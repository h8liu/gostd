<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/elf</h2>
<ul>
<li><a href="/gostd/debug/elf/elf.go.html">elf.go</a></li>
<li><a href="/gostd/debug/elf/elf_test.go.html">elf_test.go</a></li>
<li><a href="/gostd/debug/elf/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/elf/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/elf/symbols_test.go.html">symbols_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5064281">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5064337">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5064391">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5064442">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5064496">package</span>&nbsp;<span class="ident" id="5064504">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5064509">import</span>&nbsp;<span class="op" id="5064516">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5064519">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5064528">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5064543">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5064562">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5064572">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5064579">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5064585">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="5064590">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5064593">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5064626">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5064665">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="5064712">type</span>&nbsp;<span class="ident" id="5064717">FileHeader</span>&nbsp;<span class="keyword" id="5064728">struct</span>&nbsp;<span class="op" id="5064735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064738">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064749">Class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064756">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064767">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064773">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064784">Version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064793">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064804">OSABI</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064811">ABIVersion</span>&nbsp;<span class="builtintype" id="5064822">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064829">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="5064840">binary</span><span class="op" id="5064846">.</span><span class="ident" id="5064847">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064858">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064869">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064875">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064886">Machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064895">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5064906">uint64</span><br>
<span class="lineno">35</span><span class="op" id="5064913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5064916">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5064955">type</span>&nbsp;<span class="ident" id="5064960">File</span>&nbsp;<span class="keyword" id="5064965">struct</span>&nbsp;<span class="op" id="5064972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064975">FileHeader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064987">Sections</span>&nbsp;&nbsp;<span class="op" id="5064997">[</span><span class="op" id="5064998">]</span><span class="op" id="5064999">*</span><span class="ident" id="5065000">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065009">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5065019">[</span><span class="op" id="5065020">]</span><span class="op" id="5065021">*</span><span class="ident" id="5065022">Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065028">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065038">io</span><span class="op" id="5065040">.</span><span class="ident" id="5065041">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065049">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5065059">[</span><span class="op" id="5065060">]</span><span class="ident" id="5065061">verneed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065070">gnuVersym</span>&nbsp;<span class="op" id="5065080">[</span><span class="op" id="5065081">]</span><span class="builtintype" id="5065082">byte</span><br>
<span class="lineno">45</span><span class="op" id="5065087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5065090">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5065149">type</span>&nbsp;<span class="ident" id="5065154">SectionHeader</span>&nbsp;<span class="keyword" id="5065168">struct</span>&nbsp;<span class="op" id="5065175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065178">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5065188">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065196">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065206">SectionType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065219">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065229">SectionFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065242">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5065252">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065260">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5065270">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065278">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5065288">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065296">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5065306">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065314">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5065324">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065332">Addralign</span>&nbsp;<span class="builtintype" id="5065342">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065350">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5065360">uint64</span><br>
<span class="lineno"></span><span class="op" id="5065367">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5065370">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5065427">type</span>&nbsp;<span class="ident" id="5065432">Section</span>&nbsp;<span class="keyword" id="5065440">struct</span>&nbsp;<span class="op" id="5065447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065450">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5065466">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5065504">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5065544">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5065579">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5065627">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5065677">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065701">io</span><span class="op" id="5065703">.</span><span class="ident" id="5065704">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065714">sr</span>&nbsp;<span class="op" id="5065717">*</span><span class="ident" id="5065718">io</span><span class="op" id="5065720">.</span><span class="ident" id="5065721">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5065735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5065738">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5065797">func</span>&nbsp;<span class="op" id="5065802">(</span><span class="ident" id="5065803">s</span>&nbsp;<span class="op" id="5065805">*</span><span class="ident" id="5065806">Section</span><span class="op" id="5065813">)</span>&nbsp;<span class="ident" id="5065815">Data</span><span class="op" id="5065819">(</span><span class="op" id="5065820">)</span>&nbsp;<span class="op" id="5065822">(</span><span class="op" id="5065823">[</span><span class="op" id="5065824">]</span><span class="builtintype" id="5065825">byte</span><span class="op" id="5065829">,</span>&nbsp;<span class="builtintype" id="5065831">error</span><span class="op" id="5065836">)</span>&nbsp;<span class="op" id="5065838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065841">dat</span>&nbsp;<span class="op" id="5065845">:=</span>&nbsp;<span class="builtinfunc" id="5065848">make</span><span class="op" id="5065852">(</span><span class="op" id="5065853">[</span><span class="op" id="5065854">]</span><span class="builtintype" id="5065855">byte</span><span class="op" id="5065859">,</span>&nbsp;<span class="ident" id="5065861">s</span><span class="op" id="5065862">.</span><span class="ident" id="5065863">sr</span><span class="op" id="5065865">.</span><span class="ident" id="5065866">Size</span><span class="op" id="5065870">(</span><span class="op" id="5065871">)</span><span class="op" id="5065872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065875">n</span><span class="op" id="5065876">,</span>&nbsp;<span class="ident" id="5065878">err</span>&nbsp;<span class="op" id="5065882">:=</span>&nbsp;<span class="ident" id="5065885">s</span><span class="op" id="5065886">.</span><span class="ident" id="5065887">sr</span><span class="op" id="5065889">.</span><span class="ident" id="5065890">ReadAt</span><span class="op" id="5065896">(</span><span class="ident" id="5065897">dat</span><span class="op" id="5065900">,</span>&nbsp;<span class="num" id="5065902">0</span><span class="op" id="5065903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065906">if</span>&nbsp;<span class="ident" id="5065909">n</span>&nbsp;<span class="op" id="5065911">==</span>&nbsp;<span class="builtinfunc" id="5065914">len</span><span class="op" id="5065917">(</span><span class="ident" id="5065918">dat</span><span class="op" id="5065921">)</span>&nbsp;<span class="op" id="5065923">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065927">err</span>&nbsp;<span class="op" id="5065931">=</span>&nbsp;<span class="builtintype" id="5065933">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5065938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065941">return</span>&nbsp;<span class="ident" id="5065948">dat</span><span class="op" id="5065951">[</span><span class="num" id="5065952">0</span><span class="op" id="5065953">:</span><span class="ident" id="5065954">n</span><span class="op" id="5065955">]</span><span class="op" id="5065956">,</span>&nbsp;<span class="ident" id="5065958">err</span><br>
<span class="lineno"></span><span class="op" id="5065962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="5065965">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5066028">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5066053">func</span>&nbsp;<span class="op" id="5066058">(</span><span class="ident" id="5066059">f</span>&nbsp;<span class="op" id="5066061">*</span><span class="ident" id="5066062">File</span><span class="op" id="5066066">)</span>&nbsp;<span class="ident" id="5066068">stringTable</span><span class="op" id="5066079">(</span><span class="ident" id="5066080">link</span>&nbsp;<span class="builtintype" id="5066085">uint32</span><span class="op" id="5066091">)</span>&nbsp;<span class="op" id="5066093">(</span><span class="op" id="5066094">[</span><span class="op" id="5066095">]</span><span class="builtintype" id="5066096">byte</span><span class="op" id="5066100">,</span>&nbsp;<span class="builtintype" id="5066102">error</span><span class="op" id="5066107">)</span>&nbsp;<span class="op" id="5066109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5066112">if</span>&nbsp;<span class="ident" id="5066115">link</span>&nbsp;<span class="op" id="5066120">&lt;=</span>&nbsp;<span class="num" id="5066123">0</span>&nbsp;<span class="op" id="5066125">||</span>&nbsp;<span class="ident" id="5066128">link</span>&nbsp;<span class="op" id="5066133">&gt;=</span>&nbsp;<span class="builtintype" id="5066136">uint32</span><span class="op" id="5066142">(</span><span class="builtinfunc" id="5066143">len</span><span class="op" id="5066146">(</span><span class="ident" id="5066147">f</span><span class="op" id="5066148">.</span><span class="ident" id="5066149">Sections</span><span class="op" id="5066157">)</span><span class="op" id="5066158">)</span>&nbsp;<span class="op" id="5066160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5066164">return</span>&nbsp;<span class="builtintype" id="5066171">nil</span><span class="op" id="5066174">,</span>&nbsp;<span class="ident" id="5066176">errors</span><span class="op" id="5066182">.</span><span class="ident" id="5066183">New</span><span class="op" id="5066186">(</span><span class="string" id="5066187">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="5066226">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5066229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5066232">return</span>&nbsp;<span class="ident" id="5066239">f</span><span class="op" id="5066240">.</span><span class="ident" id="5066241">Sections</span><span class="op" id="5066249">[</span><span class="ident" id="5066250">link</span><span class="op" id="5066254">]</span><span class="op" id="5066255">.</span><span class="ident" id="5066256">Data</span><span class="op" id="5066260">(</span><span class="op" id="5066261">)</span><br>
<span class="lineno"></span><span class="op" id="5066263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5066266">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="5066324">func</span>&nbsp;<span class="op" id="5066329">(</span><span class="ident" id="5066330">s</span>&nbsp;<span class="op" id="5066332">*</span><span class="ident" id="5066333">Section</span><span class="op" id="5066340">)</span>&nbsp;<span class="ident" id="5066342">Open</span><span class="op" id="5066346">(</span><span class="op" id="5066347">)</span>&nbsp;<span class="ident" id="5066349">io</span><span class="op" id="5066351">.</span><span class="ident" id="5066352">ReadSeeker</span>&nbsp;<span class="op" id="5066363">{</span>&nbsp;<span class="keyword" id="5066365">return</span>&nbsp;<span class="ident" id="5066372">io</span><span class="op" id="5066374">.</span><span class="ident" id="5066375">NewSectionReader</span><span class="op" id="5066391">(</span><span class="ident" id="5066392">s</span><span class="op" id="5066393">.</span><span class="ident" id="5066394">sr</span><span class="op" id="5066396">,</span>&nbsp;<span class="num" id="5066398">0</span><span class="op" id="5066399">,</span>&nbsp;<span class="num" id="5066401">1</span><span class="op" id="5066402">&lt;&lt;</span><span class="num" id="5066404">63</span><span class="op" id="5066406">-</span><span class="num" id="5066407">1</span><span class="op" id="5066408">)</span>&nbsp;<span class="op" id="5066410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5066413">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5066469">type</span>&nbsp;<span class="ident" id="5066474">ProgHeader</span>&nbsp;<span class="keyword" id="5066485">struct</span>&nbsp;<span class="op" id="5066492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066495">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5066502">ProgType</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066512">Flags</span>&nbsp;&nbsp;<span class="ident" id="5066519">ProgFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066529">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5066536">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066544">Vaddr</span>&nbsp;&nbsp;<span class="builtintype" id="5066551">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066559">Paddr</span>&nbsp;&nbsp;<span class="builtintype" id="5066566">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066574">Filesz</span>&nbsp;<span class="builtintype" id="5066581">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066589">Memsz</span>&nbsp;&nbsp;<span class="builtintype" id="5066596">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066604">Align</span>&nbsp;&nbsp;<span class="builtintype" id="5066611">uint64</span><br>
<span class="lineno"></span><span class="op" id="5066618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5066621">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="5066688">type</span>&nbsp;<span class="ident" id="5066693">Prog</span>&nbsp;<span class="keyword" id="5066698">struct</span>&nbsp;<span class="op" id="5066705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066708">ProgHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066721">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066759">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066799">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066834">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066882">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066932">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066956">io</span><span class="op" id="5066958">.</span><span class="ident" id="5066959">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066969">sr</span>&nbsp;<span class="op" id="5066972">*</span><span class="ident" id="5066973">io</span><span class="op" id="5066975">.</span><span class="ident" id="5066976">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5066990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5066993">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5067056">func</span>&nbsp;<span class="op" id="5067061">(</span><span class="ident" id="5067062">p</span>&nbsp;<span class="op" id="5067064">*</span><span class="ident" id="5067065">Prog</span><span class="op" id="5067069">)</span>&nbsp;<span class="ident" id="5067071">Open</span><span class="op" id="5067075">(</span><span class="op" id="5067076">)</span>&nbsp;<span class="ident" id="5067078">io</span><span class="op" id="5067080">.</span><span class="ident" id="5067081">ReadSeeker</span>&nbsp;<span class="op" id="5067092">{</span>&nbsp;<span class="keyword" id="5067094">return</span>&nbsp;<span class="ident" id="5067101">io</span><span class="op" id="5067103">.</span><span class="ident" id="5067104">NewSectionReader</span><span class="op" id="5067120">(</span><span class="ident" id="5067121">p</span><span class="op" id="5067122">.</span><span class="ident" id="5067123">sr</span><span class="op" id="5067125">,</span>&nbsp;<span class="num" id="5067127">0</span><span class="op" id="5067128">,</span>&nbsp;<span class="num" id="5067130">1</span><span class="op" id="5067131">&lt;&lt;</span><span class="num" id="5067133">63</span><span class="op" id="5067135">-</span><span class="num" id="5067136">1</span><span class="op" id="5067137">)</span>&nbsp;<span class="op" id="5067139">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5067142">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5067206">type</span>&nbsp;<span class="ident" id="5067211">Symbol</span>&nbsp;<span class="keyword" id="5067218">struct</span>&nbsp;<span class="op" id="5067225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067228">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5067240">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067248">Info</span><span class="op" id="5067252">,</span>&nbsp;<span class="ident" id="5067254">Other</span>&nbsp;<span class="builtintype" id="5067260">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067266">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067278">SectionIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067292">Value</span><span class="op" id="5067297">,</span>&nbsp;<span class="ident" id="5067299">Size</span>&nbsp;<span class="builtintype" id="5067304">uint64</span><br>
<span class="lineno"></span><span class="op" id="5067311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5067314">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5067336">type</span>&nbsp;<span class="ident" id="5067341">FormatError</span>&nbsp;<span class="keyword" id="5067353">struct</span>&nbsp;<span class="op" id="5067360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067363">off</span>&nbsp;<span class="builtintype" id="5067367">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067374">msg</span>&nbsp;<span class="builtintype" id="5067378">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067386">val</span>&nbsp;<span class="keyword" id="5067390">interface</span><span class="op" id="5067399">{</span><span class="op" id="5067400">}</span><br>
<span class="lineno"></span><span class="op" id="5067402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5067405">func</span>&nbsp;<span class="op" id="5067410">(</span><span class="ident" id="5067411">e</span>&nbsp;<span class="op" id="5067413">*</span><span class="ident" id="5067414">FormatError</span><span class="op" id="5067425">)</span>&nbsp;<span class="ident" id="5067427">Error</span><span class="op" id="5067432">(</span><span class="op" id="5067433">)</span>&nbsp;<span class="builtintype" id="5067435">string</span>&nbsp;<span class="op" id="5067442">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067445">msg</span>&nbsp;<span class="op" id="5067449">:=</span>&nbsp;<span class="ident" id="5067452">e</span><span class="op" id="5067453">.</span><span class="ident" id="5067454">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5067459">if</span>&nbsp;<span class="ident" id="5067462">e</span><span class="op" id="5067463">.</span><span class="ident" id="5067464">val</span>&nbsp;<span class="op" id="5067468">!=</span>&nbsp;<span class="builtintype" id="5067471">nil</span>&nbsp;<span class="op" id="5067475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067479">msg</span>&nbsp;<span class="op" id="5067483">+=</span>&nbsp;<span class="ident" id="5067486">fmt</span><span class="op" id="5067489">.</span><span class="ident" id="5067490">Sprintf</span><span class="op" id="5067497">(</span><span class="string" id="5067498">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="5067506">,</span>&nbsp;<span class="ident" id="5067508">e</span><span class="op" id="5067509">.</span><span class="ident" id="5067510">val</span><span class="op" id="5067513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5067516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067519">msg</span>&nbsp;<span class="op" id="5067523">+=</span>&nbsp;<span class="ident" id="5067526">fmt</span><span class="op" id="5067529">.</span><span class="ident" id="5067530">Sprintf</span><span class="op" id="5067537">(</span><span class="string" id="5067538">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5067561">,</span>&nbsp;<span class="ident" id="5067563">e</span><span class="op" id="5067564">.</span><span class="ident" id="5067565">off</span><span class="op" id="5067568">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5067571">return</span>&nbsp;<span class="ident" id="5067578">msg</span><br>
<span class="lineno"></span><span class="op" id="5067582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5067585">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5067670">func</span>&nbsp;<span class="ident" id="5067675">Open</span><span class="op" id="5067679">(</span><span class="ident" id="5067680">name</span>&nbsp;<span class="builtintype" id="5067685">string</span><span class="op" id="5067691">)</span>&nbsp;<span class="op" id="5067693">(</span><span class="op" id="5067694">*</span><span class="ident" id="5067695">File</span><span class="op" id="5067699">,</span>&nbsp;<span class="builtintype" id="5067701">error</span><span class="op" id="5067706">)</span>&nbsp;<span class="op" id="5067708">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067711">f</span><span class="op" id="5067712">,</span>&nbsp;<span class="ident" id="5067714">err</span>&nbsp;<span class="op" id="5067718">:=</span>&nbsp;<span class="ident" id="5067721">os</span><span class="op" id="5067723">.</span><span class="ident" id="5067724">Open</span><span class="op" id="5067728">(</span><span class="ident" id="5067729">name</span><span class="op" id="5067733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5067736">if</span>&nbsp;<span class="ident" id="5067739">err</span>&nbsp;<span class="op" id="5067743">!=</span>&nbsp;<span class="builtintype" id="5067746">nil</span>&nbsp;<span class="op" id="5067750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5067754">return</span>&nbsp;<span class="builtintype" id="5067761">nil</span><span class="op" id="5067764">,</span>&nbsp;<span class="ident" id="5067766">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5067771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067774">ff</span><span class="op" id="5067776">,</span>&nbsp;<span class="ident" id="5067778">err</span>&nbsp;<span class="op" id="5067782">:=</span>&nbsp;<span class="ident" id="5067785">NewFile</span><span class="op" id="5067792">(</span><span class="ident" id="5067793">f</span><span class="op" id="5067794">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5067797">if</span>&nbsp;<span class="ident" id="5067800">err</span>&nbsp;<span class="op" id="5067804">!=</span>&nbsp;<span class="builtintype" id="5067807">nil</span>&nbsp;<span class="op" id="5067811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067815">f</span><span class="op" id="5067816">.</span><span class="ident" id="5067817">Close</span><span class="op" id="5067822">(</span><span class="op" id="5067823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5067827">return</span>&nbsp;<span class="builtintype" id="5067834">nil</span><span class="op" id="5067837">,</span>&nbsp;<span class="ident" id="5067839">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5067844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067847">ff</span><span class="op" id="5067849">.</span><span class="ident" id="5067850">closer</span>&nbsp;<span class="op" id="5067857">=</span>&nbsp;<span class="ident" id="5067859">f</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5067862">return</span>&nbsp;<span class="ident" id="5067869">ff</span><span class="op" id="5067871">,</span>&nbsp;<span class="builtintype" id="5067873">nil</span><br>
<span class="lineno"></span><span class="op" id="5067877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5067880">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5067906">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="5067973">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5067997">func</span>&nbsp;<span class="op" id="5068002">(</span><span class="ident" id="5068003">f</span>&nbsp;<span class="op" id="5068005">*</span><span class="ident" id="5068006">File</span><span class="op" id="5068010">)</span>&nbsp;<span class="ident" id="5068012">Close</span><span class="op" id="5068017">(</span><span class="op" id="5068018">)</span>&nbsp;<span class="builtintype" id="5068020">error</span>&nbsp;<span class="op" id="5068026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068029">var</span>&nbsp;<span class="ident" id="5068033">err</span>&nbsp;<span class="builtintype" id="5068037">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068044">if</span>&nbsp;<span class="ident" id="5068047">f</span><span class="op" id="5068048">.</span><span class="ident" id="5068049">closer</span>&nbsp;<span class="op" id="5068056">!=</span>&nbsp;<span class="builtintype" id="5068059">nil</span>&nbsp;<span class="op" id="5068063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068067">err</span>&nbsp;<span class="op" id="5068071">=</span>&nbsp;<span class="ident" id="5068073">f</span><span class="op" id="5068074">.</span><span class="ident" id="5068075">closer</span><span class="op" id="5068081">.</span><span class="ident" id="5068082">Close</span><span class="op" id="5068087">(</span><span class="op" id="5068088">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068092">f</span><span class="op" id="5068093">.</span><span class="ident" id="5068094">closer</span>&nbsp;<span class="op" id="5068101">=</span>&nbsp;<span class="builtintype" id="5068103">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5068108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068111">return</span>&nbsp;<span class="ident" id="5068118">err</span><br>
<span class="lineno"></span><span class="op" id="5068122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="5068125">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5068182">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5068233">func</span>&nbsp;<span class="op" id="5068238">(</span><span class="ident" id="5068239">f</span>&nbsp;<span class="op" id="5068241">*</span><span class="ident" id="5068242">File</span><span class="op" id="5068246">)</span>&nbsp;<span class="ident" id="5068248">SectionByType</span><span class="op" id="5068261">(</span><span class="ident" id="5068262">typ</span>&nbsp;<span class="ident" id="5068266">SectionType</span><span class="op" id="5068277">)</span>&nbsp;<span class="op" id="5068279">*</span><span class="ident" id="5068280">Section</span>&nbsp;<span class="op" id="5068288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068291">for</span>&nbsp;<span class="ident" id="5068295">_</span><span class="op" id="5068296">,</span>&nbsp;<span class="ident" id="5068298">s</span>&nbsp;<span class="op" id="5068300">:=</span>&nbsp;<span class="keyword" id="5068303">range</span>&nbsp;<span class="ident" id="5068309">f</span><span class="op" id="5068310">.</span><span class="ident" id="5068311">Sections</span>&nbsp;<span class="op" id="5068320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068324">if</span>&nbsp;<span class="ident" id="5068327">s</span><span class="op" id="5068328">.</span><span class="ident" id="5068329">Type</span>&nbsp;<span class="op" id="5068334">==</span>&nbsp;<span class="ident" id="5068337">typ</span>&nbsp;<span class="op" id="5068341">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068346">return</span>&nbsp;<span class="ident" id="5068353">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5068357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5068360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068363">return</span>&nbsp;<span class="builtintype" id="5068370">nil</span><br>
<span class="lineno"></span><span class="op" id="5068374">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5068377">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="5068460">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="5068530">func</span>&nbsp;<span class="ident" id="5068535">NewFile</span><span class="op" id="5068542">(</span><span class="ident" id="5068543">r</span>&nbsp;<span class="ident" id="5068545">io</span><span class="op" id="5068547">.</span><span class="ident" id="5068548">ReaderAt</span><span class="op" id="5068556">)</span>&nbsp;<span class="op" id="5068558">(</span><span class="op" id="5068559">*</span><span class="ident" id="5068560">File</span><span class="op" id="5068564">,</span>&nbsp;<span class="builtintype" id="5068566">error</span><span class="op" id="5068571">)</span>&nbsp;<span class="op" id="5068573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068576">sr</span>&nbsp;<span class="op" id="5068579">:=</span>&nbsp;<span class="ident" id="5068582">io</span><span class="op" id="5068584">.</span><span class="ident" id="5068585">NewSectionReader</span><span class="op" id="5068601">(</span><span class="ident" id="5068602">r</span><span class="op" id="5068603">,</span>&nbsp;<span class="num" id="5068605">0</span><span class="op" id="5068606">,</span>&nbsp;<span class="num" id="5068608">1</span><span class="op" id="5068609">&lt;&lt;</span><span class="num" id="5068611">63</span><span class="op" id="5068613">-</span><span class="num" id="5068614">1</span><span class="op" id="5068615">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5068618">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068653">var</span>&nbsp;<span class="ident" id="5068657">ident</span>&nbsp;<span class="op" id="5068663">[</span><span class="num" id="5068664">16</span><span class="op" id="5068666">]</span><span class="builtintype" id="5068667">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068674">if</span>&nbsp;<span class="ident" id="5068677">_</span><span class="op" id="5068678">,</span>&nbsp;<span class="ident" id="5068680">err</span>&nbsp;<span class="op" id="5068684">:=</span>&nbsp;<span class="ident" id="5068687">r</span><span class="op" id="5068688">.</span><span class="ident" id="5068689">ReadAt</span><span class="op" id="5068695">(</span><span class="ident" id="5068696">ident</span><span class="op" id="5068701">[</span><span class="num" id="5068702">0</span><span class="op" id="5068703">:</span><span class="op" id="5068704">]</span><span class="op" id="5068705">,</span>&nbsp;<span class="num" id="5068707">0</span><span class="op" id="5068708">)</span><span class="op" id="5068709">;</span>&nbsp;<span class="ident" id="5068711">err</span>&nbsp;<span class="op" id="5068715">!=</span>&nbsp;<span class="builtintype" id="5068718">nil</span>&nbsp;<span class="op" id="5068722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068726">return</span>&nbsp;<span class="builtintype" id="5068733">nil</span><span class="op" id="5068736">,</span>&nbsp;<span class="ident" id="5068738">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5068743">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068746">if</span>&nbsp;<span class="ident" id="5068749">ident</span><span class="op" id="5068754">[</span><span class="num" id="5068755">0</span><span class="op" id="5068756">]</span>&nbsp;<span class="op" id="5068758">!=</span>&nbsp;<span class="string" id="5068761">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="5068768">||</span>&nbsp;<span class="ident" id="5068771">ident</span><span class="op" id="5068776">[</span><span class="num" id="5068777">1</span><span class="op" id="5068778">]</span>&nbsp;<span class="op" id="5068780">!=</span>&nbsp;<span class="string" id="5068783">&#39;E&#39;</span>&nbsp;<span class="op" id="5068787">||</span>&nbsp;<span class="ident" id="5068790">ident</span><span class="op" id="5068795">[</span><span class="num" id="5068796">2</span><span class="op" id="5068797">]</span>&nbsp;<span class="op" id="5068799">!=</span>&nbsp;<span class="string" id="5068802">&#39;L&#39;</span>&nbsp;<span class="op" id="5068806">||</span>&nbsp;<span class="ident" id="5068809">ident</span><span class="op" id="5068814">[</span><span class="num" id="5068815">3</span><span class="op" id="5068816">]</span>&nbsp;<span class="op" id="5068818">!=</span>&nbsp;<span class="string" id="5068821">&#39;F&#39;</span>&nbsp;<span class="op" id="5068825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068829">return</span>&nbsp;<span class="builtintype" id="5068836">nil</span><span class="op" id="5068839">,</span>&nbsp;<span class="op" id="5068841">&amp;</span><span class="ident" id="5068842">FormatError</span><span class="op" id="5068853">{</span><span class="num" id="5068854">0</span><span class="op" id="5068855">,</span>&nbsp;<span class="string" id="5068857">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="5068875">,</span>&nbsp;<span class="ident" id="5068877">ident</span><span class="op" id="5068882">[</span><span class="num" id="5068883">0</span><span class="op" id="5068884">:</span><span class="num" id="5068885">4</span><span class="op" id="5068886">]</span><span class="op" id="5068887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5068890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068894">f</span>&nbsp;<span class="op" id="5068896">:=</span>&nbsp;<span class="builtinfunc" id="5068899">new</span><span class="op" id="5068902">(</span><span class="ident" id="5068903">File</span><span class="op" id="5068907">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068910">f</span><span class="op" id="5068911">.</span><span class="ident" id="5068912">Class</span>&nbsp;<span class="op" id="5068918">=</span>&nbsp;<span class="ident" id="5068920">Class</span><span class="op" id="5068925">(</span><span class="ident" id="5068926">ident</span><span class="op" id="5068931">[</span><span class="ident" id="5068932">EI_CLASS</span><span class="op" id="5068940">]</span><span class="op" id="5068941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068944">switch</span>&nbsp;<span class="ident" id="5068951">f</span><span class="op" id="5068952">.</span><span class="ident" id="5068953">Class</span>&nbsp;<span class="op" id="5068959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068962">case</span>&nbsp;<span class="ident" id="5068967">ELFCLASS32</span><span class="op" id="5068977">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068980">case</span>&nbsp;<span class="ident" id="5068985">ELFCLASS64</span><span class="op" id="5068995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5068999">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069006">default</span><span class="op" id="5069013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069017">return</span>&nbsp;<span class="builtintype" id="5069024">nil</span><span class="op" id="5069027">,</span>&nbsp;<span class="op" id="5069029">&amp;</span><span class="ident" id="5069030">FormatError</span><span class="op" id="5069041">{</span><span class="num" id="5069042">0</span><span class="op" id="5069043">,</span>&nbsp;<span class="string" id="5069045">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="5069064">,</span>&nbsp;<span class="ident" id="5069066">f</span><span class="op" id="5069067">.</span><span class="ident" id="5069068">Class</span><span class="op" id="5069073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5069076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069080">f</span><span class="op" id="5069081">.</span><span class="ident" id="5069082">Data</span>&nbsp;<span class="op" id="5069087">=</span>&nbsp;<span class="ident" id="5069089">Data</span><span class="op" id="5069093">(</span><span class="ident" id="5069094">ident</span><span class="op" id="5069099">[</span><span class="ident" id="5069100">EI_DATA</span><span class="op" id="5069107">]</span><span class="op" id="5069108">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069111">switch</span>&nbsp;<span class="ident" id="5069118">f</span><span class="op" id="5069119">.</span><span class="ident" id="5069120">Data</span>&nbsp;<span class="op" id="5069125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069128">case</span>&nbsp;<span class="ident" id="5069133">ELFDATA2LSB</span><span class="op" id="5069144">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069148">f</span><span class="op" id="5069149">.</span><span class="ident" id="5069150">ByteOrder</span>&nbsp;<span class="op" id="5069160">=</span>&nbsp;<span class="ident" id="5069162">binary</span><span class="op" id="5069168">.</span><span class="ident" id="5069169">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069183">case</span>&nbsp;<span class="ident" id="5069188">ELFDATA2MSB</span><span class="op" id="5069199">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069203">f</span><span class="op" id="5069204">.</span><span class="ident" id="5069205">ByteOrder</span>&nbsp;<span class="op" id="5069215">=</span>&nbsp;<span class="ident" id="5069217">binary</span><span class="op" id="5069223">.</span><span class="ident" id="5069224">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069235">default</span><span class="op" id="5069242">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069246">return</span>&nbsp;<span class="builtintype" id="5069253">nil</span><span class="op" id="5069256">,</span>&nbsp;<span class="op" id="5069258">&amp;</span><span class="ident" id="5069259">FormatError</span><span class="op" id="5069270">{</span><span class="num" id="5069271">0</span><span class="op" id="5069272">,</span>&nbsp;<span class="string" id="5069274">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="5069301">,</span>&nbsp;<span class="ident" id="5069303">f</span><span class="op" id="5069304">.</span><span class="ident" id="5069305">Data</span><span class="op" id="5069309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5069312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069316">f</span><span class="op" id="5069317">.</span><span class="ident" id="5069318">Version</span>&nbsp;<span class="op" id="5069326">=</span>&nbsp;<span class="ident" id="5069328">Version</span><span class="op" id="5069335">(</span><span class="ident" id="5069336">ident</span><span class="op" id="5069341">[</span><span class="ident" id="5069342">EI_VERSION</span><span class="op" id="5069352">]</span><span class="op" id="5069353">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069356">if</span>&nbsp;<span class="ident" id="5069359">f</span><span class="op" id="5069360">.</span><span class="ident" id="5069361">Version</span>&nbsp;<span class="op" id="5069369">!=</span>&nbsp;<span class="ident" id="5069372">EV_CURRENT</span>&nbsp;<span class="op" id="5069383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069387">return</span>&nbsp;<span class="builtintype" id="5069394">nil</span><span class="op" id="5069397">,</span>&nbsp;<span class="op" id="5069399">&amp;</span><span class="ident" id="5069400">FormatError</span><span class="op" id="5069411">{</span><span class="num" id="5069412">0</span><span class="op" id="5069413">,</span>&nbsp;<span class="string" id="5069415">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5069436">,</span>&nbsp;<span class="ident" id="5069438">f</span><span class="op" id="5069439">.</span><span class="ident" id="5069440">Version</span><span class="op" id="5069447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5069450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069454">f</span><span class="op" id="5069455">.</span><span class="ident" id="5069456">OSABI</span>&nbsp;<span class="op" id="5069462">=</span>&nbsp;<span class="ident" id="5069464">OSABI</span><span class="op" id="5069469">(</span><span class="ident" id="5069470">ident</span><span class="op" id="5069475">[</span><span class="ident" id="5069476">EI_OSABI</span><span class="op" id="5069484">]</span><span class="op" id="5069485">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069488">f</span><span class="op" id="5069489">.</span><span class="ident" id="5069490">ABIVersion</span>&nbsp;<span class="op" id="5069501">=</span>&nbsp;<span class="ident" id="5069503">ident</span><span class="op" id="5069508">[</span><span class="ident" id="5069509">EI_ABIVERSION</span><span class="op" id="5069522">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5069526">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069551">var</span>&nbsp;<span class="ident" id="5069555">phoff</span>&nbsp;<span class="builtintype" id="5069561">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069568">var</span>&nbsp;<span class="ident" id="5069572">phentsize</span><span class="op" id="5069581">,</span>&nbsp;<span class="ident" id="5069583">phnum</span>&nbsp;<span class="builtintype" id="5069589">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069594">var</span>&nbsp;<span class="ident" id="5069598">shoff</span>&nbsp;<span class="builtintype" id="5069604">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069611">var</span>&nbsp;<span class="ident" id="5069615">shentsize</span><span class="op" id="5069624">,</span>&nbsp;<span class="ident" id="5069626">shnum</span><span class="op" id="5069631">,</span>&nbsp;<span class="ident" id="5069633">shstrndx</span>&nbsp;<span class="builtintype" id="5069642">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069647">shstrndx</span>&nbsp;<span class="op" id="5069656">=</span>&nbsp;<span class="op" id="5069658">-</span><span class="num" id="5069659">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069662">switch</span>&nbsp;<span class="ident" id="5069669">f</span><span class="op" id="5069670">.</span><span class="ident" id="5069671">Class</span>&nbsp;<span class="op" id="5069677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069680">case</span>&nbsp;<span class="ident" id="5069685">ELFCLASS32</span><span class="op" id="5069695">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069699">hdr</span>&nbsp;<span class="op" id="5069703">:=</span>&nbsp;<span class="builtinfunc" id="5069706">new</span><span class="op" id="5069709">(</span><span class="ident" id="5069710">Header32</span><span class="op" id="5069718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069722">sr</span><span class="op" id="5069724">.</span><span class="ident" id="5069725">Seek</span><span class="op" id="5069729">(</span><span class="num" id="5069730">0</span><span class="op" id="5069731">,</span>&nbsp;<span class="ident" id="5069733">os</span><span class="op" id="5069735">.</span><span class="ident" id="5069736">SEEK_SET</span><span class="op" id="5069744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069748">if</span>&nbsp;<span class="ident" id="5069751">err</span>&nbsp;<span class="op" id="5069755">:=</span>&nbsp;<span class="ident" id="5069758">binary</span><span class="op" id="5069764">.</span><span class="ident" id="5069765">Read</span><span class="op" id="5069769">(</span><span class="ident" id="5069770">sr</span><span class="op" id="5069772">,</span>&nbsp;<span class="ident" id="5069774">f</span><span class="op" id="5069775">.</span><span class="ident" id="5069776">ByteOrder</span><span class="op" id="5069785">,</span>&nbsp;<span class="ident" id="5069787">hdr</span><span class="op" id="5069790">)</span><span class="op" id="5069791">;</span>&nbsp;<span class="ident" id="5069793">err</span>&nbsp;<span class="op" id="5069797">!=</span>&nbsp;<span class="builtintype" id="5069800">nil</span>&nbsp;<span class="op" id="5069804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069809">return</span>&nbsp;<span class="builtintype" id="5069816">nil</span><span class="op" id="5069819">,</span>&nbsp;<span class="ident" id="5069821">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5069827">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069831">f</span><span class="op" id="5069832">.</span><span class="ident" id="5069833">Type</span>&nbsp;<span class="op" id="5069838">=</span>&nbsp;<span class="ident" id="5069840">Type</span><span class="op" id="5069844">(</span><span class="ident" id="5069845">hdr</span><span class="op" id="5069848">.</span><span class="ident" id="5069849">Type</span><span class="op" id="5069853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069857">f</span><span class="op" id="5069858">.</span><span class="ident" id="5069859">Machine</span>&nbsp;<span class="op" id="5069867">=</span>&nbsp;<span class="ident" id="5069869">Machine</span><span class="op" id="5069876">(</span><span class="ident" id="5069877">hdr</span><span class="op" id="5069880">.</span><span class="ident" id="5069881">Machine</span><span class="op" id="5069888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069892">f</span><span class="op" id="5069893">.</span><span class="ident" id="5069894">Entry</span>&nbsp;<span class="op" id="5069900">=</span>&nbsp;<span class="builtintype" id="5069902">uint64</span><span class="op" id="5069908">(</span><span class="ident" id="5069909">hdr</span><span class="op" id="5069912">.</span><span class="ident" id="5069913">Entry</span><span class="op" id="5069918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069922">if</span>&nbsp;<span class="ident" id="5069925">v</span>&nbsp;<span class="op" id="5069927">:=</span>&nbsp;<span class="ident" id="5069930">Version</span><span class="op" id="5069937">(</span><span class="ident" id="5069938">hdr</span><span class="op" id="5069941">.</span><span class="ident" id="5069942">Version</span><span class="op" id="5069949">)</span><span class="op" id="5069950">;</span>&nbsp;<span class="ident" id="5069952">v</span>&nbsp;<span class="op" id="5069954">!=</span>&nbsp;<span class="ident" id="5069957">f</span><span class="op" id="5069958">.</span><span class="ident" id="5069959">Version</span>&nbsp;<span class="op" id="5069967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069972">return</span>&nbsp;<span class="builtintype" id="5069979">nil</span><span class="op" id="5069982">,</span>&nbsp;<span class="op" id="5069984">&amp;</span><span class="ident" id="5069985">FormatError</span><span class="op" id="5069996">{</span><span class="num" id="5069997">0</span><span class="op" id="5069998">,</span>&nbsp;<span class="string" id="5070000">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5070024">,</span>&nbsp;<span class="ident" id="5070026">v</span><span class="op" id="5070027">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070035">phoff</span>&nbsp;<span class="op" id="5070041">=</span>&nbsp;<span class="builtintype" id="5070043">int64</span><span class="op" id="5070048">(</span><span class="ident" id="5070049">hdr</span><span class="op" id="5070052">.</span><span class="ident" id="5070053">Phoff</span><span class="op" id="5070058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070062">phentsize</span>&nbsp;<span class="op" id="5070072">=</span>&nbsp;<span class="builtintype" id="5070074">int</span><span class="op" id="5070077">(</span><span class="ident" id="5070078">hdr</span><span class="op" id="5070081">.</span><span class="ident" id="5070082">Phentsize</span><span class="op" id="5070091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070095">phnum</span>&nbsp;<span class="op" id="5070101">=</span>&nbsp;<span class="builtintype" id="5070103">int</span><span class="op" id="5070106">(</span><span class="ident" id="5070107">hdr</span><span class="op" id="5070110">.</span><span class="ident" id="5070111">Phnum</span><span class="op" id="5070116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070120">shoff</span>&nbsp;<span class="op" id="5070126">=</span>&nbsp;<span class="builtintype" id="5070128">int64</span><span class="op" id="5070133">(</span><span class="ident" id="5070134">hdr</span><span class="op" id="5070137">.</span><span class="ident" id="5070138">Shoff</span><span class="op" id="5070143">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070147">shentsize</span>&nbsp;<span class="op" id="5070157">=</span>&nbsp;<span class="builtintype" id="5070159">int</span><span class="op" id="5070162">(</span><span class="ident" id="5070163">hdr</span><span class="op" id="5070166">.</span><span class="ident" id="5070167">Shentsize</span><span class="op" id="5070176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070180">shnum</span>&nbsp;<span class="op" id="5070186">=</span>&nbsp;<span class="builtintype" id="5070188">int</span><span class="op" id="5070191">(</span><span class="ident" id="5070192">hdr</span><span class="op" id="5070195">.</span><span class="ident" id="5070196">Shnum</span><span class="op" id="5070201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070205">shstrndx</span>&nbsp;<span class="op" id="5070214">=</span>&nbsp;<span class="builtintype" id="5070216">int</span><span class="op" id="5070219">(</span><span class="ident" id="5070220">hdr</span><span class="op" id="5070223">.</span><span class="ident" id="5070224">Shstrndx</span><span class="op" id="5070232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070235">case</span>&nbsp;<span class="ident" id="5070240">ELFCLASS64</span><span class="op" id="5070250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070254">hdr</span>&nbsp;<span class="op" id="5070258">:=</span>&nbsp;<span class="builtinfunc" id="5070261">new</span><span class="op" id="5070264">(</span><span class="ident" id="5070265">Header64</span><span class="op" id="5070273">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070277">sr</span><span class="op" id="5070279">.</span><span class="ident" id="5070280">Seek</span><span class="op" id="5070284">(</span><span class="num" id="5070285">0</span><span class="op" id="5070286">,</span>&nbsp;<span class="ident" id="5070288">os</span><span class="op" id="5070290">.</span><span class="ident" id="5070291">SEEK_SET</span><span class="op" id="5070299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070303">if</span>&nbsp;<span class="ident" id="5070306">err</span>&nbsp;<span class="op" id="5070310">:=</span>&nbsp;<span class="ident" id="5070313">binary</span><span class="op" id="5070319">.</span><span class="ident" id="5070320">Read</span><span class="op" id="5070324">(</span><span class="ident" id="5070325">sr</span><span class="op" id="5070327">,</span>&nbsp;<span class="ident" id="5070329">f</span><span class="op" id="5070330">.</span><span class="ident" id="5070331">ByteOrder</span><span class="op" id="5070340">,</span>&nbsp;<span class="ident" id="5070342">hdr</span><span class="op" id="5070345">)</span><span class="op" id="5070346">;</span>&nbsp;<span class="ident" id="5070348">err</span>&nbsp;<span class="op" id="5070352">!=</span>&nbsp;<span class="builtintype" id="5070355">nil</span>&nbsp;<span class="op" id="5070359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070364">return</span>&nbsp;<span class="builtintype" id="5070371">nil</span><span class="op" id="5070374">,</span>&nbsp;<span class="ident" id="5070376">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070386">f</span><span class="op" id="5070387">.</span><span class="ident" id="5070388">Type</span>&nbsp;<span class="op" id="5070393">=</span>&nbsp;<span class="ident" id="5070395">Type</span><span class="op" id="5070399">(</span><span class="ident" id="5070400">hdr</span><span class="op" id="5070403">.</span><span class="ident" id="5070404">Type</span><span class="op" id="5070408">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070412">f</span><span class="op" id="5070413">.</span><span class="ident" id="5070414">Machine</span>&nbsp;<span class="op" id="5070422">=</span>&nbsp;<span class="ident" id="5070424">Machine</span><span class="op" id="5070431">(</span><span class="ident" id="5070432">hdr</span><span class="op" id="5070435">.</span><span class="ident" id="5070436">Machine</span><span class="op" id="5070443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070447">f</span><span class="op" id="5070448">.</span><span class="ident" id="5070449">Entry</span>&nbsp;<span class="op" id="5070455">=</span>&nbsp;<span class="builtintype" id="5070457">uint64</span><span class="op" id="5070463">(</span><span class="ident" id="5070464">hdr</span><span class="op" id="5070467">.</span><span class="ident" id="5070468">Entry</span><span class="op" id="5070473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070477">if</span>&nbsp;<span class="ident" id="5070480">v</span>&nbsp;<span class="op" id="5070482">:=</span>&nbsp;<span class="ident" id="5070485">Version</span><span class="op" id="5070492">(</span><span class="ident" id="5070493">hdr</span><span class="op" id="5070496">.</span><span class="ident" id="5070497">Version</span><span class="op" id="5070504">)</span><span class="op" id="5070505">;</span>&nbsp;<span class="ident" id="5070507">v</span>&nbsp;<span class="op" id="5070509">!=</span>&nbsp;<span class="ident" id="5070512">f</span><span class="op" id="5070513">.</span><span class="ident" id="5070514">Version</span>&nbsp;<span class="op" id="5070522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070527">return</span>&nbsp;<span class="builtintype" id="5070534">nil</span><span class="op" id="5070537">,</span>&nbsp;<span class="op" id="5070539">&amp;</span><span class="ident" id="5070540">FormatError</span><span class="op" id="5070551">{</span><span class="num" id="5070552">0</span><span class="op" id="5070553">,</span>&nbsp;<span class="string" id="5070555">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5070579">,</span>&nbsp;<span class="ident" id="5070581">v</span><span class="op" id="5070582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070586">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070590">phoff</span>&nbsp;<span class="op" id="5070596">=</span>&nbsp;<span class="builtintype" id="5070598">int64</span><span class="op" id="5070603">(</span><span class="ident" id="5070604">hdr</span><span class="op" id="5070607">.</span><span class="ident" id="5070608">Phoff</span><span class="op" id="5070613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070617">phentsize</span>&nbsp;<span class="op" id="5070627">=</span>&nbsp;<span class="builtintype" id="5070629">int</span><span class="op" id="5070632">(</span><span class="ident" id="5070633">hdr</span><span class="op" id="5070636">.</span><span class="ident" id="5070637">Phentsize</span><span class="op" id="5070646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070650">phnum</span>&nbsp;<span class="op" id="5070656">=</span>&nbsp;<span class="builtintype" id="5070658">int</span><span class="op" id="5070661">(</span><span class="ident" id="5070662">hdr</span><span class="op" id="5070665">.</span><span class="ident" id="5070666">Phnum</span><span class="op" id="5070671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070675">shoff</span>&nbsp;<span class="op" id="5070681">=</span>&nbsp;<span class="builtintype" id="5070683">int64</span><span class="op" id="5070688">(</span><span class="ident" id="5070689">hdr</span><span class="op" id="5070692">.</span><span class="ident" id="5070693">Shoff</span><span class="op" id="5070698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070702">shentsize</span>&nbsp;<span class="op" id="5070712">=</span>&nbsp;<span class="builtintype" id="5070714">int</span><span class="op" id="5070717">(</span><span class="ident" id="5070718">hdr</span><span class="op" id="5070721">.</span><span class="ident" id="5070722">Shentsize</span><span class="op" id="5070731">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070735">shnum</span>&nbsp;<span class="op" id="5070741">=</span>&nbsp;<span class="builtintype" id="5070743">int</span><span class="op" id="5070746">(</span><span class="ident" id="5070747">hdr</span><span class="op" id="5070750">.</span><span class="ident" id="5070751">Shnum</span><span class="op" id="5070756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070760">shstrndx</span>&nbsp;<span class="op" id="5070769">=</span>&nbsp;<span class="builtintype" id="5070771">int</span><span class="op" id="5070774">(</span><span class="ident" id="5070775">hdr</span><span class="op" id="5070778">.</span><span class="ident" id="5070779">Shstrndx</span><span class="op" id="5070787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070794">if</span>&nbsp;<span class="ident" id="5070797">shnum</span>&nbsp;<span class="op" id="5070803">&gt;</span>&nbsp;<span class="num" id="5070805">0</span>&nbsp;<span class="op" id="5070807">&amp;&amp;</span>&nbsp;<span class="ident" id="5070810">shoff</span>&nbsp;<span class="op" id="5070816">&gt;</span>&nbsp;<span class="num" id="5070818">0</span>&nbsp;<span class="op" id="5070820">&amp;&amp;</span>&nbsp;<span class="op" id="5070823">(</span><span class="ident" id="5070824">shstrndx</span>&nbsp;<span class="op" id="5070833">&lt;</span>&nbsp;<span class="num" id="5070835">0</span>&nbsp;<span class="op" id="5070837">||</span>&nbsp;<span class="ident" id="5070840">shstrndx</span>&nbsp;<span class="op" id="5070849">&gt;=</span>&nbsp;<span class="ident" id="5070852">shnum</span><span class="op" id="5070857">)</span>&nbsp;<span class="op" id="5070859">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070863">return</span>&nbsp;<span class="builtintype" id="5070870">nil</span><span class="op" id="5070873">,</span>&nbsp;<span class="op" id="5070875">&amp;</span><span class="ident" id="5070876">FormatError</span><span class="op" id="5070887">{</span><span class="num" id="5070888">0</span><span class="op" id="5070889">,</span>&nbsp;<span class="string" id="5070891">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="5070913">,</span>&nbsp;<span class="ident" id="5070915">shstrndx</span><span class="op" id="5070923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5070930">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070955">f</span><span class="op" id="5070956">.</span><span class="ident" id="5070957">Progs</span>&nbsp;<span class="op" id="5070963">=</span>&nbsp;<span class="builtinfunc" id="5070965">make</span><span class="op" id="5070969">(</span><span class="op" id="5070970">[</span><span class="op" id="5070971">]</span><span class="op" id="5070972">*</span><span class="ident" id="5070973">Prog</span><span class="op" id="5070977">,</span>&nbsp;<span class="ident" id="5070979">phnum</span><span class="op" id="5070984">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070987">for</span>&nbsp;<span class="ident" id="5070991">i</span>&nbsp;<span class="op" id="5070993">:=</span>&nbsp;<span class="num" id="5070996">0</span><span class="op" id="5070997">;</span>&nbsp;<span class="ident" id="5070999">i</span>&nbsp;<span class="op" id="5071001">&lt;</span>&nbsp;<span class="ident" id="5071003">phnum</span><span class="op" id="5071008">;</span>&nbsp;<span class="ident" id="5071010">i</span><span class="op" id="5071011">++</span>&nbsp;<span class="op" id="5071014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071018">off</span>&nbsp;<span class="op" id="5071022">:=</span>&nbsp;<span class="ident" id="5071025">phoff</span>&nbsp;<span class="op" id="5071031">+</span>&nbsp;<span class="builtintype" id="5071033">int64</span><span class="op" id="5071038">(</span><span class="ident" id="5071039">i</span><span class="op" id="5071040">)</span><span class="op" id="5071041">*</span><span class="builtintype" id="5071042">int64</span><span class="op" id="5071047">(</span><span class="ident" id="5071048">phentsize</span><span class="op" id="5071057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071061">sr</span><span class="op" id="5071063">.</span><span class="ident" id="5071064">Seek</span><span class="op" id="5071068">(</span><span class="ident" id="5071069">off</span><span class="op" id="5071072">,</span>&nbsp;<span class="ident" id="5071074">os</span><span class="op" id="5071076">.</span><span class="ident" id="5071077">SEEK_SET</span><span class="op" id="5071085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071089">p</span>&nbsp;<span class="op" id="5071091">:=</span>&nbsp;<span class="builtinfunc" id="5071094">new</span><span class="op" id="5071097">(</span><span class="ident" id="5071098">Prog</span><span class="op" id="5071102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071106">switch</span>&nbsp;<span class="ident" id="5071113">f</span><span class="op" id="5071114">.</span><span class="ident" id="5071115">Class</span>&nbsp;<span class="op" id="5071121">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071125">case</span>&nbsp;<span class="ident" id="5071130">ELFCLASS32</span><span class="op" id="5071140">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071145">ph</span>&nbsp;<span class="op" id="5071148">:=</span>&nbsp;<span class="builtinfunc" id="5071151">new</span><span class="op" id="5071154">(</span><span class="ident" id="5071155">Prog32</span><span class="op" id="5071161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071166">if</span>&nbsp;<span class="ident" id="5071169">err</span>&nbsp;<span class="op" id="5071173">:=</span>&nbsp;<span class="ident" id="5071176">binary</span><span class="op" id="5071182">.</span><span class="ident" id="5071183">Read</span><span class="op" id="5071187">(</span><span class="ident" id="5071188">sr</span><span class="op" id="5071190">,</span>&nbsp;<span class="ident" id="5071192">f</span><span class="op" id="5071193">.</span><span class="ident" id="5071194">ByteOrder</span><span class="op" id="5071203">,</span>&nbsp;<span class="ident" id="5071205">ph</span><span class="op" id="5071207">)</span><span class="op" id="5071208">;</span>&nbsp;<span class="ident" id="5071210">err</span>&nbsp;<span class="op" id="5071214">!=</span>&nbsp;<span class="builtintype" id="5071217">nil</span>&nbsp;<span class="op" id="5071221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071227">return</span>&nbsp;<span class="builtintype" id="5071234">nil</span><span class="op" id="5071237">,</span>&nbsp;<span class="ident" id="5071239">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071246">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071251">p</span><span class="op" id="5071252">.</span><span class="ident" id="5071253">ProgHeader</span>&nbsp;<span class="op" id="5071264">=</span>&nbsp;<span class="ident" id="5071266">ProgHeader</span><span class="op" id="5071276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071282">Type</span><span class="op" id="5071286">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5071290">ProgType</span><span class="op" id="5071298">(</span><span class="ident" id="5071299">ph</span><span class="op" id="5071301">.</span><span class="ident" id="5071302">Type</span><span class="op" id="5071306">)</span><span class="op" id="5071307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071313">Flags</span><span class="op" id="5071318">:</span>&nbsp;&nbsp;<span class="ident" id="5071321">ProgFlag</span><span class="op" id="5071329">(</span><span class="ident" id="5071330">ph</span><span class="op" id="5071332">.</span><span class="ident" id="5071333">Flags</span><span class="op" id="5071338">)</span><span class="op" id="5071339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071345">Off</span><span class="op" id="5071348">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5071353">uint64</span><span class="op" id="5071359">(</span><span class="ident" id="5071360">ph</span><span class="op" id="5071362">.</span><span class="ident" id="5071363">Off</span><span class="op" id="5071366">)</span><span class="op" id="5071367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071373">Vaddr</span><span class="op" id="5071378">:</span>&nbsp;&nbsp;<span class="builtintype" id="5071381">uint64</span><span class="op" id="5071387">(</span><span class="ident" id="5071388">ph</span><span class="op" id="5071390">.</span><span class="ident" id="5071391">Vaddr</span><span class="op" id="5071396">)</span><span class="op" id="5071397">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071403">Paddr</span><span class="op" id="5071408">:</span>&nbsp;&nbsp;<span class="builtintype" id="5071411">uint64</span><span class="op" id="5071417">(</span><span class="ident" id="5071418">ph</span><span class="op" id="5071420">.</span><span class="ident" id="5071421">Paddr</span><span class="op" id="5071426">)</span><span class="op" id="5071427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071433">Filesz</span><span class="op" id="5071439">:</span>&nbsp;<span class="builtintype" id="5071441">uint64</span><span class="op" id="5071447">(</span><span class="ident" id="5071448">ph</span><span class="op" id="5071450">.</span><span class="ident" id="5071451">Filesz</span><span class="op" id="5071457">)</span><span class="op" id="5071458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071464">Memsz</span><span class="op" id="5071469">:</span>&nbsp;&nbsp;<span class="builtintype" id="5071472">uint64</span><span class="op" id="5071478">(</span><span class="ident" id="5071479">ph</span><span class="op" id="5071481">.</span><span class="ident" id="5071482">Memsz</span><span class="op" id="5071487">)</span><span class="op" id="5071488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071494">Align</span><span class="op" id="5071499">:</span>&nbsp;&nbsp;<span class="builtintype" id="5071502">uint64</span><span class="op" id="5071508">(</span><span class="ident" id="5071509">ph</span><span class="op" id="5071511">.</span><span class="ident" id="5071512">Align</span><span class="op" id="5071517">)</span><span class="op" id="5071518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071523">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071527">case</span>&nbsp;<span class="ident" id="5071532">ELFCLASS64</span><span class="op" id="5071542">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071547">ph</span>&nbsp;<span class="op" id="5071550">:=</span>&nbsp;<span class="builtinfunc" id="5071553">new</span><span class="op" id="5071556">(</span><span class="ident" id="5071557">Prog64</span><span class="op" id="5071563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071568">if</span>&nbsp;<span class="ident" id="5071571">err</span>&nbsp;<span class="op" id="5071575">:=</span>&nbsp;<span class="ident" id="5071578">binary</span><span class="op" id="5071584">.</span><span class="ident" id="5071585">Read</span><span class="op" id="5071589">(</span><span class="ident" id="5071590">sr</span><span class="op" id="5071592">,</span>&nbsp;<span class="ident" id="5071594">f</span><span class="op" id="5071595">.</span><span class="ident" id="5071596">ByteOrder</span><span class="op" id="5071605">,</span>&nbsp;<span class="ident" id="5071607">ph</span><span class="op" id="5071609">)</span><span class="op" id="5071610">;</span>&nbsp;<span class="ident" id="5071612">err</span>&nbsp;<span class="op" id="5071616">!=</span>&nbsp;<span class="builtintype" id="5071619">nil</span>&nbsp;<span class="op" id="5071623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071629">return</span>&nbsp;<span class="builtintype" id="5071636">nil</span><span class="op" id="5071639">,</span>&nbsp;<span class="ident" id="5071641">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071648">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071653">p</span><span class="op" id="5071654">.</span><span class="ident" id="5071655">ProgHeader</span>&nbsp;<span class="op" id="5071666">=</span>&nbsp;<span class="ident" id="5071668">ProgHeader</span><span class="op" id="5071678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071684">Type</span><span class="op" id="5071688">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5071692">ProgType</span><span class="op" id="5071700">(</span><span class="ident" id="5071701">ph</span><span class="op" id="5071703">.</span><span class="ident" id="5071704">Type</span><span class="op" id="5071708">)</span><span class="op" id="5071709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071715">Flags</span><span class="op" id="5071720">:</span>&nbsp;&nbsp;<span class="ident" id="5071723">ProgFlag</span><span class="op" id="5071731">(</span><span class="ident" id="5071732">ph</span><span class="op" id="5071734">.</span><span class="ident" id="5071735">Flags</span><span class="op" id="5071740">)</span><span class="op" id="5071741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071747">Off</span><span class="op" id="5071750">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5071755">uint64</span><span class="op" id="5071761">(</span><span class="ident" id="5071762">ph</span><span class="op" id="5071764">.</span><span class="ident" id="5071765">Off</span><span class="op" id="5071768">)</span><span class="op" id="5071769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071775">Vaddr</span><span class="op" id="5071780">:</span>&nbsp;&nbsp;<span class="builtintype" id="5071783">uint64</span><span class="op" id="5071789">(</span><span class="ident" id="5071790">ph</span><span class="op" id="5071792">.</span><span class="ident" id="5071793">Vaddr</span><span class="op" id="5071798">)</span><span class="op" id="5071799">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071805">Paddr</span><span class="op" id="5071810">:</span>&nbsp;&nbsp;<span class="builtintype" id="5071813">uint64</span><span class="op" id="5071819">(</span><span class="ident" id="5071820">ph</span><span class="op" id="5071822">.</span><span class="ident" id="5071823">Paddr</span><span class="op" id="5071828">)</span><span class="op" id="5071829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071835">Filesz</span><span class="op" id="5071841">:</span>&nbsp;<span class="builtintype" id="5071843">uint64</span><span class="op" id="5071849">(</span><span class="ident" id="5071850">ph</span><span class="op" id="5071852">.</span><span class="ident" id="5071853">Filesz</span><span class="op" id="5071859">)</span><span class="op" id="5071860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071866">Memsz</span><span class="op" id="5071871">:</span>&nbsp;&nbsp;<span class="builtintype" id="5071874">uint64</span><span class="op" id="5071880">(</span><span class="ident" id="5071881">ph</span><span class="op" id="5071883">.</span><span class="ident" id="5071884">Memsz</span><span class="op" id="5071889">)</span><span class="op" id="5071890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071896">Align</span><span class="op" id="5071901">:</span>&nbsp;&nbsp;<span class="builtintype" id="5071904">uint64</span><span class="op" id="5071910">(</span><span class="ident" id="5071911">ph</span><span class="op" id="5071913">.</span><span class="ident" id="5071914">Align</span><span class="op" id="5071919">)</span><span class="op" id="5071920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071925">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071933">p</span><span class="op" id="5071934">.</span><span class="ident" id="5071935">sr</span>&nbsp;<span class="op" id="5071938">=</span>&nbsp;<span class="ident" id="5071940">io</span><span class="op" id="5071942">.</span><span class="ident" id="5071943">NewSectionReader</span><span class="op" id="5071959">(</span><span class="ident" id="5071960">r</span><span class="op" id="5071961">,</span>&nbsp;<span class="builtintype" id="5071963">int64</span><span class="op" id="5071968">(</span><span class="ident" id="5071969">p</span><span class="op" id="5071970">.</span><span class="ident" id="5071971">Off</span><span class="op" id="5071974">)</span><span class="op" id="5071975">,</span>&nbsp;<span class="builtintype" id="5071977">int64</span><span class="op" id="5071982">(</span><span class="ident" id="5071983">p</span><span class="op" id="5071984">.</span><span class="ident" id="5071985">Filesz</span><span class="op" id="5071991">)</span><span class="op" id="5071992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071996">p</span><span class="op" id="5071997">.</span><span class="ident" id="5071998">ReaderAt</span>&nbsp;<span class="op" id="5072007">=</span>&nbsp;<span class="ident" id="5072009">p</span><span class="op" id="5072010">.</span><span class="ident" id="5072011">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072016">f</span><span class="op" id="5072017">.</span><span class="ident" id="5072018">Progs</span><span class="op" id="5072023">[</span><span class="ident" id="5072024">i</span><span class="op" id="5072025">]</span>&nbsp;<span class="op" id="5072027">=</span>&nbsp;<span class="ident" id="5072029">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5072032">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5072036">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072061">f</span><span class="op" id="5072062">.</span><span class="ident" id="5072063">Sections</span>&nbsp;<span class="op" id="5072072">=</span>&nbsp;<span class="builtinfunc" id="5072074">make</span><span class="op" id="5072078">(</span><span class="op" id="5072079">[</span><span class="op" id="5072080">]</span><span class="op" id="5072081">*</span><span class="ident" id="5072082">Section</span><span class="op" id="5072089">,</span>&nbsp;<span class="ident" id="5072091">shnum</span><span class="op" id="5072096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072099">names</span>&nbsp;<span class="op" id="5072105">:=</span>&nbsp;<span class="builtinfunc" id="5072108">make</span><span class="op" id="5072112">(</span><span class="op" id="5072113">[</span><span class="op" id="5072114">]</span><span class="builtintype" id="5072115">uint32</span><span class="op" id="5072121">,</span>&nbsp;<span class="ident" id="5072123">shnum</span><span class="op" id="5072128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072131">for</span>&nbsp;<span class="ident" id="5072135">i</span>&nbsp;<span class="op" id="5072137">:=</span>&nbsp;<span class="num" id="5072140">0</span><span class="op" id="5072141">;</span>&nbsp;<span class="ident" id="5072143">i</span>&nbsp;<span class="op" id="5072145">&lt;</span>&nbsp;<span class="ident" id="5072147">shnum</span><span class="op" id="5072152">;</span>&nbsp;<span class="ident" id="5072154">i</span><span class="op" id="5072155">++</span>&nbsp;<span class="op" id="5072158">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072162">off</span>&nbsp;<span class="op" id="5072166">:=</span>&nbsp;<span class="ident" id="5072169">shoff</span>&nbsp;<span class="op" id="5072175">+</span>&nbsp;<span class="builtintype" id="5072177">int64</span><span class="op" id="5072182">(</span><span class="ident" id="5072183">i</span><span class="op" id="5072184">)</span><span class="op" id="5072185">*</span><span class="builtintype" id="5072186">int64</span><span class="op" id="5072191">(</span><span class="ident" id="5072192">shentsize</span><span class="op" id="5072201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072205">sr</span><span class="op" id="5072207">.</span><span class="ident" id="5072208">Seek</span><span class="op" id="5072212">(</span><span class="ident" id="5072213">off</span><span class="op" id="5072216">,</span>&nbsp;<span class="ident" id="5072218">os</span><span class="op" id="5072220">.</span><span class="ident" id="5072221">SEEK_SET</span><span class="op" id="5072229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072233">s</span>&nbsp;<span class="op" id="5072235">:=</span>&nbsp;<span class="builtinfunc" id="5072238">new</span><span class="op" id="5072241">(</span><span class="ident" id="5072242">Section</span><span class="op" id="5072249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072253">switch</span>&nbsp;<span class="ident" id="5072260">f</span><span class="op" id="5072261">.</span><span class="ident" id="5072262">Class</span>&nbsp;<span class="op" id="5072268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072272">case</span>&nbsp;<span class="ident" id="5072277">ELFCLASS32</span><span class="op" id="5072287">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072292">sh</span>&nbsp;<span class="op" id="5072295">:=</span>&nbsp;<span class="builtinfunc" id="5072298">new</span><span class="op" id="5072301">(</span><span class="ident" id="5072302">Section32</span><span class="op" id="5072311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072316">if</span>&nbsp;<span class="ident" id="5072319">err</span>&nbsp;<span class="op" id="5072323">:=</span>&nbsp;<span class="ident" id="5072326">binary</span><span class="op" id="5072332">.</span><span class="ident" id="5072333">Read</span><span class="op" id="5072337">(</span><span class="ident" id="5072338">sr</span><span class="op" id="5072340">,</span>&nbsp;<span class="ident" id="5072342">f</span><span class="op" id="5072343">.</span><span class="ident" id="5072344">ByteOrder</span><span class="op" id="5072353">,</span>&nbsp;<span class="ident" id="5072355">sh</span><span class="op" id="5072357">)</span><span class="op" id="5072358">;</span>&nbsp;<span class="ident" id="5072360">err</span>&nbsp;<span class="op" id="5072364">!=</span>&nbsp;<span class="builtintype" id="5072367">nil</span>&nbsp;<span class="op" id="5072371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072377">return</span>&nbsp;<span class="builtintype" id="5072384">nil</span><span class="op" id="5072387">,</span>&nbsp;<span class="ident" id="5072389">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5072396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072401">names</span><span class="op" id="5072406">[</span><span class="ident" id="5072407">i</span><span class="op" id="5072408">]</span>&nbsp;<span class="op" id="5072410">=</span>&nbsp;<span class="ident" id="5072412">sh</span><span class="op" id="5072414">.</span><span class="ident" id="5072415">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072423">s</span><span class="op" id="5072424">.</span><span class="ident" id="5072425">SectionHeader</span>&nbsp;<span class="op" id="5072439">=</span>&nbsp;<span class="ident" id="5072441">SectionHeader</span><span class="op" id="5072454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072460">Type</span><span class="op" id="5072464">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072471">SectionType</span><span class="op" id="5072482">(</span><span class="ident" id="5072483">sh</span><span class="op" id="5072485">.</span><span class="ident" id="5072486">Type</span><span class="op" id="5072490">)</span><span class="op" id="5072491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072497">Flags</span><span class="op" id="5072502">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072508">SectionFlag</span><span class="op" id="5072519">(</span><span class="ident" id="5072520">sh</span><span class="op" id="5072522">.</span><span class="ident" id="5072523">Flags</span><span class="op" id="5072528">)</span><span class="op" id="5072529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072535">Addr</span><span class="op" id="5072539">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5072546">uint64</span><span class="op" id="5072552">(</span><span class="ident" id="5072553">sh</span><span class="op" id="5072555">.</span><span class="ident" id="5072556">Addr</span><span class="op" id="5072560">)</span><span class="op" id="5072561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072567">Offset</span><span class="op" id="5072573">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5072578">uint64</span><span class="op" id="5072584">(</span><span class="ident" id="5072585">sh</span><span class="op" id="5072587">.</span><span class="ident" id="5072588">Off</span><span class="op" id="5072591">)</span><span class="op" id="5072592">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072598">Size</span><span class="op" id="5072602">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5072609">uint64</span><span class="op" id="5072615">(</span><span class="ident" id="5072616">sh</span><span class="op" id="5072618">.</span><span class="ident" id="5072619">Size</span><span class="op" id="5072623">)</span><span class="op" id="5072624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072630">Link</span><span class="op" id="5072634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5072641">uint32</span><span class="op" id="5072647">(</span><span class="ident" id="5072648">sh</span><span class="op" id="5072650">.</span><span class="ident" id="5072651">Link</span><span class="op" id="5072655">)</span><span class="op" id="5072656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072662">Info</span><span class="op" id="5072666">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5072673">uint32</span><span class="op" id="5072679">(</span><span class="ident" id="5072680">sh</span><span class="op" id="5072682">.</span><span class="ident" id="5072683">Info</span><span class="op" id="5072687">)</span><span class="op" id="5072688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072694">Addralign</span><span class="op" id="5072703">:</span>&nbsp;<span class="builtintype" id="5072705">uint64</span><span class="op" id="5072711">(</span><span class="ident" id="5072712">sh</span><span class="op" id="5072714">.</span><span class="ident" id="5072715">Addralign</span><span class="op" id="5072724">)</span><span class="op" id="5072725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072731">Entsize</span><span class="op" id="5072738">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5072742">uint64</span><span class="op" id="5072748">(</span><span class="ident" id="5072749">sh</span><span class="op" id="5072751">.</span><span class="ident" id="5072752">Entsize</span><span class="op" id="5072759">)</span><span class="op" id="5072760">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5072765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072769">case</span>&nbsp;<span class="ident" id="5072774">ELFCLASS64</span><span class="op" id="5072784">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072789">sh</span>&nbsp;<span class="op" id="5072792">:=</span>&nbsp;<span class="builtinfunc" id="5072795">new</span><span class="op" id="5072798">(</span><span class="ident" id="5072799">Section64</span><span class="op" id="5072808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072813">if</span>&nbsp;<span class="ident" id="5072816">err</span>&nbsp;<span class="op" id="5072820">:=</span>&nbsp;<span class="ident" id="5072823">binary</span><span class="op" id="5072829">.</span><span class="ident" id="5072830">Read</span><span class="op" id="5072834">(</span><span class="ident" id="5072835">sr</span><span class="op" id="5072837">,</span>&nbsp;<span class="ident" id="5072839">f</span><span class="op" id="5072840">.</span><span class="ident" id="5072841">ByteOrder</span><span class="op" id="5072850">,</span>&nbsp;<span class="ident" id="5072852">sh</span><span class="op" id="5072854">)</span><span class="op" id="5072855">;</span>&nbsp;<span class="ident" id="5072857">err</span>&nbsp;<span class="op" id="5072861">!=</span>&nbsp;<span class="builtintype" id="5072864">nil</span>&nbsp;<span class="op" id="5072868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072874">return</span>&nbsp;<span class="builtintype" id="5072881">nil</span><span class="op" id="5072884">,</span>&nbsp;<span class="ident" id="5072886">err</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5072893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072898">names</span><span class="op" id="5072903">[</span><span class="ident" id="5072904">i</span><span class="op" id="5072905">]</span>&nbsp;<span class="op" id="5072907">=</span>&nbsp;<span class="ident" id="5072909">sh</span><span class="op" id="5072911">.</span><span class="ident" id="5072912">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072920">s</span><span class="op" id="5072921">.</span><span class="ident" id="5072922">SectionHeader</span>&nbsp;<span class="op" id="5072936">=</span>&nbsp;<span class="ident" id="5072938">SectionHeader</span><span class="op" id="5072951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072957">Type</span><span class="op" id="5072961">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072968">SectionType</span><span class="op" id="5072979">(</span><span class="ident" id="5072980">sh</span><span class="op" id="5072982">.</span><span class="ident" id="5072983">Type</span><span class="op" id="5072987">)</span><span class="op" id="5072988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072994">Flags</span><span class="op" id="5072999">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073005">SectionFlag</span><span class="op" id="5073016">(</span><span class="ident" id="5073017">sh</span><span class="op" id="5073019">.</span><span class="ident" id="5073020">Flags</span><span class="op" id="5073025">)</span><span class="op" id="5073026">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073032">Offset</span><span class="op" id="5073038">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5073043">uint64</span><span class="op" id="5073049">(</span><span class="ident" id="5073050">sh</span><span class="op" id="5073052">.</span><span class="ident" id="5073053">Off</span><span class="op" id="5073056">)</span><span class="op" id="5073057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073063">Size</span><span class="op" id="5073067">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5073074">uint64</span><span class="op" id="5073080">(</span><span class="ident" id="5073081">sh</span><span class="op" id="5073083">.</span><span class="ident" id="5073084">Size</span><span class="op" id="5073088">)</span><span class="op" id="5073089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073095">Addr</span><span class="op" id="5073099">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5073106">uint64</span><span class="op" id="5073112">(</span><span class="ident" id="5073113">sh</span><span class="op" id="5073115">.</span><span class="ident" id="5073116">Addr</span><span class="op" id="5073120">)</span><span class="op" id="5073121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073127">Link</span><span class="op" id="5073131">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5073138">uint32</span><span class="op" id="5073144">(</span><span class="ident" id="5073145">sh</span><span class="op" id="5073147">.</span><span class="ident" id="5073148">Link</span><span class="op" id="5073152">)</span><span class="op" id="5073153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073159">Info</span><span class="op" id="5073163">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5073170">uint32</span><span class="op" id="5073176">(</span><span class="ident" id="5073177">sh</span><span class="op" id="5073179">.</span><span class="ident" id="5073180">Info</span><span class="op" id="5073184">)</span><span class="op" id="5073185">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073191">Addralign</span><span class="op" id="5073200">:</span>&nbsp;<span class="builtintype" id="5073202">uint64</span><span class="op" id="5073208">(</span><span class="ident" id="5073209">sh</span><span class="op" id="5073211">.</span><span class="ident" id="5073212">Addralign</span><span class="op" id="5073221">)</span><span class="op" id="5073222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073228">Entsize</span><span class="op" id="5073235">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5073239">uint64</span><span class="op" id="5073245">(</span><span class="ident" id="5073246">sh</span><span class="op" id="5073248">.</span><span class="ident" id="5073249">Entsize</span><span class="op" id="5073256">)</span><span class="op" id="5073257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5073262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5073266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073270">s</span><span class="op" id="5073271">.</span><span class="ident" id="5073272">sr</span>&nbsp;<span class="op" id="5073275">=</span>&nbsp;<span class="ident" id="5073277">io</span><span class="op" id="5073279">.</span><span class="ident" id="5073280">NewSectionReader</span><span class="op" id="5073296">(</span><span class="ident" id="5073297">r</span><span class="op" id="5073298">,</span>&nbsp;<span class="builtintype" id="5073300">int64</span><span class="op" id="5073305">(</span><span class="ident" id="5073306">s</span><span class="op" id="5073307">.</span><span class="ident" id="5073308">Offset</span><span class="op" id="5073314">)</span><span class="op" id="5073315">,</span>&nbsp;<span class="builtintype" id="5073317">int64</span><span class="op" id="5073322">(</span><span class="ident" id="5073323">s</span><span class="op" id="5073324">.</span><span class="ident" id="5073325">Size</span><span class="op" id="5073329">)</span><span class="op" id="5073330">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073334">s</span><span class="op" id="5073335">.</span><span class="ident" id="5073336">ReaderAt</span>&nbsp;<span class="op" id="5073345">=</span>&nbsp;<span class="ident" id="5073347">s</span><span class="op" id="5073348">.</span><span class="ident" id="5073349">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073354">f</span><span class="op" id="5073355">.</span><span class="ident" id="5073356">Sections</span><span class="op" id="5073364">[</span><span class="ident" id="5073365">i</span><span class="op" id="5073366">]</span>&nbsp;<span class="op" id="5073368">=</span>&nbsp;<span class="ident" id="5073370">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5073373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073377">if</span>&nbsp;<span class="builtinfunc" id="5073380">len</span><span class="op" id="5073383">(</span><span class="ident" id="5073384">f</span><span class="op" id="5073385">.</span><span class="ident" id="5073386">Sections</span><span class="op" id="5073394">)</span>&nbsp;<span class="op" id="5073396">==</span>&nbsp;<span class="num" id="5073399">0</span>&nbsp;<span class="op" id="5073401">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073405">return</span>&nbsp;<span class="ident" id="5073412">f</span><span class="op" id="5073413">,</span>&nbsp;<span class="builtintype" id="5073415">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5073420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5073424">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073462">shstrtab</span><span class="op" id="5073470">,</span>&nbsp;<span class="ident" id="5073472">err</span>&nbsp;<span class="op" id="5073476">:=</span>&nbsp;<span class="ident" id="5073479">f</span><span class="op" id="5073480">.</span><span class="ident" id="5073481">Sections</span><span class="op" id="5073489">[</span><span class="ident" id="5073490">shstrndx</span><span class="op" id="5073498">]</span><span class="op" id="5073499">.</span><span class="ident" id="5073500">Data</span><span class="op" id="5073504">(</span><span class="op" id="5073505">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073508">if</span>&nbsp;<span class="ident" id="5073511">err</span>&nbsp;<span class="op" id="5073515">!=</span>&nbsp;<span class="builtintype" id="5073518">nil</span>&nbsp;<span class="op" id="5073522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073526">return</span>&nbsp;<span class="builtintype" id="5073533">nil</span><span class="op" id="5073536">,</span>&nbsp;<span class="ident" id="5073538">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5073543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073546">for</span>&nbsp;<span class="ident" id="5073550">i</span><span class="op" id="5073551">,</span>&nbsp;<span class="ident" id="5073553">s</span>&nbsp;<span class="op" id="5073555">:=</span>&nbsp;<span class="keyword" id="5073558">range</span>&nbsp;<span class="ident" id="5073564">f</span><span class="op" id="5073565">.</span><span class="ident" id="5073566">Sections</span>&nbsp;<span class="op" id="5073575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073579">var</span>&nbsp;<span class="ident" id="5073583">ok</span>&nbsp;<span class="builtintype" id="5073586">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073593">s</span><span class="op" id="5073594">.</span><span class="ident" id="5073595">Name</span><span class="op" id="5073599">,</span>&nbsp;<span class="ident" id="5073601">ok</span>&nbsp;<span class="op" id="5073604">=</span>&nbsp;<span class="ident" id="5073606">getString</span><span class="op" id="5073615">(</span><span class="ident" id="5073616">shstrtab</span><span class="op" id="5073624">,</span>&nbsp;<span class="builtintype" id="5073626">int</span><span class="op" id="5073629">(</span><span class="ident" id="5073630">names</span><span class="op" id="5073635">[</span><span class="ident" id="5073636">i</span><span class="op" id="5073637">]</span><span class="op" id="5073638">)</span><span class="op" id="5073639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073643">if</span>&nbsp;<span class="op" id="5073646">!</span><span class="ident" id="5073647">ok</span>&nbsp;<span class="op" id="5073650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073655">return</span>&nbsp;<span class="builtintype" id="5073662">nil</span><span class="op" id="5073665">,</span>&nbsp;<span class="op" id="5073667">&amp;</span><span class="ident" id="5073668">FormatError</span><span class="op" id="5073679">{</span><span class="ident" id="5073680">shoff</span>&nbsp;<span class="op" id="5073686">+</span>&nbsp;<span class="builtintype" id="5073688">int64</span><span class="op" id="5073693">(</span><span class="ident" id="5073694">i</span><span class="op" id="5073695">*</span><span class="ident" id="5073696">shentsize</span><span class="op" id="5073705">)</span><span class="op" id="5073706">,</span>&nbsp;<span class="string" id="5073708">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="5073732">,</span>&nbsp;<span class="ident" id="5073734">names</span><span class="op" id="5073739">[</span><span class="ident" id="5073740">i</span><span class="op" id="5073741">]</span><span class="op" id="5073742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5073746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5073749">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073753">return</span>&nbsp;<span class="ident" id="5073760">f</span><span class="op" id="5073761">,</span>&nbsp;<span class="builtintype" id="5073763">nil</span><br>
<span class="lineno"></span><span class="op" id="5073767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5073770">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="5073841">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5073905">func</span>&nbsp;<span class="op" id="5073910">(</span><span class="ident" id="5073911">f</span>&nbsp;<span class="op" id="5073913">*</span><span class="ident" id="5073914">File</span><span class="op" id="5073918">)</span>&nbsp;<span class="ident" id="5073920">getSymbols</span><span class="op" id="5073930">(</span><span class="ident" id="5073931">typ</span>&nbsp;<span class="ident" id="5073935">SectionType</span><span class="op" id="5073946">)</span>&nbsp;<span class="op" id="5073948">(</span><span class="op" id="5073949">[</span><span class="op" id="5073950">]</span><span class="ident" id="5073951">Symbol</span><span class="op" id="5073957">,</span>&nbsp;<span class="op" id="5073959">[</span><span class="op" id="5073960">]</span><span class="builtintype" id="5073961">byte</span><span class="op" id="5073965">,</span>&nbsp;<span class="builtintype" id="5073967">error</span><span class="op" id="5073972">)</span>&nbsp;<span class="op" id="5073974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073977">switch</span>&nbsp;<span class="ident" id="5073984">f</span><span class="op" id="5073985">.</span><span class="ident" id="5073986">Class</span>&nbsp;<span class="op" id="5073992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073995">case</span>&nbsp;<span class="ident" id="5074000">ELFCLASS64</span><span class="op" id="5074010">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074014">return</span>&nbsp;<span class="ident" id="5074021">f</span><span class="op" id="5074022">.</span><span class="ident" id="5074023">getSymbols64</span><span class="op" id="5074035">(</span><span class="ident" id="5074036">typ</span><span class="op" id="5074039">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074043">case</span>&nbsp;<span class="ident" id="5074048">ELFCLASS32</span><span class="op" id="5074058">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074062">return</span>&nbsp;<span class="ident" id="5074069">f</span><span class="op" id="5074070">.</span><span class="ident" id="5074071">getSymbols32</span><span class="op" id="5074083">(</span><span class="ident" id="5074084">typ</span><span class="op" id="5074087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074094">return</span>&nbsp;<span class="builtintype" id="5074101">nil</span><span class="op" id="5074104">,</span>&nbsp;<span class="builtintype" id="5074106">nil</span><span class="op" id="5074109">,</span>&nbsp;<span class="ident" id="5074111">errors</span><span class="op" id="5074117">.</span><span class="ident" id="5074118">New</span><span class="op" id="5074121">(</span><span class="string" id="5074122">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5074139">)</span><br>
<span class="lineno"></span><span class="op" id="5074141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5074144">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="5074212">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="5074256">var</span>&nbsp;<span class="ident" id="5074260">ErrNoSymbols</span>&nbsp;<span class="op" id="5074273">=</span>&nbsp;<span class="ident" id="5074275">errors</span><span class="op" id="5074281">.</span><span class="ident" id="5074282">New</span><span class="op" id="5074285">(</span><span class="string" id="5074286">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5074305">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5074308">func</span>&nbsp;<span class="op" id="5074313">(</span><span class="ident" id="5074314">f</span>&nbsp;<span class="op" id="5074316">*</span><span class="ident" id="5074317">File</span><span class="op" id="5074321">)</span>&nbsp;<span class="ident" id="5074323">getSymbols32</span><span class="op" id="5074335">(</span><span class="ident" id="5074336">typ</span>&nbsp;<span class="ident" id="5074340">SectionType</span><span class="op" id="5074351">)</span>&nbsp;<span class="op" id="5074353">(</span><span class="op" id="5074354">[</span><span class="op" id="5074355">]</span><span class="ident" id="5074356">Symbol</span><span class="op" id="5074362">,</span>&nbsp;<span class="op" id="5074364">[</span><span class="op" id="5074365">]</span><span class="builtintype" id="5074366">byte</span><span class="op" id="5074370">,</span>&nbsp;<span class="builtintype" id="5074372">error</span><span class="op" id="5074377">)</span>&nbsp;<span class="op" id="5074379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074382">symtabSection</span>&nbsp;<span class="op" id="5074396">:=</span>&nbsp;<span class="ident" id="5074399">f</span><span class="op" id="5074400">.</span><span class="ident" id="5074401">SectionByType</span><span class="op" id="5074414">(</span><span class="ident" id="5074415">typ</span><span class="op" id="5074418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074421">if</span>&nbsp;<span class="ident" id="5074424">symtabSection</span>&nbsp;<span class="op" id="5074438">==</span>&nbsp;<span class="builtintype" id="5074441">nil</span>&nbsp;<span class="op" id="5074445">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074449">return</span>&nbsp;<span class="builtintype" id="5074456">nil</span><span class="op" id="5074459">,</span>&nbsp;<span class="builtintype" id="5074461">nil</span><span class="op" id="5074464">,</span>&nbsp;<span class="ident" id="5074466">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074484">data</span><span class="op" id="5074488">,</span>&nbsp;<span class="ident" id="5074490">err</span>&nbsp;<span class="op" id="5074494">:=</span>&nbsp;<span class="ident" id="5074497">symtabSection</span><span class="op" id="5074510">.</span><span class="ident" id="5074511">Data</span><span class="op" id="5074515">(</span><span class="op" id="5074516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074519">if</span>&nbsp;<span class="ident" id="5074522">err</span>&nbsp;<span class="op" id="5074526">!=</span>&nbsp;<span class="builtintype" id="5074529">nil</span>&nbsp;<span class="op" id="5074533">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074537">return</span>&nbsp;<span class="builtintype" id="5074544">nil</span><span class="op" id="5074547">,</span>&nbsp;<span class="builtintype" id="5074549">nil</span><span class="op" id="5074552">,</span>&nbsp;<span class="ident" id="5074554">errors</span><span class="op" id="5074560">.</span><span class="ident" id="5074561">New</span><span class="op" id="5074564">(</span><span class="string" id="5074565">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5074593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074599">symtab</span>&nbsp;<span class="op" id="5074606">:=</span>&nbsp;<span class="ident" id="5074609">bytes</span><span class="op" id="5074614">.</span><span class="ident" id="5074615">NewReader</span><span class="op" id="5074624">(</span><span class="ident" id="5074625">data</span><span class="op" id="5074629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074632">if</span>&nbsp;<span class="ident" id="5074635">symtab</span><span class="op" id="5074641">.</span><span class="ident" id="5074642">Len</span><span class="op" id="5074645">(</span><span class="op" id="5074646">)</span><span class="op" id="5074647">%</span><span class="ident" id="5074648">Sym32Size</span>&nbsp;<span class="op" id="5074658">!=</span>&nbsp;<span class="num" id="5074661">0</span>&nbsp;<span class="op" id="5074663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074667">return</span>&nbsp;<span class="builtintype" id="5074674">nil</span><span class="op" id="5074677">,</span>&nbsp;<span class="builtintype" id="5074679">nil</span><span class="op" id="5074682">,</span>&nbsp;<span class="ident" id="5074684">errors</span><span class="op" id="5074690">.</span><span class="ident" id="5074691">New</span><span class="op" id="5074694">(</span><span class="string" id="5074695">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="5074750">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074757">strdata</span><span class="op" id="5074764">,</span>&nbsp;<span class="ident" id="5074766">err</span>&nbsp;<span class="op" id="5074770">:=</span>&nbsp;<span class="ident" id="5074773">f</span><span class="op" id="5074774">.</span><span class="ident" id="5074775">stringTable</span><span class="op" id="5074786">(</span><span class="ident" id="5074787">symtabSection</span><span class="op" id="5074800">.</span><span class="ident" id="5074801">Link</span><span class="op" id="5074805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074808">if</span>&nbsp;<span class="ident" id="5074811">err</span>&nbsp;<span class="op" id="5074815">!=</span>&nbsp;<span class="builtintype" id="5074818">nil</span>&nbsp;<span class="op" id="5074822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074826">return</span>&nbsp;<span class="builtintype" id="5074833">nil</span><span class="op" id="5074836">,</span>&nbsp;<span class="builtintype" id="5074838">nil</span><span class="op" id="5074841">,</span>&nbsp;<span class="ident" id="5074843">errors</span><span class="op" id="5074849">.</span><span class="ident" id="5074850">New</span><span class="op" id="5074853">(</span><span class="string" id="5074854">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5074888">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5074895">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074929">var</span>&nbsp;<span class="ident" id="5074933">skip</span>&nbsp;<span class="op" id="5074938">[</span><span class="ident" id="5074939">Sym32Size</span><span class="op" id="5074948">]</span><span class="builtintype" id="5074949">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074955">symtab</span><span class="op" id="5074961">.</span><span class="ident" id="5074962">Read</span><span class="op" id="5074966">(</span><span class="ident" id="5074967">skip</span><span class="op" id="5074971">[</span><span class="op" id="5074972">:</span><span class="op" id="5074973">]</span><span class="op" id="5074974">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074978">symbols</span>&nbsp;<span class="op" id="5074986">:=</span>&nbsp;<span class="builtinfunc" id="5074989">make</span><span class="op" id="5074993">(</span><span class="op" id="5074994">[</span><span class="op" id="5074995">]</span><span class="ident" id="5074996">Symbol</span><span class="op" id="5075002">,</span>&nbsp;<span class="ident" id="5075004">symtab</span><span class="op" id="5075010">.</span><span class="ident" id="5075011">Len</span><span class="op" id="5075014">(</span><span class="op" id="5075015">)</span><span class="op" id="5075016">/</span><span class="ident" id="5075017">Sym32Size</span><span class="op" id="5075026">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075030">i</span>&nbsp;<span class="op" id="5075032">:=</span>&nbsp;<span class="num" id="5075035">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075038">var</span>&nbsp;<span class="ident" id="5075042">sym</span>&nbsp;<span class="ident" id="5075046">Sym32</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075053">for</span>&nbsp;<span class="ident" id="5075057">symtab</span><span class="op" id="5075063">.</span><span class="ident" id="5075064">Len</span><span class="op" id="5075067">(</span><span class="op" id="5075068">)</span>&nbsp;<span class="op" id="5075070">&gt;</span>&nbsp;<span class="num" id="5075072">0</span>&nbsp;<span class="op" id="5075074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075078">binary</span><span class="op" id="5075084">.</span><span class="ident" id="5075085">Read</span><span class="op" id="5075089">(</span><span class="ident" id="5075090">symtab</span><span class="op" id="5075096">,</span>&nbsp;<span class="ident" id="5075098">f</span><span class="op" id="5075099">.</span><span class="ident" id="5075100">ByteOrder</span><span class="op" id="5075109">,</span>&nbsp;<span class="op" id="5075111">&amp;</span><span class="ident" id="5075112">sym</span><span class="op" id="5075115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075119">str</span><span class="op" id="5075122">,</span>&nbsp;<span class="ident" id="5075124">_</span>&nbsp;<span class="op" id="5075126">:=</span>&nbsp;<span class="ident" id="5075129">getString</span><span class="op" id="5075138">(</span><span class="ident" id="5075139">strdata</span><span class="op" id="5075146">,</span>&nbsp;<span class="builtintype" id="5075148">int</span><span class="op" id="5075151">(</span><span class="ident" id="5075152">sym</span><span class="op" id="5075155">.</span><span class="ident" id="5075156">Name</span><span class="op" id="5075160">)</span><span class="op" id="5075161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075165">symbols</span><span class="op" id="5075172">[</span><span class="ident" id="5075173">i</span><span class="op" id="5075174">]</span><span class="op" id="5075175">.</span><span class="ident" id="5075176">Name</span>&nbsp;<span class="op" id="5075181">=</span>&nbsp;<span class="ident" id="5075183">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075189">symbols</span><span class="op" id="5075196">[</span><span class="ident" id="5075197">i</span><span class="op" id="5075198">]</span><span class="op" id="5075199">.</span><span class="ident" id="5075200">Info</span>&nbsp;<span class="op" id="5075205">=</span>&nbsp;<span class="ident" id="5075207">sym</span><span class="op" id="5075210">.</span><span class="ident" id="5075211">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075218">symbols</span><span class="op" id="5075225">[</span><span class="ident" id="5075226">i</span><span class="op" id="5075227">]</span><span class="op" id="5075228">.</span><span class="ident" id="5075229">Other</span>&nbsp;<span class="op" id="5075235">=</span>&nbsp;<span class="ident" id="5075237">sym</span><span class="op" id="5075240">.</span><span class="ident" id="5075241">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075249">symbols</span><span class="op" id="5075256">[</span><span class="ident" id="5075257">i</span><span class="op" id="5075258">]</span><span class="op" id="5075259">.</span><span class="ident" id="5075260">Section</span>&nbsp;<span class="op" id="5075268">=</span>&nbsp;<span class="ident" id="5075270">SectionIndex</span><span class="op" id="5075282">(</span><span class="ident" id="5075283">sym</span><span class="op" id="5075286">.</span><span class="ident" id="5075287">Shndx</span><span class="op" id="5075292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075296">symbols</span><span class="op" id="5075303">[</span><span class="ident" id="5075304">i</span><span class="op" id="5075305">]</span><span class="op" id="5075306">.</span><span class="ident" id="5075307">Value</span>&nbsp;<span class="op" id="5075313">=</span>&nbsp;<span class="builtintype" id="5075315">uint64</span><span class="op" id="5075321">(</span><span class="ident" id="5075322">sym</span><span class="op" id="5075325">.</span><span class="ident" id="5075326">Value</span><span class="op" id="5075331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075335">symbols</span><span class="op" id="5075342">[</span><span class="ident" id="5075343">i</span><span class="op" id="5075344">]</span><span class="op" id="5075345">.</span><span class="ident" id="5075346">Size</span>&nbsp;<span class="op" id="5075351">=</span>&nbsp;<span class="builtintype" id="5075353">uint64</span><span class="op" id="5075359">(</span><span class="ident" id="5075360">sym</span><span class="op" id="5075363">.</span><span class="ident" id="5075364">Size</span><span class="op" id="5075368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075372">i</span><span class="op" id="5075373">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5075377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075381">return</span>&nbsp;<span class="ident" id="5075388">symbols</span><span class="op" id="5075395">,</span>&nbsp;<span class="ident" id="5075397">strdata</span><span class="op" id="5075404">,</span>&nbsp;<span class="builtintype" id="5075406">nil</span><br>
<span class="lineno"></span><span class="op" id="5075410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="5075413">func</span>&nbsp;<span class="op" id="5075418">(</span><span class="ident" id="5075419">f</span>&nbsp;<span class="op" id="5075421">*</span><span class="ident" id="5075422">File</span><span class="op" id="5075426">)</span>&nbsp;<span class="ident" id="5075428">getSymbols64</span><span class="op" id="5075440">(</span><span class="ident" id="5075441">typ</span>&nbsp;<span class="ident" id="5075445">SectionType</span><span class="op" id="5075456">)</span>&nbsp;<span class="op" id="5075458">(</span><span class="op" id="5075459">[</span><span class="op" id="5075460">]</span><span class="ident" id="5075461">Symbol</span><span class="op" id="5075467">,</span>&nbsp;<span class="op" id="5075469">[</span><span class="op" id="5075470">]</span><span class="builtintype" id="5075471">byte</span><span class="op" id="5075475">,</span>&nbsp;<span class="builtintype" id="5075477">error</span><span class="op" id="5075482">)</span>&nbsp;<span class="op" id="5075484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075487">symtabSection</span>&nbsp;<span class="op" id="5075501">:=</span>&nbsp;<span class="ident" id="5075504">f</span><span class="op" id="5075505">.</span><span class="ident" id="5075506">SectionByType</span><span class="op" id="5075519">(</span><span class="ident" id="5075520">typ</span><span class="op" id="5075523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075526">if</span>&nbsp;<span class="ident" id="5075529">symtabSection</span>&nbsp;<span class="op" id="5075543">==</span>&nbsp;<span class="builtintype" id="5075546">nil</span>&nbsp;<span class="op" id="5075550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075554">return</span>&nbsp;<span class="builtintype" id="5075561">nil</span><span class="op" id="5075564">,</span>&nbsp;<span class="builtintype" id="5075566">nil</span><span class="op" id="5075569">,</span>&nbsp;<span class="ident" id="5075571">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5075585">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075589">data</span><span class="op" id="5075593">,</span>&nbsp;<span class="ident" id="5075595">err</span>&nbsp;<span class="op" id="5075599">:=</span>&nbsp;<span class="ident" id="5075602">symtabSection</span><span class="op" id="5075615">.</span><span class="ident" id="5075616">Data</span><span class="op" id="5075620">(</span><span class="op" id="5075621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075624">if</span>&nbsp;<span class="ident" id="5075627">err</span>&nbsp;<span class="op" id="5075631">!=</span>&nbsp;<span class="builtintype" id="5075634">nil</span>&nbsp;<span class="op" id="5075638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075642">return</span>&nbsp;<span class="builtintype" id="5075649">nil</span><span class="op" id="5075652">,</span>&nbsp;<span class="builtintype" id="5075654">nil</span><span class="op" id="5075657">,</span>&nbsp;<span class="ident" id="5075659">errors</span><span class="op" id="5075665">.</span><span class="ident" id="5075666">New</span><span class="op" id="5075669">(</span><span class="string" id="5075670">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5075698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5075701">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075704">symtab</span>&nbsp;<span class="op" id="5075711">:=</span>&nbsp;<span class="ident" id="5075714">bytes</span><span class="op" id="5075719">.</span><span class="ident" id="5075720">NewReader</span><span class="op" id="5075729">(</span><span class="ident" id="5075730">data</span><span class="op" id="5075734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075737">if</span>&nbsp;<span class="ident" id="5075740">symtab</span><span class="op" id="5075746">.</span><span class="ident" id="5075747">Len</span><span class="op" id="5075750">(</span><span class="op" id="5075751">)</span><span class="op" id="5075752">%</span><span class="ident" id="5075753">Sym64Size</span>&nbsp;<span class="op" id="5075763">!=</span>&nbsp;<span class="num" id="5075766">0</span>&nbsp;<span class="op" id="5075768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075772">return</span>&nbsp;<span class="builtintype" id="5075779">nil</span><span class="op" id="5075782">,</span>&nbsp;<span class="builtintype" id="5075784">nil</span><span class="op" id="5075787">,</span>&nbsp;<span class="ident" id="5075789">errors</span><span class="op" id="5075795">.</span><span class="ident" id="5075796">New</span><span class="op" id="5075799">(</span><span class="string" id="5075800">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="5075857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5075860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075864">strdata</span><span class="op" id="5075871">,</span>&nbsp;<span class="ident" id="5075873">err</span>&nbsp;<span class="op" id="5075877">:=</span>&nbsp;<span class="ident" id="5075880">f</span><span class="op" id="5075881">.</span><span class="ident" id="5075882">stringTable</span><span class="op" id="5075893">(</span><span class="ident" id="5075894">symtabSection</span><span class="op" id="5075907">.</span><span class="ident" id="5075908">Link</span><span class="op" id="5075912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075915">if</span>&nbsp;<span class="ident" id="5075918">err</span>&nbsp;<span class="op" id="5075922">!=</span>&nbsp;<span class="builtintype" id="5075925">nil</span>&nbsp;<span class="op" id="5075929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075933">return</span>&nbsp;<span class="builtintype" id="5075940">nil</span><span class="op" id="5075943">,</span>&nbsp;<span class="builtintype" id="5075945">nil</span><span class="op" id="5075948">,</span>&nbsp;<span class="ident" id="5075950">errors</span><span class="op" id="5075956">.</span><span class="ident" id="5075957">New</span><span class="op" id="5075960">(</span><span class="string" id="5075961">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5075995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5075998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5076002">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076036">var</span>&nbsp;<span class="ident" id="5076040">skip</span>&nbsp;<span class="op" id="5076045">[</span><span class="ident" id="5076046">Sym64Size</span><span class="op" id="5076055">]</span><span class="builtintype" id="5076056">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076062">symtab</span><span class="op" id="5076068">.</span><span class="ident" id="5076069">Read</span><span class="op" id="5076073">(</span><span class="ident" id="5076074">skip</span><span class="op" id="5076078">[</span><span class="op" id="5076079">:</span><span class="op" id="5076080">]</span><span class="op" id="5076081">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076085">symbols</span>&nbsp;<span class="op" id="5076093">:=</span>&nbsp;<span class="builtinfunc" id="5076096">make</span><span class="op" id="5076100">(</span><span class="op" id="5076101">[</span><span class="op" id="5076102">]</span><span class="ident" id="5076103">Symbol</span><span class="op" id="5076109">,</span>&nbsp;<span class="ident" id="5076111">symtab</span><span class="op" id="5076117">.</span><span class="ident" id="5076118">Len</span><span class="op" id="5076121">(</span><span class="op" id="5076122">)</span><span class="op" id="5076123">/</span><span class="ident" id="5076124">Sym64Size</span><span class="op" id="5076133">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076137">i</span>&nbsp;<span class="op" id="5076139">:=</span>&nbsp;<span class="num" id="5076142">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076145">var</span>&nbsp;<span class="ident" id="5076149">sym</span>&nbsp;<span class="ident" id="5076153">Sym64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076160">for</span>&nbsp;<span class="ident" id="5076164">symtab</span><span class="op" id="5076170">.</span><span class="ident" id="5076171">Len</span><span class="op" id="5076174">(</span><span class="op" id="5076175">)</span>&nbsp;<span class="op" id="5076177">&gt;</span>&nbsp;<span class="num" id="5076179">0</span>&nbsp;<span class="op" id="5076181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076185">binary</span><span class="op" id="5076191">.</span><span class="ident" id="5076192">Read</span><span class="op" id="5076196">(</span><span class="ident" id="5076197">symtab</span><span class="op" id="5076203">,</span>&nbsp;<span class="ident" id="5076205">f</span><span class="op" id="5076206">.</span><span class="ident" id="5076207">ByteOrder</span><span class="op" id="5076216">,</span>&nbsp;<span class="op" id="5076218">&amp;</span><span class="ident" id="5076219">sym</span><span class="op" id="5076222">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076226">str</span><span class="op" id="5076229">,</span>&nbsp;<span class="ident" id="5076231">_</span>&nbsp;<span class="op" id="5076233">:=</span>&nbsp;<span class="ident" id="5076236">getString</span><span class="op" id="5076245">(</span><span class="ident" id="5076246">strdata</span><span class="op" id="5076253">,</span>&nbsp;<span class="builtintype" id="5076255">int</span><span class="op" id="5076258">(</span><span class="ident" id="5076259">sym</span><span class="op" id="5076262">.</span><span class="ident" id="5076263">Name</span><span class="op" id="5076267">)</span><span class="op" id="5076268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076272">symbols</span><span class="op" id="5076279">[</span><span class="ident" id="5076280">i</span><span class="op" id="5076281">]</span><span class="op" id="5076282">.</span><span class="ident" id="5076283">Name</span>&nbsp;<span class="op" id="5076288">=</span>&nbsp;<span class="ident" id="5076290">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076296">symbols</span><span class="op" id="5076303">[</span><span class="ident" id="5076304">i</span><span class="op" id="5076305">]</span><span class="op" id="5076306">.</span><span class="ident" id="5076307">Info</span>&nbsp;<span class="op" id="5076312">=</span>&nbsp;<span class="ident" id="5076314">sym</span><span class="op" id="5076317">.</span><span class="ident" id="5076318">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076325">symbols</span><span class="op" id="5076332">[</span><span class="ident" id="5076333">i</span><span class="op" id="5076334">]</span><span class="op" id="5076335">.</span><span class="ident" id="5076336">Other</span>&nbsp;<span class="op" id="5076342">=</span>&nbsp;<span class="ident" id="5076344">sym</span><span class="op" id="5076347">.</span><span class="ident" id="5076348">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076356">symbols</span><span class="op" id="5076363">[</span><span class="ident" id="5076364">i</span><span class="op" id="5076365">]</span><span class="op" id="5076366">.</span><span class="ident" id="5076367">Section</span>&nbsp;<span class="op" id="5076375">=</span>&nbsp;<span class="ident" id="5076377">SectionIndex</span><span class="op" id="5076389">(</span><span class="ident" id="5076390">sym</span><span class="op" id="5076393">.</span><span class="ident" id="5076394">Shndx</span><span class="op" id="5076399">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076403">symbols</span><span class="op" id="5076410">[</span><span class="ident" id="5076411">i</span><span class="op" id="5076412">]</span><span class="op" id="5076413">.</span><span class="ident" id="5076414">Value</span>&nbsp;<span class="op" id="5076420">=</span>&nbsp;<span class="ident" id="5076422">sym</span><span class="op" id="5076425">.</span><span class="ident" id="5076426">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076434">symbols</span><span class="op" id="5076441">[</span><span class="ident" id="5076442">i</span><span class="op" id="5076443">]</span><span class="op" id="5076444">.</span><span class="ident" id="5076445">Size</span>&nbsp;<span class="op" id="5076450">=</span>&nbsp;<span class="ident" id="5076452">sym</span><span class="op" id="5076455">.</span><span class="ident" id="5076456">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076463">i</span><span class="op" id="5076464">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076472">return</span>&nbsp;<span class="ident" id="5076479">symbols</span><span class="op" id="5076486">,</span>&nbsp;<span class="ident" id="5076488">strdata</span><span class="op" id="5076495">,</span>&nbsp;<span class="builtintype" id="5076497">nil</span><br>
<span class="lineno"></span><span class="op" id="5076501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5076504">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5076561">func</span>&nbsp;<span class="ident" id="5076566">getString</span><span class="op" id="5076575">(</span><span class="ident" id="5076576">section</span>&nbsp;<span class="op" id="5076584">[</span><span class="op" id="5076585">]</span><span class="builtintype" id="5076586">byte</span><span class="op" id="5076590">,</span>&nbsp;<span class="ident" id="5076592">start</span>&nbsp;<span class="builtintype" id="5076598">int</span><span class="op" id="5076601">)</span>&nbsp;<span class="op" id="5076603">(</span><span class="builtintype" id="5076604">string</span><span class="op" id="5076610">,</span>&nbsp;<span class="builtintype" id="5076612">bool</span><span class="op" id="5076616">)</span>&nbsp;<span class="op" id="5076618">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076621">if</span>&nbsp;<span class="ident" id="5076624">start</span>&nbsp;<span class="op" id="5076630">&lt;</span>&nbsp;<span class="num" id="5076632">0</span>&nbsp;<span class="op" id="5076634">||</span>&nbsp;<span class="ident" id="5076637">start</span>&nbsp;<span class="op" id="5076643">&gt;=</span>&nbsp;<span class="builtinfunc" id="5076646">len</span><span class="op" id="5076649">(</span><span class="ident" id="5076650">section</span><span class="op" id="5076657">)</span>&nbsp;<span class="op" id="5076659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076663">return</span>&nbsp;<span class="string" id="5076670">&#34;&#34;</span><span class="op" id="5076672">,</span>&nbsp;<span class="builtintype" id="5076674">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076685">for</span>&nbsp;<span class="ident" id="5076689">end</span>&nbsp;<span class="op" id="5076693">:=</span>&nbsp;<span class="ident" id="5076696">start</span><span class="op" id="5076701">;</span>&nbsp;<span class="ident" id="5076703">end</span>&nbsp;<span class="op" id="5076707">&lt;</span>&nbsp;<span class="builtinfunc" id="5076709">len</span><span class="op" id="5076712">(</span><span class="ident" id="5076713">section</span><span class="op" id="5076720">)</span><span class="op" id="5076721">;</span>&nbsp;<span class="ident" id="5076723">end</span><span class="op" id="5076726">++</span>&nbsp;<span class="op" id="5076729">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076733">if</span>&nbsp;<span class="ident" id="5076736">section</span><span class="op" id="5076743">[</span><span class="ident" id="5076744">end</span><span class="op" id="5076747">]</span>&nbsp;<span class="op" id="5076749">==</span>&nbsp;<span class="num" id="5076752">0</span>&nbsp;<span class="op" id="5076754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076759">return</span>&nbsp;<span class="builtintype" id="5076766">string</span><span class="op" id="5076772">(</span><span class="ident" id="5076773">section</span><span class="op" id="5076780">[</span><span class="ident" id="5076781">start</span><span class="op" id="5076786">:</span><span class="ident" id="5076787">end</span><span class="op" id="5076790">]</span><span class="op" id="5076791">)</span><span class="op" id="5076792">,</span>&nbsp;<span class="builtintype" id="5076794">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076807">return</span>&nbsp;<span class="string" id="5076814">&#34;&#34;</span><span class="op" id="5076816">,</span>&nbsp;<span class="builtintype" id="5076818">false</span><br>
<span class="lineno">510</span><span class="op" id="5076824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5076827">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5076895">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5076914">func</span>&nbsp;<span class="op" id="5076919">(</span><span class="ident" id="5076920">f</span>&nbsp;<span class="op" id="5076922">*</span><span class="ident" id="5076923">File</span><span class="op" id="5076927">)</span>&nbsp;<span class="ident" id="5076929">Section</span><span class="op" id="5076936">(</span><span class="ident" id="5076937">name</span>&nbsp;<span class="builtintype" id="5076942">string</span><span class="op" id="5076948">)</span>&nbsp;<span class="op" id="5076950">*</span><span class="ident" id="5076951">Section</span>&nbsp;<span class="op" id="5076959">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076962">for</span>&nbsp;<span class="ident" id="5076966">_</span><span class="op" id="5076967">,</span>&nbsp;<span class="ident" id="5076969">s</span>&nbsp;<span class="op" id="5076971">:=</span>&nbsp;<span class="keyword" id="5076974">range</span>&nbsp;<span class="ident" id="5076980">f</span><span class="op" id="5076981">.</span><span class="ident" id="5076982">Sections</span>&nbsp;<span class="op" id="5076991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076995">if</span>&nbsp;<span class="ident" id="5076998">s</span><span class="op" id="5076999">.</span><span class="ident" id="5077000">Name</span>&nbsp;<span class="op" id="5077005">==</span>&nbsp;<span class="ident" id="5077008">name</span>&nbsp;<span class="op" id="5077013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077018">return</span>&nbsp;<span class="ident" id="5077025">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077032">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077035">return</span>&nbsp;<span class="builtintype" id="5077042">nil</span><br>
<span class="lineno"></span><span class="op" id="5077046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5077049">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="5077127">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="5077146">func</span>&nbsp;<span class="op" id="5077151">(</span><span class="ident" id="5077152">f</span>&nbsp;<span class="op" id="5077154">*</span><span class="ident" id="5077155">File</span><span class="op" id="5077159">)</span>&nbsp;<span class="ident" id="5077161">applyRelocations</span><span class="op" id="5077177">(</span><span class="ident" id="5077178">dst</span>&nbsp;<span class="op" id="5077182">[</span><span class="op" id="5077183">]</span><span class="builtintype" id="5077184">byte</span><span class="op" id="5077188">,</span>&nbsp;<span class="ident" id="5077190">rels</span>&nbsp;<span class="op" id="5077195">[</span><span class="op" id="5077196">]</span><span class="builtintype" id="5077197">byte</span><span class="op" id="5077201">)</span>&nbsp;<span class="builtintype" id="5077203">error</span>&nbsp;<span class="op" id="5077209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077212">if</span>&nbsp;<span class="ident" id="5077215">f</span><span class="op" id="5077216">.</span><span class="ident" id="5077217">Class</span>&nbsp;<span class="op" id="5077223">==</span>&nbsp;<span class="ident" id="5077226">ELFCLASS64</span>&nbsp;<span class="op" id="5077237">&amp;&amp;</span>&nbsp;<span class="ident" id="5077240">f</span><span class="op" id="5077241">.</span><span class="ident" id="5077242">Machine</span>&nbsp;<span class="op" id="5077250">==</span>&nbsp;<span class="ident" id="5077253">EM_X86_64</span>&nbsp;<span class="op" id="5077263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077267">return</span>&nbsp;<span class="ident" id="5077274">f</span><span class="op" id="5077275">.</span><span class="ident" id="5077276">applyRelocationsAMD64</span><span class="op" id="5077297">(</span><span class="ident" id="5077298">dst</span><span class="op" id="5077301">,</span>&nbsp;<span class="ident" id="5077303">rels</span><span class="op" id="5077307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077313">if</span>&nbsp;<span class="ident" id="5077316">f</span><span class="op" id="5077317">.</span><span class="ident" id="5077318">Class</span>&nbsp;<span class="op" id="5077324">==</span>&nbsp;<span class="ident" id="5077327">ELFCLASS32</span>&nbsp;<span class="op" id="5077338">&amp;&amp;</span>&nbsp;<span class="ident" id="5077341">f</span><span class="op" id="5077342">.</span><span class="ident" id="5077343">Machine</span>&nbsp;<span class="op" id="5077351">==</span>&nbsp;<span class="ident" id="5077354">EM_386</span>&nbsp;<span class="op" id="5077361">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077365">return</span>&nbsp;<span class="ident" id="5077372">f</span><span class="op" id="5077373">.</span><span class="ident" id="5077374">applyRelocations386</span><span class="op" id="5077393">(</span><span class="ident" id="5077394">dst</span><span class="op" id="5077397">,</span>&nbsp;<span class="ident" id="5077399">rels</span><span class="op" id="5077403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077409">if</span>&nbsp;<span class="ident" id="5077412">f</span><span class="op" id="5077413">.</span><span class="ident" id="5077414">Class</span>&nbsp;<span class="op" id="5077420">==</span>&nbsp;<span class="ident" id="5077423">ELFCLASS64</span>&nbsp;<span class="op" id="5077434">&amp;&amp;</span>&nbsp;<span class="ident" id="5077437">f</span><span class="op" id="5077438">.</span><span class="ident" id="5077439">Machine</span>&nbsp;<span class="op" id="5077447">==</span>&nbsp;<span class="ident" id="5077450">EM_AARCH64</span>&nbsp;<span class="op" id="5077461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077465">return</span>&nbsp;<span class="ident" id="5077472">f</span><span class="op" id="5077473">.</span><span class="ident" id="5077474">applyRelocationsARM64</span><span class="op" id="5077495">(</span><span class="ident" id="5077496">dst</span><span class="op" id="5077499">,</span>&nbsp;<span class="ident" id="5077501">rels</span><span class="op" id="5077505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077508">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077512">return</span>&nbsp;<span class="ident" id="5077519">errors</span><span class="op" id="5077525">.</span><span class="ident" id="5077526">New</span><span class="op" id="5077529">(</span><span class="string" id="5077530">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5077547">)</span><br>
<span class="lineno"></span><span class="op" id="5077549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5077552">func</span>&nbsp;<span class="op" id="5077557">(</span><span class="ident" id="5077558">f</span>&nbsp;<span class="op" id="5077560">*</span><span class="ident" id="5077561">File</span><span class="op" id="5077565">)</span>&nbsp;<span class="ident" id="5077567">applyRelocationsAMD64</span><span class="op" id="5077588">(</span><span class="ident" id="5077589">dst</span>&nbsp;<span class="op" id="5077593">[</span><span class="op" id="5077594">]</span><span class="builtintype" id="5077595">byte</span><span class="op" id="5077599">,</span>&nbsp;<span class="ident" id="5077601">rels</span>&nbsp;<span class="op" id="5077606">[</span><span class="op" id="5077607">]</span><span class="builtintype" id="5077608">byte</span><span class="op" id="5077612">)</span>&nbsp;<span class="builtintype" id="5077614">error</span>&nbsp;<span class="op" id="5077620">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5077623">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077653">if</span>&nbsp;<span class="builtinfunc" id="5077656">len</span><span class="op" id="5077659">(</span><span class="ident" id="5077660">rels</span><span class="op" id="5077664">)</span><span class="op" id="5077665">%</span><span class="num" id="5077666">24</span>&nbsp;<span class="op" id="5077669">!=</span>&nbsp;<span class="num" id="5077672">0</span>&nbsp;<span class="op" id="5077674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077678">return</span>&nbsp;<span class="ident" id="5077685">errors</span><span class="op" id="5077691">.</span><span class="ident" id="5077692">New</span><span class="op" id="5077695">(</span><span class="string" id="5077696">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5077750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077757">symbols</span><span class="op" id="5077764">,</span>&nbsp;<span class="ident" id="5077766">_</span><span class="op" id="5077767">,</span>&nbsp;<span class="ident" id="5077769">err</span>&nbsp;<span class="op" id="5077773">:=</span>&nbsp;<span class="ident" id="5077776">f</span><span class="op" id="5077777">.</span><span class="ident" id="5077778">getSymbols</span><span class="op" id="5077788">(</span><span class="ident" id="5077789">SHT_SYMTAB</span><span class="op" id="5077799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077802">if</span>&nbsp;<span class="ident" id="5077805">err</span>&nbsp;<span class="op" id="5077809">!=</span>&nbsp;<span class="builtintype" id="5077812">nil</span>&nbsp;<span class="op" id="5077816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077820">return</span>&nbsp;<span class="ident" id="5077827">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077836">b</span>&nbsp;<span class="op" id="5077838">:=</span>&nbsp;<span class="ident" id="5077841">bytes</span><span class="op" id="5077846">.</span><span class="ident" id="5077847">NewReader</span><span class="op" id="5077856">(</span><span class="ident" id="5077857">rels</span><span class="op" id="5077861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077864">var</span>&nbsp;<span class="ident" id="5077868">rela</span>&nbsp;<span class="ident" id="5077873">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077882">for</span>&nbsp;<span class="ident" id="5077886">b</span><span class="op" id="5077887">.</span><span class="ident" id="5077888">Len</span><span class="op" id="5077891">(</span><span class="op" id="5077892">)</span>&nbsp;<span class="op" id="5077894">&gt;</span>&nbsp;<span class="num" id="5077896">0</span>&nbsp;<span class="op" id="5077898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077902">binary</span><span class="op" id="5077908">.</span><span class="ident" id="5077909">Read</span><span class="op" id="5077913">(</span><span class="ident" id="5077914">b</span><span class="op" id="5077915">,</span>&nbsp;<span class="ident" id="5077917">f</span><span class="op" id="5077918">.</span><span class="ident" id="5077919">ByteOrder</span><span class="op" id="5077928">,</span>&nbsp;<span class="op" id="5077930">&amp;</span><span class="ident" id="5077931">rela</span><span class="op" id="5077935">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077939">symNo</span>&nbsp;<span class="op" id="5077945">:=</span>&nbsp;<span class="ident" id="5077948">rela</span><span class="op" id="5077952">.</span><span class="ident" id="5077953">Info</span>&nbsp;<span class="op" id="5077958">&gt;&gt;</span>&nbsp;<span class="num" id="5077961">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077966">t</span>&nbsp;<span class="op" id="5077968">:=</span>&nbsp;<span class="ident" id="5077971">R_X86_64</span><span class="op" id="5077979">(</span><span class="ident" id="5077980">rela</span><span class="op" id="5077984">.</span><span class="ident" id="5077985">Info</span>&nbsp;<span class="op" id="5077990">&amp;</span>&nbsp;<span class="num" id="5077992">0xffff</span><span class="op" id="5077998">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078003">if</span>&nbsp;<span class="ident" id="5078006">symNo</span>&nbsp;<span class="op" id="5078012">==</span>&nbsp;<span class="num" id="5078015">0</span>&nbsp;<span class="op" id="5078017">||</span>&nbsp;<span class="ident" id="5078020">symNo</span>&nbsp;<span class="op" id="5078026">&gt;</span>&nbsp;<span class="builtintype" id="5078028">uint64</span><span class="op" id="5078034">(</span><span class="builtinfunc" id="5078035">len</span><span class="op" id="5078038">(</span><span class="ident" id="5078039">symbols</span><span class="op" id="5078046">)</span><span class="op" id="5078047">)</span>&nbsp;<span class="op" id="5078049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078054">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5078065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5078069">sym</span>&nbsp;<span class="op" id="5078073">:=</span>&nbsp;<span class="op" id="5078076">&amp;</span><span class="ident" id="5078077">symbols</span><span class="op" id="5078084">[</span><span class="ident" id="5078085">symNo</span><span class="op" id="5078090">-</span><span class="num" id="5078091">1</span><span class="op" id="5078092">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078096">if</span>&nbsp;<span class="ident" id="5078099">SymType</span><span class="op" id="5078106">(</span><span class="ident" id="5078107">sym</span><span class="op" id="5078110">.</span><span class="ident" id="5078111">Info</span><span class="op" id="5078115">&amp;</span><span class="num" id="5078116">0xf</span><span class="op" id="5078119">)</span>&nbsp;<span class="op" id="5078121">!=</span>&nbsp;<span class="ident" id="5078124">STT_SECTION</span>&nbsp;<span class="op" id="5078136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5078141">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078196">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5078207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5078212">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5078265">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5078320">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078367">switch</span>&nbsp;<span class="ident" id="5078374">t</span>&nbsp;<span class="op" id="5078376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078380">case</span>&nbsp;<span class="ident" id="5078385">R_X86_64_64</span><span class="op" id="5078396">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078401">if</span>&nbsp;<span class="ident" id="5078404">rela</span><span class="op" id="5078408">.</span><span class="ident" id="5078409">Off</span><span class="op" id="5078412">+</span><span class="num" id="5078413">8</span>&nbsp;<span class="op" id="5078415">&gt;=</span>&nbsp;<span class="builtintype" id="5078418">uint64</span><span class="op" id="5078424">(</span><span class="builtinfunc" id="5078425">len</span><span class="op" id="5078428">(</span><span class="ident" id="5078429">dst</span><span class="op" id="5078432">)</span><span class="op" id="5078433">)</span>&nbsp;<span class="op" id="5078435">||</span>&nbsp;<span class="ident" id="5078438">rela</span><span class="op" id="5078442">.</span><span class="ident" id="5078443">Addend</span>&nbsp;<span class="op" id="5078450">&lt;</span>&nbsp;<span class="num" id="5078452">0</span>&nbsp;<span class="op" id="5078454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078460">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5078472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5078477">f</span><span class="op" id="5078478">.</span><span class="ident" id="5078479">ByteOrder</span><span class="op" id="5078488">.</span><span class="ident" id="5078489">PutUint64</span><span class="op" id="5078498">(</span><span class="ident" id="5078499">dst</span><span class="op" id="5078502">[</span><span class="ident" id="5078503">rela</span><span class="op" id="5078507">.</span><span class="ident" id="5078508">Off</span><span class="op" id="5078511">:</span><span class="ident" id="5078512">rela</span><span class="op" id="5078516">.</span><span class="ident" id="5078517">Off</span><span class="op" id="5078520">+</span><span class="num" id="5078521">8</span><span class="op" id="5078522">]</span><span class="op" id="5078523">,</span>&nbsp;<span class="builtintype" id="5078525">uint64</span><span class="op" id="5078531">(</span><span class="ident" id="5078532">rela</span><span class="op" id="5078536">.</span><span class="ident" id="5078537">Addend</span><span class="op" id="5078543">)</span><span class="op" id="5078544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078548">case</span>&nbsp;<span class="ident" id="5078553">R_X86_64_32</span><span class="op" id="5078564">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078569">if</span>&nbsp;<span class="ident" id="5078572">rela</span><span class="op" id="5078576">.</span><span class="ident" id="5078577">Off</span><span class="op" id="5078580">+</span><span class="num" id="5078581">4</span>&nbsp;<span class="op" id="5078583">&gt;=</span>&nbsp;<span class="builtintype" id="5078586">uint64</span><span class="op" id="5078592">(</span><span class="builtinfunc" id="5078593">len</span><span class="op" id="5078596">(</span><span class="ident" id="5078597">dst</span><span class="op" id="5078600">)</span><span class="op" id="5078601">)</span>&nbsp;<span class="op" id="5078603">||</span>&nbsp;<span class="ident" id="5078606">rela</span><span class="op" id="5078610">.</span><span class="ident" id="5078611">Addend</span>&nbsp;<span class="op" id="5078618">&lt;</span>&nbsp;<span class="num" id="5078620">0</span>&nbsp;<span class="op" id="5078622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078628">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5078640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5078645">f</span><span class="op" id="5078646">.</span><span class="ident" id="5078647">ByteOrder</span><span class="op" id="5078656">.</span><span class="ident" id="5078657">PutUint32</span><span class="op" id="5078666">(</span><span class="ident" id="5078667">dst</span><span class="op" id="5078670">[</span><span class="ident" id="5078671">rela</span><span class="op" id="5078675">.</span><span class="ident" id="5078676">Off</span><span class="op" id="5078679">:</span><span class="ident" id="5078680">rela</span><span class="op" id="5078684">.</span><span class="ident" id="5078685">Off</span><span class="op" id="5078688">+</span><span class="num" id="5078689">4</span><span class="op" id="5078690">]</span><span class="op" id="5078691">,</span>&nbsp;<span class="builtintype" id="5078693">uint32</span><span class="op" id="5078699">(</span><span class="ident" id="5078700">rela</span><span class="op" id="5078704">.</span><span class="ident" id="5078705">Addend</span><span class="op" id="5078711">)</span><span class="op" id="5078712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5078716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5078719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078723">return</span>&nbsp;<span class="builtintype" id="5078730">nil</span><br>
<span class="lineno"></span><span class="op" id="5078734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5078737">func</span>&nbsp;<span class="op" id="5078742">(</span><span class="ident" id="5078743">f</span>&nbsp;<span class="op" id="5078745">*</span><span class="ident" id="5078746">File</span><span class="op" id="5078750">)</span>&nbsp;<span class="ident" id="5078752">applyRelocations386</span><span class="op" id="5078771">(</span><span class="ident" id="5078772">dst</span>&nbsp;<span class="op" id="5078776">[</span><span class="op" id="5078777">]</span><span class="builtintype" id="5078778">byte</span><span class="op" id="5078782">,</span>&nbsp;<span class="ident" id="5078784">rels</span>&nbsp;<span class="op" id="5078789">[</span><span class="op" id="5078790">]</span><span class="builtintype" id="5078791">byte</span><span class="op" id="5078795">)</span>&nbsp;<span class="builtintype" id="5078797">error</span>&nbsp;<span class="op" id="5078803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5078806">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078834">if</span>&nbsp;<span class="builtinfunc" id="5078837">len</span><span class="op" id="5078840">(</span><span class="ident" id="5078841">rels</span><span class="op" id="5078845">)</span><span class="op" id="5078846">%</span><span class="num" id="5078847">8</span>&nbsp;<span class="op" id="5078849">!=</span>&nbsp;<span class="num" id="5078852">0</span>&nbsp;<span class="op" id="5078854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078858">return</span>&nbsp;<span class="ident" id="5078865">errors</span><span class="op" id="5078871">.</span><span class="ident" id="5078872">New</span><span class="op" id="5078875">(</span><span class="string" id="5078876">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="5078929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5078932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5078936">symbols</span><span class="op" id="5078943">,</span>&nbsp;<span class="ident" id="5078945">_</span><span class="op" id="5078946">,</span>&nbsp;<span class="ident" id="5078948">err</span>&nbsp;<span class="op" id="5078952">:=</span>&nbsp;<span class="ident" id="5078955">f</span><span class="op" id="5078956">.</span><span class="ident" id="5078957">getSymbols</span><span class="op" id="5078967">(</span><span class="ident" id="5078968">SHT_SYMTAB</span><span class="op" id="5078978">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078981">if</span>&nbsp;<span class="ident" id="5078984">err</span>&nbsp;<span class="op" id="5078988">!=</span>&nbsp;<span class="builtintype" id="5078991">nil</span>&nbsp;<span class="op" id="5078995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078999">return</span>&nbsp;<span class="ident" id="5079006">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5079011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079015">b</span>&nbsp;<span class="op" id="5079017">:=</span>&nbsp;<span class="ident" id="5079020">bytes</span><span class="op" id="5079025">.</span><span class="ident" id="5079026">NewReader</span><span class="op" id="5079035">(</span><span class="ident" id="5079036">rels</span><span class="op" id="5079040">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079043">var</span>&nbsp;<span class="ident" id="5079047">rel</span>&nbsp;<span class="ident" id="5079051">Rel32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079059">for</span>&nbsp;<span class="ident" id="5079063">b</span><span class="op" id="5079064">.</span><span class="ident" id="5079065">Len</span><span class="op" id="5079068">(</span><span class="op" id="5079069">)</span>&nbsp;<span class="op" id="5079071">&gt;</span>&nbsp;<span class="num" id="5079073">0</span>&nbsp;<span class="op" id="5079075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079079">binary</span><span class="op" id="5079085">.</span><span class="ident" id="5079086">Read</span><span class="op" id="5079090">(</span><span class="ident" id="5079091">b</span><span class="op" id="5079092">,</span>&nbsp;<span class="ident" id="5079094">f</span><span class="op" id="5079095">.</span><span class="ident" id="5079096">ByteOrder</span><span class="op" id="5079105">,</span>&nbsp;<span class="op" id="5079107">&amp;</span><span class="ident" id="5079108">rel</span><span class="op" id="5079111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079115">symNo</span>&nbsp;<span class="op" id="5079121">:=</span>&nbsp;<span class="ident" id="5079124">rel</span><span class="op" id="5079127">.</span><span class="ident" id="5079128">Info</span>&nbsp;<span class="op" id="5079133">&gt;&gt;</span>&nbsp;<span class="num" id="5079136">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079140">t</span>&nbsp;<span class="op" id="5079142">:=</span>&nbsp;<span class="ident" id="5079145">R_386</span><span class="op" id="5079150">(</span><span class="ident" id="5079151">rel</span><span class="op" id="5079154">.</span><span class="ident" id="5079155">Info</span>&nbsp;<span class="op" id="5079160">&amp;</span>&nbsp;<span class="num" id="5079162">0xff</span><span class="op" id="5079166">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079171">if</span>&nbsp;<span class="ident" id="5079174">symNo</span>&nbsp;<span class="op" id="5079180">==</span>&nbsp;<span class="num" id="5079183">0</span>&nbsp;<span class="op" id="5079185">||</span>&nbsp;<span class="ident" id="5079188">symNo</span>&nbsp;<span class="op" id="5079194">&gt;</span>&nbsp;<span class="builtintype" id="5079196">uint32</span><span class="op" id="5079202">(</span><span class="builtinfunc" id="5079203">len</span><span class="op" id="5079206">(</span><span class="ident" id="5079207">symbols</span><span class="op" id="5079214">)</span><span class="op" id="5079215">)</span>&nbsp;<span class="op" id="5079217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079222">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5079233">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079237">sym</span>&nbsp;<span class="op" id="5079241">:=</span>&nbsp;<span class="op" id="5079244">&amp;</span><span class="ident" id="5079245">symbols</span><span class="op" id="5079252">[</span><span class="ident" id="5079253">symNo</span><span class="op" id="5079258">-</span><span class="num" id="5079259">1</span><span class="op" id="5079260">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079265">if</span>&nbsp;<span class="ident" id="5079268">t</span>&nbsp;<span class="op" id="5079270">==</span>&nbsp;<span class="ident" id="5079273">R_386_32</span>&nbsp;<span class="op" id="5079282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079287">if</span>&nbsp;<span class="ident" id="5079290">rel</span><span class="op" id="5079293">.</span><span class="ident" id="5079294">Off</span><span class="op" id="5079297">+</span><span class="num" id="5079298">4</span>&nbsp;<span class="op" id="5079300">&gt;=</span>&nbsp;<span class="builtintype" id="5079303">uint32</span><span class="op" id="5079309">(</span><span class="builtinfunc" id="5079310">len</span><span class="op" id="5079313">(</span><span class="ident" id="5079314">dst</span><span class="op" id="5079317">)</span><span class="op" id="5079318">)</span>&nbsp;<span class="op" id="5079320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079326">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5079338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079343">val</span>&nbsp;<span class="op" id="5079347">:=</span>&nbsp;<span class="ident" id="5079350">f</span><span class="op" id="5079351">.</span><span class="ident" id="5079352">ByteOrder</span><span class="op" id="5079361">.</span><span class="ident" id="5079362">Uint32</span><span class="op" id="5079368">(</span><span class="ident" id="5079369">dst</span><span class="op" id="5079372">[</span><span class="ident" id="5079373">rel</span><span class="op" id="5079376">.</span><span class="ident" id="5079377">Off</span>&nbsp;<span class="op" id="5079381">:</span>&nbsp;<span class="ident" id="5079383">rel</span><span class="op" id="5079386">.</span><span class="ident" id="5079387">Off</span><span class="op" id="5079390">+</span><span class="num" id="5079391">4</span><span class="op" id="5079392">]</span><span class="op" id="5079393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079398">val</span>&nbsp;<span class="op" id="5079402">+=</span>&nbsp;<span class="builtintype" id="5079405">uint32</span><span class="op" id="5079411">(</span><span class="ident" id="5079412">sym</span><span class="op" id="5079415">.</span><span class="ident" id="5079416">Value</span><span class="op" id="5079421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079426">f</span><span class="op" id="5079427">.</span><span class="ident" id="5079428">ByteOrder</span><span class="op" id="5079437">.</span><span class="ident" id="5079438">PutUint32</span><span class="op" id="5079447">(</span><span class="ident" id="5079448">dst</span><span class="op" id="5079451">[</span><span class="ident" id="5079452">rel</span><span class="op" id="5079455">.</span><span class="ident" id="5079456">Off</span><span class="op" id="5079459">:</span><span class="ident" id="5079460">rel</span><span class="op" id="5079463">.</span><span class="ident" id="5079464">Off</span><span class="op" id="5079467">+</span><span class="num" id="5079468">4</span><span class="op" id="5079469">]</span><span class="op" id="5079470">,</span>&nbsp;<span class="ident" id="5079472">val</span><span class="op" id="5079475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5079479">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5079482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079486">return</span>&nbsp;<span class="builtintype" id="5079493">nil</span><br>
<span class="lineno"></span><span class="op" id="5079497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="5079500">func</span>&nbsp;<span class="op" id="5079505">(</span><span class="ident" id="5079506">f</span>&nbsp;<span class="op" id="5079508">*</span><span class="ident" id="5079509">File</span><span class="op" id="5079513">)</span>&nbsp;<span class="ident" id="5079515">applyRelocationsARM64</span><span class="op" id="5079536">(</span><span class="ident" id="5079537">dst</span>&nbsp;<span class="op" id="5079541">[</span><span class="op" id="5079542">]</span><span class="builtintype" id="5079543">byte</span><span class="op" id="5079547">,</span>&nbsp;<span class="ident" id="5079549">rels</span>&nbsp;<span class="op" id="5079554">[</span><span class="op" id="5079555">]</span><span class="builtintype" id="5079556">byte</span><span class="op" id="5079560">)</span>&nbsp;<span class="builtintype" id="5079562">error</span>&nbsp;<span class="op" id="5079568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5079571">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079601">if</span>&nbsp;<span class="builtinfunc" id="5079604">len</span><span class="op" id="5079607">(</span><span class="ident" id="5079608">rels</span><span class="op" id="5079612">)</span><span class="op" id="5079613">%</span><span class="num" id="5079614">24</span>&nbsp;<span class="op" id="5079617">!=</span>&nbsp;<span class="num" id="5079620">0</span>&nbsp;<span class="op" id="5079622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079626">return</span>&nbsp;<span class="ident" id="5079633">errors</span><span class="op" id="5079639">.</span><span class="ident" id="5079640">New</span><span class="op" id="5079643">(</span><span class="string" id="5079644">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5079698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5079701">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079705">symbols</span><span class="op" id="5079712">,</span>&nbsp;<span class="ident" id="5079714">_</span><span class="op" id="5079715">,</span>&nbsp;<span class="ident" id="5079717">err</span>&nbsp;<span class="op" id="5079721">:=</span>&nbsp;<span class="ident" id="5079724">f</span><span class="op" id="5079725">.</span><span class="ident" id="5079726">getSymbols</span><span class="op" id="5079736">(</span><span class="ident" id="5079737">SHT_SYMTAB</span><span class="op" id="5079747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079750">if</span>&nbsp;<span class="ident" id="5079753">err</span>&nbsp;<span class="op" id="5079757">!=</span>&nbsp;<span class="builtintype" id="5079760">nil</span>&nbsp;<span class="op" id="5079764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079768">return</span>&nbsp;<span class="ident" id="5079775">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5079780">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079784">b</span>&nbsp;<span class="op" id="5079786">:=</span>&nbsp;<span class="ident" id="5079789">bytes</span><span class="op" id="5079794">.</span><span class="ident" id="5079795">NewReader</span><span class="op" id="5079804">(</span><span class="ident" id="5079805">rels</span><span class="op" id="5079809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079812">var</span>&nbsp;<span class="ident" id="5079816">rela</span>&nbsp;<span class="ident" id="5079821">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079830">for</span>&nbsp;<span class="ident" id="5079834">b</span><span class="op" id="5079835">.</span><span class="ident" id="5079836">Len</span><span class="op" id="5079839">(</span><span class="op" id="5079840">)</span>&nbsp;<span class="op" id="5079842">&gt;</span>&nbsp;<span class="num" id="5079844">0</span>&nbsp;<span class="op" id="5079846">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079850">binary</span><span class="op" id="5079856">.</span><span class="ident" id="5079857">Read</span><span class="op" id="5079861">(</span><span class="ident" id="5079862">b</span><span class="op" id="5079863">,</span>&nbsp;<span class="ident" id="5079865">f</span><span class="op" id="5079866">.</span><span class="ident" id="5079867">ByteOrder</span><span class="op" id="5079876">,</span>&nbsp;<span class="op" id="5079878">&amp;</span><span class="ident" id="5079879">rela</span><span class="op" id="5079883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079887">symNo</span>&nbsp;<span class="op" id="5079893">:=</span>&nbsp;<span class="ident" id="5079896">rela</span><span class="op" id="5079900">.</span><span class="ident" id="5079901">Info</span>&nbsp;<span class="op" id="5079906">&gt;&gt;</span>&nbsp;<span class="num" id="5079909">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079914">t</span>&nbsp;<span class="op" id="5079916">:=</span>&nbsp;<span class="ident" id="5079919">R_AARCH64</span><span class="op" id="5079928">(</span><span class="ident" id="5079929">rela</span><span class="op" id="5079933">.</span><span class="ident" id="5079934">Info</span>&nbsp;<span class="op" id="5079939">&amp;</span>&nbsp;<span class="num" id="5079941">0xffff</span><span class="op" id="5079947">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079952">if</span>&nbsp;<span class="ident" id="5079955">symNo</span>&nbsp;<span class="op" id="5079961">==</span>&nbsp;<span class="num" id="5079964">0</span>&nbsp;<span class="op" id="5079966">||</span>&nbsp;<span class="ident" id="5079969">symNo</span>&nbsp;<span class="op" id="5079975">&gt;</span>&nbsp;<span class="builtintype" id="5079977">uint64</span><span class="op" id="5079983">(</span><span class="builtinfunc" id="5079984">len</span><span class="op" id="5079987">(</span><span class="ident" id="5079988">symbols</span><span class="op" id="5079995">)</span><span class="op" id="5079996">)</span>&nbsp;<span class="op" id="5079998">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080003">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5080014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080018">sym</span>&nbsp;<span class="op" id="5080022">:=</span>&nbsp;<span class="op" id="5080025">&amp;</span><span class="ident" id="5080026">symbols</span><span class="op" id="5080033">[</span><span class="ident" id="5080034">symNo</span><span class="op" id="5080039">-</span><span class="num" id="5080040">1</span><span class="op" id="5080041">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080045">if</span>&nbsp;<span class="ident" id="5080048">SymType</span><span class="op" id="5080055">(</span><span class="ident" id="5080056">sym</span><span class="op" id="5080059">.</span><span class="ident" id="5080060">Info</span><span class="op" id="5080064">&amp;</span><span class="num" id="5080065">0xf</span><span class="op" id="5080068">)</span>&nbsp;<span class="op" id="5080070">!=</span>&nbsp;<span class="ident" id="5080073">STT_SECTION</span>&nbsp;<span class="op" id="5080085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5080090">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080145">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5080156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5080161">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5080214">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5080269">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080316">switch</span>&nbsp;<span class="ident" id="5080323">t</span>&nbsp;<span class="op" id="5080325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080329">case</span>&nbsp;<span class="ident" id="5080334">R_AARCH64_ABS64</span><span class="op" id="5080349">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080354">if</span>&nbsp;<span class="ident" id="5080357">rela</span><span class="op" id="5080361">.</span><span class="ident" id="5080362">Off</span><span class="op" id="5080365">+</span><span class="num" id="5080366">8</span>&nbsp;<span class="op" id="5080368">&gt;=</span>&nbsp;<span class="builtintype" id="5080371">uint64</span><span class="op" id="5080377">(</span><span class="builtinfunc" id="5080378">len</span><span class="op" id="5080381">(</span><span class="ident" id="5080382">dst</span><span class="op" id="5080385">)</span><span class="op" id="5080386">)</span>&nbsp;<span class="op" id="5080388">||</span>&nbsp;<span class="ident" id="5080391">rela</span><span class="op" id="5080395">.</span><span class="ident" id="5080396">Addend</span>&nbsp;<span class="op" id="5080403">&lt;</span>&nbsp;<span class="num" id="5080405">0</span>&nbsp;<span class="op" id="5080407">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080413">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5080425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080430">f</span><span class="op" id="5080431">.</span><span class="ident" id="5080432">ByteOrder</span><span class="op" id="5080441">.</span><span class="ident" id="5080442">PutUint64</span><span class="op" id="5080451">(</span><span class="ident" id="5080452">dst</span><span class="op" id="5080455">[</span><span class="ident" id="5080456">rela</span><span class="op" id="5080460">.</span><span class="ident" id="5080461">Off</span><span class="op" id="5080464">:</span><span class="ident" id="5080465">rela</span><span class="op" id="5080469">.</span><span class="ident" id="5080470">Off</span><span class="op" id="5080473">+</span><span class="num" id="5080474">8</span><span class="op" id="5080475">]</span><span class="op" id="5080476">,</span>&nbsp;<span class="builtintype" id="5080478">uint64</span><span class="op" id="5080484">(</span><span class="ident" id="5080485">rela</span><span class="op" id="5080489">.</span><span class="ident" id="5080490">Addend</span><span class="op" id="5080496">)</span><span class="op" id="5080497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080501">case</span>&nbsp;<span class="ident" id="5080506">R_AARCH64_ABS32</span><span class="op" id="5080521">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080526">if</span>&nbsp;<span class="ident" id="5080529">rela</span><span class="op" id="5080533">.</span><span class="ident" id="5080534">Off</span><span class="op" id="5080537">+</span><span class="num" id="5080538">4</span>&nbsp;<span class="op" id="5080540">&gt;=</span>&nbsp;<span class="builtintype" id="5080543">uint64</span><span class="op" id="5080549">(</span><span class="builtinfunc" id="5080550">len</span><span class="op" id="5080553">(</span><span class="ident" id="5080554">dst</span><span class="op" id="5080557">)</span><span class="op" id="5080558">)</span>&nbsp;<span class="op" id="5080560">||</span>&nbsp;<span class="ident" id="5080563">rela</span><span class="op" id="5080567">.</span><span class="ident" id="5080568">Addend</span>&nbsp;<span class="op" id="5080575">&lt;</span>&nbsp;<span class="num" id="5080577">0</span>&nbsp;<span class="op" id="5080579">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080585">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5080597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080602">f</span><span class="op" id="5080603">.</span><span class="ident" id="5080604">ByteOrder</span><span class="op" id="5080613">.</span><span class="ident" id="5080614">PutUint32</span><span class="op" id="5080623">(</span><span class="ident" id="5080624">dst</span><span class="op" id="5080627">[</span><span class="ident" id="5080628">rela</span><span class="op" id="5080632">.</span><span class="ident" id="5080633">Off</span><span class="op" id="5080636">:</span><span class="ident" id="5080637">rela</span><span class="op" id="5080641">.</span><span class="ident" id="5080642">Off</span><span class="op" id="5080645">+</span><span class="num" id="5080646">4</span><span class="op" id="5080647">]</span><span class="op" id="5080648">,</span>&nbsp;<span class="builtintype" id="5080650">uint32</span><span class="op" id="5080656">(</span><span class="ident" id="5080657">rela</span><span class="op" id="5080661">.</span><span class="ident" id="5080662">Addend</span><span class="op" id="5080668">)</span><span class="op" id="5080669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5080673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5080676">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080680">return</span>&nbsp;<span class="builtintype" id="5080687">nil</span><br>
<span class="lineno"></span><span class="op" id="5080691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5080694">func</span>&nbsp;<span class="op" id="5080699">(</span><span class="ident" id="5080700">f</span>&nbsp;<span class="op" id="5080702">*</span><span class="ident" id="5080703">File</span><span class="op" id="5080707">)</span>&nbsp;<span class="ident" id="5080709">DWARF</span><span class="op" id="5080714">(</span><span class="op" id="5080715">)</span>&nbsp;<span class="op" id="5080717">(</span><span class="op" id="5080718">*</span><span class="ident" id="5080719">dwarf</span><span class="op" id="5080724">.</span><span class="ident" id="5080725">Data</span><span class="op" id="5080729">,</span>&nbsp;<span class="builtintype" id="5080731">error</span><span class="op" id="5080736">)</span>&nbsp;<span class="op" id="5080738">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5080741">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5080792">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5080847">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080906">var</span>&nbsp;<span class="ident" id="5080910">names</span>&nbsp;<span class="op" id="5080916">=</span>&nbsp;<span class="op" id="5080918">[</span><span class="op" id="5080919">...</span><span class="op" id="5080922">]</span><span class="builtintype" id="5080923">string</span><span class="op" id="5080929">{</span><span class="string" id="5080930">&#34;abbrev&#34;</span><span class="op" id="5080938">,</span>&nbsp;<span class="string" id="5080940">&#34;info&#34;</span><span class="op" id="5080946">,</span>&nbsp;<span class="string" id="5080948">&#34;str&#34;</span><span class="op" id="5080953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080956">var</span>&nbsp;<span class="ident" id="5080960">dat</span>&nbsp;<span class="op" id="5080964">[</span><span class="builtinfunc" id="5080965">len</span><span class="op" id="5080968">(</span><span class="ident" id="5080969">names</span><span class="op" id="5080974">)</span><span class="op" id="5080975">]</span><span class="op" id="5080976">[</span><span class="op" id="5080977">]</span><span class="builtintype" id="5080978">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080984">for</span>&nbsp;<span class="ident" id="5080988">i</span><span class="op" id="5080989">,</span>&nbsp;<span class="ident" id="5080991">name</span>&nbsp;<span class="op" id="5080996">:=</span>&nbsp;<span class="keyword" id="5080999">range</span>&nbsp;<span class="ident" id="5081005">names</span>&nbsp;<span class="op" id="5081011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081015">name</span>&nbsp;<span class="op" id="5081020">=</span>&nbsp;<span class="string" id="5081022">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5081032">+</span>&nbsp;<span class="ident" id="5081034">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081041">s</span>&nbsp;<span class="op" id="5081043">:=</span>&nbsp;<span class="ident" id="5081046">f</span><span class="op" id="5081047">.</span><span class="ident" id="5081048">Section</span><span class="op" id="5081055">(</span><span class="ident" id="5081056">name</span><span class="op" id="5081060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081064">if</span>&nbsp;<span class="ident" id="5081067">s</span>&nbsp;<span class="op" id="5081069">==</span>&nbsp;<span class="builtintype" id="5081072">nil</span>&nbsp;<span class="op" id="5081076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081081">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081096">b</span><span class="op" id="5081097">,</span>&nbsp;<span class="ident" id="5081099">err</span>&nbsp;<span class="op" id="5081103">:=</span>&nbsp;<span class="ident" id="5081106">s</span><span class="op" id="5081107">.</span><span class="ident" id="5081108">Data</span><span class="op" id="5081112">(</span><span class="op" id="5081113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081117">if</span>&nbsp;<span class="ident" id="5081120">err</span>&nbsp;<span class="op" id="5081124">!=</span>&nbsp;<span class="builtintype" id="5081127">nil</span>&nbsp;<span class="op" id="5081131">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5081134">uint64</span><span class="op" id="5081140">(</span><span class="builtinfunc" id="5081141">len</span><span class="op" id="5081144">(</span><span class="ident" id="5081145">b</span><span class="op" id="5081146">)</span><span class="op" id="5081147">)</span>&nbsp;<span class="op" id="5081149">&lt;</span>&nbsp;<span class="ident" id="5081151">s</span><span class="op" id="5081152">.</span><span class="ident" id="5081153">Size</span>&nbsp;<span class="op" id="5081158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081163">return</span>&nbsp;<span class="builtintype" id="5081170">nil</span><span class="op" id="5081173">,</span>&nbsp;<span class="ident" id="5081175">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081181">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081185">dat</span><span class="op" id="5081188">[</span><span class="ident" id="5081189">i</span><span class="op" id="5081190">]</span>&nbsp;<span class="op" id="5081192">=</span>&nbsp;<span class="ident" id="5081194">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5081201">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5081274">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081347">rela</span>&nbsp;<span class="op" id="5081352">:=</span>&nbsp;<span class="ident" id="5081355">f</span><span class="op" id="5081356">.</span><span class="ident" id="5081357">Section</span><span class="op" id="5081364">(</span><span class="string" id="5081365">&#34;.rela.debug_info&#34;</span><span class="op" id="5081383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081386">if</span>&nbsp;<span class="ident" id="5081389">rela</span>&nbsp;<span class="op" id="5081394">!=</span>&nbsp;<span class="builtintype" id="5081397">nil</span>&nbsp;<span class="op" id="5081401">&amp;&amp;</span>&nbsp;<span class="ident" id="5081404">rela</span><span class="op" id="5081408">.</span><span class="ident" id="5081409">Type</span>&nbsp;<span class="op" id="5081414">==</span>&nbsp;<span class="ident" id="5081417">SHT_RELA</span>&nbsp;<span class="op" id="5081426">&amp;&amp;</span>&nbsp;<span class="op" id="5081429">(</span><span class="ident" id="5081430">f</span><span class="op" id="5081431">.</span><span class="ident" id="5081432">Machine</span>&nbsp;<span class="op" id="5081440">==</span>&nbsp;<span class="ident" id="5081443">EM_X86_64</span>&nbsp;<span class="op" id="5081453">||</span>&nbsp;<span class="ident" id="5081456">f</span><span class="op" id="5081457">.</span><span class="ident" id="5081458">Machine</span>&nbsp;<span class="op" id="5081466">==</span>&nbsp;<span class="ident" id="5081469">EM_AARCH64</span><span class="op" id="5081479">)</span>&nbsp;<span class="op" id="5081481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081485">data</span><span class="op" id="5081489">,</span>&nbsp;<span class="ident" id="5081491">err</span>&nbsp;<span class="op" id="5081495">:=</span>&nbsp;<span class="ident" id="5081498">rela</span><span class="op" id="5081502">.</span><span class="ident" id="5081503">Data</span><span class="op" id="5081507">(</span><span class="op" id="5081508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081512">if</span>&nbsp;<span class="ident" id="5081515">err</span>&nbsp;<span class="op" id="5081519">!=</span>&nbsp;<span class="builtintype" id="5081522">nil</span>&nbsp;<span class="op" id="5081526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081531">return</span>&nbsp;<span class="builtintype" id="5081538">nil</span><span class="op" id="5081541">,</span>&nbsp;<span class="ident" id="5081543">err</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081553">err</span>&nbsp;<span class="op" id="5081557">=</span>&nbsp;<span class="ident" id="5081559">f</span><span class="op" id="5081560">.</span><span class="ident" id="5081561">applyRelocations</span><span class="op" id="5081577">(</span><span class="ident" id="5081578">dat</span><span class="op" id="5081581">[</span><span class="num" id="5081582">1</span><span class="op" id="5081583">]</span><span class="op" id="5081584">,</span>&nbsp;<span class="ident" id="5081586">data</span><span class="op" id="5081590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081594">if</span>&nbsp;<span class="ident" id="5081597">err</span>&nbsp;<span class="op" id="5081601">!=</span>&nbsp;<span class="builtintype" id="5081604">nil</span>&nbsp;<span class="op" id="5081608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081613">return</span>&nbsp;<span class="builtintype" id="5081620">nil</span><span class="op" id="5081623">,</span>&nbsp;<span class="ident" id="5081625">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081631">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5081638">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081704">rel</span>&nbsp;<span class="op" id="5081708">:=</span>&nbsp;<span class="ident" id="5081711">f</span><span class="op" id="5081712">.</span><span class="ident" id="5081713">Section</span><span class="op" id="5081720">(</span><span class="string" id="5081721">&#34;.rel.debug_info&#34;</span><span class="op" id="5081738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081741">if</span>&nbsp;<span class="ident" id="5081744">rel</span>&nbsp;<span class="op" id="5081748">!=</span>&nbsp;<span class="builtintype" id="5081751">nil</span>&nbsp;<span class="op" id="5081755">&amp;&amp;</span>&nbsp;<span class="ident" id="5081758">rel</span><span class="op" id="5081761">.</span><span class="ident" id="5081762">Type</span>&nbsp;<span class="op" id="5081767">==</span>&nbsp;<span class="ident" id="5081770">SHT_REL</span>&nbsp;<span class="op" id="5081778">&amp;&amp;</span>&nbsp;<span class="ident" id="5081781">f</span><span class="op" id="5081782">.</span><span class="ident" id="5081783">Machine</span>&nbsp;<span class="op" id="5081791">==</span>&nbsp;<span class="ident" id="5081794">EM_386</span>&nbsp;<span class="op" id="5081801">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081805">data</span><span class="op" id="5081809">,</span>&nbsp;<span class="ident" id="5081811">err</span>&nbsp;<span class="op" id="5081815">:=</span>&nbsp;<span class="ident" id="5081818">rel</span><span class="op" id="5081821">.</span><span class="ident" id="5081822">Data</span><span class="op" id="5081826">(</span><span class="op" id="5081827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081831">if</span>&nbsp;<span class="ident" id="5081834">err</span>&nbsp;<span class="op" id="5081838">!=</span>&nbsp;<span class="builtintype" id="5081841">nil</span>&nbsp;<span class="op" id="5081845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081850">return</span>&nbsp;<span class="builtintype" id="5081857">nil</span><span class="op" id="5081860">,</span>&nbsp;<span class="ident" id="5081862">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081872">err</span>&nbsp;<span class="op" id="5081876">=</span>&nbsp;<span class="ident" id="5081878">f</span><span class="op" id="5081879">.</span><span class="ident" id="5081880">applyRelocations</span><span class="op" id="5081896">(</span><span class="ident" id="5081897">dat</span><span class="op" id="5081900">[</span><span class="num" id="5081901">1</span><span class="op" id="5081902">]</span><span class="op" id="5081903">,</span>&nbsp;<span class="ident" id="5081905">data</span><span class="op" id="5081909">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081913">if</span>&nbsp;<span class="ident" id="5081916">err</span>&nbsp;<span class="op" id="5081920">!=</span>&nbsp;<span class="builtintype" id="5081923">nil</span>&nbsp;<span class="op" id="5081927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081932">return</span>&nbsp;<span class="builtintype" id="5081939">nil</span><span class="op" id="5081942">,</span>&nbsp;<span class="ident" id="5081944">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081957">abbrev</span><span class="op" id="5081963">,</span>&nbsp;<span class="ident" id="5081965">info</span><span class="op" id="5081969">,</span>&nbsp;<span class="ident" id="5081971">str</span>&nbsp;<span class="op" id="5081975">:=</span>&nbsp;<span class="ident" id="5081978">dat</span><span class="op" id="5081981">[</span><span class="num" id="5081982">0</span><span class="op" id="5081983">]</span><span class="op" id="5081984">,</span>&nbsp;<span class="ident" id="5081986">dat</span><span class="op" id="5081989">[</span><span class="num" id="5081990">1</span><span class="op" id="5081991">]</span><span class="op" id="5081992">,</span>&nbsp;<span class="ident" id="5081994">dat</span><span class="op" id="5081997">[</span><span class="num" id="5081998">2</span><span class="op" id="5081999">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082002">d</span><span class="op" id="5082003">,</span>&nbsp;<span class="ident" id="5082005">err</span>&nbsp;<span class="op" id="5082009">:=</span>&nbsp;<span class="ident" id="5082012">dwarf</span><span class="op" id="5082017">.</span><span class="ident" id="5082018">New</span><span class="op" id="5082021">(</span><span class="ident" id="5082022">abbrev</span><span class="op" id="5082028">,</span>&nbsp;<span class="builtintype" id="5082030">nil</span><span class="op" id="5082033">,</span>&nbsp;<span class="builtintype" id="5082035">nil</span><span class="op" id="5082038">,</span>&nbsp;<span class="ident" id="5082040">info</span><span class="op" id="5082044">,</span>&nbsp;<span class="builtintype" id="5082046">nil</span><span class="op" id="5082049">,</span>&nbsp;<span class="builtintype" id="5082051">nil</span><span class="op" id="5082054">,</span>&nbsp;<span class="builtintype" id="5082056">nil</span><span class="op" id="5082059">,</span>&nbsp;<span class="ident" id="5082061">str</span><span class="op" id="5082064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082067">if</span>&nbsp;<span class="ident" id="5082070">err</span>&nbsp;<span class="op" id="5082074">!=</span>&nbsp;<span class="builtintype" id="5082077">nil</span>&nbsp;<span class="op" id="5082081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082085">return</span>&nbsp;<span class="builtintype" id="5082092">nil</span><span class="op" id="5082095">,</span>&nbsp;<span class="ident" id="5082097">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082102">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5082106">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082149">for</span>&nbsp;<span class="ident" id="5082153">i</span><span class="op" id="5082154">,</span>&nbsp;<span class="ident" id="5082156">s</span>&nbsp;<span class="op" id="5082158">:=</span>&nbsp;<span class="keyword" id="5082161">range</span>&nbsp;<span class="ident" id="5082167">f</span><span class="op" id="5082168">.</span><span class="ident" id="5082169">Sections</span>&nbsp;<span class="op" id="5082178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082182">if</span>&nbsp;<span class="ident" id="5082185">s</span><span class="op" id="5082186">.</span><span class="ident" id="5082187">Name</span>&nbsp;<span class="op" id="5082192">==</span>&nbsp;<span class="string" id="5082195">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="5082210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082215">b</span><span class="op" id="5082216">,</span>&nbsp;<span class="ident" id="5082218">err</span>&nbsp;<span class="op" id="5082222">:=</span>&nbsp;<span class="ident" id="5082225">s</span><span class="op" id="5082226">.</span><span class="ident" id="5082227">Data</span><span class="op" id="5082231">(</span><span class="op" id="5082232">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082237">if</span>&nbsp;<span class="ident" id="5082240">err</span>&nbsp;<span class="op" id="5082244">!=</span>&nbsp;<span class="builtintype" id="5082247">nil</span>&nbsp;<span class="op" id="5082251">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5082254">uint64</span><span class="op" id="5082260">(</span><span class="builtinfunc" id="5082261">len</span><span class="op" id="5082264">(</span><span class="ident" id="5082265">b</span><span class="op" id="5082266">)</span><span class="op" id="5082267">)</span>&nbsp;<span class="op" id="5082269">&lt;</span>&nbsp;<span class="ident" id="5082271">s</span><span class="op" id="5082272">.</span><span class="ident" id="5082273">Size</span>&nbsp;<span class="op" id="5082278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082284">return</span>&nbsp;<span class="builtintype" id="5082291">nil</span><span class="op" id="5082294">,</span>&nbsp;<span class="ident" id="5082296">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082309">for</span>&nbsp;<span class="ident" id="5082313">_</span><span class="op" id="5082314">,</span>&nbsp;<span class="ident" id="5082316">r</span>&nbsp;<span class="op" id="5082318">:=</span>&nbsp;<span class="keyword" id="5082321">range</span>&nbsp;<span class="ident" id="5082327">f</span><span class="op" id="5082328">.</span><span class="ident" id="5082329">Sections</span>&nbsp;<span class="op" id="5082338">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082344">if</span>&nbsp;<span class="ident" id="5082347">r</span><span class="op" id="5082348">.</span><span class="ident" id="5082349">Type</span>&nbsp;<span class="op" id="5082354">!=</span>&nbsp;<span class="ident" id="5082357">SHT_RELA</span>&nbsp;<span class="op" id="5082366">&amp;&amp;</span>&nbsp;<span class="ident" id="5082369">r</span><span class="op" id="5082370">.</span><span class="ident" id="5082371">Type</span>&nbsp;<span class="op" id="5082376">!=</span>&nbsp;<span class="ident" id="5082379">SHT_REL</span>&nbsp;<span class="op" id="5082387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082394">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082413">if</span>&nbsp;<span class="builtintype" id="5082416">int</span><span class="op" id="5082419">(</span><span class="ident" id="5082420">r</span><span class="op" id="5082421">.</span><span class="ident" id="5082422">Info</span><span class="op" id="5082426">)</span>&nbsp;<span class="op" id="5082428">!=</span>&nbsp;<span class="ident" id="5082431">i</span>&nbsp;<span class="op" id="5082433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082440">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082459">rd</span><span class="op" id="5082461">,</span>&nbsp;<span class="ident" id="5082463">err</span>&nbsp;<span class="op" id="5082467">:=</span>&nbsp;<span class="ident" id="5082470">r</span><span class="op" id="5082471">.</span><span class="ident" id="5082472">Data</span><span class="op" id="5082476">(</span><span class="op" id="5082477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082483">if</span>&nbsp;<span class="ident" id="5082486">err</span>&nbsp;<span class="op" id="5082490">!=</span>&nbsp;<span class="builtintype" id="5082493">nil</span>&nbsp;<span class="op" id="5082497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082504">return</span>&nbsp;<span class="builtintype" id="5082511">nil</span><span class="op" id="5082514">,</span>&nbsp;<span class="ident" id="5082516">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082524">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082530">err</span>&nbsp;<span class="op" id="5082534">=</span>&nbsp;<span class="ident" id="5082536">f</span><span class="op" id="5082537">.</span><span class="ident" id="5082538">applyRelocations</span><span class="op" id="5082554">(</span><span class="ident" id="5082555">b</span><span class="op" id="5082556">,</span>&nbsp;<span class="ident" id="5082558">rd</span><span class="op" id="5082560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082566">if</span>&nbsp;<span class="ident" id="5082569">err</span>&nbsp;<span class="op" id="5082573">!=</span>&nbsp;<span class="builtintype" id="5082576">nil</span>&nbsp;<span class="op" id="5082580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082587">return</span>&nbsp;<span class="builtintype" id="5082594">nil</span><span class="op" id="5082597">,</span>&nbsp;<span class="ident" id="5082599">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082612">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082618">err</span>&nbsp;<span class="op" id="5082622">=</span>&nbsp;<span class="ident" id="5082624">d</span><span class="op" id="5082625">.</span><span class="ident" id="5082626">AddTypes</span><span class="op" id="5082634">(</span><span class="ident" id="5082635">fmt</span><span class="op" id="5082638">.</span><span class="ident" id="5082639">Sprintf</span><span class="op" id="5082646">(</span><span class="string" id="5082647">&#34;types-%d&#34;</span><span class="op" id="5082657">,</span>&nbsp;<span class="ident" id="5082659">i</span><span class="op" id="5082660">)</span><span class="op" id="5082661">,</span>&nbsp;<span class="ident" id="5082663">b</span><span class="op" id="5082664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082669">if</span>&nbsp;<span class="ident" id="5082672">err</span>&nbsp;<span class="op" id="5082676">!=</span>&nbsp;<span class="builtintype" id="5082679">nil</span>&nbsp;<span class="op" id="5082683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082689">return</span>&nbsp;<span class="builtintype" id="5082696">nil</span><span class="op" id="5082699">,</span>&nbsp;<span class="ident" id="5082701">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082708">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082719">return</span>&nbsp;<span class="ident" id="5082726">d</span><span class="op" id="5082727">,</span>&nbsp;<span class="builtintype" id="5082729">nil</span><br>
<span class="lineno"></span><span class="op" id="5082733">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="5082736">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="5082819">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5082840">//</span><br>
<span class="lineno"></span><span class="comment" id="5082843">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="5082919">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5082993">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5083039">func</span>&nbsp;<span class="op" id="5083044">(</span><span class="ident" id="5083045">f</span>&nbsp;<span class="op" id="5083047">*</span><span class="ident" id="5083048">File</span><span class="op" id="5083052">)</span>&nbsp;<span class="ident" id="5083054">Symbols</span><span class="op" id="5083061">(</span><span class="op" id="5083062">)</span>&nbsp;<span class="op" id="5083064">(</span><span class="op" id="5083065">[</span><span class="op" id="5083066">]</span><span class="ident" id="5083067">Symbol</span><span class="op" id="5083073">,</span>&nbsp;<span class="builtintype" id="5083075">error</span><span class="op" id="5083080">)</span>&nbsp;<span class="op" id="5083082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083085">sym</span><span class="op" id="5083088">,</span>&nbsp;<span class="ident" id="5083090">_</span><span class="op" id="5083091">,</span>&nbsp;<span class="ident" id="5083093">err</span>&nbsp;<span class="op" id="5083097">:=</span>&nbsp;<span class="ident" id="5083100">f</span><span class="op" id="5083101">.</span><span class="ident" id="5083102">getSymbols</span><span class="op" id="5083112">(</span><span class="ident" id="5083113">SHT_SYMTAB</span><span class="op" id="5083123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5083126">return</span>&nbsp;<span class="ident" id="5083133">sym</span><span class="op" id="5083136">,</span>&nbsp;<span class="ident" id="5083138">err</span><br>
<span class="lineno">770</span><span class="op" id="5083142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5083145">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5083215">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5083264">//</span><br>
<span class="lineno">775</span><span class="comment" id="5083267">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="5083351">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5083425">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5083471">func</span>&nbsp;<span class="op" id="5083476">(</span><span class="ident" id="5083477">f</span>&nbsp;<span class="op" id="5083479">*</span><span class="ident" id="5083480">File</span><span class="op" id="5083484">)</span>&nbsp;<span class="ident" id="5083486">DynamicSymbols</span><span class="op" id="5083500">(</span><span class="op" id="5083501">)</span>&nbsp;<span class="op" id="5083503">(</span><span class="op" id="5083504">[</span><span class="op" id="5083505">]</span><span class="ident" id="5083506">Symbol</span><span class="op" id="5083512">,</span>&nbsp;<span class="builtintype" id="5083514">error</span><span class="op" id="5083519">)</span>&nbsp;<span class="op" id="5083521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083524">sym</span><span class="op" id="5083527">,</span>&nbsp;<span class="ident" id="5083529">_</span><span class="op" id="5083530">,</span>&nbsp;<span class="ident" id="5083532">err</span>&nbsp;<span class="op" id="5083536">:=</span>&nbsp;<span class="ident" id="5083539">f</span><span class="op" id="5083540">.</span><span class="ident" id="5083541">getSymbols</span><span class="op" id="5083551">(</span><span class="ident" id="5083552">SHT_DYNSYM</span><span class="op" id="5083562">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5083565">return</span>&nbsp;<span class="ident" id="5083572">sym</span><span class="op" id="5083575">,</span>&nbsp;<span class="ident" id="5083577">err</span><br>
<span class="lineno"></span><span class="op" id="5083581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5083584">type</span>&nbsp;<span class="ident" id="5083589">ImportedSymbol</span>&nbsp;<span class="keyword" id="5083604">struct</span>&nbsp;<span class="op" id="5083611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083614">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5083622">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083630">Version</span>&nbsp;<span class="builtintype" id="5083638">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083646">Library</span>&nbsp;<span class="builtintype" id="5083654">string</span><br>
<span class="lineno"></span><span class="op" id="5083661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5083664">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="5083716">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5083771">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5083825">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5083861">func</span>&nbsp;<span class="op" id="5083866">(</span><span class="ident" id="5083867">f</span>&nbsp;<span class="op" id="5083869">*</span><span class="ident" id="5083870">File</span><span class="op" id="5083874">)</span>&nbsp;<span class="ident" id="5083876">ImportedSymbols</span><span class="op" id="5083891">(</span><span class="op" id="5083892">)</span>&nbsp;<span class="op" id="5083894">(</span><span class="op" id="5083895">[</span><span class="op" id="5083896">]</span><span class="ident" id="5083897">ImportedSymbol</span><span class="op" id="5083911">,</span>&nbsp;<span class="builtintype" id="5083913">error</span><span class="op" id="5083918">)</span>&nbsp;<span class="op" id="5083920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083923">sym</span><span class="op" id="5083926">,</span>&nbsp;<span class="ident" id="5083928">str</span><span class="op" id="5083931">,</span>&nbsp;<span class="ident" id="5083933">err</span>&nbsp;<span class="op" id="5083937">:=</span>&nbsp;<span class="ident" id="5083940">f</span><span class="op" id="5083941">.</span><span class="ident" id="5083942">getSymbols</span><span class="op" id="5083952">(</span><span class="ident" id="5083953">SHT_DYNSYM</span><span class="op" id="5083963">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5083966">if</span>&nbsp;<span class="ident" id="5083969">err</span>&nbsp;<span class="op" id="5083973">!=</span>&nbsp;<span class="builtintype" id="5083976">nil</span>&nbsp;<span class="op" id="5083980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5083984">return</span>&nbsp;<span class="builtintype" id="5083991">nil</span><span class="op" id="5083994">,</span>&nbsp;<span class="ident" id="5083996">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5084001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084004">f</span><span class="op" id="5084005">.</span><span class="ident" id="5084006">gnuVersionInit</span><span class="op" id="5084020">(</span><span class="ident" id="5084021">str</span><span class="op" id="5084024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084027">var</span>&nbsp;<span class="ident" id="5084031">all</span>&nbsp;<span class="op" id="5084035">[</span><span class="op" id="5084036">]</span><span class="ident" id="5084037">ImportedSymbol</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084053">for</span>&nbsp;<span class="ident" id="5084057">i</span><span class="op" id="5084058">,</span>&nbsp;<span class="ident" id="5084060">s</span>&nbsp;<span class="op" id="5084062">:=</span>&nbsp;<span class="keyword" id="5084065">range</span>&nbsp;<span class="ident" id="5084071">sym</span>&nbsp;<span class="op" id="5084075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084079">if</span>&nbsp;<span class="ident" id="5084082">ST_BIND</span><span class="op" id="5084089">(</span><span class="ident" id="5084090">s</span><span class="op" id="5084091">.</span><span class="ident" id="5084092">Info</span><span class="op" id="5084096">)</span>&nbsp;<span class="op" id="5084098">==</span>&nbsp;<span class="ident" id="5084101">STB_GLOBAL</span>&nbsp;<span class="op" id="5084112">&amp;&amp;</span>&nbsp;<span class="ident" id="5084115">s</span><span class="op" id="5084116">.</span><span class="ident" id="5084117">Section</span>&nbsp;<span class="op" id="5084125">==</span>&nbsp;<span class="ident" id="5084128">SHN_UNDEF</span>&nbsp;<span class="op" id="5084138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084143">all</span>&nbsp;<span class="op" id="5084147">=</span>&nbsp;<span class="builtinfunc" id="5084149">append</span><span class="op" id="5084155">(</span><span class="ident" id="5084156">all</span><span class="op" id="5084159">,</span>&nbsp;<span class="ident" id="5084161">ImportedSymbol</span><span class="op" id="5084175">{</span><span class="ident" id="5084176">Name</span><span class="op" id="5084180">:</span>&nbsp;<span class="ident" id="5084182">s</span><span class="op" id="5084183">.</span><span class="ident" id="5084184">Name</span><span class="op" id="5084188">}</span><span class="op" id="5084189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084194">f</span><span class="op" id="5084195">.</span><span class="ident" id="5084196">gnuVersion</span><span class="op" id="5084206">(</span><span class="ident" id="5084207">i</span><span class="op" id="5084208">,</span>&nbsp;<span class="op" id="5084210">&amp;</span><span class="ident" id="5084211">all</span><span class="op" id="5084214">[</span><span class="builtinfunc" id="5084215">len</span><span class="op" id="5084218">(</span><span class="ident" id="5084219">all</span><span class="op" id="5084222">)</span><span class="op" id="5084223">-</span><span class="num" id="5084224">1</span><span class="op" id="5084225">]</span><span class="op" id="5084226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5084230">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5084233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084236">return</span>&nbsp;<span class="ident" id="5084243">all</span><span class="op" id="5084246">,</span>&nbsp;<span class="builtintype" id="5084248">nil</span><br>
<span class="lineno"></span><span class="op" id="5084252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5084255">type</span>&nbsp;<span class="ident" id="5084260">verneed</span>&nbsp;<span class="keyword" id="5084268">struct</span>&nbsp;<span class="op" id="5084275">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084278">File</span>&nbsp;<span class="builtintype" id="5084283">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084291">Name</span>&nbsp;<span class="builtintype" id="5084296">string</span><br>
<span class="lineno"></span><span class="op" id="5084303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5084306">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="5084354">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="5084389">func</span>&nbsp;<span class="op" id="5084394">(</span><span class="ident" id="5084395">f</span>&nbsp;<span class="op" id="5084397">*</span><span class="ident" id="5084398">File</span><span class="op" id="5084402">)</span>&nbsp;<span class="ident" id="5084404">gnuVersionInit</span><span class="op" id="5084418">(</span><span class="ident" id="5084419">str</span>&nbsp;<span class="op" id="5084423">[</span><span class="op" id="5084424">]</span><span class="builtintype" id="5084425">byte</span><span class="op" id="5084429">)</span>&nbsp;<span class="op" id="5084431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5084434">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084470">vn</span>&nbsp;<span class="op" id="5084473">:=</span>&nbsp;<span class="ident" id="5084476">f</span><span class="op" id="5084477">.</span><span class="ident" id="5084478">SectionByType</span><span class="op" id="5084491">(</span><span class="ident" id="5084492">SHT_GNU_VERNEED</span><span class="op" id="5084507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084510">if</span>&nbsp;<span class="ident" id="5084513">vn</span>&nbsp;<span class="op" id="5084516">==</span>&nbsp;<span class="builtintype" id="5084519">nil</span>&nbsp;<span class="op" id="5084523">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084527">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5084535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084538">d</span><span class="op" id="5084539">,</span>&nbsp;<span class="ident" id="5084541">_</span>&nbsp;<span class="op" id="5084543">:=</span>&nbsp;<span class="ident" id="5084546">vn</span><span class="op" id="5084548">.</span><span class="ident" id="5084549">Data</span><span class="op" id="5084553">(</span><span class="op" id="5084554">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084558">var</span>&nbsp;<span class="ident" id="5084562">need</span>&nbsp;<span class="op" id="5084567">[</span><span class="op" id="5084568">]</span><span class="ident" id="5084569">verneed</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084578">i</span>&nbsp;<span class="op" id="5084580">:=</span>&nbsp;<span class="num" id="5084583">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084586">for</span>&nbsp;<span class="op" id="5084590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084594">if</span>&nbsp;<span class="ident" id="5084597">i</span><span class="op" id="5084598">+</span><span class="num" id="5084599">16</span>&nbsp;<span class="op" id="5084602">&gt;</span>&nbsp;<span class="builtinfunc" id="5084604">len</span><span class="op" id="5084607">(</span><span class="ident" id="5084608">d</span><span class="op" id="5084609">)</span>&nbsp;<span class="op" id="5084611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084616">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5084624">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084628">vers</span>&nbsp;<span class="op" id="5084633">:=</span>&nbsp;<span class="ident" id="5084636">f</span><span class="op" id="5084637">.</span><span class="ident" id="5084638">ByteOrder</span><span class="op" id="5084647">.</span><span class="ident" id="5084648">Uint16</span><span class="op" id="5084654">(</span><span class="ident" id="5084655">d</span><span class="op" id="5084656">[</span><span class="ident" id="5084657">i</span>&nbsp;<span class="op" id="5084659">:</span>&nbsp;<span class="ident" id="5084661">i</span><span class="op" id="5084662">+</span><span class="num" id="5084663">2</span><span class="op" id="5084664">]</span><span class="op" id="5084665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084669">if</span>&nbsp;<span class="ident" id="5084672">vers</span>&nbsp;<span class="op" id="5084677">!=</span>&nbsp;<span class="num" id="5084680">1</span>&nbsp;<span class="op" id="5084682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084687">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5084695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084699">cnt</span>&nbsp;<span class="op" id="5084703">:=</span>&nbsp;<span class="ident" id="5084706">f</span><span class="op" id="5084707">.</span><span class="ident" id="5084708">ByteOrder</span><span class="op" id="5084717">.</span><span class="ident" id="5084718">Uint16</span><span class="op" id="5084724">(</span><span class="ident" id="5084725">d</span><span class="op" id="5084726">[</span><span class="ident" id="5084727">i</span><span class="op" id="5084728">+</span><span class="num" id="5084729">2</span>&nbsp;<span class="op" id="5084731">:</span>&nbsp;<span class="ident" id="5084733">i</span><span class="op" id="5084734">+</span><span class="num" id="5084735">4</span><span class="op" id="5084736">]</span><span class="op" id="5084737">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084741">fileoff</span>&nbsp;<span class="op" id="5084749">:=</span>&nbsp;<span class="ident" id="5084752">f</span><span class="op" id="5084753">.</span><span class="ident" id="5084754">ByteOrder</span><span class="op" id="5084763">.</span><span class="ident" id="5084764">Uint32</span><span class="op" id="5084770">(</span><span class="ident" id="5084771">d</span><span class="op" id="5084772">[</span><span class="ident" id="5084773">i</span><span class="op" id="5084774">+</span><span class="num" id="5084775">4</span>&nbsp;<span class="op" id="5084777">:</span>&nbsp;<span class="ident" id="5084779">i</span><span class="op" id="5084780">+</span><span class="num" id="5084781">8</span><span class="op" id="5084782">]</span><span class="op" id="5084783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084787">aux</span>&nbsp;<span class="op" id="5084791">:=</span>&nbsp;<span class="ident" id="5084794">f</span><span class="op" id="5084795">.</span><span class="ident" id="5084796">ByteOrder</span><span class="op" id="5084805">.</span><span class="ident" id="5084806">Uint32</span><span class="op" id="5084812">(</span><span class="ident" id="5084813">d</span><span class="op" id="5084814">[</span><span class="ident" id="5084815">i</span><span class="op" id="5084816">+</span><span class="num" id="5084817">8</span>&nbsp;<span class="op" id="5084819">:</span>&nbsp;<span class="ident" id="5084821">i</span><span class="op" id="5084822">+</span><span class="num" id="5084823">12</span><span class="op" id="5084825">]</span><span class="op" id="5084826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084830">next</span>&nbsp;<span class="op" id="5084835">:=</span>&nbsp;<span class="ident" id="5084838">f</span><span class="op" id="5084839">.</span><span class="ident" id="5084840">ByteOrder</span><span class="op" id="5084849">.</span><span class="ident" id="5084850">Uint32</span><span class="op" id="5084856">(</span><span class="ident" id="5084857">d</span><span class="op" id="5084858">[</span><span class="ident" id="5084859">i</span><span class="op" id="5084860">+</span><span class="num" id="5084861">12</span>&nbsp;<span class="op" id="5084864">:</span>&nbsp;<span class="ident" id="5084866">i</span><span class="op" id="5084867">+</span><span class="num" id="5084868">16</span><span class="op" id="5084870">]</span><span class="op" id="5084871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084875">file</span><span class="op" id="5084879">,</span>&nbsp;<span class="ident" id="5084881">_</span>&nbsp;<span class="op" id="5084883">:=</span>&nbsp;<span class="ident" id="5084886">getString</span><span class="op" id="5084895">(</span><span class="ident" id="5084896">str</span><span class="op" id="5084899">,</span>&nbsp;<span class="builtintype" id="5084901">int</span><span class="op" id="5084904">(</span><span class="ident" id="5084905">fileoff</span><span class="op" id="5084912">)</span><span class="op" id="5084913">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084918">var</span>&nbsp;<span class="ident" id="5084922">name</span>&nbsp;<span class="builtintype" id="5084927">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5084936">j</span>&nbsp;<span class="op" id="5084938">:=</span>&nbsp;<span class="ident" id="5084941">i</span>&nbsp;<span class="op" id="5084943">+</span>&nbsp;<span class="builtintype" id="5084945">int</span><span class="op" id="5084948">(</span><span class="ident" id="5084949">aux</span><span class="op" id="5084952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084956">for</span>&nbsp;<span class="ident" id="5084960">c</span>&nbsp;<span class="op" id="5084962">:=</span>&nbsp;<span class="num" id="5084965">0</span><span class="op" id="5084966">;</span>&nbsp;<span class="ident" id="5084968">c</span>&nbsp;<span class="op" id="5084970">&lt;</span>&nbsp;<span class="builtintype" id="5084972">int</span><span class="op" id="5084975">(</span><span class="ident" id="5084976">cnt</span><span class="op" id="5084979">)</span><span class="op" id="5084980">;</span>&nbsp;<span class="ident" id="5084982">c</span><span class="op" id="5084983">++</span>&nbsp;<span class="op" id="5084986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5084991">if</span>&nbsp;<span class="ident" id="5084994">j</span><span class="op" id="5084995">+</span><span class="num" id="5084996">16</span>&nbsp;<span class="op" id="5084999">&gt;</span>&nbsp;<span class="builtinfunc" id="5085001">len</span><span class="op" id="5085004">(</span><span class="ident" id="5085005">d</span><span class="op" id="5085006">)</span>&nbsp;<span class="op" id="5085008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5085014">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5085023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5085028">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5085071">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085117">other</span>&nbsp;<span class="op" id="5085123">:=</span>&nbsp;<span class="ident" id="5085126">f</span><span class="op" id="5085127">.</span><span class="ident" id="5085128">ByteOrder</span><span class="op" id="5085137">.</span><span class="ident" id="5085138">Uint16</span><span class="op" id="5085144">(</span><span class="ident" id="5085145">d</span><span class="op" id="5085146">[</span><span class="ident" id="5085147">j</span><span class="op" id="5085148">+</span><span class="num" id="5085149">6</span>&nbsp;<span class="op" id="5085151">:</span>&nbsp;<span class="ident" id="5085153">j</span><span class="op" id="5085154">+</span><span class="num" id="5085155">8</span><span class="op" id="5085156">]</span><span class="op" id="5085157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085162">nameoff</span>&nbsp;<span class="op" id="5085170">:=</span>&nbsp;<span class="ident" id="5085173">f</span><span class="op" id="5085174">.</span><span class="ident" id="5085175">ByteOrder</span><span class="op" id="5085184">.</span><span class="ident" id="5085185">Uint32</span><span class="op" id="5085191">(</span><span class="ident" id="5085192">d</span><span class="op" id="5085193">[</span><span class="ident" id="5085194">j</span><span class="op" id="5085195">+</span><span class="num" id="5085196">8</span>&nbsp;<span class="op" id="5085198">:</span>&nbsp;<span class="ident" id="5085200">j</span><span class="op" id="5085201">+</span><span class="num" id="5085202">12</span><span class="op" id="5085204">]</span><span class="op" id="5085205">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085210">next</span>&nbsp;<span class="op" id="5085215">:=</span>&nbsp;<span class="ident" id="5085218">f</span><span class="op" id="5085219">.</span><span class="ident" id="5085220">ByteOrder</span><span class="op" id="5085229">.</span><span class="ident" id="5085230">Uint32</span><span class="op" id="5085236">(</span><span class="ident" id="5085237">d</span><span class="op" id="5085238">[</span><span class="ident" id="5085239">j</span><span class="op" id="5085240">+</span><span class="num" id="5085241">12</span>&nbsp;<span class="op" id="5085244">:</span>&nbsp;<span class="ident" id="5085246">j</span><span class="op" id="5085247">+</span><span class="num" id="5085248">16</span><span class="op" id="5085250">]</span><span class="op" id="5085251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085256">name</span><span class="op" id="5085260">,</span>&nbsp;<span class="ident" id="5085262">_</span>&nbsp;<span class="op" id="5085264">=</span>&nbsp;<span class="ident" id="5085266">getString</span><span class="op" id="5085275">(</span><span class="ident" id="5085276">str</span><span class="op" id="5085279">,</span>&nbsp;<span class="builtintype" id="5085281">int</span><span class="op" id="5085284">(</span><span class="ident" id="5085285">nameoff</span><span class="op" id="5085292">)</span><span class="op" id="5085293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085298">ndx</span>&nbsp;<span class="op" id="5085302">:=</span>&nbsp;<span class="builtintype" id="5085305">int</span><span class="op" id="5085308">(</span><span class="ident" id="5085309">other</span><span class="op" id="5085314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5085319">if</span>&nbsp;<span class="ident" id="5085322">ndx</span>&nbsp;<span class="op" id="5085326">&gt;=</span>&nbsp;<span class="builtinfunc" id="5085329">len</span><span class="op" id="5085332">(</span><span class="ident" id="5085333">need</span><span class="op" id="5085337">)</span>&nbsp;<span class="op" id="5085339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085345">a</span>&nbsp;<span class="op" id="5085347">:=</span>&nbsp;<span class="builtinfunc" id="5085350">make</span><span class="op" id="5085354">(</span><span class="op" id="5085355">[</span><span class="op" id="5085356">]</span><span class="ident" id="5085357">verneed</span><span class="op" id="5085364">,</span>&nbsp;<span class="num" id="5085366">2</span><span class="op" id="5085367">*</span><span class="op" id="5085368">(</span><span class="ident" id="5085369">ndx</span><span class="op" id="5085372">+</span><span class="num" id="5085373">1</span><span class="op" id="5085374">)</span><span class="op" id="5085375">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5085381">copy</span><span class="op" id="5085385">(</span><span class="ident" id="5085386">a</span><span class="op" id="5085387">,</span>&nbsp;<span class="ident" id="5085389">need</span><span class="op" id="5085393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085399">need</span>&nbsp;<span class="op" id="5085404">=</span>&nbsp;<span class="ident" id="5085406">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5085411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085417">need</span><span class="op" id="5085421">[</span><span class="ident" id="5085422">ndx</span><span class="op" id="5085425">]</span>&nbsp;<span class="op" id="5085427">=</span>&nbsp;<span class="ident" id="5085429">verneed</span><span class="op" id="5085436">{</span><span class="ident" id="5085437">file</span><span class="op" id="5085441">,</span>&nbsp;<span class="ident" id="5085443">name</span><span class="op" id="5085447">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5085452">if</span>&nbsp;<span class="ident" id="5085455">next</span>&nbsp;<span class="op" id="5085460">==</span>&nbsp;<span class="num" id="5085463">0</span>&nbsp;<span class="op" id="5085465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5085471">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5085480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085485">j</span>&nbsp;<span class="op" id="5085487">+=</span>&nbsp;<span class="builtintype" id="5085490">int</span><span class="op" id="5085493">(</span><span class="ident" id="5085494">next</span><span class="op" id="5085498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5085502">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5085507">if</span>&nbsp;<span class="ident" id="5085510">next</span>&nbsp;<span class="op" id="5085515">==</span>&nbsp;<span class="num" id="5085518">0</span>&nbsp;<span class="op" id="5085520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5085525">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5085533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085537">i</span>&nbsp;<span class="op" id="5085539">+=</span>&nbsp;<span class="builtintype" id="5085542">int</span><span class="op" id="5085545">(</span><span class="ident" id="5085546">next</span><span class="op" id="5085550">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5085553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5085557">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085615">vs</span>&nbsp;<span class="op" id="5085618">:=</span>&nbsp;<span class="ident" id="5085621">f</span><span class="op" id="5085622">.</span><span class="ident" id="5085623">SectionByType</span><span class="op" id="5085636">(</span><span class="ident" id="5085637">SHT_GNU_VERSYM</span><span class="op" id="5085651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5085654">if</span>&nbsp;<span class="ident" id="5085657">vs</span>&nbsp;<span class="op" id="5085660">==</span>&nbsp;<span class="builtintype" id="5085663">nil</span>&nbsp;<span class="op" id="5085667">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5085671">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5085679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085682">d</span><span class="op" id="5085683">,</span>&nbsp;<span class="ident" id="5085685">_</span>&nbsp;<span class="op" id="5085687">=</span>&nbsp;<span class="ident" id="5085689">vs</span><span class="op" id="5085691">.</span><span class="ident" id="5085692">Data</span><span class="op" id="5085696">(</span><span class="op" id="5085697">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085701">f</span><span class="op" id="5085702">.</span><span class="ident" id="5085703">gnuNeed</span>&nbsp;<span class="op" id="5085711">=</span>&nbsp;<span class="ident" id="5085713">need</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085719">f</span><span class="op" id="5085720">.</span><span class="ident" id="5085721">gnuVersym</span>&nbsp;<span class="op" id="5085731">=</span>&nbsp;<span class="ident" id="5085733">d</span><br>
<span class="lineno"></span><span class="op" id="5085735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5085738">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="5085797">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="5085846">func</span>&nbsp;<span class="op" id="5085851">(</span><span class="ident" id="5085852">f</span>&nbsp;<span class="op" id="5085854">*</span><span class="ident" id="5085855">File</span><span class="op" id="5085859">)</span>&nbsp;<span class="ident" id="5085861">gnuVersion</span><span class="op" id="5085871">(</span><span class="ident" id="5085872">i</span>&nbsp;<span class="builtintype" id="5085874">int</span><span class="op" id="5085877">,</span>&nbsp;<span class="ident" id="5085879">sym</span>&nbsp;<span class="op" id="5085883">*</span><span class="ident" id="5085884">ImportedSymbol</span><span class="op" id="5085898">)</span>&nbsp;<span class="op" id="5085900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5085903">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085932">i</span>&nbsp;<span class="op" id="5085934">=</span>&nbsp;<span class="op" id="5085936">(</span><span class="ident" id="5085937">i</span>&nbsp;<span class="op" id="5085939">+</span>&nbsp;<span class="num" id="5085941">1</span><span class="op" id="5085942">)</span>&nbsp;<span class="op" id="5085944">*</span>&nbsp;<span class="num" id="5085946">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5085949">if</span>&nbsp;<span class="ident" id="5085952">i</span>&nbsp;<span class="op" id="5085954">&gt;=</span>&nbsp;<span class="builtinfunc" id="5085957">len</span><span class="op" id="5085960">(</span><span class="ident" id="5085961">f</span><span class="op" id="5085962">.</span><span class="ident" id="5085963">gnuVersym</span><span class="op" id="5085972">)</span>&nbsp;<span class="op" id="5085974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5085978">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5085986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5085989">j</span>&nbsp;<span class="op" id="5085991">:=</span>&nbsp;<span class="builtintype" id="5085994">int</span><span class="op" id="5085997">(</span><span class="ident" id="5085998">f</span><span class="op" id="5085999">.</span><span class="ident" id="5086000">ByteOrder</span><span class="op" id="5086009">.</span><span class="ident" id="5086010">Uint16</span><span class="op" id="5086016">(</span><span class="ident" id="5086017">f</span><span class="op" id="5086018">.</span><span class="ident" id="5086019">gnuVersym</span><span class="op" id="5086028">[</span><span class="ident" id="5086029">i</span><span class="op" id="5086030">:</span><span class="op" id="5086031">]</span><span class="op" id="5086032">)</span><span class="op" id="5086033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5086036">if</span>&nbsp;<span class="ident" id="5086039">j</span>&nbsp;<span class="op" id="5086041">&lt;</span>&nbsp;<span class="num" id="5086043">2</span>&nbsp;<span class="op" id="5086045">||</span>&nbsp;<span class="ident" id="5086048">j</span>&nbsp;<span class="op" id="5086050">&gt;=</span>&nbsp;<span class="builtinfunc" id="5086053">len</span><span class="op" id="5086056">(</span><span class="ident" id="5086057">f</span><span class="op" id="5086058">.</span><span class="ident" id="5086059">gnuNeed</span><span class="op" id="5086066">)</span>&nbsp;<span class="op" id="5086068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5086072">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5086080">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5086083">n</span>&nbsp;<span class="op" id="5086085">:=</span>&nbsp;<span class="op" id="5086088">&amp;</span><span class="ident" id="5086089">f</span><span class="op" id="5086090">.</span><span class="ident" id="5086091">gnuNeed</span><span class="op" id="5086098">[</span><span class="ident" id="5086099">j</span><span class="op" id="5086100">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5086103">sym</span><span class="op" id="5086106">.</span><span class="ident" id="5086107">Library</span>&nbsp;<span class="op" id="5086115">=</span>&nbsp;<span class="ident" id="5086117">n</span><span class="op" id="5086118">.</span><span class="ident" id="5086119">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5086125">sym</span><span class="op" id="5086128">.</span><span class="ident" id="5086129">Version</span>&nbsp;<span class="op" id="5086137">=</span>&nbsp;<span class="ident" id="5086139">n</span><span class="op" id="5086140">.</span><span class="ident" id="5086141">Name</span><br>
<span class="lineno"></span><span class="op" id="5086146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5086149">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5086205">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5086260">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="5086308">func</span>&nbsp;<span class="op" id="5086313">(</span><span class="ident" id="5086314">f</span>&nbsp;<span class="op" id="5086316">*</span><span class="ident" id="5086317">File</span><span class="op" id="5086321">)</span>&nbsp;<span class="ident" id="5086323">ImportedLibraries</span><span class="op" id="5086340">(</span><span class="op" id="5086341">)</span>&nbsp;<span class="op" id="5086343">(</span><span class="op" id="5086344">[</span><span class="op" id="5086345">]</span><span class="builtintype" id="5086346">string</span><span class="op" id="5086352">,</span>&nbsp;<span class="builtintype" id="5086354">error</span><span class="op" id="5086359">)</span>&nbsp;<span class="op" id="5086361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5086364">return</span>&nbsp;<span class="ident" id="5086371">f</span><span class="op" id="5086372">.</span><span class="ident" id="5086373">DynString</span><span class="op" id="5086382">(</span><span class="ident" id="5086383">DT_NEEDED</span><span class="op" id="5086392">)</span><br>
<span class="lineno">905</span><span class="op" id="5086394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5086397">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="5086477">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="5086489">//</span><br>
<span class="lineno">910</span><span class="comment" id="5086492">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5086576">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="5086591">func</span>&nbsp;<span class="op" id="5086596">(</span><span class="ident" id="5086597">f</span>&nbsp;<span class="op" id="5086599">*</span><span class="ident" id="5086600">File</span><span class="op" id="5086604">)</span>&nbsp;<span class="ident" id="5086606">DynString</span><span class="op" id="5086615">(</span><span class="ident" id="5086616">tag</span>&nbsp;<span class="ident" id="5086620">DynTag</span><span class="op" id="5086626">)</span>&nbsp;<span class="op" id="5086628">(</span><span class="op" id="5086629">[</span><span class="op" id="5086630">]</span><span class="builtintype" id="5086631">string</span><span class="op" id="5086637">,</span>&nbsp;<span class="builtintype" id="5086639">error</span><span class="op" id="5086644">)</span>&nbsp;<span class="op" id="5086646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5086649">switch</span>&nbsp;<span class="ident" id="5086656">tag</span>&nbsp;<span class="op" id="5086660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5086663">case</span>&nbsp;<span class="ident" id="5086668">DT_NEEDED</span><span class="op" id="5086677">,</span>&nbsp;<span class="ident" id="5086679">DT_SONAME</span><span class="op" id="5086688">,</span>&nbsp;<span class="ident" id="5086690">DT_RPATH</span><span class="op" id="5086698">,</span>&nbsp;<span class="ident" id="5086700">DT_RUNPATH</span><span class="op" id="5086710">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5086713">default</span><span class="op" id="5086720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5086724">return</span>&nbsp;<span class="builtintype" id="5086731">nil</span><span class="op" id="5086734">,</span>&nbsp;<span class="ident" id="5086736">fmt</span><span class="op" id="5086739">.</span><span class="ident" id="5086740">Errorf</span><span class="op" id="5086746">(</span><span class="string" id="5086747">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="5086773">,</span>&nbsp;<span class="ident" id="5086775">tag</span><span class="op" id="5086778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5086781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5086784">ds</span>&nbsp;<span class="op" id="5086787">:=</span>&nbsp;<span class="ident" id="5086790">f</span><span class="op" id="5086791">.</span><span class="ident" id="5086792">SectionByType</span><span class="op" id="5086805">(</span><span class="ident" id="5086806">SHT_DYNAMIC</span><span class="op" id="5086817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5086820">if</span>&nbsp;<span class="ident" id="5086823">ds</span>&nbsp;<span class="op" id="5086826">==</span>&nbsp;<span class="builtintype" id="5086829">nil</span>&nbsp;<span class="op" id="5086833">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5086837">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5086871">return</span>&nbsp;<span class="builtintype" id="5086878">nil</span><span class="op" id="5086881">,</span>&nbsp;<span class="builtintype" id="5086883">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5086888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5086891">d</span><span class="op" id="5086892">,</span>&nbsp;<span class="ident" id="5086894">err</span>&nbsp;<span class="op" id="5086898">:=</span>&nbsp;<span class="ident" id="5086901">ds</span><span class="op" id="5086903">.</span><span class="ident" id="5086904">Data</span><span class="op" id="5086908">(</span><span class="op" id="5086909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5086912">if</span>&nbsp;<span class="ident" id="5086915">err</span>&nbsp;<span class="op" id="5086919">!=</span>&nbsp;<span class="builtintype" id="5086922">nil</span>&nbsp;<span class="op" id="5086926">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5086930">return</span>&nbsp;<span class="builtintype" id="5086937">nil</span><span class="op" id="5086940">,</span>&nbsp;<span class="ident" id="5086942">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5086947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5086950">str</span><span class="op" id="5086953">,</span>&nbsp;<span class="ident" id="5086955">err</span>&nbsp;<span class="op" id="5086959">:=</span>&nbsp;<span class="ident" id="5086962">f</span><span class="op" id="5086963">.</span><span class="ident" id="5086964">stringTable</span><span class="op" id="5086975">(</span><span class="ident" id="5086976">ds</span><span class="op" id="5086978">.</span><span class="ident" id="5086979">Link</span><span class="op" id="5086983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5086986">if</span>&nbsp;<span class="ident" id="5086989">err</span>&nbsp;<span class="op" id="5086993">!=</span>&nbsp;<span class="builtintype" id="5086996">nil</span>&nbsp;<span class="op" id="5087000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5087004">return</span>&nbsp;<span class="builtintype" id="5087011">nil</span><span class="op" id="5087014">,</span>&nbsp;<span class="ident" id="5087016">err</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5087021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5087024">var</span>&nbsp;<span class="ident" id="5087028">all</span>&nbsp;<span class="op" id="5087032">[</span><span class="op" id="5087033">]</span><span class="builtintype" id="5087034">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5087042">for</span>&nbsp;<span class="builtinfunc" id="5087046">len</span><span class="op" id="5087049">(</span><span class="ident" id="5087050">d</span><span class="op" id="5087051">)</span>&nbsp;<span class="op" id="5087053">&gt;</span>&nbsp;<span class="num" id="5087055">0</span>&nbsp;<span class="op" id="5087057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5087061">var</span>&nbsp;<span class="ident" id="5087065">t</span>&nbsp;<span class="ident" id="5087067">DynTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5087076">var</span>&nbsp;<span class="ident" id="5087080">v</span>&nbsp;<span class="builtintype" id="5087082">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5087091">switch</span>&nbsp;<span class="ident" id="5087098">f</span><span class="op" id="5087099">.</span><span class="ident" id="5087100">Class</span>&nbsp;<span class="op" id="5087106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5087110">case</span>&nbsp;<span class="ident" id="5087115">ELFCLASS32</span><span class="op" id="5087125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5087130">t</span>&nbsp;<span class="op" id="5087132">=</span>&nbsp;<span class="ident" id="5087134">DynTag</span><span class="op" id="5087140">(</span><span class="ident" id="5087141">f</span><span class="op" id="5087142">.</span><span class="ident" id="5087143">ByteOrder</span><span class="op" id="5087152">.</span><span class="ident" id="5087153">Uint32</span><span class="op" id="5087159">(</span><span class="ident" id="5087160">d</span><span class="op" id="5087161">[</span><span class="num" id="5087162">0</span><span class="op" id="5087163">:</span><span class="num" id="5087164">4</span><span class="op" id="5087165">]</span><span class="op" id="5087166">)</span><span class="op" id="5087167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5087172">v</span>&nbsp;<span class="op" id="5087174">=</span>&nbsp;<span class="builtintype" id="5087176">uint64</span><span class="op" id="5087182">(</span><span class="ident" id="5087183">f</span><span class="op" id="5087184">.</span><span class="ident" id="5087185">ByteOrder</span><span class="op" id="5087194">.</span><span class="ident" id="5087195">Uint32</span><span class="op" id="5087201">(</span><span class="ident" id="5087202">d</span><span class="op" id="5087203">[</span><span class="num" id="5087204">4</span><span class="op" id="5087205">:</span><span class="num" id="5087206">8</span><span class="op" id="5087207">]</span><span class="op" id="5087208">)</span><span class="op" id="5087209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5087214">d</span>&nbsp;<span class="op" id="5087216">=</span>&nbsp;<span class="ident" id="5087218">d</span><span class="op" id="5087219">[</span><span class="num" id="5087220">8</span><span class="op" id="5087221">:</span><span class="op" id="5087222">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5087226">case</span>&nbsp;<span class="ident" id="5087231">ELFCLASS64</span><span class="op" id="5087241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5087246">t</span>&nbsp;<span class="op" id="5087248">=</span>&nbsp;<span class="ident" id="5087250">DynTag</span><span class="op" id="5087256">(</span><span class="ident" id="5087257">f</span><span class="op" id="5087258">.</span><span class="ident" id="5087259">ByteOrder</span><span class="op" id="5087268">.</span><span class="ident" id="5087269">Uint64</span><span class="op" id="5087275">(</span><span class="ident" id="5087276">d</span><span class="op" id="5087277">[</span><span class="num" id="5087278">0</span><span class="op" id="5087279">:</span><span class="num" id="5087280">8</span><span class="op" id="5087281">]</span><span class="op" id="5087282">)</span><span class="op" id="5087283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5087288">v</span>&nbsp;<span class="op" id="5087290">=</span>&nbsp;<span class="ident" id="5087292">f</span><span class="op" id="5087293">.</span><span class="ident" id="5087294">ByteOrder</span><span class="op" id="5087303">.</span><span class="ident" id="5087304">Uint64</span><span class="op" id="5087310">(</span><span class="ident" id="5087311">d</span><span class="op" id="5087312">[</span><span class="num" id="5087313">8</span><span class="op" id="5087314">:</span><span class="num" id="5087315">16</span><span class="op" id="5087317">]</span><span class="op" id="5087318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5087323">d</span>&nbsp;<span class="op" id="5087325">=</span>&nbsp;<span class="ident" id="5087327">d</span><span class="op" id="5087328">[</span><span class="num" id="5087329">16</span><span class="op" id="5087331">:</span><span class="op" id="5087332">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5087336">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5087340">if</span>&nbsp;<span class="ident" id="5087343">t</span>&nbsp;<span class="op" id="5087345">==</span>&nbsp;<span class="ident" id="5087348">tag</span>&nbsp;<span class="op" id="5087352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5087357">s</span><span class="op" id="5087358">,</span>&nbsp;<span class="ident" id="5087360">ok</span>&nbsp;<span class="op" id="5087363">:=</span>&nbsp;<span class="ident" id="5087366">getString</span><span class="op" id="5087375">(</span><span class="ident" id="5087376">str</span><span class="op" id="5087379">,</span>&nbsp;<span class="builtintype" id="5087381">int</span><span class="op" id="5087384">(</span><span class="ident" id="5087385">v</span><span class="op" id="5087386">)</span><span class="op" id="5087387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5087392">if</span>&nbsp;<span class="ident" id="5087395">ok</span>&nbsp;<span class="op" id="5087398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5087404">all</span>&nbsp;<span class="op" id="5087408">=</span>&nbsp;<span class="builtinfunc" id="5087410">append</span><span class="op" id="5087416">(</span><span class="ident" id="5087417">all</span><span class="op" id="5087420">,</span>&nbsp;<span class="ident" id="5087422">s</span><span class="op" id="5087423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5087428">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5087432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5087435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5087438">return</span>&nbsp;<span class="ident" id="5087445">all</span><span class="op" id="5087448">,</span>&nbsp;<span class="builtintype" id="5087450">nil</span><br>
<span class="lineno"></span><span class="op" id="5087454">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
