<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2533821">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2533876">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2533930">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2533981">//&nbsp;Linux&nbsp;system&nbsp;calls.</span><br>
<span class="lineno"></span><span class="comment" id="2534004">//&nbsp;This&nbsp;file&nbsp;is&nbsp;compiled&nbsp;as&nbsp;ordinary&nbsp;Go&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment" id="2534050">//&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;input&nbsp;to&nbsp;mksyscall,</span><br>
<span class="lineno"></span><span class="comment" id="2534088">//&nbsp;which&nbsp;parses&nbsp;the&nbsp;//sys&nbsp;lines&nbsp;and&nbsp;generates&nbsp;system&nbsp;call&nbsp;stubs.</span><br>
<span class="lineno"></span><span class="comment" id="2534153">//&nbsp;Note&nbsp;that&nbsp;sometimes&nbsp;we&nbsp;use&nbsp;a&nbsp;lowercase&nbsp;//sys&nbsp;name&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2534210">//&nbsp;wrap&nbsp;it&nbsp;in&nbsp;our&nbsp;own&nbsp;nicer&nbsp;implementation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2534255">package</span>&nbsp;<span class="ident" id="2534263">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2534272">import</span>&nbsp;<span class="string" id="2534279">&#34;unsafe&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2534289">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Wrapped<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2534308">//sys&nbsp;&nbsp;&nbsp;&nbspopen(path&nbsp;string,&nbsp;mode&nbsp;int,&nbsp;perm&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2534376">func</span>&nbsp;<span class="ident" id="2534381">Open</span><span class="op" id="2534385">(</span><span class="ident" id="2534386">path</span>&nbsp;<span class="builtintype" id="2534391">string</span><span class="op" id="2534397">,</span>&nbsp;<span class="ident" id="2534399">mode</span>&nbsp;<span class="builtintype" id="2534404">int</span><span class="op" id="2534407">,</span>&nbsp;<span class="ident" id="2534409">perm</span>&nbsp;<span class="builtintype" id="2534414">uint32</span><span class="op" id="2534420">)</span>&nbsp;<span class="op" id="2534422">(</span><span class="ident" id="2534423">fd</span>&nbsp;<span class="builtintype" id="2534426">int</span><span class="op" id="2534429">,</span>&nbsp;<span class="ident" id="2534431">err</span>&nbsp;<span class="builtintype" id="2534435">error</span><span class="op" id="2534440">)</span>&nbsp;<span class="op" id="2534442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534445">return</span>&nbsp;<span class="ident" id="2534452">open</span><span class="op" id="2534456">(</span><span class="ident" id="2534457">path</span><span class="op" id="2534461">,</span>&nbsp;<span class="ident" id="2534463">mode</span><span class="op" id="2534467">|</span><span class="ident" id="2534468">O_LARGEFILE</span><span class="op" id="2534479">,</span>&nbsp;<span class="ident" id="2534481">perm</span><span class="op" id="2534485">)</span><br>
<span class="lineno"></span><span class="op" id="2534487">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2534490">//sys&nbsp;&nbsp;&nbsp;&nbspopenat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;flags&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2534572">func</span>&nbsp;<span class="ident" id="2534577">Openat</span><span class="op" id="2534583">(</span><span class="ident" id="2534584">dirfd</span>&nbsp;<span class="builtintype" id="2534590">int</span><span class="op" id="2534593">,</span>&nbsp;<span class="ident" id="2534595">path</span>&nbsp;<span class="builtintype" id="2534600">string</span><span class="op" id="2534606">,</span>&nbsp;<span class="ident" id="2534608">flags</span>&nbsp;<span class="builtintype" id="2534614">int</span><span class="op" id="2534617">,</span>&nbsp;<span class="ident" id="2534619">mode</span>&nbsp;<span class="builtintype" id="2534624">uint32</span><span class="op" id="2534630">)</span>&nbsp;<span class="op" id="2534632">(</span><span class="ident" id="2534633">fd</span>&nbsp;<span class="builtintype" id="2534636">int</span><span class="op" id="2534639">,</span>&nbsp;<span class="ident" id="2534641">err</span>&nbsp;<span class="builtintype" id="2534645">error</span><span class="op" id="2534650">)</span>&nbsp;<span class="op" id="2534652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534655">return</span>&nbsp;<span class="ident" id="2534662">openat</span><span class="op" id="2534668">(</span><span class="ident" id="2534669">dirfd</span><span class="op" id="2534674">,</span>&nbsp;<span class="ident" id="2534676">path</span><span class="op" id="2534680">,</span>&nbsp;<span class="ident" id="2534682">flags</span><span class="op" id="2534687">|</span><span class="ident" id="2534688">O_LARGEFILE</span><span class="op" id="2534699">,</span>&nbsp;<span class="ident" id="2534701">mode</span><span class="op" id="2534705">)</span><br>
<span class="lineno">30</span><span class="op" id="2534707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2534710">//sysnb&nbsp;&nbsp;&nbsp;&nbsppipe(p&nbsp;*[2]_C_int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2534750">func</span>&nbsp;<span class="ident" id="2534755">Pipe</span><span class="op" id="2534759">(</span><span class="ident" id="2534760">p</span>&nbsp;<span class="op" id="2534762">[</span><span class="op" id="2534763">]</span><span class="builtintype" id="2534764">int</span><span class="op" id="2534767">)</span>&nbsp;<span class="op" id="2534769">(</span><span class="ident" id="2534770">err</span>&nbsp;<span class="builtintype" id="2534774">error</span><span class="op" id="2534779">)</span>&nbsp;<span class="op" id="2534781">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534784">if</span>&nbsp;<span class="builtinfunc" id="2534787">len</span><span class="op" id="2534790">(</span><span class="ident" id="2534791">p</span><span class="op" id="2534792">)</span>&nbsp;<span class="op" id="2534794">!=</span>&nbsp;<span class="num" id="2534797">2</span>&nbsp;<span class="op" id="2534799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534803">return</span>&nbsp;<span class="ident" id="2534810">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2534818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534821">var</span>&nbsp;<span class="ident" id="2534825">pp</span>&nbsp;<span class="op" id="2534828">[</span><span class="num" id="2534829">2</span><span class="op" id="2534830">]</span><span class="ident" id="2534831">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534839">err</span>&nbsp;<span class="op" id="2534843">=</span>&nbsp;<span class="ident" id="2534845">pipe</span><span class="op" id="2534849">(</span><span class="op" id="2534850">&amp;</span><span class="ident" id="2534851">pp</span><span class="op" id="2534853">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534856">p</span><span class="op" id="2534857">[</span><span class="num" id="2534858">0</span><span class="op" id="2534859">]</span>&nbsp;<span class="op" id="2534861">=</span>&nbsp;<span class="builtintype" id="2534863">int</span><span class="op" id="2534866">(</span><span class="ident" id="2534867">pp</span><span class="op" id="2534869">[</span><span class="num" id="2534870">0</span><span class="op" id="2534871">]</span><span class="op" id="2534872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534875">p</span><span class="op" id="2534876">[</span><span class="num" id="2534877">1</span><span class="op" id="2534878">]</span>&nbsp;<span class="op" id="2534880">=</span>&nbsp;<span class="builtintype" id="2534882">int</span><span class="op" id="2534885">(</span><span class="ident" id="2534886">pp</span><span class="op" id="2534888">[</span><span class="num" id="2534889">1</span><span class="op" id="2534890">]</span><span class="op" id="2534891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534894">return</span><br>
<span class="lineno"></span><span class="op" id="2534901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2534904">//sysnb&nbsp;pipe2(p&nbsp;*[2]_C_int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2534956">func</span>&nbsp;<span class="ident" id="2534961">Pipe2</span><span class="op" id="2534966">(</span><span class="ident" id="2534967">p</span>&nbsp;<span class="op" id="2534969">[</span><span class="op" id="2534970">]</span><span class="builtintype" id="2534971">int</span><span class="op" id="2534974">,</span>&nbsp;<span class="ident" id="2534976">flags</span>&nbsp;<span class="builtintype" id="2534982">int</span><span class="op" id="2534985">)</span>&nbsp;<span class="op" id="2534987">(</span><span class="ident" id="2534988">err</span>&nbsp;<span class="builtintype" id="2534992">error</span><span class="op" id="2534997">)</span>&nbsp;<span class="op" id="2534999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535002">if</span>&nbsp;<span class="builtinfunc" id="2535005">len</span><span class="op" id="2535008">(</span><span class="ident" id="2535009">p</span><span class="op" id="2535010">)</span>&nbsp;<span class="op" id="2535012">!=</span>&nbsp;<span class="num" id="2535015">2</span>&nbsp;<span class="op" id="2535017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535021">return</span>&nbsp;<span class="ident" id="2535028">EINVAL</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535039">var</span>&nbsp;<span class="ident" id="2535043">pp</span>&nbsp;<span class="op" id="2535046">[</span><span class="num" id="2535047">2</span><span class="op" id="2535048">]</span><span class="ident" id="2535049">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535057">err</span>&nbsp;<span class="op" id="2535061">=</span>&nbsp;<span class="ident" id="2535063">pipe2</span><span class="op" id="2535068">(</span><span class="op" id="2535069">&amp;</span><span class="ident" id="2535070">pp</span><span class="op" id="2535072">,</span>&nbsp;<span class="ident" id="2535074">flags</span><span class="op" id="2535079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535082">p</span><span class="op" id="2535083">[</span><span class="num" id="2535084">0</span><span class="op" id="2535085">]</span>&nbsp;<span class="op" id="2535087">=</span>&nbsp;<span class="builtintype" id="2535089">int</span><span class="op" id="2535092">(</span><span class="ident" id="2535093">pp</span><span class="op" id="2535095">[</span><span class="num" id="2535096">0</span><span class="op" id="2535097">]</span><span class="op" id="2535098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535101">p</span><span class="op" id="2535102">[</span><span class="num" id="2535103">1</span><span class="op" id="2535104">]</span>&nbsp;<span class="op" id="2535106">=</span>&nbsp;<span class="builtintype" id="2535108">int</span><span class="op" id="2535111">(</span><span class="ident" id="2535112">pp</span><span class="op" id="2535114">[</span><span class="num" id="2535115">1</span><span class="op" id="2535116">]</span><span class="op" id="2535117">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535120">return</span><br>
<span class="lineno"></span><span class="op" id="2535127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2535130">//sys&nbsp;&nbsp;&nbsp;&nbsputimes(path&nbsp;string,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2535188">func</span>&nbsp;<span class="ident" id="2535193">Utimes</span><span class="op" id="2535199">(</span><span class="ident" id="2535200">path</span>&nbsp;<span class="builtintype" id="2535205">string</span><span class="op" id="2535211">,</span>&nbsp;<span class="ident" id="2535213">tv</span>&nbsp;<span class="op" id="2535216">[</span><span class="op" id="2535217">]</span><span class="ident" id="2535218">Timeval</span><span class="op" id="2535225">)</span>&nbsp;<span class="op" id="2535227">(</span><span class="ident" id="2535228">err</span>&nbsp;<span class="builtintype" id="2535232">error</span><span class="op" id="2535237">)</span>&nbsp;<span class="op" id="2535239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535242">if</span>&nbsp;<span class="builtinfunc" id="2535245">len</span><span class="op" id="2535248">(</span><span class="ident" id="2535249">tv</span><span class="op" id="2535251">)</span>&nbsp;<span class="op" id="2535253">!=</span>&nbsp;<span class="num" id="2535256">2</span>&nbsp;<span class="op" id="2535258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535262">return</span>&nbsp;<span class="ident" id="2535269">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535280">return</span>&nbsp;<span class="ident" id="2535287">utimes</span><span class="op" id="2535293">(</span><span class="ident" id="2535294">path</span><span class="op" id="2535298">,</span>&nbsp;<span class="op" id="2535300">(</span><span class="op" id="2535301">*</span><span class="op" id="2535302">[</span><span class="num" id="2535303">2</span><span class="op" id="2535304">]</span><span class="ident" id="2535305">Timeval</span><span class="op" id="2535312">)</span><span class="op" id="2535313">(</span><span class="ident" id="2535314">unsafe</span><span class="op" id="2535320">.</span><span class="ident" id="2535321">Pointer</span><span class="op" id="2535328">(</span><span class="op" id="2535329">&amp;</span><span class="ident" id="2535330">tv</span><span class="op" id="2535332">[</span><span class="num" id="2535333">0</span><span class="op" id="2535334">]</span><span class="op" id="2535335">)</span><span class="op" id="2535336">)</span><span class="op" id="2535337">)</span><br>
<span class="lineno">65</span><span class="op" id="2535339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2535342">//sys&nbsp;&nbsp;&nbsp;&nbsputimensat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;times&nbsp;*[2]Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2535415">func</span>&nbsp;<span class="ident" id="2535420">UtimesNano</span><span class="op" id="2535430">(</span><span class="ident" id="2535431">path</span>&nbsp;<span class="builtintype" id="2535436">string</span><span class="op" id="2535442">,</span>&nbsp;<span class="ident" id="2535444">ts</span>&nbsp;<span class="op" id="2535447">[</span><span class="op" id="2535448">]</span><span class="ident" id="2535449">Timespec</span><span class="op" id="2535457">)</span>&nbsp;<span class="op" id="2535459">(</span><span class="ident" id="2535460">err</span>&nbsp;<span class="builtintype" id="2535464">error</span><span class="op" id="2535469">)</span>&nbsp;<span class="op" id="2535471">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535474">if</span>&nbsp;<span class="builtinfunc" id="2535477">len</span><span class="op" id="2535480">(</span><span class="ident" id="2535481">ts</span><span class="op" id="2535483">)</span>&nbsp;<span class="op" id="2535485">!=</span>&nbsp;<span class="num" id="2535488">2</span>&nbsp;<span class="op" id="2535490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535494">return</span>&nbsp;<span class="ident" id="2535501">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535512">err</span>&nbsp;<span class="op" id="2535516">=</span>&nbsp;<span class="ident" id="2535518">utimensat</span><span class="op" id="2535527">(</span><span class="ident" id="2535528">_AT_FDCWD</span><span class="op" id="2535537">,</span>&nbsp;<span class="ident" id="2535539">path</span><span class="op" id="2535543">,</span>&nbsp;<span class="op" id="2535545">(</span><span class="op" id="2535546">*</span><span class="op" id="2535547">[</span><span class="num" id="2535548">2</span><span class="op" id="2535549">]</span><span class="ident" id="2535550">Timespec</span><span class="op" id="2535558">)</span><span class="op" id="2535559">(</span><span class="ident" id="2535560">unsafe</span><span class="op" id="2535566">.</span><span class="ident" id="2535567">Pointer</span><span class="op" id="2535574">(</span><span class="op" id="2535575">&amp;</span><span class="ident" id="2535576">ts</span><span class="op" id="2535578">[</span><span class="num" id="2535579">0</span><span class="op" id="2535580">]</span><span class="op" id="2535581">)</span><span class="op" id="2535582">)</span><span class="op" id="2535583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535586">if</span>&nbsp;<span class="ident" id="2535589">err</span>&nbsp;<span class="op" id="2535593">!=</span>&nbsp;<span class="ident" id="2535596">ENOSYS</span>&nbsp;<span class="op" id="2535603">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535607">return</span>&nbsp;<span class="ident" id="2535614">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2535622">//&nbsp;If&nbsp;the&nbsp;utimensat&nbsp;syscall&nbsp;isn&#39;t&nbsp;available&nbsp;(utimensat&nbsp;was&nbsp;added&nbsp;to&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2535697">//&nbsp;in&nbsp;2.6.22,&nbsp;Released,&nbsp;8&nbsp;July&nbsp;2007)&nbsp;then&nbsp;fall&nbsp;back&nbsp;to&nbsp;utimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535760">var</span>&nbsp;<span class="ident" id="2535764">tv</span>&nbsp;<span class="op" id="2535767">[</span><span class="num" id="2535768">2</span><span class="op" id="2535769">]</span><span class="ident" id="2535770">Timeval</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535779">for</span>&nbsp;<span class="ident" id="2535783">i</span>&nbsp;<span class="op" id="2535785">:=</span>&nbsp;<span class="num" id="2535788">0</span><span class="op" id="2535789">;</span>&nbsp;<span class="ident" id="2535791">i</span>&nbsp;<span class="op" id="2535793">&lt;</span>&nbsp;<span class="num" id="2535795">2</span><span class="op" id="2535796">;</span>&nbsp;<span class="ident" id="2535798">i</span><span class="op" id="2535799">++</span>&nbsp;<span class="op" id="2535802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535806">tv</span><span class="op" id="2535808">[</span><span class="ident" id="2535809">i</span><span class="op" id="2535810">]</span><span class="op" id="2535811">.</span><span class="ident" id="2535812">Sec</span>&nbsp;<span class="op" id="2535816">=</span>&nbsp;<span class="ident" id="2535818">ts</span><span class="op" id="2535820">[</span><span class="ident" id="2535821">i</span><span class="op" id="2535822">]</span><span class="op" id="2535823">.</span><span class="ident" id="2535824">Sec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535830">tv</span><span class="op" id="2535832">[</span><span class="ident" id="2535833">i</span><span class="op" id="2535834">]</span><span class="op" id="2535835">.</span><span class="ident" id="2535836">Usec</span>&nbsp;<span class="op" id="2535841">=</span>&nbsp;<span class="ident" id="2535843">ts</span><span class="op" id="2535845">[</span><span class="ident" id="2535846">i</span><span class="op" id="2535847">]</span><span class="op" id="2535848">.</span><span class="ident" id="2535849">Nsec</span>&nbsp;<span class="op" id="2535854">/</span>&nbsp;<span class="num" id="2535856">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535865">return</span>&nbsp;<span class="ident" id="2535872">utimes</span><span class="op" id="2535878">(</span><span class="ident" id="2535879">path</span><span class="op" id="2535883">,</span>&nbsp;<span class="op" id="2535885">(</span><span class="op" id="2535886">*</span><span class="op" id="2535887">[</span><span class="num" id="2535888">2</span><span class="op" id="2535889">]</span><span class="ident" id="2535890">Timeval</span><span class="op" id="2535897">)</span><span class="op" id="2535898">(</span><span class="ident" id="2535899">unsafe</span><span class="op" id="2535905">.</span><span class="ident" id="2535906">Pointer</span><span class="op" id="2535913">(</span><span class="op" id="2535914">&amp;</span><span class="ident" id="2535915">tv</span><span class="op" id="2535917">[</span><span class="num" id="2535918">0</span><span class="op" id="2535919">]</span><span class="op" id="2535920">)</span><span class="op" id="2535921">)</span><span class="op" id="2535922">)</span><br>
<span class="lineno">85</span><span class="op" id="2535924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2535927">//sys&nbsp;&nbsp;&nbsp;&nbspfutimesat(dirfd&nbsp;int,&nbsp;path&nbsp;*byte,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2535998">func</span>&nbsp;<span class="ident" id="2536003">Futimesat</span><span class="op" id="2536012">(</span><span class="ident" id="2536013">dirfd</span>&nbsp;<span class="builtintype" id="2536019">int</span><span class="op" id="2536022">,</span>&nbsp;<span class="ident" id="2536024">path</span>&nbsp;<span class="builtintype" id="2536029">string</span><span class="op" id="2536035">,</span>&nbsp;<span class="ident" id="2536037">tv</span>&nbsp;<span class="op" id="2536040">[</span><span class="op" id="2536041">]</span><span class="ident" id="2536042">Timeval</span><span class="op" id="2536049">)</span>&nbsp;<span class="op" id="2536051">(</span><span class="ident" id="2536052">err</span>&nbsp;<span class="builtintype" id="2536056">error</span><span class="op" id="2536061">)</span>&nbsp;<span class="op" id="2536063">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536066">if</span>&nbsp;<span class="builtinfunc" id="2536069">len</span><span class="op" id="2536072">(</span><span class="ident" id="2536073">tv</span><span class="op" id="2536075">)</span>&nbsp;<span class="op" id="2536077">!=</span>&nbsp;<span class="num" id="2536080">2</span>&nbsp;<span class="op" id="2536082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536086">return</span>&nbsp;<span class="ident" id="2536093">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536104">pathp</span><span class="op" id="2536109">,</span>&nbsp;<span class="ident" id="2536111">err</span>&nbsp;<span class="op" id="2536115">:=</span>&nbsp;<span class="ident" id="2536118">BytePtrFromString</span><span class="op" id="2536135">(</span><span class="ident" id="2536136">path</span><span class="op" id="2536140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536143">if</span>&nbsp;<span class="ident" id="2536146">err</span>&nbsp;<span class="op" id="2536150">!=</span>&nbsp;<span class="ident" id="2536153">nil</span>&nbsp;<span class="op" id="2536157">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536161">return</span>&nbsp;<span class="ident" id="2536168">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536176">err</span>&nbsp;<span class="op" id="2536180">=</span>&nbsp;<span class="ident" id="2536182">futimesat</span><span class="op" id="2536191">(</span><span class="ident" id="2536192">dirfd</span><span class="op" id="2536197">,</span>&nbsp;<span class="ident" id="2536199">pathp</span><span class="op" id="2536204">,</span>&nbsp;<span class="op" id="2536206">(</span><span class="op" id="2536207">*</span><span class="op" id="2536208">[</span><span class="num" id="2536209">2</span><span class="op" id="2536210">]</span><span class="ident" id="2536211">Timeval</span><span class="op" id="2536218">)</span><span class="op" id="2536219">(</span><span class="ident" id="2536220">unsafe</span><span class="op" id="2536226">.</span><span class="ident" id="2536227">Pointer</span><span class="op" id="2536234">(</span><span class="op" id="2536235">&amp;</span><span class="ident" id="2536236">tv</span><span class="op" id="2536238">[</span><span class="num" id="2536239">0</span><span class="op" id="2536240">]</span><span class="op" id="2536241">)</span><span class="op" id="2536242">)</span><span class="op" id="2536243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536246">use</span><span class="op" id="2536249">(</span><span class="ident" id="2536250">unsafe</span><span class="op" id="2536256">.</span><span class="ident" id="2536257">Pointer</span><span class="op" id="2536264">(</span><span class="ident" id="2536265">pathp</span><span class="op" id="2536270">)</span><span class="op" id="2536271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536274">return</span>&nbsp;<span class="ident" id="2536281">err</span><br>
<span class="lineno">100</span><span class="op" id="2536285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2536288">func</span>&nbsp;<span class="ident" id="2536293">Futimes</span><span class="op" id="2536300">(</span><span class="ident" id="2536301">fd</span>&nbsp;<span class="builtintype" id="2536304">int</span><span class="op" id="2536307">,</span>&nbsp;<span class="ident" id="2536309">tv</span>&nbsp;<span class="op" id="2536312">[</span><span class="op" id="2536313">]</span><span class="ident" id="2536314">Timeval</span><span class="op" id="2536321">)</span>&nbsp;<span class="op" id="2536323">(</span><span class="ident" id="2536324">err</span>&nbsp;<span class="builtintype" id="2536328">error</span><span class="op" id="2536333">)</span>&nbsp;<span class="op" id="2536335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536338">//&nbsp;Believe&nbsp;it&nbsp;or&nbsp;not,&nbsp;this&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can&nbsp;do&nbsp;on&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536397">//&nbsp;(and&nbsp;is&nbsp;what&nbsp;glibc&nbsp;does).</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536427">return</span>&nbsp;<span class="ident" id="2536434">Utimes</span><span class="op" id="2536440">(</span><span class="string" id="2536441">&#34;/proc/self/fd/&#34;</span><span class="op" id="2536457">+</span><span class="ident" id="2536458">itoa</span><span class="op" id="2536462">(</span><span class="ident" id="2536463">fd</span><span class="op" id="2536465">)</span><span class="op" id="2536466">,</span>&nbsp;<span class="ident" id="2536468">tv</span><span class="op" id="2536470">)</span><br>
<span class="lineno"></span><span class="op" id="2536472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2536475">const</span>&nbsp;<span class="ident" id="2536481">ImplementsGetwd</span>&nbsp;<span class="op" id="2536497">=</span>&nbsp;<span class="builtintype" id="2536499">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2536505">//sys&nbsp;&nbsp;&nbsp;&nbspGetcwd(buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2536550">func</span>&nbsp;<span class="ident" id="2536555">Getwd</span><span class="op" id="2536560">(</span><span class="op" id="2536561">)</span>&nbsp;<span class="op" id="2536563">(</span><span class="ident" id="2536564">wd</span>&nbsp;<span class="builtintype" id="2536567">string</span><span class="op" id="2536573">,</span>&nbsp;<span class="ident" id="2536575">err</span>&nbsp;<span class="builtintype" id="2536579">error</span><span class="op" id="2536584">)</span>&nbsp;<span class="op" id="2536586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536589">var</span>&nbsp;<span class="ident" id="2536593">buf</span>&nbsp;<span class="op" id="2536597">[</span><span class="ident" id="2536598">PathMax</span><span class="op" id="2536605">]</span><span class="builtintype" id="2536606">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536612">n</span><span class="op" id="2536613">,</span>&nbsp;<span class="ident" id="2536615">err</span>&nbsp;<span class="op" id="2536619">:=</span>&nbsp;<span class="ident" id="2536622">Getcwd</span><span class="op" id="2536628">(</span><span class="ident" id="2536629">buf</span><span class="op" id="2536632">[</span><span class="num" id="2536633">0</span><span class="op" id="2536634">:</span><span class="op" id="2536635">]</span><span class="op" id="2536636">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536639">if</span>&nbsp;<span class="ident" id="2536642">err</span>&nbsp;<span class="op" id="2536646">!=</span>&nbsp;<span class="ident" id="2536649">nil</span>&nbsp;<span class="op" id="2536653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536657">return</span>&nbsp;<span class="string" id="2536664">&#34;&#34;</span><span class="op" id="2536666">,</span>&nbsp;<span class="ident" id="2536668">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536676">//&nbsp;Getcwd&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;to&nbsp;buf,&nbsp;including&nbsp;the&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536750">if</span>&nbsp;<span class="ident" id="2536753">n</span>&nbsp;<span class="op" id="2536755">&lt;</span>&nbsp;<span class="num" id="2536757">1</span>&nbsp;<span class="op" id="2536759">||</span>&nbsp;<span class="ident" id="2536762">n</span>&nbsp;<span class="op" id="2536764">&gt;</span>&nbsp;<span class="builtinfunc" id="2536766">len</span><span class="op" id="2536769">(</span><span class="ident" id="2536770">buf</span><span class="op" id="2536773">)</span>&nbsp;<span class="op" id="2536775">||</span>&nbsp;<span class="ident" id="2536778">buf</span><span class="op" id="2536781">[</span><span class="ident" id="2536782">n</span><span class="op" id="2536783">-</span><span class="num" id="2536784">1</span><span class="op" id="2536785">]</span>&nbsp;<span class="op" id="2536787">!=</span>&nbsp;<span class="num" id="2536790">0</span>&nbsp;<span class="op" id="2536792">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536796">return</span>&nbsp;<span class="string" id="2536803">&#34;&#34;</span><span class="op" id="2536805">,</span>&nbsp;<span class="ident" id="2536807">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536818">return</span>&nbsp;<span class="builtintype" id="2536825">string</span><span class="op" id="2536831">(</span><span class="ident" id="2536832">buf</span><span class="op" id="2536835">[</span><span class="num" id="2536836">0</span>&nbsp;<span class="op" id="2536838">:</span>&nbsp;<span class="ident" id="2536840">n</span><span class="op" id="2536841">-</span><span class="num" id="2536842">1</span><span class="op" id="2536843">]</span><span class="op" id="2536844">)</span><span class="op" id="2536845">,</span>&nbsp;<span class="ident" id="2536847">nil</span><br>
<span class="lineno"></span><span class="op" id="2536851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2536854">func</span>&nbsp;<span class="ident" id="2536859">Getgroups</span><span class="op" id="2536868">(</span><span class="op" id="2536869">)</span>&nbsp;<span class="op" id="2536871">(</span><span class="ident" id="2536872">gids</span>&nbsp;<span class="op" id="2536877">[</span><span class="op" id="2536878">]</span><span class="builtintype" id="2536879">int</span><span class="op" id="2536882">,</span>&nbsp;<span class="ident" id="2536884">err</span>&nbsp;<span class="builtintype" id="2536888">error</span><span class="op" id="2536893">)</span>&nbsp;<span class="op" id="2536895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536898">n</span><span class="op" id="2536899">,</span>&nbsp;<span class="ident" id="2536901">err</span>&nbsp;<span class="op" id="2536905">:=</span>&nbsp;<span class="ident" id="2536908">getgroups</span><span class="op" id="2536917">(</span><span class="num" id="2536918">0</span><span class="op" id="2536919">,</span>&nbsp;<span class="ident" id="2536921">nil</span><span class="op" id="2536924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536927">if</span>&nbsp;<span class="ident" id="2536930">err</span>&nbsp;<span class="op" id="2536934">!=</span>&nbsp;<span class="ident" id="2536937">nil</span>&nbsp;<span class="op" id="2536941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536945">return</span>&nbsp;<span class="ident" id="2536952">nil</span><span class="op" id="2536955">,</span>&nbsp;<span class="ident" id="2536957">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536962">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536965">if</span>&nbsp;<span class="ident" id="2536968">n</span>&nbsp;<span class="op" id="2536970">==</span>&nbsp;<span class="num" id="2536973">0</span>&nbsp;<span class="op" id="2536975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536979">return</span>&nbsp;<span class="ident" id="2536986">nil</span><span class="op" id="2536989">,</span>&nbsp;<span class="ident" id="2536991">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2537000">//&nbsp;Sanity&nbsp;check&nbsp;group&nbsp;count.&nbsp;&nbsp;Max&nbsp;is&nbsp;1&lt;&lt;16&nbsp;on&nbsp;Linux.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537054">if</span>&nbsp;<span class="ident" id="2537057">n</span>&nbsp;<span class="op" id="2537059">&lt;</span>&nbsp;<span class="num" id="2537061">0</span>&nbsp;<span class="op" id="2537063">||</span>&nbsp;<span class="ident" id="2537066">n</span>&nbsp;<span class="op" id="2537068">&gt;</span>&nbsp;<span class="num" id="2537070">1</span><span class="op" id="2537071">&lt;&lt;</span><span class="num" id="2537073">20</span>&nbsp;<span class="op" id="2537076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537080">return</span>&nbsp;<span class="ident" id="2537087">nil</span><span class="op" id="2537090">,</span>&nbsp;<span class="ident" id="2537092">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2537100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537104">a</span>&nbsp;<span class="op" id="2537106">:=</span>&nbsp;<span class="builtinfunc" id="2537109">make</span><span class="op" id="2537113">(</span><span class="op" id="2537114">[</span><span class="op" id="2537115">]</span><span class="ident" id="2537116">_Gid_t</span><span class="op" id="2537122">,</span>&nbsp;<span class="ident" id="2537124">n</span><span class="op" id="2537125">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537128">n</span><span class="op" id="2537129">,</span>&nbsp;<span class="ident" id="2537131">err</span>&nbsp;<span class="op" id="2537135">=</span>&nbsp;<span class="ident" id="2537137">getgroups</span><span class="op" id="2537146">(</span><span class="ident" id="2537147">n</span><span class="op" id="2537148">,</span>&nbsp;<span class="op" id="2537150">&amp;</span><span class="ident" id="2537151">a</span><span class="op" id="2537152">[</span><span class="num" id="2537153">0</span><span class="op" id="2537154">]</span><span class="op" id="2537155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537158">if</span>&nbsp;<span class="ident" id="2537161">err</span>&nbsp;<span class="op" id="2537165">!=</span>&nbsp;<span class="ident" id="2537168">nil</span>&nbsp;<span class="op" id="2537172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537176">return</span>&nbsp;<span class="ident" id="2537183">nil</span><span class="op" id="2537186">,</span>&nbsp;<span class="ident" id="2537188">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2537193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537196">gids</span>&nbsp;<span class="op" id="2537201">=</span>&nbsp;<span class="builtinfunc" id="2537203">make</span><span class="op" id="2537207">(</span><span class="op" id="2537208">[</span><span class="op" id="2537209">]</span><span class="builtintype" id="2537210">int</span><span class="op" id="2537213">,</span>&nbsp;<span class="ident" id="2537215">n</span><span class="op" id="2537216">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537219">for</span>&nbsp;<span class="ident" id="2537223">i</span><span class="op" id="2537224">,</span>&nbsp;<span class="ident" id="2537226">v</span>&nbsp;<span class="op" id="2537228">:=</span>&nbsp;<span class="keyword" id="2537231">range</span>&nbsp;<span class="ident" id="2537237">a</span><span class="op" id="2537238">[</span><span class="num" id="2537239">0</span><span class="op" id="2537240">:</span><span class="ident" id="2537241">n</span><span class="op" id="2537242">]</span>&nbsp;<span class="op" id="2537244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537248">gids</span><span class="op" id="2537252">[</span><span class="ident" id="2537253">i</span><span class="op" id="2537254">]</span>&nbsp;<span class="op" id="2537256">=</span>&nbsp;<span class="builtintype" id="2537258">int</span><span class="op" id="2537261">(</span><span class="ident" id="2537262">v</span><span class="op" id="2537263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2537266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537269">return</span><br>
<span class="lineno"></span><span class="op" id="2537276">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="2537279">func</span>&nbsp;<span class="ident" id="2537284">Setgroups</span><span class="op" id="2537293">(</span><span class="ident" id="2537294">gids</span>&nbsp;<span class="op" id="2537299">[</span><span class="op" id="2537300">]</span><span class="builtintype" id="2537301">int</span><span class="op" id="2537304">)</span>&nbsp;<span class="op" id="2537306">(</span><span class="ident" id="2537307">err</span>&nbsp;<span class="builtintype" id="2537311">error</span><span class="op" id="2537316">)</span>&nbsp;<span class="op" id="2537318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537321">if</span>&nbsp;<span class="builtinfunc" id="2537324">len</span><span class="op" id="2537327">(</span><span class="ident" id="2537328">gids</span><span class="op" id="2537332">)</span>&nbsp;<span class="op" id="2537334">==</span>&nbsp;<span class="num" id="2537337">0</span>&nbsp;<span class="op" id="2537339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537343">return</span>&nbsp;<span class="ident" id="2537350">setgroups</span><span class="op" id="2537359">(</span><span class="num" id="2537360">0</span><span class="op" id="2537361">,</span>&nbsp;<span class="ident" id="2537363">nil</span><span class="op" id="2537366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2537369">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537373">a</span>&nbsp;<span class="op" id="2537375">:=</span>&nbsp;<span class="builtinfunc" id="2537378">make</span><span class="op" id="2537382">(</span><span class="op" id="2537383">[</span><span class="op" id="2537384">]</span><span class="ident" id="2537385">_Gid_t</span><span class="op" id="2537391">,</span>&nbsp;<span class="builtinfunc" id="2537393">len</span><span class="op" id="2537396">(</span><span class="ident" id="2537397">gids</span><span class="op" id="2537401">)</span><span class="op" id="2537402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537405">for</span>&nbsp;<span class="ident" id="2537409">i</span><span class="op" id="2537410">,</span>&nbsp;<span class="ident" id="2537412">v</span>&nbsp;<span class="op" id="2537414">:=</span>&nbsp;<span class="keyword" id="2537417">range</span>&nbsp;<span class="ident" id="2537423">gids</span>&nbsp;<span class="op" id="2537428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537432">a</span><span class="op" id="2537433">[</span><span class="ident" id="2537434">i</span><span class="op" id="2537435">]</span>&nbsp;<span class="op" id="2537437">=</span>&nbsp;<span class="ident" id="2537439">_Gid_t</span><span class="op" id="2537445">(</span><span class="ident" id="2537446">v</span><span class="op" id="2537447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2537450">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537453">return</span>&nbsp;<span class="ident" id="2537460">setgroups</span><span class="op" id="2537469">(</span><span class="builtinfunc" id="2537470">len</span><span class="op" id="2537473">(</span><span class="ident" id="2537474">a</span><span class="op" id="2537475">)</span><span class="op" id="2537476">,</span>&nbsp;<span class="op" id="2537478">&amp;</span><span class="ident" id="2537479">a</span><span class="op" id="2537480">[</span><span class="num" id="2537481">0</span><span class="op" id="2537482">]</span><span class="op" id="2537483">)</span><br>
<span class="lineno"></span><span class="op" id="2537485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2537488">type</span>&nbsp;<span class="ident" id="2537493">WaitStatus</span>&nbsp;<span class="builtintype" id="2537504">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2537512">//&nbsp;Wait&nbsp;status&nbsp;is&nbsp;7&nbsp;bits&nbsp;at&nbsp;bottom,&nbsp;either&nbsp;0&nbsp;(exited),</span><br>
<span class="lineno"></span><span class="comment" id="2537567">//&nbsp;0x7F&nbsp;(stopped),&nbsp;or&nbsp;a&nbsp;signal&nbsp;number&nbsp;that&nbsp;caused&nbsp;an&nbsp;exit.</span><br>
<span class="lineno"></span><span class="comment" id="2537626">//&nbsp;The&nbsp;0x80&nbsp;bit&nbsp;is&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;core&nbsp;dump.</span><br>
<span class="lineno"></span><span class="comment" id="2537676">//&nbsp;An&nbsp;extra&nbsp;number&nbsp;(exit&nbsp;code,&nbsp;signal&nbsp;causing&nbsp;a&nbsp;stop)</span><br>
<span class="lineno"></span><span class="comment" id="2537730">//&nbsp;is&nbsp;in&nbsp;the&nbsp;high&nbsp;bits.&nbsp;&nbsp;At&nbsp;least&nbsp;that&#39;s&nbsp;the&nbsp;idea.</span><br>
<span class="lineno">170</span><span class="comment" id="2537781">//&nbsp;There&nbsp;are&nbsp;various&nbsp;irregularities.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2537836">//&nbsp;&#34;continued&#34;&nbsp;status&nbsp;is&nbsp;0xFFFF,&nbsp;distinguishing&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="2537891">//&nbsp;from&nbsp;stopped&nbsp;via&nbsp;the&nbsp;core&nbsp;dump&nbsp;bit.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2537931">const</span>&nbsp;<span class="op" id="2537937">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537940">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2537948">=</span>&nbsp;<span class="num" id="2537950">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537956">core</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2537964">=</span>&nbsp;<span class="num" id="2537966">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537972">exited</span>&nbsp;&nbsp;<span class="op" id="2537980">=</span>&nbsp;<span class="num" id="2537982">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537988">stopped</span>&nbsp;<span class="op" id="2537996">=</span>&nbsp;<span class="num" id="2537998">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538004">shift</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2538012">=</span>&nbsp;<span class="num" id="2538014">8</span><br>
<span class="lineno">180</span><span class="op" id="2538016">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2538019">func</span>&nbsp;<span class="op" id="2538024">(</span><span class="ident" id="2538025">w</span>&nbsp;<span class="ident" id="2538027">WaitStatus</span><span class="op" id="2538037">)</span>&nbsp;<span class="ident" id="2538039">Exited</span><span class="op" id="2538045">(</span><span class="op" id="2538046">)</span>&nbsp;<span class="builtintype" id="2538048">bool</span>&nbsp;<span class="op" id="2538053">{</span>&nbsp;<span class="keyword" id="2538055">return</span>&nbsp;<span class="ident" id="2538062">w</span><span class="op" id="2538063">&amp;</span><span class="ident" id="2538064">mask</span>&nbsp;<span class="op" id="2538069">==</span>&nbsp;<span class="ident" id="2538072">exited</span>&nbsp;<span class="op" id="2538079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2538082">func</span>&nbsp;<span class="op" id="2538087">(</span><span class="ident" id="2538088">w</span>&nbsp;<span class="ident" id="2538090">WaitStatus</span><span class="op" id="2538100">)</span>&nbsp;<span class="ident" id="2538102">Signaled</span><span class="op" id="2538110">(</span><span class="op" id="2538111">)</span>&nbsp;<span class="builtintype" id="2538113">bool</span>&nbsp;<span class="op" id="2538118">{</span>&nbsp;<span class="keyword" id="2538120">return</span>&nbsp;<span class="ident" id="2538127">w</span><span class="op" id="2538128">&amp;</span><span class="ident" id="2538129">mask</span>&nbsp;<span class="op" id="2538134">!=</span>&nbsp;<span class="ident" id="2538137">stopped</span>&nbsp;<span class="op" id="2538145">&amp;&amp;</span>&nbsp;<span class="ident" id="2538148">w</span><span class="op" id="2538149">&amp;</span><span class="ident" id="2538150">mask</span>&nbsp;<span class="op" id="2538155">!=</span>&nbsp;<span class="ident" id="2538158">exited</span>&nbsp;<span class="op" id="2538165">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="2538168">func</span>&nbsp;<span class="op" id="2538173">(</span><span class="ident" id="2538174">w</span>&nbsp;<span class="ident" id="2538176">WaitStatus</span><span class="op" id="2538186">)</span>&nbsp;<span class="ident" id="2538188">Stopped</span><span class="op" id="2538195">(</span><span class="op" id="2538196">)</span>&nbsp;<span class="builtintype" id="2538198">bool</span>&nbsp;<span class="op" id="2538203">{</span>&nbsp;<span class="keyword" id="2538205">return</span>&nbsp;<span class="ident" id="2538212">w</span><span class="op" id="2538213">&amp;</span><span class="num" id="2538214">0xFF</span>&nbsp;<span class="op" id="2538219">==</span>&nbsp;<span class="ident" id="2538222">stopped</span>&nbsp;<span class="op" id="2538230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2538233">func</span>&nbsp;<span class="op" id="2538238">(</span><span class="ident" id="2538239">w</span>&nbsp;<span class="ident" id="2538241">WaitStatus</span><span class="op" id="2538251">)</span>&nbsp;<span class="ident" id="2538253">Continued</span><span class="op" id="2538262">(</span><span class="op" id="2538263">)</span>&nbsp;<span class="builtintype" id="2538265">bool</span>&nbsp;<span class="op" id="2538270">{</span>&nbsp;<span class="keyword" id="2538272">return</span>&nbsp;<span class="ident" id="2538279">w</span>&nbsp;<span class="op" id="2538281">==</span>&nbsp;<span class="num" id="2538284">0xFFFF</span>&nbsp;<span class="op" id="2538291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2538294">func</span>&nbsp;<span class="op" id="2538299">(</span><span class="ident" id="2538300">w</span>&nbsp;<span class="ident" id="2538302">WaitStatus</span><span class="op" id="2538312">)</span>&nbsp;<span class="ident" id="2538314">CoreDump</span><span class="op" id="2538322">(</span><span class="op" id="2538323">)</span>&nbsp;<span class="builtintype" id="2538325">bool</span>&nbsp;<span class="op" id="2538330">{</span>&nbsp;<span class="keyword" id="2538332">return</span>&nbsp;<span class="ident" id="2538339">w</span><span class="op" id="2538340">.</span><span class="ident" id="2538341">Signaled</span><span class="op" id="2538349">(</span><span class="op" id="2538350">)</span>&nbsp;<span class="op" id="2538352">&amp;&amp;</span>&nbsp;<span class="ident" id="2538355">w</span><span class="op" id="2538356">&amp;</span><span class="ident" id="2538357">core</span>&nbsp;<span class="op" id="2538362">!=</span>&nbsp;<span class="num" id="2538365">0</span>&nbsp;<span class="op" id="2538367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2538370">func</span>&nbsp;<span class="op" id="2538375">(</span><span class="ident" id="2538376">w</span>&nbsp;<span class="ident" id="2538378">WaitStatus</span><span class="op" id="2538388">)</span>&nbsp;<span class="ident" id="2538390">ExitStatus</span><span class="op" id="2538400">(</span><span class="op" id="2538401">)</span>&nbsp;<span class="builtintype" id="2538403">int</span>&nbsp;<span class="op" id="2538407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538410">if</span>&nbsp;<span class="op" id="2538413">!</span><span class="ident" id="2538414">w</span><span class="op" id="2538415">.</span><span class="ident" id="2538416">Exited</span><span class="op" id="2538422">(</span><span class="op" id="2538423">)</span>&nbsp;<span class="op" id="2538425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538429">return</span>&nbsp;<span class="op" id="2538436">-</span><span class="num" id="2538437">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2538440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538443">return</span>&nbsp;<span class="builtintype" id="2538450">int</span><span class="op" id="2538453">(</span><span class="ident" id="2538454">w</span><span class="op" id="2538455">&gt;&gt;</span><span class="ident" id="2538457">shift</span><span class="op" id="2538462">)</span>&nbsp;<span class="op" id="2538464">&amp;</span>&nbsp;<span class="num" id="2538466">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2538471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2538474">func</span>&nbsp;<span class="op" id="2538479">(</span><span class="ident" id="2538480">w</span>&nbsp;<span class="ident" id="2538482">WaitStatus</span><span class="op" id="2538492">)</span>&nbsp;<span class="ident" id="2538494">Signal</span><span class="op" id="2538500">(</span><span class="op" id="2538501">)</span>&nbsp;<span class="ident" id="2538503">Signal</span>&nbsp;<span class="op" id="2538510">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538513">if</span>&nbsp;<span class="op" id="2538516">!</span><span class="ident" id="2538517">w</span><span class="op" id="2538518">.</span><span class="ident" id="2538519">Signaled</span><span class="op" id="2538527">(</span><span class="op" id="2538528">)</span>&nbsp;<span class="op" id="2538530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538534">return</span>&nbsp;<span class="op" id="2538541">-</span><span class="num" id="2538542">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2538545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538548">return</span>&nbsp;<span class="ident" id="2538555">Signal</span><span class="op" id="2538561">(</span><span class="ident" id="2538562">w</span>&nbsp;<span class="op" id="2538564">&amp;</span>&nbsp;<span class="ident" id="2538566">mask</span><span class="op" id="2538570">)</span><br>
<span class="lineno"></span><span class="op" id="2538572">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2538575">func</span>&nbsp;<span class="op" id="2538580">(</span><span class="ident" id="2538581">w</span>&nbsp;<span class="ident" id="2538583">WaitStatus</span><span class="op" id="2538593">)</span>&nbsp;<span class="ident" id="2538595">StopSignal</span><span class="op" id="2538605">(</span><span class="op" id="2538606">)</span>&nbsp;<span class="ident" id="2538608">Signal</span>&nbsp;<span class="op" id="2538615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538618">if</span>&nbsp;<span class="op" id="2538621">!</span><span class="ident" id="2538622">w</span><span class="op" id="2538623">.</span><span class="ident" id="2538624">Stopped</span><span class="op" id="2538631">(</span><span class="op" id="2538632">)</span>&nbsp;<span class="op" id="2538634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538638">return</span>&nbsp;<span class="op" id="2538645">-</span><span class="num" id="2538646">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2538649">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538652">return</span>&nbsp;<span class="ident" id="2538659">Signal</span><span class="op" id="2538665">(</span><span class="ident" id="2538666">w</span><span class="op" id="2538667">&gt;&gt;</span><span class="ident" id="2538669">shift</span><span class="op" id="2538674">)</span>&nbsp;<span class="op" id="2538676">&amp;</span>&nbsp;<span class="num" id="2538678">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2538683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2538686">func</span>&nbsp;<span class="op" id="2538691">(</span><span class="ident" id="2538692">w</span>&nbsp;<span class="ident" id="2538694">WaitStatus</span><span class="op" id="2538704">)</span>&nbsp;<span class="ident" id="2538706">TrapCause</span><span class="op" id="2538715">(</span><span class="op" id="2538716">)</span>&nbsp;<span class="builtintype" id="2538718">int</span>&nbsp;<span class="op" id="2538722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538725">if</span>&nbsp;<span class="ident" id="2538728">w</span><span class="op" id="2538729">.</span><span class="ident" id="2538730">StopSignal</span><span class="op" id="2538740">(</span><span class="op" id="2538741">)</span>&nbsp;<span class="op" id="2538743">!=</span>&nbsp;<span class="ident" id="2538746">SIGTRAP</span>&nbsp;<span class="op" id="2538754">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538758">return</span>&nbsp;<span class="op" id="2538765">-</span><span class="num" id="2538766">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2538769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538772">return</span>&nbsp;<span class="builtintype" id="2538779">int</span><span class="op" id="2538782">(</span><span class="ident" id="2538783">w</span><span class="op" id="2538784">&gt;&gt;</span><span class="ident" id="2538786">shift</span><span class="op" id="2538791">)</span>&nbsp;<span class="op" id="2538793">&gt;&gt;</span>&nbsp;<span class="num" id="2538796">8</span><br>
<span class="lineno"></span><span class="op" id="2538798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2538801">//sys&nbsp;&nbsp;&nbsp;&nbspwait4(pid&nbsp;int,&nbsp;wstatus&nbsp;*_C_int,&nbsp;options&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(wpid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2538891">func</span>&nbsp;<span class="ident" id="2538896">Wait4</span><span class="op" id="2538901">(</span><span class="ident" id="2538902">pid</span>&nbsp;<span class="builtintype" id="2538906">int</span><span class="op" id="2538909">,</span>&nbsp;<span class="ident" id="2538911">wstatus</span>&nbsp;<span class="op" id="2538919">*</span><span class="ident" id="2538920">WaitStatus</span><span class="op" id="2538930">,</span>&nbsp;<span class="ident" id="2538932">options</span>&nbsp;<span class="builtintype" id="2538940">int</span><span class="op" id="2538943">,</span>&nbsp;<span class="ident" id="2538945">rusage</span>&nbsp;<span class="op" id="2538952">*</span><span class="ident" id="2538953">Rusage</span><span class="op" id="2538959">)</span>&nbsp;<span class="op" id="2538961">(</span><span class="ident" id="2538962">wpid</span>&nbsp;<span class="builtintype" id="2538967">int</span><span class="op" id="2538970">,</span>&nbsp;<span class="ident" id="2538972">err</span>&nbsp;<span class="builtintype" id="2538976">error</span><span class="op" id="2538981">)</span>&nbsp;<span class="op" id="2538983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538986">var</span>&nbsp;<span class="ident" id="2538990">status</span>&nbsp;<span class="ident" id="2538997">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539005">wpid</span><span class="op" id="2539009">,</span>&nbsp;<span class="ident" id="2539011">err</span>&nbsp;<span class="op" id="2539015">=</span>&nbsp;<span class="ident" id="2539017">wait4</span><span class="op" id="2539022">(</span><span class="ident" id="2539023">pid</span><span class="op" id="2539026">,</span>&nbsp;<span class="op" id="2539028">&amp;</span><span class="ident" id="2539029">status</span><span class="op" id="2539035">,</span>&nbsp;<span class="ident" id="2539037">options</span><span class="op" id="2539044">,</span>&nbsp;<span class="ident" id="2539046">rusage</span><span class="op" id="2539052">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539055">if</span>&nbsp;<span class="ident" id="2539058">wstatus</span>&nbsp;<span class="op" id="2539066">!=</span>&nbsp;<span class="ident" id="2539069">nil</span>&nbsp;<span class="op" id="2539073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2539077">*</span><span class="ident" id="2539078">wstatus</span>&nbsp;<span class="op" id="2539086">=</span>&nbsp;<span class="ident" id="2539088">WaitStatus</span><span class="op" id="2539098">(</span><span class="ident" id="2539099">status</span><span class="op" id="2539105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2539108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539111">return</span><br>
<span class="lineno"></span><span class="op" id="2539118">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2539121">func</span>&nbsp;<span class="ident" id="2539126">Mkfifo</span><span class="op" id="2539132">(</span><span class="ident" id="2539133">path</span>&nbsp;<span class="builtintype" id="2539138">string</span><span class="op" id="2539144">,</span>&nbsp;<span class="ident" id="2539146">mode</span>&nbsp;<span class="builtintype" id="2539151">uint32</span><span class="op" id="2539157">)</span>&nbsp;<span class="op" id="2539159">(</span><span class="ident" id="2539160">err</span>&nbsp;<span class="builtintype" id="2539164">error</span><span class="op" id="2539169">)</span>&nbsp;<span class="op" id="2539171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539174">return</span>&nbsp;<span class="ident" id="2539181">Mknod</span><span class="op" id="2539186">(</span><span class="ident" id="2539187">path</span><span class="op" id="2539191">,</span>&nbsp;<span class="ident" id="2539193">mode</span><span class="op" id="2539197">|</span><span class="ident" id="2539198">S_IFIFO</span><span class="op" id="2539205">,</span>&nbsp;<span class="num" id="2539207">0</span><span class="op" id="2539208">)</span><br>
<span class="lineno"></span><span class="op" id="2539210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2539213">func</span>&nbsp;<span class="op" id="2539218">(</span><span class="ident" id="2539219">sa</span>&nbsp;<span class="op" id="2539222">*</span><span class="ident" id="2539223">SockaddrInet4</span><span class="op" id="2539236">)</span>&nbsp;<span class="ident" id="2539238">sockaddr</span><span class="op" id="2539246">(</span><span class="op" id="2539247">)</span>&nbsp;<span class="op" id="2539249">(</span><span class="ident" id="2539250">unsafe</span><span class="op" id="2539256">.</span><span class="ident" id="2539257">Pointer</span><span class="op" id="2539264">,</span>&nbsp;<span class="ident" id="2539266">_Socklen</span><span class="op" id="2539274">,</span>&nbsp;<span class="builtintype" id="2539276">error</span><span class="op" id="2539281">)</span>&nbsp;<span class="op" id="2539283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539286">if</span>&nbsp;<span class="ident" id="2539289">sa</span><span class="op" id="2539291">.</span><span class="ident" id="2539292">Port</span>&nbsp;<span class="op" id="2539297">&lt;</span>&nbsp;<span class="num" id="2539299">0</span>&nbsp;<span class="op" id="2539301">||</span>&nbsp;<span class="ident" id="2539304">sa</span><span class="op" id="2539306">.</span><span class="ident" id="2539307">Port</span>&nbsp;<span class="op" id="2539312">&gt;</span>&nbsp;<span class="num" id="2539314">0xFFFF</span>&nbsp;<span class="op" id="2539321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539325">return</span>&nbsp;<span class="ident" id="2539332">nil</span><span class="op" id="2539335">,</span>&nbsp;<span class="num" id="2539337">0</span><span class="op" id="2539338">,</span>&nbsp;<span class="ident" id="2539340">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2539348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539351">sa</span><span class="op" id="2539353">.</span><span class="ident" id="2539354">raw</span><span class="op" id="2539357">.</span><span class="ident" id="2539358">Family</span>&nbsp;<span class="op" id="2539365">=</span>&nbsp;<span class="ident" id="2539367">AF_INET</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539376">p</span>&nbsp;<span class="op" id="2539378">:=</span>&nbsp;<span class="op" id="2539381">(</span><span class="op" id="2539382">*</span><span class="op" id="2539383">[</span><span class="num" id="2539384">2</span><span class="op" id="2539385">]</span><span class="builtintype" id="2539386">byte</span><span class="op" id="2539390">)</span><span class="op" id="2539391">(</span><span class="ident" id="2539392">unsafe</span><span class="op" id="2539398">.</span><span class="ident" id="2539399">Pointer</span><span class="op" id="2539406">(</span><span class="op" id="2539407">&amp;</span><span class="ident" id="2539408">sa</span><span class="op" id="2539410">.</span><span class="ident" id="2539411">raw</span><span class="op" id="2539414">.</span><span class="ident" id="2539415">Port</span><span class="op" id="2539419">)</span><span class="op" id="2539420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539423">p</span><span class="op" id="2539424">[</span><span class="num" id="2539425">0</span><span class="op" id="2539426">]</span>&nbsp;<span class="op" id="2539428">=</span>&nbsp;<span class="builtintype" id="2539430">byte</span><span class="op" id="2539434">(</span><span class="ident" id="2539435">sa</span><span class="op" id="2539437">.</span><span class="ident" id="2539438">Port</span>&nbsp;<span class="op" id="2539443">&gt;&gt;</span>&nbsp;<span class="num" id="2539446">8</span><span class="op" id="2539447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539450">p</span><span class="op" id="2539451">[</span><span class="num" id="2539452">1</span><span class="op" id="2539453">]</span>&nbsp;<span class="op" id="2539455">=</span>&nbsp;<span class="builtintype" id="2539457">byte</span><span class="op" id="2539461">(</span><span class="ident" id="2539462">sa</span><span class="op" id="2539464">.</span><span class="ident" id="2539465">Port</span><span class="op" id="2539469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539472">for</span>&nbsp;<span class="ident" id="2539476">i</span>&nbsp;<span class="op" id="2539478">:=</span>&nbsp;<span class="num" id="2539481">0</span><span class="op" id="2539482">;</span>&nbsp;<span class="ident" id="2539484">i</span>&nbsp;<span class="op" id="2539486">&lt;</span>&nbsp;<span class="builtinfunc" id="2539488">len</span><span class="op" id="2539491">(</span><span class="ident" id="2539492">sa</span><span class="op" id="2539494">.</span><span class="ident" id="2539495">Addr</span><span class="op" id="2539499">)</span><span class="op" id="2539500">;</span>&nbsp;<span class="ident" id="2539502">i</span><span class="op" id="2539503">++</span>&nbsp;<span class="op" id="2539506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539510">sa</span><span class="op" id="2539512">.</span><span class="ident" id="2539513">raw</span><span class="op" id="2539516">.</span><span class="ident" id="2539517">Addr</span><span class="op" id="2539521">[</span><span class="ident" id="2539522">i</span><span class="op" id="2539523">]</span>&nbsp;<span class="op" id="2539525">=</span>&nbsp;<span class="ident" id="2539527">sa</span><span class="op" id="2539529">.</span><span class="ident" id="2539530">Addr</span><span class="op" id="2539534">[</span><span class="ident" id="2539535">i</span><span class="op" id="2539536">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2539539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539542">return</span>&nbsp;<span class="ident" id="2539549">unsafe</span><span class="op" id="2539555">.</span><span class="ident" id="2539556">Pointer</span><span class="op" id="2539563">(</span><span class="op" id="2539564">&amp;</span><span class="ident" id="2539565">sa</span><span class="op" id="2539567">.</span><span class="ident" id="2539568">raw</span><span class="op" id="2539571">)</span><span class="op" id="2539572">,</span>&nbsp;<span class="ident" id="2539574">SizeofSockaddrInet4</span><span class="op" id="2539593">,</span>&nbsp;<span class="ident" id="2539595">nil</span><br>
<span class="lineno"></span><span class="op" id="2539599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2539602">func</span>&nbsp;<span class="op" id="2539607">(</span><span class="ident" id="2539608">sa</span>&nbsp;<span class="op" id="2539611">*</span><span class="ident" id="2539612">SockaddrInet6</span><span class="op" id="2539625">)</span>&nbsp;<span class="ident" id="2539627">sockaddr</span><span class="op" id="2539635">(</span><span class="op" id="2539636">)</span>&nbsp;<span class="op" id="2539638">(</span><span class="ident" id="2539639">unsafe</span><span class="op" id="2539645">.</span><span class="ident" id="2539646">Pointer</span><span class="op" id="2539653">,</span>&nbsp;<span class="ident" id="2539655">_Socklen</span><span class="op" id="2539663">,</span>&nbsp;<span class="builtintype" id="2539665">error</span><span class="op" id="2539670">)</span>&nbsp;<span class="op" id="2539672">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539675">if</span>&nbsp;<span class="ident" id="2539678">sa</span><span class="op" id="2539680">.</span><span class="ident" id="2539681">Port</span>&nbsp;<span class="op" id="2539686">&lt;</span>&nbsp;<span class="num" id="2539688">0</span>&nbsp;<span class="op" id="2539690">||</span>&nbsp;<span class="ident" id="2539693">sa</span><span class="op" id="2539695">.</span><span class="ident" id="2539696">Port</span>&nbsp;<span class="op" id="2539701">&gt;</span>&nbsp;<span class="num" id="2539703">0xFFFF</span>&nbsp;<span class="op" id="2539710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539714">return</span>&nbsp;<span class="ident" id="2539721">nil</span><span class="op" id="2539724">,</span>&nbsp;<span class="num" id="2539726">0</span><span class="op" id="2539727">,</span>&nbsp;<span class="ident" id="2539729">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2539737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539740">sa</span><span class="op" id="2539742">.</span><span class="ident" id="2539743">raw</span><span class="op" id="2539746">.</span><span class="ident" id="2539747">Family</span>&nbsp;<span class="op" id="2539754">=</span>&nbsp;<span class="ident" id="2539756">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539766">p</span>&nbsp;<span class="op" id="2539768">:=</span>&nbsp;<span class="op" id="2539771">(</span><span class="op" id="2539772">*</span><span class="op" id="2539773">[</span><span class="num" id="2539774">2</span><span class="op" id="2539775">]</span><span class="builtintype" id="2539776">byte</span><span class="op" id="2539780">)</span><span class="op" id="2539781">(</span><span class="ident" id="2539782">unsafe</span><span class="op" id="2539788">.</span><span class="ident" id="2539789">Pointer</span><span class="op" id="2539796">(</span><span class="op" id="2539797">&amp;</span><span class="ident" id="2539798">sa</span><span class="op" id="2539800">.</span><span class="ident" id="2539801">raw</span><span class="op" id="2539804">.</span><span class="ident" id="2539805">Port</span><span class="op" id="2539809">)</span><span class="op" id="2539810">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539813">p</span><span class="op" id="2539814">[</span><span class="num" id="2539815">0</span><span class="op" id="2539816">]</span>&nbsp;<span class="op" id="2539818">=</span>&nbsp;<span class="builtintype" id="2539820">byte</span><span class="op" id="2539824">(</span><span class="ident" id="2539825">sa</span><span class="op" id="2539827">.</span><span class="ident" id="2539828">Port</span>&nbsp;<span class="op" id="2539833">&gt;&gt;</span>&nbsp;<span class="num" id="2539836">8</span><span class="op" id="2539837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539840">p</span><span class="op" id="2539841">[</span><span class="num" id="2539842">1</span><span class="op" id="2539843">]</span>&nbsp;<span class="op" id="2539845">=</span>&nbsp;<span class="builtintype" id="2539847">byte</span><span class="op" id="2539851">(</span><span class="ident" id="2539852">sa</span><span class="op" id="2539854">.</span><span class="ident" id="2539855">Port</span><span class="op" id="2539859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539862">sa</span><span class="op" id="2539864">.</span><span class="ident" id="2539865">raw</span><span class="op" id="2539868">.</span><span class="ident" id="2539869">Scope_id</span>&nbsp;<span class="op" id="2539878">=</span>&nbsp;<span class="ident" id="2539880">sa</span><span class="op" id="2539882">.</span><span class="ident" id="2539883">ZoneId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539891">for</span>&nbsp;<span class="ident" id="2539895">i</span>&nbsp;<span class="op" id="2539897">:=</span>&nbsp;<span class="num" id="2539900">0</span><span class="op" id="2539901">;</span>&nbsp;<span class="ident" id="2539903">i</span>&nbsp;<span class="op" id="2539905">&lt;</span>&nbsp;<span class="builtinfunc" id="2539907">len</span><span class="op" id="2539910">(</span><span class="ident" id="2539911">sa</span><span class="op" id="2539913">.</span><span class="ident" id="2539914">Addr</span><span class="op" id="2539918">)</span><span class="op" id="2539919">;</span>&nbsp;<span class="ident" id="2539921">i</span><span class="op" id="2539922">++</span>&nbsp;<span class="op" id="2539925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539929">sa</span><span class="op" id="2539931">.</span><span class="ident" id="2539932">raw</span><span class="op" id="2539935">.</span><span class="ident" id="2539936">Addr</span><span class="op" id="2539940">[</span><span class="ident" id="2539941">i</span><span class="op" id="2539942">]</span>&nbsp;<span class="op" id="2539944">=</span>&nbsp;<span class="ident" id="2539946">sa</span><span class="op" id="2539948">.</span><span class="ident" id="2539949">Addr</span><span class="op" id="2539953">[</span><span class="ident" id="2539954">i</span><span class="op" id="2539955">]</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2539958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539961">return</span>&nbsp;<span class="ident" id="2539968">unsafe</span><span class="op" id="2539974">.</span><span class="ident" id="2539975">Pointer</span><span class="op" id="2539982">(</span><span class="op" id="2539983">&amp;</span><span class="ident" id="2539984">sa</span><span class="op" id="2539986">.</span><span class="ident" id="2539987">raw</span><span class="op" id="2539990">)</span><span class="op" id="2539991">,</span>&nbsp;<span class="ident" id="2539993">SizeofSockaddrInet6</span><span class="op" id="2540012">,</span>&nbsp;<span class="ident" id="2540014">nil</span><br>
<span class="lineno"></span><span class="op" id="2540018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2540021">func</span>&nbsp;<span class="op" id="2540026">(</span><span class="ident" id="2540027">sa</span>&nbsp;<span class="op" id="2540030">*</span><span class="ident" id="2540031">SockaddrUnix</span><span class="op" id="2540043">)</span>&nbsp;<span class="ident" id="2540045">sockaddr</span><span class="op" id="2540053">(</span><span class="op" id="2540054">)</span>&nbsp;<span class="op" id="2540056">(</span><span class="ident" id="2540057">unsafe</span><span class="op" id="2540063">.</span><span class="ident" id="2540064">Pointer</span><span class="op" id="2540071">,</span>&nbsp;<span class="ident" id="2540073">_Socklen</span><span class="op" id="2540081">,</span>&nbsp;<span class="builtintype" id="2540083">error</span><span class="op" id="2540088">)</span>&nbsp;<span class="op" id="2540090">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540093">name</span>&nbsp;<span class="op" id="2540098">:=</span>&nbsp;<span class="ident" id="2540101">sa</span><span class="op" id="2540103">.</span><span class="ident" id="2540104">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540110">n</span>&nbsp;<span class="op" id="2540112">:=</span>&nbsp;<span class="builtinfunc" id="2540115">len</span><span class="op" id="2540118">(</span><span class="ident" id="2540119">name</span><span class="op" id="2540123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540126">if</span>&nbsp;<span class="ident" id="2540129">n</span>&nbsp;<span class="op" id="2540131">&gt;=</span>&nbsp;<span class="builtinfunc" id="2540134">len</span><span class="op" id="2540137">(</span><span class="ident" id="2540138">sa</span><span class="op" id="2540140">.</span><span class="ident" id="2540141">raw</span><span class="op" id="2540144">.</span><span class="ident" id="2540145">Path</span><span class="op" id="2540149">)</span>&nbsp;<span class="op" id="2540151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540155">return</span>&nbsp;<span class="ident" id="2540162">nil</span><span class="op" id="2540165">,</span>&nbsp;<span class="num" id="2540167">0</span><span class="op" id="2540168">,</span>&nbsp;<span class="ident" id="2540170">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2540178">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540181">sa</span><span class="op" id="2540183">.</span><span class="ident" id="2540184">raw</span><span class="op" id="2540187">.</span><span class="ident" id="2540188">Family</span>&nbsp;<span class="op" id="2540195">=</span>&nbsp;<span class="ident" id="2540197">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540206">for</span>&nbsp;<span class="ident" id="2540210">i</span>&nbsp;<span class="op" id="2540212">:=</span>&nbsp;<span class="num" id="2540215">0</span><span class="op" id="2540216">;</span>&nbsp;<span class="ident" id="2540218">i</span>&nbsp;<span class="op" id="2540220">&lt;</span>&nbsp;<span class="ident" id="2540222">n</span><span class="op" id="2540223">;</span>&nbsp;<span class="ident" id="2540225">i</span><span class="op" id="2540226">++</span>&nbsp;<span class="op" id="2540229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540233">sa</span><span class="op" id="2540235">.</span><span class="ident" id="2540236">raw</span><span class="op" id="2540239">.</span><span class="ident" id="2540240">Path</span><span class="op" id="2540244">[</span><span class="ident" id="2540245">i</span><span class="op" id="2540246">]</span>&nbsp;<span class="op" id="2540248">=</span>&nbsp;<span class="builtintype" id="2540250">int8</span><span class="op" id="2540254">(</span><span class="ident" id="2540255">name</span><span class="op" id="2540259">[</span><span class="ident" id="2540260">i</span><span class="op" id="2540261">]</span><span class="op" id="2540262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2540265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2540268">//&nbsp;length&nbsp;is&nbsp;family&nbsp;(uint16),&nbsp;name,&nbsp;NUL.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540310">sl</span>&nbsp;<span class="op" id="2540313">:=</span>&nbsp;<span class="ident" id="2540316">_Socklen</span><span class="op" id="2540324">(</span><span class="num" id="2540325">2</span><span class="op" id="2540326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540329">if</span>&nbsp;<span class="ident" id="2540332">n</span>&nbsp;<span class="op" id="2540334">&gt;</span>&nbsp;<span class="num" id="2540336">0</span>&nbsp;<span class="op" id="2540338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540342">sl</span>&nbsp;<span class="op" id="2540345">+=</span>&nbsp;<span class="ident" id="2540348">_Socklen</span><span class="op" id="2540356">(</span><span class="ident" id="2540357">n</span><span class="op" id="2540358">)</span>&nbsp;<span class="op" id="2540360">+</span>&nbsp;<span class="num" id="2540362">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2540365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540368">if</span>&nbsp;<span class="ident" id="2540371">sa</span><span class="op" id="2540373">.</span><span class="ident" id="2540374">raw</span><span class="op" id="2540377">.</span><span class="ident" id="2540378">Path</span><span class="op" id="2540382">[</span><span class="num" id="2540383">0</span><span class="op" id="2540384">]</span>&nbsp;<span class="op" id="2540386">==</span>&nbsp;<span class="string" id="2540389">&#39;@&#39;</span>&nbsp;<span class="op" id="2540393">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540397">sa</span><span class="op" id="2540399">.</span><span class="ident" id="2540400">raw</span><span class="op" id="2540403">.</span><span class="ident" id="2540404">Path</span><span class="op" id="2540408">[</span><span class="num" id="2540409">0</span><span class="op" id="2540410">]</span>&nbsp;<span class="op" id="2540412">=</span>&nbsp;<span class="num" id="2540414">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2540418">//&nbsp;Don&#39;t&nbsp;count&nbsp;trailing&nbsp;NUL&nbsp;for&nbsp;abstract&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540470">sl</span><span class="op" id="2540472">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2540476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540480">return</span>&nbsp;<span class="ident" id="2540487">unsafe</span><span class="op" id="2540493">.</span><span class="ident" id="2540494">Pointer</span><span class="op" id="2540501">(</span><span class="op" id="2540502">&amp;</span><span class="ident" id="2540503">sa</span><span class="op" id="2540505">.</span><span class="ident" id="2540506">raw</span><span class="op" id="2540509">)</span><span class="op" id="2540510">,</span>&nbsp;<span class="ident" id="2540512">sl</span><span class="op" id="2540514">,</span>&nbsp;<span class="ident" id="2540516">nil</span><br>
<span class="lineno"></span><span class="op" id="2540520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2540523">type</span>&nbsp;<span class="ident" id="2540528">SockaddrLinklayer</span>&nbsp;<span class="keyword" id="2540546">struct</span>&nbsp;<span class="op" id="2540553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540556">Protocol</span>&nbsp;<span class="builtintype" id="2540565">uint16</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540573">Ifindex</span>&nbsp;&nbsp;<span class="builtintype" id="2540582">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540587">Hatype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2540596">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540604">Pkttype</span>&nbsp;&nbsp;<span class="builtintype" id="2540613">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540620">Halen</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2540629">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540636">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2540645">[</span><span class="num" id="2540646">8</span><span class="op" id="2540647">]</span><span class="builtintype" id="2540648">byte</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540654">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2540663">RawSockaddrLinklayer</span><br>
<span class="lineno"></span><span class="op" id="2540684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2540687">func</span>&nbsp;<span class="op" id="2540692">(</span><span class="ident" id="2540693">sa</span>&nbsp;<span class="op" id="2540696">*</span><span class="ident" id="2540697">SockaddrLinklayer</span><span class="op" id="2540714">)</span>&nbsp;<span class="ident" id="2540716">sockaddr</span><span class="op" id="2540724">(</span><span class="op" id="2540725">)</span>&nbsp;<span class="op" id="2540727">(</span><span class="ident" id="2540728">unsafe</span><span class="op" id="2540734">.</span><span class="ident" id="2540735">Pointer</span><span class="op" id="2540742">,</span>&nbsp;<span class="ident" id="2540744">_Socklen</span><span class="op" id="2540752">,</span>&nbsp;<span class="builtintype" id="2540754">error</span><span class="op" id="2540759">)</span>&nbsp;<span class="op" id="2540761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540764">if</span>&nbsp;<span class="ident" id="2540767">sa</span><span class="op" id="2540769">.</span><span class="ident" id="2540770">Ifindex</span>&nbsp;<span class="op" id="2540778">&lt;</span>&nbsp;<span class="num" id="2540780">0</span>&nbsp;<span class="op" id="2540782">||</span>&nbsp;<span class="ident" id="2540785">sa</span><span class="op" id="2540787">.</span><span class="ident" id="2540788">Ifindex</span>&nbsp;<span class="op" id="2540796">&gt;</span>&nbsp;<span class="num" id="2540798">0x7fffffff</span>&nbsp;<span class="op" id="2540809">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540813">return</span>&nbsp;<span class="ident" id="2540820">nil</span><span class="op" id="2540823">,</span>&nbsp;<span class="num" id="2540825">0</span><span class="op" id="2540826">,</span>&nbsp;<span class="ident" id="2540828">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2540836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540839">sa</span><span class="op" id="2540841">.</span><span class="ident" id="2540842">raw</span><span class="op" id="2540845">.</span><span class="ident" id="2540846">Family</span>&nbsp;<span class="op" id="2540853">=</span>&nbsp;<span class="ident" id="2540855">AF_PACKET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540866">sa</span><span class="op" id="2540868">.</span><span class="ident" id="2540869">raw</span><span class="op" id="2540872">.</span><span class="ident" id="2540873">Protocol</span>&nbsp;<span class="op" id="2540882">=</span>&nbsp;<span class="ident" id="2540884">sa</span><span class="op" id="2540886">.</span><span class="ident" id="2540887">Protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540897">sa</span><span class="op" id="2540899">.</span><span class="ident" id="2540900">raw</span><span class="op" id="2540903">.</span><span class="ident" id="2540904">Ifindex</span>&nbsp;<span class="op" id="2540912">=</span>&nbsp;<span class="builtintype" id="2540914">int32</span><span class="op" id="2540919">(</span><span class="ident" id="2540920">sa</span><span class="op" id="2540922">.</span><span class="ident" id="2540923">Ifindex</span><span class="op" id="2540930">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540933">sa</span><span class="op" id="2540935">.</span><span class="ident" id="2540936">raw</span><span class="op" id="2540939">.</span><span class="ident" id="2540940">Hatype</span>&nbsp;<span class="op" id="2540947">=</span>&nbsp;<span class="ident" id="2540949">sa</span><span class="op" id="2540951">.</span><span class="ident" id="2540952">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540960">sa</span><span class="op" id="2540962">.</span><span class="ident" id="2540963">raw</span><span class="op" id="2540966">.</span><span class="ident" id="2540967">Pkttype</span>&nbsp;<span class="op" id="2540975">=</span>&nbsp;<span class="ident" id="2540977">sa</span><span class="op" id="2540979">.</span><span class="ident" id="2540980">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540989">sa</span><span class="op" id="2540991">.</span><span class="ident" id="2540992">raw</span><span class="op" id="2540995">.</span><span class="ident" id="2540996">Halen</span>&nbsp;<span class="op" id="2541002">=</span>&nbsp;<span class="ident" id="2541004">sa</span><span class="op" id="2541006">.</span><span class="ident" id="2541007">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541014">for</span>&nbsp;<span class="ident" id="2541018">i</span>&nbsp;<span class="op" id="2541020">:=</span>&nbsp;<span class="num" id="2541023">0</span><span class="op" id="2541024">;</span>&nbsp;<span class="ident" id="2541026">i</span>&nbsp;<span class="op" id="2541028">&lt;</span>&nbsp;<span class="builtinfunc" id="2541030">len</span><span class="op" id="2541033">(</span><span class="ident" id="2541034">sa</span><span class="op" id="2541036">.</span><span class="ident" id="2541037">Addr</span><span class="op" id="2541041">)</span><span class="op" id="2541042">;</span>&nbsp;<span class="ident" id="2541044">i</span><span class="op" id="2541045">++</span>&nbsp;<span class="op" id="2541048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541052">sa</span><span class="op" id="2541054">.</span><span class="ident" id="2541055">raw</span><span class="op" id="2541058">.</span><span class="ident" id="2541059">Addr</span><span class="op" id="2541063">[</span><span class="ident" id="2541064">i</span><span class="op" id="2541065">]</span>&nbsp;<span class="op" id="2541067">=</span>&nbsp;<span class="ident" id="2541069">sa</span><span class="op" id="2541071">.</span><span class="ident" id="2541072">Addr</span><span class="op" id="2541076">[</span><span class="ident" id="2541077">i</span><span class="op" id="2541078">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2541081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541084">return</span>&nbsp;<span class="ident" id="2541091">unsafe</span><span class="op" id="2541097">.</span><span class="ident" id="2541098">Pointer</span><span class="op" id="2541105">(</span><span class="op" id="2541106">&amp;</span><span class="ident" id="2541107">sa</span><span class="op" id="2541109">.</span><span class="ident" id="2541110">raw</span><span class="op" id="2541113">)</span><span class="op" id="2541114">,</span>&nbsp;<span class="ident" id="2541116">SizeofSockaddrLinklayer</span><span class="op" id="2541139">,</span>&nbsp;<span class="ident" id="2541141">nil</span><br>
<span class="lineno"></span><span class="op" id="2541145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2541148">type</span>&nbsp;<span class="ident" id="2541153">SockaddrNetlink</span>&nbsp;<span class="keyword" id="2541169">struct</span>&nbsp;<span class="op" id="2541176">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541179">Family</span>&nbsp;<span class="builtintype" id="2541186">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541194">Pad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2541201">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541209">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2541216">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541224">Groups</span>&nbsp;<span class="builtintype" id="2541231">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541239">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2541246">RawSockaddrNetlink</span><br>
<span class="lineno">320</span><span class="op" id="2541265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2541268">func</span>&nbsp;<span class="op" id="2541273">(</span><span class="ident" id="2541274">sa</span>&nbsp;<span class="op" id="2541277">*</span><span class="ident" id="2541278">SockaddrNetlink</span><span class="op" id="2541293">)</span>&nbsp;<span class="ident" id="2541295">sockaddr</span><span class="op" id="2541303">(</span><span class="op" id="2541304">)</span>&nbsp;<span class="op" id="2541306">(</span><span class="ident" id="2541307">unsafe</span><span class="op" id="2541313">.</span><span class="ident" id="2541314">Pointer</span><span class="op" id="2541321">,</span>&nbsp;<span class="ident" id="2541323">_Socklen</span><span class="op" id="2541331">,</span>&nbsp;<span class="builtintype" id="2541333">error</span><span class="op" id="2541338">)</span>&nbsp;<span class="op" id="2541340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541343">sa</span><span class="op" id="2541345">.</span><span class="ident" id="2541346">raw</span><span class="op" id="2541349">.</span><span class="ident" id="2541350">Family</span>&nbsp;<span class="op" id="2541357">=</span>&nbsp;<span class="ident" id="2541359">AF_NETLINK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541371">sa</span><span class="op" id="2541373">.</span><span class="ident" id="2541374">raw</span><span class="op" id="2541377">.</span><span class="ident" id="2541378">Pad</span>&nbsp;<span class="op" id="2541382">=</span>&nbsp;<span class="ident" id="2541384">sa</span><span class="op" id="2541386">.</span><span class="ident" id="2541387">Pad</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541392">sa</span><span class="op" id="2541394">.</span><span class="ident" id="2541395">raw</span><span class="op" id="2541398">.</span><span class="ident" id="2541399">Pid</span>&nbsp;<span class="op" id="2541403">=</span>&nbsp;<span class="ident" id="2541405">sa</span><span class="op" id="2541407">.</span><span class="ident" id="2541408">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541413">sa</span><span class="op" id="2541415">.</span><span class="ident" id="2541416">raw</span><span class="op" id="2541419">.</span><span class="ident" id="2541420">Groups</span>&nbsp;<span class="op" id="2541427">=</span>&nbsp;<span class="ident" id="2541429">sa</span><span class="op" id="2541431">.</span><span class="ident" id="2541432">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541440">return</span>&nbsp;<span class="ident" id="2541447">unsafe</span><span class="op" id="2541453">.</span><span class="ident" id="2541454">Pointer</span><span class="op" id="2541461">(</span><span class="op" id="2541462">&amp;</span><span class="ident" id="2541463">sa</span><span class="op" id="2541465">.</span><span class="ident" id="2541466">raw</span><span class="op" id="2541469">)</span><span class="op" id="2541470">,</span>&nbsp;<span class="ident" id="2541472">SizeofSockaddrNetlink</span><span class="op" id="2541493">,</span>&nbsp;<span class="ident" id="2541495">nil</span><br>
<span class="lineno"></span><span class="op" id="2541499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="2541502">func</span>&nbsp;<span class="ident" id="2541507">anyToSockaddr</span><span class="op" id="2541520">(</span><span class="ident" id="2541521">rsa</span>&nbsp;<span class="op" id="2541525">*</span><span class="ident" id="2541526">RawSockaddrAny</span><span class="op" id="2541540">)</span>&nbsp;<span class="op" id="2541542">(</span><span class="ident" id="2541543">Sockaddr</span><span class="op" id="2541551">,</span>&nbsp;<span class="builtintype" id="2541553">error</span><span class="op" id="2541558">)</span>&nbsp;<span class="op" id="2541560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541563">switch</span>&nbsp;<span class="ident" id="2541570">rsa</span><span class="op" id="2541573">.</span><span class="ident" id="2541574">Addr</span><span class="op" id="2541578">.</span><span class="ident" id="2541579">Family</span>&nbsp;<span class="op" id="2541586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541589">case</span>&nbsp;<span class="ident" id="2541594">AF_NETLINK</span><span class="op" id="2541604">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541608">pp</span>&nbsp;<span class="op" id="2541611">:=</span>&nbsp;<span class="op" id="2541614">(</span><span class="op" id="2541615">*</span><span class="ident" id="2541616">RawSockaddrNetlink</span><span class="op" id="2541634">)</span><span class="op" id="2541635">(</span><span class="ident" id="2541636">unsafe</span><span class="op" id="2541642">.</span><span class="ident" id="2541643">Pointer</span><span class="op" id="2541650">(</span><span class="ident" id="2541651">rsa</span><span class="op" id="2541654">)</span><span class="op" id="2541655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541659">sa</span>&nbsp;<span class="op" id="2541662">:=</span>&nbsp;<span class="builtinfunc" id="2541665">new</span><span class="op" id="2541668">(</span><span class="ident" id="2541669">SockaddrNetlink</span><span class="op" id="2541684">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541688">sa</span><span class="op" id="2541690">.</span><span class="ident" id="2541691">Family</span>&nbsp;<span class="op" id="2541698">=</span>&nbsp;<span class="ident" id="2541700">pp</span><span class="op" id="2541702">.</span><span class="ident" id="2541703">Family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541712">sa</span><span class="op" id="2541714">.</span><span class="ident" id="2541715">Pad</span>&nbsp;<span class="op" id="2541719">=</span>&nbsp;<span class="ident" id="2541721">pp</span><span class="op" id="2541723">.</span><span class="ident" id="2541724">Pad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541730">sa</span><span class="op" id="2541732">.</span><span class="ident" id="2541733">Pid</span>&nbsp;<span class="op" id="2541737">=</span>&nbsp;<span class="ident" id="2541739">pp</span><span class="op" id="2541741">.</span><span class="ident" id="2541742">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541748">sa</span><span class="op" id="2541750">.</span><span class="ident" id="2541751">Groups</span>&nbsp;<span class="op" id="2541758">=</span>&nbsp;<span class="ident" id="2541760">pp</span><span class="op" id="2541762">.</span><span class="ident" id="2541763">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541772">return</span>&nbsp;<span class="ident" id="2541779">sa</span><span class="op" id="2541781">,</span>&nbsp;<span class="ident" id="2541783">nil</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541789">case</span>&nbsp;<span class="ident" id="2541794">AF_PACKET</span><span class="op" id="2541803">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541807">pp</span>&nbsp;<span class="op" id="2541810">:=</span>&nbsp;<span class="op" id="2541813">(</span><span class="op" id="2541814">*</span><span class="ident" id="2541815">RawSockaddrLinklayer</span><span class="op" id="2541835">)</span><span class="op" id="2541836">(</span><span class="ident" id="2541837">unsafe</span><span class="op" id="2541843">.</span><span class="ident" id="2541844">Pointer</span><span class="op" id="2541851">(</span><span class="ident" id="2541852">rsa</span><span class="op" id="2541855">)</span><span class="op" id="2541856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541860">sa</span>&nbsp;<span class="op" id="2541863">:=</span>&nbsp;<span class="builtinfunc" id="2541866">new</span><span class="op" id="2541869">(</span><span class="ident" id="2541870">SockaddrLinklayer</span><span class="op" id="2541887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541891">sa</span><span class="op" id="2541893">.</span><span class="ident" id="2541894">Protocol</span>&nbsp;<span class="op" id="2541903">=</span>&nbsp;<span class="ident" id="2541905">pp</span><span class="op" id="2541907">.</span><span class="ident" id="2541908">Protocol</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541919">sa</span><span class="op" id="2541921">.</span><span class="ident" id="2541922">Ifindex</span>&nbsp;<span class="op" id="2541930">=</span>&nbsp;<span class="builtintype" id="2541932">int</span><span class="op" id="2541935">(</span><span class="ident" id="2541936">pp</span><span class="op" id="2541938">.</span><span class="ident" id="2541939">Ifindex</span><span class="op" id="2541946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541950">sa</span><span class="op" id="2541952">.</span><span class="ident" id="2541953">Hatype</span>&nbsp;<span class="op" id="2541960">=</span>&nbsp;<span class="ident" id="2541962">pp</span><span class="op" id="2541964">.</span><span class="ident" id="2541965">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541974">sa</span><span class="op" id="2541976">.</span><span class="ident" id="2541977">Pkttype</span>&nbsp;<span class="op" id="2541985">=</span>&nbsp;<span class="ident" id="2541987">pp</span><span class="op" id="2541989">.</span><span class="ident" id="2541990">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542000">sa</span><span class="op" id="2542002">.</span><span class="ident" id="2542003">Halen</span>&nbsp;<span class="op" id="2542009">=</span>&nbsp;<span class="ident" id="2542011">pp</span><span class="op" id="2542013">.</span><span class="ident" id="2542014">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542022">for</span>&nbsp;<span class="ident" id="2542026">i</span>&nbsp;<span class="op" id="2542028">:=</span>&nbsp;<span class="num" id="2542031">0</span><span class="op" id="2542032">;</span>&nbsp;<span class="ident" id="2542034">i</span>&nbsp;<span class="op" id="2542036">&lt;</span>&nbsp;<span class="builtinfunc" id="2542038">len</span><span class="op" id="2542041">(</span><span class="ident" id="2542042">sa</span><span class="op" id="2542044">.</span><span class="ident" id="2542045">Addr</span><span class="op" id="2542049">)</span><span class="op" id="2542050">;</span>&nbsp;<span class="ident" id="2542052">i</span><span class="op" id="2542053">++</span>&nbsp;<span class="op" id="2542056">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542061">sa</span><span class="op" id="2542063">.</span><span class="ident" id="2542064">Addr</span><span class="op" id="2542068">[</span><span class="ident" id="2542069">i</span><span class="op" id="2542070">]</span>&nbsp;<span class="op" id="2542072">=</span>&nbsp;<span class="ident" id="2542074">pp</span><span class="op" id="2542076">.</span><span class="ident" id="2542077">Addr</span><span class="op" id="2542081">[</span><span class="ident" id="2542082">i</span><span class="op" id="2542083">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2542087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542091">return</span>&nbsp;<span class="ident" id="2542098">sa</span><span class="op" id="2542100">,</span>&nbsp;<span class="ident" id="2542102">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542108">case</span>&nbsp;<span class="ident" id="2542113">AF_UNIX</span><span class="op" id="2542120">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542124">pp</span>&nbsp;<span class="op" id="2542127">:=</span>&nbsp;<span class="op" id="2542130">(</span><span class="op" id="2542131">*</span><span class="ident" id="2542132">RawSockaddrUnix</span><span class="op" id="2542147">)</span><span class="op" id="2542148">(</span><span class="ident" id="2542149">unsafe</span><span class="op" id="2542155">.</span><span class="ident" id="2542156">Pointer</span><span class="op" id="2542163">(</span><span class="ident" id="2542164">rsa</span><span class="op" id="2542167">)</span><span class="op" id="2542168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542172">sa</span>&nbsp;<span class="op" id="2542175">:=</span>&nbsp;<span class="builtinfunc" id="2542178">new</span><span class="op" id="2542181">(</span><span class="ident" id="2542182">SockaddrUnix</span><span class="op" id="2542194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542198">if</span>&nbsp;<span class="ident" id="2542201">pp</span><span class="op" id="2542203">.</span><span class="ident" id="2542204">Path</span><span class="op" id="2542208">[</span><span class="num" id="2542209">0</span><span class="op" id="2542210">]</span>&nbsp;<span class="op" id="2542212">==</span>&nbsp;<span class="num" id="2542215">0</span>&nbsp;<span class="op" id="2542217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542222">//&nbsp;&#34;Abstract&#34;&nbsp;Unix&nbsp;domain&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542259">//&nbsp;Rewrite&nbsp;leading&nbsp;NUL&nbsp;as&nbsp;@&nbsp;for&nbsp;textual&nbsp;display.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542311">//&nbsp;(This&nbsp;is&nbsp;the&nbsp;standard&nbsp;convention.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542352">//&nbsp;Not&nbsp;friendly&nbsp;to&nbsp;overwrite&nbsp;in&nbsp;place,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542394">//&nbsp;but&nbsp;the&nbsp;callers&nbsp;below&nbsp;don&#39;t&nbsp;care.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542434">pp</span><span class="op" id="2542436">.</span><span class="ident" id="2542437">Path</span><span class="op" id="2542441">[</span><span class="num" id="2542442">0</span><span class="op" id="2542443">]</span>&nbsp;<span class="op" id="2542445">=</span>&nbsp;<span class="string" id="2542447">&#39;@&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2542453">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542458">//&nbsp;Assume&nbsp;path&nbsp;ends&nbsp;at&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542488">//&nbsp;This&nbsp;is&nbsp;not&nbsp;technically&nbsp;the&nbsp;Linux&nbsp;semantics&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542541">//&nbsp;abstract&nbsp;Unix&nbsp;domain&nbsp;sockets--they&nbsp;are&nbsp;supposed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542594">//&nbsp;to&nbsp;be&nbsp;uninterpreted&nbsp;fixed-size&nbsp;binary&nbsp;blobs--but</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542648">//&nbsp;everyone&nbsp;uses&nbsp;this&nbsp;convention.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542684">n</span>&nbsp;<span class="op" id="2542686">:=</span>&nbsp;<span class="num" id="2542689">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542693">for</span>&nbsp;<span class="ident" id="2542697">n</span>&nbsp;<span class="op" id="2542699">&lt;</span>&nbsp;<span class="builtinfunc" id="2542701">len</span><span class="op" id="2542704">(</span><span class="ident" id="2542705">pp</span><span class="op" id="2542707">.</span><span class="ident" id="2542708">Path</span><span class="op" id="2542712">)</span>&nbsp;<span class="op" id="2542714">&amp;&amp;</span>&nbsp;<span class="ident" id="2542717">pp</span><span class="op" id="2542719">.</span><span class="ident" id="2542720">Path</span><span class="op" id="2542724">[</span><span class="ident" id="2542725">n</span><span class="op" id="2542726">]</span>&nbsp;<span class="op" id="2542728">!=</span>&nbsp;<span class="num" id="2542731">0</span>&nbsp;<span class="op" id="2542733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542738">n</span><span class="op" id="2542739">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2542744">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542748">bytes</span>&nbsp;<span class="op" id="2542754">:=</span>&nbsp;<span class="op" id="2542757">(</span><span class="op" id="2542758">*</span><span class="op" id="2542759">[</span><span class="num" id="2542760">10000</span><span class="op" id="2542765">]</span><span class="builtintype" id="2542766">byte</span><span class="op" id="2542770">)</span><span class="op" id="2542771">(</span><span class="ident" id="2542772">unsafe</span><span class="op" id="2542778">.</span><span class="ident" id="2542779">Pointer</span><span class="op" id="2542786">(</span><span class="op" id="2542787">&amp;</span><span class="ident" id="2542788">pp</span><span class="op" id="2542790">.</span><span class="ident" id="2542791">Path</span><span class="op" id="2542795">[</span><span class="num" id="2542796">0</span><span class="op" id="2542797">]</span><span class="op" id="2542798">)</span><span class="op" id="2542799">)</span><span class="op" id="2542800">[</span><span class="num" id="2542801">0</span><span class="op" id="2542802">:</span><span class="ident" id="2542803">n</span><span class="op" id="2542804">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542808">sa</span><span class="op" id="2542810">.</span><span class="ident" id="2542811">Name</span>&nbsp;<span class="op" id="2542816">=</span>&nbsp;<span class="builtintype" id="2542818">string</span><span class="op" id="2542824">(</span><span class="ident" id="2542825">bytes</span><span class="op" id="2542830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542834">return</span>&nbsp;<span class="ident" id="2542841">sa</span><span class="op" id="2542843">,</span>&nbsp;<span class="ident" id="2542845">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542851">case</span>&nbsp;<span class="ident" id="2542856">AF_INET</span><span class="op" id="2542863">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542867">pp</span>&nbsp;<span class="op" id="2542870">:=</span>&nbsp;<span class="op" id="2542873">(</span><span class="op" id="2542874">*</span><span class="ident" id="2542875">RawSockaddrInet4</span><span class="op" id="2542891">)</span><span class="op" id="2542892">(</span><span class="ident" id="2542893">unsafe</span><span class="op" id="2542899">.</span><span class="ident" id="2542900">Pointer</span><span class="op" id="2542907">(</span><span class="ident" id="2542908">rsa</span><span class="op" id="2542911">)</span><span class="op" id="2542912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542916">sa</span>&nbsp;<span class="op" id="2542919">:=</span>&nbsp;<span class="builtinfunc" id="2542922">new</span><span class="op" id="2542925">(</span><span class="ident" id="2542926">SockaddrInet4</span><span class="op" id="2542939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542943">p</span>&nbsp;<span class="op" id="2542945">:=</span>&nbsp;<span class="op" id="2542948">(</span><span class="op" id="2542949">*</span><span class="op" id="2542950">[</span><span class="num" id="2542951">2</span><span class="op" id="2542952">]</span><span class="builtintype" id="2542953">byte</span><span class="op" id="2542957">)</span><span class="op" id="2542958">(</span><span class="ident" id="2542959">unsafe</span><span class="op" id="2542965">.</span><span class="ident" id="2542966">Pointer</span><span class="op" id="2542973">(</span><span class="op" id="2542974">&amp;</span><span class="ident" id="2542975">pp</span><span class="op" id="2542977">.</span><span class="ident" id="2542978">Port</span><span class="op" id="2542982">)</span><span class="op" id="2542983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542987">sa</span><span class="op" id="2542989">.</span><span class="ident" id="2542990">Port</span>&nbsp;<span class="op" id="2542995">=</span>&nbsp;<span class="builtintype" id="2542997">int</span><span class="op" id="2543000">(</span><span class="ident" id="2543001">p</span><span class="op" id="2543002">[</span><span class="num" id="2543003">0</span><span class="op" id="2543004">]</span><span class="op" id="2543005">)</span><span class="op" id="2543006">&lt;&lt;</span><span class="num" id="2543008">8</span>&nbsp;<span class="op" id="2543010">+</span>&nbsp;<span class="builtintype" id="2543012">int</span><span class="op" id="2543015">(</span><span class="ident" id="2543016">p</span><span class="op" id="2543017">[</span><span class="num" id="2543018">1</span><span class="op" id="2543019">]</span><span class="op" id="2543020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543024">for</span>&nbsp;<span class="ident" id="2543028">i</span>&nbsp;<span class="op" id="2543030">:=</span>&nbsp;<span class="num" id="2543033">0</span><span class="op" id="2543034">;</span>&nbsp;<span class="ident" id="2543036">i</span>&nbsp;<span class="op" id="2543038">&lt;</span>&nbsp;<span class="builtinfunc" id="2543040">len</span><span class="op" id="2543043">(</span><span class="ident" id="2543044">sa</span><span class="op" id="2543046">.</span><span class="ident" id="2543047">Addr</span><span class="op" id="2543051">)</span><span class="op" id="2543052">;</span>&nbsp;<span class="ident" id="2543054">i</span><span class="op" id="2543055">++</span>&nbsp;<span class="op" id="2543058">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543063">sa</span><span class="op" id="2543065">.</span><span class="ident" id="2543066">Addr</span><span class="op" id="2543070">[</span><span class="ident" id="2543071">i</span><span class="op" id="2543072">]</span>&nbsp;<span class="op" id="2543074">=</span>&nbsp;<span class="ident" id="2543076">pp</span><span class="op" id="2543078">.</span><span class="ident" id="2543079">Addr</span><span class="op" id="2543083">[</span><span class="ident" id="2543084">i</span><span class="op" id="2543085">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2543089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543093">return</span>&nbsp;<span class="ident" id="2543100">sa</span><span class="op" id="2543102">,</span>&nbsp;<span class="ident" id="2543104">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543110">case</span>&nbsp;<span class="ident" id="2543115">AF_INET6</span><span class="op" id="2543123">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543127">pp</span>&nbsp;<span class="op" id="2543130">:=</span>&nbsp;<span class="op" id="2543133">(</span><span class="op" id="2543134">*</span><span class="ident" id="2543135">RawSockaddrInet6</span><span class="op" id="2543151">)</span><span class="op" id="2543152">(</span><span class="ident" id="2543153">unsafe</span><span class="op" id="2543159">.</span><span class="ident" id="2543160">Pointer</span><span class="op" id="2543167">(</span><span class="ident" id="2543168">rsa</span><span class="op" id="2543171">)</span><span class="op" id="2543172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543176">sa</span>&nbsp;<span class="op" id="2543179">:=</span>&nbsp;<span class="builtinfunc" id="2543182">new</span><span class="op" id="2543185">(</span><span class="ident" id="2543186">SockaddrInet6</span><span class="op" id="2543199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543203">p</span>&nbsp;<span class="op" id="2543205">:=</span>&nbsp;<span class="op" id="2543208">(</span><span class="op" id="2543209">*</span><span class="op" id="2543210">[</span><span class="num" id="2543211">2</span><span class="op" id="2543212">]</span><span class="builtintype" id="2543213">byte</span><span class="op" id="2543217">)</span><span class="op" id="2543218">(</span><span class="ident" id="2543219">unsafe</span><span class="op" id="2543225">.</span><span class="ident" id="2543226">Pointer</span><span class="op" id="2543233">(</span><span class="op" id="2543234">&amp;</span><span class="ident" id="2543235">pp</span><span class="op" id="2543237">.</span><span class="ident" id="2543238">Port</span><span class="op" id="2543242">)</span><span class="op" id="2543243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543247">sa</span><span class="op" id="2543249">.</span><span class="ident" id="2543250">Port</span>&nbsp;<span class="op" id="2543255">=</span>&nbsp;<span class="builtintype" id="2543257">int</span><span class="op" id="2543260">(</span><span class="ident" id="2543261">p</span><span class="op" id="2543262">[</span><span class="num" id="2543263">0</span><span class="op" id="2543264">]</span><span class="op" id="2543265">)</span><span class="op" id="2543266">&lt;&lt;</span><span class="num" id="2543268">8</span>&nbsp;<span class="op" id="2543270">+</span>&nbsp;<span class="builtintype" id="2543272">int</span><span class="op" id="2543275">(</span><span class="ident" id="2543276">p</span><span class="op" id="2543277">[</span><span class="num" id="2543278">1</span><span class="op" id="2543279">]</span><span class="op" id="2543280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543284">sa</span><span class="op" id="2543286">.</span><span class="ident" id="2543287">ZoneId</span>&nbsp;<span class="op" id="2543294">=</span>&nbsp;<span class="ident" id="2543296">pp</span><span class="op" id="2543298">.</span><span class="ident" id="2543299">Scope_id</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543310">for</span>&nbsp;<span class="ident" id="2543314">i</span>&nbsp;<span class="op" id="2543316">:=</span>&nbsp;<span class="num" id="2543319">0</span><span class="op" id="2543320">;</span>&nbsp;<span class="ident" id="2543322">i</span>&nbsp;<span class="op" id="2543324">&lt;</span>&nbsp;<span class="builtinfunc" id="2543326">len</span><span class="op" id="2543329">(</span><span class="ident" id="2543330">sa</span><span class="op" id="2543332">.</span><span class="ident" id="2543333">Addr</span><span class="op" id="2543337">)</span><span class="op" id="2543338">;</span>&nbsp;<span class="ident" id="2543340">i</span><span class="op" id="2543341">++</span>&nbsp;<span class="op" id="2543344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543349">sa</span><span class="op" id="2543351">.</span><span class="ident" id="2543352">Addr</span><span class="op" id="2543356">[</span><span class="ident" id="2543357">i</span><span class="op" id="2543358">]</span>&nbsp;<span class="op" id="2543360">=</span>&nbsp;<span class="ident" id="2543362">pp</span><span class="op" id="2543364">.</span><span class="ident" id="2543365">Addr</span><span class="op" id="2543369">[</span><span class="ident" id="2543370">i</span><span class="op" id="2543371">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2543375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543379">return</span>&nbsp;<span class="ident" id="2543386">sa</span><span class="op" id="2543388">,</span>&nbsp;<span class="ident" id="2543390">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2543395">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543398">return</span>&nbsp;<span class="ident" id="2543405">nil</span><span class="op" id="2543408">,</span>&nbsp;<span class="ident" id="2543410">EAFNOSUPPORT</span><br>
<span class="lineno"></span><span class="op" id="2543423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2543426">func</span>&nbsp;<span class="ident" id="2543431">Accept</span><span class="op" id="2543437">(</span><span class="ident" id="2543438">fd</span>&nbsp;<span class="builtintype" id="2543441">int</span><span class="op" id="2543444">)</span>&nbsp;<span class="op" id="2543446">(</span><span class="ident" id="2543447">nfd</span>&nbsp;<span class="builtintype" id="2543451">int</span><span class="op" id="2543454">,</span>&nbsp;<span class="ident" id="2543456">sa</span>&nbsp;<span class="ident" id="2543459">Sockaddr</span><span class="op" id="2543467">,</span>&nbsp;<span class="ident" id="2543469">err</span>&nbsp;<span class="builtintype" id="2543473">error</span><span class="op" id="2543478">)</span>&nbsp;<span class="op" id="2543480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543483">var</span>&nbsp;<span class="ident" id="2543487">rsa</span>&nbsp;<span class="ident" id="2543491">RawSockaddrAny</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543507">var</span>&nbsp;<span class="builtinfunc" id="2543511">len</span>&nbsp;<span class="ident" id="2543515">_Socklen</span>&nbsp;<span class="op" id="2543524">=</span>&nbsp;<span class="ident" id="2543526">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543545">nfd</span><span class="op" id="2543548">,</span>&nbsp;<span class="ident" id="2543550">err</span>&nbsp;<span class="op" id="2543554">=</span>&nbsp;<span class="ident" id="2543556">accept</span><span class="op" id="2543562">(</span><span class="ident" id="2543563">fd</span><span class="op" id="2543565">,</span>&nbsp;<span class="op" id="2543567">&amp;</span><span class="ident" id="2543568">rsa</span><span class="op" id="2543571">,</span>&nbsp;<span class="op" id="2543573">&amp;</span><span class="builtinfunc" id="2543574">len</span><span class="op" id="2543577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543580">if</span>&nbsp;<span class="ident" id="2543583">err</span>&nbsp;<span class="op" id="2543587">!=</span>&nbsp;<span class="ident" id="2543590">nil</span>&nbsp;<span class="op" id="2543594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543598">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2543606">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543609">sa</span><span class="op" id="2543611">,</span>&nbsp;<span class="ident" id="2543613">err</span>&nbsp;<span class="op" id="2543617">=</span>&nbsp;<span class="ident" id="2543619">anyToSockaddr</span><span class="op" id="2543632">(</span><span class="op" id="2543633">&amp;</span><span class="ident" id="2543634">rsa</span><span class="op" id="2543637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543640">if</span>&nbsp;<span class="ident" id="2543643">err</span>&nbsp;<span class="op" id="2543647">!=</span>&nbsp;<span class="ident" id="2543650">nil</span>&nbsp;<span class="op" id="2543654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543658">Close</span><span class="op" id="2543663">(</span><span class="ident" id="2543664">nfd</span><span class="op" id="2543667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543671">nfd</span>&nbsp;<span class="op" id="2543675">=</span>&nbsp;<span class="num" id="2543677">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2543680">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543683">return</span><br>
<span class="lineno"></span><span class="op" id="2543690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2543693">func</span>&nbsp;<span class="ident" id="2543698">Accept4</span><span class="op" id="2543705">(</span><span class="ident" id="2543706">fd</span>&nbsp;<span class="builtintype" id="2543709">int</span><span class="op" id="2543712">,</span>&nbsp;<span class="ident" id="2543714">flags</span>&nbsp;<span class="builtintype" id="2543720">int</span><span class="op" id="2543723">)</span>&nbsp;<span class="op" id="2543725">(</span><span class="ident" id="2543726">nfd</span>&nbsp;<span class="builtintype" id="2543730">int</span><span class="op" id="2543733">,</span>&nbsp;<span class="ident" id="2543735">sa</span>&nbsp;<span class="ident" id="2543738">Sockaddr</span><span class="op" id="2543746">,</span>&nbsp;<span class="ident" id="2543748">err</span>&nbsp;<span class="builtintype" id="2543752">error</span><span class="op" id="2543757">)</span>&nbsp;<span class="op" id="2543759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543762">var</span>&nbsp;<span class="ident" id="2543766">rsa</span>&nbsp;<span class="ident" id="2543770">RawSockaddrAny</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543786">var</span>&nbsp;<span class="builtinfunc" id="2543790">len</span>&nbsp;<span class="ident" id="2543794">_Socklen</span>&nbsp;<span class="op" id="2543803">=</span>&nbsp;<span class="ident" id="2543805">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543824">nfd</span><span class="op" id="2543827">,</span>&nbsp;<span class="ident" id="2543829">err</span>&nbsp;<span class="op" id="2543833">=</span>&nbsp;<span class="ident" id="2543835">accept4</span><span class="op" id="2543842">(</span><span class="ident" id="2543843">fd</span><span class="op" id="2543845">,</span>&nbsp;<span class="op" id="2543847">&amp;</span><span class="ident" id="2543848">rsa</span><span class="op" id="2543851">,</span>&nbsp;<span class="op" id="2543853">&amp;</span><span class="builtinfunc" id="2543854">len</span><span class="op" id="2543857">,</span>&nbsp;<span class="ident" id="2543859">flags</span><span class="op" id="2543864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543867">if</span>&nbsp;<span class="ident" id="2543870">err</span>&nbsp;<span class="op" id="2543874">!=</span>&nbsp;<span class="ident" id="2543877">nil</span>&nbsp;<span class="op" id="2543881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543885">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2543893">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543896">if</span>&nbsp;<span class="builtinfunc" id="2543899">len</span>&nbsp;<span class="op" id="2543903">&gt;</span>&nbsp;<span class="ident" id="2543905">SizeofSockaddrAny</span>&nbsp;<span class="op" id="2543923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2543927">panic</span><span class="op" id="2543932">(</span><span class="string" id="2543933">&#34;RawSockaddrAny&nbsp;too&nbsp;small&#34;</span><span class="op" id="2543959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2543962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543965">sa</span><span class="op" id="2543967">,</span>&nbsp;<span class="ident" id="2543969">err</span>&nbsp;<span class="op" id="2543973">=</span>&nbsp;<span class="ident" id="2543975">anyToSockaddr</span><span class="op" id="2543988">(</span><span class="op" id="2543989">&amp;</span><span class="ident" id="2543990">rsa</span><span class="op" id="2543993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543996">if</span>&nbsp;<span class="ident" id="2543999">err</span>&nbsp;<span class="op" id="2544003">!=</span>&nbsp;<span class="ident" id="2544006">nil</span>&nbsp;<span class="op" id="2544010">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544014">Close</span><span class="op" id="2544019">(</span><span class="ident" id="2544020">nfd</span><span class="op" id="2544023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544027">nfd</span>&nbsp;<span class="op" id="2544031">=</span>&nbsp;<span class="num" id="2544033">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2544036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544039">return</span><br>
<span class="lineno"></span><span class="op" id="2544046">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2544049">func</span>&nbsp;<span class="ident" id="2544054">Getsockname</span><span class="op" id="2544065">(</span><span class="ident" id="2544066">fd</span>&nbsp;<span class="builtintype" id="2544069">int</span><span class="op" id="2544072">)</span>&nbsp;<span class="op" id="2544074">(</span><span class="ident" id="2544075">sa</span>&nbsp;<span class="ident" id="2544078">Sockaddr</span><span class="op" id="2544086">,</span>&nbsp;<span class="ident" id="2544088">err</span>&nbsp;<span class="builtintype" id="2544092">error</span><span class="op" id="2544097">)</span>&nbsp;<span class="op" id="2544099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544102">var</span>&nbsp;<span class="ident" id="2544106">rsa</span>&nbsp;<span class="ident" id="2544110">RawSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544126">var</span>&nbsp;<span class="builtinfunc" id="2544130">len</span>&nbsp;<span class="ident" id="2544134">_Socklen</span>&nbsp;<span class="op" id="2544143">=</span>&nbsp;<span class="ident" id="2544145">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544164">if</span>&nbsp;<span class="ident" id="2544167">err</span>&nbsp;<span class="op" id="2544171">=</span>&nbsp;<span class="ident" id="2544173">getsockname</span><span class="op" id="2544184">(</span><span class="ident" id="2544185">fd</span><span class="op" id="2544187">,</span>&nbsp;<span class="op" id="2544189">&amp;</span><span class="ident" id="2544190">rsa</span><span class="op" id="2544193">,</span>&nbsp;<span class="op" id="2544195">&amp;</span><span class="builtinfunc" id="2544196">len</span><span class="op" id="2544199">)</span><span class="op" id="2544200">;</span>&nbsp;<span class="ident" id="2544202">err</span>&nbsp;<span class="op" id="2544206">!=</span>&nbsp;<span class="ident" id="2544209">nil</span>&nbsp;<span class="op" id="2544213">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544217">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2544225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544228">return</span>&nbsp;<span class="ident" id="2544235">anyToSockaddr</span><span class="op" id="2544248">(</span><span class="op" id="2544249">&amp;</span><span class="ident" id="2544250">rsa</span><span class="op" id="2544253">)</span><br>
<span class="lineno"></span><span class="op" id="2544255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="2544258">func</span>&nbsp;<span class="ident" id="2544263">GetsockoptInet4Addr</span><span class="op" id="2544282">(</span><span class="ident" id="2544283">fd</span><span class="op" id="2544285">,</span>&nbsp;<span class="ident" id="2544287">level</span><span class="op" id="2544292">,</span>&nbsp;<span class="ident" id="2544294">opt</span>&nbsp;<span class="builtintype" id="2544298">int</span><span class="op" id="2544301">)</span>&nbsp;<span class="op" id="2544303">(</span><span class="ident" id="2544304">value</span>&nbsp;<span class="op" id="2544310">[</span><span class="num" id="2544311">4</span><span class="op" id="2544312">]</span><span class="builtintype" id="2544313">byte</span><span class="op" id="2544317">,</span>&nbsp;<span class="ident" id="2544319">err</span>&nbsp;<span class="builtintype" id="2544323">error</span><span class="op" id="2544328">)</span>&nbsp;<span class="op" id="2544330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544333">vallen</span>&nbsp;<span class="op" id="2544340">:=</span>&nbsp;<span class="ident" id="2544343">_Socklen</span><span class="op" id="2544351">(</span><span class="num" id="2544352">4</span><span class="op" id="2544353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544356">err</span>&nbsp;<span class="op" id="2544360">=</span>&nbsp;<span class="ident" id="2544362">getsockopt</span><span class="op" id="2544372">(</span><span class="ident" id="2544373">fd</span><span class="op" id="2544375">,</span>&nbsp;<span class="ident" id="2544377">level</span><span class="op" id="2544382">,</span>&nbsp;<span class="ident" id="2544384">opt</span><span class="op" id="2544387">,</span>&nbsp;<span class="ident" id="2544389">unsafe</span><span class="op" id="2544395">.</span><span class="ident" id="2544396">Pointer</span><span class="op" id="2544403">(</span><span class="op" id="2544404">&amp;</span><span class="ident" id="2544405">value</span><span class="op" id="2544410">[</span><span class="num" id="2544411">0</span><span class="op" id="2544412">]</span><span class="op" id="2544413">)</span><span class="op" id="2544414">,</span>&nbsp;<span class="op" id="2544416">&amp;</span><span class="ident" id="2544417">vallen</span><span class="op" id="2544423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544426">return</span>&nbsp;<span class="ident" id="2544433">value</span><span class="op" id="2544438">,</span>&nbsp;<span class="ident" id="2544440">err</span><br>
<span class="lineno"></span><span class="op" id="2544444">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2544447">func</span>&nbsp;<span class="ident" id="2544452">GetsockoptIPMreq</span><span class="op" id="2544468">(</span><span class="ident" id="2544469">fd</span><span class="op" id="2544471">,</span>&nbsp;<span class="ident" id="2544473">level</span><span class="op" id="2544478">,</span>&nbsp;<span class="ident" id="2544480">opt</span>&nbsp;<span class="builtintype" id="2544484">int</span><span class="op" id="2544487">)</span>&nbsp;<span class="op" id="2544489">(</span><span class="op" id="2544490">*</span><span class="ident" id="2544491">IPMreq</span><span class="op" id="2544497">,</span>&nbsp;<span class="builtintype" id="2544499">error</span><span class="op" id="2544504">)</span>&nbsp;<span class="op" id="2544506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544509">var</span>&nbsp;<span class="ident" id="2544513">value</span>&nbsp;<span class="ident" id="2544519">IPMreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544527">vallen</span>&nbsp;<span class="op" id="2544534">:=</span>&nbsp;<span class="ident" id="2544537">_Socklen</span><span class="op" id="2544545">(</span><span class="ident" id="2544546">SizeofIPMreq</span><span class="op" id="2544558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544561">err</span>&nbsp;<span class="op" id="2544565">:=</span>&nbsp;<span class="ident" id="2544568">getsockopt</span><span class="op" id="2544578">(</span><span class="ident" id="2544579">fd</span><span class="op" id="2544581">,</span>&nbsp;<span class="ident" id="2544583">level</span><span class="op" id="2544588">,</span>&nbsp;<span class="ident" id="2544590">opt</span><span class="op" id="2544593">,</span>&nbsp;<span class="ident" id="2544595">unsafe</span><span class="op" id="2544601">.</span><span class="ident" id="2544602">Pointer</span><span class="op" id="2544609">(</span><span class="op" id="2544610">&amp;</span><span class="ident" id="2544611">value</span><span class="op" id="2544616">)</span><span class="op" id="2544617">,</span>&nbsp;<span class="op" id="2544619">&amp;</span><span class="ident" id="2544620">vallen</span><span class="op" id="2544626">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544629">return</span>&nbsp;<span class="op" id="2544636">&amp;</span><span class="ident" id="2544637">value</span><span class="op" id="2544642">,</span>&nbsp;<span class="ident" id="2544644">err</span><br>
<span class="lineno"></span><span class="op" id="2544648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2544651">func</span>&nbsp;<span class="ident" id="2544656">GetsockoptIPMreqn</span><span class="op" id="2544673">(</span><span class="ident" id="2544674">fd</span><span class="op" id="2544676">,</span>&nbsp;<span class="ident" id="2544678">level</span><span class="op" id="2544683">,</span>&nbsp;<span class="ident" id="2544685">opt</span>&nbsp;<span class="builtintype" id="2544689">int</span><span class="op" id="2544692">)</span>&nbsp;<span class="op" id="2544694">(</span><span class="op" id="2544695">*</span><span class="ident" id="2544696">IPMreqn</span><span class="op" id="2544703">,</span>&nbsp;<span class="builtintype" id="2544705">error</span><span class="op" id="2544710">)</span>&nbsp;<span class="op" id="2544712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544715">var</span>&nbsp;<span class="ident" id="2544719">value</span>&nbsp;<span class="ident" id="2544725">IPMreqn</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544734">vallen</span>&nbsp;<span class="op" id="2544741">:=</span>&nbsp;<span class="ident" id="2544744">_Socklen</span><span class="op" id="2544752">(</span><span class="ident" id="2544753">SizeofIPMreqn</span><span class="op" id="2544766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544769">err</span>&nbsp;<span class="op" id="2544773">:=</span>&nbsp;<span class="ident" id="2544776">getsockopt</span><span class="op" id="2544786">(</span><span class="ident" id="2544787">fd</span><span class="op" id="2544789">,</span>&nbsp;<span class="ident" id="2544791">level</span><span class="op" id="2544796">,</span>&nbsp;<span class="ident" id="2544798">opt</span><span class="op" id="2544801">,</span>&nbsp;<span class="ident" id="2544803">unsafe</span><span class="op" id="2544809">.</span><span class="ident" id="2544810">Pointer</span><span class="op" id="2544817">(</span><span class="op" id="2544818">&amp;</span><span class="ident" id="2544819">value</span><span class="op" id="2544824">)</span><span class="op" id="2544825">,</span>&nbsp;<span class="op" id="2544827">&amp;</span><span class="ident" id="2544828">vallen</span><span class="op" id="2544834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544837">return</span>&nbsp;<span class="op" id="2544844">&amp;</span><span class="ident" id="2544845">value</span><span class="op" id="2544850">,</span>&nbsp;<span class="ident" id="2544852">err</span><br>
<span class="lineno"></span><span class="op" id="2544856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="2544859">func</span>&nbsp;<span class="ident" id="2544864">GetsockoptIPv6Mreq</span><span class="op" id="2544882">(</span><span class="ident" id="2544883">fd</span><span class="op" id="2544885">,</span>&nbsp;<span class="ident" id="2544887">level</span><span class="op" id="2544892">,</span>&nbsp;<span class="ident" id="2544894">opt</span>&nbsp;<span class="builtintype" id="2544898">int</span><span class="op" id="2544901">)</span>&nbsp;<span class="op" id="2544903">(</span><span class="op" id="2544904">*</span><span class="ident" id="2544905">IPv6Mreq</span><span class="op" id="2544913">,</span>&nbsp;<span class="builtintype" id="2544915">error</span><span class="op" id="2544920">)</span>&nbsp;<span class="op" id="2544922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544925">var</span>&nbsp;<span class="ident" id="2544929">value</span>&nbsp;<span class="ident" id="2544935">IPv6Mreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544945">vallen</span>&nbsp;<span class="op" id="2544952">:=</span>&nbsp;<span class="ident" id="2544955">_Socklen</span><span class="op" id="2544963">(</span><span class="ident" id="2544964">SizeofIPv6Mreq</span><span class="op" id="2544978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544981">err</span>&nbsp;<span class="op" id="2544985">:=</span>&nbsp;<span class="ident" id="2544988">getsockopt</span><span class="op" id="2544998">(</span><span class="ident" id="2544999">fd</span><span class="op" id="2545001">,</span>&nbsp;<span class="ident" id="2545003">level</span><span class="op" id="2545008">,</span>&nbsp;<span class="ident" id="2545010">opt</span><span class="op" id="2545013">,</span>&nbsp;<span class="ident" id="2545015">unsafe</span><span class="op" id="2545021">.</span><span class="ident" id="2545022">Pointer</span><span class="op" id="2545029">(</span><span class="op" id="2545030">&amp;</span><span class="ident" id="2545031">value</span><span class="op" id="2545036">)</span><span class="op" id="2545037">,</span>&nbsp;<span class="op" id="2545039">&amp;</span><span class="ident" id="2545040">vallen</span><span class="op" id="2545046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545049">return</span>&nbsp;<span class="op" id="2545056">&amp;</span><span class="ident" id="2545057">value</span><span class="op" id="2545062">,</span>&nbsp;<span class="ident" id="2545064">err</span><br>
<span class="lineno">470</span><span class="op" id="2545068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2545071">func</span>&nbsp;<span class="ident" id="2545076">GetsockoptIPv6MTUInfo</span><span class="op" id="2545097">(</span><span class="ident" id="2545098">fd</span><span class="op" id="2545100">,</span>&nbsp;<span class="ident" id="2545102">level</span><span class="op" id="2545107">,</span>&nbsp;<span class="ident" id="2545109">opt</span>&nbsp;<span class="builtintype" id="2545113">int</span><span class="op" id="2545116">)</span>&nbsp;<span class="op" id="2545118">(</span><span class="op" id="2545119">*</span><span class="ident" id="2545120">IPv6MTUInfo</span><span class="op" id="2545131">,</span>&nbsp;<span class="builtintype" id="2545133">error</span><span class="op" id="2545138">)</span>&nbsp;<span class="op" id="2545140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545143">var</span>&nbsp;<span class="ident" id="2545147">value</span>&nbsp;<span class="ident" id="2545153">IPv6MTUInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545166">vallen</span>&nbsp;<span class="op" id="2545173">:=</span>&nbsp;<span class="ident" id="2545176">_Socklen</span><span class="op" id="2545184">(</span><span class="ident" id="2545185">SizeofIPv6MTUInfo</span><span class="op" id="2545202">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545205">err</span>&nbsp;<span class="op" id="2545209">:=</span>&nbsp;<span class="ident" id="2545212">getsockopt</span><span class="op" id="2545222">(</span><span class="ident" id="2545223">fd</span><span class="op" id="2545225">,</span>&nbsp;<span class="ident" id="2545227">level</span><span class="op" id="2545232">,</span>&nbsp;<span class="ident" id="2545234">opt</span><span class="op" id="2545237">,</span>&nbsp;<span class="ident" id="2545239">unsafe</span><span class="op" id="2545245">.</span><span class="ident" id="2545246">Pointer</span><span class="op" id="2545253">(</span><span class="op" id="2545254">&amp;</span><span class="ident" id="2545255">value</span><span class="op" id="2545260">)</span><span class="op" id="2545261">,</span>&nbsp;<span class="op" id="2545263">&amp;</span><span class="ident" id="2545264">vallen</span><span class="op" id="2545270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545273">return</span>&nbsp;<span class="op" id="2545280">&amp;</span><span class="ident" id="2545281">value</span><span class="op" id="2545286">,</span>&nbsp;<span class="ident" id="2545288">err</span><br>
<span class="lineno"></span><span class="op" id="2545292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2545295">func</span>&nbsp;<span class="ident" id="2545300">GetsockoptICMPv6Filter</span><span class="op" id="2545322">(</span><span class="ident" id="2545323">fd</span><span class="op" id="2545325">,</span>&nbsp;<span class="ident" id="2545327">level</span><span class="op" id="2545332">,</span>&nbsp;<span class="ident" id="2545334">opt</span>&nbsp;<span class="builtintype" id="2545338">int</span><span class="op" id="2545341">)</span>&nbsp;<span class="op" id="2545343">(</span><span class="op" id="2545344">*</span><span class="ident" id="2545345">ICMPv6Filter</span><span class="op" id="2545357">,</span>&nbsp;<span class="builtintype" id="2545359">error</span><span class="op" id="2545364">)</span>&nbsp;<span class="op" id="2545366">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545369">var</span>&nbsp;<span class="ident" id="2545373">value</span>&nbsp;<span class="ident" id="2545379">ICMPv6Filter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545393">vallen</span>&nbsp;<span class="op" id="2545400">:=</span>&nbsp;<span class="ident" id="2545403">_Socklen</span><span class="op" id="2545411">(</span><span class="ident" id="2545412">SizeofICMPv6Filter</span><span class="op" id="2545430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545433">err</span>&nbsp;<span class="op" id="2545437">:=</span>&nbsp;<span class="ident" id="2545440">getsockopt</span><span class="op" id="2545450">(</span><span class="ident" id="2545451">fd</span><span class="op" id="2545453">,</span>&nbsp;<span class="ident" id="2545455">level</span><span class="op" id="2545460">,</span>&nbsp;<span class="ident" id="2545462">opt</span><span class="op" id="2545465">,</span>&nbsp;<span class="ident" id="2545467">unsafe</span><span class="op" id="2545473">.</span><span class="ident" id="2545474">Pointer</span><span class="op" id="2545481">(</span><span class="op" id="2545482">&amp;</span><span class="ident" id="2545483">value</span><span class="op" id="2545488">)</span><span class="op" id="2545489">,</span>&nbsp;<span class="op" id="2545491">&amp;</span><span class="ident" id="2545492">vallen</span><span class="op" id="2545498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545501">return</span>&nbsp;<span class="op" id="2545508">&amp;</span><span class="ident" id="2545509">value</span><span class="op" id="2545514">,</span>&nbsp;<span class="ident" id="2545516">err</span><br>
<span class="lineno"></span><span class="op" id="2545520">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="2545523">func</span>&nbsp;<span class="ident" id="2545528">GetsockoptUcred</span><span class="op" id="2545543">(</span><span class="ident" id="2545544">fd</span><span class="op" id="2545546">,</span>&nbsp;<span class="ident" id="2545548">level</span><span class="op" id="2545553">,</span>&nbsp;<span class="ident" id="2545555">opt</span>&nbsp;<span class="builtintype" id="2545559">int</span><span class="op" id="2545562">)</span>&nbsp;<span class="op" id="2545564">(</span><span class="op" id="2545565">*</span><span class="ident" id="2545566">Ucred</span><span class="op" id="2545571">,</span>&nbsp;<span class="builtintype" id="2545573">error</span><span class="op" id="2545578">)</span>&nbsp;<span class="op" id="2545580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545583">var</span>&nbsp;<span class="ident" id="2545587">value</span>&nbsp;<span class="ident" id="2545593">Ucred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545600">vallen</span>&nbsp;<span class="op" id="2545607">:=</span>&nbsp;<span class="ident" id="2545610">_Socklen</span><span class="op" id="2545618">(</span><span class="ident" id="2545619">SizeofUcred</span><span class="op" id="2545630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545633">err</span>&nbsp;<span class="op" id="2545637">:=</span>&nbsp;<span class="ident" id="2545640">getsockopt</span><span class="op" id="2545650">(</span><span class="ident" id="2545651">fd</span><span class="op" id="2545653">,</span>&nbsp;<span class="ident" id="2545655">level</span><span class="op" id="2545660">,</span>&nbsp;<span class="ident" id="2545662">opt</span><span class="op" id="2545665">,</span>&nbsp;<span class="ident" id="2545667">unsafe</span><span class="op" id="2545673">.</span><span class="ident" id="2545674">Pointer</span><span class="op" id="2545681">(</span><span class="op" id="2545682">&amp;</span><span class="ident" id="2545683">value</span><span class="op" id="2545688">)</span><span class="op" id="2545689">,</span>&nbsp;<span class="op" id="2545691">&amp;</span><span class="ident" id="2545692">vallen</span><span class="op" id="2545698">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545701">return</span>&nbsp;<span class="op" id="2545708">&amp;</span><span class="ident" id="2545709">value</span><span class="op" id="2545714">,</span>&nbsp;<span class="ident" id="2545716">err</span><br>
<span class="lineno"></span><span class="op" id="2545720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2545723">func</span>&nbsp;<span class="ident" id="2545728">SetsockoptIPMreqn</span><span class="op" id="2545745">(</span><span class="ident" id="2545746">fd</span><span class="op" id="2545748">,</span>&nbsp;<span class="ident" id="2545750">level</span><span class="op" id="2545755">,</span>&nbsp;<span class="ident" id="2545757">opt</span>&nbsp;<span class="builtintype" id="2545761">int</span><span class="op" id="2545764">,</span>&nbsp;<span class="ident" id="2545766">mreq</span>&nbsp;<span class="op" id="2545771">*</span><span class="ident" id="2545772">IPMreqn</span><span class="op" id="2545779">)</span>&nbsp;<span class="op" id="2545781">(</span><span class="ident" id="2545782">err</span>&nbsp;<span class="builtintype" id="2545786">error</span><span class="op" id="2545791">)</span>&nbsp;<span class="op" id="2545793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545796">return</span>&nbsp;<span class="ident" id="2545803">setsockopt</span><span class="op" id="2545813">(</span><span class="ident" id="2545814">fd</span><span class="op" id="2545816">,</span>&nbsp;<span class="ident" id="2545818">level</span><span class="op" id="2545823">,</span>&nbsp;<span class="ident" id="2545825">opt</span><span class="op" id="2545828">,</span>&nbsp;<span class="ident" id="2545830">unsafe</span><span class="op" id="2545836">.</span><span class="ident" id="2545837">Pointer</span><span class="op" id="2545844">(</span><span class="ident" id="2545845">mreq</span><span class="op" id="2545849">)</span><span class="op" id="2545850">,</span>&nbsp;<span class="ident" id="2545852">unsafe</span><span class="op" id="2545858">.</span><span class="ident" id="2545859">Sizeof</span><span class="op" id="2545865">(</span><span class="op" id="2545866">*</span><span class="ident" id="2545867">mreq</span><span class="op" id="2545871">)</span><span class="op" id="2545872">)</span><br>
<span class="lineno">495</span><span class="op" id="2545874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2545877">func</span>&nbsp;<span class="ident" id="2545882">Recvmsg</span><span class="op" id="2545889">(</span><span class="ident" id="2545890">fd</span>&nbsp;<span class="builtintype" id="2545893">int</span><span class="op" id="2545896">,</span>&nbsp;<span class="ident" id="2545898">p</span><span class="op" id="2545899">,</span>&nbsp;<span class="ident" id="2545901">oob</span>&nbsp;<span class="op" id="2545905">[</span><span class="op" id="2545906">]</span><span class="builtintype" id="2545907">byte</span><span class="op" id="2545911">,</span>&nbsp;<span class="ident" id="2545913">flags</span>&nbsp;<span class="builtintype" id="2545919">int</span><span class="op" id="2545922">)</span>&nbsp;<span class="op" id="2545924">(</span><span class="ident" id="2545925">n</span><span class="op" id="2545926">,</span>&nbsp;<span class="ident" id="2545928">oobn</span>&nbsp;<span class="builtintype" id="2545933">int</span><span class="op" id="2545936">,</span>&nbsp;<span class="ident" id="2545938">recvflags</span>&nbsp;<span class="builtintype" id="2545948">int</span><span class="op" id="2545951">,</span>&nbsp;<span class="ident" id="2545953">from</span>&nbsp;<span class="ident" id="2545958">Sockaddr</span><span class="op" id="2545966">,</span>&nbsp;<span class="ident" id="2545968">err</span>&nbsp;<span class="builtintype" id="2545972">error</span><span class="op" id="2545977">)</span>&nbsp;<span class="op" id="2545979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545982">var</span>&nbsp;<span class="ident" id="2545986">msg</span>&nbsp;<span class="ident" id="2545990">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545998">var</span>&nbsp;<span class="ident" id="2546002">rsa</span>&nbsp;<span class="ident" id="2546006">RawSockaddrAny</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546022">msg</span><span class="op" id="2546025">.</span><span class="ident" id="2546026">Name</span>&nbsp;<span class="op" id="2546031">=</span>&nbsp;<span class="op" id="2546033">(</span><span class="op" id="2546034">*</span><span class="builtintype" id="2546035">byte</span><span class="op" id="2546039">)</span><span class="op" id="2546040">(</span><span class="ident" id="2546041">unsafe</span><span class="op" id="2546047">.</span><span class="ident" id="2546048">Pointer</span><span class="op" id="2546055">(</span><span class="op" id="2546056">&amp;</span><span class="ident" id="2546057">rsa</span><span class="op" id="2546060">)</span><span class="op" id="2546061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546064">msg</span><span class="op" id="2546067">.</span><span class="ident" id="2546068">Namelen</span>&nbsp;<span class="op" id="2546076">=</span>&nbsp;<span class="builtintype" id="2546078">uint32</span><span class="op" id="2546084">(</span><span class="ident" id="2546085">SizeofSockaddrAny</span><span class="op" id="2546102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546105">var</span>&nbsp;<span class="ident" id="2546109">iov</span>&nbsp;<span class="ident" id="2546113">Iovec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546120">if</span>&nbsp;<span class="builtinfunc" id="2546123">len</span><span class="op" id="2546126">(</span><span class="ident" id="2546127">p</span><span class="op" id="2546128">)</span>&nbsp;<span class="op" id="2546130">&gt;</span>&nbsp;<span class="num" id="2546132">0</span>&nbsp;<span class="op" id="2546134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546138">iov</span><span class="op" id="2546141">.</span><span class="ident" id="2546142">Base</span>&nbsp;<span class="op" id="2546147">=</span>&nbsp;<span class="op" id="2546149">(</span><span class="op" id="2546150">*</span><span class="builtintype" id="2546151">byte</span><span class="op" id="2546155">)</span><span class="op" id="2546156">(</span><span class="ident" id="2546157">unsafe</span><span class="op" id="2546163">.</span><span class="ident" id="2546164">Pointer</span><span class="op" id="2546171">(</span><span class="op" id="2546172">&amp;</span><span class="ident" id="2546173">p</span><span class="op" id="2546174">[</span><span class="num" id="2546175">0</span><span class="op" id="2546176">]</span><span class="op" id="2546177">)</span><span class="op" id="2546178">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546182">iov</span><span class="op" id="2546185">.</span><span class="ident" id="2546186">SetLen</span><span class="op" id="2546192">(</span><span class="builtinfunc" id="2546193">len</span><span class="op" id="2546196">(</span><span class="ident" id="2546197">p</span><span class="op" id="2546198">)</span><span class="op" id="2546199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546205">var</span>&nbsp;<span class="ident" id="2546209">dummy</span>&nbsp;<span class="builtintype" id="2546215">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546221">if</span>&nbsp;<span class="builtinfunc" id="2546224">len</span><span class="op" id="2546227">(</span><span class="ident" id="2546228">oob</span><span class="op" id="2546231">)</span>&nbsp;<span class="op" id="2546233">&gt;</span>&nbsp;<span class="num" id="2546235">0</span>&nbsp;<span class="op" id="2546237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2546241">//&nbsp;receive&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546279">if</span>&nbsp;<span class="builtinfunc" id="2546282">len</span><span class="op" id="2546285">(</span><span class="ident" id="2546286">p</span><span class="op" id="2546287">)</span>&nbsp;<span class="op" id="2546289">==</span>&nbsp;<span class="num" id="2546292">0</span>&nbsp;<span class="op" id="2546294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546299">iov</span><span class="op" id="2546302">.</span><span class="ident" id="2546303">Base</span>&nbsp;<span class="op" id="2546308">=</span>&nbsp;<span class="op" id="2546310">&amp;</span><span class="ident" id="2546311">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546320">iov</span><span class="op" id="2546323">.</span><span class="ident" id="2546324">SetLen</span><span class="op" id="2546330">(</span><span class="num" id="2546331">1</span><span class="op" id="2546332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546340">msg</span><span class="op" id="2546343">.</span><span class="ident" id="2546344">Control</span>&nbsp;<span class="op" id="2546352">=</span>&nbsp;<span class="op" id="2546354">(</span><span class="op" id="2546355">*</span><span class="builtintype" id="2546356">byte</span><span class="op" id="2546360">)</span><span class="op" id="2546361">(</span><span class="ident" id="2546362">unsafe</span><span class="op" id="2546368">.</span><span class="ident" id="2546369">Pointer</span><span class="op" id="2546376">(</span><span class="op" id="2546377">&amp;</span><span class="ident" id="2546378">oob</span><span class="op" id="2546381">[</span><span class="num" id="2546382">0</span><span class="op" id="2546383">]</span><span class="op" id="2546384">)</span><span class="op" id="2546385">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546389">msg</span><span class="op" id="2546392">.</span><span class="ident" id="2546393">SetControllen</span><span class="op" id="2546406">(</span><span class="builtinfunc" id="2546407">len</span><span class="op" id="2546410">(</span><span class="ident" id="2546411">oob</span><span class="op" id="2546414">)</span><span class="op" id="2546415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546421">msg</span><span class="op" id="2546424">.</span><span class="ident" id="2546425">Iov</span>&nbsp;<span class="op" id="2546429">=</span>&nbsp;<span class="op" id="2546431">&amp;</span><span class="ident" id="2546432">iov</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546437">msg</span><span class="op" id="2546440">.</span><span class="ident" id="2546441">Iovlen</span>&nbsp;<span class="op" id="2546448">=</span>&nbsp;<span class="num" id="2546450">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546453">if</span>&nbsp;<span class="ident" id="2546456">n</span><span class="op" id="2546457">,</span>&nbsp;<span class="ident" id="2546459">err</span>&nbsp;<span class="op" id="2546463">=</span>&nbsp;<span class="ident" id="2546465">recvmsg</span><span class="op" id="2546472">(</span><span class="ident" id="2546473">fd</span><span class="op" id="2546475">,</span>&nbsp;<span class="op" id="2546477">&amp;</span><span class="ident" id="2546478">msg</span><span class="op" id="2546481">,</span>&nbsp;<span class="ident" id="2546483">flags</span><span class="op" id="2546488">)</span><span class="op" id="2546489">;</span>&nbsp;<span class="ident" id="2546491">err</span>&nbsp;<span class="op" id="2546495">!=</span>&nbsp;<span class="ident" id="2546498">nil</span>&nbsp;<span class="op" id="2546502">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546506">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546517">oobn</span>&nbsp;<span class="op" id="2546522">=</span>&nbsp;<span class="builtintype" id="2546524">int</span><span class="op" id="2546527">(</span><span class="ident" id="2546528">msg</span><span class="op" id="2546531">.</span><span class="ident" id="2546532">Controllen</span><span class="op" id="2546542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546545">recvflags</span>&nbsp;<span class="op" id="2546555">=</span>&nbsp;<span class="builtintype" id="2546557">int</span><span class="op" id="2546560">(</span><span class="ident" id="2546561">msg</span><span class="op" id="2546564">.</span><span class="ident" id="2546565">Flags</span><span class="op" id="2546570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2546573">//&nbsp;source&nbsp;address&nbsp;is&nbsp;only&nbsp;specified&nbsp;if&nbsp;the&nbsp;socket&nbsp;is&nbsp;unconnected</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546639">if</span>&nbsp;<span class="ident" id="2546642">rsa</span><span class="op" id="2546645">.</span><span class="ident" id="2546646">Addr</span><span class="op" id="2546650">.</span><span class="ident" id="2546651">Family</span>&nbsp;<span class="op" id="2546658">!=</span>&nbsp;<span class="ident" id="2546661">AF_UNSPEC</span>&nbsp;<span class="op" id="2546671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546675">from</span><span class="op" id="2546679">,</span>&nbsp;<span class="ident" id="2546681">err</span>&nbsp;<span class="op" id="2546685">=</span>&nbsp;<span class="ident" id="2546687">anyToSockaddr</span><span class="op" id="2546700">(</span><span class="op" id="2546701">&amp;</span><span class="ident" id="2546702">rsa</span><span class="op" id="2546705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546711">return</span><br>
<span class="lineno"></span><span class="op" id="2546718">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="2546721">func</span>&nbsp;<span class="ident" id="2546726">Sendmsg</span><span class="op" id="2546733">(</span><span class="ident" id="2546734">fd</span>&nbsp;<span class="builtintype" id="2546737">int</span><span class="op" id="2546740">,</span>&nbsp;<span class="ident" id="2546742">p</span><span class="op" id="2546743">,</span>&nbsp;<span class="ident" id="2546745">oob</span>&nbsp;<span class="op" id="2546749">[</span><span class="op" id="2546750">]</span><span class="builtintype" id="2546751">byte</span><span class="op" id="2546755">,</span>&nbsp;<span class="ident" id="2546757">to</span>&nbsp;<span class="ident" id="2546760">Sockaddr</span><span class="op" id="2546768">,</span>&nbsp;<span class="ident" id="2546770">flags</span>&nbsp;<span class="builtintype" id="2546776">int</span><span class="op" id="2546779">)</span>&nbsp;<span class="op" id="2546781">(</span><span class="ident" id="2546782">err</span>&nbsp;<span class="builtintype" id="2546786">error</span><span class="op" id="2546791">)</span>&nbsp;<span class="op" id="2546793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546796">_</span><span class="op" id="2546797">,</span>&nbsp;<span class="ident" id="2546799">err</span>&nbsp;<span class="op" id="2546803">=</span>&nbsp;<span class="ident" id="2546805">SendmsgN</span><span class="op" id="2546813">(</span><span class="ident" id="2546814">fd</span><span class="op" id="2546816">,</span>&nbsp;<span class="ident" id="2546818">p</span><span class="op" id="2546819">,</span>&nbsp;<span class="ident" id="2546821">oob</span><span class="op" id="2546824">,</span>&nbsp;<span class="ident" id="2546826">to</span><span class="op" id="2546828">,</span>&nbsp;<span class="ident" id="2546830">flags</span><span class="op" id="2546835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546838">return</span><br>
<span class="lineno"></span><span class="op" id="2546845">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="2546848">func</span>&nbsp;<span class="ident" id="2546853">SendmsgN</span><span class="op" id="2546861">(</span><span class="ident" id="2546862">fd</span>&nbsp;<span class="builtintype" id="2546865">int</span><span class="op" id="2546868">,</span>&nbsp;<span class="ident" id="2546870">p</span><span class="op" id="2546871">,</span>&nbsp;<span class="ident" id="2546873">oob</span>&nbsp;<span class="op" id="2546877">[</span><span class="op" id="2546878">]</span><span class="builtintype" id="2546879">byte</span><span class="op" id="2546883">,</span>&nbsp;<span class="ident" id="2546885">to</span>&nbsp;<span class="ident" id="2546888">Sockaddr</span><span class="op" id="2546896">,</span>&nbsp;<span class="ident" id="2546898">flags</span>&nbsp;<span class="builtintype" id="2546904">int</span><span class="op" id="2546907">)</span>&nbsp;<span class="op" id="2546909">(</span><span class="ident" id="2546910">n</span>&nbsp;<span class="builtintype" id="2546912">int</span><span class="op" id="2546915">,</span>&nbsp;<span class="ident" id="2546917">err</span>&nbsp;<span class="builtintype" id="2546921">error</span><span class="op" id="2546926">)</span>&nbsp;<span class="op" id="2546928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546931">var</span>&nbsp;<span class="ident" id="2546935">ptr</span>&nbsp;<span class="ident" id="2546939">unsafe</span><span class="op" id="2546945">.</span><span class="ident" id="2546946">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546955">var</span>&nbsp;<span class="ident" id="2546959">salen</span>&nbsp;<span class="ident" id="2546965">_Socklen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546975">if</span>&nbsp;<span class="ident" id="2546978">to</span>&nbsp;<span class="op" id="2546981">!=</span>&nbsp;<span class="ident" id="2546984">nil</span>&nbsp;<span class="op" id="2546988">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546992">var</span>&nbsp;<span class="ident" id="2546996">err</span>&nbsp;<span class="builtintype" id="2547000">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547008">ptr</span><span class="op" id="2547011">,</span>&nbsp;<span class="ident" id="2547013">salen</span><span class="op" id="2547018">,</span>&nbsp;<span class="ident" id="2547020">err</span>&nbsp;<span class="op" id="2547024">=</span>&nbsp;<span class="ident" id="2547026">to</span><span class="op" id="2547028">.</span><span class="ident" id="2547029">sockaddr</span><span class="op" id="2547037">(</span><span class="op" id="2547038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547042">if</span>&nbsp;<span class="ident" id="2547045">err</span>&nbsp;<span class="op" id="2547049">!=</span>&nbsp;<span class="ident" id="2547052">nil</span>&nbsp;<span class="op" id="2547056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547061">return</span>&nbsp;<span class="num" id="2547068">0</span><span class="op" id="2547069">,</span>&nbsp;<span class="ident" id="2547071">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547077">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547083">var</span>&nbsp;<span class="ident" id="2547087">msg</span>&nbsp;<span class="ident" id="2547091">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547099">msg</span><span class="op" id="2547102">.</span><span class="ident" id="2547103">Name</span>&nbsp;<span class="op" id="2547108">=</span>&nbsp;<span class="op" id="2547110">(</span><span class="op" id="2547111">*</span><span class="builtintype" id="2547112">byte</span><span class="op" id="2547116">)</span><span class="op" id="2547117">(</span><span class="ident" id="2547118">unsafe</span><span class="op" id="2547124">.</span><span class="ident" id="2547125">Pointer</span><span class="op" id="2547132">(</span><span class="ident" id="2547133">ptr</span><span class="op" id="2547136">)</span><span class="op" id="2547137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547140">msg</span><span class="op" id="2547143">.</span><span class="ident" id="2547144">Namelen</span>&nbsp;<span class="op" id="2547152">=</span>&nbsp;<span class="builtintype" id="2547154">uint32</span><span class="op" id="2547160">(</span><span class="ident" id="2547161">salen</span><span class="op" id="2547166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547169">var</span>&nbsp;<span class="ident" id="2547173">iov</span>&nbsp;<span class="ident" id="2547177">Iovec</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547184">if</span>&nbsp;<span class="builtinfunc" id="2547187">len</span><span class="op" id="2547190">(</span><span class="ident" id="2547191">p</span><span class="op" id="2547192">)</span>&nbsp;<span class="op" id="2547194">&gt;</span>&nbsp;<span class="num" id="2547196">0</span>&nbsp;<span class="op" id="2547198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547202">iov</span><span class="op" id="2547205">.</span><span class="ident" id="2547206">Base</span>&nbsp;<span class="op" id="2547211">=</span>&nbsp;<span class="op" id="2547213">(</span><span class="op" id="2547214">*</span><span class="builtintype" id="2547215">byte</span><span class="op" id="2547219">)</span><span class="op" id="2547220">(</span><span class="ident" id="2547221">unsafe</span><span class="op" id="2547227">.</span><span class="ident" id="2547228">Pointer</span><span class="op" id="2547235">(</span><span class="op" id="2547236">&amp;</span><span class="ident" id="2547237">p</span><span class="op" id="2547238">[</span><span class="num" id="2547239">0</span><span class="op" id="2547240">]</span><span class="op" id="2547241">)</span><span class="op" id="2547242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547246">iov</span><span class="op" id="2547249">.</span><span class="ident" id="2547250">SetLen</span><span class="op" id="2547256">(</span><span class="builtinfunc" id="2547257">len</span><span class="op" id="2547260">(</span><span class="ident" id="2547261">p</span><span class="op" id="2547262">)</span><span class="op" id="2547263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547269">var</span>&nbsp;<span class="ident" id="2547273">dummy</span>&nbsp;<span class="builtintype" id="2547279">byte</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547285">if</span>&nbsp;<span class="builtinfunc" id="2547288">len</span><span class="op" id="2547291">(</span><span class="ident" id="2547292">oob</span><span class="op" id="2547295">)</span>&nbsp;<span class="op" id="2547297">&gt;</span>&nbsp;<span class="num" id="2547299">0</span>&nbsp;<span class="op" id="2547301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2547305">//&nbsp;send&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547340">if</span>&nbsp;<span class="builtinfunc" id="2547343">len</span><span class="op" id="2547346">(</span><span class="ident" id="2547347">p</span><span class="op" id="2547348">)</span>&nbsp;<span class="op" id="2547350">==</span>&nbsp;<span class="num" id="2547353">0</span>&nbsp;<span class="op" id="2547355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547360">iov</span><span class="op" id="2547363">.</span><span class="ident" id="2547364">Base</span>&nbsp;<span class="op" id="2547369">=</span>&nbsp;<span class="op" id="2547371">&amp;</span><span class="ident" id="2547372">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547381">iov</span><span class="op" id="2547384">.</span><span class="ident" id="2547385">SetLen</span><span class="op" id="2547391">(</span><span class="num" id="2547392">1</span><span class="op" id="2547393">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547401">msg</span><span class="op" id="2547404">.</span><span class="ident" id="2547405">Control</span>&nbsp;<span class="op" id="2547413">=</span>&nbsp;<span class="op" id="2547415">(</span><span class="op" id="2547416">*</span><span class="builtintype" id="2547417">byte</span><span class="op" id="2547421">)</span><span class="op" id="2547422">(</span><span class="ident" id="2547423">unsafe</span><span class="op" id="2547429">.</span><span class="ident" id="2547430">Pointer</span><span class="op" id="2547437">(</span><span class="op" id="2547438">&amp;</span><span class="ident" id="2547439">oob</span><span class="op" id="2547442">[</span><span class="num" id="2547443">0</span><span class="op" id="2547444">]</span><span class="op" id="2547445">)</span><span class="op" id="2547446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547450">msg</span><span class="op" id="2547453">.</span><span class="ident" id="2547454">SetControllen</span><span class="op" id="2547467">(</span><span class="builtinfunc" id="2547468">len</span><span class="op" id="2547471">(</span><span class="ident" id="2547472">oob</span><span class="op" id="2547475">)</span><span class="op" id="2547476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547482">msg</span><span class="op" id="2547485">.</span><span class="ident" id="2547486">Iov</span>&nbsp;<span class="op" id="2547490">=</span>&nbsp;<span class="op" id="2547492">&amp;</span><span class="ident" id="2547493">iov</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547498">msg</span><span class="op" id="2547501">.</span><span class="ident" id="2547502">Iovlen</span>&nbsp;<span class="op" id="2547509">=</span>&nbsp;<span class="num" id="2547511">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547514">if</span>&nbsp;<span class="ident" id="2547517">n</span><span class="op" id="2547518">,</span>&nbsp;<span class="ident" id="2547520">err</span>&nbsp;<span class="op" id="2547524">=</span>&nbsp;<span class="ident" id="2547526">sendmsg</span><span class="op" id="2547533">(</span><span class="ident" id="2547534">fd</span><span class="op" id="2547536">,</span>&nbsp;<span class="op" id="2547538">&amp;</span><span class="ident" id="2547539">msg</span><span class="op" id="2547542">,</span>&nbsp;<span class="ident" id="2547544">flags</span><span class="op" id="2547549">)</span><span class="op" id="2547550">;</span>&nbsp;<span class="ident" id="2547552">err</span>&nbsp;<span class="op" id="2547556">!=</span>&nbsp;<span class="ident" id="2547559">nil</span>&nbsp;<span class="op" id="2547563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547567">return</span>&nbsp;<span class="num" id="2547574">0</span><span class="op" id="2547575">,</span>&nbsp;<span class="ident" id="2547577">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547585">if</span>&nbsp;<span class="builtinfunc" id="2547588">len</span><span class="op" id="2547591">(</span><span class="ident" id="2547592">oob</span><span class="op" id="2547595">)</span>&nbsp;<span class="op" id="2547597">&gt;</span>&nbsp;<span class="num" id="2547599">0</span>&nbsp;<span class="op" id="2547601">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2547604">len</span><span class="op" id="2547607">(</span><span class="ident" id="2547608">p</span><span class="op" id="2547609">)</span>&nbsp;<span class="op" id="2547611">==</span>&nbsp;<span class="num" id="2547614">0</span>&nbsp;<span class="op" id="2547616">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547620">n</span>&nbsp;<span class="op" id="2547622">=</span>&nbsp;<span class="num" id="2547624">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547630">return</span>&nbsp;<span class="ident" id="2547637">n</span><span class="op" id="2547638">,</span>&nbsp;<span class="ident" id="2547640">nil</span><br>
<span class="lineno"></span><span class="op" id="2547644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="2547647">//&nbsp;BindToDevice&nbsp;binds&nbsp;the&nbsp;socket&nbsp;associated&nbsp;with&nbsp;fd&nbsp;to&nbsp;device.</span><br>
<span class="lineno"></span><span class="keyword" id="2547710">func</span>&nbsp;<span class="ident" id="2547715">BindToDevice</span><span class="op" id="2547727">(</span><span class="ident" id="2547728">fd</span>&nbsp;<span class="builtintype" id="2547731">int</span><span class="op" id="2547734">,</span>&nbsp;<span class="ident" id="2547736">device</span>&nbsp;<span class="builtintype" id="2547743">string</span><span class="op" id="2547749">)</span>&nbsp;<span class="op" id="2547751">(</span><span class="ident" id="2547752">err</span>&nbsp;<span class="builtintype" id="2547756">error</span><span class="op" id="2547761">)</span>&nbsp;<span class="op" id="2547763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547766">return</span>&nbsp;<span class="ident" id="2547773">SetsockoptString</span><span class="op" id="2547789">(</span><span class="ident" id="2547790">fd</span><span class="op" id="2547792">,</span>&nbsp;<span class="ident" id="2547794">SOL_SOCKET</span><span class="op" id="2547804">,</span>&nbsp;<span class="ident" id="2547806">SO_BINDTODEVICE</span><span class="op" id="2547821">,</span>&nbsp;<span class="ident" id="2547823">device</span><span class="op" id="2547829">)</span><br>
<span class="lineno"></span><span class="op" id="2547831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span><span class="comment" id="2547834">//sys&nbsp;&nbsp;&nbsp;&nbspptrace(request&nbsp;int,&nbsp;pid&nbsp;int,&nbsp;addr&nbsp;uintptr,&nbsp;data&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2547910">func</span>&nbsp;<span class="ident" id="2547915">ptracePeek</span><span class="op" id="2547925">(</span><span class="ident" id="2547926">req</span>&nbsp;<span class="builtintype" id="2547930">int</span><span class="op" id="2547933">,</span>&nbsp;<span class="ident" id="2547935">pid</span>&nbsp;<span class="builtintype" id="2547939">int</span><span class="op" id="2547942">,</span>&nbsp;<span class="ident" id="2547944">addr</span>&nbsp;<span class="builtintype" id="2547949">uintptr</span><span class="op" id="2547956">,</span>&nbsp;<span class="ident" id="2547958">out</span>&nbsp;<span class="op" id="2547962">[</span><span class="op" id="2547963">]</span><span class="builtintype" id="2547964">byte</span><span class="op" id="2547968">)</span>&nbsp;<span class="op" id="2547970">(</span><span class="ident" id="2547971">count</span>&nbsp;<span class="builtintype" id="2547977">int</span><span class="op" id="2547980">,</span>&nbsp;<span class="ident" id="2547982">err</span>&nbsp;<span class="builtintype" id="2547986">error</span><span class="op" id="2547991">)</span>&nbsp;<span class="op" id="2547993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2547996">//&nbsp;The&nbsp;peek&nbsp;requests&nbsp;are&nbsp;machine-size&nbsp;oriented,&nbsp;so&nbsp;we&nbsp;wrap&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548059">//&nbsp;to&nbsp;retrieve&nbsp;arbitrary-length&nbsp;data.</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548099">//&nbsp;The&nbsp;ptrace&nbsp;syscall&nbsp;differs&nbsp;from&nbsp;glibc&#39;s&nbsp;ptrace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548151">//&nbsp;Peeks&nbsp;returns&nbsp;the&nbsp;word&nbsp;in&nbsp;*data,&nbsp;not&nbsp;as&nbsp;the&nbsp;return&nbsp;value.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548214">var</span>&nbsp;<span class="ident" id="2548218">buf</span>&nbsp;<span class="op" id="2548222">[</span><span class="ident" id="2548223">sizeofPtr</span><span class="op" id="2548232">]</span><span class="builtintype" id="2548233">byte</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548240">//&nbsp;Leading&nbsp;edge.&nbsp;&nbsp;PEEKTEXT/PEEKDATA&nbsp;don&#39;t&nbsp;require&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548299">//&nbsp;access&nbsp;(PEEKUSER&nbsp;warns&nbsp;that&nbsp;it&nbsp;might),&nbsp;but&nbsp;if&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548358">//&nbsp;align&nbsp;our&nbsp;reads,&nbsp;we&nbsp;might&nbsp;straddle&nbsp;an&nbsp;unmapped&nbsp;page</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548414">//&nbsp;boundary&nbsp;and&nbsp;not&nbsp;get&nbsp;the&nbsp;bytes&nbsp;leading&nbsp;up&nbsp;to&nbsp;the&nbsp;page</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548472">//&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548486">n</span>&nbsp;<span class="op" id="2548488">:=</span>&nbsp;<span class="num" id="2548491">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548494">if</span>&nbsp;<span class="ident" id="2548497">addr</span><span class="op" id="2548501">%</span><span class="ident" id="2548502">sizeofPtr</span>&nbsp;<span class="op" id="2548512">!=</span>&nbsp;<span class="num" id="2548515">0</span>&nbsp;<span class="op" id="2548517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548521">err</span>&nbsp;<span class="op" id="2548525">=</span>&nbsp;<span class="ident" id="2548527">ptrace</span><span class="op" id="2548533">(</span><span class="ident" id="2548534">req</span><span class="op" id="2548537">,</span>&nbsp;<span class="ident" id="2548539">pid</span><span class="op" id="2548542">,</span>&nbsp;<span class="ident" id="2548544">addr</span><span class="op" id="2548548">-</span><span class="ident" id="2548549">addr</span><span class="op" id="2548553">%</span><span class="ident" id="2548554">sizeofPtr</span><span class="op" id="2548563">,</span>&nbsp;<span class="builtintype" id="2548565">uintptr</span><span class="op" id="2548572">(</span><span class="ident" id="2548573">unsafe</span><span class="op" id="2548579">.</span><span class="ident" id="2548580">Pointer</span><span class="op" id="2548587">(</span><span class="op" id="2548588">&amp;</span><span class="ident" id="2548589">buf</span><span class="op" id="2548592">[</span><span class="num" id="2548593">0</span><span class="op" id="2548594">]</span><span class="op" id="2548595">)</span><span class="op" id="2548596">)</span><span class="op" id="2548597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548601">if</span>&nbsp;<span class="ident" id="2548604">err</span>&nbsp;<span class="op" id="2548608">!=</span>&nbsp;<span class="ident" id="2548611">nil</span>&nbsp;<span class="op" id="2548615">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548620">return</span>&nbsp;<span class="num" id="2548627">0</span><span class="op" id="2548628">,</span>&nbsp;<span class="ident" id="2548630">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548640">n</span>&nbsp;<span class="op" id="2548642">+=</span>&nbsp;<span class="builtinfunc" id="2548645">copy</span><span class="op" id="2548649">(</span><span class="ident" id="2548650">out</span><span class="op" id="2548653">,</span>&nbsp;<span class="ident" id="2548655">buf</span><span class="op" id="2548658">[</span><span class="ident" id="2548659">addr</span><span class="op" id="2548663">%</span><span class="ident" id="2548664">sizeofPtr</span><span class="op" id="2548673">:</span><span class="op" id="2548674">]</span><span class="op" id="2548675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548679">out</span>&nbsp;<span class="op" id="2548683">=</span>&nbsp;<span class="ident" id="2548685">out</span><span class="op" id="2548688">[</span><span class="ident" id="2548689">n</span><span class="op" id="2548690">:</span><span class="op" id="2548691">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548694">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548698">//&nbsp;Remainder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548713">for</span>&nbsp;<span class="builtinfunc" id="2548717">len</span><span class="op" id="2548720">(</span><span class="ident" id="2548721">out</span><span class="op" id="2548724">)</span>&nbsp;<span class="op" id="2548726">&gt;</span>&nbsp;<span class="num" id="2548728">0</span>&nbsp;<span class="op" id="2548730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548734">//&nbsp;We&nbsp;use&nbsp;an&nbsp;internal&nbsp;buffer&nbsp;to&nbsp;guarantee&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548789">//&nbsp;It&#39;s&nbsp;not&nbsp;documented&nbsp;if&nbsp;this&nbsp;is&nbsp;necessary,&nbsp;but&nbsp;we&#39;re&nbsp;paranoid.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548856">err</span>&nbsp;<span class="op" id="2548860">=</span>&nbsp;<span class="ident" id="2548862">ptrace</span><span class="op" id="2548868">(</span><span class="ident" id="2548869">req</span><span class="op" id="2548872">,</span>&nbsp;<span class="ident" id="2548874">pid</span><span class="op" id="2548877">,</span>&nbsp;<span class="ident" id="2548879">addr</span><span class="op" id="2548883">+</span><span class="builtintype" id="2548884">uintptr</span><span class="op" id="2548891">(</span><span class="ident" id="2548892">n</span><span class="op" id="2548893">)</span><span class="op" id="2548894">,</span>&nbsp;<span class="builtintype" id="2548896">uintptr</span><span class="op" id="2548903">(</span><span class="ident" id="2548904">unsafe</span><span class="op" id="2548910">.</span><span class="ident" id="2548911">Pointer</span><span class="op" id="2548918">(</span><span class="op" id="2548919">&amp;</span><span class="ident" id="2548920">buf</span><span class="op" id="2548923">[</span><span class="num" id="2548924">0</span><span class="op" id="2548925">]</span><span class="op" id="2548926">)</span><span class="op" id="2548927">)</span><span class="op" id="2548928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548932">if</span>&nbsp;<span class="ident" id="2548935">err</span>&nbsp;<span class="op" id="2548939">!=</span>&nbsp;<span class="ident" id="2548942">nil</span>&nbsp;<span class="op" id="2548946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548951">return</span>&nbsp;<span class="ident" id="2548958">n</span><span class="op" id="2548959">,</span>&nbsp;<span class="ident" id="2548961">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548971">copied</span>&nbsp;<span class="op" id="2548978">:=</span>&nbsp;<span class="builtinfunc" id="2548981">copy</span><span class="op" id="2548985">(</span><span class="ident" id="2548986">out</span><span class="op" id="2548989">,</span>&nbsp;<span class="ident" id="2548991">buf</span><span class="op" id="2548994">[</span><span class="num" id="2548995">0</span><span class="op" id="2548996">:</span><span class="op" id="2548997">]</span><span class="op" id="2548998">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549002">n</span>&nbsp;<span class="op" id="2549004">+=</span>&nbsp;<span class="ident" id="2549007">copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549016">out</span>&nbsp;<span class="op" id="2549020">=</span>&nbsp;<span class="ident" id="2549022">out</span><span class="op" id="2549025">[</span><span class="ident" id="2549026">copied</span><span class="op" id="2549032">:</span><span class="op" id="2549033">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2549036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549040">return</span>&nbsp;<span class="ident" id="2549047">n</span><span class="op" id="2549048">,</span>&nbsp;<span class="ident" id="2549050">nil</span><br>
<span class="lineno">620</span><span class="op" id="2549054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2549057">func</span>&nbsp;<span class="ident" id="2549062">PtracePeekText</span><span class="op" id="2549076">(</span><span class="ident" id="2549077">pid</span>&nbsp;<span class="builtintype" id="2549081">int</span><span class="op" id="2549084">,</span>&nbsp;<span class="ident" id="2549086">addr</span>&nbsp;<span class="builtintype" id="2549091">uintptr</span><span class="op" id="2549098">,</span>&nbsp;<span class="ident" id="2549100">out</span>&nbsp;<span class="op" id="2549104">[</span><span class="op" id="2549105">]</span><span class="builtintype" id="2549106">byte</span><span class="op" id="2549110">)</span>&nbsp;<span class="op" id="2549112">(</span><span class="ident" id="2549113">count</span>&nbsp;<span class="builtintype" id="2549119">int</span><span class="op" id="2549122">,</span>&nbsp;<span class="ident" id="2549124">err</span>&nbsp;<span class="builtintype" id="2549128">error</span><span class="op" id="2549133">)</span>&nbsp;<span class="op" id="2549135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549138">return</span>&nbsp;<span class="ident" id="2549145">ptracePeek</span><span class="op" id="2549155">(</span><span class="ident" id="2549156">PTRACE_PEEKTEXT</span><span class="op" id="2549171">,</span>&nbsp;<span class="ident" id="2549173">pid</span><span class="op" id="2549176">,</span>&nbsp;<span class="ident" id="2549178">addr</span><span class="op" id="2549182">,</span>&nbsp;<span class="ident" id="2549184">out</span><span class="op" id="2549187">)</span><br>
<span class="lineno"></span><span class="op" id="2549189">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="2549192">func</span>&nbsp;<span class="ident" id="2549197">PtracePeekData</span><span class="op" id="2549211">(</span><span class="ident" id="2549212">pid</span>&nbsp;<span class="builtintype" id="2549216">int</span><span class="op" id="2549219">,</span>&nbsp;<span class="ident" id="2549221">addr</span>&nbsp;<span class="builtintype" id="2549226">uintptr</span><span class="op" id="2549233">,</span>&nbsp;<span class="ident" id="2549235">out</span>&nbsp;<span class="op" id="2549239">[</span><span class="op" id="2549240">]</span><span class="builtintype" id="2549241">byte</span><span class="op" id="2549245">)</span>&nbsp;<span class="op" id="2549247">(</span><span class="ident" id="2549248">count</span>&nbsp;<span class="builtintype" id="2549254">int</span><span class="op" id="2549257">,</span>&nbsp;<span class="ident" id="2549259">err</span>&nbsp;<span class="builtintype" id="2549263">error</span><span class="op" id="2549268">)</span>&nbsp;<span class="op" id="2549270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549273">return</span>&nbsp;<span class="ident" id="2549280">ptracePeek</span><span class="op" id="2549290">(</span><span class="ident" id="2549291">PTRACE_PEEKDATA</span><span class="op" id="2549306">,</span>&nbsp;<span class="ident" id="2549308">pid</span><span class="op" id="2549311">,</span>&nbsp;<span class="ident" id="2549313">addr</span><span class="op" id="2549317">,</span>&nbsp;<span class="ident" id="2549319">out</span><span class="op" id="2549322">)</span><br>
<span class="lineno"></span><span class="op" id="2549324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="keyword" id="2549327">func</span>&nbsp;<span class="ident" id="2549332">ptracePoke</span><span class="op" id="2549342">(</span><span class="ident" id="2549343">pokeReq</span>&nbsp;<span class="builtintype" id="2549351">int</span><span class="op" id="2549354">,</span>&nbsp;<span class="ident" id="2549356">peekReq</span>&nbsp;<span class="builtintype" id="2549364">int</span><span class="op" id="2549367">,</span>&nbsp;<span class="ident" id="2549369">pid</span>&nbsp;<span class="builtintype" id="2549373">int</span><span class="op" id="2549376">,</span>&nbsp;<span class="ident" id="2549378">addr</span>&nbsp;<span class="builtintype" id="2549383">uintptr</span><span class="op" id="2549390">,</span>&nbsp;<span class="ident" id="2549392">data</span>&nbsp;<span class="op" id="2549397">[</span><span class="op" id="2549398">]</span><span class="builtintype" id="2549399">byte</span><span class="op" id="2549403">)</span>&nbsp;<span class="op" id="2549405">(</span><span class="ident" id="2549406">count</span>&nbsp;<span class="builtintype" id="2549412">int</span><span class="op" id="2549415">,</span>&nbsp;<span class="ident" id="2549417">err</span>&nbsp;<span class="builtintype" id="2549421">error</span><span class="op" id="2549426">)</span>&nbsp;<span class="op" id="2549428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2549431">//&nbsp;As&nbsp;for&nbsp;ptracePeek,&nbsp;we&nbsp;need&nbsp;to&nbsp;align&nbsp;our&nbsp;accesses&nbsp;to&nbsp;deal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2549492">//&nbsp;with&nbsp;the&nbsp;possibility&nbsp;of&nbsp;straddling&nbsp;an&nbsp;invalid&nbsp;page.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2549549">//&nbsp;Leading&nbsp;edge.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549567">n</span>&nbsp;<span class="op" id="2549569">:=</span>&nbsp;<span class="num" id="2549572">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549575">if</span>&nbsp;<span class="ident" id="2549578">addr</span><span class="op" id="2549582">%</span><span class="ident" id="2549583">sizeofPtr</span>&nbsp;<span class="op" id="2549593">!=</span>&nbsp;<span class="num" id="2549596">0</span>&nbsp;<span class="op" id="2549598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549602">var</span>&nbsp;<span class="ident" id="2549606">buf</span>&nbsp;<span class="op" id="2549610">[</span><span class="ident" id="2549611">sizeofPtr</span><span class="op" id="2549620">]</span><span class="builtintype" id="2549621">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549628">err</span>&nbsp;<span class="op" id="2549632">=</span>&nbsp;<span class="ident" id="2549634">ptrace</span><span class="op" id="2549640">(</span><span class="ident" id="2549641">peekReq</span><span class="op" id="2549648">,</span>&nbsp;<span class="ident" id="2549650">pid</span><span class="op" id="2549653">,</span>&nbsp;<span class="ident" id="2549655">addr</span><span class="op" id="2549659">-</span><span class="ident" id="2549660">addr</span><span class="op" id="2549664">%</span><span class="ident" id="2549665">sizeofPtr</span><span class="op" id="2549674">,</span>&nbsp;<span class="builtintype" id="2549676">uintptr</span><span class="op" id="2549683">(</span><span class="ident" id="2549684">unsafe</span><span class="op" id="2549690">.</span><span class="ident" id="2549691">Pointer</span><span class="op" id="2549698">(</span><span class="op" id="2549699">&amp;</span><span class="ident" id="2549700">buf</span><span class="op" id="2549703">[</span><span class="num" id="2549704">0</span><span class="op" id="2549705">]</span><span class="op" id="2549706">)</span><span class="op" id="2549707">)</span><span class="op" id="2549708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549712">if</span>&nbsp;<span class="ident" id="2549715">err</span>&nbsp;<span class="op" id="2549719">!=</span>&nbsp;<span class="ident" id="2549722">nil</span>&nbsp;<span class="op" id="2549726">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549731">return</span>&nbsp;<span class="num" id="2549738">0</span><span class="op" id="2549739">,</span>&nbsp;<span class="ident" id="2549741">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2549747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549751">n</span>&nbsp;<span class="op" id="2549753">+=</span>&nbsp;<span class="builtinfunc" id="2549756">copy</span><span class="op" id="2549760">(</span><span class="ident" id="2549761">buf</span><span class="op" id="2549764">[</span><span class="ident" id="2549765">addr</span><span class="op" id="2549769">%</span><span class="ident" id="2549770">sizeofPtr</span><span class="op" id="2549779">:</span><span class="op" id="2549780">]</span><span class="op" id="2549781">,</span>&nbsp;<span class="ident" id="2549783">data</span><span class="op" id="2549787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549791">word</span>&nbsp;<span class="op" id="2549796">:=</span>&nbsp;<span class="op" id="2549799">*</span><span class="op" id="2549800">(</span><span class="op" id="2549801">(</span><span class="op" id="2549802">*</span><span class="builtintype" id="2549803">uintptr</span><span class="op" id="2549810">)</span><span class="op" id="2549811">(</span><span class="ident" id="2549812">unsafe</span><span class="op" id="2549818">.</span><span class="ident" id="2549819">Pointer</span><span class="op" id="2549826">(</span><span class="op" id="2549827">&amp;</span><span class="ident" id="2549828">buf</span><span class="op" id="2549831">[</span><span class="num" id="2549832">0</span><span class="op" id="2549833">]</span><span class="op" id="2549834">)</span><span class="op" id="2549835">)</span><span class="op" id="2549836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549840">err</span>&nbsp;<span class="op" id="2549844">=</span>&nbsp;<span class="ident" id="2549846">ptrace</span><span class="op" id="2549852">(</span><span class="ident" id="2549853">pokeReq</span><span class="op" id="2549860">,</span>&nbsp;<span class="ident" id="2549862">pid</span><span class="op" id="2549865">,</span>&nbsp;<span class="ident" id="2549867">addr</span><span class="op" id="2549871">-</span><span class="ident" id="2549872">addr</span><span class="op" id="2549876">%</span><span class="ident" id="2549877">sizeofPtr</span><span class="op" id="2549886">,</span>&nbsp;<span class="ident" id="2549888">word</span><span class="op" id="2549892">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549896">if</span>&nbsp;<span class="ident" id="2549899">err</span>&nbsp;<span class="op" id="2549903">!=</span>&nbsp;<span class="ident" id="2549906">nil</span>&nbsp;<span class="op" id="2549910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549915">return</span>&nbsp;<span class="num" id="2549922">0</span><span class="op" id="2549923">,</span>&nbsp;<span class="ident" id="2549925">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2549931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549935">data</span>&nbsp;<span class="op" id="2549940">=</span>&nbsp;<span class="ident" id="2549942">data</span><span class="op" id="2549946">[</span><span class="ident" id="2549947">n</span><span class="op" id="2549948">:</span><span class="op" id="2549949">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2549952">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2549956">//&nbsp;Interior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549970">for</span>&nbsp;<span class="builtinfunc" id="2549974">len</span><span class="op" id="2549977">(</span><span class="ident" id="2549978">data</span><span class="op" id="2549982">)</span>&nbsp;<span class="op" id="2549984">&gt;</span>&nbsp;<span class="ident" id="2549986">sizeofPtr</span>&nbsp;<span class="op" id="2549996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550000">word</span>&nbsp;<span class="op" id="2550005">:=</span>&nbsp;<span class="op" id="2550008">*</span><span class="op" id="2550009">(</span><span class="op" id="2550010">(</span><span class="op" id="2550011">*</span><span class="builtintype" id="2550012">uintptr</span><span class="op" id="2550019">)</span><span class="op" id="2550020">(</span><span class="ident" id="2550021">unsafe</span><span class="op" id="2550027">.</span><span class="ident" id="2550028">Pointer</span><span class="op" id="2550035">(</span><span class="op" id="2550036">&amp;</span><span class="ident" id="2550037">data</span><span class="op" id="2550041">[</span><span class="num" id="2550042">0</span><span class="op" id="2550043">]</span><span class="op" id="2550044">)</span><span class="op" id="2550045">)</span><span class="op" id="2550046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550050">err</span>&nbsp;<span class="op" id="2550054">=</span>&nbsp;<span class="ident" id="2550056">ptrace</span><span class="op" id="2550062">(</span><span class="ident" id="2550063">pokeReq</span><span class="op" id="2550070">,</span>&nbsp;<span class="ident" id="2550072">pid</span><span class="op" id="2550075">,</span>&nbsp;<span class="ident" id="2550077">addr</span><span class="op" id="2550081">+</span><span class="builtintype" id="2550082">uintptr</span><span class="op" id="2550089">(</span><span class="ident" id="2550090">n</span><span class="op" id="2550091">)</span><span class="op" id="2550092">,</span>&nbsp;<span class="ident" id="2550094">word</span><span class="op" id="2550098">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550102">if</span>&nbsp;<span class="ident" id="2550105">err</span>&nbsp;<span class="op" id="2550109">!=</span>&nbsp;<span class="ident" id="2550112">nil</span>&nbsp;<span class="op" id="2550116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550121">return</span>&nbsp;<span class="ident" id="2550128">n</span><span class="op" id="2550129">,</span>&nbsp;<span class="ident" id="2550131">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2550137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550141">n</span>&nbsp;<span class="op" id="2550143">+=</span>&nbsp;<span class="ident" id="2550146">sizeofPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550158">data</span>&nbsp;<span class="op" id="2550163">=</span>&nbsp;<span class="ident" id="2550165">data</span><span class="op" id="2550169">[</span><span class="ident" id="2550170">sizeofPtr</span><span class="op" id="2550179">:</span><span class="op" id="2550180">]</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2550183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2550187">//&nbsp;Trailing&nbsp;edge.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550206">if</span>&nbsp;<span class="builtinfunc" id="2550209">len</span><span class="op" id="2550212">(</span><span class="ident" id="2550213">data</span><span class="op" id="2550217">)</span>&nbsp;<span class="op" id="2550219">&gt;</span>&nbsp;<span class="num" id="2550221">0</span>&nbsp;<span class="op" id="2550223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550227">var</span>&nbsp;<span class="ident" id="2550231">buf</span>&nbsp;<span class="op" id="2550235">[</span><span class="ident" id="2550236">sizeofPtr</span><span class="op" id="2550245">]</span><span class="builtintype" id="2550246">byte</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550253">err</span>&nbsp;<span class="op" id="2550257">=</span>&nbsp;<span class="ident" id="2550259">ptrace</span><span class="op" id="2550265">(</span><span class="ident" id="2550266">peekReq</span><span class="op" id="2550273">,</span>&nbsp;<span class="ident" id="2550275">pid</span><span class="op" id="2550278">,</span>&nbsp;<span class="ident" id="2550280">addr</span><span class="op" id="2550284">+</span><span class="builtintype" id="2550285">uintptr</span><span class="op" id="2550292">(</span><span class="ident" id="2550293">n</span><span class="op" id="2550294">)</span><span class="op" id="2550295">,</span>&nbsp;<span class="builtintype" id="2550297">uintptr</span><span class="op" id="2550304">(</span><span class="ident" id="2550305">unsafe</span><span class="op" id="2550311">.</span><span class="ident" id="2550312">Pointer</span><span class="op" id="2550319">(</span><span class="op" id="2550320">&amp;</span><span class="ident" id="2550321">buf</span><span class="op" id="2550324">[</span><span class="num" id="2550325">0</span><span class="op" id="2550326">]</span><span class="op" id="2550327">)</span><span class="op" id="2550328">)</span><span class="op" id="2550329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550333">if</span>&nbsp;<span class="ident" id="2550336">err</span>&nbsp;<span class="op" id="2550340">!=</span>&nbsp;<span class="ident" id="2550343">nil</span>&nbsp;<span class="op" id="2550347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550352">return</span>&nbsp;<span class="ident" id="2550359">n</span><span class="op" id="2550360">,</span>&nbsp;<span class="ident" id="2550362">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2550368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2550372">copy</span><span class="op" id="2550376">(</span><span class="ident" id="2550377">buf</span><span class="op" id="2550380">[</span><span class="num" id="2550381">0</span><span class="op" id="2550382">:</span><span class="op" id="2550383">]</span><span class="op" id="2550384">,</span>&nbsp;<span class="ident" id="2550386">data</span><span class="op" id="2550390">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550394">word</span>&nbsp;<span class="op" id="2550399">:=</span>&nbsp;<span class="op" id="2550402">*</span><span class="op" id="2550403">(</span><span class="op" id="2550404">(</span><span class="op" id="2550405">*</span><span class="builtintype" id="2550406">uintptr</span><span class="op" id="2550413">)</span><span class="op" id="2550414">(</span><span class="ident" id="2550415">unsafe</span><span class="op" id="2550421">.</span><span class="ident" id="2550422">Pointer</span><span class="op" id="2550429">(</span><span class="op" id="2550430">&amp;</span><span class="ident" id="2550431">buf</span><span class="op" id="2550434">[</span><span class="num" id="2550435">0</span><span class="op" id="2550436">]</span><span class="op" id="2550437">)</span><span class="op" id="2550438">)</span><span class="op" id="2550439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550443">err</span>&nbsp;<span class="op" id="2550447">=</span>&nbsp;<span class="ident" id="2550449">ptrace</span><span class="op" id="2550455">(</span><span class="ident" id="2550456">pokeReq</span><span class="op" id="2550463">,</span>&nbsp;<span class="ident" id="2550465">pid</span><span class="op" id="2550468">,</span>&nbsp;<span class="ident" id="2550470">addr</span><span class="op" id="2550474">+</span><span class="builtintype" id="2550475">uintptr</span><span class="op" id="2550482">(</span><span class="ident" id="2550483">n</span><span class="op" id="2550484">)</span><span class="op" id="2550485">,</span>&nbsp;<span class="ident" id="2550487">word</span><span class="op" id="2550491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550495">if</span>&nbsp;<span class="ident" id="2550498">err</span>&nbsp;<span class="op" id="2550502">!=</span>&nbsp;<span class="ident" id="2550505">nil</span>&nbsp;<span class="op" id="2550509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550514">return</span>&nbsp;<span class="ident" id="2550521">n</span><span class="op" id="2550522">,</span>&nbsp;<span class="ident" id="2550524">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2550530">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550534">n</span>&nbsp;<span class="op" id="2550536">+=</span>&nbsp;<span class="builtinfunc" id="2550539">len</span><span class="op" id="2550542">(</span><span class="ident" id="2550543">data</span><span class="op" id="2550547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2550550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550554">return</span>&nbsp;<span class="ident" id="2550561">n</span><span class="op" id="2550562">,</span>&nbsp;<span class="ident" id="2550564">nil</span><br>
<span class="lineno"></span><span class="op" id="2550568">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="2550571">func</span>&nbsp;<span class="ident" id="2550576">PtracePokeText</span><span class="op" id="2550590">(</span><span class="ident" id="2550591">pid</span>&nbsp;<span class="builtintype" id="2550595">int</span><span class="op" id="2550598">,</span>&nbsp;<span class="ident" id="2550600">addr</span>&nbsp;<span class="builtintype" id="2550605">uintptr</span><span class="op" id="2550612">,</span>&nbsp;<span class="ident" id="2550614">data</span>&nbsp;<span class="op" id="2550619">[</span><span class="op" id="2550620">]</span><span class="builtintype" id="2550621">byte</span><span class="op" id="2550625">)</span>&nbsp;<span class="op" id="2550627">(</span><span class="ident" id="2550628">count</span>&nbsp;<span class="builtintype" id="2550634">int</span><span class="op" id="2550637">,</span>&nbsp;<span class="ident" id="2550639">err</span>&nbsp;<span class="builtintype" id="2550643">error</span><span class="op" id="2550648">)</span>&nbsp;<span class="op" id="2550650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550653">return</span>&nbsp;<span class="ident" id="2550660">ptracePoke</span><span class="op" id="2550670">(</span><span class="ident" id="2550671">PTRACE_POKETEXT</span><span class="op" id="2550686">,</span>&nbsp;<span class="ident" id="2550688">PTRACE_PEEKTEXT</span><span class="op" id="2550703">,</span>&nbsp;<span class="ident" id="2550705">pid</span><span class="op" id="2550708">,</span>&nbsp;<span class="ident" id="2550710">addr</span><span class="op" id="2550714">,</span>&nbsp;<span class="ident" id="2550716">data</span><span class="op" id="2550720">)</span><br>
<span class="lineno"></span><span class="op" id="2550722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="keyword" id="2550725">func</span>&nbsp;<span class="ident" id="2550730">PtracePokeData</span><span class="op" id="2550744">(</span><span class="ident" id="2550745">pid</span>&nbsp;<span class="builtintype" id="2550749">int</span><span class="op" id="2550752">,</span>&nbsp;<span class="ident" id="2550754">addr</span>&nbsp;<span class="builtintype" id="2550759">uintptr</span><span class="op" id="2550766">,</span>&nbsp;<span class="ident" id="2550768">data</span>&nbsp;<span class="op" id="2550773">[</span><span class="op" id="2550774">]</span><span class="builtintype" id="2550775">byte</span><span class="op" id="2550779">)</span>&nbsp;<span class="op" id="2550781">(</span><span class="ident" id="2550782">count</span>&nbsp;<span class="builtintype" id="2550788">int</span><span class="op" id="2550791">,</span>&nbsp;<span class="ident" id="2550793">err</span>&nbsp;<span class="builtintype" id="2550797">error</span><span class="op" id="2550802">)</span>&nbsp;<span class="op" id="2550804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550807">return</span>&nbsp;<span class="ident" id="2550814">ptracePoke</span><span class="op" id="2550824">(</span><span class="ident" id="2550825">PTRACE_POKEDATA</span><span class="op" id="2550840">,</span>&nbsp;<span class="ident" id="2550842">PTRACE_PEEKDATA</span><span class="op" id="2550857">,</span>&nbsp;<span class="ident" id="2550859">pid</span><span class="op" id="2550862">,</span>&nbsp;<span class="ident" id="2550864">addr</span><span class="op" id="2550868">,</span>&nbsp;<span class="ident" id="2550870">data</span><span class="op" id="2550874">)</span><br>
<span class="lineno"></span><span class="op" id="2550876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550879">func</span>&nbsp;<span class="ident" id="2550884">PtraceGetRegs</span><span class="op" id="2550897">(</span><span class="ident" id="2550898">pid</span>&nbsp;<span class="builtintype" id="2550902">int</span><span class="op" id="2550905">,</span>&nbsp;<span class="ident" id="2550907">regsout</span>&nbsp;<span class="op" id="2550915">*</span><span class="ident" id="2550916">PtraceRegs</span><span class="op" id="2550926">)</span>&nbsp;<span class="op" id="2550928">(</span><span class="ident" id="2550929">err</span>&nbsp;<span class="builtintype" id="2550933">error</span><span class="op" id="2550938">)</span>&nbsp;<span class="op" id="2550940">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550943">return</span>&nbsp;<span class="ident" id="2550950">ptrace</span><span class="op" id="2550956">(</span><span class="ident" id="2550957">PTRACE_GETREGS</span><span class="op" id="2550971">,</span>&nbsp;<span class="ident" id="2550973">pid</span><span class="op" id="2550976">,</span>&nbsp;<span class="num" id="2550978">0</span><span class="op" id="2550979">,</span>&nbsp;<span class="builtintype" id="2550981">uintptr</span><span class="op" id="2550988">(</span><span class="ident" id="2550989">unsafe</span><span class="op" id="2550995">.</span><span class="ident" id="2550996">Pointer</span><span class="op" id="2551003">(</span><span class="ident" id="2551004">regsout</span><span class="op" id="2551011">)</span><span class="op" id="2551012">)</span><span class="op" id="2551013">)</span><br>
<span class="lineno"></span><span class="op" id="2551015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551018">func</span>&nbsp;<span class="ident" id="2551023">PtraceSetRegs</span><span class="op" id="2551036">(</span><span class="ident" id="2551037">pid</span>&nbsp;<span class="builtintype" id="2551041">int</span><span class="op" id="2551044">,</span>&nbsp;<span class="ident" id="2551046">regs</span>&nbsp;<span class="op" id="2551051">*</span><span class="ident" id="2551052">PtraceRegs</span><span class="op" id="2551062">)</span>&nbsp;<span class="op" id="2551064">(</span><span class="ident" id="2551065">err</span>&nbsp;<span class="builtintype" id="2551069">error</span><span class="op" id="2551074">)</span>&nbsp;<span class="op" id="2551076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551079">return</span>&nbsp;<span class="ident" id="2551086">ptrace</span><span class="op" id="2551092">(</span><span class="ident" id="2551093">PTRACE_SETREGS</span><span class="op" id="2551107">,</span>&nbsp;<span class="ident" id="2551109">pid</span><span class="op" id="2551112">,</span>&nbsp;<span class="num" id="2551114">0</span><span class="op" id="2551115">,</span>&nbsp;<span class="builtintype" id="2551117">uintptr</span><span class="op" id="2551124">(</span><span class="ident" id="2551125">unsafe</span><span class="op" id="2551131">.</span><span class="ident" id="2551132">Pointer</span><span class="op" id="2551139">(</span><span class="ident" id="2551140">regs</span><span class="op" id="2551144">)</span><span class="op" id="2551145">)</span><span class="op" id="2551146">)</span><br>
<span class="lineno">695</span><span class="op" id="2551148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551151">func</span>&nbsp;<span class="ident" id="2551156">PtraceSetOptions</span><span class="op" id="2551172">(</span><span class="ident" id="2551173">pid</span>&nbsp;<span class="builtintype" id="2551177">int</span><span class="op" id="2551180">,</span>&nbsp;<span class="ident" id="2551182">options</span>&nbsp;<span class="builtintype" id="2551190">int</span><span class="op" id="2551193">)</span>&nbsp;<span class="op" id="2551195">(</span><span class="ident" id="2551196">err</span>&nbsp;<span class="builtintype" id="2551200">error</span><span class="op" id="2551205">)</span>&nbsp;<span class="op" id="2551207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551210">return</span>&nbsp;<span class="ident" id="2551217">ptrace</span><span class="op" id="2551223">(</span><span class="ident" id="2551224">PTRACE_SETOPTIONS</span><span class="op" id="2551241">,</span>&nbsp;<span class="ident" id="2551243">pid</span><span class="op" id="2551246">,</span>&nbsp;<span class="num" id="2551248">0</span><span class="op" id="2551249">,</span>&nbsp;<span class="builtintype" id="2551251">uintptr</span><span class="op" id="2551258">(</span><span class="ident" id="2551259">options</span><span class="op" id="2551266">)</span><span class="op" id="2551267">)</span><br>
<span class="lineno"></span><span class="op" id="2551269">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="2551272">func</span>&nbsp;<span class="ident" id="2551277">PtraceGetEventMsg</span><span class="op" id="2551294">(</span><span class="ident" id="2551295">pid</span>&nbsp;<span class="builtintype" id="2551299">int</span><span class="op" id="2551302">)</span>&nbsp;<span class="op" id="2551304">(</span><span class="ident" id="2551305">msg</span>&nbsp;<span class="builtintype" id="2551309">uint</span><span class="op" id="2551313">,</span>&nbsp;<span class="ident" id="2551315">err</span>&nbsp;<span class="builtintype" id="2551319">error</span><span class="op" id="2551324">)</span>&nbsp;<span class="op" id="2551326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551329">var</span>&nbsp;<span class="ident" id="2551333">data</span>&nbsp;<span class="ident" id="2551338">_C_long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551347">err</span>&nbsp;<span class="op" id="2551351">=</span>&nbsp;<span class="ident" id="2551353">ptrace</span><span class="op" id="2551359">(</span><span class="ident" id="2551360">PTRACE_GETEVENTMSG</span><span class="op" id="2551378">,</span>&nbsp;<span class="ident" id="2551380">pid</span><span class="op" id="2551383">,</span>&nbsp;<span class="num" id="2551385">0</span><span class="op" id="2551386">,</span>&nbsp;<span class="builtintype" id="2551388">uintptr</span><span class="op" id="2551395">(</span><span class="ident" id="2551396">unsafe</span><span class="op" id="2551402">.</span><span class="ident" id="2551403">Pointer</span><span class="op" id="2551410">(</span><span class="op" id="2551411">&amp;</span><span class="ident" id="2551412">data</span><span class="op" id="2551416">)</span><span class="op" id="2551417">)</span><span class="op" id="2551418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551421">msg</span>&nbsp;<span class="op" id="2551425">=</span>&nbsp;<span class="builtintype" id="2551427">uint</span><span class="op" id="2551431">(</span><span class="ident" id="2551432">data</span><span class="op" id="2551436">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551439">return</span><br>
<span class="lineno"></span><span class="op" id="2551446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551449">func</span>&nbsp;<span class="ident" id="2551454">PtraceCont</span><span class="op" id="2551464">(</span><span class="ident" id="2551465">pid</span>&nbsp;<span class="builtintype" id="2551469">int</span><span class="op" id="2551472">,</span>&nbsp;<span class="ident" id="2551474">signal</span>&nbsp;<span class="builtintype" id="2551481">int</span><span class="op" id="2551484">)</span>&nbsp;<span class="op" id="2551486">(</span><span class="ident" id="2551487">err</span>&nbsp;<span class="builtintype" id="2551491">error</span><span class="op" id="2551496">)</span>&nbsp;<span class="op" id="2551498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551501">return</span>&nbsp;<span class="ident" id="2551508">ptrace</span><span class="op" id="2551514">(</span><span class="ident" id="2551515">PTRACE_CONT</span><span class="op" id="2551526">,</span>&nbsp;<span class="ident" id="2551528">pid</span><span class="op" id="2551531">,</span>&nbsp;<span class="num" id="2551533">0</span><span class="op" id="2551534">,</span>&nbsp;<span class="builtintype" id="2551536">uintptr</span><span class="op" id="2551543">(</span><span class="ident" id="2551544">signal</span><span class="op" id="2551550">)</span><span class="op" id="2551551">)</span><br>
<span class="lineno">710</span><span class="op" id="2551553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551556">func</span>&nbsp;<span class="ident" id="2551561">PtraceSyscall</span><span class="op" id="2551574">(</span><span class="ident" id="2551575">pid</span>&nbsp;<span class="builtintype" id="2551579">int</span><span class="op" id="2551582">,</span>&nbsp;<span class="ident" id="2551584">signal</span>&nbsp;<span class="builtintype" id="2551591">int</span><span class="op" id="2551594">)</span>&nbsp;<span class="op" id="2551596">(</span><span class="ident" id="2551597">err</span>&nbsp;<span class="builtintype" id="2551601">error</span><span class="op" id="2551606">)</span>&nbsp;<span class="op" id="2551608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551611">return</span>&nbsp;<span class="ident" id="2551618">ptrace</span><span class="op" id="2551624">(</span><span class="ident" id="2551625">PTRACE_SYSCALL</span><span class="op" id="2551639">,</span>&nbsp;<span class="ident" id="2551641">pid</span><span class="op" id="2551644">,</span>&nbsp;<span class="num" id="2551646">0</span><span class="op" id="2551647">,</span>&nbsp;<span class="builtintype" id="2551649">uintptr</span><span class="op" id="2551656">(</span><span class="ident" id="2551657">signal</span><span class="op" id="2551663">)</span><span class="op" id="2551664">)</span><br>
<span class="lineno"></span><span class="op" id="2551666">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="2551669">func</span>&nbsp;<span class="ident" id="2551674">PtraceSingleStep</span><span class="op" id="2551690">(</span><span class="ident" id="2551691">pid</span>&nbsp;<span class="builtintype" id="2551695">int</span><span class="op" id="2551698">)</span>&nbsp;<span class="op" id="2551700">(</span><span class="ident" id="2551701">err</span>&nbsp;<span class="builtintype" id="2551705">error</span><span class="op" id="2551710">)</span>&nbsp;<span class="op" id="2551712">{</span>&nbsp;<span class="keyword" id="2551714">return</span>&nbsp;<span class="ident" id="2551721">ptrace</span><span class="op" id="2551727">(</span><span class="ident" id="2551728">PTRACE_SINGLESTEP</span><span class="op" id="2551745">,</span>&nbsp;<span class="ident" id="2551747">pid</span><span class="op" id="2551750">,</span>&nbsp;<span class="num" id="2551752">0</span><span class="op" id="2551753">,</span>&nbsp;<span class="num" id="2551755">0</span><span class="op" id="2551756">)</span>&nbsp;<span class="op" id="2551758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551761">func</span>&nbsp;<span class="ident" id="2551766">PtraceAttach</span><span class="op" id="2551778">(</span><span class="ident" id="2551779">pid</span>&nbsp;<span class="builtintype" id="2551783">int</span><span class="op" id="2551786">)</span>&nbsp;<span class="op" id="2551788">(</span><span class="ident" id="2551789">err</span>&nbsp;<span class="builtintype" id="2551793">error</span><span class="op" id="2551798">)</span>&nbsp;<span class="op" id="2551800">{</span>&nbsp;<span class="keyword" id="2551802">return</span>&nbsp;<span class="ident" id="2551809">ptrace</span><span class="op" id="2551815">(</span><span class="ident" id="2551816">PTRACE_ATTACH</span><span class="op" id="2551829">,</span>&nbsp;<span class="ident" id="2551831">pid</span><span class="op" id="2551834">,</span>&nbsp;<span class="num" id="2551836">0</span><span class="op" id="2551837">,</span>&nbsp;<span class="num" id="2551839">0</span><span class="op" id="2551840">)</span>&nbsp;<span class="op" id="2551842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span><span class="keyword" id="2551845">func</span>&nbsp;<span class="ident" id="2551850">PtraceDetach</span><span class="op" id="2551862">(</span><span class="ident" id="2551863">pid</span>&nbsp;<span class="builtintype" id="2551867">int</span><span class="op" id="2551870">)</span>&nbsp;<span class="op" id="2551872">(</span><span class="ident" id="2551873">err</span>&nbsp;<span class="builtintype" id="2551877">error</span><span class="op" id="2551882">)</span>&nbsp;<span class="op" id="2551884">{</span>&nbsp;<span class="keyword" id="2551886">return</span>&nbsp;<span class="ident" id="2551893">ptrace</span><span class="op" id="2551899">(</span><span class="ident" id="2551900">PTRACE_DETACH</span><span class="op" id="2551913">,</span>&nbsp;<span class="ident" id="2551915">pid</span><span class="op" id="2551918">,</span>&nbsp;<span class="num" id="2551920">0</span><span class="op" id="2551921">,</span>&nbsp;<span class="num" id="2551923">0</span><span class="op" id="2551924">)</span>&nbsp;<span class="op" id="2551926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2551929">//sys&nbsp;&nbsp;&nbsp;&nbspreboot(magic1&nbsp;uint,&nbsp;magic2&nbsp;uint,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552002">func</span>&nbsp;<span class="ident" id="2552007">Reboot</span><span class="op" id="2552013">(</span><span class="ident" id="2552014">cmd</span>&nbsp;<span class="builtintype" id="2552018">int</span><span class="op" id="2552021">)</span>&nbsp;<span class="op" id="2552023">(</span><span class="ident" id="2552024">err</span>&nbsp;<span class="builtintype" id="2552028">error</span><span class="op" id="2552033">)</span>&nbsp;<span class="op" id="2552035">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552038">return</span>&nbsp;<span class="ident" id="2552045">reboot</span><span class="op" id="2552051">(</span><span class="ident" id="2552052">LINUX_REBOOT_MAGIC1</span><span class="op" id="2552071">,</span>&nbsp;<span class="ident" id="2552073">LINUX_REBOOT_MAGIC2</span><span class="op" id="2552092">,</span>&nbsp;<span class="ident" id="2552094">cmd</span><span class="op" id="2552097">,</span>&nbsp;<span class="string" id="2552099">&#34;&#34;</span><span class="op" id="2552101">)</span><br>
<span class="lineno"></span><span class="op" id="2552103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552106">func</span>&nbsp;<span class="ident" id="2552111">clen</span><span class="op" id="2552115">(</span><span class="ident" id="2552116">n</span>&nbsp;<span class="op" id="2552118">[</span><span class="op" id="2552119">]</span><span class="builtintype" id="2552120">byte</span><span class="op" id="2552124">)</span>&nbsp;<span class="builtintype" id="2552126">int</span>&nbsp;<span class="op" id="2552130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552133">for</span>&nbsp;<span class="ident" id="2552137">i</span>&nbsp;<span class="op" id="2552139">:=</span>&nbsp;<span class="num" id="2552142">0</span><span class="op" id="2552143">;</span>&nbsp;<span class="ident" id="2552145">i</span>&nbsp;<span class="op" id="2552147">&lt;</span>&nbsp;<span class="builtinfunc" id="2552149">len</span><span class="op" id="2552152">(</span><span class="ident" id="2552153">n</span><span class="op" id="2552154">)</span><span class="op" id="2552155">;</span>&nbsp;<span class="ident" id="2552157">i</span><span class="op" id="2552158">++</span>&nbsp;<span class="op" id="2552161">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552165">if</span>&nbsp;<span class="ident" id="2552168">n</span><span class="op" id="2552169">[</span><span class="ident" id="2552170">i</span><span class="op" id="2552171">]</span>&nbsp;<span class="op" id="2552173">==</span>&nbsp;<span class="num" id="2552176">0</span>&nbsp;<span class="op" id="2552178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552183">return</span>&nbsp;<span class="ident" id="2552190">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2552194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2552197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552200">return</span>&nbsp;<span class="builtinfunc" id="2552207">len</span><span class="op" id="2552210">(</span><span class="ident" id="2552211">n</span><span class="op" id="2552212">)</span><br>
<span class="lineno">735</span><span class="op" id="2552214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552217">func</span>&nbsp;<span class="ident" id="2552222">ReadDirent</span><span class="op" id="2552232">(</span><span class="ident" id="2552233">fd</span>&nbsp;<span class="builtintype" id="2552236">int</span><span class="op" id="2552239">,</span>&nbsp;<span class="ident" id="2552241">buf</span>&nbsp;<span class="op" id="2552245">[</span><span class="op" id="2552246">]</span><span class="builtintype" id="2552247">byte</span><span class="op" id="2552251">)</span>&nbsp;<span class="op" id="2552253">(</span><span class="ident" id="2552254">n</span>&nbsp;<span class="builtintype" id="2552256">int</span><span class="op" id="2552259">,</span>&nbsp;<span class="ident" id="2552261">err</span>&nbsp;<span class="builtintype" id="2552265">error</span><span class="op" id="2552270">)</span>&nbsp;<span class="op" id="2552272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552275">return</span>&nbsp;<span class="ident" id="2552282">Getdents</span><span class="op" id="2552290">(</span><span class="ident" id="2552291">fd</span><span class="op" id="2552293">,</span>&nbsp;<span class="ident" id="2552295">buf</span><span class="op" id="2552298">)</span><br>
<span class="lineno"></span><span class="op" id="2552300">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="2552303">func</span>&nbsp;<span class="ident" id="2552308">ParseDirent</span><span class="op" id="2552319">(</span><span class="ident" id="2552320">buf</span>&nbsp;<span class="op" id="2552324">[</span><span class="op" id="2552325">]</span><span class="builtintype" id="2552326">byte</span><span class="op" id="2552330">,</span>&nbsp;<span class="ident" id="2552332">max</span>&nbsp;<span class="builtintype" id="2552336">int</span><span class="op" id="2552339">,</span>&nbsp;<span class="ident" id="2552341">names</span>&nbsp;<span class="op" id="2552347">[</span><span class="op" id="2552348">]</span><span class="builtintype" id="2552349">string</span><span class="op" id="2552355">)</span>&nbsp;<span class="op" id="2552357">(</span><span class="ident" id="2552358">consumed</span>&nbsp;<span class="builtintype" id="2552367">int</span><span class="op" id="2552370">,</span>&nbsp;<span class="ident" id="2552372">count</span>&nbsp;<span class="builtintype" id="2552378">int</span><span class="op" id="2552381">,</span>&nbsp;<span class="ident" id="2552383">newnames</span>&nbsp;<span class="op" id="2552392">[</span><span class="op" id="2552393">]</span><span class="builtintype" id="2552394">string</span><span class="op" id="2552400">)</span>&nbsp;<span class="op" id="2552402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552405">origlen</span>&nbsp;<span class="op" id="2552413">:=</span>&nbsp;<span class="builtinfunc" id="2552416">len</span><span class="op" id="2552419">(</span><span class="ident" id="2552420">buf</span><span class="op" id="2552423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552426">count</span>&nbsp;<span class="op" id="2552432">=</span>&nbsp;<span class="num" id="2552434">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552437">for</span>&nbsp;<span class="ident" id="2552441">max</span>&nbsp;<span class="op" id="2552445">!=</span>&nbsp;<span class="num" id="2552448">0</span>&nbsp;<span class="op" id="2552450">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2552453">len</span><span class="op" id="2552456">(</span><span class="ident" id="2552457">buf</span><span class="op" id="2552460">)</span>&nbsp;<span class="op" id="2552462">&gt;</span>&nbsp;<span class="num" id="2552464">0</span>&nbsp;<span class="op" id="2552466">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552470">dirent</span>&nbsp;<span class="op" id="2552477">:=</span>&nbsp;<span class="op" id="2552480">(</span><span class="op" id="2552481">*</span><span class="ident" id="2552482">Dirent</span><span class="op" id="2552488">)</span><span class="op" id="2552489">(</span><span class="ident" id="2552490">unsafe</span><span class="op" id="2552496">.</span><span class="ident" id="2552497">Pointer</span><span class="op" id="2552504">(</span><span class="op" id="2552505">&amp;</span><span class="ident" id="2552506">buf</span><span class="op" id="2552509">[</span><span class="num" id="2552510">0</span><span class="op" id="2552511">]</span><span class="op" id="2552512">)</span><span class="op" id="2552513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552517">buf</span>&nbsp;<span class="op" id="2552521">=</span>&nbsp;<span class="ident" id="2552523">buf</span><span class="op" id="2552526">[</span><span class="ident" id="2552527">dirent</span><span class="op" id="2552533">.</span><span class="ident" id="2552534">Reclen</span><span class="op" id="2552540">:</span><span class="op" id="2552541">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552545">if</span>&nbsp;<span class="ident" id="2552548">dirent</span><span class="op" id="2552554">.</span><span class="ident" id="2552555">Ino</span>&nbsp;<span class="op" id="2552559">==</span>&nbsp;<span class="num" id="2552562">0</span>&nbsp;<span class="op" id="2552564">{</span>&nbsp;<span class="comment" id="2552566">//&nbsp;File&nbsp;absent&nbsp;in&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552598">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2552609">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552613">bytes</span>&nbsp;<span class="op" id="2552619">:=</span>&nbsp;<span class="op" id="2552622">(</span><span class="op" id="2552623">*</span><span class="op" id="2552624">[</span><span class="num" id="2552625">10000</span><span class="op" id="2552630">]</span><span class="builtintype" id="2552631">byte</span><span class="op" id="2552635">)</span><span class="op" id="2552636">(</span><span class="ident" id="2552637">unsafe</span><span class="op" id="2552643">.</span><span class="ident" id="2552644">Pointer</span><span class="op" id="2552651">(</span><span class="op" id="2552652">&amp;</span><span class="ident" id="2552653">dirent</span><span class="op" id="2552659">.</span><span class="ident" id="2552660">Name</span><span class="op" id="2552664">[</span><span class="num" id="2552665">0</span><span class="op" id="2552666">]</span><span class="op" id="2552667">)</span><span class="op" id="2552668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552672">var</span>&nbsp;<span class="ident" id="2552676">name</span>&nbsp;<span class="op" id="2552681">=</span>&nbsp;<span class="builtintype" id="2552683">string</span><span class="op" id="2552689">(</span><span class="ident" id="2552690">bytes</span><span class="op" id="2552695">[</span><span class="num" id="2552696">0</span><span class="op" id="2552697">:</span><span class="ident" id="2552698">clen</span><span class="op" id="2552702">(</span><span class="ident" id="2552703">bytes</span><span class="op" id="2552708">[</span><span class="op" id="2552709">:</span><span class="op" id="2552710">]</span><span class="op" id="2552711">)</span><span class="op" id="2552712">]</span><span class="op" id="2552713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552717">if</span>&nbsp;<span class="ident" id="2552720">name</span>&nbsp;<span class="op" id="2552725">==</span>&nbsp;<span class="string" id="2552728">&#34;.&#34;</span>&nbsp;<span class="op" id="2552732">||</span>&nbsp;<span class="ident" id="2552735">name</span>&nbsp;<span class="op" id="2552740">==</span>&nbsp;<span class="string" id="2552743">&#34;..&#34;</span>&nbsp;<span class="op" id="2552748">{</span>&nbsp;<span class="comment" id="2552750">//&nbsp;Useless&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552770">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2552781">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552785">max</span><span class="op" id="2552788">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552793">count</span><span class="op" id="2552798">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552803">names</span>&nbsp;<span class="op" id="2552809">=</span>&nbsp;<span class="builtinfunc" id="2552811">append</span><span class="op" id="2552817">(</span><span class="ident" id="2552818">names</span><span class="op" id="2552823">,</span>&nbsp;<span class="ident" id="2552825">name</span><span class="op" id="2552829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2552832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552835">return</span>&nbsp;<span class="ident" id="2552842">origlen</span>&nbsp;<span class="op" id="2552850">-</span>&nbsp;<span class="builtinfunc" id="2552852">len</span><span class="op" id="2552855">(</span><span class="ident" id="2552856">buf</span><span class="op" id="2552859">)</span><span class="op" id="2552860">,</span>&nbsp;<span class="ident" id="2552862">count</span><span class="op" id="2552867">,</span>&nbsp;<span class="ident" id="2552869">names</span><br>
<span class="lineno">760</span><span class="op" id="2552875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2552878">//sys&nbsp;&nbsp;&nbsp;&nbspmount(source&nbsp;string,&nbsp;target&nbsp;string,&nbsp;fstype&nbsp;string,&nbsp;flags&nbsp;uintptr,&nbsp;data&nbsp;*byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552975">func</span>&nbsp;<span class="ident" id="2552980">Mount</span><span class="op" id="2552985">(</span><span class="ident" id="2552986">source</span>&nbsp;<span class="builtintype" id="2552993">string</span><span class="op" id="2552999">,</span>&nbsp;<span class="ident" id="2553001">target</span>&nbsp;<span class="builtintype" id="2553008">string</span><span class="op" id="2553014">,</span>&nbsp;<span class="ident" id="2553016">fstype</span>&nbsp;<span class="builtintype" id="2553023">string</span><span class="op" id="2553029">,</span>&nbsp;<span class="ident" id="2553031">flags</span>&nbsp;<span class="builtintype" id="2553037">uintptr</span><span class="op" id="2553044">,</span>&nbsp;<span class="ident" id="2553046">data</span>&nbsp;<span class="builtintype" id="2553051">string</span><span class="op" id="2553057">)</span>&nbsp;<span class="op" id="2553059">(</span><span class="ident" id="2553060">err</span>&nbsp;<span class="builtintype" id="2553064">error</span><span class="op" id="2553069">)</span>&nbsp;<span class="op" id="2553071">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2553074">//&nbsp;Certain&nbsp;file&nbsp;systems&nbsp;get&nbsp;rather&nbsp;angry&nbsp;and&nbsp;EINVAL&nbsp;if&nbsp;you&nbsp;give</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2553139">//&nbsp;them&nbsp;an&nbsp;empty&nbsp;string&nbsp;of&nbsp;data,&nbsp;rather&nbsp;than&nbsp;NULL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553191">if</span>&nbsp;<span class="ident" id="2553194">data</span>&nbsp;<span class="op" id="2553199">==</span>&nbsp;<span class="string" id="2553202">&#34;&#34;</span>&nbsp;<span class="op" id="2553205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553209">return</span>&nbsp;<span class="ident" id="2553216">mount</span><span class="op" id="2553221">(</span><span class="ident" id="2553222">source</span><span class="op" id="2553228">,</span>&nbsp;<span class="ident" id="2553230">target</span><span class="op" id="2553236">,</span>&nbsp;<span class="ident" id="2553238">fstype</span><span class="op" id="2553244">,</span>&nbsp;<span class="ident" id="2553246">flags</span><span class="op" id="2553251">,</span>&nbsp;<span class="ident" id="2553253">nil</span><span class="op" id="2553256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2553259">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553262">datap</span><span class="op" id="2553267">,</span>&nbsp;<span class="ident" id="2553269">err</span>&nbsp;<span class="op" id="2553273">:=</span>&nbsp;<span class="ident" id="2553276">BytePtrFromString</span><span class="op" id="2553293">(</span><span class="ident" id="2553294">data</span><span class="op" id="2553298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553301">if</span>&nbsp;<span class="ident" id="2553304">err</span>&nbsp;<span class="op" id="2553308">!=</span>&nbsp;<span class="ident" id="2553311">nil</span>&nbsp;<span class="op" id="2553315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553319">return</span>&nbsp;<span class="ident" id="2553326">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2553331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553334">err</span>&nbsp;<span class="op" id="2553338">=</span>&nbsp;<span class="ident" id="2553340">mount</span><span class="op" id="2553345">(</span><span class="ident" id="2553346">source</span><span class="op" id="2553352">,</span>&nbsp;<span class="ident" id="2553354">target</span><span class="op" id="2553360">,</span>&nbsp;<span class="ident" id="2553362">fstype</span><span class="op" id="2553368">,</span>&nbsp;<span class="ident" id="2553370">flags</span><span class="op" id="2553375">,</span>&nbsp;<span class="ident" id="2553377">datap</span><span class="op" id="2553382">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553385">use</span><span class="op" id="2553388">(</span><span class="ident" id="2553389">unsafe</span><span class="op" id="2553395">.</span><span class="ident" id="2553396">Pointer</span><span class="op" id="2553403">(</span><span class="ident" id="2553404">datap</span><span class="op" id="2553409">)</span><span class="op" id="2553410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553413">return</span>&nbsp;<span class="ident" id="2553420">err</span><br>
<span class="lineno"></span><span class="op" id="2553424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2553427">//&nbsp;Sendto</span><br>
<span class="lineno">780</span><span class="comment" id="2553437">//&nbsp;Recvfrom</span><br>
<span class="lineno"></span><span class="comment" id="2553449">//&nbsp;Socketpair</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2553464">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Direct&nbsp;access<br>
<span class="lineno">785</span>&nbsp;*/</span><br>
<span class="lineno"></span><span class="comment" id="2553488">//sys&nbsp;&nbsp;&nbsp;&nbspAccess(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2553539">//sys&nbsp;&nbsp;&nbsp;&nbspAcct(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2553575">//sys&nbsp;&nbsp;&nbsp;&nbspAdjtimex(buf&nbsp;*Timex)&nbsp;(state&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2553625">//sys&nbsp;&nbsp;&nbsp;&nbspChdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">790</span><span class="comment" id="2553662">//sys&nbsp;&nbsp;&nbsp;&nbspChmod(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2553712">//sys&nbsp;&nbsp;&nbsp;&nbspChroot(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2553750">//sys&nbsp;&nbsp;&nbsp;&nbspClose(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2553782">//sys&nbsp;&nbsp;&nbsp;&nbspCreat(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2553840">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup(oldfd&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">795</span><span class="comment" id="2553883">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup2(oldfd&nbsp;int,&nbsp;newfd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2553930">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup3(oldfd&nbsp;int,&nbsp;newfd&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2553988">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate(size&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2554038">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate1(flag&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2554089">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCtl(epfd&nbsp;int,&nbsp;op&nbsp;int,&nbsp;fd&nbsp;int,&nbsp;event&nbsp;*EpollEvent)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">800</span><span class="comment" id="2554163">//sys&nbsp;&nbsp;&nbsp;&nbspEpollWait(epfd&nbsp;int,&nbsp;events&nbsp;[]EpollEvent,&nbsp;msec&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2554239">//sys&nbsp;&nbsp;&nbsp;&nbspExit(code&nbsp;int)&nbsp;=&nbsp;SYS_EXIT_GROUP</span><br>
<span class="lineno"></span><span class="comment" id="2554277">//sys&nbsp;&nbsp;&nbsp;&nbspFaccessat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2554353">//sys&nbsp;&nbsp;&nbsp;&nbspFallocate(fd&nbsp;int,&nbsp;mode&nbsp;uint32,&nbsp;off&nbsp;int64,&nbsp;len&nbsp;int64)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2554424">//sys&nbsp;&nbsp;&nbsp;&nbspFchdir(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">805</span><span class="comment" id="2554457">//sys&nbsp;&nbsp;&nbsp;&nbspFchmod(fd&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2554503">//sys&nbsp;&nbsp;&nbsp;&nbspFchmodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2554578">//sys&nbsp;&nbsp;&nbsp;&nbspFchownat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;uid&nbsp;int,&nbsp;gid&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2554658">//sys&nbsp;&nbsp;&nbsp;&nbspfcntl(fd&nbsp;int,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;int)&nbsp;(val&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2554717">//sys&nbsp;&nbsp;&nbsp;&nbspFdatasync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">810</span><span class="comment" id="2554753">//sys&nbsp;&nbsp;&nbsp;&nbspFlock(fd&nbsp;int,&nbsp;how&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2554794">//sys&nbsp;&nbsp;&nbsp;&nbspFsync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2554826">//sys&nbsp;&nbsp;&nbsp;&nbspGetdents(fd&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_GETDENTS64</span><br>
<span class="lineno"></span><span class="comment" id="2554897">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgid(pid&nbsp;int)&nbsp;(pgid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2554944">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgrp()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno">815</span><span class="comment" id="2554972">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpid()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2554999">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetppid()&nbsp;(ppid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2555028">//sys&nbsp;&nbsp;&nbsp;&nbspGetpriority(which&nbsp;int,&nbsp;who&nbsp;int)&nbsp;(prio&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2555088">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetrusage(who&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2555143">//sysnb&nbsp;&nbsp;&nbsp;&nbspGettid()&nbsp;(tid&nbsp;int)</span><br>
<span class="lineno">820</span><span class="comment" id="2555170">//sys&nbsp;&nbsp;&nbsp;&nbspGetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2555244">//sys&nbsp;&nbsp;&nbsp;&nbspInotifyAddWatch(fd&nbsp;int,&nbsp;pathname&nbsp;string,&nbsp;mask&nbsp;uint32)&nbsp;(watchdesc&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2555331">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit()&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2555373">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit1(flags&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2555425">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyRmWatch(fd&nbsp;int,&nbsp;watchdesc&nbsp;uint32)&nbsp;(success&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">825</span><span class="comment" id="2555499">//sysnb&nbsp;&nbsp;&nbsp;&nbspKill(pid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2555545">//sys&nbsp;&nbsp;&nbsp;&nbspKlogctl(typ&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_SYSLOG</span><br>
<span class="lineno"></span><span class="comment" id="2555612">//sys&nbsp;&nbsp;&nbsp;&nbspLink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2555667">//sys&nbsp;&nbsp;&nbsp;&nbspListxattr(path&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2555729">//sys&nbsp;&nbsp;&nbsp;&nbspMkdir(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">830</span><span class="comment" id="2555779">//sys&nbsp;&nbsp;&nbsp;&nbspMkdirat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2555842">//sys&nbsp;&nbsp;&nbsp;&nbspMknod(path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2555901">//sys&nbsp;&nbsp;&nbsp;&nbspMknodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2555973">//sys&nbsp;&nbsp;&nbsp;&nbspNanosleep(time&nbsp;*Timespec,&nbsp;leftover&nbsp;*Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2556037">//sys&nbsp;&nbsp;&nbsp;&nbspPause()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">835</span><span class="comment" id="2556063">//sys&nbsp;&nbsp;&nbsp;&nbspPivotRoot(newroot&nbsp;string,&nbsp;putold&nbsp;string)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PIVOT_ROOT</span><br>
<span class="lineno"></span><span class="comment" id="2556139">//sysnb&nbsp;prlimit(pid&nbsp;int,&nbsp;resource&nbsp;int,&nbsp;old&nbsp;*Rlimit,&nbsp;newlimit&nbsp;*Rlimit)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PRLIMIT64</span><br>
<span class="lineno"></span><span class="comment" id="2556237">//sys&nbsp;&nbsp;&nbsp;&nbspread(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2556285">//sys&nbsp;&nbsp;&nbsp;&nbspReadlink(path&nbsp;string,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2556344">//sys&nbsp;&nbsp;&nbsp;&nbspRemovexattr(path&nbsp;string,&nbsp;attr&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">840</span><span class="comment" id="2556400">//sys&nbsp;&nbsp;&nbsp;&nbspRename(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2556457">//sys&nbsp;&nbsp;&nbsp;&nbspRenameat(olddirfd&nbsp;int,&nbsp;oldpath&nbsp;string,&nbsp;newdirfd&nbsp;int,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2556544">//sys&nbsp;&nbsp;&nbsp;&nbspRmdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2556581">//sys&nbsp;&nbsp;&nbsp;&nbspSetdomainname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2556623">//sys&nbsp;&nbsp;&nbsp;&nbspSethostname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">845</span><span class="comment" id="2556663">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetpgid(pid&nbsp;int,&nbsp;pgid&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2556710">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetsid()&nbsp;(pid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2556748">//sysnb&nbsp;&nbsp;&nbsp;&nbspSettimeofday(tv&nbsp;*Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2556795">//&nbsp;issue&nbsp;1435.</span><br>
<span class="lineno">850</span><span class="comment" id="2556810">//&nbsp;On&nbsp;linux&nbsp;Setuid&nbsp;and&nbsp;Setgid&nbsp;only&nbsp;affects&nbsp;the&nbsp;current&nbsp;thread,&nbsp;not&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="2556890">//&nbsp;This&nbsp;does&nbsp;not&nbsp;match&nbsp;what&nbsp;most&nbsp;callers&nbsp;expect&nbsp;so&nbsp;we&nbsp;must&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2556965">//&nbsp;here&nbsp;rather&nbsp;than&nbsp;letting&nbsp;the&nbsp;caller&nbsp;think&nbsp;that&nbsp;the&nbsp;call&nbsp;succeeded.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2557036">func</span>&nbsp;<span class="ident" id="2557041">Setuid</span><span class="op" id="2557047">(</span><span class="ident" id="2557048">uid</span>&nbsp;<span class="builtintype" id="2557052">int</span><span class="op" id="2557055">)</span>&nbsp;<span class="op" id="2557057">(</span><span class="ident" id="2557058">err</span>&nbsp;<span class="builtintype" id="2557062">error</span><span class="op" id="2557067">)</span>&nbsp;<span class="op" id="2557069">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557072">return</span>&nbsp;<span class="ident" id="2557079">EOPNOTSUPP</span><br>
<span class="lineno"></span><span class="op" id="2557090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2557093">func</span>&nbsp;<span class="ident" id="2557098">Setgid</span><span class="op" id="2557104">(</span><span class="ident" id="2557105">uid</span>&nbsp;<span class="builtintype" id="2557109">int</span><span class="op" id="2557112">)</span>&nbsp;<span class="op" id="2557114">(</span><span class="ident" id="2557115">err</span>&nbsp;<span class="builtintype" id="2557119">error</span><span class="op" id="2557124">)</span>&nbsp;<span class="op" id="2557126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557129">return</span>&nbsp;<span class="ident" id="2557136">EOPNOTSUPP</span><br>
<span class="lineno">860</span><span class="op" id="2557147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2557150">//sys&nbsp;&nbsp;&nbsp;&nbspSetpriority(which&nbsp;int,&nbsp;who&nbsp;int,&nbsp;prio&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2557210">//sys&nbsp;&nbsp;&nbsp;&nbspSetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;data&nbsp;[]byte,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2557287">//sys&nbsp;&nbsp;&nbsp;&nbspSymlink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">865</span><span class="comment" id="2557345">//sys&nbsp;&nbsp;&nbsp;&nbspSync()</span><br>
<span class="lineno"></span><span class="comment" id="2557358">//sysnb&nbsp;&nbsp;&nbsp;&nbspSysinfo(info&nbsp;*Sysinfo_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2557403">//sys&nbsp;&nbsp;&nbsp;&nbspTee(rfd&nbsp;int,&nbsp;wfd&nbsp;int,&nbsp;len&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(n&nbsp;int64,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2557472">//sysnb&nbsp;&nbsp;&nbsp;&nbspTgkill(tgid&nbsp;int,&nbsp;tid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2557530">//sysnb&nbsp;&nbsp;&nbsp;&nbspTimes(tms&nbsp;*Tms)&nbsp;(ticks&nbsp;uintptr,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">870</span><span class="comment" id="2557581">//sysnb&nbsp;&nbsp;&nbsp;&nbspUmask(mask&nbsp;int)&nbsp;(oldmask&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2557619">//sysnb&nbsp;&nbsp;&nbsp;&nbspUname(buf&nbsp;*Utsname)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2557659">//sys&nbsp;&nbsp;&nbsp;&nbspUnlink(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2557697">//sys&nbsp;&nbsp;&nbsp;&nbspUnlinkat(dirfd&nbsp;int,&nbsp;path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2557748">//sys&nbsp;&nbsp;&nbsp;&nbspUnmount(target&nbsp;string,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_UMOUNT2</span><br>
<span class="lineno">875</span><span class="comment" id="2557814">//sys&nbsp;&nbsp;&nbsp;&nbspUnshare(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2557851">//sys&nbsp;&nbsp;&nbsp;&nbspUstat(dev&nbsp;int,&nbsp;ubuf&nbsp;*Ustat_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2557899">//sys&nbsp;&nbsp;&nbsp;&nbspUtime(path&nbsp;string,&nbsp;buf&nbsp;*Utimbuf)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2557950">//sys&nbsp;&nbsp;&nbsp;&nbspwrite(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2557999">//sys&nbsp;&nbsp;&nbsp;&nbspexitThread(code&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_EXIT</span><br>
<span class="lineno">880</span><span class="comment" id="2558049">//sys&nbsp;&nbsp;&nbsp;&nbspreadlen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_READ</span><br>
<span class="lineno"></span><span class="comment" id="2558118">//sys&nbsp;&nbsp;&nbsp;&nbspwritelen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_WRITE</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2558190">//&nbsp;mmap&nbsp;varies&nbsp;by&nbsp;architecture;&nbsp;see&nbsp;syscall_linux_*.go.</span><br>
<span class="lineno"></span><span class="comment" id="2558246">//sys&nbsp;&nbsp;&nbsp;&nbspmunmap(addr&nbsp;uintptr,&nbsp;length&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span><span class="keyword" id="2558302">var</span>&nbsp;<span class="ident" id="2558306">mapper</span>&nbsp;<span class="op" id="2558313">=</span>&nbsp;<span class="op" id="2558315">&amp;</span><span class="ident" id="2558316">mmapper</span><span class="op" id="2558323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558326">active</span><span class="op" id="2558332">:</span>&nbsp;<span class="builtinfunc" id="2558334">make</span><span class="op" id="2558338">(</span><span class="keyword" id="2558339">map</span><span class="op" id="2558342">[</span><span class="op" id="2558343">*</span><span class="builtintype" id="2558344">byte</span><span class="op" id="2558348">]</span><span class="op" id="2558349">[</span><span class="op" id="2558350">]</span><span class="builtintype" id="2558351">byte</span><span class="op" id="2558355">)</span><span class="op" id="2558356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558359">mmap</span><span class="op" id="2558363">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2558367">mmap</span><span class="op" id="2558371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558374">munmap</span><span class="op" id="2558380">:</span>&nbsp;<span class="ident" id="2558382">munmap</span><span class="op" id="2558388">,</span><br>
<span class="lineno">890</span><span class="op" id="2558390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2558393">func</span>&nbsp;<span class="ident" id="2558398">Mmap</span><span class="op" id="2558402">(</span><span class="ident" id="2558403">fd</span>&nbsp;<span class="builtintype" id="2558406">int</span><span class="op" id="2558409">,</span>&nbsp;<span class="ident" id="2558411">offset</span>&nbsp;<span class="ident" id="2558418">int64</span><span class="op" id="2558423">,</span>&nbsp;<span class="ident" id="2558425">length</span>&nbsp;<span class="builtintype" id="2558432">int</span><span class="op" id="2558435">,</span>&nbsp;<span class="ident" id="2558437">prot</span>&nbsp;<span class="builtintype" id="2558442">int</span><span class="op" id="2558445">,</span>&nbsp;<span class="ident" id="2558447">flags</span>&nbsp;<span class="builtintype" id="2558453">int</span><span class="op" id="2558456">)</span>&nbsp;<span class="op" id="2558458">(</span><span class="ident" id="2558459">data</span>&nbsp;<span class="op" id="2558464">[</span><span class="op" id="2558465">]</span><span class="builtintype" id="2558466">byte</span><span class="op" id="2558470">,</span>&nbsp;<span class="ident" id="2558472">err</span>&nbsp;<span class="builtintype" id="2558476">error</span><span class="op" id="2558481">)</span>&nbsp;<span class="op" id="2558483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558486">return</span>&nbsp;<span class="ident" id="2558493">mapper</span><span class="op" id="2558499">.</span><span class="ident" id="2558500">Mmap</span><span class="op" id="2558504">(</span><span class="ident" id="2558505">fd</span><span class="op" id="2558507">,</span>&nbsp;<span class="ident" id="2558509">offset</span><span class="op" id="2558515">,</span>&nbsp;<span class="ident" id="2558517">length</span><span class="op" id="2558523">,</span>&nbsp;<span class="ident" id="2558525">prot</span><span class="op" id="2558529">,</span>&nbsp;<span class="ident" id="2558531">flags</span><span class="op" id="2558536">)</span><br>
<span class="lineno"></span><span class="op" id="2558538">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="keyword" id="2558541">func</span>&nbsp;<span class="ident" id="2558546">Munmap</span><span class="op" id="2558552">(</span><span class="ident" id="2558553">b</span>&nbsp;<span class="op" id="2558555">[</span><span class="op" id="2558556">]</span><span class="builtintype" id="2558557">byte</span><span class="op" id="2558561">)</span>&nbsp;<span class="op" id="2558563">(</span><span class="ident" id="2558564">err</span>&nbsp;<span class="builtintype" id="2558568">error</span><span class="op" id="2558573">)</span>&nbsp;<span class="op" id="2558575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558578">return</span>&nbsp;<span class="ident" id="2558585">mapper</span><span class="op" id="2558591">.</span><span class="ident" id="2558592">Munmap</span><span class="op" id="2558598">(</span><span class="ident" id="2558599">b</span><span class="op" id="2558600">)</span><br>
<span class="lineno"></span><span class="op" id="2558602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="2558605">//sys&nbsp;&nbsp;&nbsp;&nbspMadvise(b&nbsp;[]byte,&nbsp;advice&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2558653">//sys&nbsp;&nbsp;&nbsp;&nbspMprotect(b&nbsp;[]byte,&nbsp;prot&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2558700">//sys&nbsp;&nbsp;&nbsp;&nbspMlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2558734">//sys&nbsp;&nbsp;&nbsp;&nbspMunlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2558770">//sys&nbsp;&nbsp;&nbsp;&nbspMlockall(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">905</span><span class="comment" id="2558808">//sys&nbsp;&nbsp;&nbsp;&nbspMunlockall()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2558840">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Unimplemented<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno">910</span><span class="comment" id="2558864">//&nbsp;AddKey</span><br>
<span class="lineno"></span><span class="comment" id="2558874">//&nbsp;AfsSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2558888">//&nbsp;Alarm</span><br>
<span class="lineno"></span><span class="comment" id="2558897">//&nbsp;ArchPrctl</span><br>
<span class="lineno"></span><span class="comment" id="2558910">//&nbsp;Brk</span><br>
<span class="lineno">915</span><span class="comment" id="2558917">//&nbsp;Capget</span><br>
<span class="lineno"></span><span class="comment" id="2558927">//&nbsp;Capset</span><br>
<span class="lineno"></span><span class="comment" id="2558937">//&nbsp;ClockGetres</span><br>
<span class="lineno"></span><span class="comment" id="2558952">//&nbsp;ClockGettime</span><br>
<span class="lineno"></span><span class="comment" id="2558968">//&nbsp;ClockNanosleep</span><br>
<span class="lineno">920</span><span class="comment" id="2558986">//&nbsp;ClockSettime</span><br>
<span class="lineno"></span><span class="comment" id="2559002">//&nbsp;Clone</span><br>
<span class="lineno"></span><span class="comment" id="2559011">//&nbsp;CreateModule</span><br>
<span class="lineno"></span><span class="comment" id="2559027">//&nbsp;DeleteModule</span><br>
<span class="lineno"></span><span class="comment" id="2559043">//&nbsp;EpollCtlOld</span><br>
<span class="lineno">925</span><span class="comment" id="2559058">//&nbsp;EpollPwait</span><br>
<span class="lineno"></span><span class="comment" id="2559072">//&nbsp;EpollWaitOld</span><br>
<span class="lineno"></span><span class="comment" id="2559088">//&nbsp;Eventfd</span><br>
<span class="lineno"></span><span class="comment" id="2559099">//&nbsp;Execve</span><br>
<span class="lineno"></span><span class="comment" id="2559109">//&nbsp;Fadvise64</span><br>
<span class="lineno">930</span><span class="comment" id="2559122">//&nbsp;Fgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2559135">//&nbsp;Flistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2559149">//&nbsp;Fork</span><br>
<span class="lineno"></span><span class="comment" id="2559157">//&nbsp;Fremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2559173">//&nbsp;Fsetxattr</span><br>
<span class="lineno">935</span><span class="comment" id="2559186">//&nbsp;Futex</span><br>
<span class="lineno"></span><span class="comment" id="2559195">//&nbsp;GetKernelSyms</span><br>
<span class="lineno"></span><span class="comment" id="2559212">//&nbsp;GetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2559228">//&nbsp;GetRobustList</span><br>
<span class="lineno"></span><span class="comment" id="2559245">//&nbsp;GetThreadArea</span><br>
<span class="lineno">940</span><span class="comment" id="2559262">//&nbsp;Getitimer</span><br>
<span class="lineno"></span><span class="comment" id="2559275">//&nbsp;Getpmsg</span><br>
<span class="lineno"></span><span class="comment" id="2559286">//&nbsp;IoCancel</span><br>
<span class="lineno"></span><span class="comment" id="2559298">//&nbsp;IoDestroy</span><br>
<span class="lineno"></span><span class="comment" id="2559311">//&nbsp;IoGetevents</span><br>
<span class="lineno">945</span><span class="comment" id="2559326">//&nbsp;IoSetup</span><br>
<span class="lineno"></span><span class="comment" id="2559337">//&nbsp;IoSubmit</span><br>
<span class="lineno"></span><span class="comment" id="2559349">//&nbsp;Ioctl</span><br>
<span class="lineno"></span><span class="comment" id="2559358">//&nbsp;IoprioGet</span><br>
<span class="lineno"></span><span class="comment" id="2559371">//&nbsp;IoprioSet</span><br>
<span class="lineno">950</span><span class="comment" id="2559384">//&nbsp;KexecLoad</span><br>
<span class="lineno"></span><span class="comment" id="2559397">//&nbsp;Keyctl</span><br>
<span class="lineno"></span><span class="comment" id="2559407">//&nbsp;Lgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2559420">//&nbsp;Llistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2559434">//&nbsp;LookupDcookie</span><br>
<span class="lineno">955</span><span class="comment" id="2559451">//&nbsp;Lremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2559467">//&nbsp;Lsetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2559480">//&nbsp;Mbind</span><br>
<span class="lineno"></span><span class="comment" id="2559489">//&nbsp;MigratePages</span><br>
<span class="lineno"></span><span class="comment" id="2559505">//&nbsp;Mincore</span><br>
<span class="lineno">960</span><span class="comment" id="2559516">//&nbsp;ModifyLdt</span><br>
<span class="lineno"></span><span class="comment" id="2559529">//&nbsp;Mount</span><br>
<span class="lineno"></span><span class="comment" id="2559538">//&nbsp;MovePages</span><br>
<span class="lineno"></span><span class="comment" id="2559551">//&nbsp;Mprotect</span><br>
<span class="lineno"></span><span class="comment" id="2559563">//&nbsp;MqGetsetattr</span><br>
<span class="lineno">965</span><span class="comment" id="2559579">//&nbsp;MqNotify</span><br>
<span class="lineno"></span><span class="comment" id="2559591">//&nbsp;MqOpen</span><br>
<span class="lineno"></span><span class="comment" id="2559601">//&nbsp;MqTimedreceive</span><br>
<span class="lineno"></span><span class="comment" id="2559619">//&nbsp;MqTimedsend</span><br>
<span class="lineno"></span><span class="comment" id="2559634">//&nbsp;MqUnlink</span><br>
<span class="lineno">970</span><span class="comment" id="2559646">//&nbsp;Mremap</span><br>
<span class="lineno"></span><span class="comment" id="2559656">//&nbsp;Msgctl</span><br>
<span class="lineno"></span><span class="comment" id="2559666">//&nbsp;Msgget</span><br>
<span class="lineno"></span><span class="comment" id="2559676">//&nbsp;Msgrcv</span><br>
<span class="lineno"></span><span class="comment" id="2559686">//&nbsp;Msgsnd</span><br>
<span class="lineno">975</span><span class="comment" id="2559696">//&nbsp;Msync</span><br>
<span class="lineno"></span><span class="comment" id="2559705">//&nbsp;Newfstatat</span><br>
<span class="lineno"></span><span class="comment" id="2559719">//&nbsp;Nfsservctl</span><br>
<span class="lineno"></span><span class="comment" id="2559733">//&nbsp;Personality</span><br>
<span class="lineno"></span><span class="comment" id="2559748">//&nbsp;Poll</span><br>
<span class="lineno">980</span><span class="comment" id="2559756">//&nbsp;Ppoll</span><br>
<span class="lineno"></span><span class="comment" id="2559765">//&nbsp;Prctl</span><br>
<span class="lineno"></span><span class="comment" id="2559774">//&nbsp;Pselect6</span><br>
<span class="lineno"></span><span class="comment" id="2559786">//&nbsp;Ptrace</span><br>
<span class="lineno"></span><span class="comment" id="2559796">//&nbsp;Putpmsg</span><br>
<span class="lineno">985</span><span class="comment" id="2559807">//&nbsp;QueryModule</span><br>
<span class="lineno"></span><span class="comment" id="2559822">//&nbsp;Quotactl</span><br>
<span class="lineno"></span><span class="comment" id="2559834">//&nbsp;Readahead</span><br>
<span class="lineno"></span><span class="comment" id="2559847">//&nbsp;Readv</span><br>
<span class="lineno"></span><span class="comment" id="2559856">//&nbsp;RemapFilePages</span><br>
<span class="lineno">990</span><span class="comment" id="2559874">//&nbsp;RequestKey</span><br>
<span class="lineno"></span><span class="comment" id="2559888">//&nbsp;RestartSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2559906">//&nbsp;RtSigaction</span><br>
<span class="lineno"></span><span class="comment" id="2559921">//&nbsp;RtSigpending</span><br>
<span class="lineno"></span><span class="comment" id="2559937">//&nbsp;RtSigprocmask</span><br>
<span class="lineno">995</span><span class="comment" id="2559954">//&nbsp;RtSigqueueinfo</span><br>
<span class="lineno"></span><span class="comment" id="2559972">//&nbsp;RtSigreturn</span><br>
<span class="lineno"></span><span class="comment" id="2559987">//&nbsp;RtSigsuspend</span><br>
<span class="lineno"></span><span class="comment" id="2560003">//&nbsp;RtSigtimedwait</span><br>
<span class="lineno"></span><span class="comment" id="2560021">//&nbsp;SchedGetPriorityMax</span><br>
<span class="lineno">1000</span><span class="comment" id="2560044">//&nbsp;SchedGetPriorityMin</span><br>
<span class="lineno"></span><span class="comment" id="2560067">//&nbsp;SchedGetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2560087">//&nbsp;SchedGetparam</span><br>
<span class="lineno"></span><span class="comment" id="2560104">//&nbsp;SchedGetscheduler</span><br>
<span class="lineno"></span><span class="comment" id="2560125">//&nbsp;SchedRrGetInterval</span><br>
<span class="lineno">1005</span><span class="comment" id="2560147">//&nbsp;SchedSetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2560167">//&nbsp;SchedSetparam</span><br>
<span class="lineno"></span><span class="comment" id="2560184">//&nbsp;SchedYield</span><br>
<span class="lineno"></span><span class="comment" id="2560198">//&nbsp;Security</span><br>
<span class="lineno"></span><span class="comment" id="2560210">//&nbsp;Semctl</span><br>
<span class="lineno">1010</span><span class="comment" id="2560220">//&nbsp;Semget</span><br>
<span class="lineno"></span><span class="comment" id="2560230">//&nbsp;Semop</span><br>
<span class="lineno"></span><span class="comment" id="2560239">//&nbsp;Semtimedop</span><br>
<span class="lineno"></span><span class="comment" id="2560253">//&nbsp;SetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2560269">//&nbsp;SetRobustList</span><br>
<span class="lineno">1015</span><span class="comment" id="2560286">//&nbsp;SetThreadArea</span><br>
<span class="lineno"></span><span class="comment" id="2560303">//&nbsp;SetTidAddress</span><br>
<span class="lineno"></span><span class="comment" id="2560320">//&nbsp;Shmat</span><br>
<span class="lineno"></span><span class="comment" id="2560329">//&nbsp;Shmctl</span><br>
<span class="lineno"></span><span class="comment" id="2560339">//&nbsp;Shmdt</span><br>
<span class="lineno">1020</span><span class="comment" id="2560348">//&nbsp;Shmget</span><br>
<span class="lineno"></span><span class="comment" id="2560358">//&nbsp;Sigaltstack</span><br>
<span class="lineno"></span><span class="comment" id="2560373">//&nbsp;Signalfd</span><br>
<span class="lineno"></span><span class="comment" id="2560385">//&nbsp;Swapoff</span><br>
<span class="lineno"></span><span class="comment" id="2560396">//&nbsp;Swapon</span><br>
<span class="lineno">1025</span><span class="comment" id="2560406">//&nbsp;Sysfs</span><br>
<span class="lineno"></span><span class="comment" id="2560415">//&nbsp;TimerCreate</span><br>
<span class="lineno"></span><span class="comment" id="2560430">//&nbsp;TimerDelete</span><br>
<span class="lineno"></span><span class="comment" id="2560445">//&nbsp;TimerGetoverrun</span><br>
<span class="lineno"></span><span class="comment" id="2560464">//&nbsp;TimerGettime</span><br>
<span class="lineno">1030</span><span class="comment" id="2560480">//&nbsp;TimerSettime</span><br>
<span class="lineno"></span><span class="comment" id="2560496">//&nbsp;Timerfd</span><br>
<span class="lineno"></span><span class="comment" id="2560507">//&nbsp;Tkill&nbsp;(obsolete)</span><br>
<span class="lineno"></span><span class="comment" id="2560527">//&nbsp;Tuxcall</span><br>
<span class="lineno"></span><span class="comment" id="2560538">//&nbsp;Umount2</span><br>
<span class="lineno">1035</span><span class="comment" id="2560549">//&nbsp;Uselib</span><br>
<span class="lineno"></span><span class="comment" id="2560559">//&nbsp;Utimensat</span><br>
<span class="lineno"></span><span class="comment" id="2560572">//&nbsp;Vfork</span><br>
<span class="lineno"></span><span class="comment" id="2560581">//&nbsp;Vhangup</span><br>
<span class="lineno"></span><span class="comment" id="2560592">//&nbsp;Vmsplice</span><br>
<span class="lineno">1040</span><span class="comment" id="2560604">//&nbsp;Vserver</span><br>
<span class="lineno"></span><span class="comment" id="2560615">//&nbsp;Waitid</span><br>
<span class="lineno"></span><span class="comment" id="2560625">//&nbsp;_Sysctl</span>
</div>
</body>
</html>
