<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4144382">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4144438">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4144492">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4144543">package</span>&nbsp;<span class="ident" id="4144551">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4144556">import</span>&nbsp;<span class="op" id="4144563">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4144566">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4144572">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4144578">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="4144588">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4144591">//&nbsp;maxSendfileSize&nbsp;is&nbsp;the&nbsp;largest&nbsp;chunk&nbsp;size&nbsp;we&nbsp;ask&nbsp;the&nbsp;kernel&nbsp;to&nbsp;copy</span><br>
<span class="lineno"></span><span class="comment" id="4144662">//&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno">15</span><span class="keyword" id="4144676">const</span>&nbsp;<span class="ident" id="4144682">maxSendfileSize</span>&nbsp;<span class="builtintype" id="4144698">int</span>&nbsp;<span class="op" id="4144702">=</span>&nbsp;<span class="num" id="4144704">4</span>&nbsp;<span class="op" id="4144706">&lt;&lt;</span>&nbsp;<span class="num" id="4144709">20</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4144713">//&nbsp;sendFile&nbsp;copies&nbsp;the&nbsp;contents&nbsp;of&nbsp;r&nbsp;to&nbsp;c&nbsp;using&nbsp;the&nbsp;sendfile</span><br>
<span class="lineno"></span><span class="comment" id="4144774">//&nbsp;system&nbsp;call&nbsp;to&nbsp;minimize&nbsp;copies.</span><br>
<span class="lineno"></span><span class="comment" id="4144809">//</span><br>
<span class="lineno">20</span><span class="comment" id="4144812">//&nbsp;if&nbsp;handled&nbsp;==&nbsp;true,&nbsp;sendFile&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="4144887">//&nbsp;non-EOF&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4144905">//</span><br>
<span class="lineno"></span><span class="comment" id="4144908">//&nbsp;if&nbsp;handled&nbsp;==&nbsp;false,&nbsp;sendFile&nbsp;performed&nbsp;no&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="4144960">func</span>&nbsp;<span class="ident" id="4144965">sendFile</span><span class="op" id="4144973">(</span><span class="ident" id="4144974">c</span>&nbsp;<span class="op" id="4144976">*</span><span class="ident" id="4144977">netFD</span><span class="op" id="4144982">,</span>&nbsp;<span class="ident" id="4144984">r</span>&nbsp;<span class="ident" id="4144986">io</span><span class="op" id="4144988">.</span><span class="ident" id="4144989">Reader</span><span class="op" id="4144995">)</span>&nbsp;<span class="op" id="4144997">(</span><span class="ident" id="4144998">written</span>&nbsp;<span class="ident" id="4145006">int64</span><span class="op" id="4145011">,</span>&nbsp;<span class="ident" id="4145013">err</span>&nbsp;<span class="builtintype" id="4145017">error</span><span class="op" id="4145022">,</span>&nbsp;<span class="ident" id="4145024">handled</span>&nbsp;<span class="builtintype" id="4145032">bool</span><span class="op" id="4145036">)</span>&nbsp;<span class="op" id="4145038">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145041">var</span>&nbsp;<span class="ident" id="4145045">remain</span>&nbsp;<span class="ident" id="4145052">int64</span>&nbsp;<span class="op" id="4145058">=</span>&nbsp;<span class="num" id="4145060">1</span>&nbsp;<span class="op" id="4145062">&lt;&lt;</span>&nbsp;<span class="num" id="4145065">62</span>&nbsp;<span class="comment" id="4145068">//&nbsp;by&nbsp;default,&nbsp;copy&nbsp;until&nbsp;EOF</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145100">lr</span><span class="op" id="4145102">,</span>&nbsp;<span class="ident" id="4145104">ok</span>&nbsp;<span class="op" id="4145107">:=</span>&nbsp;<span class="ident" id="4145110">r</span><span class="op" id="4145111">.</span><span class="op" id="4145112">(</span><span class="op" id="4145113">*</span><span class="ident" id="4145114">io</span><span class="op" id="4145116">.</span><span class="ident" id="4145117">LimitedReader</span><span class="op" id="4145130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145133">if</span>&nbsp;<span class="ident" id="4145136">ok</span>&nbsp;<span class="op" id="4145139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145143">remain</span><span class="op" id="4145149">,</span>&nbsp;<span class="ident" id="4145151">r</span>&nbsp;<span class="op" id="4145153">=</span>&nbsp;<span class="ident" id="4145155">lr</span><span class="op" id="4145157">.</span><span class="ident" id="4145158">N</span><span class="op" id="4145159">,</span>&nbsp;<span class="ident" id="4145161">lr</span><span class="op" id="4145163">.</span><span class="ident" id="4145164">R</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145168">if</span>&nbsp;<span class="ident" id="4145171">remain</span>&nbsp;<span class="op" id="4145178">&lt;=</span>&nbsp;<span class="num" id="4145181">0</span>&nbsp;<span class="op" id="4145183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145188">return</span>&nbsp;<span class="num" id="4145195">0</span><span class="op" id="4145196">,</span>&nbsp;<span class="ident" id="4145198">nil</span><span class="op" id="4145201">,</span>&nbsp;<span class="builtintype" id="4145203">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145216">f</span><span class="op" id="4145217">,</span>&nbsp;<span class="ident" id="4145219">ok</span>&nbsp;<span class="op" id="4145222">:=</span>&nbsp;<span class="ident" id="4145225">r</span><span class="op" id="4145226">.</span><span class="op" id="4145227">(</span><span class="op" id="4145228">*</span><span class="ident" id="4145229">os</span><span class="op" id="4145231">.</span><span class="ident" id="4145232">File</span><span class="op" id="4145236">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145239">if</span>&nbsp;<span class="op" id="4145242">!</span><span class="ident" id="4145243">ok</span>&nbsp;<span class="op" id="4145246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145250">return</span>&nbsp;<span class="num" id="4145257">0</span><span class="op" id="4145258">,</span>&nbsp;<span class="ident" id="4145260">nil</span><span class="op" id="4145263">,</span>&nbsp;<span class="builtintype" id="4145265">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145276">if</span>&nbsp;<span class="ident" id="4145279">err</span>&nbsp;<span class="op" id="4145283">:=</span>&nbsp;<span class="ident" id="4145286">c</span><span class="op" id="4145287">.</span><span class="ident" id="4145288">writeLock</span><span class="op" id="4145297">(</span><span class="op" id="4145298">)</span><span class="op" id="4145299">;</span>&nbsp;<span class="ident" id="4145301">err</span>&nbsp;<span class="op" id="4145305">!=</span>&nbsp;<span class="ident" id="4145308">nil</span>&nbsp;<span class="op" id="4145312">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145316">return</span>&nbsp;<span class="num" id="4145323">0</span><span class="op" id="4145324">,</span>&nbsp;<span class="ident" id="4145326">err</span><span class="op" id="4145329">,</span>&nbsp;<span class="builtintype" id="4145331">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145340">defer</span>&nbsp;<span class="ident" id="4145346">c</span><span class="op" id="4145347">.</span><span class="ident" id="4145348">writeUnlock</span><span class="op" id="4145359">(</span><span class="op" id="4145360">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145364">dst</span>&nbsp;<span class="op" id="4145368">:=</span>&nbsp;<span class="ident" id="4145371">c</span><span class="op" id="4145372">.</span><span class="ident" id="4145373">sysfd</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145380">src</span>&nbsp;<span class="op" id="4145384">:=</span>&nbsp;<span class="builtintype" id="4145387">int</span><span class="op" id="4145390">(</span><span class="ident" id="4145391">f</span><span class="op" id="4145392">.</span><span class="ident" id="4145393">Fd</span><span class="op" id="4145395">(</span><span class="op" id="4145396">)</span><span class="op" id="4145397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145400">for</span>&nbsp;<span class="ident" id="4145404">remain</span>&nbsp;<span class="op" id="4145411">&gt;</span>&nbsp;<span class="num" id="4145413">0</span>&nbsp;<span class="op" id="4145415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145419">n</span>&nbsp;<span class="op" id="4145421">:=</span>&nbsp;<span class="ident" id="4145424">maxSendfileSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145442">if</span>&nbsp;<span class="ident" id="4145445">int64</span><span class="op" id="4145450">(</span><span class="ident" id="4145451">n</span><span class="op" id="4145452">)</span>&nbsp;<span class="op" id="4145454">&gt;</span>&nbsp;<span class="ident" id="4145456">remain</span>&nbsp;<span class="op" id="4145463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145468">n</span>&nbsp;<span class="op" id="4145470">=</span>&nbsp;<span class="builtintype" id="4145472">int</span><span class="op" id="4145475">(</span><span class="ident" id="4145476">remain</span><span class="op" id="4145482">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145490">n</span><span class="op" id="4145491">,</span>&nbsp;<span class="ident" id="4145493">err1</span>&nbsp;<span class="op" id="4145498">:=</span>&nbsp;<span class="ident" id="4145501">syscall</span><span class="op" id="4145508">.</span><span class="ident" id="4145509">Sendfile</span><span class="op" id="4145517">(</span><span class="ident" id="4145518">dst</span><span class="op" id="4145521">,</span>&nbsp;<span class="ident" id="4145523">src</span><span class="op" id="4145526">,</span>&nbsp;<span class="ident" id="4145528">nil</span><span class="op" id="4145531">,</span>&nbsp;<span class="ident" id="4145533">n</span><span class="op" id="4145534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145538">if</span>&nbsp;<span class="ident" id="4145541">n</span>&nbsp;<span class="op" id="4145543">&gt;</span>&nbsp;<span class="num" id="4145545">0</span>&nbsp;<span class="op" id="4145547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145552">written</span>&nbsp;<span class="op" id="4145560">+=</span>&nbsp;<span class="ident" id="4145563">int64</span><span class="op" id="4145568">(</span><span class="ident" id="4145569">n</span><span class="op" id="4145570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145575">remain</span>&nbsp;<span class="op" id="4145582">-=</span>&nbsp;<span class="ident" id="4145585">int64</span><span class="op" id="4145590">(</span><span class="ident" id="4145591">n</span><span class="op" id="4145592">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145600">if</span>&nbsp;<span class="ident" id="4145603">n</span>&nbsp;<span class="op" id="4145605">==</span>&nbsp;<span class="num" id="4145608">0</span>&nbsp;<span class="op" id="4145610">&amp;&amp;</span>&nbsp;<span class="ident" id="4145613">err1</span>&nbsp;<span class="op" id="4145618">==</span>&nbsp;<span class="ident" id="4145621">nil</span>&nbsp;<span class="op" id="4145625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145630">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145642">if</span>&nbsp;<span class="ident" id="4145645">err1</span>&nbsp;<span class="op" id="4145650">==</span>&nbsp;<span class="ident" id="4145653">syscall</span><span class="op" id="4145660">.</span><span class="ident" id="4145661">EAGAIN</span>&nbsp;<span class="op" id="4145668">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145673">if</span>&nbsp;<span class="ident" id="4145676">err1</span>&nbsp;<span class="op" id="4145681">=</span>&nbsp;<span class="ident" id="4145683">c</span><span class="op" id="4145684">.</span><span class="ident" id="4145685">pd</span><span class="op" id="4145687">.</span><span class="ident" id="4145688">WaitWrite</span><span class="op" id="4145697">(</span><span class="op" id="4145698">)</span><span class="op" id="4145699">;</span>&nbsp;<span class="ident" id="4145701">err1</span>&nbsp;<span class="op" id="4145706">==</span>&nbsp;<span class="ident" id="4145709">nil</span>&nbsp;<span class="op" id="4145713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145719">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145739">if</span>&nbsp;<span class="ident" id="4145742">err1</span>&nbsp;<span class="op" id="4145747">!=</span>&nbsp;<span class="ident" id="4145750">nil</span>&nbsp;<span class="op" id="4145754">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4145759">//&nbsp;This&nbsp;includes&nbsp;syscall.ENOSYS&nbsp;(no&nbsp;kernel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4145805">//&nbsp;support)&nbsp;and&nbsp;syscall.EINVAL&nbsp;(fd&nbsp;types&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4145855">//&nbsp;don&#39;t&nbsp;implement&nbsp;sendfile&nbsp;together)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145896">err</span>&nbsp;<span class="op" id="4145900">=</span>&nbsp;<span class="op" id="4145902">&amp;</span><span class="ident" id="4145903">OpError</span><span class="op" id="4145910">{</span><span class="string" id="4145911">&#34;sendfile&#34;</span><span class="op" id="4145921">,</span>&nbsp;<span class="ident" id="4145923">c</span><span class="op" id="4145924">.</span><span class="ident" id="4145925">net</span><span class="op" id="4145928">,</span>&nbsp;<span class="ident" id="4145930">c</span><span class="op" id="4145931">.</span><span class="ident" id="4145932">raddr</span><span class="op" id="4145937">,</span>&nbsp;<span class="ident" id="4145939">err1</span><span class="op" id="4145943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145948">break</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145962">if</span>&nbsp;<span class="ident" id="4145965">lr</span>&nbsp;<span class="op" id="4145968">!=</span>&nbsp;<span class="ident" id="4145971">nil</span>&nbsp;<span class="op" id="4145975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145979">lr</span><span class="op" id="4145981">.</span><span class="ident" id="4145982">N</span>&nbsp;<span class="op" id="4145984">=</span>&nbsp;<span class="ident" id="4145986">remain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145994">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145997">return</span>&nbsp;<span class="ident" id="4146004">written</span><span class="op" id="4146011">,</span>&nbsp;<span class="ident" id="4146013">err</span><span class="op" id="4146016">,</span>&nbsp;<span class="ident" id="4146018">written</span>&nbsp;<span class="op" id="4146026">&gt;</span>&nbsp;<span class="num" id="4146028">0</span><br>
<span class="lineno"></span><span class="op" id="4146030">}</span>
</div>
</body>
</html>
