<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509/pkix</h2>
<ul>
<li><a href="/gostd/crypto/x509/pkix/pkix.go.html" class="current">pkix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4867978">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4868033">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4868087">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4868138">//&nbsp;Package&nbsp;pkix&nbsp;contains&nbsp;shared,&nbsp;low&nbsp;level&nbsp;structures&nbsp;used&nbsp;for&nbsp;ASN.1&nbsp;parsing</span><br>
<span class="lineno"></span><span class="comment" id="4868215">//&nbsp;and&nbsp;serialization&nbsp;of&nbsp;X.509&nbsp;certificates,&nbsp;CRL&nbsp;and&nbsp;OCSP.</span><br>
<span class="lineno"></span><span class="keyword" id="4868273">package</span>&nbsp;<span class="ident" id="4868281">pkix</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4868287">import</span>&nbsp;<span class="op" id="4868294">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4868297">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4868314">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4868326">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4868333">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4868336">//&nbsp;AlgorithmIdentifier&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4868416">//&nbsp;5280,&nbsp;section&nbsp;4.1.1.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4868442">type</span>&nbsp;<span class="ident" id="4868447">AlgorithmIdentifier</span>&nbsp;<span class="keyword" id="4868467">struct</span>&nbsp;<span class="op" id="4868474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868477">Algorithm</span>&nbsp;&nbsp;<span class="ident" id="4868488">asn1</span><span class="op" id="4868492">.</span><span class="ident" id="4868493">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868511">Parameters</span>&nbsp;<span class="ident" id="4868522">asn1</span><span class="op" id="4868526">.</span><span class="ident" id="4868527">RawValue</span>&nbsp;<span class="string" id="4868536">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">20</span><span class="op" id="4868554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4868557">type</span>&nbsp;<span class="ident" id="4868562">RDNSequence</span>&nbsp;<span class="op" id="4868574">[</span><span class="op" id="4868575">]</span><span class="ident" id="4868576">RelativeDistinguishedNameSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4868606">type</span>&nbsp;<span class="ident" id="4868611">RelativeDistinguishedNameSET</span>&nbsp;<span class="op" id="4868640">[</span><span class="op" id="4868641">]</span><span class="ident" id="4868642">AttributeTypeAndValue</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4868665">//&nbsp;AttributeTypeAndValue&nbsp;mirrors&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4868738">//&nbsp;http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span><br>
<span class="lineno"></span><span class="keyword" id="4868792">type</span>&nbsp;<span class="ident" id="4868797">AttributeTypeAndValue</span>&nbsp;<span class="keyword" id="4868819">struct</span>&nbsp;<span class="op" id="4868826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868829">Type</span>&nbsp;&nbsp;<span class="ident" id="4868835">asn1</span><span class="op" id="4868839">.</span><span class="ident" id="4868840">ObjectIdentifier</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868858">Value</span>&nbsp;<span class="keyword" id="4868864">interface</span><span class="op" id="4868873">{</span><span class="op" id="4868874">}</span><br>
<span class="lineno"></span><span class="op" id="4868876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4868879">//&nbsp;AttributeTypeAndValueSET&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;ASN.1&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4868946">//&nbsp;AttributeTypeAndValue&nbsp;sequences&nbsp;from&nbsp;RFC&nbsp;2986&nbsp;(PKCS&nbsp;#10).</span><br>
<span class="lineno">35</span><span class="keyword" id="4869007">type</span>&nbsp;<span class="ident" id="4869012">AttributeTypeAndValueSET</span>&nbsp;<span class="keyword" id="4869037">struct</span>&nbsp;<span class="op" id="4869044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869047">Type</span>&nbsp;&nbsp;<span class="ident" id="4869053">asn1</span><span class="op" id="4869057">.</span><span class="ident" id="4869058">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869076">Value</span>&nbsp;<span class="op" id="4869082">[</span><span class="op" id="4869083">]</span><span class="op" id="4869084">[</span><span class="op" id="4869085">]</span><span class="ident" id="4869086">AttributeTypeAndValue</span>&nbsp;<span class="string" id="4869108">`asn1:&#34;set&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4869121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4869124">//&nbsp;Extension&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4869194">//&nbsp;5280,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4869216">type</span>&nbsp;<span class="ident" id="4869221">Extension</span>&nbsp;<span class="keyword" id="4869231">struct</span>&nbsp;<span class="op" id="4869238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869241">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869250">asn1</span><span class="op" id="4869254">.</span><span class="ident" id="4869255">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869273">Critical</span>&nbsp;<span class="builtintype" id="4869282">bool</span>&nbsp;<span class="string" id="4869287">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869306">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4869315">[</span><span class="op" id="4869316">]</span><span class="builtintype" id="4869317">byte</span><br>
<span class="lineno"></span><span class="op" id="4869322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4869325">//&nbsp;Name&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;distinguished&nbsp;name.&nbsp;This&nbsp;only&nbsp;includes&nbsp;the&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="4869403">//&nbsp;elements&nbsp;of&nbsp;a&nbsp;DN.&nbsp;&nbsp;Additional&nbsp;elements&nbsp;in&nbsp;the&nbsp;name&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">50</span><span class="keyword" id="4869470">type</span>&nbsp;<span class="ident" id="4869475">Name</span>&nbsp;<span class="keyword" id="4869480">struct</span>&nbsp;<span class="op" id="4869487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869490">Country</span><span class="op" id="4869497">,</span>&nbsp;<span class="ident" id="4869499">Organization</span><span class="op" id="4869511">,</span>&nbsp;<span class="ident" id="4869513">OrganizationalUnit</span>&nbsp;<span class="op" id="4869532">[</span><span class="op" id="4869533">]</span><span class="builtintype" id="4869534">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869542">Locality</span><span class="op" id="4869550">,</span>&nbsp;<span class="ident" id="4869552">Province</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4869584">[</span><span class="op" id="4869585">]</span><span class="builtintype" id="4869586">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869594">StreetAddress</span><span class="op" id="4869607">,</span>&nbsp;<span class="ident" id="4869609">PostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4869636">[</span><span class="op" id="4869637">]</span><span class="builtintype" id="4869638">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869646">SerialNumber</span><span class="op" id="4869658">,</span>&nbsp;<span class="ident" id="4869660">CommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4869688">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869697">Names</span>&nbsp;<span class="op" id="4869703">[</span><span class="op" id="4869704">]</span><span class="ident" id="4869705">AttributeTypeAndValue</span><br>
<span class="lineno"></span><span class="op" id="4869727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4869730">func</span>&nbsp;<span class="op" id="4869735">(</span><span class="ident" id="4869736">n</span>&nbsp;<span class="op" id="4869738">*</span><span class="ident" id="4869739">Name</span><span class="op" id="4869743">)</span>&nbsp;<span class="ident" id="4869745">FillFromRDNSequence</span><span class="op" id="4869764">(</span><span class="ident" id="4869765">rdns</span>&nbsp;<span class="op" id="4869770">*</span><span class="ident" id="4869771">RDNSequence</span><span class="op" id="4869782">)</span>&nbsp;<span class="op" id="4869784">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4869787">for</span>&nbsp;<span class="ident" id="4869791">_</span><span class="op" id="4869792">,</span>&nbsp;<span class="ident" id="4869794">rdn</span>&nbsp;<span class="op" id="4869798">:=</span>&nbsp;<span class="keyword" id="4869801">range</span>&nbsp;<span class="op" id="4869807">*</span><span class="ident" id="4869808">rdns</span>&nbsp;<span class="op" id="4869813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4869817">if</span>&nbsp;<span class="builtinfunc" id="4869820">len</span><span class="op" id="4869823">(</span><span class="ident" id="4869824">rdn</span><span class="op" id="4869827">)</span>&nbsp;<span class="op" id="4869829">==</span>&nbsp;<span class="num" id="4869832">0</span>&nbsp;<span class="op" id="4869834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4869839">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4869850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869854">atv</span>&nbsp;<span class="op" id="4869858">:=</span>&nbsp;<span class="ident" id="4869861">rdn</span><span class="op" id="4869864">[</span><span class="num" id="4869865">0</span><span class="op" id="4869866">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869870">n</span><span class="op" id="4869871">.</span><span class="ident" id="4869872">Names</span>&nbsp;<span class="op" id="4869878">=</span>&nbsp;<span class="builtinfunc" id="4869880">append</span><span class="op" id="4869886">(</span><span class="ident" id="4869887">n</span><span class="op" id="4869888">.</span><span class="ident" id="4869889">Names</span><span class="op" id="4869894">,</span>&nbsp;<span class="ident" id="4869896">atv</span><span class="op" id="4869899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869903">value</span><span class="op" id="4869908">,</span>&nbsp;<span class="ident" id="4869910">ok</span>&nbsp;<span class="op" id="4869913">:=</span>&nbsp;<span class="ident" id="4869916">atv</span><span class="op" id="4869919">.</span><span class="ident" id="4869920">Value</span><span class="op" id="4869925">.</span><span class="op" id="4869926">(</span><span class="builtintype" id="4869927">string</span><span class="op" id="4869933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4869937">if</span>&nbsp;<span class="op" id="4869940">!</span><span class="ident" id="4869941">ok</span>&nbsp;<span class="op" id="4869944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4869949">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4869960">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869965">t</span>&nbsp;<span class="op" id="4869967">:=</span>&nbsp;<span class="ident" id="4869970">atv</span><span class="op" id="4869973">.</span><span class="ident" id="4869974">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4869981">if</span>&nbsp;<span class="builtinfunc" id="4869984">len</span><span class="op" id="4869987">(</span><span class="ident" id="4869988">t</span><span class="op" id="4869989">)</span>&nbsp;<span class="op" id="4869991">==</span>&nbsp;<span class="num" id="4869994">4</span>&nbsp;<span class="op" id="4869996">&amp;&amp;</span>&nbsp;<span class="ident" id="4869999">t</span><span class="op" id="4870000">[</span><span class="num" id="4870001">0</span><span class="op" id="4870002">]</span>&nbsp;<span class="op" id="4870004">==</span>&nbsp;<span class="num" id="4870007">2</span>&nbsp;<span class="op" id="4870009">&amp;&amp;</span>&nbsp;<span class="ident" id="4870012">t</span><span class="op" id="4870013">[</span><span class="num" id="4870014">1</span><span class="op" id="4870015">]</span>&nbsp;<span class="op" id="4870017">==</span>&nbsp;<span class="num" id="4870020">5</span>&nbsp;<span class="op" id="4870022">&amp;&amp;</span>&nbsp;<span class="ident" id="4870025">t</span><span class="op" id="4870026">[</span><span class="num" id="4870027">2</span><span class="op" id="4870028">]</span>&nbsp;<span class="op" id="4870030">==</span>&nbsp;<span class="num" id="4870033">4</span>&nbsp;<span class="op" id="4870035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4870040">switch</span>&nbsp;<span class="ident" id="4870047">t</span><span class="op" id="4870048">[</span><span class="num" id="4870049">3</span><span class="op" id="4870050">]</span>&nbsp;<span class="op" id="4870052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4870057">case</span>&nbsp;<span class="num" id="4870062">3</span><span class="op" id="4870063">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870069">n</span><span class="op" id="4870070">.</span><span class="ident" id="4870071">CommonName</span>&nbsp;<span class="op" id="4870082">=</span>&nbsp;<span class="ident" id="4870084">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4870093">case</span>&nbsp;<span class="num" id="4870098">5</span><span class="op" id="4870099">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870105">n</span><span class="op" id="4870106">.</span><span class="ident" id="4870107">SerialNumber</span>&nbsp;<span class="op" id="4870120">=</span>&nbsp;<span class="ident" id="4870122">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4870131">case</span>&nbsp;<span class="num" id="4870136">6</span><span class="op" id="4870137">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870143">n</span><span class="op" id="4870144">.</span><span class="ident" id="4870145">Country</span>&nbsp;<span class="op" id="4870153">=</span>&nbsp;<span class="builtinfunc" id="4870155">append</span><span class="op" id="4870161">(</span><span class="ident" id="4870162">n</span><span class="op" id="4870163">.</span><span class="ident" id="4870164">Country</span><span class="op" id="4870171">,</span>&nbsp;<span class="ident" id="4870173">value</span><span class="op" id="4870178">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4870183">case</span>&nbsp;<span class="num" id="4870188">7</span><span class="op" id="4870189">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870195">n</span><span class="op" id="4870196">.</span><span class="ident" id="4870197">Locality</span>&nbsp;<span class="op" id="4870206">=</span>&nbsp;<span class="builtinfunc" id="4870208">append</span><span class="op" id="4870214">(</span><span class="ident" id="4870215">n</span><span class="op" id="4870216">.</span><span class="ident" id="4870217">Locality</span><span class="op" id="4870225">,</span>&nbsp;<span class="ident" id="4870227">value</span><span class="op" id="4870232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4870237">case</span>&nbsp;<span class="num" id="4870242">8</span><span class="op" id="4870243">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870249">n</span><span class="op" id="4870250">.</span><span class="ident" id="4870251">Province</span>&nbsp;<span class="op" id="4870260">=</span>&nbsp;<span class="builtinfunc" id="4870262">append</span><span class="op" id="4870268">(</span><span class="ident" id="4870269">n</span><span class="op" id="4870270">.</span><span class="ident" id="4870271">Province</span><span class="op" id="4870279">,</span>&nbsp;<span class="ident" id="4870281">value</span><span class="op" id="4870286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4870291">case</span>&nbsp;<span class="num" id="4870296">9</span><span class="op" id="4870297">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870303">n</span><span class="op" id="4870304">.</span><span class="ident" id="4870305">StreetAddress</span>&nbsp;<span class="op" id="4870319">=</span>&nbsp;<span class="builtinfunc" id="4870321">append</span><span class="op" id="4870327">(</span><span class="ident" id="4870328">n</span><span class="op" id="4870329">.</span><span class="ident" id="4870330">StreetAddress</span><span class="op" id="4870343">,</span>&nbsp;<span class="ident" id="4870345">value</span><span class="op" id="4870350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4870355">case</span>&nbsp;<span class="num" id="4870360">10</span><span class="op" id="4870362">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870368">n</span><span class="op" id="4870369">.</span><span class="ident" id="4870370">Organization</span>&nbsp;<span class="op" id="4870383">=</span>&nbsp;<span class="builtinfunc" id="4870385">append</span><span class="op" id="4870391">(</span><span class="ident" id="4870392">n</span><span class="op" id="4870393">.</span><span class="ident" id="4870394">Organization</span><span class="op" id="4870406">,</span>&nbsp;<span class="ident" id="4870408">value</span><span class="op" id="4870413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4870418">case</span>&nbsp;<span class="num" id="4870423">11</span><span class="op" id="4870425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870431">n</span><span class="op" id="4870432">.</span><span class="ident" id="4870433">OrganizationalUnit</span>&nbsp;<span class="op" id="4870452">=</span>&nbsp;<span class="builtinfunc" id="4870454">append</span><span class="op" id="4870460">(</span><span class="ident" id="4870461">n</span><span class="op" id="4870462">.</span><span class="ident" id="4870463">OrganizationalUnit</span><span class="op" id="4870481">,</span>&nbsp;<span class="ident" id="4870483">value</span><span class="op" id="4870488">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4870493">case</span>&nbsp;<span class="num" id="4870498">17</span><span class="op" id="4870500">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870506">n</span><span class="op" id="4870507">.</span><span class="ident" id="4870508">PostalCode</span>&nbsp;<span class="op" id="4870519">=</span>&nbsp;<span class="builtinfunc" id="4870521">append</span><span class="op" id="4870527">(</span><span class="ident" id="4870528">n</span><span class="op" id="4870529">.</span><span class="ident" id="4870530">PostalCode</span><span class="op" id="4870540">,</span>&nbsp;<span class="ident" id="4870542">value</span><span class="op" id="4870547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4870552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4870556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4870559">}</span><br>
<span class="lineno">95</span><span class="op" id="4870561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4870564">var</span>&nbsp;<span class="op" id="4870568">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870571">oidCountry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4870593">=</span>&nbsp;<span class="op" id="4870595">[</span><span class="op" id="4870596">]</span><span class="builtintype" id="4870597">int</span><span class="op" id="4870600">{</span><span class="num" id="4870601">2</span><span class="op" id="4870602">,</span>&nbsp;<span class="num" id="4870604">5</span><span class="op" id="4870605">,</span>&nbsp;<span class="num" id="4870607">4</span><span class="op" id="4870608">,</span>&nbsp;<span class="num" id="4870610">6</span><span class="op" id="4870611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870614">oidOrganization</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4870636">=</span>&nbsp;<span class="op" id="4870638">[</span><span class="op" id="4870639">]</span><span class="builtintype" id="4870640">int</span><span class="op" id="4870643">{</span><span class="num" id="4870644">2</span><span class="op" id="4870645">,</span>&nbsp;<span class="num" id="4870647">5</span><span class="op" id="4870648">,</span>&nbsp;<span class="num" id="4870650">4</span><span class="op" id="4870651">,</span>&nbsp;<span class="num" id="4870653">10</span><span class="op" id="4870655">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870658">oidOrganizationalUnit</span>&nbsp;<span class="op" id="4870680">=</span>&nbsp;<span class="op" id="4870682">[</span><span class="op" id="4870683">]</span><span class="builtintype" id="4870684">int</span><span class="op" id="4870687">{</span><span class="num" id="4870688">2</span><span class="op" id="4870689">,</span>&nbsp;<span class="num" id="4870691">5</span><span class="op" id="4870692">,</span>&nbsp;<span class="num" id="4870694">4</span><span class="op" id="4870695">,</span>&nbsp;<span class="num" id="4870697">11</span><span class="op" id="4870699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870702">oidCommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4870724">=</span>&nbsp;<span class="op" id="4870726">[</span><span class="op" id="4870727">]</span><span class="builtintype" id="4870728">int</span><span class="op" id="4870731">{</span><span class="num" id="4870732">2</span><span class="op" id="4870733">,</span>&nbsp;<span class="num" id="4870735">5</span><span class="op" id="4870736">,</span>&nbsp;<span class="num" id="4870738">4</span><span class="op" id="4870739">,</span>&nbsp;<span class="num" id="4870741">3</span><span class="op" id="4870742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870745">oidSerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4870767">=</span>&nbsp;<span class="op" id="4870769">[</span><span class="op" id="4870770">]</span><span class="builtintype" id="4870771">int</span><span class="op" id="4870774">{</span><span class="num" id="4870775">2</span><span class="op" id="4870776">,</span>&nbsp;<span class="num" id="4870778">5</span><span class="op" id="4870779">,</span>&nbsp;<span class="num" id="4870781">4</span><span class="op" id="4870782">,</span>&nbsp;<span class="num" id="4870784">5</span><span class="op" id="4870785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870788">oidLocality</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4870810">=</span>&nbsp;<span class="op" id="4870812">[</span><span class="op" id="4870813">]</span><span class="builtintype" id="4870814">int</span><span class="op" id="4870817">{</span><span class="num" id="4870818">2</span><span class="op" id="4870819">,</span>&nbsp;<span class="num" id="4870821">5</span><span class="op" id="4870822">,</span>&nbsp;<span class="num" id="4870824">4</span><span class="op" id="4870825">,</span>&nbsp;<span class="num" id="4870827">7</span><span class="op" id="4870828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870831">oidProvince</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4870853">=</span>&nbsp;<span class="op" id="4870855">[</span><span class="op" id="4870856">]</span><span class="builtintype" id="4870857">int</span><span class="op" id="4870860">{</span><span class="num" id="4870861">2</span><span class="op" id="4870862">,</span>&nbsp;<span class="num" id="4870864">5</span><span class="op" id="4870865">,</span>&nbsp;<span class="num" id="4870867">4</span><span class="op" id="4870868">,</span>&nbsp;<span class="num" id="4870870">8</span><span class="op" id="4870871">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870874">oidStreetAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4870896">=</span>&nbsp;<span class="op" id="4870898">[</span><span class="op" id="4870899">]</span><span class="builtintype" id="4870900">int</span><span class="op" id="4870903">{</span><span class="num" id="4870904">2</span><span class="op" id="4870905">,</span>&nbsp;<span class="num" id="4870907">5</span><span class="op" id="4870908">,</span>&nbsp;<span class="num" id="4870910">4</span><span class="op" id="4870911">,</span>&nbsp;<span class="num" id="4870913">9</span><span class="op" id="4870914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870917">oidPostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4870939">=</span>&nbsp;<span class="op" id="4870941">[</span><span class="op" id="4870942">]</span><span class="builtintype" id="4870943">int</span><span class="op" id="4870946">{</span><span class="num" id="4870947">2</span><span class="op" id="4870948">,</span>&nbsp;<span class="num" id="4870950">5</span><span class="op" id="4870951">,</span>&nbsp;<span class="num" id="4870953">4</span><span class="op" id="4870954">,</span>&nbsp;<span class="num" id="4870956">17</span><span class="op" id="4870958">}</span><br>
<span class="lineno"></span><span class="op" id="4870960">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4870963">//&nbsp;appendRDNs&nbsp;appends&nbsp;a&nbsp;relativeDistinguishedNameSET&nbsp;to&nbsp;the&nbsp;given&nbsp;RDNSequence</span><br>
<span class="lineno">110</span><span class="comment" id="4871041">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.&nbsp;The&nbsp;relativeDistinguishedNameSET&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4871116">//&nbsp;attributeTypeAndValue&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;given&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;5280,&nbsp;A.1,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4871194">//&nbsp;search&nbsp;for&nbsp;AttributeTypeAndValue.</span><br>
<span class="lineno"></span><span class="keyword" id="4871231">func</span>&nbsp;<span class="ident" id="4871236">appendRDNs</span><span class="op" id="4871246">(</span><span class="ident" id="4871247">in</span>&nbsp;<span class="ident" id="4871250">RDNSequence</span><span class="op" id="4871261">,</span>&nbsp;<span class="ident" id="4871263">values</span>&nbsp;<span class="op" id="4871270">[</span><span class="op" id="4871271">]</span><span class="builtintype" id="4871272">string</span><span class="op" id="4871278">,</span>&nbsp;<span class="ident" id="4871280">oid</span>&nbsp;<span class="ident" id="4871284">asn1</span><span class="op" id="4871288">.</span><span class="ident" id="4871289">ObjectIdentifier</span><span class="op" id="4871305">)</span>&nbsp;<span class="ident" id="4871307">RDNSequence</span>&nbsp;<span class="op" id="4871319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871322">if</span>&nbsp;<span class="builtinfunc" id="4871325">len</span><span class="op" id="4871328">(</span><span class="ident" id="4871329">values</span><span class="op" id="4871335">)</span>&nbsp;<span class="op" id="4871337">==</span>&nbsp;<span class="num" id="4871340">0</span>&nbsp;<span class="op" id="4871342">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871346">return</span>&nbsp;<span class="ident" id="4871353">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871361">s</span>&nbsp;<span class="op" id="4871363">:=</span>&nbsp;<span class="builtinfunc" id="4871366">make</span><span class="op" id="4871370">(</span><span class="op" id="4871371">[</span><span class="op" id="4871372">]</span><span class="ident" id="4871373">AttributeTypeAndValue</span><span class="op" id="4871394">,</span>&nbsp;<span class="builtinfunc" id="4871396">len</span><span class="op" id="4871399">(</span><span class="ident" id="4871400">values</span><span class="op" id="4871406">)</span><span class="op" id="4871407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871410">for</span>&nbsp;<span class="ident" id="4871414">i</span><span class="op" id="4871415">,</span>&nbsp;<span class="ident" id="4871417">value</span>&nbsp;<span class="op" id="4871423">:=</span>&nbsp;<span class="keyword" id="4871426">range</span>&nbsp;<span class="ident" id="4871432">values</span>&nbsp;<span class="op" id="4871439">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871443">s</span><span class="op" id="4871444">[</span><span class="ident" id="4871445">i</span><span class="op" id="4871446">]</span><span class="op" id="4871447">.</span><span class="ident" id="4871448">Type</span>&nbsp;<span class="op" id="4871453">=</span>&nbsp;<span class="ident" id="4871455">oid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871461">s</span><span class="op" id="4871462">[</span><span class="ident" id="4871463">i</span><span class="op" id="4871464">]</span><span class="op" id="4871465">.</span><span class="ident" id="4871466">Value</span>&nbsp;<span class="op" id="4871472">=</span>&nbsp;<span class="ident" id="4871474">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871485">return</span>&nbsp;<span class="builtinfunc" id="4871492">append</span><span class="op" id="4871498">(</span><span class="ident" id="4871499">in</span><span class="op" id="4871501">,</span>&nbsp;<span class="ident" id="4871503">s</span><span class="op" id="4871504">)</span><br>
<span class="lineno">125</span><span class="op" id="4871506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4871509">func</span>&nbsp;<span class="op" id="4871514">(</span><span class="ident" id="4871515">n</span>&nbsp;<span class="ident" id="4871517">Name</span><span class="op" id="4871521">)</span>&nbsp;<span class="ident" id="4871523">ToRDNSequence</span><span class="op" id="4871536">(</span><span class="op" id="4871537">)</span>&nbsp;<span class="op" id="4871539">(</span><span class="ident" id="4871540">ret</span>&nbsp;<span class="ident" id="4871544">RDNSequence</span><span class="op" id="4871555">)</span>&nbsp;<span class="op" id="4871557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871560">ret</span>&nbsp;<span class="op" id="4871564">=</span>&nbsp;<span class="ident" id="4871566">appendRDNs</span><span class="op" id="4871576">(</span><span class="ident" id="4871577">ret</span><span class="op" id="4871580">,</span>&nbsp;<span class="ident" id="4871582">n</span><span class="op" id="4871583">.</span><span class="ident" id="4871584">Country</span><span class="op" id="4871591">,</span>&nbsp;<span class="ident" id="4871593">oidCountry</span><span class="op" id="4871603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871606">ret</span>&nbsp;<span class="op" id="4871610">=</span>&nbsp;<span class="ident" id="4871612">appendRDNs</span><span class="op" id="4871622">(</span><span class="ident" id="4871623">ret</span><span class="op" id="4871626">,</span>&nbsp;<span class="ident" id="4871628">n</span><span class="op" id="4871629">.</span><span class="ident" id="4871630">Organization</span><span class="op" id="4871642">,</span>&nbsp;<span class="ident" id="4871644">oidOrganization</span><span class="op" id="4871659">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871662">ret</span>&nbsp;<span class="op" id="4871666">=</span>&nbsp;<span class="ident" id="4871668">appendRDNs</span><span class="op" id="4871678">(</span><span class="ident" id="4871679">ret</span><span class="op" id="4871682">,</span>&nbsp;<span class="ident" id="4871684">n</span><span class="op" id="4871685">.</span><span class="ident" id="4871686">OrganizationalUnit</span><span class="op" id="4871704">,</span>&nbsp;<span class="ident" id="4871706">oidOrganizationalUnit</span><span class="op" id="4871727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871730">ret</span>&nbsp;<span class="op" id="4871734">=</span>&nbsp;<span class="ident" id="4871736">appendRDNs</span><span class="op" id="4871746">(</span><span class="ident" id="4871747">ret</span><span class="op" id="4871750">,</span>&nbsp;<span class="ident" id="4871752">n</span><span class="op" id="4871753">.</span><span class="ident" id="4871754">Locality</span><span class="op" id="4871762">,</span>&nbsp;<span class="ident" id="4871764">oidLocality</span><span class="op" id="4871775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871778">ret</span>&nbsp;<span class="op" id="4871782">=</span>&nbsp;<span class="ident" id="4871784">appendRDNs</span><span class="op" id="4871794">(</span><span class="ident" id="4871795">ret</span><span class="op" id="4871798">,</span>&nbsp;<span class="ident" id="4871800">n</span><span class="op" id="4871801">.</span><span class="ident" id="4871802">Province</span><span class="op" id="4871810">,</span>&nbsp;<span class="ident" id="4871812">oidProvince</span><span class="op" id="4871823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871826">ret</span>&nbsp;<span class="op" id="4871830">=</span>&nbsp;<span class="ident" id="4871832">appendRDNs</span><span class="op" id="4871842">(</span><span class="ident" id="4871843">ret</span><span class="op" id="4871846">,</span>&nbsp;<span class="ident" id="4871848">n</span><span class="op" id="4871849">.</span><span class="ident" id="4871850">StreetAddress</span><span class="op" id="4871863">,</span>&nbsp;<span class="ident" id="4871865">oidStreetAddress</span><span class="op" id="4871881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871884">ret</span>&nbsp;<span class="op" id="4871888">=</span>&nbsp;<span class="ident" id="4871890">appendRDNs</span><span class="op" id="4871900">(</span><span class="ident" id="4871901">ret</span><span class="op" id="4871904">,</span>&nbsp;<span class="ident" id="4871906">n</span><span class="op" id="4871907">.</span><span class="ident" id="4871908">PostalCode</span><span class="op" id="4871918">,</span>&nbsp;<span class="ident" id="4871920">oidPostalCode</span><span class="op" id="4871933">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871936">if</span>&nbsp;<span class="builtinfunc" id="4871939">len</span><span class="op" id="4871942">(</span><span class="ident" id="4871943">n</span><span class="op" id="4871944">.</span><span class="ident" id="4871945">CommonName</span><span class="op" id="4871955">)</span>&nbsp;<span class="op" id="4871957">&gt;</span>&nbsp;<span class="num" id="4871959">0</span>&nbsp;<span class="op" id="4871961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871965">ret</span>&nbsp;<span class="op" id="4871969">=</span>&nbsp;<span class="ident" id="4871971">appendRDNs</span><span class="op" id="4871981">(</span><span class="ident" id="4871982">ret</span><span class="op" id="4871985">,</span>&nbsp;<span class="op" id="4871987">[</span><span class="op" id="4871988">]</span><span class="builtintype" id="4871989">string</span><span class="op" id="4871995">{</span><span class="ident" id="4871996">n</span><span class="op" id="4871997">.</span><span class="ident" id="4871998">CommonName</span><span class="op" id="4872008">}</span><span class="op" id="4872009">,</span>&nbsp;<span class="ident" id="4872011">oidCommonName</span><span class="op" id="4872024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872030">if</span>&nbsp;<span class="builtinfunc" id="4872033">len</span><span class="op" id="4872036">(</span><span class="ident" id="4872037">n</span><span class="op" id="4872038">.</span><span class="ident" id="4872039">SerialNumber</span><span class="op" id="4872051">)</span>&nbsp;<span class="op" id="4872053">&gt;</span>&nbsp;<span class="num" id="4872055">0</span>&nbsp;<span class="op" id="4872057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872061">ret</span>&nbsp;<span class="op" id="4872065">=</span>&nbsp;<span class="ident" id="4872067">appendRDNs</span><span class="op" id="4872077">(</span><span class="ident" id="4872078">ret</span><span class="op" id="4872081">,</span>&nbsp;<span class="op" id="4872083">[</span><span class="op" id="4872084">]</span><span class="builtintype" id="4872085">string</span><span class="op" id="4872091">{</span><span class="ident" id="4872092">n</span><span class="op" id="4872093">.</span><span class="ident" id="4872094">SerialNumber</span><span class="op" id="4872106">}</span><span class="op" id="4872107">,</span>&nbsp;<span class="ident" id="4872109">oidSerialNumber</span><span class="op" id="4872124">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872131">return</span>&nbsp;<span class="ident" id="4872138">ret</span><br>
<span class="lineno"></span><span class="op" id="4872142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4872145">//&nbsp;CertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4872221">//&nbsp;5280,&nbsp;section&nbsp;5.1.&nbsp;Use&nbsp;Certificate.CheckCRLSignature&nbsp;to&nbsp;verify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4872291">//&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4872305">type</span>&nbsp;<span class="ident" id="4872310">CertificateList</span>&nbsp;<span class="keyword" id="4872326">struct</span>&nbsp;<span class="op" id="4872333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872336">TBSCertList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872355">TBSCertificateList</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872375">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4872394">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872415">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872434">asn1</span><span class="op" id="4872438">.</span><span class="ident" id="4872439">BitString</span><br>
<span class="lineno"></span><span class="op" id="4872449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4872452">//&nbsp;HasExpired&nbsp;reports&nbsp;whether&nbsp;now&nbsp;is&nbsp;past&nbsp;the&nbsp;expiry&nbsp;time&nbsp;of&nbsp;certList.</span><br>
<span class="lineno">155</span><span class="keyword" id="4872523">func</span>&nbsp;<span class="op" id="4872528">(</span><span class="ident" id="4872529">certList</span>&nbsp;<span class="op" id="4872538">*</span><span class="ident" id="4872539">CertificateList</span><span class="op" id="4872554">)</span>&nbsp;<span class="ident" id="4872556">HasExpired</span><span class="op" id="4872566">(</span><span class="ident" id="4872567">now</span>&nbsp;<span class="ident" id="4872571">time</span><span class="op" id="4872575">.</span><span class="ident" id="4872576">Time</span><span class="op" id="4872580">)</span>&nbsp;<span class="builtintype" id="4872582">bool</span>&nbsp;<span class="op" id="4872587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872590">return</span>&nbsp;<span class="ident" id="4872597">now</span><span class="op" id="4872600">.</span><span class="ident" id="4872601">After</span><span class="op" id="4872606">(</span><span class="ident" id="4872607">certList</span><span class="op" id="4872615">.</span><span class="ident" id="4872616">TBSCertList</span><span class="op" id="4872627">.</span><span class="ident" id="4872628">NextUpdate</span><span class="op" id="4872638">)</span><br>
<span class="lineno"></span><span class="op" id="4872640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4872643">//&nbsp;TBSCertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno">160</span><span class="comment" id="4872722">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4872744">type</span>&nbsp;<span class="ident" id="4872749">TBSCertificateList</span>&nbsp;<span class="keyword" id="4872768">struct</span>&nbsp;<span class="op" id="4872775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872778">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872798">asn1</span><span class="op" id="4872802">.</span><span class="ident" id="4872803">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872815">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4872835">int</span>&nbsp;<span class="string" id="4872839">`asn1:&#34;optional,default:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872868">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872888">AlgorithmIdentifier</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872909">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872929">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872942">ThisUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872962">time</span><span class="op" id="4872966">.</span><span class="ident" id="4872967">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872973">NextUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872993">time</span><span class="op" id="4872997">.</span><span class="ident" id="4872998">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4873014">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873033">RevokedCertificates</span>&nbsp;<span class="op" id="4873053">[</span><span class="op" id="4873054">]</span><span class="ident" id="4873055">RevokedCertificate</span>&nbsp;<span class="string" id="4873074">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873093">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4873113">[</span><span class="op" id="4873114">]</span><span class="ident" id="4873115">Extension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4873134">`asn1:&#34;tag:0,optional,explicit&#34;`</span><br>
<span class="lineno">170</span><span class="op" id="4873167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4873170">//&nbsp;RevokedCertificate&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4873249">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4873271">type</span>&nbsp;<span class="ident" id="4873276">RevokedCertificate</span>&nbsp;<span class="keyword" id="4873295">struct</span>&nbsp;<span class="op" id="4873302">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873305">SerialNumber</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4873320">*</span><span class="ident" id="4873321">big</span><span class="op" id="4873324">.</span><span class="ident" id="4873325">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873330">RevocationTime</span>&nbsp;<span class="ident" id="4873345">time</span><span class="op" id="4873349">.</span><span class="ident" id="4873350">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873356">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4873371">[</span><span class="op" id="4873372">]</span><span class="ident" id="4873373">Extension</span>&nbsp;<span class="string" id="4873383">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4873401">}</span>
</div>
</body>
</html>
