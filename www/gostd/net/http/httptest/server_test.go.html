<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httptest</h2>
<ul>
<li><a href="/gostd/net/http/httptest/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder.go.html">recorder.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder_test.go.html">recorder_test.go</a></li>
<li><a href="/gostd/net/http/httptest/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/httptest/server_test.go.html">server_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6492028">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6492083">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6492137">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6492188">package</span>&nbsp;<span class="ident" id="6492196">httptest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6492206">import</span>&nbsp;<span class="op" id="6492213">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6492216">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6492229">&#34;net/http&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6492241">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6492251">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6492254">func</span>&nbsp;<span class="ident" id="6492259">TestServer</span><span class="op" id="6492269">(</span><span class="ident" id="6492270">t</span>&nbsp;<span class="op" id="6492272">*</span><span class="ident" id="6492273">testing</span><span class="op" id="6492280">.</span><span class="ident" id="6492281">T</span><span class="op" id="6492282">)</span>&nbsp;<span class="op" id="6492284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492287">ts</span>&nbsp;<span class="op" id="6492290">:=</span>&nbsp;<span class="ident" id="6492293">NewServer</span><span class="op" id="6492302">(</span><span class="ident" id="6492303">http</span><span class="op" id="6492307">.</span><span class="ident" id="6492308">HandlerFunc</span><span class="op" id="6492319">(</span><span class="keyword" id="6492320">func</span><span class="op" id="6492324">(</span><span class="ident" id="6492325">w</span>&nbsp;<span class="ident" id="6492327">http</span><span class="op" id="6492331">.</span><span class="ident" id="6492332">ResponseWriter</span><span class="op" id="6492346">,</span>&nbsp;<span class="ident" id="6492348">r</span>&nbsp;<span class="op" id="6492350">*</span><span class="ident" id="6492351">http</span><span class="op" id="6492355">.</span><span class="ident" id="6492356">Request</span><span class="op" id="6492363">)</span>&nbsp;<span class="op" id="6492365">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492369">w</span><span class="op" id="6492370">.</span><span class="ident" id="6492371">Write</span><span class="op" id="6492376">(</span><span class="op" id="6492377">[</span><span class="op" id="6492378">]</span><span class="builtintype" id="6492379">byte</span><span class="op" id="6492383">(</span><span class="string" id="6492384">&#34;hello&#34;</span><span class="op" id="6492391">)</span><span class="op" id="6492392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492395">}</span><span class="op" id="6492396">)</span><span class="op" id="6492397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492400">defer</span>&nbsp;<span class="ident" id="6492406">ts</span><span class="op" id="6492408">.</span><span class="ident" id="6492409">Close</span><span class="op" id="6492414">(</span><span class="op" id="6492415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492418">res</span><span class="op" id="6492421">,</span>&nbsp;<span class="ident" id="6492423">err</span>&nbsp;<span class="op" id="6492427">:=</span>&nbsp;<span class="ident" id="6492430">http</span><span class="op" id="6492434">.</span><span class="ident" id="6492435">Get</span><span class="op" id="6492438">(</span><span class="ident" id="6492439">ts</span><span class="op" id="6492441">.</span><span class="ident" id="6492442">URL</span><span class="op" id="6492445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492448">if</span>&nbsp;<span class="ident" id="6492451">err</span>&nbsp;<span class="op" id="6492455">!=</span>&nbsp;<span class="ident" id="6492458">nil</span>&nbsp;<span class="op" id="6492462">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492466">t</span><span class="op" id="6492467">.</span><span class="ident" id="6492468">Fatal</span><span class="op" id="6492473">(</span><span class="ident" id="6492474">err</span><span class="op" id="6492477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492483">got</span><span class="op" id="6492486">,</span>&nbsp;<span class="ident" id="6492488">err</span>&nbsp;<span class="op" id="6492492">:=</span>&nbsp;<span class="ident" id="6492495">ioutil</span><span class="op" id="6492501">.</span><span class="ident" id="6492502">ReadAll</span><span class="op" id="6492509">(</span><span class="ident" id="6492510">res</span><span class="op" id="6492513">.</span><span class="ident" id="6492514">Body</span><span class="op" id="6492518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492521">if</span>&nbsp;<span class="ident" id="6492524">err</span>&nbsp;<span class="op" id="6492528">!=</span>&nbsp;<span class="ident" id="6492531">nil</span>&nbsp;<span class="op" id="6492535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492539">t</span><span class="op" id="6492540">.</span><span class="ident" id="6492541">Fatal</span><span class="op" id="6492546">(</span><span class="ident" id="6492547">err</span><span class="op" id="6492550">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492556">if</span>&nbsp;<span class="builtintype" id="6492559">string</span><span class="op" id="6492565">(</span><span class="ident" id="6492566">got</span><span class="op" id="6492569">)</span>&nbsp;<span class="op" id="6492571">!=</span>&nbsp;<span class="string" id="6492574">&#34;hello&#34;</span>&nbsp;<span class="op" id="6492582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492586">t</span><span class="op" id="6492587">.</span><span class="ident" id="6492588">Errorf</span><span class="op" id="6492594">(</span><span class="string" id="6492595">&#34;got&nbsp;%q,&nbsp;want&nbsp;hello&#34;</span><span class="op" id="6492615">,</span>&nbsp;<span class="builtintype" id="6492617">string</span><span class="op" id="6492623">(</span><span class="ident" id="6492624">got</span><span class="op" id="6492627">)</span><span class="op" id="6492628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492631">}</span><br>
<span class="lineno"></span><span class="op" id="6492633">}</span>
</div>
</body>
</html>
