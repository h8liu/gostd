<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1886541">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1886596">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1886650">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1886701">package</span>&nbsp;<span class="ident" id="1886709">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1886715">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspBessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1886781">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1886835">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1886886">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1886941">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1886971">//</span><br>
<span class="lineno"></span><span class="comment" id="1886974">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1887030">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1887099">//</span><br>
<span class="lineno"></span><span class="comment" id="1887102">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1887161">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1887217">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1887274">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1887291">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1887347">//</span><br>
<span class="lineno">25</span><span class="comment" id="1887350">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1887392">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="1887452">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="1887466">//</span><br>
<span class="lineno"></span><span class="comment" id="1887469">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="1887487">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="1887552">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="1887615">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="1887649">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="1887683">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="1887717">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="1887769">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="1887809">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1887864">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="1887919">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="1887976">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1888029">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1888083">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="1888117">//</span><br>
<span class="lineno"></span><span class="comment" id="1888120">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="1888171">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="1888218">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1888242">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="1888303">//</span><br>
<span class="lineno">50</span><span class="comment" id="1888306">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1888328">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1888348">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1888368">func</span>&nbsp;<span class="ident" id="1888373">Jn</span><span class="op" id="1888375">(</span><span class="ident" id="1888376">n</span>&nbsp;<span class="builtintype" id="1888378">int</span><span class="op" id="1888381">,</span>&nbsp;<span class="ident" id="1888383">x</span>&nbsp;<span class="builtintype" id="1888385">float64</span><span class="op" id="1888392">)</span>&nbsp;<span class="builtintype" id="1888394">float64</span>&nbsp;<span class="op" id="1888402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888405">const</span>&nbsp;<span class="op" id="1888411">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888415">TwoM29</span>&nbsp;<span class="op" id="1888422">=</span>&nbsp;<span class="num" id="1888424">1.0</span>&nbsp;<span class="op" id="1888428">/</span>&nbsp;<span class="op" id="1888430">(</span><span class="num" id="1888431">1</span>&nbsp;<span class="op" id="1888433">&lt;&lt;</span>&nbsp;<span class="num" id="1888436">29</span><span class="op" id="1888438">)</span>&nbsp;<span class="comment" id="1888440">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888471">Two302</span>&nbsp;<span class="op" id="1888478">=</span>&nbsp;<span class="num" id="1888480">1</span>&nbsp;<span class="op" id="1888482">&lt;&lt;</span>&nbsp;<span class="num" id="1888485">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1888496">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1888526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1888529">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888547">switch</span>&nbsp;<span class="op" id="1888554">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888557">case</span>&nbsp;<span class="ident" id="1888562">IsNaN</span><span class="op" id="1888567">(</span><span class="ident" id="1888568">x</span><span class="op" id="1888569">)</span><span class="op" id="1888570">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888574">return</span>&nbsp;<span class="ident" id="1888581">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888584">case</span>&nbsp;<span class="ident" id="1888589">IsInf</span><span class="op" id="1888594">(</span><span class="ident" id="1888595">x</span><span class="op" id="1888596">,</span>&nbsp;<span class="num" id="1888598">0</span><span class="op" id="1888599">)</span><span class="op" id="1888600">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888604">return</span>&nbsp;<span class="num" id="1888611">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1888614">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1888617">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1888680">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888711">if</span>&nbsp;<span class="ident" id="1888714">n</span>&nbsp;<span class="op" id="1888716">==</span>&nbsp;<span class="num" id="1888719">0</span>&nbsp;<span class="op" id="1888721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888725">return</span>&nbsp;<span class="ident" id="1888732">J0</span><span class="op" id="1888734">(</span><span class="ident" id="1888735">x</span><span class="op" id="1888736">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1888739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888742">if</span>&nbsp;<span class="ident" id="1888745">x</span>&nbsp;<span class="op" id="1888747">==</span>&nbsp;<span class="num" id="1888750">0</span>&nbsp;<span class="op" id="1888752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888756">return</span>&nbsp;<span class="num" id="1888763">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1888766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888769">if</span>&nbsp;<span class="ident" id="1888772">n</span>&nbsp;<span class="op" id="1888774">&lt;</span>&nbsp;<span class="num" id="1888776">0</span>&nbsp;<span class="op" id="1888778">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888782">n</span><span class="op" id="1888783">,</span>&nbsp;<span class="ident" id="1888785">x</span>&nbsp;<span class="op" id="1888787">=</span>&nbsp;<span class="op" id="1888789">-</span><span class="ident" id="1888790">n</span><span class="op" id="1888791">,</span>&nbsp;<span class="op" id="1888793">-</span><span class="ident" id="1888794">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1888797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888800">if</span>&nbsp;<span class="ident" id="1888803">n</span>&nbsp;<span class="op" id="1888805">==</span>&nbsp;<span class="num" id="1888808">1</span>&nbsp;<span class="op" id="1888810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888814">return</span>&nbsp;<span class="ident" id="1888821">J1</span><span class="op" id="1888823">(</span><span class="ident" id="1888824">x</span><span class="op" id="1888825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1888828">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888831">sign</span>&nbsp;<span class="op" id="1888836">:=</span>&nbsp;<span class="builtintype" id="1888839">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888846">if</span>&nbsp;<span class="ident" id="1888849">x</span>&nbsp;<span class="op" id="1888851">&lt;</span>&nbsp;<span class="num" id="1888853">0</span>&nbsp;<span class="op" id="1888855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888859">x</span>&nbsp;<span class="op" id="1888861">=</span>&nbsp;<span class="op" id="1888863">-</span><span class="ident" id="1888864">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888868">if</span>&nbsp;<span class="ident" id="1888871">n</span><span class="op" id="1888872">&amp;</span><span class="num" id="1888873">1</span>&nbsp;<span class="op" id="1888875">==</span>&nbsp;<span class="num" id="1888878">1</span>&nbsp;<span class="op" id="1888880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888885">sign</span>&nbsp;<span class="op" id="1888890">=</span>&nbsp;<span class="builtintype" id="1888892">true</span>&nbsp;<span class="comment" id="1888897">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1888923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1888926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888929">var</span>&nbsp;<span class="ident" id="1888933">b</span>&nbsp;<span class="builtintype" id="1888935">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888944">if</span>&nbsp;<span class="builtintype" id="1888947">float64</span><span class="op" id="1888954">(</span><span class="ident" id="1888955">n</span><span class="op" id="1888956">)</span>&nbsp;<span class="op" id="1888958">&lt;=</span>&nbsp;<span class="ident" id="1888961">x</span>&nbsp;<span class="op" id="1888963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1888967">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889015">if</span>&nbsp;<span class="ident" id="1889018">x</span>&nbsp;<span class="op" id="1889020">&gt;=</span>&nbsp;<span class="ident" id="1889023">Two302</span>&nbsp;<span class="op" id="1889030">{</span>&nbsp;<span class="comment" id="1889032">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889050">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889068">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889123">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889178">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889217">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889274">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889280">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889336">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889390">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889438">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889486">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889534">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889583">var</span>&nbsp;<span class="ident" id="1889587">temp</span>&nbsp;<span class="builtintype" id="1889592">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889603">switch</span>&nbsp;<span class="ident" id="1889610">n</span>&nbsp;<span class="op" id="1889612">&amp;</span>&nbsp;<span class="num" id="1889614">3</span>&nbsp;<span class="op" id="1889616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889621">case</span>&nbsp;<span class="num" id="1889626">0</span><span class="op" id="1889627">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889633">temp</span>&nbsp;<span class="op" id="1889638">=</span>&nbsp;<span class="ident" id="1889640">Cos</span><span class="op" id="1889643">(</span><span class="ident" id="1889644">x</span><span class="op" id="1889645">)</span>&nbsp;<span class="op" id="1889647">+</span>&nbsp;<span class="ident" id="1889649">Sin</span><span class="op" id="1889652">(</span><span class="ident" id="1889653">x</span><span class="op" id="1889654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889659">case</span>&nbsp;<span class="num" id="1889664">1</span><span class="op" id="1889665">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889671">temp</span>&nbsp;<span class="op" id="1889676">=</span>&nbsp;<span class="op" id="1889678">-</span><span class="ident" id="1889679">Cos</span><span class="op" id="1889682">(</span><span class="ident" id="1889683">x</span><span class="op" id="1889684">)</span>&nbsp;<span class="op" id="1889686">+</span>&nbsp;<span class="ident" id="1889688">Sin</span><span class="op" id="1889691">(</span><span class="ident" id="1889692">x</span><span class="op" id="1889693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889698">case</span>&nbsp;<span class="num" id="1889703">2</span><span class="op" id="1889704">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889710">temp</span>&nbsp;<span class="op" id="1889715">=</span>&nbsp;<span class="op" id="1889717">-</span><span class="ident" id="1889718">Cos</span><span class="op" id="1889721">(</span><span class="ident" id="1889722">x</span><span class="op" id="1889723">)</span>&nbsp;<span class="op" id="1889725">-</span>&nbsp;<span class="ident" id="1889727">Sin</span><span class="op" id="1889730">(</span><span class="ident" id="1889731">x</span><span class="op" id="1889732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889737">case</span>&nbsp;<span class="num" id="1889742">3</span><span class="op" id="1889743">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889749">temp</span>&nbsp;<span class="op" id="1889754">=</span>&nbsp;<span class="ident" id="1889756">Cos</span><span class="op" id="1889759">(</span><span class="ident" id="1889760">x</span><span class="op" id="1889761">)</span>&nbsp;<span class="op" id="1889763">-</span>&nbsp;<span class="ident" id="1889765">Sin</span><span class="op" id="1889768">(</span><span class="ident" id="1889769">x</span><span class="op" id="1889770">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889780">b</span>&nbsp;<span class="op" id="1889782">=</span>&nbsp;<span class="op" id="1889784">(</span><span class="num" id="1889785">1</span>&nbsp;<span class="op" id="1889787">/</span>&nbsp;<span class="ident" id="1889789">SqrtPi</span><span class="op" id="1889795">)</span>&nbsp;<span class="op" id="1889797">*</span>&nbsp;<span class="ident" id="1889799">temp</span>&nbsp;<span class="op" id="1889804">/</span>&nbsp;<span class="ident" id="1889806">Sqrt</span><span class="op" id="1889810">(</span><span class="ident" id="1889811">x</span><span class="op" id="1889812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889816">}</span>&nbsp;<span class="keyword" id="1889818">else</span>&nbsp;<span class="op" id="1889823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889828">b</span>&nbsp;<span class="op" id="1889830">=</span>&nbsp;<span class="ident" id="1889832">J1</span><span class="op" id="1889834">(</span><span class="ident" id="1889835">x</span><span class="op" id="1889836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889841">for</span>&nbsp;<span class="ident" id="1889845">i</span><span class="op" id="1889846">,</span>&nbsp;<span class="ident" id="1889848">a</span>&nbsp;<span class="op" id="1889850">:=</span>&nbsp;<span class="num" id="1889853">1</span><span class="op" id="1889854">,</span>&nbsp;<span class="ident" id="1889856">J0</span><span class="op" id="1889858">(</span><span class="ident" id="1889859">x</span><span class="op" id="1889860">)</span><span class="op" id="1889861">;</span>&nbsp;<span class="ident" id="1889863">i</span>&nbsp;<span class="op" id="1889865">&lt;</span>&nbsp;<span class="ident" id="1889867">n</span><span class="op" id="1889868">;</span>&nbsp;<span class="ident" id="1889870">i</span><span class="op" id="1889871">++</span>&nbsp;<span class="op" id="1889874">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889880">a</span><span class="op" id="1889881">,</span>&nbsp;<span class="ident" id="1889883">b</span>&nbsp;<span class="op" id="1889885">=</span>&nbsp;<span class="ident" id="1889887">b</span><span class="op" id="1889888">,</span>&nbsp;<span class="ident" id="1889890">b</span><span class="op" id="1889891">*</span><span class="op" id="1889892">(</span><span class="builtintype" id="1889893">float64</span><span class="op" id="1889900">(</span><span class="ident" id="1889901">i</span><span class="op" id="1889902">+</span><span class="ident" id="1889903">i</span><span class="op" id="1889904">)</span><span class="op" id="1889905">/</span><span class="ident" id="1889906">x</span><span class="op" id="1889907">)</span><span class="op" id="1889908">-</span><span class="ident" id="1889909">a</span>&nbsp;<span class="comment" id="1889911">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889940">}</span>&nbsp;<span class="keyword" id="1889942">else</span>&nbsp;<span class="op" id="1889947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889951">if</span>&nbsp;<span class="ident" id="1889954">x</span>&nbsp;<span class="op" id="1889956">&lt;</span>&nbsp;<span class="ident" id="1889958">TwoM29</span>&nbsp;<span class="op" id="1889965">{</span>&nbsp;<span class="comment" id="1889967">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889984">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890045">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890082">if</span>&nbsp;<span class="ident" id="1890085">n</span>&nbsp;<span class="op" id="1890087">&gt;</span>&nbsp;<span class="num" id="1890089">33</span>&nbsp;<span class="op" id="1890092">{</span>&nbsp;<span class="comment" id="1890094">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890111">b</span>&nbsp;<span class="op" id="1890113">=</span>&nbsp;<span class="num" id="1890115">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890120">}</span>&nbsp;<span class="keyword" id="1890122">else</span>&nbsp;<span class="op" id="1890127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890133">temp</span>&nbsp;<span class="op" id="1890138">:=</span>&nbsp;<span class="ident" id="1890141">x</span>&nbsp;<span class="op" id="1890143">*</span>&nbsp;<span class="num" id="1890145">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890153">b</span>&nbsp;<span class="op" id="1890155">=</span>&nbsp;<span class="ident" id="1890157">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890166">a</span>&nbsp;<span class="op" id="1890168">:=</span>&nbsp;<span class="num" id="1890171">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890179">for</span>&nbsp;<span class="ident" id="1890183">i</span>&nbsp;<span class="op" id="1890185">:=</span>&nbsp;<span class="num" id="1890188">2</span><span class="op" id="1890189">;</span>&nbsp;<span class="ident" id="1890191">i</span>&nbsp;<span class="op" id="1890193">&lt;=</span>&nbsp;<span class="ident" id="1890196">n</span><span class="op" id="1890197">;</span>&nbsp;<span class="ident" id="1890199">i</span><span class="op" id="1890200">++</span>&nbsp;<span class="op" id="1890203">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890210">a</span>&nbsp;<span class="op" id="1890212">*=</span>&nbsp;<span class="builtintype" id="1890215">float64</span><span class="op" id="1890222">(</span><span class="ident" id="1890223">i</span><span class="op" id="1890224">)</span>&nbsp;<span class="comment" id="1890226">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890241">b</span>&nbsp;<span class="op" id="1890243">*=</span>&nbsp;<span class="ident" id="1890246">temp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1890257">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890283">b</span>&nbsp;<span class="op" id="1890285">/=</span>&nbsp;<span class="ident" id="1890288">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890293">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890297">}</span>&nbsp;<span class="keyword" id="1890299">else</span>&nbsp;<span class="op" id="1890304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890309">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890339">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890388">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890445">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890494">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890500">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890545">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890601">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890649">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890699">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890745">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890751">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890805">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890847">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890872">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890909">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890937">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890973">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891004">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891039">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891076">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891082">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891128">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891163">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891201">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891239">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891277">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891320">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891338">w</span>&nbsp;<span class="op" id="1891340">:=</span>&nbsp;<span class="builtintype" id="1891343">float64</span><span class="op" id="1891350">(</span><span class="ident" id="1891351">n</span><span class="op" id="1891352">+</span><span class="ident" id="1891353">n</span><span class="op" id="1891354">)</span>&nbsp;<span class="op" id="1891356">/</span>&nbsp;<span class="ident" id="1891358">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891363">h</span>&nbsp;<span class="op" id="1891365">:=</span>&nbsp;<span class="num" id="1891368">2</span>&nbsp;<span class="op" id="1891370">/</span>&nbsp;<span class="ident" id="1891372">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891377">q0</span>&nbsp;<span class="op" id="1891380">:=</span>&nbsp;<span class="ident" id="1891383">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891388">z</span>&nbsp;<span class="op" id="1891390">:=</span>&nbsp;<span class="ident" id="1891393">w</span>&nbsp;<span class="op" id="1891395">+</span>&nbsp;<span class="ident" id="1891397">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891402">q1</span>&nbsp;<span class="op" id="1891405">:=</span>&nbsp;<span class="ident" id="1891408">w</span><span class="op" id="1891409">*</span><span class="ident" id="1891410">z</span>&nbsp;<span class="op" id="1891412">-</span>&nbsp;<span class="num" id="1891414">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891419">k</span>&nbsp;<span class="op" id="1891421">:=</span>&nbsp;<span class="num" id="1891424">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891429">for</span>&nbsp;<span class="ident" id="1891433">q1</span>&nbsp;<span class="op" id="1891436">&lt;</span>&nbsp;<span class="num" id="1891438">1e9</span>&nbsp;<span class="op" id="1891442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891448">k</span>&nbsp;<span class="op" id="1891450">+=</span>&nbsp;<span class="num" id="1891453">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891459">z</span>&nbsp;<span class="op" id="1891461">+=</span>&nbsp;<span class="ident" id="1891464">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891470">q0</span><span class="op" id="1891472">,</span>&nbsp;<span class="ident" id="1891474">q1</span>&nbsp;<span class="op" id="1891477">=</span>&nbsp;<span class="ident" id="1891479">q1</span><span class="op" id="1891481">,</span>&nbsp;<span class="ident" id="1891483">z</span><span class="op" id="1891484">*</span><span class="ident" id="1891485">q1</span><span class="op" id="1891487">-</span><span class="ident" id="1891488">q0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1891494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891499">m</span>&nbsp;<span class="op" id="1891501">:=</span>&nbsp;<span class="ident" id="1891504">n</span>&nbsp;<span class="op" id="1891506">+</span>&nbsp;<span class="ident" id="1891508">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891513">t</span>&nbsp;<span class="op" id="1891515">:=</span>&nbsp;<span class="num" id="1891518">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891525">for</span>&nbsp;<span class="ident" id="1891529">i</span>&nbsp;<span class="op" id="1891531">:=</span>&nbsp;<span class="num" id="1891534">2</span>&nbsp;<span class="op" id="1891536">*</span>&nbsp;<span class="op" id="1891538">(</span><span class="ident" id="1891539">n</span>&nbsp;<span class="op" id="1891541">+</span>&nbsp;<span class="ident" id="1891543">k</span><span class="op" id="1891544">)</span><span class="op" id="1891545">;</span>&nbsp;<span class="ident" id="1891547">i</span>&nbsp;<span class="op" id="1891549">&gt;=</span>&nbsp;<span class="ident" id="1891552">m</span><span class="op" id="1891553">;</span>&nbsp;<span class="ident" id="1891555">i</span>&nbsp;<span class="op" id="1891557">-=</span>&nbsp;<span class="num" id="1891560">2</span>&nbsp;<span class="op" id="1891562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891568">t</span>&nbsp;<span class="op" id="1891570">=</span>&nbsp;<span class="num" id="1891572">1</span>&nbsp;<span class="op" id="1891574">/</span>&nbsp;<span class="op" id="1891576">(</span><span class="builtintype" id="1891577">float64</span><span class="op" id="1891584">(</span><span class="ident" id="1891585">i</span><span class="op" id="1891586">)</span><span class="op" id="1891587">/</span><span class="ident" id="1891588">x</span>&nbsp;<span class="op" id="1891590">-</span>&nbsp;<span class="ident" id="1891592">t</span><span class="op" id="1891593">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1891598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891603">a</span>&nbsp;<span class="op" id="1891605">:=</span>&nbsp;<span class="ident" id="1891608">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891613">b</span>&nbsp;<span class="op" id="1891615">=</span>&nbsp;<span class="num" id="1891617">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891622">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891676">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891713">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891744">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891785">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891851">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891910">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891943">tmp</span>&nbsp;<span class="op" id="1891947">:=</span>&nbsp;<span class="builtintype" id="1891950">float64</span><span class="op" id="1891957">(</span><span class="ident" id="1891958">n</span><span class="op" id="1891959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891964">v</span>&nbsp;<span class="op" id="1891966">:=</span>&nbsp;<span class="num" id="1891969">2</span>&nbsp;<span class="op" id="1891971">/</span>&nbsp;<span class="ident" id="1891973">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891978">tmp</span>&nbsp;<span class="op" id="1891982">=</span>&nbsp;<span class="ident" id="1891984">tmp</span>&nbsp;<span class="op" id="1891988">*</span>&nbsp;<span class="ident" id="1891990">Log</span><span class="op" id="1891993">(</span><span class="ident" id="1891994">Abs</span><span class="op" id="1891997">(</span><span class="ident" id="1891998">v</span><span class="op" id="1891999">*</span><span class="ident" id="1892000">tmp</span><span class="op" id="1892003">)</span><span class="op" id="1892004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892009">if</span>&nbsp;<span class="ident" id="1892012">tmp</span>&nbsp;<span class="op" id="1892016">&lt;</span>&nbsp;<span class="num" id="1892018">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="1892045">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892051">for</span>&nbsp;<span class="ident" id="1892055">i</span>&nbsp;<span class="op" id="1892057">:=</span>&nbsp;<span class="ident" id="1892060">n</span>&nbsp;<span class="op" id="1892062">-</span>&nbsp;<span class="num" id="1892064">1</span><span class="op" id="1892065">;</span>&nbsp;<span class="ident" id="1892067">i</span>&nbsp;<span class="op" id="1892069">&gt;</span>&nbsp;<span class="num" id="1892071">0</span><span class="op" id="1892072">;</span>&nbsp;<span class="ident" id="1892074">i</span><span class="op" id="1892075">--</span>&nbsp;<span class="op" id="1892078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892085">di</span>&nbsp;<span class="op" id="1892088">:=</span>&nbsp;<span class="builtintype" id="1892091">float64</span><span class="op" id="1892098">(</span><span class="ident" id="1892099">i</span>&nbsp;<span class="op" id="1892101">+</span>&nbsp;<span class="ident" id="1892103">i</span><span class="op" id="1892104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892111">a</span><span class="op" id="1892112">,</span>&nbsp;<span class="ident" id="1892114">b</span>&nbsp;<span class="op" id="1892116">=</span>&nbsp;<span class="ident" id="1892118">b</span><span class="op" id="1892119">,</span>&nbsp;<span class="ident" id="1892121">b</span><span class="op" id="1892122">*</span><span class="ident" id="1892123">di</span><span class="op" id="1892125">/</span><span class="ident" id="1892126">x</span><span class="op" id="1892127">-</span><span class="ident" id="1892128">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892135">di</span>&nbsp;<span class="op" id="1892138">-=</span>&nbsp;<span class="num" id="1892141">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892147">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892152">}</span>&nbsp;<span class="keyword" id="1892154">else</span>&nbsp;<span class="op" id="1892159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892165">for</span>&nbsp;<span class="ident" id="1892169">i</span>&nbsp;<span class="op" id="1892171">:=</span>&nbsp;<span class="ident" id="1892174">n</span>&nbsp;<span class="op" id="1892176">-</span>&nbsp;<span class="num" id="1892178">1</span><span class="op" id="1892179">;</span>&nbsp;<span class="ident" id="1892181">i</span>&nbsp;<span class="op" id="1892183">&gt;</span>&nbsp;<span class="num" id="1892185">0</span><span class="op" id="1892186">;</span>&nbsp;<span class="ident" id="1892188">i</span><span class="op" id="1892189">--</span>&nbsp;<span class="op" id="1892192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892199">di</span>&nbsp;<span class="op" id="1892202">:=</span>&nbsp;<span class="builtintype" id="1892205">float64</span><span class="op" id="1892212">(</span><span class="ident" id="1892213">i</span>&nbsp;<span class="op" id="1892215">+</span>&nbsp;<span class="ident" id="1892217">i</span><span class="op" id="1892218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892225">a</span><span class="op" id="1892226">,</span>&nbsp;<span class="ident" id="1892228">b</span>&nbsp;<span class="op" id="1892230">=</span>&nbsp;<span class="ident" id="1892232">b</span><span class="op" id="1892233">,</span>&nbsp;<span class="ident" id="1892235">b</span><span class="op" id="1892236">*</span><span class="ident" id="1892237">di</span><span class="op" id="1892239">/</span><span class="ident" id="1892240">x</span><span class="op" id="1892241">-</span><span class="ident" id="1892242">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892249">di</span>&nbsp;<span class="op" id="1892252">-=</span>&nbsp;<span class="num" id="1892255">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1892262">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892305">if</span>&nbsp;<span class="ident" id="1892308">b</span>&nbsp;<span class="op" id="1892310">&gt;</span>&nbsp;<span class="num" id="1892312">1e100</span>&nbsp;<span class="op" id="1892318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892326">a</span>&nbsp;<span class="op" id="1892328">/=</span>&nbsp;<span class="ident" id="1892331">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892339">t</span>&nbsp;<span class="op" id="1892341">/=</span>&nbsp;<span class="ident" id="1892344">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892352">b</span>&nbsp;<span class="op" id="1892354">=</span>&nbsp;<span class="num" id="1892356">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892379">b</span>&nbsp;<span class="op" id="1892381">=</span>&nbsp;<span class="ident" id="1892383">t</span>&nbsp;<span class="op" id="1892385">*</span>&nbsp;<span class="ident" id="1892387">J0</span><span class="op" id="1892389">(</span><span class="ident" id="1892390">x</span><span class="op" id="1892391">)</span>&nbsp;<span class="op" id="1892393">/</span>&nbsp;<span class="ident" id="1892395">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892399">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892405">if</span>&nbsp;<span class="ident" id="1892408">sign</span>&nbsp;<span class="op" id="1892413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892417">return</span>&nbsp;<span class="op" id="1892424">-</span><span class="ident" id="1892425">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892431">return</span>&nbsp;<span class="ident" id="1892438">b</span><br>
<span class="lineno">225</span><span class="op" id="1892440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1892443">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="1892505">//</span><br>
<span class="lineno"></span><span class="comment" id="1892508">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="1892530">//&nbsp;&nbsp;&nbsp;&nbspYn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1892549">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="1892572">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="1892626">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1892648">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="1892668">func</span>&nbsp;<span class="ident" id="1892673">Yn</span><span class="op" id="1892675">(</span><span class="ident" id="1892676">n</span>&nbsp;<span class="builtintype" id="1892678">int</span><span class="op" id="1892681">,</span>&nbsp;<span class="ident" id="1892683">x</span>&nbsp;<span class="builtintype" id="1892685">float64</span><span class="op" id="1892692">)</span>&nbsp;<span class="builtintype" id="1892694">float64</span>&nbsp;<span class="op" id="1892702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892705">const</span>&nbsp;<span class="ident" id="1892711">Two302</span>&nbsp;<span class="op" id="1892718">=</span>&nbsp;<span class="num" id="1892720">1</span>&nbsp;<span class="op" id="1892722">&lt;&lt;</span>&nbsp;<span class="num" id="1892725">302</span>&nbsp;<span class="comment" id="1892729">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1892759">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892777">switch</span>&nbsp;<span class="op" id="1892784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892787">case</span>&nbsp;<span class="ident" id="1892792">x</span>&nbsp;<span class="op" id="1892794">&lt;</span>&nbsp;<span class="num" id="1892796">0</span>&nbsp;<span class="op" id="1892798">||</span>&nbsp;<span class="ident" id="1892801">IsNaN</span><span class="op" id="1892806">(</span><span class="ident" id="1892807">x</span><span class="op" id="1892808">)</span><span class="op" id="1892809">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892813">return</span>&nbsp;<span class="ident" id="1892820">NaN</span><span class="op" id="1892823">(</span><span class="op" id="1892824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892827">case</span>&nbsp;<span class="ident" id="1892832">IsInf</span><span class="op" id="1892837">(</span><span class="ident" id="1892838">x</span><span class="op" id="1892839">,</span>&nbsp;<span class="num" id="1892841">1</span><span class="op" id="1892842">)</span><span class="op" id="1892843">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892847">return</span>&nbsp;<span class="num" id="1892854">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892861">if</span>&nbsp;<span class="ident" id="1892864">n</span>&nbsp;<span class="op" id="1892866">==</span>&nbsp;<span class="num" id="1892869">0</span>&nbsp;<span class="op" id="1892871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892875">return</span>&nbsp;<span class="ident" id="1892882">Y0</span><span class="op" id="1892884">(</span><span class="ident" id="1892885">x</span><span class="op" id="1892886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892892">if</span>&nbsp;<span class="ident" id="1892895">x</span>&nbsp;<span class="op" id="1892897">==</span>&nbsp;<span class="num" id="1892900">0</span>&nbsp;<span class="op" id="1892902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892906">if</span>&nbsp;<span class="ident" id="1892909">n</span>&nbsp;<span class="op" id="1892911">&lt;</span>&nbsp;<span class="num" id="1892913">0</span>&nbsp;<span class="op" id="1892915">&amp;&amp;</span>&nbsp;<span class="ident" id="1892918">n</span><span class="op" id="1892919">&amp;</span><span class="num" id="1892920">1</span>&nbsp;<span class="op" id="1892922">==</span>&nbsp;<span class="num" id="1892925">1</span>&nbsp;<span class="op" id="1892927">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892932">return</span>&nbsp;<span class="ident" id="1892939">Inf</span><span class="op" id="1892942">(</span><span class="num" id="1892943">1</span><span class="op" id="1892944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892952">return</span>&nbsp;<span class="ident" id="1892959">Inf</span><span class="op" id="1892962">(</span><span class="op" id="1892963">-</span><span class="num" id="1892964">1</span><span class="op" id="1892965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892971">sign</span>&nbsp;<span class="op" id="1892976">:=</span>&nbsp;<span class="builtintype" id="1892979">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892986">if</span>&nbsp;<span class="ident" id="1892989">n</span>&nbsp;<span class="op" id="1892991">&lt;</span>&nbsp;<span class="num" id="1892993">0</span>&nbsp;<span class="op" id="1892995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892999">n</span>&nbsp;<span class="op" id="1893001">=</span>&nbsp;<span class="op" id="1893003">-</span><span class="ident" id="1893004">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893008">if</span>&nbsp;<span class="ident" id="1893011">n</span><span class="op" id="1893012">&amp;</span><span class="num" id="1893013">1</span>&nbsp;<span class="op" id="1893015">==</span>&nbsp;<span class="num" id="1893018">1</span>&nbsp;<span class="op" id="1893020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893025">sign</span>&nbsp;<span class="op" id="1893030">=</span>&nbsp;<span class="builtintype" id="1893032">true</span>&nbsp;<span class="comment" id="1893037">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893072">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893078">if</span>&nbsp;<span class="ident" id="1893081">n</span>&nbsp;<span class="op" id="1893083">==</span>&nbsp;<span class="num" id="1893086">1</span>&nbsp;<span class="op" id="1893088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893092">if</span>&nbsp;<span class="ident" id="1893095">sign</span>&nbsp;<span class="op" id="1893100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893105">return</span>&nbsp;<span class="op" id="1893112">-</span><span class="ident" id="1893113">Y1</span><span class="op" id="1893115">(</span><span class="ident" id="1893116">x</span><span class="op" id="1893117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893121">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893125">return</span>&nbsp;<span class="ident" id="1893132">Y1</span><span class="op" id="1893134">(</span><span class="ident" id="1893135">x</span><span class="op" id="1893136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893142">var</span>&nbsp;<span class="ident" id="1893146">b</span>&nbsp;<span class="builtintype" id="1893148">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893157">if</span>&nbsp;<span class="ident" id="1893160">x</span>&nbsp;<span class="op" id="1893162">&gt;=</span>&nbsp;<span class="ident" id="1893165">Two302</span>&nbsp;<span class="op" id="1893172">{</span>&nbsp;<span class="comment" id="1893174">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893190">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893207">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893256">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893305">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893338">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspxn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893382">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893387">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbspsin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbspcos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893424">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893465">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893487">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893510">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp-s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893532">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893555">var</span>&nbsp;<span class="ident" id="1893559">temp</span>&nbsp;<span class="builtintype" id="1893564">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893574">switch</span>&nbsp;<span class="ident" id="1893581">n</span>&nbsp;<span class="op" id="1893583">&amp;</span>&nbsp;<span class="num" id="1893585">3</span>&nbsp;<span class="op" id="1893587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893591">case</span>&nbsp;<span class="num" id="1893596">0</span><span class="op" id="1893597">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893602">temp</span>&nbsp;<span class="op" id="1893607">=</span>&nbsp;<span class="ident" id="1893609">Sin</span><span class="op" id="1893612">(</span><span class="ident" id="1893613">x</span><span class="op" id="1893614">)</span>&nbsp;<span class="op" id="1893616">-</span>&nbsp;<span class="ident" id="1893618">Cos</span><span class="op" id="1893621">(</span><span class="ident" id="1893622">x</span><span class="op" id="1893623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893627">case</span>&nbsp;<span class="num" id="1893632">1</span><span class="op" id="1893633">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893638">temp</span>&nbsp;<span class="op" id="1893643">=</span>&nbsp;<span class="op" id="1893645">-</span><span class="ident" id="1893646">Sin</span><span class="op" id="1893649">(</span><span class="ident" id="1893650">x</span><span class="op" id="1893651">)</span>&nbsp;<span class="op" id="1893653">-</span>&nbsp;<span class="ident" id="1893655">Cos</span><span class="op" id="1893658">(</span><span class="ident" id="1893659">x</span><span class="op" id="1893660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893664">case</span>&nbsp;<span class="num" id="1893669">2</span><span class="op" id="1893670">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893675">temp</span>&nbsp;<span class="op" id="1893680">=</span>&nbsp;<span class="op" id="1893682">-</span><span class="ident" id="1893683">Sin</span><span class="op" id="1893686">(</span><span class="ident" id="1893687">x</span><span class="op" id="1893688">)</span>&nbsp;<span class="op" id="1893690">+</span>&nbsp;<span class="ident" id="1893692">Cos</span><span class="op" id="1893695">(</span><span class="ident" id="1893696">x</span><span class="op" id="1893697">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893701">case</span>&nbsp;<span class="num" id="1893706">3</span><span class="op" id="1893707">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893712">temp</span>&nbsp;<span class="op" id="1893717">=</span>&nbsp;<span class="ident" id="1893719">Sin</span><span class="op" id="1893722">(</span><span class="ident" id="1893723">x</span><span class="op" id="1893724">)</span>&nbsp;<span class="op" id="1893726">+</span>&nbsp;<span class="ident" id="1893728">Cos</span><span class="op" id="1893731">(</span><span class="ident" id="1893732">x</span><span class="op" id="1893733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893741">b</span>&nbsp;<span class="op" id="1893743">=</span>&nbsp;<span class="op" id="1893745">(</span><span class="num" id="1893746">1</span>&nbsp;<span class="op" id="1893748">/</span>&nbsp;<span class="ident" id="1893750">SqrtPi</span><span class="op" id="1893756">)</span>&nbsp;<span class="op" id="1893758">*</span>&nbsp;<span class="ident" id="1893760">temp</span>&nbsp;<span class="op" id="1893765">/</span>&nbsp;<span class="ident" id="1893767">Sqrt</span><span class="op" id="1893771">(</span><span class="ident" id="1893772">x</span><span class="op" id="1893773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893776">}</span>&nbsp;<span class="keyword" id="1893778">else</span>&nbsp;<span class="op" id="1893783">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893787">a</span>&nbsp;<span class="op" id="1893789">:=</span>&nbsp;<span class="ident" id="1893792">Y0</span><span class="op" id="1893794">(</span><span class="ident" id="1893795">x</span><span class="op" id="1893796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893800">b</span>&nbsp;<span class="op" id="1893802">=</span>&nbsp;<span class="ident" id="1893804">Y1</span><span class="op" id="1893806">(</span><span class="ident" id="1893807">x</span><span class="op" id="1893808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893812">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893835">for</span>&nbsp;<span class="ident" id="1893839">i</span>&nbsp;<span class="op" id="1893841">:=</span>&nbsp;<span class="num" id="1893844">1</span><span class="op" id="1893845">;</span>&nbsp;<span class="ident" id="1893847">i</span>&nbsp;<span class="op" id="1893849">&lt;</span>&nbsp;<span class="ident" id="1893851">n</span>&nbsp;<span class="op" id="1893853">&amp;&amp;</span>&nbsp;<span class="op" id="1893856">!</span><span class="ident" id="1893857">IsInf</span><span class="op" id="1893862">(</span><span class="ident" id="1893863">b</span><span class="op" id="1893864">,</span>&nbsp;<span class="op" id="1893866">-</span><span class="num" id="1893867">1</span><span class="op" id="1893868">)</span><span class="op" id="1893869">;</span>&nbsp;<span class="ident" id="1893871">i</span><span class="op" id="1893872">++</span>&nbsp;<span class="op" id="1893875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893880">a</span><span class="op" id="1893881">,</span>&nbsp;<span class="ident" id="1893883">b</span>&nbsp;<span class="op" id="1893885">=</span>&nbsp;<span class="ident" id="1893887">b</span><span class="op" id="1893888">,</span>&nbsp;<span class="op" id="1893890">(</span><span class="builtintype" id="1893891">float64</span><span class="op" id="1893898">(</span><span class="ident" id="1893899">i</span><span class="op" id="1893900">+</span><span class="ident" id="1893901">i</span><span class="op" id="1893902">)</span><span class="op" id="1893903">/</span><span class="ident" id="1893904">x</span><span class="op" id="1893905">)</span><span class="op" id="1893906">*</span><span class="ident" id="1893907">b</span><span class="op" id="1893908">-</span><span class="ident" id="1893909">a</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893919">if</span>&nbsp;<span class="ident" id="1893922">sign</span>&nbsp;<span class="op" id="1893927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893931">return</span>&nbsp;<span class="op" id="1893938">-</span><span class="ident" id="1893939">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893942">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893945">return</span>&nbsp;<span class="ident" id="1893952">b</span><br>
<span class="lineno"></span><span class="op" id="1893954">}</span>
</div>
</body>
</html>
