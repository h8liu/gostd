<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7515677">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7515733">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7515787">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7515838">package</span>&nbsp;<span class="ident" id="7515846">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7515851">import</span>&nbsp;<span class="op" id="7515858">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515861">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515870">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515877">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515883">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515894">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515905">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515916">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7515931">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7515934">const</span>&nbsp;<span class="ident" id="7515940">testInput</span>&nbsp;<span class="op" id="7515950">=</span>&nbsp;<span class="string" id="7515952">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="7516169">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7516172">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="7516181">+</span>&nbsp;<span class="string" id="7516183">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7516473">var</span>&nbsp;<span class="ident" id="7516477">testEntity</span>&nbsp;<span class="op" id="7516488">=</span>&nbsp;<span class="keyword" id="7516490">map</span><span class="op" id="7516493">[</span><span class="builtintype" id="7516494">string</span><span class="op" id="7516500">]</span><span class="builtintype" id="7516501">string</span><span class="op" id="7516507">{</span><span class="string" id="7516508">&#34;何&#34;</span><span class="op" id="7516513">:</span>&nbsp;<span class="string" id="7516515">&#34;What&#34;</span><span class="op" id="7516521">,</span>&nbsp;<span class="string" id="7516523">&#34;is-it&#34;</span><span class="op" id="7516530">:</span>&nbsp;<span class="string" id="7516532">&#34;is&nbsp;it?&#34;</span><span class="op" id="7516540">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="7516543">var</span>&nbsp;<span class="ident" id="7516547">rawTokens</span>&nbsp;<span class="op" id="7516557">=</span>&nbsp;<span class="op" id="7516559">[</span><span class="op" id="7516560">]</span><span class="ident" id="7516561">Token</span><span class="op" id="7516566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516569">CharData</span><span class="op" id="7516577">(</span><span class="string" id="7516578">&#34;\n&#34;</span><span class="op" id="7516582">)</span><span class="op" id="7516583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516586">ProcInst</span><span class="op" id="7516594">{</span><span class="string" id="7516595">&#34;xml&#34;</span><span class="op" id="7516600">,</span>&nbsp;<span class="op" id="7516602">[</span><span class="op" id="7516603">]</span><span class="builtintype" id="7516604">byte</span><span class="op" id="7516608">(</span><span class="string" id="7516609">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="7516641">)</span><span class="op" id="7516642">}</span><span class="op" id="7516643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516646">CharData</span><span class="op" id="7516654">(</span><span class="string" id="7516655">&#34;\n&#34;</span><span class="op" id="7516659">)</span><span class="op" id="7516660">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516663">Directive</span><span class="op" id="7516672">(</span><span class="string" id="7516673">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="7516795">)</span><span class="op" id="7516796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516799">CharData</span><span class="op" id="7516807">(</span><span class="string" id="7516808">&#34;\n&#34;</span><span class="op" id="7516812">)</span><span class="op" id="7516813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516816">StartElement</span><span class="op" id="7516828">{</span><span class="ident" id="7516829">Name</span><span class="op" id="7516833">{</span><span class="string" id="7516834">&#34;&#34;</span><span class="op" id="7516836">,</span>&nbsp;<span class="string" id="7516838">&#34;body&#34;</span><span class="op" id="7516844">}</span><span class="op" id="7516845">,</span>&nbsp;<span class="op" id="7516847">[</span><span class="op" id="7516848">]</span><span class="ident" id="7516849">Attr</span><span class="op" id="7516853">{</span><span class="op" id="7516854">{</span><span class="ident" id="7516855">Name</span><span class="op" id="7516859">{</span><span class="string" id="7516860">&#34;xmlns&#34;</span><span class="op" id="7516867">,</span>&nbsp;<span class="string" id="7516869">&#34;foo&#34;</span><span class="op" id="7516874">}</span><span class="op" id="7516875">,</span>&nbsp;<span class="string" id="7516877">&#34;ns1&#34;</span><span class="op" id="7516882">}</span><span class="op" id="7516883">,</span>&nbsp;<span class="op" id="7516885">{</span><span class="ident" id="7516886">Name</span><span class="op" id="7516890">{</span><span class="string" id="7516891">&#34;&#34;</span><span class="op" id="7516893">,</span>&nbsp;<span class="string" id="7516895">&#34;xmlns&#34;</span><span class="op" id="7516902">}</span><span class="op" id="7516903">,</span>&nbsp;<span class="string" id="7516905">&#34;ns2&#34;</span><span class="op" id="7516910">}</span><span class="op" id="7516911">,</span>&nbsp;<span class="op" id="7516913">{</span><span class="ident" id="7516914">Name</span><span class="op" id="7516918">{</span><span class="string" id="7516919">&#34;xmlns&#34;</span><span class="op" id="7516926">,</span>&nbsp;<span class="string" id="7516928">&#34;tag&#34;</span><span class="op" id="7516933">}</span><span class="op" id="7516934">,</span>&nbsp;<span class="string" id="7516936">&#34;ns3&#34;</span><span class="op" id="7516941">}</span><span class="op" id="7516942">}</span><span class="op" id="7516943">}</span><span class="op" id="7516944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516947">CharData</span><span class="op" id="7516955">(</span><span class="string" id="7516956">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7516962">)</span><span class="op" id="7516963">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516966">StartElement</span><span class="op" id="7516978">{</span><span class="ident" id="7516979">Name</span><span class="op" id="7516983">{</span><span class="string" id="7516984">&#34;&#34;</span><span class="op" id="7516986">,</span>&nbsp;<span class="string" id="7516988">&#34;hello&#34;</span><span class="op" id="7516995">}</span><span class="op" id="7516996">,</span>&nbsp;<span class="op" id="7516998">[</span><span class="op" id="7516999">]</span><span class="ident" id="7517000">Attr</span><span class="op" id="7517004">{</span><span class="op" id="7517005">{</span><span class="ident" id="7517006">Name</span><span class="op" id="7517010">{</span><span class="string" id="7517011">&#34;&#34;</span><span class="op" id="7517013">,</span>&nbsp;<span class="string" id="7517015">&#34;lang&#34;</span><span class="op" id="7517021">}</span><span class="op" id="7517022">,</span>&nbsp;<span class="string" id="7517024">&#34;en&#34;</span><span class="op" id="7517028">}</span><span class="op" id="7517029">}</span><span class="op" id="7517030">}</span><span class="op" id="7517031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517034">CharData</span><span class="op" id="7517042">(</span><span class="string" id="7517043">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="7517066">)</span><span class="op" id="7517067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517070">EndElement</span><span class="op" id="7517080">{</span><span class="ident" id="7517081">Name</span><span class="op" id="7517085">{</span><span class="string" id="7517086">&#34;&#34;</span><span class="op" id="7517088">,</span>&nbsp;<span class="string" id="7517090">&#34;hello&#34;</span><span class="op" id="7517097">}</span><span class="op" id="7517098">}</span><span class="op" id="7517099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517102">CharData</span><span class="op" id="7517110">(</span><span class="string" id="7517111">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7517117">)</span><span class="op" id="7517118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517121">StartElement</span><span class="op" id="7517133">{</span><span class="ident" id="7517134">Name</span><span class="op" id="7517138">{</span><span class="string" id="7517139">&#34;&#34;</span><span class="op" id="7517141">,</span>&nbsp;<span class="string" id="7517143">&#34;query&#34;</span><span class="op" id="7517150">}</span><span class="op" id="7517151">,</span>&nbsp;<span class="op" id="7517153">[</span><span class="op" id="7517154">]</span><span class="ident" id="7517155">Attr</span><span class="op" id="7517159">{</span><span class="op" id="7517160">}</span><span class="op" id="7517161">}</span><span class="op" id="7517162">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517165">CharData</span><span class="op" id="7517173">(</span><span class="string" id="7517174">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="7517187">)</span><span class="op" id="7517188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517191">EndElement</span><span class="op" id="7517201">{</span><span class="ident" id="7517202">Name</span><span class="op" id="7517206">{</span><span class="string" id="7517207">&#34;&#34;</span><span class="op" id="7517209">,</span>&nbsp;<span class="string" id="7517211">&#34;query&#34;</span><span class="op" id="7517218">}</span><span class="op" id="7517219">}</span><span class="op" id="7517220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517223">CharData</span><span class="op" id="7517231">(</span><span class="string" id="7517232">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7517238">)</span><span class="op" id="7517239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517242">StartElement</span><span class="op" id="7517254">{</span><span class="ident" id="7517255">Name</span><span class="op" id="7517259">{</span><span class="string" id="7517260">&#34;&#34;</span><span class="op" id="7517262">,</span>&nbsp;<span class="string" id="7517264">&#34;goodbye&#34;</span><span class="op" id="7517273">}</span><span class="op" id="7517274">,</span>&nbsp;<span class="op" id="7517276">[</span><span class="op" id="7517277">]</span><span class="ident" id="7517278">Attr</span><span class="op" id="7517282">{</span><span class="op" id="7517283">}</span><span class="op" id="7517284">}</span><span class="op" id="7517285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517288">EndElement</span><span class="op" id="7517298">{</span><span class="ident" id="7517299">Name</span><span class="op" id="7517303">{</span><span class="string" id="7517304">&#34;&#34;</span><span class="op" id="7517306">,</span>&nbsp;<span class="string" id="7517308">&#34;goodbye&#34;</span><span class="op" id="7517317">}</span><span class="op" id="7517318">}</span><span class="op" id="7517319">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517322">CharData</span><span class="op" id="7517330">(</span><span class="string" id="7517331">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7517337">)</span><span class="op" id="7517338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517341">StartElement</span><span class="op" id="7517353">{</span><span class="ident" id="7517354">Name</span><span class="op" id="7517358">{</span><span class="string" id="7517359">&#34;&#34;</span><span class="op" id="7517361">,</span>&nbsp;<span class="string" id="7517363">&#34;outer&#34;</span><span class="op" id="7517370">}</span><span class="op" id="7517371">,</span>&nbsp;<span class="op" id="7517373">[</span><span class="op" id="7517374">]</span><span class="ident" id="7517375">Attr</span><span class="op" id="7517379">{</span><span class="op" id="7517380">{</span><span class="ident" id="7517381">Name</span><span class="op" id="7517385">{</span><span class="string" id="7517386">&#34;foo&#34;</span><span class="op" id="7517391">,</span>&nbsp;<span class="string" id="7517393">&#34;attr&#34;</span><span class="op" id="7517399">}</span><span class="op" id="7517400">,</span>&nbsp;<span class="string" id="7517402">&#34;value&#34;</span><span class="op" id="7517409">}</span><span class="op" id="7517410">,</span>&nbsp;<span class="op" id="7517412">{</span><span class="ident" id="7517413">Name</span><span class="op" id="7517417">{</span><span class="string" id="7517418">&#34;xmlns&#34;</span><span class="op" id="7517425">,</span>&nbsp;<span class="string" id="7517427">&#34;tag&#34;</span><span class="op" id="7517432">}</span><span class="op" id="7517433">,</span>&nbsp;<span class="string" id="7517435">&#34;ns4&#34;</span><span class="op" id="7517440">}</span><span class="op" id="7517441">}</span><span class="op" id="7517442">}</span><span class="op" id="7517443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517446">CharData</span><span class="op" id="7517454">(</span><span class="string" id="7517455">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7517463">)</span><span class="op" id="7517464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517467">StartElement</span><span class="op" id="7517479">{</span><span class="ident" id="7517480">Name</span><span class="op" id="7517484">{</span><span class="string" id="7517485">&#34;&#34;</span><span class="op" id="7517487">,</span>&nbsp;<span class="string" id="7517489">&#34;inner&#34;</span><span class="op" id="7517496">}</span><span class="op" id="7517497">,</span>&nbsp;<span class="op" id="7517499">[</span><span class="op" id="7517500">]</span><span class="ident" id="7517501">Attr</span><span class="op" id="7517505">{</span><span class="op" id="7517506">}</span><span class="op" id="7517507">}</span><span class="op" id="7517508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517511">EndElement</span><span class="op" id="7517521">{</span><span class="ident" id="7517522">Name</span><span class="op" id="7517526">{</span><span class="string" id="7517527">&#34;&#34;</span><span class="op" id="7517529">,</span>&nbsp;<span class="string" id="7517531">&#34;inner&#34;</span><span class="op" id="7517538">}</span><span class="op" id="7517539">}</span><span class="op" id="7517540">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517543">CharData</span><span class="op" id="7517551">(</span><span class="string" id="7517552">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7517558">)</span><span class="op" id="7517559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517562">EndElement</span><span class="op" id="7517572">{</span><span class="ident" id="7517573">Name</span><span class="op" id="7517577">{</span><span class="string" id="7517578">&#34;&#34;</span><span class="op" id="7517580">,</span>&nbsp;<span class="string" id="7517582">&#34;outer&#34;</span><span class="op" id="7517589">}</span><span class="op" id="7517590">}</span><span class="op" id="7517591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517594">CharData</span><span class="op" id="7517602">(</span><span class="string" id="7517603">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7517609">)</span><span class="op" id="7517610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517613">StartElement</span><span class="op" id="7517625">{</span><span class="ident" id="7517626">Name</span><span class="op" id="7517630">{</span><span class="string" id="7517631">&#34;tag&#34;</span><span class="op" id="7517636">,</span>&nbsp;<span class="string" id="7517638">&#34;name&#34;</span><span class="op" id="7517644">}</span><span class="op" id="7517645">,</span>&nbsp;<span class="op" id="7517647">[</span><span class="op" id="7517648">]</span><span class="ident" id="7517649">Attr</span><span class="op" id="7517653">{</span><span class="op" id="7517654">}</span><span class="op" id="7517655">}</span><span class="op" id="7517656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517659">CharData</span><span class="op" id="7517667">(</span><span class="string" id="7517668">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7517676">)</span><span class="op" id="7517677">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517680">CharData</span><span class="op" id="7517688">(</span><span class="string" id="7517689">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="7517706">)</span><span class="op" id="7517707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517710">CharData</span><span class="op" id="7517718">(</span><span class="string" id="7517719">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7517725">)</span><span class="op" id="7517726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517729">EndElement</span><span class="op" id="7517739">{</span><span class="ident" id="7517740">Name</span><span class="op" id="7517744">{</span><span class="string" id="7517745">&#34;tag&#34;</span><span class="op" id="7517750">,</span>&nbsp;<span class="string" id="7517752">&#34;name&#34;</span><span class="op" id="7517758">}</span><span class="op" id="7517759">}</span><span class="op" id="7517760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517763">CharData</span><span class="op" id="7517771">(</span><span class="string" id="7517772">&#34;\n&#34;</span><span class="op" id="7517776">)</span><span class="op" id="7517777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517780">EndElement</span><span class="op" id="7517790">{</span><span class="ident" id="7517791">Name</span><span class="op" id="7517795">{</span><span class="string" id="7517796">&#34;&#34;</span><span class="op" id="7517798">,</span>&nbsp;<span class="string" id="7517800">&#34;body&#34;</span><span class="op" id="7517806">}</span><span class="op" id="7517807">}</span><span class="op" id="7517808">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517811">Comment</span><span class="op" id="7517818">(</span><span class="string" id="7517819">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="7517844">)</span><span class="op" id="7517845">,</span><br>
<span class="lineno"></span><span class="op" id="7517847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7517850">var</span>&nbsp;<span class="ident" id="7517854">cookedTokens</span>&nbsp;<span class="op" id="7517867">=</span>&nbsp;<span class="op" id="7517869">[</span><span class="op" id="7517870">]</span><span class="ident" id="7517871">Token</span><span class="op" id="7517876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517879">CharData</span><span class="op" id="7517887">(</span><span class="string" id="7517888">&#34;\n&#34;</span><span class="op" id="7517892">)</span><span class="op" id="7517893">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517896">ProcInst</span><span class="op" id="7517904">{</span><span class="string" id="7517905">&#34;xml&#34;</span><span class="op" id="7517910">,</span>&nbsp;<span class="op" id="7517912">[</span><span class="op" id="7517913">]</span><span class="builtintype" id="7517914">byte</span><span class="op" id="7517918">(</span><span class="string" id="7517919">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="7517951">)</span><span class="op" id="7517952">}</span><span class="op" id="7517953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517956">CharData</span><span class="op" id="7517964">(</span><span class="string" id="7517965">&#34;\n&#34;</span><span class="op" id="7517969">)</span><span class="op" id="7517970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517973">Directive</span><span class="op" id="7517982">(</span><span class="string" id="7517983">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="7518105">)</span><span class="op" id="7518106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518109">CharData</span><span class="op" id="7518117">(</span><span class="string" id="7518118">&#34;\n&#34;</span><span class="op" id="7518122">)</span><span class="op" id="7518123">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518126">StartElement</span><span class="op" id="7518138">{</span><span class="ident" id="7518139">Name</span><span class="op" id="7518143">{</span><span class="string" id="7518144">&#34;ns2&#34;</span><span class="op" id="7518149">,</span>&nbsp;<span class="string" id="7518151">&#34;body&#34;</span><span class="op" id="7518157">}</span><span class="op" id="7518158">,</span>&nbsp;<span class="op" id="7518160">[</span><span class="op" id="7518161">]</span><span class="ident" id="7518162">Attr</span><span class="op" id="7518166">{</span><span class="op" id="7518167">{</span><span class="ident" id="7518168">Name</span><span class="op" id="7518172">{</span><span class="string" id="7518173">&#34;xmlns&#34;</span><span class="op" id="7518180">,</span>&nbsp;<span class="string" id="7518182">&#34;foo&#34;</span><span class="op" id="7518187">}</span><span class="op" id="7518188">,</span>&nbsp;<span class="string" id="7518190">&#34;ns1&#34;</span><span class="op" id="7518195">}</span><span class="op" id="7518196">,</span>&nbsp;<span class="op" id="7518198">{</span><span class="ident" id="7518199">Name</span><span class="op" id="7518203">{</span><span class="string" id="7518204">&#34;&#34;</span><span class="op" id="7518206">,</span>&nbsp;<span class="string" id="7518208">&#34;xmlns&#34;</span><span class="op" id="7518215">}</span><span class="op" id="7518216">,</span>&nbsp;<span class="string" id="7518218">&#34;ns2&#34;</span><span class="op" id="7518223">}</span><span class="op" id="7518224">,</span>&nbsp;<span class="op" id="7518226">{</span><span class="ident" id="7518227">Name</span><span class="op" id="7518231">{</span><span class="string" id="7518232">&#34;xmlns&#34;</span><span class="op" id="7518239">,</span>&nbsp;<span class="string" id="7518241">&#34;tag&#34;</span><span class="op" id="7518246">}</span><span class="op" id="7518247">,</span>&nbsp;<span class="string" id="7518249">&#34;ns3&#34;</span><span class="op" id="7518254">}</span><span class="op" id="7518255">}</span><span class="op" id="7518256">}</span><span class="op" id="7518257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518260">CharData</span><span class="op" id="7518268">(</span><span class="string" id="7518269">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7518275">)</span><span class="op" id="7518276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518279">StartElement</span><span class="op" id="7518291">{</span><span class="ident" id="7518292">Name</span><span class="op" id="7518296">{</span><span class="string" id="7518297">&#34;ns2&#34;</span><span class="op" id="7518302">,</span>&nbsp;<span class="string" id="7518304">&#34;hello&#34;</span><span class="op" id="7518311">}</span><span class="op" id="7518312">,</span>&nbsp;<span class="op" id="7518314">[</span><span class="op" id="7518315">]</span><span class="ident" id="7518316">Attr</span><span class="op" id="7518320">{</span><span class="op" id="7518321">{</span><span class="ident" id="7518322">Name</span><span class="op" id="7518326">{</span><span class="string" id="7518327">&#34;&#34;</span><span class="op" id="7518329">,</span>&nbsp;<span class="string" id="7518331">&#34;lang&#34;</span><span class="op" id="7518337">}</span><span class="op" id="7518338">,</span>&nbsp;<span class="string" id="7518340">&#34;en&#34;</span><span class="op" id="7518344">}</span><span class="op" id="7518345">}</span><span class="op" id="7518346">}</span><span class="op" id="7518347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518350">CharData</span><span class="op" id="7518358">(</span><span class="string" id="7518359">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="7518382">)</span><span class="op" id="7518383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518386">EndElement</span><span class="op" id="7518396">{</span><span class="ident" id="7518397">Name</span><span class="op" id="7518401">{</span><span class="string" id="7518402">&#34;ns2&#34;</span><span class="op" id="7518407">,</span>&nbsp;<span class="string" id="7518409">&#34;hello&#34;</span><span class="op" id="7518416">}</span><span class="op" id="7518417">}</span><span class="op" id="7518418">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518421">CharData</span><span class="op" id="7518429">(</span><span class="string" id="7518430">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7518436">)</span><span class="op" id="7518437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518440">StartElement</span><span class="op" id="7518452">{</span><span class="ident" id="7518453">Name</span><span class="op" id="7518457">{</span><span class="string" id="7518458">&#34;ns2&#34;</span><span class="op" id="7518463">,</span>&nbsp;<span class="string" id="7518465">&#34;query&#34;</span><span class="op" id="7518472">}</span><span class="op" id="7518473">,</span>&nbsp;<span class="op" id="7518475">[</span><span class="op" id="7518476">]</span><span class="ident" id="7518477">Attr</span><span class="op" id="7518481">{</span><span class="op" id="7518482">}</span><span class="op" id="7518483">}</span><span class="op" id="7518484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518487">CharData</span><span class="op" id="7518495">(</span><span class="string" id="7518496">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="7518509">)</span><span class="op" id="7518510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518513">EndElement</span><span class="op" id="7518523">{</span><span class="ident" id="7518524">Name</span><span class="op" id="7518528">{</span><span class="string" id="7518529">&#34;ns2&#34;</span><span class="op" id="7518534">,</span>&nbsp;<span class="string" id="7518536">&#34;query&#34;</span><span class="op" id="7518543">}</span><span class="op" id="7518544">}</span><span class="op" id="7518545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518548">CharData</span><span class="op" id="7518556">(</span><span class="string" id="7518557">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7518563">)</span><span class="op" id="7518564">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518567">StartElement</span><span class="op" id="7518579">{</span><span class="ident" id="7518580">Name</span><span class="op" id="7518584">{</span><span class="string" id="7518585">&#34;ns2&#34;</span><span class="op" id="7518590">,</span>&nbsp;<span class="string" id="7518592">&#34;goodbye&#34;</span><span class="op" id="7518601">}</span><span class="op" id="7518602">,</span>&nbsp;<span class="op" id="7518604">[</span><span class="op" id="7518605">]</span><span class="ident" id="7518606">Attr</span><span class="op" id="7518610">{</span><span class="op" id="7518611">}</span><span class="op" id="7518612">}</span><span class="op" id="7518613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518616">EndElement</span><span class="op" id="7518626">{</span><span class="ident" id="7518627">Name</span><span class="op" id="7518631">{</span><span class="string" id="7518632">&#34;ns2&#34;</span><span class="op" id="7518637">,</span>&nbsp;<span class="string" id="7518639">&#34;goodbye&#34;</span><span class="op" id="7518648">}</span><span class="op" id="7518649">}</span><span class="op" id="7518650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518653">CharData</span><span class="op" id="7518661">(</span><span class="string" id="7518662">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7518668">)</span><span class="op" id="7518669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518672">StartElement</span><span class="op" id="7518684">{</span><span class="ident" id="7518685">Name</span><span class="op" id="7518689">{</span><span class="string" id="7518690">&#34;ns2&#34;</span><span class="op" id="7518695">,</span>&nbsp;<span class="string" id="7518697">&#34;outer&#34;</span><span class="op" id="7518704">}</span><span class="op" id="7518705">,</span>&nbsp;<span class="op" id="7518707">[</span><span class="op" id="7518708">]</span><span class="ident" id="7518709">Attr</span><span class="op" id="7518713">{</span><span class="op" id="7518714">{</span><span class="ident" id="7518715">Name</span><span class="op" id="7518719">{</span><span class="string" id="7518720">&#34;ns1&#34;</span><span class="op" id="7518725">,</span>&nbsp;<span class="string" id="7518727">&#34;attr&#34;</span><span class="op" id="7518733">}</span><span class="op" id="7518734">,</span>&nbsp;<span class="string" id="7518736">&#34;value&#34;</span><span class="op" id="7518743">}</span><span class="op" id="7518744">,</span>&nbsp;<span class="op" id="7518746">{</span><span class="ident" id="7518747">Name</span><span class="op" id="7518751">{</span><span class="string" id="7518752">&#34;xmlns&#34;</span><span class="op" id="7518759">,</span>&nbsp;<span class="string" id="7518761">&#34;tag&#34;</span><span class="op" id="7518766">}</span><span class="op" id="7518767">,</span>&nbsp;<span class="string" id="7518769">&#34;ns4&#34;</span><span class="op" id="7518774">}</span><span class="op" id="7518775">}</span><span class="op" id="7518776">}</span><span class="op" id="7518777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518780">CharData</span><span class="op" id="7518788">(</span><span class="string" id="7518789">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7518797">)</span><span class="op" id="7518798">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518801">StartElement</span><span class="op" id="7518813">{</span><span class="ident" id="7518814">Name</span><span class="op" id="7518818">{</span><span class="string" id="7518819">&#34;ns2&#34;</span><span class="op" id="7518824">,</span>&nbsp;<span class="string" id="7518826">&#34;inner&#34;</span><span class="op" id="7518833">}</span><span class="op" id="7518834">,</span>&nbsp;<span class="op" id="7518836">[</span><span class="op" id="7518837">]</span><span class="ident" id="7518838">Attr</span><span class="op" id="7518842">{</span><span class="op" id="7518843">}</span><span class="op" id="7518844">}</span><span class="op" id="7518845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518848">EndElement</span><span class="op" id="7518858">{</span><span class="ident" id="7518859">Name</span><span class="op" id="7518863">{</span><span class="string" id="7518864">&#34;ns2&#34;</span><span class="op" id="7518869">,</span>&nbsp;<span class="string" id="7518871">&#34;inner&#34;</span><span class="op" id="7518878">}</span><span class="op" id="7518879">}</span><span class="op" id="7518880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518883">CharData</span><span class="op" id="7518891">(</span><span class="string" id="7518892">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7518898">)</span><span class="op" id="7518899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518902">EndElement</span><span class="op" id="7518912">{</span><span class="ident" id="7518913">Name</span><span class="op" id="7518917">{</span><span class="string" id="7518918">&#34;ns2&#34;</span><span class="op" id="7518923">,</span>&nbsp;<span class="string" id="7518925">&#34;outer&#34;</span><span class="op" id="7518932">}</span><span class="op" id="7518933">}</span><span class="op" id="7518934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518937">CharData</span><span class="op" id="7518945">(</span><span class="string" id="7518946">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7518952">)</span><span class="op" id="7518953">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518956">StartElement</span><span class="op" id="7518968">{</span><span class="ident" id="7518969">Name</span><span class="op" id="7518973">{</span><span class="string" id="7518974">&#34;ns3&#34;</span><span class="op" id="7518979">,</span>&nbsp;<span class="string" id="7518981">&#34;name&#34;</span><span class="op" id="7518987">}</span><span class="op" id="7518988">,</span>&nbsp;<span class="op" id="7518990">[</span><span class="op" id="7518991">]</span><span class="ident" id="7518992">Attr</span><span class="op" id="7518996">{</span><span class="op" id="7518997">}</span><span class="op" id="7518998">}</span><span class="op" id="7518999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519002">CharData</span><span class="op" id="7519010">(</span><span class="string" id="7519011">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7519019">)</span><span class="op" id="7519020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519023">CharData</span><span class="op" id="7519031">(</span><span class="string" id="7519032">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="7519049">)</span><span class="op" id="7519050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519053">CharData</span><span class="op" id="7519061">(</span><span class="string" id="7519062">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7519068">)</span><span class="op" id="7519069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519072">EndElement</span><span class="op" id="7519082">{</span><span class="ident" id="7519083">Name</span><span class="op" id="7519087">{</span><span class="string" id="7519088">&#34;ns3&#34;</span><span class="op" id="7519093">,</span>&nbsp;<span class="string" id="7519095">&#34;name&#34;</span><span class="op" id="7519101">}</span><span class="op" id="7519102">}</span><span class="op" id="7519103">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519106">CharData</span><span class="op" id="7519114">(</span><span class="string" id="7519115">&#34;\n&#34;</span><span class="op" id="7519119">)</span><span class="op" id="7519120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519123">EndElement</span><span class="op" id="7519133">{</span><span class="ident" id="7519134">Name</span><span class="op" id="7519138">{</span><span class="string" id="7519139">&#34;ns2&#34;</span><span class="op" id="7519144">,</span>&nbsp;<span class="string" id="7519146">&#34;body&#34;</span><span class="op" id="7519152">}</span><span class="op" id="7519153">}</span><span class="op" id="7519154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519157">Comment</span><span class="op" id="7519164">(</span><span class="string" id="7519165">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="7519190">)</span><span class="op" id="7519191">,</span><br>
<span class="lineno"></span><span class="op" id="7519193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7519196">const</span>&nbsp;<span class="ident" id="7519202">testInputAltEncoding</span>&nbsp;<span class="op" id="7519223">=</span>&nbsp;<span class="string" id="7519225">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7519299">var</span>&nbsp;<span class="ident" id="7519303">rawTokensAltEncoding</span>&nbsp;<span class="op" id="7519324">=</span>&nbsp;<span class="op" id="7519326">[</span><span class="op" id="7519327">]</span><span class="ident" id="7519328">Token</span><span class="op" id="7519333">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519336">CharData</span><span class="op" id="7519344">(</span><span class="string" id="7519345">&#34;\n&#34;</span><span class="op" id="7519349">)</span><span class="op" id="7519350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519353">ProcInst</span><span class="op" id="7519361">{</span><span class="string" id="7519362">&#34;xml&#34;</span><span class="op" id="7519367">,</span>&nbsp;<span class="op" id="7519369">[</span><span class="op" id="7519370">]</span><span class="builtintype" id="7519371">byte</span><span class="op" id="7519375">(</span><span class="string" id="7519376">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="7519422">)</span><span class="op" id="7519423">}</span><span class="op" id="7519424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519427">CharData</span><span class="op" id="7519435">(</span><span class="string" id="7519436">&#34;\n&#34;</span><span class="op" id="7519440">)</span><span class="op" id="7519441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519444">StartElement</span><span class="op" id="7519456">{</span><span class="ident" id="7519457">Name</span><span class="op" id="7519461">{</span><span class="string" id="7519462">&#34;&#34;</span><span class="op" id="7519464">,</span>&nbsp;<span class="string" id="7519466">&#34;tag&#34;</span><span class="op" id="7519471">}</span><span class="op" id="7519472">,</span>&nbsp;<span class="op" id="7519474">[</span><span class="op" id="7519475">]</span><span class="ident" id="7519476">Attr</span><span class="op" id="7519480">{</span><span class="op" id="7519481">}</span><span class="op" id="7519482">}</span><span class="op" id="7519483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519486">CharData</span><span class="op" id="7519494">(</span><span class="string" id="7519495">&#34;value&#34;</span><span class="op" id="7519502">)</span><span class="op" id="7519503">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519506">EndElement</span><span class="op" id="7519516">{</span><span class="ident" id="7519517">Name</span><span class="op" id="7519521">{</span><span class="string" id="7519522">&#34;&#34;</span><span class="op" id="7519524">,</span>&nbsp;<span class="string" id="7519526">&#34;tag&#34;</span><span class="op" id="7519531">}</span><span class="op" id="7519532">}</span><span class="op" id="7519533">,</span><br>
<span class="lineno"></span><span class="op" id="7519535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7519538">var</span>&nbsp;<span class="ident" id="7519542">xmlInput</span>&nbsp;<span class="op" id="7519551">=</span>&nbsp;<span class="op" id="7519553">[</span><span class="op" id="7519554">]</span><span class="builtintype" id="7519555">string</span><span class="op" id="7519561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7519564">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519589">&#34;&lt;&#34;</span><span class="op" id="7519592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519595">&#34;&lt;t&#34;</span><span class="op" id="7519599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519602">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="7519607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519610">&#34;&lt;t/&#34;</span><span class="op" id="7519615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519618">&#34;&lt;!&#34;</span><span class="op" id="7519622">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519625">&#34;&lt;!-&#34;</span><span class="op" id="7519630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519633">&#34;&lt;!--&#34;</span><span class="op" id="7519639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519642">&#34;&lt;!--c-&#34;</span><span class="op" id="7519650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519653">&#34;&lt;!--c--&#34;</span><span class="op" id="7519662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519665">&#34;&lt;!d&#34;</span><span class="op" id="7519670">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519673">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="7519680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519683">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="7519691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519694">&#34;&lt;?&#34;</span><span class="op" id="7519698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519701">&#34;&lt;?p&#34;</span><span class="op" id="7519706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519709">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="7519715">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519718">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="7519725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519728">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="7519736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519739">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="7519748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519751">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="7519760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519763">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="7519773">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519776">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="7519792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519795">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="7519812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519815">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="7519833">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7519837">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519861">&#34;&lt;&gt;&#34;</span><span class="op" id="7519865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519868">&#34;&lt;t/a&#34;</span><span class="op" id="7519874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519877">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="7519884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519887">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="7519894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7519897">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519943">&#34;&lt;/0&gt;&#34;</span><span class="op" id="7519949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519952">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="7519962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519965">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="7519976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519979">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="7519990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7519993">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="7520009">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7520012">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="7520019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7520022">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="7520030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7520033">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="7520042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7520045">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7520099">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="7520108">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7520111">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="7520119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7520122">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="7520131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7520134">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="7520151">,</span><br>
<span class="lineno"></span><span class="op" id="7520153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="7520156">func</span>&nbsp;<span class="ident" id="7520161">TestRawToken</span><span class="op" id="7520173">(</span><span class="ident" id="7520174">t</span>&nbsp;<span class="op" id="7520176">*</span><span class="ident" id="7520177">testing</span><span class="op" id="7520184">.</span><span class="ident" id="7520185">T</span><span class="op" id="7520186">)</span>&nbsp;<span class="op" id="7520188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520191">d</span>&nbsp;<span class="op" id="7520193">:=</span>&nbsp;<span class="ident" id="7520196">NewDecoder</span><span class="op" id="7520206">(</span><span class="ident" id="7520207">strings</span><span class="op" id="7520214">.</span><span class="ident" id="7520215">NewReader</span><span class="op" id="7520224">(</span><span class="ident" id="7520225">testInput</span><span class="op" id="7520234">)</span><span class="op" id="7520235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520238">d</span><span class="op" id="7520239">.</span><span class="ident" id="7520240">Entity</span>&nbsp;<span class="op" id="7520247">=</span>&nbsp;<span class="ident" id="7520249">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520261">testRawToken</span><span class="op" id="7520273">(</span><span class="ident" id="7520274">t</span><span class="op" id="7520275">,</span>&nbsp;<span class="ident" id="7520277">d</span><span class="op" id="7520278">,</span>&nbsp;<span class="ident" id="7520280">testInput</span><span class="op" id="7520289">,</span>&nbsp;<span class="ident" id="7520291">rawTokens</span><span class="op" id="7520300">)</span><br>
<span class="lineno"></span><span class="op" id="7520302">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7520305">const</span>&nbsp;<span class="ident" id="7520311">nonStrictInput</span>&nbsp;<span class="op" id="7520326">=</span>&nbsp;<span class="string" id="7520328">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7520490">var</span>&nbsp;<span class="ident" id="7520494">nonStringEntity</span>&nbsp;<span class="op" id="7520510">=</span>&nbsp;<span class="keyword" id="7520512">map</span><span class="op" id="7520515">[</span><span class="builtintype" id="7520516">string</span><span class="op" id="7520522">]</span><span class="builtintype" id="7520523">string</span><span class="op" id="7520529">{</span><span class="string" id="7520530">&#34;&#34;</span><span class="op" id="7520532">:</span>&nbsp;<span class="string" id="7520534">&#34;oops!&#34;</span><span class="op" id="7520541">,</span>&nbsp;<span class="string" id="7520543">&#34;0a&#34;</span><span class="op" id="7520547">:</span>&nbsp;<span class="string" id="7520549">&#34;oops!&#34;</span><span class="op" id="7520556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7520559">var</span>&nbsp;<span class="ident" id="7520563">nonStrictTokens</span>&nbsp;<span class="op" id="7520579">=</span>&nbsp;<span class="op" id="7520581">[</span><span class="op" id="7520582">]</span><span class="ident" id="7520583">Token</span><span class="op" id="7520588">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520591">CharData</span><span class="op" id="7520599">(</span><span class="string" id="7520600">&#34;\n&#34;</span><span class="op" id="7520604">)</span><span class="op" id="7520605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520608">StartElement</span><span class="op" id="7520620">{</span><span class="ident" id="7520621">Name</span><span class="op" id="7520625">{</span><span class="string" id="7520626">&#34;&#34;</span><span class="op" id="7520628">,</span>&nbsp;<span class="string" id="7520630">&#34;tag&#34;</span><span class="op" id="7520635">}</span><span class="op" id="7520636">,</span>&nbsp;<span class="op" id="7520638">[</span><span class="op" id="7520639">]</span><span class="ident" id="7520640">Attr</span><span class="op" id="7520644">{</span><span class="op" id="7520645">}</span><span class="op" id="7520646">}</span><span class="op" id="7520647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520650">CharData</span><span class="op" id="7520658">(</span><span class="string" id="7520659">&#34;non&amp;entity&#34;</span><span class="op" id="7520671">)</span><span class="op" id="7520672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520675">EndElement</span><span class="op" id="7520685">{</span><span class="ident" id="7520686">Name</span><span class="op" id="7520690">{</span><span class="string" id="7520691">&#34;&#34;</span><span class="op" id="7520693">,</span>&nbsp;<span class="string" id="7520695">&#34;tag&#34;</span><span class="op" id="7520700">}</span><span class="op" id="7520701">}</span><span class="op" id="7520702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520705">CharData</span><span class="op" id="7520713">(</span><span class="string" id="7520714">&#34;\n&#34;</span><span class="op" id="7520718">)</span><span class="op" id="7520719">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520722">StartElement</span><span class="op" id="7520734">{</span><span class="ident" id="7520735">Name</span><span class="op" id="7520739">{</span><span class="string" id="7520740">&#34;&#34;</span><span class="op" id="7520742">,</span>&nbsp;<span class="string" id="7520744">&#34;tag&#34;</span><span class="op" id="7520749">}</span><span class="op" id="7520750">,</span>&nbsp;<span class="op" id="7520752">[</span><span class="op" id="7520753">]</span><span class="ident" id="7520754">Attr</span><span class="op" id="7520758">{</span><span class="op" id="7520759">}</span><span class="op" id="7520760">}</span><span class="op" id="7520761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520764">CharData</span><span class="op" id="7520772">(</span><span class="string" id="7520773">&#34;&amp;unknown;entity&#34;</span><span class="op" id="7520790">)</span><span class="op" id="7520791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520794">EndElement</span><span class="op" id="7520804">{</span><span class="ident" id="7520805">Name</span><span class="op" id="7520809">{</span><span class="string" id="7520810">&#34;&#34;</span><span class="op" id="7520812">,</span>&nbsp;<span class="string" id="7520814">&#34;tag&#34;</span><span class="op" id="7520819">}</span><span class="op" id="7520820">}</span><span class="op" id="7520821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520824">CharData</span><span class="op" id="7520832">(</span><span class="string" id="7520833">&#34;\n&#34;</span><span class="op" id="7520837">)</span><span class="op" id="7520838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520841">StartElement</span><span class="op" id="7520853">{</span><span class="ident" id="7520854">Name</span><span class="op" id="7520858">{</span><span class="string" id="7520859">&#34;&#34;</span><span class="op" id="7520861">,</span>&nbsp;<span class="string" id="7520863">&#34;tag&#34;</span><span class="op" id="7520868">}</span><span class="op" id="7520869">,</span>&nbsp;<span class="op" id="7520871">[</span><span class="op" id="7520872">]</span><span class="ident" id="7520873">Attr</span><span class="op" id="7520877">{</span><span class="op" id="7520878">}</span><span class="op" id="7520879">}</span><span class="op" id="7520880">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520883">CharData</span><span class="op" id="7520891">(</span><span class="string" id="7520892">&#34;&amp;#123&#34;</span><span class="op" id="7520899">)</span><span class="op" id="7520900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520903">EndElement</span><span class="op" id="7520913">{</span><span class="ident" id="7520914">Name</span><span class="op" id="7520918">{</span><span class="string" id="7520919">&#34;&#34;</span><span class="op" id="7520921">,</span>&nbsp;<span class="string" id="7520923">&#34;tag&#34;</span><span class="op" id="7520928">}</span><span class="op" id="7520929">}</span><span class="op" id="7520930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520933">CharData</span><span class="op" id="7520941">(</span><span class="string" id="7520942">&#34;\n&#34;</span><span class="op" id="7520946">)</span><span class="op" id="7520947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520950">StartElement</span><span class="op" id="7520962">{</span><span class="ident" id="7520963">Name</span><span class="op" id="7520967">{</span><span class="string" id="7520968">&#34;&#34;</span><span class="op" id="7520970">,</span>&nbsp;<span class="string" id="7520972">&#34;tag&#34;</span><span class="op" id="7520977">}</span><span class="op" id="7520978">,</span>&nbsp;<span class="op" id="7520980">[</span><span class="op" id="7520981">]</span><span class="ident" id="7520982">Attr</span><span class="op" id="7520986">{</span><span class="op" id="7520987">}</span><span class="op" id="7520988">}</span><span class="op" id="7520989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520992">CharData</span><span class="op" id="7521000">(</span><span class="string" id="7521001">&#34;&amp;#zzz;&#34;</span><span class="op" id="7521009">)</span><span class="op" id="7521010">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521013">EndElement</span><span class="op" id="7521023">{</span><span class="ident" id="7521024">Name</span><span class="op" id="7521028">{</span><span class="string" id="7521029">&#34;&#34;</span><span class="op" id="7521031">,</span>&nbsp;<span class="string" id="7521033">&#34;tag&#34;</span><span class="op" id="7521038">}</span><span class="op" id="7521039">}</span><span class="op" id="7521040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521043">CharData</span><span class="op" id="7521051">(</span><span class="string" id="7521052">&#34;\n&#34;</span><span class="op" id="7521056">)</span><span class="op" id="7521057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521060">StartElement</span><span class="op" id="7521072">{</span><span class="ident" id="7521073">Name</span><span class="op" id="7521077">{</span><span class="string" id="7521078">&#34;&#34;</span><span class="op" id="7521080">,</span>&nbsp;<span class="string" id="7521082">&#34;tag&#34;</span><span class="op" id="7521087">}</span><span class="op" id="7521088">,</span>&nbsp;<span class="op" id="7521090">[</span><span class="op" id="7521091">]</span><span class="ident" id="7521092">Attr</span><span class="op" id="7521096">{</span><span class="op" id="7521097">}</span><span class="op" id="7521098">}</span><span class="op" id="7521099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521102">CharData</span><span class="op" id="7521110">(</span><span class="string" id="7521111">&#34;&amp;なまえ3;&#34;</span><span class="op" id="7521125">)</span><span class="op" id="7521126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521129">EndElement</span><span class="op" id="7521139">{</span><span class="ident" id="7521140">Name</span><span class="op" id="7521144">{</span><span class="string" id="7521145">&#34;&#34;</span><span class="op" id="7521147">,</span>&nbsp;<span class="string" id="7521149">&#34;tag&#34;</span><span class="op" id="7521154">}</span><span class="op" id="7521155">}</span><span class="op" id="7521156">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521159">CharData</span><span class="op" id="7521167">(</span><span class="string" id="7521168">&#34;\n&#34;</span><span class="op" id="7521172">)</span><span class="op" id="7521173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521176">StartElement</span><span class="op" id="7521188">{</span><span class="ident" id="7521189">Name</span><span class="op" id="7521193">{</span><span class="string" id="7521194">&#34;&#34;</span><span class="op" id="7521196">,</span>&nbsp;<span class="string" id="7521198">&#34;tag&#34;</span><span class="op" id="7521203">}</span><span class="op" id="7521204">,</span>&nbsp;<span class="op" id="7521206">[</span><span class="op" id="7521207">]</span><span class="ident" id="7521208">Attr</span><span class="op" id="7521212">{</span><span class="op" id="7521213">}</span><span class="op" id="7521214">}</span><span class="op" id="7521215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521218">CharData</span><span class="op" id="7521226">(</span><span class="string" id="7521227">&#34;&amp;lt-gt;&#34;</span><span class="op" id="7521236">)</span><span class="op" id="7521237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521240">EndElement</span><span class="op" id="7521250">{</span><span class="ident" id="7521251">Name</span><span class="op" id="7521255">{</span><span class="string" id="7521256">&#34;&#34;</span><span class="op" id="7521258">,</span>&nbsp;<span class="string" id="7521260">&#34;tag&#34;</span><span class="op" id="7521265">}</span><span class="op" id="7521266">}</span><span class="op" id="7521267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521270">CharData</span><span class="op" id="7521278">(</span><span class="string" id="7521279">&#34;\n&#34;</span><span class="op" id="7521283">)</span><span class="op" id="7521284">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521287">StartElement</span><span class="op" id="7521299">{</span><span class="ident" id="7521300">Name</span><span class="op" id="7521304">{</span><span class="string" id="7521305">&#34;&#34;</span><span class="op" id="7521307">,</span>&nbsp;<span class="string" id="7521309">&#34;tag&#34;</span><span class="op" id="7521314">}</span><span class="op" id="7521315">,</span>&nbsp;<span class="op" id="7521317">[</span><span class="op" id="7521318">]</span><span class="ident" id="7521319">Attr</span><span class="op" id="7521323">{</span><span class="op" id="7521324">}</span><span class="op" id="7521325">}</span><span class="op" id="7521326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521329">CharData</span><span class="op" id="7521337">(</span><span class="string" id="7521338">&#34;&amp;;&#34;</span><span class="op" id="7521342">)</span><span class="op" id="7521343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521346">EndElement</span><span class="op" id="7521356">{</span><span class="ident" id="7521357">Name</span><span class="op" id="7521361">{</span><span class="string" id="7521362">&#34;&#34;</span><span class="op" id="7521364">,</span>&nbsp;<span class="string" id="7521366">&#34;tag&#34;</span><span class="op" id="7521371">}</span><span class="op" id="7521372">}</span><span class="op" id="7521373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521376">CharData</span><span class="op" id="7521384">(</span><span class="string" id="7521385">&#34;\n&#34;</span><span class="op" id="7521389">)</span><span class="op" id="7521390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521393">StartElement</span><span class="op" id="7521405">{</span><span class="ident" id="7521406">Name</span><span class="op" id="7521410">{</span><span class="string" id="7521411">&#34;&#34;</span><span class="op" id="7521413">,</span>&nbsp;<span class="string" id="7521415">&#34;tag&#34;</span><span class="op" id="7521420">}</span><span class="op" id="7521421">,</span>&nbsp;<span class="op" id="7521423">[</span><span class="op" id="7521424">]</span><span class="ident" id="7521425">Attr</span><span class="op" id="7521429">{</span><span class="op" id="7521430">}</span><span class="op" id="7521431">}</span><span class="op" id="7521432">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521435">CharData</span><span class="op" id="7521443">(</span><span class="string" id="7521444">&#34;&amp;0a;&#34;</span><span class="op" id="7521450">)</span><span class="op" id="7521451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521454">EndElement</span><span class="op" id="7521464">{</span><span class="ident" id="7521465">Name</span><span class="op" id="7521469">{</span><span class="string" id="7521470">&#34;&#34;</span><span class="op" id="7521472">,</span>&nbsp;<span class="string" id="7521474">&#34;tag&#34;</span><span class="op" id="7521479">}</span><span class="op" id="7521480">}</span><span class="op" id="7521481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521484">CharData</span><span class="op" id="7521492">(</span><span class="string" id="7521493">&#34;\n&#34;</span><span class="op" id="7521497">)</span><span class="op" id="7521498">,</span><br>
<span class="lineno"></span><span class="op" id="7521500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="7521503">func</span>&nbsp;<span class="ident" id="7521508">TestNonStrictRawToken</span><span class="op" id="7521529">(</span><span class="ident" id="7521530">t</span>&nbsp;<span class="op" id="7521532">*</span><span class="ident" id="7521533">testing</span><span class="op" id="7521540">.</span><span class="ident" id="7521541">T</span><span class="op" id="7521542">)</span>&nbsp;<span class="op" id="7521544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521547">d</span>&nbsp;<span class="op" id="7521549">:=</span>&nbsp;<span class="ident" id="7521552">NewDecoder</span><span class="op" id="7521562">(</span><span class="ident" id="7521563">strings</span><span class="op" id="7521570">.</span><span class="ident" id="7521571">NewReader</span><span class="op" id="7521580">(</span><span class="ident" id="7521581">nonStrictInput</span><span class="op" id="7521595">)</span><span class="op" id="7521596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521599">d</span><span class="op" id="7521600">.</span><span class="ident" id="7521601">Strict</span>&nbsp;<span class="op" id="7521608">=</span>&nbsp;<span class="builtintype" id="7521610">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521617">testRawToken</span><span class="op" id="7521629">(</span><span class="ident" id="7521630">t</span><span class="op" id="7521631">,</span>&nbsp;<span class="ident" id="7521633">d</span><span class="op" id="7521634">,</span>&nbsp;<span class="ident" id="7521636">nonStrictInput</span><span class="op" id="7521650">,</span>&nbsp;<span class="ident" id="7521652">nonStrictTokens</span><span class="op" id="7521667">)</span><br>
<span class="lineno"></span><span class="op" id="7521669">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="7521672">type</span>&nbsp;<span class="ident" id="7521677">downCaser</span>&nbsp;<span class="keyword" id="7521687">struct</span>&nbsp;<span class="op" id="7521694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521697">t</span>&nbsp;<span class="op" id="7521699">*</span><span class="ident" id="7521700">testing</span><span class="op" id="7521707">.</span><span class="ident" id="7521708">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521711">r</span>&nbsp;<span class="ident" id="7521713">io</span><span class="op" id="7521715">.</span><span class="ident" id="7521716">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="7521727">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="7521730">func</span>&nbsp;<span class="op" id="7521735">(</span><span class="ident" id="7521736">d</span>&nbsp;<span class="op" id="7521738">*</span><span class="ident" id="7521739">downCaser</span><span class="op" id="7521748">)</span>&nbsp;<span class="ident" id="7521750">ReadByte</span><span class="op" id="7521758">(</span><span class="op" id="7521759">)</span>&nbsp;<span class="op" id="7521761">(</span><span class="ident" id="7521762">c</span>&nbsp;<span class="builtintype" id="7521764">byte</span><span class="op" id="7521768">,</span>&nbsp;<span class="ident" id="7521770">err</span>&nbsp;<span class="builtintype" id="7521774">error</span><span class="op" id="7521779">)</span>&nbsp;<span class="op" id="7521781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521784">c</span><span class="op" id="7521785">,</span>&nbsp;<span class="ident" id="7521787">err</span>&nbsp;<span class="op" id="7521791">=</span>&nbsp;<span class="ident" id="7521793">d</span><span class="op" id="7521794">.</span><span class="ident" id="7521795">r</span><span class="op" id="7521796">.</span><span class="ident" id="7521797">ReadByte</span><span class="op" id="7521805">(</span><span class="op" id="7521806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7521809">if</span>&nbsp;<span class="ident" id="7521812">c</span>&nbsp;<span class="op" id="7521814">&gt;=</span>&nbsp;<span class="string" id="7521817">&#39;A&#39;</span>&nbsp;<span class="op" id="7521821">&amp;&amp;</span>&nbsp;<span class="ident" id="7521824">c</span>&nbsp;<span class="op" id="7521826">&lt;=</span>&nbsp;<span class="string" id="7521829">&#39;Z&#39;</span>&nbsp;<span class="op" id="7521833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521837">c</span>&nbsp;<span class="op" id="7521839">+=</span>&nbsp;<span class="string" id="7521842">&#39;a&#39;</span>&nbsp;<span class="op" id="7521846">-</span>&nbsp;<span class="string" id="7521848">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7521853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7521856">return</span><br>
<span class="lineno"></span><span class="op" id="7521863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7521866">func</span>&nbsp;<span class="op" id="7521871">(</span><span class="ident" id="7521872">d</span>&nbsp;<span class="op" id="7521874">*</span><span class="ident" id="7521875">downCaser</span><span class="op" id="7521884">)</span>&nbsp;<span class="ident" id="7521886">Read</span><span class="op" id="7521890">(</span><span class="ident" id="7521891">p</span>&nbsp;<span class="op" id="7521893">[</span><span class="op" id="7521894">]</span><span class="builtintype" id="7521895">byte</span><span class="op" id="7521899">)</span>&nbsp;<span class="op" id="7521901">(</span><span class="builtintype" id="7521902">int</span><span class="op" id="7521905">,</span>&nbsp;<span class="builtintype" id="7521907">error</span><span class="op" id="7521912">)</span>&nbsp;<span class="op" id="7521914">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7521917">d</span><span class="op" id="7521918">.</span><span class="ident" id="7521919">t</span><span class="op" id="7521920">.</span><span class="ident" id="7521921">Fatalf</span><span class="op" id="7521927">(</span><span class="string" id="7521928">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="7521970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7521973">panic</span><span class="op" id="7521978">(</span><span class="string" id="7521979">&#34;unreachable&#34;</span><span class="op" id="7521992">)</span><br>
<span class="lineno"></span><span class="op" id="7521994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7521997">func</span>&nbsp;<span class="ident" id="7522002">TestRawTokenAltEncoding</span><span class="op" id="7522025">(</span><span class="ident" id="7522026">t</span>&nbsp;<span class="op" id="7522028">*</span><span class="ident" id="7522029">testing</span><span class="op" id="7522036">.</span><span class="ident" id="7522037">T</span><span class="op" id="7522038">)</span>&nbsp;<span class="op" id="7522040">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522043">d</span>&nbsp;<span class="op" id="7522045">:=</span>&nbsp;<span class="ident" id="7522048">NewDecoder</span><span class="op" id="7522058">(</span><span class="ident" id="7522059">strings</span><span class="op" id="7522066">.</span><span class="ident" id="7522067">NewReader</span><span class="op" id="7522076">(</span><span class="ident" id="7522077">testInputAltEncoding</span><span class="op" id="7522097">)</span><span class="op" id="7522098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522101">d</span><span class="op" id="7522102">.</span><span class="ident" id="7522103">CharsetReader</span>&nbsp;<span class="op" id="7522117">=</span>&nbsp;<span class="keyword" id="7522119">func</span><span class="op" id="7522123">(</span><span class="ident" id="7522124">charset</span>&nbsp;<span class="builtintype" id="7522132">string</span><span class="op" id="7522138">,</span>&nbsp;<span class="ident" id="7522140">input</span>&nbsp;<span class="ident" id="7522146">io</span><span class="op" id="7522148">.</span><span class="ident" id="7522149">Reader</span><span class="op" id="7522155">)</span>&nbsp;<span class="op" id="7522157">(</span><span class="ident" id="7522158">io</span><span class="op" id="7522160">.</span><span class="ident" id="7522161">Reader</span><span class="op" id="7522167">,</span>&nbsp;<span class="builtintype" id="7522169">error</span><span class="op" id="7522174">)</span>&nbsp;<span class="op" id="7522176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7522180">if</span>&nbsp;<span class="ident" id="7522183">charset</span>&nbsp;<span class="op" id="7522191">!=</span>&nbsp;<span class="string" id="7522194">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="7522216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522221">t</span><span class="op" id="7522222">.</span><span class="ident" id="7522223">Fatalf</span><span class="op" id="7522229">(</span><span class="string" id="7522230">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="7522253">,</span>&nbsp;<span class="ident" id="7522255">charset</span><span class="op" id="7522262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7522266">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7522270">return</span>&nbsp;<span class="op" id="7522277">&amp;</span><span class="ident" id="7522278">downCaser</span><span class="op" id="7522287">{</span><span class="ident" id="7522288">t</span><span class="op" id="7522289">,</span>&nbsp;<span class="ident" id="7522291">input</span><span class="op" id="7522296">.</span><span class="op" id="7522297">(</span><span class="ident" id="7522298">io</span><span class="op" id="7522300">.</span><span class="ident" id="7522301">ByteReader</span><span class="op" id="7522311">)</span><span class="op" id="7522312">}</span><span class="op" id="7522313">,</span>&nbsp;<span class="ident" id="7522315">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7522320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522323">testRawToken</span><span class="op" id="7522335">(</span><span class="ident" id="7522336">t</span><span class="op" id="7522337">,</span>&nbsp;<span class="ident" id="7522339">d</span><span class="op" id="7522340">,</span>&nbsp;<span class="ident" id="7522342">testInputAltEncoding</span><span class="op" id="7522362">,</span>&nbsp;<span class="ident" id="7522364">rawTokensAltEncoding</span><span class="op" id="7522384">)</span><br>
<span class="lineno"></span><span class="op" id="7522386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="7522389">func</span>&nbsp;<span class="ident" id="7522394">TestRawTokenAltEncodingNoConverter</span><span class="op" id="7522428">(</span><span class="ident" id="7522429">t</span>&nbsp;<span class="op" id="7522431">*</span><span class="ident" id="7522432">testing</span><span class="op" id="7522439">.</span><span class="ident" id="7522440">T</span><span class="op" id="7522441">)</span>&nbsp;<span class="op" id="7522443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522446">d</span>&nbsp;<span class="op" id="7522448">:=</span>&nbsp;<span class="ident" id="7522451">NewDecoder</span><span class="op" id="7522461">(</span><span class="ident" id="7522462">strings</span><span class="op" id="7522469">.</span><span class="ident" id="7522470">NewReader</span><span class="op" id="7522479">(</span><span class="ident" id="7522480">testInputAltEncoding</span><span class="op" id="7522500">)</span><span class="op" id="7522501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522504">token</span><span class="op" id="7522509">,</span>&nbsp;<span class="ident" id="7522511">err</span>&nbsp;<span class="op" id="7522515">:=</span>&nbsp;<span class="ident" id="7522518">d</span><span class="op" id="7522519">.</span><span class="ident" id="7522520">RawToken</span><span class="op" id="7522528">(</span><span class="op" id="7522529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7522532">if</span>&nbsp;<span class="ident" id="7522535">token</span>&nbsp;<span class="op" id="7522541">==</span>&nbsp;<span class="ident" id="7522544">nil</span>&nbsp;<span class="op" id="7522548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522552">t</span><span class="op" id="7522553">.</span><span class="ident" id="7522554">Fatalf</span><span class="op" id="7522560">(</span><span class="string" id="7522561">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="7522602">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7522605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7522608">if</span>&nbsp;<span class="ident" id="7522611">err</span>&nbsp;<span class="op" id="7522615">!=</span>&nbsp;<span class="ident" id="7522618">nil</span>&nbsp;<span class="op" id="7522622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522626">t</span><span class="op" id="7522627">.</span><span class="ident" id="7522628">Fatal</span><span class="op" id="7522633">(</span><span class="ident" id="7522634">err</span><span class="op" id="7522637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7522640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522643">token</span><span class="op" id="7522648">,</span>&nbsp;<span class="ident" id="7522650">err</span>&nbsp;<span class="op" id="7522654">=</span>&nbsp;<span class="ident" id="7522656">d</span><span class="op" id="7522657">.</span><span class="ident" id="7522658">RawToken</span><span class="op" id="7522666">(</span><span class="op" id="7522667">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7522670">if</span>&nbsp;<span class="ident" id="7522673">token</span>&nbsp;<span class="op" id="7522679">!=</span>&nbsp;<span class="ident" id="7522682">nil</span>&nbsp;<span class="op" id="7522686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522690">t</span><span class="op" id="7522691">.</span><span class="ident" id="7522692">Errorf</span><span class="op" id="7522698">(</span><span class="string" id="7522699">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="7522730">,</span>&nbsp;<span class="ident" id="7522732">token</span><span class="op" id="7522737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7522740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7522743">if</span>&nbsp;<span class="ident" id="7522746">err</span>&nbsp;<span class="op" id="7522750">==</span>&nbsp;<span class="ident" id="7522753">nil</span>&nbsp;<span class="op" id="7522757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522761">t</span><span class="op" id="7522762">.</span><span class="ident" id="7522763">Fatalf</span><span class="op" id="7522769">(</span><span class="string" id="7522770">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="7522813">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7522816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7522819">const</span>&nbsp;<span class="ident" id="7522825">encoding</span>&nbsp;<span class="op" id="7522834">=</span>&nbsp;<span class="string" id="7522836">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7522859">if</span>&nbsp;<span class="op" id="7522862">!</span><span class="ident" id="7522863">strings</span><span class="op" id="7522870">.</span><span class="ident" id="7522871">Contains</span><span class="op" id="7522879">(</span><span class="ident" id="7522880">err</span><span class="op" id="7522883">.</span><span class="ident" id="7522884">Error</span><span class="op" id="7522889">(</span><span class="op" id="7522890">)</span><span class="op" id="7522891">,</span>&nbsp;<span class="ident" id="7522893">encoding</span><span class="op" id="7522901">)</span>&nbsp;<span class="op" id="7522903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522907">t</span><span class="op" id="7522908">.</span><span class="ident" id="7522909">Errorf</span><span class="op" id="7522915">(</span><span class="string" id="7522916">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7522961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7522966">encoding</span><span class="op" id="7522974">,</span>&nbsp;<span class="ident" id="7522976">err</span><span class="op" id="7522979">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7522982">}</span><br>
<span class="lineno"></span><span class="op" id="7522984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7522987">func</span>&nbsp;<span class="ident" id="7522992">testRawToken</span><span class="op" id="7523004">(</span><span class="ident" id="7523005">t</span>&nbsp;<span class="op" id="7523007">*</span><span class="ident" id="7523008">testing</span><span class="op" id="7523015">.</span><span class="ident" id="7523016">T</span><span class="op" id="7523017">,</span>&nbsp;<span class="ident" id="7523019">d</span>&nbsp;<span class="op" id="7523021">*</span><span class="ident" id="7523022">Decoder</span><span class="op" id="7523029">,</span>&nbsp;<span class="ident" id="7523031">raw</span>&nbsp;<span class="builtintype" id="7523035">string</span><span class="op" id="7523041">,</span>&nbsp;<span class="ident" id="7523043">rawTokens</span>&nbsp;<span class="op" id="7523053">[</span><span class="op" id="7523054">]</span><span class="ident" id="7523055">Token</span><span class="op" id="7523060">)</span>&nbsp;<span class="op" id="7523062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7523065">lastEnd</span>&nbsp;<span class="op" id="7523073">:=</span>&nbsp;<span class="ident" id="7523076">int64</span><span class="op" id="7523081">(</span><span class="num" id="7523082">0</span><span class="op" id="7523083">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7523086">for</span>&nbsp;<span class="ident" id="7523090">i</span><span class="op" id="7523091">,</span>&nbsp;<span class="ident" id="7523093">want</span>&nbsp;<span class="op" id="7523098">:=</span>&nbsp;<span class="keyword" id="7523101">range</span>&nbsp;<span class="ident" id="7523107">rawTokens</span>&nbsp;<span class="op" id="7523117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7523121">start</span>&nbsp;<span class="op" id="7523127">:=</span>&nbsp;<span class="ident" id="7523130">d</span><span class="op" id="7523131">.</span><span class="ident" id="7523132">InputOffset</span><span class="op" id="7523143">(</span><span class="op" id="7523144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7523148">have</span><span class="op" id="7523152">,</span>&nbsp;<span class="ident" id="7523154">err</span>&nbsp;<span class="op" id="7523158">:=</span>&nbsp;<span class="ident" id="7523161">d</span><span class="op" id="7523162">.</span><span class="ident" id="7523163">RawToken</span><span class="op" id="7523171">(</span><span class="op" id="7523172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7523176">end</span>&nbsp;<span class="op" id="7523180">:=</span>&nbsp;<span class="ident" id="7523183">d</span><span class="op" id="7523184">.</span><span class="ident" id="7523185">InputOffset</span><span class="op" id="7523196">(</span><span class="op" id="7523197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7523201">if</span>&nbsp;<span class="ident" id="7523204">err</span>&nbsp;<span class="op" id="7523208">!=</span>&nbsp;<span class="ident" id="7523211">nil</span>&nbsp;<span class="op" id="7523215">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7523220">t</span><span class="op" id="7523221">.</span><span class="ident" id="7523222">Fatalf</span><span class="op" id="7523228">(</span><span class="string" id="7523229">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7523261">,</span>&nbsp;<span class="ident" id="7523263">i</span><span class="op" id="7523264">,</span>&nbsp;<span class="ident" id="7523266">err</span><span class="op" id="7523269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7523273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7523277">if</span>&nbsp;<span class="op" id="7523280">!</span><span class="ident" id="7523281">reflect</span><span class="op" id="7523288">.</span><span class="ident" id="7523289">DeepEqual</span><span class="op" id="7523298">(</span><span class="ident" id="7523299">have</span><span class="op" id="7523303">,</span>&nbsp;<span class="ident" id="7523305">want</span><span class="op" id="7523309">)</span>&nbsp;<span class="op" id="7523311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7523316">var</span>&nbsp;<span class="ident" id="7523320">shave</span><span class="op" id="7523325">,</span>&nbsp;<span class="ident" id="7523327">swant</span>&nbsp;<span class="builtintype" id="7523333">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7523343">if</span>&nbsp;<span class="ident" id="7523346">_</span><span class="op" id="7523347">,</span>&nbsp;<span class="ident" id="7523349">ok</span>&nbsp;<span class="op" id="7523352">:=</span>&nbsp;<span class="ident" id="7523355">have</span><span class="op" id="7523359">.</span><span class="op" id="7523360">(</span><span class="ident" id="7523361">CharData</span><span class="op" id="7523369">)</span><span class="op" id="7523370">;</span>&nbsp;<span class="ident" id="7523372">ok</span>&nbsp;<span class="op" id="7523375">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7523381">shave</span>&nbsp;<span class="op" id="7523387">=</span>&nbsp;<span class="ident" id="7523389">fmt</span><span class="op" id="7523392">.</span><span class="ident" id="7523393">Sprintf</span><span class="op" id="7523400">(</span><span class="string" id="7523401">&#34;CharData(%q)&#34;</span><span class="op" id="7523415">,</span>&nbsp;<span class="ident" id="7523417">have</span><span class="op" id="7523421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7523426">}</span>&nbsp;<span class="keyword" id="7523428">else</span>&nbsp;<span class="op" id="7523433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7523439">shave</span>&nbsp;<span class="op" id="7523445">=</span>&nbsp;<span class="ident" id="7523447">fmt</span><span class="op" id="7523450">.</span><span class="ident" id="7523451">Sprintf</span><span class="op" id="7523458">(</span><span class="string" id="7523459">&#34;%#v&#34;</span><span class="op" id="7523464">,</span>&nbsp;<span class="ident" id="7523466">have</span><span class="op" id="7523470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7523475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7523480">if</span>&nbsp;<span class="ident" id="7523483">_</span><span class="op" id="7523484">,</span>&nbsp;<span class="ident" id="7523486">ok</span>&nbsp;<span class="op" id="7523489">:=</span>&nbsp;<span class="ident" id="7523492">want</span><span class="op" id="7523496">.</span><span class="op" id="7523497">(</span><span class="ident" id="7523498">CharData</span><span class="op" id="7523506">)</span><span class="op" id="7523507">;</span>&nbsp;<span class="ident" id="7523509">ok</span>&nbsp;<span class="op" id="7523512">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7523518">swant</span>&nbsp;<span class="op" id="7523524">=</span>&nbsp;<span class="ident" id="7523526">fmt</span><span class="op" id="7523529">.</span><span class="ident" id="7523530">Sprintf</span><span class="op" id="7523537">(</span><span class="string" id="7523538">&#34;CharData(%q)&#34;</span><span class="op" id="7523552">,</span>&nbsp;<span class="ident" id="7523554">want</span><span class="op" id="7523558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7523563">}</span>&nbsp;<span class="keyword" id="7523565">else</span>&nbsp;<span class="op" id="7523570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7523576">swant</span>&nbsp;<span class="op" id="7523582">=</span>&nbsp;<span class="ident" id="7523584">fmt</span><span class="op" id="7523587">.</span><span class="ident" id="7523588">Sprintf</span><span class="op" id="7523595">(</span><span class="string" id="7523596">&#34;%#v&#34;</span><span class="op" id="7523601">,</span>&nbsp;<span class="ident" id="7523603">want</span><span class="op" id="7523607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7523612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7523617">t</span><span class="op" id="7523618">.</span><span class="ident" id="7523619">Errorf</span><span class="op" id="7523625">(</span><span class="string" id="7523626">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7523650">,</span>&nbsp;<span class="ident" id="7523652">i</span><span class="op" id="7523653">,</span>&nbsp;<span class="ident" id="7523655">shave</span><span class="op" id="7523660">,</span>&nbsp;<span class="ident" id="7523662">swant</span><span class="op" id="7523667">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7523671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7523676">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7523727">switch</span>&nbsp;<span class="op" id="7523734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7523738">case</span>&nbsp;<span class="ident" id="7523743">start</span>&nbsp;<span class="op" id="7523749">&lt;</span>&nbsp;<span class="ident" id="7523751">lastEnd</span><span class="op" id="7523758">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7523763">t</span><span class="op" id="7523764">.</span><span class="ident" id="7523765">Errorf</span><span class="op" id="7523771">(</span><span class="string" id="7523772">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="7523832">,</span>&nbsp;<span class="ident" id="7523834">i</span><span class="op" id="7523835">,</span>&nbsp;<span class="ident" id="7523837">start</span><span class="op" id="7523842">,</span>&nbsp;<span class="ident" id="7523844">end</span><span class="op" id="7523847">,</span>&nbsp;<span class="ident" id="7523849">have</span><span class="op" id="7523853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7523857">case</span>&nbsp;<span class="ident" id="7523862">start</span>&nbsp;<span class="op" id="7523868">&gt;=</span>&nbsp;<span class="ident" id="7523871">end</span><span class="op" id="7523874">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7523879">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7523930">if</span>&nbsp;<span class="ident" id="7523933">start</span>&nbsp;<span class="op" id="7523939">==</span>&nbsp;<span class="ident" id="7523942">end</span>&nbsp;<span class="op" id="7523946">&amp;&amp;</span>&nbsp;<span class="ident" id="7523949">end</span>&nbsp;<span class="op" id="7523953">==</span>&nbsp;<span class="ident" id="7523956">lastEnd</span>&nbsp;<span class="op" id="7523964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7523970">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7523979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7523984">t</span><span class="op" id="7523985">.</span><span class="ident" id="7523986">Errorf</span><span class="op" id="7523992">(</span><span class="string" id="7523993">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="7524037">,</span>&nbsp;<span class="ident" id="7524039">i</span><span class="op" id="7524040">,</span>&nbsp;<span class="ident" id="7524042">start</span><span class="op" id="7524047">,</span>&nbsp;<span class="ident" id="7524049">end</span><span class="op" id="7524052">,</span>&nbsp;<span class="ident" id="7524054">have</span><span class="op" id="7524058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7524062">case</span>&nbsp;<span class="ident" id="7524067">end</span>&nbsp;<span class="op" id="7524071">&gt;</span>&nbsp;<span class="ident" id="7524073">int64</span><span class="op" id="7524078">(</span><span class="builtinfunc" id="7524079">len</span><span class="op" id="7524082">(</span><span class="ident" id="7524083">raw</span><span class="op" id="7524086">)</span><span class="op" id="7524087">)</span><span class="op" id="7524088">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7524093">t</span><span class="op" id="7524094">.</span><span class="ident" id="7524095">Errorf</span><span class="op" id="7524101">(</span><span class="string" id="7524102">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="7524158">,</span>&nbsp;<span class="ident" id="7524160">i</span><span class="op" id="7524161">,</span>&nbsp;<span class="ident" id="7524163">start</span><span class="op" id="7524168">,</span>&nbsp;<span class="ident" id="7524170">end</span><span class="op" id="7524173">,</span>&nbsp;<span class="ident" id="7524175">have</span><span class="op" id="7524179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7524183">default</span><span class="op" id="7524190">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7524195">text</span>&nbsp;<span class="op" id="7524200">:=</span>&nbsp;<span class="ident" id="7524203">raw</span><span class="op" id="7524206">[</span><span class="ident" id="7524207">start</span><span class="op" id="7524212">:</span><span class="ident" id="7524213">end</span><span class="op" id="7524216">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7524221">if</span>&nbsp;<span class="ident" id="7524224">strings</span><span class="op" id="7524231">.</span><span class="ident" id="7524232">ContainsAny</span><span class="op" id="7524243">(</span><span class="ident" id="7524244">text</span><span class="op" id="7524248">,</span>&nbsp;<span class="string" id="7524250">&#34;&lt;&gt;&#34;</span><span class="op" id="7524254">)</span>&nbsp;<span class="op" id="7524256">&amp;&amp;</span>&nbsp;<span class="op" id="7524259">(</span><span class="op" id="7524260">!</span><span class="ident" id="7524261">strings</span><span class="op" id="7524268">.</span><span class="ident" id="7524269">HasPrefix</span><span class="op" id="7524278">(</span><span class="ident" id="7524279">text</span><span class="op" id="7524283">,</span>&nbsp;<span class="string" id="7524285">&#34;&lt;&#34;</span><span class="op" id="7524288">)</span>&nbsp;<span class="op" id="7524290">||</span>&nbsp;<span class="op" id="7524293">!</span><span class="ident" id="7524294">strings</span><span class="op" id="7524301">.</span><span class="ident" id="7524302">HasSuffix</span><span class="op" id="7524311">(</span><span class="ident" id="7524312">text</span><span class="op" id="7524316">,</span>&nbsp;<span class="string" id="7524318">&#34;&gt;&#34;</span><span class="op" id="7524321">)</span><span class="op" id="7524322">)</span>&nbsp;<span class="op" id="7524324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7524330">t</span><span class="op" id="7524331">.</span><span class="ident" id="7524332">Errorf</span><span class="op" id="7524338">(</span><span class="string" id="7524339">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="7524382">,</span>&nbsp;<span class="ident" id="7524384">i</span><span class="op" id="7524385">,</span>&nbsp;<span class="ident" id="7524387">text</span><span class="op" id="7524391">,</span>&nbsp;<span class="ident" id="7524393">have</span><span class="op" id="7524397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7524402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7524406">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7524410">lastEnd</span>&nbsp;<span class="op" id="7524418">=</span>&nbsp;<span class="ident" id="7524420">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7524425">}</span><br>
<span class="lineno"></span><span class="op" id="7524427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7524430">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="7524501">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="7524569">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7524627">var</span>&nbsp;<span class="ident" id="7524631">nestedDirectivesInput</span>&nbsp;<span class="op" id="7524653">=</span>&nbsp;<span class="string" id="7524655">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7524921">var</span>&nbsp;<span class="ident" id="7524925">nestedDirectivesTokens</span>&nbsp;<span class="op" id="7524948">=</span>&nbsp;<span class="op" id="7524950">[</span><span class="op" id="7524951">]</span><span class="ident" id="7524952">Token</span><span class="op" id="7524957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7524960">CharData</span><span class="op" id="7524968">(</span><span class="string" id="7524969">&#34;\n&#34;</span><span class="op" id="7524973">)</span><span class="op" id="7524974">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7524977">Directive</span><span class="op" id="7524986">(</span><span class="string" id="7524987">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="7525058">)</span><span class="op" id="7525059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525062">CharData</span><span class="op" id="7525070">(</span><span class="string" id="7525071">&#34;\n&#34;</span><span class="op" id="7525075">)</span><span class="op" id="7525076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525079">Directive</span><span class="op" id="7525088">(</span><span class="string" id="7525089">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="7525118">)</span><span class="op" id="7525119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525122">CharData</span><span class="op" id="7525130">(</span><span class="string" id="7525131">&#34;\n&#34;</span><span class="op" id="7525135">)</span><span class="op" id="7525136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525139">Directive</span><span class="op" id="7525148">(</span><span class="string" id="7525149">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="7525178">)</span><span class="op" id="7525179">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525182">CharData</span><span class="op" id="7525190">(</span><span class="string" id="7525191">&#34;\n&#34;</span><span class="op" id="7525195">)</span><span class="op" id="7525196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525199">Directive</span><span class="op" id="7525208">(</span><span class="string" id="7525209">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="7525238">)</span><span class="op" id="7525239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525242">CharData</span><span class="op" id="7525250">(</span><span class="string" id="7525251">&#34;\n&#34;</span><span class="op" id="7525255">)</span><span class="op" id="7525256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525259">Directive</span><span class="op" id="7525268">(</span><span class="string" id="7525269">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="7525298">)</span><span class="op" id="7525299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525302">CharData</span><span class="op" id="7525310">(</span><span class="string" id="7525311">&#34;\n&#34;</span><span class="op" id="7525315">)</span><span class="op" id="7525316">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525319">Directive</span><span class="op" id="7525328">(</span><span class="string" id="7525329">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="7525359">)</span><span class="op" id="7525360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525363">CharData</span><span class="op" id="7525371">(</span><span class="string" id="7525372">&#34;\n&#34;</span><span class="op" id="7525376">)</span><span class="op" id="7525377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525380">Directive</span><span class="op" id="7525389">(</span><span class="string" id="7525390">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="7525420">)</span><span class="op" id="7525421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525424">CharData</span><span class="op" id="7525432">(</span><span class="string" id="7525433">&#34;\n&#34;</span><span class="op" id="7525437">)</span><span class="op" id="7525438">,</span><br>
<span class="lineno"></span><span class="op" id="7525440">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="7525443">func</span>&nbsp;<span class="ident" id="7525448">TestNestedDirectives</span><span class="op" id="7525468">(</span><span class="ident" id="7525469">t</span>&nbsp;<span class="op" id="7525471">*</span><span class="ident" id="7525472">testing</span><span class="op" id="7525479">.</span><span class="ident" id="7525480">T</span><span class="op" id="7525481">)</span>&nbsp;<span class="op" id="7525483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525486">d</span>&nbsp;<span class="op" id="7525488">:=</span>&nbsp;<span class="ident" id="7525491">NewDecoder</span><span class="op" id="7525501">(</span><span class="ident" id="7525502">strings</span><span class="op" id="7525509">.</span><span class="ident" id="7525510">NewReader</span><span class="op" id="7525519">(</span><span class="ident" id="7525520">nestedDirectivesInput</span><span class="op" id="7525541">)</span><span class="op" id="7525542">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7525546">for</span>&nbsp;<span class="ident" id="7525550">i</span><span class="op" id="7525551">,</span>&nbsp;<span class="ident" id="7525553">want</span>&nbsp;<span class="op" id="7525558">:=</span>&nbsp;<span class="keyword" id="7525561">range</span>&nbsp;<span class="ident" id="7525567">nestedDirectivesTokens</span>&nbsp;<span class="op" id="7525590">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525594">have</span><span class="op" id="7525598">,</span>&nbsp;<span class="ident" id="7525600">err</span>&nbsp;<span class="op" id="7525604">:=</span>&nbsp;<span class="ident" id="7525607">d</span><span class="op" id="7525608">.</span><span class="ident" id="7525609">Token</span><span class="op" id="7525614">(</span><span class="op" id="7525615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7525619">if</span>&nbsp;<span class="ident" id="7525622">err</span>&nbsp;<span class="op" id="7525626">!=</span>&nbsp;<span class="ident" id="7525629">nil</span>&nbsp;<span class="op" id="7525633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525638">t</span><span class="op" id="7525639">.</span><span class="ident" id="7525640">Fatalf</span><span class="op" id="7525646">(</span><span class="string" id="7525647">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7525679">,</span>&nbsp;<span class="ident" id="7525681">i</span><span class="op" id="7525682">,</span>&nbsp;<span class="ident" id="7525684">err</span><span class="op" id="7525687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7525691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7525695">if</span>&nbsp;<span class="op" id="7525698">!</span><span class="ident" id="7525699">reflect</span><span class="op" id="7525706">.</span><span class="ident" id="7525707">DeepEqual</span><span class="op" id="7525716">(</span><span class="ident" id="7525717">have</span><span class="op" id="7525721">,</span>&nbsp;<span class="ident" id="7525723">want</span><span class="op" id="7525727">)</span>&nbsp;<span class="op" id="7525729">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525734">t</span><span class="op" id="7525735">.</span><span class="ident" id="7525736">Errorf</span><span class="op" id="7525742">(</span><span class="string" id="7525743">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7525768">,</span>&nbsp;<span class="ident" id="7525770">i</span><span class="op" id="7525771">,</span>&nbsp;<span class="ident" id="7525773">have</span><span class="op" id="7525777">,</span>&nbsp;<span class="ident" id="7525779">want</span><span class="op" id="7525783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7525787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7525790">}</span><br>
<span class="lineno"></span><span class="op" id="7525792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="7525795">func</span>&nbsp;<span class="ident" id="7525800">TestToken</span><span class="op" id="7525809">(</span><span class="ident" id="7525810">t</span>&nbsp;<span class="op" id="7525812">*</span><span class="ident" id="7525813">testing</span><span class="op" id="7525820">.</span><span class="ident" id="7525821">T</span><span class="op" id="7525822">)</span>&nbsp;<span class="op" id="7525824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525827">d</span>&nbsp;<span class="op" id="7525829">:=</span>&nbsp;<span class="ident" id="7525832">NewDecoder</span><span class="op" id="7525842">(</span><span class="ident" id="7525843">strings</span><span class="op" id="7525850">.</span><span class="ident" id="7525851">NewReader</span><span class="op" id="7525860">(</span><span class="ident" id="7525861">testInput</span><span class="op" id="7525870">)</span><span class="op" id="7525871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525874">d</span><span class="op" id="7525875">.</span><span class="ident" id="7525876">Entity</span>&nbsp;<span class="op" id="7525883">=</span>&nbsp;<span class="ident" id="7525885">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7525898">for</span>&nbsp;<span class="ident" id="7525902">i</span><span class="op" id="7525903">,</span>&nbsp;<span class="ident" id="7525905">want</span>&nbsp;<span class="op" id="7525910">:=</span>&nbsp;<span class="keyword" id="7525913">range</span>&nbsp;<span class="ident" id="7525919">cookedTokens</span>&nbsp;<span class="op" id="7525932">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525936">have</span><span class="op" id="7525940">,</span>&nbsp;<span class="ident" id="7525942">err</span>&nbsp;<span class="op" id="7525946">:=</span>&nbsp;<span class="ident" id="7525949">d</span><span class="op" id="7525950">.</span><span class="ident" id="7525951">Token</span><span class="op" id="7525956">(</span><span class="op" id="7525957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7525961">if</span>&nbsp;<span class="ident" id="7525964">err</span>&nbsp;<span class="op" id="7525968">!=</span>&nbsp;<span class="ident" id="7525971">nil</span>&nbsp;<span class="op" id="7525975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525980">t</span><span class="op" id="7525981">.</span><span class="ident" id="7525982">Fatalf</span><span class="op" id="7525988">(</span><span class="string" id="7525989">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7526021">,</span>&nbsp;<span class="ident" id="7526023">i</span><span class="op" id="7526024">,</span>&nbsp;<span class="ident" id="7526026">err</span><span class="op" id="7526029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7526033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7526037">if</span>&nbsp;<span class="op" id="7526040">!</span><span class="ident" id="7526041">reflect</span><span class="op" id="7526048">.</span><span class="ident" id="7526049">DeepEqual</span><span class="op" id="7526058">(</span><span class="ident" id="7526059">have</span><span class="op" id="7526063">,</span>&nbsp;<span class="ident" id="7526065">want</span><span class="op" id="7526069">)</span>&nbsp;<span class="op" id="7526071">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526076">t</span><span class="op" id="7526077">.</span><span class="ident" id="7526078">Errorf</span><span class="op" id="7526084">(</span><span class="string" id="7526085">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7526110">,</span>&nbsp;<span class="ident" id="7526112">i</span><span class="op" id="7526113">,</span>&nbsp;<span class="ident" id="7526115">have</span><span class="op" id="7526119">,</span>&nbsp;<span class="ident" id="7526121">want</span><span class="op" id="7526125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7526129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7526132">}</span><br>
<span class="lineno"></span><span class="op" id="7526134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="7526137">func</span>&nbsp;<span class="ident" id="7526142">TestSyntax</span><span class="op" id="7526152">(</span><span class="ident" id="7526153">t</span>&nbsp;<span class="op" id="7526155">*</span><span class="ident" id="7526156">testing</span><span class="op" id="7526163">.</span><span class="ident" id="7526164">T</span><span class="op" id="7526165">)</span>&nbsp;<span class="op" id="7526167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7526170">for</span>&nbsp;<span class="ident" id="7526174">i</span>&nbsp;<span class="op" id="7526176">:=</span>&nbsp;<span class="keyword" id="7526179">range</span>&nbsp;<span class="ident" id="7526185">xmlInput</span>&nbsp;<span class="op" id="7526194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526198">d</span>&nbsp;<span class="op" id="7526200">:=</span>&nbsp;<span class="ident" id="7526203">NewDecoder</span><span class="op" id="7526213">(</span><span class="ident" id="7526214">strings</span><span class="op" id="7526221">.</span><span class="ident" id="7526222">NewReader</span><span class="op" id="7526231">(</span><span class="ident" id="7526232">xmlInput</span><span class="op" id="7526240">[</span><span class="ident" id="7526241">i</span><span class="op" id="7526242">]</span><span class="op" id="7526243">)</span><span class="op" id="7526244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7526248">var</span>&nbsp;<span class="ident" id="7526252">err</span>&nbsp;<span class="builtintype" id="7526256">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7526264">for</span>&nbsp;<span class="ident" id="7526268">_</span><span class="op" id="7526269">,</span>&nbsp;<span class="ident" id="7526271">err</span>&nbsp;<span class="op" id="7526275">=</span>&nbsp;<span class="ident" id="7526277">d</span><span class="op" id="7526278">.</span><span class="ident" id="7526279">Token</span><span class="op" id="7526284">(</span><span class="op" id="7526285">)</span><span class="op" id="7526286">;</span>&nbsp;<span class="ident" id="7526288">err</span>&nbsp;<span class="op" id="7526292">==</span>&nbsp;<span class="ident" id="7526295">nil</span><span class="op" id="7526298">;</span>&nbsp;<span class="ident" id="7526300">_</span><span class="op" id="7526301">,</span>&nbsp;<span class="ident" id="7526303">err</span>&nbsp;<span class="op" id="7526307">=</span>&nbsp;<span class="ident" id="7526309">d</span><span class="op" id="7526310">.</span><span class="ident" id="7526311">Token</span><span class="op" id="7526316">(</span><span class="op" id="7526317">)</span>&nbsp;<span class="op" id="7526319">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7526323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7526327">if</span>&nbsp;<span class="ident" id="7526330">_</span><span class="op" id="7526331">,</span>&nbsp;<span class="ident" id="7526333">ok</span>&nbsp;<span class="op" id="7526336">:=</span>&nbsp;<span class="ident" id="7526339">err</span><span class="op" id="7526342">.</span><span class="op" id="7526343">(</span><span class="op" id="7526344">*</span><span class="ident" id="7526345">SyntaxError</span><span class="op" id="7526356">)</span><span class="op" id="7526357">;</span>&nbsp;<span class="op" id="7526359">!</span><span class="ident" id="7526360">ok</span>&nbsp;<span class="op" id="7526363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526368">t</span><span class="op" id="7526369">.</span><span class="ident" id="7526370">Fatalf</span><span class="op" id="7526376">(</span><span class="string" id="7526377">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="7526427">,</span>&nbsp;<span class="ident" id="7526429">xmlInput</span><span class="op" id="7526437">[</span><span class="ident" id="7526438">i</span><span class="op" id="7526439">]</span><span class="op" id="7526440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7526444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7526447">}</span><br>
<span class="lineno">400</span><span class="op" id="7526449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7526452">type</span>&nbsp;<span class="ident" id="7526457">allScalars</span>&nbsp;<span class="keyword" id="7526468">struct</span>&nbsp;<span class="op" id="7526475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526478">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526488">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526494">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526504">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526510">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526520">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526526">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526536">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526542">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526552">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526557">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526567">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526573">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526583">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526590">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526600">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526607">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7526617">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526624">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526634">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526639">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526649">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526656">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526666">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526674">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526684">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526692">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7526702">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526710">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526720">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526729">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526739">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526748">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526758">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526767">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526777">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526785">PtrString</span>&nbsp;<span class="op" id="7526795">*</span><span class="builtintype" id="7526796">string</span><br>
<span class="lineno"></span><span class="op" id="7526803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7526806">var</span>&nbsp;<span class="ident" id="7526810">all</span>&nbsp;<span class="op" id="7526814">=</span>&nbsp;<span class="ident" id="7526816">allScalars</span><span class="op" id="7526826">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526829">True1</span><span class="op" id="7526834">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526840">true</span><span class="op" id="7526844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526847">True2</span><span class="op" id="7526852">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526858">true</span><span class="op" id="7526862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526865">False1</span><span class="op" id="7526871">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526876">false</span><span class="op" id="7526881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526884">False2</span><span class="op" id="7526890">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7526895">false</span><span class="op" id="7526900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526903">Int</span><span class="op" id="7526906">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7526914">1</span><span class="op" id="7526915">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526918">Int8</span><span class="op" id="7526922">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7526929">-</span><span class="num" id="7526930">2</span><span class="op" id="7526931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526934">Int16</span><span class="op" id="7526939">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7526945">3</span><span class="op" id="7526946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526949">Int32</span><span class="op" id="7526954">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7526960">-</span><span class="num" id="7526961">4</span><span class="op" id="7526962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526965">Int64</span><span class="op" id="7526970">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7526976">5</span><span class="op" id="7526977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526980">Uint</span><span class="op" id="7526984">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7526991">6</span><span class="op" id="7526992">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7526995">Uint8</span><span class="op" id="7527000">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527006">7</span><span class="op" id="7527007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527010">Uint16</span><span class="op" id="7527016">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527021">8</span><span class="op" id="7527022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527025">Uint32</span><span class="op" id="7527031">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527036">9</span><span class="op" id="7527037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527040">Uint64</span><span class="op" id="7527046">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527051">10</span><span class="op" id="7527053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527056">Uintptr</span><span class="op" id="7527063">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7527067">11</span><span class="op" id="7527069">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527072">Float32</span><span class="op" id="7527079">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7527083">13.0</span><span class="op" id="7527087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527090">Float64</span><span class="op" id="7527097">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7527101">14.0</span><span class="op" id="7527105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527108">String</span><span class="op" id="7527114">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7527119">&#34;15&#34;</span><span class="op" id="7527123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527126">PtrString</span><span class="op" id="7527135">:</span>&nbsp;<span class="op" id="7527137">&amp;</span><span class="ident" id="7527138">sixteen</span><span class="op" id="7527145">,</span><br>
<span class="lineno"></span><span class="op" id="7527147">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="7527150">var</span>&nbsp;<span class="ident" id="7527154">sixteen</span>&nbsp;<span class="op" id="7527162">=</span>&nbsp;<span class="string" id="7527164">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7527170">const</span>&nbsp;<span class="ident" id="7527176">testScalarsInput</span>&nbsp;<span class="op" id="7527193">=</span>&nbsp;<span class="string" id="7527195">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="7527631">func</span>&nbsp;<span class="ident" id="7527636">TestAllScalars</span><span class="op" id="7527650">(</span><span class="ident" id="7527651">t</span>&nbsp;<span class="op" id="7527653">*</span><span class="ident" id="7527654">testing</span><span class="op" id="7527661">.</span><span class="ident" id="7527662">T</span><span class="op" id="7527663">)</span>&nbsp;<span class="op" id="7527665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7527668">var</span>&nbsp;<span class="ident" id="7527672">a</span>&nbsp;<span class="ident" id="7527674">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527686">err</span>&nbsp;<span class="op" id="7527690">:=</span>&nbsp;<span class="ident" id="7527693">Unmarshal</span><span class="op" id="7527702">(</span><span class="op" id="7527703">[</span><span class="op" id="7527704">]</span><span class="builtintype" id="7527705">byte</span><span class="op" id="7527709">(</span><span class="ident" id="7527710">testScalarsInput</span><span class="op" id="7527726">)</span><span class="op" id="7527727">,</span>&nbsp;<span class="op" id="7527729">&amp;</span><span class="ident" id="7527730">a</span><span class="op" id="7527731">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7527735">if</span>&nbsp;<span class="ident" id="7527738">err</span>&nbsp;<span class="op" id="7527742">!=</span>&nbsp;<span class="ident" id="7527745">nil</span>&nbsp;<span class="op" id="7527749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527753">t</span><span class="op" id="7527754">.</span><span class="ident" id="7527755">Fatal</span><span class="op" id="7527760">(</span><span class="ident" id="7527761">err</span><span class="op" id="7527764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7527767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7527770">if</span>&nbsp;<span class="op" id="7527773">!</span><span class="ident" id="7527774">reflect</span><span class="op" id="7527781">.</span><span class="ident" id="7527782">DeepEqual</span><span class="op" id="7527791">(</span><span class="ident" id="7527792">a</span><span class="op" id="7527793">,</span>&nbsp;<span class="ident" id="7527795">all</span><span class="op" id="7527798">)</span>&nbsp;<span class="op" id="7527800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527804">t</span><span class="op" id="7527805">.</span><span class="ident" id="7527806">Errorf</span><span class="op" id="7527812">(</span><span class="string" id="7527813">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="7527832">,</span>&nbsp;<span class="ident" id="7527834">a</span><span class="op" id="7527835">,</span>&nbsp;<span class="ident" id="7527837">all</span><span class="op" id="7527840">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7527843">}</span><br>
<span class="lineno"></span><span class="op" id="7527845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7527848">type</span>&nbsp;<span class="ident" id="7527853">item</span>&nbsp;<span class="keyword" id="7527858">struct</span>&nbsp;<span class="op" id="7527865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527868">Field_a</span>&nbsp;<span class="builtintype" id="7527876">string</span><br>
<span class="lineno">485</span><span class="op" id="7527883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7527886">func</span>&nbsp;<span class="ident" id="7527891">TestIssue569</span><span class="op" id="7527903">(</span><span class="ident" id="7527904">t</span>&nbsp;<span class="op" id="7527906">*</span><span class="ident" id="7527907">testing</span><span class="op" id="7527914">.</span><span class="ident" id="7527915">T</span><span class="op" id="7527916">)</span>&nbsp;<span class="op" id="7527918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527921">data</span>&nbsp;<span class="op" id="7527926">:=</span>&nbsp;<span class="string" id="7527929">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7527969">var</span>&nbsp;<span class="ident" id="7527973">i</span>&nbsp;<span class="ident" id="7527975">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7527981">err</span>&nbsp;<span class="op" id="7527985">:=</span>&nbsp;<span class="ident" id="7527988">Unmarshal</span><span class="op" id="7527997">(</span><span class="op" id="7527998">[</span><span class="op" id="7527999">]</span><span class="builtintype" id="7528000">byte</span><span class="op" id="7528004">(</span><span class="ident" id="7528005">data</span><span class="op" id="7528009">)</span><span class="op" id="7528010">,</span>&nbsp;<span class="op" id="7528012">&amp;</span><span class="ident" id="7528013">i</span><span class="op" id="7528014">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7528018">if</span>&nbsp;<span class="ident" id="7528021">err</span>&nbsp;<span class="op" id="7528025">!=</span>&nbsp;<span class="ident" id="7528028">nil</span>&nbsp;<span class="op" id="7528032">||</span>&nbsp;<span class="ident" id="7528035">i</span><span class="op" id="7528036">.</span><span class="ident" id="7528037">Field_a</span>&nbsp;<span class="op" id="7528045">!=</span>&nbsp;<span class="string" id="7528048">&#34;abcd&#34;</span>&nbsp;<span class="op" id="7528055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528059">t</span><span class="op" id="7528060">.</span><span class="ident" id="7528061">Fatal</span><span class="op" id="7528066">(</span><span class="string" id="7528067">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="7528083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7528086">}</span><br>
<span class="lineno">495</span><span class="op" id="7528088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7528091">func</span>&nbsp;<span class="ident" id="7528096">TestUnquotedAttrs</span><span class="op" id="7528113">(</span><span class="ident" id="7528114">t</span>&nbsp;<span class="op" id="7528116">*</span><span class="ident" id="7528117">testing</span><span class="op" id="7528124">.</span><span class="ident" id="7528125">T</span><span class="op" id="7528126">)</span>&nbsp;<span class="op" id="7528128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528131">data</span>&nbsp;<span class="op" id="7528136">:=</span>&nbsp;<span class="string" id="7528139">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528165">d</span>&nbsp;<span class="op" id="7528167">:=</span>&nbsp;<span class="ident" id="7528170">NewDecoder</span><span class="op" id="7528180">(</span><span class="ident" id="7528181">strings</span><span class="op" id="7528188">.</span><span class="ident" id="7528189">NewReader</span><span class="op" id="7528198">(</span><span class="ident" id="7528199">data</span><span class="op" id="7528203">)</span><span class="op" id="7528204">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528207">d</span><span class="op" id="7528208">.</span><span class="ident" id="7528209">Strict</span>&nbsp;<span class="op" id="7528216">=</span>&nbsp;<span class="builtintype" id="7528218">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528225">token</span><span class="op" id="7528230">,</span>&nbsp;<span class="ident" id="7528232">err</span>&nbsp;<span class="op" id="7528236">:=</span>&nbsp;<span class="ident" id="7528239">d</span><span class="op" id="7528240">.</span><span class="ident" id="7528241">Token</span><span class="op" id="7528246">(</span><span class="op" id="7528247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7528250">if</span>&nbsp;<span class="ident" id="7528253">_</span><span class="op" id="7528254">,</span>&nbsp;<span class="ident" id="7528256">ok</span>&nbsp;<span class="op" id="7528259">:=</span>&nbsp;<span class="ident" id="7528262">err</span><span class="op" id="7528265">.</span><span class="op" id="7528266">(</span><span class="op" id="7528267">*</span><span class="ident" id="7528268">SyntaxError</span><span class="op" id="7528279">)</span><span class="op" id="7528280">;</span>&nbsp;<span class="ident" id="7528282">ok</span>&nbsp;<span class="op" id="7528285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528289">t</span><span class="op" id="7528290">.</span><span class="ident" id="7528291">Errorf</span><span class="op" id="7528297">(</span><span class="string" id="7528298">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7528320">,</span>&nbsp;<span class="ident" id="7528322">err</span><span class="op" id="7528325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7528328">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7528331">if</span>&nbsp;<span class="ident" id="7528334">token</span><span class="op" id="7528339">.</span><span class="op" id="7528340">(</span><span class="ident" id="7528341">StartElement</span><span class="op" id="7528353">)</span><span class="op" id="7528354">.</span><span class="ident" id="7528355">Name</span><span class="op" id="7528359">.</span><span class="ident" id="7528360">Local</span>&nbsp;<span class="op" id="7528366">!=</span>&nbsp;<span class="string" id="7528369">&#34;tag&#34;</span>&nbsp;<span class="op" id="7528375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528379">t</span><span class="op" id="7528380">.</span><span class="ident" id="7528381">Errorf</span><span class="op" id="7528387">(</span><span class="string" id="7528388">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7528413">,</span>&nbsp;<span class="ident" id="7528415">token</span><span class="op" id="7528420">.</span><span class="op" id="7528421">(</span><span class="ident" id="7528422">StartElement</span><span class="op" id="7528434">)</span><span class="op" id="7528435">.</span><span class="ident" id="7528436">Name</span><span class="op" id="7528440">.</span><span class="ident" id="7528441">Local</span><span class="op" id="7528446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7528449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528452">attr</span>&nbsp;<span class="op" id="7528457">:=</span>&nbsp;<span class="ident" id="7528460">token</span><span class="op" id="7528465">.</span><span class="op" id="7528466">(</span><span class="ident" id="7528467">StartElement</span><span class="op" id="7528479">)</span><span class="op" id="7528480">.</span><span class="ident" id="7528481">Attr</span><span class="op" id="7528485">[</span><span class="num" id="7528486">0</span><span class="op" id="7528487">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7528490">if</span>&nbsp;<span class="ident" id="7528493">attr</span><span class="op" id="7528497">.</span><span class="ident" id="7528498">Value</span>&nbsp;<span class="op" id="7528504">!=</span>&nbsp;<span class="string" id="7528507">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="7528519">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528523">t</span><span class="op" id="7528524">.</span><span class="ident" id="7528525">Errorf</span><span class="op" id="7528531">(</span><span class="string" id="7528532">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="7528564">,</span>&nbsp;<span class="ident" id="7528566">attr</span><span class="op" id="7528570">.</span><span class="ident" id="7528571">Value</span><span class="op" id="7528576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7528579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7528582">if</span>&nbsp;<span class="ident" id="7528585">attr</span><span class="op" id="7528589">.</span><span class="ident" id="7528590">Name</span><span class="op" id="7528594">.</span><span class="ident" id="7528595">Local</span>&nbsp;<span class="op" id="7528601">!=</span>&nbsp;<span class="string" id="7528604">&#34;attr&#34;</span>&nbsp;<span class="op" id="7528611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528615">t</span><span class="op" id="7528616">.</span><span class="ident" id="7528617">Errorf</span><span class="op" id="7528623">(</span><span class="string" id="7528624">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7528655">,</span>&nbsp;<span class="ident" id="7528657">attr</span><span class="op" id="7528661">.</span><span class="ident" id="7528662">Name</span><span class="op" id="7528666">.</span><span class="ident" id="7528667">Local</span><span class="op" id="7528672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7528675">}</span><br>
<span class="lineno">515</span><span class="op" id="7528677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7528680">func</span>&nbsp;<span class="ident" id="7528685">TestValuelessAttrs</span><span class="op" id="7528703">(</span><span class="ident" id="7528704">t</span>&nbsp;<span class="op" id="7528706">*</span><span class="ident" id="7528707">testing</span><span class="op" id="7528714">.</span><span class="ident" id="7528715">T</span><span class="op" id="7528716">)</span>&nbsp;<span class="op" id="7528718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528721">tests</span>&nbsp;<span class="op" id="7528727">:=</span>&nbsp;<span class="op" id="7528730">[</span><span class="op" id="7528731">]</span><span class="op" id="7528732">[</span><span class="num" id="7528733">3</span><span class="op" id="7528734">]</span><span class="builtintype" id="7528735">string</span><span class="op" id="7528741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7528745">{</span><span class="string" id="7528746">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="7528758">,</span>&nbsp;<span class="string" id="7528760">&#34;p&#34;</span><span class="op" id="7528763">,</span>&nbsp;<span class="string" id="7528765">&#34;nowrap&#34;</span><span class="op" id="7528773">}</span><span class="op" id="7528774">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7528778">{</span><span class="string" id="7528779">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="7528792">,</span>&nbsp;<span class="string" id="7528794">&#34;p&#34;</span><span class="op" id="7528797">,</span>&nbsp;<span class="string" id="7528799">&#34;nowrap&#34;</span><span class="op" id="7528807">}</span><span class="op" id="7528808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7528812">{</span><span class="string" id="7528813">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="7528831">,</span>&nbsp;<span class="string" id="7528833">&#34;input&#34;</span><span class="op" id="7528840">,</span>&nbsp;<span class="string" id="7528842">&#34;checked&#34;</span><span class="op" id="7528851">}</span><span class="op" id="7528852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7528856">{</span><span class="string" id="7528857">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="7528876">,</span>&nbsp;<span class="string" id="7528878">&#34;input&#34;</span><span class="op" id="7528885">,</span>&nbsp;<span class="string" id="7528887">&#34;checked&#34;</span><span class="op" id="7528896">}</span><span class="op" id="7528897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7528900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7528903">for</span>&nbsp;<span class="ident" id="7528907">_</span><span class="op" id="7528908">,</span>&nbsp;<span class="ident" id="7528910">test</span>&nbsp;<span class="op" id="7528915">:=</span>&nbsp;<span class="keyword" id="7528918">range</span>&nbsp;<span class="ident" id="7528924">tests</span>&nbsp;<span class="op" id="7528930">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528934">d</span>&nbsp;<span class="op" id="7528936">:=</span>&nbsp;<span class="ident" id="7528939">NewDecoder</span><span class="op" id="7528949">(</span><span class="ident" id="7528950">strings</span><span class="op" id="7528957">.</span><span class="ident" id="7528958">NewReader</span><span class="op" id="7528967">(</span><span class="ident" id="7528968">test</span><span class="op" id="7528972">[</span><span class="num" id="7528973">0</span><span class="op" id="7528974">]</span><span class="op" id="7528975">)</span><span class="op" id="7528976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528980">d</span><span class="op" id="7528981">.</span><span class="ident" id="7528982">Strict</span>&nbsp;<span class="op" id="7528989">=</span>&nbsp;<span class="builtintype" id="7528991">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7528999">token</span><span class="op" id="7529004">,</span>&nbsp;<span class="ident" id="7529006">err</span>&nbsp;<span class="op" id="7529010">:=</span>&nbsp;<span class="ident" id="7529013">d</span><span class="op" id="7529014">.</span><span class="ident" id="7529015">Token</span><span class="op" id="7529020">(</span><span class="op" id="7529021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7529025">if</span>&nbsp;<span class="ident" id="7529028">_</span><span class="op" id="7529029">,</span>&nbsp;<span class="ident" id="7529031">ok</span>&nbsp;<span class="op" id="7529034">:=</span>&nbsp;<span class="ident" id="7529037">err</span><span class="op" id="7529040">.</span><span class="op" id="7529041">(</span><span class="op" id="7529042">*</span><span class="ident" id="7529043">SyntaxError</span><span class="op" id="7529054">)</span><span class="op" id="7529055">;</span>&nbsp;<span class="ident" id="7529057">ok</span>&nbsp;<span class="op" id="7529060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529065">t</span><span class="op" id="7529066">.</span><span class="ident" id="7529067">Errorf</span><span class="op" id="7529073">(</span><span class="string" id="7529074">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7529096">,</span>&nbsp;<span class="ident" id="7529098">err</span><span class="op" id="7529101">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7529109">if</span>&nbsp;<span class="ident" id="7529112">token</span><span class="op" id="7529117">.</span><span class="op" id="7529118">(</span><span class="ident" id="7529119">StartElement</span><span class="op" id="7529131">)</span><span class="op" id="7529132">.</span><span class="ident" id="7529133">Name</span><span class="op" id="7529137">.</span><span class="ident" id="7529138">Local</span>&nbsp;<span class="op" id="7529144">!=</span>&nbsp;<span class="ident" id="7529147">test</span><span class="op" id="7529151">[</span><span class="num" id="7529152">1</span><span class="op" id="7529153">]</span>&nbsp;<span class="op" id="7529155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529160">t</span><span class="op" id="7529161">.</span><span class="ident" id="7529162">Errorf</span><span class="op" id="7529168">(</span><span class="string" id="7529169">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7529194">,</span>&nbsp;<span class="ident" id="7529196">token</span><span class="op" id="7529201">.</span><span class="op" id="7529202">(</span><span class="ident" id="7529203">StartElement</span><span class="op" id="7529215">)</span><span class="op" id="7529216">.</span><span class="ident" id="7529217">Name</span><span class="op" id="7529221">.</span><span class="ident" id="7529222">Local</span><span class="op" id="7529227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529235">attr</span>&nbsp;<span class="op" id="7529240">:=</span>&nbsp;<span class="ident" id="7529243">token</span><span class="op" id="7529248">.</span><span class="op" id="7529249">(</span><span class="ident" id="7529250">StartElement</span><span class="op" id="7529262">)</span><span class="op" id="7529263">.</span><span class="ident" id="7529264">Attr</span><span class="op" id="7529268">[</span><span class="num" id="7529269">0</span><span class="op" id="7529270">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7529274">if</span>&nbsp;<span class="ident" id="7529277">attr</span><span class="op" id="7529281">.</span><span class="ident" id="7529282">Value</span>&nbsp;<span class="op" id="7529288">!=</span>&nbsp;<span class="ident" id="7529291">test</span><span class="op" id="7529295">[</span><span class="num" id="7529296">2</span><span class="op" id="7529297">]</span>&nbsp;<span class="op" id="7529299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529304">t</span><span class="op" id="7529305">.</span><span class="ident" id="7529306">Errorf</span><span class="op" id="7529312">(</span><span class="string" id="7529313">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="7529345">,</span>&nbsp;<span class="ident" id="7529347">attr</span><span class="op" id="7529351">.</span><span class="ident" id="7529352">Value</span><span class="op" id="7529357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7529365">if</span>&nbsp;<span class="ident" id="7529368">attr</span><span class="op" id="7529372">.</span><span class="ident" id="7529373">Name</span><span class="op" id="7529377">.</span><span class="ident" id="7529378">Local</span>&nbsp;<span class="op" id="7529384">!=</span>&nbsp;<span class="ident" id="7529387">test</span><span class="op" id="7529391">[</span><span class="num" id="7529392">2</span><span class="op" id="7529393">]</span>&nbsp;<span class="op" id="7529395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529400">t</span><span class="op" id="7529401">.</span><span class="ident" id="7529402">Errorf</span><span class="op" id="7529408">(</span><span class="string" id="7529409">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7529440">,</span>&nbsp;<span class="ident" id="7529442">attr</span><span class="op" id="7529446">.</span><span class="ident" id="7529447">Name</span><span class="op" id="7529451">.</span><span class="ident" id="7529452">Local</span><span class="op" id="7529457">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529464">}</span><br>
<span class="lineno"></span><span class="op" id="7529466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7529469">func</span>&nbsp;<span class="ident" id="7529474">TestCopyTokenCharData</span><span class="op" id="7529495">(</span><span class="ident" id="7529496">t</span>&nbsp;<span class="op" id="7529498">*</span><span class="ident" id="7529499">testing</span><span class="op" id="7529506">.</span><span class="ident" id="7529507">T</span><span class="op" id="7529508">)</span>&nbsp;<span class="op" id="7529510">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529513">data</span>&nbsp;<span class="op" id="7529518">:=</span>&nbsp;<span class="op" id="7529521">[</span><span class="op" id="7529522">]</span><span class="builtintype" id="7529523">byte</span><span class="op" id="7529527">(</span><span class="string" id="7529528">&#34;same&nbsp;data&#34;</span><span class="op" id="7529539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7529542">var</span>&nbsp;<span class="ident" id="7529546">tok1</span>&nbsp;<span class="ident" id="7529551">Token</span>&nbsp;<span class="op" id="7529557">=</span>&nbsp;<span class="ident" id="7529559">CharData</span><span class="op" id="7529567">(</span><span class="ident" id="7529568">data</span><span class="op" id="7529572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529575">tok2</span>&nbsp;<span class="op" id="7529580">:=</span>&nbsp;<span class="ident" id="7529583">CopyToken</span><span class="op" id="7529592">(</span><span class="ident" id="7529593">tok1</span><span class="op" id="7529597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7529600">if</span>&nbsp;<span class="op" id="7529603">!</span><span class="ident" id="7529604">reflect</span><span class="op" id="7529611">.</span><span class="ident" id="7529612">DeepEqual</span><span class="op" id="7529621">(</span><span class="ident" id="7529622">tok1</span><span class="op" id="7529626">,</span>&nbsp;<span class="ident" id="7529628">tok2</span><span class="op" id="7529632">)</span>&nbsp;<span class="op" id="7529634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529638">t</span><span class="op" id="7529639">.</span><span class="ident" id="7529640">Error</span><span class="op" id="7529645">(</span><span class="string" id="7529646">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="7529679">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529685">data</span><span class="op" id="7529689">[</span><span class="num" id="7529690">1</span><span class="op" id="7529691">]</span>&nbsp;<span class="op" id="7529693">=</span>&nbsp;<span class="string" id="7529695">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7529700">if</span>&nbsp;<span class="ident" id="7529703">reflect</span><span class="op" id="7529710">.</span><span class="ident" id="7529711">DeepEqual</span><span class="op" id="7529720">(</span><span class="ident" id="7529721">tok1</span><span class="op" id="7529725">,</span>&nbsp;<span class="ident" id="7529727">tok2</span><span class="op" id="7529731">)</span>&nbsp;<span class="op" id="7529733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529737">t</span><span class="op" id="7529738">.</span><span class="ident" id="7529739">Error</span><span class="op" id="7529744">(</span><span class="string" id="7529745">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="7529784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529787">}</span><br>
<span class="lineno">555</span><span class="op" id="7529789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7529792">func</span>&nbsp;<span class="ident" id="7529797">TestCopyTokenStartElement</span><span class="op" id="7529822">(</span><span class="ident" id="7529823">t</span>&nbsp;<span class="op" id="7529825">*</span><span class="ident" id="7529826">testing</span><span class="op" id="7529833">.</span><span class="ident" id="7529834">T</span><span class="op" id="7529835">)</span>&nbsp;<span class="op" id="7529837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529840">elt</span>&nbsp;<span class="op" id="7529844">:=</span>&nbsp;<span class="ident" id="7529847">StartElement</span><span class="op" id="7529859">{</span><span class="ident" id="7529860">Name</span><span class="op" id="7529864">{</span><span class="string" id="7529865">&#34;&#34;</span><span class="op" id="7529867">,</span>&nbsp;<span class="string" id="7529869">&#34;hello&#34;</span><span class="op" id="7529876">}</span><span class="op" id="7529877">,</span>&nbsp;<span class="op" id="7529879">[</span><span class="op" id="7529880">]</span><span class="ident" id="7529881">Attr</span><span class="op" id="7529885">{</span><span class="op" id="7529886">{</span><span class="ident" id="7529887">Name</span><span class="op" id="7529891">{</span><span class="string" id="7529892">&#34;&#34;</span><span class="op" id="7529894">,</span>&nbsp;<span class="string" id="7529896">&#34;lang&#34;</span><span class="op" id="7529902">}</span><span class="op" id="7529903">,</span>&nbsp;<span class="string" id="7529905">&#34;en&#34;</span><span class="op" id="7529909">}</span><span class="op" id="7529910">}</span><span class="op" id="7529911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7529914">var</span>&nbsp;<span class="ident" id="7529918">tok1</span>&nbsp;<span class="ident" id="7529923">Token</span>&nbsp;<span class="op" id="7529929">=</span>&nbsp;<span class="ident" id="7529931">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529936">tok2</span>&nbsp;<span class="op" id="7529941">:=</span>&nbsp;<span class="ident" id="7529944">CopyToken</span><span class="op" id="7529953">(</span><span class="ident" id="7529954">tok1</span><span class="op" id="7529958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7529961">if</span>&nbsp;<span class="ident" id="7529964">tok1</span><span class="op" id="7529968">.</span><span class="op" id="7529969">(</span><span class="ident" id="7529970">StartElement</span><span class="op" id="7529982">)</span><span class="op" id="7529983">.</span><span class="ident" id="7529984">Attr</span><span class="op" id="7529988">[</span><span class="num" id="7529989">0</span><span class="op" id="7529990">]</span><span class="op" id="7529991">.</span><span class="ident" id="7529992">Value</span>&nbsp;<span class="op" id="7529998">!=</span>&nbsp;<span class="string" id="7530001">&#34;en&#34;</span>&nbsp;<span class="op" id="7530006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530010">t</span><span class="op" id="7530011">.</span><span class="ident" id="7530012">Error</span><span class="op" id="7530017">(</span><span class="string" id="7530018">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="7530047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7530053">if</span>&nbsp;<span class="op" id="7530056">!</span><span class="ident" id="7530057">reflect</span><span class="op" id="7530064">.</span><span class="ident" id="7530065">DeepEqual</span><span class="op" id="7530074">(</span><span class="ident" id="7530075">tok1</span><span class="op" id="7530079">,</span>&nbsp;<span class="ident" id="7530081">tok2</span><span class="op" id="7530085">)</span>&nbsp;<span class="op" id="7530087">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530091">t</span><span class="op" id="7530092">.</span><span class="ident" id="7530093">Error</span><span class="op" id="7530098">(</span><span class="string" id="7530099">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="7530140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530146">tok1</span><span class="op" id="7530150">.</span><span class="op" id="7530151">(</span><span class="ident" id="7530152">StartElement</span><span class="op" id="7530164">)</span><span class="op" id="7530165">.</span><span class="ident" id="7530166">Attr</span><span class="op" id="7530170">[</span><span class="num" id="7530171">0</span><span class="op" id="7530172">]</span>&nbsp;<span class="op" id="7530174">=</span>&nbsp;<span class="ident" id="7530176">Attr</span><span class="op" id="7530180">{</span><span class="ident" id="7530181">Name</span><span class="op" id="7530185">{</span><span class="string" id="7530186">&#34;&#34;</span><span class="op" id="7530188">,</span>&nbsp;<span class="string" id="7530190">&#34;lang&#34;</span><span class="op" id="7530196">}</span><span class="op" id="7530197">,</span>&nbsp;<span class="string" id="7530199">&#34;de&#34;</span><span class="op" id="7530203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7530206">if</span>&nbsp;<span class="ident" id="7530209">reflect</span><span class="op" id="7530216">.</span><span class="ident" id="7530217">DeepEqual</span><span class="op" id="7530226">(</span><span class="ident" id="7530227">tok1</span><span class="op" id="7530231">,</span>&nbsp;<span class="ident" id="7530233">tok2</span><span class="op" id="7530237">)</span>&nbsp;<span class="op" id="7530239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530243">t</span><span class="op" id="7530244">.</span><span class="ident" id="7530245">Error</span><span class="op" id="7530250">(</span><span class="string" id="7530251">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="7530290">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530293">}</span><br>
<span class="lineno"></span><span class="op" id="7530295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7530298">func</span>&nbsp;<span class="ident" id="7530303">TestSyntaxErrorLineNum</span><span class="op" id="7530325">(</span><span class="ident" id="7530326">t</span>&nbsp;<span class="op" id="7530328">*</span><span class="ident" id="7530329">testing</span><span class="op" id="7530336">.</span><span class="ident" id="7530337">T</span><span class="op" id="7530338">)</span>&nbsp;<span class="op" id="7530340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530343">testInput</span>&nbsp;<span class="op" id="7530353">:=</span>&nbsp;<span class="string" id="7530356">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530384">d</span>&nbsp;<span class="op" id="7530386">:=</span>&nbsp;<span class="ident" id="7530389">NewDecoder</span><span class="op" id="7530399">(</span><span class="ident" id="7530400">strings</span><span class="op" id="7530407">.</span><span class="ident" id="7530408">NewReader</span><span class="op" id="7530417">(</span><span class="ident" id="7530418">testInput</span><span class="op" id="7530427">)</span><span class="op" id="7530428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7530431">var</span>&nbsp;<span class="ident" id="7530435">err</span>&nbsp;<span class="builtintype" id="7530439">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7530446">for</span>&nbsp;<span class="ident" id="7530450">_</span><span class="op" id="7530451">,</span>&nbsp;<span class="ident" id="7530453">err</span>&nbsp;<span class="op" id="7530457">=</span>&nbsp;<span class="ident" id="7530459">d</span><span class="op" id="7530460">.</span><span class="ident" id="7530461">Token</span><span class="op" id="7530466">(</span><span class="op" id="7530467">)</span><span class="op" id="7530468">;</span>&nbsp;<span class="ident" id="7530470">err</span>&nbsp;<span class="op" id="7530474">==</span>&nbsp;<span class="ident" id="7530477">nil</span><span class="op" id="7530480">;</span>&nbsp;<span class="ident" id="7530482">_</span><span class="op" id="7530483">,</span>&nbsp;<span class="ident" id="7530485">err</span>&nbsp;<span class="op" id="7530489">=</span>&nbsp;<span class="ident" id="7530491">d</span><span class="op" id="7530492">.</span><span class="ident" id="7530493">Token</span><span class="op" id="7530498">(</span><span class="op" id="7530499">)</span>&nbsp;<span class="op" id="7530501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530507">synerr</span><span class="op" id="7530513">,</span>&nbsp;<span class="ident" id="7530515">ok</span>&nbsp;<span class="op" id="7530518">:=</span>&nbsp;<span class="ident" id="7530521">err</span><span class="op" id="7530524">.</span><span class="op" id="7530525">(</span><span class="op" id="7530526">*</span><span class="ident" id="7530527">SyntaxError</span><span class="op" id="7530538">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7530541">if</span>&nbsp;<span class="op" id="7530544">!</span><span class="ident" id="7530545">ok</span>&nbsp;<span class="op" id="7530548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530552">t</span><span class="op" id="7530553">.</span><span class="ident" id="7530554">Error</span><span class="op" id="7530559">(</span><span class="string" id="7530560">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="7530583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7530589">if</span>&nbsp;<span class="ident" id="7530592">synerr</span><span class="op" id="7530598">.</span><span class="ident" id="7530599">Line</span>&nbsp;<span class="op" id="7530604">!=</span>&nbsp;<span class="num" id="7530607">3</span>&nbsp;<span class="op" id="7530609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530613">t</span><span class="op" id="7530614">.</span><span class="ident" id="7530615">Error</span><span class="op" id="7530620">(</span><span class="string" id="7530621">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="7530667">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530670">}</span><br>
<span class="lineno"></span><span class="op" id="7530672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7530675">func</span>&nbsp;<span class="ident" id="7530680">TestTrailingRawToken</span><span class="op" id="7530700">(</span><span class="ident" id="7530701">t</span>&nbsp;<span class="op" id="7530703">*</span><span class="ident" id="7530704">testing</span><span class="op" id="7530711">.</span><span class="ident" id="7530712">T</span><span class="op" id="7530713">)</span>&nbsp;<span class="op" id="7530715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530718">input</span>&nbsp;<span class="op" id="7530724">:=</span>&nbsp;<span class="string" id="7530727">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530744">d</span>&nbsp;<span class="op" id="7530746">:=</span>&nbsp;<span class="ident" id="7530749">NewDecoder</span><span class="op" id="7530759">(</span><span class="ident" id="7530760">strings</span><span class="op" id="7530767">.</span><span class="ident" id="7530768">NewReader</span><span class="op" id="7530777">(</span><span class="ident" id="7530778">input</span><span class="op" id="7530783">)</span><span class="op" id="7530784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7530787">var</span>&nbsp;<span class="ident" id="7530791">err</span>&nbsp;<span class="builtintype" id="7530795">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7530802">for</span>&nbsp;<span class="ident" id="7530806">_</span><span class="op" id="7530807">,</span>&nbsp;<span class="ident" id="7530809">err</span>&nbsp;<span class="op" id="7530813">=</span>&nbsp;<span class="ident" id="7530815">d</span><span class="op" id="7530816">.</span><span class="ident" id="7530817">RawToken</span><span class="op" id="7530825">(</span><span class="op" id="7530826">)</span><span class="op" id="7530827">;</span>&nbsp;<span class="ident" id="7530829">err</span>&nbsp;<span class="op" id="7530833">==</span>&nbsp;<span class="ident" id="7530836">nil</span><span class="op" id="7530839">;</span>&nbsp;<span class="ident" id="7530841">_</span><span class="op" id="7530842">,</span>&nbsp;<span class="ident" id="7530844">err</span>&nbsp;<span class="op" id="7530848">=</span>&nbsp;<span class="ident" id="7530850">d</span><span class="op" id="7530851">.</span><span class="ident" id="7530852">RawToken</span><span class="op" id="7530860">(</span><span class="op" id="7530861">)</span>&nbsp;<span class="op" id="7530863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7530869">if</span>&nbsp;<span class="ident" id="7530872">err</span>&nbsp;<span class="op" id="7530876">!=</span>&nbsp;<span class="ident" id="7530879">io</span><span class="op" id="7530881">.</span><span class="ident" id="7530882">EOF</span>&nbsp;<span class="op" id="7530886">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530890">t</span><span class="op" id="7530891">.</span><span class="ident" id="7530892">Fatalf</span><span class="op" id="7530898">(</span><span class="string" id="7530899">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7530937">,</span>&nbsp;<span class="ident" id="7530939">err</span><span class="op" id="7530942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530945">}</span><br>
<span class="lineno"></span><span class="op" id="7530947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7530950">func</span>&nbsp;<span class="ident" id="7530955">TestTrailingToken</span><span class="op" id="7530972">(</span><span class="ident" id="7530973">t</span>&nbsp;<span class="op" id="7530975">*</span><span class="ident" id="7530976">testing</span><span class="op" id="7530983">.</span><span class="ident" id="7530984">T</span><span class="op" id="7530985">)</span>&nbsp;<span class="op" id="7530987">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7530990">input</span>&nbsp;<span class="op" id="7530996">:=</span>&nbsp;<span class="string" id="7530999">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7531016">d</span>&nbsp;<span class="op" id="7531018">:=</span>&nbsp;<span class="ident" id="7531021">NewDecoder</span><span class="op" id="7531031">(</span><span class="ident" id="7531032">strings</span><span class="op" id="7531039">.</span><span class="ident" id="7531040">NewReader</span><span class="op" id="7531049">(</span><span class="ident" id="7531050">input</span><span class="op" id="7531055">)</span><span class="op" id="7531056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7531059">var</span>&nbsp;<span class="ident" id="7531063">err</span>&nbsp;<span class="builtintype" id="7531067">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7531074">for</span>&nbsp;<span class="ident" id="7531078">_</span><span class="op" id="7531079">,</span>&nbsp;<span class="ident" id="7531081">err</span>&nbsp;<span class="op" id="7531085">=</span>&nbsp;<span class="ident" id="7531087">d</span><span class="op" id="7531088">.</span><span class="ident" id="7531089">Token</span><span class="op" id="7531094">(</span><span class="op" id="7531095">)</span><span class="op" id="7531096">;</span>&nbsp;<span class="ident" id="7531098">err</span>&nbsp;<span class="op" id="7531102">==</span>&nbsp;<span class="ident" id="7531105">nil</span><span class="op" id="7531108">;</span>&nbsp;<span class="ident" id="7531110">_</span><span class="op" id="7531111">,</span>&nbsp;<span class="ident" id="7531113">err</span>&nbsp;<span class="op" id="7531117">=</span>&nbsp;<span class="ident" id="7531119">d</span><span class="op" id="7531120">.</span><span class="ident" id="7531121">Token</span><span class="op" id="7531126">(</span><span class="op" id="7531127">)</span>&nbsp;<span class="op" id="7531129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7531132">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7531135">if</span>&nbsp;<span class="ident" id="7531138">err</span>&nbsp;<span class="op" id="7531142">!=</span>&nbsp;<span class="ident" id="7531145">io</span><span class="op" id="7531147">.</span><span class="ident" id="7531148">EOF</span>&nbsp;<span class="op" id="7531152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7531156">t</span><span class="op" id="7531157">.</span><span class="ident" id="7531158">Fatalf</span><span class="op" id="7531164">(</span><span class="string" id="7531165">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7531200">,</span>&nbsp;<span class="ident" id="7531202">err</span><span class="op" id="7531205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7531208">}</span><br>
<span class="lineno"></span><span class="op" id="7531210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="7531213">func</span>&nbsp;<span class="ident" id="7531218">TestEntityInsideCDATA</span><span class="op" id="7531239">(</span><span class="ident" id="7531240">t</span>&nbsp;<span class="op" id="7531242">*</span><span class="ident" id="7531243">testing</span><span class="op" id="7531250">.</span><span class="ident" id="7531251">T</span><span class="op" id="7531252">)</span>&nbsp;<span class="op" id="7531254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7531257">input</span>&nbsp;<span class="op" id="7531263">:=</span>&nbsp;<span class="string" id="7531266">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7531305">d</span>&nbsp;<span class="op" id="7531307">:=</span>&nbsp;<span class="ident" id="7531310">NewDecoder</span><span class="op" id="7531320">(</span><span class="ident" id="7531321">strings</span><span class="op" id="7531328">.</span><span class="ident" id="7531329">NewReader</span><span class="op" id="7531338">(</span><span class="ident" id="7531339">input</span><span class="op" id="7531344">)</span><span class="op" id="7531345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7531348">var</span>&nbsp;<span class="ident" id="7531352">err</span>&nbsp;<span class="builtintype" id="7531356">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7531363">for</span>&nbsp;<span class="ident" id="7531367">_</span><span class="op" id="7531368">,</span>&nbsp;<span class="ident" id="7531370">err</span>&nbsp;<span class="op" id="7531374">=</span>&nbsp;<span class="ident" id="7531376">d</span><span class="op" id="7531377">.</span><span class="ident" id="7531378">Token</span><span class="op" id="7531383">(</span><span class="op" id="7531384">)</span><span class="op" id="7531385">;</span>&nbsp;<span class="ident" id="7531387">err</span>&nbsp;<span class="op" id="7531391">==</span>&nbsp;<span class="ident" id="7531394">nil</span><span class="op" id="7531397">;</span>&nbsp;<span class="ident" id="7531399">_</span><span class="op" id="7531400">,</span>&nbsp;<span class="ident" id="7531402">err</span>&nbsp;<span class="op" id="7531406">=</span>&nbsp;<span class="ident" id="7531408">d</span><span class="op" id="7531409">.</span><span class="ident" id="7531410">Token</span><span class="op" id="7531415">(</span><span class="op" id="7531416">)</span>&nbsp;<span class="op" id="7531418">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7531421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7531424">if</span>&nbsp;<span class="ident" id="7531427">err</span>&nbsp;<span class="op" id="7531431">!=</span>&nbsp;<span class="ident" id="7531434">io</span><span class="op" id="7531436">.</span><span class="ident" id="7531437">EOF</span>&nbsp;<span class="op" id="7531441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7531445">t</span><span class="op" id="7531446">.</span><span class="ident" id="7531447">Fatalf</span><span class="op" id="7531453">(</span><span class="string" id="7531454">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7531489">,</span>&nbsp;<span class="ident" id="7531491">err</span><span class="op" id="7531494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7531497">}</span><br>
<span class="lineno"></span><span class="op" id="7531499">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="7531502">var</span>&nbsp;<span class="ident" id="7531506">characterTests</span>&nbsp;<span class="op" id="7531521">=</span>&nbsp;<span class="op" id="7531523">[</span><span class="op" id="7531524">]</span><span class="keyword" id="7531525">struct</span>&nbsp;<span class="op" id="7531532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7531535">in</span>&nbsp;&nbsp;<span class="builtintype" id="7531539">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7531547">err</span>&nbsp;<span class="builtintype" id="7531551">string</span><br>
<span class="lineno"></span><span class="op" id="7531558">}</span><span class="op" id="7531559">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7531562">{</span><span class="string" id="7531563">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="7531575">,</span>&nbsp;<span class="string" id="7531577">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="7531608">}</span><span class="op" id="7531609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7531612">{</span><span class="string" id="7531613">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="7531648">,</span>&nbsp;<span class="string" id="7531650">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="7531681">}</span><span class="op" id="7531682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7531685">{</span><span class="string" id="7531686">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="7531706">,</span>&nbsp;<span class="string" id="7531708">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="7531739">}</span><span class="op" id="7531740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7531743">{</span><span class="string" id="7531744">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="7531803">,</span>&nbsp;<span class="string" id="7531805">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="7531836">}</span><span class="op" id="7531837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7531840">{</span><span class="string" id="7531841">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="7531899">,</span>&nbsp;<span class="string" id="7531901">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="7531937">}</span><span class="op" id="7531938">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7531941">{</span><span class="string" id="7531942">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="7531964">,</span>&nbsp;<span class="string" id="7531966">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="7532012">}</span><span class="op" id="7532013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532016">{</span><span class="string" id="7532017">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="7532036">,</span>&nbsp;<span class="string" id="7532038">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="7532081">}</span><span class="op" id="7532082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532085">{</span><span class="string" id="7532086">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="7532113">,</span>&nbsp;<span class="string" id="7532115">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="7532150">}</span><span class="op" id="7532151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532154">{</span><span class="string" id="7532155">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="7532175">,</span>&nbsp;<span class="string" id="7532177">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="7532211">}</span><span class="op" id="7532212">,</span><br>
<span class="lineno"></span><span class="op" id="7532214">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="7532217">func</span>&nbsp;<span class="ident" id="7532222">TestDisallowedCharacters</span><span class="op" id="7532246">(</span><span class="ident" id="7532247">t</span>&nbsp;<span class="op" id="7532249">*</span><span class="ident" id="7532250">testing</span><span class="op" id="7532257">.</span><span class="ident" id="7532258">T</span><span class="op" id="7532259">)</span>&nbsp;<span class="op" id="7532261">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532265">for</span>&nbsp;<span class="ident" id="7532269">i</span><span class="op" id="7532270">,</span>&nbsp;<span class="ident" id="7532272">tt</span>&nbsp;<span class="op" id="7532275">:=</span>&nbsp;<span class="keyword" id="7532278">range</span>&nbsp;<span class="ident" id="7532284">characterTests</span>&nbsp;<span class="op" id="7532299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532303">d</span>&nbsp;<span class="op" id="7532305">:=</span>&nbsp;<span class="ident" id="7532308">NewDecoder</span><span class="op" id="7532318">(</span><span class="ident" id="7532319">strings</span><span class="op" id="7532326">.</span><span class="ident" id="7532327">NewReader</span><span class="op" id="7532336">(</span><span class="ident" id="7532337">tt</span><span class="op" id="7532339">.</span><span class="ident" id="7532340">in</span><span class="op" id="7532342">)</span><span class="op" id="7532343">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532347">var</span>&nbsp;<span class="ident" id="7532351">err</span>&nbsp;<span class="builtintype" id="7532355">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532364">for</span>&nbsp;<span class="ident" id="7532368">err</span>&nbsp;<span class="op" id="7532372">==</span>&nbsp;<span class="ident" id="7532375">nil</span>&nbsp;<span class="op" id="7532379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532384">_</span><span class="op" id="7532385">,</span>&nbsp;<span class="ident" id="7532387">err</span>&nbsp;<span class="op" id="7532391">=</span>&nbsp;<span class="ident" id="7532393">d</span><span class="op" id="7532394">.</span><span class="ident" id="7532395">Token</span><span class="op" id="7532400">(</span><span class="op" id="7532401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532405">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532409">synerr</span><span class="op" id="7532415">,</span>&nbsp;<span class="ident" id="7532417">ok</span>&nbsp;<span class="op" id="7532420">:=</span>&nbsp;<span class="ident" id="7532423">err</span><span class="op" id="7532426">.</span><span class="op" id="7532427">(</span><span class="op" id="7532428">*</span><span class="ident" id="7532429">SyntaxError</span><span class="op" id="7532440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532444">if</span>&nbsp;<span class="op" id="7532447">!</span><span class="ident" id="7532448">ok</span>&nbsp;<span class="op" id="7532451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532456">t</span><span class="op" id="7532457">.</span><span class="ident" id="7532458">Fatalf</span><span class="op" id="7532464">(</span><span class="string" id="7532465">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="7532515">,</span>&nbsp;<span class="ident" id="7532517">i</span><span class="op" id="7532518">,</span>&nbsp;<span class="ident" id="7532520">err</span><span class="op" id="7532523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532531">if</span>&nbsp;<span class="ident" id="7532534">synerr</span><span class="op" id="7532540">.</span><span class="ident" id="7532541">Msg</span>&nbsp;<span class="op" id="7532545">!=</span>&nbsp;<span class="ident" id="7532548">tt</span><span class="op" id="7532550">.</span><span class="ident" id="7532551">err</span>&nbsp;<span class="op" id="7532555">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532560">t</span><span class="op" id="7532561">.</span><span class="ident" id="7532562">Fatalf</span><span class="op" id="7532568">(</span><span class="string" id="7532569">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7532613">,</span>&nbsp;<span class="ident" id="7532615">i</span><span class="op" id="7532616">,</span>&nbsp;<span class="ident" id="7532618">tt</span><span class="op" id="7532620">.</span><span class="ident" id="7532621">err</span><span class="op" id="7532624">,</span>&nbsp;<span class="ident" id="7532626">synerr</span><span class="op" id="7532632">.</span><span class="ident" id="7532633">Msg</span><span class="op" id="7532636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532643">}</span><br>
<span class="lineno"></span><span class="op" id="7532645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="7532648">type</span>&nbsp;<span class="ident" id="7532653">procInstEncodingTest</span>&nbsp;<span class="keyword" id="7532674">struct</span>&nbsp;<span class="op" id="7532681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532684">expect</span><span class="op" id="7532690">,</span>&nbsp;<span class="ident" id="7532692">got</span>&nbsp;<span class="builtintype" id="7532696">string</span><br>
<span class="lineno"></span><span class="op" id="7532703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7532706">var</span>&nbsp;<span class="ident" id="7532710">procInstTests</span>&nbsp;<span class="op" id="7532724">=</span>&nbsp;<span class="op" id="7532726">[</span><span class="op" id="7532727">]</span><span class="keyword" id="7532728">struct</span>&nbsp;<span class="op" id="7532735">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532738">input</span><span class="op" id="7532743">,</span>&nbsp;<span class="ident" id="7532745">expect</span>&nbsp;<span class="builtintype" id="7532752">string</span><br>
<span class="lineno"></span><span class="op" id="7532759">}</span><span class="op" id="7532760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532763">{</span><span class="string" id="7532764">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="7532796">,</span>&nbsp;<span class="string" id="7532798">&#34;utf-8&#34;</span><span class="op" id="7532805">}</span><span class="op" id="7532806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532809">{</span><span class="string" id="7532810">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="7532842">,</span>&nbsp;<span class="string" id="7532844">&#34;utf-8&#34;</span><span class="op" id="7532851">}</span><span class="op" id="7532852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532855">{</span><span class="string" id="7532856">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="7532889">,</span>&nbsp;<span class="string" id="7532891">&#34;utf-8&#34;</span><span class="op" id="7532898">}</span><span class="op" id="7532899">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532902">{</span><span class="string" id="7532903">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="7532933">,</span>&nbsp;<span class="string" id="7532935">&#34;&#34;</span><span class="op" id="7532937">}</span><span class="op" id="7532938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532941">{</span><span class="string" id="7532942">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="7532959">,</span>&nbsp;<span class="string" id="7532961">&#34;FOO&#34;</span><span class="op" id="7532966">}</span><span class="op" id="7532967">,</span><br>
<span class="lineno"></span><span class="op" id="7532969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7532972">func</span>&nbsp;<span class="ident" id="7532977">TestProcInstEncoding</span><span class="op" id="7532997">(</span><span class="ident" id="7532998">t</span>&nbsp;<span class="op" id="7533000">*</span><span class="ident" id="7533001">testing</span><span class="op" id="7533008">.</span><span class="ident" id="7533009">T</span><span class="op" id="7533010">)</span>&nbsp;<span class="op" id="7533012">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7533015">for</span>&nbsp;<span class="ident" id="7533019">_</span><span class="op" id="7533020">,</span>&nbsp;<span class="ident" id="7533022">test</span>&nbsp;<span class="op" id="7533027">:=</span>&nbsp;<span class="keyword" id="7533030">range</span>&nbsp;<span class="ident" id="7533036">procInstTests</span>&nbsp;<span class="op" id="7533050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533054">got</span>&nbsp;<span class="op" id="7533058">:=</span>&nbsp;<span class="ident" id="7533061">procInstEncoding</span><span class="op" id="7533077">(</span><span class="ident" id="7533078">test</span><span class="op" id="7533082">.</span><span class="ident" id="7533083">input</span><span class="op" id="7533088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7533092">if</span>&nbsp;<span class="ident" id="7533095">got</span>&nbsp;<span class="op" id="7533099">!=</span>&nbsp;<span class="ident" id="7533102">test</span><span class="op" id="7533106">.</span><span class="ident" id="7533107">expect</span>&nbsp;<span class="op" id="7533114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533119">t</span><span class="op" id="7533120">.</span><span class="ident" id="7533121">Errorf</span><span class="op" id="7533127">(</span><span class="string" id="7533128">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7533164">,</span>&nbsp;<span class="ident" id="7533166">test</span><span class="op" id="7533170">.</span><span class="ident" id="7533171">input</span><span class="op" id="7533176">,</span>&nbsp;<span class="ident" id="7533178">got</span><span class="op" id="7533181">,</span>&nbsp;<span class="ident" id="7533183">test</span><span class="op" id="7533187">.</span><span class="ident" id="7533188">expect</span><span class="op" id="7533194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7533198">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7533201">}</span><br>
<span class="lineno"></span><span class="op" id="7533203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7533206">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="7533267">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7533302">var</span>&nbsp;<span class="ident" id="7533306">directivesWithCommentsInput</span>&nbsp;<span class="op" id="7533334">=</span>&nbsp;<span class="string" id="7533336">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7533572">var</span>&nbsp;<span class="ident" id="7533576">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="7533605">=</span>&nbsp;<span class="op" id="7533607">[</span><span class="op" id="7533608">]</span><span class="ident" id="7533609">Token</span><span class="op" id="7533614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533617">CharData</span><span class="op" id="7533625">(</span><span class="string" id="7533626">&#34;\n&#34;</span><span class="op" id="7533630">)</span><span class="op" id="7533631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533634">Directive</span><span class="op" id="7533643">(</span><span class="string" id="7533644">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="7533715">)</span><span class="op" id="7533716">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533719">CharData</span><span class="op" id="7533727">(</span><span class="string" id="7533728">&#34;\n&#34;</span><span class="op" id="7533732">)</span><span class="op" id="7533733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533736">Directive</span><span class="op" id="7533745">(</span><span class="string" id="7533746">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="7533779">)</span><span class="op" id="7533780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533783">CharData</span><span class="op" id="7533791">(</span><span class="string" id="7533792">&#34;\n&#34;</span><span class="op" id="7533796">)</span><span class="op" id="7533797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533800">Directive</span><span class="op" id="7533809">(</span><span class="string" id="7533810">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="7533855">)</span><span class="op" id="7533856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533859">CharData</span><span class="op" id="7533867">(</span><span class="string" id="7533868">&#34;\n&#34;</span><span class="op" id="7533872">)</span><span class="op" id="7533873">,</span><br>
<span class="lineno">695</span><span class="op" id="7533875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7533878">func</span>&nbsp;<span class="ident" id="7533883">TestDirectivesWithComments</span><span class="op" id="7533909">(</span><span class="ident" id="7533910">t</span>&nbsp;<span class="op" id="7533912">*</span><span class="ident" id="7533913">testing</span><span class="op" id="7533920">.</span><span class="ident" id="7533921">T</span><span class="op" id="7533922">)</span>&nbsp;<span class="op" id="7533924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533927">d</span>&nbsp;<span class="op" id="7533929">:=</span>&nbsp;<span class="ident" id="7533932">NewDecoder</span><span class="op" id="7533942">(</span><span class="ident" id="7533943">strings</span><span class="op" id="7533950">.</span><span class="ident" id="7533951">NewReader</span><span class="op" id="7533960">(</span><span class="ident" id="7533961">directivesWithCommentsInput</span><span class="op" id="7533988">)</span><span class="op" id="7533989">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7533993">for</span>&nbsp;<span class="ident" id="7533997">i</span><span class="op" id="7533998">,</span>&nbsp;<span class="ident" id="7534000">want</span>&nbsp;<span class="op" id="7534005">:=</span>&nbsp;<span class="keyword" id="7534008">range</span>&nbsp;<span class="ident" id="7534014">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="7534043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534047">have</span><span class="op" id="7534051">,</span>&nbsp;<span class="ident" id="7534053">err</span>&nbsp;<span class="op" id="7534057">:=</span>&nbsp;<span class="ident" id="7534060">d</span><span class="op" id="7534061">.</span><span class="ident" id="7534062">Token</span><span class="op" id="7534067">(</span><span class="op" id="7534068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7534072">if</span>&nbsp;<span class="ident" id="7534075">err</span>&nbsp;<span class="op" id="7534079">!=</span>&nbsp;<span class="ident" id="7534082">nil</span>&nbsp;<span class="op" id="7534086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534091">t</span><span class="op" id="7534092">.</span><span class="ident" id="7534093">Fatalf</span><span class="op" id="7534099">(</span><span class="string" id="7534100">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7534132">,</span>&nbsp;<span class="ident" id="7534134">i</span><span class="op" id="7534135">,</span>&nbsp;<span class="ident" id="7534137">err</span><span class="op" id="7534140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7534144">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7534148">if</span>&nbsp;<span class="op" id="7534151">!</span><span class="ident" id="7534152">reflect</span><span class="op" id="7534159">.</span><span class="ident" id="7534160">DeepEqual</span><span class="op" id="7534169">(</span><span class="ident" id="7534170">have</span><span class="op" id="7534174">,</span>&nbsp;<span class="ident" id="7534176">want</span><span class="op" id="7534180">)</span>&nbsp;<span class="op" id="7534182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534187">t</span><span class="op" id="7534188">.</span><span class="ident" id="7534189">Errorf</span><span class="op" id="7534195">(</span><span class="string" id="7534196">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7534221">,</span>&nbsp;<span class="ident" id="7534223">i</span><span class="op" id="7534224">,</span>&nbsp;<span class="ident" id="7534226">have</span><span class="op" id="7534230">,</span>&nbsp;<span class="ident" id="7534232">want</span><span class="op" id="7534236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7534240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7534243">}</span><br>
<span class="lineno"></span><span class="op" id="7534245">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="7534248">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="7534302">type</span>&nbsp;<span class="ident" id="7534307">errWriter</span>&nbsp;<span class="keyword" id="7534317">struct</span><span class="op" id="7534323">{</span><span class="op" id="7534324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7534327">func</span>&nbsp;<span class="op" id="7534332">(</span><span class="ident" id="7534333">errWriter</span><span class="op" id="7534342">)</span>&nbsp;<span class="ident" id="7534344">Write</span><span class="op" id="7534349">(</span><span class="ident" id="7534350">p</span>&nbsp;<span class="op" id="7534352">[</span><span class="op" id="7534353">]</span><span class="builtintype" id="7534354">byte</span><span class="op" id="7534358">)</span>&nbsp;<span class="op" id="7534360">(</span><span class="ident" id="7534361">n</span>&nbsp;<span class="builtintype" id="7534363">int</span><span class="op" id="7534366">,</span>&nbsp;<span class="ident" id="7534368">err</span>&nbsp;<span class="builtintype" id="7534372">error</span><span class="op" id="7534377">)</span>&nbsp;<span class="op" id="7534379">{</span>&nbsp;<span class="keyword" id="7534381">return</span>&nbsp;<span class="num" id="7534388">0</span><span class="op" id="7534389">,</span>&nbsp;<span class="ident" id="7534391">fmt</span><span class="op" id="7534394">.</span><span class="ident" id="7534395">Errorf</span><span class="op" id="7534401">(</span><span class="string" id="7534402">&#34;unwritable&#34;</span><span class="op" id="7534414">)</span>&nbsp;<span class="op" id="7534416">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="7534419">func</span>&nbsp;<span class="ident" id="7534424">TestEscapeTextIOErrors</span><span class="op" id="7534446">(</span><span class="ident" id="7534447">t</span>&nbsp;<span class="op" id="7534449">*</span><span class="ident" id="7534450">testing</span><span class="op" id="7534457">.</span><span class="ident" id="7534458">T</span><span class="op" id="7534459">)</span>&nbsp;<span class="op" id="7534461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534464">expectErr</span>&nbsp;<span class="op" id="7534474">:=</span>&nbsp;<span class="string" id="7534477">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534491">err</span>&nbsp;<span class="op" id="7534495">:=</span>&nbsp;<span class="ident" id="7534498">EscapeText</span><span class="op" id="7534508">(</span><span class="ident" id="7534509">errWriter</span><span class="op" id="7534518">{</span><span class="op" id="7534519">}</span><span class="op" id="7534520">,</span>&nbsp;<span class="op" id="7534522">[</span><span class="op" id="7534523">]</span><span class="builtintype" id="7534524">byte</span><span class="op" id="7534528">{</span><span class="string" id="7534529">&#39;A&#39;</span><span class="op" id="7534532">}</span><span class="op" id="7534533">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7534537">if</span>&nbsp;<span class="ident" id="7534540">err</span>&nbsp;<span class="op" id="7534544">==</span>&nbsp;<span class="ident" id="7534547">nil</span>&nbsp;<span class="op" id="7534551">||</span>&nbsp;<span class="ident" id="7534554">err</span><span class="op" id="7534557">.</span><span class="ident" id="7534558">Error</span><span class="op" id="7534563">(</span><span class="op" id="7534564">)</span>&nbsp;<span class="op" id="7534566">!=</span>&nbsp;<span class="ident" id="7534569">expectErr</span>&nbsp;<span class="op" id="7534579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534583">t</span><span class="op" id="7534584">.</span><span class="ident" id="7534585">Errorf</span><span class="op" id="7534591">(</span><span class="string" id="7534592">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7534610">,</span>&nbsp;<span class="ident" id="7534612">err</span><span class="op" id="7534615">,</span>&nbsp;<span class="ident" id="7534617">expectErr</span><span class="op" id="7534626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7534629">}</span><br>
<span class="lineno"></span><span class="op" id="7534631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="7534634">func</span>&nbsp;<span class="ident" id="7534639">TestEscapeTextInvalidChar</span><span class="op" id="7534664">(</span><span class="ident" id="7534665">t</span>&nbsp;<span class="op" id="7534667">*</span><span class="ident" id="7534668">testing</span><span class="op" id="7534675">.</span><span class="ident" id="7534676">T</span><span class="op" id="7534677">)</span>&nbsp;<span class="op" id="7534679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534682">input</span>&nbsp;<span class="op" id="7534688">:=</span>&nbsp;<span class="op" id="7534691">[</span><span class="op" id="7534692">]</span><span class="builtintype" id="7534693">byte</span><span class="op" id="7534697">(</span><span class="string" id="7534698">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="7534725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534728">expected</span>&nbsp;<span class="op" id="7534737">:=</span>&nbsp;<span class="string" id="7534740">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534772">buff</span>&nbsp;<span class="op" id="7534777">:=</span>&nbsp;<span class="builtinfunc" id="7534780">new</span><span class="op" id="7534783">(</span><span class="ident" id="7534784">bytes</span><span class="op" id="7534789">.</span><span class="ident" id="7534790">Buffer</span><span class="op" id="7534796">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7534799">if</span>&nbsp;<span class="ident" id="7534802">err</span>&nbsp;<span class="op" id="7534806">:=</span>&nbsp;<span class="ident" id="7534809">EscapeText</span><span class="op" id="7534819">(</span><span class="ident" id="7534820">buff</span><span class="op" id="7534824">,</span>&nbsp;<span class="ident" id="7534826">input</span><span class="op" id="7534831">)</span><span class="op" id="7534832">;</span>&nbsp;<span class="ident" id="7534834">err</span>&nbsp;<span class="op" id="7534838">!=</span>&nbsp;<span class="ident" id="7534841">nil</span>&nbsp;<span class="op" id="7534845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534849">t</span><span class="op" id="7534850">.</span><span class="ident" id="7534851">Fatalf</span><span class="op" id="7534857">(</span><span class="string" id="7534858">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="7534877">,</span>&nbsp;<span class="ident" id="7534879">err</span><span class="op" id="7534882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7534885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534888">text</span>&nbsp;<span class="op" id="7534893">:=</span>&nbsp;<span class="ident" id="7534896">buff</span><span class="op" id="7534900">.</span><span class="ident" id="7534901">String</span><span class="op" id="7534907">(</span><span class="op" id="7534908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7534912">if</span>&nbsp;<span class="ident" id="7534915">text</span>&nbsp;<span class="op" id="7534920">!=</span>&nbsp;<span class="ident" id="7534923">expected</span>&nbsp;<span class="op" id="7534932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534936">t</span><span class="op" id="7534937">.</span><span class="ident" id="7534938">Errorf</span><span class="op" id="7534944">(</span><span class="string" id="7534945">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7534963">,</span>&nbsp;<span class="ident" id="7534965">text</span><span class="op" id="7534969">,</span>&nbsp;<span class="ident" id="7534971">expected</span><span class="op" id="7534979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7534982">}</span><br>
<span class="lineno"></span><span class="op" id="7534984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="7534987">func</span>&nbsp;<span class="ident" id="7534992">TestIssue5880</span><span class="op" id="7535005">(</span><span class="ident" id="7535006">t</span>&nbsp;<span class="op" id="7535008">*</span><span class="ident" id="7535009">testing</span><span class="op" id="7535016">.</span><span class="ident" id="7535017">T</span><span class="op" id="7535018">)</span>&nbsp;<span class="op" id="7535020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535023">type</span>&nbsp;<span class="ident" id="7535028">T</span>&nbsp;<span class="op" id="7535030">[</span><span class="op" id="7535031">]</span><span class="builtintype" id="7535032">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535038">data</span><span class="op" id="7535042">,</span>&nbsp;<span class="ident" id="7535044">err</span>&nbsp;<span class="op" id="7535048">:=</span>&nbsp;<span class="ident" id="7535051">Marshal</span><span class="op" id="7535058">(</span><span class="ident" id="7535059">T</span><span class="op" id="7535060">{</span><span class="num" id="7535061">192</span><span class="op" id="7535064">,</span>&nbsp;<span class="num" id="7535066">168</span><span class="op" id="7535069">,</span>&nbsp;<span class="num" id="7535071">0</span><span class="op" id="7535072">,</span>&nbsp;<span class="num" id="7535074">1</span><span class="op" id="7535075">}</span><span class="op" id="7535076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535079">if</span>&nbsp;<span class="ident" id="7535082">err</span>&nbsp;<span class="op" id="7535086">!=</span>&nbsp;<span class="ident" id="7535089">nil</span>&nbsp;<span class="op" id="7535093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535097">t</span><span class="op" id="7535098">.</span><span class="ident" id="7535099">Errorf</span><span class="op" id="7535105">(</span><span class="string" id="7535106">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7535125">,</span>&nbsp;<span class="ident" id="7535127">err</span><span class="op" id="7535130">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535136">if</span>&nbsp;<span class="op" id="7535139">!</span><span class="ident" id="7535140">utf8</span><span class="op" id="7535144">.</span><span class="ident" id="7535145">Valid</span><span class="op" id="7535150">(</span><span class="ident" id="7535151">data</span><span class="op" id="7535155">)</span>&nbsp;<span class="op" id="7535157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535161">t</span><span class="op" id="7535162">.</span><span class="ident" id="7535163">Errorf</span><span class="op" id="7535169">(</span><span class="string" id="7535170">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="7535207">,</span>&nbsp;<span class="ident" id="7535209">data</span><span class="op" id="7535213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535216">}</span><br>
<span class="lineno"></span><span class="op" id="7535218">}</span>
</div>
</body>
</html>
