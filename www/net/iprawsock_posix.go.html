<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2620200">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2620256">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2620310">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2620361">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2620439">package</span>&nbsp;<span class="ident" id="2620447">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2620452">import</span>&nbsp;<span class="op" id="2620459">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2620462">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2620473">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="2620480">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2620483">//&nbsp;BUG(mikio):&nbsp;On&nbsp;every&nbsp;POSIX&nbsp;platform,&nbsp;reads&nbsp;from&nbsp;the&nbsp;&#34;ip4&#34;&nbsp;network</span><br>
<span class="lineno">15</span><span class="comment" id="2620552">//&nbsp;using&nbsp;the&nbsp;ReadFrom&nbsp;or&nbsp;ReadFromIP&nbsp;method&nbsp;might&nbsp;not&nbsp;return&nbsp;a&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="2620623">//&nbsp;IPv4&nbsp;packet,&nbsp;including&nbsp;its&nbsp;header,&nbsp;even&nbsp;if&nbsp;there&nbsp;is&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="2620684">//&nbsp;available.&nbsp;This&nbsp;can&nbsp;occur&nbsp;even&nbsp;in&nbsp;cases&nbsp;where&nbsp;Read&nbsp;or&nbsp;ReadMsgIP</span><br>
<span class="lineno"></span><span class="comment" id="2620751">//&nbsp;could&nbsp;return&nbsp;a&nbsp;complete&nbsp;packet.&nbsp;For&nbsp;this&nbsp;reason,&nbsp;it&nbsp;is&nbsp;recommended</span><br>
<span class="lineno"></span><span class="comment" id="2620821">//&nbsp;that&nbsp;you&nbsp;do&nbsp;not&nbsp;uses&nbsp;these&nbsp;methods&nbsp;if&nbsp;it&nbsp;is&nbsp;important&nbsp;to&nbsp;receive&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="2620891">//&nbsp;full&nbsp;packet.</span><br>
<span class="lineno"></span><span class="comment" id="2620907">//</span><br>
<span class="lineno"></span><span class="comment" id="2620910">//&nbsp;The&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines&nbsp;make&nbsp;it&nbsp;impossible&nbsp;for&nbsp;us&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2620976">//&nbsp;change&nbsp;the&nbsp;behavior&nbsp;of&nbsp;these&nbsp;methods;&nbsp;use&nbsp;Read&nbsp;or&nbsp;ReadMsgIP</span><br>
<span class="lineno"></span><span class="comment" id="2621039">//&nbsp;instead.</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="2621052">func</span>&nbsp;<span class="ident" id="2621057">sockaddrToIP</span><span class="op" id="2621069">(</span><span class="ident" id="2621070">sa</span>&nbsp;<span class="ident" id="2621073"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2621080">.</span><span class="ident" id="2621081">Sockaddr</span><span class="op" id="2621089">)</span>&nbsp;<span class="ident" id="2621091"><a href="/net/net.go.html#2652238">Addr</a></span>&nbsp;<span class="op" id="2621096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621099">switch</span>&nbsp;<span class="ident" id="2621106">sa</span>&nbsp;<span class="op" id="2621109">:=</span>&nbsp;<span class="ident" id="2621112"><a href="/net/iprawsock_posix.go.html#2621070">sa</a></span><span class="op" id="2621114">.</span><span class="op" id="2621115">(</span><span class="keyword" id="2621116">type</span><span class="op" id="2621120">)</span>&nbsp;<span class="op" id="2621122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621125">case</span>&nbsp;<span class="op" id="2621130">*</span><span class="ident" id="2621131"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2621138">.</span><span class="ident" id="2621139">SockaddrInet4</span><span class="op" id="2621152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621156">return</span>&nbsp;<span class="op" id="2621163">&amp;</span><span class="ident" id="2621164"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2621170">{</span><span class="ident" id="2621171">IP</span><span class="op" id="2621173">:</span>&nbsp;<span class="ident" id="2621175"><a href="/net/iprawsock_posix.go.html#2621106">sa</a></span><span class="op" id="2621177">.</span><span class="ident" id="2621178">Addr</span><span class="op" id="2621182">[</span><span class="num" id="2621183">0</span><span class="op" id="2621184">:</span><span class="op" id="2621185">]</span><span class="op" id="2621186">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621189">case</span>&nbsp;<span class="op" id="2621194">*</span><span class="ident" id="2621195"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2621202">.</span><span class="ident" id="2621203">SockaddrInet6</span><span class="op" id="2621216">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621220">return</span>&nbsp;<span class="op" id="2621227">&amp;</span><span class="ident" id="2621228"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2621234">{</span><span class="ident" id="2621235">IP</span><span class="op" id="2621237">:</span>&nbsp;<span class="ident" id="2621239"><a href="/net/iprawsock_posix.go.html#2621106">sa</a></span><span class="op" id="2621241">.</span><span class="ident" id="2621242">Addr</span><span class="op" id="2621246">[</span><span class="num" id="2621247">0</span><span class="op" id="2621248">:</span><span class="op" id="2621249">]</span><span class="op" id="2621250">,</span>&nbsp;<span class="ident" id="2621252">Zone</span><span class="op" id="2621256">:</span>&nbsp;<span class="ident" id="2621258"><a href="/net/ipsock.go.html#2635208">zoneToString</a></span><span class="op" id="2621270">(</span><span class="builtintype" id="2621271">int</span><span class="op" id="2621274">(</span><span class="ident" id="2621275"><a href="/net/iprawsock_posix.go.html#2621106">sa</a></span><span class="op" id="2621277">.</span><span class="ident" id="2621278">ZoneId</span><span class="op" id="2621284">)</span><span class="op" id="2621285">)</span><span class="op" id="2621286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621292">return</span>&nbsp;<span class="ident" id="2621299">nil</span><br>
<span class="lineno"></span><span class="op" id="2621303">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="2621306">func</span>&nbsp;<span class="op" id="2621311">(</span><span class="ident" id="2621312">a</span>&nbsp;<span class="op" id="2621314">*</span><span class="ident" id="2621315"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2621321">)</span>&nbsp;<span class="ident" id="2621323">family</span><span class="op" id="2621329">(</span><span class="op" id="2621330">)</span>&nbsp;<span class="builtintype" id="2621332">int</span>&nbsp;<span class="op" id="2621336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621339">if</span>&nbsp;<span class="ident" id="2621342"><a href="/net/iprawsock_posix.go.html#2621312">a</a></span>&nbsp;<span class="op" id="2621344">==</span>&nbsp;<span class="ident" id="2621347">nil</span>&nbsp;<span class="op" id="2621351">||</span>&nbsp;<span class="builtinfunc" id="2621354">len</span><span class="op" id="2621357">(</span><span class="ident" id="2621358"><a href="/net/iprawsock_posix.go.html#2621312">a</a></span><span class="op" id="2621359">.</span><span class="ident" id="2621360">IP</span><span class="op" id="2621362">)</span>&nbsp;<span class="op" id="2621364">&lt;=</span>&nbsp;<span class="ident" id="2621367"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2621375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621379">return</span>&nbsp;<span class="ident" id="2621386"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2621393">.</span><span class="ident" id="2621394">AF_INET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621403">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621406">if</span>&nbsp;<span class="ident" id="2621409"><a href="/net/iprawsock_posix.go.html#2621312">a</a></span><span class="op" id="2621410">.</span><span class="ident" id="2621411">IP</span><span class="op" id="2621413">.</span><span class="ident" id="2621414">To4</span><span class="op" id="2621417">(</span><span class="op" id="2621418">)</span>&nbsp;<span class="op" id="2621420">!=</span>&nbsp;<span class="ident" id="2621423">nil</span>&nbsp;<span class="op" id="2621427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621431">return</span>&nbsp;<span class="ident" id="2621438"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2621445">.</span><span class="ident" id="2621446">AF_INET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621458">return</span>&nbsp;<span class="ident" id="2621465"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2621472">.</span><span class="ident" id="2621473">AF_INET6</span><br>
<span class="lineno"></span><span class="op" id="2621482">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="2621485">func</span>&nbsp;<span class="op" id="2621490">(</span><span class="ident" id="2621491">a</span>&nbsp;<span class="op" id="2621493">*</span><span class="ident" id="2621494"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2621500">)</span>&nbsp;<span class="ident" id="2621502">isWildcard</span><span class="op" id="2621512">(</span><span class="op" id="2621513">)</span>&nbsp;<span class="builtintype" id="2621515">bool</span>&nbsp;<span class="op" id="2621520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621523">if</span>&nbsp;<span class="ident" id="2621526"><a href="/net/iprawsock_posix.go.html#2621491">a</a></span>&nbsp;<span class="op" id="2621528">==</span>&nbsp;<span class="ident" id="2621531">nil</span>&nbsp;<span class="op" id="2621535">||</span>&nbsp;<span class="ident" id="2621538"><a href="/net/iprawsock_posix.go.html#2621491">a</a></span><span class="op" id="2621539">.</span><span class="ident" id="2621540">IP</span>&nbsp;<span class="op" id="2621543">==</span>&nbsp;<span class="ident" id="2621546">nil</span>&nbsp;<span class="op" id="2621550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621554">return</span>&nbsp;<span class="ident" id="2621561">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621567">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621570">return</span>&nbsp;<span class="ident" id="2621577"><a href="/net/iprawsock_posix.go.html#2621491">a</a></span><span class="op" id="2621578">.</span><span class="ident" id="2621579">IP</span><span class="op" id="2621581">.</span><span class="ident" id="2621582">IsUnspecified</span><span class="op" id="2621595">(</span><span class="op" id="2621596">)</span><br>
<span class="lineno"></span><span class="op" id="2621598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2621601">func</span>&nbsp;<span class="op" id="2621606">(</span><span class="ident" id="2621607">a</span>&nbsp;<span class="op" id="2621609">*</span><span class="ident" id="2621610"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2621616">)</span>&nbsp;<span class="ident" id="2621618">sockaddr</span><span class="op" id="2621626">(</span><span class="ident" id="2621627">family</span>&nbsp;<span class="builtintype" id="2621634">int</span><span class="op" id="2621637">)</span>&nbsp;<span class="op" id="2621639">(</span><span class="ident" id="2621640"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2621647">.</span><span class="ident" id="2621648">Sockaddr</span><span class="op" id="2621656">,</span>&nbsp;<span class="builtintype" id="2621658">error</span><span class="op" id="2621663">)</span>&nbsp;<span class="op" id="2621665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621668">if</span>&nbsp;<span class="ident" id="2621671"><a href="/net/iprawsock_posix.go.html#2621607">a</a></span>&nbsp;<span class="op" id="2621673">==</span>&nbsp;<span class="ident" id="2621676">nil</span>&nbsp;<span class="op" id="2621680">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621684">return</span>&nbsp;<span class="ident" id="2621691">nil</span><span class="op" id="2621694">,</span>&nbsp;<span class="ident" id="2621696">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621704">return</span>&nbsp;<span class="ident" id="2621711"><a href="/net/ipsock_posix.go.html#2640171">ipToSockaddr</a></span><span class="op" id="2621723">(</span><span class="ident" id="2621724"><a href="/net/iprawsock_posix.go.html#2621627">family</a></span><span class="op" id="2621730">,</span>&nbsp;<span class="ident" id="2621732"><a href="/net/iprawsock_posix.go.html#2621607">a</a></span><span class="op" id="2621733">.</span><span class="ident" id="2621734">IP</span><span class="op" id="2621736">,</span>&nbsp;<span class="num" id="2621738">0</span><span class="op" id="2621739">,</span>&nbsp;<span class="ident" id="2621741"><a href="/net/iprawsock_posix.go.html#2621607">a</a></span><span class="op" id="2621742">.</span><span class="ident" id="2621743">Zone</span><span class="op" id="2621747">)</span><br>
<span class="lineno"></span><span class="op" id="2621749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="2621752">//&nbsp;IPConn&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;and&nbsp;PacketConn&nbsp;interfaces</span><br>
<span class="lineno"></span><span class="comment" id="2621822">//&nbsp;for&nbsp;IP&nbsp;network&nbsp;connections.</span><br>
<span class="lineno"></span><span class="keyword" id="2621853">type</span>&nbsp;<span class="ident" id="2621858">IPConn</span>&nbsp;<span class="keyword" id="2621865">struct</span>&nbsp;<span class="op" id="2621872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621875"><a href="/net/net.go.html#2654243">conn</a></span><br>
<span class="lineno"></span><span class="op" id="2621880">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2621883">func</span>&nbsp;<span class="ident" id="2621888">newIPConn</span><span class="op" id="2621897">(</span><span class="ident" id="2621898">fd</span>&nbsp;<span class="op" id="2621901">*</span><span class="ident" id="2621902"><a href="/net/fd_unix.go.html#2575420">netFD</a></span><span class="op" id="2621907">)</span>&nbsp;<span class="op" id="2621909">*</span><span class="ident" id="2621910"><a href="/net/iprawsock_posix.go.html#2621858">IPConn</a></span>&nbsp;<span class="op" id="2621917">{</span>&nbsp;<span class="keyword" id="2621919">return</span>&nbsp;<span class="op" id="2621926">&amp;</span><span class="ident" id="2621927"><a href="/net/iprawsock_posix.go.html#2621858">IPConn</a></span><span class="op" id="2621933">{</span><span class="ident" id="2621934"><a href="/net/net.go.html#2654243">conn</a></span><span class="op" id="2621938">{</span><span class="ident" id="2621939"><a href="/net/iprawsock_posix.go.html#2621898">fd</a></span><span class="op" id="2621941">}</span><span class="op" id="2621942">}</span>&nbsp;<span class="op" id="2621944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2621947">//&nbsp;ReadFromIP&nbsp;reads&nbsp;an&nbsp;IP&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="2622016">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address</span><br>
<span class="lineno">70</span><span class="comment" id="2622087">//&nbsp;that&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span><span class="comment" id="2622114">//</span><br>
<span class="lineno"></span><span class="comment" id="2622117">//&nbsp;ReadFromIP&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2622180">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2622247">//&nbsp;SetReadDeadline.</span><br>
<span class="lineno">75</span><span class="keyword" id="2622267">func</span>&nbsp;<span class="op" id="2622272">(</span><span class="ident" id="2622273">c</span>&nbsp;<span class="op" id="2622275">*</span><span class="ident" id="2622276"><a href="/net/iprawsock_posix.go.html#2621858">IPConn</a></span><span class="op" id="2622282">)</span>&nbsp;<span class="ident" id="2622284">ReadFromIP</span><span class="op" id="2622294">(</span><span class="ident" id="2622295">b</span>&nbsp;<span class="op" id="2622297">[</span><span class="op" id="2622298">]</span><span class="builtintype" id="2622299">byte</span><span class="op" id="2622303">)</span>&nbsp;<span class="op" id="2622305">(</span><span class="builtintype" id="2622306">int</span><span class="op" id="2622309">,</span>&nbsp;<span class="op" id="2622311">*</span><span class="ident" id="2622312"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2622318">,</span>&nbsp;<span class="builtintype" id="2622320">error</span><span class="op" id="2622325">)</span>&nbsp;<span class="op" id="2622327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622330">if</span>&nbsp;<span class="op" id="2622333">!</span><span class="ident" id="2622334"><a href="/net/iprawsock_posix.go.html#2622273">c</a></span><span class="op" id="2622335">.</span><span class="ident" id="2622336">ok</span><span class="op" id="2622338">(</span><span class="op" id="2622339">)</span>&nbsp;<span class="op" id="2622341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622345">return</span>&nbsp;<span class="num" id="2622352">0</span><span class="op" id="2622353">,</span>&nbsp;<span class="ident" id="2622355">nil</span><span class="op" id="2622358">,</span>&nbsp;<span class="ident" id="2622360"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2622367">.</span><span class="ident" id="2622368">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2622376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2622379">//&nbsp;TODO(cw,rsc):&nbsp;consider&nbsp;using&nbsp;readv&nbsp;if&nbsp;we&nbsp;know&nbsp;the&nbsp;family</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2622440">//&nbsp;type&nbsp;to&nbsp;avoid&nbsp;the&nbsp;header&nbsp;trim/copy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622479">var</span>&nbsp;<span class="ident" id="2622483">addr</span>&nbsp;<span class="op" id="2622488">*</span><span class="ident" id="2622489"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622497">n</span><span class="op" id="2622498">,</span>&nbsp;<span class="ident" id="2622500">sa</span><span class="op" id="2622502">,</span>&nbsp;<span class="ident" id="2622504">err</span>&nbsp;<span class="op" id="2622508">:=</span>&nbsp;<span class="ident" id="2622511"><a href="/net/iprawsock_posix.go.html#2622273">c</a></span><span class="op" id="2622512">.</span><span class="ident" id="2622513">fd</span><span class="op" id="2622515">.</span><span class="ident" id="2622516">readFrom</span><span class="op" id="2622524">(</span><span class="ident" id="2622525"><a href="/net/iprawsock_posix.go.html#2622295">b</a></span><span class="op" id="2622526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622529">switch</span>&nbsp;<span class="ident" id="2622536">sa</span>&nbsp;<span class="op" id="2622539">:=</span>&nbsp;<span class="ident" id="2622542"><a href="/net/iprawsock_posix.go.html#2622500">sa</a></span><span class="op" id="2622544">.</span><span class="op" id="2622545">(</span><span class="keyword" id="2622546">type</span><span class="op" id="2622550">)</span>&nbsp;<span class="op" id="2622552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622555">case</span>&nbsp;<span class="op" id="2622560">*</span><span class="ident" id="2622561"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2622568">.</span><span class="ident" id="2622569">SockaddrInet4</span><span class="op" id="2622582">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622586"><a href="/net/iprawsock_posix.go.html#2622483">addr</a></span>&nbsp;<span class="op" id="2622591">=</span>&nbsp;<span class="op" id="2622593">&amp;</span><span class="ident" id="2622594"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2622600">{</span><span class="ident" id="2622601">IP</span><span class="op" id="2622603">:</span>&nbsp;<span class="ident" id="2622605"><a href="/net/iprawsock_posix.go.html#2622536">sa</a></span><span class="op" id="2622607">.</span><span class="ident" id="2622608">Addr</span><span class="op" id="2622612">[</span><span class="num" id="2622613">0</span><span class="op" id="2622614">:</span><span class="op" id="2622615">]</span><span class="op" id="2622616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622620">if</span>&nbsp;<span class="builtinfunc" id="2622623">len</span><span class="op" id="2622626">(</span><span class="ident" id="2622627"><a href="/net/iprawsock_posix.go.html#2622295">b</a></span><span class="op" id="2622628">)</span>&nbsp;<span class="op" id="2622630">&gt;=</span>&nbsp;<span class="ident" id="2622633"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2622641">{</span>&nbsp;<span class="comment" id="2622643">//&nbsp;discard&nbsp;ipv4&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622669">hsize</span>&nbsp;<span class="op" id="2622675">:=</span>&nbsp;<span class="op" id="2622678">(</span><span class="builtintype" id="2622679">int</span><span class="op" id="2622682">(</span><span class="ident" id="2622683"><a href="/net/iprawsock_posix.go.html#2622295">b</a></span><span class="op" id="2622684">[</span><span class="num" id="2622685">0</span><span class="op" id="2622686">]</span><span class="op" id="2622687">)</span>&nbsp;<span class="op" id="2622689">&amp;</span>&nbsp;<span class="num" id="2622691">0xf</span><span class="op" id="2622694">)</span>&nbsp;<span class="op" id="2622696">*</span>&nbsp;<span class="num" id="2622698">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2622703">copy</span><span class="op" id="2622707">(</span><span class="ident" id="2622708"><a href="/net/iprawsock_posix.go.html#2622295">b</a></span><span class="op" id="2622709">,</span>&nbsp;<span class="ident" id="2622711"><a href="/net/iprawsock_posix.go.html#2622295">b</a></span><span class="op" id="2622712">[</span><span class="ident" id="2622713"><a href="/net/iprawsock_posix.go.html#2622669">hsize</a></span><span class="op" id="2622718">:</span><span class="op" id="2622719">]</span><span class="op" id="2622720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622725"><a href="/net/iprawsock_posix.go.html#2622497">n</a></span>&nbsp;<span class="op" id="2622727">-=</span>&nbsp;<span class="ident" id="2622730"><a href="/net/iprawsock_posix.go.html#2622669">hsize</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2622738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622741">case</span>&nbsp;<span class="op" id="2622746">*</span><span class="ident" id="2622747"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2622754">.</span><span class="ident" id="2622755">SockaddrInet6</span><span class="op" id="2622768">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622772"><a href="/net/iprawsock_posix.go.html#2622483">addr</a></span>&nbsp;<span class="op" id="2622777">=</span>&nbsp;<span class="op" id="2622779">&amp;</span><span class="ident" id="2622780"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2622786">{</span><span class="ident" id="2622787">IP</span><span class="op" id="2622789">:</span>&nbsp;<span class="ident" id="2622791"><a href="/net/iprawsock_posix.go.html#2622536">sa</a></span><span class="op" id="2622793">.</span><span class="ident" id="2622794">Addr</span><span class="op" id="2622798">[</span><span class="num" id="2622799">0</span><span class="op" id="2622800">:</span><span class="op" id="2622801">]</span><span class="op" id="2622802">,</span>&nbsp;<span class="ident" id="2622804">Zone</span><span class="op" id="2622808">:</span>&nbsp;<span class="ident" id="2622810"><a href="/net/ipsock.go.html#2635208">zoneToString</a></span><span class="op" id="2622822">(</span><span class="builtintype" id="2622823">int</span><span class="op" id="2622826">(</span><span class="ident" id="2622827"><a href="/net/iprawsock_posix.go.html#2622536">sa</a></span><span class="op" id="2622829">.</span><span class="ident" id="2622830">ZoneId</span><span class="op" id="2622836">)</span><span class="op" id="2622837">)</span><span class="op" id="2622838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2622841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622844">return</span>&nbsp;<span class="ident" id="2622851"><a href="/net/iprawsock_posix.go.html#2622497">n</a></span><span class="op" id="2622852">,</span>&nbsp;<span class="ident" id="2622854"><a href="/net/iprawsock_posix.go.html#2622483">addr</a></span><span class="op" id="2622858">,</span>&nbsp;<span class="ident" id="2622860"><a href="/net/iprawsock_posix.go.html#2622504">err</a></span><br>
<span class="lineno">95</span><span class="op" id="2622864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2622867">//&nbsp;ReadFrom&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2622922">func</span>&nbsp;<span class="op" id="2622927">(</span><span class="ident" id="2622928">c</span>&nbsp;<span class="op" id="2622930">*</span><span class="ident" id="2622931"><a href="/net/iprawsock_posix.go.html#2621858">IPConn</a></span><span class="op" id="2622937">)</span>&nbsp;<span class="ident" id="2622939">ReadFrom</span><span class="op" id="2622947">(</span><span class="ident" id="2622948">b</span>&nbsp;<span class="op" id="2622950">[</span><span class="op" id="2622951">]</span><span class="builtintype" id="2622952">byte</span><span class="op" id="2622956">)</span>&nbsp;<span class="op" id="2622958">(</span><span class="builtintype" id="2622959">int</span><span class="op" id="2622962">,</span>&nbsp;<span class="ident" id="2622964"><a href="/net/net.go.html#2652238">Addr</a></span><span class="op" id="2622968">,</span>&nbsp;<span class="builtintype" id="2622970">error</span><span class="op" id="2622975">)</span>&nbsp;<span class="op" id="2622977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622980">if</span>&nbsp;<span class="op" id="2622983">!</span><span class="ident" id="2622984"><a href="/net/iprawsock_posix.go.html#2622928">c</a></span><span class="op" id="2622985">.</span><span class="ident" id="2622986">ok</span><span class="op" id="2622988">(</span><span class="op" id="2622989">)</span>&nbsp;<span class="op" id="2622991">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622995">return</span>&nbsp;<span class="num" id="2623002">0</span><span class="op" id="2623003">,</span>&nbsp;<span class="ident" id="2623005">nil</span><span class="op" id="2623008">,</span>&nbsp;<span class="ident" id="2623010"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2623017">.</span><span class="ident" id="2623018">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2623026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623029">n</span><span class="op" id="2623030">,</span>&nbsp;<span class="ident" id="2623032">addr</span><span class="op" id="2623036">,</span>&nbsp;<span class="ident" id="2623038">err</span>&nbsp;<span class="op" id="2623042">:=</span>&nbsp;<span class="ident" id="2623045"><a href="/net/iprawsock_posix.go.html#2622928">c</a></span><span class="op" id="2623046">.</span><span class="ident" id="2623047">ReadFromIP</span><span class="op" id="2623057">(</span><span class="ident" id="2623058"><a href="/net/iprawsock_posix.go.html#2622948">b</a></span><span class="op" id="2623059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623062">return</span>&nbsp;<span class="ident" id="2623069"><a href="/net/iprawsock_posix.go.html#2623029">n</a></span><span class="op" id="2623070">,</span>&nbsp;<span class="ident" id="2623072"><a href="/net/iprawsock_posix.go.html#2623032">addr</a></span><span class="op" id="2623076">.</span><span class="ident" id="2623077">toAddr</span><span class="op" id="2623083">(</span><span class="op" id="2623084">)</span><span class="op" id="2623085">,</span>&nbsp;<span class="ident" id="2623087"><a href="/net/iprawsock_posix.go.html#2623038">err</a></span><br>
<span class="lineno"></span><span class="op" id="2623091">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="2623094">//&nbsp;ReadMsgIP&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2623165">//&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;into&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2623232">//&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b,&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;oob,&nbsp;the&nbsp;flags</span><br>
<span class="lineno"></span><span class="comment" id="2623303">//&nbsp;that&nbsp;were&nbsp;set&nbsp;on&nbsp;the&nbsp;packet&nbsp;and&nbsp;the&nbsp;source&nbsp;address&nbsp;of&nbsp;the&nbsp;packet.</span><br>
<span class="lineno">110</span><span class="keyword" id="2623372">func</span>&nbsp;<span class="op" id="2623377">(</span><span class="ident" id="2623378">c</span>&nbsp;<span class="op" id="2623380">*</span><span class="ident" id="2623381"><a href="/net/iprawsock_posix.go.html#2621858">IPConn</a></span><span class="op" id="2623387">)</span>&nbsp;<span class="ident" id="2623389">ReadMsgIP</span><span class="op" id="2623398">(</span><span class="ident" id="2623399">b</span><span class="op" id="2623400">,</span>&nbsp;<span class="ident" id="2623402">oob</span>&nbsp;<span class="op" id="2623406">[</span><span class="op" id="2623407">]</span><span class="builtintype" id="2623408">byte</span><span class="op" id="2623412">)</span>&nbsp;<span class="op" id="2623414">(</span><span class="ident" id="2623415">n</span><span class="op" id="2623416">,</span>&nbsp;<span class="ident" id="2623418">oobn</span><span class="op" id="2623422">,</span>&nbsp;<span class="ident" id="2623424">flags</span>&nbsp;<span class="builtintype" id="2623430">int</span><span class="op" id="2623433">,</span>&nbsp;<span class="ident" id="2623435">addr</span>&nbsp;<span class="op" id="2623440">*</span><span class="ident" id="2623441"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2623447">,</span>&nbsp;<span class="ident" id="2623449">err</span>&nbsp;<span class="builtintype" id="2623453">error</span><span class="op" id="2623458">)</span>&nbsp;<span class="op" id="2623460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623463">if</span>&nbsp;<span class="op" id="2623466">!</span><span class="ident" id="2623467"><a href="/net/iprawsock_posix.go.html#2623378">c</a></span><span class="op" id="2623468">.</span><span class="ident" id="2623469">ok</span><span class="op" id="2623471">(</span><span class="op" id="2623472">)</span>&nbsp;<span class="op" id="2623474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623478">return</span>&nbsp;<span class="num" id="2623485">0</span><span class="op" id="2623486">,</span>&nbsp;<span class="num" id="2623488">0</span><span class="op" id="2623489">,</span>&nbsp;<span class="num" id="2623491">0</span><span class="op" id="2623492">,</span>&nbsp;<span class="ident" id="2623494">nil</span><span class="op" id="2623497">,</span>&nbsp;<span class="ident" id="2623499"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2623506">.</span><span class="ident" id="2623507">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2623515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623518">var</span>&nbsp;<span class="ident" id="2623522">sa</span>&nbsp;<span class="ident" id="2623525"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2623532">.</span><span class="ident" id="2623533">Sockaddr</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623543"><a href="/net/iprawsock_posix.go.html#2623415">n</a></span><span class="op" id="2623544">,</span>&nbsp;<span class="ident" id="2623546"><a href="/net/iprawsock_posix.go.html#2623418">oobn</a></span><span class="op" id="2623550">,</span>&nbsp;<span class="ident" id="2623552"><a href="/net/iprawsock_posix.go.html#2623424">flags</a></span><span class="op" id="2623557">,</span>&nbsp;<span class="ident" id="2623559"><a href="/net/iprawsock_posix.go.html#2623522">sa</a></span><span class="op" id="2623561">,</span>&nbsp;<span class="ident" id="2623563"><a href="/net/iprawsock_posix.go.html#2623449">err</a></span>&nbsp;<span class="op" id="2623567">=</span>&nbsp;<span class="ident" id="2623569"><a href="/net/iprawsock_posix.go.html#2623378">c</a></span><span class="op" id="2623570">.</span><span class="ident" id="2623571">fd</span><span class="op" id="2623573">.</span><span class="ident" id="2623574">readMsg</span><span class="op" id="2623581">(</span><span class="ident" id="2623582"><a href="/net/iprawsock_posix.go.html#2623399">b</a></span><span class="op" id="2623583">,</span>&nbsp;<span class="ident" id="2623585"><a href="/net/iprawsock_posix.go.html#2623402">oob</a></span><span class="op" id="2623588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623591">switch</span>&nbsp;<span class="ident" id="2623598">sa</span>&nbsp;<span class="op" id="2623601">:=</span>&nbsp;<span class="ident" id="2623604"><a href="/net/iprawsock_posix.go.html#2623522">sa</a></span><span class="op" id="2623606">.</span><span class="op" id="2623607">(</span><span class="keyword" id="2623608">type</span><span class="op" id="2623612">)</span>&nbsp;<span class="op" id="2623614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623617">case</span>&nbsp;<span class="op" id="2623622">*</span><span class="ident" id="2623623"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2623630">.</span><span class="ident" id="2623631">SockaddrInet4</span><span class="op" id="2623644">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623648"><a href="/net/iprawsock_posix.go.html#2623435">addr</a></span>&nbsp;<span class="op" id="2623653">=</span>&nbsp;<span class="op" id="2623655">&amp;</span><span class="ident" id="2623656"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2623662">{</span><span class="ident" id="2623663">IP</span><span class="op" id="2623665">:</span>&nbsp;<span class="ident" id="2623667"><a href="/net/iprawsock_posix.go.html#2623598">sa</a></span><span class="op" id="2623669">.</span><span class="ident" id="2623670">Addr</span><span class="op" id="2623674">[</span><span class="num" id="2623675">0</span><span class="op" id="2623676">:</span><span class="op" id="2623677">]</span><span class="op" id="2623678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623681">case</span>&nbsp;<span class="op" id="2623686">*</span><span class="ident" id="2623687"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2623694">.</span><span class="ident" id="2623695">SockaddrInet6</span><span class="op" id="2623708">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623712"><a href="/net/iprawsock_posix.go.html#2623435">addr</a></span>&nbsp;<span class="op" id="2623717">=</span>&nbsp;<span class="op" id="2623719">&amp;</span><span class="ident" id="2623720"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2623726">{</span><span class="ident" id="2623727">IP</span><span class="op" id="2623729">:</span>&nbsp;<span class="ident" id="2623731"><a href="/net/iprawsock_posix.go.html#2623598">sa</a></span><span class="op" id="2623733">.</span><span class="ident" id="2623734">Addr</span><span class="op" id="2623738">[</span><span class="num" id="2623739">0</span><span class="op" id="2623740">:</span><span class="op" id="2623741">]</span><span class="op" id="2623742">,</span>&nbsp;<span class="ident" id="2623744">Zone</span><span class="op" id="2623748">:</span>&nbsp;<span class="ident" id="2623750"><a href="/net/ipsock.go.html#2635208">zoneToString</a></span><span class="op" id="2623762">(</span><span class="builtintype" id="2623763">int</span><span class="op" id="2623766">(</span><span class="ident" id="2623767"><a href="/net/iprawsock_posix.go.html#2623598">sa</a></span><span class="op" id="2623769">.</span><span class="ident" id="2623770">ZoneId</span><span class="op" id="2623776">)</span><span class="op" id="2623777">)</span><span class="op" id="2623778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2623781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623784">return</span><br>
<span class="lineno"></span><span class="op" id="2623791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="2623794">//&nbsp;WriteToIP&nbsp;writes&nbsp;an&nbsp;IP&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload</span><br>
<span class="lineno"></span><span class="comment" id="2623862">//&nbsp;from&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="2623873">//</span><br>
<span class="lineno"></span><span class="comment" id="2623876">//&nbsp;WriteToIP&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2623938">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno">130</span><span class="comment" id="2624005">//&nbsp;SetWriteDeadline.&nbsp;&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts</span><br>
<span class="lineno"></span><span class="comment" id="2624074">//&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span><span class="keyword" id="2624087">func</span>&nbsp;<span class="op" id="2624092">(</span><span class="ident" id="2624093">c</span>&nbsp;<span class="op" id="2624095">*</span><span class="ident" id="2624096"><a href="/net/iprawsock_posix.go.html#2621858">IPConn</a></span><span class="op" id="2624102">)</span>&nbsp;<span class="ident" id="2624104">WriteToIP</span><span class="op" id="2624113">(</span><span class="ident" id="2624114">b</span>&nbsp;<span class="op" id="2624116">[</span><span class="op" id="2624117">]</span><span class="builtintype" id="2624118">byte</span><span class="op" id="2624122">,</span>&nbsp;<span class="ident" id="2624124">addr</span>&nbsp;<span class="op" id="2624129">*</span><span class="ident" id="2624130"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2624136">)</span>&nbsp;<span class="op" id="2624138">(</span><span class="builtintype" id="2624139">int</span><span class="op" id="2624142">,</span>&nbsp;<span class="builtintype" id="2624144">error</span><span class="op" id="2624149">)</span>&nbsp;<span class="op" id="2624151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624154">if</span>&nbsp;<span class="op" id="2624157">!</span><span class="ident" id="2624158"><a href="/net/iprawsock_posix.go.html#2624093">c</a></span><span class="op" id="2624159">.</span><span class="ident" id="2624160">ok</span><span class="op" id="2624162">(</span><span class="op" id="2624163">)</span>&nbsp;<span class="op" id="2624165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624169">return</span>&nbsp;<span class="num" id="2624176">0</span><span class="op" id="2624177">,</span>&nbsp;<span class="ident" id="2624179"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2624186">.</span><span class="ident" id="2624187">EINVAL</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2624195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624198">if</span>&nbsp;<span class="ident" id="2624201"><a href="/net/iprawsock_posix.go.html#2624093">c</a></span><span class="op" id="2624202">.</span><span class="ident" id="2624203">fd</span><span class="op" id="2624205">.</span><span class="ident" id="2624206">isConnected</span>&nbsp;<span class="op" id="2624218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624222">return</span>&nbsp;<span class="num" id="2624229">0</span><span class="op" id="2624230">,</span>&nbsp;<span class="op" id="2624232">&amp;</span><span class="ident" id="2624233"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2624240">{</span><span class="ident" id="2624241">Op</span><span class="op" id="2624243">:</span>&nbsp;<span class="string" id="2624245">&#34;write&#34;</span><span class="op" id="2624252">,</span>&nbsp;<span class="ident" id="2624254">Net</span><span class="op" id="2624257">:</span>&nbsp;<span class="ident" id="2624259"><a href="/net/iprawsock_posix.go.html#2624093">c</a></span><span class="op" id="2624260">.</span><span class="ident" id="2624261">fd</span><span class="op" id="2624263">.</span><span class="ident" id="2624264">net</span><span class="op" id="2624267">,</span>&nbsp;<span class="ident" id="2624269">Addr</span><span class="op" id="2624273">:</span>&nbsp;<span class="ident" id="2624275"><a href="/net/iprawsock_posix.go.html#2624124">addr</a></span><span class="op" id="2624279">,</span>&nbsp;<span class="ident" id="2624281">Err</span><span class="op" id="2624284">:</span>&nbsp;<span class="ident" id="2624286"><a href="/net/net.go.html#2659374">ErrWriteToConnected</a></span><span class="op" id="2624305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2624308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624311">if</span>&nbsp;<span class="ident" id="2624314"><a href="/net/iprawsock_posix.go.html#2624124">addr</a></span>&nbsp;<span class="op" id="2624319">==</span>&nbsp;<span class="ident" id="2624322">nil</span>&nbsp;<span class="op" id="2624326">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624330">return</span>&nbsp;<span class="num" id="2624337">0</span><span class="op" id="2624338">,</span>&nbsp;<span class="op" id="2624340">&amp;</span><span class="ident" id="2624341"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2624348">{</span><span class="ident" id="2624349">Op</span><span class="op" id="2624351">:</span>&nbsp;<span class="string" id="2624353">&#34;write&#34;</span><span class="op" id="2624360">,</span>&nbsp;<span class="ident" id="2624362">Net</span><span class="op" id="2624365">:</span>&nbsp;<span class="ident" id="2624367"><a href="/net/iprawsock_posix.go.html#2624093">c</a></span><span class="op" id="2624368">.</span><span class="ident" id="2624369">fd</span><span class="op" id="2624371">.</span><span class="ident" id="2624372">net</span><span class="op" id="2624375">,</span>&nbsp;<span class="ident" id="2624377">Addr</span><span class="op" id="2624381">:</span>&nbsp;<span class="ident" id="2624383">nil</span><span class="op" id="2624386">,</span>&nbsp;<span class="ident" id="2624388">Err</span><span class="op" id="2624391">:</span>&nbsp;<span class="ident" id="2624393"><a href="/net/net.go.html#2659161">errMissingAddress</a></span><span class="op" id="2624410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2624413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624416">sa</span><span class="op" id="2624418">,</span>&nbsp;<span class="ident" id="2624420">err</span>&nbsp;<span class="op" id="2624424">:=</span>&nbsp;<span class="ident" id="2624427"><a href="/net/iprawsock_posix.go.html#2624124">addr</a></span><span class="op" id="2624431">.</span><span class="ident" id="2624432">sockaddr</span><span class="op" id="2624440">(</span><span class="ident" id="2624441"><a href="/net/iprawsock_posix.go.html#2624093">c</a></span><span class="op" id="2624442">.</span><span class="ident" id="2624443">fd</span><span class="op" id="2624445">.</span><span class="ident" id="2624446">family</span><span class="op" id="2624452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624455">if</span>&nbsp;<span class="ident" id="2624458"><a href="/net/iprawsock_posix.go.html#2624420">err</a></span>&nbsp;<span class="op" id="2624462">!=</span>&nbsp;<span class="ident" id="2624465">nil</span>&nbsp;<span class="op" id="2624469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624473">return</span>&nbsp;<span class="num" id="2624480">0</span><span class="op" id="2624481">,</span>&nbsp;<span class="op" id="2624483">&amp;</span><span class="ident" id="2624484"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2624491">{</span><span class="string" id="2624492">&#34;write&#34;</span><span class="op" id="2624499">,</span>&nbsp;<span class="ident" id="2624501"><a href="/net/iprawsock_posix.go.html#2624093">c</a></span><span class="op" id="2624502">.</span><span class="ident" id="2624503">fd</span><span class="op" id="2624505">.</span><span class="ident" id="2624506">net</span><span class="op" id="2624509">,</span>&nbsp;<span class="ident" id="2624511"><a href="/net/iprawsock_posix.go.html#2624124">addr</a></span><span class="op" id="2624515">,</span>&nbsp;<span class="ident" id="2624517"><a href="/net/iprawsock_posix.go.html#2624420">err</a></span><span class="op" id="2624520">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2624523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624526">return</span>&nbsp;<span class="ident" id="2624533"><a href="/net/iprawsock_posix.go.html#2624093">c</a></span><span class="op" id="2624534">.</span><span class="ident" id="2624535">fd</span><span class="op" id="2624537">.</span><span class="ident" id="2624538">writeTo</span><span class="op" id="2624545">(</span><span class="ident" id="2624546"><a href="/net/iprawsock_posix.go.html#2624114">b</a></span><span class="op" id="2624547">,</span>&nbsp;<span class="ident" id="2624549"><a href="/net/iprawsock_posix.go.html#2624416">sa</a></span><span class="op" id="2624551">)</span><br>
<span class="lineno"></span><span class="op" id="2624553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2624556">//&nbsp;WriteTo&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno">150</span><span class="keyword" id="2624609">func</span>&nbsp;<span class="op" id="2624614">(</span><span class="ident" id="2624615">c</span>&nbsp;<span class="op" id="2624617">*</span><span class="ident" id="2624618"><a href="/net/iprawsock_posix.go.html#2621858">IPConn</a></span><span class="op" id="2624624">)</span>&nbsp;<span class="ident" id="2624626">WriteTo</span><span class="op" id="2624633">(</span><span class="ident" id="2624634">b</span>&nbsp;<span class="op" id="2624636">[</span><span class="op" id="2624637">]</span><span class="builtintype" id="2624638">byte</span><span class="op" id="2624642">,</span>&nbsp;<span class="ident" id="2624644">addr</span>&nbsp;<span class="ident" id="2624649"><a href="/net/net.go.html#2652238">Addr</a></span><span class="op" id="2624653">)</span>&nbsp;<span class="op" id="2624655">(</span><span class="builtintype" id="2624656">int</span><span class="op" id="2624659">,</span>&nbsp;<span class="builtintype" id="2624661">error</span><span class="op" id="2624666">)</span>&nbsp;<span class="op" id="2624668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624671">if</span>&nbsp;<span class="op" id="2624674">!</span><span class="ident" id="2624675"><a href="/net/iprawsock_posix.go.html#2624615">c</a></span><span class="op" id="2624676">.</span><span class="ident" id="2624677">ok</span><span class="op" id="2624679">(</span><span class="op" id="2624680">)</span>&nbsp;<span class="op" id="2624682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624686">return</span>&nbsp;<span class="num" id="2624693">0</span><span class="op" id="2624694">,</span>&nbsp;<span class="ident" id="2624696"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2624703">.</span><span class="ident" id="2624704">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2624712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624715">a</span><span class="op" id="2624716">,</span>&nbsp;<span class="ident" id="2624718">ok</span>&nbsp;<span class="op" id="2624721">:=</span>&nbsp;<span class="ident" id="2624724"><a href="/net/iprawsock_posix.go.html#2624644">addr</a></span><span class="op" id="2624728">.</span><span class="op" id="2624729">(</span><span class="op" id="2624730">*</span><span class="ident" id="2624731"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2624737">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624740">if</span>&nbsp;<span class="op" id="2624743">!</span><span class="ident" id="2624744"><a href="/net/iprawsock_posix.go.html#2624718">ok</a></span>&nbsp;<span class="op" id="2624747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624751">return</span>&nbsp;<span class="num" id="2624758">0</span><span class="op" id="2624759">,</span>&nbsp;<span class="op" id="2624761">&amp;</span><span class="ident" id="2624762"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2624769">{</span><span class="string" id="2624770">&#34;write&#34;</span><span class="op" id="2624777">,</span>&nbsp;<span class="ident" id="2624779"><a href="/net/iprawsock_posix.go.html#2624615">c</a></span><span class="op" id="2624780">.</span><span class="ident" id="2624781">fd</span><span class="op" id="2624783">.</span><span class="ident" id="2624784">net</span><span class="op" id="2624787">,</span>&nbsp;<span class="ident" id="2624789"><a href="/net/iprawsock_posix.go.html#2624644">addr</a></span><span class="op" id="2624793">,</span>&nbsp;<span class="ident" id="2624795"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2624802">.</span><span class="ident" id="2624803">EINVAL</span><span class="op" id="2624809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2624812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624815">return</span>&nbsp;<span class="ident" id="2624822"><a href="/net/iprawsock_posix.go.html#2624615">c</a></span><span class="op" id="2624823">.</span><span class="ident" id="2624824">WriteToIP</span><span class="op" id="2624833">(</span><span class="ident" id="2624834"><a href="/net/iprawsock_posix.go.html#2624634">b</a></span><span class="op" id="2624835">,</span>&nbsp;<span class="ident" id="2624837"><a href="/net/iprawsock_posix.go.html#2624715">a</a></span><span class="op" id="2624838">)</span><br>
<span class="lineno"></span><span class="op" id="2624840">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="2624843">//&nbsp;WriteMsgIP&nbsp;writes&nbsp;a&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2624913">//&nbsp;b&nbsp;and&nbsp;the&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;from&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2624980">//&nbsp;number&nbsp;of&nbsp;payload&nbsp;and&nbsp;out-of-band&nbsp;bytes&nbsp;written.</span><br>
<span class="lineno"></span><span class="keyword" id="2625032">func</span>&nbsp;<span class="op" id="2625037">(</span><span class="ident" id="2625038">c</span>&nbsp;<span class="op" id="2625040">*</span><span class="ident" id="2625041"><a href="/net/iprawsock_posix.go.html#2621858">IPConn</a></span><span class="op" id="2625047">)</span>&nbsp;<span class="ident" id="2625049">WriteMsgIP</span><span class="op" id="2625059">(</span><span class="ident" id="2625060">b</span><span class="op" id="2625061">,</span>&nbsp;<span class="ident" id="2625063">oob</span>&nbsp;<span class="op" id="2625067">[</span><span class="op" id="2625068">]</span><span class="builtintype" id="2625069">byte</span><span class="op" id="2625073">,</span>&nbsp;<span class="ident" id="2625075">addr</span>&nbsp;<span class="op" id="2625080">*</span><span class="ident" id="2625081"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2625087">)</span>&nbsp;<span class="op" id="2625089">(</span><span class="ident" id="2625090">n</span><span class="op" id="2625091">,</span>&nbsp;<span class="ident" id="2625093">oobn</span>&nbsp;<span class="builtintype" id="2625098">int</span><span class="op" id="2625101">,</span>&nbsp;<span class="ident" id="2625103">err</span>&nbsp;<span class="builtintype" id="2625107">error</span><span class="op" id="2625112">)</span>&nbsp;<span class="op" id="2625114">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625117">if</span>&nbsp;<span class="op" id="2625120">!</span><span class="ident" id="2625121"><a href="/net/iprawsock_posix.go.html#2625038">c</a></span><span class="op" id="2625122">.</span><span class="ident" id="2625123">ok</span><span class="op" id="2625125">(</span><span class="op" id="2625126">)</span>&nbsp;<span class="op" id="2625128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625132">return</span>&nbsp;<span class="num" id="2625139">0</span><span class="op" id="2625140">,</span>&nbsp;<span class="num" id="2625142">0</span><span class="op" id="2625143">,</span>&nbsp;<span class="ident" id="2625145"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2625152">.</span><span class="ident" id="2625153">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2625161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625164">if</span>&nbsp;<span class="ident" id="2625167"><a href="/net/iprawsock_posix.go.html#2625038">c</a></span><span class="op" id="2625168">.</span><span class="ident" id="2625169">fd</span><span class="op" id="2625171">.</span><span class="ident" id="2625172">isConnected</span>&nbsp;<span class="op" id="2625184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625188">return</span>&nbsp;<span class="num" id="2625195">0</span><span class="op" id="2625196">,</span>&nbsp;<span class="num" id="2625198">0</span><span class="op" id="2625199">,</span>&nbsp;<span class="op" id="2625201">&amp;</span><span class="ident" id="2625202"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2625209">{</span><span class="ident" id="2625210">Op</span><span class="op" id="2625212">:</span>&nbsp;<span class="string" id="2625214">&#34;write&#34;</span><span class="op" id="2625221">,</span>&nbsp;<span class="ident" id="2625223">Net</span><span class="op" id="2625226">:</span>&nbsp;<span class="ident" id="2625228"><a href="/net/iprawsock_posix.go.html#2625038">c</a></span><span class="op" id="2625229">.</span><span class="ident" id="2625230">fd</span><span class="op" id="2625232">.</span><span class="ident" id="2625233">net</span><span class="op" id="2625236">,</span>&nbsp;<span class="ident" id="2625238">Addr</span><span class="op" id="2625242">:</span>&nbsp;<span class="ident" id="2625244"><a href="/net/iprawsock_posix.go.html#2625075">addr</a></span><span class="op" id="2625248">,</span>&nbsp;<span class="ident" id="2625250">Err</span><span class="op" id="2625253">:</span>&nbsp;<span class="ident" id="2625255"><a href="/net/net.go.html#2659374">ErrWriteToConnected</a></span><span class="op" id="2625274">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2625277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625280">if</span>&nbsp;<span class="ident" id="2625283"><a href="/net/iprawsock_posix.go.html#2625075">addr</a></span>&nbsp;<span class="op" id="2625288">==</span>&nbsp;<span class="ident" id="2625291">nil</span>&nbsp;<span class="op" id="2625295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625299">return</span>&nbsp;<span class="num" id="2625306">0</span><span class="op" id="2625307">,</span>&nbsp;<span class="num" id="2625309">0</span><span class="op" id="2625310">,</span>&nbsp;<span class="op" id="2625312">&amp;</span><span class="ident" id="2625313"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2625320">{</span><span class="ident" id="2625321">Op</span><span class="op" id="2625323">:</span>&nbsp;<span class="string" id="2625325">&#34;write&#34;</span><span class="op" id="2625332">,</span>&nbsp;<span class="ident" id="2625334">Net</span><span class="op" id="2625337">:</span>&nbsp;<span class="ident" id="2625339"><a href="/net/iprawsock_posix.go.html#2625038">c</a></span><span class="op" id="2625340">.</span><span class="ident" id="2625341">fd</span><span class="op" id="2625343">.</span><span class="ident" id="2625344">net</span><span class="op" id="2625347">,</span>&nbsp;<span class="ident" id="2625349">Addr</span><span class="op" id="2625353">:</span>&nbsp;<span class="ident" id="2625355">nil</span><span class="op" id="2625358">,</span>&nbsp;<span class="ident" id="2625360">Err</span><span class="op" id="2625363">:</span>&nbsp;<span class="ident" id="2625365"><a href="/net/net.go.html#2659161">errMissingAddress</a></span><span class="op" id="2625382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2625385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625388">sa</span><span class="op" id="2625390">,</span>&nbsp;<span class="ident" id="2625392"><a href="/net/iprawsock_posix.go.html#2625103">err</a></span>&nbsp;<span class="op" id="2625396">:=</span>&nbsp;<span class="ident" id="2625399"><a href="/net/iprawsock_posix.go.html#2625075">addr</a></span><span class="op" id="2625403">.</span><span class="ident" id="2625404">sockaddr</span><span class="op" id="2625412">(</span><span class="ident" id="2625413"><a href="/net/iprawsock_posix.go.html#2625038">c</a></span><span class="op" id="2625414">.</span><span class="ident" id="2625415">fd</span><span class="op" id="2625417">.</span><span class="ident" id="2625418">family</span><span class="op" id="2625424">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625427">if</span>&nbsp;<span class="ident" id="2625430"><a href="/net/iprawsock_posix.go.html#2625103">err</a></span>&nbsp;<span class="op" id="2625434">!=</span>&nbsp;<span class="ident" id="2625437">nil</span>&nbsp;<span class="op" id="2625441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625445">return</span>&nbsp;<span class="num" id="2625452">0</span><span class="op" id="2625453">,</span>&nbsp;<span class="num" id="2625455">0</span><span class="op" id="2625456">,</span>&nbsp;<span class="op" id="2625458">&amp;</span><span class="ident" id="2625459"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2625466">{</span><span class="string" id="2625467">&#34;write&#34;</span><span class="op" id="2625474">,</span>&nbsp;<span class="ident" id="2625476"><a href="/net/iprawsock_posix.go.html#2625038">c</a></span><span class="op" id="2625477">.</span><span class="ident" id="2625478">fd</span><span class="op" id="2625480">.</span><span class="ident" id="2625481">net</span><span class="op" id="2625484">,</span>&nbsp;<span class="ident" id="2625486"><a href="/net/iprawsock_posix.go.html#2625075">addr</a></span><span class="op" id="2625490">,</span>&nbsp;<span class="ident" id="2625492"><a href="/net/iprawsock_posix.go.html#2625103">err</a></span><span class="op" id="2625495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2625498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625501">return</span>&nbsp;<span class="ident" id="2625508"><a href="/net/iprawsock_posix.go.html#2625038">c</a></span><span class="op" id="2625509">.</span><span class="ident" id="2625510">fd</span><span class="op" id="2625512">.</span><span class="ident" id="2625513">writeMsg</span><span class="op" id="2625521">(</span><span class="ident" id="2625522"><a href="/net/iprawsock_posix.go.html#2625060">b</a></span><span class="op" id="2625523">,</span>&nbsp;<span class="ident" id="2625525"><a href="/net/iprawsock_posix.go.html#2625063">oob</a></span><span class="op" id="2625528">,</span>&nbsp;<span class="ident" id="2625530"><a href="/net/iprawsock_posix.go.html#2625388">sa</a></span><span class="op" id="2625532">)</span><br>
<span class="lineno"></span><span class="op" id="2625534">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="2625537">//&nbsp;DialIP&nbsp;connects&nbsp;to&nbsp;the&nbsp;remote&nbsp;address&nbsp;raddr&nbsp;on&nbsp;the&nbsp;network&nbsp;protocol</span><br>
<span class="lineno"></span><span class="comment" id="2625608">//&nbsp;netProto,&nbsp;which&nbsp;must&nbsp;be&nbsp;&#34;ip&#34;,&nbsp;&#34;ip4&#34;,&nbsp;or&nbsp;&#34;ip6&#34;&nbsp;followed&nbsp;by&nbsp;a&nbsp;colon</span><br>
<span class="lineno"></span><span class="comment" id="2625677">//&nbsp;and&nbsp;a&nbsp;protocol&nbsp;number&nbsp;or&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="2625711">func</span>&nbsp;<span class="ident" id="2625716">DialIP</span><span class="op" id="2625722">(</span><span class="ident" id="2625723">netProto</span>&nbsp;<span class="builtintype" id="2625732">string</span><span class="op" id="2625738">,</span>&nbsp;<span class="ident" id="2625740">laddr</span><span class="op" id="2625745">,</span>&nbsp;<span class="ident" id="2625747">raddr</span>&nbsp;<span class="op" id="2625753">*</span><span class="ident" id="2625754"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2625760">)</span>&nbsp;<span class="op" id="2625762">(</span><span class="op" id="2625763">*</span><span class="ident" id="2625764"><a href="/net/iprawsock_posix.go.html#2621858">IPConn</a></span><span class="op" id="2625770">,</span>&nbsp;<span class="builtintype" id="2625772">error</span><span class="op" id="2625777">)</span>&nbsp;<span class="op" id="2625779">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625782">return</span>&nbsp;<span class="ident" id="2625789"><a href="/net/iprawsock_posix.go.html#2625840">dialIP</a></span><span class="op" id="2625795">(</span><span class="ident" id="2625796"><a href="/net/iprawsock_posix.go.html#2625723">netProto</a></span><span class="op" id="2625804">,</span>&nbsp;<span class="ident" id="2625806"><a href="/net/iprawsock_posix.go.html#2625740">laddr</a></span><span class="op" id="2625811">,</span>&nbsp;<span class="ident" id="2625813"><a href="/net/iprawsock_posix.go.html#2625747">raddr</a></span><span class="op" id="2625818">,</span>&nbsp;<span class="ident" id="2625820"><a href="/net/net.go.html#2660335">noDeadline</a></span><span class="op" id="2625830">)</span><br>
<span class="lineno"></span><span class="op" id="2625832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2625835">func</span>&nbsp;<span class="ident" id="2625840">dialIP</span><span class="op" id="2625846">(</span><span class="ident" id="2625847">netProto</span>&nbsp;<span class="builtintype" id="2625856">string</span><span class="op" id="2625862">,</span>&nbsp;<span class="ident" id="2625864">laddr</span><span class="op" id="2625869">,</span>&nbsp;<span class="ident" id="2625871">raddr</span>&nbsp;<span class="op" id="2625877">*</span><span class="ident" id="2625878"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2625884">,</span>&nbsp;<span class="ident" id="2625886">deadline</span>&nbsp;<span class="ident" id="2625895"><a href="/net/iprawsock_posix.go.html#2620473">time</a></span><span class="op" id="2625899">.</span><span class="ident" id="2625900">Time</span><span class="op" id="2625904">)</span>&nbsp;<span class="op" id="2625906">(</span><span class="op" id="2625907">*</span><span class="ident" id="2625908"><a href="/net/iprawsock_posix.go.html#2621858">IPConn</a></span><span class="op" id="2625914">,</span>&nbsp;<span class="builtintype" id="2625916">error</span><span class="op" id="2625921">)</span>&nbsp;<span class="op" id="2625923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625926">net</span><span class="op" id="2625929">,</span>&nbsp;<span class="ident" id="2625931">proto</span><span class="op" id="2625936">,</span>&nbsp;<span class="ident" id="2625938">err</span>&nbsp;<span class="op" id="2625942">:=</span>&nbsp;<span class="ident" id="2625945"><a href="/net/dial.go.html#2519499">parseNetwork</a></span><span class="op" id="2625957">(</span><span class="ident" id="2625958"><a href="/net/iprawsock_posix.go.html#2625847">netProto</a></span><span class="op" id="2625966">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625969">if</span>&nbsp;<span class="ident" id="2625972"><a href="/net/iprawsock_posix.go.html#2625938">err</a></span>&nbsp;<span class="op" id="2625976">!=</span>&nbsp;<span class="ident" id="2625979">nil</span>&nbsp;<span class="op" id="2625983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625987">return</span>&nbsp;<span class="ident" id="2625994">nil</span><span class="op" id="2625997">,</span>&nbsp;<span class="op" id="2625999">&amp;</span><span class="ident" id="2626000"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2626007">{</span><span class="ident" id="2626008">Op</span><span class="op" id="2626010">:</span>&nbsp;<span class="string" id="2626012">&#34;dial&#34;</span><span class="op" id="2626018">,</span>&nbsp;<span class="ident" id="2626020">Net</span><span class="op" id="2626023">:</span>&nbsp;<span class="ident" id="2626025"><a href="/net/iprawsock_posix.go.html#2625847">netProto</a></span><span class="op" id="2626033">,</span>&nbsp;<span class="ident" id="2626035">Addr</span><span class="op" id="2626039">:</span>&nbsp;<span class="ident" id="2626041"><a href="/net/iprawsock_posix.go.html#2625871">raddr</a></span><span class="op" id="2626046">,</span>&nbsp;<span class="ident" id="2626048">Err</span><span class="op" id="2626051">:</span>&nbsp;<span class="ident" id="2626053"><a href="/net/iprawsock_posix.go.html#2625938">err</a></span><span class="op" id="2626056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2626059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626062">switch</span>&nbsp;<span class="ident" id="2626069"><a href="/net/iprawsock_posix.go.html#2625926">net</a></span>&nbsp;<span class="op" id="2626073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626076">case</span>&nbsp;<span class="string" id="2626081">&#34;ip&#34;</span><span class="op" id="2626085">,</span>&nbsp;<span class="string" id="2626087">&#34;ip4&#34;</span><span class="op" id="2626092">,</span>&nbsp;<span class="string" id="2626094">&#34;ip6&#34;</span><span class="op" id="2626099">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626102">default</span><span class="op" id="2626109">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626113">return</span>&nbsp;<span class="ident" id="2626120">nil</span><span class="op" id="2626123">,</span>&nbsp;<span class="op" id="2626125">&amp;</span><span class="ident" id="2626126"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2626133">{</span><span class="ident" id="2626134">Op</span><span class="op" id="2626136">:</span>&nbsp;<span class="string" id="2626138">&#34;dial&#34;</span><span class="op" id="2626144">,</span>&nbsp;<span class="ident" id="2626146">Net</span><span class="op" id="2626149">:</span>&nbsp;<span class="ident" id="2626151"><a href="/net/iprawsock_posix.go.html#2625847">netProto</a></span><span class="op" id="2626159">,</span>&nbsp;<span class="ident" id="2626161">Addr</span><span class="op" id="2626165">:</span>&nbsp;<span class="ident" id="2626167"><a href="/net/iprawsock_posix.go.html#2625871">raddr</a></span><span class="op" id="2626172">,</span>&nbsp;<span class="ident" id="2626174">Err</span><span class="op" id="2626177">:</span>&nbsp;<span class="ident" id="2626179"><a href="/net/net.go.html#2661008">UnknownNetworkError</a></span><span class="op" id="2626198">(</span><span class="ident" id="2626199"><a href="/net/iprawsock_posix.go.html#2625847">netProto</a></span><span class="op" id="2626207">)</span><span class="op" id="2626208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2626211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626214">if</span>&nbsp;<span class="ident" id="2626217"><a href="/net/iprawsock_posix.go.html#2625871">raddr</a></span>&nbsp;<span class="op" id="2626223">==</span>&nbsp;<span class="ident" id="2626226">nil</span>&nbsp;<span class="op" id="2626230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626234">return</span>&nbsp;<span class="ident" id="2626241">nil</span><span class="op" id="2626244">,</span>&nbsp;<span class="op" id="2626246">&amp;</span><span class="ident" id="2626247"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2626254">{</span><span class="ident" id="2626255">Op</span><span class="op" id="2626257">:</span>&nbsp;<span class="string" id="2626259">&#34;dial&#34;</span><span class="op" id="2626265">,</span>&nbsp;<span class="ident" id="2626267">Net</span><span class="op" id="2626270">:</span>&nbsp;<span class="ident" id="2626272"><a href="/net/iprawsock_posix.go.html#2625847">netProto</a></span><span class="op" id="2626280">,</span>&nbsp;<span class="ident" id="2626282">Addr</span><span class="op" id="2626286">:</span>&nbsp;<span class="ident" id="2626288">nil</span><span class="op" id="2626291">,</span>&nbsp;<span class="ident" id="2626293">Err</span><span class="op" id="2626296">:</span>&nbsp;<span class="ident" id="2626298"><a href="/net/net.go.html#2659161">errMissingAddress</a></span><span class="op" id="2626315">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2626318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626321">fd</span><span class="op" id="2626323">,</span>&nbsp;<span class="ident" id="2626325"><a href="/net/iprawsock_posix.go.html#2625938">err</a></span>&nbsp;<span class="op" id="2626329">:=</span>&nbsp;<span class="ident" id="2626332"><a href="/net/ipsock_posix.go.html#2639894">internetSocket</a></span><span class="op" id="2626346">(</span><span class="ident" id="2626347"><a href="/net/iprawsock_posix.go.html#2625926">net</a></span><span class="op" id="2626350">,</span>&nbsp;<span class="ident" id="2626352"><a href="/net/iprawsock_posix.go.html#2625864">laddr</a></span><span class="op" id="2626357">,</span>&nbsp;<span class="ident" id="2626359"><a href="/net/iprawsock_posix.go.html#2625871">raddr</a></span><span class="op" id="2626364">,</span>&nbsp;<span class="ident" id="2626366"><a href="/net/iprawsock_posix.go.html#2625886">deadline</a></span><span class="op" id="2626374">,</span>&nbsp;<span class="ident" id="2626376"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2626383">.</span><span class="ident" id="2626384">SOCK_RAW</span><span class="op" id="2626392">,</span>&nbsp;<span class="ident" id="2626394"><a href="/net/iprawsock_posix.go.html#2625931">proto</a></span><span class="op" id="2626399">,</span>&nbsp;<span class="string" id="2626401">&#34;dial&#34;</span><span class="op" id="2626407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626410">if</span>&nbsp;<span class="ident" id="2626413"><a href="/net/iprawsock_posix.go.html#2625938">err</a></span>&nbsp;<span class="op" id="2626417">!=</span>&nbsp;<span class="ident" id="2626420">nil</span>&nbsp;<span class="op" id="2626424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626428">return</span>&nbsp;<span class="ident" id="2626435">nil</span><span class="op" id="2626438">,</span>&nbsp;<span class="op" id="2626440">&amp;</span><span class="ident" id="2626441"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2626448">{</span><span class="ident" id="2626449">Op</span><span class="op" id="2626451">:</span>&nbsp;<span class="string" id="2626453">&#34;dial&#34;</span><span class="op" id="2626459">,</span>&nbsp;<span class="ident" id="2626461">Net</span><span class="op" id="2626464">:</span>&nbsp;<span class="ident" id="2626466"><a href="/net/iprawsock_posix.go.html#2625847">netProto</a></span><span class="op" id="2626474">,</span>&nbsp;<span class="ident" id="2626476">Addr</span><span class="op" id="2626480">:</span>&nbsp;<span class="ident" id="2626482"><a href="/net/iprawsock_posix.go.html#2625871">raddr</a></span><span class="op" id="2626487">,</span>&nbsp;<span class="ident" id="2626489">Err</span><span class="op" id="2626492">:</span>&nbsp;<span class="ident" id="2626494"><a href="/net/iprawsock_posix.go.html#2625938">err</a></span><span class="op" id="2626497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2626500">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626503">return</span>&nbsp;<span class="ident" id="2626510"><a href="/net/iprawsock_posix.go.html#2621888">newIPConn</a></span><span class="op" id="2626519">(</span><span class="ident" id="2626520"><a href="/net/iprawsock_posix.go.html#2626321">fd</a></span><span class="op" id="2626522">)</span><span class="op" id="2626523">,</span>&nbsp;<span class="ident" id="2626525">nil</span><br>
<span class="lineno"></span><span class="op" id="2626529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2626532">//&nbsp;ListenIP&nbsp;listens&nbsp;for&nbsp;incoming&nbsp;IP&nbsp;packets&nbsp;addressed&nbsp;to&nbsp;the&nbsp;local</span><br>
<span class="lineno"></span><span class="comment" id="2626599">//&nbsp;address&nbsp;laddr.&nbsp;&nbsp;The&nbsp;returned&nbsp;connection&#39;s&nbsp;ReadFrom&nbsp;and&nbsp;WriteTo</span><br>
<span class="lineno">210</span><span class="comment" id="2626665">//&nbsp;methods&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;receive&nbsp;and&nbsp;send&nbsp;IP&nbsp;packets&nbsp;with&nbsp;per-packet</span><br>
<span class="lineno"></span><span class="comment" id="2626735">//&nbsp;addressing.</span><br>
<span class="lineno"></span><span class="keyword" id="2626750">func</span>&nbsp;<span class="ident" id="2626755">ListenIP</span><span class="op" id="2626763">(</span><span class="ident" id="2626764">netProto</span>&nbsp;<span class="builtintype" id="2626773">string</span><span class="op" id="2626779">,</span>&nbsp;<span class="ident" id="2626781">laddr</span>&nbsp;<span class="op" id="2626787">*</span><span class="ident" id="2626788"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2626794">)</span>&nbsp;<span class="op" id="2626796">(</span><span class="op" id="2626797">*</span><span class="ident" id="2626798"><a href="/net/iprawsock_posix.go.html#2621858">IPConn</a></span><span class="op" id="2626804">,</span>&nbsp;<span class="builtintype" id="2626806">error</span><span class="op" id="2626811">)</span>&nbsp;<span class="op" id="2626813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626816">net</span><span class="op" id="2626819">,</span>&nbsp;<span class="ident" id="2626821">proto</span><span class="op" id="2626826">,</span>&nbsp;<span class="ident" id="2626828">err</span>&nbsp;<span class="op" id="2626832">:=</span>&nbsp;<span class="ident" id="2626835"><a href="/net/dial.go.html#2519499">parseNetwork</a></span><span class="op" id="2626847">(</span><span class="ident" id="2626848"><a href="/net/iprawsock_posix.go.html#2626764">netProto</a></span><span class="op" id="2626856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626859">if</span>&nbsp;<span class="ident" id="2626862"><a href="/net/iprawsock_posix.go.html#2626828">err</a></span>&nbsp;<span class="op" id="2626866">!=</span>&nbsp;<span class="ident" id="2626869">nil</span>&nbsp;<span class="op" id="2626873">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626877">return</span>&nbsp;<span class="ident" id="2626884">nil</span><span class="op" id="2626887">,</span>&nbsp;<span class="op" id="2626889">&amp;</span><span class="ident" id="2626890"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2626897">{</span><span class="ident" id="2626898">Op</span><span class="op" id="2626900">:</span>&nbsp;<span class="string" id="2626902">&#34;dial&#34;</span><span class="op" id="2626908">,</span>&nbsp;<span class="ident" id="2626910">Net</span><span class="op" id="2626913">:</span>&nbsp;<span class="ident" id="2626915"><a href="/net/iprawsock_posix.go.html#2626764">netProto</a></span><span class="op" id="2626923">,</span>&nbsp;<span class="ident" id="2626925">Addr</span><span class="op" id="2626929">:</span>&nbsp;<span class="ident" id="2626931"><a href="/net/iprawsock_posix.go.html#2626781">laddr</a></span><span class="op" id="2626936">,</span>&nbsp;<span class="ident" id="2626938">Err</span><span class="op" id="2626941">:</span>&nbsp;<span class="ident" id="2626943"><a href="/net/iprawsock_posix.go.html#2626828">err</a></span><span class="op" id="2626946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2626949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626952">switch</span>&nbsp;<span class="ident" id="2626959"><a href="/net/iprawsock_posix.go.html#2626816">net</a></span>&nbsp;<span class="op" id="2626963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626966">case</span>&nbsp;<span class="string" id="2626971">&#34;ip&#34;</span><span class="op" id="2626975">,</span>&nbsp;<span class="string" id="2626977">&#34;ip4&#34;</span><span class="op" id="2626982">,</span>&nbsp;<span class="string" id="2626984">&#34;ip6&#34;</span><span class="op" id="2626989">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626992">default</span><span class="op" id="2626999">:</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627003">return</span>&nbsp;<span class="ident" id="2627010">nil</span><span class="op" id="2627013">,</span>&nbsp;<span class="op" id="2627015">&amp;</span><span class="ident" id="2627016"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2627023">{</span><span class="ident" id="2627024">Op</span><span class="op" id="2627026">:</span>&nbsp;<span class="string" id="2627028">&#34;listen&#34;</span><span class="op" id="2627036">,</span>&nbsp;<span class="ident" id="2627038">Net</span><span class="op" id="2627041">:</span>&nbsp;<span class="ident" id="2627043"><a href="/net/iprawsock_posix.go.html#2626764">netProto</a></span><span class="op" id="2627051">,</span>&nbsp;<span class="ident" id="2627053">Addr</span><span class="op" id="2627057">:</span>&nbsp;<span class="ident" id="2627059"><a href="/net/iprawsock_posix.go.html#2626781">laddr</a></span><span class="op" id="2627064">,</span>&nbsp;<span class="ident" id="2627066">Err</span><span class="op" id="2627069">:</span>&nbsp;<span class="ident" id="2627071"><a href="/net/net.go.html#2661008">UnknownNetworkError</a></span><span class="op" id="2627090">(</span><span class="ident" id="2627091"><a href="/net/iprawsock_posix.go.html#2626764">netProto</a></span><span class="op" id="2627099">)</span><span class="op" id="2627100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2627103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627106">fd</span><span class="op" id="2627108">,</span>&nbsp;<span class="ident" id="2627110"><a href="/net/iprawsock_posix.go.html#2626828">err</a></span>&nbsp;<span class="op" id="2627114">:=</span>&nbsp;<span class="ident" id="2627117"><a href="/net/ipsock_posix.go.html#2639894">internetSocket</a></span><span class="op" id="2627131">(</span><span class="ident" id="2627132"><a href="/net/iprawsock_posix.go.html#2626816">net</a></span><span class="op" id="2627135">,</span>&nbsp;<span class="ident" id="2627137"><a href="/net/iprawsock_posix.go.html#2626781">laddr</a></span><span class="op" id="2627142">,</span>&nbsp;<span class="ident" id="2627144">nil</span><span class="op" id="2627147">,</span>&nbsp;<span class="ident" id="2627149"><a href="/net/net.go.html#2660335">noDeadline</a></span><span class="op" id="2627159">,</span>&nbsp;<span class="ident" id="2627161"><a href="/net/iprawsock_posix.go.html#2620462">syscall</a></span><span class="op" id="2627168">.</span><span class="ident" id="2627169">SOCK_RAW</span><span class="op" id="2627177">,</span>&nbsp;<span class="ident" id="2627179"><a href="/net/iprawsock_posix.go.html#2626821">proto</a></span><span class="op" id="2627184">,</span>&nbsp;<span class="string" id="2627186">&#34;listen&#34;</span><span class="op" id="2627194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627197">if</span>&nbsp;<span class="ident" id="2627200"><a href="/net/iprawsock_posix.go.html#2626828">err</a></span>&nbsp;<span class="op" id="2627204">!=</span>&nbsp;<span class="ident" id="2627207">nil</span>&nbsp;<span class="op" id="2627211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627215">return</span>&nbsp;<span class="ident" id="2627222">nil</span><span class="op" id="2627225">,</span>&nbsp;<span class="op" id="2627227">&amp;</span><span class="ident" id="2627228"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="2627235">{</span><span class="ident" id="2627236">Op</span><span class="op" id="2627238">:</span>&nbsp;<span class="string" id="2627240">&#34;listen&#34;</span><span class="op" id="2627248">,</span>&nbsp;<span class="ident" id="2627250">Net</span><span class="op" id="2627253">:</span>&nbsp;<span class="ident" id="2627255"><a href="/net/iprawsock_posix.go.html#2626764">netProto</a></span><span class="op" id="2627263">,</span>&nbsp;<span class="ident" id="2627265">Addr</span><span class="op" id="2627269">:</span>&nbsp;<span class="ident" id="2627271"><a href="/net/iprawsock_posix.go.html#2626781">laddr</a></span><span class="op" id="2627276">,</span>&nbsp;<span class="ident" id="2627278">Err</span><span class="op" id="2627281">:</span>&nbsp;<span class="ident" id="2627283"><a href="/net/iprawsock_posix.go.html#2626828">err</a></span><span class="op" id="2627286">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2627289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627292">return</span>&nbsp;<span class="ident" id="2627299"><a href="/net/iprawsock_posix.go.html#2621888">newIPConn</a></span><span class="op" id="2627308">(</span><span class="ident" id="2627309"><a href="/net/iprawsock_posix.go.html#2627106">fd</a></span><span class="op" id="2627311">)</span><span class="op" id="2627312">,</span>&nbsp;<span class="ident" id="2627314">nil</span><br>
<span class="lineno"></span><span class="op" id="2627318">}</span>
</div>
</body>
</html>
