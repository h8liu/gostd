<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/gob</h2>
<ul>
<li><a href="/gostd/encoding/gob/codec_test.go.html">codec_test.go</a></li>
<li><a href="/gostd/encoding/gob/dec_helpers.go.html">dec_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/gob/decoder.go.html">decoder.go</a></li>
<li><a href="/gostd/encoding/gob/doc.go.html">doc.go</a></li>
<li><a href="/gostd/encoding/gob/enc_helpers.go.html">enc_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/gob/encoder.go.html">encoder.go</a></li>
<li><a href="/gostd/encoding/gob/encoder_test.go.html" class="current">encoder_test.go</a></li>
<li><a href="/gostd/encoding/gob/error.go.html">error.go</a></li>
<li><a href="/gostd/encoding/gob/example_encdec_test.go.html">example_encdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_interface_test.go.html">example_interface_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/gob/gobencdec_test.go.html">gobencdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/timing_test.go.html">timing_test.go</a></li>
<li><a href="/gostd/encoding/gob/type.go.html">type.go</a></li>
<li><a href="/gostd/encoding/gob/type_test.go.html">type_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8282145">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8282200">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8282254">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8282305">package</span>&nbsp;<span class="ident" id="8282313">gob</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8282318">import</span>&nbsp;<span class="op" id="8282325">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282328">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282337">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282344">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282350">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282361">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282372">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8282382">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="8282385">//&nbsp;Test&nbsp;basic&nbsp;operations&nbsp;in&nbsp;a&nbsp;safe&nbsp;manner.</span><br>
<span class="lineno"></span><span class="keyword" id="8282428">func</span>&nbsp;<span class="ident" id="8282433">TestBasicEncoderDecoder</span><span class="op" id="8282456">(</span><span class="ident" id="8282457">t</span>&nbsp;<span class="op" id="8282459">*</span><span class="ident" id="8282460">testing</span><span class="op" id="8282467">.</span><span class="ident" id="8282468">T</span><span class="op" id="8282469">)</span>&nbsp;<span class="op" id="8282471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8282474">var</span>&nbsp;<span class="ident" id="8282478">values</span>&nbsp;<span class="op" id="8282485">=</span>&nbsp;<span class="op" id="8282487">[</span><span class="op" id="8282488">]</span><span class="keyword" id="8282489">interface</span><span class="op" id="8282498">{</span><span class="op" id="8282499">}</span><span class="op" id="8282500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282504">true</span><span class="op" id="8282508">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282512">int</span><span class="op" id="8282515">(</span><span class="num" id="8282516">123</span><span class="op" id="8282519">)</span><span class="op" id="8282520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282524">int8</span><span class="op" id="8282528">(</span><span class="num" id="8282529">123</span><span class="op" id="8282532">)</span><span class="op" id="8282533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282537">int16</span><span class="op" id="8282542">(</span><span class="op" id="8282543">-</span><span class="num" id="8282544">12345</span><span class="op" id="8282549">)</span><span class="op" id="8282550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282554">int32</span><span class="op" id="8282559">(</span><span class="num" id="8282560">123456</span><span class="op" id="8282566">)</span><span class="op" id="8282567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282571">int64</span><span class="op" id="8282576">(</span><span class="op" id="8282577">-</span><span class="num" id="8282578">1234567</span><span class="op" id="8282585">)</span><span class="op" id="8282586">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282590">uint</span><span class="op" id="8282594">(</span><span class="num" id="8282595">123</span><span class="op" id="8282598">)</span><span class="op" id="8282599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282603">uint8</span><span class="op" id="8282608">(</span><span class="num" id="8282609">123</span><span class="op" id="8282612">)</span><span class="op" id="8282613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282617">uint16</span><span class="op" id="8282623">(</span><span class="num" id="8282624">12345</span><span class="op" id="8282629">)</span><span class="op" id="8282630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282634">uint32</span><span class="op" id="8282640">(</span><span class="num" id="8282641">123456</span><span class="op" id="8282647">)</span><span class="op" id="8282648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282652">uint64</span><span class="op" id="8282658">(</span><span class="num" id="8282659">1234567</span><span class="op" id="8282666">)</span><span class="op" id="8282667">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282671">uintptr</span><span class="op" id="8282678">(</span><span class="num" id="8282679">12345678</span><span class="op" id="8282687">)</span><span class="op" id="8282688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282692">float32</span><span class="op" id="8282699">(</span><span class="num" id="8282700">1.2345</span><span class="op" id="8282706">)</span><span class="op" id="8282707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282711">float64</span><span class="op" id="8282718">(</span><span class="num" id="8282719">1.2345678</span><span class="op" id="8282728">)</span><span class="op" id="8282729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282733">complex64</span><span class="op" id="8282742">(</span><span class="num" id="8282743">1.2345</span>&nbsp;<span class="op" id="8282750">+</span>&nbsp;<span class="num" id="8282752">2.3456i</span><span class="op" id="8282759">)</span><span class="op" id="8282760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282764">complex128</span><span class="op" id="8282774">(</span><span class="num" id="8282775">1.2345678</span>&nbsp;<span class="op" id="8282785">+</span>&nbsp;<span class="num" id="8282787">2.3456789i</span><span class="op" id="8282797">)</span><span class="op" id="8282798">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8282802">[</span><span class="op" id="8282803">]</span><span class="builtintype" id="8282804">byte</span><span class="op" id="8282808">(</span><span class="string" id="8282809">&#34;hello&#34;</span><span class="op" id="8282816">)</span><span class="op" id="8282817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8282821">string</span><span class="op" id="8282827">(</span><span class="string" id="8282828">&#34;hello&#34;</span><span class="op" id="8282835">)</span><span class="op" id="8282836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8282839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8282842">for</span>&nbsp;<span class="ident" id="8282846">_</span><span class="op" id="8282847">,</span>&nbsp;<span class="ident" id="8282849">value</span>&nbsp;<span class="op" id="8282855">:=</span>&nbsp;<span class="keyword" id="8282858">range</span>&nbsp;<span class="ident" id="8282864">values</span>&nbsp;<span class="op" id="8282871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282875">b</span>&nbsp;<span class="op" id="8282877">:=</span>&nbsp;<span class="builtinfunc" id="8282880">new</span><span class="op" id="8282883">(</span><span class="ident" id="8282884">bytes</span><span class="op" id="8282889">.</span><span class="ident" id="8282890">Buffer</span><span class="op" id="8282896">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282900">enc</span>&nbsp;<span class="op" id="8282904">:=</span>&nbsp;<span class="ident" id="8282907">NewEncoder</span><span class="op" id="8282917">(</span><span class="ident" id="8282918">b</span><span class="op" id="8282919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282923">err</span>&nbsp;<span class="op" id="8282927">:=</span>&nbsp;<span class="ident" id="8282930">enc</span><span class="op" id="8282933">.</span><span class="ident" id="8282934">Encode</span><span class="op" id="8282940">(</span><span class="ident" id="8282941">value</span><span class="op" id="8282946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8282950">if</span>&nbsp;<span class="ident" id="8282953">err</span>&nbsp;<span class="op" id="8282957">!=</span>&nbsp;<span class="builtintype" id="8282960">nil</span>&nbsp;<span class="op" id="8282964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282969">t</span><span class="op" id="8282970">.</span><span class="ident" id="8282971">Error</span><span class="op" id="8282976">(</span><span class="string" id="8282977">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="8282992">,</span>&nbsp;<span class="ident" id="8282994">err</span><span class="op" id="8282997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8283001">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283005">dec</span>&nbsp;<span class="op" id="8283009">:=</span>&nbsp;<span class="ident" id="8283012">NewDecoder</span><span class="op" id="8283022">(</span><span class="ident" id="8283023">b</span><span class="op" id="8283024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283028">result</span>&nbsp;<span class="op" id="8283035">:=</span>&nbsp;<span class="ident" id="8283038">reflect</span><span class="op" id="8283045">.</span><span class="ident" id="8283046">New</span><span class="op" id="8283049">(</span><span class="ident" id="8283050">reflect</span><span class="op" id="8283057">.</span><span class="ident" id="8283058">TypeOf</span><span class="op" id="8283064">(</span><span class="ident" id="8283065">value</span><span class="op" id="8283070">)</span><span class="op" id="8283071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283075">err</span>&nbsp;<span class="op" id="8283079">=</span>&nbsp;<span class="ident" id="8283081">dec</span><span class="op" id="8283084">.</span><span class="ident" id="8283085">Decode</span><span class="op" id="8283091">(</span><span class="ident" id="8283092">result</span><span class="op" id="8283098">.</span><span class="ident" id="8283099">Interface</span><span class="op" id="8283108">(</span><span class="op" id="8283109">)</span><span class="op" id="8283110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8283114">if</span>&nbsp;<span class="ident" id="8283117">err</span>&nbsp;<span class="op" id="8283121">!=</span>&nbsp;<span class="builtintype" id="8283124">nil</span>&nbsp;<span class="op" id="8283128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283133">t</span><span class="op" id="8283134">.</span><span class="ident" id="8283135">Fatalf</span><span class="op" id="8283141">(</span><span class="string" id="8283142">&#34;error&nbsp;decoding&nbsp;%T:&nbsp;%v:&#34;</span><span class="op" id="8283166">,</span>&nbsp;<span class="ident" id="8283168">reflect</span><span class="op" id="8283175">.</span><span class="ident" id="8283176">TypeOf</span><span class="op" id="8283182">(</span><span class="ident" id="8283183">value</span><span class="op" id="8283188">)</span><span class="op" id="8283189">,</span>&nbsp;<span class="ident" id="8283191">err</span><span class="op" id="8283194">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8283198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8283202">if</span>&nbsp;<span class="op" id="8283205">!</span><span class="ident" id="8283206">reflect</span><span class="op" id="8283213">.</span><span class="ident" id="8283214">DeepEqual</span><span class="op" id="8283223">(</span><span class="ident" id="8283224">value</span><span class="op" id="8283229">,</span>&nbsp;<span class="ident" id="8283231">result</span><span class="op" id="8283237">.</span><span class="ident" id="8283238">Elem</span><span class="op" id="8283242">(</span><span class="op" id="8283243">)</span><span class="op" id="8283244">.</span><span class="ident" id="8283245">Interface</span><span class="op" id="8283254">(</span><span class="op" id="8283255">)</span><span class="op" id="8283256">)</span>&nbsp;<span class="op" id="8283258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283263">t</span><span class="op" id="8283264">.</span><span class="ident" id="8283265">Fatalf</span><span class="op" id="8283271">(</span><span class="string" id="8283272">&#34;%T:&nbsp;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8283296">,</span>&nbsp;<span class="ident" id="8283298">value</span><span class="op" id="8283303">,</span>&nbsp;<span class="ident" id="8283305">value</span><span class="op" id="8283310">,</span>&nbsp;<span class="ident" id="8283312">result</span><span class="op" id="8283318">.</span><span class="ident" id="8283319">Elem</span><span class="op" id="8283323">(</span><span class="op" id="8283324">)</span><span class="op" id="8283325">.</span><span class="ident" id="8283326">Interface</span><span class="op" id="8283335">(</span><span class="op" id="8283336">)</span><span class="op" id="8283337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8283341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8283344">}</span><br>
<span class="lineno">55</span><span class="op" id="8283346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8283349">type</span>&nbsp;<span class="ident" id="8283354">ET0</span>&nbsp;<span class="keyword" id="8283358">struct</span>&nbsp;<span class="op" id="8283365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283368">A</span>&nbsp;<span class="builtintype" id="8283370">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283375">B</span>&nbsp;<span class="builtintype" id="8283377">string</span><br>
<span class="lineno">60</span><span class="op" id="8283384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8283387">type</span>&nbsp;<span class="ident" id="8283392">ET2</span>&nbsp;<span class="keyword" id="8283396">struct</span>&nbsp;<span class="op" id="8283403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283406">X</span>&nbsp;<span class="builtintype" id="8283408">string</span><br>
<span class="lineno"></span><span class="op" id="8283415">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="8283418">type</span>&nbsp;<span class="ident" id="8283423">ET1</span>&nbsp;<span class="keyword" id="8283427">struct</span>&nbsp;<span class="op" id="8283434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283437">A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8283442">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283447">Et2</span>&nbsp;&nbsp;<span class="op" id="8283452">*</span><span class="ident" id="8283453">ET2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283458">Next</span>&nbsp;<span class="op" id="8283463">*</span><span class="ident" id="8283464">ET1</span><br>
<span class="lineno">70</span><span class="op" id="8283468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8283471">//&nbsp;Like&nbsp;ET1&nbsp;but&nbsp;with&nbsp;a&nbsp;different&nbsp;name&nbsp;for&nbsp;a&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="8283521">type</span>&nbsp;<span class="ident" id="8283526">ET3</span>&nbsp;<span class="keyword" id="8283530">struct</span>&nbsp;<span class="op" id="8283537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283540">A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8283554">int</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283559">Et2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8283573">*</span><span class="ident" id="8283574">ET2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283579">DifferentNext</span>&nbsp;<span class="op" id="8283593">*</span><span class="ident" id="8283594">ET1</span><br>
<span class="lineno"></span><span class="op" id="8283598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8283601">//&nbsp;Like&nbsp;ET1&nbsp;but&nbsp;with&nbsp;a&nbsp;different&nbsp;type&nbsp;for&nbsp;a&nbsp;field</span><br>
<span class="lineno">80</span><span class="keyword" id="8283651">type</span>&nbsp;<span class="ident" id="8283656">ET4</span>&nbsp;<span class="keyword" id="8283660">struct</span>&nbsp;<span class="op" id="8283667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283670">A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8283675">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283680">Et2</span>&nbsp;&nbsp;<span class="builtintype" id="8283685">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283694">Next</span>&nbsp;<span class="builtintype" id="8283699">int</span><br>
<span class="lineno"></span><span class="op" id="8283703">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="8283706">func</span>&nbsp;<span class="ident" id="8283711">TestEncoderDecoder</span><span class="op" id="8283729">(</span><span class="ident" id="8283730">t</span>&nbsp;<span class="op" id="8283732">*</span><span class="ident" id="8283733">testing</span><span class="op" id="8283740">.</span><span class="ident" id="8283741">T</span><span class="op" id="8283742">)</span>&nbsp;<span class="op" id="8283744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283747">b</span>&nbsp;<span class="op" id="8283749">:=</span>&nbsp;<span class="builtinfunc" id="8283752">new</span><span class="op" id="8283755">(</span><span class="ident" id="8283756">bytes</span><span class="op" id="8283761">.</span><span class="ident" id="8283762">Buffer</span><span class="op" id="8283768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283771">enc</span>&nbsp;<span class="op" id="8283775">:=</span>&nbsp;<span class="ident" id="8283778">NewEncoder</span><span class="op" id="8283788">(</span><span class="ident" id="8283789">b</span><span class="op" id="8283790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283793">et0</span>&nbsp;<span class="op" id="8283797">:=</span>&nbsp;<span class="builtinfunc" id="8283800">new</span><span class="op" id="8283803">(</span><span class="ident" id="8283804">ET0</span><span class="op" id="8283807">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283810">et0</span><span class="op" id="8283813">.</span><span class="ident" id="8283814">A</span>&nbsp;<span class="op" id="8283816">=</span>&nbsp;<span class="num" id="8283818">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283821">et0</span><span class="op" id="8283824">.</span><span class="ident" id="8283825">B</span>&nbsp;<span class="op" id="8283827">=</span>&nbsp;<span class="string" id="8283829">&#34;gobs&nbsp;of&nbsp;fun&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283844">err</span>&nbsp;<span class="op" id="8283848">:=</span>&nbsp;<span class="ident" id="8283851">enc</span><span class="op" id="8283854">.</span><span class="ident" id="8283855">Encode</span><span class="op" id="8283861">(</span><span class="ident" id="8283862">et0</span><span class="op" id="8283865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8283868">if</span>&nbsp;<span class="ident" id="8283871">err</span>&nbsp;<span class="op" id="8283875">!=</span>&nbsp;<span class="builtintype" id="8283878">nil</span>&nbsp;<span class="op" id="8283882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283886">t</span><span class="op" id="8283887">.</span><span class="ident" id="8283888">Error</span><span class="op" id="8283893">(</span><span class="string" id="8283894">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="8283909">,</span>&nbsp;<span class="ident" id="8283911">err</span><span class="op" id="8283914">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8283917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8283920">//fmt.Printf(&#34;%&nbsp;x&nbsp;%q\n&#34;,&nbsp;b,&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8283952">//Debug(b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283964">dec</span>&nbsp;<span class="op" id="8283968">:=</span>&nbsp;<span class="ident" id="8283971">NewDecoder</span><span class="op" id="8283981">(</span><span class="ident" id="8283982">b</span><span class="op" id="8283983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283986">newEt0</span>&nbsp;<span class="op" id="8283993">:=</span>&nbsp;<span class="builtinfunc" id="8283996">new</span><span class="op" id="8283999">(</span><span class="ident" id="8284000">ET0</span><span class="op" id="8284003">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284006">err</span>&nbsp;<span class="op" id="8284010">=</span>&nbsp;<span class="ident" id="8284012">dec</span><span class="op" id="8284015">.</span><span class="ident" id="8284016">Decode</span><span class="op" id="8284022">(</span><span class="ident" id="8284023">newEt0</span><span class="op" id="8284029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8284032">if</span>&nbsp;<span class="ident" id="8284035">err</span>&nbsp;<span class="op" id="8284039">!=</span>&nbsp;<span class="builtintype" id="8284042">nil</span>&nbsp;<span class="op" id="8284046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284050">t</span><span class="op" id="8284051">.</span><span class="ident" id="8284052">Fatal</span><span class="op" id="8284057">(</span><span class="string" id="8284058">&#34;error&nbsp;decoding&nbsp;ET0:&#34;</span><span class="op" id="8284079">,</span>&nbsp;<span class="ident" id="8284081">err</span><span class="op" id="8284084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8284087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8284091">if</span>&nbsp;<span class="op" id="8284094">!</span><span class="ident" id="8284095">reflect</span><span class="op" id="8284102">.</span><span class="ident" id="8284103">DeepEqual</span><span class="op" id="8284112">(</span><span class="ident" id="8284113">et0</span><span class="op" id="8284116">,</span>&nbsp;<span class="ident" id="8284118">newEt0</span><span class="op" id="8284124">)</span>&nbsp;<span class="op" id="8284126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284130">t</span><span class="op" id="8284131">.</span><span class="ident" id="8284132">Fatalf</span><span class="op" id="8284138">(</span><span class="string" id="8284139">&#34;invalid&nbsp;data&nbsp;for&nbsp;et0:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="8284184">,</span>&nbsp;<span class="op" id="8284186">*</span><span class="ident" id="8284187">et0</span><span class="op" id="8284190">,</span>&nbsp;<span class="op" id="8284192">*</span><span class="ident" id="8284193">newEt0</span><span class="op" id="8284199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8284202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8284205">if</span>&nbsp;<span class="ident" id="8284208">b</span><span class="op" id="8284209">.</span><span class="ident" id="8284210">Len</span><span class="op" id="8284213">(</span><span class="op" id="8284214">)</span>&nbsp;<span class="op" id="8284216">!=</span>&nbsp;<span class="num" id="8284219">0</span>&nbsp;<span class="op" id="8284221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284225">t</span><span class="op" id="8284226">.</span><span class="ident" id="8284227">Error</span><span class="op" id="8284232">(</span><span class="string" id="8284233">&#34;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="8284246">,</span>&nbsp;<span class="ident" id="8284248">b</span><span class="op" id="8284249">.</span><span class="ident" id="8284250">Len</span><span class="op" id="8284253">(</span><span class="op" id="8284254">)</span><span class="op" id="8284255">,</span>&nbsp;<span class="string" id="8284257">&#34;bytes&nbsp;left&#34;</span><span class="op" id="8284269">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8284272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8284275">//&nbsp;&nbsp;&nbsp;&nbsp;t.FailNow()</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284292">b</span>&nbsp;<span class="op" id="8284294">=</span>&nbsp;<span class="builtinfunc" id="8284296">new</span><span class="op" id="8284299">(</span><span class="ident" id="8284300">bytes</span><span class="op" id="8284305">.</span><span class="ident" id="8284306">Buffer</span><span class="op" id="8284312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284315">enc</span>&nbsp;<span class="op" id="8284319">=</span>&nbsp;<span class="ident" id="8284321">NewEncoder</span><span class="op" id="8284331">(</span><span class="ident" id="8284332">b</span><span class="op" id="8284333">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284336">et1</span>&nbsp;<span class="op" id="8284340">:=</span>&nbsp;<span class="builtinfunc" id="8284343">new</span><span class="op" id="8284346">(</span><span class="ident" id="8284347">ET1</span><span class="op" id="8284350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284353">et1</span><span class="op" id="8284356">.</span><span class="ident" id="8284357">A</span>&nbsp;<span class="op" id="8284359">=</span>&nbsp;<span class="num" id="8284361">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284364">et1</span><span class="op" id="8284367">.</span><span class="ident" id="8284368">Et2</span>&nbsp;<span class="op" id="8284372">=</span>&nbsp;<span class="builtinfunc" id="8284374">new</span><span class="op" id="8284377">(</span><span class="ident" id="8284378">ET2</span><span class="op" id="8284381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284384">err</span>&nbsp;<span class="op" id="8284388">=</span>&nbsp;<span class="ident" id="8284390">enc</span><span class="op" id="8284393">.</span><span class="ident" id="8284394">Encode</span><span class="op" id="8284400">(</span><span class="ident" id="8284401">et1</span><span class="op" id="8284404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8284407">if</span>&nbsp;<span class="ident" id="8284410">err</span>&nbsp;<span class="op" id="8284414">!=</span>&nbsp;<span class="builtintype" id="8284417">nil</span>&nbsp;<span class="op" id="8284421">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284425">t</span><span class="op" id="8284426">.</span><span class="ident" id="8284427">Error</span><span class="op" id="8284432">(</span><span class="string" id="8284433">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="8284448">,</span>&nbsp;<span class="ident" id="8284450">err</span><span class="op" id="8284453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8284456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284459">dec</span>&nbsp;<span class="op" id="8284463">=</span>&nbsp;<span class="ident" id="8284465">NewDecoder</span><span class="op" id="8284475">(</span><span class="ident" id="8284476">b</span><span class="op" id="8284477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284480">newEt1</span>&nbsp;<span class="op" id="8284487">:=</span>&nbsp;<span class="builtinfunc" id="8284490">new</span><span class="op" id="8284493">(</span><span class="ident" id="8284494">ET1</span><span class="op" id="8284497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284500">err</span>&nbsp;<span class="op" id="8284504">=</span>&nbsp;<span class="ident" id="8284506">dec</span><span class="op" id="8284509">.</span><span class="ident" id="8284510">Decode</span><span class="op" id="8284516">(</span><span class="ident" id="8284517">newEt1</span><span class="op" id="8284523">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8284526">if</span>&nbsp;<span class="ident" id="8284529">err</span>&nbsp;<span class="op" id="8284533">!=</span>&nbsp;<span class="builtintype" id="8284536">nil</span>&nbsp;<span class="op" id="8284540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284544">t</span><span class="op" id="8284545">.</span><span class="ident" id="8284546">Fatal</span><span class="op" id="8284551">(</span><span class="string" id="8284552">&#34;error&nbsp;decoding&nbsp;ET1:&#34;</span><span class="op" id="8284573">,</span>&nbsp;<span class="ident" id="8284575">err</span><span class="op" id="8284578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8284581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8284585">if</span>&nbsp;<span class="op" id="8284588">!</span><span class="ident" id="8284589">reflect</span><span class="op" id="8284596">.</span><span class="ident" id="8284597">DeepEqual</span><span class="op" id="8284606">(</span><span class="ident" id="8284607">et1</span><span class="op" id="8284610">,</span>&nbsp;<span class="ident" id="8284612">newEt1</span><span class="op" id="8284618">)</span>&nbsp;<span class="op" id="8284620">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284624">t</span><span class="op" id="8284625">.</span><span class="ident" id="8284626">Fatalf</span><span class="op" id="8284632">(</span><span class="string" id="8284633">&#34;invalid&nbsp;data&nbsp;for&nbsp;et1:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="8284678">,</span>&nbsp;<span class="op" id="8284680">*</span><span class="ident" id="8284681">et1</span><span class="op" id="8284684">,</span>&nbsp;<span class="op" id="8284686">*</span><span class="ident" id="8284687">newEt1</span><span class="op" id="8284693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8284696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8284699">if</span>&nbsp;<span class="ident" id="8284702">b</span><span class="op" id="8284703">.</span><span class="ident" id="8284704">Len</span><span class="op" id="8284707">(</span><span class="op" id="8284708">)</span>&nbsp;<span class="op" id="8284710">!=</span>&nbsp;<span class="num" id="8284713">0</span>&nbsp;<span class="op" id="8284715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284719">t</span><span class="op" id="8284720">.</span><span class="ident" id="8284721">Error</span><span class="op" id="8284726">(</span><span class="string" id="8284727">&#34;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="8284740">,</span>&nbsp;<span class="ident" id="8284742">b</span><span class="op" id="8284743">.</span><span class="ident" id="8284744">Len</span><span class="op" id="8284747">(</span><span class="op" id="8284748">)</span><span class="op" id="8284749">,</span>&nbsp;<span class="string" id="8284751">&#34;bytes&nbsp;left&#34;</span><span class="op" id="8284763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8284766">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284770">enc</span><span class="op" id="8284773">.</span><span class="ident" id="8284774">Encode</span><span class="op" id="8284780">(</span><span class="ident" id="8284781">et1</span><span class="op" id="8284784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284787">newEt1</span>&nbsp;<span class="op" id="8284794">=</span>&nbsp;<span class="builtinfunc" id="8284796">new</span><span class="op" id="8284799">(</span><span class="ident" id="8284800">ET1</span><span class="op" id="8284803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284806">err</span>&nbsp;<span class="op" id="8284810">=</span>&nbsp;<span class="ident" id="8284812">dec</span><span class="op" id="8284815">.</span><span class="ident" id="8284816">Decode</span><span class="op" id="8284822">(</span><span class="ident" id="8284823">newEt1</span><span class="op" id="8284829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8284832">if</span>&nbsp;<span class="ident" id="8284835">err</span>&nbsp;<span class="op" id="8284839">!=</span>&nbsp;<span class="builtintype" id="8284842">nil</span>&nbsp;<span class="op" id="8284846">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284850">t</span><span class="op" id="8284851">.</span><span class="ident" id="8284852">Fatal</span><span class="op" id="8284857">(</span><span class="string" id="8284858">&#34;round&nbsp;2:&nbsp;error&nbsp;decoding&nbsp;ET1:&#34;</span><span class="op" id="8284888">,</span>&nbsp;<span class="ident" id="8284890">err</span><span class="op" id="8284893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8284896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8284899">if</span>&nbsp;<span class="op" id="8284902">!</span><span class="ident" id="8284903">reflect</span><span class="op" id="8284910">.</span><span class="ident" id="8284911">DeepEqual</span><span class="op" id="8284920">(</span><span class="ident" id="8284921">et1</span><span class="op" id="8284924">,</span>&nbsp;<span class="ident" id="8284926">newEt1</span><span class="op" id="8284932">)</span>&nbsp;<span class="op" id="8284934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284938">t</span><span class="op" id="8284939">.</span><span class="ident" id="8284940">Fatalf</span><span class="op" id="8284946">(</span><span class="string" id="8284947">&#34;round&nbsp;2:&nbsp;invalid&nbsp;data&nbsp;for&nbsp;et1:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="8285001">,</span>&nbsp;<span class="op" id="8285003">*</span><span class="ident" id="8285004">et1</span><span class="op" id="8285007">,</span>&nbsp;<span class="op" id="8285009">*</span><span class="ident" id="8285010">newEt1</span><span class="op" id="8285016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8285019">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285022">if</span>&nbsp;<span class="ident" id="8285025">b</span><span class="op" id="8285026">.</span><span class="ident" id="8285027">Len</span><span class="op" id="8285030">(</span><span class="op" id="8285031">)</span>&nbsp;<span class="op" id="8285033">!=</span>&nbsp;<span class="num" id="8285036">0</span>&nbsp;<span class="op" id="8285038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285042">t</span><span class="op" id="8285043">.</span><span class="ident" id="8285044">Error</span><span class="op" id="8285049">(</span><span class="string" id="8285050">&#34;round&nbsp;2:&nbsp;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="8285072">,</span>&nbsp;<span class="ident" id="8285074">b</span><span class="op" id="8285075">.</span><span class="ident" id="8285076">Len</span><span class="op" id="8285079">(</span><span class="op" id="8285080">)</span><span class="op" id="8285081">,</span>&nbsp;<span class="string" id="8285083">&#34;bytes&nbsp;left&#34;</span><span class="op" id="8285095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8285098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8285102">//&nbsp;Now&nbsp;test&nbsp;with&nbsp;a&nbsp;running&nbsp;encoder/decoder&nbsp;pair&nbsp;that&nbsp;we&nbsp;recognize&nbsp;a&nbsp;type&nbsp;mismatch.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285186">err</span>&nbsp;<span class="op" id="8285190">=</span>&nbsp;<span class="ident" id="8285192">enc</span><span class="op" id="8285195">.</span><span class="ident" id="8285196">Encode</span><span class="op" id="8285202">(</span><span class="ident" id="8285203">et1</span><span class="op" id="8285206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285209">if</span>&nbsp;<span class="ident" id="8285212">err</span>&nbsp;<span class="op" id="8285216">!=</span>&nbsp;<span class="builtintype" id="8285219">nil</span>&nbsp;<span class="op" id="8285223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285227">t</span><span class="op" id="8285228">.</span><span class="ident" id="8285229">Error</span><span class="op" id="8285234">(</span><span class="string" id="8285235">&#34;round&nbsp;3:&nbsp;encoder&nbsp;fail:&#34;</span><span class="op" id="8285259">,</span>&nbsp;<span class="ident" id="8285261">err</span><span class="op" id="8285264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8285267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285270">newEt2</span>&nbsp;<span class="op" id="8285277">:=</span>&nbsp;<span class="builtinfunc" id="8285280">new</span><span class="op" id="8285283">(</span><span class="ident" id="8285284">ET2</span><span class="op" id="8285287">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285290">err</span>&nbsp;<span class="op" id="8285294">=</span>&nbsp;<span class="ident" id="8285296">dec</span><span class="op" id="8285299">.</span><span class="ident" id="8285300">Decode</span><span class="op" id="8285306">(</span><span class="ident" id="8285307">newEt2</span><span class="op" id="8285313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285316">if</span>&nbsp;<span class="ident" id="8285319">err</span>&nbsp;<span class="op" id="8285323">==</span>&nbsp;<span class="builtintype" id="8285326">nil</span>&nbsp;<span class="op" id="8285330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285334">t</span><span class="op" id="8285335">.</span><span class="ident" id="8285336">Fatal</span><span class="op" id="8285341">(</span><span class="string" id="8285342">&#34;round&nbsp;3:&nbsp;expected&nbsp;`bad&nbsp;type&#39;&nbsp;error&nbsp;decoding&nbsp;ET2&#34;</span><span class="op" id="8285391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8285394">}</span><br>
<span class="lineno"></span><span class="op" id="8285396">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="8285399">//&nbsp;Run&nbsp;one&nbsp;value&nbsp;through&nbsp;the&nbsp;encoder/decoder,&nbsp;but&nbsp;use&nbsp;the&nbsp;wrong&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="8285469">//&nbsp;Input&nbsp;is&nbsp;always&nbsp;an&nbsp;ET1;&nbsp;we&nbsp;compare&nbsp;it&nbsp;to&nbsp;whatever&nbsp;is&nbsp;under&nbsp;&#39;e&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="8285536">func</span>&nbsp;<span class="ident" id="8285541">badTypeCheck</span><span class="op" id="8285553">(</span><span class="ident" id="8285554">e</span>&nbsp;<span class="keyword" id="8285556">interface</span><span class="op" id="8285565">{</span><span class="op" id="8285566">}</span><span class="op" id="8285567">,</span>&nbsp;<span class="ident" id="8285569">shouldFail</span>&nbsp;<span class="builtintype" id="8285580">bool</span><span class="op" id="8285584">,</span>&nbsp;<span class="ident" id="8285586">msg</span>&nbsp;<span class="builtintype" id="8285590">string</span><span class="op" id="8285596">,</span>&nbsp;<span class="ident" id="8285598">t</span>&nbsp;<span class="op" id="8285600">*</span><span class="ident" id="8285601">testing</span><span class="op" id="8285608">.</span><span class="ident" id="8285609">T</span><span class="op" id="8285610">)</span>&nbsp;<span class="op" id="8285612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285615">b</span>&nbsp;<span class="op" id="8285617">:=</span>&nbsp;<span class="builtinfunc" id="8285620">new</span><span class="op" id="8285623">(</span><span class="ident" id="8285624">bytes</span><span class="op" id="8285629">.</span><span class="ident" id="8285630">Buffer</span><span class="op" id="8285636">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285639">enc</span>&nbsp;<span class="op" id="8285643">:=</span>&nbsp;<span class="ident" id="8285646">NewEncoder</span><span class="op" id="8285656">(</span><span class="ident" id="8285657">b</span><span class="op" id="8285658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285661">et1</span>&nbsp;<span class="op" id="8285665">:=</span>&nbsp;<span class="builtinfunc" id="8285668">new</span><span class="op" id="8285671">(</span><span class="ident" id="8285672">ET1</span><span class="op" id="8285675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285678">et1</span><span class="op" id="8285681">.</span><span class="ident" id="8285682">A</span>&nbsp;<span class="op" id="8285684">=</span>&nbsp;<span class="num" id="8285686">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285689">et1</span><span class="op" id="8285692">.</span><span class="ident" id="8285693">Et2</span>&nbsp;<span class="op" id="8285697">=</span>&nbsp;<span class="builtinfunc" id="8285699">new</span><span class="op" id="8285702">(</span><span class="ident" id="8285703">ET2</span><span class="op" id="8285706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285709">err</span>&nbsp;<span class="op" id="8285713">:=</span>&nbsp;<span class="ident" id="8285716">enc</span><span class="op" id="8285719">.</span><span class="ident" id="8285720">Encode</span><span class="op" id="8285726">(</span><span class="ident" id="8285727">et1</span><span class="op" id="8285730">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285733">if</span>&nbsp;<span class="ident" id="8285736">err</span>&nbsp;<span class="op" id="8285740">!=</span>&nbsp;<span class="builtintype" id="8285743">nil</span>&nbsp;<span class="op" id="8285747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285751">t</span><span class="op" id="8285752">.</span><span class="ident" id="8285753">Error</span><span class="op" id="8285758">(</span><span class="string" id="8285759">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="8285774">,</span>&nbsp;<span class="ident" id="8285776">err</span><span class="op" id="8285779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8285782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285785">dec</span>&nbsp;<span class="op" id="8285789">:=</span>&nbsp;<span class="ident" id="8285792">NewDecoder</span><span class="op" id="8285802">(</span><span class="ident" id="8285803">b</span><span class="op" id="8285804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285807">err</span>&nbsp;<span class="op" id="8285811">=</span>&nbsp;<span class="ident" id="8285813">dec</span><span class="op" id="8285816">.</span><span class="ident" id="8285817">Decode</span><span class="op" id="8285823">(</span><span class="ident" id="8285824">e</span><span class="op" id="8285825">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285828">if</span>&nbsp;<span class="ident" id="8285831">shouldFail</span>&nbsp;<span class="op" id="8285842">&amp;&amp;</span>&nbsp;<span class="ident" id="8285845">err</span>&nbsp;<span class="op" id="8285849">==</span>&nbsp;<span class="builtintype" id="8285852">nil</span>&nbsp;<span class="op" id="8285856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285860">t</span><span class="op" id="8285861">.</span><span class="ident" id="8285862">Error</span><span class="op" id="8285867">(</span><span class="string" id="8285868">&#34;expected&nbsp;error&nbsp;for&#34;</span><span class="op" id="8285888">,</span>&nbsp;<span class="ident" id="8285890">msg</span><span class="op" id="8285893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8285896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285899">if</span>&nbsp;<span class="op" id="8285902">!</span><span class="ident" id="8285903">shouldFail</span>&nbsp;<span class="op" id="8285914">&amp;&amp;</span>&nbsp;<span class="ident" id="8285917">err</span>&nbsp;<span class="op" id="8285921">!=</span>&nbsp;<span class="builtintype" id="8285924">nil</span>&nbsp;<span class="op" id="8285928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285932">t</span><span class="op" id="8285933">.</span><span class="ident" id="8285934">Error</span><span class="op" id="8285939">(</span><span class="string" id="8285940">&#34;unexpected&nbsp;error&nbsp;for&#34;</span><span class="op" id="8285962">,</span>&nbsp;<span class="ident" id="8285964">msg</span><span class="op" id="8285967">,</span>&nbsp;<span class="ident" id="8285969">err</span><span class="op" id="8285972">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8285975">}</span><br>
<span class="lineno"></span><span class="op" id="8285977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8285980">//&nbsp;Test&nbsp;that&nbsp;we&nbsp;recognize&nbsp;a&nbsp;bad&nbsp;type&nbsp;the&nbsp;first&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="8286033">func</span>&nbsp;<span class="ident" id="8286038">TestWrongTypeDecoder</span><span class="op" id="8286058">(</span><span class="ident" id="8286059">t</span>&nbsp;<span class="op" id="8286061">*</span><span class="ident" id="8286062">testing</span><span class="op" id="8286069">.</span><span class="ident" id="8286070">T</span><span class="op" id="8286071">)</span>&nbsp;<span class="op" id="8286073">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286076">badTypeCheck</span><span class="op" id="8286088">(</span><span class="builtinfunc" id="8286089">new</span><span class="op" id="8286092">(</span><span class="ident" id="8286093">ET2</span><span class="op" id="8286096">)</span><span class="op" id="8286097">,</span>&nbsp;<span class="builtintype" id="8286099">true</span><span class="op" id="8286103">,</span>&nbsp;<span class="string" id="8286105">&#34;no&nbsp;fields&nbsp;in&nbsp;common&#34;</span><span class="op" id="8286126">,</span>&nbsp;<span class="ident" id="8286128">t</span><span class="op" id="8286129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286132">badTypeCheck</span><span class="op" id="8286144">(</span><span class="builtinfunc" id="8286145">new</span><span class="op" id="8286148">(</span><span class="ident" id="8286149">ET3</span><span class="op" id="8286152">)</span><span class="op" id="8286153">,</span>&nbsp;<span class="builtintype" id="8286155">false</span><span class="op" id="8286160">,</span>&nbsp;<span class="string" id="8286162">&#34;different&nbsp;name&nbsp;of&nbsp;field&#34;</span><span class="op" id="8286187">,</span>&nbsp;<span class="ident" id="8286189">t</span><span class="op" id="8286190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286193">badTypeCheck</span><span class="op" id="8286205">(</span><span class="builtinfunc" id="8286206">new</span><span class="op" id="8286209">(</span><span class="ident" id="8286210">ET4</span><span class="op" id="8286213">)</span><span class="op" id="8286214">,</span>&nbsp;<span class="builtintype" id="8286216">true</span><span class="op" id="8286220">,</span>&nbsp;<span class="string" id="8286222">&#34;different&nbsp;type&nbsp;of&nbsp;field&#34;</span><span class="op" id="8286247">,</span>&nbsp;<span class="ident" id="8286249">t</span><span class="op" id="8286250">)</span><br>
<span class="lineno"></span><span class="op" id="8286252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="8286255">func</span>&nbsp;<span class="ident" id="8286260">corruptDataCheck</span><span class="op" id="8286276">(</span><span class="ident" id="8286277">s</span>&nbsp;<span class="builtintype" id="8286279">string</span><span class="op" id="8286285">,</span>&nbsp;<span class="ident" id="8286287">err</span>&nbsp;<span class="builtintype" id="8286291">error</span><span class="op" id="8286296">,</span>&nbsp;<span class="ident" id="8286298">t</span>&nbsp;<span class="op" id="8286300">*</span><span class="ident" id="8286301">testing</span><span class="op" id="8286308">.</span><span class="ident" id="8286309">T</span><span class="op" id="8286310">)</span>&nbsp;<span class="op" id="8286312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286315">b</span>&nbsp;<span class="op" id="8286317">:=</span>&nbsp;<span class="ident" id="8286320">bytes</span><span class="op" id="8286325">.</span><span class="ident" id="8286326">NewBufferString</span><span class="op" id="8286341">(</span><span class="ident" id="8286342">s</span><span class="op" id="8286343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286346">dec</span>&nbsp;<span class="op" id="8286350">:=</span>&nbsp;<span class="ident" id="8286353">NewDecoder</span><span class="op" id="8286363">(</span><span class="ident" id="8286364">b</span><span class="op" id="8286365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286368">err1</span>&nbsp;<span class="op" id="8286373">:=</span>&nbsp;<span class="ident" id="8286376">dec</span><span class="op" id="8286379">.</span><span class="ident" id="8286380">Decode</span><span class="op" id="8286386">(</span><span class="builtinfunc" id="8286387">new</span><span class="op" id="8286390">(</span><span class="ident" id="8286391">ET2</span><span class="op" id="8286394">)</span><span class="op" id="8286395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286398">if</span>&nbsp;<span class="ident" id="8286401">err1</span>&nbsp;<span class="op" id="8286406">!=</span>&nbsp;<span class="ident" id="8286409">err</span>&nbsp;<span class="op" id="8286413">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286417">t</span><span class="op" id="8286418">.</span><span class="ident" id="8286419">Errorf</span><span class="op" id="8286425">(</span><span class="string" id="8286426">&#34;from&nbsp;%q&nbsp;expected&nbsp;error&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="8286461">,</span>&nbsp;<span class="ident" id="8286463">s</span><span class="op" id="8286464">,</span>&nbsp;<span class="ident" id="8286466">err</span><span class="op" id="8286469">,</span>&nbsp;<span class="ident" id="8286471">err1</span><span class="op" id="8286475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8286478">}</span><br>
<span class="lineno"></span><span class="op" id="8286480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8286483">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;survive&nbsp;bad&nbsp;data.</span><br>
<span class="lineno">200</span><span class="keyword" id="8286518">func</span>&nbsp;<span class="ident" id="8286523">TestBadData</span><span class="op" id="8286534">(</span><span class="ident" id="8286535">t</span>&nbsp;<span class="op" id="8286537">*</span><span class="ident" id="8286538">testing</span><span class="op" id="8286545">.</span><span class="ident" id="8286546">T</span><span class="op" id="8286547">)</span>&nbsp;<span class="op" id="8286549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286552">corruptDataCheck</span><span class="op" id="8286568">(</span><span class="string" id="8286569">&#34;&#34;</span><span class="op" id="8286571">,</span>&nbsp;<span class="ident" id="8286573">io</span><span class="op" id="8286575">.</span><span class="ident" id="8286576">EOF</span><span class="op" id="8286579">,</span>&nbsp;<span class="ident" id="8286581">t</span><span class="op" id="8286582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286585">corruptDataCheck</span><span class="op" id="8286601">(</span><span class="string" id="8286602">&#34;\x7Fhi&#34;</span><span class="op" id="8286610">,</span>&nbsp;<span class="ident" id="8286612">io</span><span class="op" id="8286614">.</span><span class="ident" id="8286615">ErrUnexpectedEOF</span><span class="op" id="8286631">,</span>&nbsp;<span class="ident" id="8286633">t</span><span class="op" id="8286634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286637">corruptDataCheck</span><span class="op" id="8286653">(</span><span class="string" id="8286654">&#34;\x03now&nbsp;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&#34;</span><span class="op" id="8286692">,</span>&nbsp;<span class="ident" id="8286694">errBadType</span><span class="op" id="8286704">,</span>&nbsp;<span class="ident" id="8286706">t</span><span class="op" id="8286707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8286710">//&nbsp;issue&nbsp;6323.</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286726">corruptDataCheck</span><span class="op" id="8286742">(</span><span class="string" id="8286743">&#34;\x04\x24foo&#34;</span><span class="op" id="8286756">,</span>&nbsp;<span class="ident" id="8286758">errRange</span><span class="op" id="8286766">,</span>&nbsp;<span class="ident" id="8286768">t</span><span class="op" id="8286769">)</span><br>
<span class="lineno"></span><span class="op" id="8286771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8286774">//&nbsp;Types&nbsp;not&nbsp;supported&nbsp;at&nbsp;top&nbsp;level&nbsp;by&nbsp;the&nbsp;Encoder.</span><br>
<span class="lineno"></span><span class="keyword" id="8286826">var</span>&nbsp;<span class="ident" id="8286830">unsupportedValues</span>&nbsp;<span class="op" id="8286848">=</span>&nbsp;<span class="op" id="8286850">[</span><span class="op" id="8286851">]</span><span class="keyword" id="8286852">interface</span><span class="op" id="8286861">{</span><span class="op" id="8286862">}</span><span class="op" id="8286863">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8286866">make</span><span class="op" id="8286870">(</span><span class="keyword" id="8286871">chan</span>&nbsp;<span class="builtintype" id="8286876">int</span><span class="op" id="8286879">)</span><span class="op" id="8286880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286883">func</span><span class="op" id="8286887">(</span><span class="ident" id="8286888">a</span>&nbsp;<span class="builtintype" id="8286890">int</span><span class="op" id="8286893">)</span>&nbsp;<span class="builtintype" id="8286895">bool</span>&nbsp;<span class="op" id="8286900">{</span>&nbsp;<span class="keyword" id="8286902">return</span>&nbsp;<span class="builtintype" id="8286909">true</span>&nbsp;<span class="op" id="8286914">}</span><span class="op" id="8286915">,</span><br>
<span class="lineno"></span><span class="op" id="8286917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8286920">func</span>&nbsp;<span class="ident" id="8286925">TestUnsupported</span><span class="op" id="8286940">(</span><span class="ident" id="8286941">t</span>&nbsp;<span class="op" id="8286943">*</span><span class="ident" id="8286944">testing</span><span class="op" id="8286951">.</span><span class="ident" id="8286952">T</span><span class="op" id="8286953">)</span>&nbsp;<span class="op" id="8286955">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286958">var</span>&nbsp;<span class="ident" id="8286962">b</span>&nbsp;<span class="ident" id="8286964">bytes</span><span class="op" id="8286969">.</span><span class="ident" id="8286970">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286978">enc</span>&nbsp;<span class="op" id="8286982">:=</span>&nbsp;<span class="ident" id="8286985">NewEncoder</span><span class="op" id="8286995">(</span><span class="op" id="8286996">&amp;</span><span class="ident" id="8286997">b</span><span class="op" id="8286998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287001">for</span>&nbsp;<span class="ident" id="8287005">_</span><span class="op" id="8287006">,</span>&nbsp;<span class="ident" id="8287008">v</span>&nbsp;<span class="op" id="8287010">:=</span>&nbsp;<span class="keyword" id="8287013">range</span>&nbsp;<span class="ident" id="8287019">unsupportedValues</span>&nbsp;<span class="op" id="8287037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287041">err</span>&nbsp;<span class="op" id="8287045">:=</span>&nbsp;<span class="ident" id="8287048">enc</span><span class="op" id="8287051">.</span><span class="ident" id="8287052">Encode</span><span class="op" id="8287058">(</span><span class="ident" id="8287059">v</span><span class="op" id="8287060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287064">if</span>&nbsp;<span class="ident" id="8287067">err</span>&nbsp;<span class="op" id="8287071">==</span>&nbsp;<span class="builtintype" id="8287074">nil</span>&nbsp;<span class="op" id="8287078">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287083">t</span><span class="op" id="8287084">.</span><span class="ident" id="8287085">Errorf</span><span class="op" id="8287091">(</span><span class="string" id="8287092">&#34;expected&nbsp;error&nbsp;for&nbsp;%T;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8287125">,</span>&nbsp;<span class="ident" id="8287127">v</span><span class="op" id="8287128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287135">}</span><br>
<span class="lineno"></span><span class="op" id="8287137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="8287140">func</span>&nbsp;<span class="ident" id="8287145">encAndDec</span><span class="op" id="8287154">(</span><span class="ident" id="8287155">in</span><span class="op" id="8287157">,</span>&nbsp;<span class="ident" id="8287159">out</span>&nbsp;<span class="keyword" id="8287163">interface</span><span class="op" id="8287172">{</span><span class="op" id="8287173">}</span><span class="op" id="8287174">)</span>&nbsp;<span class="builtintype" id="8287176">error</span>&nbsp;<span class="op" id="8287182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287185">b</span>&nbsp;<span class="op" id="8287187">:=</span>&nbsp;<span class="builtinfunc" id="8287190">new</span><span class="op" id="8287193">(</span><span class="ident" id="8287194">bytes</span><span class="op" id="8287199">.</span><span class="ident" id="8287200">Buffer</span><span class="op" id="8287206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287209">enc</span>&nbsp;<span class="op" id="8287213">:=</span>&nbsp;<span class="ident" id="8287216">NewEncoder</span><span class="op" id="8287226">(</span><span class="ident" id="8287227">b</span><span class="op" id="8287228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287231">err</span>&nbsp;<span class="op" id="8287235">:=</span>&nbsp;<span class="ident" id="8287238">enc</span><span class="op" id="8287241">.</span><span class="ident" id="8287242">Encode</span><span class="op" id="8287248">(</span><span class="ident" id="8287249">in</span><span class="op" id="8287251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287254">if</span>&nbsp;<span class="ident" id="8287257">err</span>&nbsp;<span class="op" id="8287261">!=</span>&nbsp;<span class="builtintype" id="8287264">nil</span>&nbsp;<span class="op" id="8287268">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287272">return</span>&nbsp;<span class="ident" id="8287279">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287287">dec</span>&nbsp;<span class="op" id="8287291">:=</span>&nbsp;<span class="ident" id="8287294">NewDecoder</span><span class="op" id="8287304">(</span><span class="ident" id="8287305">b</span><span class="op" id="8287306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287309">err</span>&nbsp;<span class="op" id="8287313">=</span>&nbsp;<span class="ident" id="8287315">dec</span><span class="op" id="8287318">.</span><span class="ident" id="8287319">Decode</span><span class="op" id="8287325">(</span><span class="ident" id="8287326">out</span><span class="op" id="8287329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287332">if</span>&nbsp;<span class="ident" id="8287335">err</span>&nbsp;<span class="op" id="8287339">!=</span>&nbsp;<span class="builtintype" id="8287342">nil</span>&nbsp;<span class="op" id="8287346">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287350">return</span>&nbsp;<span class="ident" id="8287357">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287365">return</span>&nbsp;<span class="builtintype" id="8287372">nil</span><br>
<span class="lineno"></span><span class="op" id="8287376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="8287379">func</span>&nbsp;<span class="ident" id="8287384">TestTypeToPtrType</span><span class="op" id="8287401">(</span><span class="ident" id="8287402">t</span>&nbsp;<span class="op" id="8287404">*</span><span class="ident" id="8287405">testing</span><span class="op" id="8287412">.</span><span class="ident" id="8287413">T</span><span class="op" id="8287414">)</span>&nbsp;<span class="op" id="8287416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8287419">//&nbsp;Encode&nbsp;a&nbsp;T,&nbsp;decode&nbsp;a&nbsp;*T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287447">type</span>&nbsp;<span class="ident" id="8287452">Type0</span>&nbsp;<span class="keyword" id="8287458">struct</span>&nbsp;<span class="op" id="8287465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287469">A</span>&nbsp;<span class="builtintype" id="8287471">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287476">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287479">t0</span>&nbsp;<span class="op" id="8287482">:=</span>&nbsp;<span class="ident" id="8287485">Type0</span><span class="op" id="8287490">{</span><span class="num" id="8287491">7</span><span class="op" id="8287492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287495">t0p</span>&nbsp;<span class="op" id="8287499">:=</span>&nbsp;<span class="builtinfunc" id="8287502">new</span><span class="op" id="8287505">(</span><span class="ident" id="8287506">Type0</span><span class="op" id="8287511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287514">if</span>&nbsp;<span class="ident" id="8287517">err</span>&nbsp;<span class="op" id="8287521">:=</span>&nbsp;<span class="ident" id="8287524">encAndDec</span><span class="op" id="8287533">(</span><span class="ident" id="8287534">t0</span><span class="op" id="8287536">,</span>&nbsp;<span class="ident" id="8287538">t0p</span><span class="op" id="8287541">)</span><span class="op" id="8287542">;</span>&nbsp;<span class="ident" id="8287544">err</span>&nbsp;<span class="op" id="8287548">!=</span>&nbsp;<span class="builtintype" id="8287551">nil</span>&nbsp;<span class="op" id="8287555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287559">t</span><span class="op" id="8287560">.</span><span class="ident" id="8287561">Error</span><span class="op" id="8287566">(</span><span class="ident" id="8287567">err</span><span class="op" id="8287570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287573">}</span><br>
<span class="lineno">250</span><span class="op" id="8287575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8287578">func</span>&nbsp;<span class="ident" id="8287583">TestPtrTypeToType</span><span class="op" id="8287600">(</span><span class="ident" id="8287601">t</span>&nbsp;<span class="op" id="8287603">*</span><span class="ident" id="8287604">testing</span><span class="op" id="8287611">.</span><span class="ident" id="8287612">T</span><span class="op" id="8287613">)</span>&nbsp;<span class="op" id="8287615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8287618">//&nbsp;Encode&nbsp;a&nbsp;*T,&nbsp;decode&nbsp;a&nbsp;T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287646">type</span>&nbsp;<span class="ident" id="8287651">Type1</span>&nbsp;<span class="keyword" id="8287657">struct</span>&nbsp;<span class="op" id="8287664">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287668">A</span>&nbsp;<span class="builtintype" id="8287670">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287679">t1p</span>&nbsp;<span class="op" id="8287683">:=</span>&nbsp;<span class="op" id="8287686">&amp;</span><span class="ident" id="8287687">Type1</span><span class="op" id="8287692">{</span><span class="num" id="8287693">17</span><span class="op" id="8287695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287698">var</span>&nbsp;<span class="ident" id="8287702">t1</span>&nbsp;<span class="ident" id="8287705">Type1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287712">if</span>&nbsp;<span class="ident" id="8287715">err</span>&nbsp;<span class="op" id="8287719">:=</span>&nbsp;<span class="ident" id="8287722">encAndDec</span><span class="op" id="8287731">(</span><span class="ident" id="8287732">t1</span><span class="op" id="8287734">,</span>&nbsp;<span class="ident" id="8287736">t1p</span><span class="op" id="8287739">)</span><span class="op" id="8287740">;</span>&nbsp;<span class="ident" id="8287742">err</span>&nbsp;<span class="op" id="8287746">!=</span>&nbsp;<span class="builtintype" id="8287749">nil</span>&nbsp;<span class="op" id="8287753">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287757">t</span><span class="op" id="8287758">.</span><span class="ident" id="8287759">Error</span><span class="op" id="8287764">(</span><span class="ident" id="8287765">err</span><span class="op" id="8287768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287771">}</span><br>
<span class="lineno"></span><span class="op" id="8287773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8287776">func</span>&nbsp;<span class="ident" id="8287781">TestTypeToPtrPtrPtrPtrType</span><span class="op" id="8287807">(</span><span class="ident" id="8287808">t</span>&nbsp;<span class="op" id="8287810">*</span><span class="ident" id="8287811">testing</span><span class="op" id="8287818">.</span><span class="ident" id="8287819">T</span><span class="op" id="8287820">)</span>&nbsp;<span class="op" id="8287822">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287825">type</span>&nbsp;<span class="ident" id="8287830">Type2</span>&nbsp;<span class="keyword" id="8287836">struct</span>&nbsp;<span class="op" id="8287843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287847">A</span>&nbsp;<span class="op" id="8287849">*</span><span class="op" id="8287850">*</span><span class="op" id="8287851">*</span><span class="op" id="8287852">*</span><span class="builtintype" id="8287853">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287865">t2</span>&nbsp;<span class="op" id="8287868">:=</span>&nbsp;<span class="ident" id="8287871">Type2</span><span class="op" id="8287876">{</span><span class="op" id="8287877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287880">t2</span><span class="op" id="8287882">.</span><span class="ident" id="8287883">A</span>&nbsp;<span class="op" id="8287885">=</span>&nbsp;<span class="builtinfunc" id="8287887">new</span><span class="op" id="8287890">(</span><span class="op" id="8287891">*</span><span class="op" id="8287892">*</span><span class="op" id="8287893">*</span><span class="builtintype" id="8287894">float64</span><span class="op" id="8287901">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287904">*</span><span class="ident" id="8287905">t2</span><span class="op" id="8287907">.</span><span class="ident" id="8287908">A</span>&nbsp;<span class="op" id="8287910">=</span>&nbsp;<span class="builtinfunc" id="8287912">new</span><span class="op" id="8287915">(</span><span class="op" id="8287916">*</span><span class="op" id="8287917">*</span><span class="builtintype" id="8287918">float64</span><span class="op" id="8287925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287928">*</span><span class="op" id="8287929">*</span><span class="ident" id="8287930">t2</span><span class="op" id="8287932">.</span><span class="ident" id="8287933">A</span>&nbsp;<span class="op" id="8287935">=</span>&nbsp;<span class="builtinfunc" id="8287937">new</span><span class="op" id="8287940">(</span><span class="op" id="8287941">*</span><span class="builtintype" id="8287942">float64</span><span class="op" id="8287949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287952">*</span><span class="op" id="8287953">*</span><span class="op" id="8287954">*</span><span class="ident" id="8287955">t2</span><span class="op" id="8287957">.</span><span class="ident" id="8287958">A</span>&nbsp;<span class="op" id="8287960">=</span>&nbsp;<span class="builtinfunc" id="8287962">new</span><span class="op" id="8287965">(</span><span class="builtintype" id="8287966">float64</span><span class="op" id="8287973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287976">*</span><span class="op" id="8287977">*</span><span class="op" id="8287978">*</span><span class="op" id="8287979">*</span><span class="ident" id="8287980">t2</span><span class="op" id="8287982">.</span><span class="ident" id="8287983">A</span>&nbsp;<span class="op" id="8287985">=</span>&nbsp;<span class="num" id="8287987">27.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287993">t2pppp</span>&nbsp;<span class="op" id="8288000">:=</span>&nbsp;<span class="builtinfunc" id="8288003">new</span><span class="op" id="8288006">(</span><span class="op" id="8288007">*</span><span class="op" id="8288008">*</span><span class="op" id="8288009">*</span><span class="ident" id="8288010">Type2</span><span class="op" id="8288015">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288018">if</span>&nbsp;<span class="ident" id="8288021">err</span>&nbsp;<span class="op" id="8288025">:=</span>&nbsp;<span class="ident" id="8288028">encAndDec</span><span class="op" id="8288037">(</span><span class="ident" id="8288038">t2</span><span class="op" id="8288040">,</span>&nbsp;<span class="ident" id="8288042">t2pppp</span><span class="op" id="8288048">)</span><span class="op" id="8288049">;</span>&nbsp;<span class="ident" id="8288051">err</span>&nbsp;<span class="op" id="8288055">!=</span>&nbsp;<span class="builtintype" id="8288058">nil</span>&nbsp;<span class="op" id="8288062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288066">t</span><span class="op" id="8288067">.</span><span class="ident" id="8288068">Fatal</span><span class="op" id="8288073">(</span><span class="ident" id="8288074">err</span><span class="op" id="8288077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8288080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288083">if</span>&nbsp;<span class="op" id="8288086">*</span><span class="op" id="8288087">*</span><span class="op" id="8288088">*</span><span class="op" id="8288089">*</span><span class="op" id="8288090">(</span><span class="op" id="8288091">*</span><span class="op" id="8288092">*</span><span class="op" id="8288093">*</span><span class="op" id="8288094">*</span><span class="ident" id="8288095">t2pppp</span><span class="op" id="8288101">)</span><span class="op" id="8288102">.</span><span class="ident" id="8288103">A</span>&nbsp;<span class="op" id="8288105">!=</span>&nbsp;<span class="op" id="8288108">*</span><span class="op" id="8288109">*</span><span class="op" id="8288110">*</span><span class="op" id="8288111">*</span><span class="ident" id="8288112">t2</span><span class="op" id="8288114">.</span><span class="ident" id="8288115">A</span>&nbsp;<span class="op" id="8288117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288121">t</span><span class="op" id="8288122">.</span><span class="ident" id="8288123">Errorf</span><span class="op" id="8288129">(</span><span class="string" id="8288130">&#34;wrong&nbsp;value&nbsp;after&nbsp;decode:&nbsp;%g&nbsp;not&nbsp;%g&#34;</span><span class="op" id="8288167">,</span>&nbsp;<span class="op" id="8288169">*</span><span class="op" id="8288170">*</span><span class="op" id="8288171">*</span><span class="op" id="8288172">*</span><span class="op" id="8288173">(</span><span class="op" id="8288174">*</span><span class="op" id="8288175">*</span><span class="op" id="8288176">*</span><span class="op" id="8288177">*</span><span class="ident" id="8288178">t2pppp</span><span class="op" id="8288184">)</span><span class="op" id="8288185">.</span><span class="ident" id="8288186">A</span><span class="op" id="8288187">,</span>&nbsp;<span class="op" id="8288189">*</span><span class="op" id="8288190">*</span><span class="op" id="8288191">*</span><span class="op" id="8288192">*</span><span class="ident" id="8288193">t2</span><span class="op" id="8288195">.</span><span class="ident" id="8288196">A</span><span class="op" id="8288197">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8288200">}</span><br>
<span class="lineno"></span><span class="op" id="8288202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8288205">func</span>&nbsp;<span class="ident" id="8288210">TestSlice</span><span class="op" id="8288219">(</span><span class="ident" id="8288220">t</span>&nbsp;<span class="op" id="8288222">*</span><span class="ident" id="8288223">testing</span><span class="op" id="8288230">.</span><span class="ident" id="8288231">T</span><span class="op" id="8288232">)</span>&nbsp;<span class="op" id="8288234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288237">type</span>&nbsp;<span class="ident" id="8288242">Type3</span>&nbsp;<span class="keyword" id="8288248">struct</span>&nbsp;<span class="op" id="8288255">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288259">A</span>&nbsp;<span class="op" id="8288261">[</span><span class="op" id="8288262">]</span><span class="builtintype" id="8288263">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8288271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288274">t3p</span>&nbsp;<span class="op" id="8288278">:=</span>&nbsp;<span class="op" id="8288281">&amp;</span><span class="ident" id="8288282">Type3</span><span class="op" id="8288287">{</span><span class="op" id="8288288">[</span><span class="op" id="8288289">]</span><span class="builtintype" id="8288290">string</span><span class="op" id="8288296">{</span><span class="string" id="8288297">&#34;hello&#34;</span><span class="op" id="8288304">,</span>&nbsp;<span class="string" id="8288306">&#34;world&#34;</span><span class="op" id="8288313">}</span><span class="op" id="8288314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288317">var</span>&nbsp;<span class="ident" id="8288321">t3</span>&nbsp;<span class="ident" id="8288324">Type3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288331">if</span>&nbsp;<span class="ident" id="8288334">err</span>&nbsp;<span class="op" id="8288338">:=</span>&nbsp;<span class="ident" id="8288341">encAndDec</span><span class="op" id="8288350">(</span><span class="ident" id="8288351">t3</span><span class="op" id="8288353">,</span>&nbsp;<span class="ident" id="8288355">t3p</span><span class="op" id="8288358">)</span><span class="op" id="8288359">;</span>&nbsp;<span class="ident" id="8288361">err</span>&nbsp;<span class="op" id="8288365">!=</span>&nbsp;<span class="builtintype" id="8288368">nil</span>&nbsp;<span class="op" id="8288372">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288376">t</span><span class="op" id="8288377">.</span><span class="ident" id="8288378">Error</span><span class="op" id="8288383">(</span><span class="ident" id="8288384">err</span><span class="op" id="8288387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8288390">}</span><br>
<span class="lineno"></span><span class="op" id="8288392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8288395">func</span>&nbsp;<span class="ident" id="8288400">TestValueError</span><span class="op" id="8288414">(</span><span class="ident" id="8288415">t</span>&nbsp;<span class="op" id="8288417">*</span><span class="ident" id="8288418">testing</span><span class="op" id="8288425">.</span><span class="ident" id="8288426">T</span><span class="op" id="8288427">)</span>&nbsp;<span class="op" id="8288429">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8288432">//&nbsp;Encode&nbsp;a&nbsp;*T,&nbsp;decode&nbsp;a&nbsp;T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288460">type</span>&nbsp;<span class="ident" id="8288465">Type4</span>&nbsp;<span class="keyword" id="8288471">struct</span>&nbsp;<span class="op" id="8288478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288482">A</span>&nbsp;<span class="builtintype" id="8288484">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8288489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288492">t4p</span>&nbsp;<span class="op" id="8288496">:=</span>&nbsp;<span class="op" id="8288499">&amp;</span><span class="ident" id="8288500">Type4</span><span class="op" id="8288505">{</span><span class="num" id="8288506">3</span><span class="op" id="8288507">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288510">var</span>&nbsp;<span class="ident" id="8288514">t4</span>&nbsp;<span class="ident" id="8288517">Type4</span>&nbsp;<span class="comment" id="8288523">//&nbsp;note:&nbsp;not&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288548">if</span>&nbsp;<span class="ident" id="8288551">err</span>&nbsp;<span class="op" id="8288555">:=</span>&nbsp;<span class="ident" id="8288558">encAndDec</span><span class="op" id="8288567">(</span><span class="ident" id="8288568">t4p</span><span class="op" id="8288571">,</span>&nbsp;<span class="ident" id="8288573">t4</span><span class="op" id="8288575">)</span><span class="op" id="8288576">;</span>&nbsp;<span class="ident" id="8288578">err</span>&nbsp;<span class="op" id="8288582">==</span>&nbsp;<span class="builtintype" id="8288585">nil</span>&nbsp;<span class="op" id="8288589">||</span>&nbsp;<span class="ident" id="8288592">strings</span><span class="op" id="8288599">.</span><span class="ident" id="8288600">Index</span><span class="op" id="8288605">(</span><span class="ident" id="8288606">err</span><span class="op" id="8288609">.</span><span class="ident" id="8288610">Error</span><span class="op" id="8288615">(</span><span class="op" id="8288616">)</span><span class="op" id="8288617">,</span>&nbsp;<span class="string" id="8288619">&#34;pointer&#34;</span><span class="op" id="8288628">)</span>&nbsp;<span class="op" id="8288630">&lt;</span>&nbsp;<span class="num" id="8288632">0</span>&nbsp;<span class="op" id="8288634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288638">t</span><span class="op" id="8288639">.</span><span class="ident" id="8288640">Error</span><span class="op" id="8288645">(</span><span class="string" id="8288646">&#34;expected&nbsp;error&nbsp;about&nbsp;pointer;&nbsp;got&#34;</span><span class="op" id="8288681">,</span>&nbsp;<span class="ident" id="8288683">err</span><span class="op" id="8288686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8288689">}</span><br>
<span class="lineno"></span><span class="op" id="8288691">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="8288694">func</span>&nbsp;<span class="ident" id="8288699">TestArray</span><span class="op" id="8288708">(</span><span class="ident" id="8288709">t</span>&nbsp;<span class="op" id="8288711">*</span><span class="ident" id="8288712">testing</span><span class="op" id="8288719">.</span><span class="ident" id="8288720">T</span><span class="op" id="8288721">)</span>&nbsp;<span class="op" id="8288723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288726">type</span>&nbsp;<span class="ident" id="8288731">Type5</span>&nbsp;<span class="keyword" id="8288737">struct</span>&nbsp;<span class="op" id="8288744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288748">A</span>&nbsp;<span class="op" id="8288750">[</span><span class="num" id="8288751">3</span><span class="op" id="8288752">]</span><span class="builtintype" id="8288753">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288762">B</span>&nbsp;<span class="op" id="8288764">[</span><span class="num" id="8288765">3</span><span class="op" id="8288766">]</span><span class="builtintype" id="8288767">byte</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8288773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288776">type</span>&nbsp;<span class="ident" id="8288781">Type6</span>&nbsp;<span class="keyword" id="8288787">struct</span>&nbsp;<span class="op" id="8288794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288798">A</span>&nbsp;<span class="op" id="8288800">[</span><span class="num" id="8288801">2</span><span class="op" id="8288802">]</span><span class="builtintype" id="8288803">string</span>&nbsp;<span class="comment" id="8288810">//&nbsp;can&#39;t&nbsp;hold&nbsp;t5.a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8288830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288833">t5</span>&nbsp;<span class="op" id="8288836">:=</span>&nbsp;<span class="ident" id="8288839">Type5</span><span class="op" id="8288844">{</span><span class="op" id="8288845">[</span><span class="num" id="8288846">3</span><span class="op" id="8288847">]</span><span class="builtintype" id="8288848">string</span><span class="op" id="8288854">{</span><span class="string" id="8288855">&#34;hello&#34;</span><span class="op" id="8288862">,</span>&nbsp;<span class="string" id="8288864">&#34;,&#34;</span><span class="op" id="8288867">,</span>&nbsp;<span class="string" id="8288869">&#34;world&#34;</span><span class="op" id="8288876">}</span><span class="op" id="8288877">,</span>&nbsp;<span class="op" id="8288879">[</span><span class="num" id="8288880">3</span><span class="op" id="8288881">]</span><span class="builtintype" id="8288882">byte</span><span class="op" id="8288886">{</span><span class="num" id="8288887">1</span><span class="op" id="8288888">,</span>&nbsp;<span class="num" id="8288890">2</span><span class="op" id="8288891">,</span>&nbsp;<span class="num" id="8288893">3</span><span class="op" id="8288894">}</span><span class="op" id="8288895">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288898">var</span>&nbsp;<span class="ident" id="8288902">t5p</span>&nbsp;<span class="ident" id="8288906">Type5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288913">if</span>&nbsp;<span class="ident" id="8288916">err</span>&nbsp;<span class="op" id="8288920">:=</span>&nbsp;<span class="ident" id="8288923">encAndDec</span><span class="op" id="8288932">(</span><span class="ident" id="8288933">t5</span><span class="op" id="8288935">,</span>&nbsp;<span class="op" id="8288937">&amp;</span><span class="ident" id="8288938">t5p</span><span class="op" id="8288941">)</span><span class="op" id="8288942">;</span>&nbsp;<span class="ident" id="8288944">err</span>&nbsp;<span class="op" id="8288948">!=</span>&nbsp;<span class="builtintype" id="8288951">nil</span>&nbsp;<span class="op" id="8288955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288959">t</span><span class="op" id="8288960">.</span><span class="ident" id="8288961">Error</span><span class="op" id="8288966">(</span><span class="ident" id="8288967">err</span><span class="op" id="8288970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8288973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288976">var</span>&nbsp;<span class="ident" id="8288980">t6</span>&nbsp;<span class="ident" id="8288983">Type6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288990">if</span>&nbsp;<span class="ident" id="8288993">err</span>&nbsp;<span class="op" id="8288997">:=</span>&nbsp;<span class="ident" id="8289000">encAndDec</span><span class="op" id="8289009">(</span><span class="ident" id="8289010">t5</span><span class="op" id="8289012">,</span>&nbsp;<span class="op" id="8289014">&amp;</span><span class="ident" id="8289015">t6</span><span class="op" id="8289017">)</span><span class="op" id="8289018">;</span>&nbsp;<span class="ident" id="8289020">err</span>&nbsp;<span class="op" id="8289024">==</span>&nbsp;<span class="builtintype" id="8289027">nil</span>&nbsp;<span class="op" id="8289031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289035">t</span><span class="op" id="8289036">.</span><span class="ident" id="8289037">Error</span><span class="op" id="8289042">(</span><span class="string" id="8289043">&#34;should&nbsp;fail&nbsp;with&nbsp;mismatched&nbsp;array&nbsp;sizes&#34;</span><span class="op" id="8289084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289087">}</span><br>
<span class="lineno"></span><span class="op" id="8289089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="8289092">func</span>&nbsp;<span class="ident" id="8289097">TestRecursiveMapType</span><span class="op" id="8289117">(</span><span class="ident" id="8289118">t</span>&nbsp;<span class="op" id="8289120">*</span><span class="ident" id="8289121">testing</span><span class="op" id="8289128">.</span><span class="ident" id="8289129">T</span><span class="op" id="8289130">)</span>&nbsp;<span class="op" id="8289132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289135">type</span>&nbsp;<span class="ident" id="8289140">recursiveMap</span>&nbsp;<span class="keyword" id="8289153">map</span><span class="op" id="8289156">[</span><span class="builtintype" id="8289157">string</span><span class="op" id="8289163">]</span><span class="ident" id="8289164">recursiveMap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289178">r1</span>&nbsp;<span class="op" id="8289181">:=</span>&nbsp;<span class="ident" id="8289184">recursiveMap</span><span class="op" id="8289196">{</span><span class="string" id="8289197">&#34;A&#34;</span><span class="op" id="8289200">:</span>&nbsp;<span class="ident" id="8289202">recursiveMap</span><span class="op" id="8289214">{</span><span class="string" id="8289215">&#34;B&#34;</span><span class="op" id="8289218">:</span>&nbsp;<span class="builtintype" id="8289220">nil</span><span class="op" id="8289223">,</span>&nbsp;<span class="string" id="8289225">&#34;C&#34;</span><span class="op" id="8289228">:</span>&nbsp;<span class="builtintype" id="8289230">nil</span><span class="op" id="8289233">}</span><span class="op" id="8289234">,</span>&nbsp;<span class="string" id="8289236">&#34;D&#34;</span><span class="op" id="8289239">:</span>&nbsp;<span class="builtintype" id="8289241">nil</span><span class="op" id="8289244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289247">r2</span>&nbsp;<span class="op" id="8289250">:=</span>&nbsp;<span class="builtinfunc" id="8289253">make</span><span class="op" id="8289257">(</span><span class="ident" id="8289258">recursiveMap</span><span class="op" id="8289270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289273">if</span>&nbsp;<span class="ident" id="8289276">err</span>&nbsp;<span class="op" id="8289280">:=</span>&nbsp;<span class="ident" id="8289283">encAndDec</span><span class="op" id="8289292">(</span><span class="ident" id="8289293">r1</span><span class="op" id="8289295">,</span>&nbsp;<span class="op" id="8289297">&amp;</span><span class="ident" id="8289298">r2</span><span class="op" id="8289300">)</span><span class="op" id="8289301">;</span>&nbsp;<span class="ident" id="8289303">err</span>&nbsp;<span class="op" id="8289307">!=</span>&nbsp;<span class="builtintype" id="8289310">nil</span>&nbsp;<span class="op" id="8289314">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289318">t</span><span class="op" id="8289319">.</span><span class="ident" id="8289320">Error</span><span class="op" id="8289325">(</span><span class="ident" id="8289326">err</span><span class="op" id="8289329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289332">}</span><br>
<span class="lineno"></span><span class="op" id="8289334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8289337">func</span>&nbsp;<span class="ident" id="8289342">TestRecursiveSliceType</span><span class="op" id="8289364">(</span><span class="ident" id="8289365">t</span>&nbsp;<span class="op" id="8289367">*</span><span class="ident" id="8289368">testing</span><span class="op" id="8289375">.</span><span class="ident" id="8289376">T</span><span class="op" id="8289377">)</span>&nbsp;<span class="op" id="8289379">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289382">type</span>&nbsp;<span class="ident" id="8289387">recursiveSlice</span>&nbsp;<span class="op" id="8289402">[</span><span class="op" id="8289403">]</span><span class="ident" id="8289404">recursiveSlice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289420">r1</span>&nbsp;<span class="op" id="8289423">:=</span>&nbsp;<span class="ident" id="8289426">recursiveSlice</span><span class="op" id="8289440">{</span><span class="num" id="8289441">0</span><span class="op" id="8289442">:</span>&nbsp;<span class="ident" id="8289444">recursiveSlice</span><span class="op" id="8289458">{</span><span class="num" id="8289459">0</span><span class="op" id="8289460">:</span>&nbsp;<span class="builtintype" id="8289462">nil</span><span class="op" id="8289465">}</span><span class="op" id="8289466">,</span>&nbsp;<span class="num" id="8289468">1</span><span class="op" id="8289469">:</span>&nbsp;<span class="builtintype" id="8289471">nil</span><span class="op" id="8289474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289477">r2</span>&nbsp;<span class="op" id="8289480">:=</span>&nbsp;<span class="builtinfunc" id="8289483">make</span><span class="op" id="8289487">(</span><span class="ident" id="8289488">recursiveSlice</span><span class="op" id="8289502">,</span>&nbsp;<span class="num" id="8289504">0</span><span class="op" id="8289505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289508">if</span>&nbsp;<span class="ident" id="8289511">err</span>&nbsp;<span class="op" id="8289515">:=</span>&nbsp;<span class="ident" id="8289518">encAndDec</span><span class="op" id="8289527">(</span><span class="ident" id="8289528">r1</span><span class="op" id="8289530">,</span>&nbsp;<span class="op" id="8289532">&amp;</span><span class="ident" id="8289533">r2</span><span class="op" id="8289535">)</span><span class="op" id="8289536">;</span>&nbsp;<span class="ident" id="8289538">err</span>&nbsp;<span class="op" id="8289542">!=</span>&nbsp;<span class="builtintype" id="8289545">nil</span>&nbsp;<span class="op" id="8289549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289553">t</span><span class="op" id="8289554">.</span><span class="ident" id="8289555">Error</span><span class="op" id="8289560">(</span><span class="ident" id="8289561">err</span><span class="op" id="8289564">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289567">}</span><br>
<span class="lineno"></span><span class="op" id="8289569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8289572">//&nbsp;Regression&nbsp;test&nbsp;for&nbsp;bug:&nbsp;must&nbsp;send&nbsp;zero&nbsp;values&nbsp;inside&nbsp;arrays</span><br>
<span class="lineno"></span><span class="keyword" id="8289636">func</span>&nbsp;<span class="ident" id="8289641">TestDefaultsInArray</span><span class="op" id="8289660">(</span><span class="ident" id="8289661">t</span>&nbsp;<span class="op" id="8289663">*</span><span class="ident" id="8289664">testing</span><span class="op" id="8289671">.</span><span class="ident" id="8289672">T</span><span class="op" id="8289673">)</span>&nbsp;<span class="op" id="8289675">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289678">type</span>&nbsp;<span class="ident" id="8289683">Type7</span>&nbsp;<span class="keyword" id="8289689">struct</span>&nbsp;<span class="op" id="8289696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289700">B</span>&nbsp;<span class="op" id="8289702">[</span><span class="op" id="8289703">]</span><span class="builtintype" id="8289704">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289711">I</span>&nbsp;<span class="op" id="8289713">[</span><span class="op" id="8289714">]</span><span class="builtintype" id="8289715">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289721">S</span>&nbsp;<span class="op" id="8289723">[</span><span class="op" id="8289724">]</span><span class="builtintype" id="8289725">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289734">F</span>&nbsp;<span class="op" id="8289736">[</span><span class="op" id="8289737">]</span><span class="builtintype" id="8289738">float64</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289750">t7</span>&nbsp;<span class="op" id="8289753">:=</span>&nbsp;<span class="ident" id="8289756">Type7</span><span class="op" id="8289761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289765">[</span><span class="op" id="8289766">]</span><span class="builtintype" id="8289767">bool</span><span class="op" id="8289771">{</span><span class="builtintype" id="8289772">false</span><span class="op" id="8289777">,</span>&nbsp;<span class="builtintype" id="8289779">false</span><span class="op" id="8289784">,</span>&nbsp;<span class="builtintype" id="8289786">true</span><span class="op" id="8289790">}</span><span class="op" id="8289791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289795">[</span><span class="op" id="8289796">]</span><span class="builtintype" id="8289797">int</span><span class="op" id="8289800">{</span><span class="num" id="8289801">0</span><span class="op" id="8289802">,</span>&nbsp;<span class="num" id="8289804">0</span><span class="op" id="8289805">,</span>&nbsp;<span class="num" id="8289807">1</span><span class="op" id="8289808">}</span><span class="op" id="8289809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289813">[</span><span class="op" id="8289814">]</span><span class="builtintype" id="8289815">string</span><span class="op" id="8289821">{</span><span class="string" id="8289822">&#34;hi&#34;</span><span class="op" id="8289826">,</span>&nbsp;<span class="string" id="8289828">&#34;&#34;</span><span class="op" id="8289830">,</span>&nbsp;<span class="string" id="8289832">&#34;there&#34;</span><span class="op" id="8289839">}</span><span class="op" id="8289840">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289844">[</span><span class="op" id="8289845">]</span><span class="builtintype" id="8289846">float64</span><span class="op" id="8289853">{</span><span class="num" id="8289854">0</span><span class="op" id="8289855">,</span>&nbsp;<span class="num" id="8289857">0</span><span class="op" id="8289858">,</span>&nbsp;<span class="num" id="8289860">1</span><span class="op" id="8289861">}</span><span class="op" id="8289862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289868">var</span>&nbsp;<span class="ident" id="8289872">t7p</span>&nbsp;<span class="ident" id="8289876">Type7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289883">if</span>&nbsp;<span class="ident" id="8289886">err</span>&nbsp;<span class="op" id="8289890">:=</span>&nbsp;<span class="ident" id="8289893">encAndDec</span><span class="op" id="8289902">(</span><span class="ident" id="8289903">t7</span><span class="op" id="8289905">,</span>&nbsp;<span class="op" id="8289907">&amp;</span><span class="ident" id="8289908">t7p</span><span class="op" id="8289911">)</span><span class="op" id="8289912">;</span>&nbsp;<span class="ident" id="8289914">err</span>&nbsp;<span class="op" id="8289918">!=</span>&nbsp;<span class="builtintype" id="8289921">nil</span>&nbsp;<span class="op" id="8289925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289929">t</span><span class="op" id="8289930">.</span><span class="ident" id="8289931">Error</span><span class="op" id="8289936">(</span><span class="ident" id="8289937">err</span><span class="op" id="8289940">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289943">}</span><br>
<span class="lineno"></span><span class="op" id="8289945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8289948">var</span>&nbsp;<span class="ident" id="8289952">testInt</span>&nbsp;<span class="builtintype" id="8289960">int</span><br>
<span class="lineno"></span><span class="keyword" id="8289964">var</span>&nbsp;<span class="ident" id="8289968">testFloat32</span>&nbsp;<span class="builtintype" id="8289980">float32</span><br>
<span class="lineno">365</span><span class="keyword" id="8289988">var</span>&nbsp;<span class="ident" id="8289992">testString</span>&nbsp;<span class="builtintype" id="8290003">string</span><br>
<span class="lineno"></span><span class="keyword" id="8290010">var</span>&nbsp;<span class="ident" id="8290014">testSlice</span>&nbsp;<span class="op" id="8290024">[</span><span class="op" id="8290025">]</span><span class="builtintype" id="8290026">string</span><br>
<span class="lineno"></span><span class="keyword" id="8290033">var</span>&nbsp;<span class="ident" id="8290037">testMap</span>&nbsp;<span class="keyword" id="8290045">map</span><span class="op" id="8290048">[</span><span class="builtintype" id="8290049">string</span><span class="op" id="8290055">]</span><span class="builtintype" id="8290056">int</span><br>
<span class="lineno"></span><span class="keyword" id="8290060">var</span>&nbsp;<span class="ident" id="8290064">testArray</span>&nbsp;<span class="op" id="8290074">[</span><span class="num" id="8290075">7</span><span class="op" id="8290076">]</span><span class="builtintype" id="8290077">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="8290082">type</span>&nbsp;<span class="ident" id="8290087">SingleTest</span>&nbsp;<span class="keyword" id="8290098">struct</span>&nbsp;<span class="op" id="8290105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290108">in</span>&nbsp;&nbsp;<span class="keyword" id="8290112">interface</span><span class="op" id="8290121">{</span><span class="op" id="8290122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290125">out</span>&nbsp;<span class="keyword" id="8290129">interface</span><span class="op" id="8290138">{</span><span class="op" id="8290139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290142">err</span>&nbsp;<span class="builtintype" id="8290146">string</span><br>
<span class="lineno"></span><span class="op" id="8290153">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="8290156">var</span>&nbsp;<span class="ident" id="8290160">singleTests</span>&nbsp;<span class="op" id="8290172">=</span>&nbsp;<span class="op" id="8290174">[</span><span class="op" id="8290175">]</span><span class="ident" id="8290176">SingleTest</span><span class="op" id="8290186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8290189">{</span><span class="num" id="8290190">17</span><span class="op" id="8290192">,</span>&nbsp;<span class="op" id="8290194">&amp;</span><span class="ident" id="8290195">testInt</span><span class="op" id="8290202">,</span>&nbsp;<span class="string" id="8290204">&#34;&#34;</span><span class="op" id="8290206">}</span><span class="op" id="8290207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8290210">{</span><span class="builtintype" id="8290211">float32</span><span class="op" id="8290218">(</span><span class="num" id="8290219">17.5</span><span class="op" id="8290223">)</span><span class="op" id="8290224">,</span>&nbsp;<span class="op" id="8290226">&amp;</span><span class="ident" id="8290227">testFloat32</span><span class="op" id="8290238">,</span>&nbsp;<span class="string" id="8290240">&#34;&#34;</span><span class="op" id="8290242">}</span><span class="op" id="8290243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8290246">{</span><span class="string" id="8290247">&#34;bike&nbsp;shed&#34;</span><span class="op" id="8290258">,</span>&nbsp;<span class="op" id="8290260">&amp;</span><span class="ident" id="8290261">testString</span><span class="op" id="8290271">,</span>&nbsp;<span class="string" id="8290273">&#34;&#34;</span><span class="op" id="8290275">}</span><span class="op" id="8290276">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8290279">{</span><span class="op" id="8290280">[</span><span class="op" id="8290281">]</span><span class="builtintype" id="8290282">string</span><span class="op" id="8290288">{</span><span class="string" id="8290289">&#34;bike&#34;</span><span class="op" id="8290295">,</span>&nbsp;<span class="string" id="8290297">&#34;shed&#34;</span><span class="op" id="8290303">,</span>&nbsp;<span class="string" id="8290305">&#34;paint&#34;</span><span class="op" id="8290312">,</span>&nbsp;<span class="string" id="8290314">&#34;color&#34;</span><span class="op" id="8290321">}</span><span class="op" id="8290322">,</span>&nbsp;<span class="op" id="8290324">&amp;</span><span class="ident" id="8290325">testSlice</span><span class="op" id="8290334">,</span>&nbsp;<span class="string" id="8290336">&#34;&#34;</span><span class="op" id="8290338">}</span><span class="op" id="8290339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8290342">{</span><span class="keyword" id="8290343">map</span><span class="op" id="8290346">[</span><span class="builtintype" id="8290347">string</span><span class="op" id="8290353">]</span><span class="builtintype" id="8290354">int</span><span class="op" id="8290357">{</span><span class="string" id="8290358">&#34;seven&#34;</span><span class="op" id="8290365">:</span>&nbsp;<span class="num" id="8290367">7</span><span class="op" id="8290368">,</span>&nbsp;<span class="string" id="8290370">&#34;twelve&#34;</span><span class="op" id="8290378">:</span>&nbsp;<span class="num" id="8290380">12</span><span class="op" id="8290382">}</span><span class="op" id="8290383">,</span>&nbsp;<span class="op" id="8290385">&amp;</span><span class="ident" id="8290386">testMap</span><span class="op" id="8290393">,</span>&nbsp;<span class="string" id="8290395">&#34;&#34;</span><span class="op" id="8290397">}</span><span class="op" id="8290398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8290401">{</span><span class="op" id="8290402">[</span><span class="num" id="8290403">7</span><span class="op" id="8290404">]</span><span class="builtintype" id="8290405">int</span><span class="op" id="8290408">{</span><span class="num" id="8290409">4</span><span class="op" id="8290410">,</span>&nbsp;<span class="num" id="8290412">55</span><span class="op" id="8290414">,</span>&nbsp;<span class="num" id="8290416">0</span><span class="op" id="8290417">,</span>&nbsp;<span class="num" id="8290419">0</span><span class="op" id="8290420">,</span>&nbsp;<span class="num" id="8290422">0</span><span class="op" id="8290423">,</span>&nbsp;<span class="num" id="8290425">0</span><span class="op" id="8290426">,</span>&nbsp;<span class="num" id="8290428">0</span><span class="op" id="8290429">}</span><span class="op" id="8290430">,</span>&nbsp;<span class="op" id="8290432">&amp;</span><span class="ident" id="8290433">testArray</span><span class="op" id="8290442">,</span>&nbsp;<span class="string" id="8290444">&#34;&#34;</span><span class="op" id="8290446">}</span><span class="op" id="8290447">,</span>&nbsp;<span class="comment" id="8290449">//&nbsp;case&nbsp;that&nbsp;once&nbsp;triggered&nbsp;a&nbsp;bug</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8290484">{</span><span class="op" id="8290485">[</span><span class="num" id="8290486">7</span><span class="op" id="8290487">]</span><span class="builtintype" id="8290488">int</span><span class="op" id="8290491">{</span><span class="num" id="8290492">4</span><span class="op" id="8290493">,</span>&nbsp;<span class="num" id="8290495">55</span><span class="op" id="8290497">,</span>&nbsp;<span class="num" id="8290499">1</span><span class="op" id="8290500">,</span>&nbsp;<span class="num" id="8290502">44</span><span class="op" id="8290504">,</span>&nbsp;<span class="num" id="8290506">22</span><span class="op" id="8290508">,</span>&nbsp;<span class="num" id="8290510">66</span><span class="op" id="8290512">,</span>&nbsp;<span class="num" id="8290514">1234</span><span class="op" id="8290518">}</span><span class="op" id="8290519">,</span>&nbsp;<span class="op" id="8290521">&amp;</span><span class="ident" id="8290522">testArray</span><span class="op" id="8290531">,</span>&nbsp;<span class="string" id="8290533">&#34;&#34;</span><span class="op" id="8290535">}</span><span class="op" id="8290536">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8290540">//&nbsp;Decode&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8290558">{</span><span class="num" id="8290559">172</span><span class="op" id="8290562">,</span>&nbsp;<span class="op" id="8290564">&amp;</span><span class="ident" id="8290565">testFloat32</span><span class="op" id="8290576">,</span>&nbsp;<span class="string" id="8290578">&#34;type&#34;</span><span class="op" id="8290584">}</span><span class="op" id="8290585">,</span><br>
<span class="lineno"></span><span class="op" id="8290587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8290590">func</span>&nbsp;<span class="ident" id="8290595">TestSingletons</span><span class="op" id="8290609">(</span><span class="ident" id="8290610">t</span>&nbsp;<span class="op" id="8290612">*</span><span class="ident" id="8290613">testing</span><span class="op" id="8290620">.</span><span class="ident" id="8290621">T</span><span class="op" id="8290622">)</span>&nbsp;<span class="op" id="8290624">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290627">b</span>&nbsp;<span class="op" id="8290629">:=</span>&nbsp;<span class="builtinfunc" id="8290632">new</span><span class="op" id="8290635">(</span><span class="ident" id="8290636">bytes</span><span class="op" id="8290641">.</span><span class="ident" id="8290642">Buffer</span><span class="op" id="8290648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290651">enc</span>&nbsp;<span class="op" id="8290655">:=</span>&nbsp;<span class="ident" id="8290658">NewEncoder</span><span class="op" id="8290668">(</span><span class="ident" id="8290669">b</span><span class="op" id="8290670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290673">dec</span>&nbsp;<span class="op" id="8290677">:=</span>&nbsp;<span class="ident" id="8290680">NewDecoder</span><span class="op" id="8290690">(</span><span class="ident" id="8290691">b</span><span class="op" id="8290692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8290695">for</span>&nbsp;<span class="ident" id="8290699">_</span><span class="op" id="8290700">,</span>&nbsp;<span class="ident" id="8290702">test</span>&nbsp;<span class="op" id="8290707">:=</span>&nbsp;<span class="keyword" id="8290710">range</span>&nbsp;<span class="ident" id="8290716">singleTests</span>&nbsp;<span class="op" id="8290728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290732">b</span><span class="op" id="8290733">.</span><span class="ident" id="8290734">Reset</span><span class="op" id="8290739">(</span><span class="op" id="8290740">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290744">err</span>&nbsp;<span class="op" id="8290748">:=</span>&nbsp;<span class="ident" id="8290751">enc</span><span class="op" id="8290754">.</span><span class="ident" id="8290755">Encode</span><span class="op" id="8290761">(</span><span class="ident" id="8290762">test</span><span class="op" id="8290766">.</span><span class="ident" id="8290767">in</span><span class="op" id="8290769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8290773">if</span>&nbsp;<span class="ident" id="8290776">err</span>&nbsp;<span class="op" id="8290780">!=</span>&nbsp;<span class="builtintype" id="8290783">nil</span>&nbsp;<span class="op" id="8290787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290792">t</span><span class="op" id="8290793">.</span><span class="ident" id="8290794">Errorf</span><span class="op" id="8290800">(</span><span class="string" id="8290801">&#34;error&nbsp;encoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="8290824">,</span>&nbsp;<span class="ident" id="8290826">test</span><span class="op" id="8290830">.</span><span class="ident" id="8290831">in</span><span class="op" id="8290833">,</span>&nbsp;<span class="ident" id="8290835">err</span><span class="op" id="8290838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8290843">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8290854">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290858">err</span>&nbsp;<span class="op" id="8290862">=</span>&nbsp;<span class="ident" id="8290864">dec</span><span class="op" id="8290867">.</span><span class="ident" id="8290868">Decode</span><span class="op" id="8290874">(</span><span class="ident" id="8290875">test</span><span class="op" id="8290879">.</span><span class="ident" id="8290880">out</span><span class="op" id="8290883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8290887">switch</span>&nbsp;<span class="op" id="8290894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8290898">case</span>&nbsp;<span class="ident" id="8290903">err</span>&nbsp;<span class="op" id="8290907">!=</span>&nbsp;<span class="builtintype" id="8290910">nil</span>&nbsp;<span class="op" id="8290914">&amp;&amp;</span>&nbsp;<span class="ident" id="8290917">test</span><span class="op" id="8290921">.</span><span class="ident" id="8290922">err</span>&nbsp;<span class="op" id="8290926">==</span>&nbsp;<span class="string" id="8290929">&#34;&#34;</span><span class="op" id="8290931">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290936">t</span><span class="op" id="8290937">.</span><span class="ident" id="8290938">Errorf</span><span class="op" id="8290944">(</span><span class="string" id="8290945">&#34;error&nbsp;decoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="8290968">,</span>&nbsp;<span class="ident" id="8290970">test</span><span class="op" id="8290974">.</span><span class="ident" id="8290975">in</span><span class="op" id="8290977">,</span>&nbsp;<span class="ident" id="8290979">err</span><span class="op" id="8290982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8290987">continue</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8290998">case</span>&nbsp;<span class="ident" id="8291003">err</span>&nbsp;<span class="op" id="8291007">==</span>&nbsp;<span class="builtintype" id="8291010">nil</span>&nbsp;<span class="op" id="8291014">&amp;&amp;</span>&nbsp;<span class="ident" id="8291017">test</span><span class="op" id="8291021">.</span><span class="ident" id="8291022">err</span>&nbsp;<span class="op" id="8291026">!=</span>&nbsp;<span class="string" id="8291029">&#34;&#34;</span><span class="op" id="8291031">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291036">t</span><span class="op" id="8291037">.</span><span class="ident" id="8291038">Errorf</span><span class="op" id="8291044">(</span><span class="string" id="8291045">&#34;expected&nbsp;error&nbsp;decoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="8291077">,</span>&nbsp;<span class="ident" id="8291079">test</span><span class="op" id="8291083">.</span><span class="ident" id="8291084">in</span><span class="op" id="8291086">,</span>&nbsp;<span class="ident" id="8291088">test</span><span class="op" id="8291092">.</span><span class="ident" id="8291093">err</span><span class="op" id="8291096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291101">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291112">case</span>&nbsp;<span class="ident" id="8291117">err</span>&nbsp;<span class="op" id="8291121">!=</span>&nbsp;<span class="builtintype" id="8291124">nil</span>&nbsp;<span class="op" id="8291128">&amp;&amp;</span>&nbsp;<span class="ident" id="8291131">test</span><span class="op" id="8291135">.</span><span class="ident" id="8291136">err</span>&nbsp;<span class="op" id="8291140">!=</span>&nbsp;<span class="string" id="8291143">&#34;&#34;</span><span class="op" id="8291145">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291150">if</span>&nbsp;<span class="ident" id="8291153">strings</span><span class="op" id="8291160">.</span><span class="ident" id="8291161">Index</span><span class="op" id="8291166">(</span><span class="ident" id="8291167">err</span><span class="op" id="8291170">.</span><span class="ident" id="8291171">Error</span><span class="op" id="8291176">(</span><span class="op" id="8291177">)</span><span class="op" id="8291178">,</span>&nbsp;<span class="ident" id="8291180">test</span><span class="op" id="8291184">.</span><span class="ident" id="8291185">err</span><span class="op" id="8291188">)</span>&nbsp;<span class="op" id="8291190">&lt;</span>&nbsp;<span class="num" id="8291192">0</span>&nbsp;<span class="op" id="8291194">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291200">t</span><span class="op" id="8291201">.</span><span class="ident" id="8291202">Errorf</span><span class="op" id="8291208">(</span><span class="string" id="8291209">&#34;wrong&nbsp;error&nbsp;decoding&nbsp;%v:&nbsp;wanted&nbsp;%s,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8291253">,</span>&nbsp;<span class="ident" id="8291255">test</span><span class="op" id="8291259">.</span><span class="ident" id="8291260">in</span><span class="op" id="8291262">,</span>&nbsp;<span class="ident" id="8291264">test</span><span class="op" id="8291268">.</span><span class="ident" id="8291269">err</span><span class="op" id="8291272">,</span>&nbsp;<span class="ident" id="8291274">err</span><span class="op" id="8291277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291287">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8291302">//&nbsp;Get&nbsp;rid&nbsp;of&nbsp;the&nbsp;pointer&nbsp;in&nbsp;the&nbsp;rhs</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291341">val</span>&nbsp;<span class="op" id="8291345">:=</span>&nbsp;<span class="ident" id="8291348">reflect</span><span class="op" id="8291355">.</span><span class="ident" id="8291356">ValueOf</span><span class="op" id="8291363">(</span><span class="ident" id="8291364">test</span><span class="op" id="8291368">.</span><span class="ident" id="8291369">out</span><span class="op" id="8291372">)</span><span class="op" id="8291373">.</span><span class="ident" id="8291374">Elem</span><span class="op" id="8291378">(</span><span class="op" id="8291379">)</span><span class="op" id="8291380">.</span><span class="ident" id="8291381">Interface</span><span class="op" id="8291390">(</span><span class="op" id="8291391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291395">if</span>&nbsp;<span class="op" id="8291398">!</span><span class="ident" id="8291399">reflect</span><span class="op" id="8291406">.</span><span class="ident" id="8291407">DeepEqual</span><span class="op" id="8291416">(</span><span class="ident" id="8291417">test</span><span class="op" id="8291421">.</span><span class="ident" id="8291422">in</span><span class="op" id="8291424">,</span>&nbsp;<span class="ident" id="8291426">val</span><span class="op" id="8291429">)</span>&nbsp;<span class="op" id="8291431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291436">t</span><span class="op" id="8291437">.</span><span class="ident" id="8291438">Errorf</span><span class="op" id="8291444">(</span><span class="string" id="8291445">&#34;decoding&nbsp;singleton:&nbsp;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8291485">,</span>&nbsp;<span class="ident" id="8291487">test</span><span class="op" id="8291491">.</span><span class="ident" id="8291492">in</span><span class="op" id="8291494">,</span>&nbsp;<span class="ident" id="8291496">val</span><span class="op" id="8291499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291506">}</span><br>
<span class="lineno">420</span><span class="op" id="8291508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8291511">func</span>&nbsp;<span class="ident" id="8291516">TestStructNonStruct</span><span class="op" id="8291535">(</span><span class="ident" id="8291536">t</span>&nbsp;<span class="op" id="8291538">*</span><span class="ident" id="8291539">testing</span><span class="op" id="8291546">.</span><span class="ident" id="8291547">T</span><span class="op" id="8291548">)</span>&nbsp;<span class="op" id="8291550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291553">type</span>&nbsp;<span class="ident" id="8291558">Struct</span>&nbsp;<span class="keyword" id="8291565">struct</span>&nbsp;<span class="op" id="8291572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291576">A</span>&nbsp;<span class="builtintype" id="8291578">string</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291589">type</span>&nbsp;<span class="ident" id="8291594">NonStruct</span>&nbsp;<span class="builtintype" id="8291604">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291612">s</span>&nbsp;<span class="op" id="8291614">:=</span>&nbsp;<span class="ident" id="8291617">Struct</span><span class="op" id="8291623">{</span><span class="string" id="8291624">&#34;hello&#34;</span><span class="op" id="8291631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291634">var</span>&nbsp;<span class="ident" id="8291638">sp</span>&nbsp;<span class="ident" id="8291641">Struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291649">if</span>&nbsp;<span class="ident" id="8291652">err</span>&nbsp;<span class="op" id="8291656">:=</span>&nbsp;<span class="ident" id="8291659">encAndDec</span><span class="op" id="8291668">(</span><span class="ident" id="8291669">s</span><span class="op" id="8291670">,</span>&nbsp;<span class="op" id="8291672">&amp;</span><span class="ident" id="8291673">sp</span><span class="op" id="8291675">)</span><span class="op" id="8291676">;</span>&nbsp;<span class="ident" id="8291678">err</span>&nbsp;<span class="op" id="8291682">!=</span>&nbsp;<span class="builtintype" id="8291685">nil</span>&nbsp;<span class="op" id="8291689">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291693">t</span><span class="op" id="8291694">.</span><span class="ident" id="8291695">Error</span><span class="op" id="8291700">(</span><span class="ident" id="8291701">err</span><span class="op" id="8291704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291710">var</span>&nbsp;<span class="ident" id="8291714">ns</span>&nbsp;<span class="ident" id="8291717">NonStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291728">if</span>&nbsp;<span class="ident" id="8291731">err</span>&nbsp;<span class="op" id="8291735">:=</span>&nbsp;<span class="ident" id="8291738">encAndDec</span><span class="op" id="8291747">(</span><span class="ident" id="8291748">s</span><span class="op" id="8291749">,</span>&nbsp;<span class="op" id="8291751">&amp;</span><span class="ident" id="8291752">ns</span><span class="op" id="8291754">)</span><span class="op" id="8291755">;</span>&nbsp;<span class="ident" id="8291757">err</span>&nbsp;<span class="op" id="8291761">==</span>&nbsp;<span class="builtintype" id="8291764">nil</span>&nbsp;<span class="op" id="8291768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291772">t</span><span class="op" id="8291773">.</span><span class="ident" id="8291774">Error</span><span class="op" id="8291779">(</span><span class="string" id="8291780">&#34;should&nbsp;get&nbsp;error&nbsp;for&nbsp;struct/non-struct&#34;</span><span class="op" id="8291820">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291823">}</span>&nbsp;<span class="keyword" id="8291825">else</span>&nbsp;<span class="keyword" id="8291830">if</span>&nbsp;<span class="ident" id="8291833">strings</span><span class="op" id="8291840">.</span><span class="ident" id="8291841">Index</span><span class="op" id="8291846">(</span><span class="ident" id="8291847">err</span><span class="op" id="8291850">.</span><span class="ident" id="8291851">Error</span><span class="op" id="8291856">(</span><span class="op" id="8291857">)</span><span class="op" id="8291858">,</span>&nbsp;<span class="string" id="8291860">&#34;type&#34;</span><span class="op" id="8291866">)</span>&nbsp;<span class="op" id="8291868">&lt;</span>&nbsp;<span class="num" id="8291870">0</span>&nbsp;<span class="op" id="8291872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291876">t</span><span class="op" id="8291877">.</span><span class="ident" id="8291878">Error</span><span class="op" id="8291883">(</span><span class="string" id="8291884">&#34;for&nbsp;struct/non-struct&nbsp;expected&nbsp;type&nbsp;error;&nbsp;got&#34;</span><span class="op" id="8291932">,</span>&nbsp;<span class="ident" id="8291934">err</span><span class="op" id="8291937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8291943">//&nbsp;Now&nbsp;try&nbsp;the&nbsp;other&nbsp;way</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291969">var</span>&nbsp;<span class="ident" id="8291973">nsp</span>&nbsp;<span class="ident" id="8291977">NonStruct</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291988">if</span>&nbsp;<span class="ident" id="8291991">err</span>&nbsp;<span class="op" id="8291995">:=</span>&nbsp;<span class="ident" id="8291998">encAndDec</span><span class="op" id="8292007">(</span><span class="ident" id="8292008">ns</span><span class="op" id="8292010">,</span>&nbsp;<span class="op" id="8292012">&amp;</span><span class="ident" id="8292013">nsp</span><span class="op" id="8292016">)</span><span class="op" id="8292017">;</span>&nbsp;<span class="ident" id="8292019">err</span>&nbsp;<span class="op" id="8292023">!=</span>&nbsp;<span class="builtintype" id="8292026">nil</span>&nbsp;<span class="op" id="8292030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292034">t</span><span class="op" id="8292035">.</span><span class="ident" id="8292036">Error</span><span class="op" id="8292041">(</span><span class="ident" id="8292042">err</span><span class="op" id="8292045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292051">if</span>&nbsp;<span class="ident" id="8292054">err</span>&nbsp;<span class="op" id="8292058">:=</span>&nbsp;<span class="ident" id="8292061">encAndDec</span><span class="op" id="8292070">(</span><span class="ident" id="8292071">ns</span><span class="op" id="8292073">,</span>&nbsp;<span class="op" id="8292075">&amp;</span><span class="ident" id="8292076">s</span><span class="op" id="8292077">)</span><span class="op" id="8292078">;</span>&nbsp;<span class="ident" id="8292080">err</span>&nbsp;<span class="op" id="8292084">==</span>&nbsp;<span class="builtintype" id="8292087">nil</span>&nbsp;<span class="op" id="8292091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292095">t</span><span class="op" id="8292096">.</span><span class="ident" id="8292097">Error</span><span class="op" id="8292102">(</span><span class="string" id="8292103">&#34;should&nbsp;get&nbsp;error&nbsp;for&nbsp;non-struct/struct&#34;</span><span class="op" id="8292143">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292146">}</span>&nbsp;<span class="keyword" id="8292148">else</span>&nbsp;<span class="keyword" id="8292153">if</span>&nbsp;<span class="ident" id="8292156">strings</span><span class="op" id="8292163">.</span><span class="ident" id="8292164">Index</span><span class="op" id="8292169">(</span><span class="ident" id="8292170">err</span><span class="op" id="8292173">.</span><span class="ident" id="8292174">Error</span><span class="op" id="8292179">(</span><span class="op" id="8292180">)</span><span class="op" id="8292181">,</span>&nbsp;<span class="string" id="8292183">&#34;type&#34;</span><span class="op" id="8292189">)</span>&nbsp;<span class="op" id="8292191">&lt;</span>&nbsp;<span class="num" id="8292193">0</span>&nbsp;<span class="op" id="8292195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292199">t</span><span class="op" id="8292200">.</span><span class="ident" id="8292201">Error</span><span class="op" id="8292206">(</span><span class="string" id="8292207">&#34;for&nbsp;non-struct/struct&nbsp;expected&nbsp;type&nbsp;error;&nbsp;got&#34;</span><span class="op" id="8292255">,</span>&nbsp;<span class="ident" id="8292257">err</span><span class="op" id="8292260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292263">}</span><br>
<span class="lineno"></span><span class="op" id="8292265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">450</span><span class="keyword" id="8292268">type</span>&nbsp;<span class="ident" id="8292273">interfaceIndirectTestI</span>&nbsp;<span class="keyword" id="8292296">interface</span>&nbsp;<span class="op" id="8292306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292309">F</span><span class="op" id="8292310">(</span><span class="op" id="8292311">)</span>&nbsp;<span class="builtintype" id="8292313">bool</span><br>
<span class="lineno"></span><span class="op" id="8292318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8292321">type</span>&nbsp;<span class="ident" id="8292326">interfaceIndirectTestT</span>&nbsp;<span class="keyword" id="8292349">struct</span><span class="op" id="8292355">{</span><span class="op" id="8292356">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span><span class="keyword" id="8292359">func</span>&nbsp;<span class="op" id="8292364">(</span><span class="ident" id="8292365">this</span>&nbsp;<span class="op" id="8292370">*</span><span class="ident" id="8292371">interfaceIndirectTestT</span><span class="op" id="8292393">)</span>&nbsp;<span class="ident" id="8292395">F</span><span class="op" id="8292396">(</span><span class="op" id="8292397">)</span>&nbsp;<span class="builtintype" id="8292399">bool</span>&nbsp;<span class="op" id="8292404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292407">return</span>&nbsp;<span class="builtintype" id="8292414">true</span><br>
<span class="lineno"></span><span class="op" id="8292419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="comment" id="8292422">//&nbsp;A&nbsp;version&nbsp;of&nbsp;a&nbsp;bug&nbsp;reported&nbsp;on&nbsp;golang-nuts.&nbsp;&nbsp;Also&nbsp;tests&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="8292491">//&nbsp;slice&nbsp;of&nbsp;interfaces.&nbsp;&nbsp;The&nbsp;issue&nbsp;was&nbsp;registering&nbsp;*T&nbsp;caused&nbsp;T&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="8292560">//&nbsp;stored&nbsp;as&nbsp;the&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="8292592">func</span>&nbsp;<span class="ident" id="8292597">TestInterfaceIndirect</span><span class="op" id="8292618">(</span><span class="ident" id="8292619">t</span>&nbsp;<span class="op" id="8292621">*</span><span class="ident" id="8292622">testing</span><span class="op" id="8292629">.</span><span class="ident" id="8292630">T</span><span class="op" id="8292631">)</span>&nbsp;<span class="op" id="8292633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292636">Register</span><span class="op" id="8292644">(</span><span class="op" id="8292645">&amp;</span><span class="ident" id="8292646">interfaceIndirectTestT</span><span class="op" id="8292668">{</span><span class="op" id="8292669">}</span><span class="op" id="8292670">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292673">b</span>&nbsp;<span class="op" id="8292675">:=</span>&nbsp;<span class="builtinfunc" id="8292678">new</span><span class="op" id="8292681">(</span><span class="ident" id="8292682">bytes</span><span class="op" id="8292687">.</span><span class="ident" id="8292688">Buffer</span><span class="op" id="8292694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292697">w</span>&nbsp;<span class="op" id="8292699">:=</span>&nbsp;<span class="op" id="8292702">[</span><span class="op" id="8292703">]</span><span class="ident" id="8292704">interfaceIndirectTestI</span><span class="op" id="8292726">{</span><span class="op" id="8292727">&amp;</span><span class="ident" id="8292728">interfaceIndirectTestT</span><span class="op" id="8292750">{</span><span class="op" id="8292751">}</span><span class="op" id="8292752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292755">err</span>&nbsp;<span class="op" id="8292759">:=</span>&nbsp;<span class="ident" id="8292762">NewEncoder</span><span class="op" id="8292772">(</span><span class="ident" id="8292773">b</span><span class="op" id="8292774">)</span><span class="op" id="8292775">.</span><span class="ident" id="8292776">Encode</span><span class="op" id="8292782">(</span><span class="ident" id="8292783">w</span><span class="op" id="8292784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292787">if</span>&nbsp;<span class="ident" id="8292790">err</span>&nbsp;<span class="op" id="8292794">!=</span>&nbsp;<span class="builtintype" id="8292797">nil</span>&nbsp;<span class="op" id="8292801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292805">t</span><span class="op" id="8292806">.</span><span class="ident" id="8292807">Fatal</span><span class="op" id="8292812">(</span><span class="string" id="8292813">&#34;encode&nbsp;error:&#34;</span><span class="op" id="8292828">,</span>&nbsp;<span class="ident" id="8292830">err</span><span class="op" id="8292833">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292840">var</span>&nbsp;<span class="ident" id="8292844">r</span>&nbsp;<span class="op" id="8292846">[</span><span class="op" id="8292847">]</span><span class="ident" id="8292848">interfaceIndirectTestI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292872">err</span>&nbsp;<span class="op" id="8292876">=</span>&nbsp;<span class="ident" id="8292878">NewDecoder</span><span class="op" id="8292888">(</span><span class="ident" id="8292889">b</span><span class="op" id="8292890">)</span><span class="op" id="8292891">.</span><span class="ident" id="8292892">Decode</span><span class="op" id="8292898">(</span><span class="op" id="8292899">&amp;</span><span class="ident" id="8292900">r</span><span class="op" id="8292901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292904">if</span>&nbsp;<span class="ident" id="8292907">err</span>&nbsp;<span class="op" id="8292911">!=</span>&nbsp;<span class="builtintype" id="8292914">nil</span>&nbsp;<span class="op" id="8292918">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292922">t</span><span class="op" id="8292923">.</span><span class="ident" id="8292924">Fatal</span><span class="op" id="8292929">(</span><span class="string" id="8292930">&#34;decode&nbsp;error:&#34;</span><span class="op" id="8292945">,</span>&nbsp;<span class="ident" id="8292947">err</span><span class="op" id="8292950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292953">}</span><br>
<span class="lineno"></span><span class="op" id="8292955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8292958">//&nbsp;Now&nbsp;follow&nbsp;various&nbsp;tests&nbsp;that&nbsp;decode&nbsp;into&nbsp;things&nbsp;that&nbsp;can&#39;t&nbsp;represent&nbsp;the</span><br>
<span class="lineno">480</span><span class="comment" id="8293035">//&nbsp;encoded&nbsp;value,&nbsp;all&nbsp;of&nbsp;which&nbsp;should&nbsp;be&nbsp;legal.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8293084">//&nbsp;Also,&nbsp;when&nbsp;the&nbsp;ignored&nbsp;object&nbsp;contains&nbsp;an&nbsp;interface&nbsp;value,&nbsp;it&nbsp;may&nbsp;define</span><br>
<span class="lineno"></span><span class="comment" id="8293160">//&nbsp;types.&nbsp;Make&nbsp;sure&nbsp;that&nbsp;skipping&nbsp;the&nbsp;value&nbsp;still&nbsp;defines&nbsp;the&nbsp;types&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="8293237">//&nbsp;the&nbsp;encoder/decoder&nbsp;pair&nbsp;to&nbsp;send&nbsp;a&nbsp;value&nbsp;afterwards.&nbsp;&nbsp;If&nbsp;an&nbsp;interface</span><br>
<span class="lineno">485</span><span class="comment" id="8293310">//&nbsp;is&nbsp;sent,&nbsp;its&nbsp;type&nbsp;in&nbsp;the&nbsp;test&nbsp;is&nbsp;always&nbsp;NewType0,&nbsp;so&nbsp;this&nbsp;checks&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="8293387">//&nbsp;encoder&nbsp;and&nbsp;decoder&nbsp;don&#39;t&nbsp;skew&nbsp;with&nbsp;respect&nbsp;to&nbsp;type&nbsp;definitions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8293456">type</span>&nbsp;<span class="ident" id="8293461">Struct0</span>&nbsp;<span class="keyword" id="8293469">struct</span>&nbsp;<span class="op" id="8293476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293479">I</span>&nbsp;<span class="keyword" id="8293481">interface</span><span class="op" id="8293490">{</span><span class="op" id="8293491">}</span><br>
<span class="lineno">490</span><span class="op" id="8293493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8293496">type</span>&nbsp;<span class="ident" id="8293501">NewType0</span>&nbsp;<span class="keyword" id="8293510">struct</span>&nbsp;<span class="op" id="8293517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293520">S</span>&nbsp;<span class="builtintype" id="8293522">string</span><br>
<span class="lineno"></span><span class="op" id="8293529">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="8293532">type</span>&nbsp;<span class="ident" id="8293537">ignoreTest</span>&nbsp;<span class="keyword" id="8293548">struct</span>&nbsp;<span class="op" id="8293555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293558">in</span><span class="op" id="8293560">,</span>&nbsp;<span class="ident" id="8293562">out</span>&nbsp;<span class="keyword" id="8293566">interface</span><span class="op" id="8293575">{</span><span class="op" id="8293576">}</span><br>
<span class="lineno"></span><span class="op" id="8293578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="8293581">var</span>&nbsp;<span class="ident" id="8293585">ignoreTests</span>&nbsp;<span class="op" id="8293597">=</span>&nbsp;<span class="op" id="8293599">[</span><span class="op" id="8293600">]</span><span class="ident" id="8293601">ignoreTest</span><span class="op" id="8293611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8293614">//&nbsp;Decode&nbsp;normal&nbsp;struct&nbsp;into&nbsp;an&nbsp;empty&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8293660">{</span><span class="op" id="8293661">&amp;</span><span class="keyword" id="8293662">struct</span><span class="op" id="8293668">{</span>&nbsp;<span class="ident" id="8293670">A</span>&nbsp;<span class="builtintype" id="8293672">int</span>&nbsp;<span class="op" id="8293676">}</span><span class="op" id="8293677">{</span><span class="num" id="8293678">23</span><span class="op" id="8293680">}</span><span class="op" id="8293681">,</span>&nbsp;<span class="op" id="8293683">&amp;</span><span class="keyword" id="8293684">struct</span><span class="op" id="8293690">{</span><span class="op" id="8293691">}</span><span class="op" id="8293692">{</span><span class="op" id="8293693">}</span><span class="op" id="8293694">}</span><span class="op" id="8293695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8293698">//&nbsp;Decode&nbsp;normal&nbsp;struct&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8293735">{</span><span class="op" id="8293736">&amp;</span><span class="keyword" id="8293737">struct</span><span class="op" id="8293743">{</span>&nbsp;<span class="ident" id="8293745">A</span>&nbsp;<span class="builtintype" id="8293747">int</span>&nbsp;<span class="op" id="8293751">}</span><span class="op" id="8293752">{</span><span class="num" id="8293753">23</span><span class="op" id="8293755">}</span><span class="op" id="8293756">,</span>&nbsp;<span class="builtintype" id="8293758">nil</span><span class="op" id="8293761">}</span><span class="op" id="8293762">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8293765">//&nbsp;Decode&nbsp;singleton&nbsp;string&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8293805">{</span><span class="string" id="8293806">&#34;hello,&nbsp;world&#34;</span><span class="op" id="8293820">,</span>&nbsp;<span class="builtintype" id="8293822">nil</span><span class="op" id="8293825">}</span><span class="op" id="8293826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8293829">//&nbsp;Decode&nbsp;singleton&nbsp;slice&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8293868">{</span><span class="op" id="8293869">[</span><span class="op" id="8293870">]</span><span class="builtintype" id="8293871">int</span><span class="op" id="8293874">{</span><span class="num" id="8293875">1</span><span class="op" id="8293876">,</span>&nbsp;<span class="num" id="8293878">2</span><span class="op" id="8293879">,</span>&nbsp;<span class="num" id="8293881">3</span><span class="op" id="8293882">,</span>&nbsp;<span class="num" id="8293884">4</span><span class="op" id="8293885">}</span><span class="op" id="8293886">,</span>&nbsp;<span class="builtintype" id="8293888">nil</span><span class="op" id="8293891">}</span><span class="op" id="8293892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8293895">//&nbsp;Decode&nbsp;struct&nbsp;containing&nbsp;an&nbsp;interface&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8293949">{</span><span class="op" id="8293950">&amp;</span><span class="ident" id="8293951">Struct0</span><span class="op" id="8293958">{</span><span class="op" id="8293959">&amp;</span><span class="ident" id="8293960">NewType0</span><span class="op" id="8293968">{</span><span class="string" id="8293969">&#34;value0&#34;</span><span class="op" id="8293977">}</span><span class="op" id="8293978">}</span><span class="op" id="8293979">,</span>&nbsp;<span class="builtintype" id="8293981">nil</span><span class="op" id="8293984">}</span><span class="op" id="8293985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8293988">//&nbsp;Decode&nbsp;singleton&nbsp;slice&nbsp;of&nbsp;interfaces&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294041">{</span><span class="op" id="8294042">[</span><span class="op" id="8294043">]</span><span class="keyword" id="8294044">interface</span><span class="op" id="8294053">{</span><span class="op" id="8294054">}</span><span class="op" id="8294055">{</span><span class="string" id="8294056">&#34;hi&#34;</span><span class="op" id="8294060">,</span>&nbsp;<span class="op" id="8294062">&amp;</span><span class="ident" id="8294063">NewType0</span><span class="op" id="8294071">{</span><span class="string" id="8294072">&#34;value1&#34;</span><span class="op" id="8294080">}</span><span class="op" id="8294081">,</span>&nbsp;<span class="num" id="8294083">23</span><span class="op" id="8294085">}</span><span class="op" id="8294086">,</span>&nbsp;<span class="builtintype" id="8294088">nil</span><span class="op" id="8294091">}</span><span class="op" id="8294092">,</span><br>
<span class="lineno"></span><span class="op" id="8294094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="8294097">func</span>&nbsp;<span class="ident" id="8294102">TestDecodeIntoNothing</span><span class="op" id="8294123">(</span><span class="ident" id="8294124">t</span>&nbsp;<span class="op" id="8294126">*</span><span class="ident" id="8294127">testing</span><span class="op" id="8294134">.</span><span class="ident" id="8294135">T</span><span class="op" id="8294136">)</span>&nbsp;<span class="op" id="8294138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294141">Register</span><span class="op" id="8294149">(</span><span class="builtinfunc" id="8294150">new</span><span class="op" id="8294153">(</span><span class="ident" id="8294154">NewType0</span><span class="op" id="8294162">)</span><span class="op" id="8294163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294166">for</span>&nbsp;<span class="ident" id="8294170">i</span><span class="op" id="8294171">,</span>&nbsp;<span class="ident" id="8294173">test</span>&nbsp;<span class="op" id="8294178">:=</span>&nbsp;<span class="keyword" id="8294181">range</span>&nbsp;<span class="ident" id="8294187">ignoreTests</span>&nbsp;<span class="op" id="8294199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294203">b</span>&nbsp;<span class="op" id="8294205">:=</span>&nbsp;<span class="builtinfunc" id="8294208">new</span><span class="op" id="8294211">(</span><span class="ident" id="8294212">bytes</span><span class="op" id="8294217">.</span><span class="ident" id="8294218">Buffer</span><span class="op" id="8294224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294228">enc</span>&nbsp;<span class="op" id="8294232">:=</span>&nbsp;<span class="ident" id="8294235">NewEncoder</span><span class="op" id="8294245">(</span><span class="ident" id="8294246">b</span><span class="op" id="8294247">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294251">err</span>&nbsp;<span class="op" id="8294255">:=</span>&nbsp;<span class="ident" id="8294258">enc</span><span class="op" id="8294261">.</span><span class="ident" id="8294262">Encode</span><span class="op" id="8294268">(</span><span class="ident" id="8294269">test</span><span class="op" id="8294273">.</span><span class="ident" id="8294274">in</span><span class="op" id="8294276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294280">if</span>&nbsp;<span class="ident" id="8294283">err</span>&nbsp;<span class="op" id="8294287">!=</span>&nbsp;<span class="builtintype" id="8294290">nil</span>&nbsp;<span class="op" id="8294294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294299">t</span><span class="op" id="8294300">.</span><span class="ident" id="8294301">Errorf</span><span class="op" id="8294307">(</span><span class="string" id="8294308">&#34;%d:&nbsp;encode&nbsp;error&nbsp;%s:&#34;</span><span class="op" id="8294330">,</span>&nbsp;<span class="ident" id="8294332">i</span><span class="op" id="8294333">,</span>&nbsp;<span class="ident" id="8294335">err</span><span class="op" id="8294338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294343">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294354">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294358">dec</span>&nbsp;<span class="op" id="8294362">:=</span>&nbsp;<span class="ident" id="8294365">NewDecoder</span><span class="op" id="8294375">(</span><span class="ident" id="8294376">b</span><span class="op" id="8294377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294381">err</span>&nbsp;<span class="op" id="8294385">=</span>&nbsp;<span class="ident" id="8294387">dec</span><span class="op" id="8294390">.</span><span class="ident" id="8294391">Decode</span><span class="op" id="8294397">(</span><span class="ident" id="8294398">test</span><span class="op" id="8294402">.</span><span class="ident" id="8294403">out</span><span class="op" id="8294406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294410">if</span>&nbsp;<span class="ident" id="8294413">err</span>&nbsp;<span class="op" id="8294417">!=</span>&nbsp;<span class="builtintype" id="8294420">nil</span>&nbsp;<span class="op" id="8294424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294429">t</span><span class="op" id="8294430">.</span><span class="ident" id="8294431">Errorf</span><span class="op" id="8294437">(</span><span class="string" id="8294438">&#34;%d:&nbsp;decode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8294460">,</span>&nbsp;<span class="ident" id="8294462">i</span><span class="op" id="8294463">,</span>&nbsp;<span class="ident" id="8294465">err</span><span class="op" id="8294468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294473">continue</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8294488">//&nbsp;Now&nbsp;see&nbsp;if&nbsp;the&nbsp;encoder&nbsp;and&nbsp;decoder&nbsp;are&nbsp;in&nbsp;a&nbsp;consistent&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294555">str</span>&nbsp;<span class="op" id="8294559">:=</span>&nbsp;<span class="ident" id="8294562">fmt</span><span class="op" id="8294565">.</span><span class="ident" id="8294566">Sprintf</span><span class="op" id="8294573">(</span><span class="string" id="8294574">&#34;Value&nbsp;%d&#34;</span><span class="op" id="8294584">,</span>&nbsp;<span class="ident" id="8294586">i</span><span class="op" id="8294587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294591">err</span>&nbsp;<span class="op" id="8294595">=</span>&nbsp;<span class="ident" id="8294597">enc</span><span class="op" id="8294600">.</span><span class="ident" id="8294601">Encode</span><span class="op" id="8294607">(</span><span class="op" id="8294608">&amp;</span><span class="ident" id="8294609">NewType0</span><span class="op" id="8294617">{</span><span class="ident" id="8294618">str</span><span class="op" id="8294621">}</span><span class="op" id="8294622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294626">if</span>&nbsp;<span class="ident" id="8294629">err</span>&nbsp;<span class="op" id="8294633">!=</span>&nbsp;<span class="builtintype" id="8294636">nil</span>&nbsp;<span class="op" id="8294640">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294645">t</span><span class="op" id="8294646">.</span><span class="ident" id="8294647">Fatalf</span><span class="op" id="8294653">(</span><span class="string" id="8294654">&#34;%d:&nbsp;NewType0&nbsp;encode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8294685">,</span>&nbsp;<span class="ident" id="8294687">i</span><span class="op" id="8294688">,</span>&nbsp;<span class="ident" id="8294690">err</span><span class="op" id="8294693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294701">ns</span>&nbsp;<span class="op" id="8294704">:=</span>&nbsp;<span class="builtinfunc" id="8294707">new</span><span class="op" id="8294710">(</span><span class="ident" id="8294711">NewType0</span><span class="op" id="8294719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294723">err</span>&nbsp;<span class="op" id="8294727">=</span>&nbsp;<span class="ident" id="8294729">dec</span><span class="op" id="8294732">.</span><span class="ident" id="8294733">Decode</span><span class="op" id="8294739">(</span><span class="ident" id="8294740">ns</span><span class="op" id="8294742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294746">if</span>&nbsp;<span class="ident" id="8294749">err</span>&nbsp;<span class="op" id="8294753">!=</span>&nbsp;<span class="builtintype" id="8294756">nil</span>&nbsp;<span class="op" id="8294760">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294765">t</span><span class="op" id="8294766">.</span><span class="ident" id="8294767">Fatalf</span><span class="op" id="8294773">(</span><span class="string" id="8294774">&#34;%d:&nbsp;NewType0&nbsp;decode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8294805">,</span>&nbsp;<span class="ident" id="8294807">i</span><span class="op" id="8294808">,</span>&nbsp;<span class="ident" id="8294810">err</span><span class="op" id="8294813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294821">if</span>&nbsp;<span class="ident" id="8294824">ns</span><span class="op" id="8294826">.</span><span class="ident" id="8294827">S</span>&nbsp;<span class="op" id="8294829">!=</span>&nbsp;<span class="ident" id="8294832">str</span>&nbsp;<span class="op" id="8294836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294841">t</span><span class="op" id="8294842">.</span><span class="ident" id="8294843">Fatalf</span><span class="op" id="8294849">(</span><span class="string" id="8294850">&#34;%d:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8294874">,</span>&nbsp;<span class="ident" id="8294876">i</span><span class="op" id="8294877">,</span>&nbsp;<span class="ident" id="8294879">str</span><span class="op" id="8294882">,</span>&nbsp;<span class="ident" id="8294884">ns</span><span class="op" id="8294886">.</span><span class="ident" id="8294887">S</span><span class="op" id="8294888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294892">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294895">}</span><br>
<span class="lineno"></span><span class="op" id="8294897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8294900">//&nbsp;Another&nbsp;bug&nbsp;from&nbsp;golang-nuts,&nbsp;involving&nbsp;nested&nbsp;interfaces.</span><br>
<span class="lineno"></span><span class="keyword" id="8294962">type</span>&nbsp;<span class="ident" id="8294967">Bug0Outer</span>&nbsp;<span class="keyword" id="8294977">struct</span>&nbsp;<span class="op" id="8294984">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294987">Bug0Field</span>&nbsp;<span class="keyword" id="8294997">interface</span><span class="op" id="8295006">{</span><span class="op" id="8295007">}</span><br>
<span class="lineno"></span><span class="op" id="8295009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8295012">type</span>&nbsp;<span class="ident" id="8295017">Bug0Inner</span>&nbsp;<span class="keyword" id="8295027">struct</span>&nbsp;<span class="op" id="8295034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295037">A</span>&nbsp;<span class="builtintype" id="8295039">int</span><br>
<span class="lineno">555</span><span class="op" id="8295043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8295046">func</span>&nbsp;<span class="ident" id="8295051">TestNestedInterfaces</span><span class="op" id="8295071">(</span><span class="ident" id="8295072">t</span>&nbsp;<span class="op" id="8295074">*</span><span class="ident" id="8295075">testing</span><span class="op" id="8295082">.</span><span class="ident" id="8295083">T</span><span class="op" id="8295084">)</span>&nbsp;<span class="op" id="8295086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295089">var</span>&nbsp;<span class="ident" id="8295093">buf</span>&nbsp;<span class="ident" id="8295097">bytes</span><span class="op" id="8295102">.</span><span class="ident" id="8295103">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295111">e</span>&nbsp;<span class="op" id="8295113">:=</span>&nbsp;<span class="ident" id="8295116">NewEncoder</span><span class="op" id="8295126">(</span><span class="op" id="8295127">&amp;</span><span class="ident" id="8295128">buf</span><span class="op" id="8295131">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295134">d</span>&nbsp;<span class="op" id="8295136">:=</span>&nbsp;<span class="ident" id="8295139">NewDecoder</span><span class="op" id="8295149">(</span><span class="op" id="8295150">&amp;</span><span class="ident" id="8295151">buf</span><span class="op" id="8295154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295157">Register</span><span class="op" id="8295165">(</span><span class="builtinfunc" id="8295166">new</span><span class="op" id="8295169">(</span><span class="ident" id="8295170">Bug0Outer</span><span class="op" id="8295179">)</span><span class="op" id="8295180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295183">Register</span><span class="op" id="8295191">(</span><span class="builtinfunc" id="8295192">new</span><span class="op" id="8295195">(</span><span class="ident" id="8295196">Bug0Inner</span><span class="op" id="8295205">)</span><span class="op" id="8295206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295209">f</span>&nbsp;<span class="op" id="8295211">:=</span>&nbsp;<span class="op" id="8295214">&amp;</span><span class="ident" id="8295215">Bug0Outer</span><span class="op" id="8295224">{</span><span class="op" id="8295225">&amp;</span><span class="ident" id="8295226">Bug0Outer</span><span class="op" id="8295235">{</span><span class="op" id="8295236">&amp;</span><span class="ident" id="8295237">Bug0Inner</span><span class="op" id="8295246">{</span><span class="num" id="8295247">7</span><span class="op" id="8295248">}</span><span class="op" id="8295249">}</span><span class="op" id="8295250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295253">var</span>&nbsp;<span class="ident" id="8295257">v</span>&nbsp;<span class="keyword" id="8295259">interface</span><span class="op" id="8295268">{</span><span class="op" id="8295269">}</span>&nbsp;<span class="op" id="8295271">=</span>&nbsp;<span class="ident" id="8295273">f</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295276">err</span>&nbsp;<span class="op" id="8295280">:=</span>&nbsp;<span class="ident" id="8295283">e</span><span class="op" id="8295284">.</span><span class="ident" id="8295285">Encode</span><span class="op" id="8295291">(</span><span class="op" id="8295292">&amp;</span><span class="ident" id="8295293">v</span><span class="op" id="8295294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295297">if</span>&nbsp;<span class="ident" id="8295300">err</span>&nbsp;<span class="op" id="8295304">!=</span>&nbsp;<span class="builtintype" id="8295307">nil</span>&nbsp;<span class="op" id="8295311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295315">t</span><span class="op" id="8295316">.</span><span class="ident" id="8295317">Fatal</span><span class="op" id="8295322">(</span><span class="string" id="8295323">&#34;Encode:&#34;</span><span class="op" id="8295332">,</span>&nbsp;<span class="ident" id="8295334">err</span><span class="op" id="8295337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295343">err</span>&nbsp;<span class="op" id="8295347">=</span>&nbsp;<span class="ident" id="8295349">d</span><span class="op" id="8295350">.</span><span class="ident" id="8295351">Decode</span><span class="op" id="8295357">(</span><span class="op" id="8295358">&amp;</span><span class="ident" id="8295359">v</span><span class="op" id="8295360">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295363">if</span>&nbsp;<span class="ident" id="8295366">err</span>&nbsp;<span class="op" id="8295370">!=</span>&nbsp;<span class="builtintype" id="8295373">nil</span>&nbsp;<span class="op" id="8295377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295381">t</span><span class="op" id="8295382">.</span><span class="ident" id="8295383">Fatal</span><span class="op" id="8295388">(</span><span class="string" id="8295389">&#34;Decode:&#34;</span><span class="op" id="8295398">,</span>&nbsp;<span class="ident" id="8295400">err</span><span class="op" id="8295403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8295409">//&nbsp;Make&nbsp;sure&nbsp;it&nbsp;decoded&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295445">outer1</span><span class="op" id="8295451">,</span>&nbsp;<span class="ident" id="8295453">ok</span>&nbsp;<span class="op" id="8295456">:=</span>&nbsp;<span class="ident" id="8295459">v</span><span class="op" id="8295460">.</span><span class="op" id="8295461">(</span><span class="op" id="8295462">*</span><span class="ident" id="8295463">Bug0Outer</span><span class="op" id="8295472">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295475">if</span>&nbsp;<span class="op" id="8295478">!</span><span class="ident" id="8295479">ok</span>&nbsp;<span class="op" id="8295482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295486">t</span><span class="op" id="8295487">.</span><span class="ident" id="8295488">Fatalf</span><span class="op" id="8295494">(</span><span class="string" id="8295495">&#34;v&nbsp;not&nbsp;Bug0Outer:&nbsp;%T&#34;</span><span class="op" id="8295516">,</span>&nbsp;<span class="ident" id="8295518">v</span><span class="op" id="8295519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295525">outer2</span><span class="op" id="8295531">,</span>&nbsp;<span class="ident" id="8295533">ok</span>&nbsp;<span class="op" id="8295536">:=</span>&nbsp;<span class="ident" id="8295539">outer1</span><span class="op" id="8295545">.</span><span class="ident" id="8295546">Bug0Field</span><span class="op" id="8295555">.</span><span class="op" id="8295556">(</span><span class="op" id="8295557">*</span><span class="ident" id="8295558">Bug0Outer</span><span class="op" id="8295567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295570">if</span>&nbsp;<span class="op" id="8295573">!</span><span class="ident" id="8295574">ok</span>&nbsp;<span class="op" id="8295577">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295581">t</span><span class="op" id="8295582">.</span><span class="ident" id="8295583">Fatalf</span><span class="op" id="8295589">(</span><span class="string" id="8295590">&#34;v.Bug0Field&nbsp;not&nbsp;Bug0Outer:&nbsp;%T&#34;</span><span class="op" id="8295621">,</span>&nbsp;<span class="ident" id="8295623">outer1</span><span class="op" id="8295629">.</span><span class="ident" id="8295630">Bug0Field</span><span class="op" id="8295639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295645">inner</span><span class="op" id="8295650">,</span>&nbsp;<span class="ident" id="8295652">ok</span>&nbsp;<span class="op" id="8295655">:=</span>&nbsp;<span class="ident" id="8295658">outer2</span><span class="op" id="8295664">.</span><span class="ident" id="8295665">Bug0Field</span><span class="op" id="8295674">.</span><span class="op" id="8295675">(</span><span class="op" id="8295676">*</span><span class="ident" id="8295677">Bug0Inner</span><span class="op" id="8295686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295689">if</span>&nbsp;<span class="op" id="8295692">!</span><span class="ident" id="8295693">ok</span>&nbsp;<span class="op" id="8295696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295700">t</span><span class="op" id="8295701">.</span><span class="ident" id="8295702">Fatalf</span><span class="op" id="8295708">(</span><span class="string" id="8295709">&#34;v.Bug0Field.Bug0Field&nbsp;not&nbsp;Bug0Inner:&nbsp;%T&#34;</span><span class="op" id="8295750">,</span>&nbsp;<span class="ident" id="8295752">outer2</span><span class="op" id="8295758">.</span><span class="ident" id="8295759">Bug0Field</span><span class="op" id="8295768">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295774">if</span>&nbsp;<span class="ident" id="8295777">inner</span><span class="op" id="8295782">.</span><span class="ident" id="8295783">A</span>&nbsp;<span class="op" id="8295785">!=</span>&nbsp;<span class="num" id="8295788">7</span>&nbsp;<span class="op" id="8295790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295794">t</span><span class="op" id="8295795">.</span><span class="ident" id="8295796">Fatalf</span><span class="op" id="8295802">(</span><span class="string" id="8295803">&#34;final&nbsp;value&nbsp;%d;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8295832">,</span>&nbsp;<span class="ident" id="8295834">inner</span><span class="op" id="8295839">.</span><span class="ident" id="8295840">A</span><span class="op" id="8295841">,</span>&nbsp;<span class="num" id="8295843">7</span><span class="op" id="8295844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295847">}</span><br>
<span class="lineno"></span><span class="op" id="8295849">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="8295852">//&nbsp;The&nbsp;bugs&nbsp;keep&nbsp;coming.&nbsp;We&nbsp;forgot&nbsp;to&nbsp;send&nbsp;map&nbsp;subtypes&nbsp;before&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8295925">type</span>&nbsp;<span class="ident" id="8295930">Bug1Elem</span>&nbsp;<span class="keyword" id="8295939">struct</span>&nbsp;<span class="op" id="8295946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295949">Name</span>&nbsp;<span class="builtintype" id="8295954">string</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295962">Id</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8295967">int</span><br>
<span class="lineno"></span><span class="op" id="8295971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8295974">type</span>&nbsp;<span class="ident" id="8295979">Bug1StructMap</span>&nbsp;<span class="keyword" id="8295993">map</span><span class="op" id="8295996">[</span><span class="builtintype" id="8295997">string</span><span class="op" id="8296003">]</span><span class="ident" id="8296004">Bug1Elem</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span><span class="keyword" id="8296014">func</span>&nbsp;<span class="ident" id="8296019">bug1EncDec</span><span class="op" id="8296029">(</span><span class="ident" id="8296030">in</span>&nbsp;<span class="ident" id="8296033">Bug1StructMap</span><span class="op" id="8296046">,</span>&nbsp;<span class="ident" id="8296048">out</span>&nbsp;<span class="op" id="8296052">*</span><span class="ident" id="8296053">Bug1StructMap</span><span class="op" id="8296066">)</span>&nbsp;<span class="builtintype" id="8296068">error</span>&nbsp;<span class="op" id="8296074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8296077">return</span>&nbsp;<span class="builtintype" id="8296084">nil</span><br>
<span class="lineno"></span><span class="op" id="8296088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8296091">func</span>&nbsp;<span class="ident" id="8296096">TestMapBug1</span><span class="op" id="8296107">(</span><span class="ident" id="8296108">t</span>&nbsp;<span class="op" id="8296110">*</span><span class="ident" id="8296111">testing</span><span class="op" id="8296118">.</span><span class="ident" id="8296119">T</span><span class="op" id="8296120">)</span>&nbsp;<span class="op" id="8296122">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296125">in</span>&nbsp;<span class="op" id="8296128">:=</span>&nbsp;<span class="builtinfunc" id="8296131">make</span><span class="op" id="8296135">(</span><span class="ident" id="8296136">Bug1StructMap</span><span class="op" id="8296149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296152">in</span><span class="op" id="8296154">[</span><span class="string" id="8296155">&#34;val1&#34;</span><span class="op" id="8296161">]</span>&nbsp;<span class="op" id="8296163">=</span>&nbsp;<span class="ident" id="8296165">Bug1Elem</span><span class="op" id="8296173">{</span><span class="string" id="8296174">&#34;elem1&#34;</span><span class="op" id="8296181">,</span>&nbsp;<span class="num" id="8296183">1</span><span class="op" id="8296184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296187">in</span><span class="op" id="8296189">[</span><span class="string" id="8296190">&#34;val2&#34;</span><span class="op" id="8296196">]</span>&nbsp;<span class="op" id="8296198">=</span>&nbsp;<span class="ident" id="8296200">Bug1Elem</span><span class="op" id="8296208">{</span><span class="string" id="8296209">&#34;elem2&#34;</span><span class="op" id="8296216">,</span>&nbsp;<span class="num" id="8296218">2</span><span class="op" id="8296219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296223">b</span>&nbsp;<span class="op" id="8296225">:=</span>&nbsp;<span class="builtinfunc" id="8296228">new</span><span class="op" id="8296231">(</span><span class="ident" id="8296232">bytes</span><span class="op" id="8296237">.</span><span class="ident" id="8296238">Buffer</span><span class="op" id="8296244">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296247">enc</span>&nbsp;<span class="op" id="8296251">:=</span>&nbsp;<span class="ident" id="8296254">NewEncoder</span><span class="op" id="8296264">(</span><span class="ident" id="8296265">b</span><span class="op" id="8296266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296269">err</span>&nbsp;<span class="op" id="8296273">:=</span>&nbsp;<span class="ident" id="8296276">enc</span><span class="op" id="8296279">.</span><span class="ident" id="8296280">Encode</span><span class="op" id="8296286">(</span><span class="ident" id="8296287">in</span><span class="op" id="8296289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8296292">if</span>&nbsp;<span class="ident" id="8296295">err</span>&nbsp;<span class="op" id="8296299">!=</span>&nbsp;<span class="builtintype" id="8296302">nil</span>&nbsp;<span class="op" id="8296306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296310">t</span><span class="op" id="8296311">.</span><span class="ident" id="8296312">Fatal</span><span class="op" id="8296317">(</span><span class="string" id="8296318">&#34;encode:&#34;</span><span class="op" id="8296327">,</span>&nbsp;<span class="ident" id="8296329">err</span><span class="op" id="8296332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8296335">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296338">dec</span>&nbsp;<span class="op" id="8296342">:=</span>&nbsp;<span class="ident" id="8296345">NewDecoder</span><span class="op" id="8296355">(</span><span class="ident" id="8296356">b</span><span class="op" id="8296357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296360">out</span>&nbsp;<span class="op" id="8296364">:=</span>&nbsp;<span class="builtinfunc" id="8296367">make</span><span class="op" id="8296371">(</span><span class="ident" id="8296372">Bug1StructMap</span><span class="op" id="8296385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296388">err</span>&nbsp;<span class="op" id="8296392">=</span>&nbsp;<span class="ident" id="8296394">dec</span><span class="op" id="8296397">.</span><span class="ident" id="8296398">Decode</span><span class="op" id="8296404">(</span><span class="op" id="8296405">&amp;</span><span class="ident" id="8296406">out</span><span class="op" id="8296409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8296412">if</span>&nbsp;<span class="ident" id="8296415">err</span>&nbsp;<span class="op" id="8296419">!=</span>&nbsp;<span class="builtintype" id="8296422">nil</span>&nbsp;<span class="op" id="8296426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296430">t</span><span class="op" id="8296431">.</span><span class="ident" id="8296432">Fatal</span><span class="op" id="8296437">(</span><span class="string" id="8296438">&#34;decode:&#34;</span><span class="op" id="8296447">,</span>&nbsp;<span class="ident" id="8296449">err</span><span class="op" id="8296452">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8296455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8296458">if</span>&nbsp;<span class="op" id="8296461">!</span><span class="ident" id="8296462">reflect</span><span class="op" id="8296469">.</span><span class="ident" id="8296470">DeepEqual</span><span class="op" id="8296479">(</span><span class="ident" id="8296480">in</span><span class="op" id="8296482">,</span>&nbsp;<span class="ident" id="8296484">out</span><span class="op" id="8296487">)</span>&nbsp;<span class="op" id="8296489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296493">t</span><span class="op" id="8296494">.</span><span class="ident" id="8296495">Errorf</span><span class="op" id="8296501">(</span><span class="string" id="8296502">&#34;mismatch:&nbsp;%v&nbsp;%v&#34;</span><span class="op" id="8296519">,</span>&nbsp;<span class="ident" id="8296521">in</span><span class="op" id="8296523">,</span>&nbsp;<span class="ident" id="8296525">out</span><span class="op" id="8296528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8296531">}</span><br>
<span class="lineno"></span><span class="op" id="8296533">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="8296536">func</span>&nbsp;<span class="ident" id="8296541">TestGobMapInterfaceEncode</span><span class="op" id="8296566">(</span><span class="ident" id="8296567">t</span>&nbsp;<span class="op" id="8296569">*</span><span class="ident" id="8296570">testing</span><span class="op" id="8296577">.</span><span class="ident" id="8296578">T</span><span class="op" id="8296579">)</span>&nbsp;<span class="op" id="8296581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296584">m</span>&nbsp;<span class="op" id="8296586">:=</span>&nbsp;<span class="keyword" id="8296589">map</span><span class="op" id="8296592">[</span><span class="builtintype" id="8296593">string</span><span class="op" id="8296599">]</span><span class="keyword" id="8296600">interface</span><span class="op" id="8296609">{</span><span class="op" id="8296610">}</span><span class="op" id="8296611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296615">&#34;up&#34;</span><span class="op" id="8296619">:</span>&nbsp;<span class="builtintype" id="8296621">uintptr</span><span class="op" id="8296628">(</span><span class="num" id="8296629">0</span><span class="op" id="8296630">)</span><span class="op" id="8296631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296635">&#34;i0&#34;</span><span class="op" id="8296639">:</span>&nbsp;<span class="op" id="8296641">[</span><span class="op" id="8296642">]</span><span class="builtintype" id="8296643">int</span><span class="op" id="8296646">{</span><span class="op" id="8296647">-</span><span class="num" id="8296648">1</span><span class="op" id="8296649">}</span><span class="op" id="8296650">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296654">&#34;i1&#34;</span><span class="op" id="8296658">:</span>&nbsp;<span class="op" id="8296660">[</span><span class="op" id="8296661">]</span><span class="builtintype" id="8296662">int8</span><span class="op" id="8296666">{</span><span class="op" id="8296667">-</span><span class="num" id="8296668">1</span><span class="op" id="8296669">}</span><span class="op" id="8296670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296674">&#34;i2&#34;</span><span class="op" id="8296678">:</span>&nbsp;<span class="op" id="8296680">[</span><span class="op" id="8296681">]</span><span class="builtintype" id="8296682">int16</span><span class="op" id="8296687">{</span><span class="op" id="8296688">-</span><span class="num" id="8296689">1</span><span class="op" id="8296690">}</span><span class="op" id="8296691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296695">&#34;i3&#34;</span><span class="op" id="8296699">:</span>&nbsp;<span class="op" id="8296701">[</span><span class="op" id="8296702">]</span><span class="builtintype" id="8296703">int32</span><span class="op" id="8296708">{</span><span class="op" id="8296709">-</span><span class="num" id="8296710">1</span><span class="op" id="8296711">}</span><span class="op" id="8296712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296716">&#34;i4&#34;</span><span class="op" id="8296720">:</span>&nbsp;<span class="op" id="8296722">[</span><span class="op" id="8296723">]</span><span class="ident" id="8296724">int64</span><span class="op" id="8296729">{</span><span class="op" id="8296730">-</span><span class="num" id="8296731">1</span><span class="op" id="8296732">}</span><span class="op" id="8296733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296737">&#34;u0&#34;</span><span class="op" id="8296741">:</span>&nbsp;<span class="op" id="8296743">[</span><span class="op" id="8296744">]</span><span class="builtintype" id="8296745">uint</span><span class="op" id="8296749">{</span><span class="num" id="8296750">1</span><span class="op" id="8296751">}</span><span class="op" id="8296752">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296756">&#34;u1&#34;</span><span class="op" id="8296760">:</span>&nbsp;<span class="op" id="8296762">[</span><span class="op" id="8296763">]</span><span class="builtintype" id="8296764">uint8</span><span class="op" id="8296769">{</span><span class="num" id="8296770">1</span><span class="op" id="8296771">}</span><span class="op" id="8296772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296776">&#34;u2&#34;</span><span class="op" id="8296780">:</span>&nbsp;<span class="op" id="8296782">[</span><span class="op" id="8296783">]</span><span class="builtintype" id="8296784">uint16</span><span class="op" id="8296790">{</span><span class="num" id="8296791">1</span><span class="op" id="8296792">}</span><span class="op" id="8296793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296797">&#34;u3&#34;</span><span class="op" id="8296801">:</span>&nbsp;<span class="op" id="8296803">[</span><span class="op" id="8296804">]</span><span class="builtintype" id="8296805">uint32</span><span class="op" id="8296811">{</span><span class="num" id="8296812">1</span><span class="op" id="8296813">}</span><span class="op" id="8296814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296818">&#34;u4&#34;</span><span class="op" id="8296822">:</span>&nbsp;<span class="op" id="8296824">[</span><span class="op" id="8296825">]</span><span class="ident" id="8296826">uint64</span><span class="op" id="8296832">{</span><span class="num" id="8296833">1</span><span class="op" id="8296834">}</span><span class="op" id="8296835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296839">&#34;f0&#34;</span><span class="op" id="8296843">:</span>&nbsp;<span class="op" id="8296845">[</span><span class="op" id="8296846">]</span><span class="builtintype" id="8296847">float32</span><span class="op" id="8296854">{</span><span class="num" id="8296855">1</span><span class="op" id="8296856">}</span><span class="op" id="8296857">,</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296861">&#34;f1&#34;</span><span class="op" id="8296865">:</span>&nbsp;<span class="op" id="8296867">[</span><span class="op" id="8296868">]</span><span class="builtintype" id="8296869">float64</span><span class="op" id="8296876">{</span><span class="num" id="8296877">1</span><span class="op" id="8296878">}</span><span class="op" id="8296879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296883">&#34;c0&#34;</span><span class="op" id="8296887">:</span>&nbsp;<span class="op" id="8296889">[</span><span class="op" id="8296890">]</span><span class="builtintype" id="8296891">complex64</span><span class="op" id="8296900">{</span><span class="builtinfunc" id="8296901">complex</span><span class="op" id="8296908">(</span><span class="num" id="8296909">2</span><span class="op" id="8296910">,</span>&nbsp;<span class="op" id="8296912">-</span><span class="num" id="8296913">2</span><span class="op" id="8296914">)</span><span class="op" id="8296915">}</span><span class="op" id="8296916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296920">&#34;c1&#34;</span><span class="op" id="8296924">:</span>&nbsp;<span class="op" id="8296926">[</span><span class="op" id="8296927">]</span><span class="builtintype" id="8296928">complex128</span><span class="op" id="8296938">{</span><span class="builtinfunc" id="8296939">complex</span><span class="op" id="8296946">(</span><span class="num" id="8296947">2</span><span class="op" id="8296948">,</span>&nbsp;<span class="builtintype" id="8296950">float64</span><span class="op" id="8296957">(</span><span class="op" id="8296958">-</span><span class="num" id="8296959">2</span><span class="op" id="8296960">)</span><span class="op" id="8296961">)</span><span class="op" id="8296962">}</span><span class="op" id="8296963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296967">&#34;us&#34;</span><span class="op" id="8296971">:</span>&nbsp;<span class="op" id="8296973">[</span><span class="op" id="8296974">]</span><span class="builtintype" id="8296975">uintptr</span><span class="op" id="8296982">{</span><span class="num" id="8296983">0</span><span class="op" id="8296984">}</span><span class="op" id="8296985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8296989">&#34;bo&#34;</span><span class="op" id="8296993">:</span>&nbsp;<span class="op" id="8296995">[</span><span class="op" id="8296996">]</span><span class="builtintype" id="8296997">bool</span><span class="op" id="8297001">{</span><span class="builtintype" id="8297002">false</span><span class="op" id="8297007">}</span><span class="op" id="8297008">,</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8297012">&#34;st&#34;</span><span class="op" id="8297016">:</span>&nbsp;<span class="op" id="8297018">[</span><span class="op" id="8297019">]</span><span class="builtintype" id="8297020">string</span><span class="op" id="8297026">{</span><span class="string" id="8297027">&#34;s&#34;</span><span class="op" id="8297030">}</span><span class="op" id="8297031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297037">enc</span>&nbsp;<span class="op" id="8297041">:=</span>&nbsp;<span class="ident" id="8297044">NewEncoder</span><span class="op" id="8297054">(</span><span class="builtinfunc" id="8297055">new</span><span class="op" id="8297058">(</span><span class="ident" id="8297059">bytes</span><span class="op" id="8297064">.</span><span class="ident" id="8297065">Buffer</span><span class="op" id="8297071">)</span><span class="op" id="8297072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297075">err</span>&nbsp;<span class="op" id="8297079">:=</span>&nbsp;<span class="ident" id="8297082">enc</span><span class="op" id="8297085">.</span><span class="ident" id="8297086">Encode</span><span class="op" id="8297092">(</span><span class="ident" id="8297093">m</span><span class="op" id="8297094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8297097">if</span>&nbsp;<span class="ident" id="8297100">err</span>&nbsp;<span class="op" id="8297104">!=</span>&nbsp;<span class="builtintype" id="8297107">nil</span>&nbsp;<span class="op" id="8297111">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297115">t</span><span class="op" id="8297116">.</span><span class="ident" id="8297117">Errorf</span><span class="op" id="8297123">(</span><span class="string" id="8297124">&#34;encode&nbsp;map:&nbsp;%s&#34;</span><span class="op" id="8297140">,</span>&nbsp;<span class="ident" id="8297142">err</span><span class="op" id="8297145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297148">}</span><br>
<span class="lineno"></span><span class="op" id="8297150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8297153">func</span>&nbsp;<span class="ident" id="8297158">TestSliceReusesMemory</span><span class="op" id="8297179">(</span><span class="ident" id="8297180">t</span>&nbsp;<span class="op" id="8297182">*</span><span class="ident" id="8297183">testing</span><span class="op" id="8297190">.</span><span class="ident" id="8297191">T</span><span class="op" id="8297192">)</span>&nbsp;<span class="op" id="8297194">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297197">buf</span>&nbsp;<span class="op" id="8297201">:=</span>&nbsp;<span class="builtinfunc" id="8297204">new</span><span class="op" id="8297207">(</span><span class="ident" id="8297208">bytes</span><span class="op" id="8297213">.</span><span class="ident" id="8297214">Buffer</span><span class="op" id="8297220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8297223">//&nbsp;Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297237">x</span>&nbsp;<span class="op" id="8297239">:=</span>&nbsp;<span class="op" id="8297242">[</span><span class="op" id="8297243">]</span><span class="builtintype" id="8297244">byte</span><span class="op" id="8297248">(</span><span class="string" id="8297249">&#34;abcd&#34;</span><span class="op" id="8297255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297259">enc</span>&nbsp;<span class="op" id="8297263">:=</span>&nbsp;<span class="ident" id="8297266">NewEncoder</span><span class="op" id="8297276">(</span><span class="ident" id="8297277">buf</span><span class="op" id="8297280">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297284">err</span>&nbsp;<span class="op" id="8297288">:=</span>&nbsp;<span class="ident" id="8297291">enc</span><span class="op" id="8297294">.</span><span class="ident" id="8297295">Encode</span><span class="op" id="8297301">(</span><span class="ident" id="8297302">x</span><span class="op" id="8297303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8297307">if</span>&nbsp;<span class="ident" id="8297310">err</span>&nbsp;<span class="op" id="8297314">!=</span>&nbsp;<span class="builtintype" id="8297317">nil</span>&nbsp;<span class="op" id="8297321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297326">t</span><span class="op" id="8297327">.</span><span class="ident" id="8297328">Errorf</span><span class="op" id="8297334">(</span><span class="string" id="8297335">&#34;bytes:&nbsp;encode:&nbsp;%s&#34;</span><span class="op" id="8297354">,</span>&nbsp;<span class="ident" id="8297356">err</span><span class="op" id="8297359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8297367">//&nbsp;Decode&nbsp;into&nbsp;y,&nbsp;which&nbsp;is&nbsp;big&nbsp;enough.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297408">y</span>&nbsp;<span class="op" id="8297410">:=</span>&nbsp;<span class="op" id="8297413">[</span><span class="op" id="8297414">]</span><span class="builtintype" id="8297415">byte</span><span class="op" id="8297419">(</span><span class="string" id="8297420">&#34;ABCDE&#34;</span><span class="op" id="8297427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297431">addr</span>&nbsp;<span class="op" id="8297436">:=</span>&nbsp;<span class="op" id="8297439">&amp;</span><span class="ident" id="8297440">y</span><span class="op" id="8297441">[</span><span class="num" id="8297442">0</span><span class="op" id="8297443">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297447">dec</span>&nbsp;<span class="op" id="8297451">:=</span>&nbsp;<span class="ident" id="8297454">NewDecoder</span><span class="op" id="8297464">(</span><span class="ident" id="8297465">buf</span><span class="op" id="8297468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297472">err</span>&nbsp;<span class="op" id="8297476">=</span>&nbsp;<span class="ident" id="8297478">dec</span><span class="op" id="8297481">.</span><span class="ident" id="8297482">Decode</span><span class="op" id="8297488">(</span><span class="op" id="8297489">&amp;</span><span class="ident" id="8297490">y</span><span class="op" id="8297491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8297495">if</span>&nbsp;<span class="ident" id="8297498">err</span>&nbsp;<span class="op" id="8297502">!=</span>&nbsp;<span class="builtintype" id="8297505">nil</span>&nbsp;<span class="op" id="8297509">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297514">t</span><span class="op" id="8297515">.</span><span class="ident" id="8297516">Fatal</span><span class="op" id="8297521">(</span><span class="string" id="8297522">&#34;bytes:&nbsp;decode:&#34;</span><span class="op" id="8297538">,</span>&nbsp;<span class="ident" id="8297540">err</span><span class="op" id="8297543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8297551">if</span>&nbsp;<span class="op" id="8297554">!</span><span class="ident" id="8297555">bytes</span><span class="op" id="8297560">.</span><span class="ident" id="8297561">Equal</span><span class="op" id="8297566">(</span><span class="ident" id="8297567">x</span><span class="op" id="8297568">,</span>&nbsp;<span class="ident" id="8297570">y</span><span class="op" id="8297571">)</span>&nbsp;<span class="op" id="8297573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297578">t</span><span class="op" id="8297579">.</span><span class="ident" id="8297580">Errorf</span><span class="op" id="8297586">(</span><span class="string" id="8297587">&#34;bytes:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q\n&#34;</span><span class="op" id="8297616">,</span>&nbsp;<span class="ident" id="8297618">x</span><span class="op" id="8297619">,</span>&nbsp;<span class="ident" id="8297621">y</span><span class="op" id="8297622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297626">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8297630">if</span>&nbsp;<span class="ident" id="8297633">addr</span>&nbsp;<span class="op" id="8297638">!=</span>&nbsp;<span class="op" id="8297641">&amp;</span><span class="ident" id="8297642">y</span><span class="op" id="8297643">[</span><span class="num" id="8297644">0</span><span class="op" id="8297645">]</span>&nbsp;<span class="op" id="8297647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297652">t</span><span class="op" id="8297653">.</span><span class="ident" id="8297654">Errorf</span><span class="op" id="8297660">(</span><span class="string" id="8297661">&#34;bytes:&nbsp;unnecessary&nbsp;reallocation&#34;</span><span class="op" id="8297694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8297704">//&nbsp;general&nbsp;slice</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297726">x</span>&nbsp;<span class="op" id="8297728">:=</span>&nbsp;<span class="op" id="8297731">[</span><span class="op" id="8297732">]</span><span class="builtintype" id="8297733">rune</span><span class="op" id="8297737">(</span><span class="string" id="8297738">&#34;abcd&#34;</span><span class="op" id="8297744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297748">enc</span>&nbsp;<span class="op" id="8297752">:=</span>&nbsp;<span class="ident" id="8297755">NewEncoder</span><span class="op" id="8297765">(</span><span class="ident" id="8297766">buf</span><span class="op" id="8297769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297773">err</span>&nbsp;<span class="op" id="8297777">:=</span>&nbsp;<span class="ident" id="8297780">enc</span><span class="op" id="8297783">.</span><span class="ident" id="8297784">Encode</span><span class="op" id="8297790">(</span><span class="ident" id="8297791">x</span><span class="op" id="8297792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8297796">if</span>&nbsp;<span class="ident" id="8297799">err</span>&nbsp;<span class="op" id="8297803">!=</span>&nbsp;<span class="builtintype" id="8297806">nil</span>&nbsp;<span class="op" id="8297810">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297815">t</span><span class="op" id="8297816">.</span><span class="ident" id="8297817">Errorf</span><span class="op" id="8297823">(</span><span class="string" id="8297824">&#34;ints:&nbsp;encode:&nbsp;%s&#34;</span><span class="op" id="8297842">,</span>&nbsp;<span class="ident" id="8297844">err</span><span class="op" id="8297847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8297855">//&nbsp;Decode&nbsp;into&nbsp;y,&nbsp;which&nbsp;is&nbsp;big&nbsp;enough.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297896">y</span>&nbsp;<span class="op" id="8297898">:=</span>&nbsp;<span class="op" id="8297901">[</span><span class="op" id="8297902">]</span><span class="builtintype" id="8297903">rune</span><span class="op" id="8297907">(</span><span class="string" id="8297908">&#34;ABCDE&#34;</span><span class="op" id="8297915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297919">addr</span>&nbsp;<span class="op" id="8297924">:=</span>&nbsp;<span class="op" id="8297927">&amp;</span><span class="ident" id="8297928">y</span><span class="op" id="8297929">[</span><span class="num" id="8297930">0</span><span class="op" id="8297931">]</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297935">dec</span>&nbsp;<span class="op" id="8297939">:=</span>&nbsp;<span class="ident" id="8297942">NewDecoder</span><span class="op" id="8297952">(</span><span class="ident" id="8297953">buf</span><span class="op" id="8297956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297960">err</span>&nbsp;<span class="op" id="8297964">=</span>&nbsp;<span class="ident" id="8297966">dec</span><span class="op" id="8297969">.</span><span class="ident" id="8297970">Decode</span><span class="op" id="8297976">(</span><span class="op" id="8297977">&amp;</span><span class="ident" id="8297978">y</span><span class="op" id="8297979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8297983">if</span>&nbsp;<span class="ident" id="8297986">err</span>&nbsp;<span class="op" id="8297990">!=</span>&nbsp;<span class="builtintype" id="8297993">nil</span>&nbsp;<span class="op" id="8297997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298002">t</span><span class="op" id="8298003">.</span><span class="ident" id="8298004">Fatal</span><span class="op" id="8298009">(</span><span class="string" id="8298010">&#34;ints:&nbsp;decode:&#34;</span><span class="op" id="8298025">,</span>&nbsp;<span class="ident" id="8298027">err</span><span class="op" id="8298030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8298034">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8298038">if</span>&nbsp;<span class="op" id="8298041">!</span><span class="ident" id="8298042">reflect</span><span class="op" id="8298049">.</span><span class="ident" id="8298050">DeepEqual</span><span class="op" id="8298059">(</span><span class="ident" id="8298060">x</span><span class="op" id="8298061">,</span>&nbsp;<span class="ident" id="8298063">y</span><span class="op" id="8298064">)</span>&nbsp;<span class="op" id="8298066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298071">t</span><span class="op" id="8298072">.</span><span class="ident" id="8298073">Errorf</span><span class="op" id="8298079">(</span><span class="string" id="8298080">&#34;ints:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q\n&#34;</span><span class="op" id="8298108">,</span>&nbsp;<span class="ident" id="8298110">x</span><span class="op" id="8298111">,</span>&nbsp;<span class="ident" id="8298113">y</span><span class="op" id="8298114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8298118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8298122">if</span>&nbsp;<span class="ident" id="8298125">addr</span>&nbsp;<span class="op" id="8298130">!=</span>&nbsp;<span class="op" id="8298133">&amp;</span><span class="ident" id="8298134">y</span><span class="op" id="8298135">[</span><span class="num" id="8298136">0</span><span class="op" id="8298137">]</span>&nbsp;<span class="op" id="8298139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298144">t</span><span class="op" id="8298145">.</span><span class="ident" id="8298146">Errorf</span><span class="op" id="8298152">(</span><span class="string" id="8298153">&#34;ints:&nbsp;unnecessary&nbsp;reallocation&#34;</span><span class="op" id="8298185">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8298189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8298192">}</span><br>
<span class="lineno"></span><span class="op" id="8298194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8298197">//&nbsp;Used&nbsp;to&nbsp;crash:&nbsp;negative&nbsp;count&nbsp;in&nbsp;recvMessage.</span><br>
<span class="lineno">705</span><span class="keyword" id="8298246">func</span>&nbsp;<span class="ident" id="8298251">TestBadCount</span><span class="op" id="8298263">(</span><span class="ident" id="8298264">t</span>&nbsp;<span class="op" id="8298266">*</span><span class="ident" id="8298267">testing</span><span class="op" id="8298274">.</span><span class="ident" id="8298275">T</span><span class="op" id="8298276">)</span>&nbsp;<span class="op" id="8298278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298281">b</span>&nbsp;<span class="op" id="8298283">:=</span>&nbsp;<span class="op" id="8298286">[</span><span class="op" id="8298287">]</span><span class="builtintype" id="8298288">byte</span><span class="op" id="8298292">{</span><span class="num" id="8298293">0xfb</span><span class="op" id="8298297">,</span>&nbsp;<span class="num" id="8298299">0xa5</span><span class="op" id="8298303">,</span>&nbsp;<span class="num" id="8298305">0x82</span><span class="op" id="8298309">,</span>&nbsp;<span class="num" id="8298311">0x2f</span><span class="op" id="8298315">,</span>&nbsp;<span class="num" id="8298317">0xca</span><span class="op" id="8298321">,</span>&nbsp;<span class="num" id="8298323">0x1</span><span class="op" id="8298326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8298329">if</span>&nbsp;<span class="ident" id="8298332">err</span>&nbsp;<span class="op" id="8298336">:=</span>&nbsp;<span class="ident" id="8298339">NewDecoder</span><span class="op" id="8298349">(</span><span class="ident" id="8298350">bytes</span><span class="op" id="8298355">.</span><span class="ident" id="8298356">NewReader</span><span class="op" id="8298365">(</span><span class="ident" id="8298366">b</span><span class="op" id="8298367">)</span><span class="op" id="8298368">)</span><span class="op" id="8298369">.</span><span class="ident" id="8298370">Decode</span><span class="op" id="8298376">(</span><span class="builtintype" id="8298377">nil</span><span class="op" id="8298380">)</span><span class="op" id="8298381">;</span>&nbsp;<span class="ident" id="8298383">err</span>&nbsp;<span class="op" id="8298387">==</span>&nbsp;<span class="builtintype" id="8298390">nil</span>&nbsp;<span class="op" id="8298394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298398">t</span><span class="op" id="8298399">.</span><span class="ident" id="8298400">Error</span><span class="op" id="8298405">(</span><span class="string" id="8298406">&#34;expected&nbsp;error&nbsp;from&nbsp;bad&nbsp;count&#34;</span><span class="op" id="8298437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8298440">}</span>&nbsp;<span class="keyword" id="8298442">else</span>&nbsp;<span class="keyword" id="8298447">if</span>&nbsp;<span class="ident" id="8298450">err</span><span class="op" id="8298453">.</span><span class="ident" id="8298454">Error</span><span class="op" id="8298459">(</span><span class="op" id="8298460">)</span>&nbsp;<span class="op" id="8298462">!=</span>&nbsp;<span class="ident" id="8298465">errBadCount</span><span class="op" id="8298476">.</span><span class="ident" id="8298477">Error</span><span class="op" id="8298482">(</span><span class="op" id="8298483">)</span>&nbsp;<span class="op" id="8298485">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298489">t</span><span class="op" id="8298490">.</span><span class="ident" id="8298491">Error</span><span class="op" id="8298496">(</span><span class="string" id="8298497">&#34;expected&nbsp;bad&nbsp;count&nbsp;error;&nbsp;got&#34;</span><span class="op" id="8298528">,</span>&nbsp;<span class="ident" id="8298530">err</span><span class="op" id="8298533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8298536">}</span><br>
<span class="lineno"></span><span class="op" id="8298538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8298541">//&nbsp;Verify&nbsp;that&nbsp;sequential&nbsp;Decoders&nbsp;built&nbsp;on&nbsp;a&nbsp;single&nbsp;input&nbsp;will</span><br>
<span class="lineno">715</span><span class="comment" id="8298605">//&nbsp;succeed&nbsp;if&nbsp;the&nbsp;input&nbsp;implements&nbsp;ReadByte&nbsp;and&nbsp;there&nbsp;is&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="8298665">//&nbsp;type&nbsp;information&nbsp;in&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="8298700">func</span>&nbsp;<span class="ident" id="8298705">TestSequentialDecoder</span><span class="op" id="8298726">(</span><span class="ident" id="8298727">t</span>&nbsp;<span class="op" id="8298729">*</span><span class="ident" id="8298730">testing</span><span class="op" id="8298737">.</span><span class="ident" id="8298738">T</span><span class="op" id="8298739">)</span>&nbsp;<span class="op" id="8298741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298744">b</span>&nbsp;<span class="op" id="8298746">:=</span>&nbsp;<span class="builtinfunc" id="8298749">new</span><span class="op" id="8298752">(</span><span class="ident" id="8298753">bytes</span><span class="op" id="8298758">.</span><span class="ident" id="8298759">Buffer</span><span class="op" id="8298765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298768">enc</span>&nbsp;<span class="op" id="8298772">:=</span>&nbsp;<span class="ident" id="8298775">NewEncoder</span><span class="op" id="8298785">(</span><span class="ident" id="8298786">b</span><span class="op" id="8298787">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8298790">const</span>&nbsp;<span class="ident" id="8298796">count</span>&nbsp;<span class="op" id="8298802">=</span>&nbsp;<span class="num" id="8298804">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8298808">for</span>&nbsp;<span class="ident" id="8298812">i</span>&nbsp;<span class="op" id="8298814">:=</span>&nbsp;<span class="num" id="8298817">0</span><span class="op" id="8298818">;</span>&nbsp;<span class="ident" id="8298820">i</span>&nbsp;<span class="op" id="8298822">&lt;</span>&nbsp;<span class="ident" id="8298824">count</span><span class="op" id="8298829">;</span>&nbsp;<span class="ident" id="8298831">i</span><span class="op" id="8298832">++</span>&nbsp;<span class="op" id="8298835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298839">s</span>&nbsp;<span class="op" id="8298841">:=</span>&nbsp;<span class="ident" id="8298844">fmt</span><span class="op" id="8298847">.</span><span class="ident" id="8298848">Sprintf</span><span class="op" id="8298855">(</span><span class="string" id="8298856">&#34;%d&#34;</span><span class="op" id="8298860">,</span>&nbsp;<span class="ident" id="8298862">i</span><span class="op" id="8298863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8298867">if</span>&nbsp;<span class="ident" id="8298870">err</span>&nbsp;<span class="op" id="8298874">:=</span>&nbsp;<span class="ident" id="8298877">enc</span><span class="op" id="8298880">.</span><span class="ident" id="8298881">Encode</span><span class="op" id="8298887">(</span><span class="ident" id="8298888">s</span><span class="op" id="8298889">)</span><span class="op" id="8298890">;</span>&nbsp;<span class="ident" id="8298892">err</span>&nbsp;<span class="op" id="8298896">!=</span>&nbsp;<span class="builtintype" id="8298899">nil</span>&nbsp;<span class="op" id="8298903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298908">t</span><span class="op" id="8298909">.</span><span class="ident" id="8298910">Error</span><span class="op" id="8298915">(</span><span class="string" id="8298916">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="8298931">,</span>&nbsp;<span class="ident" id="8298933">err</span><span class="op" id="8298936">)</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8298940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8298943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8298946">for</span>&nbsp;<span class="ident" id="8298950">i</span>&nbsp;<span class="op" id="8298952">:=</span>&nbsp;<span class="num" id="8298955">0</span><span class="op" id="8298956">;</span>&nbsp;<span class="ident" id="8298958">i</span>&nbsp;<span class="op" id="8298960">&lt;</span>&nbsp;<span class="ident" id="8298962">count</span><span class="op" id="8298967">;</span>&nbsp;<span class="ident" id="8298969">i</span><span class="op" id="8298970">++</span>&nbsp;<span class="op" id="8298973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298977">dec</span>&nbsp;<span class="op" id="8298981">:=</span>&nbsp;<span class="ident" id="8298984">NewDecoder</span><span class="op" id="8298994">(</span><span class="ident" id="8298995">b</span><span class="op" id="8298996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299000">var</span>&nbsp;<span class="ident" id="8299004">s</span>&nbsp;<span class="builtintype" id="8299006">string</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299015">if</span>&nbsp;<span class="ident" id="8299018">err</span>&nbsp;<span class="op" id="8299022">:=</span>&nbsp;<span class="ident" id="8299025">dec</span><span class="op" id="8299028">.</span><span class="ident" id="8299029">Decode</span><span class="op" id="8299035">(</span><span class="op" id="8299036">&amp;</span><span class="ident" id="8299037">s</span><span class="op" id="8299038">)</span><span class="op" id="8299039">;</span>&nbsp;<span class="ident" id="8299041">err</span>&nbsp;<span class="op" id="8299045">!=</span>&nbsp;<span class="builtintype" id="8299048">nil</span>&nbsp;<span class="op" id="8299052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299057">t</span><span class="op" id="8299058">.</span><span class="ident" id="8299059">Fatal</span><span class="op" id="8299064">(</span><span class="string" id="8299065">&#34;decoder&nbsp;fail:&#34;</span><span class="op" id="8299080">,</span>&nbsp;<span class="ident" id="8299082">err</span><span class="op" id="8299085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8299089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299093">if</span>&nbsp;<span class="ident" id="8299096">s</span>&nbsp;<span class="op" id="8299098">!=</span>&nbsp;<span class="ident" id="8299101">fmt</span><span class="op" id="8299104">.</span><span class="ident" id="8299105">Sprintf</span><span class="op" id="8299112">(</span><span class="string" id="8299113">&#34;%d&#34;</span><span class="op" id="8299117">,</span>&nbsp;<span class="ident" id="8299119">i</span><span class="op" id="8299120">)</span>&nbsp;<span class="op" id="8299122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299127">t</span><span class="op" id="8299128">.</span><span class="ident" id="8299129">Fatalf</span><span class="op" id="8299135">(</span><span class="string" id="8299136">&#34;decode&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%s&#34;</span><span class="op" id="8299163">,</span>&nbsp;<span class="ident" id="8299165">i</span><span class="op" id="8299166">,</span>&nbsp;<span class="ident" id="8299168">s</span><span class="op" id="8299169">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8299173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8299176">}</span><br>
<span class="lineno"></span><span class="op" id="8299178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8299181">//&nbsp;Should&nbsp;be&nbsp;able&nbsp;to&nbsp;have&nbsp;unrepresentable&nbsp;fields&nbsp;(chan,&nbsp;func,&nbsp;*chan&nbsp;etc.);&nbsp;we&nbsp;just&nbsp;ignore&nbsp;them.</span><br>
<span class="lineno">740</span><span class="keyword" id="8299277">type</span>&nbsp;<span class="ident" id="8299282">Bug2</span>&nbsp;<span class="keyword" id="8299287">struct</span>&nbsp;<span class="op" id="8299294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299297">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8299301">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299306">C</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299310">chan</span>&nbsp;<span class="builtintype" id="8299315">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299320">CP</span>&nbsp;&nbsp;<span class="op" id="8299324">*</span><span class="keyword" id="8299325">chan</span>&nbsp;<span class="builtintype" id="8299330">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299335">F</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299339">func</span><span class="op" id="8299343">(</span><span class="op" id="8299344">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299347">FPP</span>&nbsp;<span class="op" id="8299351">*</span><span class="op" id="8299352">*</span><span class="keyword" id="8299353">func</span><span class="op" id="8299357">(</span><span class="op" id="8299358">)</span><br>
<span class="lineno"></span><span class="op" id="8299360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8299363">func</span>&nbsp;<span class="ident" id="8299368">TestChanFuncIgnored</span><span class="op" id="8299387">(</span><span class="ident" id="8299388">t</span>&nbsp;<span class="op" id="8299390">*</span><span class="ident" id="8299391">testing</span><span class="op" id="8299398">.</span><span class="ident" id="8299399">T</span><span class="op" id="8299400">)</span>&nbsp;<span class="op" id="8299402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299405">c</span>&nbsp;<span class="op" id="8299407">:=</span>&nbsp;<span class="builtinfunc" id="8299410">make</span><span class="op" id="8299414">(</span><span class="keyword" id="8299415">chan</span>&nbsp;<span class="builtintype" id="8299420">int</span><span class="op" id="8299423">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299426">f</span>&nbsp;<span class="op" id="8299428">:=</span>&nbsp;<span class="keyword" id="8299431">func</span><span class="op" id="8299435">(</span><span class="op" id="8299436">)</span>&nbsp;<span class="op" id="8299438">{</span><span class="op" id="8299439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299442">fp</span>&nbsp;<span class="op" id="8299445">:=</span>&nbsp;<span class="op" id="8299448">&amp;</span><span class="ident" id="8299449">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299452">b0</span>&nbsp;<span class="op" id="8299455">:=</span>&nbsp;<span class="ident" id="8299458">Bug2</span><span class="op" id="8299462">{</span><span class="num" id="8299463">23</span><span class="op" id="8299465">,</span>&nbsp;<span class="ident" id="8299467">c</span><span class="op" id="8299468">,</span>&nbsp;<span class="op" id="8299470">&amp;</span><span class="ident" id="8299471">c</span><span class="op" id="8299472">,</span>&nbsp;<span class="ident" id="8299474">f</span><span class="op" id="8299475">,</span>&nbsp;<span class="op" id="8299477">&amp;</span><span class="ident" id="8299478">fp</span><span class="op" id="8299480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299483">var</span>&nbsp;<span class="ident" id="8299487">buf</span>&nbsp;<span class="ident" id="8299491">bytes</span><span class="op" id="8299496">.</span><span class="ident" id="8299497">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299505">enc</span>&nbsp;<span class="op" id="8299509">:=</span>&nbsp;<span class="ident" id="8299512">NewEncoder</span><span class="op" id="8299522">(</span><span class="op" id="8299523">&amp;</span><span class="ident" id="8299524">buf</span><span class="op" id="8299527">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299530">if</span>&nbsp;<span class="ident" id="8299533">err</span>&nbsp;<span class="op" id="8299537">:=</span>&nbsp;<span class="ident" id="8299540">enc</span><span class="op" id="8299543">.</span><span class="ident" id="8299544">Encode</span><span class="op" id="8299550">(</span><span class="ident" id="8299551">b0</span><span class="op" id="8299553">)</span><span class="op" id="8299554">;</span>&nbsp;<span class="ident" id="8299556">err</span>&nbsp;<span class="op" id="8299560">!=</span>&nbsp;<span class="builtintype" id="8299563">nil</span>&nbsp;<span class="op" id="8299567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299571">t</span><span class="op" id="8299572">.</span><span class="ident" id="8299573">Fatal</span><span class="op" id="8299578">(</span><span class="string" id="8299579">&#34;error&nbsp;encoding:&#34;</span><span class="op" id="8299596">,</span>&nbsp;<span class="ident" id="8299598">err</span><span class="op" id="8299601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8299604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299607">var</span>&nbsp;<span class="ident" id="8299611">b1</span>&nbsp;<span class="ident" id="8299614">Bug2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299620">err</span>&nbsp;<span class="op" id="8299624">:=</span>&nbsp;<span class="ident" id="8299627">NewDecoder</span><span class="op" id="8299637">(</span><span class="op" id="8299638">&amp;</span><span class="ident" id="8299639">buf</span><span class="op" id="8299642">)</span><span class="op" id="8299643">.</span><span class="ident" id="8299644">Decode</span><span class="op" id="8299650">(</span><span class="op" id="8299651">&amp;</span><span class="ident" id="8299652">b1</span><span class="op" id="8299654">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299657">if</span>&nbsp;<span class="ident" id="8299660">err</span>&nbsp;<span class="op" id="8299664">!=</span>&nbsp;<span class="builtintype" id="8299667">nil</span>&nbsp;<span class="op" id="8299671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299675">t</span><span class="op" id="8299676">.</span><span class="ident" id="8299677">Fatal</span><span class="op" id="8299682">(</span><span class="string" id="8299683">&#34;decode:&#34;</span><span class="op" id="8299692">,</span>&nbsp;<span class="ident" id="8299694">err</span><span class="op" id="8299697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8299700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299703">if</span>&nbsp;<span class="ident" id="8299706">b1</span><span class="op" id="8299708">.</span><span class="ident" id="8299709">A</span>&nbsp;<span class="op" id="8299711">!=</span>&nbsp;<span class="ident" id="8299714">b0</span><span class="op" id="8299716">.</span><span class="ident" id="8299717">A</span>&nbsp;<span class="op" id="8299719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299723">t</span><span class="op" id="8299724">.</span><span class="ident" id="8299725">Fatalf</span><span class="op" id="8299731">(</span><span class="string" id="8299732">&#34;got&nbsp;%d&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8299748">,</span>&nbsp;<span class="ident" id="8299750">b1</span><span class="op" id="8299752">.</span><span class="ident" id="8299753">A</span><span class="op" id="8299754">,</span>&nbsp;<span class="ident" id="8299756">b0</span><span class="op" id="8299758">.</span><span class="ident" id="8299759">A</span><span class="op" id="8299760">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8299763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299766">if</span>&nbsp;<span class="ident" id="8299769">b1</span><span class="op" id="8299771">.</span><span class="ident" id="8299772">C</span>&nbsp;<span class="op" id="8299774">!=</span>&nbsp;<span class="builtintype" id="8299777">nil</span>&nbsp;<span class="op" id="8299781">||</span>&nbsp;<span class="ident" id="8299784">b1</span><span class="op" id="8299786">.</span><span class="ident" id="8299787">CP</span>&nbsp;<span class="op" id="8299790">!=</span>&nbsp;<span class="builtintype" id="8299793">nil</span>&nbsp;<span class="op" id="8299797">||</span>&nbsp;<span class="ident" id="8299800">b1</span><span class="op" id="8299802">.</span><span class="ident" id="8299803">F</span>&nbsp;<span class="op" id="8299805">!=</span>&nbsp;<span class="builtintype" id="8299808">nil</span>&nbsp;<span class="op" id="8299812">||</span>&nbsp;<span class="ident" id="8299815">b1</span><span class="op" id="8299817">.</span><span class="ident" id="8299818">FPP</span>&nbsp;<span class="op" id="8299822">!=</span>&nbsp;<span class="builtintype" id="8299825">nil</span>&nbsp;<span class="op" id="8299829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8299833">t</span><span class="op" id="8299834">.</span><span class="ident" id="8299835">Fatal</span><span class="op" id="8299840">(</span><span class="string" id="8299841">&#34;unexpected&nbsp;value&nbsp;for&nbsp;chan&nbsp;or&nbsp;func&#34;</span><span class="op" id="8299876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8299879">}</span><br>
<span class="lineno"></span><span class="op" id="8299881">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="keyword" id="8299884">func</span>&nbsp;<span class="ident" id="8299889">TestSliceIncompatibility</span><span class="op" id="8299913">(</span><span class="ident" id="8299914">t</span>&nbsp;<span class="op" id="8299916">*</span><span class="ident" id="8299917">testing</span><span class="op" id="8299924">.</span><span class="ident" id="8299925">T</span><span class="op" id="8299926">)</span>&nbsp;<span class="op" id="8299928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299931">var</span>&nbsp;<span class="ident" id="8299935">in</span>&nbsp;<span class="op" id="8299938">=</span>&nbsp;<span class="op" id="8299940">[</span><span class="op" id="8299941">]</span><span class="builtintype" id="8299942">byte</span><span class="op" id="8299946">{</span><span class="num" id="8299947">1</span><span class="op" id="8299948">,</span>&nbsp;<span class="num" id="8299950">2</span><span class="op" id="8299951">,</span>&nbsp;<span class="num" id="8299953">3</span><span class="op" id="8299954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299957">var</span>&nbsp;<span class="ident" id="8299961">out</span>&nbsp;<span class="op" id="8299965">[</span><span class="op" id="8299966">]</span><span class="builtintype" id="8299967">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8299972">if</span>&nbsp;<span class="ident" id="8299975">err</span>&nbsp;<span class="op" id="8299979">:=</span>&nbsp;<span class="ident" id="8299982">encAndDec</span><span class="op" id="8299991">(</span><span class="ident" id="8299992">in</span><span class="op" id="8299994">,</span>&nbsp;<span class="op" id="8299996">&amp;</span><span class="ident" id="8299997">out</span><span class="op" id="8300000">)</span><span class="op" id="8300001">;</span>&nbsp;<span class="ident" id="8300003">err</span>&nbsp;<span class="op" id="8300007">==</span>&nbsp;<span class="builtintype" id="8300010">nil</span>&nbsp;<span class="op" id="8300014">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300018">t</span><span class="op" id="8300019">.</span><span class="ident" id="8300020">Error</span><span class="op" id="8300025">(</span><span class="string" id="8300026">&#34;expected&nbsp;compatibility&nbsp;error&#34;</span><span class="op" id="8300056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8300059">}</span><br>
<span class="lineno"></span><span class="op" id="8300061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8300064">//&nbsp;Mutually&nbsp;recursive&nbsp;slices&nbsp;of&nbsp;structs&nbsp;caused&nbsp;problems.</span><br>
<span class="lineno">780</span><span class="keyword" id="8300121">type</span>&nbsp;<span class="ident" id="8300126">Bug3</span>&nbsp;<span class="keyword" id="8300131">struct</span>&nbsp;<span class="op" id="8300138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300141">Num</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8300150">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300155">Children</span>&nbsp;<span class="op" id="8300164">[</span><span class="op" id="8300165">]</span><span class="op" id="8300166">*</span><span class="ident" id="8300167">Bug3</span><br>
<span class="lineno"></span><span class="op" id="8300172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">785</span><span class="keyword" id="8300175">func</span>&nbsp;<span class="ident" id="8300180">TestGobPtrSlices</span><span class="op" id="8300196">(</span><span class="ident" id="8300197">t</span>&nbsp;<span class="op" id="8300199">*</span><span class="ident" id="8300200">testing</span><span class="op" id="8300207">.</span><span class="ident" id="8300208">T</span><span class="op" id="8300209">)</span>&nbsp;<span class="op" id="8300211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300214">in</span>&nbsp;<span class="op" id="8300217">:=</span>&nbsp;<span class="op" id="8300220">[</span><span class="op" id="8300221">]</span><span class="op" id="8300222">*</span><span class="ident" id="8300223">Bug3</span><span class="op" id="8300227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8300231">{</span><span class="num" id="8300232">1</span><span class="op" id="8300233">,</span>&nbsp;<span class="builtintype" id="8300235">nil</span><span class="op" id="8300238">}</span><span class="op" id="8300239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8300243">{</span><span class="num" id="8300244">2</span><span class="op" id="8300245">,</span>&nbsp;<span class="builtintype" id="8300247">nil</span><span class="op" id="8300250">}</span><span class="op" id="8300251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8300254">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300257">b</span>&nbsp;<span class="op" id="8300259">:=</span>&nbsp;<span class="builtinfunc" id="8300262">new</span><span class="op" id="8300265">(</span><span class="ident" id="8300266">bytes</span><span class="op" id="8300271">.</span><span class="ident" id="8300272">Buffer</span><span class="op" id="8300278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300281">err</span>&nbsp;<span class="op" id="8300285">:=</span>&nbsp;<span class="ident" id="8300288">NewEncoder</span><span class="op" id="8300298">(</span><span class="ident" id="8300299">b</span><span class="op" id="8300300">)</span><span class="op" id="8300301">.</span><span class="ident" id="8300302">Encode</span><span class="op" id="8300308">(</span><span class="op" id="8300309">&amp;</span><span class="ident" id="8300310">in</span><span class="op" id="8300312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8300315">if</span>&nbsp;<span class="ident" id="8300318">err</span>&nbsp;<span class="op" id="8300322">!=</span>&nbsp;<span class="builtintype" id="8300325">nil</span>&nbsp;<span class="op" id="8300329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300333">t</span><span class="op" id="8300334">.</span><span class="ident" id="8300335">Fatal</span><span class="op" id="8300340">(</span><span class="string" id="8300341">&#34;encode:&#34;</span><span class="op" id="8300350">,</span>&nbsp;<span class="ident" id="8300352">err</span><span class="op" id="8300355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8300358">}</span><br>
<span class="lineno">795</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8300362">var</span>&nbsp;<span class="ident" id="8300366">out</span>&nbsp;<span class="op" id="8300370">[</span><span class="op" id="8300371">]</span><span class="op" id="8300372">*</span><span class="ident" id="8300373">Bug3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300379">err</span>&nbsp;<span class="op" id="8300383">=</span>&nbsp;<span class="ident" id="8300385">NewDecoder</span><span class="op" id="8300395">(</span><span class="ident" id="8300396">b</span><span class="op" id="8300397">)</span><span class="op" id="8300398">.</span><span class="ident" id="8300399">Decode</span><span class="op" id="8300405">(</span><span class="op" id="8300406">&amp;</span><span class="ident" id="8300407">out</span><span class="op" id="8300410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8300413">if</span>&nbsp;<span class="ident" id="8300416">err</span>&nbsp;<span class="op" id="8300420">!=</span>&nbsp;<span class="builtintype" id="8300423">nil</span>&nbsp;<span class="op" id="8300427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300431">t</span><span class="op" id="8300432">.</span><span class="ident" id="8300433">Fatal</span><span class="op" id="8300438">(</span><span class="string" id="8300439">&#34;decode:&#34;</span><span class="op" id="8300448">,</span>&nbsp;<span class="ident" id="8300450">err</span><span class="op" id="8300453">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8300456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8300459">if</span>&nbsp;<span class="op" id="8300462">!</span><span class="ident" id="8300463">reflect</span><span class="op" id="8300470">.</span><span class="ident" id="8300471">DeepEqual</span><span class="op" id="8300480">(</span><span class="ident" id="8300481">in</span><span class="op" id="8300483">,</span>&nbsp;<span class="ident" id="8300485">out</span><span class="op" id="8300488">)</span>&nbsp;<span class="op" id="8300490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300494">t</span><span class="op" id="8300495">.</span><span class="ident" id="8300496">Fatalf</span><span class="op" id="8300502">(</span><span class="string" id="8300503">&#34;got&nbsp;%v;&nbsp;wanted&nbsp;%v&#34;</span><span class="op" id="8300522">,</span>&nbsp;<span class="ident" id="8300524">out</span><span class="op" id="8300527">,</span>&nbsp;<span class="ident" id="8300529">in</span><span class="op" id="8300531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8300534">}</span><br>
<span class="lineno"></span><span class="op" id="8300536">}</span><br>
<span class="lineno">805</span><br>
<span class="lineno"></span><span class="comment" id="8300539">//&nbsp;getDecEnginePtr&nbsp;cached&nbsp;engine&nbsp;for&nbsp;ut.base&nbsp;instead&nbsp;of&nbsp;ut.user&nbsp;so&nbsp;we&nbsp;passed</span><br>
<span class="lineno"></span><span class="comment" id="8300616">//&nbsp;a&nbsp;*map&nbsp;and&nbsp;then&nbsp;tried&nbsp;to&nbsp;reuse&nbsp;its&nbsp;engine&nbsp;to&nbsp;decode&nbsp;the&nbsp;inner&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="8300686">func</span>&nbsp;<span class="ident" id="8300691">TestPtrToMapOfMap</span><span class="op" id="8300708">(</span><span class="ident" id="8300709">t</span>&nbsp;<span class="op" id="8300711">*</span><span class="ident" id="8300712">testing</span><span class="op" id="8300719">.</span><span class="ident" id="8300720">T</span><span class="op" id="8300721">)</span>&nbsp;<span class="op" id="8300723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300726">Register</span><span class="op" id="8300734">(</span><span class="builtinfunc" id="8300735">make</span><span class="op" id="8300739">(</span><span class="keyword" id="8300740">map</span><span class="op" id="8300743">[</span><span class="builtintype" id="8300744">string</span><span class="op" id="8300750">]</span><span class="keyword" id="8300751">interface</span><span class="op" id="8300760">{</span><span class="op" id="8300761">}</span><span class="op" id="8300762">)</span><span class="op" id="8300763">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300766">subdata</span>&nbsp;<span class="op" id="8300774">:=</span>&nbsp;<span class="builtinfunc" id="8300777">make</span><span class="op" id="8300781">(</span><span class="keyword" id="8300782">map</span><span class="op" id="8300785">[</span><span class="builtintype" id="8300786">string</span><span class="op" id="8300792">]</span><span class="keyword" id="8300793">interface</span><span class="op" id="8300802">{</span><span class="op" id="8300803">}</span><span class="op" id="8300804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300807">subdata</span><span class="op" id="8300814">[</span><span class="string" id="8300815">&#34;bar&#34;</span><span class="op" id="8300820">]</span>&nbsp;<span class="op" id="8300822">=</span>&nbsp;<span class="string" id="8300824">&#34;baz&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300831">data</span>&nbsp;<span class="op" id="8300836">:=</span>&nbsp;<span class="builtinfunc" id="8300839">make</span><span class="op" id="8300843">(</span><span class="keyword" id="8300844">map</span><span class="op" id="8300847">[</span><span class="builtintype" id="8300848">string</span><span class="op" id="8300854">]</span><span class="keyword" id="8300855">interface</span><span class="op" id="8300864">{</span><span class="op" id="8300865">}</span><span class="op" id="8300866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300869">data</span><span class="op" id="8300873">[</span><span class="string" id="8300874">&#34;foo&#34;</span><span class="op" id="8300879">]</span>&nbsp;<span class="op" id="8300881">=</span>&nbsp;<span class="ident" id="8300883">subdata</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300893">b</span>&nbsp;<span class="op" id="8300895">:=</span>&nbsp;<span class="builtinfunc" id="8300898">new</span><span class="op" id="8300901">(</span><span class="ident" id="8300902">bytes</span><span class="op" id="8300907">.</span><span class="ident" id="8300908">Buffer</span><span class="op" id="8300914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300917">err</span>&nbsp;<span class="op" id="8300921">:=</span>&nbsp;<span class="ident" id="8300924">NewEncoder</span><span class="op" id="8300934">(</span><span class="ident" id="8300935">b</span><span class="op" id="8300936">)</span><span class="op" id="8300937">.</span><span class="ident" id="8300938">Encode</span><span class="op" id="8300944">(</span><span class="ident" id="8300945">data</span><span class="op" id="8300949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8300952">if</span>&nbsp;<span class="ident" id="8300955">err</span>&nbsp;<span class="op" id="8300959">!=</span>&nbsp;<span class="builtintype" id="8300962">nil</span>&nbsp;<span class="op" id="8300966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8300970">t</span><span class="op" id="8300971">.</span><span class="ident" id="8300972">Fatal</span><span class="op" id="8300977">(</span><span class="string" id="8300978">&#34;encode:&#34;</span><span class="op" id="8300987">,</span>&nbsp;<span class="ident" id="8300989">err</span><span class="op" id="8300992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8300995">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8300998">var</span>&nbsp;<span class="ident" id="8301002">newData</span>&nbsp;<span class="keyword" id="8301010">map</span><span class="op" id="8301013">[</span><span class="builtintype" id="8301014">string</span><span class="op" id="8301020">]</span><span class="keyword" id="8301021">interface</span><span class="op" id="8301030">{</span><span class="op" id="8301031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301034">err</span>&nbsp;<span class="op" id="8301038">=</span>&nbsp;<span class="ident" id="8301040">NewDecoder</span><span class="op" id="8301050">(</span><span class="ident" id="8301051">b</span><span class="op" id="8301052">)</span><span class="op" id="8301053">.</span><span class="ident" id="8301054">Decode</span><span class="op" id="8301060">(</span><span class="op" id="8301061">&amp;</span><span class="ident" id="8301062">newData</span><span class="op" id="8301069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8301072">if</span>&nbsp;<span class="ident" id="8301075">err</span>&nbsp;<span class="op" id="8301079">!=</span>&nbsp;<span class="builtintype" id="8301082">nil</span>&nbsp;<span class="op" id="8301086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301090">t</span><span class="op" id="8301091">.</span><span class="ident" id="8301092">Fatal</span><span class="op" id="8301097">(</span><span class="string" id="8301098">&#34;decode:&#34;</span><span class="op" id="8301107">,</span>&nbsp;<span class="ident" id="8301109">err</span><span class="op" id="8301112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8301115">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8301118">if</span>&nbsp;<span class="op" id="8301121">!</span><span class="ident" id="8301122">reflect</span><span class="op" id="8301129">.</span><span class="ident" id="8301130">DeepEqual</span><span class="op" id="8301139">(</span><span class="ident" id="8301140">data</span><span class="op" id="8301144">,</span>&nbsp;<span class="ident" id="8301146">newData</span><span class="op" id="8301153">)</span>&nbsp;<span class="op" id="8301155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301159">t</span><span class="op" id="8301160">.</span><span class="ident" id="8301161">Fatalf</span><span class="op" id="8301167">(</span><span class="string" id="8301168">&#34;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8301188">,</span>&nbsp;<span class="ident" id="8301190">data</span><span class="op" id="8301194">,</span>&nbsp;<span class="ident" id="8301196">newData</span><span class="op" id="8301203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8301206">}</span><br>
<span class="lineno"></span><span class="op" id="8301208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span><span class="comment" id="8301211">//&nbsp;A&nbsp;top-level&nbsp;nil&nbsp;pointer&nbsp;generates&nbsp;a&nbsp;panic&nbsp;with&nbsp;a&nbsp;helpful&nbsp;string-valued&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="8301294">func</span>&nbsp;<span class="ident" id="8301299">TestTopLevelNilPointer</span><span class="op" id="8301321">(</span><span class="ident" id="8301322">t</span>&nbsp;<span class="op" id="8301324">*</span><span class="ident" id="8301325">testing</span><span class="op" id="8301332">.</span><span class="ident" id="8301333">T</span><span class="op" id="8301334">)</span>&nbsp;<span class="op" id="8301336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301339">errMsg</span>&nbsp;<span class="op" id="8301346">:=</span>&nbsp;<span class="ident" id="8301349">topLevelNilPanic</span><span class="op" id="8301365">(</span><span class="ident" id="8301366">t</span><span class="op" id="8301367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8301370">if</span>&nbsp;<span class="ident" id="8301373">errMsg</span>&nbsp;<span class="op" id="8301380">==</span>&nbsp;<span class="string" id="8301383">&#34;&#34;</span>&nbsp;<span class="op" id="8301386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301390">t</span><span class="op" id="8301391">.</span><span class="ident" id="8301392">Fatal</span><span class="op" id="8301397">(</span><span class="string" id="8301398">&#34;top-level&nbsp;nil&nbsp;pointer&nbsp;did&nbsp;not&nbsp;panic&#34;</span><span class="op" id="8301435">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8301438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8301441">if</span>&nbsp;<span class="op" id="8301444">!</span><span class="ident" id="8301445">strings</span><span class="op" id="8301452">.</span><span class="ident" id="8301453">Contains</span><span class="op" id="8301461">(</span><span class="ident" id="8301462">errMsg</span><span class="op" id="8301468">,</span>&nbsp;<span class="string" id="8301470">&#34;nil&nbsp;pointer&#34;</span><span class="op" id="8301483">)</span>&nbsp;<span class="op" id="8301485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301489">t</span><span class="op" id="8301490">.</span><span class="ident" id="8301491">Fatal</span><span class="op" id="8301496">(</span><span class="string" id="8301497">&#34;expected&nbsp;nil&nbsp;pointer&nbsp;error,&nbsp;got:&#34;</span><span class="op" id="8301531">,</span>&nbsp;<span class="ident" id="8301533">errMsg</span><span class="op" id="8301539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8301542">}</span><br>
<span class="lineno"></span><span class="op" id="8301544">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="8301547">func</span>&nbsp;<span class="ident" id="8301552">topLevelNilPanic</span><span class="op" id="8301568">(</span><span class="ident" id="8301569">t</span>&nbsp;<span class="op" id="8301571">*</span><span class="ident" id="8301572">testing</span><span class="op" id="8301579">.</span><span class="ident" id="8301580">T</span><span class="op" id="8301581">)</span>&nbsp;<span class="op" id="8301583">(</span><span class="ident" id="8301584">panicErr</span>&nbsp;<span class="builtintype" id="8301593">string</span><span class="op" id="8301599">)</span>&nbsp;<span class="op" id="8301601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8301604">defer</span>&nbsp;<span class="keyword" id="8301610">func</span><span class="op" id="8301614">(</span><span class="op" id="8301615">)</span>&nbsp;<span class="op" id="8301617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301621">e</span>&nbsp;<span class="op" id="8301623">:=</span>&nbsp;<span class="builtinfunc" id="8301626">recover</span><span class="op" id="8301633">(</span><span class="op" id="8301634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8301638">if</span>&nbsp;<span class="ident" id="8301641">err</span><span class="op" id="8301644">,</span>&nbsp;<span class="ident" id="8301646">ok</span>&nbsp;<span class="op" id="8301649">:=</span>&nbsp;<span class="ident" id="8301652">e</span><span class="op" id="8301653">.</span><span class="op" id="8301654">(</span><span class="builtintype" id="8301655">string</span><span class="op" id="8301661">)</span><span class="op" id="8301662">;</span>&nbsp;<span class="ident" id="8301664">ok</span>&nbsp;<span class="op" id="8301667">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301672">panicErr</span>&nbsp;<span class="op" id="8301681">=</span>&nbsp;<span class="ident" id="8301683">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8301689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8301692">}</span><span class="op" id="8301693">(</span><span class="op" id="8301694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8301697">var</span>&nbsp;<span class="ident" id="8301701">ip</span>&nbsp;<span class="op" id="8301704">*</span><span class="builtintype" id="8301705">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301710">buf</span>&nbsp;<span class="op" id="8301714">:=</span>&nbsp;<span class="builtinfunc" id="8301717">new</span><span class="op" id="8301720">(</span><span class="ident" id="8301721">bytes</span><span class="op" id="8301726">.</span><span class="ident" id="8301727">Buffer</span><span class="op" id="8301733">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8301736">if</span>&nbsp;<span class="ident" id="8301739">err</span>&nbsp;<span class="op" id="8301743">:=</span>&nbsp;<span class="ident" id="8301746">NewEncoder</span><span class="op" id="8301756">(</span><span class="ident" id="8301757">buf</span><span class="op" id="8301760">)</span><span class="op" id="8301761">.</span><span class="ident" id="8301762">Encode</span><span class="op" id="8301768">(</span><span class="ident" id="8301769">ip</span><span class="op" id="8301771">)</span><span class="op" id="8301772">;</span>&nbsp;<span class="ident" id="8301774">err</span>&nbsp;<span class="op" id="8301778">!=</span>&nbsp;<span class="builtintype" id="8301781">nil</span>&nbsp;<span class="op" id="8301785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301789">t</span><span class="op" id="8301790">.</span><span class="ident" id="8301791">Fatal</span><span class="op" id="8301796">(</span><span class="string" id="8301797">&#34;error&nbsp;in&nbsp;encode:&#34;</span><span class="op" id="8301815">,</span>&nbsp;<span class="ident" id="8301817">err</span><span class="op" id="8301820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8301823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8301826">return</span><br>
<span class="lineno"></span><span class="op" id="8301833">}</span><br>
<span class="lineno">855</span><br>
<span class="lineno"></span><span class="keyword" id="8301836">func</span>&nbsp;<span class="ident" id="8301841">TestNilPointerInsideInterface</span><span class="op" id="8301870">(</span><span class="ident" id="8301871">t</span>&nbsp;<span class="op" id="8301873">*</span><span class="ident" id="8301874">testing</span><span class="op" id="8301881">.</span><span class="ident" id="8301882">T</span><span class="op" id="8301883">)</span>&nbsp;<span class="op" id="8301885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8301888">var</span>&nbsp;<span class="ident" id="8301892">ip</span>&nbsp;<span class="op" id="8301895">*</span><span class="builtintype" id="8301896">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301901">si</span>&nbsp;<span class="op" id="8301904">:=</span>&nbsp;<span class="keyword" id="8301907">struct</span>&nbsp;<span class="op" id="8301914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301918">I</span>&nbsp;<span class="keyword" id="8301920">interface</span><span class="op" id="8301929">{</span><span class="op" id="8301930">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8301933">}</span><span class="op" id="8301934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301938">I</span><span class="op" id="8301939">:</span>&nbsp;<span class="ident" id="8301941">ip</span><span class="op" id="8301943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8301946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301949">buf</span>&nbsp;<span class="op" id="8301953">:=</span>&nbsp;<span class="builtinfunc" id="8301956">new</span><span class="op" id="8301959">(</span><span class="ident" id="8301960">bytes</span><span class="op" id="8301965">.</span><span class="ident" id="8301966">Buffer</span><span class="op" id="8301972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8301975">err</span>&nbsp;<span class="op" id="8301979">:=</span>&nbsp;<span class="ident" id="8301982">NewEncoder</span><span class="op" id="8301992">(</span><span class="ident" id="8301993">buf</span><span class="op" id="8301996">)</span><span class="op" id="8301997">.</span><span class="ident" id="8301998">Encode</span><span class="op" id="8302004">(</span><span class="ident" id="8302005">si</span><span class="op" id="8302007">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8302010">if</span>&nbsp;<span class="ident" id="8302013">err</span>&nbsp;<span class="op" id="8302017">==</span>&nbsp;<span class="builtintype" id="8302020">nil</span>&nbsp;<span class="op" id="8302024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302028">t</span><span class="op" id="8302029">.</span><span class="ident" id="8302030">Fatal</span><span class="op" id="8302035">(</span><span class="string" id="8302036">&#34;expected&nbsp;error,&nbsp;got&nbsp;none&#34;</span><span class="op" id="8302062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8302065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302068">errMsg</span>&nbsp;<span class="op" id="8302075">:=</span>&nbsp;<span class="ident" id="8302078">err</span><span class="op" id="8302081">.</span><span class="ident" id="8302082">Error</span><span class="op" id="8302087">(</span><span class="op" id="8302088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8302091">if</span>&nbsp;<span class="op" id="8302094">!</span><span class="ident" id="8302095">strings</span><span class="op" id="8302102">.</span><span class="ident" id="8302103">Contains</span><span class="op" id="8302111">(</span><span class="ident" id="8302112">errMsg</span><span class="op" id="8302118">,</span>&nbsp;<span class="string" id="8302120">&#34;nil&nbsp;pointer&#34;</span><span class="op" id="8302133">)</span>&nbsp;<span class="op" id="8302135">||</span>&nbsp;<span class="op" id="8302138">!</span><span class="ident" id="8302139">strings</span><span class="op" id="8302146">.</span><span class="ident" id="8302147">Contains</span><span class="op" id="8302155">(</span><span class="ident" id="8302156">errMsg</span><span class="op" id="8302162">,</span>&nbsp;<span class="string" id="8302164">&#34;interface&#34;</span><span class="op" id="8302175">)</span>&nbsp;<span class="op" id="8302177">{</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302181">t</span><span class="op" id="8302182">.</span><span class="ident" id="8302183">Fatal</span><span class="op" id="8302188">(</span><span class="string" id="8302189">&#34;expected&nbsp;error&nbsp;about&nbsp;nil&nbsp;pointer&nbsp;and&nbsp;interface,&nbsp;got:&#34;</span><span class="op" id="8302243">,</span>&nbsp;<span class="ident" id="8302245">errMsg</span><span class="op" id="8302251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8302254">}</span><br>
<span class="lineno"></span><span class="op" id="8302256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8302259">type</span>&nbsp;<span class="ident" id="8302264">Bug4Public</span>&nbsp;<span class="keyword" id="8302275">struct</span>&nbsp;<span class="op" id="8302282">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302285">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8302292">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302300">Secret</span>&nbsp;<span class="ident" id="8302307">Bug4Secret</span><br>
<span class="lineno"></span><span class="op" id="8302318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8302321">type</span>&nbsp;<span class="ident" id="8302326">Bug4Secret</span>&nbsp;<span class="keyword" id="8302337">struct</span>&nbsp;<span class="op" id="8302344">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302347">a</span>&nbsp;<span class="builtintype" id="8302349">int</span>&nbsp;<span class="comment" id="8302353">//&nbsp;error:&nbsp;no&nbsp;exported&nbsp;fields.</span><br>
<span class="lineno"></span><span class="op" id="8302383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8302386">//&nbsp;Test&nbsp;that&nbsp;a&nbsp;failed&nbsp;compilation&nbsp;doesn&#39;t&nbsp;leave&nbsp;around&nbsp;an&nbsp;executable&nbsp;encoder.</span><br>
<span class="lineno"></span><span class="comment" id="8302464">//&nbsp;Issue&nbsp;3273.</span><br>
<span class="lineno">885</span><span class="keyword" id="8302479">func</span>&nbsp;<span class="ident" id="8302484">TestMutipleEncodingsOfBadType</span><span class="op" id="8302513">(</span><span class="ident" id="8302514">t</span>&nbsp;<span class="op" id="8302516">*</span><span class="ident" id="8302517">testing</span><span class="op" id="8302524">.</span><span class="ident" id="8302525">T</span><span class="op" id="8302526">)</span>&nbsp;<span class="op" id="8302528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302531">x</span>&nbsp;<span class="op" id="8302533">:=</span>&nbsp;<span class="ident" id="8302536">Bug4Public</span><span class="op" id="8302546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302550">Name</span><span class="op" id="8302554">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8302558">&#34;name&#34;</span><span class="op" id="8302564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302568">Secret</span><span class="op" id="8302574">:</span>&nbsp;<span class="ident" id="8302576">Bug4Secret</span><span class="op" id="8302586">{</span><span class="num" id="8302587">1</span><span class="op" id="8302588">}</span><span class="op" id="8302589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8302592">}</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302595">buf</span>&nbsp;<span class="op" id="8302599">:=</span>&nbsp;<span class="builtinfunc" id="8302602">new</span><span class="op" id="8302605">(</span><span class="ident" id="8302606">bytes</span><span class="op" id="8302611">.</span><span class="ident" id="8302612">Buffer</span><span class="op" id="8302618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302621">enc</span>&nbsp;<span class="op" id="8302625">:=</span>&nbsp;<span class="ident" id="8302628">NewEncoder</span><span class="op" id="8302638">(</span><span class="ident" id="8302639">buf</span><span class="op" id="8302642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302645">err</span>&nbsp;<span class="op" id="8302649">:=</span>&nbsp;<span class="ident" id="8302652">enc</span><span class="op" id="8302655">.</span><span class="ident" id="8302656">Encode</span><span class="op" id="8302662">(</span><span class="ident" id="8302663">x</span><span class="op" id="8302664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8302667">if</span>&nbsp;<span class="ident" id="8302670">err</span>&nbsp;<span class="op" id="8302674">==</span>&nbsp;<span class="builtintype" id="8302677">nil</span>&nbsp;<span class="op" id="8302681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302685">t</span><span class="op" id="8302686">.</span><span class="ident" id="8302687">Fatal</span><span class="op" id="8302692">(</span><span class="string" id="8302693">&#34;first&nbsp;encoding:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="8302725">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8302728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302731">buf</span><span class="op" id="8302734">.</span><span class="ident" id="8302735">Reset</span><span class="op" id="8302740">(</span><span class="op" id="8302741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302744">enc</span>&nbsp;<span class="op" id="8302748">=</span>&nbsp;<span class="ident" id="8302750">NewEncoder</span><span class="op" id="8302760">(</span><span class="ident" id="8302761">buf</span><span class="op" id="8302764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302767">err</span>&nbsp;<span class="op" id="8302771">=</span>&nbsp;<span class="ident" id="8302773">enc</span><span class="op" id="8302776">.</span><span class="ident" id="8302777">Encode</span><span class="op" id="8302783">(</span><span class="ident" id="8302784">x</span><span class="op" id="8302785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8302788">if</span>&nbsp;<span class="ident" id="8302791">err</span>&nbsp;<span class="op" id="8302795">==</span>&nbsp;<span class="builtintype" id="8302798">nil</span>&nbsp;<span class="op" id="8302802">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302806">t</span><span class="op" id="8302807">.</span><span class="ident" id="8302808">Fatal</span><span class="op" id="8302813">(</span><span class="string" id="8302814">&#34;second&nbsp;encoding:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="8302847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8302850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8302853">if</span>&nbsp;<span class="op" id="8302856">!</span><span class="ident" id="8302857">strings</span><span class="op" id="8302864">.</span><span class="ident" id="8302865">Contains</span><span class="op" id="8302873">(</span><span class="ident" id="8302874">err</span><span class="op" id="8302877">.</span><span class="ident" id="8302878">Error</span><span class="op" id="8302883">(</span><span class="op" id="8302884">)</span><span class="op" id="8302885">,</span>&nbsp;<span class="string" id="8302887">&#34;no&nbsp;exported&nbsp;fields&#34;</span><span class="op" id="8302907">)</span>&nbsp;<span class="op" id="8302909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8302913">t</span><span class="op" id="8302914">.</span><span class="ident" id="8302915">Errorf</span><span class="op" id="8302921">(</span><span class="string" id="8302922">&#34;expected&nbsp;error&nbsp;about&nbsp;no&nbsp;exported&nbsp;fields;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8302971">,</span>&nbsp;<span class="ident" id="8302973">err</span><span class="op" id="8302976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8302979">}</span><br>
<span class="lineno">905</span><span class="op" id="8302981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8302984">//&nbsp;There&nbsp;was&nbsp;an&nbsp;error&nbsp;check&nbsp;comparing&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;input&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="8303055">//&nbsp;length&nbsp;of&nbsp;the&nbsp;slice&nbsp;being&nbsp;decoded.&nbsp;It&nbsp;was&nbsp;wrong&nbsp;because&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="8303123">//&nbsp;thing&nbsp;in&nbsp;the&nbsp;input&nbsp;might&nbsp;be&nbsp;a&nbsp;type&nbsp;definition,&nbsp;which&nbsp;would&nbsp;lead&nbsp;to</span><br>
<span class="lineno">910</span><span class="comment" id="8303193">//&nbsp;an&nbsp;incorrect&nbsp;length&nbsp;check.&nbsp;&nbsp;This&nbsp;test&nbsp;reproduces&nbsp;the&nbsp;corner&nbsp;case.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8303263">type</span>&nbsp;<span class="ident" id="8303268">Z</span>&nbsp;<span class="keyword" id="8303270">struct</span>&nbsp;<span class="op" id="8303277">{</span><br>
<span class="lineno"></span><span class="op" id="8303279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="keyword" id="8303282">func</span>&nbsp;<span class="ident" id="8303287">Test29ElementSlice</span><span class="op" id="8303305">(</span><span class="ident" id="8303306">t</span>&nbsp;<span class="op" id="8303308">*</span><span class="ident" id="8303309">testing</span><span class="op" id="8303316">.</span><span class="ident" id="8303317">T</span><span class="op" id="8303318">)</span>&nbsp;<span class="op" id="8303320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8303323">Register</span><span class="op" id="8303331">(</span><span class="ident" id="8303332">Z</span><span class="op" id="8303333">{</span><span class="op" id="8303334">}</span><span class="op" id="8303335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8303338">src</span>&nbsp;<span class="op" id="8303342">:=</span>&nbsp;<span class="builtinfunc" id="8303345">make</span><span class="op" id="8303349">(</span><span class="op" id="8303350">[</span><span class="op" id="8303351">]</span><span class="keyword" id="8303352">interface</span><span class="op" id="8303361">{</span><span class="op" id="8303362">}</span><span class="op" id="8303363">,</span>&nbsp;<span class="num" id="8303365">100</span><span class="op" id="8303368">)</span>&nbsp;<span class="comment" id="8303370">//&nbsp;Size&nbsp;needs&nbsp;to&nbsp;be&nbsp;bigger&nbsp;than&nbsp;size&nbsp;of&nbsp;type&nbsp;definition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8303428">for</span>&nbsp;<span class="ident" id="8303432">i</span>&nbsp;<span class="op" id="8303434">:=</span>&nbsp;<span class="keyword" id="8303437">range</span>&nbsp;<span class="ident" id="8303443">src</span>&nbsp;<span class="op" id="8303447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8303451">src</span><span class="op" id="8303454">[</span><span class="ident" id="8303455">i</span><span class="op" id="8303456">]</span>&nbsp;<span class="op" id="8303458">=</span>&nbsp;<span class="ident" id="8303460">Z</span><span class="op" id="8303461">{</span><span class="op" id="8303462">}</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8303465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8303468">buf</span>&nbsp;<span class="op" id="8303472">:=</span>&nbsp;<span class="builtinfunc" id="8303475">new</span><span class="op" id="8303478">(</span><span class="ident" id="8303479">bytes</span><span class="op" id="8303484">.</span><span class="ident" id="8303485">Buffer</span><span class="op" id="8303491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8303494">err</span>&nbsp;<span class="op" id="8303498">:=</span>&nbsp;<span class="ident" id="8303501">NewEncoder</span><span class="op" id="8303511">(</span><span class="ident" id="8303512">buf</span><span class="op" id="8303515">)</span><span class="op" id="8303516">.</span><span class="ident" id="8303517">Encode</span><span class="op" id="8303523">(</span><span class="ident" id="8303524">src</span><span class="op" id="8303527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8303530">if</span>&nbsp;<span class="ident" id="8303533">err</span>&nbsp;<span class="op" id="8303537">!=</span>&nbsp;<span class="builtintype" id="8303540">nil</span>&nbsp;<span class="op" id="8303544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8303548">t</span><span class="op" id="8303549">.</span><span class="ident" id="8303550">Fatalf</span><span class="op" id="8303556">(</span><span class="string" id="8303557">&#34;encode:&nbsp;%v&#34;</span><span class="op" id="8303569">,</span>&nbsp;<span class="ident" id="8303571">err</span><span class="op" id="8303574">)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8303578">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8303586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8303590">var</span>&nbsp;<span class="ident" id="8303594">dst</span>&nbsp;<span class="op" id="8303598">[</span><span class="op" id="8303599">]</span><span class="keyword" id="8303600">interface</span><span class="op" id="8303609">{</span><span class="op" id="8303610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8303613">err</span>&nbsp;<span class="op" id="8303617">=</span>&nbsp;<span class="ident" id="8303619">NewDecoder</span><span class="op" id="8303629">(</span><span class="ident" id="8303630">buf</span><span class="op" id="8303633">)</span><span class="op" id="8303634">.</span><span class="ident" id="8303635">Decode</span><span class="op" id="8303641">(</span><span class="op" id="8303642">&amp;</span><span class="ident" id="8303643">dst</span><span class="op" id="8303646">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8303649">if</span>&nbsp;<span class="ident" id="8303652">err</span>&nbsp;<span class="op" id="8303656">!=</span>&nbsp;<span class="builtintype" id="8303659">nil</span>&nbsp;<span class="op" id="8303663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8303667">t</span><span class="op" id="8303668">.</span><span class="ident" id="8303669">Errorf</span><span class="op" id="8303675">(</span><span class="string" id="8303676">&#34;decode:&nbsp;%v&#34;</span><span class="op" id="8303688">,</span>&nbsp;<span class="ident" id="8303690">err</span><span class="op" id="8303693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8303697">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8303705">}</span><br>
<span class="lineno"></span><span class="op" id="8303707">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span><span class="comment" id="8303710">//&nbsp;Don&#39;t&nbsp;crash,&nbsp;just&nbsp;give&nbsp;error&nbsp;when&nbsp;allocating&nbsp;a&nbsp;huge&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="8303772">//&nbsp;Issue&nbsp;8084.</span><br>
<span class="lineno"></span><span class="keyword" id="8303787">func</span>&nbsp;<span class="ident" id="8303792">TestErrorForHugeSlice</span><span class="op" id="8303813">(</span><span class="ident" id="8303814">t</span>&nbsp;<span class="op" id="8303816">*</span><span class="ident" id="8303817">testing</span><span class="op" id="8303824">.</span><span class="ident" id="8303825">T</span><span class="op" id="8303826">)</span>&nbsp;<span class="op" id="8303828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8303831">//&nbsp;Encode&nbsp;an&nbsp;int&nbsp;slice.</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8303856">buf</span>&nbsp;<span class="op" id="8303860">:=</span>&nbsp;<span class="builtinfunc" id="8303863">new</span><span class="op" id="8303866">(</span><span class="ident" id="8303867">bytes</span><span class="op" id="8303872">.</span><span class="ident" id="8303873">Buffer</span><span class="op" id="8303879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8303882">slice</span>&nbsp;<span class="op" id="8303888">:=</span>&nbsp;<span class="op" id="8303891">[</span><span class="op" id="8303892">]</span><span class="builtintype" id="8303893">int</span><span class="op" id="8303896">{</span><span class="num" id="8303897">1</span><span class="op" id="8303898">,</span>&nbsp;<span class="num" id="8303900">1</span><span class="op" id="8303901">,</span>&nbsp;<span class="num" id="8303903">1</span><span class="op" id="8303904">,</span>&nbsp;<span class="num" id="8303906">1</span><span class="op" id="8303907">,</span>&nbsp;<span class="num" id="8303909">1</span><span class="op" id="8303910">,</span>&nbsp;<span class="num" id="8303912">1</span><span class="op" id="8303913">,</span>&nbsp;<span class="num" id="8303915">1</span><span class="op" id="8303916">,</span>&nbsp;<span class="num" id="8303918">1</span><span class="op" id="8303919">,</span>&nbsp;<span class="num" id="8303921">1</span><span class="op" id="8303922">,</span>&nbsp;<span class="num" id="8303924">1</span><span class="op" id="8303925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8303928">err</span>&nbsp;<span class="op" id="8303932">:=</span>&nbsp;<span class="ident" id="8303935">NewEncoder</span><span class="op" id="8303945">(</span><span class="ident" id="8303946">buf</span><span class="op" id="8303949">)</span><span class="op" id="8303950">.</span><span class="ident" id="8303951">Encode</span><span class="op" id="8303957">(</span><span class="ident" id="8303958">slice</span><span class="op" id="8303963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8303966">if</span>&nbsp;<span class="ident" id="8303969">err</span>&nbsp;<span class="op" id="8303973">!=</span>&nbsp;<span class="builtintype" id="8303976">nil</span>&nbsp;<span class="op" id="8303980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8303984">t</span><span class="op" id="8303985">.</span><span class="ident" id="8303986">Fatal</span><span class="op" id="8303991">(</span><span class="string" id="8303992">&#34;encode:&#34;</span><span class="op" id="8304001">,</span>&nbsp;<span class="ident" id="8304003">err</span><span class="op" id="8304006">)</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8304009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8304012">//&nbsp;Reach&nbsp;into&nbsp;the&nbsp;buffer&nbsp;and&nbsp;smash&nbsp;the&nbsp;count&nbsp;to&nbsp;make&nbsp;the&nbsp;encoded&nbsp;slice&nbsp;very&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8304095">buf</span><span class="op" id="8304098">.</span><span class="ident" id="8304099">Bytes</span><span class="op" id="8304104">(</span><span class="op" id="8304105">)</span><span class="op" id="8304106">[</span><span class="ident" id="8304107">buf</span><span class="op" id="8304110">.</span><span class="ident" id="8304111">Len</span><span class="op" id="8304114">(</span><span class="op" id="8304115">)</span><span class="op" id="8304116">-</span><span class="builtinfunc" id="8304117">len</span><span class="op" id="8304120">(</span><span class="ident" id="8304121">slice</span><span class="op" id="8304126">)</span><span class="op" id="8304127">-</span><span class="num" id="8304128">1</span><span class="op" id="8304129">]</span>&nbsp;<span class="op" id="8304131">=</span>&nbsp;<span class="num" id="8304133">0xfa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8304139">//&nbsp;Decode&nbsp;and&nbsp;see&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8304165">err</span>&nbsp;<span class="op" id="8304169">=</span>&nbsp;<span class="ident" id="8304171">NewDecoder</span><span class="op" id="8304181">(</span><span class="ident" id="8304182">buf</span><span class="op" id="8304185">)</span><span class="op" id="8304186">.</span><span class="ident" id="8304187">Decode</span><span class="op" id="8304193">(</span><span class="op" id="8304194">&amp;</span><span class="ident" id="8304195">slice</span><span class="op" id="8304200">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8304203">if</span>&nbsp;<span class="ident" id="8304206">err</span>&nbsp;<span class="op" id="8304210">==</span>&nbsp;<span class="builtintype" id="8304213">nil</span>&nbsp;<span class="op" id="8304217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8304221">t</span><span class="op" id="8304222">.</span><span class="ident" id="8304223">Fatal</span><span class="op" id="8304228">(</span><span class="string" id="8304229">&#34;decode:&nbsp;no&nbsp;error&#34;</span><span class="op" id="8304247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8304250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8304253">if</span>&nbsp;<span class="op" id="8304256">!</span><span class="ident" id="8304257">strings</span><span class="op" id="8304264">.</span><span class="ident" id="8304265">Contains</span><span class="op" id="8304273">(</span><span class="ident" id="8304274">err</span><span class="op" id="8304277">.</span><span class="ident" id="8304278">Error</span><span class="op" id="8304283">(</span><span class="op" id="8304284">)</span><span class="op" id="8304285">,</span>&nbsp;<span class="string" id="8304287">&#34;slice&nbsp;too&nbsp;big&#34;</span><span class="op" id="8304302">)</span>&nbsp;<span class="op" id="8304304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8304308">t</span><span class="op" id="8304309">.</span><span class="ident" id="8304310">Fatal</span><span class="op" id="8304315">(</span><span class="string" id="8304316">&#34;decode:&nbsp;expected&nbsp;slice&nbsp;too&nbsp;big&nbsp;error,&nbsp;got&nbsp;%s&#34;</span><span class="op" id="8304362">,</span>&nbsp;<span class="ident" id="8304364">err</span><span class="op" id="8304367">.</span><span class="ident" id="8304368">Error</span><span class="op" id="8304373">(</span><span class="op" id="8304374">)</span><span class="op" id="8304375">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8304378">}</span><br>
<span class="lineno"></span><span class="op" id="8304380">}</span>
</div>
</body>
</html>
