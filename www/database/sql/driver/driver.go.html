<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5923569">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5923624">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5923678">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5923729">//&nbsp;Package&nbsp;driver&nbsp;defines&nbsp;interfaces&nbsp;to&nbsp;be&nbsp;implemented&nbsp;by&nbsp;database</span><br>
<span class="lineno"></span><span class="comment" id="5923796">//&nbsp;drivers&nbsp;as&nbsp;used&nbsp;by&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="comment" id="5923831">//</span><br>
<span class="lineno"></span><span class="comment" id="5923834">//&nbsp;Most&nbsp;code&nbsp;should&nbsp;use&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="keyword" id="5923871">package</span>&nbsp;<span class="ident" id="5923879">driver</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5923887">import</span>&nbsp;<span class="string" id="5923894">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5923904">//&nbsp;Value&nbsp;is&nbsp;a&nbsp;value&nbsp;that&nbsp;drivers&nbsp;must&nbsp;be&nbsp;able&nbsp;to&nbsp;handle.</span><br>
<span class="lineno"></span><span class="comment" id="5923961">//&nbsp;It&nbsp;is&nbsp;either&nbsp;nil&nbsp;or&nbsp;an&nbsp;instance&nbsp;of&nbsp;one&nbsp;of&nbsp;these&nbsp;types:</span><br>
<span class="lineno">15</span><span class="comment" id="5924019">//</span><br>
<span class="lineno"></span><span class="comment" id="5924022">//&nbsp;&nbsp;&nbsp;int64</span><br>
<span class="lineno"></span><span class="comment" id="5924033">//&nbsp;&nbsp;&nbsp;float64</span><br>
<span class="lineno"></span><span class="comment" id="5924046">//&nbsp;&nbsp;&nbsp;bool</span><br>
<span class="lineno"></span><span class="comment" id="5924056">//&nbsp;&nbsp;&nbsp;[]byte</span><br>
<span class="lineno">20</span><span class="comment" id="5924068">//&nbsp;&nbsp;&nbsp;string&nbsp;&nbsp;&nbsp;[*]&nbsp;everywhere&nbsp;except&nbsp;from&nbsp;Rows.Next.</span><br>
<span class="lineno"></span><span class="comment" id="5924120">//&nbsp;&nbsp;&nbsp;time.Time</span><br>
<span class="lineno"></span><span class="keyword" id="5924135">type</span>&nbsp;<span class="ident" id="5924140">Value</span>&nbsp;<span class="keyword" id="5924146">interface</span><span class="op" id="5924155">{</span><span class="op" id="5924156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5924159">//&nbsp;Driver&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;must&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;database</span><br>
<span class="lineno">25</span><span class="comment" id="5924225">//&nbsp;driver.</span><br>
<span class="lineno"></span><span class="keyword" id="5924236">type</span>&nbsp;<span class="ident" id="5924241">Driver</span>&nbsp;<span class="keyword" id="5924248">interface</span>&nbsp;<span class="op" id="5924258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5924261">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;connection&nbsp;to&nbsp;the&nbsp;database.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5924312">//&nbsp;The&nbsp;name&nbsp;is&nbsp;a&nbsp;string&nbsp;in&nbsp;a&nbsp;driver-specific&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5924366">//</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5924370">//&nbsp;Open&nbsp;may&nbsp;return&nbsp;a&nbsp;cached&nbsp;connection&nbsp;(one&nbsp;previously</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5924426">//&nbsp;closed),&nbsp;but&nbsp;doing&nbsp;so&nbsp;is&nbsp;unnecessary;&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5924484">//&nbsp;maintains&nbsp;a&nbsp;pool&nbsp;of&nbsp;idle&nbsp;connections&nbsp;for&nbsp;efficient&nbsp;re-use.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5924547">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5924551">//&nbsp;The&nbsp;returned&nbsp;connection&nbsp;is&nbsp;only&nbsp;used&nbsp;by&nbsp;one&nbsp;goroutine&nbsp;at&nbsp;a</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5924614">//&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5924624">Open</span><span class="op" id="5924628">(</span><span class="ident" id="5924629">name</span>&nbsp;<span class="builtintype" id="5924634">string</span><span class="op" id="5924640">)</span>&nbsp;<span class="op" id="5924642">(</span><span class="ident" id="5924643">Conn</span><span class="op" id="5924647">,</span>&nbsp;<span class="builtintype" id="5924649">error</span><span class="op" id="5924654">)</span><br>
<span class="lineno"></span><span class="op" id="5924656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5924659">//&nbsp;ErrSkip&nbsp;may&nbsp;be&nbsp;returned&nbsp;by&nbsp;some&nbsp;optional&nbsp;interfaces&#39;&nbsp;methods&nbsp;to</span><br>
<span class="lineno">40</span><span class="comment" id="5924726">//&nbsp;indicate&nbsp;at&nbsp;runtime&nbsp;that&nbsp;the&nbsp;fast&nbsp;path&nbsp;is&nbsp;unavailable&nbsp;and&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5924795">//&nbsp;package&nbsp;should&nbsp;continue&nbsp;as&nbsp;if&nbsp;the&nbsp;optional&nbsp;interface&nbsp;was&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5924859">//&nbsp;implemented.&nbsp;ErrSkip&nbsp;is&nbsp;only&nbsp;supported&nbsp;where&nbsp;explicitly</span><br>
<span class="lineno"></span><span class="comment" id="5924918">//&nbsp;documented.</span><br>
<span class="lineno"></span><span class="keyword" id="5924933">var</span>&nbsp;<span class="ident" id="5924937">ErrSkip</span>&nbsp;<span class="op" id="5924945">=</span>&nbsp;<span class="ident" id="5924947">errors</span><span class="op" id="5924953">.</span><span class="ident" id="5924954">New</span><span class="op" id="5924957">(</span><span class="string" id="5924958">&#34;driver:&nbsp;skip&nbsp;fast-path;&nbsp;continue&nbsp;as&nbsp;if&nbsp;unimplemented&#34;</span><span class="op" id="5925012">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5925015">//&nbsp;ErrBadConn&nbsp;should&nbsp;be&nbsp;returned&nbsp;by&nbsp;a&nbsp;driver&nbsp;to&nbsp;signal&nbsp;to&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5925081">//&nbsp;package&nbsp;that&nbsp;a&nbsp;driver.Conn&nbsp;is&nbsp;in&nbsp;a&nbsp;bad&nbsp;state&nbsp;(such&nbsp;as&nbsp;the&nbsp;server</span><br>
<span class="lineno"></span><span class="comment" id="5925149">//&nbsp;having&nbsp;earlier&nbsp;closed&nbsp;the&nbsp;connection)&nbsp;and&nbsp;the&nbsp;sql&nbsp;package&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="5925217">//&nbsp;retry&nbsp;on&nbsp;a&nbsp;new&nbsp;connection.</span><br>
<span class="lineno">50</span><span class="comment" id="5925247">//</span><br>
<span class="lineno"></span><span class="comment" id="5925250">//&nbsp;To&nbsp;prevent&nbsp;duplicate&nbsp;operations,&nbsp;ErrBadConn&nbsp;should&nbsp;NOT&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span><span class="comment" id="5925320">//&nbsp;if&nbsp;there&#39;s&nbsp;a&nbsp;possibility&nbsp;that&nbsp;the&nbsp;database&nbsp;server&nbsp;might&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="5925384">//&nbsp;performed&nbsp;the&nbsp;operation.&nbsp;Even&nbsp;if&nbsp;the&nbsp;server&nbsp;sends&nbsp;back&nbsp;an&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5925452">//&nbsp;you&nbsp;shouldn&#39;t&nbsp;return&nbsp;ErrBadConn.</span><br>
<span class="lineno">55</span><span class="keyword" id="5925488">var</span>&nbsp;<span class="ident" id="5925492">ErrBadConn</span>&nbsp;<span class="op" id="5925503">=</span>&nbsp;<span class="ident" id="5925505">errors</span><span class="op" id="5925511">.</span><span class="ident" id="5925512">New</span><span class="op" id="5925515">(</span><span class="string" id="5925516">&#34;driver:&nbsp;bad&nbsp;connection&#34;</span><span class="op" id="5925540">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5925543">//&nbsp;Execer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5925613">//</span><br>
<span class="lineno"></span><span class="comment" id="5925616">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Execer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Exec&nbsp;will</span><br>
<span class="lineno">60</span><span class="comment" id="5925687">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5925755">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5925769">//</span><br>
<span class="lineno"></span><span class="comment" id="5925772">//&nbsp;Exec&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno"></span><span class="keyword" id="5925800">type</span>&nbsp;<span class="ident" id="5925805">Execer</span>&nbsp;<span class="keyword" id="5925812">interface</span>&nbsp;<span class="op" id="5925822">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925825">Exec</span><span class="op" id="5925829">(</span><span class="ident" id="5925830">query</span>&nbsp;<span class="builtintype" id="5925836">string</span><span class="op" id="5925842">,</span>&nbsp;<span class="ident" id="5925844">args</span>&nbsp;<span class="op" id="5925849">[</span><span class="op" id="5925850">]</span><span class="ident" id="5925851">Value</span><span class="op" id="5925856">)</span>&nbsp;<span class="op" id="5925858">(</span><span class="ident" id="5925859">Result</span><span class="op" id="5925865">,</span>&nbsp;<span class="builtintype" id="5925867">error</span><span class="op" id="5925872">)</span><br>
<span class="lineno"></span><span class="op" id="5925874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5925877">//&nbsp;Queryer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5925948">//</span><br>
<span class="lineno">70</span><span class="comment" id="5925951">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Queryer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Query&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="5926024">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5926092">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5926106">//</span><br>
<span class="lineno"></span><span class="comment" id="5926109">//&nbsp;Query&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno">75</span><span class="keyword" id="5926138">type</span>&nbsp;<span class="ident" id="5926143">Queryer</span>&nbsp;<span class="keyword" id="5926151">interface</span>&nbsp;<span class="op" id="5926161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926164">Query</span><span class="op" id="5926169">(</span><span class="ident" id="5926170">query</span>&nbsp;<span class="builtintype" id="5926176">string</span><span class="op" id="5926182">,</span>&nbsp;<span class="ident" id="5926184">args</span>&nbsp;<span class="op" id="5926189">[</span><span class="op" id="5926190">]</span><span class="ident" id="5926191">Value</span><span class="op" id="5926196">)</span>&nbsp;<span class="op" id="5926198">(</span><span class="ident" id="5926199">Rows</span><span class="op" id="5926203">,</span>&nbsp;<span class="builtintype" id="5926205">error</span><span class="op" id="5926210">)</span><br>
<span class="lineno"></span><span class="op" id="5926212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5926215">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;connection&nbsp;to&nbsp;a&nbsp;database.&nbsp;It&nbsp;is&nbsp;not&nbsp;used&nbsp;concurrently</span><br>
<span class="lineno">80</span><span class="comment" id="5926282">//&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="5926309">//</span><br>
<span class="lineno"></span><span class="comment" id="5926312">//&nbsp;Conn&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;stateful.</span><br>
<span class="lineno"></span><span class="keyword" id="5926347">type</span>&nbsp;<span class="ident" id="5926352">Conn</span>&nbsp;<span class="keyword" id="5926357">interface</span>&nbsp;<span class="op" id="5926367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926370">//&nbsp;Prepare&nbsp;returns&nbsp;a&nbsp;prepared&nbsp;statement,&nbsp;bound&nbsp;to&nbsp;this&nbsp;connection.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926438">Prepare</span><span class="op" id="5926445">(</span><span class="ident" id="5926446">query</span>&nbsp;<span class="builtintype" id="5926452">string</span><span class="op" id="5926458">)</span>&nbsp;<span class="op" id="5926460">(</span><span class="ident" id="5926461">Stmt</span><span class="op" id="5926465">,</span>&nbsp;<span class="builtintype" id="5926467">error</span><span class="op" id="5926472">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926476">//&nbsp;Close&nbsp;invalidates&nbsp;and&nbsp;potentially&nbsp;stops&nbsp;any&nbsp;current</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926532">//&nbsp;prepared&nbsp;statements&nbsp;and&nbsp;transactions,&nbsp;marking&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926587">//&nbsp;connection&nbsp;as&nbsp;no&nbsp;longer&nbsp;in&nbsp;use.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926623">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926627">//&nbsp;Because&nbsp;the&nbsp;sql&nbsp;package&nbsp;maintains&nbsp;a&nbsp;free&nbsp;pool&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926680">//&nbsp;connections&nbsp;and&nbsp;only&nbsp;calls&nbsp;Close&nbsp;when&nbsp;there&#39;s&nbsp;a&nbsp;surplus&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926743">//&nbsp;idle&nbsp;connections,&nbsp;it&nbsp;shouldn&#39;t&nbsp;be&nbsp;necessary&nbsp;for&nbsp;drivers&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926806">//&nbsp;do&nbsp;their&nbsp;own&nbsp;connection&nbsp;caching.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926843">Close</span><span class="op" id="5926848">(</span><span class="op" id="5926849">)</span>&nbsp;<span class="builtintype" id="5926851">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926859">//&nbsp;Begin&nbsp;starts&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;transaction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926907">Begin</span><span class="op" id="5926912">(</span><span class="op" id="5926913">)</span>&nbsp;<span class="op" id="5926915">(</span><span class="ident" id="5926916">Tx</span><span class="op" id="5926918">,</span>&nbsp;<span class="builtintype" id="5926920">error</span><span class="op" id="5926925">)</span><br>
<span class="lineno"></span><span class="op" id="5926927">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5926930">//&nbsp;Result&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;query&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="5926976">type</span>&nbsp;<span class="ident" id="5926981">Result</span>&nbsp;<span class="keyword" id="5926988">interface</span>&nbsp;<span class="op" id="5926998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927001">//&nbsp;LastInsertId&nbsp;returns&nbsp;the&nbsp;database&#39;s&nbsp;auto-generated&nbsp;ID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927059">//&nbsp;after,&nbsp;for&nbsp;example,&nbsp;an&nbsp;INSERT&nbsp;into&nbsp;a&nbsp;table&nbsp;with&nbsp;primary</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927119">//&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5927128">LastInsertId</span><span class="op" id="5927140">(</span><span class="op" id="5927141">)</span>&nbsp;<span class="op" id="5927143">(</span><span class="ident" id="5927144">int64</span><span class="op" id="5927149">,</span>&nbsp;<span class="builtintype" id="5927151">error</span><span class="op" id="5927156">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927160">//&nbsp;RowsAffected&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;rows&nbsp;affected&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927220">//&nbsp;query.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5927231">RowsAffected</span><span class="op" id="5927243">(</span><span class="op" id="5927244">)</span>&nbsp;<span class="op" id="5927246">(</span><span class="ident" id="5927247">int64</span><span class="op" id="5927252">,</span>&nbsp;<span class="builtintype" id="5927254">error</span><span class="op" id="5927259">)</span><br>
<span class="lineno"></span><span class="op" id="5927261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5927264">//&nbsp;Stmt&nbsp;is&nbsp;a&nbsp;prepared&nbsp;statement.&nbsp;It&nbsp;is&nbsp;bound&nbsp;to&nbsp;a&nbsp;Conn&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5927327">//&nbsp;used&nbsp;by&nbsp;multiple&nbsp;goroutines&nbsp;concurrently.</span><br>
<span class="lineno">115</span><span class="keyword" id="5927372">type</span>&nbsp;<span class="ident" id="5927377">Stmt</span>&nbsp;<span class="keyword" id="5927382">interface</span>&nbsp;<span class="op" id="5927392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927395">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;statement.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927427">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927431">//&nbsp;As&nbsp;of&nbsp;Go&nbsp;1.1,&nbsp;a&nbsp;Stmt&nbsp;will&nbsp;not&nbsp;be&nbsp;closed&nbsp;if&nbsp;it&#39;s&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927490">//&nbsp;by&nbsp;any&nbsp;queries.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5927510">Close</span><span class="op" id="5927515">(</span><span class="op" id="5927516">)</span>&nbsp;<span class="builtintype" id="5927518">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927526">//&nbsp;NumInput&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;placeholder&nbsp;parameters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927585">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927589">//&nbsp;If&nbsp;NumInput&nbsp;returns&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;sql&nbsp;package&nbsp;will&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927653">//&nbsp;argument&nbsp;counts&nbsp;from&nbsp;callers&nbsp;and&nbsp;return&nbsp;errors&nbsp;to&nbsp;the&nbsp;caller</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927718">//&nbsp;before&nbsp;the&nbsp;statement&#39;s&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;methods&nbsp;are&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927779">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927783">//&nbsp;NumInput&nbsp;may&nbsp;also&nbsp;return&nbsp;-1,&nbsp;if&nbsp;the&nbsp;driver&nbsp;doesn&#39;t&nbsp;know</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927843">//&nbsp;its&nbsp;number&nbsp;of&nbsp;placeholders.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927905">//&nbsp;will&nbsp;not&nbsp;sanity&nbsp;check&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;argument&nbsp;counts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5927962">NumInput</span><span class="op" id="5927970">(</span><span class="op" id="5927971">)</span>&nbsp;<span class="builtintype" id="5927973">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927979">//&nbsp;Exec&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;doesn&#39;t&nbsp;return&nbsp;rows,&nbsp;such</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928036">//&nbsp;as&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928064">Exec</span><span class="op" id="5928068">(</span><span class="ident" id="5928069">args</span>&nbsp;<span class="op" id="5928074">[</span><span class="op" id="5928075">]</span><span class="ident" id="5928076">Value</span><span class="op" id="5928081">)</span>&nbsp;<span class="op" id="5928083">(</span><span class="ident" id="5928084">Result</span><span class="op" id="5928090">,</span>&nbsp;<span class="builtintype" id="5928092">error</span><span class="op" id="5928097">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928101">//&nbsp;Query&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;may&nbsp;return&nbsp;rows,&nbsp;such&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928160">//&nbsp;SELECT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928172">Query</span><span class="op" id="5928177">(</span><span class="ident" id="5928178">args</span>&nbsp;<span class="op" id="5928183">[</span><span class="op" id="5928184">]</span><span class="ident" id="5928185">Value</span><span class="op" id="5928190">)</span>&nbsp;<span class="op" id="5928192">(</span><span class="ident" id="5928193">Rows</span><span class="op" id="5928197">,</span>&nbsp;<span class="builtintype" id="5928199">error</span><span class="op" id="5928204">)</span><br>
<span class="lineno">140</span><span class="op" id="5928206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5928209">//&nbsp;ColumnConverter&nbsp;may&nbsp;be&nbsp;optionally&nbsp;implemented&nbsp;by&nbsp;Stmt&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5928273">//&nbsp;statement&nbsp;is&nbsp;aware&nbsp;of&nbsp;its&nbsp;own&nbsp;columns&#39;&nbsp;types&nbsp;and&nbsp;can&nbsp;convert&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5928342">//&nbsp;any&nbsp;type&nbsp;to&nbsp;a&nbsp;driver&nbsp;Value.</span><br>
<span class="lineno">145</span><span class="keyword" id="5928373">type</span>&nbsp;<span class="ident" id="5928378">ColumnConverter</span>&nbsp;<span class="keyword" id="5928394">interface</span>&nbsp;<span class="op" id="5928404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928407">//&nbsp;ColumnConverter&nbsp;returns&nbsp;a&nbsp;ValueConverter&nbsp;for&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928469">//&nbsp;column&nbsp;index.&nbsp;&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;specific&nbsp;column&nbsp;isn&#39;t&nbsp;known</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928533">//&nbsp;or&nbsp;shouldn&#39;t&nbsp;be&nbsp;handled&nbsp;specially,&nbsp;DefaultValueConverter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928594">//&nbsp;can&nbsp;be&nbsp;returned.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928615">ColumnConverter</span><span class="op" id="5928630">(</span><span class="ident" id="5928631">idx</span>&nbsp;<span class="builtintype" id="5928635">int</span><span class="op" id="5928638">)</span>&nbsp;<span class="ident" id="5928640">ValueConverter</span><br>
<span class="lineno"></span><span class="op" id="5928655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5928658">//&nbsp;Rows&nbsp;is&nbsp;an&nbsp;iterator&nbsp;over&nbsp;an&nbsp;executed&nbsp;query&#39;s&nbsp;results.</span><br>
<span class="lineno"></span><span class="keyword" id="5928715">type</span>&nbsp;<span class="ident" id="5928720">Rows</span>&nbsp;<span class="keyword" id="5928725">interface</span>&nbsp;<span class="op" id="5928735">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928738">//&nbsp;Columns&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;columns.&nbsp;The&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928798">//&nbsp;columns&nbsp;of&nbsp;the&nbsp;result&nbsp;is&nbsp;inferred&nbsp;from&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928859">//&nbsp;slice.&nbsp;&nbsp;If&nbsp;a&nbsp;particular&nbsp;column&nbsp;name&nbsp;isn&#39;t&nbsp;known,&nbsp;an&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928921">//&nbsp;string&nbsp;should&nbsp;be&nbsp;returned&nbsp;for&nbsp;that&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928967">Columns</span><span class="op" id="5928974">(</span><span class="op" id="5928975">)</span>&nbsp;<span class="op" id="5928977">[</span><span class="op" id="5928978">]</span><span class="builtintype" id="5928979">string</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928988">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;rows&nbsp;iterator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929024">Close</span><span class="op" id="5929029">(</span><span class="op" id="5929030">)</span>&nbsp;<span class="builtintype" id="5929032">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929040">//&nbsp;Next&nbsp;is&nbsp;called&nbsp;to&nbsp;populate&nbsp;the&nbsp;next&nbsp;row&nbsp;of&nbsp;data&nbsp;into</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929097">//&nbsp;the&nbsp;provided&nbsp;slice.&nbsp;The&nbsp;provided&nbsp;slice&nbsp;will&nbsp;be&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929157">//&nbsp;size&nbsp;as&nbsp;the&nbsp;Columns()&nbsp;are&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929193">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929197">//&nbsp;The&nbsp;dest&nbsp;slice&nbsp;may&nbsp;be&nbsp;populated&nbsp;only&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929243">//&nbsp;a&nbsp;driver&nbsp;Value&nbsp;type,&nbsp;but&nbsp;excluding&nbsp;string.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929290">//&nbsp;All&nbsp;string&nbsp;values&nbsp;must&nbsp;be&nbsp;converted&nbsp;to&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929341">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929345">//&nbsp;Next&nbsp;should&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;rows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929404">Next</span><span class="op" id="5929408">(</span><span class="ident" id="5929409">dest</span>&nbsp;<span class="op" id="5929414">[</span><span class="op" id="5929415">]</span><span class="ident" id="5929416">Value</span><span class="op" id="5929421">)</span>&nbsp;<span class="builtintype" id="5929423">error</span><br>
<span class="lineno"></span><span class="op" id="5929429">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="5929432">//&nbsp;Tx&nbsp;is&nbsp;a&nbsp;transaction.</span><br>
<span class="lineno"></span><span class="keyword" id="5929456">type</span>&nbsp;<span class="ident" id="5929461">Tx</span>&nbsp;<span class="keyword" id="5929464">interface</span>&nbsp;<span class="op" id="5929474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929477">Commit</span><span class="op" id="5929483">(</span><span class="op" id="5929484">)</span>&nbsp;<span class="builtintype" id="5929486">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929493">Rollback</span><span class="op" id="5929501">(</span><span class="op" id="5929502">)</span>&nbsp;<span class="builtintype" id="5929504">error</span><br>
<span class="lineno">180</span><span class="op" id="5929510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5929513">//&nbsp;RowsAffected&nbsp;implements&nbsp;Result&nbsp;for&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE&nbsp;operation</span><br>
<span class="lineno"></span><span class="comment" id="5929581">//&nbsp;which&nbsp;mutates&nbsp;a&nbsp;number&nbsp;of&nbsp;rows.</span><br>
<span class="lineno"></span><span class="keyword" id="5929616">type</span>&nbsp;<span class="ident" id="5929621">RowsAffected</span>&nbsp;<span class="ident" id="5929634">int64</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="5929641">var</span>&nbsp;<span class="ident" id="5929645">_</span>&nbsp;<span class="ident" id="5929647">Result</span>&nbsp;<span class="op" id="5929654">=</span>&nbsp;<span class="ident" id="5929656">RowsAffected</span><span class="op" id="5929668">(</span><span class="num" id="5929669">0</span><span class="op" id="5929670">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5929673">func</span>&nbsp;<span class="op" id="5929678">(</span><span class="ident" id="5929679">RowsAffected</span><span class="op" id="5929691">)</span>&nbsp;<span class="ident" id="5929693">LastInsertId</span><span class="op" id="5929705">(</span><span class="op" id="5929706">)</span>&nbsp;<span class="op" id="5929708">(</span><span class="ident" id="5929709">int64</span><span class="op" id="5929714">,</span>&nbsp;<span class="builtintype" id="5929716">error</span><span class="op" id="5929721">)</span>&nbsp;<span class="op" id="5929723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929726">return</span>&nbsp;<span class="num" id="5929733">0</span><span class="op" id="5929734">,</span>&nbsp;<span class="ident" id="5929736">errors</span><span class="op" id="5929742">.</span><span class="ident" id="5929743">New</span><span class="op" id="5929746">(</span><span class="string" id="5929747">&#34;no&nbsp;LastInsertId&nbsp;available&#34;</span><span class="op" id="5929774">)</span><br>
<span class="lineno">190</span><span class="op" id="5929776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5929779">func</span>&nbsp;<span class="op" id="5929784">(</span><span class="ident" id="5929785">v</span>&nbsp;<span class="ident" id="5929787">RowsAffected</span><span class="op" id="5929799">)</span>&nbsp;<span class="ident" id="5929801">RowsAffected</span><span class="op" id="5929813">(</span><span class="op" id="5929814">)</span>&nbsp;<span class="op" id="5929816">(</span><span class="ident" id="5929817">int64</span><span class="op" id="5929822">,</span>&nbsp;<span class="builtintype" id="5929824">error</span><span class="op" id="5929829">)</span>&nbsp;<span class="op" id="5929831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929834">return</span>&nbsp;<span class="ident" id="5929841">int64</span><span class="op" id="5929846">(</span><span class="ident" id="5929847">v</span><span class="op" id="5929848">)</span><span class="op" id="5929849">,</span>&nbsp;<span class="ident" id="5929851">nil</span><br>
<span class="lineno"></span><span class="op" id="5929855">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="5929858">//&nbsp;ResultNoRows&nbsp;is&nbsp;a&nbsp;pre-defined&nbsp;Result&nbsp;for&nbsp;drivers&nbsp;to&nbsp;return&nbsp;when&nbsp;a&nbsp;DDL</span><br>
<span class="lineno"></span><span class="comment" id="5929931">//&nbsp;command&nbsp;(such&nbsp;as&nbsp;a&nbsp;CREATE&nbsp;TABLE)&nbsp;succeeds.&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;for&nbsp;both</span><br>
<span class="lineno"></span><span class="comment" id="5930006">//&nbsp;LastInsertId&nbsp;and&nbsp;RowsAffected.</span><br>
<span class="lineno"></span><span class="keyword" id="5930040">var</span>&nbsp;<span class="ident" id="5930044">ResultNoRows</span>&nbsp;<span class="ident" id="5930057">noRows</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="5930065">type</span>&nbsp;<span class="ident" id="5930070">noRows</span>&nbsp;<span class="keyword" id="5930077">struct</span><span class="op" id="5930083">{</span><span class="op" id="5930084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5930087">var</span>&nbsp;<span class="ident" id="5930091">_</span>&nbsp;<span class="ident" id="5930093">Result</span>&nbsp;<span class="op" id="5930100">=</span>&nbsp;<span class="ident" id="5930102">noRows</span><span class="op" id="5930108">{</span><span class="op" id="5930109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="5930112">func</span>&nbsp;<span class="op" id="5930117">(</span><span class="ident" id="5930118">noRows</span><span class="op" id="5930124">)</span>&nbsp;<span class="ident" id="5930126">LastInsertId</span><span class="op" id="5930138">(</span><span class="op" id="5930139">)</span>&nbsp;<span class="op" id="5930141">(</span><span class="ident" id="5930142">int64</span><span class="op" id="5930147">,</span>&nbsp;<span class="builtintype" id="5930149">error</span><span class="op" id="5930154">)</span>&nbsp;<span class="op" id="5930156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930159">return</span>&nbsp;<span class="num" id="5930166">0</span><span class="op" id="5930167">,</span>&nbsp;<span class="ident" id="5930169">errors</span><span class="op" id="5930175">.</span><span class="ident" id="5930176">New</span><span class="op" id="5930179">(</span><span class="string" id="5930180">&#34;no&nbsp;LastInsertId&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5930227">)</span><br>
<span class="lineno"></span><span class="op" id="5930229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5930232">func</span>&nbsp;<span class="op" id="5930237">(</span><span class="ident" id="5930238">noRows</span><span class="op" id="5930244">)</span>&nbsp;<span class="ident" id="5930246">RowsAffected</span><span class="op" id="5930258">(</span><span class="op" id="5930259">)</span>&nbsp;<span class="op" id="5930261">(</span><span class="ident" id="5930262">int64</span><span class="op" id="5930267">,</span>&nbsp;<span class="builtintype" id="5930269">error</span><span class="op" id="5930274">)</span>&nbsp;<span class="op" id="5930276">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930279">return</span>&nbsp;<span class="num" id="5930286">0</span><span class="op" id="5930287">,</span>&nbsp;<span class="ident" id="5930289">errors</span><span class="op" id="5930295">.</span><span class="ident" id="5930296">New</span><span class="op" id="5930299">(</span><span class="string" id="5930300">&#34;no&nbsp;RowsAffected&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5930347">)</span><br>
<span class="lineno"></span><span class="op" id="5930349">}</span>
</div>
</body>
</html>
