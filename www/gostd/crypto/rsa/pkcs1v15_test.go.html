<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html" class="current">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6422495">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6422550">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6422604">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6422655">package</span>&nbsp;<span class="ident" id="6422663">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6422668">import</span>&nbsp;<span class="op" id="6422675">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422678">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422687">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422697">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422712">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422727">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422746">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422762">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422768">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422780">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422791">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="6422807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="6422810">func</span>&nbsp;<span class="ident" id="6422815">decodeBase64</span><span class="op" id="6422827">(</span><span class="ident" id="6422828">in</span>&nbsp;<span class="builtintype" id="6422831">string</span><span class="op" id="6422837">)</span>&nbsp;<span class="op" id="6422839">[</span><span class="op" id="6422840">]</span><span class="builtintype" id="6422841">byte</span>&nbsp;<span class="op" id="6422846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422849">out</span>&nbsp;<span class="op" id="6422853">:=</span>&nbsp;<span class="builtinfunc" id="6422856">make</span><span class="op" id="6422860">(</span><span class="op" id="6422861">[</span><span class="op" id="6422862">]</span><span class="builtintype" id="6422863">byte</span><span class="op" id="6422867">,</span>&nbsp;<span class="ident" id="6422869">base64</span><span class="op" id="6422875">.</span><span class="ident" id="6422876">StdEncoding</span><span class="op" id="6422887">.</span><span class="ident" id="6422888">DecodedLen</span><span class="op" id="6422898">(</span><span class="builtinfunc" id="6422899">len</span><span class="op" id="6422902">(</span><span class="ident" id="6422903">in</span><span class="op" id="6422905">)</span><span class="op" id="6422906">)</span><span class="op" id="6422907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422910">n</span><span class="op" id="6422911">,</span>&nbsp;<span class="ident" id="6422913">err</span>&nbsp;<span class="op" id="6422917">:=</span>&nbsp;<span class="ident" id="6422920">base64</span><span class="op" id="6422926">.</span><span class="ident" id="6422927">StdEncoding</span><span class="op" id="6422938">.</span><span class="ident" id="6422939">Decode</span><span class="op" id="6422945">(</span><span class="ident" id="6422946">out</span><span class="op" id="6422949">,</span>&nbsp;<span class="op" id="6422951">[</span><span class="op" id="6422952">]</span><span class="builtintype" id="6422953">byte</span><span class="op" id="6422957">(</span><span class="ident" id="6422958">in</span><span class="op" id="6422960">)</span><span class="op" id="6422961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422964">if</span>&nbsp;<span class="ident" id="6422967">err</span>&nbsp;<span class="op" id="6422971">!=</span>&nbsp;<span class="ident" id="6422974">nil</span>&nbsp;<span class="op" id="6422978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422982">return</span>&nbsp;<span class="ident" id="6422989">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6422994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422997">return</span>&nbsp;<span class="ident" id="6423004">out</span><span class="op" id="6423007">[</span><span class="num" id="6423008">0</span><span class="op" id="6423009">:</span><span class="ident" id="6423010">n</span><span class="op" id="6423011">]</span><br>
<span class="lineno"></span><span class="op" id="6423013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6423016">type</span>&nbsp;<span class="ident" id="6423021">DecryptPKCS1v15Test</span>&nbsp;<span class="keyword" id="6423041">struct</span>&nbsp;<span class="op" id="6423048">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6423051">in</span><span class="op" id="6423053">,</span>&nbsp;<span class="ident" id="6423055">out</span>&nbsp;<span class="builtintype" id="6423059">string</span><br>
<span class="lineno"></span><span class="op" id="6423066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6423069">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="6423143">var</span>&nbsp;<span class="ident" id="6423147">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="6423168">=</span>&nbsp;<span class="op" id="6423170">[</span><span class="op" id="6423171">]</span><span class="ident" id="6423172">DecryptPKCS1v15Test</span><span class="op" id="6423191">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6423198">&#34;gIcUIoVkD6ATMBk/u/nlCZCCWRKdkfjCgFdo35VpRXLduiKXhNz1XupLLzTXAybEq15juc+EgY5o0DHv/nt3yg==&#34;</span><span class="op" id="6423288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6423292">&#34;x&#34;</span><span class="op" id="6423295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423298">}</span><span class="op" id="6423299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423302">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6423306">&#34;Y7TOCSqofGhkRb+jaVRLzK8xw2cSo1IVES19utzv6hwvx+M8kFsoWQm5DzBeJCZTCVDPkTpavUuEbgp8hnUGDw==&#34;</span><span class="op" id="6423396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6423400">&#34;testing.&#34;</span><span class="op" id="6423410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423413">}</span><span class="op" id="6423414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6423421">&#34;arReP9DJtEVyV2Dg3dDp4c/PSk1O6lxkoJ8HcFupoRorBZG+7+1fDAwT1olNddFnQMjmkb8vxwmNMoTAT/BFjQ==&#34;</span><span class="op" id="6423511">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6423515">&#34;testing.\n&#34;</span><span class="op" id="6423527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423530">}</span><span class="op" id="6423531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6423538">&#34;WtaBXIoGC54+vH0NH0CHHE+dRDOsMc/6BrfFu2lEqcKL9+uDuWaf+Xj9mrbQCjjZcpQuX733zyok/jsnqe/Ftw==&#34;</span><span class="op" id="6423628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6423632">&#34;01234567890123456789012345678901234567890123456789012&#34;</span><span class="op" id="6423687">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423690">}</span><span class="op" id="6423691">,</span><br>
<span class="lineno"></span><span class="op" id="6423693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6423696">func</span>&nbsp;<span class="ident" id="6423701">TestDecryptPKCS1v15</span><span class="op" id="6423720">(</span><span class="ident" id="6423721">t</span>&nbsp;<span class="op" id="6423723">*</span><span class="ident" id="6423724">testing</span><span class="op" id="6423731">.</span><span class="ident" id="6423732">T</span><span class="op" id="6423733">)</span>&nbsp;<span class="op" id="6423735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423738">for</span>&nbsp;<span class="ident" id="6423742">i</span><span class="op" id="6423743">,</span>&nbsp;<span class="ident" id="6423745">test</span>&nbsp;<span class="op" id="6423750">:=</span>&nbsp;<span class="keyword" id="6423753">range</span>&nbsp;<span class="ident" id="6423759">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="6423780">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6423784">out</span><span class="op" id="6423787">,</span>&nbsp;<span class="ident" id="6423789">err</span>&nbsp;<span class="op" id="6423793">:=</span>&nbsp;<span class="ident" id="6423796">DecryptPKCS1v15</span><span class="op" id="6423811">(</span><span class="ident" id="6423812">nil</span><span class="op" id="6423815">,</span>&nbsp;<span class="ident" id="6423817">rsaPrivateKey</span><span class="op" id="6423830">,</span>&nbsp;<span class="ident" id="6423832">decodeBase64</span><span class="op" id="6423844">(</span><span class="ident" id="6423845">test</span><span class="op" id="6423849">.</span><span class="ident" id="6423850">in</span><span class="op" id="6423852">)</span><span class="op" id="6423853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423857">if</span>&nbsp;<span class="ident" id="6423860">err</span>&nbsp;<span class="op" id="6423864">!=</span>&nbsp;<span class="ident" id="6423867">nil</span>&nbsp;<span class="op" id="6423871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6423876">t</span><span class="op" id="6423877">.</span><span class="ident" id="6423878">Errorf</span><span class="op" id="6423884">(</span><span class="string" id="6423885">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="6423907">,</span>&nbsp;<span class="ident" id="6423909">i</span><span class="op" id="6423910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6423918">want</span>&nbsp;<span class="op" id="6423923">:=</span>&nbsp;<span class="op" id="6423926">[</span><span class="op" id="6423927">]</span><span class="builtintype" id="6423928">byte</span><span class="op" id="6423932">(</span><span class="ident" id="6423933">test</span><span class="op" id="6423937">.</span><span class="ident" id="6423938">out</span><span class="op" id="6423941">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423945">if</span>&nbsp;<span class="op" id="6423948">!</span><span class="ident" id="6423949">bytes</span><span class="op" id="6423954">.</span><span class="ident" id="6423955">Equal</span><span class="op" id="6423960">(</span><span class="ident" id="6423961">out</span><span class="op" id="6423964">,</span>&nbsp;<span class="ident" id="6423966">want</span><span class="op" id="6423970">)</span>&nbsp;<span class="op" id="6423972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6423977">t</span><span class="op" id="6423978">.</span><span class="ident" id="6423979">Errorf</span><span class="op" id="6423985">(</span><span class="string" id="6423986">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="6424008">,</span>&nbsp;<span class="ident" id="6424010">i</span><span class="op" id="6424011">,</span>&nbsp;<span class="ident" id="6424013">out</span><span class="op" id="6424016">,</span>&nbsp;<span class="ident" id="6424018">want</span><span class="op" id="6424022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6424026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6424029">}</span><br>
<span class="lineno"></span><span class="op" id="6424031">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="6424034">func</span>&nbsp;<span class="ident" id="6424039">TestEncryptPKCS1v15</span><span class="op" id="6424058">(</span><span class="ident" id="6424059">t</span>&nbsp;<span class="op" id="6424061">*</span><span class="ident" id="6424062">testing</span><span class="op" id="6424069">.</span><span class="ident" id="6424070">T</span><span class="op" id="6424071">)</span>&nbsp;<span class="op" id="6424073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424076">random</span>&nbsp;<span class="op" id="6424083">:=</span>&nbsp;<span class="ident" id="6424086">rand</span><span class="op" id="6424090">.</span><span class="ident" id="6424091">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424099">k</span>&nbsp;<span class="op" id="6424101">:=</span>&nbsp;<span class="op" id="6424104">(</span><span class="ident" id="6424105">rsaPrivateKey</span><span class="op" id="6424118">.</span><span class="ident" id="6424119">N</span><span class="op" id="6424120">.</span><span class="ident" id="6424121">BitLen</span><span class="op" id="6424127">(</span><span class="op" id="6424128">)</span>&nbsp;<span class="op" id="6424130">+</span>&nbsp;<span class="num" id="6424132">7</span><span class="op" id="6424133">)</span>&nbsp;<span class="op" id="6424135">/</span>&nbsp;<span class="num" id="6424137">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424141">tryEncryptDecrypt</span>&nbsp;<span class="op" id="6424159">:=</span>&nbsp;<span class="keyword" id="6424162">func</span><span class="op" id="6424166">(</span><span class="ident" id="6424167">in</span>&nbsp;<span class="op" id="6424170">[</span><span class="op" id="6424171">]</span><span class="builtintype" id="6424172">byte</span><span class="op" id="6424176">,</span>&nbsp;<span class="ident" id="6424178">blind</span>&nbsp;<span class="builtintype" id="6424184">bool</span><span class="op" id="6424188">)</span>&nbsp;<span class="builtintype" id="6424190">bool</span>&nbsp;<span class="op" id="6424195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424199">if</span>&nbsp;<span class="builtinfunc" id="6424202">len</span><span class="op" id="6424205">(</span><span class="ident" id="6424206">in</span><span class="op" id="6424208">)</span>&nbsp;<span class="op" id="6424210">&gt;</span>&nbsp;<span class="ident" id="6424212">k</span><span class="op" id="6424213">-</span><span class="num" id="6424214">11</span>&nbsp;<span class="op" id="6424217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424222">in</span>&nbsp;<span class="op" id="6424225">=</span>&nbsp;<span class="ident" id="6424227">in</span><span class="op" id="6424229">[</span><span class="num" id="6424230">0</span>&nbsp;<span class="op" id="6424232">:</span>&nbsp;<span class="ident" id="6424234">k</span><span class="op" id="6424235">-</span><span class="num" id="6424236">11</span><span class="op" id="6424238">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6424242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424247">ciphertext</span><span class="op" id="6424257">,</span>&nbsp;<span class="ident" id="6424259">err</span>&nbsp;<span class="op" id="6424263">:=</span>&nbsp;<span class="ident" id="6424266">EncryptPKCS1v15</span><span class="op" id="6424281">(</span><span class="ident" id="6424282">random</span><span class="op" id="6424288">,</span>&nbsp;<span class="op" id="6424290">&amp;</span><span class="ident" id="6424291">rsaPrivateKey</span><span class="op" id="6424304">.</span><span class="ident" id="6424305">PublicKey</span><span class="op" id="6424314">,</span>&nbsp;<span class="ident" id="6424316">in</span><span class="op" id="6424318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424322">if</span>&nbsp;<span class="ident" id="6424325">err</span>&nbsp;<span class="op" id="6424329">!=</span>&nbsp;<span class="ident" id="6424332">nil</span>&nbsp;<span class="op" id="6424336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424341">t</span><span class="op" id="6424342">.</span><span class="ident" id="6424343">Errorf</span><span class="op" id="6424349">(</span><span class="string" id="6424350">&#34;error&nbsp;encrypting:&nbsp;%s&#34;</span><span class="op" id="6424372">,</span>&nbsp;<span class="ident" id="6424374">err</span><span class="op" id="6424377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424382">return</span>&nbsp;<span class="builtintype" id="6424389">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6424397">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424402">var</span>&nbsp;<span class="ident" id="6424406">rand</span>&nbsp;<span class="ident" id="6424411">io</span><span class="op" id="6424413">.</span><span class="ident" id="6424414">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424423">if</span>&nbsp;<span class="op" id="6424426">!</span><span class="ident" id="6424427">blind</span>&nbsp;<span class="op" id="6424433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424438">rand</span>&nbsp;<span class="op" id="6424443">=</span>&nbsp;<span class="ident" id="6424445">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6424451">}</span>&nbsp;<span class="keyword" id="6424453">else</span>&nbsp;<span class="op" id="6424458">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424463">rand</span>&nbsp;<span class="op" id="6424468">=</span>&nbsp;<span class="ident" id="6424470">random</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6424479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424483">plaintext</span><span class="op" id="6424492">,</span>&nbsp;<span class="ident" id="6424494">err</span>&nbsp;<span class="op" id="6424498">:=</span>&nbsp;<span class="ident" id="6424501">DecryptPKCS1v15</span><span class="op" id="6424516">(</span><span class="ident" id="6424517">rand</span><span class="op" id="6424521">,</span>&nbsp;<span class="ident" id="6424523">rsaPrivateKey</span><span class="op" id="6424536">,</span>&nbsp;<span class="ident" id="6424538">ciphertext</span><span class="op" id="6424548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424552">if</span>&nbsp;<span class="ident" id="6424555">err</span>&nbsp;<span class="op" id="6424559">!=</span>&nbsp;<span class="ident" id="6424562">nil</span>&nbsp;<span class="op" id="6424566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424571">t</span><span class="op" id="6424572">.</span><span class="ident" id="6424573">Errorf</span><span class="op" id="6424579">(</span><span class="string" id="6424580">&#34;error&nbsp;decrypting:&nbsp;%s&#34;</span><span class="op" id="6424602">,</span>&nbsp;<span class="ident" id="6424604">err</span><span class="op" id="6424607">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424612">return</span>&nbsp;<span class="builtintype" id="6424619">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6424627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424632">if</span>&nbsp;<span class="op" id="6424635">!</span><span class="ident" id="6424636">bytes</span><span class="op" id="6424641">.</span><span class="ident" id="6424642">Equal</span><span class="op" id="6424647">(</span><span class="ident" id="6424648">plaintext</span><span class="op" id="6424657">,</span>&nbsp;<span class="ident" id="6424659">in</span><span class="op" id="6424661">)</span>&nbsp;<span class="op" id="6424663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424668">t</span><span class="op" id="6424669">.</span><span class="ident" id="6424670">Errorf</span><span class="op" id="6424676">(</span><span class="string" id="6424677">&#34;output&nbsp;mismatch:&nbsp;%#v&nbsp;%#v&#34;</span><span class="op" id="6424703">,</span>&nbsp;<span class="ident" id="6424705">plaintext</span><span class="op" id="6424714">,</span>&nbsp;<span class="ident" id="6424716">in</span><span class="op" id="6424718">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424723">return</span>&nbsp;<span class="builtintype" id="6424730">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6424738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424742">return</span>&nbsp;<span class="builtintype" id="6424749">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6424755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424759">config</span>&nbsp;<span class="op" id="6424766">:=</span>&nbsp;<span class="builtinfunc" id="6424769">new</span><span class="op" id="6424772">(</span><span class="ident" id="6424773">quick</span><span class="op" id="6424778">.</span><span class="ident" id="6424779">Config</span><span class="op" id="6424785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424788">if</span>&nbsp;<span class="ident" id="6424791">testing</span><span class="op" id="6424798">.</span><span class="ident" id="6424799">Short</span><span class="op" id="6424804">(</span><span class="op" id="6424805">)</span>&nbsp;<span class="op" id="6424807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424811">config</span><span class="op" id="6424817">.</span><span class="ident" id="6424818">MaxCount</span>&nbsp;<span class="op" id="6424827">=</span>&nbsp;<span class="num" id="6424829">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6424833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424836">quick</span><span class="op" id="6424841">.</span><span class="ident" id="6424842">Check</span><span class="op" id="6424847">(</span><span class="ident" id="6424848">tryEncryptDecrypt</span><span class="op" id="6424865">,</span>&nbsp;<span class="ident" id="6424867">config</span><span class="op" id="6424873">)</span><br>
<span class="lineno">105</span><span class="op" id="6424875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6424878">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="6424952">var</span>&nbsp;<span class="ident" id="6424956">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="6424987">=</span>&nbsp;<span class="op" id="6424989">[</span><span class="op" id="6424990">]</span><span class="ident" id="6424991">DecryptPKCS1v15Test</span><span class="op" id="6425010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425013">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6425017">&#34;e6ukkae6Gykq0fKzYwULpZehX+UPXYzMoB5mHQUDEiclRbOTqas4Y0E6nwns1BBpdvEJcilhl5zsox/6DtGsYg==&#34;</span><span class="op" id="6425107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6425111">&#34;1234&#34;</span><span class="op" id="6425117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425120">}</span><span class="op" id="6425121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6425128">&#34;Dtis4uk/q/LQGGqGk97P59K03hkCIVFMEFZRgVWOAAhxgYpCRG0MX2adptt92l67IqMki6iVQyyt0TtX3IdtEw==&#34;</span><span class="op" id="6425218">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6425222">&#34;FAIL&#34;</span><span class="op" id="6425228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425231">}</span><span class="op" id="6425232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6425239">&#34;LIyFyCYCptPxrvTxpol8F3M7ZivlMsf53zs0vHRAv+rDIh2YsHS69ePMoPMe3TkOMZ3NupiL3takPxIs1sK+dw==&#34;</span><span class="op" id="6425329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6425333">&#34;abcd&#34;</span><span class="op" id="6425339">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425342">}</span><span class="op" id="6425343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6425350">&#34;bafnobel46bKy76JzqU/RIVOH0uAYvzUtauKmIidKgM0sMlvobYVAVQPeUQ/oTGjbIZ1v/6Gyi5AO4DtHruGdw==&#34;</span><span class="op" id="6425440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6425444">&#34;FAIL&#34;</span><span class="op" id="6425450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425453">}</span><span class="op" id="6425454">,</span><br>
<span class="lineno">125</span><span class="op" id="6425456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6425459">func</span>&nbsp;<span class="ident" id="6425464">TestEncryptPKCS1v15SessionKey</span><span class="op" id="6425493">(</span><span class="ident" id="6425494">t</span>&nbsp;<span class="op" id="6425496">*</span><span class="ident" id="6425497">testing</span><span class="op" id="6425504">.</span><span class="ident" id="6425505">T</span><span class="op" id="6425506">)</span>&nbsp;<span class="op" id="6425508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425511">for</span>&nbsp;<span class="ident" id="6425515">i</span><span class="op" id="6425516">,</span>&nbsp;<span class="ident" id="6425518">test</span>&nbsp;<span class="op" id="6425523">:=</span>&nbsp;<span class="keyword" id="6425526">range</span>&nbsp;<span class="ident" id="6425532">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="6425563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425567">key</span>&nbsp;<span class="op" id="6425571">:=</span>&nbsp;<span class="op" id="6425574">[</span><span class="op" id="6425575">]</span><span class="builtintype" id="6425576">byte</span><span class="op" id="6425580">(</span><span class="string" id="6425581">&#34;FAIL&#34;</span><span class="op" id="6425587">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425591">err</span>&nbsp;<span class="op" id="6425595">:=</span>&nbsp;<span class="ident" id="6425598">DecryptPKCS1v15SessionKey</span><span class="op" id="6425623">(</span><span class="ident" id="6425624">nil</span><span class="op" id="6425627">,</span>&nbsp;<span class="ident" id="6425629">rsaPrivateKey</span><span class="op" id="6425642">,</span>&nbsp;<span class="ident" id="6425644">decodeBase64</span><span class="op" id="6425656">(</span><span class="ident" id="6425657">test</span><span class="op" id="6425661">.</span><span class="ident" id="6425662">in</span><span class="op" id="6425664">)</span><span class="op" id="6425665">,</span>&nbsp;<span class="ident" id="6425667">key</span><span class="op" id="6425670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425674">if</span>&nbsp;<span class="ident" id="6425677">err</span>&nbsp;<span class="op" id="6425681">!=</span>&nbsp;<span class="ident" id="6425684">nil</span>&nbsp;<span class="op" id="6425688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425693">t</span><span class="op" id="6425694">.</span><span class="ident" id="6425695">Errorf</span><span class="op" id="6425701">(</span><span class="string" id="6425702">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="6425724">,</span>&nbsp;<span class="ident" id="6425726">i</span><span class="op" id="6425727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425735">want</span>&nbsp;<span class="op" id="6425740">:=</span>&nbsp;<span class="op" id="6425743">[</span><span class="op" id="6425744">]</span><span class="builtintype" id="6425745">byte</span><span class="op" id="6425749">(</span><span class="ident" id="6425750">test</span><span class="op" id="6425754">.</span><span class="ident" id="6425755">out</span><span class="op" id="6425758">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425762">if</span>&nbsp;<span class="op" id="6425765">!</span><span class="ident" id="6425766">bytes</span><span class="op" id="6425771">.</span><span class="ident" id="6425772">Equal</span><span class="op" id="6425777">(</span><span class="ident" id="6425778">key</span><span class="op" id="6425781">,</span>&nbsp;<span class="ident" id="6425783">want</span><span class="op" id="6425787">)</span>&nbsp;<span class="op" id="6425789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425794">t</span><span class="op" id="6425795">.</span><span class="ident" id="6425796">Errorf</span><span class="op" id="6425802">(</span><span class="string" id="6425803">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="6425825">,</span>&nbsp;<span class="ident" id="6425827">i</span><span class="op" id="6425828">,</span>&nbsp;<span class="ident" id="6425830">key</span><span class="op" id="6425833">,</span>&nbsp;<span class="ident" id="6425835">want</span><span class="op" id="6425839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425846">}</span><br>
<span class="lineno"></span><span class="op" id="6425848">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="6425851">func</span>&nbsp;<span class="ident" id="6425856">TestNonZeroRandomBytes</span><span class="op" id="6425878">(</span><span class="ident" id="6425879">t</span>&nbsp;<span class="op" id="6425881">*</span><span class="ident" id="6425882">testing</span><span class="op" id="6425889">.</span><span class="ident" id="6425890">T</span><span class="op" id="6425891">)</span>&nbsp;<span class="op" id="6425893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425896">random</span>&nbsp;<span class="op" id="6425903">:=</span>&nbsp;<span class="ident" id="6425906">rand</span><span class="op" id="6425910">.</span><span class="ident" id="6425911">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425920">b</span>&nbsp;<span class="op" id="6425922">:=</span>&nbsp;<span class="builtinfunc" id="6425925">make</span><span class="op" id="6425929">(</span><span class="op" id="6425930">[</span><span class="op" id="6425931">]</span><span class="builtintype" id="6425932">byte</span><span class="op" id="6425936">,</span>&nbsp;<span class="num" id="6425938">512</span><span class="op" id="6425941">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425944">err</span>&nbsp;<span class="op" id="6425948">:=</span>&nbsp;<span class="ident" id="6425951">nonZeroRandomBytes</span><span class="op" id="6425969">(</span><span class="ident" id="6425970">b</span><span class="op" id="6425971">,</span>&nbsp;<span class="ident" id="6425973">random</span><span class="op" id="6425979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425982">if</span>&nbsp;<span class="ident" id="6425985">err</span>&nbsp;<span class="op" id="6425989">!=</span>&nbsp;<span class="ident" id="6425992">nil</span>&nbsp;<span class="op" id="6425996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426000">t</span><span class="op" id="6426001">.</span><span class="ident" id="6426002">Errorf</span><span class="op" id="6426008">(</span><span class="string" id="6426009">&#34;returned&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6426029">,</span>&nbsp;<span class="ident" id="6426031">err</span><span class="op" id="6426034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426040">for</span>&nbsp;<span class="ident" id="6426044">_</span><span class="op" id="6426045">,</span>&nbsp;<span class="ident" id="6426047">b</span>&nbsp;<span class="op" id="6426049">:=</span>&nbsp;<span class="keyword" id="6426052">range</span>&nbsp;<span class="ident" id="6426058">b</span>&nbsp;<span class="op" id="6426060">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426064">if</span>&nbsp;<span class="ident" id="6426067">b</span>&nbsp;<span class="op" id="6426069">==</span>&nbsp;<span class="num" id="6426072">0</span>&nbsp;<span class="op" id="6426074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426079">t</span><span class="op" id="6426080">.</span><span class="ident" id="6426081">Errorf</span><span class="op" id="6426087">(</span><span class="string" id="6426088">&#34;Zero&nbsp;octet&nbsp;found&#34;</span><span class="op" id="6426106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426111">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426123">}</span><br>
<span class="lineno">155</span><span class="op" id="6426125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6426128">type</span>&nbsp;<span class="ident" id="6426133">signPKCS1v15Test</span>&nbsp;<span class="keyword" id="6426150">struct</span>&nbsp;<span class="op" id="6426157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426160">in</span><span class="op" id="6426162">,</span>&nbsp;<span class="ident" id="6426164">out</span>&nbsp;<span class="builtintype" id="6426168">string</span><br>
<span class="lineno"></span><span class="op" id="6426175">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="6426178">//&nbsp;These&nbsp;vectors&nbsp;have&nbsp;been&nbsp;tested&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6426217">//&nbsp;&nbsp;&nbsp;`openssl&nbsp;rsautl&nbsp;-verify&nbsp;-inkey&nbsp;pk&nbsp;-in&nbsp;signature&nbsp;|&nbsp;hexdump&nbsp;-C`</span><br>
<span class="lineno"></span><span class="keyword" id="6426284">var</span>&nbsp;<span class="ident" id="6426288">signPKCS1v15Tests</span>&nbsp;<span class="op" id="6426306">=</span>&nbsp;<span class="op" id="6426308">[</span><span class="op" id="6426309">]</span><span class="ident" id="6426310">signPKCS1v15Test</span><span class="op" id="6426326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426329">{</span><span class="string" id="6426330">&#34;Test.\n&#34;</span><span class="op" id="6426339">,</span>&nbsp;<span class="string" id="6426341">&#34;a4f3fa6ea93bcdd0c57be020c1193ecbfd6f200a3d95c409769b029578fa0e336ad9a347600e40d3ae823b8c7e6bad88cc07c1d54c3a1523cbbb6d58efc362ae&#34;</span><span class="op" id="6426471">}</span><span class="op" id="6426472">,</span><br>
<span class="lineno">165</span><span class="op" id="6426474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6426477">func</span>&nbsp;<span class="ident" id="6426482">TestSignPKCS1v15</span><span class="op" id="6426498">(</span><span class="ident" id="6426499">t</span>&nbsp;<span class="op" id="6426501">*</span><span class="ident" id="6426502">testing</span><span class="op" id="6426509">.</span><span class="ident" id="6426510">T</span><span class="op" id="6426511">)</span>&nbsp;<span class="op" id="6426513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426516">for</span>&nbsp;<span class="ident" id="6426520">i</span><span class="op" id="6426521">,</span>&nbsp;<span class="ident" id="6426523">test</span>&nbsp;<span class="op" id="6426528">:=</span>&nbsp;<span class="keyword" id="6426531">range</span>&nbsp;<span class="ident" id="6426537">signPKCS1v15Tests</span>&nbsp;<span class="op" id="6426555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426559">h</span>&nbsp;<span class="op" id="6426561">:=</span>&nbsp;<span class="ident" id="6426564">sha1</span><span class="op" id="6426568">.</span><span class="ident" id="6426569">New</span><span class="op" id="6426572">(</span><span class="op" id="6426573">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426577">h</span><span class="op" id="6426578">.</span><span class="ident" id="6426579">Write</span><span class="op" id="6426584">(</span><span class="op" id="6426585">[</span><span class="op" id="6426586">]</span><span class="builtintype" id="6426587">byte</span><span class="op" id="6426591">(</span><span class="ident" id="6426592">test</span><span class="op" id="6426596">.</span><span class="ident" id="6426597">in</span><span class="op" id="6426599">)</span><span class="op" id="6426600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426604">digest</span>&nbsp;<span class="op" id="6426611">:=</span>&nbsp;<span class="ident" id="6426614">h</span><span class="op" id="6426615">.</span><span class="ident" id="6426616">Sum</span><span class="op" id="6426619">(</span><span class="ident" id="6426620">nil</span><span class="op" id="6426623">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426628">s</span><span class="op" id="6426629">,</span>&nbsp;<span class="ident" id="6426631">err</span>&nbsp;<span class="op" id="6426635">:=</span>&nbsp;<span class="ident" id="6426638">SignPKCS1v15</span><span class="op" id="6426650">(</span><span class="ident" id="6426651">nil</span><span class="op" id="6426654">,</span>&nbsp;<span class="ident" id="6426656">rsaPrivateKey</span><span class="op" id="6426669">,</span>&nbsp;<span class="ident" id="6426671">crypto</span><span class="op" id="6426677">.</span><span class="ident" id="6426678">SHA1</span><span class="op" id="6426682">,</span>&nbsp;<span class="ident" id="6426684">digest</span><span class="op" id="6426690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426694">if</span>&nbsp;<span class="ident" id="6426697">err</span>&nbsp;<span class="op" id="6426701">!=</span>&nbsp;<span class="ident" id="6426704">nil</span>&nbsp;<span class="op" id="6426708">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426713">t</span><span class="op" id="6426714">.</span><span class="ident" id="6426715">Errorf</span><span class="op" id="6426721">(</span><span class="string" id="6426722">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="6426730">,</span>&nbsp;<span class="ident" id="6426732">i</span><span class="op" id="6426733">,</span>&nbsp;<span class="ident" id="6426735">err</span><span class="op" id="6426738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426747">expected</span><span class="op" id="6426755">,</span>&nbsp;<span class="ident" id="6426757">_</span>&nbsp;<span class="op" id="6426759">:=</span>&nbsp;<span class="ident" id="6426762">hex</span><span class="op" id="6426765">.</span><span class="ident" id="6426766">DecodeString</span><span class="op" id="6426778">(</span><span class="ident" id="6426779">test</span><span class="op" id="6426783">.</span><span class="ident" id="6426784">out</span><span class="op" id="6426787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426791">if</span>&nbsp;<span class="op" id="6426794">!</span><span class="ident" id="6426795">bytes</span><span class="op" id="6426800">.</span><span class="ident" id="6426801">Equal</span><span class="op" id="6426806">(</span><span class="ident" id="6426807">s</span><span class="op" id="6426808">,</span>&nbsp;<span class="ident" id="6426810">expected</span><span class="op" id="6426818">)</span>&nbsp;<span class="op" id="6426820">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426825">t</span><span class="op" id="6426826">.</span><span class="ident" id="6426827">Errorf</span><span class="op" id="6426833">(</span><span class="string" id="6426834">&#34;#%d&nbsp;got:&nbsp;%x&nbsp;want:&nbsp;%x&#34;</span><span class="op" id="6426856">,</span>&nbsp;<span class="ident" id="6426858">i</span><span class="op" id="6426859">,</span>&nbsp;<span class="ident" id="6426861">s</span><span class="op" id="6426862">,</span>&nbsp;<span class="ident" id="6426864">expected</span><span class="op" id="6426872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426879">}</span><br>
<span class="lineno"></span><span class="op" id="6426881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="6426884">func</span>&nbsp;<span class="ident" id="6426889">TestVerifyPKCS1v15</span><span class="op" id="6426907">(</span><span class="ident" id="6426908">t</span>&nbsp;<span class="op" id="6426910">*</span><span class="ident" id="6426911">testing</span><span class="op" id="6426918">.</span><span class="ident" id="6426919">T</span><span class="op" id="6426920">)</span>&nbsp;<span class="op" id="6426922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426925">for</span>&nbsp;<span class="ident" id="6426929">i</span><span class="op" id="6426930">,</span>&nbsp;<span class="ident" id="6426932">test</span>&nbsp;<span class="op" id="6426937">:=</span>&nbsp;<span class="keyword" id="6426940">range</span>&nbsp;<span class="ident" id="6426946">signPKCS1v15Tests</span>&nbsp;<span class="op" id="6426964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426968">h</span>&nbsp;<span class="op" id="6426970">:=</span>&nbsp;<span class="ident" id="6426973">sha1</span><span class="op" id="6426977">.</span><span class="ident" id="6426978">New</span><span class="op" id="6426981">(</span><span class="op" id="6426982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426986">h</span><span class="op" id="6426987">.</span><span class="ident" id="6426988">Write</span><span class="op" id="6426993">(</span><span class="op" id="6426994">[</span><span class="op" id="6426995">]</span><span class="builtintype" id="6426996">byte</span><span class="op" id="6427000">(</span><span class="ident" id="6427001">test</span><span class="op" id="6427005">.</span><span class="ident" id="6427006">in</span><span class="op" id="6427008">)</span><span class="op" id="6427009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427013">digest</span>&nbsp;<span class="op" id="6427020">:=</span>&nbsp;<span class="ident" id="6427023">h</span><span class="op" id="6427024">.</span><span class="ident" id="6427025">Sum</span><span class="op" id="6427028">(</span><span class="ident" id="6427029">nil</span><span class="op" id="6427032">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427037">sig</span><span class="op" id="6427040">,</span>&nbsp;<span class="ident" id="6427042">_</span>&nbsp;<span class="op" id="6427044">:=</span>&nbsp;<span class="ident" id="6427047">hex</span><span class="op" id="6427050">.</span><span class="ident" id="6427051">DecodeString</span><span class="op" id="6427063">(</span><span class="ident" id="6427064">test</span><span class="op" id="6427068">.</span><span class="ident" id="6427069">out</span><span class="op" id="6427072">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427077">err</span>&nbsp;<span class="op" id="6427081">:=</span>&nbsp;<span class="ident" id="6427084">VerifyPKCS1v15</span><span class="op" id="6427098">(</span><span class="op" id="6427099">&amp;</span><span class="ident" id="6427100">rsaPrivateKey</span><span class="op" id="6427113">.</span><span class="ident" id="6427114">PublicKey</span><span class="op" id="6427123">,</span>&nbsp;<span class="ident" id="6427125">crypto</span><span class="op" id="6427131">.</span><span class="ident" id="6427132">SHA1</span><span class="op" id="6427136">,</span>&nbsp;<span class="ident" id="6427138">digest</span><span class="op" id="6427144">,</span>&nbsp;<span class="ident" id="6427146">sig</span><span class="op" id="6427149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427153">if</span>&nbsp;<span class="ident" id="6427156">err</span>&nbsp;<span class="op" id="6427160">!=</span>&nbsp;<span class="ident" id="6427163">nil</span>&nbsp;<span class="op" id="6427167">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427172">t</span><span class="op" id="6427173">.</span><span class="ident" id="6427174">Errorf</span><span class="op" id="6427180">(</span><span class="string" id="6427181">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="6427189">,</span>&nbsp;<span class="ident" id="6427191">i</span><span class="op" id="6427192">,</span>&nbsp;<span class="ident" id="6427194">err</span><span class="op" id="6427197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427204">}</span><br>
<span class="lineno"></span><span class="op" id="6427206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="6427209">func</span>&nbsp;<span class="ident" id="6427214">TestOverlongMessagePKCS1v15</span><span class="op" id="6427241">(</span><span class="ident" id="6427242">t</span>&nbsp;<span class="op" id="6427244">*</span><span class="ident" id="6427245">testing</span><span class="op" id="6427252">.</span><span class="ident" id="6427253">T</span><span class="op" id="6427254">)</span>&nbsp;<span class="op" id="6427256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427259">ciphertext</span>&nbsp;<span class="op" id="6427270">:=</span>&nbsp;<span class="ident" id="6427273">decodeBase64</span><span class="op" id="6427285">(</span><span class="string" id="6427286">&#34;fjOVdirUzFoLlukv80dBllMLjXythIf22feqPrNo0YoIjzyzyoMFiLjAc/Y4krkeZ11XFThIrEvw\nkRiZcCq5ng==&#34;</span><span class="op" id="6427378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427381">_</span><span class="op" id="6427382">,</span>&nbsp;<span class="ident" id="6427384">err</span>&nbsp;<span class="op" id="6427388">:=</span>&nbsp;<span class="ident" id="6427391">DecryptPKCS1v15</span><span class="op" id="6427406">(</span><span class="ident" id="6427407">nil</span><span class="op" id="6427410">,</span>&nbsp;<span class="ident" id="6427412">rsaPrivateKey</span><span class="op" id="6427425">,</span>&nbsp;<span class="ident" id="6427427">ciphertext</span><span class="op" id="6427437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427440">if</span>&nbsp;<span class="ident" id="6427443">err</span>&nbsp;<span class="op" id="6427447">==</span>&nbsp;<span class="ident" id="6427450">nil</span>&nbsp;<span class="op" id="6427454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427458">t</span><span class="op" id="6427459">.</span><span class="ident" id="6427460">Error</span><span class="op" id="6427465">(</span><span class="string" id="6427466">&#34;RSA&nbsp;decrypted&nbsp;a&nbsp;message&nbsp;that&nbsp;was&nbsp;too&nbsp;long.&#34;</span><span class="op" id="6427510">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427513">}</span><br>
<span class="lineno"></span><span class="op" id="6427515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6427518">func</span>&nbsp;<span class="ident" id="6427523">TestUnpaddedSignature</span><span class="op" id="6427544">(</span><span class="ident" id="6427545">t</span>&nbsp;<span class="op" id="6427547">*</span><span class="ident" id="6427548">testing</span><span class="op" id="6427555">.</span><span class="ident" id="6427556">T</span><span class="op" id="6427557">)</span>&nbsp;<span class="op" id="6427559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427562">msg</span>&nbsp;<span class="op" id="6427566">:=</span>&nbsp;<span class="op" id="6427569">[</span><span class="op" id="6427570">]</span><span class="builtintype" id="6427571">byte</span><span class="op" id="6427575">(</span><span class="string" id="6427576">&#34;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013\n&#34;</span><span class="op" id="6427608">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6427611">//&nbsp;This&nbsp;base64&nbsp;value&nbsp;was&nbsp;generated&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6427653">//&nbsp;%&nbsp;echo&nbsp;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013&nbsp;&gt;&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6427704">//&nbsp;%&nbsp;openssl&nbsp;rsautl&nbsp;-sign&nbsp;-inkey&nbsp;key&nbsp;-out&nbsp;/tmp/sig&nbsp;-in&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6427769">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6427773">//&nbsp;Where&nbsp;&#34;key&#34;&nbsp;contains&nbsp;the&nbsp;RSA&nbsp;private&nbsp;key&nbsp;given&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;this</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6427846">//&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427856">expectedSig</span>&nbsp;<span class="op" id="6427868">:=</span>&nbsp;<span class="ident" id="6427871">decodeBase64</span><span class="op" id="6427883">(</span><span class="string" id="6427884">&#34;pX4DR8azytjdQ1rtUiC040FjkepuQut5q2ZFX1pTjBrOVKNjgsCDyiJDGZTCNoh9qpXYbhl7iEym30BWWwuiZg==&#34;</span><span class="op" id="6427974">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427978">sig</span><span class="op" id="6427981">,</span>&nbsp;<span class="ident" id="6427983">err</span>&nbsp;<span class="op" id="6427987">:=</span>&nbsp;<span class="ident" id="6427990">SignPKCS1v15</span><span class="op" id="6428002">(</span><span class="ident" id="6428003">nil</span><span class="op" id="6428006">,</span>&nbsp;<span class="ident" id="6428008">rsaPrivateKey</span><span class="op" id="6428021">,</span>&nbsp;<span class="ident" id="6428023">crypto</span><span class="op" id="6428029">.</span><span class="ident" id="6428030">Hash</span><span class="op" id="6428034">(</span><span class="num" id="6428035">0</span><span class="op" id="6428036">)</span><span class="op" id="6428037">,</span>&nbsp;<span class="ident" id="6428039">msg</span><span class="op" id="6428042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428045">if</span>&nbsp;<span class="ident" id="6428048">err</span>&nbsp;<span class="op" id="6428052">!=</span>&nbsp;<span class="ident" id="6428055">nil</span>&nbsp;<span class="op" id="6428059">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428063">t</span><span class="op" id="6428064">.</span><span class="ident" id="6428065">Fatalf</span><span class="op" id="6428071">(</span><span class="string" id="6428072">&#34;SignPKCS1v15&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="6428097">,</span>&nbsp;<span class="ident" id="6428099">err</span><span class="op" id="6428102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428108">if</span>&nbsp;<span class="op" id="6428111">!</span><span class="ident" id="6428112">bytes</span><span class="op" id="6428117">.</span><span class="ident" id="6428118">Equal</span><span class="op" id="6428123">(</span><span class="ident" id="6428124">sig</span><span class="op" id="6428127">,</span>&nbsp;<span class="ident" id="6428129">expectedSig</span><span class="op" id="6428140">)</span>&nbsp;<span class="op" id="6428142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428146">t</span><span class="op" id="6428147">.</span><span class="ident" id="6428148">Fatalf</span><span class="op" id="6428154">(</span><span class="string" id="6428155">&#34;signature&nbsp;is&nbsp;not&nbsp;expected&nbsp;value:&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="6428205">,</span>&nbsp;<span class="ident" id="6428207">sig</span><span class="op" id="6428210">,</span>&nbsp;<span class="ident" id="6428212">expectedSig</span><span class="op" id="6428223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428226">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428229">if</span>&nbsp;<span class="ident" id="6428232">err</span>&nbsp;<span class="op" id="6428236">:=</span>&nbsp;<span class="ident" id="6428239">VerifyPKCS1v15</span><span class="op" id="6428253">(</span><span class="op" id="6428254">&amp;</span><span class="ident" id="6428255">rsaPrivateKey</span><span class="op" id="6428268">.</span><span class="ident" id="6428269">PublicKey</span><span class="op" id="6428278">,</span>&nbsp;<span class="ident" id="6428280">crypto</span><span class="op" id="6428286">.</span><span class="ident" id="6428287">Hash</span><span class="op" id="6428291">(</span><span class="num" id="6428292">0</span><span class="op" id="6428293">)</span><span class="op" id="6428294">,</span>&nbsp;<span class="ident" id="6428296">msg</span><span class="op" id="6428299">,</span>&nbsp;<span class="ident" id="6428301">sig</span><span class="op" id="6428304">)</span><span class="op" id="6428305">;</span>&nbsp;<span class="ident" id="6428307">err</span>&nbsp;<span class="op" id="6428311">!=</span>&nbsp;<span class="ident" id="6428314">nil</span>&nbsp;<span class="op" id="6428318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428322">t</span><span class="op" id="6428323">.</span><span class="ident" id="6428324">Fatalf</span><span class="op" id="6428330">(</span><span class="string" id="6428331">&#34;signature&nbsp;failed&nbsp;to&nbsp;verify:&nbsp;%s&#34;</span><span class="op" id="6428363">,</span>&nbsp;<span class="ident" id="6428365">err</span><span class="op" id="6428368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428371">}</span><br>
<span class="lineno"></span><span class="op" id="6428373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="6428376">func</span>&nbsp;<span class="ident" id="6428381">TestShortSessionKey</span><span class="op" id="6428400">(</span><span class="ident" id="6428401">t</span>&nbsp;<span class="op" id="6428403">*</span><span class="ident" id="6428404">testing</span><span class="op" id="6428411">.</span><span class="ident" id="6428412">T</span><span class="op" id="6428413">)</span>&nbsp;<span class="op" id="6428415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6428418">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;attempting&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;session&nbsp;key&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6428484">//&nbsp;ciphertext&nbsp;is&nbsp;too&nbsp;small&nbsp;doesn&#39;t&nbsp;run&nbsp;outside&nbsp;the&nbsp;array&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428550">ciphertext</span><span class="op" id="6428560">,</span>&nbsp;<span class="ident" id="6428562">err</span>&nbsp;<span class="op" id="6428566">:=</span>&nbsp;<span class="ident" id="6428569">EncryptPKCS1v15</span><span class="op" id="6428584">(</span><span class="ident" id="6428585">rand</span><span class="op" id="6428589">.</span><span class="ident" id="6428590">Reader</span><span class="op" id="6428596">,</span>&nbsp;<span class="op" id="6428598">&amp;</span><span class="ident" id="6428599">rsaPrivateKey</span><span class="op" id="6428612">.</span><span class="ident" id="6428613">PublicKey</span><span class="op" id="6428622">,</span>&nbsp;<span class="op" id="6428624">[</span><span class="op" id="6428625">]</span><span class="builtintype" id="6428626">byte</span><span class="op" id="6428630">{</span><span class="num" id="6428631">1</span><span class="op" id="6428632">}</span><span class="op" id="6428633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428636">if</span>&nbsp;<span class="ident" id="6428639">err</span>&nbsp;<span class="op" id="6428643">!=</span>&nbsp;<span class="ident" id="6428646">nil</span>&nbsp;<span class="op" id="6428650">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428654">t</span><span class="op" id="6428655">.</span><span class="ident" id="6428656">Fatalf</span><span class="op" id="6428662">(</span><span class="string" id="6428663">&#34;Failed&nbsp;to&nbsp;encrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="6428700">,</span>&nbsp;<span class="ident" id="6428702">err</span><span class="op" id="6428705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428712">var</span>&nbsp;<span class="ident" id="6428716">key</span>&nbsp;<span class="op" id="6428720">[</span><span class="num" id="6428721">32</span><span class="op" id="6428723">]</span><span class="builtintype" id="6428724">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428730">if</span>&nbsp;<span class="ident" id="6428733">err</span>&nbsp;<span class="op" id="6428737">:=</span>&nbsp;<span class="ident" id="6428740">DecryptPKCS1v15SessionKey</span><span class="op" id="6428765">(</span><span class="ident" id="6428766">nil</span><span class="op" id="6428769">,</span>&nbsp;<span class="ident" id="6428771">rsaPrivateKey</span><span class="op" id="6428784">,</span>&nbsp;<span class="ident" id="6428786">ciphertext</span><span class="op" id="6428796">,</span>&nbsp;<span class="ident" id="6428798">key</span><span class="op" id="6428801">[</span><span class="op" id="6428802">:</span><span class="op" id="6428803">]</span><span class="op" id="6428804">)</span><span class="op" id="6428805">;</span>&nbsp;<span class="ident" id="6428807">err</span>&nbsp;<span class="op" id="6428811">!=</span>&nbsp;<span class="ident" id="6428814">nil</span>&nbsp;<span class="op" id="6428818">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428822">t</span><span class="op" id="6428823">.</span><span class="ident" id="6428824">Fatalf</span><span class="op" id="6428830">(</span><span class="string" id="6428831">&#34;Failed&nbsp;to&nbsp;decrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="6428868">,</span>&nbsp;<span class="ident" id="6428870">err</span><span class="op" id="6428873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428880">for</span>&nbsp;<span class="ident" id="6428884">_</span><span class="op" id="6428885">,</span>&nbsp;<span class="ident" id="6428887">v</span>&nbsp;<span class="op" id="6428889">:=</span>&nbsp;<span class="keyword" id="6428892">range</span>&nbsp;<span class="ident" id="6428898">key</span>&nbsp;<span class="op" id="6428902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428906">if</span>&nbsp;<span class="ident" id="6428909">v</span>&nbsp;<span class="op" id="6428911">!=</span>&nbsp;<span class="num" id="6428914">0</span>&nbsp;<span class="op" id="6428916">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428921">t</span><span class="op" id="6428922">.</span><span class="ident" id="6428923">Fatal</span><span class="op" id="6428928">(</span><span class="string" id="6428929">&#34;key&nbsp;was&nbsp;modified&nbsp;when&nbsp;ciphertext&nbsp;was&nbsp;invalid&#34;</span><span class="op" id="6428975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428982">}</span><br>
<span class="lineno"></span><span class="op" id="6428984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="6428987">//&nbsp;In&nbsp;order&nbsp;to&nbsp;generate&nbsp;new&nbsp;test&nbsp;vectors&nbsp;you&#39;ll&nbsp;need&nbsp;the&nbsp;PEM&nbsp;form&nbsp;of&nbsp;this&nbsp;key:</span><br>
<span class="lineno"></span><span class="comment" id="6429066">//&nbsp;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno"></span><span class="comment" id="6429101">//&nbsp;MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0</span><br>
<span class="lineno"></span><span class="comment" id="6429169">//&nbsp;fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu</span><br>
<span class="lineno"></span><span class="comment" id="6429237">//&nbsp;/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu</span><br>
<span class="lineno">255</span><span class="comment" id="6429305">//&nbsp;RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/</span><br>
<span class="lineno"></span><span class="comment" id="6429373">//&nbsp;EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A</span><br>
<span class="lineno"></span><span class="comment" id="6429441">//&nbsp;IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS</span><br>
<span class="lineno"></span><span class="comment" id="6429509">//&nbsp;tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V</span><br>
<span class="lineno"></span><span class="comment" id="6429553">//&nbsp;-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="6429587">var</span>&nbsp;<span class="ident" id="6429591">rsaPrivateKey</span>&nbsp;<span class="op" id="6429605">=</span>&nbsp;<span class="op" id="6429607">&amp;</span><span class="ident" id="6429608">PrivateKey</span><span class="op" id="6429618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429621">PublicKey</span><span class="op" id="6429630">:</span>&nbsp;<span class="ident" id="6429632">PublicKey</span><span class="op" id="6429641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429645">N</span><span class="op" id="6429646">:</span>&nbsp;<span class="ident" id="6429648">fromBase10</span><span class="op" id="6429658">(</span><span class="string" id="6429659">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="6429815">)</span><span class="op" id="6429816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429820">E</span><span class="op" id="6429821">:</span>&nbsp;<span class="num" id="6429823">65537</span><span class="op" id="6429828">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6429831">}</span><span class="op" id="6429832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429835">D</span><span class="op" id="6429836">:</span>&nbsp;<span class="ident" id="6429838">fromBase10</span><span class="op" id="6429848">(</span><span class="string" id="6429849">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="6430005">)</span><span class="op" id="6430006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430009">Primes</span><span class="op" id="6430015">:</span>&nbsp;<span class="op" id="6430017">[</span><span class="op" id="6430018">]</span><span class="op" id="6430019">*</span><span class="ident" id="6430020">big</span><span class="op" id="6430023">.</span><span class="ident" id="6430024">Int</span><span class="op" id="6430027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430031">fromBase10</span><span class="op" id="6430041">(</span><span class="string" id="6430042">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="6430121">)</span><span class="op" id="6430122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430126">fromBase10</span><span class="op" id="6430136">(</span><span class="string" id="6430137">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="6430216">)</span><span class="op" id="6430217">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6430220">}</span><span class="op" id="6430221">,</span><br>
<span class="lineno"></span><span class="op" id="6430223">}</span>
</div>
</body>
</html>
