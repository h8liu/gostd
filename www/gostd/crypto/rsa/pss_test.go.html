<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8488160">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8488215">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8488269">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8488320">package</span>&nbsp;<span class="ident" id="8488328">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8488333">import</span>&nbsp;<span class="op" id="8488340">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488343">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488352">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488361">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488379">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488389">_</span>&nbsp;<span class="string" id="8488391">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488405">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488420">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488435">_</span>&nbsp;<span class="string" id="8488437">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488454">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488470">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488482">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488488">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488499">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488510">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8488520">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8488523">func</span>&nbsp;<span class="ident" id="8488528">TestEMSAPSS</span><span class="op" id="8488539">(</span><span class="ident" id="8488540">t</span>&nbsp;<span class="op" id="8488542">*</span><span class="ident" id="8488543">testing</span><span class="op" id="8488550">.</span><span class="ident" id="8488551">T</span><span class="op" id="8488552">)</span>&nbsp;<span class="op" id="8488554">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8488557">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488660">msg</span>&nbsp;<span class="op" id="8488664">:=</span>&nbsp;<span class="op" id="8488667">[</span><span class="op" id="8488668">]</span><span class="builtintype" id="8488669">byte</span><span class="op" id="8488673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8488677">0x85</span><span class="op" id="8488681">,</span>&nbsp;<span class="num" id="8488683">0x9e</span><span class="op" id="8488687">,</span>&nbsp;<span class="num" id="8488689">0xef</span><span class="op" id="8488693">,</span>&nbsp;<span class="num" id="8488695">0x2f</span><span class="op" id="8488699">,</span>&nbsp;<span class="num" id="8488701">0xd7</span><span class="op" id="8488705">,</span>&nbsp;<span class="num" id="8488707">0x8a</span><span class="op" id="8488711">,</span>&nbsp;<span class="num" id="8488713">0xca</span><span class="op" id="8488717">,</span>&nbsp;<span class="num" id="8488719">0x00</span><span class="op" id="8488723">,</span>&nbsp;<span class="num" id="8488725">0x30</span><span class="op" id="8488729">,</span>&nbsp;<span class="num" id="8488731">0x8b</span><span class="op" id="8488735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8488739">0xdc</span><span class="op" id="8488743">,</span>&nbsp;<span class="num" id="8488745">0x47</span><span class="op" id="8488749">,</span>&nbsp;<span class="num" id="8488751">0x11</span><span class="op" id="8488755">,</span>&nbsp;<span class="num" id="8488757">0x93</span><span class="op" id="8488761">,</span>&nbsp;<span class="num" id="8488763">0xbf</span><span class="op" id="8488767">,</span>&nbsp;<span class="num" id="8488769">0x55</span><span class="op" id="8488773">,</span>&nbsp;<span class="num" id="8488775">0xbf</span><span class="op" id="8488779">,</span>&nbsp;<span class="num" id="8488781">0x9d</span><span class="op" id="8488785">,</span>&nbsp;<span class="num" id="8488787">0x78</span><span class="op" id="8488791">,</span>&nbsp;<span class="num" id="8488793">0xdb</span><span class="op" id="8488797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8488801">0x8f</span><span class="op" id="8488805">,</span>&nbsp;<span class="num" id="8488807">0x8a</span><span class="op" id="8488811">,</span>&nbsp;<span class="num" id="8488813">0x67</span><span class="op" id="8488817">,</span>&nbsp;<span class="num" id="8488819">0x2b</span><span class="op" id="8488823">,</span>&nbsp;<span class="num" id="8488825">0x48</span><span class="op" id="8488829">,</span>&nbsp;<span class="num" id="8488831">0x46</span><span class="op" id="8488835">,</span>&nbsp;<span class="num" id="8488837">0x34</span><span class="op" id="8488841">,</span>&nbsp;<span class="num" id="8488843">0xf3</span><span class="op" id="8488847">,</span>&nbsp;<span class="num" id="8488849">0xc9</span><span class="op" id="8488853">,</span>&nbsp;<span class="num" id="8488855">0xc2</span><span class="op" id="8488859">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8488863">0x6e</span><span class="op" id="8488867">,</span>&nbsp;<span class="num" id="8488869">0x64</span><span class="op" id="8488873">,</span>&nbsp;<span class="num" id="8488875">0x78</span><span class="op" id="8488879">,</span>&nbsp;<span class="num" id="8488881">0xae</span><span class="op" id="8488885">,</span>&nbsp;<span class="num" id="8488887">0x10</span><span class="op" id="8488891">,</span>&nbsp;<span class="num" id="8488893">0x26</span><span class="op" id="8488897">,</span>&nbsp;<span class="num" id="8488899">0x0f</span><span class="op" id="8488903">,</span>&nbsp;<span class="num" id="8488905">0xe0</span><span class="op" id="8488909">,</span>&nbsp;<span class="num" id="8488911">0xdd</span><span class="op" id="8488915">,</span>&nbsp;<span class="num" id="8488917">0x8c</span><span class="op" id="8488921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8488925">0x08</span><span class="op" id="8488929">,</span>&nbsp;<span class="num" id="8488931">0x2e</span><span class="op" id="8488935">,</span>&nbsp;<span class="num" id="8488937">0x53</span><span class="op" id="8488941">,</span>&nbsp;<span class="num" id="8488943">0xa5</span><span class="op" id="8488947">,</span>&nbsp;<span class="num" id="8488949">0x29</span><span class="op" id="8488953">,</span>&nbsp;<span class="num" id="8488955">0x3a</span><span class="op" id="8488959">,</span>&nbsp;<span class="num" id="8488961">0xf2</span><span class="op" id="8488965">,</span>&nbsp;<span class="num" id="8488967">0x17</span><span class="op" id="8488971">,</span>&nbsp;<span class="num" id="8488973">0x3c</span><span class="op" id="8488977">,</span>&nbsp;<span class="num" id="8488979">0xd5</span><span class="op" id="8488983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8488987">0x0c</span><span class="op" id="8488991">,</span>&nbsp;<span class="num" id="8488993">0x6d</span><span class="op" id="8488997">,</span>&nbsp;<span class="num" id="8488999">0x5d</span><span class="op" id="8489003">,</span>&nbsp;<span class="num" id="8489005">0x35</span><span class="op" id="8489009">,</span>&nbsp;<span class="num" id="8489011">0x4f</span><span class="op" id="8489015">,</span>&nbsp;<span class="num" id="8489017">0xeb</span><span class="op" id="8489021">,</span>&nbsp;<span class="num" id="8489023">0xf7</span><span class="op" id="8489027">,</span>&nbsp;<span class="num" id="8489029">0x8b</span><span class="op" id="8489033">,</span>&nbsp;<span class="num" id="8489035">0x26</span><span class="op" id="8489039">,</span>&nbsp;<span class="num" id="8489041">0x02</span><span class="op" id="8489045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489049">0x1c</span><span class="op" id="8489053">,</span>&nbsp;<span class="num" id="8489055">0x25</span><span class="op" id="8489059">,</span>&nbsp;<span class="num" id="8489061">0xc0</span><span class="op" id="8489065">,</span>&nbsp;<span class="num" id="8489067">0x27</span><span class="op" id="8489071">,</span>&nbsp;<span class="num" id="8489073">0x12</span><span class="op" id="8489077">,</span>&nbsp;<span class="num" id="8489079">0xe7</span><span class="op" id="8489083">,</span>&nbsp;<span class="num" id="8489085">0x8c</span><span class="op" id="8489089">,</span>&nbsp;<span class="num" id="8489091">0xd4</span><span class="op" id="8489095">,</span>&nbsp;<span class="num" id="8489097">0x69</span><span class="op" id="8489101">,</span>&nbsp;<span class="num" id="8489103">0x4c</span><span class="op" id="8489107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489111">0x9f</span><span class="op" id="8489115">,</span>&nbsp;<span class="num" id="8489117">0x46</span><span class="op" id="8489121">,</span>&nbsp;<span class="num" id="8489123">0x97</span><span class="op" id="8489127">,</span>&nbsp;<span class="num" id="8489129">0x77</span><span class="op" id="8489133">,</span>&nbsp;<span class="num" id="8489135">0xe4</span><span class="op" id="8489139">,</span>&nbsp;<span class="num" id="8489141">0x51</span><span class="op" id="8489145">,</span>&nbsp;<span class="num" id="8489147">0xe7</span><span class="op" id="8489151">,</span>&nbsp;<span class="num" id="8489153">0xf8</span><span class="op" id="8489157">,</span>&nbsp;<span class="num" id="8489159">0xe9</span><span class="op" id="8489163">,</span>&nbsp;<span class="num" id="8489165">0xe0</span><span class="op" id="8489169">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489173">0x4c</span><span class="op" id="8489177">,</span>&nbsp;<span class="num" id="8489179">0xd3</span><span class="op" id="8489183">,</span>&nbsp;<span class="num" id="8489185">0x73</span><span class="op" id="8489189">,</span>&nbsp;<span class="num" id="8489191">0x9c</span><span class="op" id="8489195">,</span>&nbsp;<span class="num" id="8489197">0x6b</span><span class="op" id="8489201">,</span>&nbsp;<span class="num" id="8489203">0xbf</span><span class="op" id="8489207">,</span>&nbsp;<span class="num" id="8489209">0xed</span><span class="op" id="8489213">,</span>&nbsp;<span class="num" id="8489215">0xae</span><span class="op" id="8489219">,</span>&nbsp;<span class="num" id="8489221">0x48</span><span class="op" id="8489225">,</span>&nbsp;<span class="num" id="8489227">0x7f</span><span class="op" id="8489231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489235">0xb5</span><span class="op" id="8489239">,</span>&nbsp;<span class="num" id="8489241">0x56</span><span class="op" id="8489245">,</span>&nbsp;<span class="num" id="8489247">0x44</span><span class="op" id="8489251">,</span>&nbsp;<span class="num" id="8489253">0xe9</span><span class="op" id="8489257">,</span>&nbsp;<span class="num" id="8489259">0xca</span><span class="op" id="8489263">,</span>&nbsp;<span class="num" id="8489265">0x74</span><span class="op" id="8489269">,</span>&nbsp;<span class="num" id="8489271">0xff</span><span class="op" id="8489275">,</span>&nbsp;<span class="num" id="8489277">0x77</span><span class="op" id="8489281">,</span>&nbsp;<span class="num" id="8489283">0xa5</span><span class="op" id="8489287">,</span>&nbsp;<span class="num" id="8489289">0x3c</span><span class="op" id="8489293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489297">0xb7</span><span class="op" id="8489301">,</span>&nbsp;<span class="num" id="8489303">0x29</span><span class="op" id="8489307">,</span>&nbsp;<span class="num" id="8489309">0x80</span><span class="op" id="8489313">,</span>&nbsp;<span class="num" id="8489315">0x2f</span><span class="op" id="8489319">,</span>&nbsp;<span class="num" id="8489321">0x6e</span><span class="op" id="8489325">,</span>&nbsp;<span class="num" id="8489327">0xd4</span><span class="op" id="8489331">,</span>&nbsp;<span class="num" id="8489333">0xa5</span><span class="op" id="8489337">,</span>&nbsp;<span class="num" id="8489339">0xff</span><span class="op" id="8489343">,</span>&nbsp;<span class="num" id="8489345">0xa8</span><span class="op" id="8489349">,</span>&nbsp;<span class="num" id="8489351">0xba</span><span class="op" id="8489355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489359">0x15</span><span class="op" id="8489363">,</span>&nbsp;<span class="num" id="8489365">0x98</span><span class="op" id="8489369">,</span>&nbsp;<span class="num" id="8489371">0x90</span><span class="op" id="8489375">,</span>&nbsp;<span class="num" id="8489377">0xfc</span><span class="op" id="8489381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8489384">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489387">salt</span>&nbsp;<span class="op" id="8489392">:=</span>&nbsp;<span class="op" id="8489395">[</span><span class="op" id="8489396">]</span><span class="builtintype" id="8489397">byte</span><span class="op" id="8489401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489405">0xe3</span><span class="op" id="8489409">,</span>&nbsp;<span class="num" id="8489411">0xb5</span><span class="op" id="8489415">,</span>&nbsp;<span class="num" id="8489417">0xd5</span><span class="op" id="8489421">,</span>&nbsp;<span class="num" id="8489423">0xd0</span><span class="op" id="8489427">,</span>&nbsp;<span class="num" id="8489429">0x02</span><span class="op" id="8489433">,</span>&nbsp;<span class="num" id="8489435">0xc1</span><span class="op" id="8489439">,</span>&nbsp;<span class="num" id="8489441">0xbc</span><span class="op" id="8489445">,</span>&nbsp;<span class="num" id="8489447">0xe5</span><span class="op" id="8489451">,</span>&nbsp;<span class="num" id="8489453">0x0c</span><span class="op" id="8489457">,</span>&nbsp;<span class="num" id="8489459">0x2b</span><span class="op" id="8489463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489467">0x65</span><span class="op" id="8489471">,</span>&nbsp;<span class="num" id="8489473">0xef</span><span class="op" id="8489477">,</span>&nbsp;<span class="num" id="8489479">0x88</span><span class="op" id="8489483">,</span>&nbsp;<span class="num" id="8489485">0xa1</span><span class="op" id="8489489">,</span>&nbsp;<span class="num" id="8489491">0x88</span><span class="op" id="8489495">,</span>&nbsp;<span class="num" id="8489497">0xd8</span><span class="op" id="8489501">,</span>&nbsp;<span class="num" id="8489503">0x3b</span><span class="op" id="8489507">,</span>&nbsp;<span class="num" id="8489509">0xce</span><span class="op" id="8489513">,</span>&nbsp;<span class="num" id="8489515">0x7e</span><span class="op" id="8489519">,</span>&nbsp;<span class="num" id="8489521">0x61</span><span class="op" id="8489525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8489528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489531">expected</span>&nbsp;<span class="op" id="8489540">:=</span>&nbsp;<span class="op" id="8489543">[</span><span class="op" id="8489544">]</span><span class="builtintype" id="8489545">byte</span><span class="op" id="8489549">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489553">0x66</span><span class="op" id="8489557">,</span>&nbsp;<span class="num" id="8489559">0xe4</span><span class="op" id="8489563">,</span>&nbsp;<span class="num" id="8489565">0x67</span><span class="op" id="8489569">,</span>&nbsp;<span class="num" id="8489571">0x2e</span><span class="op" id="8489575">,</span>&nbsp;<span class="num" id="8489577">0x83</span><span class="op" id="8489581">,</span>&nbsp;<span class="num" id="8489583">0x6a</span><span class="op" id="8489587">,</span>&nbsp;<span class="num" id="8489589">0xd1</span><span class="op" id="8489593">,</span>&nbsp;<span class="num" id="8489595">0x21</span><span class="op" id="8489599">,</span>&nbsp;<span class="num" id="8489601">0xba</span><span class="op" id="8489605">,</span>&nbsp;<span class="num" id="8489607">0x24</span><span class="op" id="8489611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489615">0x4b</span><span class="op" id="8489619">,</span>&nbsp;<span class="num" id="8489621">0xed</span><span class="op" id="8489625">,</span>&nbsp;<span class="num" id="8489627">0x65</span><span class="op" id="8489631">,</span>&nbsp;<span class="num" id="8489633">0x76</span><span class="op" id="8489637">,</span>&nbsp;<span class="num" id="8489639">0xb8</span><span class="op" id="8489643">,</span>&nbsp;<span class="num" id="8489645">0x67</span><span class="op" id="8489649">,</span>&nbsp;<span class="num" id="8489651">0xd9</span><span class="op" id="8489655">,</span>&nbsp;<span class="num" id="8489657">0xa4</span><span class="op" id="8489661">,</span>&nbsp;<span class="num" id="8489663">0x47</span><span class="op" id="8489667">,</span>&nbsp;<span class="num" id="8489669">0xc2</span><span class="op" id="8489673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489677">0x8a</span><span class="op" id="8489681">,</span>&nbsp;<span class="num" id="8489683">0x6e</span><span class="op" id="8489687">,</span>&nbsp;<span class="num" id="8489689">0x66</span><span class="op" id="8489693">,</span>&nbsp;<span class="num" id="8489695">0xa5</span><span class="op" id="8489699">,</span>&nbsp;<span class="num" id="8489701">0xb8</span><span class="op" id="8489705">,</span>&nbsp;<span class="num" id="8489707">0x7d</span><span class="op" id="8489711">,</span>&nbsp;<span class="num" id="8489713">0xee</span><span class="op" id="8489717">,</span>&nbsp;<span class="num" id="8489719">0x7f</span><span class="op" id="8489723">,</span>&nbsp;<span class="num" id="8489725">0xbc</span><span class="op" id="8489729">,</span>&nbsp;<span class="num" id="8489731">0x7e</span><span class="op" id="8489735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489739">0x65</span><span class="op" id="8489743">,</span>&nbsp;<span class="num" id="8489745">0xaf</span><span class="op" id="8489749">,</span>&nbsp;<span class="num" id="8489751">0x50</span><span class="op" id="8489755">,</span>&nbsp;<span class="num" id="8489757">0x57</span><span class="op" id="8489761">,</span>&nbsp;<span class="num" id="8489763">0xf8</span><span class="op" id="8489767">,</span>&nbsp;<span class="num" id="8489769">0x6f</span><span class="op" id="8489773">,</span>&nbsp;<span class="num" id="8489775">0xae</span><span class="op" id="8489779">,</span>&nbsp;<span class="num" id="8489781">0x89</span><span class="op" id="8489785">,</span>&nbsp;<span class="num" id="8489787">0x84</span><span class="op" id="8489791">,</span>&nbsp;<span class="num" id="8489793">0xd9</span><span class="op" id="8489797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489801">0xba</span><span class="op" id="8489805">,</span>&nbsp;<span class="num" id="8489807">0x7f</span><span class="op" id="8489811">,</span>&nbsp;<span class="num" id="8489813">0x96</span><span class="op" id="8489817">,</span>&nbsp;<span class="num" id="8489819">0x9a</span><span class="op" id="8489823">,</span>&nbsp;<span class="num" id="8489825">0xd6</span><span class="op" id="8489829">,</span>&nbsp;<span class="num" id="8489831">0xfe</span><span class="op" id="8489835">,</span>&nbsp;<span class="num" id="8489837">0x02</span><span class="op" id="8489841">,</span>&nbsp;<span class="num" id="8489843">0xa4</span><span class="op" id="8489847">,</span>&nbsp;<span class="num" id="8489849">0xd7</span><span class="op" id="8489853">,</span>&nbsp;<span class="num" id="8489855">0x5f</span><span class="op" id="8489859">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489863">0x74</span><span class="op" id="8489867">,</span>&nbsp;<span class="num" id="8489869">0x45</span><span class="op" id="8489873">,</span>&nbsp;<span class="num" id="8489875">0xfe</span><span class="op" id="8489879">,</span>&nbsp;<span class="num" id="8489881">0xfd</span><span class="op" id="8489885">,</span>&nbsp;<span class="num" id="8489887">0xd8</span><span class="op" id="8489891">,</span>&nbsp;<span class="num" id="8489893">0x5b</span><span class="op" id="8489897">,</span>&nbsp;<span class="num" id="8489899">0x6d</span><span class="op" id="8489903">,</span>&nbsp;<span class="num" id="8489905">0x3a</span><span class="op" id="8489909">,</span>&nbsp;<span class="num" id="8489911">0x47</span><span class="op" id="8489915">,</span>&nbsp;<span class="num" id="8489917">0x7c</span><span class="op" id="8489921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489925">0x28</span><span class="op" id="8489929">,</span>&nbsp;<span class="num" id="8489931">0xd2</span><span class="op" id="8489935">,</span>&nbsp;<span class="num" id="8489937">0x4b</span><span class="op" id="8489941">,</span>&nbsp;<span class="num" id="8489943">0xa1</span><span class="op" id="8489947">,</span>&nbsp;<span class="num" id="8489949">0xe3</span><span class="op" id="8489953">,</span>&nbsp;<span class="num" id="8489955">0x75</span><span class="op" id="8489959">,</span>&nbsp;<span class="num" id="8489961">0x6f</span><span class="op" id="8489965">,</span>&nbsp;<span class="num" id="8489967">0x79</span><span class="op" id="8489971">,</span>&nbsp;<span class="num" id="8489973">0x2d</span><span class="op" id="8489977">,</span>&nbsp;<span class="num" id="8489979">0xd1</span><span class="op" id="8489983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8489987">0xdc</span><span class="op" id="8489991">,</span>&nbsp;<span class="num" id="8489993">0xe8</span><span class="op" id="8489997">,</span>&nbsp;<span class="num" id="8489999">0xca</span><span class="op" id="8490003">,</span>&nbsp;<span class="num" id="8490005">0x94</span><span class="op" id="8490009">,</span>&nbsp;<span class="num" id="8490011">0x44</span><span class="op" id="8490015">,</span>&nbsp;<span class="num" id="8490017">0x0e</span><span class="op" id="8490021">,</span>&nbsp;<span class="num" id="8490023">0xcb</span><span class="op" id="8490027">,</span>&nbsp;<span class="num" id="8490029">0x52</span><span class="op" id="8490033">,</span>&nbsp;<span class="num" id="8490035">0x79</span><span class="op" id="8490039">,</span>&nbsp;<span class="num" id="8490041">0xec</span><span class="op" id="8490045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8490049">0xd3</span><span class="op" id="8490053">,</span>&nbsp;<span class="num" id="8490055">0x18</span><span class="op" id="8490059">,</span>&nbsp;<span class="num" id="8490061">0x3a</span><span class="op" id="8490065">,</span>&nbsp;<span class="num" id="8490067">0x31</span><span class="op" id="8490071">,</span>&nbsp;<span class="num" id="8490073">0x1f</span><span class="op" id="8490077">,</span>&nbsp;<span class="num" id="8490079">0xc8</span><span class="op" id="8490083">,</span>&nbsp;<span class="num" id="8490085">0x96</span><span class="op" id="8490089">,</span>&nbsp;<span class="num" id="8490091">0xda</span><span class="op" id="8490095">,</span>&nbsp;<span class="num" id="8490097">0x1c</span><span class="op" id="8490101">,</span>&nbsp;<span class="num" id="8490103">0xb3</span><span class="op" id="8490107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8490111">0x93</span><span class="op" id="8490115">,</span>&nbsp;<span class="num" id="8490117">0x11</span><span class="op" id="8490121">,</span>&nbsp;<span class="num" id="8490123">0xaf</span><span class="op" id="8490127">,</span>&nbsp;<span class="num" id="8490129">0x37</span><span class="op" id="8490133">,</span>&nbsp;<span class="num" id="8490135">0xea</span><span class="op" id="8490139">,</span>&nbsp;<span class="num" id="8490141">0x4a</span><span class="op" id="8490145">,</span>&nbsp;<span class="num" id="8490147">0x75</span><span class="op" id="8490151">,</span>&nbsp;<span class="num" id="8490153">0xe2</span><span class="op" id="8490157">,</span>&nbsp;<span class="num" id="8490159">0x4b</span><span class="op" id="8490163">,</span>&nbsp;<span class="num" id="8490165">0xdb</span><span class="op" id="8490169">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8490173">0xfd</span><span class="op" id="8490177">,</span>&nbsp;<span class="num" id="8490179">0x5c</span><span class="op" id="8490183">,</span>&nbsp;<span class="num" id="8490185">0x1d</span><span class="op" id="8490189">,</span>&nbsp;<span class="num" id="8490191">0xa0</span><span class="op" id="8490195">,</span>&nbsp;<span class="num" id="8490197">0xde</span><span class="op" id="8490201">,</span>&nbsp;<span class="num" id="8490203">0x7c</span><span class="op" id="8490207">,</span>&nbsp;<span class="num" id="8490209">0xec</span><span class="op" id="8490213">,</span>&nbsp;<span class="num" id="8490215">0xdf</span><span class="op" id="8490219">,</span>&nbsp;<span class="num" id="8490221">0x1a</span><span class="op" id="8490225">,</span>&nbsp;<span class="num" id="8490227">0x89</span><span class="op" id="8490231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8490235">0x6f</span><span class="op" id="8490239">,</span>&nbsp;<span class="num" id="8490241">0x9d</span><span class="op" id="8490245">,</span>&nbsp;<span class="num" id="8490247">0x8b</span><span class="op" id="8490251">,</span>&nbsp;<span class="num" id="8490253">0xc8</span><span class="op" id="8490257">,</span>&nbsp;<span class="num" id="8490259">0x16</span><span class="op" id="8490263">,</span>&nbsp;<span class="num" id="8490265">0xd9</span><span class="op" id="8490269">,</span>&nbsp;<span class="num" id="8490271">0x7c</span><span class="op" id="8490275">,</span>&nbsp;<span class="num" id="8490277">0xd7</span><span class="op" id="8490281">,</span>&nbsp;<span class="num" id="8490283">0xa2</span><span class="op" id="8490287">,</span>&nbsp;<span class="num" id="8490289">0xc4</span><span class="op" id="8490293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8490297">0x3b</span><span class="op" id="8490301">,</span>&nbsp;<span class="num" id="8490303">0xad</span><span class="op" id="8490307">,</span>&nbsp;<span class="num" id="8490309">0x54</span><span class="op" id="8490313">,</span>&nbsp;<span class="num" id="8490315">0x6f</span><span class="op" id="8490319">,</span>&nbsp;<span class="num" id="8490321">0xbe</span><span class="op" id="8490325">,</span>&nbsp;<span class="num" id="8490327">0x8c</span><span class="op" id="8490331">,</span>&nbsp;<span class="num" id="8490333">0xfe</span><span class="op" id="8490337">,</span>&nbsp;<span class="num" id="8490339">0xbc</span><span class="op" id="8490343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490350">hash</span>&nbsp;<span class="op" id="8490355">:=</span>&nbsp;<span class="ident" id="8490358">sha1</span><span class="op" id="8490362">.</span><span class="ident" id="8490363">New</span><span class="op" id="8490366">(</span><span class="op" id="8490367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490370">hash</span><span class="op" id="8490374">.</span><span class="ident" id="8490375">Write</span><span class="op" id="8490380">(</span><span class="ident" id="8490381">msg</span><span class="op" id="8490384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490387">hashed</span>&nbsp;<span class="op" id="8490394">:=</span>&nbsp;<span class="ident" id="8490397">hash</span><span class="op" id="8490401">.</span><span class="ident" id="8490402">Sum</span><span class="op" id="8490405">(</span><span class="ident" id="8490406">nil</span><span class="op" id="8490409">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490413">encoded</span><span class="op" id="8490420">,</span>&nbsp;<span class="ident" id="8490422">err</span>&nbsp;<span class="op" id="8490426">:=</span>&nbsp;<span class="ident" id="8490429">emsaPSSEncode</span><span class="op" id="8490442">(</span><span class="ident" id="8490443">hashed</span><span class="op" id="8490449">,</span>&nbsp;<span class="num" id="8490451">1023</span><span class="op" id="8490455">,</span>&nbsp;<span class="ident" id="8490457">salt</span><span class="op" id="8490461">,</span>&nbsp;<span class="ident" id="8490463">sha1</span><span class="op" id="8490467">.</span><span class="ident" id="8490468">New</span><span class="op" id="8490471">(</span><span class="op" id="8490472">)</span><span class="op" id="8490473">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8490476">if</span>&nbsp;<span class="ident" id="8490479">err</span>&nbsp;<span class="op" id="8490483">!=</span>&nbsp;<span class="ident" id="8490486">nil</span>&nbsp;<span class="op" id="8490490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490494">t</span><span class="op" id="8490495">.</span><span class="ident" id="8490496">Errorf</span><span class="op" id="8490502">(</span><span class="string" id="8490503">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="8490535">,</span>&nbsp;<span class="ident" id="8490537">err</span><span class="op" id="8490540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8490546">if</span>&nbsp;<span class="op" id="8490549">!</span><span class="ident" id="8490550">bytes</span><span class="op" id="8490555">.</span><span class="ident" id="8490556">Equal</span><span class="op" id="8490561">(</span><span class="ident" id="8490562">encoded</span><span class="op" id="8490569">,</span>&nbsp;<span class="ident" id="8490571">expected</span><span class="op" id="8490579">)</span>&nbsp;<span class="op" id="8490581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490585">t</span><span class="op" id="8490586">.</span><span class="ident" id="8490587">Errorf</span><span class="op" id="8490593">(</span><span class="string" id="8490594">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8490625">,</span>&nbsp;<span class="ident" id="8490627">encoded</span><span class="op" id="8490634">,</span>&nbsp;<span class="ident" id="8490636">expected</span><span class="op" id="8490644">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8490651">if</span>&nbsp;<span class="ident" id="8490654">err</span>&nbsp;<span class="op" id="8490658">=</span>&nbsp;<span class="ident" id="8490660">emsaPSSVerify</span><span class="op" id="8490673">(</span><span class="ident" id="8490674">hashed</span><span class="op" id="8490680">,</span>&nbsp;<span class="ident" id="8490682">encoded</span><span class="op" id="8490689">,</span>&nbsp;<span class="num" id="8490691">1023</span><span class="op" id="8490695">,</span>&nbsp;<span class="builtinfunc" id="8490697">len</span><span class="op" id="8490700">(</span><span class="ident" id="8490701">salt</span><span class="op" id="8490705">)</span><span class="op" id="8490706">,</span>&nbsp;<span class="ident" id="8490708">sha1</span><span class="op" id="8490712">.</span><span class="ident" id="8490713">New</span><span class="op" id="8490716">(</span><span class="op" id="8490717">)</span><span class="op" id="8490718">)</span><span class="op" id="8490719">;</span>&nbsp;<span class="ident" id="8490721">err</span>&nbsp;<span class="op" id="8490725">!=</span>&nbsp;<span class="ident" id="8490728">nil</span>&nbsp;<span class="op" id="8490732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490736">t</span><span class="op" id="8490737">.</span><span class="ident" id="8490738">Errorf</span><span class="op" id="8490744">(</span><span class="string" id="8490745">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="8490767">,</span>&nbsp;<span class="ident" id="8490769">err</span><span class="op" id="8490772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490775">}</span><br>
<span class="lineno">75</span><span class="op" id="8490777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8490780">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="8490845">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="8490909">func</span>&nbsp;<span class="ident" id="8490914">TestPSSGolden</span><span class="op" id="8490927">(</span><span class="ident" id="8490928">t</span>&nbsp;<span class="op" id="8490930">*</span><span class="ident" id="8490931">testing</span><span class="op" id="8490938">.</span><span class="ident" id="8490939">T</span><span class="op" id="8490940">)</span>&nbsp;<span class="op" id="8490942">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490945">inFile</span><span class="op" id="8490951">,</span>&nbsp;<span class="ident" id="8490953">err</span>&nbsp;<span class="op" id="8490957">:=</span>&nbsp;<span class="ident" id="8490960">os</span><span class="op" id="8490962">.</span><span class="ident" id="8490963">Open</span><span class="op" id="8490967">(</span><span class="string" id="8490968">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="8490995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8490998">if</span>&nbsp;<span class="ident" id="8491001">err</span>&nbsp;<span class="op" id="8491005">!=</span>&nbsp;<span class="ident" id="8491008">nil</span>&nbsp;<span class="op" id="8491012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491016">t</span><span class="op" id="8491017">.</span><span class="ident" id="8491018">Fatalf</span><span class="op" id="8491024">(</span><span class="string" id="8491025">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="8491056">,</span>&nbsp;<span class="ident" id="8491058">err</span><span class="op" id="8491061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8491064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491067">defer</span>&nbsp;<span class="ident" id="8491073">inFile</span><span class="op" id="8491079">.</span><span class="ident" id="8491080">Close</span><span class="op" id="8491085">(</span><span class="op" id="8491086">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8491090">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8491155">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8491226">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8491296">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491331">const</span>&nbsp;<span class="ident" id="8491337">newKeyMarker</span>&nbsp;<span class="op" id="8491350">=</span>&nbsp;<span class="string" id="8491352">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491369">const</span>&nbsp;<span class="ident" id="8491375">newSignatureMarker</span>&nbsp;<span class="op" id="8491394">=</span>&nbsp;<span class="string" id="8491396">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491420">values</span>&nbsp;<span class="op" id="8491427">:=</span>&nbsp;<span class="builtinfunc" id="8491430">make</span><span class="op" id="8491434">(</span><span class="keyword" id="8491435">chan</span>&nbsp;<span class="builtintype" id="8491440">string</span><span class="op" id="8491446">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491450">go</span>&nbsp;<span class="keyword" id="8491453">func</span><span class="op" id="8491457">(</span><span class="op" id="8491458">)</span>&nbsp;<span class="op" id="8491460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491464">defer</span>&nbsp;<span class="builtinfunc" id="8491470">close</span><span class="op" id="8491475">(</span><span class="ident" id="8491476">values</span><span class="op" id="8491482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491486">scanner</span>&nbsp;<span class="op" id="8491494">:=</span>&nbsp;<span class="ident" id="8491497">bufio</span><span class="op" id="8491502">.</span><span class="ident" id="8491503">NewScanner</span><span class="op" id="8491513">(</span><span class="ident" id="8491514">bzip2</span><span class="op" id="8491519">.</span><span class="ident" id="8491520">NewReader</span><span class="op" id="8491529">(</span><span class="ident" id="8491530">inFile</span><span class="op" id="8491536">)</span><span class="op" id="8491537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491541">var</span>&nbsp;<span class="ident" id="8491545">partialValue</span>&nbsp;<span class="builtintype" id="8491558">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491567">lastWasValue</span>&nbsp;<span class="op" id="8491580">:=</span>&nbsp;<span class="builtintype" id="8491583">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491591">for</span>&nbsp;<span class="ident" id="8491595">scanner</span><span class="op" id="8491602">.</span><span class="ident" id="8491603">Scan</span><span class="op" id="8491607">(</span><span class="op" id="8491608">)</span>&nbsp;<span class="op" id="8491610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491615">line</span>&nbsp;<span class="op" id="8491620">:=</span>&nbsp;<span class="ident" id="8491623">scanner</span><span class="op" id="8491630">.</span><span class="ident" id="8491631">Text</span><span class="op" id="8491635">(</span><span class="op" id="8491636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491641">switch</span>&nbsp;<span class="op" id="8491648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491653">case</span>&nbsp;<span class="builtinfunc" id="8491658">len</span><span class="op" id="8491661">(</span><span class="ident" id="8491662">line</span><span class="op" id="8491666">)</span>&nbsp;<span class="op" id="8491668">==</span>&nbsp;<span class="num" id="8491671">0</span><span class="op" id="8491672">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491678">if</span>&nbsp;<span class="builtinfunc" id="8491681">len</span><span class="op" id="8491684">(</span><span class="ident" id="8491685">partialValue</span><span class="op" id="8491697">)</span>&nbsp;<span class="op" id="8491699">&gt;</span>&nbsp;<span class="num" id="8491701">0</span>&nbsp;<span class="op" id="8491703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491710">values</span>&nbsp;<span class="op" id="8491717">&lt;-</span>&nbsp;<span class="ident" id="8491720">strings</span><span class="op" id="8491727">.</span><span class="ident" id="8491728">Replace</span><span class="op" id="8491735">(</span><span class="ident" id="8491736">partialValue</span><span class="op" id="8491748">,</span>&nbsp;<span class="string" id="8491750">&#34;&nbsp;&#34;</span><span class="op" id="8491753">,</span>&nbsp;<span class="string" id="8491755">&#34;&#34;</span><span class="op" id="8491757">,</span>&nbsp;<span class="op" id="8491759">-</span><span class="num" id="8491760">1</span><span class="op" id="8491761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491768">partialValue</span>&nbsp;<span class="op" id="8491781">=</span>&nbsp;<span class="string" id="8491783">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491791">lastWasValue</span>&nbsp;<span class="op" id="8491804">=</span>&nbsp;<span class="builtintype" id="8491806">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8491815">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491821">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491833">case</span>&nbsp;<span class="ident" id="8491838">strings</span><span class="op" id="8491845">.</span><span class="ident" id="8491846">HasPrefix</span><span class="op" id="8491855">(</span><span class="ident" id="8491856">line</span><span class="op" id="8491860">,</span>&nbsp;<span class="string" id="8491862">&#34;#&nbsp;======&#34;</span><span class="op" id="8491872">)</span>&nbsp;<span class="op" id="8491874">&amp;&amp;</span>&nbsp;<span class="ident" id="8491877">lastWasValue</span><span class="op" id="8491889">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491895">values</span>&nbsp;<span class="op" id="8491902">&lt;-</span>&nbsp;<span class="ident" id="8491905">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491922">lastWasValue</span>&nbsp;<span class="op" id="8491935">=</span>&nbsp;<span class="builtintype" id="8491937">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491946">case</span>&nbsp;<span class="ident" id="8491951">strings</span><span class="op" id="8491958">.</span><span class="ident" id="8491959">HasPrefix</span><span class="op" id="8491968">(</span><span class="ident" id="8491969">line</span><span class="op" id="8491973">,</span>&nbsp;<span class="string" id="8491975">&#34;#&nbsp;------&#34;</span><span class="op" id="8491985">)</span>&nbsp;<span class="op" id="8491987">&amp;&amp;</span>&nbsp;<span class="ident" id="8491990">lastWasValue</span><span class="op" id="8492002">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492008">values</span>&nbsp;<span class="op" id="8492015">&lt;-</span>&nbsp;<span class="ident" id="8492018">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492041">lastWasValue</span>&nbsp;<span class="op" id="8492054">=</span>&nbsp;<span class="builtintype" id="8492056">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492065">case</span>&nbsp;<span class="ident" id="8492070">strings</span><span class="op" id="8492077">.</span><span class="ident" id="8492078">HasPrefix</span><span class="op" id="8492087">(</span><span class="ident" id="8492088">line</span><span class="op" id="8492092">,</span>&nbsp;<span class="string" id="8492094">&#34;#&#34;</span><span class="op" id="8492097">)</span><span class="op" id="8492098">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492104">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492116">default</span><span class="op" id="8492123">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492129">partialValue</span>&nbsp;<span class="op" id="8492142">+=</span>&nbsp;<span class="ident" id="8492145">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492161">if</span>&nbsp;<span class="ident" id="8492164">err</span>&nbsp;<span class="op" id="8492168">:=</span>&nbsp;<span class="ident" id="8492171">scanner</span><span class="op" id="8492178">.</span><span class="ident" id="8492179">Err</span><span class="op" id="8492182">(</span><span class="op" id="8492183">)</span><span class="op" id="8492184">;</span>&nbsp;<span class="ident" id="8492186">err</span>&nbsp;<span class="op" id="8492190">!=</span>&nbsp;<span class="ident" id="8492193">nil</span>&nbsp;<span class="op" id="8492197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8492202">panic</span><span class="op" id="8492207">(</span><span class="ident" id="8492208">err</span><span class="op" id="8492211">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492218">}</span><span class="op" id="8492219">(</span><span class="op" id="8492220">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492224">var</span>&nbsp;<span class="ident" id="8492228">key</span>&nbsp;<span class="op" id="8492232">*</span><span class="ident" id="8492233">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492244">var</span>&nbsp;<span class="ident" id="8492248">hashed</span>&nbsp;<span class="op" id="8492255">[</span><span class="op" id="8492256">]</span><span class="builtintype" id="8492257">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492263">hash</span>&nbsp;<span class="op" id="8492268">:=</span>&nbsp;<span class="ident" id="8492271">crypto</span><span class="op" id="8492277">.</span><span class="ident" id="8492278">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492284">h</span>&nbsp;<span class="op" id="8492286">:=</span>&nbsp;<span class="ident" id="8492289">hash</span><span class="op" id="8492293">.</span><span class="ident" id="8492294">New</span><span class="op" id="8492297">(</span><span class="op" id="8492298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492301">opts</span>&nbsp;<span class="op" id="8492306">:=</span>&nbsp;<span class="op" id="8492309">&amp;</span><span class="ident" id="8492310">PSSOptions</span><span class="op" id="8492320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492324">SaltLength</span><span class="op" id="8492334">:</span>&nbsp;<span class="ident" id="8492336">PSSSaltLengthEqualsHash</span><span class="op" id="8492359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492362">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492366">for</span>&nbsp;<span class="ident" id="8492370">marker</span>&nbsp;<span class="op" id="8492377">:=</span>&nbsp;<span class="keyword" id="8492380">range</span>&nbsp;<span class="ident" id="8492386">values</span>&nbsp;<span class="op" id="8492393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492397">switch</span>&nbsp;<span class="ident" id="8492404">marker</span>&nbsp;<span class="op" id="8492411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492415">case</span>&nbsp;<span class="ident" id="8492420">newKeyMarker</span><span class="op" id="8492432">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492437">key</span>&nbsp;<span class="op" id="8492441">=</span>&nbsp;<span class="builtinfunc" id="8492443">new</span><span class="op" id="8492446">(</span><span class="ident" id="8492447">PublicKey</span><span class="op" id="8492456">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492461">nHex</span><span class="op" id="8492465">,</span>&nbsp;<span class="ident" id="8492467">ok</span>&nbsp;<span class="op" id="8492470">:=</span>&nbsp;<span class="op" id="8492473">&lt;-</span><span class="ident" id="8492475">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492485">if</span>&nbsp;<span class="op" id="8492488">!</span><span class="ident" id="8492489">ok</span>&nbsp;<span class="op" id="8492492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492498">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492515">key</span><span class="op" id="8492518">.</span><span class="ident" id="8492519">N</span>&nbsp;<span class="op" id="8492521">=</span>&nbsp;<span class="ident" id="8492523">bigFromHex</span><span class="op" id="8492533">(</span><span class="ident" id="8492534">nHex</span><span class="op" id="8492538">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492543">key</span><span class="op" id="8492546">.</span><span class="ident" id="8492547">E</span>&nbsp;<span class="op" id="8492549">=</span>&nbsp;<span class="ident" id="8492551">intFromHex</span><span class="op" id="8492561">(</span><span class="op" id="8492562">&lt;-</span><span class="ident" id="8492564">values</span><span class="op" id="8492570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8492575">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492624">for</span>&nbsp;<span class="ident" id="8492628">i</span>&nbsp;<span class="op" id="8492630">:=</span>&nbsp;<span class="num" id="8492633">0</span><span class="op" id="8492634">;</span>&nbsp;<span class="ident" id="8492636">i</span>&nbsp;<span class="op" id="8492638">&lt;</span>&nbsp;<span class="num" id="8492640">6</span><span class="op" id="8492641">;</span>&nbsp;<span class="ident" id="8492643">i</span><span class="op" id="8492644">++</span>&nbsp;<span class="op" id="8492647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492653">&lt;-</span><span class="ident" id="8492655">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492665">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492669">case</span>&nbsp;<span class="ident" id="8492674">newSignatureMarker</span><span class="op" id="8492692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492697">msg</span>&nbsp;<span class="op" id="8492701">:=</span>&nbsp;<span class="ident" id="8492704">fromHex</span><span class="op" id="8492711">(</span><span class="op" id="8492712">&lt;-</span><span class="ident" id="8492714">values</span><span class="op" id="8492720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492725">&lt;-</span><span class="ident" id="8492727">values</span>&nbsp;<span class="comment" id="8492734">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492750">sig</span>&nbsp;<span class="op" id="8492754">:=</span>&nbsp;<span class="ident" id="8492757">fromHex</span><span class="op" id="8492764">(</span><span class="op" id="8492765">&lt;-</span><span class="ident" id="8492767">values</span><span class="op" id="8492773">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492779">h</span><span class="op" id="8492780">.</span><span class="ident" id="8492781">Reset</span><span class="op" id="8492786">(</span><span class="op" id="8492787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492792">h</span><span class="op" id="8492793">.</span><span class="ident" id="8492794">Write</span><span class="op" id="8492799">(</span><span class="ident" id="8492800">msg</span><span class="op" id="8492803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492808">hashed</span>&nbsp;<span class="op" id="8492815">=</span>&nbsp;<span class="ident" id="8492817">h</span><span class="op" id="8492818">.</span><span class="ident" id="8492819">Sum</span><span class="op" id="8492822">(</span><span class="ident" id="8492823">hashed</span><span class="op" id="8492829">[</span><span class="op" id="8492830">:</span><span class="num" id="8492831">0</span><span class="op" id="8492832">]</span><span class="op" id="8492833">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492839">if</span>&nbsp;<span class="ident" id="8492842">err</span>&nbsp;<span class="op" id="8492846">:=</span>&nbsp;<span class="ident" id="8492849">VerifyPSS</span><span class="op" id="8492858">(</span><span class="ident" id="8492859">key</span><span class="op" id="8492862">,</span>&nbsp;<span class="ident" id="8492864">hash</span><span class="op" id="8492868">,</span>&nbsp;<span class="ident" id="8492870">hashed</span><span class="op" id="8492876">,</span>&nbsp;<span class="ident" id="8492878">sig</span><span class="op" id="8492881">,</span>&nbsp;<span class="ident" id="8492883">opts</span><span class="op" id="8492887">)</span><span class="op" id="8492888">;</span>&nbsp;<span class="ident" id="8492890">err</span>&nbsp;<span class="op" id="8492894">!=</span>&nbsp;<span class="ident" id="8492897">nil</span>&nbsp;<span class="op" id="8492901">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492907">t</span><span class="op" id="8492908">.</span><span class="ident" id="8492909">Error</span><span class="op" id="8492914">(</span><span class="ident" id="8492915">err</span><span class="op" id="8492918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492927">default</span><span class="op" id="8492934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492939">t</span><span class="op" id="8492940">.</span><span class="ident" id="8492941">Fatalf</span><span class="op" id="8492947">(</span><span class="string" id="8492948">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="8492967">+</span>&nbsp;<span class="ident" id="8492969">marker</span><span class="op" id="8492975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492979">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492982">}</span><br>
<span class="lineno"></span><span class="op" id="8492984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8492987">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8493066">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="8493134">func</span>&nbsp;<span class="ident" id="8493139">TestPSSOpenSSL</span><span class="op" id="8493153">(</span><span class="ident" id="8493154">t</span>&nbsp;<span class="op" id="8493156">*</span><span class="ident" id="8493157">testing</span><span class="op" id="8493164">.</span><span class="ident" id="8493165">T</span><span class="op" id="8493166">)</span>&nbsp;<span class="op" id="8493168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493171">hash</span>&nbsp;<span class="op" id="8493176">:=</span>&nbsp;<span class="ident" id="8493179">crypto</span><span class="op" id="8493185">.</span><span class="ident" id="8493186">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493194">h</span>&nbsp;<span class="op" id="8493196">:=</span>&nbsp;<span class="ident" id="8493199">hash</span><span class="op" id="8493203">.</span><span class="ident" id="8493204">New</span><span class="op" id="8493207">(</span><span class="op" id="8493208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493211">h</span><span class="op" id="8493212">.</span><span class="ident" id="8493213">Write</span><span class="op" id="8493218">(</span><span class="op" id="8493219">[</span><span class="op" id="8493220">]</span><span class="builtintype" id="8493221">byte</span><span class="op" id="8493225">(</span><span class="string" id="8493226">&#34;testing&#34;</span><span class="op" id="8493235">)</span><span class="op" id="8493236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493239">hashed</span>&nbsp;<span class="op" id="8493246">:=</span>&nbsp;<span class="ident" id="8493249">h</span><span class="op" id="8493250">.</span><span class="ident" id="8493251">Sum</span><span class="op" id="8493254">(</span><span class="ident" id="8493255">nil</span><span class="op" id="8493258">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8493262">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493371">sig</span>&nbsp;<span class="op" id="8493375">:=</span>&nbsp;<span class="op" id="8493378">[</span><span class="op" id="8493379">]</span><span class="builtintype" id="8493380">byte</span><span class="op" id="8493384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8493388">0x95</span><span class="op" id="8493392">,</span>&nbsp;<span class="num" id="8493394">0x59</span><span class="op" id="8493398">,</span>&nbsp;<span class="num" id="8493400">0x6f</span><span class="op" id="8493404">,</span>&nbsp;<span class="num" id="8493406">0xd3</span><span class="op" id="8493410">,</span>&nbsp;<span class="num" id="8493412">0x10</span><span class="op" id="8493416">,</span>&nbsp;<span class="num" id="8493418">0xa2</span><span class="op" id="8493422">,</span>&nbsp;<span class="num" id="8493424">0xe7</span><span class="op" id="8493428">,</span>&nbsp;<span class="num" id="8493430">0xa2</span><span class="op" id="8493434">,</span>&nbsp;<span class="num" id="8493436">0x92</span><span class="op" id="8493440">,</span>&nbsp;<span class="num" id="8493442">0x9d</span><span class="op" id="8493446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8493450">0x4a</span><span class="op" id="8493454">,</span>&nbsp;<span class="num" id="8493456">0x07</span><span class="op" id="8493460">,</span>&nbsp;<span class="num" id="8493462">0x2e</span><span class="op" id="8493466">,</span>&nbsp;<span class="num" id="8493468">0x2b</span><span class="op" id="8493472">,</span>&nbsp;<span class="num" id="8493474">0x27</span><span class="op" id="8493478">,</span>&nbsp;<span class="num" id="8493480">0xcc</span><span class="op" id="8493484">,</span>&nbsp;<span class="num" id="8493486">0x06</span><span class="op" id="8493490">,</span>&nbsp;<span class="num" id="8493492">0xc2</span><span class="op" id="8493496">,</span>&nbsp;<span class="num" id="8493498">0x87</span><span class="op" id="8493502">,</span>&nbsp;<span class="num" id="8493504">0x2c</span><span class="op" id="8493508">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8493512">0x52</span><span class="op" id="8493516">,</span>&nbsp;<span class="num" id="8493518">0xf0</span><span class="op" id="8493522">,</span>&nbsp;<span class="num" id="8493524">0x4a</span><span class="op" id="8493528">,</span>&nbsp;<span class="num" id="8493530">0xcc</span><span class="op" id="8493534">,</span>&nbsp;<span class="num" id="8493536">0x05</span><span class="op" id="8493540">,</span>&nbsp;<span class="num" id="8493542">0x94</span><span class="op" id="8493546">,</span>&nbsp;<span class="num" id="8493548">0xf2</span><span class="op" id="8493552">,</span>&nbsp;<span class="num" id="8493554">0xc3</span><span class="op" id="8493558">,</span>&nbsp;<span class="num" id="8493560">0x2e</span><span class="op" id="8493564">,</span>&nbsp;<span class="num" id="8493566">0x20</span><span class="op" id="8493570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8493574">0xd7</span><span class="op" id="8493578">,</span>&nbsp;<span class="num" id="8493580">0x3e</span><span class="op" id="8493584">,</span>&nbsp;<span class="num" id="8493586">0x66</span><span class="op" id="8493590">,</span>&nbsp;<span class="num" id="8493592">0x62</span><span class="op" id="8493596">,</span>&nbsp;<span class="num" id="8493598">0xb5</span><span class="op" id="8493602">,</span>&nbsp;<span class="num" id="8493604">0x95</span><span class="op" id="8493608">,</span>&nbsp;<span class="num" id="8493610">0x2b</span><span class="op" id="8493614">,</span>&nbsp;<span class="num" id="8493616">0xa3</span><span class="op" id="8493620">,</span>&nbsp;<span class="num" id="8493622">0x93</span><span class="op" id="8493626">,</span>&nbsp;<span class="num" id="8493628">0x9a</span><span class="op" id="8493632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8493636">0x66</span><span class="op" id="8493640">,</span>&nbsp;<span class="num" id="8493642">0x64</span><span class="op" id="8493646">,</span>&nbsp;<span class="num" id="8493648">0x25</span><span class="op" id="8493652">,</span>&nbsp;<span class="num" id="8493654">0xe0</span><span class="op" id="8493658">,</span>&nbsp;<span class="num" id="8493660">0x74</span><span class="op" id="8493664">,</span>&nbsp;<span class="num" id="8493666">0x66</span><span class="op" id="8493670">,</span>&nbsp;<span class="num" id="8493672">0x8c</span><span class="op" id="8493676">,</span>&nbsp;<span class="num" id="8493678">0x3e</span><span class="op" id="8493682">,</span>&nbsp;<span class="num" id="8493684">0x92</span><span class="op" id="8493688">,</span>&nbsp;<span class="num" id="8493690">0xeb</span><span class="op" id="8493694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8493698">0xc6</span><span class="op" id="8493702">,</span>&nbsp;<span class="num" id="8493704">0xe6</span><span class="op" id="8493708">,</span>&nbsp;<span class="num" id="8493710">0xc0</span><span class="op" id="8493714">,</span>&nbsp;<span class="num" id="8493716">0x44</span><span class="op" id="8493720">,</span>&nbsp;<span class="num" id="8493722">0xf3</span><span class="op" id="8493726">,</span>&nbsp;<span class="num" id="8493728">0xb4</span><span class="op" id="8493732">,</span>&nbsp;<span class="num" id="8493734">0xb4</span><span class="op" id="8493738">,</span>&nbsp;<span class="num" id="8493740">0x2e</span><span class="op" id="8493744">,</span>&nbsp;<span class="num" id="8493746">0x8c</span><span class="op" id="8493750">,</span>&nbsp;<span class="num" id="8493752">0x66</span><span class="op" id="8493756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8493760">0x0a</span><span class="op" id="8493764">,</span>&nbsp;<span class="num" id="8493766">0x37</span><span class="op" id="8493770">,</span>&nbsp;<span class="num" id="8493772">0x9c</span><span class="op" id="8493776">,</span>&nbsp;<span class="num" id="8493778">0x69</span><span class="op" id="8493782">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8493785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8493789">if</span>&nbsp;<span class="ident" id="8493792">err</span>&nbsp;<span class="op" id="8493796">:=</span>&nbsp;<span class="ident" id="8493799">VerifyPSS</span><span class="op" id="8493808">(</span><span class="op" id="8493809">&amp;</span><span class="ident" id="8493810">rsaPrivateKey</span><span class="op" id="8493823">.</span><span class="ident" id="8493824">PublicKey</span><span class="op" id="8493833">,</span>&nbsp;<span class="ident" id="8493835">hash</span><span class="op" id="8493839">,</span>&nbsp;<span class="ident" id="8493841">hashed</span><span class="op" id="8493847">,</span>&nbsp;<span class="ident" id="8493849">sig</span><span class="op" id="8493852">,</span>&nbsp;<span class="ident" id="8493854">nil</span><span class="op" id="8493857">)</span><span class="op" id="8493858">;</span>&nbsp;<span class="ident" id="8493860">err</span>&nbsp;<span class="op" id="8493864">!=</span>&nbsp;<span class="ident" id="8493867">nil</span>&nbsp;<span class="op" id="8493871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493875">t</span><span class="op" id="8493876">.</span><span class="ident" id="8493877">Error</span><span class="op" id="8493882">(</span><span class="ident" id="8493883">err</span><span class="op" id="8493886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8493889">}</span><br>
<span class="lineno">190</span><span class="op" id="8493891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8493894">func</span>&nbsp;<span class="ident" id="8493899">TestPSSSigning</span><span class="op" id="8493913">(</span><span class="ident" id="8493914">t</span>&nbsp;<span class="op" id="8493916">*</span><span class="ident" id="8493917">testing</span><span class="op" id="8493924">.</span><span class="ident" id="8493925">T</span><span class="op" id="8493926">)</span>&nbsp;<span class="op" id="8493928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8493931">var</span>&nbsp;<span class="ident" id="8493935">saltLengthCombinations</span>&nbsp;<span class="op" id="8493958">=</span>&nbsp;<span class="op" id="8493960">[</span><span class="op" id="8493961">]</span><span class="keyword" id="8493962">struct</span>&nbsp;<span class="op" id="8493969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493973">signSaltLength</span><span class="op" id="8493987">,</span>&nbsp;<span class="ident" id="8493989">verifySaltLength</span>&nbsp;<span class="builtintype" id="8494006">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494012">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8494045">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494051">}</span><span class="op" id="8494052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494056">{</span><span class="ident" id="8494057">PSSSaltLengthAuto</span><span class="op" id="8494074">,</span>&nbsp;<span class="ident" id="8494076">PSSSaltLengthAuto</span><span class="op" id="8494093">,</span>&nbsp;<span class="builtintype" id="8494095">true</span><span class="op" id="8494099">}</span><span class="op" id="8494100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494104">{</span><span class="ident" id="8494105">PSSSaltLengthEqualsHash</span><span class="op" id="8494128">,</span>&nbsp;<span class="ident" id="8494130">PSSSaltLengthAuto</span><span class="op" id="8494147">,</span>&nbsp;<span class="builtintype" id="8494149">true</span><span class="op" id="8494153">}</span><span class="op" id="8494154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494158">{</span><span class="ident" id="8494159">PSSSaltLengthEqualsHash</span><span class="op" id="8494182">,</span>&nbsp;<span class="ident" id="8494184">PSSSaltLengthEqualsHash</span><span class="op" id="8494207">,</span>&nbsp;<span class="builtintype" id="8494209">true</span><span class="op" id="8494213">}</span><span class="op" id="8494214">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494218">{</span><span class="ident" id="8494219">PSSSaltLengthEqualsHash</span><span class="op" id="8494242">,</span>&nbsp;<span class="num" id="8494244">8</span><span class="op" id="8494245">,</span>&nbsp;<span class="builtintype" id="8494247">false</span><span class="op" id="8494252">}</span><span class="op" id="8494253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494257">{</span><span class="ident" id="8494258">PSSSaltLengthAuto</span><span class="op" id="8494275">,</span>&nbsp;<span class="ident" id="8494277">PSSSaltLengthEqualsHash</span><span class="op" id="8494300">,</span>&nbsp;<span class="builtintype" id="8494302">false</span><span class="op" id="8494307">}</span><span class="op" id="8494308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494312">{</span><span class="num" id="8494313">8</span><span class="op" id="8494314">,</span>&nbsp;<span class="num" id="8494316">8</span><span class="op" id="8494317">,</span>&nbsp;<span class="builtintype" id="8494319">true</span><span class="op" id="8494323">}</span><span class="op" id="8494324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494331">hash</span>&nbsp;<span class="op" id="8494336">:=</span>&nbsp;<span class="ident" id="8494339">crypto</span><span class="op" id="8494345">.</span><span class="ident" id="8494346">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494351">h</span>&nbsp;<span class="op" id="8494353">:=</span>&nbsp;<span class="ident" id="8494356">hash</span><span class="op" id="8494360">.</span><span class="ident" id="8494361">New</span><span class="op" id="8494364">(</span><span class="op" id="8494365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494368">h</span><span class="op" id="8494369">.</span><span class="ident" id="8494370">Write</span><span class="op" id="8494375">(</span><span class="op" id="8494376">[</span><span class="op" id="8494377">]</span><span class="builtintype" id="8494378">byte</span><span class="op" id="8494382">(</span><span class="string" id="8494383">&#34;testing&#34;</span><span class="op" id="8494392">)</span><span class="op" id="8494393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494396">hashed</span>&nbsp;<span class="op" id="8494403">:=</span>&nbsp;<span class="ident" id="8494406">h</span><span class="op" id="8494407">.</span><span class="ident" id="8494408">Sum</span><span class="op" id="8494411">(</span><span class="ident" id="8494412">nil</span><span class="op" id="8494415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494418">var</span>&nbsp;<span class="ident" id="8494422">opts</span>&nbsp;<span class="ident" id="8494427">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494440">for</span>&nbsp;<span class="ident" id="8494444">i</span><span class="op" id="8494445">,</span>&nbsp;<span class="ident" id="8494447">test</span>&nbsp;<span class="op" id="8494452">:=</span>&nbsp;<span class="keyword" id="8494455">range</span>&nbsp;<span class="ident" id="8494461">saltLengthCombinations</span>&nbsp;<span class="op" id="8494484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494488">opts</span><span class="op" id="8494492">.</span><span class="ident" id="8494493">SaltLength</span>&nbsp;<span class="op" id="8494504">=</span>&nbsp;<span class="ident" id="8494506">test</span><span class="op" id="8494510">.</span><span class="ident" id="8494511">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494528">sig</span><span class="op" id="8494531">,</span>&nbsp;<span class="ident" id="8494533">err</span>&nbsp;<span class="op" id="8494537">:=</span>&nbsp;<span class="ident" id="8494540">SignPSS</span><span class="op" id="8494547">(</span><span class="ident" id="8494548">rand</span><span class="op" id="8494552">.</span><span class="ident" id="8494553">Reader</span><span class="op" id="8494559">,</span>&nbsp;<span class="ident" id="8494561">rsaPrivateKey</span><span class="op" id="8494574">,</span>&nbsp;<span class="ident" id="8494576">hash</span><span class="op" id="8494580">,</span>&nbsp;<span class="ident" id="8494582">hashed</span><span class="op" id="8494588">,</span>&nbsp;<span class="op" id="8494590">&amp;</span><span class="ident" id="8494591">opts</span><span class="op" id="8494595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494599">if</span>&nbsp;<span class="ident" id="8494602">err</span>&nbsp;<span class="op" id="8494606">!=</span>&nbsp;<span class="ident" id="8494609">nil</span>&nbsp;<span class="op" id="8494613">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494618">t</span><span class="op" id="8494619">.</span><span class="ident" id="8494620">Errorf</span><span class="op" id="8494626">(</span><span class="string" id="8494627">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="8494657">,</span>&nbsp;<span class="ident" id="8494659">i</span><span class="op" id="8494660">,</span>&nbsp;<span class="ident" id="8494662">err</span><span class="op" id="8494665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494670">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494686">opts</span><span class="op" id="8494690">.</span><span class="ident" id="8494691">SaltLength</span>&nbsp;<span class="op" id="8494702">=</span>&nbsp;<span class="ident" id="8494704">test</span><span class="op" id="8494708">.</span><span class="ident" id="8494709">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494728">err</span>&nbsp;<span class="op" id="8494732">=</span>&nbsp;<span class="ident" id="8494734">VerifyPSS</span><span class="op" id="8494743">(</span><span class="op" id="8494744">&amp;</span><span class="ident" id="8494745">rsaPrivateKey</span><span class="op" id="8494758">.</span><span class="ident" id="8494759">PublicKey</span><span class="op" id="8494768">,</span>&nbsp;<span class="ident" id="8494770">hash</span><span class="op" id="8494774">,</span>&nbsp;<span class="ident" id="8494776">hashed</span><span class="op" id="8494782">,</span>&nbsp;<span class="ident" id="8494784">sig</span><span class="op" id="8494787">,</span>&nbsp;<span class="op" id="8494789">&amp;</span><span class="ident" id="8494790">opts</span><span class="op" id="8494794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494798">if</span>&nbsp;<span class="op" id="8494801">(</span><span class="ident" id="8494802">err</span>&nbsp;<span class="op" id="8494806">==</span>&nbsp;<span class="ident" id="8494809">nil</span><span class="op" id="8494812">)</span>&nbsp;<span class="op" id="8494814">!=</span>&nbsp;<span class="ident" id="8494817">test</span><span class="op" id="8494821">.</span><span class="ident" id="8494822">good</span>&nbsp;<span class="op" id="8494827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494832">t</span><span class="op" id="8494833">.</span><span class="ident" id="8494834">Errorf</span><span class="op" id="8494840">(</span><span class="string" id="8494841">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="8494879">,</span>&nbsp;<span class="ident" id="8494881">i</span><span class="op" id="8494882">,</span>&nbsp;<span class="ident" id="8494884">test</span><span class="op" id="8494888">.</span><span class="ident" id="8494889">good</span><span class="op" id="8494893">,</span>&nbsp;<span class="ident" id="8494895">err</span><span class="op" id="8494898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494905">}</span><br>
<span class="lineno">225</span><span class="op" id="8494907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8494910">func</span>&nbsp;<span class="ident" id="8494915">bigFromHex</span><span class="op" id="8494925">(</span><span class="ident" id="8494926">hex</span>&nbsp;<span class="builtintype" id="8494930">string</span><span class="op" id="8494936">)</span>&nbsp;<span class="op" id="8494938">*</span><span class="ident" id="8494939">big</span><span class="op" id="8494942">.</span><span class="ident" id="8494943">Int</span>&nbsp;<span class="op" id="8494947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494950">n</span><span class="op" id="8494951">,</span>&nbsp;<span class="ident" id="8494953">ok</span>&nbsp;<span class="op" id="8494956">:=</span>&nbsp;<span class="builtinfunc" id="8494959">new</span><span class="op" id="8494962">(</span><span class="ident" id="8494963">big</span><span class="op" id="8494966">.</span><span class="ident" id="8494967">Int</span><span class="op" id="8494970">)</span><span class="op" id="8494971">.</span><span class="ident" id="8494972">SetString</span><span class="op" id="8494981">(</span><span class="ident" id="8494982">hex</span><span class="op" id="8494985">,</span>&nbsp;<span class="num" id="8494987">16</span><span class="op" id="8494989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494992">if</span>&nbsp;<span class="op" id="8494995">!</span><span class="ident" id="8494996">ok</span>&nbsp;<span class="op" id="8494999">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8495003">panic</span><span class="op" id="8495008">(</span><span class="string" id="8495009">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="8495021">+</span>&nbsp;<span class="ident" id="8495023">hex</span><span class="op" id="8495026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8495029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8495032">return</span>&nbsp;<span class="ident" id="8495039">n</span><br>
<span class="lineno"></span><span class="op" id="8495041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8495044">func</span>&nbsp;<span class="ident" id="8495049">intFromHex</span><span class="op" id="8495059">(</span><span class="ident" id="8495060">hex</span>&nbsp;<span class="builtintype" id="8495064">string</span><span class="op" id="8495070">)</span>&nbsp;<span class="builtintype" id="8495072">int</span>&nbsp;<span class="op" id="8495076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8495079">i</span><span class="op" id="8495080">,</span>&nbsp;<span class="ident" id="8495082">err</span>&nbsp;<span class="op" id="8495086">:=</span>&nbsp;<span class="ident" id="8495089">strconv</span><span class="op" id="8495096">.</span><span class="ident" id="8495097">ParseInt</span><span class="op" id="8495105">(</span><span class="ident" id="8495106">hex</span><span class="op" id="8495109">,</span>&nbsp;<span class="num" id="8495111">16</span><span class="op" id="8495113">,</span>&nbsp;<span class="num" id="8495115">32</span><span class="op" id="8495117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8495120">if</span>&nbsp;<span class="ident" id="8495123">err</span>&nbsp;<span class="op" id="8495127">!=</span>&nbsp;<span class="ident" id="8495130">nil</span>&nbsp;<span class="op" id="8495134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8495138">panic</span><span class="op" id="8495143">(</span><span class="ident" id="8495144">err</span><span class="op" id="8495147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8495150">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8495153">return</span>&nbsp;<span class="builtintype" id="8495160">int</span><span class="op" id="8495163">(</span><span class="ident" id="8495164">i</span><span class="op" id="8495165">)</span><br>
<span class="lineno"></span><span class="op" id="8495167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8495170">func</span>&nbsp;<span class="ident" id="8495175">fromHex</span><span class="op" id="8495182">(</span><span class="ident" id="8495183">hexStr</span>&nbsp;<span class="builtintype" id="8495190">string</span><span class="op" id="8495196">)</span>&nbsp;<span class="op" id="8495198">[</span><span class="op" id="8495199">]</span><span class="builtintype" id="8495200">byte</span>&nbsp;<span class="op" id="8495205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8495208">s</span><span class="op" id="8495209">,</span>&nbsp;<span class="ident" id="8495211">err</span>&nbsp;<span class="op" id="8495215">:=</span>&nbsp;<span class="ident" id="8495218">hex</span><span class="op" id="8495221">.</span><span class="ident" id="8495222">DecodeString</span><span class="op" id="8495234">(</span><span class="ident" id="8495235">hexStr</span><span class="op" id="8495241">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8495244">if</span>&nbsp;<span class="ident" id="8495247">err</span>&nbsp;<span class="op" id="8495251">!=</span>&nbsp;<span class="ident" id="8495254">nil</span>&nbsp;<span class="op" id="8495258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8495262">panic</span><span class="op" id="8495267">(</span><span class="ident" id="8495268">err</span><span class="op" id="8495271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8495274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8495277">return</span>&nbsp;<span class="ident" id="8495284">s</span><br>
<span class="lineno"></span><span class="op" id="8495286">}</span>
</div>
</body>
</html>
