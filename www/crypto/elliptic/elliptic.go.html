<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4439562">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4439617">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4439671">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4439722">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4439797">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4439808">package</span>&nbsp;<span class="ident" id="4439816">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4439826">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="4439901">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="4439976">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="4440056">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4440131">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4440205">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4440270">import</span>&nbsp;<span class="op" id="4440277">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4440280">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4440286">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4440298">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="4440305">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4440308">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="4440372">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="4440433">type</span>&nbsp;<span class="ident" id="4440438">Curve</span>&nbsp;<span class="keyword" id="4440444">interface</span>&nbsp;<span class="op" id="4440454">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4440457">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440506">Params</span><span class="op" id="4440512">(</span><span class="op" id="4440513">)</span>&nbsp;<span class="op" id="4440515">*</span><span class="ident" id="4440516"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4440529">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440594">IsOnCurve</span><span class="op" id="4440603">(</span><span class="ident" id="4440604">x</span><span class="op" id="4440605">,</span>&nbsp;<span class="ident" id="4440607">y</span>&nbsp;<span class="op" id="4440609">*</span><span class="ident" id="4440610"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4440613">.</span><span class="ident" id="4440614">Int</span><span class="op" id="4440617">)</span>&nbsp;<span class="builtintype" id="4440619">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4440625">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440672">Add</span><span class="op" id="4440675">(</span><span class="ident" id="4440676">x1</span><span class="op" id="4440678">,</span>&nbsp;<span class="ident" id="4440680">y1</span><span class="op" id="4440682">,</span>&nbsp;<span class="ident" id="4440684">x2</span><span class="op" id="4440686">,</span>&nbsp;<span class="ident" id="4440688">y2</span>&nbsp;<span class="op" id="4440691">*</span><span class="ident" id="4440692"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4440695">.</span><span class="ident" id="4440696">Int</span><span class="op" id="4440699">)</span>&nbsp;<span class="op" id="4440701">(</span><span class="ident" id="4440702">x</span><span class="op" id="4440703">,</span>&nbsp;<span class="ident" id="4440705">y</span>&nbsp;<span class="op" id="4440707">*</span><span class="ident" id="4440708"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4440711">.</span><span class="ident" id="4440712">Int</span><span class="op" id="4440715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4440718">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440745">Double</span><span class="op" id="4440751">(</span><span class="ident" id="4440752">x1</span><span class="op" id="4440754">,</span>&nbsp;<span class="ident" id="4440756">y1</span>&nbsp;<span class="op" id="4440759">*</span><span class="ident" id="4440760"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4440763">.</span><span class="ident" id="4440764">Int</span><span class="op" id="4440767">)</span>&nbsp;<span class="op" id="4440769">(</span><span class="ident" id="4440770">x</span><span class="op" id="4440771">,</span>&nbsp;<span class="ident" id="4440773">y</span>&nbsp;<span class="op" id="4440775">*</span><span class="ident" id="4440776"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4440779">.</span><span class="ident" id="4440780">Int</span><span class="op" id="4440783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4440786">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440859">ScalarMult</span><span class="op" id="4440869">(</span><span class="ident" id="4440870">x1</span><span class="op" id="4440872">,</span>&nbsp;<span class="ident" id="4440874">y1</span>&nbsp;<span class="op" id="4440877">*</span><span class="ident" id="4440878"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4440881">.</span><span class="ident" id="4440882">Int</span><span class="op" id="4440885">,</span>&nbsp;<span class="ident" id="4440887">k</span>&nbsp;<span class="op" id="4440889">[</span><span class="op" id="4440890">]</span><span class="builtintype" id="4440891">byte</span><span class="op" id="4440895">)</span>&nbsp;<span class="op" id="4440897">(</span><span class="ident" id="4440898">x</span><span class="op" id="4440899">,</span>&nbsp;<span class="ident" id="4440901">y</span>&nbsp;<span class="op" id="4440903">*</span><span class="ident" id="4440904"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4440907">.</span><span class="ident" id="4440908">Int</span><span class="op" id="4440911">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4440914">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4440985">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441029">ScalarBaseMult</span><span class="op" id="4441043">(</span><span class="ident" id="4441044">k</span>&nbsp;<span class="op" id="4441046">[</span><span class="op" id="4441047">]</span><span class="builtintype" id="4441048">byte</span><span class="op" id="4441052">)</span>&nbsp;<span class="op" id="4441054">(</span><span class="ident" id="4441055">x</span><span class="op" id="4441056">,</span>&nbsp;<span class="ident" id="4441058">y</span>&nbsp;<span class="op" id="4441060">*</span><span class="ident" id="4441061"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4441064">.</span><span class="ident" id="4441065">Int</span><span class="op" id="4441068">)</span><br>
<span class="lineno"></span><span class="op" id="4441070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4441073">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="4441151">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="4441208">type</span>&nbsp;<span class="ident" id="4441213">CurveParams</span>&nbsp;<span class="keyword" id="4441225">struct</span>&nbsp;<span class="op" id="4441232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441235">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4441243">*</span><span class="ident" id="4441244"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4441247">.</span><span class="ident" id="4441248">Int</span>&nbsp;<span class="comment" id="4441252">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441290">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4441298">*</span><span class="ident" id="4441299"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4441302">.</span><span class="ident" id="4441303">Int</span>&nbsp;<span class="comment" id="4441307">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441339">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4441347">*</span><span class="ident" id="4441348"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4441351">.</span><span class="ident" id="4441352">Int</span>&nbsp;<span class="comment" id="4441356">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441395">Gx</span><span class="op" id="4441397">,</span>&nbsp;<span class="ident" id="4441399">Gy</span>&nbsp;&nbsp;<span class="op" id="4441403">*</span><span class="ident" id="4441404"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4441407">.</span><span class="ident" id="4441408">Int</span>&nbsp;<span class="comment" id="4441412">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441440">BitSize</span>&nbsp;<span class="builtintype" id="4441448">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4441457">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="4441493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4441496">func</span>&nbsp;<span class="op" id="4441501">(</span><span class="ident" id="4441502">curve</span>&nbsp;<span class="op" id="4441508">*</span><span class="ident" id="4441509"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><span class="op" id="4441520">)</span>&nbsp;<span class="ident" id="4441522">Params</span><span class="op" id="4441528">(</span><span class="op" id="4441529">)</span>&nbsp;<span class="op" id="4441531">*</span><span class="ident" id="4441532"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span>&nbsp;<span class="op" id="4441544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441547">return</span>&nbsp;<span class="ident" id="4441554"><a href="/crypto/elliptic/elliptic.go.html#4441502">curve</a></span><br>
<span class="lineno"></span><span class="op" id="4441560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4441563">func</span>&nbsp;<span class="op" id="4441568">(</span><span class="ident" id="4441569">curve</span>&nbsp;<span class="op" id="4441575">*</span><span class="ident" id="4441576"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><span class="op" id="4441587">)</span>&nbsp;<span class="ident" id="4441589">IsOnCurve</span><span class="op" id="4441598">(</span><span class="ident" id="4441599">x</span><span class="op" id="4441600">,</span>&nbsp;<span class="ident" id="4441602">y</span>&nbsp;<span class="op" id="4441604">*</span><span class="ident" id="4441605"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4441608">.</span><span class="ident" id="4441609">Int</span><span class="op" id="4441612">)</span>&nbsp;<span class="builtintype" id="4441614">bool</span>&nbsp;<span class="op" id="4441619">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4441622">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441645">y2</span>&nbsp;<span class="op" id="4441648">:=</span>&nbsp;<span class="builtinfunc" id="4441651">new</span><span class="op" id="4441654">(</span><span class="ident" id="4441655"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4441658">.</span><span class="ident" id="4441659">Int</span><span class="op" id="4441662">)</span><span class="op" id="4441663">.</span><span class="ident" id="4441664">Mul</span><span class="op" id="4441667">(</span><span class="ident" id="4441668"><a href="/crypto/elliptic/elliptic.go.html#4441602">y</a></span><span class="op" id="4441669">,</span>&nbsp;<span class="ident" id="4441671"><a href="/crypto/elliptic/elliptic.go.html#4441602">y</a></span><span class="op" id="4441672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441675"><a href="/crypto/elliptic/elliptic.go.html#4441645">y2</a></span><span class="op" id="4441677">.</span><span class="ident" id="4441678">Mod</span><span class="op" id="4441681">(</span><span class="ident" id="4441682"><a href="/crypto/elliptic/elliptic.go.html#4441645">y2</a></span><span class="op" id="4441684">,</span>&nbsp;<span class="ident" id="4441686"><a href="/crypto/elliptic/elliptic.go.html#4441569">curve</a></span><span class="op" id="4441691">.</span><span class="ident" id="4441692">P</span><span class="op" id="4441693">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441697">x3</span>&nbsp;<span class="op" id="4441700">:=</span>&nbsp;<span class="builtinfunc" id="4441703">new</span><span class="op" id="4441706">(</span><span class="ident" id="4441707"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4441710">.</span><span class="ident" id="4441711">Int</span><span class="op" id="4441714">)</span><span class="op" id="4441715">.</span><span class="ident" id="4441716">Mul</span><span class="op" id="4441719">(</span><span class="ident" id="4441720"><a href="/crypto/elliptic/elliptic.go.html#4441599">x</a></span><span class="op" id="4441721">,</span>&nbsp;<span class="ident" id="4441723"><a href="/crypto/elliptic/elliptic.go.html#4441599">x</a></span><span class="op" id="4441724">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441727"><a href="/crypto/elliptic/elliptic.go.html#4441697">x3</a></span><span class="op" id="4441729">.</span><span class="ident" id="4441730">Mul</span><span class="op" id="4441733">(</span><span class="ident" id="4441734"><a href="/crypto/elliptic/elliptic.go.html#4441697">x3</a></span><span class="op" id="4441736">,</span>&nbsp;<span class="ident" id="4441738"><a href="/crypto/elliptic/elliptic.go.html#4441599">x</a></span><span class="op" id="4441739">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441743">threeX</span>&nbsp;<span class="op" id="4441750">:=</span>&nbsp;<span class="builtinfunc" id="4441753">new</span><span class="op" id="4441756">(</span><span class="ident" id="4441757"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4441760">.</span><span class="ident" id="4441761">Int</span><span class="op" id="4441764">)</span><span class="op" id="4441765">.</span><span class="ident" id="4441766">Lsh</span><span class="op" id="4441769">(</span><span class="ident" id="4441770"><a href="/crypto/elliptic/elliptic.go.html#4441599">x</a></span><span class="op" id="4441771">,</span>&nbsp;<span class="num" id="4441773">1</span><span class="op" id="4441774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441777"><a href="/crypto/elliptic/elliptic.go.html#4441743">threeX</a></span><span class="op" id="4441783">.</span><span class="ident" id="4441784">Add</span><span class="op" id="4441787">(</span><span class="ident" id="4441788"><a href="/crypto/elliptic/elliptic.go.html#4441743">threeX</a></span><span class="op" id="4441794">,</span>&nbsp;<span class="ident" id="4441796"><a href="/crypto/elliptic/elliptic.go.html#4441599">x</a></span><span class="op" id="4441797">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441801"><a href="/crypto/elliptic/elliptic.go.html#4441697">x3</a></span><span class="op" id="4441803">.</span><span class="ident" id="4441804">Sub</span><span class="op" id="4441807">(</span><span class="ident" id="4441808"><a href="/crypto/elliptic/elliptic.go.html#4441697">x3</a></span><span class="op" id="4441810">,</span>&nbsp;<span class="ident" id="4441812"><a href="/crypto/elliptic/elliptic.go.html#4441743">threeX</a></span><span class="op" id="4441818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441821"><a href="/crypto/elliptic/elliptic.go.html#4441697">x3</a></span><span class="op" id="4441823">.</span><span class="ident" id="4441824">Add</span><span class="op" id="4441827">(</span><span class="ident" id="4441828"><a href="/crypto/elliptic/elliptic.go.html#4441697">x3</a></span><span class="op" id="4441830">,</span>&nbsp;<span class="ident" id="4441832"><a href="/crypto/elliptic/elliptic.go.html#4441569">curve</a></span><span class="op" id="4441837">.</span><span class="ident" id="4441838">B</span><span class="op" id="4441839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441842"><a href="/crypto/elliptic/elliptic.go.html#4441697">x3</a></span><span class="op" id="4441844">.</span><span class="ident" id="4441845">Mod</span><span class="op" id="4441848">(</span><span class="ident" id="4441849"><a href="/crypto/elliptic/elliptic.go.html#4441697">x3</a></span><span class="op" id="4441851">,</span>&nbsp;<span class="ident" id="4441853"><a href="/crypto/elliptic/elliptic.go.html#4441569">curve</a></span><span class="op" id="4441858">.</span><span class="ident" id="4441859">P</span><span class="op" id="4441860">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441864">return</span>&nbsp;<span class="ident" id="4441871"><a href="/crypto/elliptic/elliptic.go.html#4441697">x3</a></span><span class="op" id="4441873">.</span><span class="ident" id="4441874">Cmp</span><span class="op" id="4441877">(</span><span class="ident" id="4441878"><a href="/crypto/elliptic/elliptic.go.html#4441645">y2</a></span><span class="op" id="4441880">)</span>&nbsp;<span class="op" id="4441882">==</span>&nbsp;<span class="num" id="4441885">0</span><br>
<span class="lineno">70</span><span class="op" id="4441887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4441890">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4441969">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="4442049">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="4442101">func</span>&nbsp;<span class="ident" id="4442106">zForAffine</span><span class="op" id="4442116">(</span><span class="ident" id="4442117">x</span><span class="op" id="4442118">,</span>&nbsp;<span class="ident" id="4442120">y</span>&nbsp;<span class="op" id="4442122">*</span><span class="ident" id="4442123"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442126">.</span><span class="ident" id="4442127">Int</span><span class="op" id="4442130">)</span>&nbsp;<span class="op" id="4442132">*</span><span class="ident" id="4442133"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442136">.</span><span class="ident" id="4442137">Int</span>&nbsp;<span class="op" id="4442141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442144">z</span>&nbsp;<span class="op" id="4442146">:=</span>&nbsp;<span class="builtinfunc" id="4442149">new</span><span class="op" id="4442152">(</span><span class="ident" id="4442153"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442156">.</span><span class="ident" id="4442157">Int</span><span class="op" id="4442160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442163">if</span>&nbsp;<span class="ident" id="4442166"><a href="/crypto/elliptic/elliptic.go.html#4442117">x</a></span><span class="op" id="4442167">.</span><span class="ident" id="4442168">Sign</span><span class="op" id="4442172">(</span><span class="op" id="4442173">)</span>&nbsp;<span class="op" id="4442175">!=</span>&nbsp;<span class="num" id="4442178">0</span>&nbsp;<span class="op" id="4442180">||</span>&nbsp;<span class="ident" id="4442183"><a href="/crypto/elliptic/elliptic.go.html#4442120">y</a></span><span class="op" id="4442184">.</span><span class="ident" id="4442185">Sign</span><span class="op" id="4442189">(</span><span class="op" id="4442190">)</span>&nbsp;<span class="op" id="4442192">!=</span>&nbsp;<span class="num" id="4442195">0</span>&nbsp;<span class="op" id="4442197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442201"><a href="/crypto/elliptic/elliptic.go.html#4442144">z</a></span><span class="op" id="4442202">.</span><span class="ident" id="4442203">SetInt64</span><span class="op" id="4442211">(</span><span class="num" id="4442212">1</span><span class="op" id="4442213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442216">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442219">return</span>&nbsp;<span class="ident" id="4442226"><a href="/crypto/elliptic/elliptic.go.html#4442144">z</a></span><br>
<span class="lineno"></span><span class="op" id="4442228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4442231">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4442309">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="4442366">func</span>&nbsp;<span class="op" id="4442371">(</span><span class="ident" id="4442372">curve</span>&nbsp;<span class="op" id="4442378">*</span><span class="ident" id="4442379"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><span class="op" id="4442390">)</span>&nbsp;<span class="ident" id="4442392">affineFromJacobian</span><span class="op" id="4442410">(</span><span class="ident" id="4442411">x</span><span class="op" id="4442412">,</span>&nbsp;<span class="ident" id="4442414">y</span><span class="op" id="4442415">,</span>&nbsp;<span class="ident" id="4442417">z</span>&nbsp;<span class="op" id="4442419">*</span><span class="ident" id="4442420"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442423">.</span><span class="ident" id="4442424">Int</span><span class="op" id="4442427">)</span>&nbsp;<span class="op" id="4442429">(</span><span class="ident" id="4442430">xOut</span><span class="op" id="4442434">,</span>&nbsp;<span class="ident" id="4442436">yOut</span>&nbsp;<span class="op" id="4442441">*</span><span class="ident" id="4442442"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442445">.</span><span class="ident" id="4442446">Int</span><span class="op" id="4442449">)</span>&nbsp;<span class="op" id="4442451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442454">if</span>&nbsp;<span class="ident" id="4442457"><a href="/crypto/elliptic/elliptic.go.html#4442417">z</a></span><span class="op" id="4442458">.</span><span class="ident" id="4442459">Sign</span><span class="op" id="4442463">(</span><span class="op" id="4442464">)</span>&nbsp;<span class="op" id="4442466">==</span>&nbsp;<span class="num" id="4442469">0</span>&nbsp;<span class="op" id="4442471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442475">return</span>&nbsp;<span class="builtinfunc" id="4442482">new</span><span class="op" id="4442485">(</span><span class="ident" id="4442486"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442489">.</span><span class="ident" id="4442490">Int</span><span class="op" id="4442493">)</span><span class="op" id="4442494">,</span>&nbsp;<span class="builtinfunc" id="4442496">new</span><span class="op" id="4442499">(</span><span class="ident" id="4442500"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442503">.</span><span class="ident" id="4442504">Int</span><span class="op" id="4442507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442514">zinv</span>&nbsp;<span class="op" id="4442519">:=</span>&nbsp;<span class="builtinfunc" id="4442522">new</span><span class="op" id="4442525">(</span><span class="ident" id="4442526"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442529">.</span><span class="ident" id="4442530">Int</span><span class="op" id="4442533">)</span><span class="op" id="4442534">.</span><span class="ident" id="4442535">ModInverse</span><span class="op" id="4442545">(</span><span class="ident" id="4442546"><a href="/crypto/elliptic/elliptic.go.html#4442417">z</a></span><span class="op" id="4442547">,</span>&nbsp;<span class="ident" id="4442549"><a href="/crypto/elliptic/elliptic.go.html#4442372">curve</a></span><span class="op" id="4442554">.</span><span class="ident" id="4442555">P</span><span class="op" id="4442556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442559">zinvsq</span>&nbsp;<span class="op" id="4442566">:=</span>&nbsp;<span class="builtinfunc" id="4442569">new</span><span class="op" id="4442572">(</span><span class="ident" id="4442573"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442576">.</span><span class="ident" id="4442577">Int</span><span class="op" id="4442580">)</span><span class="op" id="4442581">.</span><span class="ident" id="4442582">Mul</span><span class="op" id="4442585">(</span><span class="ident" id="4442586"><a href="/crypto/elliptic/elliptic.go.html#4442514">zinv</a></span><span class="op" id="4442590">,</span>&nbsp;<span class="ident" id="4442592"><a href="/crypto/elliptic/elliptic.go.html#4442514">zinv</a></span><span class="op" id="4442596">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442600"><a href="/crypto/elliptic/elliptic.go.html#4442430">xOut</a></span>&nbsp;<span class="op" id="4442605">=</span>&nbsp;<span class="builtinfunc" id="4442607">new</span><span class="op" id="4442610">(</span><span class="ident" id="4442611"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442614">.</span><span class="ident" id="4442615">Int</span><span class="op" id="4442618">)</span><span class="op" id="4442619">.</span><span class="ident" id="4442620">Mul</span><span class="op" id="4442623">(</span><span class="ident" id="4442624"><a href="/crypto/elliptic/elliptic.go.html#4442411">x</a></span><span class="op" id="4442625">,</span>&nbsp;<span class="ident" id="4442627"><a href="/crypto/elliptic/elliptic.go.html#4442559">zinvsq</a></span><span class="op" id="4442633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442636"><a href="/crypto/elliptic/elliptic.go.html#4442430">xOut</a></span><span class="op" id="4442640">.</span><span class="ident" id="4442641">Mod</span><span class="op" id="4442644">(</span><span class="ident" id="4442645"><a href="/crypto/elliptic/elliptic.go.html#4442430">xOut</a></span><span class="op" id="4442649">,</span>&nbsp;<span class="ident" id="4442651"><a href="/crypto/elliptic/elliptic.go.html#4442372">curve</a></span><span class="op" id="4442656">.</span><span class="ident" id="4442657">P</span><span class="op" id="4442658">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442661"><a href="/crypto/elliptic/elliptic.go.html#4442559">zinvsq</a></span><span class="op" id="4442667">.</span><span class="ident" id="4442668">Mul</span><span class="op" id="4442671">(</span><span class="ident" id="4442672"><a href="/crypto/elliptic/elliptic.go.html#4442559">zinvsq</a></span><span class="op" id="4442678">,</span>&nbsp;<span class="ident" id="4442680"><a href="/crypto/elliptic/elliptic.go.html#4442514">zinv</a></span><span class="op" id="4442684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442687"><a href="/crypto/elliptic/elliptic.go.html#4442436">yOut</a></span>&nbsp;<span class="op" id="4442692">=</span>&nbsp;<span class="builtinfunc" id="4442694">new</span><span class="op" id="4442697">(</span><span class="ident" id="4442698"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442701">.</span><span class="ident" id="4442702">Int</span><span class="op" id="4442705">)</span><span class="op" id="4442706">.</span><span class="ident" id="4442707">Mul</span><span class="op" id="4442710">(</span><span class="ident" id="4442711"><a href="/crypto/elliptic/elliptic.go.html#4442414">y</a></span><span class="op" id="4442712">,</span>&nbsp;<span class="ident" id="4442714"><a href="/crypto/elliptic/elliptic.go.html#4442559">zinvsq</a></span><span class="op" id="4442720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442723"><a href="/crypto/elliptic/elliptic.go.html#4442436">yOut</a></span><span class="op" id="4442727">.</span><span class="ident" id="4442728">Mod</span><span class="op" id="4442731">(</span><span class="ident" id="4442732"><a href="/crypto/elliptic/elliptic.go.html#4442436">yOut</a></span><span class="op" id="4442736">,</span>&nbsp;<span class="ident" id="4442738"><a href="/crypto/elliptic/elliptic.go.html#4442372">curve</a></span><span class="op" id="4442743">.</span><span class="ident" id="4442744">P</span><span class="op" id="4442745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442748">return</span><br>
<span class="lineno"></span><span class="op" id="4442755">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4442758">func</span>&nbsp;<span class="op" id="4442763">(</span><span class="ident" id="4442764">curve</span>&nbsp;<span class="op" id="4442770">*</span><span class="ident" id="4442771"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><span class="op" id="4442782">)</span>&nbsp;<span class="ident" id="4442784">Add</span><span class="op" id="4442787">(</span><span class="ident" id="4442788">x1</span><span class="op" id="4442790">,</span>&nbsp;<span class="ident" id="4442792">y1</span><span class="op" id="4442794">,</span>&nbsp;<span class="ident" id="4442796">x2</span><span class="op" id="4442798">,</span>&nbsp;<span class="ident" id="4442800">y2</span>&nbsp;<span class="op" id="4442803">*</span><span class="ident" id="4442804"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442807">.</span><span class="ident" id="4442808">Int</span><span class="op" id="4442811">)</span>&nbsp;<span class="op" id="4442813">(</span><span class="op" id="4442814">*</span><span class="ident" id="4442815"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442818">.</span><span class="ident" id="4442819">Int</span><span class="op" id="4442822">,</span>&nbsp;<span class="op" id="4442824">*</span><span class="ident" id="4442825"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4442828">.</span><span class="ident" id="4442829">Int</span><span class="op" id="4442832">)</span>&nbsp;<span class="op" id="4442834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442837">z1</span>&nbsp;<span class="op" id="4442840">:=</span>&nbsp;<span class="ident" id="4442843"><a href="/crypto/elliptic/elliptic.go.html#4442106">zForAffine</a></span><span class="op" id="4442853">(</span><span class="ident" id="4442854"><a href="/crypto/elliptic/elliptic.go.html#4442788">x1</a></span><span class="op" id="4442856">,</span>&nbsp;<span class="ident" id="4442858"><a href="/crypto/elliptic/elliptic.go.html#4442792">y1</a></span><span class="op" id="4442860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442863">z2</span>&nbsp;<span class="op" id="4442866">:=</span>&nbsp;<span class="ident" id="4442869"><a href="/crypto/elliptic/elliptic.go.html#4442106">zForAffine</a></span><span class="op" id="4442879">(</span><span class="ident" id="4442880"><a href="/crypto/elliptic/elliptic.go.html#4442796">x2</a></span><span class="op" id="4442882">,</span>&nbsp;<span class="ident" id="4442884"><a href="/crypto/elliptic/elliptic.go.html#4442800">y2</a></span><span class="op" id="4442886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442889">return</span>&nbsp;<span class="ident" id="4442896"><a href="/crypto/elliptic/elliptic.go.html#4442764">curve</a></span><span class="op" id="4442901">.</span><span class="ident" id="4442902">affineFromJacobian</span><span class="op" id="4442920">(</span><span class="ident" id="4442921"><a href="/crypto/elliptic/elliptic.go.html#4442764">curve</a></span><span class="op" id="4442926">.</span><span class="ident" id="4442927">addJacobian</span><span class="op" id="4442938">(</span><span class="ident" id="4442939"><a href="/crypto/elliptic/elliptic.go.html#4442788">x1</a></span><span class="op" id="4442941">,</span>&nbsp;<span class="ident" id="4442943"><a href="/crypto/elliptic/elliptic.go.html#4442792">y1</a></span><span class="op" id="4442945">,</span>&nbsp;<span class="ident" id="4442947"><a href="/crypto/elliptic/elliptic.go.html#4442837">z1</a></span><span class="op" id="4442949">,</span>&nbsp;<span class="ident" id="4442951"><a href="/crypto/elliptic/elliptic.go.html#4442796">x2</a></span><span class="op" id="4442953">,</span>&nbsp;<span class="ident" id="4442955"><a href="/crypto/elliptic/elliptic.go.html#4442800">y2</a></span><span class="op" id="4442957">,</span>&nbsp;<span class="ident" id="4442959"><a href="/crypto/elliptic/elliptic.go.html#4442863">z2</a></span><span class="op" id="4442961">)</span><span class="op" id="4442962">)</span><br>
<span class="lineno">105</span><span class="op" id="4442964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4442967">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4443041">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4443103">func</span>&nbsp;<span class="op" id="4443108">(</span><span class="ident" id="4443109">curve</span>&nbsp;<span class="op" id="4443115">*</span><span class="ident" id="4443116"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><span class="op" id="4443127">)</span>&nbsp;<span class="ident" id="4443129">addJacobian</span><span class="op" id="4443140">(</span><span class="ident" id="4443141">x1</span><span class="op" id="4443143">,</span>&nbsp;<span class="ident" id="4443145">y1</span><span class="op" id="4443147">,</span>&nbsp;<span class="ident" id="4443149">z1</span><span class="op" id="4443151">,</span>&nbsp;<span class="ident" id="4443153">x2</span><span class="op" id="4443155">,</span>&nbsp;<span class="ident" id="4443157">y2</span><span class="op" id="4443159">,</span>&nbsp;<span class="ident" id="4443161">z2</span>&nbsp;<span class="op" id="4443164">*</span><span class="ident" id="4443165"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443168">.</span><span class="ident" id="4443169">Int</span><span class="op" id="4443172">)</span>&nbsp;<span class="op" id="4443174">(</span><span class="op" id="4443175">*</span><span class="ident" id="4443176"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443179">.</span><span class="ident" id="4443180">Int</span><span class="op" id="4443183">,</span>&nbsp;<span class="op" id="4443185">*</span><span class="ident" id="4443186"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443189">.</span><span class="ident" id="4443190">Int</span><span class="op" id="4443193">,</span>&nbsp;<span class="op" id="4443195">*</span><span class="ident" id="4443196"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443199">.</span><span class="ident" id="4443200">Int</span><span class="op" id="4443203">)</span>&nbsp;<span class="op" id="4443205">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4443208">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443298">x3</span><span class="op" id="4443300">,</span>&nbsp;<span class="ident" id="4443302">y3</span><span class="op" id="4443304">,</span>&nbsp;<span class="ident" id="4443306">z3</span>&nbsp;<span class="op" id="4443309">:=</span>&nbsp;<span class="builtinfunc" id="4443312">new</span><span class="op" id="4443315">(</span><span class="ident" id="4443316"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443319">.</span><span class="ident" id="4443320">Int</span><span class="op" id="4443323">)</span><span class="op" id="4443324">,</span>&nbsp;<span class="builtinfunc" id="4443326">new</span><span class="op" id="4443329">(</span><span class="ident" id="4443330"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443333">.</span><span class="ident" id="4443334">Int</span><span class="op" id="4443337">)</span><span class="op" id="4443338">,</span>&nbsp;<span class="builtinfunc" id="4443340">new</span><span class="op" id="4443343">(</span><span class="ident" id="4443344"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443347">.</span><span class="ident" id="4443348">Int</span><span class="op" id="4443351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443354">if</span>&nbsp;<span class="ident" id="4443357"><a href="/crypto/elliptic/elliptic.go.html#4443149">z1</a></span><span class="op" id="4443359">.</span><span class="ident" id="4443360">Sign</span><span class="op" id="4443364">(</span><span class="op" id="4443365">)</span>&nbsp;<span class="op" id="4443367">==</span>&nbsp;<span class="num" id="4443370">0</span>&nbsp;<span class="op" id="4443372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443376"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4443378">.</span><span class="ident" id="4443379">Set</span><span class="op" id="4443382">(</span><span class="ident" id="4443383"><a href="/crypto/elliptic/elliptic.go.html#4443153">x2</a></span><span class="op" id="4443385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443389"><a href="/crypto/elliptic/elliptic.go.html#4443302">y3</a></span><span class="op" id="4443391">.</span><span class="ident" id="4443392">Set</span><span class="op" id="4443395">(</span><span class="ident" id="4443396"><a href="/crypto/elliptic/elliptic.go.html#4443157">y2</a></span><span class="op" id="4443398">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443402"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4443404">.</span><span class="ident" id="4443405">Set</span><span class="op" id="4443408">(</span><span class="ident" id="4443409"><a href="/crypto/elliptic/elliptic.go.html#4443161">z2</a></span><span class="op" id="4443411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443415">return</span>&nbsp;<span class="ident" id="4443422"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4443424">,</span>&nbsp;<span class="ident" id="4443426"><a href="/crypto/elliptic/elliptic.go.html#4443302">y3</a></span><span class="op" id="4443428">,</span>&nbsp;<span class="ident" id="4443430"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443437">if</span>&nbsp;<span class="ident" id="4443440"><a href="/crypto/elliptic/elliptic.go.html#4443161">z2</a></span><span class="op" id="4443442">.</span><span class="ident" id="4443443">Sign</span><span class="op" id="4443447">(</span><span class="op" id="4443448">)</span>&nbsp;<span class="op" id="4443450">==</span>&nbsp;<span class="num" id="4443453">0</span>&nbsp;<span class="op" id="4443455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443459"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4443461">.</span><span class="ident" id="4443462">Set</span><span class="op" id="4443465">(</span><span class="ident" id="4443466"><a href="/crypto/elliptic/elliptic.go.html#4443141">x1</a></span><span class="op" id="4443468">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443472"><a href="/crypto/elliptic/elliptic.go.html#4443302">y3</a></span><span class="op" id="4443474">.</span><span class="ident" id="4443475">Set</span><span class="op" id="4443478">(</span><span class="ident" id="4443479"><a href="/crypto/elliptic/elliptic.go.html#4443145">y1</a></span><span class="op" id="4443481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443485"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4443487">.</span><span class="ident" id="4443488">Set</span><span class="op" id="4443491">(</span><span class="ident" id="4443492"><a href="/crypto/elliptic/elliptic.go.html#4443149">z1</a></span><span class="op" id="4443494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443498">return</span>&nbsp;<span class="ident" id="4443505"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4443507">,</span>&nbsp;<span class="ident" id="4443509"><a href="/crypto/elliptic/elliptic.go.html#4443302">y3</a></span><span class="op" id="4443511">,</span>&nbsp;<span class="ident" id="4443513"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443521">z1z1</span>&nbsp;<span class="op" id="4443526">:=</span>&nbsp;<span class="builtinfunc" id="4443529">new</span><span class="op" id="4443532">(</span><span class="ident" id="4443533"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443536">.</span><span class="ident" id="4443537">Int</span><span class="op" id="4443540">)</span><span class="op" id="4443541">.</span><span class="ident" id="4443542">Mul</span><span class="op" id="4443545">(</span><span class="ident" id="4443546"><a href="/crypto/elliptic/elliptic.go.html#4443149">z1</a></span><span class="op" id="4443548">,</span>&nbsp;<span class="ident" id="4443550"><a href="/crypto/elliptic/elliptic.go.html#4443149">z1</a></span><span class="op" id="4443552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443555"><a href="/crypto/elliptic/elliptic.go.html#4443521">z1z1</a></span><span class="op" id="4443559">.</span><span class="ident" id="4443560">Mod</span><span class="op" id="4443563">(</span><span class="ident" id="4443564"><a href="/crypto/elliptic/elliptic.go.html#4443521">z1z1</a></span><span class="op" id="4443568">,</span>&nbsp;<span class="ident" id="4443570"><a href="/crypto/elliptic/elliptic.go.html#4443109">curve</a></span><span class="op" id="4443575">.</span><span class="ident" id="4443576">P</span><span class="op" id="4443577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443580">z2z2</span>&nbsp;<span class="op" id="4443585">:=</span>&nbsp;<span class="builtinfunc" id="4443588">new</span><span class="op" id="4443591">(</span><span class="ident" id="4443592"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443595">.</span><span class="ident" id="4443596">Int</span><span class="op" id="4443599">)</span><span class="op" id="4443600">.</span><span class="ident" id="4443601">Mul</span><span class="op" id="4443604">(</span><span class="ident" id="4443605"><a href="/crypto/elliptic/elliptic.go.html#4443161">z2</a></span><span class="op" id="4443607">,</span>&nbsp;<span class="ident" id="4443609"><a href="/crypto/elliptic/elliptic.go.html#4443161">z2</a></span><span class="op" id="4443611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443614"><a href="/crypto/elliptic/elliptic.go.html#4443580">z2z2</a></span><span class="op" id="4443618">.</span><span class="ident" id="4443619">Mod</span><span class="op" id="4443622">(</span><span class="ident" id="4443623"><a href="/crypto/elliptic/elliptic.go.html#4443580">z2z2</a></span><span class="op" id="4443627">,</span>&nbsp;<span class="ident" id="4443629"><a href="/crypto/elliptic/elliptic.go.html#4443109">curve</a></span><span class="op" id="4443634">.</span><span class="ident" id="4443635">P</span><span class="op" id="4443636">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443640">u1</span>&nbsp;<span class="op" id="4443643">:=</span>&nbsp;<span class="builtinfunc" id="4443646">new</span><span class="op" id="4443649">(</span><span class="ident" id="4443650"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443653">.</span><span class="ident" id="4443654">Int</span><span class="op" id="4443657">)</span><span class="op" id="4443658">.</span><span class="ident" id="4443659">Mul</span><span class="op" id="4443662">(</span><span class="ident" id="4443663"><a href="/crypto/elliptic/elliptic.go.html#4443141">x1</a></span><span class="op" id="4443665">,</span>&nbsp;<span class="ident" id="4443667"><a href="/crypto/elliptic/elliptic.go.html#4443580">z2z2</a></span><span class="op" id="4443671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443674"><a href="/crypto/elliptic/elliptic.go.html#4443640">u1</a></span><span class="op" id="4443676">.</span><span class="ident" id="4443677">Mod</span><span class="op" id="4443680">(</span><span class="ident" id="4443681"><a href="/crypto/elliptic/elliptic.go.html#4443640">u1</a></span><span class="op" id="4443683">,</span>&nbsp;<span class="ident" id="4443685"><a href="/crypto/elliptic/elliptic.go.html#4443109">curve</a></span><span class="op" id="4443690">.</span><span class="ident" id="4443691">P</span><span class="op" id="4443692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443695">u2</span>&nbsp;<span class="op" id="4443698">:=</span>&nbsp;<span class="builtinfunc" id="4443701">new</span><span class="op" id="4443704">(</span><span class="ident" id="4443705"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443708">.</span><span class="ident" id="4443709">Int</span><span class="op" id="4443712">)</span><span class="op" id="4443713">.</span><span class="ident" id="4443714">Mul</span><span class="op" id="4443717">(</span><span class="ident" id="4443718"><a href="/crypto/elliptic/elliptic.go.html#4443153">x2</a></span><span class="op" id="4443720">,</span>&nbsp;<span class="ident" id="4443722"><a href="/crypto/elliptic/elliptic.go.html#4443521">z1z1</a></span><span class="op" id="4443726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443729"><a href="/crypto/elliptic/elliptic.go.html#4443695">u2</a></span><span class="op" id="4443731">.</span><span class="ident" id="4443732">Mod</span><span class="op" id="4443735">(</span><span class="ident" id="4443736"><a href="/crypto/elliptic/elliptic.go.html#4443695">u2</a></span><span class="op" id="4443738">,</span>&nbsp;<span class="ident" id="4443740"><a href="/crypto/elliptic/elliptic.go.html#4443109">curve</a></span><span class="op" id="4443745">.</span><span class="ident" id="4443746">P</span><span class="op" id="4443747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443750">h</span>&nbsp;<span class="op" id="4443752">:=</span>&nbsp;<span class="builtinfunc" id="4443755">new</span><span class="op" id="4443758">(</span><span class="ident" id="4443759"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443762">.</span><span class="ident" id="4443763">Int</span><span class="op" id="4443766">)</span><span class="op" id="4443767">.</span><span class="ident" id="4443768">Sub</span><span class="op" id="4443771">(</span><span class="ident" id="4443772"><a href="/crypto/elliptic/elliptic.go.html#4443695">u2</a></span><span class="op" id="4443774">,</span>&nbsp;<span class="ident" id="4443776"><a href="/crypto/elliptic/elliptic.go.html#4443640">u1</a></span><span class="op" id="4443778">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443781">xEqual</span>&nbsp;<span class="op" id="4443788">:=</span>&nbsp;<span class="ident" id="4443791"><a href="/crypto/elliptic/elliptic.go.html#4443750">h</a></span><span class="op" id="4443792">.</span><span class="ident" id="4443793">Sign</span><span class="op" id="4443797">(</span><span class="op" id="4443798">)</span>&nbsp;<span class="op" id="4443800">==</span>&nbsp;<span class="num" id="4443803">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443806">if</span>&nbsp;<span class="ident" id="4443809"><a href="/crypto/elliptic/elliptic.go.html#4443750">h</a></span><span class="op" id="4443810">.</span><span class="ident" id="4443811">Sign</span><span class="op" id="4443815">(</span><span class="op" id="4443816">)</span>&nbsp;<span class="op" id="4443818">==</span>&nbsp;<span class="op" id="4443821">-</span><span class="num" id="4443822">1</span>&nbsp;<span class="op" id="4443824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443828"><a href="/crypto/elliptic/elliptic.go.html#4443750">h</a></span><span class="op" id="4443829">.</span><span class="ident" id="4443830">Add</span><span class="op" id="4443833">(</span><span class="ident" id="4443834"><a href="/crypto/elliptic/elliptic.go.html#4443750">h</a></span><span class="op" id="4443835">,</span>&nbsp;<span class="ident" id="4443837"><a href="/crypto/elliptic/elliptic.go.html#4443109">curve</a></span><span class="op" id="4443842">.</span><span class="ident" id="4443843">P</span><span class="op" id="4443844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443850">i</span>&nbsp;<span class="op" id="4443852">:=</span>&nbsp;<span class="builtinfunc" id="4443855">new</span><span class="op" id="4443858">(</span><span class="ident" id="4443859"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443862">.</span><span class="ident" id="4443863">Int</span><span class="op" id="4443866">)</span><span class="op" id="4443867">.</span><span class="ident" id="4443868">Lsh</span><span class="op" id="4443871">(</span><span class="ident" id="4443872"><a href="/crypto/elliptic/elliptic.go.html#4443750">h</a></span><span class="op" id="4443873">,</span>&nbsp;<span class="num" id="4443875">1</span><span class="op" id="4443876">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443879"><a href="/crypto/elliptic/elliptic.go.html#4443850">i</a></span><span class="op" id="4443880">.</span><span class="ident" id="4443881">Mul</span><span class="op" id="4443884">(</span><span class="ident" id="4443885"><a href="/crypto/elliptic/elliptic.go.html#4443850">i</a></span><span class="op" id="4443886">,</span>&nbsp;<span class="ident" id="4443888"><a href="/crypto/elliptic/elliptic.go.html#4443850">i</a></span><span class="op" id="4443889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443892">j</span>&nbsp;<span class="op" id="4443894">:=</span>&nbsp;<span class="builtinfunc" id="4443897">new</span><span class="op" id="4443900">(</span><span class="ident" id="4443901"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443904">.</span><span class="ident" id="4443905">Int</span><span class="op" id="4443908">)</span><span class="op" id="4443909">.</span><span class="ident" id="4443910">Mul</span><span class="op" id="4443913">(</span><span class="ident" id="4443914"><a href="/crypto/elliptic/elliptic.go.html#4443750">h</a></span><span class="op" id="4443915">,</span>&nbsp;<span class="ident" id="4443917"><a href="/crypto/elliptic/elliptic.go.html#4443850">i</a></span><span class="op" id="4443918">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443922">s1</span>&nbsp;<span class="op" id="4443925">:=</span>&nbsp;<span class="builtinfunc" id="4443928">new</span><span class="op" id="4443931">(</span><span class="ident" id="4443932"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4443935">.</span><span class="ident" id="4443936">Int</span><span class="op" id="4443939">)</span><span class="op" id="4443940">.</span><span class="ident" id="4443941">Mul</span><span class="op" id="4443944">(</span><span class="ident" id="4443945"><a href="/crypto/elliptic/elliptic.go.html#4443145">y1</a></span><span class="op" id="4443947">,</span>&nbsp;<span class="ident" id="4443949"><a href="/crypto/elliptic/elliptic.go.html#4443161">z2</a></span><span class="op" id="4443951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443954"><a href="/crypto/elliptic/elliptic.go.html#4443922">s1</a></span><span class="op" id="4443956">.</span><span class="ident" id="4443957">Mul</span><span class="op" id="4443960">(</span><span class="ident" id="4443961"><a href="/crypto/elliptic/elliptic.go.html#4443922">s1</a></span><span class="op" id="4443963">,</span>&nbsp;<span class="ident" id="4443965"><a href="/crypto/elliptic/elliptic.go.html#4443580">z2z2</a></span><span class="op" id="4443969">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443972"><a href="/crypto/elliptic/elliptic.go.html#4443922">s1</a></span><span class="op" id="4443974">.</span><span class="ident" id="4443975">Mod</span><span class="op" id="4443978">(</span><span class="ident" id="4443979"><a href="/crypto/elliptic/elliptic.go.html#4443922">s1</a></span><span class="op" id="4443981">,</span>&nbsp;<span class="ident" id="4443983"><a href="/crypto/elliptic/elliptic.go.html#4443109">curve</a></span><span class="op" id="4443988">.</span><span class="ident" id="4443989">P</span><span class="op" id="4443990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443993">s2</span>&nbsp;<span class="op" id="4443996">:=</span>&nbsp;<span class="builtinfunc" id="4443999">new</span><span class="op" id="4444002">(</span><span class="ident" id="4444003"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4444006">.</span><span class="ident" id="4444007">Int</span><span class="op" id="4444010">)</span><span class="op" id="4444011">.</span><span class="ident" id="4444012">Mul</span><span class="op" id="4444015">(</span><span class="ident" id="4444016"><a href="/crypto/elliptic/elliptic.go.html#4443157">y2</a></span><span class="op" id="4444018">,</span>&nbsp;<span class="ident" id="4444020"><a href="/crypto/elliptic/elliptic.go.html#4443149">z1</a></span><span class="op" id="4444022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444025"><a href="/crypto/elliptic/elliptic.go.html#4443993">s2</a></span><span class="op" id="4444027">.</span><span class="ident" id="4444028">Mul</span><span class="op" id="4444031">(</span><span class="ident" id="4444032"><a href="/crypto/elliptic/elliptic.go.html#4443993">s2</a></span><span class="op" id="4444034">,</span>&nbsp;<span class="ident" id="4444036"><a href="/crypto/elliptic/elliptic.go.html#4443521">z1z1</a></span><span class="op" id="4444040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444043"><a href="/crypto/elliptic/elliptic.go.html#4443993">s2</a></span><span class="op" id="4444045">.</span><span class="ident" id="4444046">Mod</span><span class="op" id="4444049">(</span><span class="ident" id="4444050"><a href="/crypto/elliptic/elliptic.go.html#4443993">s2</a></span><span class="op" id="4444052">,</span>&nbsp;<span class="ident" id="4444054"><a href="/crypto/elliptic/elliptic.go.html#4443109">curve</a></span><span class="op" id="4444059">.</span><span class="ident" id="4444060">P</span><span class="op" id="4444061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444064">r</span>&nbsp;<span class="op" id="4444066">:=</span>&nbsp;<span class="builtinfunc" id="4444069">new</span><span class="op" id="4444072">(</span><span class="ident" id="4444073"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4444076">.</span><span class="ident" id="4444077">Int</span><span class="op" id="4444080">)</span><span class="op" id="4444081">.</span><span class="ident" id="4444082">Sub</span><span class="op" id="4444085">(</span><span class="ident" id="4444086"><a href="/crypto/elliptic/elliptic.go.html#4443993">s2</a></span><span class="op" id="4444088">,</span>&nbsp;<span class="ident" id="4444090"><a href="/crypto/elliptic/elliptic.go.html#4443922">s1</a></span><span class="op" id="4444092">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444095">if</span>&nbsp;<span class="ident" id="4444098"><a href="/crypto/elliptic/elliptic.go.html#4444064">r</a></span><span class="op" id="4444099">.</span><span class="ident" id="4444100">Sign</span><span class="op" id="4444104">(</span><span class="op" id="4444105">)</span>&nbsp;<span class="op" id="4444107">==</span>&nbsp;<span class="op" id="4444110">-</span><span class="num" id="4444111">1</span>&nbsp;<span class="op" id="4444113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444117"><a href="/crypto/elliptic/elliptic.go.html#4444064">r</a></span><span class="op" id="4444118">.</span><span class="ident" id="4444119">Add</span><span class="op" id="4444122">(</span><span class="ident" id="4444123"><a href="/crypto/elliptic/elliptic.go.html#4444064">r</a></span><span class="op" id="4444124">,</span>&nbsp;<span class="ident" id="4444126"><a href="/crypto/elliptic/elliptic.go.html#4443109">curve</a></span><span class="op" id="4444131">.</span><span class="ident" id="4444132">P</span><span class="op" id="4444133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444139">yEqual</span>&nbsp;<span class="op" id="4444146">:=</span>&nbsp;<span class="ident" id="4444149"><a href="/crypto/elliptic/elliptic.go.html#4444064">r</a></span><span class="op" id="4444150">.</span><span class="ident" id="4444151">Sign</span><span class="op" id="4444155">(</span><span class="op" id="4444156">)</span>&nbsp;<span class="op" id="4444158">==</span>&nbsp;<span class="num" id="4444161">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444164">if</span>&nbsp;<span class="ident" id="4444167"><a href="/crypto/elliptic/elliptic.go.html#4443781">xEqual</a></span>&nbsp;<span class="op" id="4444174">&amp;&amp;</span>&nbsp;<span class="ident" id="4444177"><a href="/crypto/elliptic/elliptic.go.html#4444139">yEqual</a></span>&nbsp;<span class="op" id="4444184">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444188">return</span>&nbsp;<span class="ident" id="4444195"><a href="/crypto/elliptic/elliptic.go.html#4443109">curve</a></span><span class="op" id="4444200">.</span><span class="ident" id="4444201">doubleJacobian</span><span class="op" id="4444215">(</span><span class="ident" id="4444216"><a href="/crypto/elliptic/elliptic.go.html#4443141">x1</a></span><span class="op" id="4444218">,</span>&nbsp;<span class="ident" id="4444220"><a href="/crypto/elliptic/elliptic.go.html#4443145">y1</a></span><span class="op" id="4444222">,</span>&nbsp;<span class="ident" id="4444224"><a href="/crypto/elliptic/elliptic.go.html#4443149">z1</a></span><span class="op" id="4444226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444232"><a href="/crypto/elliptic/elliptic.go.html#4444064">r</a></span><span class="op" id="4444233">.</span><span class="ident" id="4444234">Lsh</span><span class="op" id="4444237">(</span><span class="ident" id="4444238"><a href="/crypto/elliptic/elliptic.go.html#4444064">r</a></span><span class="op" id="4444239">,</span>&nbsp;<span class="num" id="4444241">1</span><span class="op" id="4444242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444245">v</span>&nbsp;<span class="op" id="4444247">:=</span>&nbsp;<span class="builtinfunc" id="4444250">new</span><span class="op" id="4444253">(</span><span class="ident" id="4444254"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4444257">.</span><span class="ident" id="4444258">Int</span><span class="op" id="4444261">)</span><span class="op" id="4444262">.</span><span class="ident" id="4444263">Mul</span><span class="op" id="4444266">(</span><span class="ident" id="4444267"><a href="/crypto/elliptic/elliptic.go.html#4443640">u1</a></span><span class="op" id="4444269">,</span>&nbsp;<span class="ident" id="4444271"><a href="/crypto/elliptic/elliptic.go.html#4443850">i</a></span><span class="op" id="4444272">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444276"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444278">.</span><span class="ident" id="4444279">Set</span><span class="op" id="4444282">(</span><span class="ident" id="4444283"><a href="/crypto/elliptic/elliptic.go.html#4444064">r</a></span><span class="op" id="4444284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444287"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444289">.</span><span class="ident" id="4444290">Mul</span><span class="op" id="4444293">(</span><span class="ident" id="4444294"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444296">,</span>&nbsp;<span class="ident" id="4444298"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444303"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444305">.</span><span class="ident" id="4444306">Sub</span><span class="op" id="4444309">(</span><span class="ident" id="4444310"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444312">,</span>&nbsp;<span class="ident" id="4444314"><a href="/crypto/elliptic/elliptic.go.html#4443892">j</a></span><span class="op" id="4444315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444318"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444320">.</span><span class="ident" id="4444321">Sub</span><span class="op" id="4444324">(</span><span class="ident" id="4444325"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444327">,</span>&nbsp;<span class="ident" id="4444329"><a href="/crypto/elliptic/elliptic.go.html#4444245">v</a></span><span class="op" id="4444330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444333"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444335">.</span><span class="ident" id="4444336">Sub</span><span class="op" id="4444339">(</span><span class="ident" id="4444340"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444342">,</span>&nbsp;<span class="ident" id="4444344"><a href="/crypto/elliptic/elliptic.go.html#4444245">v</a></span><span class="op" id="4444345">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444348"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444350">.</span><span class="ident" id="4444351">Mod</span><span class="op" id="4444354">(</span><span class="ident" id="4444355"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444357">,</span>&nbsp;<span class="ident" id="4444359"><a href="/crypto/elliptic/elliptic.go.html#4443109">curve</a></span><span class="op" id="4444364">.</span><span class="ident" id="4444365">P</span><span class="op" id="4444366">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444370"><a href="/crypto/elliptic/elliptic.go.html#4443302">y3</a></span><span class="op" id="4444372">.</span><span class="ident" id="4444373">Set</span><span class="op" id="4444376">(</span><span class="ident" id="4444377"><a href="/crypto/elliptic/elliptic.go.html#4444064">r</a></span><span class="op" id="4444378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444381"><a href="/crypto/elliptic/elliptic.go.html#4444245">v</a></span><span class="op" id="4444382">.</span><span class="ident" id="4444383">Sub</span><span class="op" id="4444386">(</span><span class="ident" id="4444387"><a href="/crypto/elliptic/elliptic.go.html#4444245">v</a></span><span class="op" id="4444388">,</span>&nbsp;<span class="ident" id="4444390"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444395"><a href="/crypto/elliptic/elliptic.go.html#4443302">y3</a></span><span class="op" id="4444397">.</span><span class="ident" id="4444398">Mul</span><span class="op" id="4444401">(</span><span class="ident" id="4444402"><a href="/crypto/elliptic/elliptic.go.html#4443302">y3</a></span><span class="op" id="4444404">,</span>&nbsp;<span class="ident" id="4444406"><a href="/crypto/elliptic/elliptic.go.html#4444245">v</a></span><span class="op" id="4444407">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444410"><a href="/crypto/elliptic/elliptic.go.html#4443922">s1</a></span><span class="op" id="4444412">.</span><span class="ident" id="4444413">Mul</span><span class="op" id="4444416">(</span><span class="ident" id="4444417"><a href="/crypto/elliptic/elliptic.go.html#4443922">s1</a></span><span class="op" id="4444419">,</span>&nbsp;<span class="ident" id="4444421"><a href="/crypto/elliptic/elliptic.go.html#4443892">j</a></span><span class="op" id="4444422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444425"><a href="/crypto/elliptic/elliptic.go.html#4443922">s1</a></span><span class="op" id="4444427">.</span><span class="ident" id="4444428">Lsh</span><span class="op" id="4444431">(</span><span class="ident" id="4444432"><a href="/crypto/elliptic/elliptic.go.html#4443922">s1</a></span><span class="op" id="4444434">,</span>&nbsp;<span class="num" id="4444436">1</span><span class="op" id="4444437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444440"><a href="/crypto/elliptic/elliptic.go.html#4443302">y3</a></span><span class="op" id="4444442">.</span><span class="ident" id="4444443">Sub</span><span class="op" id="4444446">(</span><span class="ident" id="4444447"><a href="/crypto/elliptic/elliptic.go.html#4443302">y3</a></span><span class="op" id="4444449">,</span>&nbsp;<span class="ident" id="4444451"><a href="/crypto/elliptic/elliptic.go.html#4443922">s1</a></span><span class="op" id="4444453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444456"><a href="/crypto/elliptic/elliptic.go.html#4443302">y3</a></span><span class="op" id="4444458">.</span><span class="ident" id="4444459">Mod</span><span class="op" id="4444462">(</span><span class="ident" id="4444463"><a href="/crypto/elliptic/elliptic.go.html#4443302">y3</a></span><span class="op" id="4444465">,</span>&nbsp;<span class="ident" id="4444467"><a href="/crypto/elliptic/elliptic.go.html#4443109">curve</a></span><span class="op" id="4444472">.</span><span class="ident" id="4444473">P</span><span class="op" id="4444474">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444478"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4444480">.</span><span class="ident" id="4444481">Add</span><span class="op" id="4444484">(</span><span class="ident" id="4444485"><a href="/crypto/elliptic/elliptic.go.html#4443149">z1</a></span><span class="op" id="4444487">,</span>&nbsp;<span class="ident" id="4444489"><a href="/crypto/elliptic/elliptic.go.html#4443161">z2</a></span><span class="op" id="4444491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444494"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4444496">.</span><span class="ident" id="4444497">Mul</span><span class="op" id="4444500">(</span><span class="ident" id="4444501"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4444503">,</span>&nbsp;<span class="ident" id="4444505"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4444507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444510"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4444512">.</span><span class="ident" id="4444513">Sub</span><span class="op" id="4444516">(</span><span class="ident" id="4444517"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4444519">,</span>&nbsp;<span class="ident" id="4444521"><a href="/crypto/elliptic/elliptic.go.html#4443521">z1z1</a></span><span class="op" id="4444525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444528"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4444530">.</span><span class="ident" id="4444531">Sub</span><span class="op" id="4444534">(</span><span class="ident" id="4444535"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4444537">,</span>&nbsp;<span class="ident" id="4444539"><a href="/crypto/elliptic/elliptic.go.html#4443580">z2z2</a></span><span class="op" id="4444543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444546"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4444548">.</span><span class="ident" id="4444549">Mul</span><span class="op" id="4444552">(</span><span class="ident" id="4444553"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4444555">,</span>&nbsp;<span class="ident" id="4444557"><a href="/crypto/elliptic/elliptic.go.html#4443750">h</a></span><span class="op" id="4444558">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444561"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4444563">.</span><span class="ident" id="4444564">Mod</span><span class="op" id="4444567">(</span><span class="ident" id="4444568"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><span class="op" id="4444570">,</span>&nbsp;<span class="ident" id="4444572"><a href="/crypto/elliptic/elliptic.go.html#4443109">curve</a></span><span class="op" id="4444577">.</span><span class="ident" id="4444578">P</span><span class="op" id="4444579">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444583">return</span>&nbsp;<span class="ident" id="4444590"><a href="/crypto/elliptic/elliptic.go.html#4443298">x3</a></span><span class="op" id="4444592">,</span>&nbsp;<span class="ident" id="4444594"><a href="/crypto/elliptic/elliptic.go.html#4443302">y3</a></span><span class="op" id="4444596">,</span>&nbsp;<span class="ident" id="4444598"><a href="/crypto/elliptic/elliptic.go.html#4443306">z3</a></span><br>
<span class="lineno"></span><span class="op" id="4444601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4444604">func</span>&nbsp;<span class="op" id="4444609">(</span><span class="ident" id="4444610">curve</span>&nbsp;<span class="op" id="4444616">*</span><span class="ident" id="4444617"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><span class="op" id="4444628">)</span>&nbsp;<span class="ident" id="4444630">Double</span><span class="op" id="4444636">(</span><span class="ident" id="4444637">x1</span><span class="op" id="4444639">,</span>&nbsp;<span class="ident" id="4444641">y1</span>&nbsp;<span class="op" id="4444644">*</span><span class="ident" id="4444645"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4444648">.</span><span class="ident" id="4444649">Int</span><span class="op" id="4444652">)</span>&nbsp;<span class="op" id="4444654">(</span><span class="op" id="4444655">*</span><span class="ident" id="4444656"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4444659">.</span><span class="ident" id="4444660">Int</span><span class="op" id="4444663">,</span>&nbsp;<span class="op" id="4444665">*</span><span class="ident" id="4444666"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4444669">.</span><span class="ident" id="4444670">Int</span><span class="op" id="4444673">)</span>&nbsp;<span class="op" id="4444675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444678">z1</span>&nbsp;<span class="op" id="4444681">:=</span>&nbsp;<span class="ident" id="4444684"><a href="/crypto/elliptic/elliptic.go.html#4442106">zForAffine</a></span><span class="op" id="4444694">(</span><span class="ident" id="4444695"><a href="/crypto/elliptic/elliptic.go.html#4444637">x1</a></span><span class="op" id="4444697">,</span>&nbsp;<span class="ident" id="4444699"><a href="/crypto/elliptic/elliptic.go.html#4444641">y1</a></span><span class="op" id="4444701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444704">return</span>&nbsp;<span class="ident" id="4444711"><a href="/crypto/elliptic/elliptic.go.html#4444610">curve</a></span><span class="op" id="4444716">.</span><span class="ident" id="4444717">affineFromJacobian</span><span class="op" id="4444735">(</span><span class="ident" id="4444736"><a href="/crypto/elliptic/elliptic.go.html#4444610">curve</a></span><span class="op" id="4444741">.</span><span class="ident" id="4444742">doubleJacobian</span><span class="op" id="4444756">(</span><span class="ident" id="4444757"><a href="/crypto/elliptic/elliptic.go.html#4444637">x1</a></span><span class="op" id="4444759">,</span>&nbsp;<span class="ident" id="4444761"><a href="/crypto/elliptic/elliptic.go.html#4444641">y1</a></span><span class="op" id="4444763">,</span>&nbsp;<span class="ident" id="4444765"><a href="/crypto/elliptic/elliptic.go.html#4444678">z1</a></span><span class="op" id="4444767">)</span><span class="op" id="4444768">)</span><br>
<span class="lineno"></span><span class="op" id="4444770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4444773">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4444845">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4444891">func</span>&nbsp;<span class="op" id="4444896">(</span><span class="ident" id="4444897">curve</span>&nbsp;<span class="op" id="4444903">*</span><span class="ident" id="4444904"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><span class="op" id="4444915">)</span>&nbsp;<span class="ident" id="4444917">doubleJacobian</span><span class="op" id="4444931">(</span><span class="ident" id="4444932">x</span><span class="op" id="4444933">,</span>&nbsp;<span class="ident" id="4444935">y</span><span class="op" id="4444936">,</span>&nbsp;<span class="ident" id="4444938">z</span>&nbsp;<span class="op" id="4444940">*</span><span class="ident" id="4444941"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4444944">.</span><span class="ident" id="4444945">Int</span><span class="op" id="4444948">)</span>&nbsp;<span class="op" id="4444950">(</span><span class="op" id="4444951">*</span><span class="ident" id="4444952"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4444955">.</span><span class="ident" id="4444956">Int</span><span class="op" id="4444959">,</span>&nbsp;<span class="op" id="4444961">*</span><span class="ident" id="4444962"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4444965">.</span><span class="ident" id="4444966">Int</span><span class="op" id="4444969">,</span>&nbsp;<span class="op" id="4444971">*</span><span class="ident" id="4444972"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4444975">.</span><span class="ident" id="4444976">Int</span><span class="op" id="4444979">)</span>&nbsp;<span class="op" id="4444981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4444984">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445073">delta</span>&nbsp;<span class="op" id="4445079">:=</span>&nbsp;<span class="builtinfunc" id="4445082">new</span><span class="op" id="4445085">(</span><span class="ident" id="4445086"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4445089">.</span><span class="ident" id="4445090">Int</span><span class="op" id="4445093">)</span><span class="op" id="4445094">.</span><span class="ident" id="4445095">Mul</span><span class="op" id="4445098">(</span><span class="ident" id="4445099"><a href="/crypto/elliptic/elliptic.go.html#4444938">z</a></span><span class="op" id="4445100">,</span>&nbsp;<span class="ident" id="4445102"><a href="/crypto/elliptic/elliptic.go.html#4444938">z</a></span><span class="op" id="4445103">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445106"><a href="/crypto/elliptic/elliptic.go.html#4445073">delta</a></span><span class="op" id="4445111">.</span><span class="ident" id="4445112">Mod</span><span class="op" id="4445115">(</span><span class="ident" id="4445116"><a href="/crypto/elliptic/elliptic.go.html#4445073">delta</a></span><span class="op" id="4445121">,</span>&nbsp;<span class="ident" id="4445123"><a href="/crypto/elliptic/elliptic.go.html#4444897">curve</a></span><span class="op" id="4445128">.</span><span class="ident" id="4445129">P</span><span class="op" id="4445130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445133">gamma</span>&nbsp;<span class="op" id="4445139">:=</span>&nbsp;<span class="builtinfunc" id="4445142">new</span><span class="op" id="4445145">(</span><span class="ident" id="4445146"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4445149">.</span><span class="ident" id="4445150">Int</span><span class="op" id="4445153">)</span><span class="op" id="4445154">.</span><span class="ident" id="4445155">Mul</span><span class="op" id="4445158">(</span><span class="ident" id="4445159"><a href="/crypto/elliptic/elliptic.go.html#4444935">y</a></span><span class="op" id="4445160">,</span>&nbsp;<span class="ident" id="4445162"><a href="/crypto/elliptic/elliptic.go.html#4444935">y</a></span><span class="op" id="4445163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445166"><a href="/crypto/elliptic/elliptic.go.html#4445133">gamma</a></span><span class="op" id="4445171">.</span><span class="ident" id="4445172">Mod</span><span class="op" id="4445175">(</span><span class="ident" id="4445176"><a href="/crypto/elliptic/elliptic.go.html#4445133">gamma</a></span><span class="op" id="4445181">,</span>&nbsp;<span class="ident" id="4445183"><a href="/crypto/elliptic/elliptic.go.html#4444897">curve</a></span><span class="op" id="4445188">.</span><span class="ident" id="4445189">P</span><span class="op" id="4445190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445193">alpha</span>&nbsp;<span class="op" id="4445199">:=</span>&nbsp;<span class="builtinfunc" id="4445202">new</span><span class="op" id="4445205">(</span><span class="ident" id="4445206"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4445209">.</span><span class="ident" id="4445210">Int</span><span class="op" id="4445213">)</span><span class="op" id="4445214">.</span><span class="ident" id="4445215">Sub</span><span class="op" id="4445218">(</span><span class="ident" id="4445219"><a href="/crypto/elliptic/elliptic.go.html#4444932">x</a></span><span class="op" id="4445220">,</span>&nbsp;<span class="ident" id="4445222"><a href="/crypto/elliptic/elliptic.go.html#4445073">delta</a></span><span class="op" id="4445227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445230">if</span>&nbsp;<span class="ident" id="4445233"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445238">.</span><span class="ident" id="4445239">Sign</span><span class="op" id="4445243">(</span><span class="op" id="4445244">)</span>&nbsp;<span class="op" id="4445246">==</span>&nbsp;<span class="op" id="4445249">-</span><span class="num" id="4445250">1</span>&nbsp;<span class="op" id="4445252">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445256"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445261">.</span><span class="ident" id="4445262">Add</span><span class="op" id="4445265">(</span><span class="ident" id="4445266"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445271">,</span>&nbsp;<span class="ident" id="4445273"><a href="/crypto/elliptic/elliptic.go.html#4444897">curve</a></span><span class="op" id="4445278">.</span><span class="ident" id="4445279">P</span><span class="op" id="4445280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445286">alpha2</span>&nbsp;<span class="op" id="4445293">:=</span>&nbsp;<span class="builtinfunc" id="4445296">new</span><span class="op" id="4445299">(</span><span class="ident" id="4445300"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4445303">.</span><span class="ident" id="4445304">Int</span><span class="op" id="4445307">)</span><span class="op" id="4445308">.</span><span class="ident" id="4445309">Add</span><span class="op" id="4445312">(</span><span class="ident" id="4445313"><a href="/crypto/elliptic/elliptic.go.html#4444932">x</a></span><span class="op" id="4445314">,</span>&nbsp;<span class="ident" id="4445316"><a href="/crypto/elliptic/elliptic.go.html#4445073">delta</a></span><span class="op" id="4445321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445324"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445329">.</span><span class="ident" id="4445330">Mul</span><span class="op" id="4445333">(</span><span class="ident" id="4445334"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445339">,</span>&nbsp;<span class="ident" id="4445341"><a href="/crypto/elliptic/elliptic.go.html#4445286">alpha2</a></span><span class="op" id="4445347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445350"><a href="/crypto/elliptic/elliptic.go.html#4445286">alpha2</a></span><span class="op" id="4445356">.</span><span class="ident" id="4445357">Set</span><span class="op" id="4445360">(</span><span class="ident" id="4445361"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445366">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445369"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445374">.</span><span class="ident" id="4445375">Lsh</span><span class="op" id="4445378">(</span><span class="ident" id="4445379"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445384">,</span>&nbsp;<span class="num" id="4445386">1</span><span class="op" id="4445387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445390"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445395">.</span><span class="ident" id="4445396">Add</span><span class="op" id="4445399">(</span><span class="ident" id="4445400"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445405">,</span>&nbsp;<span class="ident" id="4445407"><a href="/crypto/elliptic/elliptic.go.html#4445286">alpha2</a></span><span class="op" id="4445413">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445417">beta</span>&nbsp;<span class="op" id="4445422">:=</span>&nbsp;<span class="ident" id="4445425"><a href="/crypto/elliptic/elliptic.go.html#4445286">alpha2</a></span><span class="op" id="4445431">.</span><span class="ident" id="4445432">Mul</span><span class="op" id="4445435">(</span><span class="ident" id="4445436"><a href="/crypto/elliptic/elliptic.go.html#4444932">x</a></span><span class="op" id="4445437">,</span>&nbsp;<span class="ident" id="4445439"><a href="/crypto/elliptic/elliptic.go.html#4445133">gamma</a></span><span class="op" id="4445444">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445448">x3</span>&nbsp;<span class="op" id="4445451">:=</span>&nbsp;<span class="builtinfunc" id="4445454">new</span><span class="op" id="4445457">(</span><span class="ident" id="4445458"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4445461">.</span><span class="ident" id="4445462">Int</span><span class="op" id="4445465">)</span><span class="op" id="4445466">.</span><span class="ident" id="4445467">Mul</span><span class="op" id="4445470">(</span><span class="ident" id="4445471"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445476">,</span>&nbsp;<span class="ident" id="4445478"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445486">beta8</span>&nbsp;<span class="op" id="4445492">:=</span>&nbsp;<span class="builtinfunc" id="4445495">new</span><span class="op" id="4445498">(</span><span class="ident" id="4445499"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4445502">.</span><span class="ident" id="4445503">Int</span><span class="op" id="4445506">)</span><span class="op" id="4445507">.</span><span class="ident" id="4445508">Lsh</span><span class="op" id="4445511">(</span><span class="ident" id="4445512"><a href="/crypto/elliptic/elliptic.go.html#4445417">beta</a></span><span class="op" id="4445516">,</span>&nbsp;<span class="num" id="4445518">3</span><span class="op" id="4445519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445522"><a href="/crypto/elliptic/elliptic.go.html#4445448">x3</a></span><span class="op" id="4445524">.</span><span class="ident" id="4445525">Sub</span><span class="op" id="4445528">(</span><span class="ident" id="4445529"><a href="/crypto/elliptic/elliptic.go.html#4445448">x3</a></span><span class="op" id="4445531">,</span>&nbsp;<span class="ident" id="4445533"><a href="/crypto/elliptic/elliptic.go.html#4445486">beta8</a></span><span class="op" id="4445538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445541">for</span>&nbsp;<span class="ident" id="4445545"><a href="/crypto/elliptic/elliptic.go.html#4445448">x3</a></span><span class="op" id="4445547">.</span><span class="ident" id="4445548">Sign</span><span class="op" id="4445552">(</span><span class="op" id="4445553">)</span>&nbsp;<span class="op" id="4445555">==</span>&nbsp;<span class="op" id="4445558">-</span><span class="num" id="4445559">1</span>&nbsp;<span class="op" id="4445561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445565"><a href="/crypto/elliptic/elliptic.go.html#4445448">x3</a></span><span class="op" id="4445567">.</span><span class="ident" id="4445568">Add</span><span class="op" id="4445571">(</span><span class="ident" id="4445572"><a href="/crypto/elliptic/elliptic.go.html#4445448">x3</a></span><span class="op" id="4445574">,</span>&nbsp;<span class="ident" id="4445576"><a href="/crypto/elliptic/elliptic.go.html#4444897">curve</a></span><span class="op" id="4445581">.</span><span class="ident" id="4445582">P</span><span class="op" id="4445583">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445589"><a href="/crypto/elliptic/elliptic.go.html#4445448">x3</a></span><span class="op" id="4445591">.</span><span class="ident" id="4445592">Mod</span><span class="op" id="4445595">(</span><span class="ident" id="4445596"><a href="/crypto/elliptic/elliptic.go.html#4445448">x3</a></span><span class="op" id="4445598">,</span>&nbsp;<span class="ident" id="4445600"><a href="/crypto/elliptic/elliptic.go.html#4444897">curve</a></span><span class="op" id="4445605">.</span><span class="ident" id="4445606">P</span><span class="op" id="4445607">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445611">z3</span>&nbsp;<span class="op" id="4445614">:=</span>&nbsp;<span class="builtinfunc" id="4445617">new</span><span class="op" id="4445620">(</span><span class="ident" id="4445621"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4445624">.</span><span class="ident" id="4445625">Int</span><span class="op" id="4445628">)</span><span class="op" id="4445629">.</span><span class="ident" id="4445630">Add</span><span class="op" id="4445633">(</span><span class="ident" id="4445634"><a href="/crypto/elliptic/elliptic.go.html#4444935">y</a></span><span class="op" id="4445635">,</span>&nbsp;<span class="ident" id="4445637"><a href="/crypto/elliptic/elliptic.go.html#4444938">z</a></span><span class="op" id="4445638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445641"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445643">.</span><span class="ident" id="4445644">Mul</span><span class="op" id="4445647">(</span><span class="ident" id="4445648"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445650">,</span>&nbsp;<span class="ident" id="4445652"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445654">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445657"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445659">.</span><span class="ident" id="4445660">Sub</span><span class="op" id="4445663">(</span><span class="ident" id="4445664"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445666">,</span>&nbsp;<span class="ident" id="4445668"><a href="/crypto/elliptic/elliptic.go.html#4445133">gamma</a></span><span class="op" id="4445673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445676">if</span>&nbsp;<span class="ident" id="4445679"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445681">.</span><span class="ident" id="4445682">Sign</span><span class="op" id="4445686">(</span><span class="op" id="4445687">)</span>&nbsp;<span class="op" id="4445689">==</span>&nbsp;<span class="op" id="4445692">-</span><span class="num" id="4445693">1</span>&nbsp;<span class="op" id="4445695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445699"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445701">.</span><span class="ident" id="4445702">Add</span><span class="op" id="4445705">(</span><span class="ident" id="4445706"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445708">,</span>&nbsp;<span class="ident" id="4445710"><a href="/crypto/elliptic/elliptic.go.html#4444897">curve</a></span><span class="op" id="4445715">.</span><span class="ident" id="4445716">P</span><span class="op" id="4445717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445723"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445725">.</span><span class="ident" id="4445726">Sub</span><span class="op" id="4445729">(</span><span class="ident" id="4445730"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445732">,</span>&nbsp;<span class="ident" id="4445734"><a href="/crypto/elliptic/elliptic.go.html#4445073">delta</a></span><span class="op" id="4445739">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445742">if</span>&nbsp;<span class="ident" id="4445745"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445747">.</span><span class="ident" id="4445748">Sign</span><span class="op" id="4445752">(</span><span class="op" id="4445753">)</span>&nbsp;<span class="op" id="4445755">==</span>&nbsp;<span class="op" id="4445758">-</span><span class="num" id="4445759">1</span>&nbsp;<span class="op" id="4445761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445765"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445767">.</span><span class="ident" id="4445768">Add</span><span class="op" id="4445771">(</span><span class="ident" id="4445772"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445774">,</span>&nbsp;<span class="ident" id="4445776"><a href="/crypto/elliptic/elliptic.go.html#4444897">curve</a></span><span class="op" id="4445781">.</span><span class="ident" id="4445782">P</span><span class="op" id="4445783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445789"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445791">.</span><span class="ident" id="4445792">Mod</span><span class="op" id="4445795">(</span><span class="ident" id="4445796"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><span class="op" id="4445798">,</span>&nbsp;<span class="ident" id="4445800"><a href="/crypto/elliptic/elliptic.go.html#4444897">curve</a></span><span class="op" id="4445805">.</span><span class="ident" id="4445806">P</span><span class="op" id="4445807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445811"><a href="/crypto/elliptic/elliptic.go.html#4445417">beta</a></span><span class="op" id="4445815">.</span><span class="ident" id="4445816">Lsh</span><span class="op" id="4445819">(</span><span class="ident" id="4445820"><a href="/crypto/elliptic/elliptic.go.html#4445417">beta</a></span><span class="op" id="4445824">,</span>&nbsp;<span class="num" id="4445826">2</span><span class="op" id="4445827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445830"><a href="/crypto/elliptic/elliptic.go.html#4445417">beta</a></span><span class="op" id="4445834">.</span><span class="ident" id="4445835">Sub</span><span class="op" id="4445838">(</span><span class="ident" id="4445839"><a href="/crypto/elliptic/elliptic.go.html#4445417">beta</a></span><span class="op" id="4445843">,</span>&nbsp;<span class="ident" id="4445845"><a href="/crypto/elliptic/elliptic.go.html#4445448">x3</a></span><span class="op" id="4445847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445850">if</span>&nbsp;<span class="ident" id="4445853"><a href="/crypto/elliptic/elliptic.go.html#4445417">beta</a></span><span class="op" id="4445857">.</span><span class="ident" id="4445858">Sign</span><span class="op" id="4445862">(</span><span class="op" id="4445863">)</span>&nbsp;<span class="op" id="4445865">==</span>&nbsp;<span class="op" id="4445868">-</span><span class="num" id="4445869">1</span>&nbsp;<span class="op" id="4445871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445875"><a href="/crypto/elliptic/elliptic.go.html#4445417">beta</a></span><span class="op" id="4445879">.</span><span class="ident" id="4445880">Add</span><span class="op" id="4445883">(</span><span class="ident" id="4445884"><a href="/crypto/elliptic/elliptic.go.html#4445417">beta</a></span><span class="op" id="4445888">,</span>&nbsp;<span class="ident" id="4445890"><a href="/crypto/elliptic/elliptic.go.html#4444897">curve</a></span><span class="op" id="4445895">.</span><span class="ident" id="4445896">P</span><span class="op" id="4445897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445900">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445903">y3</span>&nbsp;<span class="op" id="4445906">:=</span>&nbsp;<span class="ident" id="4445909"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445914">.</span><span class="ident" id="4445915">Mul</span><span class="op" id="4445918">(</span><span class="ident" id="4445919"><a href="/crypto/elliptic/elliptic.go.html#4445193">alpha</a></span><span class="op" id="4445924">,</span>&nbsp;<span class="ident" id="4445926"><a href="/crypto/elliptic/elliptic.go.html#4445417">beta</a></span><span class="op" id="4445930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445934"><a href="/crypto/elliptic/elliptic.go.html#4445133">gamma</a></span><span class="op" id="4445939">.</span><span class="ident" id="4445940">Mul</span><span class="op" id="4445943">(</span><span class="ident" id="4445944"><a href="/crypto/elliptic/elliptic.go.html#4445133">gamma</a></span><span class="op" id="4445949">,</span>&nbsp;<span class="ident" id="4445951"><a href="/crypto/elliptic/elliptic.go.html#4445133">gamma</a></span><span class="op" id="4445956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445959"><a href="/crypto/elliptic/elliptic.go.html#4445133">gamma</a></span><span class="op" id="4445964">.</span><span class="ident" id="4445965">Lsh</span><span class="op" id="4445968">(</span><span class="ident" id="4445969"><a href="/crypto/elliptic/elliptic.go.html#4445133">gamma</a></span><span class="op" id="4445974">,</span>&nbsp;<span class="num" id="4445976">3</span><span class="op" id="4445977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445980"><a href="/crypto/elliptic/elliptic.go.html#4445133">gamma</a></span><span class="op" id="4445985">.</span><span class="ident" id="4445986">Mod</span><span class="op" id="4445989">(</span><span class="ident" id="4445990"><a href="/crypto/elliptic/elliptic.go.html#4445133">gamma</a></span><span class="op" id="4445995">,</span>&nbsp;<span class="ident" id="4445997"><a href="/crypto/elliptic/elliptic.go.html#4444897">curve</a></span><span class="op" id="4446002">.</span><span class="ident" id="4446003">P</span><span class="op" id="4446004">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446008"><a href="/crypto/elliptic/elliptic.go.html#4445903">y3</a></span><span class="op" id="4446010">.</span><span class="ident" id="4446011">Sub</span><span class="op" id="4446014">(</span><span class="ident" id="4446015"><a href="/crypto/elliptic/elliptic.go.html#4445903">y3</a></span><span class="op" id="4446017">,</span>&nbsp;<span class="ident" id="4446019"><a href="/crypto/elliptic/elliptic.go.html#4445133">gamma</a></span><span class="op" id="4446024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446027">if</span>&nbsp;<span class="ident" id="4446030"><a href="/crypto/elliptic/elliptic.go.html#4445903">y3</a></span><span class="op" id="4446032">.</span><span class="ident" id="4446033">Sign</span><span class="op" id="4446037">(</span><span class="op" id="4446038">)</span>&nbsp;<span class="op" id="4446040">==</span>&nbsp;<span class="op" id="4446043">-</span><span class="num" id="4446044">1</span>&nbsp;<span class="op" id="4446046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446050"><a href="/crypto/elliptic/elliptic.go.html#4445903">y3</a></span><span class="op" id="4446052">.</span><span class="ident" id="4446053">Add</span><span class="op" id="4446056">(</span><span class="ident" id="4446057"><a href="/crypto/elliptic/elliptic.go.html#4445903">y3</a></span><span class="op" id="4446059">,</span>&nbsp;<span class="ident" id="4446061"><a href="/crypto/elliptic/elliptic.go.html#4444897">curve</a></span><span class="op" id="4446066">.</span><span class="ident" id="4446067">P</span><span class="op" id="4446068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446071">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446074"><a href="/crypto/elliptic/elliptic.go.html#4445903">y3</a></span><span class="op" id="4446076">.</span><span class="ident" id="4446077">Mod</span><span class="op" id="4446080">(</span><span class="ident" id="4446081"><a href="/crypto/elliptic/elliptic.go.html#4445903">y3</a></span><span class="op" id="4446083">,</span>&nbsp;<span class="ident" id="4446085"><a href="/crypto/elliptic/elliptic.go.html#4444897">curve</a></span><span class="op" id="4446090">.</span><span class="ident" id="4446091">P</span><span class="op" id="4446092">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446096">return</span>&nbsp;<span class="ident" id="4446103"><a href="/crypto/elliptic/elliptic.go.html#4445448">x3</a></span><span class="op" id="4446105">,</span>&nbsp;<span class="ident" id="4446107"><a href="/crypto/elliptic/elliptic.go.html#4445903">y3</a></span><span class="op" id="4446109">,</span>&nbsp;<span class="ident" id="4446111"><a href="/crypto/elliptic/elliptic.go.html#4445611">z3</a></span><br>
<span class="lineno"></span><span class="op" id="4446114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4446117">func</span>&nbsp;<span class="op" id="4446122">(</span><span class="ident" id="4446123">curve</span>&nbsp;<span class="op" id="4446129">*</span><span class="ident" id="4446130"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><span class="op" id="4446141">)</span>&nbsp;<span class="ident" id="4446143">ScalarMult</span><span class="op" id="4446153">(</span><span class="ident" id="4446154">Bx</span><span class="op" id="4446156">,</span>&nbsp;<span class="ident" id="4446158">By</span>&nbsp;<span class="op" id="4446161">*</span><span class="ident" id="4446162"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4446165">.</span><span class="ident" id="4446166">Int</span><span class="op" id="4446169">,</span>&nbsp;<span class="ident" id="4446171">k</span>&nbsp;<span class="op" id="4446173">[</span><span class="op" id="4446174">]</span><span class="builtintype" id="4446175">byte</span><span class="op" id="4446179">)</span>&nbsp;<span class="op" id="4446181">(</span><span class="op" id="4446182">*</span><span class="ident" id="4446183"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4446186">.</span><span class="ident" id="4446187">Int</span><span class="op" id="4446190">,</span>&nbsp;<span class="op" id="4446192">*</span><span class="ident" id="4446193"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4446196">.</span><span class="ident" id="4446197">Int</span><span class="op" id="4446200">)</span>&nbsp;<span class="op" id="4446202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446205">Bz</span>&nbsp;<span class="op" id="4446208">:=</span>&nbsp;<span class="builtinfunc" id="4446211">new</span><span class="op" id="4446214">(</span><span class="ident" id="4446215"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4446218">.</span><span class="ident" id="4446219">Int</span><span class="op" id="4446222">)</span><span class="op" id="4446223">.</span><span class="ident" id="4446224">SetInt64</span><span class="op" id="4446232">(</span><span class="num" id="4446233">1</span><span class="op" id="4446234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446237">x</span><span class="op" id="4446238">,</span>&nbsp;<span class="ident" id="4446240">y</span><span class="op" id="4446241">,</span>&nbsp;<span class="ident" id="4446243">z</span>&nbsp;<span class="op" id="4446245">:=</span>&nbsp;<span class="builtinfunc" id="4446248">new</span><span class="op" id="4446251">(</span><span class="ident" id="4446252"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4446255">.</span><span class="ident" id="4446256">Int</span><span class="op" id="4446259">)</span><span class="op" id="4446260">,</span>&nbsp;<span class="builtinfunc" id="4446262">new</span><span class="op" id="4446265">(</span><span class="ident" id="4446266"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4446269">.</span><span class="ident" id="4446270">Int</span><span class="op" id="4446273">)</span><span class="op" id="4446274">,</span>&nbsp;<span class="builtinfunc" id="4446276">new</span><span class="op" id="4446279">(</span><span class="ident" id="4446280"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4446283">.</span><span class="ident" id="4446284">Int</span><span class="op" id="4446287">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446291">for</span>&nbsp;<span class="ident" id="4446295">_</span><span class="op" id="4446296">,</span>&nbsp;<span class="builtintype" id="4446298">byte</span>&nbsp;<span class="op" id="4446303">:=</span>&nbsp;<span class="keyword" id="4446306">range</span>&nbsp;<span class="ident" id="4446312"><a href="/crypto/elliptic/elliptic.go.html#4446171">k</a></span>&nbsp;<span class="op" id="4446314">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446318">for</span>&nbsp;<span class="ident" id="4446322">bitNum</span>&nbsp;<span class="op" id="4446329">:=</span>&nbsp;<span class="num" id="4446332">0</span><span class="op" id="4446333">;</span>&nbsp;<span class="ident" id="4446335"><a href="/crypto/elliptic/elliptic.go.html#4446322">bitNum</a></span>&nbsp;<span class="op" id="4446342">&lt;</span>&nbsp;<span class="num" id="4446344">8</span><span class="op" id="4446345">;</span>&nbsp;<span class="ident" id="4446347"><a href="/crypto/elliptic/elliptic.go.html#4446322">bitNum</a></span><span class="op" id="4446353">++</span>&nbsp;<span class="op" id="4446356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446361"><a href="/crypto/elliptic/elliptic.go.html#4446237">x</a></span><span class="op" id="4446362">,</span>&nbsp;<span class="ident" id="4446364"><a href="/crypto/elliptic/elliptic.go.html#4446240">y</a></span><span class="op" id="4446365">,</span>&nbsp;<span class="ident" id="4446367"><a href="/crypto/elliptic/elliptic.go.html#4446243">z</a></span>&nbsp;<span class="op" id="4446369">=</span>&nbsp;<span class="ident" id="4446371"><a href="/crypto/elliptic/elliptic.go.html#4446123">curve</a></span><span class="op" id="4446376">.</span><span class="ident" id="4446377">doubleJacobian</span><span class="op" id="4446391">(</span><span class="ident" id="4446392"><a href="/crypto/elliptic/elliptic.go.html#4446237">x</a></span><span class="op" id="4446393">,</span>&nbsp;<span class="ident" id="4446395"><a href="/crypto/elliptic/elliptic.go.html#4446240">y</a></span><span class="op" id="4446396">,</span>&nbsp;<span class="ident" id="4446398"><a href="/crypto/elliptic/elliptic.go.html#4446243">z</a></span><span class="op" id="4446399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446404">if</span>&nbsp;<span class="builtintype" id="4446407"><a href="/crypto/elliptic/elliptic.go.html#4446298">byte</a></span><span class="op" id="4446411">&amp;</span><span class="num" id="4446412">0x80</span>&nbsp;<span class="op" id="4446417">==</span>&nbsp;<span class="num" id="4446420">0x80</span>&nbsp;<span class="op" id="4446425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446431"><a href="/crypto/elliptic/elliptic.go.html#4446237">x</a></span><span class="op" id="4446432">,</span>&nbsp;<span class="ident" id="4446434"><a href="/crypto/elliptic/elliptic.go.html#4446240">y</a></span><span class="op" id="4446435">,</span>&nbsp;<span class="ident" id="4446437"><a href="/crypto/elliptic/elliptic.go.html#4446243">z</a></span>&nbsp;<span class="op" id="4446439">=</span>&nbsp;<span class="ident" id="4446441"><a href="/crypto/elliptic/elliptic.go.html#4446123">curve</a></span><span class="op" id="4446446">.</span><span class="ident" id="4446447">addJacobian</span><span class="op" id="4446458">(</span><span class="ident" id="4446459"><a href="/crypto/elliptic/elliptic.go.html#4446154">Bx</a></span><span class="op" id="4446461">,</span>&nbsp;<span class="ident" id="4446463"><a href="/crypto/elliptic/elliptic.go.html#4446158">By</a></span><span class="op" id="4446465">,</span>&nbsp;<span class="ident" id="4446467"><a href="/crypto/elliptic/elliptic.go.html#4446205">Bz</a></span><span class="op" id="4446469">,</span>&nbsp;<span class="ident" id="4446471"><a href="/crypto/elliptic/elliptic.go.html#4446237">x</a></span><span class="op" id="4446472">,</span>&nbsp;<span class="ident" id="4446474"><a href="/crypto/elliptic/elliptic.go.html#4446240">y</a></span><span class="op" id="4446475">,</span>&nbsp;<span class="ident" id="4446477"><a href="/crypto/elliptic/elliptic.go.html#4446243">z</a></span><span class="op" id="4446478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446483">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4446488"><a href="/crypto/elliptic/elliptic.go.html#4446298">byte</a></span>&nbsp;<span class="op" id="4446493">&lt;&lt;=</span>&nbsp;<span class="num" id="4446497">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446508">return</span>&nbsp;<span class="ident" id="4446515"><a href="/crypto/elliptic/elliptic.go.html#4446123">curve</a></span><span class="op" id="4446520">.</span><span class="ident" id="4446521">affineFromJacobian</span><span class="op" id="4446539">(</span><span class="ident" id="4446540"><a href="/crypto/elliptic/elliptic.go.html#4446237">x</a></span><span class="op" id="4446541">,</span>&nbsp;<span class="ident" id="4446543"><a href="/crypto/elliptic/elliptic.go.html#4446240">y</a></span><span class="op" id="4446544">,</span>&nbsp;<span class="ident" id="4446546"><a href="/crypto/elliptic/elliptic.go.html#4446243">z</a></span><span class="op" id="4446547">)</span><br>
<span class="lineno">265</span><span class="op" id="4446549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4446552">func</span>&nbsp;<span class="op" id="4446557">(</span><span class="ident" id="4446558">curve</span>&nbsp;<span class="op" id="4446564">*</span><span class="ident" id="4446565"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><span class="op" id="4446576">)</span>&nbsp;<span class="ident" id="4446578">ScalarBaseMult</span><span class="op" id="4446592">(</span><span class="ident" id="4446593">k</span>&nbsp;<span class="op" id="4446595">[</span><span class="op" id="4446596">]</span><span class="builtintype" id="4446597">byte</span><span class="op" id="4446601">)</span>&nbsp;<span class="op" id="4446603">(</span><span class="op" id="4446604">*</span><span class="ident" id="4446605"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4446608">.</span><span class="ident" id="4446609">Int</span><span class="op" id="4446612">,</span>&nbsp;<span class="op" id="4446614">*</span><span class="ident" id="4446615"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4446618">.</span><span class="ident" id="4446619">Int</span><span class="op" id="4446622">)</span>&nbsp;<span class="op" id="4446624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446627">return</span>&nbsp;<span class="ident" id="4446634"><a href="/crypto/elliptic/elliptic.go.html#4446558">curve</a></span><span class="op" id="4446639">.</span><span class="ident" id="4446640">ScalarMult</span><span class="op" id="4446650">(</span><span class="ident" id="4446651"><a href="/crypto/elliptic/elliptic.go.html#4446558">curve</a></span><span class="op" id="4446656">.</span><span class="ident" id="4446657">Gx</span><span class="op" id="4446659">,</span>&nbsp;<span class="ident" id="4446661"><a href="/crypto/elliptic/elliptic.go.html#4446558">curve</a></span><span class="op" id="4446666">.</span><span class="ident" id="4446667">Gy</span><span class="op" id="4446669">,</span>&nbsp;<span class="ident" id="4446671"><a href="/crypto/elliptic/elliptic.go.html#4446593">k</a></span><span class="op" id="4446672">)</span><br>
<span class="lineno"></span><span class="op" id="4446674">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="4446677">var</span>&nbsp;<span class="ident" id="4446681">mask</span>&nbsp;<span class="op" id="4446686">=</span>&nbsp;<span class="op" id="4446688">[</span><span class="op" id="4446689">]</span><span class="builtintype" id="4446690">byte</span><span class="op" id="4446694">{</span><span class="num" id="4446695">0xff</span><span class="op" id="4446699">,</span>&nbsp;<span class="num" id="4446701">0x1</span><span class="op" id="4446704">,</span>&nbsp;<span class="num" id="4446706">0x3</span><span class="op" id="4446709">,</span>&nbsp;<span class="num" id="4446711">0x7</span><span class="op" id="4446714">,</span>&nbsp;<span class="num" id="4446716">0xf</span><span class="op" id="4446719">,</span>&nbsp;<span class="num" id="4446721">0x1f</span><span class="op" id="4446725">,</span>&nbsp;<span class="num" id="4446727">0x3f</span><span class="op" id="4446731">,</span>&nbsp;<span class="num" id="4446733">0x7f</span><span class="op" id="4446737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4446740">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4446809">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="4446877">func</span>&nbsp;<span class="ident" id="4446882">GenerateKey</span><span class="op" id="4446893">(</span><span class="ident" id="4446894">curve</span>&nbsp;<span class="ident" id="4446900"><a href="/crypto/elliptic/elliptic.go.html#4440438">Curve</a></span><span class="op" id="4446905">,</span>&nbsp;<span class="ident" id="4446907">rand</span>&nbsp;<span class="ident" id="4446912"><a href="/crypto/elliptic/elliptic.go.html#4440280">io</a></span><span class="op" id="4446914">.</span><span class="ident" id="4446915">Reader</span><span class="op" id="4446921">)</span>&nbsp;<span class="op" id="4446923">(</span><span class="ident" id="4446924">priv</span>&nbsp;<span class="op" id="4446929">[</span><span class="op" id="4446930">]</span><span class="builtintype" id="4446931">byte</span><span class="op" id="4446935">,</span>&nbsp;<span class="ident" id="4446937">x</span><span class="op" id="4446938">,</span>&nbsp;<span class="ident" id="4446940">y</span>&nbsp;<span class="op" id="4446942">*</span><span class="ident" id="4446943"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4446946">.</span><span class="ident" id="4446947">Int</span><span class="op" id="4446950">,</span>&nbsp;<span class="ident" id="4446952">err</span>&nbsp;<span class="builtintype" id="4446956">error</span><span class="op" id="4446961">)</span>&nbsp;<span class="op" id="4446963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446966">bitSize</span>&nbsp;<span class="op" id="4446974">:=</span>&nbsp;<span class="ident" id="4446977"><a href="/crypto/elliptic/elliptic.go.html#4446894">curve</a></span><span class="op" id="4446982">.</span><span class="ident" id="4446983">Params</span><span class="op" id="4446989">(</span><span class="op" id="4446990">)</span><span class="op" id="4446991">.</span><span class="ident" id="4446992">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447001">byteLen</span>&nbsp;<span class="op" id="4447009">:=</span>&nbsp;<span class="op" id="4447012">(</span><span class="ident" id="4447013"><a href="/crypto/elliptic/elliptic.go.html#4446966">bitSize</a></span>&nbsp;<span class="op" id="4447021">+</span>&nbsp;<span class="num" id="4447023">7</span><span class="op" id="4447024">)</span>&nbsp;<span class="op" id="4447026">&gt;&gt;</span>&nbsp;<span class="num" id="4447029">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447032"><a href="/crypto/elliptic/elliptic.go.html#4446924">priv</a></span>&nbsp;<span class="op" id="4447037">=</span>&nbsp;<span class="builtinfunc" id="4447039">make</span><span class="op" id="4447043">(</span><span class="op" id="4447044">[</span><span class="op" id="4447045">]</span><span class="builtintype" id="4447046">byte</span><span class="op" id="4447050">,</span>&nbsp;<span class="ident" id="4447052"><a href="/crypto/elliptic/elliptic.go.html#4447001">byteLen</a></span><span class="op" id="4447059">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447063">for</span>&nbsp;<span class="ident" id="4447067"><a href="/crypto/elliptic/elliptic.go.html#4446937">x</a></span>&nbsp;<span class="op" id="4447069">==</span>&nbsp;<span class="ident" id="4447072">nil</span>&nbsp;<span class="op" id="4447076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447080">_</span><span class="op" id="4447081">,</span>&nbsp;<span class="ident" id="4447083"><a href="/crypto/elliptic/elliptic.go.html#4446952">err</a></span>&nbsp;<span class="op" id="4447087">=</span>&nbsp;<span class="ident" id="4447089"><a href="/crypto/elliptic/elliptic.go.html#4440280">io</a></span><span class="op" id="4447091">.</span><span class="ident" id="4447092">ReadFull</span><span class="op" id="4447100">(</span><span class="ident" id="4447101"><a href="/crypto/elliptic/elliptic.go.html#4446907">rand</a></span><span class="op" id="4447105">,</span>&nbsp;<span class="ident" id="4447107"><a href="/crypto/elliptic/elliptic.go.html#4446924">priv</a></span><span class="op" id="4447111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447115">if</span>&nbsp;<span class="ident" id="4447118"><a href="/crypto/elliptic/elliptic.go.html#4446952">err</a></span>&nbsp;<span class="op" id="4447122">!=</span>&nbsp;<span class="ident" id="4447125">nil</span>&nbsp;<span class="op" id="4447129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447134">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4447143">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4447147">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4447221">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447275"><a href="/crypto/elliptic/elliptic.go.html#4446924">priv</a></span><span class="op" id="4447279">[</span><span class="num" id="4447280">0</span><span class="op" id="4447281">]</span>&nbsp;<span class="op" id="4447283">&amp;=</span>&nbsp;<span class="ident" id="4447286"><a href="/crypto/elliptic/elliptic.go.html#4446681">mask</a></span><span class="op" id="4447290">[</span><span class="ident" id="4447291"><a href="/crypto/elliptic/elliptic.go.html#4446966">bitSize</a></span><span class="op" id="4447298">%</span><span class="num" id="4447299">8</span><span class="op" id="4447300">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4447304">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4447376">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447433"><a href="/crypto/elliptic/elliptic.go.html#4446924">priv</a></span><span class="op" id="4447437">[</span><span class="num" id="4447438">1</span><span class="op" id="4447439">]</span>&nbsp;<span class="op" id="4447441">^=</span>&nbsp;<span class="num" id="4447444">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447451"><a href="/crypto/elliptic/elliptic.go.html#4446937">x</a></span><span class="op" id="4447452">,</span>&nbsp;<span class="ident" id="4447454"><a href="/crypto/elliptic/elliptic.go.html#4446940">y</a></span>&nbsp;<span class="op" id="4447456">=</span>&nbsp;<span class="ident" id="4447458"><a href="/crypto/elliptic/elliptic.go.html#4446894">curve</a></span><span class="op" id="4447463">.</span><span class="ident" id="4447464">ScalarBaseMult</span><span class="op" id="4447478">(</span><span class="ident" id="4447479"><a href="/crypto/elliptic/elliptic.go.html#4446924">priv</a></span><span class="op" id="4447483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4447486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447489">return</span><br>
<span class="lineno"></span><span class="op" id="4447496">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4447499">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="4447583">func</span>&nbsp;<span class="ident" id="4447588">Marshal</span><span class="op" id="4447595">(</span><span class="ident" id="4447596">curve</span>&nbsp;<span class="ident" id="4447602"><a href="/crypto/elliptic/elliptic.go.html#4440438">Curve</a></span><span class="op" id="4447607">,</span>&nbsp;<span class="ident" id="4447609">x</span><span class="op" id="4447610">,</span>&nbsp;<span class="ident" id="4447612">y</span>&nbsp;<span class="op" id="4447614">*</span><span class="ident" id="4447615"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4447618">.</span><span class="ident" id="4447619">Int</span><span class="op" id="4447622">)</span>&nbsp;<span class="op" id="4447624">[</span><span class="op" id="4447625">]</span><span class="builtintype" id="4447626">byte</span>&nbsp;<span class="op" id="4447631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447634">byteLen</span>&nbsp;<span class="op" id="4447642">:=</span>&nbsp;<span class="op" id="4447645">(</span><span class="ident" id="4447646"><a href="/crypto/elliptic/elliptic.go.html#4447596">curve</a></span><span class="op" id="4447651">.</span><span class="ident" id="4447652">Params</span><span class="op" id="4447658">(</span><span class="op" id="4447659">)</span><span class="op" id="4447660">.</span><span class="ident" id="4447661">BitSize</span>&nbsp;<span class="op" id="4447669">+</span>&nbsp;<span class="num" id="4447671">7</span><span class="op" id="4447672">)</span>&nbsp;<span class="op" id="4447674">&gt;&gt;</span>&nbsp;<span class="num" id="4447677">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447681">ret</span>&nbsp;<span class="op" id="4447685">:=</span>&nbsp;<span class="builtinfunc" id="4447688">make</span><span class="op" id="4447692">(</span><span class="op" id="4447693">[</span><span class="op" id="4447694">]</span><span class="builtintype" id="4447695">byte</span><span class="op" id="4447699">,</span>&nbsp;<span class="num" id="4447701">1</span><span class="op" id="4447702">+</span><span class="num" id="4447703">2</span><span class="op" id="4447704">*</span><span class="ident" id="4447705"><a href="/crypto/elliptic/elliptic.go.html#4447634">byteLen</a></span><span class="op" id="4447712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447715"><a href="/crypto/elliptic/elliptic.go.html#4447681">ret</a></span><span class="op" id="4447718">[</span><span class="num" id="4447719">0</span><span class="op" id="4447720">]</span>&nbsp;<span class="op" id="4447722">=</span>&nbsp;<span class="num" id="4447724">4</span>&nbsp;<span class="comment" id="4447726">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447750">xBytes</span>&nbsp;<span class="op" id="4447757">:=</span>&nbsp;<span class="ident" id="4447760"><a href="/crypto/elliptic/elliptic.go.html#4447609">x</a></span><span class="op" id="4447761">.</span><span class="ident" id="4447762">Bytes</span><span class="op" id="4447767">(</span><span class="op" id="4447768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4447771">copy</span><span class="op" id="4447775">(</span><span class="ident" id="4447776"><a href="/crypto/elliptic/elliptic.go.html#4447681">ret</a></span><span class="op" id="4447779">[</span><span class="num" id="4447780">1</span><span class="op" id="4447781">+</span><span class="ident" id="4447782"><a href="/crypto/elliptic/elliptic.go.html#4447634">byteLen</a></span><span class="op" id="4447789">-</span><span class="builtinfunc" id="4447790">len</span><span class="op" id="4447793">(</span><span class="ident" id="4447794"><a href="/crypto/elliptic/elliptic.go.html#4447750">xBytes</a></span><span class="op" id="4447800">)</span><span class="op" id="4447801">:</span><span class="op" id="4447802">]</span><span class="op" id="4447803">,</span>&nbsp;<span class="ident" id="4447805"><a href="/crypto/elliptic/elliptic.go.html#4447750">xBytes</a></span><span class="op" id="4447811">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447814">yBytes</span>&nbsp;<span class="op" id="4447821">:=</span>&nbsp;<span class="ident" id="4447824"><a href="/crypto/elliptic/elliptic.go.html#4447612">y</a></span><span class="op" id="4447825">.</span><span class="ident" id="4447826">Bytes</span><span class="op" id="4447831">(</span><span class="op" id="4447832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4447835">copy</span><span class="op" id="4447839">(</span><span class="ident" id="4447840"><a href="/crypto/elliptic/elliptic.go.html#4447681">ret</a></span><span class="op" id="4447843">[</span><span class="num" id="4447844">1</span><span class="op" id="4447845">+</span><span class="num" id="4447846">2</span><span class="op" id="4447847">*</span><span class="ident" id="4447848"><a href="/crypto/elliptic/elliptic.go.html#4447634">byteLen</a></span><span class="op" id="4447855">-</span><span class="builtinfunc" id="4447856">len</span><span class="op" id="4447859">(</span><span class="ident" id="4447860"><a href="/crypto/elliptic/elliptic.go.html#4447814">yBytes</a></span><span class="op" id="4447866">)</span><span class="op" id="4447867">:</span><span class="op" id="4447868">]</span><span class="op" id="4447869">,</span>&nbsp;<span class="ident" id="4447871"><a href="/crypto/elliptic/elliptic.go.html#4447814">yBytes</a></span><span class="op" id="4447877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447880">return</span>&nbsp;<span class="ident" id="4447887"><a href="/crypto/elliptic/elliptic.go.html#4447681">ret</a></span><br>
<span class="lineno"></span><span class="op" id="4447891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4447894">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4447986">func</span>&nbsp;<span class="ident" id="4447991">Unmarshal</span><span class="op" id="4448000">(</span><span class="ident" id="4448001">curve</span>&nbsp;<span class="ident" id="4448007"><a href="/crypto/elliptic/elliptic.go.html#4440438">Curve</a></span><span class="op" id="4448012">,</span>&nbsp;<span class="ident" id="4448014">data</span>&nbsp;<span class="op" id="4448019">[</span><span class="op" id="4448020">]</span><span class="builtintype" id="4448021">byte</span><span class="op" id="4448025">)</span>&nbsp;<span class="op" id="4448027">(</span><span class="ident" id="4448028">x</span><span class="op" id="4448029">,</span>&nbsp;<span class="ident" id="4448031">y</span>&nbsp;<span class="op" id="4448033">*</span><span class="ident" id="4448034"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4448037">.</span><span class="ident" id="4448038">Int</span><span class="op" id="4448041">)</span>&nbsp;<span class="op" id="4448043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448046">byteLen</span>&nbsp;<span class="op" id="4448054">:=</span>&nbsp;<span class="op" id="4448057">(</span><span class="ident" id="4448058"><a href="/crypto/elliptic/elliptic.go.html#4448001">curve</a></span><span class="op" id="4448063">.</span><span class="ident" id="4448064">Params</span><span class="op" id="4448070">(</span><span class="op" id="4448071">)</span><span class="op" id="4448072">.</span><span class="ident" id="4448073">BitSize</span>&nbsp;<span class="op" id="4448081">+</span>&nbsp;<span class="num" id="4448083">7</span><span class="op" id="4448084">)</span>&nbsp;<span class="op" id="4448086">&gt;&gt;</span>&nbsp;<span class="num" id="4448089">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448092">if</span>&nbsp;<span class="builtinfunc" id="4448095">len</span><span class="op" id="4448098">(</span><span class="ident" id="4448099"><a href="/crypto/elliptic/elliptic.go.html#4448014">data</a></span><span class="op" id="4448103">)</span>&nbsp;<span class="op" id="4448105">!=</span>&nbsp;<span class="num" id="4448108">1</span><span class="op" id="4448109">+</span><span class="num" id="4448110">2</span><span class="op" id="4448111">*</span><span class="ident" id="4448112"><a href="/crypto/elliptic/elliptic.go.html#4448046">byteLen</a></span>&nbsp;<span class="op" id="4448120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448124">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4448132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448135">if</span>&nbsp;<span class="ident" id="4448138"><a href="/crypto/elliptic/elliptic.go.html#4448014">data</a></span><span class="op" id="4448142">[</span><span class="num" id="4448143">0</span><span class="op" id="4448144">]</span>&nbsp;<span class="op" id="4448146">!=</span>&nbsp;<span class="num" id="4448149">4</span>&nbsp;<span class="op" id="4448151">{</span>&nbsp;<span class="comment" id="4448153">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448176">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4448184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448187"><a href="/crypto/elliptic/elliptic.go.html#4448028">x</a></span>&nbsp;<span class="op" id="4448189">=</span>&nbsp;<span class="builtinfunc" id="4448191">new</span><span class="op" id="4448194">(</span><span class="ident" id="4448195"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4448198">.</span><span class="ident" id="4448199">Int</span><span class="op" id="4448202">)</span><span class="op" id="4448203">.</span><span class="ident" id="4448204">SetBytes</span><span class="op" id="4448212">(</span><span class="ident" id="4448213"><a href="/crypto/elliptic/elliptic.go.html#4448014">data</a></span><span class="op" id="4448217">[</span><span class="num" id="4448218">1</span>&nbsp;<span class="op" id="4448220">:</span>&nbsp;<span class="num" id="4448222">1</span><span class="op" id="4448223">+</span><span class="ident" id="4448224"><a href="/crypto/elliptic/elliptic.go.html#4448046">byteLen</a></span><span class="op" id="4448231">]</span><span class="op" id="4448232">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448235"><a href="/crypto/elliptic/elliptic.go.html#4448031">y</a></span>&nbsp;<span class="op" id="4448237">=</span>&nbsp;<span class="builtinfunc" id="4448239">new</span><span class="op" id="4448242">(</span><span class="ident" id="4448243"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4448246">.</span><span class="ident" id="4448247">Int</span><span class="op" id="4448250">)</span><span class="op" id="4448251">.</span><span class="ident" id="4448252">SetBytes</span><span class="op" id="4448260">(</span><span class="ident" id="4448261"><a href="/crypto/elliptic/elliptic.go.html#4448014">data</a></span><span class="op" id="4448265">[</span><span class="num" id="4448266">1</span><span class="op" id="4448267">+</span><span class="ident" id="4448268"><a href="/crypto/elliptic/elliptic.go.html#4448046">byteLen</a></span><span class="op" id="4448275">:</span><span class="op" id="4448276">]</span><span class="op" id="4448277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448280">return</span><br>
<span class="lineno"></span><span class="op" id="4448287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4448290">var</span>&nbsp;<span class="ident" id="4448294">initonce</span>&nbsp;<span class="ident" id="4448303"><a href="/crypto/elliptic/elliptic.go.html#4440298">sync</a></span><span class="op" id="4448307">.</span><span class="ident" id="4448308">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="4448313">var</span>&nbsp;<span class="ident" id="4448317">p384</span>&nbsp;<span class="op" id="4448322">*</span><span class="ident" id="4448323"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><br>
<span class="lineno"></span><span class="keyword" id="4448335">var</span>&nbsp;<span class="ident" id="4448339">p521</span>&nbsp;<span class="op" id="4448344">*</span><span class="ident" id="4448345"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4448358">func</span>&nbsp;<span class="ident" id="4448363">initAll</span><span class="op" id="4448370">(</span><span class="op" id="4448371">)</span>&nbsp;<span class="op" id="4448373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448376"><a href="/crypto/elliptic/p224.go.html#4451180">initP224</a></span><span class="op" id="4448384">(</span><span class="op" id="4448385">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448388"><a href="/crypto/elliptic/p256.go.html#4471933">initP256</a></span><span class="op" id="4448396">(</span><span class="op" id="4448397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448400"><a href="/crypto/elliptic/elliptic.go.html#4448431">initP384</a></span><span class="op" id="4448408">(</span><span class="op" id="4448409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448412"><a href="/crypto/elliptic/elliptic.go.html#4449273">initP521</a></span><span class="op" id="4448420">(</span><span class="op" id="4448421">)</span><br>
<span class="lineno"></span><span class="op" id="4448423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4448426">func</span>&nbsp;<span class="ident" id="4448431">initP384</span><span class="op" id="4448439">(</span><span class="op" id="4448440">)</span>&nbsp;<span class="op" id="4448442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4448445">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448479"><a href="/crypto/elliptic/elliptic.go.html#4448317">p384</a></span>&nbsp;<span class="op" id="4448484">=</span>&nbsp;<span class="builtinfunc" id="4448486">new</span><span class="op" id="4448489">(</span><span class="ident" id="4448490"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><span class="op" id="4448501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448504"><a href="/crypto/elliptic/elliptic.go.html#4448317">p384</a></span><span class="op" id="4448508">.</span><span class="ident" id="4448509">P</span><span class="op" id="4448510">,</span>&nbsp;<span class="ident" id="4448512">_</span>&nbsp;<span class="op" id="4448514">=</span>&nbsp;<span class="builtinfunc" id="4448516">new</span><span class="op" id="4448519">(</span><span class="ident" id="4448520"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4448523">.</span><span class="ident" id="4448524">Int</span><span class="op" id="4448527">)</span><span class="op" id="4448528">.</span><span class="ident" id="4448529">SetString</span><span class="op" id="4448538">(</span><span class="string" id="4448539">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="4448657">,</span>&nbsp;<span class="num" id="4448659">10</span><span class="op" id="4448661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448664"><a href="/crypto/elliptic/elliptic.go.html#4448317">p384</a></span><span class="op" id="4448668">.</span><span class="ident" id="4448669">N</span><span class="op" id="4448670">,</span>&nbsp;<span class="ident" id="4448672">_</span>&nbsp;<span class="op" id="4448674">=</span>&nbsp;<span class="builtinfunc" id="4448676">new</span><span class="op" id="4448679">(</span><span class="ident" id="4448680"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4448683">.</span><span class="ident" id="4448684">Int</span><span class="op" id="4448687">)</span><span class="op" id="4448688">.</span><span class="ident" id="4448689">SetString</span><span class="op" id="4448698">(</span><span class="string" id="4448699">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="4448817">,</span>&nbsp;<span class="num" id="4448819">10</span><span class="op" id="4448821">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448824"><a href="/crypto/elliptic/elliptic.go.html#4448317">p384</a></span><span class="op" id="4448828">.</span><span class="ident" id="4448829">B</span><span class="op" id="4448830">,</span>&nbsp;<span class="ident" id="4448832">_</span>&nbsp;<span class="op" id="4448834">=</span>&nbsp;<span class="builtinfunc" id="4448836">new</span><span class="op" id="4448839">(</span><span class="ident" id="4448840"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4448843">.</span><span class="ident" id="4448844">Int</span><span class="op" id="4448847">)</span><span class="op" id="4448848">.</span><span class="ident" id="4448849">SetString</span><span class="op" id="4448858">(</span><span class="string" id="4448859">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="4448957">,</span>&nbsp;<span class="num" id="4448959">16</span><span class="op" id="4448961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448964"><a href="/crypto/elliptic/elliptic.go.html#4448317">p384</a></span><span class="op" id="4448968">.</span><span class="ident" id="4448969">Gx</span><span class="op" id="4448971">,</span>&nbsp;<span class="ident" id="4448973">_</span>&nbsp;<span class="op" id="4448975">=</span>&nbsp;<span class="builtinfunc" id="4448977">new</span><span class="op" id="4448980">(</span><span class="ident" id="4448981"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4448984">.</span><span class="ident" id="4448985">Int</span><span class="op" id="4448988">)</span><span class="op" id="4448989">.</span><span class="ident" id="4448990">SetString</span><span class="op" id="4448999">(</span><span class="string" id="4449000">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="4449098">,</span>&nbsp;<span class="num" id="4449100">16</span><span class="op" id="4449102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449105"><a href="/crypto/elliptic/elliptic.go.html#4448317">p384</a></span><span class="op" id="4449109">.</span><span class="ident" id="4449110">Gy</span><span class="op" id="4449112">,</span>&nbsp;<span class="ident" id="4449114">_</span>&nbsp;<span class="op" id="4449116">=</span>&nbsp;<span class="builtinfunc" id="4449118">new</span><span class="op" id="4449121">(</span><span class="ident" id="4449122"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4449125">.</span><span class="ident" id="4449126">Int</span><span class="op" id="4449129">)</span><span class="op" id="4449130">.</span><span class="ident" id="4449131">SetString</span><span class="op" id="4449140">(</span><span class="string" id="4449141">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="4449239">,</span>&nbsp;<span class="num" id="4449241">16</span><span class="op" id="4449243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449246"><a href="/crypto/elliptic/elliptic.go.html#4448317">p384</a></span><span class="op" id="4449250">.</span><span class="ident" id="4449251">BitSize</span>&nbsp;<span class="op" id="4449259">=</span>&nbsp;<span class="num" id="4449261">384</span><br>
<span class="lineno"></span><span class="op" id="4449265">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="4449268">func</span>&nbsp;<span class="ident" id="4449273">initP521</span><span class="op" id="4449281">(</span><span class="op" id="4449282">)</span>&nbsp;<span class="op" id="4449284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4449287">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449321"><a href="/crypto/elliptic/elliptic.go.html#4448339">p521</a></span>&nbsp;<span class="op" id="4449326">=</span>&nbsp;<span class="builtinfunc" id="4449328">new</span><span class="op" id="4449331">(</span><span class="ident" id="4449332"><a href="/crypto/elliptic/elliptic.go.html#4441213">CurveParams</a></span><span class="op" id="4449343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449346"><a href="/crypto/elliptic/elliptic.go.html#4448339">p521</a></span><span class="op" id="4449350">.</span><span class="ident" id="4449351">P</span><span class="op" id="4449352">,</span>&nbsp;<span class="ident" id="4449354">_</span>&nbsp;<span class="op" id="4449356">=</span>&nbsp;<span class="builtinfunc" id="4449358">new</span><span class="op" id="4449361">(</span><span class="ident" id="4449362"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4449365">.</span><span class="ident" id="4449366">Int</span><span class="op" id="4449369">)</span><span class="op" id="4449370">.</span><span class="ident" id="4449371">SetString</span><span class="op" id="4449380">(</span><span class="string" id="4449381">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="4449540">,</span>&nbsp;<span class="num" id="4449542">10</span><span class="op" id="4449544">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449547"><a href="/crypto/elliptic/elliptic.go.html#4448339">p521</a></span><span class="op" id="4449551">.</span><span class="ident" id="4449552">N</span><span class="op" id="4449553">,</span>&nbsp;<span class="ident" id="4449555">_</span>&nbsp;<span class="op" id="4449557">=</span>&nbsp;<span class="builtinfunc" id="4449559">new</span><span class="op" id="4449562">(</span><span class="ident" id="4449563"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4449566">.</span><span class="ident" id="4449567">Int</span><span class="op" id="4449570">)</span><span class="op" id="4449571">.</span><span class="ident" id="4449572">SetString</span><span class="op" id="4449581">(</span><span class="string" id="4449582">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="4449741">,</span>&nbsp;<span class="num" id="4449743">10</span><span class="op" id="4449745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449748"><a href="/crypto/elliptic/elliptic.go.html#4448339">p521</a></span><span class="op" id="4449752">.</span><span class="ident" id="4449753">B</span><span class="op" id="4449754">,</span>&nbsp;<span class="ident" id="4449756">_</span>&nbsp;<span class="op" id="4449758">=</span>&nbsp;<span class="builtinfunc" id="4449760">new</span><span class="op" id="4449763">(</span><span class="ident" id="4449764"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4449767">.</span><span class="ident" id="4449768">Int</span><span class="op" id="4449771">)</span><span class="op" id="4449772">.</span><span class="ident" id="4449773">SetString</span><span class="op" id="4449782">(</span><span class="string" id="4449783">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="4449916">,</span>&nbsp;<span class="num" id="4449918">16</span><span class="op" id="4449920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449923"><a href="/crypto/elliptic/elliptic.go.html#4448339">p521</a></span><span class="op" id="4449927">.</span><span class="ident" id="4449928">Gx</span><span class="op" id="4449930">,</span>&nbsp;<span class="ident" id="4449932">_</span>&nbsp;<span class="op" id="4449934">=</span>&nbsp;<span class="builtinfunc" id="4449936">new</span><span class="op" id="4449939">(</span><span class="ident" id="4449940"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4449943">.</span><span class="ident" id="4449944">Int</span><span class="op" id="4449947">)</span><span class="op" id="4449948">.</span><span class="ident" id="4449949">SetString</span><span class="op" id="4449958">(</span><span class="string" id="4449959">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="4450091">,</span>&nbsp;<span class="num" id="4450093">16</span><span class="op" id="4450095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450098"><a href="/crypto/elliptic/elliptic.go.html#4448339">p521</a></span><span class="op" id="4450102">.</span><span class="ident" id="4450103">Gy</span><span class="op" id="4450105">,</span>&nbsp;<span class="ident" id="4450107">_</span>&nbsp;<span class="op" id="4450109">=</span>&nbsp;<span class="builtinfunc" id="4450111">new</span><span class="op" id="4450114">(</span><span class="ident" id="4450115"><a href="/crypto/elliptic/elliptic.go.html#4440286">big</a></span><span class="op" id="4450118">.</span><span class="ident" id="4450119">Int</span><span class="op" id="4450122">)</span><span class="op" id="4450123">.</span><span class="ident" id="4450124">SetString</span><span class="op" id="4450133">(</span><span class="string" id="4450134">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="4450267">,</span>&nbsp;<span class="num" id="4450269">16</span><span class="op" id="4450271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450274"><a href="/crypto/elliptic/elliptic.go.html#4448339">p521</a></span><span class="op" id="4450278">.</span><span class="ident" id="4450279">BitSize</span>&nbsp;<span class="op" id="4450287">=</span>&nbsp;<span class="num" id="4450289">521</span><br>
<span class="lineno">355</span><span class="op" id="4450293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4450296">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="4450375">func</span>&nbsp;<span class="ident" id="4450380">P256</span><span class="op" id="4450384">(</span><span class="op" id="4450385">)</span>&nbsp;<span class="ident" id="4450387"><a href="/crypto/elliptic/elliptic.go.html#4440438">Curve</a></span>&nbsp;<span class="op" id="4450393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450396"><a href="/crypto/elliptic/elliptic.go.html#4448294">initonce</a></span><span class="op" id="4450404">.</span><span class="ident" id="4450405">Do</span><span class="op" id="4450407">(</span><span class="ident" id="4450408"><a href="/crypto/elliptic/elliptic.go.html#4448363">initAll</a></span><span class="op" id="4450415">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450418">return</span>&nbsp;<span class="ident" id="4450425"><a href="/crypto/elliptic/p256.go.html#4471800">p256</a></span><br>
<span class="lineno"></span><span class="op" id="4450430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4450433">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="4450512">func</span>&nbsp;<span class="ident" id="4450517">P384</span><span class="op" id="4450521">(</span><span class="op" id="4450522">)</span>&nbsp;<span class="ident" id="4450524"><a href="/crypto/elliptic/elliptic.go.html#4440438">Curve</a></span>&nbsp;<span class="op" id="4450530">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450533"><a href="/crypto/elliptic/elliptic.go.html#4448294">initonce</a></span><span class="op" id="4450541">.</span><span class="ident" id="4450542">Do</span><span class="op" id="4450544">(</span><span class="ident" id="4450545"><a href="/crypto/elliptic/elliptic.go.html#4448363">initAll</a></span><span class="op" id="4450552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450555">return</span>&nbsp;<span class="ident" id="4450562"><a href="/crypto/elliptic/elliptic.go.html#4448317">p384</a></span><br>
<span class="lineno"></span><span class="op" id="4450567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4450570">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="4450649">func</span>&nbsp;<span class="ident" id="4450654">P521</span><span class="op" id="4450658">(</span><span class="op" id="4450659">)</span>&nbsp;<span class="ident" id="4450661"><a href="/crypto/elliptic/elliptic.go.html#4440438">Curve</a></span>&nbsp;<span class="op" id="4450667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450670"><a href="/crypto/elliptic/elliptic.go.html#4448294">initonce</a></span><span class="op" id="4450678">.</span><span class="ident" id="4450679">Do</span><span class="op" id="4450681">(</span><span class="ident" id="4450682"><a href="/crypto/elliptic/elliptic.go.html#4448363">initAll</a></span><span class="op" id="4450689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450692">return</span>&nbsp;<span class="ident" id="4450699"><a href="/crypto/elliptic/elliptic.go.html#4448339">p521</a></span><br>
<span class="lineno"></span><span class="op" id="4450704">}</span>
</div>
</body>
</html>
