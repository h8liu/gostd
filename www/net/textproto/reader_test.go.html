<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7662461">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7662517">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7662571">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7662622">package</span>&nbsp;<span class="ident" id="7662630">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7662641">import</span>&nbsp;<span class="op" id="7662648">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7662651">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7662660">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7662669">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7662675">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7662686">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7662697">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7662707">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7662710">type</span>&nbsp;<span class="ident" id="7662715">canonicalHeaderKeyTest</span>&nbsp;<span class="keyword" id="7662738">struct</span>&nbsp;<span class="op" id="7662745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662748">in</span><span class="op" id="7662750">,</span>&nbsp;<span class="ident" id="7662752">out</span>&nbsp;<span class="builtintype" id="7662756">string</span><br>
<span class="lineno"></span><span class="op" id="7662763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7662766">var</span>&nbsp;<span class="ident" id="7662770">canonicalHeaderKeyTests</span>&nbsp;<span class="op" id="7662794">=</span>&nbsp;<span class="op" id="7662796">[</span><span class="op" id="7662797">]</span><span class="ident" id="7662798"><a href="/net/textproto/reader_test.go.html#7662715">canonicalHeaderKeyTest</a></span><span class="op" id="7662820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662823">{</span><span class="string" id="7662824">&#34;a-b-c&#34;</span><span class="op" id="7662831">,</span>&nbsp;<span class="string" id="7662833">&#34;A-B-C&#34;</span><span class="op" id="7662840">}</span><span class="op" id="7662841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662844">{</span><span class="string" id="7662845">&#34;a-1-c&#34;</span><span class="op" id="7662852">,</span>&nbsp;<span class="string" id="7662854">&#34;A-1-C&#34;</span><span class="op" id="7662861">}</span><span class="op" id="7662862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662865">{</span><span class="string" id="7662866">&#34;User-Agent&#34;</span><span class="op" id="7662878">,</span>&nbsp;<span class="string" id="7662880">&#34;User-Agent&#34;</span><span class="op" id="7662892">}</span><span class="op" id="7662893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662896">{</span><span class="string" id="7662897">&#34;uSER-aGENT&#34;</span><span class="op" id="7662909">,</span>&nbsp;<span class="string" id="7662911">&#34;User-Agent&#34;</span><span class="op" id="7662923">}</span><span class="op" id="7662924">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662927">{</span><span class="string" id="7662928">&#34;user-agent&#34;</span><span class="op" id="7662940">,</span>&nbsp;<span class="string" id="7662942">&#34;User-Agent&#34;</span><span class="op" id="7662954">}</span><span class="op" id="7662955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662958">{</span><span class="string" id="7662959">&#34;USER-AGENT&#34;</span><span class="op" id="7662971">,</span>&nbsp;<span class="string" id="7662973">&#34;User-Agent&#34;</span><span class="op" id="7662985">}</span><span class="op" id="7662986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662989">{</span><span class="string" id="7662990">&#34;üser-agenT&#34;</span><span class="op" id="7663003">,</span>&nbsp;<span class="string" id="7663005">&#34;üser-Agent&#34;</span><span class="op" id="7663018">}</span><span class="op" id="7663019">,</span>&nbsp;<span class="comment" id="7663021">//&nbsp;non-ASCII&nbsp;unchanged</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7663046">//&nbsp;This&nbsp;caused&nbsp;a&nbsp;panic&nbsp;due&nbsp;to&nbsp;mishandling&nbsp;of&nbsp;a&nbsp;space:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7663101">{</span><span class="string" id="7663102">&#34;C&nbsp;Ontent-Transfer-Encoding&#34;</span><span class="op" id="7663130">,</span>&nbsp;<span class="string" id="7663132">&#34;C-Ontent-Transfer-Encoding&#34;</span><span class="op" id="7663160">}</span><span class="op" id="7663161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7663164">{</span><span class="string" id="7663165">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7663174">,</span>&nbsp;<span class="string" id="7663176">&#34;Foo-Bar&#34;</span><span class="op" id="7663185">}</span><span class="op" id="7663186">,</span><br>
<span class="lineno"></span><span class="op" id="7663188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7663191">func</span>&nbsp;<span class="ident" id="7663196">TestCanonicalMIMEHeaderKey</span><span class="op" id="7663222">(</span><span class="ident" id="7663223">t</span>&nbsp;<span class="op" id="7663225">*</span><span class="ident" id="7663226"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7663233">.</span><span class="ident" id="7663234">T</span><span class="op" id="7663235">)</span>&nbsp;<span class="op" id="7663237">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663240">for</span>&nbsp;<span class="ident" id="7663244">_</span><span class="op" id="7663245">,</span>&nbsp;<span class="ident" id="7663247">tt</span>&nbsp;<span class="op" id="7663250">:=</span>&nbsp;<span class="keyword" id="7663253">range</span>&nbsp;<span class="ident" id="7663259"><a href="/net/textproto/reader_test.go.html#7662770">canonicalHeaderKeyTests</a></span>&nbsp;<span class="op" id="7663283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663287">if</span>&nbsp;<span class="ident" id="7663290">s</span>&nbsp;<span class="op" id="7663292">:=</span>&nbsp;<span class="ident" id="7663295"><a href="/net/textproto/reader.go.html#3644256">CanonicalMIMEHeaderKey</a></span><span class="op" id="7663317">(</span><span class="ident" id="7663318"><a href="/net/textproto/reader_test.go.html#7663247">tt</a></span><span class="op" id="7663320">.</span><span class="ident" id="7663321">in</span><span class="op" id="7663323">)</span><span class="op" id="7663324">;</span>&nbsp;<span class="ident" id="7663326"><a href="/net/textproto/reader_test.go.html#7663290">s</a></span>&nbsp;<span class="op" id="7663328">!=</span>&nbsp;<span class="ident" id="7663331"><a href="/net/textproto/reader_test.go.html#7663247">tt</a></span><span class="op" id="7663333">.</span><span class="ident" id="7663334">out</span>&nbsp;<span class="op" id="7663338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663343"><a href="/net/textproto/reader_test.go.html#7663223">t</a></span><span class="op" id="7663344">.</span><span class="ident" id="7663345">Errorf</span><span class="op" id="7663351">(</span><span class="string" id="7663352">&#34;CanonicalMIMEHeaderKey(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7663394">,</span>&nbsp;<span class="ident" id="7663396"><a href="/net/textproto/reader_test.go.html#7663247">tt</a></span><span class="op" id="7663398">.</span><span class="ident" id="7663399">in</span><span class="op" id="7663401">,</span>&nbsp;<span class="ident" id="7663403"><a href="/net/textproto/reader_test.go.html#7663290">s</a></span><span class="op" id="7663404">,</span>&nbsp;<span class="ident" id="7663406"><a href="/net/textproto/reader_test.go.html#7663247">tt</a></span><span class="op" id="7663408">.</span><span class="ident" id="7663409">out</span><span class="op" id="7663412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7663416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7663419">}</span><br>
<span class="lineno">40</span><span class="op" id="7663421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7663424">func</span>&nbsp;<span class="ident" id="7663429">reader</span><span class="op" id="7663435">(</span><span class="ident" id="7663436">s</span>&nbsp;<span class="builtintype" id="7663438">string</span><span class="op" id="7663444">)</span>&nbsp;<span class="op" id="7663446">*</span><span class="ident" id="7663447"><a href="/net/textproto/reader.go.html#3630518">Reader</a></span>&nbsp;<span class="op" id="7663454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663457">return</span>&nbsp;<span class="ident" id="7663464"><a href="/net/textproto/reader.go.html#3630688">NewReader</a></span><span class="op" id="7663473">(</span><span class="ident" id="7663474"><a href="/net/textproto/reader_test.go.html#7662651">bufio</a></span><span class="op" id="7663479">.</span><span class="ident" id="7663480">NewReader</span><span class="op" id="7663489">(</span><span class="ident" id="7663490"><a href="/net/textproto/reader_test.go.html#7662686">strings</a></span><span class="op" id="7663497">.</span><span class="ident" id="7663498">NewReader</span><span class="op" id="7663507">(</span><span class="ident" id="7663508"><a href="/net/textproto/reader_test.go.html#7663436">s</a></span><span class="op" id="7663509">)</span><span class="op" id="7663510">)</span><span class="op" id="7663511">)</span><br>
<span class="lineno"></span><span class="op" id="7663513">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7663516">func</span>&nbsp;<span class="ident" id="7663521">TestReadLine</span><span class="op" id="7663533">(</span><span class="ident" id="7663534">t</span>&nbsp;<span class="op" id="7663536">*</span><span class="ident" id="7663537"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7663544">.</span><span class="ident" id="7663545">T</span><span class="op" id="7663546">)</span>&nbsp;<span class="op" id="7663548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663551">r</span>&nbsp;<span class="op" id="7663553">:=</span>&nbsp;<span class="ident" id="7663556"><a href="/net/textproto/reader_test.go.html#7663429">reader</a></span><span class="op" id="7663562">(</span><span class="string" id="7663563">&#34;line1\nline2\n&#34;</span><span class="op" id="7663579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663582">s</span><span class="op" id="7663583">,</span>&nbsp;<span class="ident" id="7663585">err</span>&nbsp;<span class="op" id="7663589">:=</span>&nbsp;<span class="ident" id="7663592"><a href="/net/textproto/reader_test.go.html#7663551">r</a></span><span class="op" id="7663593">.</span><span class="ident" id="7663594">ReadLine</span><span class="op" id="7663602">(</span><span class="op" id="7663603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663606">if</span>&nbsp;<span class="ident" id="7663609"><a href="/net/textproto/reader_test.go.html#7663582">s</a></span>&nbsp;<span class="op" id="7663611">!=</span>&nbsp;<span class="string" id="7663614">&#34;line1&#34;</span>&nbsp;<span class="op" id="7663622">||</span>&nbsp;<span class="ident" id="7663625"><a href="/net/textproto/reader_test.go.html#7663585">err</a></span>&nbsp;<span class="op" id="7663629">!=</span>&nbsp;<span class="ident" id="7663632">nil</span>&nbsp;<span class="op" id="7663636">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663640"><a href="/net/textproto/reader_test.go.html#7663534">t</a></span><span class="op" id="7663641">.</span><span class="ident" id="7663642">Fatalf</span><span class="op" id="7663648">(</span><span class="string" id="7663649">&#34;Line&nbsp;1:&nbsp;%s,&nbsp;%v&#34;</span><span class="op" id="7663665">,</span>&nbsp;<span class="ident" id="7663667"><a href="/net/textproto/reader_test.go.html#7663582">s</a></span><span class="op" id="7663668">,</span>&nbsp;<span class="ident" id="7663670"><a href="/net/textproto/reader_test.go.html#7663585">err</a></span><span class="op" id="7663673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7663676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663679"><a href="/net/textproto/reader_test.go.html#7663582">s</a></span><span class="op" id="7663680">,</span>&nbsp;<span class="ident" id="7663682"><a href="/net/textproto/reader_test.go.html#7663585">err</a></span>&nbsp;<span class="op" id="7663686">=</span>&nbsp;<span class="ident" id="7663688"><a href="/net/textproto/reader_test.go.html#7663551">r</a></span><span class="op" id="7663689">.</span><span class="ident" id="7663690">ReadLine</span><span class="op" id="7663698">(</span><span class="op" id="7663699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663702">if</span>&nbsp;<span class="ident" id="7663705"><a href="/net/textproto/reader_test.go.html#7663582">s</a></span>&nbsp;<span class="op" id="7663707">!=</span>&nbsp;<span class="string" id="7663710">&#34;line2&#34;</span>&nbsp;<span class="op" id="7663718">||</span>&nbsp;<span class="ident" id="7663721"><a href="/net/textproto/reader_test.go.html#7663585">err</a></span>&nbsp;<span class="op" id="7663725">!=</span>&nbsp;<span class="ident" id="7663728">nil</span>&nbsp;<span class="op" id="7663732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663736"><a href="/net/textproto/reader_test.go.html#7663534">t</a></span><span class="op" id="7663737">.</span><span class="ident" id="7663738">Fatalf</span><span class="op" id="7663744">(</span><span class="string" id="7663745">&#34;Line&nbsp;2:&nbsp;%s,&nbsp;%v&#34;</span><span class="op" id="7663761">,</span>&nbsp;<span class="ident" id="7663763"><a href="/net/textproto/reader_test.go.html#7663582">s</a></span><span class="op" id="7663764">,</span>&nbsp;<span class="ident" id="7663766"><a href="/net/textproto/reader_test.go.html#7663585">err</a></span><span class="op" id="7663769">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7663772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663775"><a href="/net/textproto/reader_test.go.html#7663582">s</a></span><span class="op" id="7663776">,</span>&nbsp;<span class="ident" id="7663778"><a href="/net/textproto/reader_test.go.html#7663585">err</a></span>&nbsp;<span class="op" id="7663782">=</span>&nbsp;<span class="ident" id="7663784"><a href="/net/textproto/reader_test.go.html#7663551">r</a></span><span class="op" id="7663785">.</span><span class="ident" id="7663786">ReadLine</span><span class="op" id="7663794">(</span><span class="op" id="7663795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663798">if</span>&nbsp;<span class="ident" id="7663801"><a href="/net/textproto/reader_test.go.html#7663582">s</a></span>&nbsp;<span class="op" id="7663803">!=</span>&nbsp;<span class="string" id="7663806">&#34;&#34;</span>&nbsp;<span class="op" id="7663809">||</span>&nbsp;<span class="ident" id="7663812"><a href="/net/textproto/reader_test.go.html#7663585">err</a></span>&nbsp;<span class="op" id="7663816">!=</span>&nbsp;<span class="ident" id="7663819"><a href="/net/textproto/reader_test.go.html#7662669">io</a></span><span class="op" id="7663821">.</span><span class="ident" id="7663822">EOF</span>&nbsp;<span class="op" id="7663826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663830"><a href="/net/textproto/reader_test.go.html#7663534">t</a></span><span class="op" id="7663831">.</span><span class="ident" id="7663832">Fatalf</span><span class="op" id="7663838">(</span><span class="string" id="7663839">&#34;EOF:&nbsp;%s,&nbsp;%v&#34;</span><span class="op" id="7663852">,</span>&nbsp;<span class="ident" id="7663854"><a href="/net/textproto/reader_test.go.html#7663582">s</a></span><span class="op" id="7663855">,</span>&nbsp;<span class="ident" id="7663857"><a href="/net/textproto/reader_test.go.html#7663585">err</a></span><span class="op" id="7663860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7663863">}</span><br>
<span class="lineno">60</span><span class="op" id="7663865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7663868">func</span>&nbsp;<span class="ident" id="7663873">TestReadContinuedLine</span><span class="op" id="7663894">(</span><span class="ident" id="7663895">t</span>&nbsp;<span class="op" id="7663897">*</span><span class="ident" id="7663898"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7663905">.</span><span class="ident" id="7663906">T</span><span class="op" id="7663907">)</span>&nbsp;<span class="op" id="7663909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663912">r</span>&nbsp;<span class="op" id="7663914">:=</span>&nbsp;<span class="ident" id="7663917"><a href="/net/textproto/reader_test.go.html#7663429">reader</a></span><span class="op" id="7663923">(</span><span class="string" id="7663924">&#34;line1\nline\n&nbsp;2\nline3\n&#34;</span><span class="op" id="7663950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663953">s</span><span class="op" id="7663954">,</span>&nbsp;<span class="ident" id="7663956">err</span>&nbsp;<span class="op" id="7663960">:=</span>&nbsp;<span class="ident" id="7663963"><a href="/net/textproto/reader_test.go.html#7663912">r</a></span><span class="op" id="7663964">.</span><span class="ident" id="7663965">ReadContinuedLine</span><span class="op" id="7663982">(</span><span class="op" id="7663983">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663986">if</span>&nbsp;<span class="ident" id="7663989"><a href="/net/textproto/reader_test.go.html#7663953">s</a></span>&nbsp;<span class="op" id="7663991">!=</span>&nbsp;<span class="string" id="7663994">&#34;line1&#34;</span>&nbsp;<span class="op" id="7664002">||</span>&nbsp;<span class="ident" id="7664005"><a href="/net/textproto/reader_test.go.html#7663956">err</a></span>&nbsp;<span class="op" id="7664009">!=</span>&nbsp;<span class="ident" id="7664012">nil</span>&nbsp;<span class="op" id="7664016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664020"><a href="/net/textproto/reader_test.go.html#7663895">t</a></span><span class="op" id="7664021">.</span><span class="ident" id="7664022">Fatalf</span><span class="op" id="7664028">(</span><span class="string" id="7664029">&#34;Line&nbsp;1:&nbsp;%s,&nbsp;%v&#34;</span><span class="op" id="7664045">,</span>&nbsp;<span class="ident" id="7664047"><a href="/net/textproto/reader_test.go.html#7663953">s</a></span><span class="op" id="7664048">,</span>&nbsp;<span class="ident" id="7664050"><a href="/net/textproto/reader_test.go.html#7663956">err</a></span><span class="op" id="7664053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664059"><a href="/net/textproto/reader_test.go.html#7663953">s</a></span><span class="op" id="7664060">,</span>&nbsp;<span class="ident" id="7664062"><a href="/net/textproto/reader_test.go.html#7663956">err</a></span>&nbsp;<span class="op" id="7664066">=</span>&nbsp;<span class="ident" id="7664068"><a href="/net/textproto/reader_test.go.html#7663912">r</a></span><span class="op" id="7664069">.</span><span class="ident" id="7664070">ReadContinuedLine</span><span class="op" id="7664087">(</span><span class="op" id="7664088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664091">if</span>&nbsp;<span class="ident" id="7664094"><a href="/net/textproto/reader_test.go.html#7663953">s</a></span>&nbsp;<span class="op" id="7664096">!=</span>&nbsp;<span class="string" id="7664099">&#34;line&nbsp;2&#34;</span>&nbsp;<span class="op" id="7664108">||</span>&nbsp;<span class="ident" id="7664111"><a href="/net/textproto/reader_test.go.html#7663956">err</a></span>&nbsp;<span class="op" id="7664115">!=</span>&nbsp;<span class="ident" id="7664118">nil</span>&nbsp;<span class="op" id="7664122">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664126"><a href="/net/textproto/reader_test.go.html#7663895">t</a></span><span class="op" id="7664127">.</span><span class="ident" id="7664128">Fatalf</span><span class="op" id="7664134">(</span><span class="string" id="7664135">&#34;Line&nbsp;2:&nbsp;%s,&nbsp;%v&#34;</span><span class="op" id="7664151">,</span>&nbsp;<span class="ident" id="7664153"><a href="/net/textproto/reader_test.go.html#7663953">s</a></span><span class="op" id="7664154">,</span>&nbsp;<span class="ident" id="7664156"><a href="/net/textproto/reader_test.go.html#7663956">err</a></span><span class="op" id="7664159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664165"><a href="/net/textproto/reader_test.go.html#7663953">s</a></span><span class="op" id="7664166">,</span>&nbsp;<span class="ident" id="7664168"><a href="/net/textproto/reader_test.go.html#7663956">err</a></span>&nbsp;<span class="op" id="7664172">=</span>&nbsp;<span class="ident" id="7664174"><a href="/net/textproto/reader_test.go.html#7663912">r</a></span><span class="op" id="7664175">.</span><span class="ident" id="7664176">ReadContinuedLine</span><span class="op" id="7664193">(</span><span class="op" id="7664194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664197">if</span>&nbsp;<span class="ident" id="7664200"><a href="/net/textproto/reader_test.go.html#7663953">s</a></span>&nbsp;<span class="op" id="7664202">!=</span>&nbsp;<span class="string" id="7664205">&#34;line3&#34;</span>&nbsp;<span class="op" id="7664213">||</span>&nbsp;<span class="ident" id="7664216"><a href="/net/textproto/reader_test.go.html#7663956">err</a></span>&nbsp;<span class="op" id="7664220">!=</span>&nbsp;<span class="ident" id="7664223">nil</span>&nbsp;<span class="op" id="7664227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664231"><a href="/net/textproto/reader_test.go.html#7663895">t</a></span><span class="op" id="7664232">.</span><span class="ident" id="7664233">Fatalf</span><span class="op" id="7664239">(</span><span class="string" id="7664240">&#34;Line&nbsp;3:&nbsp;%s,&nbsp;%v&#34;</span><span class="op" id="7664256">,</span>&nbsp;<span class="ident" id="7664258"><a href="/net/textproto/reader_test.go.html#7663953">s</a></span><span class="op" id="7664259">,</span>&nbsp;<span class="ident" id="7664261"><a href="/net/textproto/reader_test.go.html#7663956">err</a></span><span class="op" id="7664264">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664270"><a href="/net/textproto/reader_test.go.html#7663953">s</a></span><span class="op" id="7664271">,</span>&nbsp;<span class="ident" id="7664273"><a href="/net/textproto/reader_test.go.html#7663956">err</a></span>&nbsp;<span class="op" id="7664277">=</span>&nbsp;<span class="ident" id="7664279"><a href="/net/textproto/reader_test.go.html#7663912">r</a></span><span class="op" id="7664280">.</span><span class="ident" id="7664281">ReadContinuedLine</span><span class="op" id="7664298">(</span><span class="op" id="7664299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664302">if</span>&nbsp;<span class="ident" id="7664305"><a href="/net/textproto/reader_test.go.html#7663953">s</a></span>&nbsp;<span class="op" id="7664307">!=</span>&nbsp;<span class="string" id="7664310">&#34;&#34;</span>&nbsp;<span class="op" id="7664313">||</span>&nbsp;<span class="ident" id="7664316"><a href="/net/textproto/reader_test.go.html#7663956">err</a></span>&nbsp;<span class="op" id="7664320">!=</span>&nbsp;<span class="ident" id="7664323"><a href="/net/textproto/reader_test.go.html#7662669">io</a></span><span class="op" id="7664325">.</span><span class="ident" id="7664326">EOF</span>&nbsp;<span class="op" id="7664330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664334"><a href="/net/textproto/reader_test.go.html#7663895">t</a></span><span class="op" id="7664335">.</span><span class="ident" id="7664336">Fatalf</span><span class="op" id="7664342">(</span><span class="string" id="7664343">&#34;EOF:&nbsp;%s,&nbsp;%v&#34;</span><span class="op" id="7664356">,</span>&nbsp;<span class="ident" id="7664358"><a href="/net/textproto/reader_test.go.html#7663953">s</a></span><span class="op" id="7664359">,</span>&nbsp;<span class="ident" id="7664361"><a href="/net/textproto/reader_test.go.html#7663956">err</a></span><span class="op" id="7664364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664367">}</span><br>
<span class="lineno">80</span><span class="op" id="7664369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7664372">func</span>&nbsp;<span class="ident" id="7664377">TestReadCodeLine</span><span class="op" id="7664393">(</span><span class="ident" id="7664394">t</span>&nbsp;<span class="op" id="7664396">*</span><span class="ident" id="7664397"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7664404">.</span><span class="ident" id="7664405">T</span><span class="op" id="7664406">)</span>&nbsp;<span class="op" id="7664408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664411">r</span>&nbsp;<span class="op" id="7664413">:=</span>&nbsp;<span class="ident" id="7664416"><a href="/net/textproto/reader_test.go.html#7663429">reader</a></span><span class="op" id="7664422">(</span><span class="string" id="7664423">&#34;123&nbsp;hi\n234&nbsp;bye\n345&nbsp;no&nbsp;way\n&#34;</span><span class="op" id="7664454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664457">code</span><span class="op" id="7664461">,</span>&nbsp;<span class="ident" id="7664463">msg</span><span class="op" id="7664466">,</span>&nbsp;<span class="ident" id="7664468">err</span>&nbsp;<span class="op" id="7664472">:=</span>&nbsp;<span class="ident" id="7664475"><a href="/net/textproto/reader_test.go.html#7664411">r</a></span><span class="op" id="7664476">.</span><span class="ident" id="7664477">ReadCodeLine</span><span class="op" id="7664489">(</span><span class="num" id="7664490">0</span><span class="op" id="7664491">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664494">if</span>&nbsp;<span class="ident" id="7664497"><a href="/net/textproto/reader_test.go.html#7664457">code</a></span>&nbsp;<span class="op" id="7664502">!=</span>&nbsp;<span class="num" id="7664505">123</span>&nbsp;<span class="op" id="7664509">||</span>&nbsp;<span class="ident" id="7664512"><a href="/net/textproto/reader_test.go.html#7664463">msg</a></span>&nbsp;<span class="op" id="7664516">!=</span>&nbsp;<span class="string" id="7664519">&#34;hi&#34;</span>&nbsp;<span class="op" id="7664524">||</span>&nbsp;<span class="ident" id="7664527"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span>&nbsp;<span class="op" id="7664531">!=</span>&nbsp;<span class="ident" id="7664534">nil</span>&nbsp;<span class="op" id="7664538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664542"><a href="/net/textproto/reader_test.go.html#7664394">t</a></span><span class="op" id="7664543">.</span><span class="ident" id="7664544">Fatalf</span><span class="op" id="7664550">(</span><span class="string" id="7664551">&#34;Line&nbsp;1:&nbsp;%d,&nbsp;%s,&nbsp;%v&#34;</span><span class="op" id="7664571">,</span>&nbsp;<span class="ident" id="7664573"><a href="/net/textproto/reader_test.go.html#7664457">code</a></span><span class="op" id="7664577">,</span>&nbsp;<span class="ident" id="7664579"><a href="/net/textproto/reader_test.go.html#7664463">msg</a></span><span class="op" id="7664582">,</span>&nbsp;<span class="ident" id="7664584"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span><span class="op" id="7664587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664593"><a href="/net/textproto/reader_test.go.html#7664457">code</a></span><span class="op" id="7664597">,</span>&nbsp;<span class="ident" id="7664599"><a href="/net/textproto/reader_test.go.html#7664463">msg</a></span><span class="op" id="7664602">,</span>&nbsp;<span class="ident" id="7664604"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span>&nbsp;<span class="op" id="7664608">=</span>&nbsp;<span class="ident" id="7664610"><a href="/net/textproto/reader_test.go.html#7664411">r</a></span><span class="op" id="7664611">.</span><span class="ident" id="7664612">ReadCodeLine</span><span class="op" id="7664624">(</span><span class="num" id="7664625">23</span><span class="op" id="7664627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664630">if</span>&nbsp;<span class="ident" id="7664633"><a href="/net/textproto/reader_test.go.html#7664457">code</a></span>&nbsp;<span class="op" id="7664638">!=</span>&nbsp;<span class="num" id="7664641">234</span>&nbsp;<span class="op" id="7664645">||</span>&nbsp;<span class="ident" id="7664648"><a href="/net/textproto/reader_test.go.html#7664463">msg</a></span>&nbsp;<span class="op" id="7664652">!=</span>&nbsp;<span class="string" id="7664655">&#34;bye&#34;</span>&nbsp;<span class="op" id="7664661">||</span>&nbsp;<span class="ident" id="7664664"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span>&nbsp;<span class="op" id="7664668">!=</span>&nbsp;<span class="ident" id="7664671">nil</span>&nbsp;<span class="op" id="7664675">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664679"><a href="/net/textproto/reader_test.go.html#7664394">t</a></span><span class="op" id="7664680">.</span><span class="ident" id="7664681">Fatalf</span><span class="op" id="7664687">(</span><span class="string" id="7664688">&#34;Line&nbsp;2:&nbsp;%d,&nbsp;%s,&nbsp;%v&#34;</span><span class="op" id="7664708">,</span>&nbsp;<span class="ident" id="7664710"><a href="/net/textproto/reader_test.go.html#7664457">code</a></span><span class="op" id="7664714">,</span>&nbsp;<span class="ident" id="7664716"><a href="/net/textproto/reader_test.go.html#7664463">msg</a></span><span class="op" id="7664719">,</span>&nbsp;<span class="ident" id="7664721"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span><span class="op" id="7664724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664730"><a href="/net/textproto/reader_test.go.html#7664457">code</a></span><span class="op" id="7664734">,</span>&nbsp;<span class="ident" id="7664736"><a href="/net/textproto/reader_test.go.html#7664463">msg</a></span><span class="op" id="7664739">,</span>&nbsp;<span class="ident" id="7664741"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span>&nbsp;<span class="op" id="7664745">=</span>&nbsp;<span class="ident" id="7664747"><a href="/net/textproto/reader_test.go.html#7664411">r</a></span><span class="op" id="7664748">.</span><span class="ident" id="7664749">ReadCodeLine</span><span class="op" id="7664761">(</span><span class="num" id="7664762">346</span><span class="op" id="7664765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664768">if</span>&nbsp;<span class="ident" id="7664771"><a href="/net/textproto/reader_test.go.html#7664457">code</a></span>&nbsp;<span class="op" id="7664776">!=</span>&nbsp;<span class="num" id="7664779">345</span>&nbsp;<span class="op" id="7664783">||</span>&nbsp;<span class="ident" id="7664786"><a href="/net/textproto/reader_test.go.html#7664463">msg</a></span>&nbsp;<span class="op" id="7664790">!=</span>&nbsp;<span class="string" id="7664793">&#34;no&nbsp;way&#34;</span>&nbsp;<span class="op" id="7664802">||</span>&nbsp;<span class="ident" id="7664805"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span>&nbsp;<span class="op" id="7664809">==</span>&nbsp;<span class="ident" id="7664812">nil</span>&nbsp;<span class="op" id="7664816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664820"><a href="/net/textproto/reader_test.go.html#7664394">t</a></span><span class="op" id="7664821">.</span><span class="ident" id="7664822">Fatalf</span><span class="op" id="7664828">(</span><span class="string" id="7664829">&#34;Line&nbsp;3:&nbsp;%d,&nbsp;%s,&nbsp;%v&#34;</span><span class="op" id="7664849">,</span>&nbsp;<span class="ident" id="7664851"><a href="/net/textproto/reader_test.go.html#7664457">code</a></span><span class="op" id="7664855">,</span>&nbsp;<span class="ident" id="7664857"><a href="/net/textproto/reader_test.go.html#7664463">msg</a></span><span class="op" id="7664860">,</span>&nbsp;<span class="ident" id="7664862"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span><span class="op" id="7664865">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664871">if</span>&nbsp;<span class="ident" id="7664874">e</span><span class="op" id="7664875">,</span>&nbsp;<span class="ident" id="7664877">ok</span>&nbsp;<span class="op" id="7664880">:=</span>&nbsp;<span class="ident" id="7664883"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span><span class="op" id="7664886">.</span><span class="op" id="7664887">(</span><span class="op" id="7664888">*</span><span class="ident" id="7664889"><a href="/net/textproto/textproto.go.html#3647221">Error</a></span><span class="op" id="7664894">)</span><span class="op" id="7664895">;</span>&nbsp;<span class="op" id="7664897">!</span><span class="ident" id="7664898"><a href="/net/textproto/reader_test.go.html#7664877">ok</a></span>&nbsp;<span class="op" id="7664901">||</span>&nbsp;<span class="ident" id="7664904"><a href="/net/textproto/reader_test.go.html#7664874">e</a></span><span class="op" id="7664905">.</span><span class="ident" id="7664906">Code</span>&nbsp;<span class="op" id="7664911">!=</span>&nbsp;<span class="ident" id="7664914"><a href="/net/textproto/reader_test.go.html#7664457">code</a></span>&nbsp;<span class="op" id="7664919">||</span>&nbsp;<span class="ident" id="7664922"><a href="/net/textproto/reader_test.go.html#7664874">e</a></span><span class="op" id="7664923">.</span><span class="ident" id="7664924">Msg</span>&nbsp;<span class="op" id="7664928">!=</span>&nbsp;<span class="ident" id="7664931"><a href="/net/textproto/reader_test.go.html#7664463">msg</a></span>&nbsp;<span class="op" id="7664935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664939"><a href="/net/textproto/reader_test.go.html#7664394">t</a></span><span class="op" id="7664940">.</span><span class="ident" id="7664941">Fatalf</span><span class="op" id="7664947">(</span><span class="string" id="7664948">&#34;Line&nbsp;3:&nbsp;wrong&nbsp;error&nbsp;%v\n&#34;</span><span class="op" id="7664974">,</span>&nbsp;<span class="ident" id="7664976"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span><span class="op" id="7664979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664985"><a href="/net/textproto/reader_test.go.html#7664457">code</a></span><span class="op" id="7664989">,</span>&nbsp;<span class="ident" id="7664991"><a href="/net/textproto/reader_test.go.html#7664463">msg</a></span><span class="op" id="7664994">,</span>&nbsp;<span class="ident" id="7664996"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span>&nbsp;<span class="op" id="7665000">=</span>&nbsp;<span class="ident" id="7665002"><a href="/net/textproto/reader_test.go.html#7664411">r</a></span><span class="op" id="7665003">.</span><span class="ident" id="7665004">ReadCodeLine</span><span class="op" id="7665016">(</span><span class="num" id="7665017">1</span><span class="op" id="7665018">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665021">if</span>&nbsp;<span class="ident" id="7665024"><a href="/net/textproto/reader_test.go.html#7664457">code</a></span>&nbsp;<span class="op" id="7665029">!=</span>&nbsp;<span class="num" id="7665032">0</span>&nbsp;<span class="op" id="7665034">||</span>&nbsp;<span class="ident" id="7665037"><a href="/net/textproto/reader_test.go.html#7664463">msg</a></span>&nbsp;<span class="op" id="7665041">!=</span>&nbsp;<span class="string" id="7665044">&#34;&#34;</span>&nbsp;<span class="op" id="7665047">||</span>&nbsp;<span class="ident" id="7665050"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span>&nbsp;<span class="op" id="7665054">!=</span>&nbsp;<span class="ident" id="7665057"><a href="/net/textproto/reader_test.go.html#7662669">io</a></span><span class="op" id="7665059">.</span><span class="ident" id="7665060">EOF</span>&nbsp;<span class="op" id="7665064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665068"><a href="/net/textproto/reader_test.go.html#7664394">t</a></span><span class="op" id="7665069">.</span><span class="ident" id="7665070">Fatalf</span><span class="op" id="7665076">(</span><span class="string" id="7665077">&#34;EOF:&nbsp;%d,&nbsp;%s,&nbsp;%v&#34;</span><span class="op" id="7665094">,</span>&nbsp;<span class="ident" id="7665096"><a href="/net/textproto/reader_test.go.html#7664457">code</a></span><span class="op" id="7665100">,</span>&nbsp;<span class="ident" id="7665102"><a href="/net/textproto/reader_test.go.html#7664463">msg</a></span><span class="op" id="7665105">,</span>&nbsp;<span class="ident" id="7665107"><a href="/net/textproto/reader_test.go.html#7664468">err</a></span><span class="op" id="7665110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665113">}</span><br>
<span class="lineno"></span><span class="op" id="7665115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="7665118">func</span>&nbsp;<span class="ident" id="7665123">TestReadDotLines</span><span class="op" id="7665139">(</span><span class="ident" id="7665140">t</span>&nbsp;<span class="op" id="7665142">*</span><span class="ident" id="7665143"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7665150">.</span><span class="ident" id="7665151">T</span><span class="op" id="7665152">)</span>&nbsp;<span class="op" id="7665154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665157">r</span>&nbsp;<span class="op" id="7665159">:=</span>&nbsp;<span class="ident" id="7665162"><a href="/net/textproto/reader_test.go.html#7663429">reader</a></span><span class="op" id="7665168">(</span><span class="string" id="7665169">&#34;dotlines\r\n.foo\r\n..bar\n...baz\nquux\r\n\r\n.\r\nanother\n&#34;</span><span class="op" id="7665232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665235">s</span><span class="op" id="7665236">,</span>&nbsp;<span class="ident" id="7665238">err</span>&nbsp;<span class="op" id="7665242">:=</span>&nbsp;<span class="ident" id="7665245"><a href="/net/textproto/reader_test.go.html#7665157">r</a></span><span class="op" id="7665246">.</span><span class="ident" id="7665247">ReadDotLines</span><span class="op" id="7665259">(</span><span class="op" id="7665260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665263">want</span>&nbsp;<span class="op" id="7665268">:=</span>&nbsp;<span class="op" id="7665271">[</span><span class="op" id="7665272">]</span><span class="builtintype" id="7665273">string</span><span class="op" id="7665279">{</span><span class="string" id="7665280">&#34;dotlines&#34;</span><span class="op" id="7665290">,</span>&nbsp;<span class="string" id="7665292">&#34;foo&#34;</span><span class="op" id="7665297">,</span>&nbsp;<span class="string" id="7665299">&#34;.bar&#34;</span><span class="op" id="7665305">,</span>&nbsp;<span class="string" id="7665307">&#34;..baz&#34;</span><span class="op" id="7665314">,</span>&nbsp;<span class="string" id="7665316">&#34;quux&#34;</span><span class="op" id="7665322">,</span>&nbsp;<span class="string" id="7665324">&#34;&#34;</span><span class="op" id="7665326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665329">if</span>&nbsp;<span class="op" id="7665332">!</span><span class="ident" id="7665333"><a href="/net/textproto/reader_test.go.html#7662675">reflect</a></span><span class="op" id="7665340">.</span><span class="ident" id="7665341">DeepEqual</span><span class="op" id="7665350">(</span><span class="ident" id="7665351"><a href="/net/textproto/reader_test.go.html#7665235">s</a></span><span class="op" id="7665352">,</span>&nbsp;<span class="ident" id="7665354"><a href="/net/textproto/reader_test.go.html#7665263">want</a></span><span class="op" id="7665358">)</span>&nbsp;<span class="op" id="7665360">||</span>&nbsp;<span class="ident" id="7665363"><a href="/net/textproto/reader_test.go.html#7665238">err</a></span>&nbsp;<span class="op" id="7665367">!=</span>&nbsp;<span class="ident" id="7665370">nil</span>&nbsp;<span class="op" id="7665374">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665378"><a href="/net/textproto/reader_test.go.html#7665140">t</a></span><span class="op" id="7665379">.</span><span class="ident" id="7665380">Fatalf</span><span class="op" id="7665386">(</span><span class="string" id="7665387">&#34;ReadDotLines:&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7665409">,</span>&nbsp;<span class="ident" id="7665411"><a href="/net/textproto/reader_test.go.html#7665235">s</a></span><span class="op" id="7665412">,</span>&nbsp;<span class="ident" id="7665414"><a href="/net/textproto/reader_test.go.html#7665238">err</a></span><span class="op" id="7665417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665424"><a href="/net/textproto/reader_test.go.html#7665235">s</a></span><span class="op" id="7665425">,</span>&nbsp;<span class="ident" id="7665427"><a href="/net/textproto/reader_test.go.html#7665238">err</a></span>&nbsp;<span class="op" id="7665431">=</span>&nbsp;<span class="ident" id="7665433"><a href="/net/textproto/reader_test.go.html#7665157">r</a></span><span class="op" id="7665434">.</span><span class="ident" id="7665435">ReadDotLines</span><span class="op" id="7665447">(</span><span class="op" id="7665448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665451"><a href="/net/textproto/reader_test.go.html#7665263">want</a></span>&nbsp;<span class="op" id="7665456">=</span>&nbsp;<span class="op" id="7665458">[</span><span class="op" id="7665459">]</span><span class="builtintype" id="7665460">string</span><span class="op" id="7665466">{</span><span class="string" id="7665467">&#34;another&#34;</span><span class="op" id="7665476">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665479">if</span>&nbsp;<span class="op" id="7665482">!</span><span class="ident" id="7665483"><a href="/net/textproto/reader_test.go.html#7662675">reflect</a></span><span class="op" id="7665490">.</span><span class="ident" id="7665491">DeepEqual</span><span class="op" id="7665500">(</span><span class="ident" id="7665501"><a href="/net/textproto/reader_test.go.html#7665235">s</a></span><span class="op" id="7665502">,</span>&nbsp;<span class="ident" id="7665504"><a href="/net/textproto/reader_test.go.html#7665263">want</a></span><span class="op" id="7665508">)</span>&nbsp;<span class="op" id="7665510">||</span>&nbsp;<span class="ident" id="7665513"><a href="/net/textproto/reader_test.go.html#7665238">err</a></span>&nbsp;<span class="op" id="7665517">!=</span>&nbsp;<span class="ident" id="7665520"><a href="/net/textproto/reader_test.go.html#7662669">io</a></span><span class="op" id="7665522">.</span><span class="ident" id="7665523">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="7665540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665544"><a href="/net/textproto/reader_test.go.html#7665140">t</a></span><span class="op" id="7665545">.</span><span class="ident" id="7665546">Fatalf</span><span class="op" id="7665552">(</span><span class="string" id="7665553">&#34;ReadDotLines2:&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7665576">,</span>&nbsp;<span class="ident" id="7665578"><a href="/net/textproto/reader_test.go.html#7665235">s</a></span><span class="op" id="7665579">,</span>&nbsp;<span class="ident" id="7665581"><a href="/net/textproto/reader_test.go.html#7665238">err</a></span><span class="op" id="7665584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665587">}</span><br>
<span class="lineno"></span><span class="op" id="7665589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="7665592">func</span>&nbsp;<span class="ident" id="7665597">TestReadDotBytes</span><span class="op" id="7665613">(</span><span class="ident" id="7665614">t</span>&nbsp;<span class="op" id="7665616">*</span><span class="ident" id="7665617"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7665624">.</span><span class="ident" id="7665625">T</span><span class="op" id="7665626">)</span>&nbsp;<span class="op" id="7665628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665631">r</span>&nbsp;<span class="op" id="7665633">:=</span>&nbsp;<span class="ident" id="7665636"><a href="/net/textproto/reader_test.go.html#7663429">reader</a></span><span class="op" id="7665642">(</span><span class="string" id="7665643">&#34;dotlines\r\n.foo\r\n..bar\n...baz\nquux\r\n\r\n.\r\nanot.her\r\n&#34;</span><span class="op" id="7665709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665712">b</span><span class="op" id="7665713">,</span>&nbsp;<span class="ident" id="7665715">err</span>&nbsp;<span class="op" id="7665719">:=</span>&nbsp;<span class="ident" id="7665722"><a href="/net/textproto/reader_test.go.html#7665631">r</a></span><span class="op" id="7665723">.</span><span class="ident" id="7665724">ReadDotBytes</span><span class="op" id="7665736">(</span><span class="op" id="7665737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665740">want</span>&nbsp;<span class="op" id="7665745">:=</span>&nbsp;<span class="op" id="7665748">[</span><span class="op" id="7665749">]</span><span class="builtintype" id="7665750">byte</span><span class="op" id="7665754">(</span><span class="string" id="7665755">&#34;dotlines\nfoo\n.bar\n..baz\nquux\n\n&#34;</span><span class="op" id="7665793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665796">if</span>&nbsp;<span class="op" id="7665799">!</span><span class="ident" id="7665800"><a href="/net/textproto/reader_test.go.html#7662675">reflect</a></span><span class="op" id="7665807">.</span><span class="ident" id="7665808">DeepEqual</span><span class="op" id="7665817">(</span><span class="ident" id="7665818"><a href="/net/textproto/reader_test.go.html#7665712">b</a></span><span class="op" id="7665819">,</span>&nbsp;<span class="ident" id="7665821"><a href="/net/textproto/reader_test.go.html#7665740">want</a></span><span class="op" id="7665825">)</span>&nbsp;<span class="op" id="7665827">||</span>&nbsp;<span class="ident" id="7665830"><a href="/net/textproto/reader_test.go.html#7665715">err</a></span>&nbsp;<span class="op" id="7665834">!=</span>&nbsp;<span class="ident" id="7665837">nil</span>&nbsp;<span class="op" id="7665841">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665845"><a href="/net/textproto/reader_test.go.html#7665614">t</a></span><span class="op" id="7665846">.</span><span class="ident" id="7665847">Fatalf</span><span class="op" id="7665853">(</span><span class="string" id="7665854">&#34;ReadDotBytes:&nbsp;%q,&nbsp;%v&#34;</span><span class="op" id="7665876">,</span>&nbsp;<span class="ident" id="7665878"><a href="/net/textproto/reader_test.go.html#7665712">b</a></span><span class="op" id="7665879">,</span>&nbsp;<span class="ident" id="7665881"><a href="/net/textproto/reader_test.go.html#7665715">err</a></span><span class="op" id="7665884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665891"><a href="/net/textproto/reader_test.go.html#7665712">b</a></span><span class="op" id="7665892">,</span>&nbsp;<span class="ident" id="7665894"><a href="/net/textproto/reader_test.go.html#7665715">err</a></span>&nbsp;<span class="op" id="7665898">=</span>&nbsp;<span class="ident" id="7665900"><a href="/net/textproto/reader_test.go.html#7665631">r</a></span><span class="op" id="7665901">.</span><span class="ident" id="7665902">ReadDotBytes</span><span class="op" id="7665914">(</span><span class="op" id="7665915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665918"><a href="/net/textproto/reader_test.go.html#7665740">want</a></span>&nbsp;<span class="op" id="7665923">=</span>&nbsp;<span class="op" id="7665925">[</span><span class="op" id="7665926">]</span><span class="builtintype" id="7665927">byte</span><span class="op" id="7665931">(</span><span class="string" id="7665932">&#34;anot.her\n&#34;</span><span class="op" id="7665944">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665947">if</span>&nbsp;<span class="op" id="7665950">!</span><span class="ident" id="7665951"><a href="/net/textproto/reader_test.go.html#7662675">reflect</a></span><span class="op" id="7665958">.</span><span class="ident" id="7665959">DeepEqual</span><span class="op" id="7665968">(</span><span class="ident" id="7665969"><a href="/net/textproto/reader_test.go.html#7665712">b</a></span><span class="op" id="7665970">,</span>&nbsp;<span class="ident" id="7665972"><a href="/net/textproto/reader_test.go.html#7665740">want</a></span><span class="op" id="7665976">)</span>&nbsp;<span class="op" id="7665978">||</span>&nbsp;<span class="ident" id="7665981"><a href="/net/textproto/reader_test.go.html#7665715">err</a></span>&nbsp;<span class="op" id="7665985">!=</span>&nbsp;<span class="ident" id="7665988"><a href="/net/textproto/reader_test.go.html#7662669">io</a></span><span class="op" id="7665990">.</span><span class="ident" id="7665991">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="7666008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666012"><a href="/net/textproto/reader_test.go.html#7665614">t</a></span><span class="op" id="7666013">.</span><span class="ident" id="7666014">Fatalf</span><span class="op" id="7666020">(</span><span class="string" id="7666021">&#34;ReadDotBytes2:&nbsp;%q,&nbsp;%v&#34;</span><span class="op" id="7666044">,</span>&nbsp;<span class="ident" id="7666046"><a href="/net/textproto/reader_test.go.html#7665712">b</a></span><span class="op" id="7666047">,</span>&nbsp;<span class="ident" id="7666049"><a href="/net/textproto/reader_test.go.html#7665715">err</a></span><span class="op" id="7666052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7666055">}</span><br>
<span class="lineno"></span><span class="op" id="7666057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="7666060">func</span>&nbsp;<span class="ident" id="7666065">TestReadMIMEHeader</span><span class="op" id="7666083">(</span><span class="ident" id="7666084">t</span>&nbsp;<span class="op" id="7666086">*</span><span class="ident" id="7666087"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7666094">.</span><span class="ident" id="7666095">T</span><span class="op" id="7666096">)</span>&nbsp;<span class="op" id="7666098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666101">r</span>&nbsp;<span class="op" id="7666103">:=</span>&nbsp;<span class="ident" id="7666106"><a href="/net/textproto/reader_test.go.html#7663429">reader</a></span><span class="op" id="7666112">(</span><span class="string" id="7666113">&#34;my-key:&nbsp;Value&nbsp;1&nbsp;&nbsp;\r\nLong-key:&nbsp;Even&nbsp;\n&nbsp;Longer&nbsp;Value\r\nmy-Key:&nbsp;Value&nbsp;2\r\n\n&#34;</span><span class="op" id="7666191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666194">m</span><span class="op" id="7666195">,</span>&nbsp;<span class="ident" id="7666197">err</span>&nbsp;<span class="op" id="7666201">:=</span>&nbsp;<span class="ident" id="7666204"><a href="/net/textproto/reader_test.go.html#7666101">r</a></span><span class="op" id="7666205">.</span><span class="ident" id="7666206">ReadMIMEHeader</span><span class="op" id="7666220">(</span><span class="op" id="7666221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666224">want</span>&nbsp;<span class="op" id="7666229">:=</span>&nbsp;<span class="ident" id="7666232"><a href="/net/textproto/header.go.html#3625965">MIMEHeader</a></span><span class="op" id="7666242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7666246">&#34;My-Key&#34;</span><span class="op" id="7666254">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7666258">{</span><span class="string" id="7666259">&#34;Value&nbsp;1&#34;</span><span class="op" id="7666268">,</span>&nbsp;<span class="string" id="7666270">&#34;Value&nbsp;2&#34;</span><span class="op" id="7666279">}</span><span class="op" id="7666280">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7666284">&#34;Long-Key&#34;</span><span class="op" id="7666294">:</span>&nbsp;<span class="op" id="7666296">{</span><span class="string" id="7666297">&#34;Even&nbsp;Longer&nbsp;Value&#34;</span><span class="op" id="7666316">}</span><span class="op" id="7666317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7666320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666323">if</span>&nbsp;<span class="op" id="7666326">!</span><span class="ident" id="7666327"><a href="/net/textproto/reader_test.go.html#7662675">reflect</a></span><span class="op" id="7666334">.</span><span class="ident" id="7666335">DeepEqual</span><span class="op" id="7666344">(</span><span class="ident" id="7666345"><a href="/net/textproto/reader_test.go.html#7666194">m</a></span><span class="op" id="7666346">,</span>&nbsp;<span class="ident" id="7666348"><a href="/net/textproto/reader_test.go.html#7666224">want</a></span><span class="op" id="7666352">)</span>&nbsp;<span class="op" id="7666354">||</span>&nbsp;<span class="ident" id="7666357"><a href="/net/textproto/reader_test.go.html#7666197">err</a></span>&nbsp;<span class="op" id="7666361">!=</span>&nbsp;<span class="ident" id="7666364">nil</span>&nbsp;<span class="op" id="7666368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666372"><a href="/net/textproto/reader_test.go.html#7666084">t</a></span><span class="op" id="7666373">.</span><span class="ident" id="7666374">Fatalf</span><span class="op" id="7666380">(</span><span class="string" id="7666381">&#34;ReadMIMEHeader:&nbsp;%v,&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7666414">,</span>&nbsp;<span class="ident" id="7666416"><a href="/net/textproto/reader_test.go.html#7666194">m</a></span><span class="op" id="7666417">,</span>&nbsp;<span class="ident" id="7666419"><a href="/net/textproto/reader_test.go.html#7666197">err</a></span><span class="op" id="7666422">,</span>&nbsp;<span class="ident" id="7666424"><a href="/net/textproto/reader_test.go.html#7666224">want</a></span><span class="op" id="7666428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7666431">}</span><br>
<span class="lineno">145</span><span class="op" id="7666433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7666436">func</span>&nbsp;<span class="ident" id="7666441">TestReadMIMEHeaderSingle</span><span class="op" id="7666465">(</span><span class="ident" id="7666466">t</span>&nbsp;<span class="op" id="7666468">*</span><span class="ident" id="7666469"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7666476">.</span><span class="ident" id="7666477">T</span><span class="op" id="7666478">)</span>&nbsp;<span class="op" id="7666480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666483">r</span>&nbsp;<span class="op" id="7666485">:=</span>&nbsp;<span class="ident" id="7666488"><a href="/net/textproto/reader_test.go.html#7663429">reader</a></span><span class="op" id="7666494">(</span><span class="string" id="7666495">&#34;Foo:&nbsp;bar\n\n&#34;</span><span class="op" id="7666509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666512">m</span><span class="op" id="7666513">,</span>&nbsp;<span class="ident" id="7666515">err</span>&nbsp;<span class="op" id="7666519">:=</span>&nbsp;<span class="ident" id="7666522"><a href="/net/textproto/reader_test.go.html#7666483">r</a></span><span class="op" id="7666523">.</span><span class="ident" id="7666524">ReadMIMEHeader</span><span class="op" id="7666538">(</span><span class="op" id="7666539">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666542">want</span>&nbsp;<span class="op" id="7666547">:=</span>&nbsp;<span class="ident" id="7666550"><a href="/net/textproto/header.go.html#3625965">MIMEHeader</a></span><span class="op" id="7666560">{</span><span class="string" id="7666561">&#34;Foo&#34;</span><span class="op" id="7666566">:</span>&nbsp;<span class="op" id="7666568">{</span><span class="string" id="7666569">&#34;bar&#34;</span><span class="op" id="7666574">}</span><span class="op" id="7666575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666578">if</span>&nbsp;<span class="op" id="7666581">!</span><span class="ident" id="7666582"><a href="/net/textproto/reader_test.go.html#7662675">reflect</a></span><span class="op" id="7666589">.</span><span class="ident" id="7666590">DeepEqual</span><span class="op" id="7666599">(</span><span class="ident" id="7666600"><a href="/net/textproto/reader_test.go.html#7666512">m</a></span><span class="op" id="7666601">,</span>&nbsp;<span class="ident" id="7666603"><a href="/net/textproto/reader_test.go.html#7666542">want</a></span><span class="op" id="7666607">)</span>&nbsp;<span class="op" id="7666609">||</span>&nbsp;<span class="ident" id="7666612"><a href="/net/textproto/reader_test.go.html#7666515">err</a></span>&nbsp;<span class="op" id="7666616">!=</span>&nbsp;<span class="ident" id="7666619">nil</span>&nbsp;<span class="op" id="7666623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666627"><a href="/net/textproto/reader_test.go.html#7666466">t</a></span><span class="op" id="7666628">.</span><span class="ident" id="7666629">Fatalf</span><span class="op" id="7666635">(</span><span class="string" id="7666636">&#34;ReadMIMEHeader:&nbsp;%v,&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7666669">,</span>&nbsp;<span class="ident" id="7666671"><a href="/net/textproto/reader_test.go.html#7666512">m</a></span><span class="op" id="7666672">,</span>&nbsp;<span class="ident" id="7666674"><a href="/net/textproto/reader_test.go.html#7666515">err</a></span><span class="op" id="7666677">,</span>&nbsp;<span class="ident" id="7666679"><a href="/net/textproto/reader_test.go.html#7666542">want</a></span><span class="op" id="7666683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7666686">}</span><br>
<span class="lineno"></span><span class="op" id="7666688">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="7666691">func</span>&nbsp;<span class="ident" id="7666696">TestLargeReadMIMEHeader</span><span class="op" id="7666719">(</span><span class="ident" id="7666720">t</span>&nbsp;<span class="op" id="7666722">*</span><span class="ident" id="7666723"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7666730">.</span><span class="ident" id="7666731">T</span><span class="op" id="7666732">)</span>&nbsp;<span class="op" id="7666734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666737">data</span>&nbsp;<span class="op" id="7666742">:=</span>&nbsp;<span class="builtinfunc" id="7666745">make</span><span class="op" id="7666749">(</span><span class="op" id="7666750">[</span><span class="op" id="7666751">]</span><span class="builtintype" id="7666752">byte</span><span class="op" id="7666756">,</span>&nbsp;<span class="num" id="7666758">16</span><span class="op" id="7666760">*</span><span class="num" id="7666761">1024</span><span class="op" id="7666765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666768">for</span>&nbsp;<span class="ident" id="7666772">i</span>&nbsp;<span class="op" id="7666774">:=</span>&nbsp;<span class="num" id="7666777">0</span><span class="op" id="7666778">;</span>&nbsp;<span class="ident" id="7666780"><a href="/net/textproto/reader_test.go.html#7666772">i</a></span>&nbsp;<span class="op" id="7666782">&lt;</span>&nbsp;<span class="builtinfunc" id="7666784">len</span><span class="op" id="7666787">(</span><span class="ident" id="7666788"><a href="/net/textproto/reader_test.go.html#7666737">data</a></span><span class="op" id="7666792">)</span><span class="op" id="7666793">;</span>&nbsp;<span class="ident" id="7666795"><a href="/net/textproto/reader_test.go.html#7666772">i</a></span><span class="op" id="7666796">++</span>&nbsp;<span class="op" id="7666799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666803"><a href="/net/textproto/reader_test.go.html#7666737">data</a></span><span class="op" id="7666807">[</span><span class="ident" id="7666808"><a href="/net/textproto/reader_test.go.html#7666772">i</a></span><span class="op" id="7666809">]</span>&nbsp;<span class="op" id="7666811">=</span>&nbsp;<span class="string" id="7666813">&#39;x&#39;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7666818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666821">sdata</span>&nbsp;<span class="op" id="7666827">:=</span>&nbsp;<span class="builtintype" id="7666830">string</span><span class="op" id="7666836">(</span><span class="ident" id="7666837"><a href="/net/textproto/reader_test.go.html#7666737">data</a></span><span class="op" id="7666841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666844">r</span>&nbsp;<span class="op" id="7666846">:=</span>&nbsp;<span class="ident" id="7666849"><a href="/net/textproto/reader_test.go.html#7663429">reader</a></span><span class="op" id="7666855">(</span><span class="string" id="7666856">&#34;Cookie:&nbsp;&#34;</span>&nbsp;<span class="op" id="7666867">+</span>&nbsp;<span class="ident" id="7666869"><a href="/net/textproto/reader_test.go.html#7666821">sdata</a></span>&nbsp;<span class="op" id="7666875">+</span>&nbsp;<span class="string" id="7666877">&#34;\r\n\n&#34;</span><span class="op" id="7666885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666888">m</span><span class="op" id="7666889">,</span>&nbsp;<span class="ident" id="7666891">err</span>&nbsp;<span class="op" id="7666895">:=</span>&nbsp;<span class="ident" id="7666898"><a href="/net/textproto/reader_test.go.html#7666844">r</a></span><span class="op" id="7666899">.</span><span class="ident" id="7666900">ReadMIMEHeader</span><span class="op" id="7666914">(</span><span class="op" id="7666915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666918">if</span>&nbsp;<span class="ident" id="7666921"><a href="/net/textproto/reader_test.go.html#7666891">err</a></span>&nbsp;<span class="op" id="7666925">!=</span>&nbsp;<span class="ident" id="7666928">nil</span>&nbsp;<span class="op" id="7666932">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666936"><a href="/net/textproto/reader_test.go.html#7666720">t</a></span><span class="op" id="7666937">.</span><span class="ident" id="7666938">Fatalf</span><span class="op" id="7666944">(</span><span class="string" id="7666945">&#34;ReadMIMEHeader:&nbsp;%v&#34;</span><span class="op" id="7666965">,</span>&nbsp;<span class="ident" id="7666967"><a href="/net/textproto/reader_test.go.html#7666891">err</a></span><span class="op" id="7666970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7666973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666976">cookie</span>&nbsp;<span class="op" id="7666983">:=</span>&nbsp;<span class="ident" id="7666986"><a href="/net/textproto/reader_test.go.html#7666888">m</a></span><span class="op" id="7666987">.</span><span class="ident" id="7666988">Get</span><span class="op" id="7666991">(</span><span class="string" id="7666992">&#34;Cookie&#34;</span><span class="op" id="7667000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667003">if</span>&nbsp;<span class="ident" id="7667006"><a href="/net/textproto/reader_test.go.html#7666976">cookie</a></span>&nbsp;<span class="op" id="7667013">!=</span>&nbsp;<span class="ident" id="7667016"><a href="/net/textproto/reader_test.go.html#7666821">sdata</a></span>&nbsp;<span class="op" id="7667022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667026"><a href="/net/textproto/reader_test.go.html#7666720">t</a></span><span class="op" id="7667027">.</span><span class="ident" id="7667028">Fatalf</span><span class="op" id="7667034">(</span><span class="string" id="7667035">&#34;ReadMIMEHeader:&nbsp;%v&nbsp;bytes,&nbsp;want&nbsp;%v&nbsp;bytes&#34;</span><span class="op" id="7667076">,</span>&nbsp;<span class="builtinfunc" id="7667078">len</span><span class="op" id="7667081">(</span><span class="ident" id="7667082"><a href="/net/textproto/reader_test.go.html#7666976">cookie</a></span><span class="op" id="7667088">)</span><span class="op" id="7667089">,</span>&nbsp;<span class="builtinfunc" id="7667091">len</span><span class="op" id="7667094">(</span><span class="ident" id="7667095"><a href="/net/textproto/reader_test.go.html#7666821">sdata</a></span><span class="op" id="7667100">)</span><span class="op" id="7667101">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667104">}</span><br>
<span class="lineno"></span><span class="op" id="7667106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7667109">//&nbsp;Test&nbsp;that&nbsp;we&nbsp;read&nbsp;slightly-bogus&nbsp;MIME&nbsp;headers&nbsp;seen&nbsp;in&nbsp;the&nbsp;wild,</span><br>
<span class="lineno"></span><span class="comment" id="7667176">//&nbsp;with&nbsp;spaces&nbsp;before&nbsp;colons,&nbsp;and&nbsp;spaces&nbsp;in&nbsp;keys.</span><br>
<span class="lineno">175</span><span class="keyword" id="7667226">func</span>&nbsp;<span class="ident" id="7667231">TestReadMIMEHeaderNonCompliant</span><span class="op" id="7667261">(</span><span class="ident" id="7667262">t</span>&nbsp;<span class="op" id="7667264">*</span><span class="ident" id="7667265"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7667272">.</span><span class="ident" id="7667273">T</span><span class="op" id="7667274">)</span>&nbsp;<span class="op" id="7667276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7667279">//&nbsp;Invalid&nbsp;HTTP&nbsp;response&nbsp;header&nbsp;as&nbsp;sent&nbsp;by&nbsp;an&nbsp;Axis&nbsp;security</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7667340">//&nbsp;camera:&nbsp;(this&nbsp;is&nbsp;handled&nbsp;by&nbsp;IE,&nbsp;Firefox,&nbsp;Chrome,&nbsp;curl,&nbsp;etc.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667405">r</span>&nbsp;<span class="op" id="7667407">:=</span>&nbsp;<span class="ident" id="7667410"><a href="/net/textproto/reader_test.go.html#7663429">reader</a></span><span class="op" id="7667416">(</span><span class="string" id="7667417">&#34;Foo:&nbsp;bar\r\n&#34;</span>&nbsp;<span class="op" id="7667432">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7667436">&#34;Content-Language:&nbsp;en\r\n&#34;</span>&nbsp;<span class="op" id="7667463">+</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7667467">&#34;SID&nbsp;:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7667481">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7667485">&#34;Audio&nbsp;Mode&nbsp;:&nbsp;None\r\n&#34;</span>&nbsp;<span class="op" id="7667509">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7667513">&#34;Privilege&nbsp;:&nbsp;127\r\n\r\n&#34;</span><span class="op" id="7667538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667541">m</span><span class="op" id="7667542">,</span>&nbsp;<span class="ident" id="7667544">err</span>&nbsp;<span class="op" id="7667548">:=</span>&nbsp;<span class="ident" id="7667551"><a href="/net/textproto/reader_test.go.html#7667405">r</a></span><span class="op" id="7667552">.</span><span class="ident" id="7667553">ReadMIMEHeader</span><span class="op" id="7667567">(</span><span class="op" id="7667568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667571">want</span>&nbsp;<span class="op" id="7667576">:=</span>&nbsp;<span class="ident" id="7667579"><a href="/net/textproto/header.go.html#3625965">MIMEHeader</a></span><span class="op" id="7667589">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7667593">&#34;Foo&#34;</span><span class="op" id="7667598">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7667613">{</span><span class="string" id="7667614">&#34;bar&#34;</span><span class="op" id="7667619">}</span><span class="op" id="7667620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7667624">&#34;Content-Language&#34;</span><span class="op" id="7667642">:</span>&nbsp;<span class="op" id="7667644">{</span><span class="string" id="7667645">&#34;en&#34;</span><span class="op" id="7667649">}</span><span class="op" id="7667650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7667654">&#34;Sid&#34;</span><span class="op" id="7667659">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7667674">{</span><span class="string" id="7667675">&#34;0&#34;</span><span class="op" id="7667678">}</span><span class="op" id="7667679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7667683">&#34;Audio-Mode&#34;</span><span class="op" id="7667695">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7667703">{</span><span class="string" id="7667704">&#34;None&#34;</span><span class="op" id="7667710">}</span><span class="op" id="7667711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7667715">&#34;Privilege&#34;</span><span class="op" id="7667726">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7667735">{</span><span class="string" id="7667736">&#34;127&#34;</span><span class="op" id="7667741">}</span><span class="op" id="7667742">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667748">if</span>&nbsp;<span class="op" id="7667751">!</span><span class="ident" id="7667752"><a href="/net/textproto/reader_test.go.html#7662675">reflect</a></span><span class="op" id="7667759">.</span><span class="ident" id="7667760">DeepEqual</span><span class="op" id="7667769">(</span><span class="ident" id="7667770"><a href="/net/textproto/reader_test.go.html#7667541">m</a></span><span class="op" id="7667771">,</span>&nbsp;<span class="ident" id="7667773"><a href="/net/textproto/reader_test.go.html#7667571">want</a></span><span class="op" id="7667777">)</span>&nbsp;<span class="op" id="7667779">||</span>&nbsp;<span class="ident" id="7667782"><a href="/net/textproto/reader_test.go.html#7667544">err</a></span>&nbsp;<span class="op" id="7667786">!=</span>&nbsp;<span class="ident" id="7667789">nil</span>&nbsp;<span class="op" id="7667793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667797"><a href="/net/textproto/reader_test.go.html#7667262">t</a></span><span class="op" id="7667798">.</span><span class="ident" id="7667799">Fatalf</span><span class="op" id="7667805">(</span><span class="string" id="7667806">&#34;ReadMIMEHeader&nbsp;=\n%v,&nbsp;%v;&nbsp;want:\n%v&#34;</span><span class="op" id="7667843">,</span>&nbsp;<span class="ident" id="7667845"><a href="/net/textproto/reader_test.go.html#7667541">m</a></span><span class="op" id="7667846">,</span>&nbsp;<span class="ident" id="7667848"><a href="/net/textproto/reader_test.go.html#7667544">err</a></span><span class="op" id="7667851">,</span>&nbsp;<span class="ident" id="7667853"><a href="/net/textproto/reader_test.go.html#7667571">want</a></span><span class="op" id="7667857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667860">}</span><br>
<span class="lineno"></span><span class="op" id="7667862">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="7667865">type</span>&nbsp;<span class="ident" id="7667870">readResponseTest</span>&nbsp;<span class="keyword" id="7667887">struct</span>&nbsp;<span class="op" id="7667894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667897">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7667906">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667914">inCode</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7667923">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667928">wantCode</span>&nbsp;<span class="builtintype" id="7667937">int</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667942">wantMsg</span>&nbsp;&nbsp;<span class="builtintype" id="7667951">string</span><br>
<span class="lineno"></span><span class="op" id="7667958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7667961">var</span>&nbsp;<span class="ident" id="7667965">readResponseTests</span>&nbsp;<span class="op" id="7667983">=</span>&nbsp;<span class="op" id="7667985">[</span><span class="op" id="7667986">]</span><span class="ident" id="7667987"><a href="/net/textproto/reader_test.go.html#7667870">readResponseTest</a></span><span class="op" id="7668003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668006">{</span><span class="string" id="7668007">&#34;230-Anonymous&nbsp;access&nbsp;granted,&nbsp;restrictions&nbsp;apply\n&#34;</span>&nbsp;<span class="op" id="7668060">+</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7668064">&#34;Read&nbsp;the&nbsp;file&nbsp;README.txt,\n&#34;</span>&nbsp;<span class="op" id="7668094">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7668098">&#34;230&nbsp;&nbsp;please&#34;</span><span class="op" id="7668111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7668115">23</span><span class="op" id="7668117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7668121">230</span><span class="op" id="7668124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7668128">&#34;Anonymous&nbsp;access&nbsp;granted,&nbsp;restrictions&nbsp;apply\nRead&nbsp;the&nbsp;file&nbsp;README.txt,\n&nbsp;please&#34;</span><span class="op" id="7668210">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668213">}</span><span class="op" id="7668214">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668218">{</span><span class="string" id="7668219">&#34;230&nbsp;Anonymous&nbsp;access&nbsp;granted,&nbsp;restrictions&nbsp;apply\n&#34;</span><span class="op" id="7668271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7668275">23</span><span class="op" id="7668277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7668281">230</span><span class="op" id="7668284">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7668288">&#34;Anonymous&nbsp;access&nbsp;granted,&nbsp;restrictions&nbsp;apply&#34;</span><span class="op" id="7668334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668337">}</span><span class="op" id="7668338">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668342">{</span><span class="string" id="7668343">&#34;400-A\n400-B\n400&nbsp;C&#34;</span><span class="op" id="7668364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7668368">4</span><span class="op" id="7668369">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7668373">400</span><span class="op" id="7668376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7668380">&#34;A\nB\nC&#34;</span><span class="op" id="7668389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668392">}</span><span class="op" id="7668393">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668397">{</span><span class="string" id="7668398">&#34;400-A\r\n400-B\r\n400&nbsp;C\r\n&#34;</span><span class="op" id="7668427">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7668431">4</span><span class="op" id="7668432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7668436">400</span><span class="op" id="7668439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7668443">&#34;A\nB\nC&#34;</span><span class="op" id="7668452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668455">}</span><span class="op" id="7668456">,</span><br>
<span class="lineno"></span><span class="op" id="7668458">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="7668461">//&nbsp;See&nbsp;http://www.ietf.org/rfc/rfc959.txt&nbsp;page&nbsp;36.</span><br>
<span class="lineno"></span><span class="keyword" id="7668512">func</span>&nbsp;<span class="ident" id="7668517">TestRFC959Lines</span><span class="op" id="7668532">(</span><span class="ident" id="7668533">t</span>&nbsp;<span class="op" id="7668535">*</span><span class="ident" id="7668536"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7668543">.</span><span class="ident" id="7668544">T</span><span class="op" id="7668545">)</span>&nbsp;<span class="op" id="7668547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668550">for</span>&nbsp;<span class="ident" id="7668554">i</span><span class="op" id="7668555">,</span>&nbsp;<span class="ident" id="7668557">tt</span>&nbsp;<span class="op" id="7668560">:=</span>&nbsp;<span class="keyword" id="7668563">range</span>&nbsp;<span class="ident" id="7668569"><a href="/net/textproto/reader_test.go.html#7667965">readResponseTests</a></span>&nbsp;<span class="op" id="7668587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668591">r</span>&nbsp;<span class="op" id="7668593">:=</span>&nbsp;<span class="ident" id="7668596"><a href="/net/textproto/reader_test.go.html#7663429">reader</a></span><span class="op" id="7668602">(</span><span class="ident" id="7668603"><a href="/net/textproto/reader_test.go.html#7668557">tt</a></span><span class="op" id="7668605">.</span><span class="ident" id="7668606">in</span>&nbsp;<span class="op" id="7668609">+</span>&nbsp;<span class="string" id="7668611">&#34;\nFOLLOWING&nbsp;DATA&#34;</span><span class="op" id="7668629">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668633">code</span><span class="op" id="7668637">,</span>&nbsp;<span class="ident" id="7668639">msg</span><span class="op" id="7668642">,</span>&nbsp;<span class="ident" id="7668644">err</span>&nbsp;<span class="op" id="7668648">:=</span>&nbsp;<span class="ident" id="7668651"><a href="/net/textproto/reader_test.go.html#7668591">r</a></span><span class="op" id="7668652">.</span><span class="ident" id="7668653">ReadResponse</span><span class="op" id="7668665">(</span><span class="ident" id="7668666"><a href="/net/textproto/reader_test.go.html#7668557">tt</a></span><span class="op" id="7668668">.</span><span class="ident" id="7668669">inCode</span><span class="op" id="7668675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668679">if</span>&nbsp;<span class="ident" id="7668682"><a href="/net/textproto/reader_test.go.html#7668644">err</a></span>&nbsp;<span class="op" id="7668686">!=</span>&nbsp;<span class="ident" id="7668689">nil</span>&nbsp;<span class="op" id="7668693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668698"><a href="/net/textproto/reader_test.go.html#7668533">t</a></span><span class="op" id="7668699">.</span><span class="ident" id="7668700">Errorf</span><span class="op" id="7668706">(</span><span class="string" id="7668707">&#34;#%d:&nbsp;ReadResponse:&nbsp;%v&#34;</span><span class="op" id="7668730">,</span>&nbsp;<span class="ident" id="7668732"><a href="/net/textproto/reader_test.go.html#7668554">i</a></span><span class="op" id="7668733">,</span>&nbsp;<span class="ident" id="7668735"><a href="/net/textproto/reader_test.go.html#7668644">err</a></span><span class="op" id="7668738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668743">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668754">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668758">if</span>&nbsp;<span class="ident" id="7668761"><a href="/net/textproto/reader_test.go.html#7668633">code</a></span>&nbsp;<span class="op" id="7668766">!=</span>&nbsp;<span class="ident" id="7668769"><a href="/net/textproto/reader_test.go.html#7668557">tt</a></span><span class="op" id="7668771">.</span><span class="ident" id="7668772">wantCode</span>&nbsp;<span class="op" id="7668781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668786"><a href="/net/textproto/reader_test.go.html#7668533">t</a></span><span class="op" id="7668787">.</span><span class="ident" id="7668788">Errorf</span><span class="op" id="7668794">(</span><span class="string" id="7668795">&#34;#%d:&nbsp;code=%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7668818">,</span>&nbsp;<span class="ident" id="7668820"><a href="/net/textproto/reader_test.go.html#7668554">i</a></span><span class="op" id="7668821">,</span>&nbsp;<span class="ident" id="7668823"><a href="/net/textproto/reader_test.go.html#7668633">code</a></span><span class="op" id="7668827">,</span>&nbsp;<span class="ident" id="7668829"><a href="/net/textproto/reader_test.go.html#7668557">tt</a></span><span class="op" id="7668831">.</span><span class="ident" id="7668832">wantCode</span><span class="op" id="7668840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668848">if</span>&nbsp;<span class="ident" id="7668851"><a href="/net/textproto/reader_test.go.html#7668639">msg</a></span>&nbsp;<span class="op" id="7668855">!=</span>&nbsp;<span class="ident" id="7668858"><a href="/net/textproto/reader_test.go.html#7668557">tt</a></span><span class="op" id="7668860">.</span><span class="ident" id="7668861">wantMsg</span>&nbsp;<span class="op" id="7668869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668874"><a href="/net/textproto/reader_test.go.html#7668533">t</a></span><span class="op" id="7668875">.</span><span class="ident" id="7668876">Errorf</span><span class="op" id="7668882">(</span><span class="string" id="7668883">&#34;#%d:&nbsp;msg=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7668905">,</span>&nbsp;<span class="ident" id="7668907"><a href="/net/textproto/reader_test.go.html#7668554">i</a></span><span class="op" id="7668908">,</span>&nbsp;<span class="ident" id="7668910"><a href="/net/textproto/reader_test.go.html#7668639">msg</a></span><span class="op" id="7668913">,</span>&nbsp;<span class="ident" id="7668915"><a href="/net/textproto/reader_test.go.html#7668557">tt</a></span><span class="op" id="7668917">.</span><span class="ident" id="7668918">wantMsg</span><span class="op" id="7668925">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668932">}</span><br>
<span class="lineno"></span><span class="op" id="7668934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7668937">func</span>&nbsp;<span class="ident" id="7668942">TestCommonHeaders</span><span class="op" id="7668959">(</span><span class="ident" id="7668960">t</span>&nbsp;<span class="op" id="7668962">*</span><span class="ident" id="7668963"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7668970">.</span><span class="ident" id="7668971">T</span><span class="op" id="7668972">)</span>&nbsp;<span class="op" id="7668974">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668977">for</span>&nbsp;<span class="ident" id="7668981">h</span>&nbsp;<span class="op" id="7668983">:=</span>&nbsp;<span class="keyword" id="7668986">range</span>&nbsp;<span class="ident" id="7668992"><a href="/net/textproto/reader.go.html#3645520">commonHeader</a></span>&nbsp;<span class="op" id="7669005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7669009">if</span>&nbsp;<span class="ident" id="7669012"><a href="/net/textproto/reader_test.go.html#7668981">h</a></span>&nbsp;<span class="op" id="7669014">!=</span>&nbsp;<span class="ident" id="7669017"><a href="/net/textproto/reader.go.html#3644256">CanonicalMIMEHeaderKey</a></span><span class="op" id="7669039">(</span><span class="ident" id="7669040"><a href="/net/textproto/reader_test.go.html#7668981">h</a></span><span class="op" id="7669041">)</span>&nbsp;<span class="op" id="7669043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7669048"><a href="/net/textproto/reader_test.go.html#7668960">t</a></span><span class="op" id="7669049">.</span><span class="ident" id="7669050">Errorf</span><span class="op" id="7669056">(</span><span class="string" id="7669057">&#34;Non-canonical&nbsp;header&nbsp;%q&nbsp;in&nbsp;commonHeader&#34;</span><span class="op" id="7669098">,</span>&nbsp;<span class="ident" id="7669100"><a href="/net/textproto/reader_test.go.html#7668981">h</a></span><span class="op" id="7669101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7669105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7669108">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7669111">b</span>&nbsp;<span class="op" id="7669113">:=</span>&nbsp;<span class="op" id="7669116">[</span><span class="op" id="7669117">]</span><span class="builtintype" id="7669118">byte</span><span class="op" id="7669122">(</span><span class="string" id="7669123">&#34;content-Length&#34;</span><span class="op" id="7669139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7669142">want</span>&nbsp;<span class="op" id="7669147">:=</span>&nbsp;<span class="string" id="7669150">&#34;Content-Length&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7669168">n</span>&nbsp;<span class="op" id="7669170">:=</span>&nbsp;<span class="ident" id="7669173"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7669180">.</span><span class="ident" id="7669181">AllocsPerRun</span><span class="op" id="7669193">(</span><span class="num" id="7669194">200</span><span class="op" id="7669197">,</span>&nbsp;<span class="keyword" id="7669199">func</span><span class="op" id="7669203">(</span><span class="op" id="7669204">)</span>&nbsp;<span class="op" id="7669206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7669210">if</span>&nbsp;<span class="ident" id="7669213">x</span>&nbsp;<span class="op" id="7669215">:=</span>&nbsp;<span class="ident" id="7669218"><a href="/net/textproto/reader.go.html#3644775">canonicalMIMEHeaderKey</a></span><span class="op" id="7669240">(</span><span class="ident" id="7669241"><a href="/net/textproto/reader_test.go.html#7669111">b</a></span><span class="op" id="7669242">)</span><span class="op" id="7669243">;</span>&nbsp;<span class="ident" id="7669245"><a href="/net/textproto/reader_test.go.html#7669213">x</a></span>&nbsp;<span class="op" id="7669247">!=</span>&nbsp;<span class="ident" id="7669250"><a href="/net/textproto/reader_test.go.html#7669142">want</a></span>&nbsp;<span class="op" id="7669255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7669260"><a href="/net/textproto/reader_test.go.html#7668960">t</a></span><span class="op" id="7669261">.</span><span class="ident" id="7669262">Fatalf</span><span class="op" id="7669268">(</span><span class="string" id="7669269">&#34;canonicalMIMEHeaderKey(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7669311">,</span>&nbsp;<span class="ident" id="7669313"><a href="/net/textproto/reader_test.go.html#7669111">b</a></span><span class="op" id="7669314">,</span>&nbsp;<span class="ident" id="7669316"><a href="/net/textproto/reader_test.go.html#7669213">x</a></span><span class="op" id="7669317">,</span>&nbsp;<span class="ident" id="7669319"><a href="/net/textproto/reader_test.go.html#7669142">want</a></span><span class="op" id="7669323">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7669327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7669330">}</span><span class="op" id="7669331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7669334">if</span>&nbsp;<span class="ident" id="7669337"><a href="/net/textproto/reader_test.go.html#7669168">n</a></span>&nbsp;<span class="op" id="7669339">&gt;</span>&nbsp;<span class="num" id="7669341">0</span>&nbsp;<span class="op" id="7669343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7669347"><a href="/net/textproto/reader_test.go.html#7668960">t</a></span><span class="op" id="7669348">.</span><span class="ident" id="7669349">Errorf</span><span class="op" id="7669355">(</span><span class="string" id="7669356">&#34;canonicalMIMEHeaderKey&nbsp;allocs&nbsp;=&nbsp;%v;&nbsp;want&nbsp;0&#34;</span><span class="op" id="7669400">,</span>&nbsp;<span class="ident" id="7669402"><a href="/net/textproto/reader_test.go.html#7669168">n</a></span><span class="op" id="7669403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7669406">}</span><br>
<span class="lineno">265</span><span class="op" id="7669408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7669411">var</span>&nbsp;<span class="ident" id="7669415">clientHeaders</span>&nbsp;<span class="op" id="7669429">=</span>&nbsp;<span class="ident" id="7669431"><a href="/net/textproto/reader_test.go.html#7662686">strings</a></span><span class="op" id="7669438">.</span><span class="ident" id="7669439">Replace</span><span class="op" id="7669446">(</span><span class="string" id="7669447">`Host:&nbsp;golang.org<br>
<span class="lineno"></span>Connection:&nbsp;keep-alive<br>
<span class="lineno"></span>Cache-Control:&nbsp;max-age=0<br>
<span class="lineno">270</span>Accept:&nbsp;application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5<br>
<span class="lineno"></span>User-Agent:&nbsp;Mozilla/5.0&nbsp;(X11;&nbsp;U;&nbsp;Linux&nbsp;x86_64;&nbsp;en-US)&nbsp;AppleWebKit/534.3&nbsp;(KHTML,&nbsp;like&nbsp;Gecko)&nbsp;Chrome/6.0.472.63&nbsp;Safari/534.3<br>
<span class="lineno"></span>Accept-Encoding:&nbsp;gzip,deflate,sdch<br>
<span class="lineno"></span>Accept-Language:&nbsp;en-US,en;q=0.8,fr-CH;q=0.6<br>
<span class="lineno"></span>Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.3<br>
<span class="lineno">275</span>COOKIE:&nbsp;__utma=000000000.0000000000.0000000000.0000000000.0000000000.00;&nbsp;__utmb=000000000.0.00.0000000000;&nbsp;__utmc=000000000;&nbsp;__utmz=000000000.0000000000.00.0.utmcsr=code.google.com|utmccn=(referral)|utmcmd=referral|utmcct=/p/go/issues/detail<br>
<span class="lineno"></span>Non-Interned:&nbsp;test<br>
<span class="lineno"></span><br>
<span class="lineno"></span>`</span><span class="op" id="7670124">,</span>&nbsp;<span class="string" id="7670126">&#34;\n&#34;</span><span class="op" id="7670130">,</span>&nbsp;<span class="string" id="7670132">&#34;\r\n&#34;</span><span class="op" id="7670138">,</span>&nbsp;<span class="op" id="7670140">-</span><span class="num" id="7670141">1</span><span class="op" id="7670142">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="7670145">var</span>&nbsp;<span class="ident" id="7670149">serverHeaders</span>&nbsp;<span class="op" id="7670163">=</span>&nbsp;<span class="ident" id="7670165"><a href="/net/textproto/reader_test.go.html#7662686">strings</a></span><span class="op" id="7670172">.</span><span class="ident" id="7670173">Replace</span><span class="op" id="7670180">(</span><span class="string" id="7670181">`Content-Type:&nbsp;text/html;&nbsp;charset=utf-8<br>
<span class="lineno"></span>Content-Encoding:&nbsp;gzip<br>
<span class="lineno"></span>Date:&nbsp;Thu,&nbsp;27&nbsp;Sep&nbsp;2012&nbsp;09:03:33&nbsp;GMT<br>
<span class="lineno"></span>Server:&nbsp;Google&nbsp;Frontend<br>
<span class="lineno"></span>Cache-Control:&nbsp;private<br>
<span class="lineno">285</span>Content-Length:&nbsp;2298<br>
<span class="lineno"></span>VIA:&nbsp;1.1&nbsp;proxy.example.com:80&nbsp;(XXX/n.n.n-nnn)<br>
<span class="lineno"></span>Connection:&nbsp;Close<br>
<span class="lineno"></span>Non-Interned:&nbsp;test<br>
<span class="lineno"></span><br>
<span class="lineno">290</span>`</span><span class="op" id="7670433">,</span>&nbsp;<span class="string" id="7670435">&#34;\n&#34;</span><span class="op" id="7670439">,</span>&nbsp;<span class="string" id="7670441">&#34;\r\n&#34;</span><span class="op" id="7670447">,</span>&nbsp;<span class="op" id="7670449">-</span><span class="num" id="7670450">1</span><span class="op" id="7670451">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7670454">func</span>&nbsp;<span class="ident" id="7670459">BenchmarkReadMIMEHeader</span><span class="op" id="7670482">(</span><span class="ident" id="7670483">b</span>&nbsp;<span class="op" id="7670485">*</span><span class="ident" id="7670486"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7670493">.</span><span class="ident" id="7670494">B</span><span class="op" id="7670495">)</span>&nbsp;<span class="op" id="7670497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7670500"><a href="/net/textproto/reader_test.go.html#7670483">b</a></span><span class="op" id="7670501">.</span><span class="ident" id="7670502">ReportAllocs</span><span class="op" id="7670514">(</span><span class="op" id="7670515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7670518">var</span>&nbsp;<span class="ident" id="7670522">buf</span>&nbsp;<span class="ident" id="7670526"><a href="/net/textproto/reader_test.go.html#7662660">bytes</a></span><span class="op" id="7670531">.</span><span class="ident" id="7670532">Buffer</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7670540">br</span>&nbsp;<span class="op" id="7670543">:=</span>&nbsp;<span class="ident" id="7670546"><a href="/net/textproto/reader_test.go.html#7662651">bufio</a></span><span class="op" id="7670551">.</span><span class="ident" id="7670552">NewReader</span><span class="op" id="7670561">(</span><span class="op" id="7670562">&amp;</span><span class="ident" id="7670563"><a href="/net/textproto/reader_test.go.html#7670522">buf</a></span><span class="op" id="7670566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7670569">r</span>&nbsp;<span class="op" id="7670571">:=</span>&nbsp;<span class="ident" id="7670574"><a href="/net/textproto/reader.go.html#3630688">NewReader</a></span><span class="op" id="7670583">(</span><span class="ident" id="7670584"><a href="/net/textproto/reader_test.go.html#7670540">br</a></span><span class="op" id="7670586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7670589">for</span>&nbsp;<span class="ident" id="7670593">i</span>&nbsp;<span class="op" id="7670595">:=</span>&nbsp;<span class="num" id="7670598">0</span><span class="op" id="7670599">;</span>&nbsp;<span class="ident" id="7670601"><a href="/net/textproto/reader_test.go.html#7670593">i</a></span>&nbsp;<span class="op" id="7670603">&lt;</span>&nbsp;<span class="ident" id="7670605"><a href="/net/textproto/reader_test.go.html#7670483">b</a></span><span class="op" id="7670606">.</span><span class="ident" id="7670607">N</span><span class="op" id="7670608">;</span>&nbsp;<span class="ident" id="7670610"><a href="/net/textproto/reader_test.go.html#7670593">i</a></span><span class="op" id="7670611">++</span>&nbsp;<span class="op" id="7670614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7670618">var</span>&nbsp;<span class="ident" id="7670622">want</span>&nbsp;<span class="builtintype" id="7670627">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7670633">var</span>&nbsp;<span class="ident" id="7670637">find</span>&nbsp;<span class="builtintype" id="7670642">string</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7670651">if</span>&nbsp;<span class="op" id="7670654">(</span><span class="ident" id="7670655"><a href="/net/textproto/reader_test.go.html#7670593">i</a></span>&nbsp;<span class="op" id="7670657">&amp;</span>&nbsp;<span class="num" id="7670659">1</span><span class="op" id="7670660">)</span>&nbsp;<span class="op" id="7670662">==</span>&nbsp;<span class="num" id="7670665">1</span>&nbsp;<span class="op" id="7670667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7670672"><a href="/net/textproto/reader_test.go.html#7670522">buf</a></span><span class="op" id="7670675">.</span><span class="ident" id="7670676">WriteString</span><span class="op" id="7670687">(</span><span class="ident" id="7670688"><a href="/net/textproto/reader_test.go.html#7669415">clientHeaders</a></span><span class="op" id="7670701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7670706"><a href="/net/textproto/reader_test.go.html#7670622">want</a></span>&nbsp;<span class="op" id="7670711">=</span>&nbsp;<span class="num" id="7670713">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7670719"><a href="/net/textproto/reader_test.go.html#7670637">find</a></span>&nbsp;<span class="op" id="7670724">=</span>&nbsp;<span class="string" id="7670726">&#34;Cookie&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7670737">}</span>&nbsp;<span class="keyword" id="7670739">else</span>&nbsp;<span class="op" id="7670744">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7670749"><a href="/net/textproto/reader_test.go.html#7670522">buf</a></span><span class="op" id="7670752">.</span><span class="ident" id="7670753">WriteString</span><span class="op" id="7670764">(</span><span class="ident" id="7670765"><a href="/net/textproto/reader_test.go.html#7670149">serverHeaders</a></span><span class="op" id="7670778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7670783"><a href="/net/textproto/reader_test.go.html#7670622">want</a></span>&nbsp;<span class="op" id="7670788">=</span>&nbsp;<span class="num" id="7670790">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7670795"><a href="/net/textproto/reader_test.go.html#7670637">find</a></span>&nbsp;<span class="op" id="7670800">=</span>&nbsp;<span class="string" id="7670802">&#34;Via&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7670810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7670814">h</span><span class="op" id="7670815">,</span>&nbsp;<span class="ident" id="7670817">err</span>&nbsp;<span class="op" id="7670821">:=</span>&nbsp;<span class="ident" id="7670824"><a href="/net/textproto/reader_test.go.html#7670569">r</a></span><span class="op" id="7670825">.</span><span class="ident" id="7670826">ReadMIMEHeader</span><span class="op" id="7670840">(</span><span class="op" id="7670841">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7670845">if</span>&nbsp;<span class="ident" id="7670848"><a href="/net/textproto/reader_test.go.html#7670817">err</a></span>&nbsp;<span class="op" id="7670852">!=</span>&nbsp;<span class="ident" id="7670855">nil</span>&nbsp;<span class="op" id="7670859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7670864"><a href="/net/textproto/reader_test.go.html#7670483">b</a></span><span class="op" id="7670865">.</span><span class="ident" id="7670866">Fatal</span><span class="op" id="7670871">(</span><span class="ident" id="7670872"><a href="/net/textproto/reader_test.go.html#7670817">err</a></span><span class="op" id="7670875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7670879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7670883">if</span>&nbsp;<span class="builtinfunc" id="7670886">len</span><span class="op" id="7670889">(</span><span class="ident" id="7670890"><a href="/net/textproto/reader_test.go.html#7670814">h</a></span><span class="op" id="7670891">)</span>&nbsp;<span class="op" id="7670893">!=</span>&nbsp;<span class="ident" id="7670896"><a href="/net/textproto/reader_test.go.html#7670622">want</a></span>&nbsp;<span class="op" id="7670901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7670906"><a href="/net/textproto/reader_test.go.html#7670483">b</a></span><span class="op" id="7670907">.</span><span class="ident" id="7670908">Fatalf</span><span class="op" id="7670914">(</span><span class="string" id="7670915">&#34;wrong&nbsp;number&nbsp;of&nbsp;headers:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7670957">,</span>&nbsp;<span class="builtinfunc" id="7670959">len</span><span class="op" id="7670962">(</span><span class="ident" id="7670963"><a href="/net/textproto/reader_test.go.html#7670814">h</a></span><span class="op" id="7670964">)</span><span class="op" id="7670965">,</span>&nbsp;<span class="ident" id="7670967"><a href="/net/textproto/reader_test.go.html#7670622">want</a></span><span class="op" id="7670971">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7670975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7670979">if</span>&nbsp;<span class="ident" id="7670982">_</span><span class="op" id="7670983">,</span>&nbsp;<span class="ident" id="7670985">ok</span>&nbsp;<span class="op" id="7670988">:=</span>&nbsp;<span class="ident" id="7670991"><a href="/net/textproto/reader_test.go.html#7670814">h</a></span><span class="op" id="7670992">[</span><span class="ident" id="7670993"><a href="/net/textproto/reader_test.go.html#7670637">find</a></span><span class="op" id="7670997">]</span><span class="op" id="7670998">;</span>&nbsp;<span class="op" id="7671000">!</span><span class="ident" id="7671001"><a href="/net/textproto/reader_test.go.html#7670985">ok</a></span>&nbsp;<span class="op" id="7671004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7671009"><a href="/net/textproto/reader_test.go.html#7670483">b</a></span><span class="op" id="7671010">.</span><span class="ident" id="7671011">Fatalf</span><span class="op" id="7671017">(</span><span class="string" id="7671018">&#34;did&nbsp;not&nbsp;find&nbsp;key&nbsp;%s&#34;</span><span class="op" id="7671039">,</span>&nbsp;<span class="ident" id="7671041"><a href="/net/textproto/reader_test.go.html#7670637">find</a></span><span class="op" id="7671045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7671049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7671052">}</span><br>
<span class="lineno">320</span><span class="op" id="7671054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7671057">func</span>&nbsp;<span class="ident" id="7671062">BenchmarkUncommon</span><span class="op" id="7671079">(</span><span class="ident" id="7671080">b</span>&nbsp;<span class="op" id="7671082">*</span><span class="ident" id="7671083"><a href="/net/textproto/reader_test.go.html#7662697">testing</a></span><span class="op" id="7671090">.</span><span class="ident" id="7671091">B</span><span class="op" id="7671092">)</span>&nbsp;<span class="op" id="7671094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7671097"><a href="/net/textproto/reader_test.go.html#7671080">b</a></span><span class="op" id="7671098">.</span><span class="ident" id="7671099">ReportAllocs</span><span class="op" id="7671111">(</span><span class="op" id="7671112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7671115">var</span>&nbsp;<span class="ident" id="7671119">buf</span>&nbsp;<span class="ident" id="7671123"><a href="/net/textproto/reader_test.go.html#7662660">bytes</a></span><span class="op" id="7671128">.</span><span class="ident" id="7671129">Buffer</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7671137">br</span>&nbsp;<span class="op" id="7671140">:=</span>&nbsp;<span class="ident" id="7671143"><a href="/net/textproto/reader_test.go.html#7662651">bufio</a></span><span class="op" id="7671148">.</span><span class="ident" id="7671149">NewReader</span><span class="op" id="7671158">(</span><span class="op" id="7671159">&amp;</span><span class="ident" id="7671160"><a href="/net/textproto/reader_test.go.html#7671119">buf</a></span><span class="op" id="7671163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7671166">r</span>&nbsp;<span class="op" id="7671168">:=</span>&nbsp;<span class="ident" id="7671171"><a href="/net/textproto/reader.go.html#3630688">NewReader</a></span><span class="op" id="7671180">(</span><span class="ident" id="7671181"><a href="/net/textproto/reader_test.go.html#7671137">br</a></span><span class="op" id="7671183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7671186">for</span>&nbsp;<span class="ident" id="7671190">i</span>&nbsp;<span class="op" id="7671192">:=</span>&nbsp;<span class="num" id="7671195">0</span><span class="op" id="7671196">;</span>&nbsp;<span class="ident" id="7671198"><a href="/net/textproto/reader_test.go.html#7671190">i</a></span>&nbsp;<span class="op" id="7671200">&lt;</span>&nbsp;<span class="ident" id="7671202"><a href="/net/textproto/reader_test.go.html#7671080">b</a></span><span class="op" id="7671203">.</span><span class="ident" id="7671204">N</span><span class="op" id="7671205">;</span>&nbsp;<span class="ident" id="7671207"><a href="/net/textproto/reader_test.go.html#7671190">i</a></span><span class="op" id="7671208">++</span>&nbsp;<span class="op" id="7671211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7671215"><a href="/net/textproto/reader_test.go.html#7671119">buf</a></span><span class="op" id="7671218">.</span><span class="ident" id="7671219">WriteString</span><span class="op" id="7671230">(</span><span class="string" id="7671231">&#34;uncommon-header-for-benchmark:&nbsp;foo\r\n\r\n&#34;</span><span class="op" id="7671275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7671279">h</span><span class="op" id="7671280">,</span>&nbsp;<span class="ident" id="7671282">err</span>&nbsp;<span class="op" id="7671286">:=</span>&nbsp;<span class="ident" id="7671289"><a href="/net/textproto/reader_test.go.html#7671166">r</a></span><span class="op" id="7671290">.</span><span class="ident" id="7671291">ReadMIMEHeader</span><span class="op" id="7671305">(</span><span class="op" id="7671306">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7671310">if</span>&nbsp;<span class="ident" id="7671313"><a href="/net/textproto/reader_test.go.html#7671282">err</a></span>&nbsp;<span class="op" id="7671317">!=</span>&nbsp;<span class="ident" id="7671320">nil</span>&nbsp;<span class="op" id="7671324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7671329"><a href="/net/textproto/reader_test.go.html#7671080">b</a></span><span class="op" id="7671330">.</span><span class="ident" id="7671331">Fatal</span><span class="op" id="7671336">(</span><span class="ident" id="7671337"><a href="/net/textproto/reader_test.go.html#7671282">err</a></span><span class="op" id="7671340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7671344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7671348">if</span>&nbsp;<span class="ident" id="7671351">_</span><span class="op" id="7671352">,</span>&nbsp;<span class="ident" id="7671354">ok</span>&nbsp;<span class="op" id="7671357">:=</span>&nbsp;<span class="ident" id="7671360"><a href="/net/textproto/reader_test.go.html#7671279">h</a></span><span class="op" id="7671361">[</span><span class="string" id="7671362">&#34;Uncommon-Header-For-Benchmark&#34;</span><span class="op" id="7671393">]</span><span class="op" id="7671394">;</span>&nbsp;<span class="op" id="7671396">!</span><span class="ident" id="7671397"><a href="/net/textproto/reader_test.go.html#7671354">ok</a></span>&nbsp;<span class="op" id="7671400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7671405"><a href="/net/textproto/reader_test.go.html#7671080">b</a></span><span class="op" id="7671406">.</span><span class="ident" id="7671407">Fatal</span><span class="op" id="7671412">(</span><span class="string" id="7671413">&#34;Missing&nbsp;result&nbsp;header.&#34;</span><span class="op" id="7671437">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7671441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7671444">}</span><br>
<span class="lineno"></span><span class="op" id="7671446">}</span>
</div>
</body>
</html>
