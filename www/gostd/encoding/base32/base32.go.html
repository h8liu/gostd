<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base32</h2>
<ul>
<li><a href="/gostd/encoding/base32/base32.go.html" class="current">base32.go</a></li>
<li><a href="/gostd/encoding/base32/base32_test.go.html">base32_test.go</a></li>
<li><a href="/gostd/encoding/base32/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5661022">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5661077">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5661131">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5661182">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5661253">package</span>&nbsp;<span class="ident" id="5661261">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5661269">import</span>&nbsp;<span class="op" id="5661276">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5661279">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5661288">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5661294">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5661305">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5661315">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5661318">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5661339">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5661407">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5661475">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="5661535">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="5661592">type</span>&nbsp;<span class="ident" id="5661597">Encoding</span>&nbsp;<span class="keyword" id="5661606">struct</span>&nbsp;<span class="op" id="5661613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5661616">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5661626">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5661634">decodeMap</span>&nbsp;<span class="op" id="5661644">[</span><span class="num" id="5661645">256</span><span class="op" id="5661648">]</span><span class="builtintype" id="5661649">byte</span><br>
<span class="lineno"></span><span class="op" id="5661654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5661657">const</span>&nbsp;<span class="ident" id="5661663">encodeStd</span>&nbsp;<span class="op" id="5661673">=</span>&nbsp;<span class="string" id="5661675">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="5661710">const</span>&nbsp;<span class="ident" id="5661716">encodeHex</span>&nbsp;<span class="op" id="5661726">=</span>&nbsp;<span class="string" id="5661728">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5661764">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="5661833">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5661868">func</span>&nbsp;<span class="ident" id="5661873">NewEncoding</span><span class="op" id="5661884">(</span><span class="ident" id="5661885">encoder</span>&nbsp;<span class="builtintype" id="5661893">string</span><span class="op" id="5661899">)</span>&nbsp;<span class="op" id="5661901">*</span><span class="ident" id="5661902">Encoding</span>&nbsp;<span class="op" id="5661911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5661914">e</span>&nbsp;<span class="op" id="5661916">:=</span>&nbsp;<span class="builtinfunc" id="5661919">new</span><span class="op" id="5661922">(</span><span class="ident" id="5661923">Encoding</span><span class="op" id="5661931">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5661934">e</span><span class="op" id="5661935">.</span><span class="ident" id="5661936">encode</span>&nbsp;<span class="op" id="5661943">=</span>&nbsp;<span class="ident" id="5661945">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5661954">for</span>&nbsp;<span class="ident" id="5661958">i</span>&nbsp;<span class="op" id="5661960">:=</span>&nbsp;<span class="num" id="5661963">0</span><span class="op" id="5661964">;</span>&nbsp;<span class="ident" id="5661966">i</span>&nbsp;<span class="op" id="5661968">&lt;</span>&nbsp;<span class="builtinfunc" id="5661970">len</span><span class="op" id="5661973">(</span><span class="ident" id="5661974">e</span><span class="op" id="5661975">.</span><span class="ident" id="5661976">decodeMap</span><span class="op" id="5661985">)</span><span class="op" id="5661986">;</span>&nbsp;<span class="ident" id="5661988">i</span><span class="op" id="5661989">++</span>&nbsp;<span class="op" id="5661992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5661996">e</span><span class="op" id="5661997">.</span><span class="ident" id="5661998">decodeMap</span><span class="op" id="5662007">[</span><span class="ident" id="5662008">i</span><span class="op" id="5662009">]</span>&nbsp;<span class="op" id="5662011">=</span>&nbsp;<span class="num" id="5662013">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5662019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5662022">for</span>&nbsp;<span class="ident" id="5662026">i</span>&nbsp;<span class="op" id="5662028">:=</span>&nbsp;<span class="num" id="5662031">0</span><span class="op" id="5662032">;</span>&nbsp;<span class="ident" id="5662034">i</span>&nbsp;<span class="op" id="5662036">&lt;</span>&nbsp;<span class="builtinfunc" id="5662038">len</span><span class="op" id="5662041">(</span><span class="ident" id="5662042">encoder</span><span class="op" id="5662049">)</span><span class="op" id="5662050">;</span>&nbsp;<span class="ident" id="5662052">i</span><span class="op" id="5662053">++</span>&nbsp;<span class="op" id="5662056">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5662060">e</span><span class="op" id="5662061">.</span><span class="ident" id="5662062">decodeMap</span><span class="op" id="5662071">[</span><span class="ident" id="5662072">encoder</span><span class="op" id="5662079">[</span><span class="ident" id="5662080">i</span><span class="op" id="5662081">]</span><span class="op" id="5662082">]</span>&nbsp;<span class="op" id="5662084">=</span>&nbsp;<span class="builtintype" id="5662086">byte</span><span class="op" id="5662090">(</span><span class="ident" id="5662091">i</span><span class="op" id="5662092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5662095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5662098">return</span>&nbsp;<span class="ident" id="5662105">e</span><br>
<span class="lineno"></span><span class="op" id="5662107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5662110">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5662172">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5662185">var</span>&nbsp;<span class="ident" id="5662189">StdEncoding</span>&nbsp;<span class="op" id="5662201">=</span>&nbsp;<span class="ident" id="5662203">NewEncoding</span><span class="op" id="5662214">(</span><span class="ident" id="5662215">encodeStd</span><span class="op" id="5662224">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5662227">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="5662296">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="5662328">var</span>&nbsp;<span class="ident" id="5662332">HexEncoding</span>&nbsp;<span class="op" id="5662344">=</span>&nbsp;<span class="ident" id="5662346">NewEncoding</span><span class="op" id="5662357">(</span><span class="ident" id="5662358">encodeHex</span><span class="op" id="5662367">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5662370">var</span>&nbsp;<span class="ident" id="5662374">removeNewlinesMapper</span>&nbsp;<span class="op" id="5662395">=</span>&nbsp;<span class="keyword" id="5662397">func</span><span class="op" id="5662401">(</span><span class="ident" id="5662402">r</span>&nbsp;<span class="builtintype" id="5662404">rune</span><span class="op" id="5662408">)</span>&nbsp;<span class="builtintype" id="5662410">rune</span>&nbsp;<span class="op" id="5662415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5662418">if</span>&nbsp;<span class="ident" id="5662421">r</span>&nbsp;<span class="op" id="5662423">==</span>&nbsp;<span class="string" id="5662426">&#39;\r&#39;</span>&nbsp;<span class="op" id="5662431">||</span>&nbsp;<span class="ident" id="5662434">r</span>&nbsp;<span class="op" id="5662436">==</span>&nbsp;<span class="string" id="5662439">&#39;\n&#39;</span>&nbsp;<span class="op" id="5662444">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5662448">return</span>&nbsp;<span class="op" id="5662455">-</span><span class="num" id="5662456">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5662459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5662462">return</span>&nbsp;<span class="ident" id="5662469">r</span><br>
<span class="lineno"></span><span class="op" id="5662471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="5662474">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5662493">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="5662547">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="5662585">//</span><br>
<span class="lineno"></span><span class="comment" id="5662588">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="5662646">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="5662707">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="5662761">func</span>&nbsp;<span class="op" id="5662766">(</span><span class="ident" id="5662767">enc</span>&nbsp;<span class="op" id="5662771">*</span><span class="ident" id="5662772">Encoding</span><span class="op" id="5662780">)</span>&nbsp;<span class="ident" id="5662782">Encode</span><span class="op" id="5662788">(</span><span class="ident" id="5662789">dst</span><span class="op" id="5662792">,</span>&nbsp;<span class="ident" id="5662794">src</span>&nbsp;<span class="op" id="5662798">[</span><span class="op" id="5662799">]</span><span class="builtintype" id="5662800">byte</span><span class="op" id="5662804">)</span>&nbsp;<span class="op" id="5662806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5662809">if</span>&nbsp;<span class="builtinfunc" id="5662812">len</span><span class="op" id="5662815">(</span><span class="ident" id="5662816">src</span><span class="op" id="5662819">)</span>&nbsp;<span class="op" id="5662821">==</span>&nbsp;<span class="num" id="5662824">0</span>&nbsp;<span class="op" id="5662826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5662830">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5662838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5662842">for</span>&nbsp;<span class="builtinfunc" id="5662846">len</span><span class="op" id="5662849">(</span><span class="ident" id="5662850">src</span><span class="op" id="5662853">)</span>&nbsp;<span class="op" id="5662855">&gt;</span>&nbsp;<span class="num" id="5662857">0</span>&nbsp;<span class="op" id="5662859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5662863">var</span>&nbsp;<span class="ident" id="5662867">b0</span><span class="op" id="5662869">,</span>&nbsp;<span class="ident" id="5662871">b1</span><span class="op" id="5662873">,</span>&nbsp;<span class="ident" id="5662875">b2</span><span class="op" id="5662877">,</span>&nbsp;<span class="ident" id="5662879">b3</span><span class="op" id="5662881">,</span>&nbsp;<span class="ident" id="5662883">b4</span><span class="op" id="5662885">,</span>&nbsp;<span class="ident" id="5662887">b5</span><span class="op" id="5662889">,</span>&nbsp;<span class="ident" id="5662891">b6</span><span class="op" id="5662893">,</span>&nbsp;<span class="ident" id="5662895">b7</span>&nbsp;<span class="builtintype" id="5662898">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5662906">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5662955">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5662980">switch</span>&nbsp;<span class="builtinfunc" id="5662987">len</span><span class="op" id="5662990">(</span><span class="ident" id="5662991">src</span><span class="op" id="5662994">)</span>&nbsp;<span class="op" id="5662996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663000">default</span><span class="op" id="5663007">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663012">b7</span>&nbsp;<span class="op" id="5663015">=</span>&nbsp;<span class="ident" id="5663017">src</span><span class="op" id="5663020">[</span><span class="num" id="5663021">4</span><span class="op" id="5663022">]</span>&nbsp;<span class="op" id="5663024">&amp;</span>&nbsp;<span class="num" id="5663026">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663034">b6</span>&nbsp;<span class="op" id="5663037">=</span>&nbsp;<span class="ident" id="5663039">src</span><span class="op" id="5663042">[</span><span class="num" id="5663043">4</span><span class="op" id="5663044">]</span>&nbsp;<span class="op" id="5663046">&gt;&gt;</span>&nbsp;<span class="num" id="5663049">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663054">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663068">case</span>&nbsp;<span class="num" id="5663073">4</span><span class="op" id="5663074">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663079">b6</span>&nbsp;<span class="op" id="5663082">|=</span>&nbsp;<span class="op" id="5663085">(</span><span class="ident" id="5663086">src</span><span class="op" id="5663089">[</span><span class="num" id="5663090">3</span><span class="op" id="5663091">]</span>&nbsp;<span class="op" id="5663093">&lt;&lt;</span>&nbsp;<span class="num" id="5663096">3</span><span class="op" id="5663097">)</span>&nbsp;<span class="op" id="5663099">&amp;</span>&nbsp;<span class="num" id="5663101">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663109">b5</span>&nbsp;<span class="op" id="5663112">=</span>&nbsp;<span class="op" id="5663114">(</span><span class="ident" id="5663115">src</span><span class="op" id="5663118">[</span><span class="num" id="5663119">3</span><span class="op" id="5663120">]</span>&nbsp;<span class="op" id="5663122">&gt;&gt;</span>&nbsp;<span class="num" id="5663125">2</span><span class="op" id="5663126">)</span>&nbsp;<span class="op" id="5663128">&amp;</span>&nbsp;<span class="num" id="5663130">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663138">b4</span>&nbsp;<span class="op" id="5663141">=</span>&nbsp;<span class="ident" id="5663143">src</span><span class="op" id="5663146">[</span><span class="num" id="5663147">3</span><span class="op" id="5663148">]</span>&nbsp;<span class="op" id="5663150">&gt;&gt;</span>&nbsp;<span class="num" id="5663153">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663158">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663172">case</span>&nbsp;<span class="num" id="5663177">3</span><span class="op" id="5663178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663183">b4</span>&nbsp;<span class="op" id="5663186">|=</span>&nbsp;<span class="op" id="5663189">(</span><span class="ident" id="5663190">src</span><span class="op" id="5663193">[</span><span class="num" id="5663194">2</span><span class="op" id="5663195">]</span>&nbsp;<span class="op" id="5663197">&lt;&lt;</span>&nbsp;<span class="num" id="5663200">1</span><span class="op" id="5663201">)</span>&nbsp;<span class="op" id="5663203">&amp;</span>&nbsp;<span class="num" id="5663205">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663213">b3</span>&nbsp;<span class="op" id="5663216">=</span>&nbsp;<span class="op" id="5663218">(</span><span class="ident" id="5663219">src</span><span class="op" id="5663222">[</span><span class="num" id="5663223">2</span><span class="op" id="5663224">]</span>&nbsp;<span class="op" id="5663226">&gt;&gt;</span>&nbsp;<span class="num" id="5663229">4</span><span class="op" id="5663230">)</span>&nbsp;<span class="op" id="5663232">&amp;</span>&nbsp;<span class="num" id="5663234">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663242">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663256">case</span>&nbsp;<span class="num" id="5663261">2</span><span class="op" id="5663262">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663267">b3</span>&nbsp;<span class="op" id="5663270">|=</span>&nbsp;<span class="op" id="5663273">(</span><span class="ident" id="5663274">src</span><span class="op" id="5663277">[</span><span class="num" id="5663278">1</span><span class="op" id="5663279">]</span>&nbsp;<span class="op" id="5663281">&lt;&lt;</span>&nbsp;<span class="num" id="5663284">4</span><span class="op" id="5663285">)</span>&nbsp;<span class="op" id="5663287">&amp;</span>&nbsp;<span class="num" id="5663289">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663297">b2</span>&nbsp;<span class="op" id="5663300">=</span>&nbsp;<span class="op" id="5663302">(</span><span class="ident" id="5663303">src</span><span class="op" id="5663306">[</span><span class="num" id="5663307">1</span><span class="op" id="5663308">]</span>&nbsp;<span class="op" id="5663310">&gt;&gt;</span>&nbsp;<span class="num" id="5663313">1</span><span class="op" id="5663314">)</span>&nbsp;<span class="op" id="5663316">&amp;</span>&nbsp;<span class="num" id="5663318">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663326">b1</span>&nbsp;<span class="op" id="5663329">=</span>&nbsp;<span class="op" id="5663331">(</span><span class="ident" id="5663332">src</span><span class="op" id="5663335">[</span><span class="num" id="5663336">1</span><span class="op" id="5663337">]</span>&nbsp;<span class="op" id="5663339">&gt;&gt;</span>&nbsp;<span class="num" id="5663342">6</span><span class="op" id="5663343">)</span>&nbsp;<span class="op" id="5663345">&amp;</span>&nbsp;<span class="num" id="5663347">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663355">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663369">case</span>&nbsp;<span class="num" id="5663374">1</span><span class="op" id="5663375">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663380">b1</span>&nbsp;<span class="op" id="5663383">|=</span>&nbsp;<span class="op" id="5663386">(</span><span class="ident" id="5663387">src</span><span class="op" id="5663390">[</span><span class="num" id="5663391">0</span><span class="op" id="5663392">]</span>&nbsp;<span class="op" id="5663394">&lt;&lt;</span>&nbsp;<span class="num" id="5663397">2</span><span class="op" id="5663398">)</span>&nbsp;<span class="op" id="5663400">&amp;</span>&nbsp;<span class="num" id="5663402">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663410">b0</span>&nbsp;<span class="op" id="5663413">=</span>&nbsp;<span class="ident" id="5663415">src</span><span class="op" id="5663418">[</span><span class="num" id="5663419">0</span><span class="op" id="5663420">]</span>&nbsp;<span class="op" id="5663422">&gt;&gt;</span>&nbsp;<span class="num" id="5663425">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5663429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5663434">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663485">dst</span><span class="op" id="5663488">[</span><span class="num" id="5663489">0</span><span class="op" id="5663490">]</span>&nbsp;<span class="op" id="5663492">=</span>&nbsp;<span class="ident" id="5663494">enc</span><span class="op" id="5663497">.</span><span class="ident" id="5663498">encode</span><span class="op" id="5663504">[</span><span class="ident" id="5663505">b0</span><span class="op" id="5663507">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663511">dst</span><span class="op" id="5663514">[</span><span class="num" id="5663515">1</span><span class="op" id="5663516">]</span>&nbsp;<span class="op" id="5663518">=</span>&nbsp;<span class="ident" id="5663520">enc</span><span class="op" id="5663523">.</span><span class="ident" id="5663524">encode</span><span class="op" id="5663530">[</span><span class="ident" id="5663531">b1</span><span class="op" id="5663533">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663537">dst</span><span class="op" id="5663540">[</span><span class="num" id="5663541">2</span><span class="op" id="5663542">]</span>&nbsp;<span class="op" id="5663544">=</span>&nbsp;<span class="ident" id="5663546">enc</span><span class="op" id="5663549">.</span><span class="ident" id="5663550">encode</span><span class="op" id="5663556">[</span><span class="ident" id="5663557">b2</span><span class="op" id="5663559">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663563">dst</span><span class="op" id="5663566">[</span><span class="num" id="5663567">3</span><span class="op" id="5663568">]</span>&nbsp;<span class="op" id="5663570">=</span>&nbsp;<span class="ident" id="5663572">enc</span><span class="op" id="5663575">.</span><span class="ident" id="5663576">encode</span><span class="op" id="5663582">[</span><span class="ident" id="5663583">b3</span><span class="op" id="5663585">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663589">dst</span><span class="op" id="5663592">[</span><span class="num" id="5663593">4</span><span class="op" id="5663594">]</span>&nbsp;<span class="op" id="5663596">=</span>&nbsp;<span class="ident" id="5663598">enc</span><span class="op" id="5663601">.</span><span class="ident" id="5663602">encode</span><span class="op" id="5663608">[</span><span class="ident" id="5663609">b4</span><span class="op" id="5663611">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663615">dst</span><span class="op" id="5663618">[</span><span class="num" id="5663619">5</span><span class="op" id="5663620">]</span>&nbsp;<span class="op" id="5663622">=</span>&nbsp;<span class="ident" id="5663624">enc</span><span class="op" id="5663627">.</span><span class="ident" id="5663628">encode</span><span class="op" id="5663634">[</span><span class="ident" id="5663635">b5</span><span class="op" id="5663637">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663641">dst</span><span class="op" id="5663644">[</span><span class="num" id="5663645">6</span><span class="op" id="5663646">]</span>&nbsp;<span class="op" id="5663648">=</span>&nbsp;<span class="ident" id="5663650">enc</span><span class="op" id="5663653">.</span><span class="ident" id="5663654">encode</span><span class="op" id="5663660">[</span><span class="ident" id="5663661">b6</span><span class="op" id="5663663">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663667">dst</span><span class="op" id="5663670">[</span><span class="num" id="5663671">7</span><span class="op" id="5663672">]</span>&nbsp;<span class="op" id="5663674">=</span>&nbsp;<span class="ident" id="5663676">enc</span><span class="op" id="5663679">.</span><span class="ident" id="5663680">encode</span><span class="op" id="5663686">[</span><span class="ident" id="5663687">b7</span><span class="op" id="5663689">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5663694">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663721">if</span>&nbsp;<span class="builtinfunc" id="5663724">len</span><span class="op" id="5663727">(</span><span class="ident" id="5663728">src</span><span class="op" id="5663731">)</span>&nbsp;<span class="op" id="5663733">&lt;</span>&nbsp;<span class="num" id="5663735">5</span>&nbsp;<span class="op" id="5663737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663742">dst</span><span class="op" id="5663745">[</span><span class="num" id="5663746">7</span><span class="op" id="5663747">]</span>&nbsp;<span class="op" id="5663749">=</span>&nbsp;<span class="string" id="5663751">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663758">if</span>&nbsp;<span class="builtinfunc" id="5663761">len</span><span class="op" id="5663764">(</span><span class="ident" id="5663765">src</span><span class="op" id="5663768">)</span>&nbsp;<span class="op" id="5663770">&lt;</span>&nbsp;<span class="num" id="5663772">4</span>&nbsp;<span class="op" id="5663774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663780">dst</span><span class="op" id="5663783">[</span><span class="num" id="5663784">6</span><span class="op" id="5663785">]</span>&nbsp;<span class="op" id="5663787">=</span>&nbsp;<span class="string" id="5663789">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663797">dst</span><span class="op" id="5663800">[</span><span class="num" id="5663801">5</span><span class="op" id="5663802">]</span>&nbsp;<span class="op" id="5663804">=</span>&nbsp;<span class="string" id="5663806">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663814">if</span>&nbsp;<span class="builtinfunc" id="5663817">len</span><span class="op" id="5663820">(</span><span class="ident" id="5663821">src</span><span class="op" id="5663824">)</span>&nbsp;<span class="op" id="5663826">&lt;</span>&nbsp;<span class="num" id="5663828">3</span>&nbsp;<span class="op" id="5663830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663837">dst</span><span class="op" id="5663840">[</span><span class="num" id="5663841">4</span><span class="op" id="5663842">]</span>&nbsp;<span class="op" id="5663844">=</span>&nbsp;<span class="string" id="5663846">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663855">if</span>&nbsp;<span class="builtinfunc" id="5663858">len</span><span class="op" id="5663861">(</span><span class="ident" id="5663862">src</span><span class="op" id="5663865">)</span>&nbsp;<span class="op" id="5663867">&lt;</span>&nbsp;<span class="num" id="5663869">2</span>&nbsp;<span class="op" id="5663871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663879">dst</span><span class="op" id="5663882">[</span><span class="num" id="5663883">3</span><span class="op" id="5663884">]</span>&nbsp;<span class="op" id="5663886">=</span>&nbsp;<span class="string" id="5663888">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663898">dst</span><span class="op" id="5663901">[</span><span class="num" id="5663902">2</span><span class="op" id="5663903">]</span>&nbsp;<span class="op" id="5663905">=</span>&nbsp;<span class="string" id="5663907">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5663916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5663922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5663927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5663932">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5663940">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663944">src</span>&nbsp;<span class="op" id="5663948">=</span>&nbsp;<span class="ident" id="5663950">src</span><span class="op" id="5663953">[</span><span class="num" id="5663954">5</span><span class="op" id="5663955">:</span><span class="op" id="5663956">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5663960">dst</span>&nbsp;<span class="op" id="5663964">=</span>&nbsp;<span class="ident" id="5663966">dst</span><span class="op" id="5663969">[</span><span class="num" id="5663970">8</span><span class="op" id="5663971">:</span><span class="op" id="5663972">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5663975">}</span><br>
<span class="lineno"></span><span class="op" id="5663977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="5663980">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="5664034">func</span>&nbsp;<span class="op" id="5664039">(</span><span class="ident" id="5664040">enc</span>&nbsp;<span class="op" id="5664044">*</span><span class="ident" id="5664045">Encoding</span><span class="op" id="5664053">)</span>&nbsp;<span class="ident" id="5664055">EncodeToString</span><span class="op" id="5664069">(</span><span class="ident" id="5664070">src</span>&nbsp;<span class="op" id="5664074">[</span><span class="op" id="5664075">]</span><span class="builtintype" id="5664076">byte</span><span class="op" id="5664080">)</span>&nbsp;<span class="builtintype" id="5664082">string</span>&nbsp;<span class="op" id="5664089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664092">buf</span>&nbsp;<span class="op" id="5664096">:=</span>&nbsp;<span class="builtinfunc" id="5664099">make</span><span class="op" id="5664103">(</span><span class="op" id="5664104">[</span><span class="op" id="5664105">]</span><span class="builtintype" id="5664106">byte</span><span class="op" id="5664110">,</span>&nbsp;<span class="ident" id="5664112">enc</span><span class="op" id="5664115">.</span><span class="ident" id="5664116">EncodedLen</span><span class="op" id="5664126">(</span><span class="builtinfunc" id="5664127">len</span><span class="op" id="5664130">(</span><span class="ident" id="5664131">src</span><span class="op" id="5664134">)</span><span class="op" id="5664135">)</span><span class="op" id="5664136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664139">enc</span><span class="op" id="5664142">.</span><span class="ident" id="5664143">Encode</span><span class="op" id="5664149">(</span><span class="ident" id="5664150">buf</span><span class="op" id="5664153">,</span>&nbsp;<span class="ident" id="5664155">src</span><span class="op" id="5664158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664161">return</span>&nbsp;<span class="builtintype" id="5664168">string</span><span class="op" id="5664174">(</span><span class="ident" id="5664175">buf</span><span class="op" id="5664178">)</span><br>
<span class="lineno">140</span><span class="op" id="5664180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5664183">type</span>&nbsp;<span class="ident" id="5664188">encoder</span>&nbsp;<span class="keyword" id="5664196">struct</span>&nbsp;<span class="op" id="5664203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664206">err</span>&nbsp;&nbsp;<span class="builtintype" id="5664211">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664218">enc</span>&nbsp;&nbsp;<span class="op" id="5664223">*</span><span class="ident" id="5664224">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664234">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664239">io</span><span class="op" id="5664241">.</span><span class="ident" id="5664242">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664250">buf</span>&nbsp;&nbsp;<span class="op" id="5664255">[</span><span class="num" id="5664256">5</span><span class="op" id="5664257">]</span><span class="builtintype" id="5664258">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5664266">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664306">nbuf</span>&nbsp;<span class="builtintype" id="5664311">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5664322">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664349">out</span>&nbsp;&nbsp;<span class="op" id="5664354">[</span><span class="num" id="5664355">1024</span><span class="op" id="5664359">]</span><span class="builtintype" id="5664360">byte</span>&nbsp;<span class="comment" id="5664365">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="5664382">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="5664385">func</span>&nbsp;<span class="op" id="5664390">(</span><span class="ident" id="5664391">e</span>&nbsp;<span class="op" id="5664393">*</span><span class="ident" id="5664394">encoder</span><span class="op" id="5664401">)</span>&nbsp;<span class="ident" id="5664403">Write</span><span class="op" id="5664408">(</span><span class="ident" id="5664409">p</span>&nbsp;<span class="op" id="5664411">[</span><span class="op" id="5664412">]</span><span class="builtintype" id="5664413">byte</span><span class="op" id="5664417">)</span>&nbsp;<span class="op" id="5664419">(</span><span class="ident" id="5664420">n</span>&nbsp;<span class="builtintype" id="5664422">int</span><span class="op" id="5664425">,</span>&nbsp;<span class="ident" id="5664427">err</span>&nbsp;<span class="builtintype" id="5664431">error</span><span class="op" id="5664436">)</span>&nbsp;<span class="op" id="5664438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664441">if</span>&nbsp;<span class="ident" id="5664444">e</span><span class="op" id="5664445">.</span><span class="ident" id="5664446">err</span>&nbsp;<span class="op" id="5664450">!=</span>&nbsp;<span class="ident" id="5664453">nil</span>&nbsp;<span class="op" id="5664457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664461">return</span>&nbsp;<span class="num" id="5664468">0</span><span class="op" id="5664469">,</span>&nbsp;<span class="ident" id="5664471">e</span><span class="op" id="5664472">.</span><span class="ident" id="5664473">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5664478">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5664482">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664502">if</span>&nbsp;<span class="ident" id="5664505">e</span><span class="op" id="5664506">.</span><span class="ident" id="5664507">nbuf</span>&nbsp;<span class="op" id="5664512">&gt;</span>&nbsp;<span class="num" id="5664514">0</span>&nbsp;<span class="op" id="5664516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664520">var</span>&nbsp;<span class="ident" id="5664524">i</span>&nbsp;<span class="builtintype" id="5664526">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664532">for</span>&nbsp;<span class="ident" id="5664536">i</span>&nbsp;<span class="op" id="5664538">=</span>&nbsp;<span class="num" id="5664540">0</span><span class="op" id="5664541">;</span>&nbsp;<span class="ident" id="5664543">i</span>&nbsp;<span class="op" id="5664545">&lt;</span>&nbsp;<span class="builtinfunc" id="5664547">len</span><span class="op" id="5664550">(</span><span class="ident" id="5664551">p</span><span class="op" id="5664552">)</span>&nbsp;<span class="op" id="5664554">&amp;&amp;</span>&nbsp;<span class="ident" id="5664557">e</span><span class="op" id="5664558">.</span><span class="ident" id="5664559">nbuf</span>&nbsp;<span class="op" id="5664564">&lt;</span>&nbsp;<span class="num" id="5664566">5</span><span class="op" id="5664567">;</span>&nbsp;<span class="ident" id="5664569">i</span><span class="op" id="5664570">++</span>&nbsp;<span class="op" id="5664573">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664578">e</span><span class="op" id="5664579">.</span><span class="ident" id="5664580">buf</span><span class="op" id="5664583">[</span><span class="ident" id="5664584">e</span><span class="op" id="5664585">.</span><span class="ident" id="5664586">nbuf</span><span class="op" id="5664590">]</span>&nbsp;<span class="op" id="5664592">=</span>&nbsp;<span class="ident" id="5664594">p</span><span class="op" id="5664595">[</span><span class="ident" id="5664596">i</span><span class="op" id="5664597">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664602">e</span><span class="op" id="5664603">.</span><span class="ident" id="5664604">nbuf</span><span class="op" id="5664608">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5664613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664617">n</span>&nbsp;<span class="op" id="5664619">+=</span>&nbsp;<span class="ident" id="5664622">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664626">p</span>&nbsp;<span class="op" id="5664628">=</span>&nbsp;<span class="ident" id="5664630">p</span><span class="op" id="5664631">[</span><span class="ident" id="5664632">i</span><span class="op" id="5664633">:</span><span class="op" id="5664634">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664638">if</span>&nbsp;<span class="ident" id="5664641">e</span><span class="op" id="5664642">.</span><span class="ident" id="5664643">nbuf</span>&nbsp;<span class="op" id="5664648">&lt;</span>&nbsp;<span class="num" id="5664650">5</span>&nbsp;<span class="op" id="5664652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664657">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5664666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664670">e</span><span class="op" id="5664671">.</span><span class="ident" id="5664672">enc</span><span class="op" id="5664675">.</span><span class="ident" id="5664676">Encode</span><span class="op" id="5664682">(</span><span class="ident" id="5664683">e</span><span class="op" id="5664684">.</span><span class="ident" id="5664685">out</span><span class="op" id="5664688">[</span><span class="num" id="5664689">0</span><span class="op" id="5664690">:</span><span class="op" id="5664691">]</span><span class="op" id="5664692">,</span>&nbsp;<span class="ident" id="5664694">e</span><span class="op" id="5664695">.</span><span class="ident" id="5664696">buf</span><span class="op" id="5664699">[</span><span class="num" id="5664700">0</span><span class="op" id="5664701">:</span><span class="op" id="5664702">]</span><span class="op" id="5664703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664707">if</span>&nbsp;<span class="ident" id="5664710">_</span><span class="op" id="5664711">,</span>&nbsp;<span class="ident" id="5664713">e</span><span class="op" id="5664714">.</span><span class="ident" id="5664715">err</span>&nbsp;<span class="op" id="5664719">=</span>&nbsp;<span class="ident" id="5664721">e</span><span class="op" id="5664722">.</span><span class="ident" id="5664723">w</span><span class="op" id="5664724">.</span><span class="ident" id="5664725">Write</span><span class="op" id="5664730">(</span><span class="ident" id="5664731">e</span><span class="op" id="5664732">.</span><span class="ident" id="5664733">out</span><span class="op" id="5664736">[</span><span class="num" id="5664737">0</span><span class="op" id="5664738">:</span><span class="num" id="5664739">8</span><span class="op" id="5664740">]</span><span class="op" id="5664741">)</span><span class="op" id="5664742">;</span>&nbsp;<span class="ident" id="5664744">e</span><span class="op" id="5664745">.</span><span class="ident" id="5664746">err</span>&nbsp;<span class="op" id="5664750">!=</span>&nbsp;<span class="ident" id="5664753">nil</span>&nbsp;<span class="op" id="5664757">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664762">return</span>&nbsp;<span class="ident" id="5664769">n</span><span class="op" id="5664770">,</span>&nbsp;<span class="ident" id="5664772">e</span><span class="op" id="5664773">.</span><span class="ident" id="5664774">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5664780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664784">e</span><span class="op" id="5664785">.</span><span class="ident" id="5664786">nbuf</span>&nbsp;<span class="op" id="5664791">=</span>&nbsp;<span class="num" id="5664793">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5664796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5664800">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664827">for</span>&nbsp;<span class="builtinfunc" id="5664831">len</span><span class="op" id="5664834">(</span><span class="ident" id="5664835">p</span><span class="op" id="5664836">)</span>&nbsp;<span class="op" id="5664838">&gt;=</span>&nbsp;<span class="num" id="5664841">5</span>&nbsp;<span class="op" id="5664843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664847">nn</span>&nbsp;<span class="op" id="5664850">:=</span>&nbsp;<span class="builtinfunc" id="5664853">len</span><span class="op" id="5664856">(</span><span class="ident" id="5664857">e</span><span class="op" id="5664858">.</span><span class="ident" id="5664859">out</span><span class="op" id="5664862">)</span>&nbsp;<span class="op" id="5664864">/</span>&nbsp;<span class="num" id="5664866">8</span>&nbsp;<span class="op" id="5664868">*</span>&nbsp;<span class="num" id="5664870">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664874">if</span>&nbsp;<span class="ident" id="5664877">nn</span>&nbsp;<span class="op" id="5664880">&gt;</span>&nbsp;<span class="builtinfunc" id="5664882">len</span><span class="op" id="5664885">(</span><span class="ident" id="5664886">p</span><span class="op" id="5664887">)</span>&nbsp;<span class="op" id="5664889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664894">nn</span>&nbsp;<span class="op" id="5664897">=</span>&nbsp;<span class="builtinfunc" id="5664899">len</span><span class="op" id="5664902">(</span><span class="ident" id="5664903">p</span><span class="op" id="5664904">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664909">nn</span>&nbsp;<span class="op" id="5664912">-=</span>&nbsp;<span class="ident" id="5664915">nn</span>&nbsp;<span class="op" id="5664918">%</span>&nbsp;<span class="num" id="5664920">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5664924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5664928">e</span><span class="op" id="5664929">.</span><span class="ident" id="5664930">enc</span><span class="op" id="5664933">.</span><span class="ident" id="5664934">Encode</span><span class="op" id="5664940">(</span><span class="ident" id="5664941">e</span><span class="op" id="5664942">.</span><span class="ident" id="5664943">out</span><span class="op" id="5664946">[</span><span class="num" id="5664947">0</span><span class="op" id="5664948">:</span><span class="op" id="5664949">]</span><span class="op" id="5664950">,</span>&nbsp;<span class="ident" id="5664952">p</span><span class="op" id="5664953">[</span><span class="num" id="5664954">0</span><span class="op" id="5664955">:</span><span class="ident" id="5664956">nn</span><span class="op" id="5664958">]</span><span class="op" id="5664959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5664963">if</span>&nbsp;<span class="ident" id="5664966">_</span><span class="op" id="5664967">,</span>&nbsp;<span class="ident" id="5664969">e</span><span class="op" id="5664970">.</span><span class="ident" id="5664971">err</span>&nbsp;<span class="op" id="5664975">=</span>&nbsp;<span class="ident" id="5664977">e</span><span class="op" id="5664978">.</span><span class="ident" id="5664979">w</span><span class="op" id="5664980">.</span><span class="ident" id="5664981">Write</span><span class="op" id="5664986">(</span><span class="ident" id="5664987">e</span><span class="op" id="5664988">.</span><span class="ident" id="5664989">out</span><span class="op" id="5664992">[</span><span class="num" id="5664993">0</span>&nbsp;<span class="op" id="5664995">:</span>&nbsp;<span class="ident" id="5664997">nn</span><span class="op" id="5664999">/</span><span class="num" id="5665000">5</span><span class="op" id="5665001">*</span><span class="num" id="5665002">8</span><span class="op" id="5665003">]</span><span class="op" id="5665004">)</span><span class="op" id="5665005">;</span>&nbsp;<span class="ident" id="5665007">e</span><span class="op" id="5665008">.</span><span class="ident" id="5665009">err</span>&nbsp;<span class="op" id="5665013">!=</span>&nbsp;<span class="ident" id="5665016">nil</span>&nbsp;<span class="op" id="5665020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5665025">return</span>&nbsp;<span class="ident" id="5665032">n</span><span class="op" id="5665033">,</span>&nbsp;<span class="ident" id="5665035">e</span><span class="op" id="5665036">.</span><span class="ident" id="5665037">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5665043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5665047">n</span>&nbsp;<span class="op" id="5665049">+=</span>&nbsp;<span class="ident" id="5665052">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5665057">p</span>&nbsp;<span class="op" id="5665059">=</span>&nbsp;<span class="ident" id="5665061">p</span><span class="op" id="5665062">[</span><span class="ident" id="5665063">nn</span><span class="op" id="5665065">:</span><span class="op" id="5665066">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5665069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5665073">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5665094">for</span>&nbsp;<span class="ident" id="5665098">i</span>&nbsp;<span class="op" id="5665100">:=</span>&nbsp;<span class="num" id="5665103">0</span><span class="op" id="5665104">;</span>&nbsp;<span class="ident" id="5665106">i</span>&nbsp;<span class="op" id="5665108">&lt;</span>&nbsp;<span class="builtinfunc" id="5665110">len</span><span class="op" id="5665113">(</span><span class="ident" id="5665114">p</span><span class="op" id="5665115">)</span><span class="op" id="5665116">;</span>&nbsp;<span class="ident" id="5665118">i</span><span class="op" id="5665119">++</span>&nbsp;<span class="op" id="5665122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5665126">e</span><span class="op" id="5665127">.</span><span class="ident" id="5665128">buf</span><span class="op" id="5665131">[</span><span class="ident" id="5665132">i</span><span class="op" id="5665133">]</span>&nbsp;<span class="op" id="5665135">=</span>&nbsp;<span class="ident" id="5665137">p</span><span class="op" id="5665138">[</span><span class="ident" id="5665139">i</span><span class="op" id="5665140">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5665143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5665146">e</span><span class="op" id="5665147">.</span><span class="ident" id="5665148">nbuf</span>&nbsp;<span class="op" id="5665153">=</span>&nbsp;<span class="builtinfunc" id="5665155">len</span><span class="op" id="5665158">(</span><span class="ident" id="5665159">p</span><span class="op" id="5665160">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5665163">n</span>&nbsp;<span class="op" id="5665165">+=</span>&nbsp;<span class="builtinfunc" id="5665168">len</span><span class="op" id="5665171">(</span><span class="ident" id="5665172">p</span><span class="op" id="5665173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5665176">return</span><br>
<span class="lineno"></span><span class="op" id="5665183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5665186">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="5665240">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="5665293">func</span>&nbsp;<span class="op" id="5665298">(</span><span class="ident" id="5665299">e</span>&nbsp;<span class="op" id="5665301">*</span><span class="ident" id="5665302">encoder</span><span class="op" id="5665309">)</span>&nbsp;<span class="ident" id="5665311">Close</span><span class="op" id="5665316">(</span><span class="op" id="5665317">)</span>&nbsp;<span class="builtintype" id="5665319">error</span>&nbsp;<span class="op" id="5665325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5665328">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5665385">if</span>&nbsp;<span class="ident" id="5665388">e</span><span class="op" id="5665389">.</span><span class="ident" id="5665390">err</span>&nbsp;<span class="op" id="5665394">==</span>&nbsp;<span class="ident" id="5665397">nil</span>&nbsp;<span class="op" id="5665401">&amp;&amp;</span>&nbsp;<span class="ident" id="5665404">e</span><span class="op" id="5665405">.</span><span class="ident" id="5665406">nbuf</span>&nbsp;<span class="op" id="5665411">&gt;</span>&nbsp;<span class="num" id="5665413">0</span>&nbsp;<span class="op" id="5665415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5665419">e</span><span class="op" id="5665420">.</span><span class="ident" id="5665421">enc</span><span class="op" id="5665424">.</span><span class="ident" id="5665425">Encode</span><span class="op" id="5665431">(</span><span class="ident" id="5665432">e</span><span class="op" id="5665433">.</span><span class="ident" id="5665434">out</span><span class="op" id="5665437">[</span><span class="num" id="5665438">0</span><span class="op" id="5665439">:</span><span class="op" id="5665440">]</span><span class="op" id="5665441">,</span>&nbsp;<span class="ident" id="5665443">e</span><span class="op" id="5665444">.</span><span class="ident" id="5665445">buf</span><span class="op" id="5665448">[</span><span class="num" id="5665449">0</span><span class="op" id="5665450">:</span><span class="ident" id="5665451">e</span><span class="op" id="5665452">.</span><span class="ident" id="5665453">nbuf</span><span class="op" id="5665457">]</span><span class="op" id="5665458">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5665462">e</span><span class="op" id="5665463">.</span><span class="ident" id="5665464">nbuf</span>&nbsp;<span class="op" id="5665469">=</span>&nbsp;<span class="num" id="5665471">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5665475">_</span><span class="op" id="5665476">,</span>&nbsp;<span class="ident" id="5665478">e</span><span class="op" id="5665479">.</span><span class="ident" id="5665480">err</span>&nbsp;<span class="op" id="5665484">=</span>&nbsp;<span class="ident" id="5665486">e</span><span class="op" id="5665487">.</span><span class="ident" id="5665488">w</span><span class="op" id="5665489">.</span><span class="ident" id="5665490">Write</span><span class="op" id="5665495">(</span><span class="ident" id="5665496">e</span><span class="op" id="5665497">.</span><span class="ident" id="5665498">out</span><span class="op" id="5665501">[</span><span class="num" id="5665502">0</span><span class="op" id="5665503">:</span><span class="num" id="5665504">8</span><span class="op" id="5665505">]</span><span class="op" id="5665506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5665509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5665512">return</span>&nbsp;<span class="ident" id="5665519">e</span><span class="op" id="5665520">.</span><span class="ident" id="5665521">err</span><br>
<span class="lineno"></span><span class="op" id="5665525">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="5665528">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5665596">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="5665668">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="5665728">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="5665796">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="5665825">func</span>&nbsp;<span class="ident" id="5665830">NewEncoder</span><span class="op" id="5665840">(</span><span class="ident" id="5665841">enc</span>&nbsp;<span class="op" id="5665845">*</span><span class="ident" id="5665846">Encoding</span><span class="op" id="5665854">,</span>&nbsp;<span class="ident" id="5665856">w</span>&nbsp;<span class="ident" id="5665858">io</span><span class="op" id="5665860">.</span><span class="ident" id="5665861">Writer</span><span class="op" id="5665867">)</span>&nbsp;<span class="ident" id="5665869">io</span><span class="op" id="5665871">.</span><span class="ident" id="5665872">WriteCloser</span>&nbsp;<span class="op" id="5665884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5665887">return</span>&nbsp;<span class="op" id="5665894">&amp;</span><span class="ident" id="5665895">encoder</span><span class="op" id="5665902">{</span><span class="ident" id="5665903">enc</span><span class="op" id="5665906">:</span>&nbsp;<span class="ident" id="5665908">enc</span><span class="op" id="5665911">,</span>&nbsp;<span class="ident" id="5665913">w</span><span class="op" id="5665914">:</span>&nbsp;<span class="ident" id="5665916">w</span><span class="op" id="5665917">}</span><br>
<span class="lineno"></span><span class="op" id="5665919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5665922">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5665987">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="5666022">func</span>&nbsp;<span class="op" id="5666027">(</span><span class="ident" id="5666028">enc</span>&nbsp;<span class="op" id="5666032">*</span><span class="ident" id="5666033">Encoding</span><span class="op" id="5666041">)</span>&nbsp;<span class="ident" id="5666043">EncodedLen</span><span class="op" id="5666053">(</span><span class="ident" id="5666054">n</span>&nbsp;<span class="builtintype" id="5666056">int</span><span class="op" id="5666059">)</span>&nbsp;<span class="builtintype" id="5666061">int</span>&nbsp;<span class="op" id="5666065">{</span>&nbsp;<span class="keyword" id="5666067">return</span>&nbsp;<span class="op" id="5666074">(</span><span class="ident" id="5666075">n</span>&nbsp;<span class="op" id="5666077">+</span>&nbsp;<span class="num" id="5666079">4</span><span class="op" id="5666080">)</span>&nbsp;<span class="op" id="5666082">/</span>&nbsp;<span class="num" id="5666084">5</span>&nbsp;<span class="op" id="5666086">*</span>&nbsp;<span class="num" id="5666088">8</span>&nbsp;<span class="op" id="5666090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5666093">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5666112">type</span>&nbsp;<span class="ident" id="5666117">CorruptInputError</span>&nbsp;<span class="ident" id="5666135">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="5666142">func</span>&nbsp;<span class="op" id="5666147">(</span><span class="ident" id="5666148">e</span>&nbsp;<span class="ident" id="5666150">CorruptInputError</span><span class="op" id="5666167">)</span>&nbsp;<span class="ident" id="5666169">Error</span><span class="op" id="5666174">(</span><span class="op" id="5666175">)</span>&nbsp;<span class="builtintype" id="5666177">string</span>&nbsp;<span class="op" id="5666184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5666187">return</span>&nbsp;<span class="string" id="5666194">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="5666231">+</span>&nbsp;<span class="ident" id="5666233">strconv</span><span class="op" id="5666240">.</span><span class="ident" id="5666241">FormatInt</span><span class="op" id="5666250">(</span><span class="ident" id="5666251">int64</span><span class="op" id="5666256">(</span><span class="ident" id="5666257">e</span><span class="op" id="5666258">)</span><span class="op" id="5666259">,</span>&nbsp;<span class="num" id="5666261">10</span><span class="op" id="5666263">)</span><br>
<span class="lineno"></span><span class="op" id="5666265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5666268">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="5666338">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5666406">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="5666476">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="5666533">func</span>&nbsp;<span class="op" id="5666538">(</span><span class="ident" id="5666539">enc</span>&nbsp;<span class="op" id="5666543">*</span><span class="ident" id="5666544">Encoding</span><span class="op" id="5666552">)</span>&nbsp;<span class="ident" id="5666554">decode</span><span class="op" id="5666560">(</span><span class="ident" id="5666561">dst</span><span class="op" id="5666564">,</span>&nbsp;<span class="ident" id="5666566">src</span>&nbsp;<span class="op" id="5666570">[</span><span class="op" id="5666571">]</span><span class="builtintype" id="5666572">byte</span><span class="op" id="5666576">)</span>&nbsp;<span class="op" id="5666578">(</span><span class="ident" id="5666579">n</span>&nbsp;<span class="builtintype" id="5666581">int</span><span class="op" id="5666584">,</span>&nbsp;<span class="ident" id="5666586">end</span>&nbsp;<span class="builtintype" id="5666590">bool</span><span class="op" id="5666594">,</span>&nbsp;<span class="ident" id="5666596">err</span>&nbsp;<span class="builtintype" id="5666600">error</span><span class="op" id="5666605">)</span>&nbsp;<span class="op" id="5666607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5666610">olen</span>&nbsp;<span class="op" id="5666615">:=</span>&nbsp;<span class="builtinfunc" id="5666618">len</span><span class="op" id="5666621">(</span><span class="ident" id="5666622">src</span><span class="op" id="5666625">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5666628">for</span>&nbsp;<span class="builtinfunc" id="5666632">len</span><span class="op" id="5666635">(</span><span class="ident" id="5666636">src</span><span class="op" id="5666639">)</span>&nbsp;<span class="op" id="5666641">&gt;</span>&nbsp;<span class="num" id="5666643">0</span>&nbsp;<span class="op" id="5666645">&amp;&amp;</span>&nbsp;<span class="op" id="5666648">!</span><span class="ident" id="5666649">end</span>&nbsp;<span class="op" id="5666653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5666657">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5666703">var</span>&nbsp;<span class="ident" id="5666707">dbuf</span>&nbsp;<span class="op" id="5666712">[</span><span class="num" id="5666713">8</span><span class="op" id="5666714">]</span><span class="builtintype" id="5666715">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5666722">dlen</span>&nbsp;<span class="op" id="5666727">:=</span>&nbsp;<span class="num" id="5666730">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5666735">for</span>&nbsp;<span class="ident" id="5666739">j</span>&nbsp;<span class="op" id="5666741">:=</span>&nbsp;<span class="num" id="5666744">0</span><span class="op" id="5666745">;</span>&nbsp;<span class="ident" id="5666747">j</span>&nbsp;<span class="op" id="5666749">&lt;</span>&nbsp;<span class="num" id="5666751">8</span><span class="op" id="5666752">;</span>&nbsp;<span class="op" id="5666754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5666759">if</span>&nbsp;<span class="builtinfunc" id="5666762">len</span><span class="op" id="5666765">(</span><span class="ident" id="5666766">src</span><span class="op" id="5666769">)</span>&nbsp;<span class="op" id="5666771">==</span>&nbsp;<span class="num" id="5666774">0</span>&nbsp;<span class="op" id="5666776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5666782">return</span>&nbsp;<span class="ident" id="5666789">n</span><span class="op" id="5666790">,</span>&nbsp;<span class="builtintype" id="5666792">false</span><span class="op" id="5666797">,</span>&nbsp;<span class="ident" id="5666799">CorruptInputError</span><span class="op" id="5666816">(</span><span class="ident" id="5666817">olen</span>&nbsp;<span class="op" id="5666822">-</span>&nbsp;<span class="builtinfunc" id="5666824">len</span><span class="op" id="5666827">(</span><span class="ident" id="5666828">src</span><span class="op" id="5666831">)</span>&nbsp;<span class="op" id="5666833">-</span>&nbsp;<span class="ident" id="5666835">j</span><span class="op" id="5666836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5666841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5666846">in</span>&nbsp;<span class="op" id="5666849">:=</span>&nbsp;<span class="ident" id="5666852">src</span><span class="op" id="5666855">[</span><span class="num" id="5666856">0</span><span class="op" id="5666857">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5666862">src</span>&nbsp;<span class="op" id="5666866">=</span>&nbsp;<span class="ident" id="5666868">src</span><span class="op" id="5666871">[</span><span class="num" id="5666872">1</span><span class="op" id="5666873">:</span><span class="op" id="5666874">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5666879">if</span>&nbsp;<span class="ident" id="5666882">in</span>&nbsp;<span class="op" id="5666885">==</span>&nbsp;<span class="string" id="5666888">&#39;=&#39;</span>&nbsp;<span class="op" id="5666892">&amp;&amp;</span>&nbsp;<span class="ident" id="5666895">j</span>&nbsp;<span class="op" id="5666897">&gt;=</span>&nbsp;<span class="num" id="5666900">2</span>&nbsp;<span class="op" id="5666902">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5666905">len</span><span class="op" id="5666908">(</span><span class="ident" id="5666909">src</span><span class="op" id="5666912">)</span>&nbsp;<span class="op" id="5666914">&lt;</span>&nbsp;<span class="num" id="5666916">8</span>&nbsp;<span class="op" id="5666918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5666924">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5666973">if</span>&nbsp;<span class="builtinfunc" id="5666976">len</span><span class="op" id="5666979">(</span><span class="ident" id="5666980">src</span><span class="op" id="5666983">)</span><span class="op" id="5666984">+</span><span class="ident" id="5666985">j</span>&nbsp;<span class="op" id="5666987">&lt;</span>&nbsp;<span class="num" id="5666989">8</span><span class="op" id="5666990">-</span><span class="num" id="5666991">1</span>&nbsp;<span class="op" id="5666993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5667000">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5667027">return</span>&nbsp;<span class="ident" id="5667034">n</span><span class="op" id="5667035">,</span>&nbsp;<span class="builtintype" id="5667037">false</span><span class="op" id="5667042">,</span>&nbsp;<span class="ident" id="5667044">CorruptInputError</span><span class="op" id="5667061">(</span><span class="ident" id="5667062">olen</span><span class="op" id="5667066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5667072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5667078">for</span>&nbsp;<span class="ident" id="5667082">k</span>&nbsp;<span class="op" id="5667084">:=</span>&nbsp;<span class="num" id="5667087">0</span><span class="op" id="5667088">;</span>&nbsp;<span class="ident" id="5667090">k</span>&nbsp;<span class="op" id="5667092">&lt;</span>&nbsp;<span class="num" id="5667094">8</span><span class="op" id="5667095">-</span><span class="num" id="5667096">1</span><span class="op" id="5667097">-</span><span class="ident" id="5667098">j</span><span class="op" id="5667099">;</span>&nbsp;<span class="ident" id="5667101">k</span><span class="op" id="5667102">++</span>&nbsp;<span class="op" id="5667105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5667112">if</span>&nbsp;<span class="builtinfunc" id="5667115">len</span><span class="op" id="5667118">(</span><span class="ident" id="5667119">src</span><span class="op" id="5667122">)</span>&nbsp;<span class="op" id="5667124">&gt;</span>&nbsp;<span class="ident" id="5667126">k</span>&nbsp;<span class="op" id="5667128">&amp;&amp;</span>&nbsp;<span class="ident" id="5667131">src</span><span class="op" id="5667134">[</span><span class="ident" id="5667135">k</span><span class="op" id="5667136">]</span>&nbsp;<span class="op" id="5667138">!=</span>&nbsp;<span class="string" id="5667141">&#39;=&#39;</span>&nbsp;<span class="op" id="5667145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5667153">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5667180">return</span>&nbsp;<span class="ident" id="5667187">n</span><span class="op" id="5667188">,</span>&nbsp;<span class="builtintype" id="5667190">false</span><span class="op" id="5667195">,</span>&nbsp;<span class="ident" id="5667197">CorruptInputError</span><span class="op" id="5667214">(</span><span class="ident" id="5667215">olen</span>&nbsp;<span class="op" id="5667220">-</span>&nbsp;<span class="builtinfunc" id="5667222">len</span><span class="op" id="5667225">(</span><span class="ident" id="5667226">src</span><span class="op" id="5667229">)</span>&nbsp;<span class="op" id="5667231">+</span>&nbsp;<span class="ident" id="5667233">k</span>&nbsp;<span class="op" id="5667235">-</span>&nbsp;<span class="num" id="5667237">1</span><span class="op" id="5667238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5667245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5667251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5667257">dlen</span><span class="op" id="5667261">,</span>&nbsp;<span class="ident" id="5667263">end</span>&nbsp;<span class="op" id="5667267">=</span>&nbsp;<span class="ident" id="5667269">j</span><span class="op" id="5667270">,</span>&nbsp;<span class="builtintype" id="5667272">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5667281">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5667356">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5667432">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5667504">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5667577">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5667648">if</span>&nbsp;<span class="ident" id="5667651">dlen</span>&nbsp;<span class="op" id="5667656">==</span>&nbsp;<span class="num" id="5667659">1</span>&nbsp;<span class="op" id="5667661">||</span>&nbsp;<span class="ident" id="5667664">dlen</span>&nbsp;<span class="op" id="5667669">==</span>&nbsp;<span class="num" id="5667672">3</span>&nbsp;<span class="op" id="5667674">||</span>&nbsp;<span class="ident" id="5667677">dlen</span>&nbsp;<span class="op" id="5667682">==</span>&nbsp;<span class="num" id="5667685">6</span>&nbsp;<span class="op" id="5667687">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5667694">return</span>&nbsp;<span class="ident" id="5667701">n</span><span class="op" id="5667702">,</span>&nbsp;<span class="builtintype" id="5667704">false</span><span class="op" id="5667709">,</span>&nbsp;<span class="ident" id="5667711">CorruptInputError</span><span class="op" id="5667728">(</span><span class="ident" id="5667729">olen</span>&nbsp;<span class="op" id="5667734">-</span>&nbsp;<span class="builtinfunc" id="5667736">len</span><span class="op" id="5667739">(</span><span class="ident" id="5667740">src</span><span class="op" id="5667743">)</span>&nbsp;<span class="op" id="5667745">-</span>&nbsp;<span class="num" id="5667747">1</span><span class="op" id="5667748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5667754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5667760">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5667769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5667774">dbuf</span><span class="op" id="5667778">[</span><span class="ident" id="5667779">j</span><span class="op" id="5667780">]</span>&nbsp;<span class="op" id="5667782">=</span>&nbsp;<span class="ident" id="5667784">enc</span><span class="op" id="5667787">.</span><span class="ident" id="5667788">decodeMap</span><span class="op" id="5667797">[</span><span class="ident" id="5667798">in</span><span class="op" id="5667800">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5667805">if</span>&nbsp;<span class="ident" id="5667808">dbuf</span><span class="op" id="5667812">[</span><span class="ident" id="5667813">j</span><span class="op" id="5667814">]</span>&nbsp;<span class="op" id="5667816">==</span>&nbsp;<span class="num" id="5667819">0xFF</span>&nbsp;<span class="op" id="5667824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5667830">return</span>&nbsp;<span class="ident" id="5667837">n</span><span class="op" id="5667838">,</span>&nbsp;<span class="builtintype" id="5667840">false</span><span class="op" id="5667845">,</span>&nbsp;<span class="ident" id="5667847">CorruptInputError</span><span class="op" id="5667864">(</span><span class="ident" id="5667865">olen</span>&nbsp;<span class="op" id="5667870">-</span>&nbsp;<span class="builtinfunc" id="5667872">len</span><span class="op" id="5667875">(</span><span class="ident" id="5667876">src</span><span class="op" id="5667879">)</span>&nbsp;<span class="op" id="5667881">-</span>&nbsp;<span class="num" id="5667883">1</span><span class="op" id="5667884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5667889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5667894">j</span><span class="op" id="5667895">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5667900">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5667905">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5667962">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5667975">switch</span>&nbsp;<span class="ident" id="5667982">dlen</span>&nbsp;<span class="op" id="5667987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5667991">case</span>&nbsp;<span class="num" id="5667996">8</span><span class="op" id="5667997">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668002">dst</span><span class="op" id="5668005">[</span><span class="num" id="5668006">4</span><span class="op" id="5668007">]</span>&nbsp;<span class="op" id="5668009">=</span>&nbsp;<span class="ident" id="5668011">dbuf</span><span class="op" id="5668015">[</span><span class="num" id="5668016">6</span><span class="op" id="5668017">]</span><span class="op" id="5668018">&lt;&lt;</span><span class="num" id="5668020">5</span>&nbsp;<span class="op" id="5668022">|</span>&nbsp;<span class="ident" id="5668024">dbuf</span><span class="op" id="5668028">[</span><span class="num" id="5668029">7</span><span class="op" id="5668030">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668035">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668049">case</span>&nbsp;<span class="num" id="5668054">7</span><span class="op" id="5668055">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668060">dst</span><span class="op" id="5668063">[</span><span class="num" id="5668064">3</span><span class="op" id="5668065">]</span>&nbsp;<span class="op" id="5668067">=</span>&nbsp;<span class="ident" id="5668069">dbuf</span><span class="op" id="5668073">[</span><span class="num" id="5668074">4</span><span class="op" id="5668075">]</span><span class="op" id="5668076">&lt;&lt;</span><span class="num" id="5668078">7</span>&nbsp;<span class="op" id="5668080">|</span>&nbsp;<span class="ident" id="5668082">dbuf</span><span class="op" id="5668086">[</span><span class="num" id="5668087">5</span><span class="op" id="5668088">]</span><span class="op" id="5668089">&lt;&lt;</span><span class="num" id="5668091">2</span>&nbsp;<span class="op" id="5668093">|</span>&nbsp;<span class="ident" id="5668095">dbuf</span><span class="op" id="5668099">[</span><span class="num" id="5668100">6</span><span class="op" id="5668101">]</span><span class="op" id="5668102">&gt;&gt;</span><span class="num" id="5668104">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668109">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668123">case</span>&nbsp;<span class="num" id="5668128">5</span><span class="op" id="5668129">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668134">dst</span><span class="op" id="5668137">[</span><span class="num" id="5668138">2</span><span class="op" id="5668139">]</span>&nbsp;<span class="op" id="5668141">=</span>&nbsp;<span class="ident" id="5668143">dbuf</span><span class="op" id="5668147">[</span><span class="num" id="5668148">3</span><span class="op" id="5668149">]</span><span class="op" id="5668150">&lt;&lt;</span><span class="num" id="5668152">4</span>&nbsp;<span class="op" id="5668154">|</span>&nbsp;<span class="ident" id="5668156">dbuf</span><span class="op" id="5668160">[</span><span class="num" id="5668161">4</span><span class="op" id="5668162">]</span><span class="op" id="5668163">&gt;&gt;</span><span class="num" id="5668165">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668170">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668184">case</span>&nbsp;<span class="num" id="5668189">4</span><span class="op" id="5668190">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668195">dst</span><span class="op" id="5668198">[</span><span class="num" id="5668199">1</span><span class="op" id="5668200">]</span>&nbsp;<span class="op" id="5668202">=</span>&nbsp;<span class="ident" id="5668204">dbuf</span><span class="op" id="5668208">[</span><span class="num" id="5668209">1</span><span class="op" id="5668210">]</span><span class="op" id="5668211">&lt;&lt;</span><span class="num" id="5668213">6</span>&nbsp;<span class="op" id="5668215">|</span>&nbsp;<span class="ident" id="5668217">dbuf</span><span class="op" id="5668221">[</span><span class="num" id="5668222">2</span><span class="op" id="5668223">]</span><span class="op" id="5668224">&lt;&lt;</span><span class="num" id="5668226">1</span>&nbsp;<span class="op" id="5668228">|</span>&nbsp;<span class="ident" id="5668230">dbuf</span><span class="op" id="5668234">[</span><span class="num" id="5668235">3</span><span class="op" id="5668236">]</span><span class="op" id="5668237">&gt;&gt;</span><span class="num" id="5668239">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668244">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668258">case</span>&nbsp;<span class="num" id="5668263">2</span><span class="op" id="5668264">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668269">dst</span><span class="op" id="5668272">[</span><span class="num" id="5668273">0</span><span class="op" id="5668274">]</span>&nbsp;<span class="op" id="5668276">=</span>&nbsp;<span class="ident" id="5668278">dbuf</span><span class="op" id="5668282">[</span><span class="num" id="5668283">0</span><span class="op" id="5668284">]</span><span class="op" id="5668285">&lt;&lt;</span><span class="num" id="5668287">3</span>&nbsp;<span class="op" id="5668289">|</span>&nbsp;<span class="ident" id="5668291">dbuf</span><span class="op" id="5668295">[</span><span class="num" id="5668296">1</span><span class="op" id="5668297">]</span><span class="op" id="5668298">&gt;&gt;</span><span class="num" id="5668300">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5668304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668308">dst</span>&nbsp;<span class="op" id="5668312">=</span>&nbsp;<span class="ident" id="5668314">dst</span><span class="op" id="5668317">[</span><span class="num" id="5668318">5</span><span class="op" id="5668319">:</span><span class="op" id="5668320">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668324">switch</span>&nbsp;<span class="ident" id="5668331">dlen</span>&nbsp;<span class="op" id="5668336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668340">case</span>&nbsp;<span class="num" id="5668345">2</span><span class="op" id="5668346">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668351">n</span>&nbsp;<span class="op" id="5668353">+=</span>&nbsp;<span class="num" id="5668356">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668360">case</span>&nbsp;<span class="num" id="5668365">4</span><span class="op" id="5668366">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668371">n</span>&nbsp;<span class="op" id="5668373">+=</span>&nbsp;<span class="num" id="5668376">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668380">case</span>&nbsp;<span class="num" id="5668385">5</span><span class="op" id="5668386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668391">n</span>&nbsp;<span class="op" id="5668393">+=</span>&nbsp;<span class="num" id="5668396">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668400">case</span>&nbsp;<span class="num" id="5668405">7</span><span class="op" id="5668406">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668411">n</span>&nbsp;<span class="op" id="5668413">+=</span>&nbsp;<span class="num" id="5668416">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668420">case</span>&nbsp;<span class="num" id="5668425">8</span><span class="op" id="5668426">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668431">n</span>&nbsp;<span class="op" id="5668433">+=</span>&nbsp;<span class="num" id="5668436">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5668440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5668443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668446">return</span>&nbsp;<span class="ident" id="5668453">n</span><span class="op" id="5668454">,</span>&nbsp;<span class="ident" id="5668456">end</span><span class="op" id="5668459">,</span>&nbsp;<span class="ident" id="5668461">nil</span><br>
<span class="lineno"></span><span class="op" id="5668465">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="5668468">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="5668533">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="5668602">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5668671">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="5668734">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="5668782">func</span>&nbsp;<span class="op" id="5668787">(</span><span class="ident" id="5668788">enc</span>&nbsp;<span class="op" id="5668792">*</span><span class="ident" id="5668793">Encoding</span><span class="op" id="5668801">)</span>&nbsp;<span class="ident" id="5668803">Decode</span><span class="op" id="5668809">(</span><span class="ident" id="5668810">dst</span><span class="op" id="5668813">,</span>&nbsp;<span class="ident" id="5668815">src</span>&nbsp;<span class="op" id="5668819">[</span><span class="op" id="5668820">]</span><span class="builtintype" id="5668821">byte</span><span class="op" id="5668825">)</span>&nbsp;<span class="op" id="5668827">(</span><span class="ident" id="5668828">n</span>&nbsp;<span class="builtintype" id="5668830">int</span><span class="op" id="5668833">,</span>&nbsp;<span class="ident" id="5668835">err</span>&nbsp;<span class="builtintype" id="5668839">error</span><span class="op" id="5668844">)</span>&nbsp;<span class="op" id="5668846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668849">src</span>&nbsp;<span class="op" id="5668853">=</span>&nbsp;<span class="ident" id="5668855">bytes</span><span class="op" id="5668860">.</span><span class="ident" id="5668861">Map</span><span class="op" id="5668864">(</span><span class="ident" id="5668865">removeNewlinesMapper</span><span class="op" id="5668885">,</span>&nbsp;<span class="ident" id="5668887">src</span><span class="op" id="5668890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5668893">n</span><span class="op" id="5668894">,</span>&nbsp;<span class="ident" id="5668896">_</span><span class="op" id="5668897">,</span>&nbsp;<span class="ident" id="5668899">err</span>&nbsp;<span class="op" id="5668903">=</span>&nbsp;<span class="ident" id="5668905">enc</span><span class="op" id="5668908">.</span><span class="ident" id="5668909">decode</span><span class="op" id="5668915">(</span><span class="ident" id="5668916">dst</span><span class="op" id="5668919">,</span>&nbsp;<span class="ident" id="5668921">src</span><span class="op" id="5668924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5668927">return</span><br>
<span class="lineno">325</span><span class="op" id="5668934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5668937">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5669007">func</span>&nbsp;<span class="op" id="5669012">(</span><span class="ident" id="5669013">enc</span>&nbsp;<span class="op" id="5669017">*</span><span class="ident" id="5669018">Encoding</span><span class="op" id="5669026">)</span>&nbsp;<span class="ident" id="5669028">DecodeString</span><span class="op" id="5669040">(</span><span class="ident" id="5669041">s</span>&nbsp;<span class="builtintype" id="5669043">string</span><span class="op" id="5669049">)</span>&nbsp;<span class="op" id="5669051">(</span><span class="op" id="5669052">[</span><span class="op" id="5669053">]</span><span class="builtintype" id="5669054">byte</span><span class="op" id="5669058">,</span>&nbsp;<span class="builtintype" id="5669060">error</span><span class="op" id="5669065">)</span>&nbsp;<span class="op" id="5669067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669070">s</span>&nbsp;<span class="op" id="5669072">=</span>&nbsp;<span class="ident" id="5669074">strings</span><span class="op" id="5669081">.</span><span class="ident" id="5669082">Map</span><span class="op" id="5669085">(</span><span class="ident" id="5669086">removeNewlinesMapper</span><span class="op" id="5669106">,</span>&nbsp;<span class="ident" id="5669108">s</span><span class="op" id="5669109">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669112">dbuf</span>&nbsp;<span class="op" id="5669117">:=</span>&nbsp;<span class="builtinfunc" id="5669120">make</span><span class="op" id="5669124">(</span><span class="op" id="5669125">[</span><span class="op" id="5669126">]</span><span class="builtintype" id="5669127">byte</span><span class="op" id="5669131">,</span>&nbsp;<span class="ident" id="5669133">enc</span><span class="op" id="5669136">.</span><span class="ident" id="5669137">DecodedLen</span><span class="op" id="5669147">(</span><span class="builtinfunc" id="5669148">len</span><span class="op" id="5669151">(</span><span class="ident" id="5669152">s</span><span class="op" id="5669153">)</span><span class="op" id="5669154">)</span><span class="op" id="5669155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669158">n</span><span class="op" id="5669159">,</span>&nbsp;<span class="ident" id="5669161">_</span><span class="op" id="5669162">,</span>&nbsp;<span class="ident" id="5669164">err</span>&nbsp;<span class="op" id="5669168">:=</span>&nbsp;<span class="ident" id="5669171">enc</span><span class="op" id="5669174">.</span><span class="ident" id="5669175">decode</span><span class="op" id="5669181">(</span><span class="ident" id="5669182">dbuf</span><span class="op" id="5669186">,</span>&nbsp;<span class="op" id="5669188">[</span><span class="op" id="5669189">]</span><span class="builtintype" id="5669190">byte</span><span class="op" id="5669194">(</span><span class="ident" id="5669195">s</span><span class="op" id="5669196">)</span><span class="op" id="5669197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5669200">return</span>&nbsp;<span class="ident" id="5669207">dbuf</span><span class="op" id="5669211">[</span><span class="op" id="5669212">:</span><span class="ident" id="5669213">n</span><span class="op" id="5669214">]</span><span class="op" id="5669215">,</span>&nbsp;<span class="ident" id="5669217">err</span><br>
<span class="lineno"></span><span class="op" id="5669221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="5669224">type</span>&nbsp;<span class="ident" id="5669229">decoder</span>&nbsp;<span class="keyword" id="5669237">struct</span>&nbsp;<span class="op" id="5669244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669247">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5669254">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669261">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5669268">*</span><span class="ident" id="5669269">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669279">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5669286">io</span><span class="op" id="5669288">.</span><span class="ident" id="5669289">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669297">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5669304">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5669315">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669338">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5669345">[</span><span class="num" id="5669346">1024</span><span class="op" id="5669350">]</span><span class="builtintype" id="5669351">byte</span>&nbsp;<span class="comment" id="5669356">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669375">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5669382">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669387">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5669394">[</span><span class="op" id="5669395">]</span><span class="builtintype" id="5669396">byte</span>&nbsp;<span class="comment" id="5669401">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669429">outbuf</span>&nbsp;<span class="op" id="5669436">[</span><span class="num" id="5669437">1024</span>&nbsp;<span class="op" id="5669442">/</span>&nbsp;<span class="num" id="5669444">8</span>&nbsp;<span class="op" id="5669446">*</span>&nbsp;<span class="num" id="5669448">5</span><span class="op" id="5669449">]</span><span class="builtintype" id="5669450">byte</span><br>
<span class="lineno"></span><span class="op" id="5669455">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="5669458">func</span>&nbsp;<span class="op" id="5669463">(</span><span class="ident" id="5669464">d</span>&nbsp;<span class="op" id="5669466">*</span><span class="ident" id="5669467">decoder</span><span class="op" id="5669474">)</span>&nbsp;<span class="ident" id="5669476">Read</span><span class="op" id="5669480">(</span><span class="ident" id="5669481">p</span>&nbsp;<span class="op" id="5669483">[</span><span class="op" id="5669484">]</span><span class="builtintype" id="5669485">byte</span><span class="op" id="5669489">)</span>&nbsp;<span class="op" id="5669491">(</span><span class="ident" id="5669492">n</span>&nbsp;<span class="builtintype" id="5669494">int</span><span class="op" id="5669497">,</span>&nbsp;<span class="ident" id="5669499">err</span>&nbsp;<span class="builtintype" id="5669503">error</span><span class="op" id="5669508">)</span>&nbsp;<span class="op" id="5669510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5669513">if</span>&nbsp;<span class="ident" id="5669516">d</span><span class="op" id="5669517">.</span><span class="ident" id="5669518">err</span>&nbsp;<span class="op" id="5669522">!=</span>&nbsp;<span class="ident" id="5669525">nil</span>&nbsp;<span class="op" id="5669529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5669533">return</span>&nbsp;<span class="num" id="5669540">0</span><span class="op" id="5669541">,</span>&nbsp;<span class="ident" id="5669543">d</span><span class="op" id="5669544">.</span><span class="ident" id="5669545">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5669550">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5669554">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5669602">if</span>&nbsp;<span class="builtinfunc" id="5669605">len</span><span class="op" id="5669608">(</span><span class="ident" id="5669609">d</span><span class="op" id="5669610">.</span><span class="ident" id="5669611">out</span><span class="op" id="5669614">)</span>&nbsp;<span class="op" id="5669616">&gt;</span>&nbsp;<span class="num" id="5669618">0</span>&nbsp;<span class="op" id="5669620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669624">n</span>&nbsp;<span class="op" id="5669626">=</span>&nbsp;<span class="builtinfunc" id="5669628">copy</span><span class="op" id="5669632">(</span><span class="ident" id="5669633">p</span><span class="op" id="5669634">,</span>&nbsp;<span class="ident" id="5669636">d</span><span class="op" id="5669637">.</span><span class="ident" id="5669638">out</span><span class="op" id="5669641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669645">d</span><span class="op" id="5669646">.</span><span class="ident" id="5669647">out</span>&nbsp;<span class="op" id="5669651">=</span>&nbsp;<span class="ident" id="5669653">d</span><span class="op" id="5669654">.</span><span class="ident" id="5669655">out</span><span class="op" id="5669658">[</span><span class="ident" id="5669659">n</span><span class="op" id="5669660">:</span><span class="op" id="5669661">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5669665">return</span>&nbsp;<span class="ident" id="5669672">n</span><span class="op" id="5669673">,</span>&nbsp;<span class="ident" id="5669675">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5669680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5669684">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669702">nn</span>&nbsp;<span class="op" id="5669705">:=</span>&nbsp;<span class="builtinfunc" id="5669708">len</span><span class="op" id="5669711">(</span><span class="ident" id="5669712">p</span><span class="op" id="5669713">)</span>&nbsp;<span class="op" id="5669715">/</span>&nbsp;<span class="num" id="5669717">5</span>&nbsp;<span class="op" id="5669719">*</span>&nbsp;<span class="num" id="5669721">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5669724">if</span>&nbsp;<span class="ident" id="5669727">nn</span>&nbsp;<span class="op" id="5669730">&lt;</span>&nbsp;<span class="num" id="5669732">8</span>&nbsp;<span class="op" id="5669734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669738">nn</span>&nbsp;<span class="op" id="5669741">=</span>&nbsp;<span class="num" id="5669743">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5669746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5669749">if</span>&nbsp;<span class="ident" id="5669752">nn</span>&nbsp;<span class="op" id="5669755">&gt;</span>&nbsp;<span class="builtinfunc" id="5669757">len</span><span class="op" id="5669760">(</span><span class="ident" id="5669761">d</span><span class="op" id="5669762">.</span><span class="ident" id="5669763">buf</span><span class="op" id="5669766">)</span>&nbsp;<span class="op" id="5669768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669772">nn</span>&nbsp;<span class="op" id="5669775">=</span>&nbsp;<span class="builtinfunc" id="5669777">len</span><span class="op" id="5669780">(</span><span class="ident" id="5669781">d</span><span class="op" id="5669782">.</span><span class="ident" id="5669783">buf</span><span class="op" id="5669786">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5669789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669792">nn</span><span class="op" id="5669794">,</span>&nbsp;<span class="ident" id="5669796">d</span><span class="op" id="5669797">.</span><span class="ident" id="5669798">err</span>&nbsp;<span class="op" id="5669802">=</span>&nbsp;<span class="ident" id="5669804">io</span><span class="op" id="5669806">.</span><span class="ident" id="5669807">ReadAtLeast</span><span class="op" id="5669818">(</span><span class="ident" id="5669819">d</span><span class="op" id="5669820">.</span><span class="ident" id="5669821">r</span><span class="op" id="5669822">,</span>&nbsp;<span class="ident" id="5669824">d</span><span class="op" id="5669825">.</span><span class="ident" id="5669826">buf</span><span class="op" id="5669829">[</span><span class="ident" id="5669830">d</span><span class="op" id="5669831">.</span><span class="ident" id="5669832">nbuf</span><span class="op" id="5669836">:</span><span class="ident" id="5669837">nn</span><span class="op" id="5669839">]</span><span class="op" id="5669840">,</span>&nbsp;<span class="num" id="5669842">8</span><span class="op" id="5669843">-</span><span class="ident" id="5669844">d</span><span class="op" id="5669845">.</span><span class="ident" id="5669846">nbuf</span><span class="op" id="5669850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669853">d</span><span class="op" id="5669854">.</span><span class="ident" id="5669855">nbuf</span>&nbsp;<span class="op" id="5669860">+=</span>&nbsp;<span class="ident" id="5669863">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5669867">if</span>&nbsp;<span class="ident" id="5669870">d</span><span class="op" id="5669871">.</span><span class="ident" id="5669872">nbuf</span>&nbsp;<span class="op" id="5669877">&lt;</span>&nbsp;<span class="num" id="5669879">8</span>&nbsp;<span class="op" id="5669881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5669885">return</span>&nbsp;<span class="num" id="5669892">0</span><span class="op" id="5669893">,</span>&nbsp;<span class="ident" id="5669895">d</span><span class="op" id="5669896">.</span><span class="ident" id="5669897">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5669902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5669906">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669970">nr</span>&nbsp;<span class="op" id="5669973">:=</span>&nbsp;<span class="ident" id="5669976">d</span><span class="op" id="5669977">.</span><span class="ident" id="5669978">nbuf</span>&nbsp;<span class="op" id="5669983">/</span>&nbsp;<span class="num" id="5669985">8</span>&nbsp;<span class="op" id="5669987">*</span>&nbsp;<span class="num" id="5669989">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5669992">nw</span>&nbsp;<span class="op" id="5669995">:=</span>&nbsp;<span class="ident" id="5669998">d</span><span class="op" id="5669999">.</span><span class="ident" id="5670000">nbuf</span>&nbsp;<span class="op" id="5670005">/</span>&nbsp;<span class="num" id="5670007">8</span>&nbsp;<span class="op" id="5670009">*</span>&nbsp;<span class="num" id="5670011">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5670014">if</span>&nbsp;<span class="ident" id="5670017">nw</span>&nbsp;<span class="op" id="5670020">&gt;</span>&nbsp;<span class="builtinfunc" id="5670022">len</span><span class="op" id="5670025">(</span><span class="ident" id="5670026">p</span><span class="op" id="5670027">)</span>&nbsp;<span class="op" id="5670029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670033">nw</span><span class="op" id="5670035">,</span>&nbsp;<span class="ident" id="5670037">d</span><span class="op" id="5670038">.</span><span class="ident" id="5670039">end</span><span class="op" id="5670042">,</span>&nbsp;<span class="ident" id="5670044">d</span><span class="op" id="5670045">.</span><span class="ident" id="5670046">err</span>&nbsp;<span class="op" id="5670050">=</span>&nbsp;<span class="ident" id="5670052">d</span><span class="op" id="5670053">.</span><span class="ident" id="5670054">enc</span><span class="op" id="5670057">.</span><span class="ident" id="5670058">decode</span><span class="op" id="5670064">(</span><span class="ident" id="5670065">d</span><span class="op" id="5670066">.</span><span class="ident" id="5670067">outbuf</span><span class="op" id="5670073">[</span><span class="num" id="5670074">0</span><span class="op" id="5670075">:</span><span class="op" id="5670076">]</span><span class="op" id="5670077">,</span>&nbsp;<span class="ident" id="5670079">d</span><span class="op" id="5670080">.</span><span class="ident" id="5670081">buf</span><span class="op" id="5670084">[</span><span class="num" id="5670085">0</span><span class="op" id="5670086">:</span><span class="ident" id="5670087">nr</span><span class="op" id="5670089">]</span><span class="op" id="5670090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670094">d</span><span class="op" id="5670095">.</span><span class="ident" id="5670096">out</span>&nbsp;<span class="op" id="5670100">=</span>&nbsp;<span class="ident" id="5670102">d</span><span class="op" id="5670103">.</span><span class="ident" id="5670104">outbuf</span><span class="op" id="5670110">[</span><span class="num" id="5670111">0</span><span class="op" id="5670112">:</span><span class="ident" id="5670113">nw</span><span class="op" id="5670115">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670119">n</span>&nbsp;<span class="op" id="5670121">=</span>&nbsp;<span class="builtinfunc" id="5670123">copy</span><span class="op" id="5670127">(</span><span class="ident" id="5670128">p</span><span class="op" id="5670129">,</span>&nbsp;<span class="ident" id="5670131">d</span><span class="op" id="5670132">.</span><span class="ident" id="5670133">out</span><span class="op" id="5670136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670140">d</span><span class="op" id="5670141">.</span><span class="ident" id="5670142">out</span>&nbsp;<span class="op" id="5670146">=</span>&nbsp;<span class="ident" id="5670148">d</span><span class="op" id="5670149">.</span><span class="ident" id="5670150">out</span><span class="op" id="5670153">[</span><span class="ident" id="5670154">n</span><span class="op" id="5670155">:</span><span class="op" id="5670156">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5670159">}</span>&nbsp;<span class="keyword" id="5670161">else</span>&nbsp;<span class="op" id="5670166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670170">n</span><span class="op" id="5670171">,</span>&nbsp;<span class="ident" id="5670173">d</span><span class="op" id="5670174">.</span><span class="ident" id="5670175">end</span><span class="op" id="5670178">,</span>&nbsp;<span class="ident" id="5670180">d</span><span class="op" id="5670181">.</span><span class="ident" id="5670182">err</span>&nbsp;<span class="op" id="5670186">=</span>&nbsp;<span class="ident" id="5670188">d</span><span class="op" id="5670189">.</span><span class="ident" id="5670190">enc</span><span class="op" id="5670193">.</span><span class="ident" id="5670194">decode</span><span class="op" id="5670200">(</span><span class="ident" id="5670201">p</span><span class="op" id="5670202">,</span>&nbsp;<span class="ident" id="5670204">d</span><span class="op" id="5670205">.</span><span class="ident" id="5670206">buf</span><span class="op" id="5670209">[</span><span class="num" id="5670210">0</span><span class="op" id="5670211">:</span><span class="ident" id="5670212">nr</span><span class="op" id="5670214">]</span><span class="op" id="5670215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5670218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670221">d</span><span class="op" id="5670222">.</span><span class="ident" id="5670223">nbuf</span>&nbsp;<span class="op" id="5670228">-=</span>&nbsp;<span class="ident" id="5670231">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5670235">for</span>&nbsp;<span class="ident" id="5670239">i</span>&nbsp;<span class="op" id="5670241">:=</span>&nbsp;<span class="num" id="5670244">0</span><span class="op" id="5670245">;</span>&nbsp;<span class="ident" id="5670247">i</span>&nbsp;<span class="op" id="5670249">&lt;</span>&nbsp;<span class="ident" id="5670251">d</span><span class="op" id="5670252">.</span><span class="ident" id="5670253">nbuf</span><span class="op" id="5670257">;</span>&nbsp;<span class="ident" id="5670259">i</span><span class="op" id="5670260">++</span>&nbsp;<span class="op" id="5670263">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670267">d</span><span class="op" id="5670268">.</span><span class="ident" id="5670269">buf</span><span class="op" id="5670272">[</span><span class="ident" id="5670273">i</span><span class="op" id="5670274">]</span>&nbsp;<span class="op" id="5670276">=</span>&nbsp;<span class="ident" id="5670278">d</span><span class="op" id="5670279">.</span><span class="ident" id="5670280">buf</span><span class="op" id="5670283">[</span><span class="ident" id="5670284">i</span><span class="op" id="5670285">+</span><span class="ident" id="5670286">nr</span><span class="op" id="5670288">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5670291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5670295">if</span>&nbsp;<span class="ident" id="5670298">d</span><span class="op" id="5670299">.</span><span class="ident" id="5670300">err</span>&nbsp;<span class="op" id="5670304">==</span>&nbsp;<span class="ident" id="5670307">nil</span>&nbsp;<span class="op" id="5670311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670315">d</span><span class="op" id="5670316">.</span><span class="ident" id="5670317">err</span>&nbsp;<span class="op" id="5670321">=</span>&nbsp;<span class="ident" id="5670323">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5670328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5670331">return</span>&nbsp;<span class="ident" id="5670338">n</span><span class="op" id="5670339">,</span>&nbsp;<span class="ident" id="5670341">d</span><span class="op" id="5670342">.</span><span class="ident" id="5670343">err</span><br>
<span class="lineno"></span><span class="op" id="5670347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5670350">type</span>&nbsp;<span class="ident" id="5670355">newlineFilteringReader</span>&nbsp;<span class="keyword" id="5670378">struct</span>&nbsp;<span class="op" id="5670385">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670388">wrapped</span>&nbsp;<span class="ident" id="5670396">io</span><span class="op" id="5670398">.</span><span class="ident" id="5670399">Reader</span><br>
<span class="lineno"></span><span class="op" id="5670406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5670409">func</span>&nbsp;<span class="op" id="5670414">(</span><span class="ident" id="5670415">r</span>&nbsp;<span class="op" id="5670417">*</span><span class="ident" id="5670418">newlineFilteringReader</span><span class="op" id="5670440">)</span>&nbsp;<span class="ident" id="5670442">Read</span><span class="op" id="5670446">(</span><span class="ident" id="5670447">p</span>&nbsp;<span class="op" id="5670449">[</span><span class="op" id="5670450">]</span><span class="builtintype" id="5670451">byte</span><span class="op" id="5670455">)</span>&nbsp;<span class="op" id="5670457">(</span><span class="builtintype" id="5670458">int</span><span class="op" id="5670461">,</span>&nbsp;<span class="builtintype" id="5670463">error</span><span class="op" id="5670468">)</span>&nbsp;<span class="op" id="5670470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670473">n</span><span class="op" id="5670474">,</span>&nbsp;<span class="ident" id="5670476">err</span>&nbsp;<span class="op" id="5670480">:=</span>&nbsp;<span class="ident" id="5670483">r</span><span class="op" id="5670484">.</span><span class="ident" id="5670485">wrapped</span><span class="op" id="5670492">.</span><span class="ident" id="5670493">Read</span><span class="op" id="5670497">(</span><span class="ident" id="5670498">p</span><span class="op" id="5670499">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5670502">for</span>&nbsp;<span class="ident" id="5670506">n</span>&nbsp;<span class="op" id="5670508">&gt;</span>&nbsp;<span class="num" id="5670510">0</span>&nbsp;<span class="op" id="5670512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670516">offset</span>&nbsp;<span class="op" id="5670523">:=</span>&nbsp;<span class="num" id="5670526">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5670530">for</span>&nbsp;<span class="ident" id="5670534">i</span><span class="op" id="5670535">,</span>&nbsp;<span class="ident" id="5670537">b</span>&nbsp;<span class="op" id="5670539">:=</span>&nbsp;<span class="keyword" id="5670542">range</span>&nbsp;<span class="ident" id="5670548">p</span><span class="op" id="5670549">[</span><span class="num" id="5670550">0</span><span class="op" id="5670551">:</span><span class="ident" id="5670552">n</span><span class="op" id="5670553">]</span>&nbsp;<span class="op" id="5670555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5670560">if</span>&nbsp;<span class="ident" id="5670563">b</span>&nbsp;<span class="op" id="5670565">!=</span>&nbsp;<span class="string" id="5670568">&#39;\r&#39;</span>&nbsp;<span class="op" id="5670573">&amp;&amp;</span>&nbsp;<span class="ident" id="5670576">b</span>&nbsp;<span class="op" id="5670578">!=</span>&nbsp;<span class="string" id="5670581">&#39;\n&#39;</span>&nbsp;<span class="op" id="5670586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5670592">if</span>&nbsp;<span class="ident" id="5670595">i</span>&nbsp;<span class="op" id="5670597">!=</span>&nbsp;<span class="ident" id="5670600">offset</span>&nbsp;<span class="op" id="5670607">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670614">p</span><span class="op" id="5670615">[</span><span class="ident" id="5670616">offset</span><span class="op" id="5670622">]</span>&nbsp;<span class="op" id="5670624">=</span>&nbsp;<span class="ident" id="5670626">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5670632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670638">offset</span><span class="op" id="5670644">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5670650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5670654">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5670658">if</span>&nbsp;<span class="ident" id="5670661">offset</span>&nbsp;<span class="op" id="5670668">&gt;</span>&nbsp;<span class="num" id="5670670">0</span>&nbsp;<span class="op" id="5670672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5670677">return</span>&nbsp;<span class="ident" id="5670684">offset</span><span class="op" id="5670690">,</span>&nbsp;<span class="ident" id="5670692">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5670698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5670702">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5670755">n</span><span class="op" id="5670756">,</span>&nbsp;<span class="ident" id="5670758">err</span>&nbsp;<span class="op" id="5670762">=</span>&nbsp;<span class="ident" id="5670764">r</span><span class="op" id="5670765">.</span><span class="ident" id="5670766">wrapped</span><span class="op" id="5670773">.</span><span class="ident" id="5670774">Read</span><span class="op" id="5670778">(</span><span class="ident" id="5670779">p</span><span class="op" id="5670780">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5670783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5670786">return</span>&nbsp;<span class="ident" id="5670793">n</span><span class="op" id="5670794">,</span>&nbsp;<span class="ident" id="5670796">err</span><br>
<span class="lineno"></span><span class="op" id="5670800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5670803">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="5670857">func</span>&nbsp;<span class="ident" id="5670862">NewDecoder</span><span class="op" id="5670872">(</span><span class="ident" id="5670873">enc</span>&nbsp;<span class="op" id="5670877">*</span><span class="ident" id="5670878">Encoding</span><span class="op" id="5670886">,</span>&nbsp;<span class="ident" id="5670888">r</span>&nbsp;<span class="ident" id="5670890">io</span><span class="op" id="5670892">.</span><span class="ident" id="5670893">Reader</span><span class="op" id="5670899">)</span>&nbsp;<span class="ident" id="5670901">io</span><span class="op" id="5670903">.</span><span class="ident" id="5670904">Reader</span>&nbsp;<span class="op" id="5670911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5670914">return</span>&nbsp;<span class="op" id="5670921">&amp;</span><span class="ident" id="5670922">decoder</span><span class="op" id="5670929">{</span><span class="ident" id="5670930">enc</span><span class="op" id="5670933">:</span>&nbsp;<span class="ident" id="5670935">enc</span><span class="op" id="5670938">,</span>&nbsp;<span class="ident" id="5670940">r</span><span class="op" id="5670941">:</span>&nbsp;<span class="op" id="5670943">&amp;</span><span class="ident" id="5670944">newlineFilteringReader</span><span class="op" id="5670966">{</span><span class="ident" id="5670967">r</span><span class="op" id="5670968">}</span><span class="op" id="5670969">}</span><br>
<span class="lineno"></span><span class="op" id="5670971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5670974">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="5671044">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5671096">func</span>&nbsp;<span class="op" id="5671101">(</span><span class="ident" id="5671102">enc</span>&nbsp;<span class="op" id="5671106">*</span><span class="ident" id="5671107">Encoding</span><span class="op" id="5671115">)</span>&nbsp;<span class="ident" id="5671117">DecodedLen</span><span class="op" id="5671127">(</span><span class="ident" id="5671128">n</span>&nbsp;<span class="builtintype" id="5671130">int</span><span class="op" id="5671133">)</span>&nbsp;<span class="builtintype" id="5671135">int</span>&nbsp;<span class="op" id="5671139">{</span>&nbsp;<span class="keyword" id="5671141">return</span>&nbsp;<span class="ident" id="5671148">n</span>&nbsp;<span class="op" id="5671150">/</span>&nbsp;<span class="num" id="5671152">8</span>&nbsp;<span class="op" id="5671154">*</span>&nbsp;<span class="num" id="5671156">5</span>&nbsp;<span class="op" id="5671158">}</span>
</div>
</body>
</html>
