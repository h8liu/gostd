<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1979530">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1979585">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1979639">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1979690">//&nbsp;Multiprecision&nbsp;decimal&nbsp;numbers.</span><br>
<span class="lineno"></span><span class="comment" id="1979725">//&nbsp;For&nbsp;floating-point&nbsp;formatting&nbsp;only;&nbsp;not&nbsp;general&nbsp;purpose.</span><br>
<span class="lineno"></span><span class="comment" id="1979785">//&nbsp;Only&nbsp;operations&nbsp;are&nbsp;assign&nbsp;and&nbsp;(binary)&nbsp;left/right&nbsp;shift.</span><br>
<span class="lineno"></span><span class="comment" id="1979846">//&nbsp;Can&nbsp;do&nbsp;binary&nbsp;floating&nbsp;point&nbsp;in&nbsp;multiprecision&nbsp;decimal&nbsp;precisely</span><br>
<span class="lineno"></span><span class="comment" id="1979914">//&nbsp;because&nbsp;2&nbsp;divides&nbsp;10;&nbsp;cannot&nbsp;do&nbsp;decimal&nbsp;floating&nbsp;point</span><br>
<span class="lineno">10</span><span class="comment" id="1979972">//&nbsp;in&nbsp;multiprecision&nbsp;binary&nbsp;precisely.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1980012">package</span>&nbsp;<span class="ident" id="1980020">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1980029">type</span>&nbsp;<span class="ident" id="1980034">decimal</span>&nbsp;<span class="keyword" id="1980042">struct</span>&nbsp;<span class="op" id="1980049">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980052">d</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1980058">[</span><span class="num" id="1980059">800</span><span class="op" id="1980062">]</span><span class="builtintype" id="1980063">byte</span>&nbsp;<span class="comment" id="1980068">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980079">nd</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1980085">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1980095">//&nbsp;number&nbsp;of&nbsp;digits&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980121">dp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1980127">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1980137">//&nbsp;decimal&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980155">neg</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1980161">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980167">trunc</span>&nbsp;<span class="builtintype" id="1980173">bool</span>&nbsp;<span class="comment" id="1980178">//&nbsp;discarded&nbsp;nonzero&nbsp;digits&nbsp;beyond&nbsp;d[:nd]</span><br>
<span class="lineno">20</span><span class="op" id="1980220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1980223">func</span>&nbsp;<span class="op" id="1980228">(</span><span class="ident" id="1980229">a</span>&nbsp;<span class="op" id="1980231">*</span><span class="ident" id="1980232">decimal</span><span class="op" id="1980239">)</span>&nbsp;<span class="ident" id="1980241">String</span><span class="op" id="1980247">(</span><span class="op" id="1980248">)</span>&nbsp;<span class="builtintype" id="1980250">string</span>&nbsp;<span class="op" id="1980257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980260">n</span>&nbsp;<span class="op" id="1980262">:=</span>&nbsp;<span class="num" id="1980265">10</span>&nbsp;<span class="op" id="1980268">+</span>&nbsp;<span class="ident" id="1980270">a</span><span class="op" id="1980271">.</span><span class="ident" id="1980272">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980276">if</span>&nbsp;<span class="ident" id="1980279">a</span><span class="op" id="1980280">.</span><span class="ident" id="1980281">dp</span>&nbsp;<span class="op" id="1980284">&gt;</span>&nbsp;<span class="num" id="1980286">0</span>&nbsp;<span class="op" id="1980288">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980292">n</span>&nbsp;<span class="op" id="1980294">+=</span>&nbsp;<span class="ident" id="1980297">a</span><span class="op" id="1980298">.</span><span class="ident" id="1980299">dp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1980303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980306">if</span>&nbsp;<span class="ident" id="1980309">a</span><span class="op" id="1980310">.</span><span class="ident" id="1980311">dp</span>&nbsp;<span class="op" id="1980314">&lt;</span>&nbsp;<span class="num" id="1980316">0</span>&nbsp;<span class="op" id="1980318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980322">n</span>&nbsp;<span class="op" id="1980324">+=</span>&nbsp;<span class="op" id="1980327">-</span><span class="ident" id="1980328">a</span><span class="op" id="1980329">.</span><span class="ident" id="1980330">dp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1980334">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980338">buf</span>&nbsp;<span class="op" id="1980342">:=</span>&nbsp;<span class="builtinfunc" id="1980345">make</span><span class="op" id="1980349">(</span><span class="op" id="1980350">[</span><span class="op" id="1980351">]</span><span class="builtintype" id="1980352">byte</span><span class="op" id="1980356">,</span>&nbsp;<span class="ident" id="1980358">n</span><span class="op" id="1980359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980362">w</span>&nbsp;<span class="op" id="1980364">:=</span>&nbsp;<span class="num" id="1980367">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980370">switch</span>&nbsp;<span class="op" id="1980377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980380">case</span>&nbsp;<span class="ident" id="1980385">a</span><span class="op" id="1980386">.</span><span class="ident" id="1980387">nd</span>&nbsp;<span class="op" id="1980390">==</span>&nbsp;<span class="num" id="1980393">0</span><span class="op" id="1980394">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980398">return</span>&nbsp;<span class="string" id="1980405">&#34;0&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980411">case</span>&nbsp;<span class="ident" id="1980416">a</span><span class="op" id="1980417">.</span><span class="ident" id="1980418">dp</span>&nbsp;<span class="op" id="1980421">&lt;=</span>&nbsp;<span class="num" id="1980424">0</span><span class="op" id="1980425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1980429">//&nbsp;zeros&nbsp;fill&nbsp;space&nbsp;between&nbsp;decimal&nbsp;point&nbsp;and&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980484">buf</span><span class="op" id="1980487">[</span><span class="ident" id="1980488">w</span><span class="op" id="1980489">]</span>&nbsp;<span class="op" id="1980491">=</span>&nbsp;<span class="string" id="1980493">&#39;0&#39;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980499">w</span><span class="op" id="1980500">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980505">buf</span><span class="op" id="1980508">[</span><span class="ident" id="1980509">w</span><span class="op" id="1980510">]</span>&nbsp;<span class="op" id="1980512">=</span>&nbsp;<span class="string" id="1980514">&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980520">w</span><span class="op" id="1980521">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980526">w</span>&nbsp;<span class="op" id="1980528">+=</span>&nbsp;<span class="ident" id="1980531">digitZero</span><span class="op" id="1980540">(</span><span class="ident" id="1980541">buf</span><span class="op" id="1980544">[</span><span class="ident" id="1980545">w</span>&nbsp;<span class="op" id="1980547">:</span>&nbsp;<span class="ident" id="1980549">w</span><span class="op" id="1980550">+</span><span class="op" id="1980551">-</span><span class="ident" id="1980552">a</span><span class="op" id="1980553">.</span><span class="ident" id="1980554">dp</span><span class="op" id="1980556">]</span><span class="op" id="1980557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980561">w</span>&nbsp;<span class="op" id="1980563">+=</span>&nbsp;<span class="builtinfunc" id="1980566">copy</span><span class="op" id="1980570">(</span><span class="ident" id="1980571">buf</span><span class="op" id="1980574">[</span><span class="ident" id="1980575">w</span><span class="op" id="1980576">:</span><span class="op" id="1980577">]</span><span class="op" id="1980578">,</span>&nbsp;<span class="ident" id="1980580">a</span><span class="op" id="1980581">.</span><span class="ident" id="1980582">d</span><span class="op" id="1980583">[</span><span class="num" id="1980584">0</span><span class="op" id="1980585">:</span><span class="ident" id="1980586">a</span><span class="op" id="1980587">.</span><span class="ident" id="1980588">nd</span><span class="op" id="1980590">]</span><span class="op" id="1980591">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980595">case</span>&nbsp;<span class="ident" id="1980600">a</span><span class="op" id="1980601">.</span><span class="ident" id="1980602">dp</span>&nbsp;<span class="op" id="1980605">&lt;</span>&nbsp;<span class="ident" id="1980607">a</span><span class="op" id="1980608">.</span><span class="ident" id="1980609">nd</span><span class="op" id="1980611">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1980615">//&nbsp;decimal&nbsp;point&nbsp;in&nbsp;middle&nbsp;of&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980654">w</span>&nbsp;<span class="op" id="1980656">+=</span>&nbsp;<span class="builtinfunc" id="1980659">copy</span><span class="op" id="1980663">(</span><span class="ident" id="1980664">buf</span><span class="op" id="1980667">[</span><span class="ident" id="1980668">w</span><span class="op" id="1980669">:</span><span class="op" id="1980670">]</span><span class="op" id="1980671">,</span>&nbsp;<span class="ident" id="1980673">a</span><span class="op" id="1980674">.</span><span class="ident" id="1980675">d</span><span class="op" id="1980676">[</span><span class="num" id="1980677">0</span><span class="op" id="1980678">:</span><span class="ident" id="1980679">a</span><span class="op" id="1980680">.</span><span class="ident" id="1980681">dp</span><span class="op" id="1980683">]</span><span class="op" id="1980684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980688">buf</span><span class="op" id="1980691">[</span><span class="ident" id="1980692">w</span><span class="op" id="1980693">]</span>&nbsp;<span class="op" id="1980695">=</span>&nbsp;<span class="string" id="1980697">&#39;.&#39;</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980703">w</span><span class="op" id="1980704">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980709">w</span>&nbsp;<span class="op" id="1980711">+=</span>&nbsp;<span class="builtinfunc" id="1980714">copy</span><span class="op" id="1980718">(</span><span class="ident" id="1980719">buf</span><span class="op" id="1980722">[</span><span class="ident" id="1980723">w</span><span class="op" id="1980724">:</span><span class="op" id="1980725">]</span><span class="op" id="1980726">,</span>&nbsp;<span class="ident" id="1980728">a</span><span class="op" id="1980729">.</span><span class="ident" id="1980730">d</span><span class="op" id="1980731">[</span><span class="ident" id="1980732">a</span><span class="op" id="1980733">.</span><span class="ident" id="1980734">dp</span><span class="op" id="1980736">:</span><span class="ident" id="1980737">a</span><span class="op" id="1980738">.</span><span class="ident" id="1980739">nd</span><span class="op" id="1980741">]</span><span class="op" id="1980742">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980746">default</span><span class="op" id="1980753">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1980757">//&nbsp;zeros&nbsp;fill&nbsp;space&nbsp;between&nbsp;digits&nbsp;and&nbsp;decimal&nbsp;point</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980812">w</span>&nbsp;<span class="op" id="1980814">+=</span>&nbsp;<span class="builtinfunc" id="1980817">copy</span><span class="op" id="1980821">(</span><span class="ident" id="1980822">buf</span><span class="op" id="1980825">[</span><span class="ident" id="1980826">w</span><span class="op" id="1980827">:</span><span class="op" id="1980828">]</span><span class="op" id="1980829">,</span>&nbsp;<span class="ident" id="1980831">a</span><span class="op" id="1980832">.</span><span class="ident" id="1980833">d</span><span class="op" id="1980834">[</span><span class="num" id="1980835">0</span><span class="op" id="1980836">:</span><span class="ident" id="1980837">a</span><span class="op" id="1980838">.</span><span class="ident" id="1980839">nd</span><span class="op" id="1980841">]</span><span class="op" id="1980842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980846">w</span>&nbsp;<span class="op" id="1980848">+=</span>&nbsp;<span class="ident" id="1980851">digitZero</span><span class="op" id="1980860">(</span><span class="ident" id="1980861">buf</span><span class="op" id="1980864">[</span><span class="ident" id="1980865">w</span>&nbsp;<span class="op" id="1980867">:</span>&nbsp;<span class="ident" id="1980869">w</span><span class="op" id="1980870">+</span><span class="ident" id="1980871">a</span><span class="op" id="1980872">.</span><span class="ident" id="1980873">dp</span><span class="op" id="1980875">-</span><span class="ident" id="1980876">a</span><span class="op" id="1980877">.</span><span class="ident" id="1980878">nd</span><span class="op" id="1980880">]</span><span class="op" id="1980881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1980884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980887">return</span>&nbsp;<span class="builtintype" id="1980894">string</span><span class="op" id="1980900">(</span><span class="ident" id="1980901">buf</span><span class="op" id="1980904">[</span><span class="num" id="1980905">0</span><span class="op" id="1980906">:</span><span class="ident" id="1980907">w</span><span class="op" id="1980908">]</span><span class="op" id="1980909">)</span><br>
<span class="lineno"></span><span class="op" id="1980911">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="1980914">func</span>&nbsp;<span class="ident" id="1980919">digitZero</span><span class="op" id="1980928">(</span><span class="ident" id="1980929">dst</span>&nbsp;<span class="op" id="1980933">[</span><span class="op" id="1980934">]</span><span class="builtintype" id="1980935">byte</span><span class="op" id="1980939">)</span>&nbsp;<span class="builtintype" id="1980941">int</span>&nbsp;<span class="op" id="1980945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980948">for</span>&nbsp;<span class="ident" id="1980952">i</span>&nbsp;<span class="op" id="1980954">:=</span>&nbsp;<span class="keyword" id="1980957">range</span>&nbsp;<span class="ident" id="1980963">dst</span>&nbsp;<span class="op" id="1980967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980971">dst</span><span class="op" id="1980974">[</span><span class="ident" id="1980975">i</span><span class="op" id="1980976">]</span>&nbsp;<span class="op" id="1980978">=</span>&nbsp;<span class="string" id="1980980">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1980985">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980988">return</span>&nbsp;<span class="builtinfunc" id="1980995">len</span><span class="op" id="1980998">(</span><span class="ident" id="1980999">dst</span><span class="op" id="1981002">)</span><br>
<span class="lineno"></span><span class="op" id="1981004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1981007">//&nbsp;trim&nbsp;trailing&nbsp;zeros&nbsp;from&nbsp;number.</span><br>
<span class="lineno"></span><span class="comment" id="1981043">//&nbsp;(They&nbsp;are&nbsp;meaningless;&nbsp;the&nbsp;decimal&nbsp;point&nbsp;is&nbsp;tracked</span><br>
<span class="lineno">70</span><span class="comment" id="1981098">//&nbsp;independent&nbsp;of&nbsp;the&nbsp;number&nbsp;of&nbsp;digits.)</span><br>
<span class="lineno"></span><span class="keyword" id="1981139">func</span>&nbsp;<span class="ident" id="1981144">trim</span><span class="op" id="1981148">(</span><span class="ident" id="1981149">a</span>&nbsp;<span class="op" id="1981151">*</span><span class="ident" id="1981152">decimal</span><span class="op" id="1981159">)</span>&nbsp;<span class="op" id="1981161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981164">for</span>&nbsp;<span class="ident" id="1981168">a</span><span class="op" id="1981169">.</span><span class="ident" id="1981170">nd</span>&nbsp;<span class="op" id="1981173">&gt;</span>&nbsp;<span class="num" id="1981175">0</span>&nbsp;<span class="op" id="1981177">&amp;&amp;</span>&nbsp;<span class="ident" id="1981180">a</span><span class="op" id="1981181">.</span><span class="ident" id="1981182">d</span><span class="op" id="1981183">[</span><span class="ident" id="1981184">a</span><span class="op" id="1981185">.</span><span class="ident" id="1981186">nd</span><span class="op" id="1981188">-</span><span class="num" id="1981189">1</span><span class="op" id="1981190">]</span>&nbsp;<span class="op" id="1981192">==</span>&nbsp;<span class="string" id="1981195">&#39;0&#39;</span>&nbsp;<span class="op" id="1981199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981203">a</span><span class="op" id="1981204">.</span><span class="ident" id="1981205">nd</span><span class="op" id="1981207">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981211">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981214">if</span>&nbsp;<span class="ident" id="1981217">a</span><span class="op" id="1981218">.</span><span class="ident" id="1981219">nd</span>&nbsp;<span class="op" id="1981222">==</span>&nbsp;<span class="num" id="1981225">0</span>&nbsp;<span class="op" id="1981227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981231">a</span><span class="op" id="1981232">.</span><span class="ident" id="1981233">dp</span>&nbsp;<span class="op" id="1981236">=</span>&nbsp;<span class="num" id="1981238">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981241">}</span><br>
<span class="lineno"></span><span class="op" id="1981243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1981246">//&nbsp;Assign&nbsp;v&nbsp;to&nbsp;a.</span><br>
<span class="lineno"></span><span class="keyword" id="1981264">func</span>&nbsp;<span class="op" id="1981269">(</span><span class="ident" id="1981270">a</span>&nbsp;<span class="op" id="1981272">*</span><span class="ident" id="1981273">decimal</span><span class="op" id="1981280">)</span>&nbsp;<span class="ident" id="1981282">Assign</span><span class="op" id="1981288">(</span><span class="ident" id="1981289">v</span>&nbsp;<span class="ident" id="1981291">uint64</span><span class="op" id="1981297">)</span>&nbsp;<span class="op" id="1981299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981302">var</span>&nbsp;<span class="ident" id="1981306">buf</span>&nbsp;<span class="op" id="1981310">[</span><span class="num" id="1981311">24</span><span class="op" id="1981313">]</span><span class="builtintype" id="1981314">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1981321">//&nbsp;Write&nbsp;reversed&nbsp;decimal&nbsp;in&nbsp;buf.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981356">n</span>&nbsp;<span class="op" id="1981358">:=</span>&nbsp;<span class="num" id="1981361">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981364">for</span>&nbsp;<span class="ident" id="1981368">v</span>&nbsp;<span class="op" id="1981370">&gt;</span>&nbsp;<span class="num" id="1981372">0</span>&nbsp;<span class="op" id="1981374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981378">v1</span>&nbsp;<span class="op" id="1981381">:=</span>&nbsp;<span class="ident" id="1981384">v</span>&nbsp;<span class="op" id="1981386">/</span>&nbsp;<span class="num" id="1981388">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981393">v</span>&nbsp;<span class="op" id="1981395">-=</span>&nbsp;<span class="num" id="1981398">10</span>&nbsp;<span class="op" id="1981401">*</span>&nbsp;<span class="ident" id="1981403">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981408">buf</span><span class="op" id="1981411">[</span><span class="ident" id="1981412">n</span><span class="op" id="1981413">]</span>&nbsp;<span class="op" id="1981415">=</span>&nbsp;<span class="builtintype" id="1981417">byte</span><span class="op" id="1981421">(</span><span class="ident" id="1981422">v</span>&nbsp;<span class="op" id="1981424">+</span>&nbsp;<span class="string" id="1981426">&#39;0&#39;</span><span class="op" id="1981429">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981433">n</span><span class="op" id="1981434">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981439">v</span>&nbsp;<span class="op" id="1981441">=</span>&nbsp;<span class="ident" id="1981443">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1981451">//&nbsp;Reverse&nbsp;again&nbsp;to&nbsp;produce&nbsp;forward&nbsp;decimal&nbsp;in&nbsp;a.d.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981504">a</span><span class="op" id="1981505">.</span><span class="ident" id="1981506">nd</span>&nbsp;<span class="op" id="1981509">=</span>&nbsp;<span class="num" id="1981511">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981514">for</span>&nbsp;<span class="ident" id="1981518">n</span><span class="op" id="1981519">--</span><span class="op" id="1981521">;</span>&nbsp;<span class="ident" id="1981523">n</span>&nbsp;<span class="op" id="1981525">&gt;=</span>&nbsp;<span class="num" id="1981528">0</span><span class="op" id="1981529">;</span>&nbsp;<span class="ident" id="1981531">n</span><span class="op" id="1981532">--</span>&nbsp;<span class="op" id="1981535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981539">a</span><span class="op" id="1981540">.</span><span class="ident" id="1981541">d</span><span class="op" id="1981542">[</span><span class="ident" id="1981543">a</span><span class="op" id="1981544">.</span><span class="ident" id="1981545">nd</span><span class="op" id="1981547">]</span>&nbsp;<span class="op" id="1981549">=</span>&nbsp;<span class="ident" id="1981551">buf</span><span class="op" id="1981554">[</span><span class="ident" id="1981555">n</span><span class="op" id="1981556">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981560">a</span><span class="op" id="1981561">.</span><span class="ident" id="1981562">nd</span><span class="op" id="1981564">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981568">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981571">a</span><span class="op" id="1981572">.</span><span class="ident" id="1981573">dp</span>&nbsp;<span class="op" id="1981576">=</span>&nbsp;<span class="ident" id="1981578">a</span><span class="op" id="1981579">.</span><span class="ident" id="1981580">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981584">trim</span><span class="op" id="1981588">(</span><span class="ident" id="1981589">a</span><span class="op" id="1981590">)</span><br>
<span class="lineno"></span><span class="op" id="1981592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1981595">//&nbsp;Maximum&nbsp;shift&nbsp;that&nbsp;we&nbsp;can&nbsp;do&nbsp;in&nbsp;one&nbsp;pass&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno">105</span><span class="comment" id="1981657">//&nbsp;Signed&nbsp;int&nbsp;has&nbsp;31&nbsp;bits,&nbsp;and&nbsp;we&nbsp;have&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;accommodate&nbsp;9&lt;&lt;k.</span><br>
<span class="lineno"></span><span class="keyword" id="1981728">const</span>&nbsp;<span class="ident" id="1981734">maxShift</span>&nbsp;<span class="op" id="1981743">=</span>&nbsp;<span class="num" id="1981745">27</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1981749">//&nbsp;Binary&nbsp;shift&nbsp;right&nbsp;(*&nbsp;2)&nbsp;by&nbsp;k&nbsp;bits.&nbsp;&nbsp;k&nbsp;&lt;=&nbsp;maxShift&nbsp;to&nbsp;avoid&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="keyword" id="1981822">func</span>&nbsp;<span class="ident" id="1981827">rightShift</span><span class="op" id="1981837">(</span><span class="ident" id="1981838">a</span>&nbsp;<span class="op" id="1981840">*</span><span class="ident" id="1981841">decimal</span><span class="op" id="1981848">,</span>&nbsp;<span class="ident" id="1981850">k</span>&nbsp;<span class="builtintype" id="1981852">uint</span><span class="op" id="1981856">)</span>&nbsp;<span class="op" id="1981858">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981861">r</span>&nbsp;<span class="op" id="1981863">:=</span>&nbsp;<span class="num" id="1981866">0</span>&nbsp;<span class="comment" id="1981868">//&nbsp;read&nbsp;pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981885">w</span>&nbsp;<span class="op" id="1981887">:=</span>&nbsp;<span class="num" id="1981890">0</span>&nbsp;<span class="comment" id="1981892">//&nbsp;write&nbsp;pointer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1981911">//&nbsp;Pick&nbsp;up&nbsp;enough&nbsp;leading&nbsp;digits&nbsp;to&nbsp;cover&nbsp;first&nbsp;shift.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981967">n</span>&nbsp;<span class="op" id="1981969">:=</span>&nbsp;<span class="num" id="1981972">0</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981975">for</span>&nbsp;<span class="op" id="1981979">;</span>&nbsp;<span class="ident" id="1981981">n</span><span class="op" id="1981982">&gt;&gt;</span><span class="ident" id="1981984">k</span>&nbsp;<span class="op" id="1981986">==</span>&nbsp;<span class="num" id="1981989">0</span><span class="op" id="1981990">;</span>&nbsp;<span class="ident" id="1981992">r</span><span class="op" id="1981993">++</span>&nbsp;<span class="op" id="1981996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982000">if</span>&nbsp;<span class="ident" id="1982003">r</span>&nbsp;<span class="op" id="1982005">&gt;=</span>&nbsp;<span class="ident" id="1982008">a</span><span class="op" id="1982009">.</span><span class="ident" id="1982010">nd</span>&nbsp;<span class="op" id="1982013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982018">if</span>&nbsp;<span class="ident" id="1982021">n</span>&nbsp;<span class="op" id="1982023">==</span>&nbsp;<span class="num" id="1982026">0</span>&nbsp;<span class="op" id="1982028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1982034">//&nbsp;a&nbsp;==&nbsp;0;&nbsp;shouldn&#39;t&nbsp;get&nbsp;here,&nbsp;but&nbsp;handle&nbsp;anyway.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982088">a</span><span class="op" id="1982089">.</span><span class="ident" id="1982090">nd</span>&nbsp;<span class="op" id="1982093">=</span>&nbsp;<span class="num" id="1982095">0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982101">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982116">for</span>&nbsp;<span class="ident" id="1982120">n</span><span class="op" id="1982121">&gt;&gt;</span><span class="ident" id="1982123">k</span>&nbsp;<span class="op" id="1982125">==</span>&nbsp;<span class="num" id="1982128">0</span>&nbsp;<span class="op" id="1982130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982136">n</span>&nbsp;<span class="op" id="1982138">=</span>&nbsp;<span class="ident" id="1982140">n</span>&nbsp;<span class="op" id="1982142">*</span>&nbsp;<span class="num" id="1982144">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982151">r</span><span class="op" id="1982152">++</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982163">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982175">c</span>&nbsp;<span class="op" id="1982177">:=</span>&nbsp;<span class="builtintype" id="1982180">int</span><span class="op" id="1982183">(</span><span class="ident" id="1982184">a</span><span class="op" id="1982185">.</span><span class="ident" id="1982186">d</span><span class="op" id="1982187">[</span><span class="ident" id="1982188">r</span><span class="op" id="1982189">]</span><span class="op" id="1982190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982194">n</span>&nbsp;<span class="op" id="1982196">=</span>&nbsp;<span class="ident" id="1982198">n</span><span class="op" id="1982199">*</span><span class="num" id="1982200">10</span>&nbsp;<span class="op" id="1982203">+</span>&nbsp;<span class="ident" id="1982205">c</span>&nbsp;<span class="op" id="1982207">-</span>&nbsp;<span class="string" id="1982209">&#39;0&#39;</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982217">a</span><span class="op" id="1982218">.</span><span class="ident" id="1982219">dp</span>&nbsp;<span class="op" id="1982222">-=</span>&nbsp;<span class="ident" id="1982225">r</span>&nbsp;<span class="op" id="1982227">-</span>&nbsp;<span class="num" id="1982229">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1982233">//&nbsp;Pick&nbsp;up&nbsp;a&nbsp;digit,&nbsp;put&nbsp;down&nbsp;a&nbsp;digit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982272">for</span>&nbsp;<span class="op" id="1982276">;</span>&nbsp;<span class="ident" id="1982278">r</span>&nbsp;<span class="op" id="1982280">&lt;</span>&nbsp;<span class="ident" id="1982282">a</span><span class="op" id="1982283">.</span><span class="ident" id="1982284">nd</span><span class="op" id="1982286">;</span>&nbsp;<span class="ident" id="1982288">r</span><span class="op" id="1982289">++</span>&nbsp;<span class="op" id="1982292">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982296">c</span>&nbsp;<span class="op" id="1982298">:=</span>&nbsp;<span class="builtintype" id="1982301">int</span><span class="op" id="1982304">(</span><span class="ident" id="1982305">a</span><span class="op" id="1982306">.</span><span class="ident" id="1982307">d</span><span class="op" id="1982308">[</span><span class="ident" id="1982309">r</span><span class="op" id="1982310">]</span><span class="op" id="1982311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982315">dig</span>&nbsp;<span class="op" id="1982319">:=</span>&nbsp;<span class="ident" id="1982322">n</span>&nbsp;<span class="op" id="1982324">&gt;&gt;</span>&nbsp;<span class="ident" id="1982327">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982331">n</span>&nbsp;<span class="op" id="1982333">-=</span>&nbsp;<span class="ident" id="1982336">dig</span>&nbsp;<span class="op" id="1982340">&lt;&lt;</span>&nbsp;<span class="ident" id="1982343">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982347">a</span><span class="op" id="1982348">.</span><span class="ident" id="1982349">d</span><span class="op" id="1982350">[</span><span class="ident" id="1982351">w</span><span class="op" id="1982352">]</span>&nbsp;<span class="op" id="1982354">=</span>&nbsp;<span class="builtintype" id="1982356">byte</span><span class="op" id="1982360">(</span><span class="ident" id="1982361">dig</span>&nbsp;<span class="op" id="1982365">+</span>&nbsp;<span class="string" id="1982367">&#39;0&#39;</span><span class="op" id="1982370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982374">w</span><span class="op" id="1982375">++</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982380">n</span>&nbsp;<span class="op" id="1982382">=</span>&nbsp;<span class="ident" id="1982384">n</span><span class="op" id="1982385">*</span><span class="num" id="1982386">10</span>&nbsp;<span class="op" id="1982389">+</span>&nbsp;<span class="ident" id="1982391">c</span>&nbsp;<span class="op" id="1982393">-</span>&nbsp;<span class="string" id="1982395">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1982404">//&nbsp;Put&nbsp;down&nbsp;extra&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982431">for</span>&nbsp;<span class="ident" id="1982435">n</span>&nbsp;<span class="op" id="1982437">&gt;</span>&nbsp;<span class="num" id="1982439">0</span>&nbsp;<span class="op" id="1982441">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982445">dig</span>&nbsp;<span class="op" id="1982449">:=</span>&nbsp;<span class="ident" id="1982452">n</span>&nbsp;<span class="op" id="1982454">&gt;&gt;</span>&nbsp;<span class="ident" id="1982457">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982461">n</span>&nbsp;<span class="op" id="1982463">-=</span>&nbsp;<span class="ident" id="1982466">dig</span>&nbsp;<span class="op" id="1982470">&lt;&lt;</span>&nbsp;<span class="ident" id="1982473">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982477">if</span>&nbsp;<span class="ident" id="1982480">w</span>&nbsp;<span class="op" id="1982482">&lt;</span>&nbsp;<span class="builtinfunc" id="1982484">len</span><span class="op" id="1982487">(</span><span class="ident" id="1982488">a</span><span class="op" id="1982489">.</span><span class="ident" id="1982490">d</span><span class="op" id="1982491">)</span>&nbsp;<span class="op" id="1982493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982498">a</span><span class="op" id="1982499">.</span><span class="ident" id="1982500">d</span><span class="op" id="1982501">[</span><span class="ident" id="1982502">w</span><span class="op" id="1982503">]</span>&nbsp;<span class="op" id="1982505">=</span>&nbsp;<span class="builtintype" id="1982507">byte</span><span class="op" id="1982511">(</span><span class="ident" id="1982512">dig</span>&nbsp;<span class="op" id="1982516">+</span>&nbsp;<span class="string" id="1982518">&#39;0&#39;</span><span class="op" id="1982521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982526">w</span><span class="op" id="1982527">++</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982532">}</span>&nbsp;<span class="keyword" id="1982534">else</span>&nbsp;<span class="keyword" id="1982539">if</span>&nbsp;<span class="ident" id="1982542">dig</span>&nbsp;<span class="op" id="1982546">&gt;</span>&nbsp;<span class="num" id="1982548">0</span>&nbsp;<span class="op" id="1982550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982555">a</span><span class="op" id="1982556">.</span><span class="ident" id="1982557">trunc</span>&nbsp;<span class="op" id="1982563">=</span>&nbsp;<span class="builtintype" id="1982565">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982576">n</span>&nbsp;<span class="op" id="1982578">=</span>&nbsp;<span class="ident" id="1982580">n</span>&nbsp;<span class="op" id="1982582">*</span>&nbsp;<span class="num" id="1982584">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982588">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982592">a</span><span class="op" id="1982593">.</span><span class="ident" id="1982594">nd</span>&nbsp;<span class="op" id="1982597">=</span>&nbsp;<span class="ident" id="1982599">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982602">trim</span><span class="op" id="1982606">(</span><span class="ident" id="1982607">a</span><span class="op" id="1982608">)</span><br>
<span class="lineno"></span><span class="op" id="1982610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="1982613">//&nbsp;Cheat&nbsp;sheet&nbsp;for&nbsp;left&nbsp;shift:&nbsp;table&nbsp;indexed&nbsp;by&nbsp;shift&nbsp;count&nbsp;giving</span><br>
<span class="lineno"></span><span class="comment" id="1982680">//&nbsp;number&nbsp;of&nbsp;new&nbsp;digits&nbsp;that&nbsp;will&nbsp;be&nbsp;introduced&nbsp;by&nbsp;that&nbsp;shift.</span><br>
<span class="lineno"></span><span class="comment" id="1982743">//</span><br>
<span class="lineno"></span><span class="comment" id="1982746">//&nbsp;For&nbsp;example,&nbsp;leftcheats[4]&nbsp;=&nbsp;{2,&nbsp;&#34;625&#34;}.&nbsp;&nbsp;That&nbsp;means&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1982807">//&nbsp;if&nbsp;we&nbsp;are&nbsp;shifting&nbsp;by&nbsp;4&nbsp;(multiplying&nbsp;by&nbsp;16),&nbsp;it&nbsp;will&nbsp;add&nbsp;2&nbsp;digits</span><br>
<span class="lineno">165</span><span class="comment" id="1982876">//&nbsp;when&nbsp;the&nbsp;string&nbsp;prefix&nbsp;is&nbsp;&#34;625&#34;&nbsp;through&nbsp;&#34;999&#34;,&nbsp;and&nbsp;one&nbsp;fewer&nbsp;digit</span><br>
<span class="lineno"></span><span class="comment" id="1982946">//&nbsp;if&nbsp;the&nbsp;string&nbsp;prefix&nbsp;is&nbsp;&#34;000&#34;&nbsp;through&nbsp;&#34;624&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="1982994">//</span><br>
<span class="lineno"></span><span class="comment" id="1982997">//&nbsp;Credit&nbsp;for&nbsp;this&nbsp;trick&nbsp;goes&nbsp;to&nbsp;Ken.</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="1983036">type</span>&nbsp;<span class="ident" id="1983041">leftCheat</span>&nbsp;<span class="keyword" id="1983051">struct</span>&nbsp;<span class="op" id="1983058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983061">delta</span>&nbsp;&nbsp;<span class="builtintype" id="1983068">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983075">//&nbsp;number&nbsp;of&nbsp;new&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983100">cutoff</span>&nbsp;<span class="builtintype" id="1983107">string</span>&nbsp;<span class="comment" id="1983114">//&nbsp;&nbsp;&nbsp;minus&nbsp;one&nbsp;digit&nbsp;if&nbsp;original&nbsp;&lt;&nbsp;a.</span><br>
<span class="lineno"></span><span class="op" id="1983152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="1983155">var</span>&nbsp;<span class="ident" id="1983159">leftcheats</span>&nbsp;<span class="op" id="1983170">=</span>&nbsp;<span class="op" id="1983172">[</span><span class="op" id="1983173">]</span><span class="ident" id="1983174">leftCheat</span><span class="op" id="1983183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1983186">//&nbsp;Leading&nbsp;digits&nbsp;of&nbsp;1/2^i&nbsp;=&nbsp;5^i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1983221">//&nbsp;5^23&nbsp;is&nbsp;not&nbsp;an&nbsp;exact&nbsp;64-bit&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1983276">//&nbsp;so&nbsp;have&nbsp;to&nbsp;use&nbsp;bc&nbsp;for&nbsp;the&nbsp;math.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1983312">/*<br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspseq&nbsp;27&nbsp;|&nbsp;sed&nbsp;&#39;s/^/5^/&#39;&nbsp;|&nbsp;bc&nbsp;|<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspawk&nbsp;&#39;BEGIN{&nbsp;print&nbsp;&#34;\tleftCheat{&nbsp;0,&nbsp;\&#34;\&#34;&nbsp;},&#34;&nbsp;}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsplog2&nbsp;=&nbsp;log(2)/log(10)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintf(&#34;\tleftCheat{&nbsp;%d,&nbsp;\&#34;%s\&#34;&nbsp;},\t//&nbsp;*&nbsp;%d\n&#34;,<br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspint(log2*NR+1),&nbsp;$0,&nbsp;2**NR)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp}&#39;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983516">{</span><span class="num" id="1983517">0</span><span class="op" id="1983518">,</span>&nbsp;<span class="string" id="1983520">&#34;&#34;</span><span class="op" id="1983522">}</span><span class="op" id="1983523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983526">{</span><span class="num" id="1983527">1</span><span class="op" id="1983528">,</span>&nbsp;<span class="string" id="1983530">&#34;5&#34;</span><span class="op" id="1983533">}</span><span class="op" id="1983534">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983554">//&nbsp;*&nbsp;2</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983562">{</span><span class="num" id="1983563">1</span><span class="op" id="1983564">,</span>&nbsp;<span class="string" id="1983566">&#34;25&#34;</span><span class="op" id="1983570">}</span><span class="op" id="1983571">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983590">//&nbsp;*&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983598">{</span><span class="num" id="1983599">1</span><span class="op" id="1983600">,</span>&nbsp;<span class="string" id="1983602">&#34;125&#34;</span><span class="op" id="1983607">}</span><span class="op" id="1983608">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983626">//&nbsp;*&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983634">{</span><span class="num" id="1983635">2</span><span class="op" id="1983636">,</span>&nbsp;<span class="string" id="1983638">&#34;625&#34;</span><span class="op" id="1983643">}</span><span class="op" id="1983644">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983662">//&nbsp;*&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983671">{</span><span class="num" id="1983672">2</span><span class="op" id="1983673">,</span>&nbsp;<span class="string" id="1983675">&#34;3125&#34;</span><span class="op" id="1983681">}</span><span class="op" id="1983682">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983699">//&nbsp;*&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983708">{</span><span class="num" id="1983709">2</span><span class="op" id="1983710">,</span>&nbsp;<span class="string" id="1983712">&#34;15625&#34;</span><span class="op" id="1983719">}</span><span class="op" id="1983720">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983736">//&nbsp;*&nbsp;64</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983745">{</span><span class="num" id="1983746">3</span><span class="op" id="1983747">,</span>&nbsp;<span class="string" id="1983749">&#34;78125&#34;</span><span class="op" id="1983756">}</span><span class="op" id="1983757">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983773">//&nbsp;*&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983783">{</span><span class="num" id="1983784">3</span><span class="op" id="1983785">,</span>&nbsp;<span class="string" id="1983787">&#34;390625&#34;</span><span class="op" id="1983795">}</span><span class="op" id="1983796">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983811">//&nbsp;*&nbsp;256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983821">{</span><span class="num" id="1983822">3</span><span class="op" id="1983823">,</span>&nbsp;<span class="string" id="1983825">&#34;1953125&#34;</span><span class="op" id="1983834">}</span><span class="op" id="1983835">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983849">//&nbsp;*&nbsp;512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983859">{</span><span class="num" id="1983860">4</span><span class="op" id="1983861">,</span>&nbsp;<span class="string" id="1983863">&#34;9765625&#34;</span><span class="op" id="1983872">}</span><span class="op" id="1983873">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983887">//&nbsp;*&nbsp;1024</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983898">{</span><span class="num" id="1983899">4</span><span class="op" id="1983900">,</span>&nbsp;<span class="string" id="1983902">&#34;48828125&#34;</span><span class="op" id="1983912">}</span><span class="op" id="1983913">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983926">//&nbsp;*&nbsp;2048</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983937">{</span><span class="num" id="1983938">4</span><span class="op" id="1983939">,</span>&nbsp;<span class="string" id="1983941">&#34;244140625&#34;</span><span class="op" id="1983952">}</span><span class="op" id="1983953">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1983965">//&nbsp;*&nbsp;4096</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983976">{</span><span class="num" id="1983977">4</span><span class="op" id="1983978">,</span>&nbsp;<span class="string" id="1983980">&#34;1220703125&#34;</span><span class="op" id="1983992">}</span><span class="op" id="1983993">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1984004">//&nbsp;*&nbsp;8192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984015">{</span><span class="num" id="1984016">5</span><span class="op" id="1984017">,</span>&nbsp;<span class="string" id="1984019">&#34;6103515625&#34;</span><span class="op" id="1984031">}</span><span class="op" id="1984032">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1984043">//&nbsp;*&nbsp;16384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984055">{</span><span class="num" id="1984056">5</span><span class="op" id="1984057">,</span>&nbsp;<span class="string" id="1984059">&#34;30517578125&#34;</span><span class="op" id="1984072">}</span><span class="op" id="1984073">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1984083">//&nbsp;*&nbsp;32768</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984095">{</span><span class="num" id="1984096">5</span><span class="op" id="1984097">,</span>&nbsp;<span class="string" id="1984099">&#34;152587890625&#34;</span><span class="op" id="1984113">}</span><span class="op" id="1984114">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1984123">//&nbsp;*&nbsp;65536</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984135">{</span><span class="num" id="1984136">6</span><span class="op" id="1984137">,</span>&nbsp;<span class="string" id="1984139">&#34;762939453125&#34;</span><span class="op" id="1984153">}</span><span class="op" id="1984154">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1984163">//&nbsp;*&nbsp;131072</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984176">{</span><span class="num" id="1984177">6</span><span class="op" id="1984178">,</span>&nbsp;<span class="string" id="1984180">&#34;3814697265625&#34;</span><span class="op" id="1984195">}</span><span class="op" id="1984196">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1984204">//&nbsp;*&nbsp;262144</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984217">{</span><span class="num" id="1984218">6</span><span class="op" id="1984219">,</span>&nbsp;<span class="string" id="1984221">&#34;19073486328125&#34;</span><span class="op" id="1984237">}</span><span class="op" id="1984238">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1984245">//&nbsp;*&nbsp;524288</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984258">{</span><span class="num" id="1984259">7</span><span class="op" id="1984260">,</span>&nbsp;<span class="string" id="1984262">&#34;95367431640625&#34;</span><span class="op" id="1984278">}</span><span class="op" id="1984279">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1984286">//&nbsp;*&nbsp;1048576</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984300">{</span><span class="num" id="1984301">7</span><span class="op" id="1984302">,</span>&nbsp;<span class="string" id="1984304">&#34;476837158203125&#34;</span><span class="op" id="1984321">}</span><span class="op" id="1984322">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1984328">//&nbsp;*&nbsp;2097152</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984342">{</span><span class="num" id="1984343">7</span><span class="op" id="1984344">,</span>&nbsp;<span class="string" id="1984346">&#34;2384185791015625&#34;</span><span class="op" id="1984364">}</span><span class="op" id="1984365">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1984370">//&nbsp;*&nbsp;4194304</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984384">{</span><span class="num" id="1984385">7</span><span class="op" id="1984386">,</span>&nbsp;<span class="string" id="1984388">&#34;11920928955078125&#34;</span><span class="op" id="1984407">}</span><span class="op" id="1984408">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1984412">//&nbsp;*&nbsp;8388608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984426">{</span><span class="num" id="1984427">8</span><span class="op" id="1984428">,</span>&nbsp;<span class="string" id="1984430">&#34;59604644775390625&#34;</span><span class="op" id="1984449">}</span><span class="op" id="1984450">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1984454">//&nbsp;*&nbsp;16777216</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984469">{</span><span class="num" id="1984470">8</span><span class="op" id="1984471">,</span>&nbsp;<span class="string" id="1984473">&#34;298023223876953125&#34;</span><span class="op" id="1984493">}</span><span class="op" id="1984494">,</span>&nbsp;&nbsp;<span class="comment" id="1984497">//&nbsp;*&nbsp;33554432</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984512">{</span><span class="num" id="1984513">8</span><span class="op" id="1984514">,</span>&nbsp;<span class="string" id="1984516">&#34;1490116119384765625&#34;</span><span class="op" id="1984537">}</span><span class="op" id="1984538">,</span>&nbsp;<span class="comment" id="1984540">//&nbsp;*&nbsp;67108864</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984555">{</span><span class="num" id="1984556">9</span><span class="op" id="1984557">,</span>&nbsp;<span class="string" id="1984559">&#34;7450580596923828125&#34;</span><span class="op" id="1984580">}</span><span class="op" id="1984581">,</span>&nbsp;<span class="comment" id="1984583">//&nbsp;*&nbsp;134217728</span><br>
<span class="lineno"></span><span class="op" id="1984598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1984601">//&nbsp;Is&nbsp;the&nbsp;leading&nbsp;prefix&nbsp;of&nbsp;b&nbsp;lexicographically&nbsp;less&nbsp;than&nbsp;s?</span><br>
<span class="lineno"></span><span class="keyword" id="1984662">func</span>&nbsp;<span class="ident" id="1984667">prefixIsLessThan</span><span class="op" id="1984683">(</span><span class="ident" id="1984684">b</span>&nbsp;<span class="op" id="1984686">[</span><span class="op" id="1984687">]</span><span class="builtintype" id="1984688">byte</span><span class="op" id="1984692">,</span>&nbsp;<span class="ident" id="1984694">s</span>&nbsp;<span class="builtintype" id="1984696">string</span><span class="op" id="1984702">)</span>&nbsp;<span class="builtintype" id="1984704">bool</span>&nbsp;<span class="op" id="1984709">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984712">for</span>&nbsp;<span class="ident" id="1984716">i</span>&nbsp;<span class="op" id="1984718">:=</span>&nbsp;<span class="num" id="1984721">0</span><span class="op" id="1984722">;</span>&nbsp;<span class="ident" id="1984724">i</span>&nbsp;<span class="op" id="1984726">&lt;</span>&nbsp;<span class="builtinfunc" id="1984728">len</span><span class="op" id="1984731">(</span><span class="ident" id="1984732">s</span><span class="op" id="1984733">)</span><span class="op" id="1984734">;</span>&nbsp;<span class="ident" id="1984736">i</span><span class="op" id="1984737">++</span>&nbsp;<span class="op" id="1984740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984744">if</span>&nbsp;<span class="ident" id="1984747">i</span>&nbsp;<span class="op" id="1984749">&gt;=</span>&nbsp;<span class="builtinfunc" id="1984752">len</span><span class="op" id="1984755">(</span><span class="ident" id="1984756">b</span><span class="op" id="1984757">)</span>&nbsp;<span class="op" id="1984759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984764">return</span>&nbsp;<span class="builtintype" id="1984771">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984782">if</span>&nbsp;<span class="ident" id="1984785">b</span><span class="op" id="1984786">[</span><span class="ident" id="1984787">i</span><span class="op" id="1984788">]</span>&nbsp;<span class="op" id="1984790">!=</span>&nbsp;<span class="ident" id="1984793">s</span><span class="op" id="1984794">[</span><span class="ident" id="1984795">i</span><span class="op" id="1984796">]</span>&nbsp;<span class="op" id="1984798">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984803">return</span>&nbsp;<span class="ident" id="1984810">b</span><span class="op" id="1984811">[</span><span class="ident" id="1984812">i</span><span class="op" id="1984813">]</span>&nbsp;<span class="op" id="1984815">&lt;</span>&nbsp;<span class="ident" id="1984817">s</span><span class="op" id="1984818">[</span><span class="ident" id="1984819">i</span><span class="op" id="1984820">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984830">return</span>&nbsp;<span class="builtintype" id="1984837">false</span><br>
<span class="lineno"></span><span class="op" id="1984843">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="1984846">//&nbsp;Binary&nbsp;shift&nbsp;left&nbsp;(/&nbsp;2)&nbsp;by&nbsp;k&nbsp;bits.&nbsp;&nbsp;k&nbsp;&lt;=&nbsp;maxShift&nbsp;to&nbsp;avoid&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="keyword" id="1984918">func</span>&nbsp;<span class="ident" id="1984923">leftShift</span><span class="op" id="1984932">(</span><span class="ident" id="1984933">a</span>&nbsp;<span class="op" id="1984935">*</span><span class="ident" id="1984936">decimal</span><span class="op" id="1984943">,</span>&nbsp;<span class="ident" id="1984945">k</span>&nbsp;<span class="builtintype" id="1984947">uint</span><span class="op" id="1984951">)</span>&nbsp;<span class="op" id="1984953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984956">delta</span>&nbsp;<span class="op" id="1984962">:=</span>&nbsp;<span class="ident" id="1984965">leftcheats</span><span class="op" id="1984975">[</span><span class="ident" id="1984976">k</span><span class="op" id="1984977">]</span><span class="op" id="1984978">.</span><span class="ident" id="1984979">delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984986">if</span>&nbsp;<span class="ident" id="1984989">prefixIsLessThan</span><span class="op" id="1985005">(</span><span class="ident" id="1985006">a</span><span class="op" id="1985007">.</span><span class="ident" id="1985008">d</span><span class="op" id="1985009">[</span><span class="num" id="1985010">0</span><span class="op" id="1985011">:</span><span class="ident" id="1985012">a</span><span class="op" id="1985013">.</span><span class="ident" id="1985014">nd</span><span class="op" id="1985016">]</span><span class="op" id="1985017">,</span>&nbsp;<span class="ident" id="1985019">leftcheats</span><span class="op" id="1985029">[</span><span class="ident" id="1985030">k</span><span class="op" id="1985031">]</span><span class="op" id="1985032">.</span><span class="ident" id="1985033">cutoff</span><span class="op" id="1985039">)</span>&nbsp;<span class="op" id="1985041">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985045">delta</span><span class="op" id="1985050">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985058">r</span>&nbsp;<span class="op" id="1985060">:=</span>&nbsp;<span class="ident" id="1985063">a</span><span class="op" id="1985064">.</span><span class="ident" id="1985065">nd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1985076">//&nbsp;read&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985091">w</span>&nbsp;<span class="op" id="1985093">:=</span>&nbsp;<span class="ident" id="1985096">a</span><span class="op" id="1985097">.</span><span class="ident" id="1985098">nd</span>&nbsp;<span class="op" id="1985101">+</span>&nbsp;<span class="ident" id="1985103">delta</span>&nbsp;<span class="comment" id="1985109">//&nbsp;write&nbsp;index</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985125">n</span>&nbsp;<span class="op" id="1985127">:=</span>&nbsp;<span class="num" id="1985130">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1985134">//&nbsp;Pick&nbsp;up&nbsp;a&nbsp;digit,&nbsp;put&nbsp;down&nbsp;a&nbsp;digit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985173">for</span>&nbsp;<span class="ident" id="1985177">r</span><span class="op" id="1985178">--</span><span class="op" id="1985180">;</span>&nbsp;<span class="ident" id="1985182">r</span>&nbsp;<span class="op" id="1985184">&gt;=</span>&nbsp;<span class="num" id="1985187">0</span><span class="op" id="1985188">;</span>&nbsp;<span class="ident" id="1985190">r</span><span class="op" id="1985191">--</span>&nbsp;<span class="op" id="1985194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985198">n</span>&nbsp;<span class="op" id="1985200">+=</span>&nbsp;<span class="op" id="1985203">(</span><span class="builtintype" id="1985204">int</span><span class="op" id="1985207">(</span><span class="ident" id="1985208">a</span><span class="op" id="1985209">.</span><span class="ident" id="1985210">d</span><span class="op" id="1985211">[</span><span class="ident" id="1985212">r</span><span class="op" id="1985213">]</span><span class="op" id="1985214">)</span>&nbsp;<span class="op" id="1985216">-</span>&nbsp;<span class="string" id="1985218">&#39;0&#39;</span><span class="op" id="1985221">)</span>&nbsp;<span class="op" id="1985223">&lt;&lt;</span>&nbsp;<span class="ident" id="1985226">k</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985230">quo</span>&nbsp;<span class="op" id="1985234">:=</span>&nbsp;<span class="ident" id="1985237">n</span>&nbsp;<span class="op" id="1985239">/</span>&nbsp;<span class="num" id="1985241">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985246">rem</span>&nbsp;<span class="op" id="1985250">:=</span>&nbsp;<span class="ident" id="1985253">n</span>&nbsp;<span class="op" id="1985255">-</span>&nbsp;<span class="num" id="1985257">10</span><span class="op" id="1985259">*</span><span class="ident" id="1985260">quo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985266">w</span><span class="op" id="1985267">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985272">if</span>&nbsp;<span class="ident" id="1985275">w</span>&nbsp;<span class="op" id="1985277">&lt;</span>&nbsp;<span class="builtinfunc" id="1985279">len</span><span class="op" id="1985282">(</span><span class="ident" id="1985283">a</span><span class="op" id="1985284">.</span><span class="ident" id="1985285">d</span><span class="op" id="1985286">)</span>&nbsp;<span class="op" id="1985288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985293">a</span><span class="op" id="1985294">.</span><span class="ident" id="1985295">d</span><span class="op" id="1985296">[</span><span class="ident" id="1985297">w</span><span class="op" id="1985298">]</span>&nbsp;<span class="op" id="1985300">=</span>&nbsp;<span class="builtintype" id="1985302">byte</span><span class="op" id="1985306">(</span><span class="ident" id="1985307">rem</span>&nbsp;<span class="op" id="1985311">+</span>&nbsp;<span class="string" id="1985313">&#39;0&#39;</span><span class="op" id="1985316">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985320">}</span>&nbsp;<span class="keyword" id="1985322">else</span>&nbsp;<span class="keyword" id="1985327">if</span>&nbsp;<span class="ident" id="1985330">rem</span>&nbsp;<span class="op" id="1985334">!=</span>&nbsp;<span class="num" id="1985337">0</span>&nbsp;<span class="op" id="1985339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985344">a</span><span class="op" id="1985345">.</span><span class="ident" id="1985346">trunc</span>&nbsp;<span class="op" id="1985352">=</span>&nbsp;<span class="builtintype" id="1985354">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985365">n</span>&nbsp;<span class="op" id="1985367">=</span>&nbsp;<span class="ident" id="1985369">quo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985374">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1985378">//&nbsp;Put&nbsp;down&nbsp;extra&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985405">for</span>&nbsp;<span class="ident" id="1985409">n</span>&nbsp;<span class="op" id="1985411">&gt;</span>&nbsp;<span class="num" id="1985413">0</span>&nbsp;<span class="op" id="1985415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985419">quo</span>&nbsp;<span class="op" id="1985423">:=</span>&nbsp;<span class="ident" id="1985426">n</span>&nbsp;<span class="op" id="1985428">/</span>&nbsp;<span class="num" id="1985430">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985435">rem</span>&nbsp;<span class="op" id="1985439">:=</span>&nbsp;<span class="ident" id="1985442">n</span>&nbsp;<span class="op" id="1985444">-</span>&nbsp;<span class="num" id="1985446">10</span><span class="op" id="1985448">*</span><span class="ident" id="1985449">quo</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985455">w</span><span class="op" id="1985456">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985461">if</span>&nbsp;<span class="ident" id="1985464">w</span>&nbsp;<span class="op" id="1985466">&lt;</span>&nbsp;<span class="builtinfunc" id="1985468">len</span><span class="op" id="1985471">(</span><span class="ident" id="1985472">a</span><span class="op" id="1985473">.</span><span class="ident" id="1985474">d</span><span class="op" id="1985475">)</span>&nbsp;<span class="op" id="1985477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985482">a</span><span class="op" id="1985483">.</span><span class="ident" id="1985484">d</span><span class="op" id="1985485">[</span><span class="ident" id="1985486">w</span><span class="op" id="1985487">]</span>&nbsp;<span class="op" id="1985489">=</span>&nbsp;<span class="builtintype" id="1985491">byte</span><span class="op" id="1985495">(</span><span class="ident" id="1985496">rem</span>&nbsp;<span class="op" id="1985500">+</span>&nbsp;<span class="string" id="1985502">&#39;0&#39;</span><span class="op" id="1985505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985509">}</span>&nbsp;<span class="keyword" id="1985511">else</span>&nbsp;<span class="keyword" id="1985516">if</span>&nbsp;<span class="ident" id="1985519">rem</span>&nbsp;<span class="op" id="1985523">!=</span>&nbsp;<span class="num" id="1985526">0</span>&nbsp;<span class="op" id="1985528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985533">a</span><span class="op" id="1985534">.</span><span class="ident" id="1985535">trunc</span>&nbsp;<span class="op" id="1985541">=</span>&nbsp;<span class="builtintype" id="1985543">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985554">n</span>&nbsp;<span class="op" id="1985556">=</span>&nbsp;<span class="ident" id="1985558">quo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985567">a</span><span class="op" id="1985568">.</span><span class="ident" id="1985569">nd</span>&nbsp;<span class="op" id="1985572">+=</span>&nbsp;<span class="ident" id="1985575">delta</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985582">if</span>&nbsp;<span class="ident" id="1985585">a</span><span class="op" id="1985586">.</span><span class="ident" id="1985587">nd</span>&nbsp;<span class="op" id="1985590">&gt;=</span>&nbsp;<span class="builtinfunc" id="1985593">len</span><span class="op" id="1985596">(</span><span class="ident" id="1985597">a</span><span class="op" id="1985598">.</span><span class="ident" id="1985599">d</span><span class="op" id="1985600">)</span>&nbsp;<span class="op" id="1985602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985606">a</span><span class="op" id="1985607">.</span><span class="ident" id="1985608">nd</span>&nbsp;<span class="op" id="1985611">=</span>&nbsp;<span class="builtinfunc" id="1985613">len</span><span class="op" id="1985616">(</span><span class="ident" id="1985617">a</span><span class="op" id="1985618">.</span><span class="ident" id="1985619">d</span><span class="op" id="1985620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985626">a</span><span class="op" id="1985627">.</span><span class="ident" id="1985628">dp</span>&nbsp;<span class="op" id="1985631">+=</span>&nbsp;<span class="ident" id="1985634">delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985641">trim</span><span class="op" id="1985645">(</span><span class="ident" id="1985646">a</span><span class="op" id="1985647">)</span><br>
<span class="lineno">275</span><span class="op" id="1985649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1985652">//&nbsp;Binary&nbsp;shift&nbsp;left&nbsp;(k&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(k&nbsp;&lt;&nbsp;0).</span><br>
<span class="lineno"></span><span class="keyword" id="1985699">func</span>&nbsp;<span class="op" id="1985704">(</span><span class="ident" id="1985705">a</span>&nbsp;<span class="op" id="1985707">*</span><span class="ident" id="1985708">decimal</span><span class="op" id="1985715">)</span>&nbsp;<span class="ident" id="1985717">Shift</span><span class="op" id="1985722">(</span><span class="ident" id="1985723">k</span>&nbsp;<span class="builtintype" id="1985725">int</span><span class="op" id="1985728">)</span>&nbsp;<span class="op" id="1985730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985733">switch</span>&nbsp;<span class="op" id="1985740">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985743">case</span>&nbsp;<span class="ident" id="1985748">a</span><span class="op" id="1985749">.</span><span class="ident" id="1985750">nd</span>&nbsp;<span class="op" id="1985753">==</span>&nbsp;<span class="num" id="1985756">0</span><span class="op" id="1985757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1985761">//&nbsp;nothing&nbsp;to&nbsp;do:&nbsp;a&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985787">case</span>&nbsp;<span class="ident" id="1985792">k</span>&nbsp;<span class="op" id="1985794">&gt;</span>&nbsp;<span class="num" id="1985796">0</span><span class="op" id="1985797">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985801">for</span>&nbsp;<span class="ident" id="1985805">k</span>&nbsp;<span class="op" id="1985807">&gt;</span>&nbsp;<span class="ident" id="1985809">maxShift</span>&nbsp;<span class="op" id="1985818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985823">leftShift</span><span class="op" id="1985832">(</span><span class="ident" id="1985833">a</span><span class="op" id="1985834">,</span>&nbsp;<span class="ident" id="1985836">maxShift</span><span class="op" id="1985844">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985849">k</span>&nbsp;<span class="op" id="1985851">-=</span>&nbsp;<span class="ident" id="1985854">maxShift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985869">leftShift</span><span class="op" id="1985878">(</span><span class="ident" id="1985879">a</span><span class="op" id="1985880">,</span>&nbsp;<span class="builtintype" id="1985882">uint</span><span class="op" id="1985886">(</span><span class="ident" id="1985887">k</span><span class="op" id="1985888">)</span><span class="op" id="1985889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985892">case</span>&nbsp;<span class="ident" id="1985897">k</span>&nbsp;<span class="op" id="1985899">&lt;</span>&nbsp;<span class="num" id="1985901">0</span><span class="op" id="1985902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985906">for</span>&nbsp;<span class="ident" id="1985910">k</span>&nbsp;<span class="op" id="1985912">&lt;</span>&nbsp;<span class="op" id="1985914">-</span><span class="ident" id="1985915">maxShift</span>&nbsp;<span class="op" id="1985924">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985929">rightShift</span><span class="op" id="1985939">(</span><span class="ident" id="1985940">a</span><span class="op" id="1985941">,</span>&nbsp;<span class="ident" id="1985943">maxShift</span><span class="op" id="1985951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985956">k</span>&nbsp;<span class="op" id="1985958">+=</span>&nbsp;<span class="ident" id="1985961">maxShift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985976">rightShift</span><span class="op" id="1985986">(</span><span class="ident" id="1985987">a</span><span class="op" id="1985988">,</span>&nbsp;<span class="builtintype" id="1985990">uint</span><span class="op" id="1985994">(</span><span class="op" id="1985995">-</span><span class="ident" id="1985996">k</span><span class="op" id="1985997">)</span><span class="op" id="1985998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986001">}</span><br>
<span class="lineno">295</span><span class="op" id="1986003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1986006">//&nbsp;If&nbsp;we&nbsp;chop&nbsp;a&nbsp;at&nbsp;nd&nbsp;digits,&nbsp;should&nbsp;we&nbsp;round&nbsp;up?</span><br>
<span class="lineno"></span><span class="keyword" id="1986056">func</span>&nbsp;<span class="ident" id="1986061">shouldRoundUp</span><span class="op" id="1986074">(</span><span class="ident" id="1986075">a</span>&nbsp;<span class="op" id="1986077">*</span><span class="ident" id="1986078">decimal</span><span class="op" id="1986085">,</span>&nbsp;<span class="ident" id="1986087">nd</span>&nbsp;<span class="builtintype" id="1986090">int</span><span class="op" id="1986093">)</span>&nbsp;<span class="builtintype" id="1986095">bool</span>&nbsp;<span class="op" id="1986100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986103">if</span>&nbsp;<span class="ident" id="1986106">nd</span>&nbsp;<span class="op" id="1986109">&lt;</span>&nbsp;<span class="num" id="1986111">0</span>&nbsp;<span class="op" id="1986113">||</span>&nbsp;<span class="ident" id="1986116">nd</span>&nbsp;<span class="op" id="1986119">&gt;=</span>&nbsp;<span class="ident" id="1986122">a</span><span class="op" id="1986123">.</span><span class="ident" id="1986124">nd</span>&nbsp;<span class="op" id="1986127">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986131">return</span>&nbsp;<span class="builtintype" id="1986138">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986148">if</span>&nbsp;<span class="ident" id="1986151">a</span><span class="op" id="1986152">.</span><span class="ident" id="1986153">d</span><span class="op" id="1986154">[</span><span class="ident" id="1986155">nd</span><span class="op" id="1986157">]</span>&nbsp;<span class="op" id="1986159">==</span>&nbsp;<span class="string" id="1986162">&#39;5&#39;</span>&nbsp;<span class="op" id="1986166">&amp;&amp;</span>&nbsp;<span class="ident" id="1986169">nd</span><span class="op" id="1986171">+</span><span class="num" id="1986172">1</span>&nbsp;<span class="op" id="1986174">==</span>&nbsp;<span class="ident" id="1986177">a</span><span class="op" id="1986178">.</span><span class="ident" id="1986179">nd</span>&nbsp;<span class="op" id="1986182">{</span>&nbsp;<span class="comment" id="1986184">//&nbsp;exactly&nbsp;halfway&nbsp;-&nbsp;round&nbsp;to&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1986221">//&nbsp;if&nbsp;we&nbsp;truncated,&nbsp;a&nbsp;little&nbsp;higher&nbsp;than&nbsp;what&#39;s&nbsp;recorded&nbsp;-&nbsp;always&nbsp;round&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986298">if</span>&nbsp;<span class="ident" id="1986301">a</span><span class="op" id="1986302">.</span><span class="ident" id="1986303">trunc</span>&nbsp;<span class="op" id="1986309">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986314">return</span>&nbsp;<span class="builtintype" id="1986321">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986332">return</span>&nbsp;<span class="ident" id="1986339">nd</span>&nbsp;<span class="op" id="1986342">&gt;</span>&nbsp;<span class="num" id="1986344">0</span>&nbsp;<span class="op" id="1986346">&amp;&amp;</span>&nbsp;<span class="op" id="1986349">(</span><span class="ident" id="1986350">a</span><span class="op" id="1986351">.</span><span class="ident" id="1986352">d</span><span class="op" id="1986353">[</span><span class="ident" id="1986354">nd</span><span class="op" id="1986356">-</span><span class="num" id="1986357">1</span><span class="op" id="1986358">]</span><span class="op" id="1986359">-</span><span class="string" id="1986360">&#39;0&#39;</span><span class="op" id="1986363">)</span><span class="op" id="1986364">%</span><span class="num" id="1986365">2</span>&nbsp;<span class="op" id="1986367">!=</span>&nbsp;<span class="num" id="1986370">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1986376">//&nbsp;not&nbsp;halfway&nbsp;-&nbsp;digit&nbsp;tells&nbsp;all</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986410">return</span>&nbsp;<span class="ident" id="1986417">a</span><span class="op" id="1986418">.</span><span class="ident" id="1986419">d</span><span class="op" id="1986420">[</span><span class="ident" id="1986421">nd</span><span class="op" id="1986423">]</span>&nbsp;<span class="op" id="1986425">&gt;=</span>&nbsp;<span class="string" id="1986428">&#39;5&#39;</span><br>
<span class="lineno"></span><span class="op" id="1986432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1986435">//&nbsp;Round&nbsp;a&nbsp;to&nbsp;nd&nbsp;digits&nbsp;(or&nbsp;fewer).</span><br>
<span class="lineno"></span><span class="comment" id="1986471">//&nbsp;If&nbsp;nd&nbsp;is&nbsp;zero,&nbsp;it&nbsp;means&nbsp;we&#39;re&nbsp;rounding</span><br>
<span class="lineno">315</span><span class="comment" id="1986513">//&nbsp;just&nbsp;to&nbsp;the&nbsp;left&nbsp;of&nbsp;the&nbsp;digits,&nbsp;as&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="1986554">//&nbsp;0.09&nbsp;-&gt;&nbsp;0.1.</span><br>
<span class="lineno"></span><span class="keyword" id="1986570">func</span>&nbsp;<span class="op" id="1986575">(</span><span class="ident" id="1986576">a</span>&nbsp;<span class="op" id="1986578">*</span><span class="ident" id="1986579">decimal</span><span class="op" id="1986586">)</span>&nbsp;<span class="ident" id="1986588">Round</span><span class="op" id="1986593">(</span><span class="ident" id="1986594">nd</span>&nbsp;<span class="builtintype" id="1986597">int</span><span class="op" id="1986600">)</span>&nbsp;<span class="op" id="1986602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986605">if</span>&nbsp;<span class="ident" id="1986608">nd</span>&nbsp;<span class="op" id="1986611">&lt;</span>&nbsp;<span class="num" id="1986613">0</span>&nbsp;<span class="op" id="1986615">||</span>&nbsp;<span class="ident" id="1986618">nd</span>&nbsp;<span class="op" id="1986621">&gt;=</span>&nbsp;<span class="ident" id="1986624">a</span><span class="op" id="1986625">.</span><span class="ident" id="1986626">nd</span>&nbsp;<span class="op" id="1986629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986633">return</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986644">if</span>&nbsp;<span class="ident" id="1986647">shouldRoundUp</span><span class="op" id="1986660">(</span><span class="ident" id="1986661">a</span><span class="op" id="1986662">,</span>&nbsp;<span class="ident" id="1986664">nd</span><span class="op" id="1986666">)</span>&nbsp;<span class="op" id="1986668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986672">a</span><span class="op" id="1986673">.</span><span class="ident" id="1986674">RoundUp</span><span class="op" id="1986681">(</span><span class="ident" id="1986682">nd</span><span class="op" id="1986684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986687">}</span>&nbsp;<span class="keyword" id="1986689">else</span>&nbsp;<span class="op" id="1986694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986698">a</span><span class="op" id="1986699">.</span><span class="ident" id="1986700">RoundDown</span><span class="op" id="1986709">(</span><span class="ident" id="1986710">nd</span><span class="op" id="1986712">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986715">}</span><br>
<span class="lineno"></span><span class="op" id="1986717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1986720">//&nbsp;Round&nbsp;a&nbsp;down&nbsp;to&nbsp;nd&nbsp;digits&nbsp;(or&nbsp;fewer).</span><br>
<span class="lineno"></span><span class="keyword" id="1986761">func</span>&nbsp;<span class="op" id="1986766">(</span><span class="ident" id="1986767">a</span>&nbsp;<span class="op" id="1986769">*</span><span class="ident" id="1986770">decimal</span><span class="op" id="1986777">)</span>&nbsp;<span class="ident" id="1986779">RoundDown</span><span class="op" id="1986788">(</span><span class="ident" id="1986789">nd</span>&nbsp;<span class="builtintype" id="1986792">int</span><span class="op" id="1986795">)</span>&nbsp;<span class="op" id="1986797">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986800">if</span>&nbsp;<span class="ident" id="1986803">nd</span>&nbsp;<span class="op" id="1986806">&lt;</span>&nbsp;<span class="num" id="1986808">0</span>&nbsp;<span class="op" id="1986810">||</span>&nbsp;<span class="ident" id="1986813">nd</span>&nbsp;<span class="op" id="1986816">&gt;=</span>&nbsp;<span class="ident" id="1986819">a</span><span class="op" id="1986820">.</span><span class="ident" id="1986821">nd</span>&nbsp;<span class="op" id="1986824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986828">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986839">a</span><span class="op" id="1986840">.</span><span class="ident" id="1986841">nd</span>&nbsp;<span class="op" id="1986844">=</span>&nbsp;<span class="ident" id="1986846">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986850">trim</span><span class="op" id="1986854">(</span><span class="ident" id="1986855">a</span><span class="op" id="1986856">)</span><br>
<span class="lineno">335</span><span class="op" id="1986858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1986861">//&nbsp;Round&nbsp;a&nbsp;up&nbsp;to&nbsp;nd&nbsp;digits&nbsp;(or&nbsp;fewer).</span><br>
<span class="lineno"></span><span class="keyword" id="1986900">func</span>&nbsp;<span class="op" id="1986905">(</span><span class="ident" id="1986906">a</span>&nbsp;<span class="op" id="1986908">*</span><span class="ident" id="1986909">decimal</span><span class="op" id="1986916">)</span>&nbsp;<span class="ident" id="1986918">RoundUp</span><span class="op" id="1986925">(</span><span class="ident" id="1986926">nd</span>&nbsp;<span class="builtintype" id="1986929">int</span><span class="op" id="1986932">)</span>&nbsp;<span class="op" id="1986934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986937">if</span>&nbsp;<span class="ident" id="1986940">nd</span>&nbsp;<span class="op" id="1986943">&lt;</span>&nbsp;<span class="num" id="1986945">0</span>&nbsp;<span class="op" id="1986947">||</span>&nbsp;<span class="ident" id="1986950">nd</span>&nbsp;<span class="op" id="1986953">&gt;=</span>&nbsp;<span class="ident" id="1986956">a</span><span class="op" id="1986957">.</span><span class="ident" id="1986958">nd</span>&nbsp;<span class="op" id="1986961">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986965">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1986977">//&nbsp;round&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986990">for</span>&nbsp;<span class="ident" id="1986994">i</span>&nbsp;<span class="op" id="1986996">:=</span>&nbsp;<span class="ident" id="1986999">nd</span>&nbsp;<span class="op" id="1987002">-</span>&nbsp;<span class="num" id="1987004">1</span><span class="op" id="1987005">;</span>&nbsp;<span class="ident" id="1987007">i</span>&nbsp;<span class="op" id="1987009">&gt;=</span>&nbsp;<span class="num" id="1987012">0</span><span class="op" id="1987013">;</span>&nbsp;<span class="ident" id="1987015">i</span><span class="op" id="1987016">--</span>&nbsp;<span class="op" id="1987019">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987023">c</span>&nbsp;<span class="op" id="1987025">:=</span>&nbsp;<span class="ident" id="1987028">a</span><span class="op" id="1987029">.</span><span class="ident" id="1987030">d</span><span class="op" id="1987031">[</span><span class="ident" id="1987032">i</span><span class="op" id="1987033">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987037">if</span>&nbsp;<span class="ident" id="1987040">c</span>&nbsp;<span class="op" id="1987042">&lt;</span>&nbsp;<span class="string" id="1987044">&#39;9&#39;</span>&nbsp;<span class="op" id="1987048">{</span>&nbsp;<span class="comment" id="1987050">//&nbsp;can&nbsp;stop&nbsp;after&nbsp;this&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987082">a</span><span class="op" id="1987083">.</span><span class="ident" id="1987084">d</span><span class="op" id="1987085">[</span><span class="ident" id="1987086">i</span><span class="op" id="1987087">]</span><span class="op" id="1987088">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987094">a</span><span class="op" id="1987095">.</span><span class="ident" id="1987096">nd</span>&nbsp;<span class="op" id="1987099">=</span>&nbsp;<span class="ident" id="1987101">i</span>&nbsp;<span class="op" id="1987103">+</span>&nbsp;<span class="num" id="1987105">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987110">return</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1987126">//&nbsp;Number&nbsp;is&nbsp;all&nbsp;9s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1987148">//&nbsp;Change&nbsp;to&nbsp;single&nbsp;1&nbsp;with&nbsp;adjusted&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987200">a</span><span class="op" id="1987201">.</span><span class="ident" id="1987202">d</span><span class="op" id="1987203">[</span><span class="num" id="1987204">0</span><span class="op" id="1987205">]</span>&nbsp;<span class="op" id="1987207">=</span>&nbsp;<span class="string" id="1987209">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987214">a</span><span class="op" id="1987215">.</span><span class="ident" id="1987216">nd</span>&nbsp;<span class="op" id="1987219">=</span>&nbsp;<span class="num" id="1987221">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987224">a</span><span class="op" id="1987225">.</span><span class="ident" id="1987226">dp</span><span class="op" id="1987228">++</span><br>
<span class="lineno"></span><span class="op" id="1987231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="comment" id="1987234">//&nbsp;Extract&nbsp;integer&nbsp;part,&nbsp;rounded&nbsp;appropriately.</span><br>
<span class="lineno"></span><span class="comment" id="1987282">//&nbsp;No&nbsp;guarantees&nbsp;about&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="keyword" id="1987315">func</span>&nbsp;<span class="op" id="1987320">(</span><span class="ident" id="1987321">a</span>&nbsp;<span class="op" id="1987323">*</span><span class="ident" id="1987324">decimal</span><span class="op" id="1987331">)</span>&nbsp;<span class="ident" id="1987333">RoundedInteger</span><span class="op" id="1987347">(</span><span class="op" id="1987348">)</span>&nbsp;<span class="ident" id="1987350">uint64</span>&nbsp;<span class="op" id="1987357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987360">if</span>&nbsp;<span class="ident" id="1987363">a</span><span class="op" id="1987364">.</span><span class="ident" id="1987365">dp</span>&nbsp;<span class="op" id="1987368">&gt;</span>&nbsp;<span class="num" id="1987370">20</span>&nbsp;<span class="op" id="1987373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987377">return</span>&nbsp;<span class="num" id="1987384">0xFFFFFFFFFFFFFFFF</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987407">var</span>&nbsp;<span class="ident" id="1987411">i</span>&nbsp;<span class="builtintype" id="1987413">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987418">n</span>&nbsp;<span class="op" id="1987420">:=</span>&nbsp;<span class="ident" id="1987423">uint64</span><span class="op" id="1987429">(</span><span class="num" id="1987430">0</span><span class="op" id="1987431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987434">for</span>&nbsp;<span class="ident" id="1987438">i</span>&nbsp;<span class="op" id="1987440">=</span>&nbsp;<span class="num" id="1987442">0</span><span class="op" id="1987443">;</span>&nbsp;<span class="ident" id="1987445">i</span>&nbsp;<span class="op" id="1987447">&lt;</span>&nbsp;<span class="ident" id="1987449">a</span><span class="op" id="1987450">.</span><span class="ident" id="1987451">dp</span>&nbsp;<span class="op" id="1987454">&amp;&amp;</span>&nbsp;<span class="ident" id="1987457">i</span>&nbsp;<span class="op" id="1987459">&lt;</span>&nbsp;<span class="ident" id="1987461">a</span><span class="op" id="1987462">.</span><span class="ident" id="1987463">nd</span><span class="op" id="1987465">;</span>&nbsp;<span class="ident" id="1987467">i</span><span class="op" id="1987468">++</span>&nbsp;<span class="op" id="1987471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987475">n</span>&nbsp;<span class="op" id="1987477">=</span>&nbsp;<span class="ident" id="1987479">n</span><span class="op" id="1987480">*</span><span class="num" id="1987481">10</span>&nbsp;<span class="op" id="1987484">+</span>&nbsp;<span class="ident" id="1987486">uint64</span><span class="op" id="1987492">(</span><span class="ident" id="1987493">a</span><span class="op" id="1987494">.</span><span class="ident" id="1987495">d</span><span class="op" id="1987496">[</span><span class="ident" id="1987497">i</span><span class="op" id="1987498">]</span><span class="op" id="1987499">-</span><span class="string" id="1987500">&#39;0&#39;</span><span class="op" id="1987503">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987509">for</span>&nbsp;<span class="op" id="1987513">;</span>&nbsp;<span class="ident" id="1987515">i</span>&nbsp;<span class="op" id="1987517">&lt;</span>&nbsp;<span class="ident" id="1987519">a</span><span class="op" id="1987520">.</span><span class="ident" id="1987521">dp</span><span class="op" id="1987523">;</span>&nbsp;<span class="ident" id="1987525">i</span><span class="op" id="1987526">++</span>&nbsp;<span class="op" id="1987529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987533">n</span>&nbsp;<span class="op" id="1987535">*=</span>&nbsp;<span class="num" id="1987538">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987545">if</span>&nbsp;<span class="ident" id="1987548">shouldRoundUp</span><span class="op" id="1987561">(</span><span class="ident" id="1987562">a</span><span class="op" id="1987563">,</span>&nbsp;<span class="ident" id="1987565">a</span><span class="op" id="1987566">.</span><span class="ident" id="1987567">dp</span><span class="op" id="1987569">)</span>&nbsp;<span class="op" id="1987571">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987575">n</span><span class="op" id="1987576">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987583">return</span>&nbsp;<span class="ident" id="1987590">n</span><br>
<span class="lineno"></span><span class="op" id="1987592">}</span>
</div>
</body>
</html>
