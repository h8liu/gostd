<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3185902">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3185957">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3186011">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3186062">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3186127">package</span>&nbsp;<span class="ident" id="3186135">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3186140">import</span>&nbsp;<span class="op" id="3186147">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3186150">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3186156">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3186166">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3186169">func</span>&nbsp;<span class="ident" id="3186174">newFileFD</span><span class="op" id="3186183">(</span><span class="ident" id="3186184">f</span>&nbsp;<span class="op" id="3186186">*</span><span class="ident" id="3186187">os</span><span class="op" id="3186189">.</span><span class="ident" id="3186190">File</span><span class="op" id="3186194">)</span>&nbsp;<span class="op" id="3186196">(</span><span class="op" id="3186197">*</span><span class="ident" id="3186198">netFD</span><span class="op" id="3186203">,</span>&nbsp;<span class="builtintype" id="3186205">error</span><span class="op" id="3186210">)</span>&nbsp;<span class="op" id="3186212">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3186215">fd</span><span class="op" id="3186217">,</span>&nbsp;<span class="ident" id="3186219">err</span>&nbsp;<span class="op" id="3186223">:=</span>&nbsp;<span class="ident" id="3186226">dupCloseOnExec</span><span class="op" id="3186240">(</span><span class="builtintype" id="3186241">int</span><span class="op" id="3186244">(</span><span class="ident" id="3186245">f</span><span class="op" id="3186246">.</span><span class="ident" id="3186247">Fd</span><span class="op" id="3186249">(</span><span class="op" id="3186250">)</span><span class="op" id="3186251">)</span><span class="op" id="3186252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3186255">if</span>&nbsp;<span class="ident" id="3186258">err</span>&nbsp;<span class="op" id="3186262">!=</span>&nbsp;<span class="ident" id="3186265">nil</span>&nbsp;<span class="op" id="3186269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3186273">return</span>&nbsp;<span class="ident" id="3186280">nil</span><span class="op" id="3186283">,</span>&nbsp;<span class="ident" id="3186285">os</span><span class="op" id="3186287">.</span><span class="ident" id="3186288">NewSyscallError</span><span class="op" id="3186303">(</span><span class="string" id="3186304">&#34;dup&#34;</span><span class="op" id="3186309">,</span>&nbsp;<span class="ident" id="3186311">err</span><span class="op" id="3186314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3186317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3186321">if</span>&nbsp;<span class="ident" id="3186324">err</span>&nbsp;<span class="op" id="3186328">=</span>&nbsp;<span class="ident" id="3186330">syscall</span><span class="op" id="3186337">.</span><span class="ident" id="3186338">SetNonblock</span><span class="op" id="3186349">(</span><span class="ident" id="3186350">fd</span><span class="op" id="3186352">,</span>&nbsp;<span class="builtintype" id="3186354">true</span><span class="op" id="3186358">)</span><span class="op" id="3186359">;</span>&nbsp;<span class="ident" id="3186361">err</span>&nbsp;<span class="op" id="3186365">!=</span>&nbsp;<span class="ident" id="3186368">nil</span>&nbsp;<span class="op" id="3186372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3186376">closesocket</span><span class="op" id="3186387">(</span><span class="ident" id="3186388">fd</span><span class="op" id="3186390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3186394">return</span>&nbsp;<span class="ident" id="3186401">nil</span><span class="op" id="3186404">,</span>&nbsp;<span class="ident" id="3186406">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3186411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3186415">sotype</span><span class="op" id="3186421">,</span>&nbsp;<span class="ident" id="3186423">err</span>&nbsp;<span class="op" id="3186427">:=</span>&nbsp;<span class="ident" id="3186430">syscall</span><span class="op" id="3186437">.</span><span class="ident" id="3186438">GetsockoptInt</span><span class="op" id="3186451">(</span><span class="ident" id="3186452">fd</span><span class="op" id="3186454">,</span>&nbsp;<span class="ident" id="3186456">syscall</span><span class="op" id="3186463">.</span><span class="ident" id="3186464">SOL_SOCKET</span><span class="op" id="3186474">,</span>&nbsp;<span class="ident" id="3186476">syscall</span><span class="op" id="3186483">.</span><span class="ident" id="3186484">SO_TYPE</span><span class="op" id="3186491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3186494">if</span>&nbsp;<span class="ident" id="3186497">err</span>&nbsp;<span class="op" id="3186501">!=</span>&nbsp;<span class="ident" id="3186504">nil</span>&nbsp;<span class="op" id="3186508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3186512">closesocket</span><span class="op" id="3186523">(</span><span class="ident" id="3186524">fd</span><span class="op" id="3186526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3186530">return</span>&nbsp;<span class="ident" id="3186537">nil</span><span class="op" id="3186540">,</span>&nbsp;<span class="ident" id="3186542">os</span><span class="op" id="3186544">.</span><span class="ident" id="3186545">NewSyscallError</span><span class="op" id="3186560">(</span><span class="string" id="3186561">&#34;getsockopt&#34;</span><span class="op" id="3186573">,</span>&nbsp;<span class="ident" id="3186575">err</span><span class="op" id="3186578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3186581">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3186585">family</span>&nbsp;<span class="op" id="3186592">:=</span>&nbsp;<span class="ident" id="3186595">syscall</span><span class="op" id="3186602">.</span><span class="ident" id="3186603">AF_UNSPEC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3186614">toAddr</span>&nbsp;<span class="op" id="3186621">:=</span>&nbsp;<span class="ident" id="3186624">sockaddrToTCP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3186639">lsa</span><span class="op" id="3186642">,</span>&nbsp;<span class="ident" id="3186644">_</span>&nbsp;<span class="op" id="3186646">:=</span>&nbsp;<span class="ident" id="3186649">syscall</span><span class="op" id="3186656">.</span><span class="ident" id="3186657">Getsockname</span><span class="op" id="3186668">(</span><span class="ident" id="3186669">fd</span><span class="op" id="3186671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3186674">switch</span>&nbsp;<span class="ident" id="3186681">lsa</span><span class="op" id="3186684">.</span><span class="op" id="3186685">(</span><span class="keyword" id="3186686">type</span><span class="op" id="3186690">)</span>&nbsp;<span class="op" id="3186692">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3186695">default</span><span class="op" id="3186702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3186706">closesocket</span><span class="op" id="3186717">(</span><span class="ident" id="3186718">fd</span><span class="op" id="3186720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3186724">return</span>&nbsp;<span class="ident" id="3186731">nil</span><span class="op" id="3186734">,</span>&nbsp;<span class="ident" id="3186736">syscall</span><span class="op" id="3186743">.</span><span class="ident" id="3186744">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3186752">case</span>&nbsp;<span class="op" id="3186757">*</span><span class="ident" id="3186758">syscall</span><span class="op" id="3186765">.</span><span class="ident" id="3186766">SockaddrInet4</span><span class="op" id="3186779">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3186783">family</span>&nbsp;<span class="op" id="3186790">=</span>&nbsp;<span class="ident" id="3186792">syscall</span><span class="op" id="3186799">.</span><span class="ident" id="3186800">AF_INET</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3186810">if</span>&nbsp;<span class="ident" id="3186813">sotype</span>&nbsp;<span class="op" id="3186820">==</span>&nbsp;<span class="ident" id="3186823">syscall</span><span class="op" id="3186830">.</span><span class="ident" id="3186831">SOCK_DGRAM</span>&nbsp;<span class="op" id="3186842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3186847">toAddr</span>&nbsp;<span class="op" id="3186854">=</span>&nbsp;<span class="ident" id="3186856">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3186872">}</span>&nbsp;<span class="keyword" id="3186874">else</span>&nbsp;<span class="keyword" id="3186879">if</span>&nbsp;<span class="ident" id="3186882">sotype</span>&nbsp;<span class="op" id="3186889">==</span>&nbsp;<span class="ident" id="3186892">syscall</span><span class="op" id="3186899">.</span><span class="ident" id="3186900">SOCK_RAW</span>&nbsp;<span class="op" id="3186909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3186914">toAddr</span>&nbsp;<span class="op" id="3186921">=</span>&nbsp;<span class="ident" id="3186923">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3186938">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3186941">case</span>&nbsp;<span class="op" id="3186946">*</span><span class="ident" id="3186947">syscall</span><span class="op" id="3186954">.</span><span class="ident" id="3186955">SockaddrInet6</span><span class="op" id="3186968">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3186972">family</span>&nbsp;<span class="op" id="3186979">=</span>&nbsp;<span class="ident" id="3186981">syscall</span><span class="op" id="3186988">.</span><span class="ident" id="3186989">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3187000">if</span>&nbsp;<span class="ident" id="3187003">sotype</span>&nbsp;<span class="op" id="3187010">==</span>&nbsp;<span class="ident" id="3187013">syscall</span><span class="op" id="3187020">.</span><span class="ident" id="3187021">SOCK_DGRAM</span>&nbsp;<span class="op" id="3187032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187037">toAddr</span>&nbsp;<span class="op" id="3187044">=</span>&nbsp;<span class="ident" id="3187046">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3187062">}</span>&nbsp;<span class="keyword" id="3187064">else</span>&nbsp;<span class="keyword" id="3187069">if</span>&nbsp;<span class="ident" id="3187072">sotype</span>&nbsp;<span class="op" id="3187079">==</span>&nbsp;<span class="ident" id="3187082">syscall</span><span class="op" id="3187089">.</span><span class="ident" id="3187090">SOCK_RAW</span>&nbsp;<span class="op" id="3187099">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187104">toAddr</span>&nbsp;<span class="op" id="3187111">=</span>&nbsp;<span class="ident" id="3187113">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3187128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3187131">case</span>&nbsp;<span class="op" id="3187136">*</span><span class="ident" id="3187137">syscall</span><span class="op" id="3187144">.</span><span class="ident" id="3187145">SockaddrUnix</span><span class="op" id="3187157">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187161">family</span>&nbsp;<span class="op" id="3187168">=</span>&nbsp;<span class="ident" id="3187170">syscall</span><span class="op" id="3187177">.</span><span class="ident" id="3187178">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187188">toAddr</span>&nbsp;<span class="op" id="3187195">=</span>&nbsp;<span class="ident" id="3187197">sockaddrToUnix</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3187214">if</span>&nbsp;<span class="ident" id="3187217">sotype</span>&nbsp;<span class="op" id="3187224">==</span>&nbsp;<span class="ident" id="3187227">syscall</span><span class="op" id="3187234">.</span><span class="ident" id="3187235">SOCK_DGRAM</span>&nbsp;<span class="op" id="3187246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187251">toAddr</span>&nbsp;<span class="op" id="3187258">=</span>&nbsp;<span class="ident" id="3187260">sockaddrToUnixgram</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3187281">}</span>&nbsp;<span class="keyword" id="3187283">else</span>&nbsp;<span class="keyword" id="3187288">if</span>&nbsp;<span class="ident" id="3187291">sotype</span>&nbsp;<span class="op" id="3187298">==</span>&nbsp;<span class="ident" id="3187301">syscall</span><span class="op" id="3187308">.</span><span class="ident" id="3187309">SOCK_SEQPACKET</span>&nbsp;<span class="op" id="3187324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187329">toAddr</span>&nbsp;<span class="op" id="3187336">=</span>&nbsp;<span class="ident" id="3187338">sockaddrToUnixpacket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3187361">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3187364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187367">laddr</span>&nbsp;<span class="op" id="3187373">:=</span>&nbsp;<span class="ident" id="3187376">toAddr</span><span class="op" id="3187382">(</span><span class="ident" id="3187383">lsa</span><span class="op" id="3187386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187389">rsa</span><span class="op" id="3187392">,</span>&nbsp;<span class="ident" id="3187394">_</span>&nbsp;<span class="op" id="3187396">:=</span>&nbsp;<span class="ident" id="3187399">syscall</span><span class="op" id="3187406">.</span><span class="ident" id="3187407">Getpeername</span><span class="op" id="3187418">(</span><span class="ident" id="3187419">fd</span><span class="op" id="3187421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187424">raddr</span>&nbsp;<span class="op" id="3187430">:=</span>&nbsp;<span class="ident" id="3187433">toAddr</span><span class="op" id="3187439">(</span><span class="ident" id="3187440">rsa</span><span class="op" id="3187443">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187447">netfd</span><span class="op" id="3187452">,</span>&nbsp;<span class="ident" id="3187454">err</span>&nbsp;<span class="op" id="3187458">:=</span>&nbsp;<span class="ident" id="3187461">newFD</span><span class="op" id="3187466">(</span><span class="ident" id="3187467">fd</span><span class="op" id="3187469">,</span>&nbsp;<span class="ident" id="3187471">family</span><span class="op" id="3187477">,</span>&nbsp;<span class="ident" id="3187479">sotype</span><span class="op" id="3187485">,</span>&nbsp;<span class="ident" id="3187487">laddr</span><span class="op" id="3187492">.</span><span class="ident" id="3187493">Network</span><span class="op" id="3187500">(</span><span class="op" id="3187501">)</span><span class="op" id="3187502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3187505">if</span>&nbsp;<span class="ident" id="3187508">err</span>&nbsp;<span class="op" id="3187512">!=</span>&nbsp;<span class="ident" id="3187515">nil</span>&nbsp;<span class="op" id="3187519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187523">closesocket</span><span class="op" id="3187534">(</span><span class="ident" id="3187535">fd</span><span class="op" id="3187537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3187541">return</span>&nbsp;<span class="ident" id="3187548">nil</span><span class="op" id="3187551">,</span>&nbsp;<span class="ident" id="3187553">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3187558">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3187561">if</span>&nbsp;<span class="ident" id="3187564">err</span>&nbsp;<span class="op" id="3187568">:=</span>&nbsp;<span class="ident" id="3187571">netfd</span><span class="op" id="3187576">.</span><span class="ident" id="3187577">init</span><span class="op" id="3187581">(</span><span class="op" id="3187582">)</span><span class="op" id="3187583">;</span>&nbsp;<span class="ident" id="3187585">err</span>&nbsp;<span class="op" id="3187589">!=</span>&nbsp;<span class="ident" id="3187592">nil</span>&nbsp;<span class="op" id="3187596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187600">netfd</span><span class="op" id="3187605">.</span><span class="ident" id="3187606">Close</span><span class="op" id="3187611">(</span><span class="op" id="3187612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3187616">return</span>&nbsp;<span class="ident" id="3187623">nil</span><span class="op" id="3187626">,</span>&nbsp;<span class="ident" id="3187628">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3187633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187636">netfd</span><span class="op" id="3187641">.</span><span class="ident" id="3187642">setAddr</span><span class="op" id="3187649">(</span><span class="ident" id="3187650">laddr</span><span class="op" id="3187655">,</span>&nbsp;<span class="ident" id="3187657">raddr</span><span class="op" id="3187662">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3187665">return</span>&nbsp;<span class="ident" id="3187672">netfd</span><span class="op" id="3187677">,</span>&nbsp;<span class="ident" id="3187679">nil</span><br>
<span class="lineno"></span><span class="op" id="3187683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3187686">//&nbsp;FileConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;connection&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3187756">//&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when</span><br>
<span class="lineno">80</span><span class="comment" id="3187827">//&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3187893">//&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3187906">func</span>&nbsp;<span class="ident" id="3187911">FileConn</span><span class="op" id="3187919">(</span><span class="ident" id="3187920">f</span>&nbsp;<span class="op" id="3187922">*</span><span class="ident" id="3187923">os</span><span class="op" id="3187925">.</span><span class="ident" id="3187926">File</span><span class="op" id="3187930">)</span>&nbsp;<span class="op" id="3187932">(</span><span class="ident" id="3187933">c</span>&nbsp;<span class="ident" id="3187935">Conn</span><span class="op" id="3187939">,</span>&nbsp;<span class="ident" id="3187941">err</span>&nbsp;<span class="builtintype" id="3187945">error</span><span class="op" id="3187950">)</span>&nbsp;<span class="op" id="3187952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3187955">fd</span><span class="op" id="3187957">,</span>&nbsp;<span class="ident" id="3187959">err</span>&nbsp;<span class="op" id="3187963">:=</span>&nbsp;<span class="ident" id="3187966">newFileFD</span><span class="op" id="3187975">(</span><span class="ident" id="3187976">f</span><span class="op" id="3187977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3187980">if</span>&nbsp;<span class="ident" id="3187983">err</span>&nbsp;<span class="op" id="3187987">!=</span>&nbsp;<span class="ident" id="3187990">nil</span>&nbsp;<span class="op" id="3187994">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3187998">return</span>&nbsp;<span class="ident" id="3188005">nil</span><span class="op" id="3188008">,</span>&nbsp;<span class="ident" id="3188010">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3188015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188018">switch</span>&nbsp;<span class="ident" id="3188025">fd</span><span class="op" id="3188027">.</span><span class="ident" id="3188028">laddr</span><span class="op" id="3188033">.</span><span class="op" id="3188034">(</span><span class="keyword" id="3188035">type</span><span class="op" id="3188039">)</span>&nbsp;<span class="op" id="3188041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188044">case</span>&nbsp;<span class="op" id="3188049">*</span><span class="ident" id="3188050">TCPAddr</span><span class="op" id="3188057">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188061">return</span>&nbsp;<span class="ident" id="3188068">newTCPConn</span><span class="op" id="3188078">(</span><span class="ident" id="3188079">fd</span><span class="op" id="3188081">)</span><span class="op" id="3188082">,</span>&nbsp;<span class="ident" id="3188084">nil</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188089">case</span>&nbsp;<span class="op" id="3188094">*</span><span class="ident" id="3188095">UDPAddr</span><span class="op" id="3188102">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188106">return</span>&nbsp;<span class="ident" id="3188113">newUDPConn</span><span class="op" id="3188123">(</span><span class="ident" id="3188124">fd</span><span class="op" id="3188126">)</span><span class="op" id="3188127">,</span>&nbsp;<span class="ident" id="3188129">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188134">case</span>&nbsp;<span class="op" id="3188139">*</span><span class="ident" id="3188140">IPAddr</span><span class="op" id="3188146">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188150">return</span>&nbsp;<span class="ident" id="3188157">newIPConn</span><span class="op" id="3188166">(</span><span class="ident" id="3188167">fd</span><span class="op" id="3188169">)</span><span class="op" id="3188170">,</span>&nbsp;<span class="ident" id="3188172">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188177">case</span>&nbsp;<span class="op" id="3188182">*</span><span class="ident" id="3188183">UnixAddr</span><span class="op" id="3188191">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188195">return</span>&nbsp;<span class="ident" id="3188202">newUnixConn</span><span class="op" id="3188213">(</span><span class="ident" id="3188214">fd</span><span class="op" id="3188216">)</span><span class="op" id="3188217">,</span>&nbsp;<span class="ident" id="3188219">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3188224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3188227">fd</span><span class="op" id="3188229">.</span><span class="ident" id="3188230">Close</span><span class="op" id="3188235">(</span><span class="op" id="3188236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188239">return</span>&nbsp;<span class="ident" id="3188246">nil</span><span class="op" id="3188249">,</span>&nbsp;<span class="ident" id="3188251">syscall</span><span class="op" id="3188258">.</span><span class="ident" id="3188259">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3188266">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3188269">//&nbsp;FileListener&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;listener&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="3188338">//&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;l</span><br>
<span class="lineno"></span><span class="comment" id="3188407">//&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;l&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3188478">//&nbsp;affect&nbsp;l.</span><br>
<span class="lineno">105</span><span class="keyword" id="3188491">func</span>&nbsp;<span class="ident" id="3188496">FileListener</span><span class="op" id="3188508">(</span><span class="ident" id="3188509">f</span>&nbsp;<span class="op" id="3188511">*</span><span class="ident" id="3188512">os</span><span class="op" id="3188514">.</span><span class="ident" id="3188515">File</span><span class="op" id="3188519">)</span>&nbsp;<span class="op" id="3188521">(</span><span class="ident" id="3188522">l</span>&nbsp;<span class="ident" id="3188524">Listener</span><span class="op" id="3188532">,</span>&nbsp;<span class="ident" id="3188534">err</span>&nbsp;<span class="builtintype" id="3188538">error</span><span class="op" id="3188543">)</span>&nbsp;<span class="op" id="3188545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3188548">fd</span><span class="op" id="3188550">,</span>&nbsp;<span class="ident" id="3188552">err</span>&nbsp;<span class="op" id="3188556">:=</span>&nbsp;<span class="ident" id="3188559">newFileFD</span><span class="op" id="3188568">(</span><span class="ident" id="3188569">f</span><span class="op" id="3188570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188573">if</span>&nbsp;<span class="ident" id="3188576">err</span>&nbsp;<span class="op" id="3188580">!=</span>&nbsp;<span class="ident" id="3188583">nil</span>&nbsp;<span class="op" id="3188587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188591">return</span>&nbsp;<span class="ident" id="3188598">nil</span><span class="op" id="3188601">,</span>&nbsp;<span class="ident" id="3188603">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3188608">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188611">switch</span>&nbsp;<span class="ident" id="3188618">laddr</span>&nbsp;<span class="op" id="3188624">:=</span>&nbsp;<span class="ident" id="3188627">fd</span><span class="op" id="3188629">.</span><span class="ident" id="3188630">laddr</span><span class="op" id="3188635">.</span><span class="op" id="3188636">(</span><span class="keyword" id="3188637">type</span><span class="op" id="3188641">)</span>&nbsp;<span class="op" id="3188643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188646">case</span>&nbsp;<span class="op" id="3188651">*</span><span class="ident" id="3188652">TCPAddr</span><span class="op" id="3188659">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188663">return</span>&nbsp;<span class="op" id="3188670">&amp;</span><span class="ident" id="3188671">TCPListener</span><span class="op" id="3188682">{</span><span class="ident" id="3188683">fd</span><span class="op" id="3188685">}</span><span class="op" id="3188686">,</span>&nbsp;<span class="ident" id="3188688">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188693">case</span>&nbsp;<span class="op" id="3188698">*</span><span class="ident" id="3188699">UnixAddr</span><span class="op" id="3188707">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188711">return</span>&nbsp;<span class="op" id="3188718">&amp;</span><span class="ident" id="3188719">UnixListener</span><span class="op" id="3188731">{</span><span class="ident" id="3188732">fd</span><span class="op" id="3188734">,</span>&nbsp;<span class="ident" id="3188736">laddr</span><span class="op" id="3188741">.</span><span class="ident" id="3188742">Name</span><span class="op" id="3188746">}</span><span class="op" id="3188747">,</span>&nbsp;<span class="ident" id="3188749">nil</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3188754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3188757">fd</span><span class="op" id="3188759">.</span><span class="ident" id="3188760">Close</span><span class="op" id="3188765">(</span><span class="op" id="3188766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3188769">return</span>&nbsp;<span class="ident" id="3188776">nil</span><span class="op" id="3188779">,</span>&nbsp;<span class="ident" id="3188781">syscall</span><span class="op" id="3188788">.</span><span class="ident" id="3188789">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3188796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3188799">//&nbsp;FilePacketConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;packet&nbsp;network&nbsp;connection</span><br>
<span class="lineno"></span><span class="comment" id="3188865">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3188922">//&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect</span><br>
<span class="lineno"></span><span class="comment" id="3188993">//&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3189032">func</span>&nbsp;<span class="ident" id="3189037">FilePacketConn</span><span class="op" id="3189051">(</span><span class="ident" id="3189052">f</span>&nbsp;<span class="op" id="3189054">*</span><span class="ident" id="3189055">os</span><span class="op" id="3189057">.</span><span class="ident" id="3189058">File</span><span class="op" id="3189062">)</span>&nbsp;<span class="op" id="3189064">(</span><span class="ident" id="3189065">c</span>&nbsp;<span class="ident" id="3189067">PacketConn</span><span class="op" id="3189077">,</span>&nbsp;<span class="ident" id="3189079">err</span>&nbsp;<span class="builtintype" id="3189083">error</span><span class="op" id="3189088">)</span>&nbsp;<span class="op" id="3189090">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3189093">fd</span><span class="op" id="3189095">,</span>&nbsp;<span class="ident" id="3189097">err</span>&nbsp;<span class="op" id="3189101">:=</span>&nbsp;<span class="ident" id="3189104">newFileFD</span><span class="op" id="3189113">(</span><span class="ident" id="3189114">f</span><span class="op" id="3189115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3189118">if</span>&nbsp;<span class="ident" id="3189121">err</span>&nbsp;<span class="op" id="3189125">!=</span>&nbsp;<span class="ident" id="3189128">nil</span>&nbsp;<span class="op" id="3189132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3189136">return</span>&nbsp;<span class="ident" id="3189143">nil</span><span class="op" id="3189146">,</span>&nbsp;<span class="ident" id="3189148">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3189153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3189156">switch</span>&nbsp;<span class="ident" id="3189163">fd</span><span class="op" id="3189165">.</span><span class="ident" id="3189166">laddr</span><span class="op" id="3189171">.</span><span class="op" id="3189172">(</span><span class="keyword" id="3189173">type</span><span class="op" id="3189177">)</span>&nbsp;<span class="op" id="3189179">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3189182">case</span>&nbsp;<span class="op" id="3189187">*</span><span class="ident" id="3189188">UDPAddr</span><span class="op" id="3189195">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3189199">return</span>&nbsp;<span class="ident" id="3189206">newUDPConn</span><span class="op" id="3189216">(</span><span class="ident" id="3189217">fd</span><span class="op" id="3189219">)</span><span class="op" id="3189220">,</span>&nbsp;<span class="ident" id="3189222">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3189227">case</span>&nbsp;<span class="op" id="3189232">*</span><span class="ident" id="3189233">IPAddr</span><span class="op" id="3189239">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3189243">return</span>&nbsp;<span class="ident" id="3189250">newIPConn</span><span class="op" id="3189259">(</span><span class="ident" id="3189260">fd</span><span class="op" id="3189262">)</span><span class="op" id="3189263">,</span>&nbsp;<span class="ident" id="3189265">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3189270">case</span>&nbsp;<span class="op" id="3189275">*</span><span class="ident" id="3189276">UnixAddr</span><span class="op" id="3189284">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3189288">return</span>&nbsp;<span class="ident" id="3189295">newUnixConn</span><span class="op" id="3189306">(</span><span class="ident" id="3189307">fd</span><span class="op" id="3189309">)</span><span class="op" id="3189310">,</span>&nbsp;<span class="ident" id="3189312">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3189317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3189320">fd</span><span class="op" id="3189322">.</span><span class="ident" id="3189323">Close</span><span class="op" id="3189328">(</span><span class="op" id="3189329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3189332">return</span>&nbsp;<span class="ident" id="3189339">nil</span><span class="op" id="3189342">,</span>&nbsp;<span class="ident" id="3189344">syscall</span><span class="op" id="3189351">.</span><span class="ident" id="3189352">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3189359">}</span>
</div>
</body>
</html>
