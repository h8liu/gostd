<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4380729">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4380784">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4380838">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4380889">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="4380962">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="4380996">//</span><br>
<span class="lineno"></span><span class="comment" id="4380999">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4381068">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="4381120">package</span>&nbsp;<span class="ident" id="4381128">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4381134">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="4381214">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="4381290">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="4381366">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4381445">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="4381520">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4381592">//</span><br>
<span class="lineno"></span><span class="comment" id="4381595">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="4381666">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4381695">import</span>&nbsp;<span class="op" id="4381702">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4381705">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4381712">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4381724">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4381735">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4381746">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4381753">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4381756">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4381832">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="4381872">type</span>&nbsp;<span class="ident" id="4381877">StructuralError</span>&nbsp;<span class="keyword" id="4381893">struct</span>&nbsp;<span class="op" id="4381900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381903">Msg</span>&nbsp;<span class="builtintype" id="4381907">string</span><br>
<span class="lineno"></span><span class="op" id="4381914">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4381917">func</span>&nbsp;<span class="op" id="4381922">(</span><span class="ident" id="4381923">e</span>&nbsp;<span class="ident" id="4381925">StructuralError</span><span class="op" id="4381940">)</span>&nbsp;<span class="ident" id="4381942">Error</span><span class="op" id="4381947">(</span><span class="op" id="4381948">)</span>&nbsp;<span class="builtintype" id="4381950">string</span>&nbsp;<span class="op" id="4381957">{</span>&nbsp;<span class="keyword" id="4381959">return</span>&nbsp;<span class="string" id="4381966">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4381992">+</span>&nbsp;<span class="ident" id="4381994">e</span><span class="op" id="4381995">.</span><span class="ident" id="4381996">Msg</span>&nbsp;<span class="op" id="4382000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4382003">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="4382061">type</span>&nbsp;<span class="ident" id="4382066">SyntaxError</span>&nbsp;<span class="keyword" id="4382078">struct</span>&nbsp;<span class="op" id="4382085">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382088">Msg</span>&nbsp;<span class="builtintype" id="4382092">string</span><br>
<span class="lineno"></span><span class="op" id="4382099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4382102">func</span>&nbsp;<span class="op" id="4382107">(</span><span class="ident" id="4382108">e</span>&nbsp;<span class="ident" id="4382110">SyntaxError</span><span class="op" id="4382121">)</span>&nbsp;<span class="ident" id="4382123">Error</span><span class="op" id="4382128">(</span><span class="op" id="4382129">)</span>&nbsp;<span class="builtintype" id="4382131">string</span>&nbsp;<span class="op" id="4382138">{</span>&nbsp;<span class="keyword" id="4382140">return</span>&nbsp;<span class="string" id="4382147">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4382170">+</span>&nbsp;<span class="ident" id="4382172">e</span><span class="op" id="4382173">.</span><span class="ident" id="4382174">Msg</span>&nbsp;<span class="op" id="4382178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4382181">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4382247">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4382259">func</span>&nbsp;<span class="ident" id="4382264">parseBool</span><span class="op" id="4382273">(</span><span class="ident" id="4382274">bytes</span>&nbsp;<span class="op" id="4382280">[</span><span class="op" id="4382281">]</span><span class="builtintype" id="4382282">byte</span><span class="op" id="4382286">)</span>&nbsp;<span class="op" id="4382288">(</span><span class="ident" id="4382289">ret</span>&nbsp;<span class="builtintype" id="4382293">bool</span><span class="op" id="4382297">,</span>&nbsp;<span class="ident" id="4382299">err</span>&nbsp;<span class="builtintype" id="4382303">error</span><span class="op" id="4382308">)</span>&nbsp;<span class="op" id="4382310">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382313">if</span>&nbsp;<span class="builtinfunc" id="4382316">len</span><span class="op" id="4382319">(</span><span class="ident" id="4382320">bytes</span><span class="op" id="4382325">)</span>&nbsp;<span class="op" id="4382327">!=</span>&nbsp;<span class="num" id="4382330">1</span>&nbsp;<span class="op" id="4382332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382336">err</span>&nbsp;<span class="op" id="4382340">=</span>&nbsp;<span class="ident" id="4382342">SyntaxError</span><span class="op" id="4382353">{</span><span class="string" id="4382354">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4382371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382375">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382387">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382460">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382529">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382579">switch</span>&nbsp;<span class="ident" id="4382586">bytes</span><span class="op" id="4382591">[</span><span class="num" id="4382592">0</span><span class="op" id="4382593">]</span>&nbsp;<span class="op" id="4382595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382598">case</span>&nbsp;<span class="num" id="4382603">0</span><span class="op" id="4382604">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382608">ret</span>&nbsp;<span class="op" id="4382612">=</span>&nbsp;<span class="builtintype" id="4382614">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382621">case</span>&nbsp;<span class="num" id="4382626">0xff</span><span class="op" id="4382630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382634">ret</span>&nbsp;<span class="op" id="4382638">=</span>&nbsp;<span class="builtintype" id="4382640">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382646">default</span><span class="op" id="4382653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382657">err</span>&nbsp;<span class="op" id="4382661">=</span>&nbsp;<span class="ident" id="4382663">SyntaxError</span><span class="op" id="4382674">{</span><span class="string" id="4382675">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4382692">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382699">return</span><br>
<span class="lineno"></span><span class="op" id="4382706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4382709">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4382721">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4382794">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4382817">func</span>&nbsp;<span class="ident" id="4382822">parseInt64</span><span class="op" id="4382832">(</span><span class="ident" id="4382833">bytes</span>&nbsp;<span class="op" id="4382839">[</span><span class="op" id="4382840">]</span><span class="builtintype" id="4382841">byte</span><span class="op" id="4382845">)</span>&nbsp;<span class="op" id="4382847">(</span><span class="ident" id="4382848">ret</span>&nbsp;<span class="ident" id="4382852">int64</span><span class="op" id="4382857">,</span>&nbsp;<span class="ident" id="4382859">err</span>&nbsp;<span class="builtintype" id="4382863">error</span><span class="op" id="4382868">)</span>&nbsp;<span class="op" id="4382870">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382873">if</span>&nbsp;<span class="builtinfunc" id="4382876">len</span><span class="op" id="4382879">(</span><span class="ident" id="4382880">bytes</span><span class="op" id="4382885">)</span>&nbsp;<span class="op" id="4382887">&gt;</span>&nbsp;<span class="num" id="4382889">8</span>&nbsp;<span class="op" id="4382891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382895">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382938">err</span>&nbsp;<span class="op" id="4382942">=</span>&nbsp;<span class="ident" id="4382944">StructuralError</span><span class="op" id="4382959">{</span><span class="string" id="4382960">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4382979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382983">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382991">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382994">for</span>&nbsp;<span class="ident" id="4382998">bytesRead</span>&nbsp;<span class="op" id="4383008">:=</span>&nbsp;<span class="num" id="4383011">0</span><span class="op" id="4383012">;</span>&nbsp;<span class="ident" id="4383014">bytesRead</span>&nbsp;<span class="op" id="4383024">&lt;</span>&nbsp;<span class="builtinfunc" id="4383026">len</span><span class="op" id="4383029">(</span><span class="ident" id="4383030">bytes</span><span class="op" id="4383035">)</span><span class="op" id="4383036">;</span>&nbsp;<span class="ident" id="4383038">bytesRead</span><span class="op" id="4383047">++</span>&nbsp;<span class="op" id="4383050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383054">ret</span>&nbsp;<span class="op" id="4383058">&lt;&lt;=</span>&nbsp;<span class="num" id="4383062">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383066">ret</span>&nbsp;<span class="op" id="4383070">|=</span>&nbsp;<span class="ident" id="4383073">int64</span><span class="op" id="4383078">(</span><span class="ident" id="4383079">bytes</span><span class="op" id="4383084">[</span><span class="ident" id="4383085">bytesRead</span><span class="op" id="4383094">]</span><span class="op" id="4383095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4383098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383102">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383160">ret</span>&nbsp;<span class="op" id="4383164">&lt;&lt;=</span>&nbsp;<span class="num" id="4383168">64</span>&nbsp;<span class="op" id="4383171">-</span>&nbsp;<span class="builtintype" id="4383173">uint8</span><span class="op" id="4383178">(</span><span class="builtinfunc" id="4383179">len</span><span class="op" id="4383182">(</span><span class="ident" id="4383183">bytes</span><span class="op" id="4383188">)</span><span class="op" id="4383189">)</span><span class="op" id="4383190">*</span><span class="num" id="4383191">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383194">ret</span>&nbsp;<span class="op" id="4383198">&gt;&gt;=</span>&nbsp;<span class="num" id="4383202">64</span>&nbsp;<span class="op" id="4383205">-</span>&nbsp;<span class="builtintype" id="4383207">uint8</span><span class="op" id="4383212">(</span><span class="builtinfunc" id="4383213">len</span><span class="op" id="4383216">(</span><span class="ident" id="4383217">bytes</span><span class="op" id="4383222">)</span><span class="op" id="4383223">)</span><span class="op" id="4383224">*</span><span class="num" id="4383225">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383228">return</span><br>
<span class="lineno"></span><span class="op" id="4383235">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4383238">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4383317">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4383332">func</span>&nbsp;<span class="ident" id="4383337">parseInt32</span><span class="op" id="4383347">(</span><span class="ident" id="4383348">bytes</span>&nbsp;<span class="op" id="4383354">[</span><span class="op" id="4383355">]</span><span class="builtintype" id="4383356">byte</span><span class="op" id="4383360">)</span>&nbsp;<span class="op" id="4383362">(</span><span class="builtintype" id="4383363">int32</span><span class="op" id="4383368">,</span>&nbsp;<span class="builtintype" id="4383370">error</span><span class="op" id="4383375">)</span>&nbsp;<span class="op" id="4383377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383380">ret64</span><span class="op" id="4383385">,</span>&nbsp;<span class="ident" id="4383387">err</span>&nbsp;<span class="op" id="4383391">:=</span>&nbsp;<span class="ident" id="4383394">parseInt64</span><span class="op" id="4383404">(</span><span class="ident" id="4383405">bytes</span><span class="op" id="4383410">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383413">if</span>&nbsp;<span class="ident" id="4383416">err</span>&nbsp;<span class="op" id="4383420">!=</span>&nbsp;<span class="ident" id="4383423">nil</span>&nbsp;<span class="op" id="4383427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383431">return</span>&nbsp;<span class="num" id="4383438">0</span><span class="op" id="4383439">,</span>&nbsp;<span class="ident" id="4383441">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4383446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383449">if</span>&nbsp;<span class="ident" id="4383452">ret64</span>&nbsp;<span class="op" id="4383458">!=</span>&nbsp;<span class="ident" id="4383461">int64</span><span class="op" id="4383466">(</span><span class="builtintype" id="4383467">int32</span><span class="op" id="4383472">(</span><span class="ident" id="4383473">ret64</span><span class="op" id="4383478">)</span><span class="op" id="4383479">)</span>&nbsp;<span class="op" id="4383481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383485">return</span>&nbsp;<span class="num" id="4383492">0</span><span class="op" id="4383493">,</span>&nbsp;<span class="ident" id="4383495">StructuralError</span><span class="op" id="4383510">{</span><span class="string" id="4383511">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4383530">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4383533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383536">return</span>&nbsp;<span class="builtintype" id="4383543">int32</span><span class="op" id="4383548">(</span><span class="ident" id="4383549">ret64</span><span class="op" id="4383554">)</span><span class="op" id="4383555">,</span>&nbsp;<span class="ident" id="4383557">nil</span><br>
<span class="lineno"></span><span class="op" id="4383561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4383564">var</span>&nbsp;<span class="ident" id="4383568">bigOne</span>&nbsp;<span class="op" id="4383575">=</span>&nbsp;<span class="ident" id="4383577">big</span><span class="op" id="4383580">.</span><span class="ident" id="4383581">NewInt</span><span class="op" id="4383587">(</span><span class="num" id="4383588">1</span><span class="op" id="4383589">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4383592">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4383674">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4383689">func</span>&nbsp;<span class="ident" id="4383694">parseBigInt</span><span class="op" id="4383705">(</span><span class="ident" id="4383706">bytes</span>&nbsp;<span class="op" id="4383712">[</span><span class="op" id="4383713">]</span><span class="builtintype" id="4383714">byte</span><span class="op" id="4383718">)</span>&nbsp;<span class="op" id="4383720">*</span><span class="ident" id="4383721">big</span><span class="op" id="4383724">.</span><span class="ident" id="4383725">Int</span>&nbsp;<span class="op" id="4383729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383732">ret</span>&nbsp;<span class="op" id="4383736">:=</span>&nbsp;<span class="builtinfunc" id="4383739">new</span><span class="op" id="4383742">(</span><span class="ident" id="4383743">big</span><span class="op" id="4383746">.</span><span class="ident" id="4383747">Int</span><span class="op" id="4383750">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383753">if</span>&nbsp;<span class="builtinfunc" id="4383756">len</span><span class="op" id="4383759">(</span><span class="ident" id="4383760">bytes</span><span class="op" id="4383765">)</span>&nbsp;<span class="op" id="4383767">&gt;</span>&nbsp;<span class="num" id="4383769">0</span>&nbsp;<span class="op" id="4383771">&amp;&amp;</span>&nbsp;<span class="ident" id="4383774">bytes</span><span class="op" id="4383779">[</span><span class="num" id="4383780">0</span><span class="op" id="4383781">]</span><span class="op" id="4383782">&amp;</span><span class="num" id="4383783">0x80</span>&nbsp;<span class="op" id="4383788">==</span>&nbsp;<span class="num" id="4383791">0x80</span>&nbsp;<span class="op" id="4383796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383800">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383832">notBytes</span>&nbsp;<span class="op" id="4383841">:=</span>&nbsp;<span class="builtinfunc" id="4383844">make</span><span class="op" id="4383848">(</span><span class="op" id="4383849">[</span><span class="op" id="4383850">]</span><span class="builtintype" id="4383851">byte</span><span class="op" id="4383855">,</span>&nbsp;<span class="builtinfunc" id="4383857">len</span><span class="op" id="4383860">(</span><span class="ident" id="4383861">bytes</span><span class="op" id="4383866">)</span><span class="op" id="4383867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383871">for</span>&nbsp;<span class="ident" id="4383875">i</span>&nbsp;<span class="op" id="4383877">:=</span>&nbsp;<span class="keyword" id="4383880">range</span>&nbsp;<span class="ident" id="4383886">notBytes</span>&nbsp;<span class="op" id="4383895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383900">notBytes</span><span class="op" id="4383908">[</span><span class="ident" id="4383909">i</span><span class="op" id="4383910">]</span>&nbsp;<span class="op" id="4383912">=</span>&nbsp;<span class="op" id="4383914">^</span><span class="ident" id="4383915">bytes</span><span class="op" id="4383920">[</span><span class="ident" id="4383921">i</span><span class="op" id="4383922">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4383926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383930">ret</span><span class="op" id="4383933">.</span><span class="ident" id="4383934">SetBytes</span><span class="op" id="4383942">(</span><span class="ident" id="4383943">notBytes</span><span class="op" id="4383951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383955">ret</span><span class="op" id="4383958">.</span><span class="ident" id="4383959">Add</span><span class="op" id="4383962">(</span><span class="ident" id="4383963">ret</span><span class="op" id="4383966">,</span>&nbsp;<span class="ident" id="4383968">bigOne</span><span class="op" id="4383974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383978">ret</span><span class="op" id="4383981">.</span><span class="ident" id="4383982">Neg</span><span class="op" id="4383985">(</span><span class="ident" id="4383986">ret</span><span class="op" id="4383989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383993">return</span>&nbsp;<span class="ident" id="4384000">ret</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4384005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384008">ret</span><span class="op" id="4384011">.</span><span class="ident" id="4384012">SetBytes</span><span class="op" id="4384020">(</span><span class="ident" id="4384021">bytes</span><span class="op" id="4384026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384029">return</span>&nbsp;<span class="ident" id="4384036">ret</span><br>
<span class="lineno"></span><span class="op" id="4384040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4384043">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4384058">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="4384137">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4384212">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="4384266">type</span>&nbsp;<span class="ident" id="4384271">BitString</span>&nbsp;<span class="keyword" id="4384281">struct</span>&nbsp;<span class="op" id="4384288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384291">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4384301">[</span><span class="op" id="4384302">]</span><span class="builtintype" id="4384303">byte</span>&nbsp;<span class="comment" id="4384308">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384336">BitLength</span>&nbsp;<span class="builtintype" id="4384346">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4384353">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="4384372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4384375">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4384449">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="4384467">func</span>&nbsp;<span class="op" id="4384472">(</span><span class="ident" id="4384473">b</span>&nbsp;<span class="ident" id="4384475">BitString</span><span class="op" id="4384484">)</span>&nbsp;<span class="ident" id="4384486">At</span><span class="op" id="4384488">(</span><span class="ident" id="4384489">i</span>&nbsp;<span class="builtintype" id="4384491">int</span><span class="op" id="4384494">)</span>&nbsp;<span class="builtintype" id="4384496">int</span>&nbsp;<span class="op" id="4384500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384503">if</span>&nbsp;<span class="ident" id="4384506">i</span>&nbsp;<span class="op" id="4384508">&lt;</span>&nbsp;<span class="num" id="4384510">0</span>&nbsp;<span class="op" id="4384512">||</span>&nbsp;<span class="ident" id="4384515">i</span>&nbsp;<span class="op" id="4384517">&gt;=</span>&nbsp;<span class="ident" id="4384520">b</span><span class="op" id="4384521">.</span><span class="ident" id="4384522">BitLength</span>&nbsp;<span class="op" id="4384532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384536">return</span>&nbsp;<span class="num" id="4384543">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4384546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384549">x</span>&nbsp;<span class="op" id="4384551">:=</span>&nbsp;<span class="ident" id="4384554">i</span>&nbsp;<span class="op" id="4384556">/</span>&nbsp;<span class="num" id="4384558">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384561">y</span>&nbsp;<span class="op" id="4384563">:=</span>&nbsp;<span class="num" id="4384566">7</span>&nbsp;<span class="op" id="4384568">-</span>&nbsp;<span class="builtintype" id="4384570">uint</span><span class="op" id="4384574">(</span><span class="ident" id="4384575">i</span><span class="op" id="4384576">%</span><span class="num" id="4384577">8</span><span class="op" id="4384578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384581">return</span>&nbsp;<span class="builtintype" id="4384588">int</span><span class="op" id="4384591">(</span><span class="ident" id="4384592">b</span><span class="op" id="4384593">.</span><span class="ident" id="4384594">Bytes</span><span class="op" id="4384599">[</span><span class="ident" id="4384600">x</span><span class="op" id="4384601">]</span><span class="op" id="4384602">&gt;&gt;</span><span class="ident" id="4384604">y</span><span class="op" id="4384605">)</span>&nbsp;<span class="op" id="4384607">&amp;</span>&nbsp;<span class="num" id="4384609">1</span><br>
<span class="lineno"></span><span class="op" id="4384611">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4384614">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4384693">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="4384739">func</span>&nbsp;<span class="op" id="4384744">(</span><span class="ident" id="4384745">b</span>&nbsp;<span class="ident" id="4384747">BitString</span><span class="op" id="4384756">)</span>&nbsp;<span class="ident" id="4384758">RightAlign</span><span class="op" id="4384768">(</span><span class="op" id="4384769">)</span>&nbsp;<span class="op" id="4384771">[</span><span class="op" id="4384772">]</span><span class="builtintype" id="4384773">byte</span>&nbsp;<span class="op" id="4384778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384781">shift</span>&nbsp;<span class="op" id="4384787">:=</span>&nbsp;<span class="builtintype" id="4384790">uint</span><span class="op" id="4384794">(</span><span class="num" id="4384795">8</span>&nbsp;<span class="op" id="4384797">-</span>&nbsp;<span class="op" id="4384799">(</span><span class="ident" id="4384800">b</span><span class="op" id="4384801">.</span><span class="ident" id="4384802">BitLength</span>&nbsp;<span class="op" id="4384812">%</span>&nbsp;<span class="num" id="4384814">8</span><span class="op" id="4384815">)</span><span class="op" id="4384816">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384819">if</span>&nbsp;<span class="ident" id="4384822">shift</span>&nbsp;<span class="op" id="4384828">==</span>&nbsp;<span class="num" id="4384831">8</span>&nbsp;<span class="op" id="4384833">||</span>&nbsp;<span class="builtinfunc" id="4384836">len</span><span class="op" id="4384839">(</span><span class="ident" id="4384840">b</span><span class="op" id="4384841">.</span><span class="ident" id="4384842">Bytes</span><span class="op" id="4384847">)</span>&nbsp;<span class="op" id="4384849">==</span>&nbsp;<span class="num" id="4384852">0</span>&nbsp;<span class="op" id="4384854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384858">return</span>&nbsp;<span class="ident" id="4384865">b</span><span class="op" id="4384866">.</span><span class="ident" id="4384867">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4384874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384878">a</span>&nbsp;<span class="op" id="4384880">:=</span>&nbsp;<span class="builtinfunc" id="4384883">make</span><span class="op" id="4384887">(</span><span class="op" id="4384888">[</span><span class="op" id="4384889">]</span><span class="builtintype" id="4384890">byte</span><span class="op" id="4384894">,</span>&nbsp;<span class="builtinfunc" id="4384896">len</span><span class="op" id="4384899">(</span><span class="ident" id="4384900">b</span><span class="op" id="4384901">.</span><span class="ident" id="4384902">Bytes</span><span class="op" id="4384907">)</span><span class="op" id="4384908">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384911">a</span><span class="op" id="4384912">[</span><span class="num" id="4384913">0</span><span class="op" id="4384914">]</span>&nbsp;<span class="op" id="4384916">=</span>&nbsp;<span class="ident" id="4384918">b</span><span class="op" id="4384919">.</span><span class="ident" id="4384920">Bytes</span><span class="op" id="4384925">[</span><span class="num" id="4384926">0</span><span class="op" id="4384927">]</span>&nbsp;<span class="op" id="4384929">&gt;&gt;</span>&nbsp;<span class="ident" id="4384932">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384939">for</span>&nbsp;<span class="ident" id="4384943">i</span>&nbsp;<span class="op" id="4384945">:=</span>&nbsp;<span class="num" id="4384948">1</span><span class="op" id="4384949">;</span>&nbsp;<span class="ident" id="4384951">i</span>&nbsp;<span class="op" id="4384953">&lt;</span>&nbsp;<span class="builtinfunc" id="4384955">len</span><span class="op" id="4384958">(</span><span class="ident" id="4384959">b</span><span class="op" id="4384960">.</span><span class="ident" id="4384961">Bytes</span><span class="op" id="4384966">)</span><span class="op" id="4384967">;</span>&nbsp;<span class="ident" id="4384969">i</span><span class="op" id="4384970">++</span>&nbsp;<span class="op" id="4384973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384977">a</span><span class="op" id="4384978">[</span><span class="ident" id="4384979">i</span><span class="op" id="4384980">]</span>&nbsp;<span class="op" id="4384982">=</span>&nbsp;<span class="ident" id="4384984">b</span><span class="op" id="4384985">.</span><span class="ident" id="4384986">Bytes</span><span class="op" id="4384991">[</span><span class="ident" id="4384992">i</span><span class="op" id="4384993">-</span><span class="num" id="4384994">1</span><span class="op" id="4384995">]</span>&nbsp;<span class="op" id="4384997">&lt;&lt;</span>&nbsp;<span class="op" id="4385000">(</span><span class="num" id="4385001">8</span>&nbsp;<span class="op" id="4385003">-</span>&nbsp;<span class="ident" id="4385005">shift</span><span class="op" id="4385010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385014">a</span><span class="op" id="4385015">[</span><span class="ident" id="4385016">i</span><span class="op" id="4385017">]</span>&nbsp;<span class="op" id="4385019">|=</span>&nbsp;<span class="ident" id="4385022">b</span><span class="op" id="4385023">.</span><span class="ident" id="4385024">Bytes</span><span class="op" id="4385029">[</span><span class="ident" id="4385030">i</span><span class="op" id="4385031">]</span>&nbsp;<span class="op" id="4385033">&gt;&gt;</span>&nbsp;<span class="ident" id="4385036">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385043">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385047">return</span>&nbsp;<span class="ident" id="4385054">a</span><br>
<span class="lineno"></span><span class="op" id="4385056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4385059">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="4385146">func</span>&nbsp;<span class="ident" id="4385151">parseBitString</span><span class="op" id="4385165">(</span><span class="ident" id="4385166">bytes</span>&nbsp;<span class="op" id="4385172">[</span><span class="op" id="4385173">]</span><span class="builtintype" id="4385174">byte</span><span class="op" id="4385178">)</span>&nbsp;<span class="op" id="4385180">(</span><span class="ident" id="4385181">ret</span>&nbsp;<span class="ident" id="4385185">BitString</span><span class="op" id="4385194">,</span>&nbsp;<span class="ident" id="4385196">err</span>&nbsp;<span class="builtintype" id="4385200">error</span><span class="op" id="4385205">)</span>&nbsp;<span class="op" id="4385207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385210">if</span>&nbsp;<span class="builtinfunc" id="4385213">len</span><span class="op" id="4385216">(</span><span class="ident" id="4385217">bytes</span><span class="op" id="4385222">)</span>&nbsp;<span class="op" id="4385224">==</span>&nbsp;<span class="num" id="4385227">0</span>&nbsp;<span class="op" id="4385229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385233">err</span>&nbsp;<span class="op" id="4385237">=</span>&nbsp;<span class="ident" id="4385239">SyntaxError</span><span class="op" id="4385250">{</span><span class="string" id="4385251">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4385275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385279">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385287">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385290">paddingBits</span>&nbsp;<span class="op" id="4385302">:=</span>&nbsp;<span class="builtintype" id="4385305">int</span><span class="op" id="4385308">(</span><span class="ident" id="4385309">bytes</span><span class="op" id="4385314">[</span><span class="num" id="4385315">0</span><span class="op" id="4385316">]</span><span class="op" id="4385317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385320">if</span>&nbsp;<span class="ident" id="4385323">paddingBits</span>&nbsp;<span class="op" id="4385335">&gt;</span>&nbsp;<span class="num" id="4385337">7</span>&nbsp;<span class="op" id="4385339">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4385344">len</span><span class="op" id="4385347">(</span><span class="ident" id="4385348">bytes</span><span class="op" id="4385353">)</span>&nbsp;<span class="op" id="4385355">==</span>&nbsp;<span class="num" id="4385358">1</span>&nbsp;<span class="op" id="4385360">&amp;&amp;</span>&nbsp;<span class="ident" id="4385363">paddingBits</span>&nbsp;<span class="op" id="4385375">&gt;</span>&nbsp;<span class="num" id="4385377">0</span>&nbsp;<span class="op" id="4385379">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385384">bytes</span><span class="op" id="4385389">[</span><span class="builtinfunc" id="4385390">len</span><span class="op" id="4385393">(</span><span class="ident" id="4385394">bytes</span><span class="op" id="4385399">)</span><span class="op" id="4385400">-</span><span class="num" id="4385401">1</span><span class="op" id="4385402">]</span><span class="op" id="4385403">&amp;</span><span class="op" id="4385404">(</span><span class="op" id="4385405">(</span><span class="num" id="4385406">1</span><span class="op" id="4385407">&lt;&lt;</span><span class="ident" id="4385409">bytes</span><span class="op" id="4385414">[</span><span class="num" id="4385415">0</span><span class="op" id="4385416">]</span><span class="op" id="4385417">)</span><span class="op" id="4385418">-</span><span class="num" id="4385419">1</span><span class="op" id="4385420">)</span>&nbsp;<span class="op" id="4385422">!=</span>&nbsp;<span class="num" id="4385425">0</span>&nbsp;<span class="op" id="4385427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385431">err</span>&nbsp;<span class="op" id="4385435">=</span>&nbsp;<span class="ident" id="4385437">SyntaxError</span><span class="op" id="4385448">{</span><span class="string" id="4385449">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4385485">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385489">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385500">ret</span><span class="op" id="4385503">.</span><span class="ident" id="4385504">BitLength</span>&nbsp;<span class="op" id="4385514">=</span>&nbsp;<span class="op" id="4385516">(</span><span class="builtinfunc" id="4385517">len</span><span class="op" id="4385520">(</span><span class="ident" id="4385521">bytes</span><span class="op" id="4385526">)</span><span class="op" id="4385527">-</span><span class="num" id="4385528">1</span><span class="op" id="4385529">)</span><span class="op" id="4385530">*</span><span class="num" id="4385531">8</span>&nbsp;<span class="op" id="4385533">-</span>&nbsp;<span class="ident" id="4385535">paddingBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385548">ret</span><span class="op" id="4385551">.</span><span class="ident" id="4385552">Bytes</span>&nbsp;<span class="op" id="4385558">=</span>&nbsp;<span class="ident" id="4385560">bytes</span><span class="op" id="4385565">[</span><span class="num" id="4385566">1</span><span class="op" id="4385567">:</span><span class="op" id="4385568">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385571">return</span><br>
<span class="lineno">180</span><span class="op" id="4385578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4385581">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4385603">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="4385665">type</span>&nbsp;<span class="ident" id="4385670">ObjectIdentifier</span>&nbsp;<span class="op" id="4385687">[</span><span class="op" id="4385688">]</span><span class="builtintype" id="4385689">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4385694">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="4385763">func</span>&nbsp;<span class="op" id="4385768">(</span><span class="ident" id="4385769">oi</span>&nbsp;<span class="ident" id="4385772">ObjectIdentifier</span><span class="op" id="4385788">)</span>&nbsp;<span class="ident" id="4385790">Equal</span><span class="op" id="4385795">(</span><span class="ident" id="4385796">other</span>&nbsp;<span class="ident" id="4385802">ObjectIdentifier</span><span class="op" id="4385818">)</span>&nbsp;<span class="builtintype" id="4385820">bool</span>&nbsp;<span class="op" id="4385825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385828">if</span>&nbsp;<span class="builtinfunc" id="4385831">len</span><span class="op" id="4385834">(</span><span class="ident" id="4385835">oi</span><span class="op" id="4385837">)</span>&nbsp;<span class="op" id="4385839">!=</span>&nbsp;<span class="builtinfunc" id="4385842">len</span><span class="op" id="4385845">(</span><span class="ident" id="4385846">other</span><span class="op" id="4385851">)</span>&nbsp;<span class="op" id="4385853">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385857">return</span>&nbsp;<span class="builtintype" id="4385864">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385874">for</span>&nbsp;<span class="ident" id="4385878">i</span>&nbsp;<span class="op" id="4385880">:=</span>&nbsp;<span class="num" id="4385883">0</span><span class="op" id="4385884">;</span>&nbsp;<span class="ident" id="4385886">i</span>&nbsp;<span class="op" id="4385888">&lt;</span>&nbsp;<span class="builtinfunc" id="4385890">len</span><span class="op" id="4385893">(</span><span class="ident" id="4385894">oi</span><span class="op" id="4385896">)</span><span class="op" id="4385897">;</span>&nbsp;<span class="ident" id="4385899">i</span><span class="op" id="4385900">++</span>&nbsp;<span class="op" id="4385903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385907">if</span>&nbsp;<span class="ident" id="4385910">oi</span><span class="op" id="4385912">[</span><span class="ident" id="4385913">i</span><span class="op" id="4385914">]</span>&nbsp;<span class="op" id="4385916">!=</span>&nbsp;<span class="ident" id="4385919">other</span><span class="op" id="4385924">[</span><span class="ident" id="4385925">i</span><span class="op" id="4385926">]</span>&nbsp;<span class="op" id="4385928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385933">return</span>&nbsp;<span class="builtintype" id="4385940">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385955">return</span>&nbsp;<span class="builtintype" id="4385962">true</span><br>
<span class="lineno"></span><span class="op" id="4385967">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4385970">func</span>&nbsp;<span class="op" id="4385975">(</span><span class="ident" id="4385976">oi</span>&nbsp;<span class="ident" id="4385979">ObjectIdentifier</span><span class="op" id="4385995">)</span>&nbsp;<span class="ident" id="4385997">String</span><span class="op" id="4386003">(</span><span class="op" id="4386004">)</span>&nbsp;<span class="builtintype" id="4386006">string</span>&nbsp;<span class="op" id="4386013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386016">var</span>&nbsp;<span class="ident" id="4386020">s</span>&nbsp;<span class="builtintype" id="4386022">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386031">for</span>&nbsp;<span class="ident" id="4386035">i</span><span class="op" id="4386036">,</span>&nbsp;<span class="ident" id="4386038">v</span>&nbsp;<span class="op" id="4386040">:=</span>&nbsp;<span class="keyword" id="4386043">range</span>&nbsp;<span class="ident" id="4386049">oi</span>&nbsp;<span class="op" id="4386052">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386056">if</span>&nbsp;<span class="ident" id="4386059">i</span>&nbsp;<span class="op" id="4386061">&gt;</span>&nbsp;<span class="num" id="4386063">0</span>&nbsp;<span class="op" id="4386065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386070">s</span>&nbsp;<span class="op" id="4386072">+=</span>&nbsp;<span class="string" id="4386075">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386085">s</span>&nbsp;<span class="op" id="4386087">+=</span>&nbsp;<span class="ident" id="4386090">strconv</span><span class="op" id="4386097">.</span><span class="ident" id="4386098">Itoa</span><span class="op" id="4386102">(</span><span class="ident" id="4386103">v</span><span class="op" id="4386104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386107">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386111">return</span>&nbsp;<span class="ident" id="4386118">s</span><br>
<span class="lineno"></span><span class="op" id="4386120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4386123">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="4386201">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="4386279">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="4386316">func</span>&nbsp;<span class="ident" id="4386321">parseObjectIdentifier</span><span class="op" id="4386342">(</span><span class="ident" id="4386343">bytes</span>&nbsp;<span class="op" id="4386349">[</span><span class="op" id="4386350">]</span><span class="builtintype" id="4386351">byte</span><span class="op" id="4386355">)</span>&nbsp;<span class="op" id="4386357">(</span><span class="ident" id="4386358">s</span>&nbsp;<span class="op" id="4386360">[</span><span class="op" id="4386361">]</span><span class="builtintype" id="4386362">int</span><span class="op" id="4386365">,</span>&nbsp;<span class="ident" id="4386367">err</span>&nbsp;<span class="builtintype" id="4386371">error</span><span class="op" id="4386376">)</span>&nbsp;<span class="op" id="4386378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386381">if</span>&nbsp;<span class="builtinfunc" id="4386384">len</span><span class="op" id="4386387">(</span><span class="ident" id="4386388">bytes</span><span class="op" id="4386393">)</span>&nbsp;<span class="op" id="4386395">==</span>&nbsp;<span class="num" id="4386398">0</span>&nbsp;<span class="op" id="4386400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386404">err</span>&nbsp;<span class="op" id="4386408">=</span>&nbsp;<span class="ident" id="4386410">SyntaxError</span><span class="op" id="4386421">{</span><span class="string" id="4386422">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="4386453">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386457">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386469">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386542">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386612">s</span>&nbsp;<span class="op" id="4386614">=</span>&nbsp;<span class="builtinfunc" id="4386616">make</span><span class="op" id="4386620">(</span><span class="op" id="4386621">[</span><span class="op" id="4386622">]</span><span class="builtintype" id="4386623">int</span><span class="op" id="4386626">,</span>&nbsp;<span class="builtinfunc" id="4386628">len</span><span class="op" id="4386631">(</span><span class="ident" id="4386632">bytes</span><span class="op" id="4386637">)</span><span class="op" id="4386638">+</span><span class="num" id="4386639">1</span><span class="op" id="4386640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386644">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386688">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386763">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386837">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386883">v</span><span class="op" id="4386884">,</span>&nbsp;<span class="ident" id="4386886">offset</span><span class="op" id="4386892">,</span>&nbsp;<span class="ident" id="4386894">err</span>&nbsp;<span class="op" id="4386898">:=</span>&nbsp;<span class="ident" id="4386901">parseBase128Int</span><span class="op" id="4386916">(</span><span class="ident" id="4386917">bytes</span><span class="op" id="4386922">,</span>&nbsp;<span class="num" id="4386924">0</span><span class="op" id="4386925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386928">if</span>&nbsp;<span class="ident" id="4386931">err</span>&nbsp;<span class="op" id="4386935">!=</span>&nbsp;<span class="ident" id="4386938">nil</span>&nbsp;<span class="op" id="4386942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386946">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386954">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386957">if</span>&nbsp;<span class="ident" id="4386960">v</span>&nbsp;<span class="op" id="4386962">&lt;</span>&nbsp;<span class="num" id="4386964">80</span>&nbsp;<span class="op" id="4386967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386971">s</span><span class="op" id="4386972">[</span><span class="num" id="4386973">0</span><span class="op" id="4386974">]</span>&nbsp;<span class="op" id="4386976">=</span>&nbsp;<span class="ident" id="4386978">v</span>&nbsp;<span class="op" id="4386980">/</span>&nbsp;<span class="num" id="4386982">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386987">s</span><span class="op" id="4386988">[</span><span class="num" id="4386989">1</span><span class="op" id="4386990">]</span>&nbsp;<span class="op" id="4386992">=</span>&nbsp;<span class="ident" id="4386994">v</span>&nbsp;<span class="op" id="4386996">%</span>&nbsp;<span class="num" id="4386998">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387002">}</span>&nbsp;<span class="keyword" id="4387004">else</span>&nbsp;<span class="op" id="4387009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387013">s</span><span class="op" id="4387014">[</span><span class="num" id="4387015">0</span><span class="op" id="4387016">]</span>&nbsp;<span class="op" id="4387018">=</span>&nbsp;<span class="num" id="4387020">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387024">s</span><span class="op" id="4387025">[</span><span class="num" id="4387026">1</span><span class="op" id="4387027">]</span>&nbsp;<span class="op" id="4387029">=</span>&nbsp;<span class="ident" id="4387031">v</span>&nbsp;<span class="op" id="4387033">-</span>&nbsp;<span class="num" id="4387035">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387043">i</span>&nbsp;<span class="op" id="4387045">:=</span>&nbsp;<span class="num" id="4387048">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387051">for</span>&nbsp;<span class="op" id="4387055">;</span>&nbsp;<span class="ident" id="4387057">offset</span>&nbsp;<span class="op" id="4387064">&lt;</span>&nbsp;<span class="builtinfunc" id="4387066">len</span><span class="op" id="4387069">(</span><span class="ident" id="4387070">bytes</span><span class="op" id="4387075">)</span><span class="op" id="4387076">;</span>&nbsp;<span class="ident" id="4387078">i</span><span class="op" id="4387079">++</span>&nbsp;<span class="op" id="4387082">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387086">v</span><span class="op" id="4387087">,</span>&nbsp;<span class="ident" id="4387089">offset</span><span class="op" id="4387095">,</span>&nbsp;<span class="ident" id="4387097">err</span>&nbsp;<span class="op" id="4387101">=</span>&nbsp;<span class="ident" id="4387103">parseBase128Int</span><span class="op" id="4387118">(</span><span class="ident" id="4387119">bytes</span><span class="op" id="4387124">,</span>&nbsp;<span class="ident" id="4387126">offset</span><span class="op" id="4387132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387136">if</span>&nbsp;<span class="ident" id="4387139">err</span>&nbsp;<span class="op" id="4387143">!=</span>&nbsp;<span class="ident" id="4387146">nil</span>&nbsp;<span class="op" id="4387150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387155">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387168">s</span><span class="op" id="4387169">[</span><span class="ident" id="4387170">i</span><span class="op" id="4387171">]</span>&nbsp;<span class="op" id="4387173">=</span>&nbsp;<span class="ident" id="4387175">v</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387181">s</span>&nbsp;<span class="op" id="4387183">=</span>&nbsp;<span class="ident" id="4387185">s</span><span class="op" id="4387186">[</span><span class="num" id="4387187">0</span><span class="op" id="4387188">:</span><span class="ident" id="4387189">i</span><span class="op" id="4387190">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387193">return</span><br>
<span class="lineno"></span><span class="op" id="4387200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4387203">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4387218">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="4387266">type</span>&nbsp;<span class="ident" id="4387271">Enumerated</span>&nbsp;<span class="builtintype" id="4387282">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="4387287">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4387296">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="4387354">type</span>&nbsp;<span class="ident" id="4387359">Flag</span>&nbsp;<span class="builtintype" id="4387364">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="4387370">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4387448">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="4387510">func</span>&nbsp;<span class="ident" id="4387515">parseBase128Int</span><span class="op" id="4387530">(</span><span class="ident" id="4387531">bytes</span>&nbsp;<span class="op" id="4387537">[</span><span class="op" id="4387538">]</span><span class="builtintype" id="4387539">byte</span><span class="op" id="4387543">,</span>&nbsp;<span class="ident" id="4387545">initOffset</span>&nbsp;<span class="builtintype" id="4387556">int</span><span class="op" id="4387559">)</span>&nbsp;<span class="op" id="4387561">(</span><span class="ident" id="4387562">ret</span><span class="op" id="4387565">,</span>&nbsp;<span class="ident" id="4387567">offset</span>&nbsp;<span class="builtintype" id="4387574">int</span><span class="op" id="4387577">,</span>&nbsp;<span class="ident" id="4387579">err</span>&nbsp;<span class="builtintype" id="4387583">error</span><span class="op" id="4387588">)</span>&nbsp;<span class="op" id="4387590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387593">offset</span>&nbsp;<span class="op" id="4387600">=</span>&nbsp;<span class="ident" id="4387602">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387614">for</span>&nbsp;<span class="ident" id="4387618">shifted</span>&nbsp;<span class="op" id="4387626">:=</span>&nbsp;<span class="num" id="4387629">0</span><span class="op" id="4387630">;</span>&nbsp;<span class="ident" id="4387632">offset</span>&nbsp;<span class="op" id="4387639">&lt;</span>&nbsp;<span class="builtinfunc" id="4387641">len</span><span class="op" id="4387644">(</span><span class="ident" id="4387645">bytes</span><span class="op" id="4387650">)</span><span class="op" id="4387651">;</span>&nbsp;<span class="ident" id="4387653">shifted</span><span class="op" id="4387660">++</span>&nbsp;<span class="op" id="4387663">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387667">if</span>&nbsp;<span class="ident" id="4387670">shifted</span>&nbsp;<span class="op" id="4387678">&gt;</span>&nbsp;<span class="num" id="4387680">4</span>&nbsp;<span class="op" id="4387682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387687">err</span>&nbsp;<span class="op" id="4387691">=</span>&nbsp;<span class="ident" id="4387693">StructuralError</span><span class="op" id="4387708">{</span><span class="string" id="4387709">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4387737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387742">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387755">ret</span>&nbsp;<span class="op" id="4387759">&lt;&lt;=</span>&nbsp;<span class="num" id="4387763">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387767">b</span>&nbsp;<span class="op" id="4387769">:=</span>&nbsp;<span class="ident" id="4387772">bytes</span><span class="op" id="4387777">[</span><span class="ident" id="4387778">offset</span><span class="op" id="4387784">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387788">ret</span>&nbsp;<span class="op" id="4387792">|=</span>&nbsp;<span class="builtintype" id="4387795">int</span><span class="op" id="4387798">(</span><span class="ident" id="4387799">b</span>&nbsp;<span class="op" id="4387801">&amp;</span>&nbsp;<span class="num" id="4387803">0x7f</span><span class="op" id="4387807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387811">offset</span><span class="op" id="4387817">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387822">if</span>&nbsp;<span class="ident" id="4387825">b</span><span class="op" id="4387826">&amp;</span><span class="num" id="4387827">0x80</span>&nbsp;<span class="op" id="4387832">==</span>&nbsp;<span class="num" id="4387835">0</span>&nbsp;<span class="op" id="4387837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387842">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387857">err</span>&nbsp;<span class="op" id="4387861">=</span>&nbsp;<span class="ident" id="4387863">SyntaxError</span><span class="op" id="4387874">{</span><span class="string" id="4387875">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="4387903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387906">return</span><br>
<span class="lineno"></span><span class="op" id="4387913">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4387916">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4387928">func</span>&nbsp;<span class="ident" id="4387933">parseUTCTime</span><span class="op" id="4387945">(</span><span class="ident" id="4387946">bytes</span>&nbsp;<span class="op" id="4387952">[</span><span class="op" id="4387953">]</span><span class="builtintype" id="4387954">byte</span><span class="op" id="4387958">)</span>&nbsp;<span class="op" id="4387960">(</span><span class="ident" id="4387961">ret</span>&nbsp;<span class="ident" id="4387965">time</span><span class="op" id="4387969">.</span><span class="ident" id="4387970">Time</span><span class="op" id="4387974">,</span>&nbsp;<span class="ident" id="4387976">err</span>&nbsp;<span class="builtintype" id="4387980">error</span><span class="op" id="4387985">)</span>&nbsp;<span class="op" id="4387987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387990">s</span>&nbsp;<span class="op" id="4387992">:=</span>&nbsp;<span class="builtintype" id="4387995">string</span><span class="op" id="4388001">(</span><span class="ident" id="4388002">bytes</span><span class="op" id="4388007">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388010">ret</span><span class="op" id="4388013">,</span>&nbsp;<span class="ident" id="4388015">err</span>&nbsp;<span class="op" id="4388019">=</span>&nbsp;<span class="ident" id="4388021">time</span><span class="op" id="4388025">.</span><span class="ident" id="4388026">Parse</span><span class="op" id="4388031">(</span><span class="string" id="4388032">&#34;0601021504Z0700&#34;</span><span class="op" id="4388049">,</span>&nbsp;<span class="ident" id="4388051">s</span><span class="op" id="4388052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388055">if</span>&nbsp;<span class="ident" id="4388058">err</span>&nbsp;<span class="op" id="4388062">!=</span>&nbsp;<span class="ident" id="4388065">nil</span>&nbsp;<span class="op" id="4388069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388073">ret</span><span class="op" id="4388076">,</span>&nbsp;<span class="ident" id="4388078">err</span>&nbsp;<span class="op" id="4388082">=</span>&nbsp;<span class="ident" id="4388084">time</span><span class="op" id="4388088">.</span><span class="ident" id="4388089">Parse</span><span class="op" id="4388094">(</span><span class="string" id="4388095">&#34;060102150405Z0700&#34;</span><span class="op" id="4388114">,</span>&nbsp;<span class="ident" id="4388116">s</span><span class="op" id="4388117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388123">if</span>&nbsp;<span class="ident" id="4388126">err</span>&nbsp;<span class="op" id="4388130">==</span>&nbsp;<span class="ident" id="4388133">nil</span>&nbsp;<span class="op" id="4388137">&amp;&amp;</span>&nbsp;<span class="ident" id="4388140">ret</span><span class="op" id="4388143">.</span><span class="ident" id="4388144">Year</span><span class="op" id="4388148">(</span><span class="op" id="4388149">)</span>&nbsp;<span class="op" id="4388151">&gt;=</span>&nbsp;<span class="num" id="4388154">2050</span>&nbsp;<span class="op" id="4388159">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4388163">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388268">ret</span>&nbsp;<span class="op" id="4388272">=</span>&nbsp;<span class="ident" id="4388274">ret</span><span class="op" id="4388277">.</span><span class="ident" id="4388278">AddDate</span><span class="op" id="4388285">(</span><span class="op" id="4388286">-</span><span class="num" id="4388287">100</span><span class="op" id="4388290">,</span>&nbsp;<span class="num" id="4388292">0</span><span class="op" id="4388293">,</span>&nbsp;<span class="num" id="4388295">0</span><span class="op" id="4388296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388303">return</span><br>
<span class="lineno">300</span><span class="op" id="4388310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4388313">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4388390">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4388425">func</span>&nbsp;<span class="ident" id="4388430">parseGeneralizedTime</span><span class="op" id="4388450">(</span><span class="ident" id="4388451">bytes</span>&nbsp;<span class="op" id="4388457">[</span><span class="op" id="4388458">]</span><span class="builtintype" id="4388459">byte</span><span class="op" id="4388463">)</span>&nbsp;<span class="op" id="4388465">(</span><span class="ident" id="4388466">ret</span>&nbsp;<span class="ident" id="4388470">time</span><span class="op" id="4388474">.</span><span class="ident" id="4388475">Time</span><span class="op" id="4388479">,</span>&nbsp;<span class="ident" id="4388481">err</span>&nbsp;<span class="builtintype" id="4388485">error</span><span class="op" id="4388490">)</span>&nbsp;<span class="op" id="4388492">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388495">return</span>&nbsp;<span class="ident" id="4388502">time</span><span class="op" id="4388506">.</span><span class="ident" id="4388507">Parse</span><span class="op" id="4388512">(</span><span class="string" id="4388513">&#34;20060102150405Z0700&#34;</span><span class="op" id="4388534">,</span>&nbsp;<span class="builtintype" id="4388536">string</span><span class="op" id="4388542">(</span><span class="ident" id="4388543">bytes</span><span class="op" id="4388548">)</span><span class="op" id="4388549">)</span><br>
<span class="lineno"></span><span class="op" id="4388551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4388554">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4388574">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4388649">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4388674">func</span>&nbsp;<span class="ident" id="4388679">parsePrintableString</span><span class="op" id="4388699">(</span><span class="ident" id="4388700">bytes</span>&nbsp;<span class="op" id="4388706">[</span><span class="op" id="4388707">]</span><span class="builtintype" id="4388708">byte</span><span class="op" id="4388712">)</span>&nbsp;<span class="op" id="4388714">(</span><span class="ident" id="4388715">ret</span>&nbsp;<span class="builtintype" id="4388719">string</span><span class="op" id="4388725">,</span>&nbsp;<span class="ident" id="4388727">err</span>&nbsp;<span class="builtintype" id="4388731">error</span><span class="op" id="4388736">)</span>&nbsp;<span class="op" id="4388738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388741">for</span>&nbsp;<span class="ident" id="4388745">_</span><span class="op" id="4388746">,</span>&nbsp;<span class="ident" id="4388748">b</span>&nbsp;<span class="op" id="4388750">:=</span>&nbsp;<span class="keyword" id="4388753">range</span>&nbsp;<span class="ident" id="4388759">bytes</span>&nbsp;<span class="op" id="4388765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388769">if</span>&nbsp;<span class="op" id="4388772">!</span><span class="ident" id="4388773">isPrintable</span><span class="op" id="4388784">(</span><span class="ident" id="4388785">b</span><span class="op" id="4388786">)</span>&nbsp;<span class="op" id="4388788">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388793">err</span>&nbsp;<span class="op" id="4388797">=</span>&nbsp;<span class="ident" id="4388799">SyntaxError</span><span class="op" id="4388810">{</span><span class="string" id="4388811">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4388855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388860">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388875">ret</span>&nbsp;<span class="op" id="4388879">=</span>&nbsp;<span class="builtintype" id="4388881">string</span><span class="op" id="4388887">(</span><span class="ident" id="4388888">bytes</span><span class="op" id="4388893">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388896">return</span><br>
<span class="lineno"></span><span class="op" id="4388903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4388906">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="4388987">func</span>&nbsp;<span class="ident" id="4388992">isPrintable</span><span class="op" id="4389003">(</span><span class="ident" id="4389004">b</span>&nbsp;<span class="builtintype" id="4389006">byte</span><span class="op" id="4389010">)</span>&nbsp;<span class="builtintype" id="4389012">bool</span>&nbsp;<span class="op" id="4389017">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389020">return</span>&nbsp;<span class="string" id="4389027">&#39;a&#39;</span>&nbsp;<span class="op" id="4389031">&lt;=</span>&nbsp;<span class="ident" id="4389034">b</span>&nbsp;<span class="op" id="4389036">&amp;&amp;</span>&nbsp;<span class="ident" id="4389039">b</span>&nbsp;<span class="op" id="4389041">&lt;=</span>&nbsp;<span class="string" id="4389044">&#39;z&#39;</span>&nbsp;<span class="op" id="4389048">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4389053">&#39;A&#39;</span>&nbsp;<span class="op" id="4389057">&lt;=</span>&nbsp;<span class="ident" id="4389060">b</span>&nbsp;<span class="op" id="4389062">&amp;&amp;</span>&nbsp;<span class="ident" id="4389065">b</span>&nbsp;<span class="op" id="4389067">&lt;=</span>&nbsp;<span class="string" id="4389070">&#39;Z&#39;</span>&nbsp;<span class="op" id="4389074">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4389079">&#39;0&#39;</span>&nbsp;<span class="op" id="4389083">&lt;=</span>&nbsp;<span class="ident" id="4389086">b</span>&nbsp;<span class="op" id="4389088">&amp;&amp;</span>&nbsp;<span class="ident" id="4389091">b</span>&nbsp;<span class="op" id="4389093">&lt;=</span>&nbsp;<span class="string" id="4389096">&#39;9&#39;</span>&nbsp;<span class="op" id="4389100">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4389105">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4389110">&lt;=</span>&nbsp;<span class="ident" id="4389113">b</span>&nbsp;<span class="op" id="4389115">&amp;&amp;</span>&nbsp;<span class="ident" id="4389118">b</span>&nbsp;<span class="op" id="4389120">&lt;=</span>&nbsp;<span class="string" id="4389123">&#39;)&#39;</span>&nbsp;<span class="op" id="4389127">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4389132">&#39;+&#39;</span>&nbsp;<span class="op" id="4389136">&lt;=</span>&nbsp;<span class="ident" id="4389139">b</span>&nbsp;<span class="op" id="4389141">&amp;&amp;</span>&nbsp;<span class="ident" id="4389144">b</span>&nbsp;<span class="op" id="4389146">&lt;=</span>&nbsp;<span class="string" id="4389149">&#39;/&#39;</span>&nbsp;<span class="op" id="4389153">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389158">b</span>&nbsp;<span class="op" id="4389160">==</span>&nbsp;<span class="string" id="4389163">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4389167">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389172">b</span>&nbsp;<span class="op" id="4389174">==</span>&nbsp;<span class="string" id="4389177">&#39;:&#39;</span>&nbsp;<span class="op" id="4389181">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389186">b</span>&nbsp;<span class="op" id="4389188">==</span>&nbsp;<span class="string" id="4389191">&#39;=&#39;</span>&nbsp;<span class="op" id="4389195">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389200">b</span>&nbsp;<span class="op" id="4389202">==</span>&nbsp;<span class="string" id="4389205">&#39;?&#39;</span>&nbsp;<span class="op" id="4389209">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4389214">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4389273">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4389333">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389390">b</span>&nbsp;<span class="op" id="4389392">==</span>&nbsp;<span class="string" id="4389395">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="4389399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="4389402">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4389416">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4389489">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4389519">func</span>&nbsp;<span class="ident" id="4389524">parseIA5String</span><span class="op" id="4389538">(</span><span class="ident" id="4389539">bytes</span>&nbsp;<span class="op" id="4389545">[</span><span class="op" id="4389546">]</span><span class="builtintype" id="4389547">byte</span><span class="op" id="4389551">)</span>&nbsp;<span class="op" id="4389553">(</span><span class="ident" id="4389554">ret</span>&nbsp;<span class="builtintype" id="4389558">string</span><span class="op" id="4389564">,</span>&nbsp;<span class="ident" id="4389566">err</span>&nbsp;<span class="builtintype" id="4389570">error</span><span class="op" id="4389575">)</span>&nbsp;<span class="op" id="4389577">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389580">for</span>&nbsp;<span class="ident" id="4389584">_</span><span class="op" id="4389585">,</span>&nbsp;<span class="ident" id="4389587">b</span>&nbsp;<span class="op" id="4389589">:=</span>&nbsp;<span class="keyword" id="4389592">range</span>&nbsp;<span class="ident" id="4389598">bytes</span>&nbsp;<span class="op" id="4389604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389608">if</span>&nbsp;<span class="ident" id="4389611">b</span>&nbsp;<span class="op" id="4389613">&gt;=</span>&nbsp;<span class="num" id="4389616">0x80</span>&nbsp;<span class="op" id="4389621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389626">err</span>&nbsp;<span class="op" id="4389630">=</span>&nbsp;<span class="ident" id="4389632">SyntaxError</span><span class="op" id="4389643">{</span><span class="string" id="4389644">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4389682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389687">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4389696">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4389699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389702">ret</span>&nbsp;<span class="op" id="4389706">=</span>&nbsp;<span class="builtintype" id="4389708">string</span><span class="op" id="4389714">(</span><span class="ident" id="4389715">bytes</span><span class="op" id="4389720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389723">return</span><br>
<span class="lineno"></span><span class="op" id="4389730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4389733">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4389747">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4389826">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4389856">func</span>&nbsp;<span class="ident" id="4389861">parseT61String</span><span class="op" id="4389875">(</span><span class="ident" id="4389876">bytes</span>&nbsp;<span class="op" id="4389882">[</span><span class="op" id="4389883">]</span><span class="builtintype" id="4389884">byte</span><span class="op" id="4389888">)</span>&nbsp;<span class="op" id="4389890">(</span><span class="ident" id="4389891">ret</span>&nbsp;<span class="builtintype" id="4389895">string</span><span class="op" id="4389901">,</span>&nbsp;<span class="ident" id="4389903">err</span>&nbsp;<span class="builtintype" id="4389907">error</span><span class="op" id="4389912">)</span>&nbsp;<span class="op" id="4389914">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389917">return</span>&nbsp;<span class="builtintype" id="4389924">string</span><span class="op" id="4389930">(</span><span class="ident" id="4389931">bytes</span><span class="op" id="4389936">)</span><span class="op" id="4389937">,</span>&nbsp;<span class="ident" id="4389939">nil</span><br>
<span class="lineno"></span><span class="op" id="4389943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4389946">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4389961">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4390038">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4390063">func</span>&nbsp;<span class="ident" id="4390068">parseUTF8String</span><span class="op" id="4390083">(</span><span class="ident" id="4390084">bytes</span>&nbsp;<span class="op" id="4390090">[</span><span class="op" id="4390091">]</span><span class="builtintype" id="4390092">byte</span><span class="op" id="4390096">)</span>&nbsp;<span class="op" id="4390098">(</span><span class="ident" id="4390099">ret</span>&nbsp;<span class="builtintype" id="4390103">string</span><span class="op" id="4390109">,</span>&nbsp;<span class="ident" id="4390111">err</span>&nbsp;<span class="builtintype" id="4390115">error</span><span class="op" id="4390120">)</span>&nbsp;<span class="op" id="4390122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390125">return</span>&nbsp;<span class="builtintype" id="4390132">string</span><span class="op" id="4390138">(</span><span class="ident" id="4390139">bytes</span><span class="op" id="4390144">)</span><span class="op" id="4390145">,</span>&nbsp;<span class="ident" id="4390147">nil</span><br>
<span class="lineno"></span><span class="op" id="4390151">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="4390154">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4390206">type</span>&nbsp;<span class="ident" id="4390211">RawValue</span>&nbsp;<span class="keyword" id="4390220">struct</span>&nbsp;<span class="op" id="4390227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390230">Class</span><span class="op" id="4390235">,</span>&nbsp;<span class="ident" id="4390237">Tag</span>&nbsp;<span class="builtintype" id="4390241">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390246">IsCompound</span>&nbsp;<span class="builtintype" id="4390257">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390263">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4390274">[</span><span class="op" id="4390275">]</span><span class="builtintype" id="4390276">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390282">FullBytes</span>&nbsp;&nbsp;<span class="op" id="4390293">[</span><span class="op" id="4390294">]</span><span class="builtintype" id="4390295">byte</span>&nbsp;<span class="comment" id="4390300">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="4390331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4390334">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="4390407">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="4390485">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4390560">type</span>&nbsp;<span class="ident" id="4390565">RawContent</span>&nbsp;<span class="op" id="4390576">[</span><span class="op" id="4390577">]</span><span class="builtintype" id="4390578">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4390584">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="4390596">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="4390675">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4390752">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="4390828">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="4390901">func</span>&nbsp;<span class="ident" id="4390906">parseTagAndLength</span><span class="op" id="4390923">(</span><span class="ident" id="4390924">bytes</span>&nbsp;<span class="op" id="4390930">[</span><span class="op" id="4390931">]</span><span class="builtintype" id="4390932">byte</span><span class="op" id="4390936">,</span>&nbsp;<span class="ident" id="4390938">initOffset</span>&nbsp;<span class="builtintype" id="4390949">int</span><span class="op" id="4390952">)</span>&nbsp;<span class="op" id="4390954">(</span><span class="ident" id="4390955">ret</span>&nbsp;<span class="ident" id="4390959">tagAndLength</span><span class="op" id="4390971">,</span>&nbsp;<span class="ident" id="4390973">offset</span>&nbsp;<span class="builtintype" id="4390980">int</span><span class="op" id="4390983">,</span>&nbsp;<span class="ident" id="4390985">err</span>&nbsp;<span class="builtintype" id="4390989">error</span><span class="op" id="4390994">)</span>&nbsp;<span class="op" id="4390996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390999">offset</span>&nbsp;<span class="op" id="4391006">=</span>&nbsp;<span class="ident" id="4391008">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391020">b</span>&nbsp;<span class="op" id="4391022">:=</span>&nbsp;<span class="ident" id="4391025">bytes</span><span class="op" id="4391030">[</span><span class="ident" id="4391031">offset</span><span class="op" id="4391037">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391040">offset</span><span class="op" id="4391046">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391050">ret</span><span class="op" id="4391053">.</span><span class="ident" id="4391054">class</span>&nbsp;<span class="op" id="4391060">=</span>&nbsp;<span class="builtintype" id="4391062">int</span><span class="op" id="4391065">(</span><span class="ident" id="4391066">b</span>&nbsp;<span class="op" id="4391068">&gt;&gt;</span>&nbsp;<span class="num" id="4391071">6</span><span class="op" id="4391072">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391075">ret</span><span class="op" id="4391078">.</span><span class="ident" id="4391079">isCompound</span>&nbsp;<span class="op" id="4391090">=</span>&nbsp;<span class="ident" id="4391092">b</span><span class="op" id="4391093">&amp;</span><span class="num" id="4391094">0x20</span>&nbsp;<span class="op" id="4391099">==</span>&nbsp;<span class="num" id="4391102">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391108">ret</span><span class="op" id="4391111">.</span><span class="ident" id="4391112">tag</span>&nbsp;<span class="op" id="4391116">=</span>&nbsp;<span class="builtintype" id="4391118">int</span><span class="op" id="4391121">(</span><span class="ident" id="4391122">b</span>&nbsp;<span class="op" id="4391124">&amp;</span>&nbsp;<span class="num" id="4391126">0x1f</span><span class="op" id="4391130">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4391134">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4391212">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391235">if</span>&nbsp;<span class="ident" id="4391238">ret</span><span class="op" id="4391241">.</span><span class="ident" id="4391242">tag</span>&nbsp;<span class="op" id="4391246">==</span>&nbsp;<span class="num" id="4391249">0x1f</span>&nbsp;<span class="op" id="4391254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391258">ret</span><span class="op" id="4391261">.</span><span class="ident" id="4391262">tag</span><span class="op" id="4391265">,</span>&nbsp;<span class="ident" id="4391267">offset</span><span class="op" id="4391273">,</span>&nbsp;<span class="ident" id="4391275">err</span>&nbsp;<span class="op" id="4391279">=</span>&nbsp;<span class="ident" id="4391281">parseBase128Int</span><span class="op" id="4391296">(</span><span class="ident" id="4391297">bytes</span><span class="op" id="4391302">,</span>&nbsp;<span class="ident" id="4391304">offset</span><span class="op" id="4391310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391314">if</span>&nbsp;<span class="ident" id="4391317">err</span>&nbsp;<span class="op" id="4391321">!=</span>&nbsp;<span class="ident" id="4391324">nil</span>&nbsp;<span class="op" id="4391328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391333">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4391342">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4391345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391348">if</span>&nbsp;<span class="ident" id="4391351">offset</span>&nbsp;<span class="op" id="4391358">&gt;=</span>&nbsp;<span class="builtinfunc" id="4391361">len</span><span class="op" id="4391364">(</span><span class="ident" id="4391365">bytes</span><span class="op" id="4391370">)</span>&nbsp;<span class="op" id="4391372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391376">err</span>&nbsp;<span class="op" id="4391380">=</span>&nbsp;<span class="ident" id="4391382">SyntaxError</span><span class="op" id="4391393">{</span><span class="string" id="4391394">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4391419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391423">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4391431">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391434">b</span>&nbsp;<span class="op" id="4391436">=</span>&nbsp;<span class="ident" id="4391438">bytes</span><span class="op" id="4391443">[</span><span class="ident" id="4391444">offset</span><span class="op" id="4391450">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391453">offset</span><span class="op" id="4391459">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391463">if</span>&nbsp;<span class="ident" id="4391466">b</span><span class="op" id="4391467">&amp;</span><span class="num" id="4391468">0x80</span>&nbsp;<span class="op" id="4391473">==</span>&nbsp;<span class="num" id="4391476">0</span>&nbsp;<span class="op" id="4391478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4391482">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391531">ret</span><span class="op" id="4391534">.</span><span class="ident" id="4391535">length</span>&nbsp;<span class="op" id="4391542">=</span>&nbsp;<span class="builtintype" id="4391544">int</span><span class="op" id="4391547">(</span><span class="ident" id="4391548">b</span>&nbsp;<span class="op" id="4391550">&amp;</span>&nbsp;<span class="num" id="4391552">0x7f</span><span class="op" id="4391556">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4391559">}</span>&nbsp;<span class="keyword" id="4391561">else</span>&nbsp;<span class="op" id="4391566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4391570">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391632">numBytes</span>&nbsp;<span class="op" id="4391641">:=</span>&nbsp;<span class="builtintype" id="4391644">int</span><span class="op" id="4391647">(</span><span class="ident" id="4391648">b</span>&nbsp;<span class="op" id="4391650">&amp;</span>&nbsp;<span class="num" id="4391652">0x7f</span><span class="op" id="4391656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391660">if</span>&nbsp;<span class="ident" id="4391663">numBytes</span>&nbsp;<span class="op" id="4391672">==</span>&nbsp;<span class="num" id="4391675">0</span>&nbsp;<span class="op" id="4391677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391682">err</span>&nbsp;<span class="op" id="4391686">=</span>&nbsp;<span class="ident" id="4391688">SyntaxError</span><span class="op" id="4391699">{</span><span class="string" id="4391700">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="4391735">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391740">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4391749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391753">ret</span><span class="op" id="4391756">.</span><span class="ident" id="4391757">length</span>&nbsp;<span class="op" id="4391764">=</span>&nbsp;<span class="num" id="4391766">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391770">for</span>&nbsp;<span class="ident" id="4391774">i</span>&nbsp;<span class="op" id="4391776">:=</span>&nbsp;<span class="num" id="4391779">0</span><span class="op" id="4391780">;</span>&nbsp;<span class="ident" id="4391782">i</span>&nbsp;<span class="op" id="4391784">&lt;</span>&nbsp;<span class="ident" id="4391786">numBytes</span><span class="op" id="4391794">;</span>&nbsp;<span class="ident" id="4391796">i</span><span class="op" id="4391797">++</span>&nbsp;<span class="op" id="4391800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391805">if</span>&nbsp;<span class="ident" id="4391808">offset</span>&nbsp;<span class="op" id="4391815">&gt;=</span>&nbsp;<span class="builtinfunc" id="4391818">len</span><span class="op" id="4391821">(</span><span class="ident" id="4391822">bytes</span><span class="op" id="4391827">)</span>&nbsp;<span class="op" id="4391829">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391835">err</span>&nbsp;<span class="op" id="4391839">=</span>&nbsp;<span class="ident" id="4391841">SyntaxError</span><span class="op" id="4391852">{</span><span class="string" id="4391853">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4391878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391884">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4391894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391899">b</span>&nbsp;<span class="op" id="4391901">=</span>&nbsp;<span class="ident" id="4391903">bytes</span><span class="op" id="4391908">[</span><span class="ident" id="4391909">offset</span><span class="op" id="4391915">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4391920">offset</span><span class="op" id="4391926">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391932">if</span>&nbsp;<span class="ident" id="4391935">ret</span><span class="op" id="4391938">.</span><span class="ident" id="4391939">length</span>&nbsp;<span class="op" id="4391946">&gt;=</span>&nbsp;<span class="num" id="4391949">1</span><span class="op" id="4391950">&lt;&lt;</span><span class="num" id="4391952">23</span>&nbsp;<span class="op" id="4391955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4391961">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4392005">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4392025">err</span>&nbsp;<span class="op" id="4392029">=</span>&nbsp;<span class="ident" id="4392031">StructuralError</span><span class="op" id="4392046">{</span><span class="string" id="4392047">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="4392065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4392071">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4392081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4392086">ret</span><span class="op" id="4392089">.</span><span class="ident" id="4392090">length</span>&nbsp;<span class="op" id="4392097">&lt;&lt;=</span>&nbsp;<span class="num" id="4392101">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4392106">ret</span><span class="op" id="4392109">.</span><span class="ident" id="4392110">length</span>&nbsp;<span class="op" id="4392117">|=</span>&nbsp;<span class="builtintype" id="4392120">int</span><span class="op" id="4392123">(</span><span class="ident" id="4392124">b</span><span class="op" id="4392125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4392130">if</span>&nbsp;<span class="ident" id="4392133">ret</span><span class="op" id="4392136">.</span><span class="ident" id="4392137">length</span>&nbsp;<span class="op" id="4392144">==</span>&nbsp;<span class="num" id="4392147">0</span>&nbsp;<span class="op" id="4392149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4392155">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4392200">err</span>&nbsp;<span class="op" id="4392204">=</span>&nbsp;<span class="ident" id="4392206">StructuralError</span><span class="op" id="4392221">{</span><span class="string" id="4392222">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="4392259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4392265">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4392275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4392279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4392282">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4392286">return</span><br>
<span class="lineno"></span><span class="op" id="4392293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4392296">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="4392376">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4392452">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4392493">func</span>&nbsp;<span class="ident" id="4392498">parseSequenceOf</span><span class="op" id="4392513">(</span><span class="ident" id="4392514">bytes</span>&nbsp;<span class="op" id="4392520">[</span><span class="op" id="4392521">]</span><span class="builtintype" id="4392522">byte</span><span class="op" id="4392526">,</span>&nbsp;<span class="ident" id="4392528">sliceType</span>&nbsp;<span class="ident" id="4392538">reflect</span><span class="op" id="4392545">.</span><span class="ident" id="4392546">Type</span><span class="op" id="4392550">,</span>&nbsp;<span class="ident" id="4392552">elemType</span>&nbsp;<span class="ident" id="4392561">reflect</span><span class="op" id="4392568">.</span><span class="ident" id="4392569">Type</span><span class="op" id="4392573">)</span>&nbsp;<span class="op" id="4392575">(</span><span class="ident" id="4392576">ret</span>&nbsp;<span class="ident" id="4392580">reflect</span><span class="op" id="4392587">.</span><span class="ident" id="4392588">Value</span><span class="op" id="4392593">,</span>&nbsp;<span class="ident" id="4392595">err</span>&nbsp;<span class="builtintype" id="4392599">error</span><span class="op" id="4392604">)</span>&nbsp;<span class="op" id="4392606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4392609">expectedTag</span><span class="op" id="4392620">,</span>&nbsp;<span class="ident" id="4392622">compoundType</span><span class="op" id="4392634">,</span>&nbsp;<span class="ident" id="4392636">ok</span>&nbsp;<span class="op" id="4392639">:=</span>&nbsp;<span class="ident" id="4392642">getUniversalType</span><span class="op" id="4392658">(</span><span class="ident" id="4392659">elemType</span><span class="op" id="4392667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4392670">if</span>&nbsp;<span class="op" id="4392673">!</span><span class="ident" id="4392674">ok</span>&nbsp;<span class="op" id="4392677">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4392681">err</span>&nbsp;<span class="op" id="4392685">=</span>&nbsp;<span class="ident" id="4392687">StructuralError</span><span class="op" id="4392702">{</span><span class="string" id="4392703">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="4392730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4392734">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4392742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4392746">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4392816">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4392870">numElements</span>&nbsp;<span class="op" id="4392882">:=</span>&nbsp;<span class="num" id="4392885">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4392888">for</span>&nbsp;<span class="ident" id="4392892">offset</span>&nbsp;<span class="op" id="4392899">:=</span>&nbsp;<span class="num" id="4392902">0</span><span class="op" id="4392903">;</span>&nbsp;<span class="ident" id="4392905">offset</span>&nbsp;<span class="op" id="4392912">&lt;</span>&nbsp;<span class="builtinfunc" id="4392914">len</span><span class="op" id="4392917">(</span><span class="ident" id="4392918">bytes</span><span class="op" id="4392923">)</span><span class="op" id="4392924">;</span>&nbsp;<span class="op" id="4392926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4392930">var</span>&nbsp;<span class="ident" id="4392934">t</span>&nbsp;<span class="ident" id="4392936">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4392951">t</span><span class="op" id="4392952">,</span>&nbsp;<span class="ident" id="4392954">offset</span><span class="op" id="4392960">,</span>&nbsp;<span class="ident" id="4392962">err</span>&nbsp;<span class="op" id="4392966">=</span>&nbsp;<span class="ident" id="4392968">parseTagAndLength</span><span class="op" id="4392985">(</span><span class="ident" id="4392986">bytes</span><span class="op" id="4392991">,</span>&nbsp;<span class="ident" id="4392993">offset</span><span class="op" id="4392999">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393003">if</span>&nbsp;<span class="ident" id="4393006">err</span>&nbsp;<span class="op" id="4393010">!=</span>&nbsp;<span class="ident" id="4393013">nil</span>&nbsp;<span class="op" id="4393017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393022">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4393031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393035">switch</span>&nbsp;<span class="ident" id="4393042">t</span><span class="op" id="4393043">.</span><span class="ident" id="4393044">tag</span>&nbsp;<span class="op" id="4393048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393052">case</span>&nbsp;<span class="ident" id="4393057">tagIA5String</span><span class="op" id="4393069">,</span>&nbsp;<span class="ident" id="4393071">tagGeneralString</span><span class="op" id="4393087">,</span>&nbsp;<span class="ident" id="4393089">tagT61String</span><span class="op" id="4393101">,</span>&nbsp;<span class="ident" id="4393103">tagUTF8String</span><span class="op" id="4393116">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4393121">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4393174">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4393232">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4393262">t</span><span class="op" id="4393263">.</span><span class="ident" id="4393264">tag</span>&nbsp;<span class="op" id="4393268">=</span>&nbsp;<span class="ident" id="4393270">tagPrintableString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393291">case</span>&nbsp;<span class="ident" id="4393296">tagGeneralizedTime</span><span class="op" id="4393314">,</span>&nbsp;<span class="ident" id="4393316">tagUTCTime</span><span class="op" id="4393326">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4393331">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4393385">t</span><span class="op" id="4393386">.</span><span class="ident" id="4393387">tag</span>&nbsp;<span class="op" id="4393391">=</span>&nbsp;<span class="ident" id="4393393">tagUTCTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4393406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393411">if</span>&nbsp;<span class="ident" id="4393414">t</span><span class="op" id="4393415">.</span><span class="ident" id="4393416">class</span>&nbsp;<span class="op" id="4393422">!=</span>&nbsp;<span class="ident" id="4393425">classUniversal</span>&nbsp;<span class="op" id="4393440">||</span>&nbsp;<span class="ident" id="4393443">t</span><span class="op" id="4393444">.</span><span class="ident" id="4393445">isCompound</span>&nbsp;<span class="op" id="4393456">!=</span>&nbsp;<span class="ident" id="4393459">compoundType</span>&nbsp;<span class="op" id="4393472">||</span>&nbsp;<span class="ident" id="4393475">t</span><span class="op" id="4393476">.</span><span class="ident" id="4393477">tag</span>&nbsp;<span class="op" id="4393481">!=</span>&nbsp;<span class="ident" id="4393484">expectedTag</span>&nbsp;<span class="op" id="4393496">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4393501">err</span>&nbsp;<span class="op" id="4393505">=</span>&nbsp;<span class="ident" id="4393507">StructuralError</span><span class="op" id="4393522">{</span><span class="string" id="4393523">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="4393546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393551">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4393560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393564">if</span>&nbsp;<span class="ident" id="4393567">invalidLength</span><span class="op" id="4393580">(</span><span class="ident" id="4393581">offset</span><span class="op" id="4393587">,</span>&nbsp;<span class="ident" id="4393589">t</span><span class="op" id="4393590">.</span><span class="ident" id="4393591">length</span><span class="op" id="4393597">,</span>&nbsp;<span class="builtinfunc" id="4393599">len</span><span class="op" id="4393602">(</span><span class="ident" id="4393603">bytes</span><span class="op" id="4393608">)</span><span class="op" id="4393609">)</span>&nbsp;<span class="op" id="4393611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4393616">err</span>&nbsp;<span class="op" id="4393620">=</span>&nbsp;<span class="ident" id="4393622">SyntaxError</span><span class="op" id="4393633">{</span><span class="string" id="4393634">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="4393654">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393659">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4393668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4393672">offset</span>&nbsp;<span class="op" id="4393679">+=</span>&nbsp;<span class="ident" id="4393682">t</span><span class="op" id="4393683">.</span><span class="ident" id="4393684">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4393693">numElements</span><span class="op" id="4393704">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4393708">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4393711">ret</span>&nbsp;<span class="op" id="4393715">=</span>&nbsp;<span class="ident" id="4393717">reflect</span><span class="op" id="4393724">.</span><span class="ident" id="4393725">MakeSlice</span><span class="op" id="4393734">(</span><span class="ident" id="4393735">sliceType</span><span class="op" id="4393744">,</span>&nbsp;<span class="ident" id="4393746">numElements</span><span class="op" id="4393757">,</span>&nbsp;<span class="ident" id="4393759">numElements</span><span class="op" id="4393770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4393773">params</span>&nbsp;<span class="op" id="4393780">:=</span>&nbsp;<span class="ident" id="4393783">fieldParameters</span><span class="op" id="4393798">{</span><span class="op" id="4393799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4393802">offset</span>&nbsp;<span class="op" id="4393809">:=</span>&nbsp;<span class="num" id="4393812">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393815">for</span>&nbsp;<span class="ident" id="4393819">i</span>&nbsp;<span class="op" id="4393821">:=</span>&nbsp;<span class="num" id="4393824">0</span><span class="op" id="4393825">;</span>&nbsp;<span class="ident" id="4393827">i</span>&nbsp;<span class="op" id="4393829">&lt;</span>&nbsp;<span class="ident" id="4393831">numElements</span><span class="op" id="4393842">;</span>&nbsp;<span class="ident" id="4393844">i</span><span class="op" id="4393845">++</span>&nbsp;<span class="op" id="4393848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4393852">offset</span><span class="op" id="4393858">,</span>&nbsp;<span class="ident" id="4393860">err</span>&nbsp;<span class="op" id="4393864">=</span>&nbsp;<span class="ident" id="4393866">parseField</span><span class="op" id="4393876">(</span><span class="ident" id="4393877">ret</span><span class="op" id="4393880">.</span><span class="ident" id="4393881">Index</span><span class="op" id="4393886">(</span><span class="ident" id="4393887">i</span><span class="op" id="4393888">)</span><span class="op" id="4393889">,</span>&nbsp;<span class="ident" id="4393891">bytes</span><span class="op" id="4393896">,</span>&nbsp;<span class="ident" id="4393898">offset</span><span class="op" id="4393904">,</span>&nbsp;<span class="ident" id="4393906">params</span><span class="op" id="4393912">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393916">if</span>&nbsp;<span class="ident" id="4393919">err</span>&nbsp;<span class="op" id="4393923">!=</span>&nbsp;<span class="ident" id="4393926">nil</span>&nbsp;<span class="op" id="4393930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393935">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4393944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4393947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4393950">return</span><br>
<span class="lineno">500</span><span class="op" id="4393957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4393960">var</span>&nbsp;<span class="op" id="4393964">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4393967">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393988">=</span>&nbsp;<span class="ident" id="4393990">reflect</span><span class="op" id="4393997">.</span><span class="ident" id="4393998">TypeOf</span><span class="op" id="4394004">(</span><span class="ident" id="4394005">BitString</span><span class="op" id="4394014">{</span><span class="op" id="4394015">}</span><span class="op" id="4394016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4394019">objectIdentifierType</span>&nbsp;<span class="op" id="4394040">=</span>&nbsp;<span class="ident" id="4394042">reflect</span><span class="op" id="4394049">.</span><span class="ident" id="4394050">TypeOf</span><span class="op" id="4394056">(</span><span class="ident" id="4394057">ObjectIdentifier</span><span class="op" id="4394073">{</span><span class="op" id="4394074">}</span><span class="op" id="4394075">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4394078">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394099">=</span>&nbsp;<span class="ident" id="4394101">reflect</span><span class="op" id="4394108">.</span><span class="ident" id="4394109">TypeOf</span><span class="op" id="4394115">(</span><span class="ident" id="4394116">Enumerated</span><span class="op" id="4394126">(</span><span class="num" id="4394127">0</span><span class="op" id="4394128">)</span><span class="op" id="4394129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4394132">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394153">=</span>&nbsp;<span class="ident" id="4394155">reflect</span><span class="op" id="4394162">.</span><span class="ident" id="4394163">TypeOf</span><span class="op" id="4394169">(</span><span class="ident" id="4394170">Flag</span><span class="op" id="4394174">(</span><span class="builtintype" id="4394175">false</span><span class="op" id="4394180">)</span><span class="op" id="4394181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4394184">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394205">=</span>&nbsp;<span class="ident" id="4394207">reflect</span><span class="op" id="4394214">.</span><span class="ident" id="4394215">TypeOf</span><span class="op" id="4394221">(</span><span class="ident" id="4394222">time</span><span class="op" id="4394226">.</span><span class="ident" id="4394227">Time</span><span class="op" id="4394231">{</span><span class="op" id="4394232">}</span><span class="op" id="4394233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4394236">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394257">=</span>&nbsp;<span class="ident" id="4394259">reflect</span><span class="op" id="4394266">.</span><span class="ident" id="4394267">TypeOf</span><span class="op" id="4394273">(</span><span class="ident" id="4394274">RawValue</span><span class="op" id="4394282">{</span><span class="op" id="4394283">}</span><span class="op" id="4394284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4394287">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394308">=</span>&nbsp;<span class="ident" id="4394310">reflect</span><span class="op" id="4394317">.</span><span class="ident" id="4394318">TypeOf</span><span class="op" id="4394324">(</span><span class="ident" id="4394325">RawContent</span><span class="op" id="4394335">(</span><span class="ident" id="4394336">nil</span><span class="op" id="4394339">)</span><span class="op" id="4394340">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4394343">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394364">=</span>&nbsp;<span class="ident" id="4394366">reflect</span><span class="op" id="4394373">.</span><span class="ident" id="4394374">TypeOf</span><span class="op" id="4394380">(</span><span class="builtinfunc" id="4394381">new</span><span class="op" id="4394384">(</span><span class="ident" id="4394385">big</span><span class="op" id="4394388">.</span><span class="ident" id="4394389">Int</span><span class="op" id="4394392">)</span><span class="op" id="4394393">)</span><br>
<span class="lineno"></span><span class="op" id="4394395">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4394398">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4394473">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="4394501">func</span>&nbsp;<span class="ident" id="4394506">invalidLength</span><span class="op" id="4394519">(</span><span class="ident" id="4394520">offset</span><span class="op" id="4394526">,</span>&nbsp;<span class="ident" id="4394528">length</span><span class="op" id="4394534">,</span>&nbsp;<span class="ident" id="4394536">sliceLength</span>&nbsp;<span class="builtintype" id="4394548">int</span><span class="op" id="4394551">)</span>&nbsp;<span class="builtintype" id="4394553">bool</span>&nbsp;<span class="op" id="4394558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4394561">return</span>&nbsp;<span class="ident" id="4394568">offset</span><span class="op" id="4394574">+</span><span class="ident" id="4394575">length</span>&nbsp;<span class="op" id="4394582">&lt;</span>&nbsp;<span class="ident" id="4394584">offset</span>&nbsp;<span class="op" id="4394591">||</span>&nbsp;<span class="ident" id="4394594">offset</span><span class="op" id="4394600">+</span><span class="ident" id="4394601">length</span>&nbsp;<span class="op" id="4394608">&gt;</span>&nbsp;<span class="ident" id="4394610">sliceLength</span><br>
<span class="lineno"></span><span class="op" id="4394622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4394625">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="4394702">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4394782">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4394805">func</span>&nbsp;<span class="ident" id="4394810">parseField</span><span class="op" id="4394820">(</span><span class="ident" id="4394821">v</span>&nbsp;<span class="ident" id="4394823">reflect</span><span class="op" id="4394830">.</span><span class="ident" id="4394831">Value</span><span class="op" id="4394836">,</span>&nbsp;<span class="ident" id="4394838">bytes</span>&nbsp;<span class="op" id="4394844">[</span><span class="op" id="4394845">]</span><span class="builtintype" id="4394846">byte</span><span class="op" id="4394850">,</span>&nbsp;<span class="ident" id="4394852">initOffset</span>&nbsp;<span class="builtintype" id="4394863">int</span><span class="op" id="4394866">,</span>&nbsp;<span class="ident" id="4394868">params</span>&nbsp;<span class="ident" id="4394875">fieldParameters</span><span class="op" id="4394890">)</span>&nbsp;<span class="op" id="4394892">(</span><span class="ident" id="4394893">offset</span>&nbsp;<span class="builtintype" id="4394900">int</span><span class="op" id="4394903">,</span>&nbsp;<span class="ident" id="4394905">err</span>&nbsp;<span class="builtintype" id="4394909">error</span><span class="op" id="4394914">)</span>&nbsp;<span class="op" id="4394916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4394919">offset</span>&nbsp;<span class="op" id="4394926">=</span>&nbsp;<span class="ident" id="4394928">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4394940">fieldType</span>&nbsp;<span class="op" id="4394950">:=</span>&nbsp;<span class="ident" id="4394953">v</span><span class="op" id="4394954">.</span><span class="ident" id="4394955">Type</span><span class="op" id="4394959">(</span><span class="op" id="4394960">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4394964">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395051">if</span>&nbsp;<span class="ident" id="4395054">offset</span>&nbsp;<span class="op" id="4395061">==</span>&nbsp;<span class="builtinfunc" id="4395064">len</span><span class="op" id="4395067">(</span><span class="ident" id="4395068">bytes</span><span class="op" id="4395073">)</span>&nbsp;<span class="op" id="4395075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395079">if</span>&nbsp;<span class="op" id="4395082">!</span><span class="ident" id="4395083">setDefaultValue</span><span class="op" id="4395098">(</span><span class="ident" id="4395099">v</span><span class="op" id="4395100">,</span>&nbsp;<span class="ident" id="4395102">params</span><span class="op" id="4395108">)</span>&nbsp;<span class="op" id="4395110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4395115">err</span>&nbsp;<span class="op" id="4395119">=</span>&nbsp;<span class="ident" id="4395121">SyntaxError</span><span class="op" id="4395132">{</span><span class="string" id="4395133">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="4395153">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4395157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395161">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4395169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4395173">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395199">if</span>&nbsp;<span class="ident" id="4395202">fieldType</span>&nbsp;<span class="op" id="4395212">==</span>&nbsp;<span class="ident" id="4395215">rawValueType</span>&nbsp;<span class="op" id="4395228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395232">var</span>&nbsp;<span class="ident" id="4395236">t</span>&nbsp;<span class="ident" id="4395238">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4395253">t</span><span class="op" id="4395254">,</span>&nbsp;<span class="ident" id="4395256">offset</span><span class="op" id="4395262">,</span>&nbsp;<span class="ident" id="4395264">err</span>&nbsp;<span class="op" id="4395268">=</span>&nbsp;<span class="ident" id="4395270">parseTagAndLength</span><span class="op" id="4395287">(</span><span class="ident" id="4395288">bytes</span><span class="op" id="4395293">,</span>&nbsp;<span class="ident" id="4395295">offset</span><span class="op" id="4395301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395305">if</span>&nbsp;<span class="ident" id="4395308">err</span>&nbsp;<span class="op" id="4395312">!=</span>&nbsp;<span class="ident" id="4395315">nil</span>&nbsp;<span class="op" id="4395319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395324">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4395333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395337">if</span>&nbsp;<span class="ident" id="4395340">invalidLength</span><span class="op" id="4395353">(</span><span class="ident" id="4395354">offset</span><span class="op" id="4395360">,</span>&nbsp;<span class="ident" id="4395362">t</span><span class="op" id="4395363">.</span><span class="ident" id="4395364">length</span><span class="op" id="4395370">,</span>&nbsp;<span class="builtinfunc" id="4395372">len</span><span class="op" id="4395375">(</span><span class="ident" id="4395376">bytes</span><span class="op" id="4395381">)</span><span class="op" id="4395382">)</span>&nbsp;<span class="op" id="4395384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4395389">err</span>&nbsp;<span class="op" id="4395393">=</span>&nbsp;<span class="ident" id="4395395">SyntaxError</span><span class="op" id="4395406">{</span><span class="string" id="4395407">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4395423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395428">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4395437">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4395441">result</span>&nbsp;<span class="op" id="4395448">:=</span>&nbsp;<span class="ident" id="4395451">RawValue</span><span class="op" id="4395459">{</span><span class="ident" id="4395460">t</span><span class="op" id="4395461">.</span><span class="ident" id="4395462">class</span><span class="op" id="4395467">,</span>&nbsp;<span class="ident" id="4395469">t</span><span class="op" id="4395470">.</span><span class="ident" id="4395471">tag</span><span class="op" id="4395474">,</span>&nbsp;<span class="ident" id="4395476">t</span><span class="op" id="4395477">.</span><span class="ident" id="4395478">isCompound</span><span class="op" id="4395488">,</span>&nbsp;<span class="ident" id="4395490">bytes</span><span class="op" id="4395495">[</span><span class="ident" id="4395496">offset</span>&nbsp;<span class="op" id="4395503">:</span>&nbsp;<span class="ident" id="4395505">offset</span><span class="op" id="4395511">+</span><span class="ident" id="4395512">t</span><span class="op" id="4395513">.</span><span class="ident" id="4395514">length</span><span class="op" id="4395520">]</span><span class="op" id="4395521">,</span>&nbsp;<span class="ident" id="4395523">bytes</span><span class="op" id="4395528">[</span><span class="ident" id="4395529">initOffset</span>&nbsp;<span class="op" id="4395540">:</span>&nbsp;<span class="ident" id="4395542">offset</span><span class="op" id="4395548">+</span><span class="ident" id="4395549">t</span><span class="op" id="4395550">.</span><span class="ident" id="4395551">length</span><span class="op" id="4395557">]</span><span class="op" id="4395558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4395562">offset</span>&nbsp;<span class="op" id="4395569">+=</span>&nbsp;<span class="ident" id="4395572">t</span><span class="op" id="4395573">.</span><span class="ident" id="4395574">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4395583">v</span><span class="op" id="4395584">.</span><span class="ident" id="4395585">Set</span><span class="op" id="4395588">(</span><span class="ident" id="4395589">reflect</span><span class="op" id="4395596">.</span><span class="ident" id="4395597">ValueOf</span><span class="op" id="4395604">(</span><span class="ident" id="4395605">result</span><span class="op" id="4395611">)</span><span class="op" id="4395612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395616">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4395624">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4395628">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395656">if</span>&nbsp;<span class="ident" id="4395659">ifaceType</span>&nbsp;<span class="op" id="4395669">:=</span>&nbsp;<span class="ident" id="4395672">fieldType</span><span class="op" id="4395681">;</span>&nbsp;<span class="ident" id="4395683">ifaceType</span><span class="op" id="4395692">.</span><span class="ident" id="4395693">Kind</span><span class="op" id="4395697">(</span><span class="op" id="4395698">)</span>&nbsp;<span class="op" id="4395700">==</span>&nbsp;<span class="ident" id="4395703">reflect</span><span class="op" id="4395710">.</span><span class="ident" id="4395711">Interface</span>&nbsp;<span class="op" id="4395721">&amp;&amp;</span>&nbsp;<span class="ident" id="4395724">ifaceType</span><span class="op" id="4395733">.</span><span class="ident" id="4395734">NumMethod</span><span class="op" id="4395743">(</span><span class="op" id="4395744">)</span>&nbsp;<span class="op" id="4395746">==</span>&nbsp;<span class="num" id="4395749">0</span>&nbsp;<span class="op" id="4395751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395755">var</span>&nbsp;<span class="ident" id="4395759">t</span>&nbsp;<span class="ident" id="4395761">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4395776">t</span><span class="op" id="4395777">,</span>&nbsp;<span class="ident" id="4395779">offset</span><span class="op" id="4395785">,</span>&nbsp;<span class="ident" id="4395787">err</span>&nbsp;<span class="op" id="4395791">=</span>&nbsp;<span class="ident" id="4395793">parseTagAndLength</span><span class="op" id="4395810">(</span><span class="ident" id="4395811">bytes</span><span class="op" id="4395816">,</span>&nbsp;<span class="ident" id="4395818">offset</span><span class="op" id="4395824">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395828">if</span>&nbsp;<span class="ident" id="4395831">err</span>&nbsp;<span class="op" id="4395835">!=</span>&nbsp;<span class="ident" id="4395838">nil</span>&nbsp;<span class="op" id="4395842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395847">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4395856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395860">if</span>&nbsp;<span class="ident" id="4395863">invalidLength</span><span class="op" id="4395876">(</span><span class="ident" id="4395877">offset</span><span class="op" id="4395883">,</span>&nbsp;<span class="ident" id="4395885">t</span><span class="op" id="4395886">.</span><span class="ident" id="4395887">length</span><span class="op" id="4395893">,</span>&nbsp;<span class="builtinfunc" id="4395895">len</span><span class="op" id="4395898">(</span><span class="ident" id="4395899">bytes</span><span class="op" id="4395904">)</span><span class="op" id="4395905">)</span>&nbsp;<span class="op" id="4395907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4395912">err</span>&nbsp;<span class="op" id="4395916">=</span>&nbsp;<span class="ident" id="4395918">SyntaxError</span><span class="op" id="4395929">{</span><span class="string" id="4395930">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4395946">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395951">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4395960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395964">var</span>&nbsp;<span class="ident" id="4395968">result</span>&nbsp;<span class="keyword" id="4395975">interface</span><span class="op" id="4395984">{</span><span class="op" id="4395985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4395989">if</span>&nbsp;<span class="op" id="4395992">!</span><span class="ident" id="4395993">t</span><span class="op" id="4395994">.</span><span class="ident" id="4395995">isCompound</span>&nbsp;<span class="op" id="4396006">&amp;&amp;</span>&nbsp;<span class="ident" id="4396009">t</span><span class="op" id="4396010">.</span><span class="ident" id="4396011">class</span>&nbsp;<span class="op" id="4396017">==</span>&nbsp;<span class="ident" id="4396020">classUniversal</span>&nbsp;<span class="op" id="4396035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396040">innerBytes</span>&nbsp;<span class="op" id="4396051">:=</span>&nbsp;<span class="ident" id="4396054">bytes</span><span class="op" id="4396059">[</span><span class="ident" id="4396060">offset</span>&nbsp;<span class="op" id="4396067">:</span>&nbsp;<span class="ident" id="4396069">offset</span><span class="op" id="4396075">+</span><span class="ident" id="4396076">t</span><span class="op" id="4396077">.</span><span class="ident" id="4396078">length</span><span class="op" id="4396084">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396089">switch</span>&nbsp;<span class="ident" id="4396096">t</span><span class="op" id="4396097">.</span><span class="ident" id="4396098">tag</span>&nbsp;<span class="op" id="4396102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396107">case</span>&nbsp;<span class="ident" id="4396112">tagPrintableString</span><span class="op" id="4396130">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396136">result</span><span class="op" id="4396142">,</span>&nbsp;<span class="ident" id="4396144">err</span>&nbsp;<span class="op" id="4396148">=</span>&nbsp;<span class="ident" id="4396150">parsePrintableString</span><span class="op" id="4396170">(</span><span class="ident" id="4396171">innerBytes</span><span class="op" id="4396181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396186">case</span>&nbsp;<span class="ident" id="4396191">tagIA5String</span><span class="op" id="4396203">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396209">result</span><span class="op" id="4396215">,</span>&nbsp;<span class="ident" id="4396217">err</span>&nbsp;<span class="op" id="4396221">=</span>&nbsp;<span class="ident" id="4396223">parseIA5String</span><span class="op" id="4396237">(</span><span class="ident" id="4396238">innerBytes</span><span class="op" id="4396248">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396253">case</span>&nbsp;<span class="ident" id="4396258">tagT61String</span><span class="op" id="4396270">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396276">result</span><span class="op" id="4396282">,</span>&nbsp;<span class="ident" id="4396284">err</span>&nbsp;<span class="op" id="4396288">=</span>&nbsp;<span class="ident" id="4396290">parseT61String</span><span class="op" id="4396304">(</span><span class="ident" id="4396305">innerBytes</span><span class="op" id="4396315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396320">case</span>&nbsp;<span class="ident" id="4396325">tagUTF8String</span><span class="op" id="4396338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396344">result</span><span class="op" id="4396350">,</span>&nbsp;<span class="ident" id="4396352">err</span>&nbsp;<span class="op" id="4396356">=</span>&nbsp;<span class="ident" id="4396358">parseUTF8String</span><span class="op" id="4396373">(</span><span class="ident" id="4396374">innerBytes</span><span class="op" id="4396384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396389">case</span>&nbsp;<span class="ident" id="4396394">tagInteger</span><span class="op" id="4396404">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396410">result</span><span class="op" id="4396416">,</span>&nbsp;<span class="ident" id="4396418">err</span>&nbsp;<span class="op" id="4396422">=</span>&nbsp;<span class="ident" id="4396424">parseInt64</span><span class="op" id="4396434">(</span><span class="ident" id="4396435">innerBytes</span><span class="op" id="4396445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396450">case</span>&nbsp;<span class="ident" id="4396455">tagBitString</span><span class="op" id="4396467">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396473">result</span><span class="op" id="4396479">,</span>&nbsp;<span class="ident" id="4396481">err</span>&nbsp;<span class="op" id="4396485">=</span>&nbsp;<span class="ident" id="4396487">parseBitString</span><span class="op" id="4396501">(</span><span class="ident" id="4396502">innerBytes</span><span class="op" id="4396512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396517">case</span>&nbsp;<span class="ident" id="4396522">tagOID</span><span class="op" id="4396528">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396534">result</span><span class="op" id="4396540">,</span>&nbsp;<span class="ident" id="4396542">err</span>&nbsp;<span class="op" id="4396546">=</span>&nbsp;<span class="ident" id="4396548">parseObjectIdentifier</span><span class="op" id="4396569">(</span><span class="ident" id="4396570">innerBytes</span><span class="op" id="4396580">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396585">case</span>&nbsp;<span class="ident" id="4396590">tagUTCTime</span><span class="op" id="4396600">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396606">result</span><span class="op" id="4396612">,</span>&nbsp;<span class="ident" id="4396614">err</span>&nbsp;<span class="op" id="4396618">=</span>&nbsp;<span class="ident" id="4396620">parseUTCTime</span><span class="op" id="4396632">(</span><span class="ident" id="4396633">innerBytes</span><span class="op" id="4396643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396648">case</span>&nbsp;<span class="ident" id="4396653">tagOctetString</span><span class="op" id="4396667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396673">result</span>&nbsp;<span class="op" id="4396680">=</span>&nbsp;<span class="ident" id="4396682">innerBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396696">default</span><span class="op" id="4396703">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4396709">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4396784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4396788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396792">offset</span>&nbsp;<span class="op" id="4396799">+=</span>&nbsp;<span class="ident" id="4396802">t</span><span class="op" id="4396803">.</span><span class="ident" id="4396804">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396813">if</span>&nbsp;<span class="ident" id="4396816">err</span>&nbsp;<span class="op" id="4396820">!=</span>&nbsp;<span class="ident" id="4396823">nil</span>&nbsp;<span class="op" id="4396827">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396832">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4396841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396845">if</span>&nbsp;<span class="ident" id="4396848">result</span>&nbsp;<span class="op" id="4396855">!=</span>&nbsp;<span class="ident" id="4396858">nil</span>&nbsp;<span class="op" id="4396862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396867">v</span><span class="op" id="4396868">.</span><span class="ident" id="4396869">Set</span><span class="op" id="4396872">(</span><span class="ident" id="4396873">reflect</span><span class="op" id="4396880">.</span><span class="ident" id="4396881">ValueOf</span><span class="op" id="4396888">(</span><span class="ident" id="4396889">result</span><span class="op" id="4396895">)</span><span class="op" id="4396896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4396900">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396904">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4396912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396915">universalTag</span><span class="op" id="4396927">,</span>&nbsp;<span class="ident" id="4396929">compoundType</span><span class="op" id="4396941">,</span>&nbsp;<span class="ident" id="4396943">ok1</span>&nbsp;<span class="op" id="4396947">:=</span>&nbsp;<span class="ident" id="4396950">getUniversalType</span><span class="op" id="4396966">(</span><span class="ident" id="4396967">fieldType</span><span class="op" id="4396976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396979">if</span>&nbsp;<span class="op" id="4396982">!</span><span class="ident" id="4396983">ok1</span>&nbsp;<span class="op" id="4396987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396991">err</span>&nbsp;<span class="op" id="4396995">=</span>&nbsp;<span class="ident" id="4396997">StructuralError</span><span class="op" id="4397012">{</span><span class="ident" id="4397013">fmt</span><span class="op" id="4397016">.</span><span class="ident" id="4397017">Sprintf</span><span class="op" id="4397024">(</span><span class="string" id="4397025">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4397046">,</span>&nbsp;<span class="ident" id="4397048">fieldType</span><span class="op" id="4397057">)</span><span class="op" id="4397058">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397062">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4397074">t</span><span class="op" id="4397075">,</span>&nbsp;<span class="ident" id="4397077">offset</span><span class="op" id="4397083">,</span>&nbsp;<span class="ident" id="4397085">err</span>&nbsp;<span class="op" id="4397089">:=</span>&nbsp;<span class="ident" id="4397092">parseTagAndLength</span><span class="op" id="4397109">(</span><span class="ident" id="4397110">bytes</span><span class="op" id="4397115">,</span>&nbsp;<span class="ident" id="4397117">offset</span><span class="op" id="4397123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397126">if</span>&nbsp;<span class="ident" id="4397129">err</span>&nbsp;<span class="op" id="4397133">!=</span>&nbsp;<span class="ident" id="4397136">nil</span>&nbsp;<span class="op" id="4397140">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397144">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397155">if</span>&nbsp;<span class="ident" id="4397158">params</span><span class="op" id="4397164">.</span><span class="ident" id="4397165">explicit</span>&nbsp;<span class="op" id="4397174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4397178">expectedClass</span>&nbsp;<span class="op" id="4397192">:=</span>&nbsp;<span class="ident" id="4397195">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397218">if</span>&nbsp;<span class="ident" id="4397221">params</span><span class="op" id="4397227">.</span><span class="ident" id="4397228">application</span>&nbsp;<span class="op" id="4397240">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4397245">expectedClass</span>&nbsp;<span class="op" id="4397259">=</span>&nbsp;<span class="ident" id="4397261">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397284">if</span>&nbsp;<span class="ident" id="4397287">t</span><span class="op" id="4397288">.</span><span class="ident" id="4397289">class</span>&nbsp;<span class="op" id="4397295">==</span>&nbsp;<span class="ident" id="4397298">expectedClass</span>&nbsp;<span class="op" id="4397312">&amp;&amp;</span>&nbsp;<span class="ident" id="4397315">t</span><span class="op" id="4397316">.</span><span class="ident" id="4397317">tag</span>&nbsp;<span class="op" id="4397321">==</span>&nbsp;<span class="op" id="4397324">*</span><span class="ident" id="4397325">params</span><span class="op" id="4397331">.</span><span class="ident" id="4397332">tag</span>&nbsp;<span class="op" id="4397336">&amp;&amp;</span>&nbsp;<span class="op" id="4397339">(</span><span class="ident" id="4397340">t</span><span class="op" id="4397341">.</span><span class="ident" id="4397342">length</span>&nbsp;<span class="op" id="4397349">==</span>&nbsp;<span class="num" id="4397352">0</span>&nbsp;<span class="op" id="4397354">||</span>&nbsp;<span class="ident" id="4397357">t</span><span class="op" id="4397358">.</span><span class="ident" id="4397359">isCompound</span><span class="op" id="4397369">)</span>&nbsp;<span class="op" id="4397371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397376">if</span>&nbsp;<span class="ident" id="4397379">t</span><span class="op" id="4397380">.</span><span class="ident" id="4397381">length</span>&nbsp;<span class="op" id="4397388">&gt;</span>&nbsp;<span class="num" id="4397390">0</span>&nbsp;<span class="op" id="4397392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4397398">t</span><span class="op" id="4397399">,</span>&nbsp;<span class="ident" id="4397401">offset</span><span class="op" id="4397407">,</span>&nbsp;<span class="ident" id="4397409">err</span>&nbsp;<span class="op" id="4397413">=</span>&nbsp;<span class="ident" id="4397415">parseTagAndLength</span><span class="op" id="4397432">(</span><span class="ident" id="4397433">bytes</span><span class="op" id="4397438">,</span>&nbsp;<span class="ident" id="4397440">offset</span><span class="op" id="4397446">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397452">if</span>&nbsp;<span class="ident" id="4397455">err</span>&nbsp;<span class="op" id="4397459">!=</span>&nbsp;<span class="ident" id="4397462">nil</span>&nbsp;<span class="op" id="4397466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397473">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397489">}</span>&nbsp;<span class="keyword" id="4397491">else</span>&nbsp;<span class="op" id="4397496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397502">if</span>&nbsp;<span class="ident" id="4397505">fieldType</span>&nbsp;<span class="op" id="4397515">!=</span>&nbsp;<span class="ident" id="4397518">flagType</span>&nbsp;<span class="op" id="4397527">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4397534">err</span>&nbsp;<span class="op" id="4397538">=</span>&nbsp;<span class="ident" id="4397540">StructuralError</span><span class="op" id="4397555">{</span><span class="string" id="4397556">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="4397603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397610">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4397627">v</span><span class="op" id="4397628">.</span><span class="ident" id="4397629">SetBool</span><span class="op" id="4397636">(</span><span class="builtintype" id="4397637">true</span><span class="op" id="4397641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397647">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397661">}</span>&nbsp;<span class="keyword" id="4397663">else</span>&nbsp;<span class="op" id="4397668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4397673">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4397735">ok</span>&nbsp;<span class="op" id="4397738">:=</span>&nbsp;<span class="ident" id="4397741">setDefaultValue</span><span class="op" id="4397756">(</span><span class="ident" id="4397757">v</span><span class="op" id="4397758">,</span>&nbsp;<span class="ident" id="4397760">params</span><span class="op" id="4397766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397771">if</span>&nbsp;<span class="ident" id="4397774">ok</span>&nbsp;<span class="op" id="4397777">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4397783">offset</span>&nbsp;<span class="op" id="4397790">=</span>&nbsp;<span class="ident" id="4397792">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397806">}</span>&nbsp;<span class="keyword" id="4397808">else</span>&nbsp;<span class="op" id="4397813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4397819">err</span>&nbsp;<span class="op" id="4397823">=</span>&nbsp;<span class="ident" id="4397825">StructuralError</span><span class="op" id="4397840">{</span><span class="string" id="4397841">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="4397880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397890">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4397906">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4397977">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4398047">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4398118">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398167">if</span>&nbsp;<span class="ident" id="4398170">universalTag</span>&nbsp;<span class="op" id="4398183">==</span>&nbsp;<span class="ident" id="4398186">tagPrintableString</span>&nbsp;<span class="op" id="4398205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398209">if</span>&nbsp;<span class="ident" id="4398212">t</span><span class="op" id="4398213">.</span><span class="ident" id="4398214">class</span>&nbsp;<span class="op" id="4398220">==</span>&nbsp;<span class="ident" id="4398223">classUniversal</span>&nbsp;<span class="op" id="4398238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398243">switch</span>&nbsp;<span class="ident" id="4398250">t</span><span class="op" id="4398251">.</span><span class="ident" id="4398252">tag</span>&nbsp;<span class="op" id="4398256">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398261">case</span>&nbsp;<span class="ident" id="4398266">tagIA5String</span><span class="op" id="4398278">,</span>&nbsp;<span class="ident" id="4398280">tagGeneralString</span><span class="op" id="4398296">,</span>&nbsp;<span class="ident" id="4398298">tagT61String</span><span class="op" id="4398310">,</span>&nbsp;<span class="ident" id="4398312">tagUTF8String</span><span class="op" id="4398325">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398331">universalTag</span>&nbsp;<span class="op" id="4398344">=</span>&nbsp;<span class="ident" id="4398346">t</span><span class="op" id="4398347">.</span><span class="ident" id="4398348">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4398355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4398359">}</span>&nbsp;<span class="keyword" id="4398361">else</span>&nbsp;<span class="keyword" id="4398366">if</span>&nbsp;<span class="ident" id="4398369">params</span><span class="op" id="4398375">.</span><span class="ident" id="4398376">stringType</span>&nbsp;<span class="op" id="4398387">!=</span>&nbsp;<span class="num" id="4398390">0</span>&nbsp;<span class="op" id="4398392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398397">universalTag</span>&nbsp;<span class="op" id="4398410">=</span>&nbsp;<span class="ident" id="4398412">params</span><span class="op" id="4398418">.</span><span class="ident" id="4398419">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4398432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4398435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4398439">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4398510">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398533">if</span>&nbsp;<span class="ident" id="4398536">universalTag</span>&nbsp;<span class="op" id="4398549">==</span>&nbsp;<span class="ident" id="4398552">tagUTCTime</span>&nbsp;<span class="op" id="4398563">&amp;&amp;</span>&nbsp;<span class="ident" id="4398566">t</span><span class="op" id="4398567">.</span><span class="ident" id="4398568">tag</span>&nbsp;<span class="op" id="4398572">==</span>&nbsp;<span class="ident" id="4398575">tagGeneralizedTime</span>&nbsp;<span class="op" id="4398594">&amp;&amp;</span>&nbsp;<span class="ident" id="4398597">t</span><span class="op" id="4398598">.</span><span class="ident" id="4398599">class</span>&nbsp;<span class="op" id="4398605">==</span>&nbsp;<span class="ident" id="4398608">classUniversal</span>&nbsp;<span class="op" id="4398623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398627">universalTag</span>&nbsp;<span class="op" id="4398640">=</span>&nbsp;<span class="ident" id="4398642">tagGeneralizedTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4398662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398666">if</span>&nbsp;<span class="ident" id="4398669">params</span><span class="op" id="4398675">.</span><span class="ident" id="4398676">set</span>&nbsp;<span class="op" id="4398680">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398684">universalTag</span>&nbsp;<span class="op" id="4398697">=</span>&nbsp;<span class="ident" id="4398699">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4398707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398711">expectedClass</span>&nbsp;<span class="op" id="4398725">:=</span>&nbsp;<span class="ident" id="4398728">classUniversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398744">expectedTag</span>&nbsp;<span class="op" id="4398756">:=</span>&nbsp;<span class="ident" id="4398759">universalTag</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398774">if</span>&nbsp;<span class="op" id="4398777">!</span><span class="ident" id="4398778">params</span><span class="op" id="4398784">.</span><span class="ident" id="4398785">explicit</span>&nbsp;<span class="op" id="4398794">&amp;&amp;</span>&nbsp;<span class="ident" id="4398797">params</span><span class="op" id="4398803">.</span><span class="ident" id="4398804">tag</span>&nbsp;<span class="op" id="4398808">!=</span>&nbsp;<span class="ident" id="4398811">nil</span>&nbsp;<span class="op" id="4398815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398819">expectedClass</span>&nbsp;<span class="op" id="4398833">=</span>&nbsp;<span class="ident" id="4398835">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398858">expectedTag</span>&nbsp;<span class="op" id="4398870">=</span>&nbsp;<span class="op" id="4398872">*</span><span class="ident" id="4398873">params</span><span class="op" id="4398879">.</span><span class="ident" id="4398880">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4398885">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398889">if</span>&nbsp;<span class="op" id="4398892">!</span><span class="ident" id="4398893">params</span><span class="op" id="4398899">.</span><span class="ident" id="4398900">explicit</span>&nbsp;<span class="op" id="4398909">&amp;&amp;</span>&nbsp;<span class="ident" id="4398912">params</span><span class="op" id="4398918">.</span><span class="ident" id="4398919">application</span>&nbsp;<span class="op" id="4398931">&amp;&amp;</span>&nbsp;<span class="ident" id="4398934">params</span><span class="op" id="4398940">.</span><span class="ident" id="4398941">tag</span>&nbsp;<span class="op" id="4398945">!=</span>&nbsp;<span class="ident" id="4398948">nil</span>&nbsp;<span class="op" id="4398952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398956">expectedClass</span>&nbsp;<span class="op" id="4398970">=</span>&nbsp;<span class="ident" id="4398972">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398991">expectedTag</span>&nbsp;<span class="op" id="4399003">=</span>&nbsp;<span class="op" id="4399005">*</span><span class="ident" id="4399006">params</span><span class="op" id="4399012">.</span><span class="ident" id="4399013">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4399018">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4399022">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399080">if</span>&nbsp;<span class="ident" id="4399083">t</span><span class="op" id="4399084">.</span><span class="ident" id="4399085">class</span>&nbsp;<span class="op" id="4399091">!=</span>&nbsp;<span class="ident" id="4399094">expectedClass</span>&nbsp;<span class="op" id="4399108">||</span>&nbsp;<span class="ident" id="4399111">t</span><span class="op" id="4399112">.</span><span class="ident" id="4399113">tag</span>&nbsp;<span class="op" id="4399117">!=</span>&nbsp;<span class="ident" id="4399120">expectedTag</span>&nbsp;<span class="op" id="4399132">||</span>&nbsp;<span class="ident" id="4399135">t</span><span class="op" id="4399136">.</span><span class="ident" id="4399137">isCompound</span>&nbsp;<span class="op" id="4399148">!=</span>&nbsp;<span class="ident" id="4399151">compoundType</span>&nbsp;<span class="op" id="4399164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4399168">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399231">ok</span>&nbsp;<span class="op" id="4399234">:=</span>&nbsp;<span class="ident" id="4399237">setDefaultValue</span><span class="op" id="4399252">(</span><span class="ident" id="4399253">v</span><span class="op" id="4399254">,</span>&nbsp;<span class="ident" id="4399256">params</span><span class="op" id="4399262">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399266">if</span>&nbsp;<span class="ident" id="4399269">ok</span>&nbsp;<span class="op" id="4399272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399277">offset</span>&nbsp;<span class="op" id="4399284">=</span>&nbsp;<span class="ident" id="4399286">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4399299">}</span>&nbsp;<span class="keyword" id="4399301">else</span>&nbsp;<span class="op" id="4399306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399311">err</span>&nbsp;<span class="op" id="4399315">=</span>&nbsp;<span class="ident" id="4399317">StructuralError</span><span class="op" id="4399332">{</span><span class="ident" id="4399333">fmt</span><span class="op" id="4399336">.</span><span class="ident" id="4399337">Sprintf</span><span class="op" id="4399344">(</span><span class="string" id="4399345">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="4399386">,</span>&nbsp;<span class="ident" id="4399388">expectedTag</span><span class="op" id="4399399">,</span>&nbsp;<span class="ident" id="4399401">t</span><span class="op" id="4399402">,</span>&nbsp;<span class="ident" id="4399404">params</span><span class="op" id="4399410">,</span>&nbsp;<span class="ident" id="4399412">fieldType</span><span class="op" id="4399421">.</span><span class="ident" id="4399422">Name</span><span class="op" id="4399426">(</span><span class="op" id="4399427">)</span><span class="op" id="4399428">,</span>&nbsp;<span class="ident" id="4399430">offset</span><span class="op" id="4399436">)</span><span class="op" id="4399437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4399441">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399445">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4399453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399456">if</span>&nbsp;<span class="ident" id="4399459">invalidLength</span><span class="op" id="4399472">(</span><span class="ident" id="4399473">offset</span><span class="op" id="4399479">,</span>&nbsp;<span class="ident" id="4399481">t</span><span class="op" id="4399482">.</span><span class="ident" id="4399483">length</span><span class="op" id="4399489">,</span>&nbsp;<span class="builtinfunc" id="4399491">len</span><span class="op" id="4399494">(</span><span class="ident" id="4399495">bytes</span><span class="op" id="4399500">)</span><span class="op" id="4399501">)</span>&nbsp;<span class="op" id="4399503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399507">err</span>&nbsp;<span class="op" id="4399511">=</span>&nbsp;<span class="ident" id="4399513">SyntaxError</span><span class="op" id="4399524">{</span><span class="string" id="4399525">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4399541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399545">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4399553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399556">innerBytes</span>&nbsp;<span class="op" id="4399567">:=</span>&nbsp;<span class="ident" id="4399570">bytes</span><span class="op" id="4399575">[</span><span class="ident" id="4399576">offset</span>&nbsp;<span class="op" id="4399583">:</span>&nbsp;<span class="ident" id="4399585">offset</span><span class="op" id="4399591">+</span><span class="ident" id="4399592">t</span><span class="op" id="4399593">.</span><span class="ident" id="4399594">length</span><span class="op" id="4399600">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399603">offset</span>&nbsp;<span class="op" id="4399610">+=</span>&nbsp;<span class="ident" id="4399613">t</span><span class="op" id="4399614">.</span><span class="ident" id="4399615">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4399624">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399687">switch</span>&nbsp;<span class="ident" id="4399694">fieldType</span>&nbsp;<span class="op" id="4399704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399707">case</span>&nbsp;<span class="ident" id="4399712">objectIdentifierType</span><span class="op" id="4399732">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399736">newSlice</span><span class="op" id="4399744">,</span>&nbsp;<span class="ident" id="4399746">err1</span>&nbsp;<span class="op" id="4399751">:=</span>&nbsp;<span class="ident" id="4399754">parseObjectIdentifier</span><span class="op" id="4399775">(</span><span class="ident" id="4399776">innerBytes</span><span class="op" id="4399786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399790">v</span><span class="op" id="4399791">.</span><span class="ident" id="4399792">Set</span><span class="op" id="4399795">(</span><span class="ident" id="4399796">reflect</span><span class="op" id="4399803">.</span><span class="ident" id="4399804">MakeSlice</span><span class="op" id="4399813">(</span><span class="ident" id="4399814">v</span><span class="op" id="4399815">.</span><span class="ident" id="4399816">Type</span><span class="op" id="4399820">(</span><span class="op" id="4399821">)</span><span class="op" id="4399822">,</span>&nbsp;<span class="builtinfunc" id="4399824">len</span><span class="op" id="4399827">(</span><span class="ident" id="4399828">newSlice</span><span class="op" id="4399836">)</span><span class="op" id="4399837">,</span>&nbsp;<span class="builtinfunc" id="4399839">len</span><span class="op" id="4399842">(</span><span class="ident" id="4399843">newSlice</span><span class="op" id="4399851">)</span><span class="op" id="4399852">)</span><span class="op" id="4399853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399857">if</span>&nbsp;<span class="ident" id="4399860">err1</span>&nbsp;<span class="op" id="4399865">==</span>&nbsp;<span class="ident" id="4399868">nil</span>&nbsp;<span class="op" id="4399872">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399877">reflect</span><span class="op" id="4399884">.</span><span class="ident" id="4399885">Copy</span><span class="op" id="4399889">(</span><span class="ident" id="4399890">v</span><span class="op" id="4399891">,</span>&nbsp;<span class="ident" id="4399893">reflect</span><span class="op" id="4399900">.</span><span class="ident" id="4399901">ValueOf</span><span class="op" id="4399908">(</span><span class="ident" id="4399909">newSlice</span><span class="op" id="4399917">)</span><span class="op" id="4399918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4399922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399926">err</span>&nbsp;<span class="op" id="4399930">=</span>&nbsp;<span class="ident" id="4399932">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399939">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399947">case</span>&nbsp;<span class="ident" id="4399952">bitStringType</span><span class="op" id="4399965">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399969">bs</span><span class="op" id="4399971">,</span>&nbsp;<span class="ident" id="4399973">err1</span>&nbsp;<span class="op" id="4399978">:=</span>&nbsp;<span class="ident" id="4399981">parseBitString</span><span class="op" id="4399995">(</span><span class="ident" id="4399996">innerBytes</span><span class="op" id="4400006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400010">if</span>&nbsp;<span class="ident" id="4400013">err1</span>&nbsp;<span class="op" id="4400018">==</span>&nbsp;<span class="ident" id="4400021">nil</span>&nbsp;<span class="op" id="4400025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400030">v</span><span class="op" id="4400031">.</span><span class="ident" id="4400032">Set</span><span class="op" id="4400035">(</span><span class="ident" id="4400036">reflect</span><span class="op" id="4400043">.</span><span class="ident" id="4400044">ValueOf</span><span class="op" id="4400051">(</span><span class="ident" id="4400052">bs</span><span class="op" id="4400054">)</span><span class="op" id="4400055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400063">err</span>&nbsp;<span class="op" id="4400067">=</span>&nbsp;<span class="ident" id="4400069">err1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400076">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400084">case</span>&nbsp;<span class="ident" id="4400089">timeType</span><span class="op" id="4400097">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400101">var</span>&nbsp;<span class="ident" id="4400105">time</span>&nbsp;<span class="ident" id="4400110">time</span><span class="op" id="4400114">.</span><span class="ident" id="4400115">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400122">var</span>&nbsp;<span class="ident" id="4400126">err1</span>&nbsp;<span class="builtintype" id="4400131">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400139">if</span>&nbsp;<span class="ident" id="4400142">universalTag</span>&nbsp;<span class="op" id="4400155">==</span>&nbsp;<span class="ident" id="4400158">tagUTCTime</span>&nbsp;<span class="op" id="4400169">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400174">time</span><span class="op" id="4400178">,</span>&nbsp;<span class="ident" id="4400180">err1</span>&nbsp;<span class="op" id="4400185">=</span>&nbsp;<span class="ident" id="4400187">parseUTCTime</span><span class="op" id="4400199">(</span><span class="ident" id="4400200">innerBytes</span><span class="op" id="4400210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400214">}</span>&nbsp;<span class="keyword" id="4400216">else</span>&nbsp;<span class="op" id="4400221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400226">time</span><span class="op" id="4400230">,</span>&nbsp;<span class="ident" id="4400232">err1</span>&nbsp;<span class="op" id="4400237">=</span>&nbsp;<span class="ident" id="4400239">parseGeneralizedTime</span><span class="op" id="4400259">(</span><span class="ident" id="4400260">innerBytes</span><span class="op" id="4400270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400278">if</span>&nbsp;<span class="ident" id="4400281">err1</span>&nbsp;<span class="op" id="4400286">==</span>&nbsp;<span class="ident" id="4400289">nil</span>&nbsp;<span class="op" id="4400293">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400298">v</span><span class="op" id="4400299">.</span><span class="ident" id="4400300">Set</span><span class="op" id="4400303">(</span><span class="ident" id="4400304">reflect</span><span class="op" id="4400311">.</span><span class="ident" id="4400312">ValueOf</span><span class="op" id="4400319">(</span><span class="ident" id="4400320">time</span><span class="op" id="4400324">)</span><span class="op" id="4400325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400333">err</span>&nbsp;<span class="op" id="4400337">=</span>&nbsp;<span class="ident" id="4400339">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400346">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400354">case</span>&nbsp;<span class="ident" id="4400359">enumeratedType</span><span class="op" id="4400373">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400377">parsedInt</span><span class="op" id="4400386">,</span>&nbsp;<span class="ident" id="4400388">err1</span>&nbsp;<span class="op" id="4400393">:=</span>&nbsp;<span class="ident" id="4400396">parseInt32</span><span class="op" id="4400406">(</span><span class="ident" id="4400407">innerBytes</span><span class="op" id="4400417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400421">if</span>&nbsp;<span class="ident" id="4400424">err1</span>&nbsp;<span class="op" id="4400429">==</span>&nbsp;<span class="ident" id="4400432">nil</span>&nbsp;<span class="op" id="4400436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400441">v</span><span class="op" id="4400442">.</span><span class="ident" id="4400443">SetInt</span><span class="op" id="4400449">(</span><span class="ident" id="4400450">int64</span><span class="op" id="4400455">(</span><span class="ident" id="4400456">parsedInt</span><span class="op" id="4400465">)</span><span class="op" id="4400466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400474">err</span>&nbsp;<span class="op" id="4400478">=</span>&nbsp;<span class="ident" id="4400480">err1</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400487">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400495">case</span>&nbsp;<span class="ident" id="4400500">flagType</span><span class="op" id="4400508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400512">v</span><span class="op" id="4400513">.</span><span class="ident" id="4400514">SetBool</span><span class="op" id="4400521">(</span><span class="builtintype" id="4400522">true</span><span class="op" id="4400526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400530">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400538">case</span>&nbsp;<span class="ident" id="4400543">bigIntType</span><span class="op" id="4400553">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400557">parsedInt</span>&nbsp;<span class="op" id="4400567">:=</span>&nbsp;<span class="ident" id="4400570">parseBigInt</span><span class="op" id="4400581">(</span><span class="ident" id="4400582">innerBytes</span><span class="op" id="4400592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400596">v</span><span class="op" id="4400597">.</span><span class="ident" id="4400598">Set</span><span class="op" id="4400601">(</span><span class="ident" id="4400602">reflect</span><span class="op" id="4400609">.</span><span class="ident" id="4400610">ValueOf</span><span class="op" id="4400617">(</span><span class="ident" id="4400618">parsedInt</span><span class="op" id="4400627">)</span><span class="op" id="4400628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400632">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400643">switch</span>&nbsp;<span class="ident" id="4400650">val</span>&nbsp;<span class="op" id="4400654">:=</span>&nbsp;<span class="ident" id="4400657">v</span><span class="op" id="4400658">;</span>&nbsp;<span class="ident" id="4400660">val</span><span class="op" id="4400663">.</span><span class="ident" id="4400664">Kind</span><span class="op" id="4400668">(</span><span class="op" id="4400669">)</span>&nbsp;<span class="op" id="4400671">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400674">case</span>&nbsp;<span class="ident" id="4400679">reflect</span><span class="op" id="4400686">.</span><span class="ident" id="4400687">Bool</span><span class="op" id="4400691">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400695">parsedBool</span><span class="op" id="4400705">,</span>&nbsp;<span class="ident" id="4400707">err1</span>&nbsp;<span class="op" id="4400712">:=</span>&nbsp;<span class="ident" id="4400715">parseBool</span><span class="op" id="4400724">(</span><span class="ident" id="4400725">innerBytes</span><span class="op" id="4400735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400739">if</span>&nbsp;<span class="ident" id="4400742">err1</span>&nbsp;<span class="op" id="4400747">==</span>&nbsp;<span class="ident" id="4400750">nil</span>&nbsp;<span class="op" id="4400754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400759">val</span><span class="op" id="4400762">.</span><span class="ident" id="4400763">SetBool</span><span class="op" id="4400770">(</span><span class="ident" id="4400771">parsedBool</span><span class="op" id="4400781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400785">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400789">err</span>&nbsp;<span class="op" id="4400793">=</span>&nbsp;<span class="ident" id="4400795">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400802">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400810">case</span>&nbsp;<span class="ident" id="4400815">reflect</span><span class="op" id="4400822">.</span><span class="ident" id="4400823">Int</span><span class="op" id="4400826">,</span>&nbsp;<span class="ident" id="4400828">reflect</span><span class="op" id="4400835">.</span><span class="ident" id="4400836">Int32</span><span class="op" id="4400841">,</span>&nbsp;<span class="ident" id="4400843">reflect</span><span class="op" id="4400850">.</span><span class="ident" id="4400851">Int64</span><span class="op" id="4400856">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400860">if</span>&nbsp;<span class="ident" id="4400863">val</span><span class="op" id="4400866">.</span><span class="ident" id="4400867">Type</span><span class="op" id="4400871">(</span><span class="op" id="4400872">)</span><span class="op" id="4400873">.</span><span class="ident" id="4400874">Size</span><span class="op" id="4400878">(</span><span class="op" id="4400879">)</span>&nbsp;<span class="op" id="4400881">==</span>&nbsp;<span class="num" id="4400884">4</span>&nbsp;<span class="op" id="4400886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400891">parsedInt</span><span class="op" id="4400900">,</span>&nbsp;<span class="ident" id="4400902">err1</span>&nbsp;<span class="op" id="4400907">:=</span>&nbsp;<span class="ident" id="4400910">parseInt32</span><span class="op" id="4400920">(</span><span class="ident" id="4400921">innerBytes</span><span class="op" id="4400931">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400936">if</span>&nbsp;<span class="ident" id="4400939">err1</span>&nbsp;<span class="op" id="4400944">==</span>&nbsp;<span class="ident" id="4400947">nil</span>&nbsp;<span class="op" id="4400951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400957">val</span><span class="op" id="4400960">.</span><span class="ident" id="4400961">SetInt</span><span class="op" id="4400967">(</span><span class="ident" id="4400968">int64</span><span class="op" id="4400973">(</span><span class="ident" id="4400974">parsedInt</span><span class="op" id="4400983">)</span><span class="op" id="4400984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400994">err</span>&nbsp;<span class="op" id="4400998">=</span>&nbsp;<span class="ident" id="4401000">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4401007">}</span>&nbsp;<span class="keyword" id="4401009">else</span>&nbsp;<span class="op" id="4401014">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401019">parsedInt</span><span class="op" id="4401028">,</span>&nbsp;<span class="ident" id="4401030">err1</span>&nbsp;<span class="op" id="4401035">:=</span>&nbsp;<span class="ident" id="4401038">parseInt64</span><span class="op" id="4401048">(</span><span class="ident" id="4401049">innerBytes</span><span class="op" id="4401059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401064">if</span>&nbsp;<span class="ident" id="4401067">err1</span>&nbsp;<span class="op" id="4401072">==</span>&nbsp;<span class="ident" id="4401075">nil</span>&nbsp;<span class="op" id="4401079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401085">val</span><span class="op" id="4401088">.</span><span class="ident" id="4401089">SetInt</span><span class="op" id="4401095">(</span><span class="ident" id="4401096">parsedInt</span><span class="op" id="4401105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4401110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401115">err</span>&nbsp;<span class="op" id="4401119">=</span>&nbsp;<span class="ident" id="4401121">err1</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4401128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401132">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4401140">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401198">case</span>&nbsp;<span class="ident" id="4401203">reflect</span><span class="op" id="4401210">.</span><span class="ident" id="4401211">Struct</span><span class="op" id="4401217">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401221">structType</span>&nbsp;<span class="op" id="4401232">:=</span>&nbsp;<span class="ident" id="4401235">fieldType</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401248">if</span>&nbsp;<span class="ident" id="4401251">structType</span><span class="op" id="4401261">.</span><span class="ident" id="4401262">NumField</span><span class="op" id="4401270">(</span><span class="op" id="4401271">)</span>&nbsp;<span class="op" id="4401273">&gt;</span>&nbsp;<span class="num" id="4401275">0</span>&nbsp;<span class="op" id="4401277">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401283">structType</span><span class="op" id="4401293">.</span><span class="ident" id="4401294">Field</span><span class="op" id="4401299">(</span><span class="num" id="4401300">0</span><span class="op" id="4401301">)</span><span class="op" id="4401302">.</span><span class="ident" id="4401303">Type</span>&nbsp;<span class="op" id="4401308">==</span>&nbsp;<span class="ident" id="4401311">rawContentsType</span>&nbsp;<span class="op" id="4401327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401332">bytes</span>&nbsp;<span class="op" id="4401338">:=</span>&nbsp;<span class="ident" id="4401341">bytes</span><span class="op" id="4401346">[</span><span class="ident" id="4401347">initOffset</span><span class="op" id="4401357">:</span><span class="ident" id="4401358">offset</span><span class="op" id="4401364">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401369">val</span><span class="op" id="4401372">.</span><span class="ident" id="4401373">Field</span><span class="op" id="4401378">(</span><span class="num" id="4401379">0</span><span class="op" id="4401380">)</span><span class="op" id="4401381">.</span><span class="ident" id="4401382">Set</span><span class="op" id="4401385">(</span><span class="ident" id="4401386">reflect</span><span class="op" id="4401393">.</span><span class="ident" id="4401394">ValueOf</span><span class="op" id="4401401">(</span><span class="ident" id="4401402">RawContent</span><span class="op" id="4401412">(</span><span class="ident" id="4401413">bytes</span><span class="op" id="4401418">)</span><span class="op" id="4401419">)</span><span class="op" id="4401420">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4401424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401429">innerOffset</span>&nbsp;<span class="op" id="4401441">:=</span>&nbsp;<span class="num" id="4401444">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401448">for</span>&nbsp;<span class="ident" id="4401452">i</span>&nbsp;<span class="op" id="4401454">:=</span>&nbsp;<span class="num" id="4401457">0</span><span class="op" id="4401458">;</span>&nbsp;<span class="ident" id="4401460">i</span>&nbsp;<span class="op" id="4401462">&lt;</span>&nbsp;<span class="ident" id="4401464">structType</span><span class="op" id="4401474">.</span><span class="ident" id="4401475">NumField</span><span class="op" id="4401483">(</span><span class="op" id="4401484">)</span><span class="op" id="4401485">;</span>&nbsp;<span class="ident" id="4401487">i</span><span class="op" id="4401488">++</span>&nbsp;<span class="op" id="4401491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401496">field</span>&nbsp;<span class="op" id="4401502">:=</span>&nbsp;<span class="ident" id="4401505">structType</span><span class="op" id="4401515">.</span><span class="ident" id="4401516">Field</span><span class="op" id="4401521">(</span><span class="ident" id="4401522">i</span><span class="op" id="4401523">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401528">if</span>&nbsp;<span class="ident" id="4401531">i</span>&nbsp;<span class="op" id="4401533">==</span>&nbsp;<span class="num" id="4401536">0</span>&nbsp;<span class="op" id="4401538">&amp;&amp;</span>&nbsp;<span class="ident" id="4401541">field</span><span class="op" id="4401546">.</span><span class="ident" id="4401547">Type</span>&nbsp;<span class="op" id="4401552">==</span>&nbsp;<span class="ident" id="4401555">rawContentsType</span>&nbsp;<span class="op" id="4401571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401577">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4401589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401594">innerOffset</span><span class="op" id="4401605">,</span>&nbsp;<span class="ident" id="4401607">err</span>&nbsp;<span class="op" id="4401611">=</span>&nbsp;<span class="ident" id="4401613">parseField</span><span class="op" id="4401623">(</span><span class="ident" id="4401624">val</span><span class="op" id="4401627">.</span><span class="ident" id="4401628">Field</span><span class="op" id="4401633">(</span><span class="ident" id="4401634">i</span><span class="op" id="4401635">)</span><span class="op" id="4401636">,</span>&nbsp;<span class="ident" id="4401638">innerBytes</span><span class="op" id="4401648">,</span>&nbsp;<span class="ident" id="4401650">innerOffset</span><span class="op" id="4401661">,</span>&nbsp;<span class="ident" id="4401663">parseFieldParameters</span><span class="op" id="4401683">(</span><span class="ident" id="4401684">field</span><span class="op" id="4401689">.</span><span class="ident" id="4401690">Tag</span><span class="op" id="4401693">.</span><span class="ident" id="4401694">Get</span><span class="op" id="4401697">(</span><span class="string" id="4401698">&#34;asn1&#34;</span><span class="op" id="4401704">)</span><span class="op" id="4401705">)</span><span class="op" id="4401706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401711">if</span>&nbsp;<span class="ident" id="4401714">err</span>&nbsp;<span class="op" id="4401718">!=</span>&nbsp;<span class="ident" id="4401721">nil</span>&nbsp;<span class="op" id="4401725">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401731">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4401741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4401745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4401749">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4401810">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4401872">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401909">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401917">case</span>&nbsp;<span class="ident" id="4401922">reflect</span><span class="op" id="4401929">.</span><span class="ident" id="4401930">Slice</span><span class="op" id="4401935">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401939">sliceType</span>&nbsp;<span class="op" id="4401949">:=</span>&nbsp;<span class="ident" id="4401952">fieldType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401964">if</span>&nbsp;<span class="ident" id="4401967">sliceType</span><span class="op" id="4401976">.</span><span class="ident" id="4401977">Elem</span><span class="op" id="4401981">(</span><span class="op" id="4401982">)</span><span class="op" id="4401983">.</span><span class="ident" id="4401984">Kind</span><span class="op" id="4401988">(</span><span class="op" id="4401989">)</span>&nbsp;<span class="op" id="4401991">==</span>&nbsp;<span class="ident" id="4401994">reflect</span><span class="op" id="4402001">.</span><span class="ident" id="4402002">Uint8</span>&nbsp;<span class="op" id="4402008">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402013">val</span><span class="op" id="4402016">.</span><span class="ident" id="4402017">Set</span><span class="op" id="4402020">(</span><span class="ident" id="4402021">reflect</span><span class="op" id="4402028">.</span><span class="ident" id="4402029">MakeSlice</span><span class="op" id="4402038">(</span><span class="ident" id="4402039">sliceType</span><span class="op" id="4402048">,</span>&nbsp;<span class="builtinfunc" id="4402050">len</span><span class="op" id="4402053">(</span><span class="ident" id="4402054">innerBytes</span><span class="op" id="4402064">)</span><span class="op" id="4402065">,</span>&nbsp;<span class="builtinfunc" id="4402067">len</span><span class="op" id="4402070">(</span><span class="ident" id="4402071">innerBytes</span><span class="op" id="4402081">)</span><span class="op" id="4402082">)</span><span class="op" id="4402083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402088">reflect</span><span class="op" id="4402095">.</span><span class="ident" id="4402096">Copy</span><span class="op" id="4402100">(</span><span class="ident" id="4402101">val</span><span class="op" id="4402104">,</span>&nbsp;<span class="ident" id="4402106">reflect</span><span class="op" id="4402113">.</span><span class="ident" id="4402114">ValueOf</span><span class="op" id="4402121">(</span><span class="ident" id="4402122">innerBytes</span><span class="op" id="4402132">)</span><span class="op" id="4402133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402138">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4402147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402151">newSlice</span><span class="op" id="4402159">,</span>&nbsp;<span class="ident" id="4402161">err1</span>&nbsp;<span class="op" id="4402166">:=</span>&nbsp;<span class="ident" id="4402169">parseSequenceOf</span><span class="op" id="4402184">(</span><span class="ident" id="4402185">innerBytes</span><span class="op" id="4402195">,</span>&nbsp;<span class="ident" id="4402197">sliceType</span><span class="op" id="4402206">,</span>&nbsp;<span class="ident" id="4402208">sliceType</span><span class="op" id="4402217">.</span><span class="ident" id="4402218">Elem</span><span class="op" id="4402222">(</span><span class="op" id="4402223">)</span><span class="op" id="4402224">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402228">if</span>&nbsp;<span class="ident" id="4402231">err1</span>&nbsp;<span class="op" id="4402236">==</span>&nbsp;<span class="ident" id="4402239">nil</span>&nbsp;<span class="op" id="4402243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402248">val</span><span class="op" id="4402251">.</span><span class="ident" id="4402252">Set</span><span class="op" id="4402255">(</span><span class="ident" id="4402256">newSlice</span><span class="op" id="4402264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4402268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402272">err</span>&nbsp;<span class="op" id="4402276">=</span>&nbsp;<span class="ident" id="4402278">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402285">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402293">case</span>&nbsp;<span class="ident" id="4402298">reflect</span><span class="op" id="4402305">.</span><span class="ident" id="4402306">String</span><span class="op" id="4402312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402316">var</span>&nbsp;<span class="ident" id="4402320">v</span>&nbsp;<span class="builtintype" id="4402322">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402331">switch</span>&nbsp;<span class="ident" id="4402338">universalTag</span>&nbsp;<span class="op" id="4402351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402355">case</span>&nbsp;<span class="ident" id="4402360">tagPrintableString</span><span class="op" id="4402378">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402383">v</span><span class="op" id="4402384">,</span>&nbsp;<span class="ident" id="4402386">err</span>&nbsp;<span class="op" id="4402390">=</span>&nbsp;<span class="ident" id="4402392">parsePrintableString</span><span class="op" id="4402412">(</span><span class="ident" id="4402413">innerBytes</span><span class="op" id="4402423">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402427">case</span>&nbsp;<span class="ident" id="4402432">tagIA5String</span><span class="op" id="4402444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402449">v</span><span class="op" id="4402450">,</span>&nbsp;<span class="ident" id="4402452">err</span>&nbsp;<span class="op" id="4402456">=</span>&nbsp;<span class="ident" id="4402458">parseIA5String</span><span class="op" id="4402472">(</span><span class="ident" id="4402473">innerBytes</span><span class="op" id="4402483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402487">case</span>&nbsp;<span class="ident" id="4402492">tagT61String</span><span class="op" id="4402504">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402509">v</span><span class="op" id="4402510">,</span>&nbsp;<span class="ident" id="4402512">err</span>&nbsp;<span class="op" id="4402516">=</span>&nbsp;<span class="ident" id="4402518">parseT61String</span><span class="op" id="4402532">(</span><span class="ident" id="4402533">innerBytes</span><span class="op" id="4402543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402547">case</span>&nbsp;<span class="ident" id="4402552">tagUTF8String</span><span class="op" id="4402565">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402570">v</span><span class="op" id="4402571">,</span>&nbsp;<span class="ident" id="4402573">err</span>&nbsp;<span class="op" id="4402577">=</span>&nbsp;<span class="ident" id="4402579">parseUTF8String</span><span class="op" id="4402594">(</span><span class="ident" id="4402595">innerBytes</span><span class="op" id="4402605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402609">case</span>&nbsp;<span class="ident" id="4402614">tagGeneralString</span><span class="op" id="4402630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4402635">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4402689">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4402747">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4402801">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402856">v</span><span class="op" id="4402857">,</span>&nbsp;<span class="ident" id="4402859">err</span>&nbsp;<span class="op" id="4402863">=</span>&nbsp;<span class="ident" id="4402865">parseT61String</span><span class="op" id="4402879">(</span><span class="ident" id="4402880">innerBytes</span><span class="op" id="4402890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402894">default</span><span class="op" id="4402901">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402906">err</span>&nbsp;<span class="op" id="4402910">=</span>&nbsp;<span class="ident" id="4402912">SyntaxError</span><span class="op" id="4402923">{</span><span class="ident" id="4402924">fmt</span><span class="op" id="4402927">.</span><span class="ident" id="4402928">Sprintf</span><span class="op" id="4402935">(</span><span class="string" id="4402936">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="4402976">,</span>&nbsp;<span class="ident" id="4402978">universalTag</span><span class="op" id="4402990">)</span><span class="op" id="4402991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4402995">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402999">if</span>&nbsp;<span class="ident" id="4403002">err</span>&nbsp;<span class="op" id="4403006">==</span>&nbsp;<span class="ident" id="4403009">nil</span>&nbsp;<span class="op" id="4403013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403018">val</span><span class="op" id="4403021">.</span><span class="ident" id="4403022">SetString</span><span class="op" id="4403031">(</span><span class="ident" id="4403032">v</span><span class="op" id="4403033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4403037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403041">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4403049">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403052">err</span>&nbsp;<span class="op" id="4403056">=</span>&nbsp;<span class="ident" id="4403058">StructuralError</span><span class="op" id="4403073">{</span><span class="string" id="4403074">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="4403090">+</span>&nbsp;<span class="ident" id="4403092">v</span><span class="op" id="4403093">.</span><span class="ident" id="4403094">Type</span><span class="op" id="4403098">(</span><span class="op" id="4403099">)</span><span class="op" id="4403100">.</span><span class="ident" id="4403101">String</span><span class="op" id="4403107">(</span><span class="op" id="4403108">)</span><span class="op" id="4403109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403112">return</span><br>
<span class="lineno"></span><span class="op" id="4403119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4403122">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="4403200">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="4403247">func</span>&nbsp;<span class="ident" id="4403252">canHaveDefaultValue</span><span class="op" id="4403271">(</span><span class="ident" id="4403272">k</span>&nbsp;<span class="ident" id="4403274">reflect</span><span class="op" id="4403281">.</span><span class="ident" id="4403282">Kind</span><span class="op" id="4403286">)</span>&nbsp;<span class="builtintype" id="4403288">bool</span>&nbsp;<span class="op" id="4403293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403296">switch</span>&nbsp;<span class="ident" id="4403303">k</span>&nbsp;<span class="op" id="4403305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403308">case</span>&nbsp;<span class="ident" id="4403313">reflect</span><span class="op" id="4403320">.</span><span class="ident" id="4403321">Int</span><span class="op" id="4403324">,</span>&nbsp;<span class="ident" id="4403326">reflect</span><span class="op" id="4403333">.</span><span class="ident" id="4403334">Int8</span><span class="op" id="4403338">,</span>&nbsp;<span class="ident" id="4403340">reflect</span><span class="op" id="4403347">.</span><span class="ident" id="4403348">Int16</span><span class="op" id="4403353">,</span>&nbsp;<span class="ident" id="4403355">reflect</span><span class="op" id="4403362">.</span><span class="ident" id="4403363">Int32</span><span class="op" id="4403368">,</span>&nbsp;<span class="ident" id="4403370">reflect</span><span class="op" id="4403377">.</span><span class="ident" id="4403378">Int64</span><span class="op" id="4403383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403387">return</span>&nbsp;<span class="builtintype" id="4403394">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4403400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403404">return</span>&nbsp;<span class="builtintype" id="4403411">false</span><br>
<span class="lineno"></span><span class="op" id="4403417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4403420">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4403499">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4403579">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4403641">func</span>&nbsp;<span class="ident" id="4403646">setDefaultValue</span><span class="op" id="4403661">(</span><span class="ident" id="4403662">v</span>&nbsp;<span class="ident" id="4403664">reflect</span><span class="op" id="4403671">.</span><span class="ident" id="4403672">Value</span><span class="op" id="4403677">,</span>&nbsp;<span class="ident" id="4403679">params</span>&nbsp;<span class="ident" id="4403686">fieldParameters</span><span class="op" id="4403701">)</span>&nbsp;<span class="op" id="4403703">(</span><span class="ident" id="4403704">ok</span>&nbsp;<span class="builtintype" id="4403707">bool</span><span class="op" id="4403711">)</span>&nbsp;<span class="op" id="4403713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403716">if</span>&nbsp;<span class="op" id="4403719">!</span><span class="ident" id="4403720">params</span><span class="op" id="4403726">.</span><span class="ident" id="4403727">optional</span>&nbsp;<span class="op" id="4403736">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403740">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4403748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403751">ok</span>&nbsp;<span class="op" id="4403754">=</span>&nbsp;<span class="builtintype" id="4403756">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403762">if</span>&nbsp;<span class="ident" id="4403765">params</span><span class="op" id="4403771">.</span><span class="ident" id="4403772">defaultValue</span>&nbsp;<span class="op" id="4403785">==</span>&nbsp;<span class="ident" id="4403788">nil</span>&nbsp;<span class="op" id="4403792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403796">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4403804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403807">if</span>&nbsp;<span class="ident" id="4403810">canHaveDefaultValue</span><span class="op" id="4403829">(</span><span class="ident" id="4403830">v</span><span class="op" id="4403831">.</span><span class="ident" id="4403832">Kind</span><span class="op" id="4403836">(</span><span class="op" id="4403837">)</span><span class="op" id="4403838">)</span>&nbsp;<span class="op" id="4403840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403844">v</span><span class="op" id="4403845">.</span><span class="ident" id="4403846">SetInt</span><span class="op" id="4403852">(</span><span class="op" id="4403853">*</span><span class="ident" id="4403854">params</span><span class="op" id="4403860">.</span><span class="ident" id="4403861">defaultValue</span><span class="op" id="4403873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4403876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403879">return</span><br>
<span class="lineno">855</span><span class="op" id="4403886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4403889">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="4403948">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4404029">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="4404088">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4404141">//</span><br>
<span class="lineno"></span><span class="comment" id="4404144">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="4404204">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="4404248">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="4404301">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4404337">//</span><br>
<span class="lineno"></span><span class="comment" id="4404340">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="4404394">//</span><br>
<span class="lineno"></span><span class="comment" id="4404397">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="4404450">//</span><br>
<span class="lineno"></span><span class="comment" id="4404453">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4404504">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="4404525">//</span><br>
<span class="lineno"></span><span class="comment" id="4404528">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="4404584">//</span><br>
<span class="lineno"></span><span class="comment" id="4404587">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="4404657">//</span><br>
<span class="lineno"></span><span class="comment" id="4404660">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="4404729">//</span><br>
<span class="lineno">880</span><span class="comment" id="4404732">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="4404799">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4404867">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="4404904">//</span><br>
<span class="lineno"></span><span class="comment" id="4404907">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="4404960">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4405026">//</span><br>
<span class="lineno"></span><span class="comment" id="4405029">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4405084">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4405134">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="4405189">//</span><br>
<span class="lineno"></span><span class="comment" id="4405192">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="4405266">//</span><br>
<span class="lineno"></span><span class="comment" id="4405269">//&nbsp;&nbsp;&nbsp;&nbspapplication&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4405325">//&nbsp;&nbsp;&nbsp;&nbspdefault:x&nbsp;&nbsp;&nbsp;&nbspsets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="4405389">//&nbsp;&nbsp;&nbsp;&nbspexplicit&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4405467">//&nbsp;&nbsp;&nbsp;&nbspoptional&nbsp;&nbsp;&nbsp;&nbspmarks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="4405513">//&nbsp;&nbsp;&nbsp;&nbspset&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4405578">//&nbsp;&nbsp;&nbsp;&nbsptag:x&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="4405651">//</span><br>
<span class="lineno">900</span><span class="comment" id="4405654">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="4405730">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4405783">//</span><br>
<span class="lineno"></span><span class="comment" id="4405786">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4405865">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="4405941">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="4405972">//</span><br>
<span class="lineno"></span><span class="comment" id="4405975">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="4406038">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4406074">func</span>&nbsp;<span class="ident" id="4406079">Unmarshal</span><span class="op" id="4406088">(</span><span class="ident" id="4406089">b</span>&nbsp;<span class="op" id="4406091">[</span><span class="op" id="4406092">]</span><span class="builtintype" id="4406093">byte</span><span class="op" id="4406097">,</span>&nbsp;<span class="ident" id="4406099">val</span>&nbsp;<span class="keyword" id="4406103">interface</span><span class="op" id="4406112">{</span><span class="op" id="4406113">}</span><span class="op" id="4406114">)</span>&nbsp;<span class="op" id="4406116">(</span><span class="ident" id="4406117">rest</span>&nbsp;<span class="op" id="4406122">[</span><span class="op" id="4406123">]</span><span class="builtintype" id="4406124">byte</span><span class="op" id="4406128">,</span>&nbsp;<span class="ident" id="4406130">err</span>&nbsp;<span class="builtintype" id="4406134">error</span><span class="op" id="4406139">)</span>&nbsp;<span class="op" id="4406141">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4406144">return</span>&nbsp;<span class="ident" id="4406151">UnmarshalWithParams</span><span class="op" id="4406170">(</span><span class="ident" id="4406171">b</span><span class="op" id="4406172">,</span>&nbsp;<span class="ident" id="4406174">val</span><span class="op" id="4406177">,</span>&nbsp;<span class="string" id="4406179">&#34;&#34;</span><span class="op" id="4406181">)</span><br>
<span class="lineno"></span><span class="op" id="4406183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4406186">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4406257">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="4406333">func</span>&nbsp;<span class="ident" id="4406338">UnmarshalWithParams</span><span class="op" id="4406357">(</span><span class="ident" id="4406358">b</span>&nbsp;<span class="op" id="4406360">[</span><span class="op" id="4406361">]</span><span class="builtintype" id="4406362">byte</span><span class="op" id="4406366">,</span>&nbsp;<span class="ident" id="4406368">val</span>&nbsp;<span class="keyword" id="4406372">interface</span><span class="op" id="4406381">{</span><span class="op" id="4406382">}</span><span class="op" id="4406383">,</span>&nbsp;<span class="ident" id="4406385">params</span>&nbsp;<span class="builtintype" id="4406392">string</span><span class="op" id="4406398">)</span>&nbsp;<span class="op" id="4406400">(</span><span class="ident" id="4406401">rest</span>&nbsp;<span class="op" id="4406406">[</span><span class="op" id="4406407">]</span><span class="builtintype" id="4406408">byte</span><span class="op" id="4406412">,</span>&nbsp;<span class="ident" id="4406414">err</span>&nbsp;<span class="builtintype" id="4406418">error</span><span class="op" id="4406423">)</span>&nbsp;<span class="op" id="4406425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406428">v</span>&nbsp;<span class="op" id="4406430">:=</span>&nbsp;<span class="ident" id="4406433">reflect</span><span class="op" id="4406440">.</span><span class="ident" id="4406441">ValueOf</span><span class="op" id="4406448">(</span><span class="ident" id="4406449">val</span><span class="op" id="4406452">)</span><span class="op" id="4406453">.</span><span class="ident" id="4406454">Elem</span><span class="op" id="4406458">(</span><span class="op" id="4406459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406462">offset</span><span class="op" id="4406468">,</span>&nbsp;<span class="ident" id="4406470">err</span>&nbsp;<span class="op" id="4406474">:=</span>&nbsp;<span class="ident" id="4406477">parseField</span><span class="op" id="4406487">(</span><span class="ident" id="4406488">v</span><span class="op" id="4406489">,</span>&nbsp;<span class="ident" id="4406491">b</span><span class="op" id="4406492">,</span>&nbsp;<span class="num" id="4406494">0</span><span class="op" id="4406495">,</span>&nbsp;<span class="ident" id="4406497">parseFieldParameters</span><span class="op" id="4406517">(</span><span class="ident" id="4406518">params</span><span class="op" id="4406524">)</span><span class="op" id="4406525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4406528">if</span>&nbsp;<span class="ident" id="4406531">err</span>&nbsp;<span class="op" id="4406535">!=</span>&nbsp;<span class="ident" id="4406538">nil</span>&nbsp;<span class="op" id="4406542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4406546">return</span>&nbsp;<span class="ident" id="4406553">nil</span><span class="op" id="4406556">,</span>&nbsp;<span class="ident" id="4406558">err</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4406563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4406566">return</span>&nbsp;<span class="ident" id="4406573">b</span><span class="op" id="4406574">[</span><span class="ident" id="4406575">offset</span><span class="op" id="4406581">:</span><span class="op" id="4406582">]</span><span class="op" id="4406583">,</span>&nbsp;<span class="ident" id="4406585">nil</span><br>
<span class="lineno"></span><span class="op" id="4406589">}</span>
</div>
</body>
</html>
