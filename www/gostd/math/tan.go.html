<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html" class="current">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2226755">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2226810">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2226864">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2226915">package</span>&nbsp;<span class="ident" id="2226923">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2226929">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;tangent.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2226961">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2227021">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="2227085">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="2227143">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2227201">//</span><br>
<span class="lineno"></span><span class="comment" id="2227204">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tan.c</span><br>
<span class="lineno"></span><span class="comment" id="2227218">//</span><br>
<span class="lineno"></span><span class="comment" id="2227221">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="2227246">//</span><br>
<span class="lineno">20</span><span class="comment" id="2227249">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2227262">//</span><br>
<span class="lineno"></span><span class="comment" id="2227265">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tan();</span><br>
<span class="lineno"></span><span class="comment" id="2227288">//&nbsp;y&nbsp;=&nbsp;tan(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2227305">//</span><br>
<span class="lineno">25</span><span class="comment" id="2227308">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2227324">//</span><br>
<span class="lineno"></span><span class="comment" id="2227327">//&nbsp;Returns&nbsp;the&nbsp;circular&nbsp;tangent&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2227385">//</span><br>
<span class="lineno"></span><span class="comment" id="2227388">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;modulo&nbsp;pi/4.&nbsp;&nbsp;A&nbsp;rational&nbsp;function</span><br>
<span class="lineno">30</span><span class="comment" id="2227444">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;+&nbsp;x**3&nbsp;P(x**2)/Q(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="2227478">//&nbsp;is&nbsp;employed&nbsp;in&nbsp;the&nbsp;basic&nbsp;interval&nbsp;[0,&nbsp;pi/4].</span><br>
<span class="lineno"></span><span class="comment" id="2227526">//</span><br>
<span class="lineno"></span><span class="comment" id="2227529">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2227542">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">35</span><span class="comment" id="2227582">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="2227640">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+-1.07e9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;44000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.0e-17</span><br>
<span class="lineno"></span><span class="comment" id="2227700">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+-1.07e9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.9e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.1e-17</span><br>
<span class="lineno"></span><span class="comment" id="2227760">//</span><br>
<span class="lineno"></span><span class="comment" id="2227763">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno">40</span><span class="comment" id="2227841">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2227917">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="2227959">//&nbsp;[Accuracy&nbsp;loss&nbsp;statement&nbsp;from&nbsp;sin.go&nbsp;comments.]</span><br>
<span class="lineno"></span><span class="comment" id="2228010">//</span><br>
<span class="lineno"></span><span class="comment" id="2228013">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">45</span><span class="comment" id="2228061">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2228125">//</span><br>
<span class="lineno"></span><span class="comment" id="2228128">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2228189">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2228259">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">50</span><span class="comment" id="2228334">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2228401">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2228474">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2228546">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2228560">//</span><br>
<span class="lineno">55</span><span class="comment" id="2228563">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2228629">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2228695">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2228708">//</span><br>
<span class="lineno"></span><span class="comment" id="2228711">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">60</span><span class="comment" id="2228735">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2228765">//&nbsp;tan&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2228785">var</span>&nbsp;<span class="ident" id="2228789">_tanP</span>&nbsp;<span class="op" id="2228795">=</span>&nbsp;<span class="op" id="2228797">[</span><span class="op" id="2228798">...</span><span class="op" id="2228801">]</span><span class="builtintype" id="2228802">float64</span><span class="op" id="2228809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2228812">-</span><span class="num" id="2228813">1.30936939181383777646E4</span><span class="op" id="2228837">,</span>&nbsp;<span class="comment" id="2228839">//&nbsp;0xc0c992d8d24f3f38</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2228862">1.15351664838587416140E6</span><span class="op" id="2228886">,</span>&nbsp;&nbsp;<span class="comment" id="2228889">//&nbsp;0x413199eca5fc9ddd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2228912">-</span><span class="num" id="2228913">1.79565251976484877988E7</span><span class="op" id="2228937">,</span>&nbsp;<span class="comment" id="2228939">//&nbsp;0xc1711fead3299176</span><br>
<span class="lineno"></span><span class="op" id="2228961">}</span><br>
<span class="lineno"></span><span class="keyword" id="2228963">var</span>&nbsp;<span class="ident" id="2228967">_tanQ</span>&nbsp;<span class="op" id="2228973">=</span>&nbsp;<span class="op" id="2228975">[</span><span class="op" id="2228976">...</span><span class="op" id="2228979">]</span><span class="builtintype" id="2228980">float64</span><span class="op" id="2228987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2228990">1.00000000000000000000E0</span><span class="op" id="2229014">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2229017">1.36812963470692954678E4</span><span class="op" id="2229041">,</span>&nbsp;&nbsp;<span class="comment" id="2229044">//0x40cab8a5eeb36572</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229066">-</span><span class="num" id="2229067">1.32089234440210967447E6</span><span class="op" id="2229091">,</span>&nbsp;<span class="comment" id="2229093">//0xc13427bc582abc96</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2229115">2.50083801823357915839E7</span><span class="op" id="2229139">,</span>&nbsp;&nbsp;<span class="comment" id="2229142">//0x4177d98fc2ead8ef</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229164">-</span><span class="num" id="2229165">5.38695755929454629881E7</span><span class="op" id="2229189">,</span>&nbsp;<span class="comment" id="2229191">//0xc189afe03cbe5a31</span><br>
<span class="lineno"></span><span class="op" id="2229212">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2229215">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2229268">//</span><br>
<span class="lineno"></span><span class="comment" id="2229271">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2229293">//&nbsp;&nbsp;&nbsp;&nbsp;Tan(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno">80</span><span class="comment" id="2229311">//&nbsp;&nbsp;&nbsp;&nbsp;Tan(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2229331">//&nbsp;&nbsp;&nbsp;&nbsp;Tan(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2229349">func</span>&nbsp;<span class="ident" id="2229354">Tan</span><span class="op" id="2229357">(</span><span class="ident" id="2229358">x</span>&nbsp;<span class="builtintype" id="2229360">float64</span><span class="op" id="2229367">)</span>&nbsp;<span class="builtintype" id="2229369">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2229378">func</span>&nbsp;<span class="ident" id="2229383">tan</span><span class="op" id="2229386">(</span><span class="ident" id="2229387">x</span>&nbsp;<span class="builtintype" id="2229389">float64</span><span class="op" id="2229396">)</span>&nbsp;<span class="builtintype" id="2229398">float64</span>&nbsp;<span class="op" id="2229406">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229409">const</span>&nbsp;<span class="op" id="2229415">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229419">PI4A</span>&nbsp;<span class="op" id="2229424">=</span>&nbsp;<span class="num" id="2229426">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229480">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229533">PI4B</span>&nbsp;<span class="op" id="2229538">=</span>&nbsp;<span class="num" id="2229540">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229594">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229619">PI4C</span>&nbsp;<span class="op" id="2229624">=</span>&nbsp;<span class="num" id="2229626">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229680">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229705">M4PI</span>&nbsp;<span class="op" id="2229710">=</span>&nbsp;<span class="num" id="2229712">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2229766">//&nbsp;4/pi</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229778">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229796">switch</span>&nbsp;<span class="op" id="2229803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229806">case</span>&nbsp;<span class="ident" id="2229811">x</span>&nbsp;<span class="op" id="2229813">==</span>&nbsp;<span class="num" id="2229816">0</span>&nbsp;<span class="op" id="2229818">||</span>&nbsp;<span class="ident" id="2229821">IsNaN</span><span class="op" id="2229826">(</span><span class="ident" id="2229827">x</span><span class="op" id="2229828">)</span><span class="op" id="2229829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229833">return</span>&nbsp;<span class="ident" id="2229840">x</span>&nbsp;<span class="comment" id="2229842">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229866">case</span>&nbsp;<span class="ident" id="2229871">IsInf</span><span class="op" id="2229876">(</span><span class="ident" id="2229877">x</span><span class="op" id="2229878">,</span>&nbsp;<span class="num" id="2229880">0</span><span class="op" id="2229881">)</span><span class="op" id="2229882">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229886">return</span>&nbsp;<span class="ident" id="2229893">NaN</span><span class="op" id="2229896">(</span><span class="op" id="2229897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229904">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229949">sign</span>&nbsp;<span class="op" id="2229954">:=</span>&nbsp;<span class="builtintype" id="2229957">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229964">if</span>&nbsp;<span class="ident" id="2229967">x</span>&nbsp;<span class="op" id="2229969">&lt;</span>&nbsp;<span class="num" id="2229971">0</span>&nbsp;<span class="op" id="2229973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229977">x</span>&nbsp;<span class="op" id="2229979">=</span>&nbsp;<span class="op" id="2229981">-</span><span class="ident" id="2229982">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229986">sign</span>&nbsp;<span class="op" id="2229991">=</span>&nbsp;<span class="builtintype" id="2229993">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229999">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230003">j</span>&nbsp;<span class="op" id="2230005">:=</span>&nbsp;<span class="ident" id="2230008">int64</span><span class="op" id="2230013">(</span><span class="ident" id="2230014">x</span>&nbsp;<span class="op" id="2230016">*</span>&nbsp;<span class="ident" id="2230018">M4PI</span><span class="op" id="2230022">)</span>&nbsp;<span class="comment" id="2230024">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230094">y</span>&nbsp;<span class="op" id="2230096">:=</span>&nbsp;<span class="builtintype" id="2230099">float64</span><span class="op" id="2230106">(</span><span class="ident" id="2230107">j</span><span class="op" id="2230108">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2230115">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2230155">/*&nbsp;map&nbsp;zeros&nbsp;and&nbsp;singularities&nbsp;to&nbsp;origin&nbsp;*/</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230200">if</span>&nbsp;<span class="ident" id="2230203">j</span><span class="op" id="2230204">&amp;</span><span class="num" id="2230205">1</span>&nbsp;<span class="op" id="2230207">==</span>&nbsp;<span class="num" id="2230210">1</span>&nbsp;<span class="op" id="2230212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230216">j</span>&nbsp;<span class="op" id="2230218">+=</span>&nbsp;<span class="num" id="2230221">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230225">y</span>&nbsp;<span class="op" id="2230227">+=</span>&nbsp;<span class="num" id="2230230">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230237">z</span>&nbsp;<span class="op" id="2230239">:=</span>&nbsp;<span class="op" id="2230242">(</span><span class="op" id="2230243">(</span><span class="ident" id="2230244">x</span>&nbsp;<span class="op" id="2230246">-</span>&nbsp;<span class="ident" id="2230248">y</span><span class="op" id="2230249">*</span><span class="ident" id="2230250">PI4A</span><span class="op" id="2230254">)</span>&nbsp;<span class="op" id="2230256">-</span>&nbsp;<span class="ident" id="2230258">y</span><span class="op" id="2230259">*</span><span class="ident" id="2230260">PI4B</span><span class="op" id="2230264">)</span>&nbsp;<span class="op" id="2230266">-</span>&nbsp;<span class="ident" id="2230268">y</span><span class="op" id="2230269">*</span><span class="ident" id="2230270">PI4C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230276">zz</span>&nbsp;<span class="op" id="2230279">:=</span>&nbsp;<span class="ident" id="2230282">z</span>&nbsp;<span class="op" id="2230284">*</span>&nbsp;<span class="ident" id="2230286">z</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230290">if</span>&nbsp;<span class="ident" id="2230293">zz</span>&nbsp;<span class="op" id="2230296">&gt;</span>&nbsp;<span class="num" id="2230298">1e-14</span>&nbsp;<span class="op" id="2230304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230308">y</span>&nbsp;<span class="op" id="2230310">=</span>&nbsp;<span class="ident" id="2230312">z</span>&nbsp;<span class="op" id="2230314">+</span>&nbsp;<span class="ident" id="2230316">z</span><span class="op" id="2230317">*</span><span class="op" id="2230318">(</span><span class="ident" id="2230319">zz</span><span class="op" id="2230321">*</span><span class="op" id="2230322">(</span><span class="op" id="2230323">(</span><span class="op" id="2230324">(</span><span class="ident" id="2230325">_tanP</span><span class="op" id="2230330">[</span><span class="num" id="2230331">0</span><span class="op" id="2230332">]</span><span class="op" id="2230333">*</span><span class="ident" id="2230334">zz</span><span class="op" id="2230336">)</span><span class="op" id="2230337">+</span><span class="ident" id="2230338">_tanP</span><span class="op" id="2230343">[</span><span class="num" id="2230344">1</span><span class="op" id="2230345">]</span><span class="op" id="2230346">)</span><span class="op" id="2230347">*</span><span class="ident" id="2230348">zz</span><span class="op" id="2230350">+</span><span class="ident" id="2230351">_tanP</span><span class="op" id="2230356">[</span><span class="num" id="2230357">2</span><span class="op" id="2230358">]</span><span class="op" id="2230359">)</span><span class="op" id="2230360">/</span><span class="op" id="2230361">(</span><span class="op" id="2230362">(</span><span class="op" id="2230363">(</span><span class="op" id="2230364">(</span><span class="ident" id="2230365">zz</span><span class="op" id="2230367">+</span><span class="ident" id="2230368">_tanQ</span><span class="op" id="2230373">[</span><span class="num" id="2230374">1</span><span class="op" id="2230375">]</span><span class="op" id="2230376">)</span><span class="op" id="2230377">*</span><span class="ident" id="2230378">zz</span><span class="op" id="2230380">+</span><span class="ident" id="2230381">_tanQ</span><span class="op" id="2230386">[</span><span class="num" id="2230387">2</span><span class="op" id="2230388">]</span><span class="op" id="2230389">)</span><span class="op" id="2230390">*</span><span class="ident" id="2230391">zz</span><span class="op" id="2230393">+</span><span class="ident" id="2230394">_tanQ</span><span class="op" id="2230399">[</span><span class="num" id="2230400">3</span><span class="op" id="2230401">]</span><span class="op" id="2230402">)</span><span class="op" id="2230403">*</span><span class="ident" id="2230404">zz</span><span class="op" id="2230406">+</span><span class="ident" id="2230407">_tanQ</span><span class="op" id="2230412">[</span><span class="num" id="2230413">4</span><span class="op" id="2230414">]</span><span class="op" id="2230415">)</span><span class="op" id="2230416">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230419">}</span>&nbsp;<span class="keyword" id="2230421">else</span>&nbsp;<span class="op" id="2230426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230430">y</span>&nbsp;<span class="op" id="2230432">=</span>&nbsp;<span class="ident" id="2230434">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230440">if</span>&nbsp;<span class="ident" id="2230443">j</span><span class="op" id="2230444">&amp;</span><span class="num" id="2230445">2</span>&nbsp;<span class="op" id="2230447">==</span>&nbsp;<span class="num" id="2230450">2</span>&nbsp;<span class="op" id="2230452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230456">y</span>&nbsp;<span class="op" id="2230458">=</span>&nbsp;<span class="op" id="2230460">-</span><span class="num" id="2230461">1</span>&nbsp;<span class="op" id="2230463">/</span>&nbsp;<span class="ident" id="2230465">y</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230471">if</span>&nbsp;<span class="ident" id="2230474">sign</span>&nbsp;<span class="op" id="2230479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230483">y</span>&nbsp;<span class="op" id="2230485">=</span>&nbsp;<span class="op" id="2230487">-</span><span class="ident" id="2230488">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230494">return</span>&nbsp;<span class="ident" id="2230501">y</span><br>
<span class="lineno">130</span><span class="op" id="2230503">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
