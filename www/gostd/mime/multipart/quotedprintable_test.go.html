<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime/multipart</h2>
<ul>
<li><a href="/gostd/mime/multipart/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/mime/multipart/formdata.go.html">formdata.go</a></li>
<li><a href="/gostd/mime/multipart/formdata_test.go.html">formdata_test.go</a></li>
<li><a href="/gostd/mime/multipart/multipart.go.html">multipart.go</a></li>
<li><a href="/gostd/mime/multipart/multipart_test.go.html">multipart_test.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable.go.html">quotedprintable.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable_test.go.html">quotedprintable_test.go</a></li>
<li><a href="/gostd/mime/multipart/writer.go.html">writer.go</a></li>
<li><a href="/gostd/mime/multipart/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7453466">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7453521">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7453575">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7453626">package</span>&nbsp;<span class="ident" id="7453634">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7453645">import</span>&nbsp;<span class="op" id="7453652">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7453655">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7453664">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7453673">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7453683">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7453691">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7453698">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7453704">&#34;os/exec&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7453715">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7453725">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7453733">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7453744">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7453755">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="7453762">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7453765">func</span>&nbsp;<span class="ident" id="7453770">TestQuotedPrintable</span><span class="op" id="7453789">(</span><span class="ident" id="7453790">t</span>&nbsp;<span class="op" id="7453792">*</span><span class="ident" id="7453793">testing</span><span class="op" id="7453800">.</span><span class="ident" id="7453801">T</span><span class="op" id="7453802">)</span>&nbsp;<span class="op" id="7453804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7453807">tests</span>&nbsp;<span class="op" id="7453813">:=</span>&nbsp;<span class="op" id="7453816">[</span><span class="op" id="7453817">]</span><span class="keyword" id="7453818">struct</span>&nbsp;<span class="op" id="7453825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7453829">in</span><span class="op" id="7453831">,</span>&nbsp;<span class="ident" id="7453833">want</span>&nbsp;<span class="builtintype" id="7453838">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7453847">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7453856">interface</span><span class="op" id="7453865">{</span><span class="op" id="7453866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7453869">}</span><span class="op" id="7453870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7453874">{</span><span class="ident" id="7453875">in</span><span class="op" id="7453877">:</span>&nbsp;<span class="string" id="7453879">&#34;&#34;</span><span class="op" id="7453881">,</span>&nbsp;<span class="ident" id="7453883">want</span><span class="op" id="7453887">:</span>&nbsp;<span class="string" id="7453889">&#34;&#34;</span><span class="op" id="7453891">}</span><span class="op" id="7453892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7453896">{</span><span class="ident" id="7453897">in</span><span class="op" id="7453899">:</span>&nbsp;<span class="string" id="7453901">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7453910">,</span>&nbsp;<span class="ident" id="7453912">want</span><span class="op" id="7453916">:</span>&nbsp;<span class="string" id="7453918">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7453927">}</span><span class="op" id="7453928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7453932">{</span><span class="ident" id="7453933">in</span><span class="op" id="7453935">:</span>&nbsp;<span class="string" id="7453937">&#34;foo&nbsp;bar=3D&#34;</span><span class="op" id="7453949">,</span>&nbsp;<span class="ident" id="7453951">want</span><span class="op" id="7453955">:</span>&nbsp;<span class="string" id="7453957">&#34;foo&nbsp;bar=&#34;</span><span class="op" id="7453967">}</span><span class="op" id="7453968">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7453972">{</span><span class="ident" id="7453973">in</span><span class="op" id="7453975">:</span>&nbsp;<span class="string" id="7453977">&#34;foo&nbsp;bar=\n&#34;</span><span class="op" id="7453989">,</span>&nbsp;<span class="ident" id="7453991">want</span><span class="op" id="7453995">:</span>&nbsp;<span class="string" id="7453997">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7454006">}</span><span class="op" id="7454007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454011">{</span><span class="ident" id="7454012">in</span><span class="op" id="7454014">:</span>&nbsp;<span class="string" id="7454016">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="7454027">,</span>&nbsp;<span class="ident" id="7454029">want</span><span class="op" id="7454033">:</span>&nbsp;<span class="string" id="7454035">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="7454046">}</span><span class="op" id="7454047">,</span>&nbsp;<span class="comment" id="7454049">//&nbsp;somewhat&nbsp;lax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454068">{</span><span class="ident" id="7454069">in</span><span class="op" id="7454071">:</span>&nbsp;<span class="string" id="7454073">&#34;foo&nbsp;bar=0&#34;</span><span class="op" id="7454084">,</span>&nbsp;<span class="ident" id="7454086">want</span><span class="op" id="7454090">:</span>&nbsp;<span class="string" id="7454092">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7454101">,</span>&nbsp;<span class="ident" id="7454103">err</span><span class="op" id="7454106">:</span>&nbsp;<span class="ident" id="7454108">io</span><span class="op" id="7454110">.</span><span class="ident" id="7454111">ErrUnexpectedEOF</span><span class="op" id="7454127">}</span><span class="op" id="7454128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454132">{</span><span class="ident" id="7454133">in</span><span class="op" id="7454135">:</span>&nbsp;<span class="string" id="7454137">&#34;foo&nbsp;bar=ab&#34;</span><span class="op" id="7454149">,</span>&nbsp;<span class="ident" id="7454151">want</span><span class="op" id="7454155">:</span>&nbsp;<span class="string" id="7454157">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7454166">,</span>&nbsp;<span class="ident" id="7454168">err</span><span class="op" id="7454171">:</span>&nbsp;<span class="string" id="7454173">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x61&#34;</span><span class="op" id="7454224">}</span><span class="op" id="7454225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454229">{</span><span class="ident" id="7454230">in</span><span class="op" id="7454232">:</span>&nbsp;<span class="string" id="7454234">&#34;foo&nbsp;bar=0D=0A&#34;</span><span class="op" id="7454249">,</span>&nbsp;<span class="ident" id="7454251">want</span><span class="op" id="7454255">:</span>&nbsp;<span class="string" id="7454257">&#34;foo&nbsp;bar\r\n&#34;</span><span class="op" id="7454270">}</span><span class="op" id="7454271">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454275">{</span><span class="ident" id="7454276">in</span><span class="op" id="7454278">:</span>&nbsp;<span class="string" id="7454280">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="7454301">,</span>&nbsp;<span class="ident" id="7454303">want</span><span class="op" id="7454307">:</span>&nbsp;<span class="string" id="7454309">&#34;&nbsp;A&nbsp;B\r\n&nbsp;C&#34;</span><span class="op" id="7454321">}</span><span class="op" id="7454322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454326">{</span><span class="ident" id="7454327">in</span><span class="op" id="7454329">:</span>&nbsp;<span class="string" id="7454331">&#34;&nbsp;A&nbsp;B&nbsp;=\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="7454346">,</span>&nbsp;<span class="ident" id="7454348">want</span><span class="op" id="7454352">:</span>&nbsp;<span class="string" id="7454354">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="7454363">}</span><span class="op" id="7454364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454368">{</span><span class="ident" id="7454369">in</span><span class="op" id="7454371">:</span>&nbsp;<span class="string" id="7454373">&#34;&nbsp;A&nbsp;B&nbsp;=\n&nbsp;C&nbsp;&#34;</span><span class="op" id="7454386">,</span>&nbsp;<span class="ident" id="7454388">want</span><span class="op" id="7454392">:</span>&nbsp;<span class="string" id="7454394">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="7454403">}</span><span class="op" id="7454404">,</span>&nbsp;<span class="comment" id="7454406">//&nbsp;lax.&nbsp;treating&nbsp;LF&nbsp;as&nbsp;CRLF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454436">{</span><span class="ident" id="7454437">in</span><span class="op" id="7454439">:</span>&nbsp;<span class="string" id="7454441">&#34;foo=\nbar&#34;</span><span class="op" id="7454452">,</span>&nbsp;<span class="ident" id="7454454">want</span><span class="op" id="7454458">:</span>&nbsp;<span class="string" id="7454460">&#34;foobar&#34;</span><span class="op" id="7454468">}</span><span class="op" id="7454469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454473">{</span><span class="ident" id="7454474">in</span><span class="op" id="7454476">:</span>&nbsp;<span class="string" id="7454478">&#34;foo\x00bar&#34;</span><span class="op" id="7454490">,</span>&nbsp;<span class="ident" id="7454492">want</span><span class="op" id="7454496">:</span>&nbsp;<span class="string" id="7454498">&#34;foo&#34;</span><span class="op" id="7454503">,</span>&nbsp;<span class="ident" id="7454505">err</span><span class="op" id="7454508">:</span>&nbsp;<span class="string" id="7454510">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0x00&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="7454575">}</span><span class="op" id="7454576">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454580">{</span><span class="ident" id="7454581">in</span><span class="op" id="7454583">:</span>&nbsp;<span class="string" id="7454585">&#34;foo&nbsp;bar\xff&#34;</span><span class="op" id="7454598">,</span>&nbsp;<span class="ident" id="7454600">want</span><span class="op" id="7454604">:</span>&nbsp;<span class="string" id="7454606">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7454615">,</span>&nbsp;<span class="ident" id="7454617">err</span><span class="op" id="7454620">:</span>&nbsp;<span class="string" id="7454622">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0xff&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="7454687">}</span><span class="op" id="7454688">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7454693">//&nbsp;Equal&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454710">{</span><span class="ident" id="7454711">in</span><span class="op" id="7454713">:</span>&nbsp;<span class="string" id="7454715">&#34;=3D30\n&#34;</span><span class="op" id="7454724">,</span>&nbsp;<span class="ident" id="7454726">want</span><span class="op" id="7454730">:</span>&nbsp;<span class="string" id="7454732">&#34;=30\n&#34;</span><span class="op" id="7454739">}</span><span class="op" id="7454740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454744">{</span><span class="ident" id="7454745">in</span><span class="op" id="7454747">:</span>&nbsp;<span class="string" id="7454749">&#34;=00=FF0=\n&#34;</span><span class="op" id="7454761">,</span>&nbsp;<span class="ident" id="7454763">want</span><span class="op" id="7454767">:</span>&nbsp;<span class="string" id="7454769">&#34;\x00\xff0&#34;</span><span class="op" id="7454780">}</span><span class="op" id="7454781">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7454786">//&nbsp;Trailing&nbsp;whitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454811">{</span><span class="ident" id="7454812">in</span><span class="op" id="7454814">:</span>&nbsp;<span class="string" id="7454816">&#34;foo&nbsp;&nbsp;\n&#34;</span><span class="op" id="7454825">,</span>&nbsp;<span class="ident" id="7454827">want</span><span class="op" id="7454831">:</span>&nbsp;<span class="string" id="7454833">&#34;foo\n&#34;</span><span class="op" id="7454840">}</span><span class="op" id="7454841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7454845">{</span><span class="ident" id="7454846">in</span><span class="op" id="7454848">:</span>&nbsp;<span class="string" id="7454850">&#34;foo&nbsp;&nbsp;\n\nfoo&nbsp;=\n\nfoo=20\n\n&#34;</span><span class="op" id="7454880">,</span>&nbsp;<span class="ident" id="7454882">want</span><span class="op" id="7454886">:</span>&nbsp;<span class="string" id="7454888">&#34;foo\n\nfoo&nbsp;\nfoo&nbsp;\n\n&#34;</span><span class="op" id="7454911">}</span><span class="op" id="7454912">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7454917">//&nbsp;Tests&nbsp;that&nbsp;we&nbsp;allow&nbsp;bare&nbsp;\n&nbsp;and&nbsp;\r&nbsp;through,&nbsp;despite&nbsp;it&nbsp;being&nbsp;strictly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7454992">//&nbsp;not&nbsp;permitted&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;Section&nbsp;6.7&nbsp;Page&nbsp;22&nbsp;bullet&nbsp;(4).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7455057">{</span><span class="ident" id="7455058">in</span><span class="op" id="7455060">:</span>&nbsp;<span class="string" id="7455062">&#34;foo\nbar&#34;</span><span class="op" id="7455072">,</span>&nbsp;<span class="ident" id="7455074">want</span><span class="op" id="7455078">:</span>&nbsp;<span class="string" id="7455080">&#34;foo\nbar&#34;</span><span class="op" id="7455090">}</span><span class="op" id="7455091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7455095">{</span><span class="ident" id="7455096">in</span><span class="op" id="7455098">:</span>&nbsp;<span class="string" id="7455100">&#34;foo\rbar&#34;</span><span class="op" id="7455110">,</span>&nbsp;<span class="ident" id="7455112">want</span><span class="op" id="7455116">:</span>&nbsp;<span class="string" id="7455118">&#34;foo\rbar&#34;</span><span class="op" id="7455128">}</span><span class="op" id="7455129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7455133">{</span><span class="ident" id="7455134">in</span><span class="op" id="7455136">:</span>&nbsp;<span class="string" id="7455138">&#34;foo\r\nbar&#34;</span><span class="op" id="7455150">,</span>&nbsp;<span class="ident" id="7455152">want</span><span class="op" id="7455156">:</span>&nbsp;<span class="string" id="7455158">&#34;foo\r\nbar&#34;</span><span class="op" id="7455170">}</span><span class="op" id="7455171">,</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7455176">//&nbsp;Different&nbsp;types&nbsp;of&nbsp;soft&nbsp;line-breaks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7455218">{</span><span class="ident" id="7455219">in</span><span class="op" id="7455221">:</span>&nbsp;<span class="string" id="7455223">&#34;foo=\r\nbar&#34;</span><span class="op" id="7455236">,</span>&nbsp;<span class="ident" id="7455238">want</span><span class="op" id="7455242">:</span>&nbsp;<span class="string" id="7455244">&#34;foobar&#34;</span><span class="op" id="7455252">}</span><span class="op" id="7455253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7455257">{</span><span class="ident" id="7455258">in</span><span class="op" id="7455260">:</span>&nbsp;<span class="string" id="7455262">&#34;foo=\nbar&#34;</span><span class="op" id="7455273">,</span>&nbsp;<span class="ident" id="7455275">want</span><span class="op" id="7455279">:</span>&nbsp;<span class="string" id="7455281">&#34;foobar&#34;</span><span class="op" id="7455289">}</span><span class="op" id="7455290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7455294">{</span><span class="ident" id="7455295">in</span><span class="op" id="7455297">:</span>&nbsp;<span class="string" id="7455299">&#34;foo=\rbar&#34;</span><span class="op" id="7455310">,</span>&nbsp;<span class="ident" id="7455312">want</span><span class="op" id="7455316">:</span>&nbsp;<span class="string" id="7455318">&#34;foo&#34;</span><span class="op" id="7455323">,</span>&nbsp;<span class="ident" id="7455325">err</span><span class="op" id="7455328">:</span>&nbsp;<span class="string" id="7455330">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d&#34;</span><span class="op" id="7455381">}</span><span class="op" id="7455382">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7455386">{</span><span class="ident" id="7455387">in</span><span class="op" id="7455389">:</span>&nbsp;<span class="string" id="7455391">&#34;foo=\r\r\r&nbsp;\nbar&#34;</span><span class="op" id="7455409">,</span>&nbsp;<span class="ident" id="7455411">want</span><span class="op" id="7455415">:</span>&nbsp;<span class="string" id="7455417">&#34;foo&#34;</span><span class="op" id="7455422">,</span>&nbsp;<span class="ident" id="7455424">err</span><span class="op" id="7455427">:</span>&nbsp;<span class="string" id="7455429">`multipart:&nbsp;invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;&#34;\r\r\r&nbsp;\n&#34;`</span><span class="op" id="7455476">}</span><span class="op" id="7455477">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7455482">//&nbsp;Example&nbsp;from&nbsp;RFC&nbsp;2045:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7455510">{</span><span class="ident" id="7455511">in</span><span class="op" id="7455513">:</span>&nbsp;<span class="string" id="7455515">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;=\n&#34;</span>&nbsp;<span class="op" id="7455536">+</span>&nbsp;<span class="string" id="7455538">&#34;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come=\n&#34;</span>&nbsp;<span class="op" id="7455564">+</span>&nbsp;<span class="string" id="7455566">&#34;&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="7455597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7455602">want</span><span class="op" id="7455606">:</span>&nbsp;<span class="string" id="7455608">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="7455674">}</span><span class="op" id="7455675">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7455678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7455681">for</span>&nbsp;<span class="ident" id="7455685">_</span><span class="op" id="7455686">,</span>&nbsp;<span class="ident" id="7455688">tt</span>&nbsp;<span class="op" id="7455691">:=</span>&nbsp;<span class="keyword" id="7455694">range</span>&nbsp;<span class="ident" id="7455700">tests</span>&nbsp;<span class="op" id="7455706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7455710">var</span>&nbsp;<span class="ident" id="7455714">buf</span>&nbsp;<span class="ident" id="7455718">bytes</span><span class="op" id="7455723">.</span><span class="ident" id="7455724">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7455733">_</span><span class="op" id="7455734">,</span>&nbsp;<span class="ident" id="7455736">err</span>&nbsp;<span class="op" id="7455740">:=</span>&nbsp;<span class="ident" id="7455743">io</span><span class="op" id="7455745">.</span><span class="ident" id="7455746">Copy</span><span class="op" id="7455750">(</span><span class="op" id="7455751">&amp;</span><span class="ident" id="7455752">buf</span><span class="op" id="7455755">,</span>&nbsp;<span class="ident" id="7455757">newQuotedPrintableReader</span><span class="op" id="7455781">(</span><span class="ident" id="7455782">strings</span><span class="op" id="7455789">.</span><span class="ident" id="7455790">NewReader</span><span class="op" id="7455799">(</span><span class="ident" id="7455800">tt</span><span class="op" id="7455802">.</span><span class="ident" id="7455803">in</span><span class="op" id="7455805">)</span><span class="op" id="7455806">)</span><span class="op" id="7455807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7455811">if</span>&nbsp;<span class="ident" id="7455814">got</span>&nbsp;<span class="op" id="7455818">:=</span>&nbsp;<span class="ident" id="7455821">buf</span><span class="op" id="7455824">.</span><span class="ident" id="7455825">String</span><span class="op" id="7455831">(</span><span class="op" id="7455832">)</span><span class="op" id="7455833">;</span>&nbsp;<span class="ident" id="7455835">got</span>&nbsp;<span class="op" id="7455839">!=</span>&nbsp;<span class="ident" id="7455842">tt</span><span class="op" id="7455844">.</span><span class="ident" id="7455845">want</span>&nbsp;<span class="op" id="7455850">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7455855">t</span><span class="op" id="7455856">.</span><span class="ident" id="7455857">Errorf</span><span class="op" id="7455863">(</span><span class="string" id="7455864">&#34;for&nbsp;%q,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7455889">,</span>&nbsp;<span class="ident" id="7455891">tt</span><span class="op" id="7455893">.</span><span class="ident" id="7455894">in</span><span class="op" id="7455896">,</span>&nbsp;<span class="ident" id="7455898">got</span><span class="op" id="7455901">,</span>&nbsp;<span class="ident" id="7455903">tt</span><span class="op" id="7455905">.</span><span class="ident" id="7455906">want</span><span class="op" id="7455910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7455914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7455918">switch</span>&nbsp;<span class="ident" id="7455925">verr</span>&nbsp;<span class="op" id="7455930">:=</span>&nbsp;<span class="ident" id="7455933">tt</span><span class="op" id="7455935">.</span><span class="ident" id="7455936">err</span><span class="op" id="7455939">.</span><span class="op" id="7455940">(</span><span class="keyword" id="7455941">type</span><span class="op" id="7455945">)</span>&nbsp;<span class="op" id="7455947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7455951">case</span>&nbsp;<span class="ident" id="7455956">nil</span><span class="op" id="7455959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7455964">if</span>&nbsp;<span class="ident" id="7455967">err</span>&nbsp;<span class="op" id="7455971">!=</span>&nbsp;<span class="ident" id="7455974">nil</span>&nbsp;<span class="op" id="7455978">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7455984">t</span><span class="op" id="7455985">.</span><span class="ident" id="7455986">Errorf</span><span class="op" id="7455992">(</span><span class="string" id="7455993">&#34;for&nbsp;%q,&nbsp;got&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7456027">,</span>&nbsp;<span class="ident" id="7456029">tt</span><span class="op" id="7456031">.</span><span class="ident" id="7456032">in</span><span class="op" id="7456034">,</span>&nbsp;<span class="ident" id="7456036">err</span><span class="op" id="7456039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7456044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7456048">case</span>&nbsp;<span class="builtintype" id="7456053">string</span><span class="op" id="7456059">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7456064">if</span>&nbsp;<span class="ident" id="7456067">got</span>&nbsp;<span class="op" id="7456071">:=</span>&nbsp;<span class="ident" id="7456074">fmt</span><span class="op" id="7456077">.</span><span class="ident" id="7456078">Sprint</span><span class="op" id="7456084">(</span><span class="ident" id="7456085">err</span><span class="op" id="7456088">)</span><span class="op" id="7456089">;</span>&nbsp;<span class="ident" id="7456091">got</span>&nbsp;<span class="op" id="7456095">!=</span>&nbsp;<span class="ident" id="7456098">verr</span>&nbsp;<span class="op" id="7456103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7456109">t</span><span class="op" id="7456110">.</span><span class="ident" id="7456111">Errorf</span><span class="op" id="7456117">(</span><span class="string" id="7456118">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7456149">,</span>&nbsp;<span class="ident" id="7456151">tt</span><span class="op" id="7456153">.</span><span class="ident" id="7456154">in</span><span class="op" id="7456156">,</span>&nbsp;<span class="ident" id="7456158">got</span><span class="op" id="7456161">,</span>&nbsp;<span class="ident" id="7456163">verr</span><span class="op" id="7456167">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7456172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7456176">case</span>&nbsp;<span class="builtintype" id="7456181">error</span><span class="op" id="7456186">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7456191">if</span>&nbsp;<span class="ident" id="7456194">err</span>&nbsp;<span class="op" id="7456198">!=</span>&nbsp;<span class="ident" id="7456201">verr</span>&nbsp;<span class="op" id="7456206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7456212">t</span><span class="op" id="7456213">.</span><span class="ident" id="7456214">Errorf</span><span class="op" id="7456220">(</span><span class="string" id="7456221">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7456252">,</span>&nbsp;<span class="ident" id="7456254">tt</span><span class="op" id="7456256">.</span><span class="ident" id="7456257">in</span><span class="op" id="7456259">,</span>&nbsp;<span class="ident" id="7456261">err</span><span class="op" id="7456264">,</span>&nbsp;<span class="ident" id="7456266">verr</span><span class="op" id="7456270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7456275">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7456279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7456282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="7456285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7456288">func</span>&nbsp;<span class="ident" id="7456293">everySequence</span><span class="op" id="7456306">(</span><span class="ident" id="7456307">base</span><span class="op" id="7456311">,</span>&nbsp;<span class="ident" id="7456313">alpha</span>&nbsp;<span class="builtintype" id="7456319">string</span><span class="op" id="7456325">,</span>&nbsp;<span class="ident" id="7456327">length</span>&nbsp;<span class="builtintype" id="7456334">int</span><span class="op" id="7456337">,</span>&nbsp;<span class="ident" id="7456339">fn</span>&nbsp;<span class="keyword" id="7456342">func</span><span class="op" id="7456346">(</span><span class="builtintype" id="7456347">string</span><span class="op" id="7456353">)</span><span class="op" id="7456354">)</span>&nbsp;<span class="op" id="7456356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7456359">if</span>&nbsp;<span class="builtinfunc" id="7456362">len</span><span class="op" id="7456365">(</span><span class="ident" id="7456366">base</span><span class="op" id="7456370">)</span>&nbsp;<span class="op" id="7456372">==</span>&nbsp;<span class="ident" id="7456375">length</span>&nbsp;<span class="op" id="7456382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7456386">fn</span><span class="op" id="7456388">(</span><span class="ident" id="7456389">base</span><span class="op" id="7456393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7456397">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7456405">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7456408">for</span>&nbsp;<span class="ident" id="7456412">i</span>&nbsp;<span class="op" id="7456414">:=</span>&nbsp;<span class="num" id="7456417">0</span><span class="op" id="7456418">;</span>&nbsp;<span class="ident" id="7456420">i</span>&nbsp;<span class="op" id="7456422">&lt;</span>&nbsp;<span class="builtinfunc" id="7456424">len</span><span class="op" id="7456427">(</span><span class="ident" id="7456428">alpha</span><span class="op" id="7456433">)</span><span class="op" id="7456434">;</span>&nbsp;<span class="ident" id="7456436">i</span><span class="op" id="7456437">++</span>&nbsp;<span class="op" id="7456440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7456444">everySequence</span><span class="op" id="7456457">(</span><span class="ident" id="7456458">base</span><span class="op" id="7456462">+</span><span class="ident" id="7456463">alpha</span><span class="op" id="7456468">[</span><span class="ident" id="7456469">i</span><span class="op" id="7456470">:</span><span class="ident" id="7456471">i</span><span class="op" id="7456472">+</span><span class="num" id="7456473">1</span><span class="op" id="7456474">]</span><span class="op" id="7456475">,</span>&nbsp;<span class="ident" id="7456477">alpha</span><span class="op" id="7456482">,</span>&nbsp;<span class="ident" id="7456484">length</span><span class="op" id="7456490">,</span>&nbsp;<span class="ident" id="7456492">fn</span><span class="op" id="7456494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7456497">}</span><br>
<span class="lineno"></span><span class="op" id="7456499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="7456502">var</span>&nbsp;<span class="ident" id="7456506">useQprint</span>&nbsp;<span class="op" id="7456516">=</span>&nbsp;<span class="ident" id="7456518">flag</span><span class="op" id="7456522">.</span><span class="ident" id="7456523">Bool</span><span class="op" id="7456527">(</span><span class="string" id="7456528">&#34;qprint&#34;</span><span class="op" id="7456536">,</span>&nbsp;<span class="builtintype" id="7456538">false</span><span class="op" id="7456543">,</span>&nbsp;<span class="string" id="7456545">&#34;Compare&nbsp;against&nbsp;the&nbsp;&#39;qprint&#39;&nbsp;program.&#34;</span><span class="op" id="7456584">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7456587">var</span>&nbsp;<span class="ident" id="7456591">badSoftRx</span>&nbsp;<span class="op" id="7456601">=</span>&nbsp;<span class="ident" id="7456603">regexp</span><span class="op" id="7456609">.</span><span class="ident" id="7456610">MustCompile</span><span class="op" id="7456621">(</span><span class="string" id="7456622">`=([^\r\n]+?\n)|([^\r\n]+$)|(\r$)|(\r[^\n]+\n)|(&nbsp;\r\n)`</span><span class="op" id="7456677">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7456680">func</span>&nbsp;<span class="ident" id="7456685">TestQPExhaustive</span><span class="op" id="7456701">(</span><span class="ident" id="7456702">t</span>&nbsp;<span class="op" id="7456704">*</span><span class="ident" id="7456705">testing</span><span class="op" id="7456712">.</span><span class="ident" id="7456713">T</span><span class="op" id="7456714">)</span>&nbsp;<span class="op" id="7456716">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7456719">if</span>&nbsp;<span class="op" id="7456722">*</span><span class="ident" id="7456723">useQprint</span>&nbsp;<span class="op" id="7456733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7456737">_</span><span class="op" id="7456738">,</span>&nbsp;<span class="ident" id="7456740">err</span>&nbsp;<span class="op" id="7456744">:=</span>&nbsp;<span class="ident" id="7456747">exec</span><span class="op" id="7456751">.</span><span class="ident" id="7456752">LookPath</span><span class="op" id="7456760">(</span><span class="string" id="7456761">&#34;qprint&#34;</span><span class="op" id="7456769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7456773">if</span>&nbsp;<span class="ident" id="7456776">err</span>&nbsp;<span class="op" id="7456780">!=</span>&nbsp;<span class="ident" id="7456783">nil</span>&nbsp;<span class="op" id="7456787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7456792">t</span><span class="op" id="7456793">.</span><span class="ident" id="7456794">Fatalf</span><span class="op" id="7456800">(</span><span class="string" id="7456801">&#34;Error&nbsp;looking&nbsp;for&nbsp;qprint:&nbsp;%v&#34;</span><span class="op" id="7456831">,</span>&nbsp;<span class="ident" id="7456833">err</span><span class="op" id="7456836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7456840">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7456843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7456847">var</span>&nbsp;<span class="ident" id="7456851">buf</span>&nbsp;<span class="ident" id="7456855">bytes</span><span class="op" id="7456860">.</span><span class="ident" id="7456861">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7456869">res</span>&nbsp;<span class="op" id="7456873">:=</span>&nbsp;<span class="builtinfunc" id="7456876">make</span><span class="op" id="7456880">(</span><span class="keyword" id="7456881">map</span><span class="op" id="7456884">[</span><span class="builtintype" id="7456885">string</span><span class="op" id="7456891">]</span><span class="builtintype" id="7456892">int</span><span class="op" id="7456895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7456898">everySequence</span><span class="op" id="7456911">(</span><span class="string" id="7456912">&#34;&#34;</span><span class="op" id="7456914">,</span>&nbsp;<span class="string" id="7456916">&#34;0A&nbsp;\r\n=&#34;</span><span class="op" id="7456926">,</span>&nbsp;<span class="num" id="7456928">6</span><span class="op" id="7456929">,</span>&nbsp;<span class="keyword" id="7456931">func</span><span class="op" id="7456935">(</span><span class="ident" id="7456936">s</span>&nbsp;<span class="builtintype" id="7456938">string</span><span class="op" id="7456944">)</span>&nbsp;<span class="op" id="7456946">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7456950">if</span>&nbsp;<span class="ident" id="7456953">strings</span><span class="op" id="7456960">.</span><span class="ident" id="7456961">HasSuffix</span><span class="op" id="7456970">(</span><span class="ident" id="7456971">s</span><span class="op" id="7456972">,</span>&nbsp;<span class="string" id="7456974">&#34;=&#34;</span><span class="op" id="7456977">)</span>&nbsp;<span class="op" id="7456979">||</span>&nbsp;<span class="ident" id="7456982">strings</span><span class="op" id="7456989">.</span><span class="ident" id="7456990">Contains</span><span class="op" id="7456998">(</span><span class="ident" id="7456999">s</span><span class="op" id="7457000">,</span>&nbsp;<span class="string" id="7457002">&#34;==&#34;</span><span class="op" id="7457006">)</span>&nbsp;<span class="op" id="7457008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457013">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7457022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457026">buf</span><span class="op" id="7457029">.</span><span class="ident" id="7457030">Reset</span><span class="op" id="7457035">(</span><span class="op" id="7457036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457040">_</span><span class="op" id="7457041">,</span>&nbsp;<span class="ident" id="7457043">err</span>&nbsp;<span class="op" id="7457047">:=</span>&nbsp;<span class="ident" id="7457050">io</span><span class="op" id="7457052">.</span><span class="ident" id="7457053">Copy</span><span class="op" id="7457057">(</span><span class="op" id="7457058">&amp;</span><span class="ident" id="7457059">buf</span><span class="op" id="7457062">,</span>&nbsp;<span class="ident" id="7457064">newQuotedPrintableReader</span><span class="op" id="7457088">(</span><span class="ident" id="7457089">strings</span><span class="op" id="7457096">.</span><span class="ident" id="7457097">NewReader</span><span class="op" id="7457106">(</span><span class="ident" id="7457107">s</span><span class="op" id="7457108">)</span><span class="op" id="7457109">)</span><span class="op" id="7457110">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457114">if</span>&nbsp;<span class="ident" id="7457117">err</span>&nbsp;<span class="op" id="7457121">!=</span>&nbsp;<span class="ident" id="7457124">nil</span>&nbsp;<span class="op" id="7457128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457133">errStr</span>&nbsp;<span class="op" id="7457140">:=</span>&nbsp;<span class="ident" id="7457143">err</span><span class="op" id="7457146">.</span><span class="ident" id="7457147">Error</span><span class="op" id="7457152">(</span><span class="op" id="7457153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457158">if</span>&nbsp;<span class="ident" id="7457161">strings</span><span class="op" id="7457168">.</span><span class="ident" id="7457169">Contains</span><span class="op" id="7457177">(</span><span class="ident" id="7457178">errStr</span><span class="op" id="7457184">,</span>&nbsp;<span class="string" id="7457186">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=:&#34;</span><span class="op" id="7457210">)</span>&nbsp;<span class="op" id="7457212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457218">errStr</span>&nbsp;<span class="op" id="7457225">=</span>&nbsp;<span class="string" id="7457227">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7457254">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457259">res</span><span class="op" id="7457262">[</span><span class="ident" id="7457263">errStr</span><span class="op" id="7457269">]</span><span class="op" id="7457270">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457276">if</span>&nbsp;<span class="ident" id="7457279">strings</span><span class="op" id="7457286">.</span><span class="ident" id="7457287">Contains</span><span class="op" id="7457295">(</span><span class="ident" id="7457296">errStr</span><span class="op" id="7457302">,</span>&nbsp;<span class="string" id="7457304">&#34;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;&#34;</span><span class="op" id="7457340">)</span>&nbsp;<span class="op" id="7457342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457348">if</span>&nbsp;<span class="ident" id="7457351">strings</span><span class="op" id="7457358">.</span><span class="ident" id="7457359">HasSuffix</span><span class="op" id="7457368">(</span><span class="ident" id="7457369">errStr</span><span class="op" id="7457375">,</span>&nbsp;<span class="string" id="7457377">&#34;0x20&#34;</span><span class="op" id="7457383">)</span>&nbsp;<span class="op" id="7457385">&amp;&amp;</span>&nbsp;<span class="op" id="7457388">(</span><span class="ident" id="7457389">strings</span><span class="op" id="7457396">.</span><span class="ident" id="7457397">Contains</span><span class="op" id="7457405">(</span><span class="ident" id="7457406">s</span><span class="op" id="7457407">,</span>&nbsp;<span class="string" id="7457409">&#34;=0&nbsp;&#34;</span><span class="op" id="7457414">)</span>&nbsp;<span class="op" id="7457416">||</span>&nbsp;<span class="ident" id="7457419">strings</span><span class="op" id="7457426">.</span><span class="ident" id="7457427">Contains</span><span class="op" id="7457435">(</span><span class="ident" id="7457436">s</span><span class="op" id="7457437">,</span>&nbsp;<span class="string" id="7457439">&#34;=A&nbsp;&#34;</span><span class="op" id="7457444">)</span>&nbsp;<span class="op" id="7457446">||</span>&nbsp;<span class="ident" id="7457449">strings</span><span class="op" id="7457456">.</span><span class="ident" id="7457457">Contains</span><span class="op" id="7457465">(</span><span class="ident" id="7457466">s</span><span class="op" id="7457467">,</span>&nbsp;<span class="string" id="7457469">&#34;=&nbsp;&#34;</span><span class="op" id="7457473">)</span><span class="op" id="7457474">)</span>&nbsp;<span class="op" id="7457476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457483">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7457494">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457500">if</span>&nbsp;<span class="ident" id="7457503">strings</span><span class="op" id="7457510">.</span><span class="ident" id="7457511">HasSuffix</span><span class="op" id="7457520">(</span><span class="ident" id="7457521">errStr</span><span class="op" id="7457527">,</span>&nbsp;<span class="string" id="7457529">&#34;0x3d&#34;</span><span class="op" id="7457535">)</span>&nbsp;<span class="op" id="7457537">&amp;&amp;</span>&nbsp;<span class="op" id="7457540">(</span><span class="ident" id="7457541">strings</span><span class="op" id="7457548">.</span><span class="ident" id="7457549">Contains</span><span class="op" id="7457557">(</span><span class="ident" id="7457558">s</span><span class="op" id="7457559">,</span>&nbsp;<span class="string" id="7457561">&#34;=0=&#34;</span><span class="op" id="7457566">)</span>&nbsp;<span class="op" id="7457568">||</span>&nbsp;<span class="ident" id="7457571">strings</span><span class="op" id="7457578">.</span><span class="ident" id="7457579">Contains</span><span class="op" id="7457587">(</span><span class="ident" id="7457588">s</span><span class="op" id="7457589">,</span>&nbsp;<span class="string" id="7457591">&#34;=A=&#34;</span><span class="op" id="7457596">)</span><span class="op" id="7457597">)</span>&nbsp;<span class="op" id="7457599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457606">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7457617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457623">if</span>&nbsp;<span class="ident" id="7457626">strings</span><span class="op" id="7457633">.</span><span class="ident" id="7457634">HasSuffix</span><span class="op" id="7457643">(</span><span class="ident" id="7457644">errStr</span><span class="op" id="7457650">,</span>&nbsp;<span class="string" id="7457652">&#34;0x0a&#34;</span><span class="op" id="7457658">)</span>&nbsp;<span class="op" id="7457660">||</span>&nbsp;<span class="ident" id="7457663">strings</span><span class="op" id="7457670">.</span><span class="ident" id="7457671">HasSuffix</span><span class="op" id="7457680">(</span><span class="ident" id="7457681">errStr</span><span class="op" id="7457687">,</span>&nbsp;<span class="string" id="7457689">&#34;0x0d&#34;</span><span class="op" id="7457695">)</span>&nbsp;<span class="op" id="7457697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7457704">//&nbsp;bunch&nbsp;of&nbsp;cases;&nbsp;since&nbsp;whitespace&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;before&nbsp;\n&nbsp;is&nbsp;removed.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457788">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7457799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7457804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457809">if</span>&nbsp;<span class="ident" id="7457812">strings</span><span class="op" id="7457819">.</span><span class="ident" id="7457820">Contains</span><span class="op" id="7457828">(</span><span class="ident" id="7457829">errStr</span><span class="op" id="7457835">,</span>&nbsp;<span class="string" id="7457837">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="7457853">)</span>&nbsp;<span class="op" id="7457855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457861">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7457871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457876">if</span>&nbsp;<span class="ident" id="7457879">errStr</span>&nbsp;<span class="op" id="7457886">==</span>&nbsp;<span class="string" id="7457889">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span>&nbsp;<span class="op" id="7457913">&amp;&amp;</span>&nbsp;<span class="ident" id="7457916">badSoftRx</span><span class="op" id="7457925">.</span><span class="ident" id="7457926">MatchString</span><span class="op" id="7457937">(</span><span class="ident" id="7457938">s</span><span class="op" id="7457939">)</span>&nbsp;<span class="op" id="7457941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7457947">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7457957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457962">t</span><span class="op" id="7457963">.</span><span class="ident" id="7457964">Errorf</span><span class="op" id="7457970">(</span><span class="string" id="7457971">&#34;decode(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7457988">,</span>&nbsp;<span class="ident" id="7457990">s</span><span class="op" id="7457991">,</span>&nbsp;<span class="ident" id="7457993">err</span><span class="op" id="7457996">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458001">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458014">if</span>&nbsp;<span class="op" id="7458017">*</span><span class="ident" id="7458018">useQprint</span>&nbsp;<span class="op" id="7458028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458033">cmd</span>&nbsp;<span class="op" id="7458037">:=</span>&nbsp;<span class="ident" id="7458040">exec</span><span class="op" id="7458044">.</span><span class="ident" id="7458045">Command</span><span class="op" id="7458052">(</span><span class="string" id="7458053">&#34;qprint&#34;</span><span class="op" id="7458061">,</span>&nbsp;<span class="string" id="7458063">&#34;-d&#34;</span><span class="op" id="7458067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458072">cmd</span><span class="op" id="7458075">.</span><span class="ident" id="7458076">Stdin</span>&nbsp;<span class="op" id="7458082">=</span>&nbsp;<span class="ident" id="7458084">strings</span><span class="op" id="7458091">.</span><span class="ident" id="7458092">NewReader</span><span class="op" id="7458101">(</span><span class="ident" id="7458102">s</span><span class="op" id="7458103">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458108">stderr</span><span class="op" id="7458114">,</span>&nbsp;<span class="ident" id="7458116">err</span>&nbsp;<span class="op" id="7458120">:=</span>&nbsp;<span class="ident" id="7458123">cmd</span><span class="op" id="7458126">.</span><span class="ident" id="7458127">StderrPipe</span><span class="op" id="7458137">(</span><span class="op" id="7458138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458143">if</span>&nbsp;<span class="ident" id="7458146">err</span>&nbsp;<span class="op" id="7458150">!=</span>&nbsp;<span class="ident" id="7458153">nil</span>&nbsp;<span class="op" id="7458157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7458163">panic</span><span class="op" id="7458168">(</span><span class="ident" id="7458169">err</span><span class="op" id="7458172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458182">qpres</span>&nbsp;<span class="op" id="7458188">:=</span>&nbsp;<span class="builtinfunc" id="7458191">make</span><span class="op" id="7458195">(</span><span class="keyword" id="7458196">chan</span>&nbsp;<span class="keyword" id="7458201">interface</span><span class="op" id="7458210">{</span><span class="op" id="7458211">}</span><span class="op" id="7458212">,</span>&nbsp;<span class="num" id="7458214">2</span><span class="op" id="7458215">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458220">go</span>&nbsp;<span class="keyword" id="7458223">func</span><span class="op" id="7458227">(</span><span class="op" id="7458228">)</span>&nbsp;<span class="op" id="7458230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458236">br</span>&nbsp;<span class="op" id="7458239">:=</span>&nbsp;<span class="ident" id="7458242">bufio</span><span class="op" id="7458247">.</span><span class="ident" id="7458248">NewReader</span><span class="op" id="7458257">(</span><span class="ident" id="7458258">stderr</span><span class="op" id="7458264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458270">s</span><span class="op" id="7458271">,</span>&nbsp;<span class="ident" id="7458273">_</span>&nbsp;<span class="op" id="7458275">:=</span>&nbsp;<span class="ident" id="7458278">br</span><span class="op" id="7458280">.</span><span class="ident" id="7458281">ReadString</span><span class="op" id="7458291">(</span><span class="string" id="7458292">&#39;\n&#39;</span><span class="op" id="7458296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458302">if</span>&nbsp;<span class="ident" id="7458305">s</span>&nbsp;<span class="op" id="7458307">!=</span>&nbsp;<span class="string" id="7458310">&#34;&#34;</span>&nbsp;<span class="op" id="7458313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458320">qpres</span>&nbsp;<span class="op" id="7458326">&lt;-</span>&nbsp;<span class="ident" id="7458329">errors</span><span class="op" id="7458335">.</span><span class="ident" id="7458336">New</span><span class="op" id="7458339">(</span><span class="ident" id="7458340">s</span><span class="op" id="7458341">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458348">if</span>&nbsp;<span class="ident" id="7458351">cmd</span><span class="op" id="7458354">.</span><span class="ident" id="7458355">Process</span>&nbsp;<span class="op" id="7458363">!=</span>&nbsp;<span class="ident" id="7458366">nil</span>&nbsp;<span class="op" id="7458370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7458378">//&nbsp;It&nbsp;can&nbsp;get&nbsp;stuck&nbsp;on&nbsp;invalid&nbsp;input,&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7458428">//&nbsp;echo&nbsp;-n&nbsp;&#34;0000=&nbsp;&#34;&nbsp;|&nbsp;qprint&nbsp;-d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458466">cmd</span><span class="op" id="7458469">.</span><span class="ident" id="7458470">Process</span><span class="op" id="7458477">.</span><span class="ident" id="7458478">Kill</span><span class="op" id="7458482">(</span><span class="op" id="7458483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458490">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458501">}</span><span class="op" id="7458502">(</span><span class="op" id="7458503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458508">go</span>&nbsp;<span class="keyword" id="7458511">func</span><span class="op" id="7458515">(</span><span class="op" id="7458516">)</span>&nbsp;<span class="op" id="7458518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458524">want</span><span class="op" id="7458528">,</span>&nbsp;<span class="ident" id="7458530">err</span>&nbsp;<span class="op" id="7458534">:=</span>&nbsp;<span class="ident" id="7458537">cmd</span><span class="op" id="7458540">.</span><span class="ident" id="7458541">Output</span><span class="op" id="7458547">(</span><span class="op" id="7458548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458554">if</span>&nbsp;<span class="ident" id="7458557">err</span>&nbsp;<span class="op" id="7458561">==</span>&nbsp;<span class="ident" id="7458564">nil</span>&nbsp;<span class="op" id="7458568">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458575">qpres</span>&nbsp;<span class="op" id="7458581">&lt;-</span>&nbsp;<span class="ident" id="7458584">want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458598">}</span><span class="op" id="7458599">(</span><span class="op" id="7458600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458605">select</span>&nbsp;<span class="op" id="7458612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458617">case</span>&nbsp;<span class="ident" id="7458622">got</span>&nbsp;<span class="op" id="7458626">:=</span>&nbsp;<span class="op" id="7458629">&lt;-</span><span class="ident" id="7458631">qpres</span><span class="op" id="7458636">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458642">if</span>&nbsp;<span class="ident" id="7458645">want</span><span class="op" id="7458649">,</span>&nbsp;<span class="ident" id="7458651">ok</span>&nbsp;<span class="op" id="7458654">:=</span>&nbsp;<span class="ident" id="7458657">got</span><span class="op" id="7458660">.</span><span class="op" id="7458661">(</span><span class="op" id="7458662">[</span><span class="op" id="7458663">]</span><span class="builtintype" id="7458664">byte</span><span class="op" id="7458668">)</span><span class="op" id="7458669">;</span>&nbsp;<span class="ident" id="7458671">ok</span>&nbsp;<span class="op" id="7458674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458681">if</span>&nbsp;<span class="builtintype" id="7458684">string</span><span class="op" id="7458690">(</span><span class="ident" id="7458691">want</span><span class="op" id="7458695">)</span>&nbsp;<span class="op" id="7458697">!=</span>&nbsp;<span class="ident" id="7458700">buf</span><span class="op" id="7458703">.</span><span class="ident" id="7458704">String</span><span class="op" id="7458710">(</span><span class="op" id="7458711">)</span>&nbsp;<span class="op" id="7458713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458721">t</span><span class="op" id="7458722">.</span><span class="ident" id="7458723">Errorf</span><span class="op" id="7458729">(</span><span class="string" id="7458730">&#34;go&nbsp;decode(%q)&nbsp;=&nbsp;%q;&nbsp;qprint&nbsp;=&nbsp;%q&#34;</span><span class="op" id="7458763">,</span>&nbsp;<span class="ident" id="7458765">s</span><span class="op" id="7458766">,</span>&nbsp;<span class="ident" id="7458768">want</span><span class="op" id="7458772">,</span>&nbsp;<span class="ident" id="7458774">buf</span><span class="op" id="7458777">.</span><span class="ident" id="7458778">String</span><span class="op" id="7458784">(</span><span class="op" id="7458785">)</span><span class="op" id="7458786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458799">}</span>&nbsp;<span class="keyword" id="7458801">else</span>&nbsp;<span class="op" id="7458806">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458813">t</span><span class="op" id="7458814">.</span><span class="ident" id="7458815">Logf</span><span class="op" id="7458819">(</span><span class="string" id="7458820">&#34;qprint&nbsp;-d(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7458840">,</span>&nbsp;<span class="ident" id="7458842">s</span><span class="op" id="7458843">,</span>&nbsp;<span class="ident" id="7458845">got</span><span class="op" id="7458848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458859">case</span>&nbsp;<span class="op" id="7458864">&lt;-</span><span class="ident" id="7458866">time</span><span class="op" id="7458870">.</span><span class="ident" id="7458871">After</span><span class="op" id="7458876">(</span><span class="num" id="7458877">5</span>&nbsp;<span class="op" id="7458879">*</span>&nbsp;<span class="ident" id="7458881">time</span><span class="op" id="7458885">.</span><span class="ident" id="7458886">Second</span><span class="op" id="7458892">)</span><span class="op" id="7458893">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458899">t</span><span class="op" id="7458900">.</span><span class="ident" id="7458901">Logf</span><span class="op" id="7458905">(</span><span class="string" id="7458906">&#34;qprint&nbsp;timeout&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7458928">,</span>&nbsp;<span class="ident" id="7458930">s</span><span class="op" id="7458931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458936">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458944">res</span><span class="op" id="7458947">[</span><span class="string" id="7458948">&#34;OK&#34;</span><span class="op" id="7458952">]</span><span class="op" id="7458953">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7458957">}</span><span class="op" id="7458958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458961">var</span>&nbsp;<span class="ident" id="7458965">outcomes</span>&nbsp;<span class="op" id="7458974">[</span><span class="op" id="7458975">]</span><span class="builtintype" id="7458976">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7458984">for</span>&nbsp;<span class="ident" id="7458988">k</span><span class="op" id="7458989">,</span>&nbsp;<span class="ident" id="7458991">v</span>&nbsp;<span class="op" id="7458993">:=</span>&nbsp;<span class="keyword" id="7458996">range</span>&nbsp;<span class="ident" id="7459002">res</span>&nbsp;<span class="op" id="7459006">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459010">outcomes</span>&nbsp;<span class="op" id="7459019">=</span>&nbsp;<span class="builtinfunc" id="7459021">append</span><span class="op" id="7459027">(</span><span class="ident" id="7459028">outcomes</span><span class="op" id="7459036">,</span>&nbsp;<span class="ident" id="7459038">fmt</span><span class="op" id="7459041">.</span><span class="ident" id="7459042">Sprintf</span><span class="op" id="7459049">(</span><span class="string" id="7459050">&#34;%v:&nbsp;%d&#34;</span><span class="op" id="7459058">,</span>&nbsp;<span class="ident" id="7459060">k</span><span class="op" id="7459061">,</span>&nbsp;<span class="ident" id="7459063">v</span><span class="op" id="7459064">)</span><span class="op" id="7459065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7459068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459071">sort</span><span class="op" id="7459075">.</span><span class="ident" id="7459076">Strings</span><span class="op" id="7459083">(</span><span class="ident" id="7459084">outcomes</span><span class="op" id="7459092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459095">got</span>&nbsp;<span class="op" id="7459099">:=</span>&nbsp;<span class="ident" id="7459102">strings</span><span class="op" id="7459109">.</span><span class="ident" id="7459110">Join</span><span class="op" id="7459114">(</span><span class="ident" id="7459115">outcomes</span><span class="op" id="7459123">,</span>&nbsp;<span class="string" id="7459125">&#34;\n&#34;</span><span class="op" id="7459129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459132">want</span>&nbsp;<span class="op" id="7459137">:=</span>&nbsp;<span class="string" id="7459140">`OK:&nbsp;21576<br>
<span class="lineno">195</span>invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;3397<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0a:&nbsp;1400<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d:&nbsp;2700<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x20:&nbsp;2490<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x3d:&nbsp;440<br>
<span class="lineno">200</span>unexpected&nbsp;EOF:&nbsp;3122`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7459425">if</span>&nbsp;<span class="ident" id="7459428">got</span>&nbsp;<span class="op" id="7459432">!=</span>&nbsp;<span class="ident" id="7459435">want</span>&nbsp;<span class="op" id="7459440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459444">t</span><span class="op" id="7459445">.</span><span class="ident" id="7459446">Errorf</span><span class="op" id="7459452">(</span><span class="string" id="7459453">&#34;Got:\n%s\nWant:\n%s&#34;</span><span class="op" id="7459474">,</span>&nbsp;<span class="ident" id="7459476">got</span><span class="op" id="7459479">,</span>&nbsp;<span class="ident" id="7459481">want</span><span class="op" id="7459485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7459488">}</span><br>
<span class="lineno"></span><span class="op" id="7459490">}</span>
</div>
</body>
</html>
