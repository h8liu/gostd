<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/arch8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/arch8/console.go.html">console.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu.go.html">cpu.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu_test.go.html">cpu_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/device.go.html">device.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/exception.go.html">exception.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br_test.go.html">inst_br_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm_test.go.html">inst_imm_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg_test.go.html">inst_reg_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/int_bus.go.html">int_bus.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt.go.html">interrupt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt_test.go.html">interrupt_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/machine.go.html">machine.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/multi_core.go.html">multi_core.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page.go.html">page.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table.go.html">page_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table_test.go.html">page_table_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_test.go.html">page_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory.go.html">phy_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory_test.go.html">phy_memory_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs.go.html">regs.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs_test.go.html">regs_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/run_image.go.html">run_image.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/serial.go.html">serial.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/ticker.go.html">ticker.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory.go.html">virt_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory_test.go.html">virt_memory_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="3594261">package</span>&nbsp;<span class="ident" id="3594269">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3594276">//&nbsp;VirtMemory&nbsp;defines&nbsp;an&nbsp;address&nbsp;space&nbsp;which&nbsp;page&nbsp;mapping</span><br>
<span class="lineno"></span><span class="comment" id="3594334">//&nbsp;is&nbsp;defined&nbsp;by&nbsp;a&nbsp;page&nbsp;table.</span><br>
<span class="lineno">5</span><span class="comment" id="3594365">//&nbsp;If&nbsp;no&nbsp;page&nbsp;table&nbsp;is&nbsp;defined,&nbsp;direct&nbsp;mapping&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="keyword" id="3594420">type</span>&nbsp;<span class="ident" id="3594425">virtMemory</span>&nbsp;<span class="keyword" id="3594436">struct</span>&nbsp;<span class="op" id="3594443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594446">phyMem</span>&nbsp;<span class="op" id="3594453">*</span><span class="ident" id="3594454">phyMemory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594465">ptable</span>&nbsp;<span class="op" id="3594472">*</span><span class="ident" id="3594473">pageTable</span><br>
<span class="lineno"></span><span class="op" id="3594483">}</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3594486">//&nbsp;NewVirtMemory&nbsp;creates&nbsp;a&nbsp;new&nbsp;virtual&nbsp;address&nbsp;space&nbsp;with&nbsp;no&nbsp;page&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="3594559">func</span>&nbsp;<span class="ident" id="3594564">newVirtMemory</span><span class="op" id="3594577">(</span><span class="ident" id="3594578">phy</span>&nbsp;<span class="op" id="3594582">*</span><span class="ident" id="3594583">phyMemory</span><span class="op" id="3594592">)</span>&nbsp;<span class="op" id="3594594">*</span><span class="ident" id="3594595">virtMemory</span>&nbsp;<span class="op" id="3594606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594609">ret</span>&nbsp;<span class="op" id="3594613">:=</span>&nbsp;<span class="builtinfunc" id="3594616">new</span><span class="op" id="3594619">(</span><span class="ident" id="3594620">virtMemory</span><span class="op" id="3594630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594633">ret</span><span class="op" id="3594636">.</span><span class="ident" id="3594637">phyMem</span>&nbsp;<span class="op" id="3594644">=</span>&nbsp;<span class="ident" id="3594646">phy</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594651">return</span>&nbsp;<span class="ident" id="3594658">ret</span><br>
<span class="lineno"></span><span class="op" id="3594662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3594665">//&nbsp;SetTable&nbsp;applies&nbsp;a&nbsp;particular&nbsp;pagetable&nbsp;at&nbsp;a&nbsp;physical&nbsp;memory&nbsp;position.</span><br>
<span class="lineno"></span><span class="comment" id="3594739">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;not&nbsp;page&nbsp;size&nbsp;aligned,&nbsp;it&nbsp;will&nbsp;be&nbsp;aligned&nbsp;down.</span><br>
<span class="lineno">20</span><span class="comment" id="3594808">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;0,&nbsp;it&nbsp;will&nbsp;use&nbsp;direct&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="3594860">func</span>&nbsp;<span class="op" id="3594865">(</span><span class="ident" id="3594866">vm</span>&nbsp;<span class="op" id="3594869">*</span><span class="ident" id="3594870">virtMemory</span><span class="op" id="3594880">)</span>&nbsp;<span class="ident" id="3594882">SetTable</span><span class="op" id="3594890">(</span><span class="ident" id="3594891">root</span>&nbsp;<span class="builtintype" id="3594896">uint32</span><span class="op" id="3594902">)</span>&nbsp;<span class="op" id="3594904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594907">if</span>&nbsp;<span class="ident" id="3594910">root</span>&nbsp;<span class="op" id="3594915">==</span>&nbsp;<span class="num" id="3594918">0</span>&nbsp;<span class="op" id="3594920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594924">vm</span><span class="op" id="3594926">.</span><span class="ident" id="3594927">ptable</span>&nbsp;<span class="op" id="3594934">=</span>&nbsp;<span class="ident" id="3594936">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3594941">}</span>&nbsp;<span class="keyword" id="3594943">else</span>&nbsp;<span class="op" id="3594948">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594952">vm</span><span class="op" id="3594954">.</span><span class="ident" id="3594955">ptable</span>&nbsp;<span class="op" id="3594962">=</span>&nbsp;<span class="ident" id="3594964">newPageTable</span><span class="op" id="3594976">(</span><span class="ident" id="3594977">vm</span><span class="op" id="3594979">.</span><span class="ident" id="3594980">phyMem</span><span class="op" id="3594986">,</span>&nbsp;<span class="ident" id="3594988">root</span><span class="op" id="3594992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3594995">}</span><br>
<span class="lineno"></span><span class="op" id="3594997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3595000">func</span>&nbsp;<span class="op" id="3595005">(</span><span class="ident" id="3595006">vm</span>&nbsp;<span class="op" id="3595009">*</span><span class="ident" id="3595010">virtMemory</span><span class="op" id="3595020">)</span>&nbsp;<span class="ident" id="3595022">transRead</span><span class="op" id="3595031">(</span><span class="ident" id="3595032">addr</span>&nbsp;<span class="builtintype" id="3595037">uint32</span><span class="op" id="3595043">,</span>&nbsp;<span class="ident" id="3595045">ring</span>&nbsp;<span class="builtintype" id="3595050">byte</span><span class="op" id="3595054">)</span>&nbsp;<span class="op" id="3595056">(</span><span class="builtintype" id="3595057">uint32</span><span class="op" id="3595063">,</span>&nbsp;<span class="op" id="3595065">*</span><span class="ident" id="3595066">Excep</span><span class="op" id="3595071">)</span>&nbsp;<span class="op" id="3595073">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595076">if</span>&nbsp;<span class="ident" id="3595079">vm</span><span class="op" id="3595081">.</span><span class="ident" id="3595082">ptable</span>&nbsp;<span class="op" id="3595089">==</span>&nbsp;<span class="ident" id="3595092">nil</span>&nbsp;<span class="op" id="3595096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595100">return</span>&nbsp;<span class="ident" id="3595107">addr</span><span class="op" id="3595111">,</span>&nbsp;<span class="ident" id="3595113">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3595118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595121">return</span>&nbsp;<span class="ident" id="3595128">vm</span><span class="op" id="3595130">.</span><span class="ident" id="3595131">ptable</span><span class="op" id="3595137">.</span><span class="ident" id="3595138">TranslateRead</span><span class="op" id="3595151">(</span><span class="ident" id="3595152">addr</span><span class="op" id="3595156">,</span>&nbsp;<span class="ident" id="3595158">ring</span><span class="op" id="3595162">)</span><br>
<span class="lineno"></span><span class="op" id="3595164">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="3595167">func</span>&nbsp;<span class="op" id="3595172">(</span><span class="ident" id="3595173">vm</span>&nbsp;<span class="op" id="3595176">*</span><span class="ident" id="3595177">virtMemory</span><span class="op" id="3595187">)</span>&nbsp;<span class="ident" id="3595189">transWrite</span><span class="op" id="3595199">(</span><span class="ident" id="3595200">addr</span>&nbsp;<span class="builtintype" id="3595205">uint32</span><span class="op" id="3595211">,</span>&nbsp;<span class="ident" id="3595213">ring</span>&nbsp;<span class="builtintype" id="3595218">byte</span><span class="op" id="3595222">)</span>&nbsp;<span class="op" id="3595224">(</span><span class="builtintype" id="3595225">uint32</span><span class="op" id="3595231">,</span>&nbsp;<span class="op" id="3595233">*</span><span class="ident" id="3595234">Excep</span><span class="op" id="3595239">)</span>&nbsp;<span class="op" id="3595241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595244">if</span>&nbsp;<span class="ident" id="3595247">vm</span><span class="op" id="3595249">.</span><span class="ident" id="3595250">ptable</span>&nbsp;<span class="op" id="3595257">==</span>&nbsp;<span class="ident" id="3595260">nil</span>&nbsp;<span class="op" id="3595264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595268">return</span>&nbsp;<span class="ident" id="3595275">addr</span><span class="op" id="3595279">,</span>&nbsp;<span class="ident" id="3595281">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3595286">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595289">return</span>&nbsp;<span class="ident" id="3595296">vm</span><span class="op" id="3595298">.</span><span class="ident" id="3595299">ptable</span><span class="op" id="3595305">.</span><span class="ident" id="3595306">TranslateWrite</span><span class="op" id="3595320">(</span><span class="ident" id="3595321">addr</span><span class="op" id="3595325">,</span>&nbsp;<span class="ident" id="3595327">ring</span><span class="op" id="3595331">)</span><br>
<span class="lineno"></span><span class="op" id="3595333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3595336">//&nbsp;ReadWord&nbsp;reads&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;virtual&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3595393">func</span>&nbsp;<span class="op" id="3595398">(</span><span class="ident" id="3595399">vm</span>&nbsp;<span class="op" id="3595402">*</span><span class="ident" id="3595403">virtMemory</span><span class="op" id="3595413">)</span>&nbsp;<span class="ident" id="3595415">ReadWord</span><span class="op" id="3595423">(</span><span class="ident" id="3595424">addr</span>&nbsp;<span class="builtintype" id="3595429">uint32</span><span class="op" id="3595435">,</span>&nbsp;<span class="ident" id="3595437">ring</span>&nbsp;<span class="builtintype" id="3595442">byte</span><span class="op" id="3595446">)</span>&nbsp;<span class="op" id="3595448">(</span><span class="builtintype" id="3595449">uint32</span><span class="op" id="3595455">,</span>&nbsp;<span class="op" id="3595457">*</span><span class="ident" id="3595458">Excep</span><span class="op" id="3595463">)</span>&nbsp;<span class="op" id="3595465">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595468">addr</span><span class="op" id="3595472">,</span>&nbsp;<span class="ident" id="3595474">e</span>&nbsp;<span class="op" id="3595476">:=</span>&nbsp;<span class="ident" id="3595479">vm</span><span class="op" id="3595481">.</span><span class="ident" id="3595482">transRead</span><span class="op" id="3595491">(</span><span class="ident" id="3595492">addr</span><span class="op" id="3595496">,</span>&nbsp;<span class="ident" id="3595498">ring</span><span class="op" id="3595502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595505">if</span>&nbsp;<span class="ident" id="3595508">e</span>&nbsp;<span class="op" id="3595510">!=</span>&nbsp;<span class="ident" id="3595513">nil</span>&nbsp;<span class="op" id="3595517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595521">return</span>&nbsp;<span class="num" id="3595528">0</span><span class="op" id="3595529">,</span>&nbsp;<span class="ident" id="3595531">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3595534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595537">return</span>&nbsp;<span class="ident" id="3595544">vm</span><span class="op" id="3595546">.</span><span class="ident" id="3595547">phyMem</span><span class="op" id="3595553">.</span><span class="ident" id="3595554">ReadWord</span><span class="op" id="3595562">(</span><span class="ident" id="3595563">addr</span><span class="op" id="3595567">)</span><br>
<span class="lineno">50</span><span class="op" id="3595569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3595572">//&nbsp;WriteWord&nbsp;writes&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;virtual&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3595631">func</span>&nbsp;<span class="op" id="3595636">(</span><span class="ident" id="3595637">vm</span>&nbsp;<span class="op" id="3595640">*</span><span class="ident" id="3595641">virtMemory</span><span class="op" id="3595651">)</span>&nbsp;<span class="ident" id="3595653">WriteWord</span><span class="op" id="3595662">(</span><span class="ident" id="3595663">addr</span>&nbsp;<span class="builtintype" id="3595668">uint32</span><span class="op" id="3595674">,</span>&nbsp;<span class="ident" id="3595676">ring</span>&nbsp;<span class="builtintype" id="3595681">byte</span><span class="op" id="3595685">,</span>&nbsp;<span class="ident" id="3595687">v</span>&nbsp;<span class="builtintype" id="3595689">uint32</span><span class="op" id="3595695">)</span>&nbsp;<span class="op" id="3595697">*</span><span class="ident" id="3595698">Excep</span>&nbsp;<span class="op" id="3595704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595707">addr</span><span class="op" id="3595711">,</span>&nbsp;<span class="ident" id="3595713">e</span>&nbsp;<span class="op" id="3595715">:=</span>&nbsp;<span class="ident" id="3595718">vm</span><span class="op" id="3595720">.</span><span class="ident" id="3595721">transWrite</span><span class="op" id="3595731">(</span><span class="ident" id="3595732">addr</span><span class="op" id="3595736">,</span>&nbsp;<span class="ident" id="3595738">ring</span><span class="op" id="3595742">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595745">if</span>&nbsp;<span class="ident" id="3595748">e</span>&nbsp;<span class="op" id="3595750">!=</span>&nbsp;<span class="ident" id="3595753">nil</span>&nbsp;<span class="op" id="3595757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595761">return</span>&nbsp;<span class="ident" id="3595768">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3595771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595774">return</span>&nbsp;<span class="ident" id="3595781">vm</span><span class="op" id="3595783">.</span><span class="ident" id="3595784">phyMem</span><span class="op" id="3595790">.</span><span class="ident" id="3595791">WriteWord</span><span class="op" id="3595800">(</span><span class="ident" id="3595801">addr</span><span class="op" id="3595805">,</span>&nbsp;<span class="ident" id="3595807">v</span><span class="op" id="3595808">)</span><br>
<span class="lineno"></span><span class="op" id="3595810">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="3595813">//&nbsp;ReadByte&nbsp;reads&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;virtual&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3595870">func</span>&nbsp;<span class="op" id="3595875">(</span><span class="ident" id="3595876">vm</span>&nbsp;<span class="op" id="3595879">*</span><span class="ident" id="3595880">virtMemory</span><span class="op" id="3595890">)</span>&nbsp;<span class="ident" id="3595892">ReadByte</span><span class="op" id="3595900">(</span><span class="ident" id="3595901">addr</span>&nbsp;<span class="builtintype" id="3595906">uint32</span><span class="op" id="3595912">,</span>&nbsp;<span class="ident" id="3595914">ring</span>&nbsp;<span class="builtintype" id="3595919">byte</span><span class="op" id="3595923">)</span>&nbsp;<span class="op" id="3595925">(</span><span class="builtintype" id="3595926">byte</span><span class="op" id="3595930">,</span>&nbsp;<span class="op" id="3595932">*</span><span class="ident" id="3595933">Excep</span><span class="op" id="3595938">)</span>&nbsp;<span class="op" id="3595940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595943">addr</span><span class="op" id="3595947">,</span>&nbsp;<span class="ident" id="3595949">e</span>&nbsp;<span class="op" id="3595951">:=</span>&nbsp;<span class="ident" id="3595954">vm</span><span class="op" id="3595956">.</span><span class="ident" id="3595957">transRead</span><span class="op" id="3595966">(</span><span class="ident" id="3595967">addr</span><span class="op" id="3595971">,</span>&nbsp;<span class="ident" id="3595973">ring</span><span class="op" id="3595977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595980">if</span>&nbsp;<span class="ident" id="3595983">e</span>&nbsp;<span class="op" id="3595985">!=</span>&nbsp;<span class="ident" id="3595988">nil</span>&nbsp;<span class="op" id="3595992">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595996">return</span>&nbsp;<span class="num" id="3596003">0</span><span class="op" id="3596004">,</span>&nbsp;<span class="ident" id="3596006">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3596009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596012">return</span>&nbsp;<span class="ident" id="3596019">vm</span><span class="op" id="3596021">.</span><span class="ident" id="3596022">phyMem</span><span class="op" id="3596028">.</span><span class="ident" id="3596029">ReadByte</span><span class="op" id="3596037">(</span><span class="ident" id="3596038">addr</span><span class="op" id="3596042">)</span><br>
<span class="lineno"></span><span class="op" id="3596044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3596047">//&nbsp;WriteByte&nbsp;writes&nbsp;a&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;virtual&nbsp;address&nbsp;under</span><br>
<span class="lineno"></span><span class="comment" id="3596109">//&nbsp;a&nbsp;certain&nbsp;ring.</span><br>
<span class="lineno"></span><span class="keyword" id="3596128">func</span>&nbsp;<span class="op" id="3596133">(</span><span class="ident" id="3596134">vm</span>&nbsp;<span class="op" id="3596137">*</span><span class="ident" id="3596138">virtMemory</span><span class="op" id="3596148">)</span>&nbsp;<span class="ident" id="3596150">WriteByte</span><span class="op" id="3596159">(</span><span class="ident" id="3596160">addr</span>&nbsp;<span class="builtintype" id="3596165">uint32</span><span class="op" id="3596171">,</span>&nbsp;<span class="ident" id="3596173">ring</span>&nbsp;<span class="builtintype" id="3596178">byte</span><span class="op" id="3596182">,</span>&nbsp;<span class="ident" id="3596184">v</span>&nbsp;<span class="builtintype" id="3596186">byte</span><span class="op" id="3596190">)</span>&nbsp;<span class="op" id="3596192">*</span><span class="ident" id="3596193">Excep</span>&nbsp;<span class="op" id="3596199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596202">addr</span><span class="op" id="3596206">,</span>&nbsp;<span class="ident" id="3596208">e</span>&nbsp;<span class="op" id="3596210">:=</span>&nbsp;<span class="ident" id="3596213">vm</span><span class="op" id="3596215">.</span><span class="ident" id="3596216">transWrite</span><span class="op" id="3596226">(</span><span class="ident" id="3596227">addr</span><span class="op" id="3596231">,</span>&nbsp;<span class="ident" id="3596233">ring</span><span class="op" id="3596237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596240">if</span>&nbsp;<span class="ident" id="3596243">e</span>&nbsp;<span class="op" id="3596245">!=</span>&nbsp;<span class="ident" id="3596248">nil</span>&nbsp;<span class="op" id="3596252">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596256">return</span>&nbsp;<span class="ident" id="3596263">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3596266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596269">return</span>&nbsp;<span class="ident" id="3596276">vm</span><span class="op" id="3596278">.</span><span class="ident" id="3596279">phyMem</span><span class="op" id="3596285">.</span><span class="ident" id="3596286">WriteByte</span><span class="op" id="3596295">(</span><span class="ident" id="3596296">addr</span><span class="op" id="3596300">,</span>&nbsp;<span class="ident" id="3596302">v</span><span class="op" id="3596303">)</span><br>
<span class="lineno"></span><span class="op" id="3596305">}</span>
</div>
</body>
</html>
