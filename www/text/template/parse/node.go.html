<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4497250">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4497305">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4497359">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4497410">//&nbsp;Parse&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4497427">package</span>&nbsp;<span class="ident" id="4497435">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4497442">import</span>&nbsp;<span class="op" id="4497449">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4497452">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4497461">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4497468">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4497479">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4497489">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4497492">var</span>&nbsp;<span class="ident" id="4497496">textFormat</span>&nbsp;<span class="op" id="4497507">=</span>&nbsp;<span class="string" id="4497509">&#34;%s&#34;</span>&nbsp;<span class="comment" id="4497514">//&nbsp;Changed&nbsp;to&nbsp;&#34;%q&#34;&nbsp;in&nbsp;tests&nbsp;for&nbsp;better&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4497570">//&nbsp;A&nbsp;Node&nbsp;is&nbsp;an&nbsp;element&nbsp;in&nbsp;the&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;interface&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span><span class="comment" id="4497639">//&nbsp;The&nbsp;interface&nbsp;contains&nbsp;an&nbsp;unexported&nbsp;method&nbsp;so&nbsp;that&nbsp;only</span><br>
<span class="lineno">20</span><span class="comment" id="4497699">//&nbsp;types&nbsp;local&nbsp;to&nbsp;this&nbsp;package&nbsp;can&nbsp;satisfy&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4497746">type</span>&nbsp;<span class="ident" id="4497751">Node</span>&nbsp;<span class="keyword" id="4497756">interface</span>&nbsp;<span class="op" id="4497766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497769">Type</span><span class="op" id="4497773">(</span><span class="op" id="4497774">)</span>&nbsp;<span class="ident" id="4497776">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497786">String</span><span class="op" id="4497792">(</span><span class="op" id="4497793">)</span>&nbsp;<span class="builtintype" id="4497795">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4497803">//&nbsp;Copy&nbsp;does&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;Node&nbsp;and&nbsp;all&nbsp;its&nbsp;components.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4497865">//&nbsp;To&nbsp;avoid&nbsp;type&nbsp;assertions,&nbsp;some&nbsp;XxxNodes&nbsp;also&nbsp;have&nbsp;specialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4497931">//&nbsp;CopyXxx&nbsp;methods&nbsp;that&nbsp;return&nbsp;*XxxNode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497973">Copy</span><span class="op" id="4497977">(</span><span class="op" id="4497978">)</span>&nbsp;<span class="ident" id="4497980">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497986">Position</span><span class="op" id="4497994">(</span><span class="op" id="4497995">)</span>&nbsp;<span class="ident" id="4497997">Pos</span>&nbsp;<span class="comment" id="4498001">//&nbsp;byte&nbsp;position&nbsp;of&nbsp;start&nbsp;of&nbsp;node&nbsp;in&nbsp;full&nbsp;original&nbsp;input&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4498066">//&nbsp;tree&nbsp;returns&nbsp;the&nbsp;containing&nbsp;*Tree.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4498105">//&nbsp;It&nbsp;is&nbsp;unexported&nbsp;so&nbsp;all&nbsp;implementations&nbsp;of&nbsp;Node&nbsp;are&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498178">tree</span><span class="op" id="4498182">(</span><span class="op" id="4498183">)</span>&nbsp;<span class="op" id="4498185">*</span><span class="ident" id="4498186">Tree</span><br>
<span class="lineno"></span><span class="op" id="4498191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4498194">//&nbsp;NodeType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parse&nbsp;tree&nbsp;node.</span><br>
<span class="lineno">35</span><span class="keyword" id="4498248">type</span>&nbsp;<span class="ident" id="4498253">NodeType</span>&nbsp;<span class="builtintype" id="4498262">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4498267">//&nbsp;Pos&nbsp;represents&nbsp;a&nbsp;byte&nbsp;position&nbsp;in&nbsp;the&nbsp;original&nbsp;input&nbsp;text&nbsp;from&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="4498339">//&nbsp;this&nbsp;template&nbsp;was&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="4498368">type</span>&nbsp;<span class="ident" id="4498373">Pos</span>&nbsp;<span class="builtintype" id="4498377">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4498382">func</span>&nbsp;<span class="op" id="4498387">(</span><span class="ident" id="4498388">p</span>&nbsp;<span class="ident" id="4498390">Pos</span><span class="op" id="4498393">)</span>&nbsp;<span class="ident" id="4498395">Position</span><span class="op" id="4498403">(</span><span class="op" id="4498404">)</span>&nbsp;<span class="ident" id="4498406">Pos</span>&nbsp;<span class="op" id="4498410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498413">return</span>&nbsp;<span class="ident" id="4498420">p</span><br>
<span class="lineno"></span><span class="op" id="4498422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4498425">//&nbsp;Type&nbsp;returns&nbsp;itself&nbsp;and&nbsp;provides&nbsp;an&nbsp;easy&nbsp;default&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="4498492">//&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;Node.&nbsp;Embedded&nbsp;in&nbsp;all&nbsp;non-trivial&nbsp;Nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="4498555">func</span>&nbsp;<span class="op" id="4498560">(</span><span class="ident" id="4498561">t</span>&nbsp;<span class="ident" id="4498563">NodeType</span><span class="op" id="4498571">)</span>&nbsp;<span class="ident" id="4498573">Type</span><span class="op" id="4498577">(</span><span class="op" id="4498578">)</span>&nbsp;<span class="ident" id="4498580">NodeType</span>&nbsp;<span class="op" id="4498589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498592">return</span>&nbsp;<span class="ident" id="4498599">t</span><br>
<span class="lineno"></span><span class="op" id="4498601">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="4498604">const</span>&nbsp;<span class="op" id="4498610">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498613">NodeText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4498628">NodeType</span>&nbsp;<span class="op" id="4498637">=</span>&nbsp;<span class="ident" id="4498639">iota</span>&nbsp;<span class="comment" id="4498644">//&nbsp;Plain&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498660">NodeAction</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4498691">//&nbsp;A&nbsp;non-control&nbsp;action&nbsp;such&nbsp;as&nbsp;a&nbsp;field&nbsp;evaluation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498744">NodeBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4498775">//&nbsp;A&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498799">NodeChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4498830">//&nbsp;A&nbsp;sequence&nbsp;of&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498864">NodeCommand</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4498895">//&nbsp;An&nbsp;element&nbsp;of&nbsp;a&nbsp;pipeline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498925">NodeDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4498956">//&nbsp;The&nbsp;cursor,&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498977">nodeElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499008">//&nbsp;An&nbsp;else&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499047">nodeEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499078">//&nbsp;An&nbsp;end&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499116">NodeField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499147">//&nbsp;A&nbsp;field&nbsp;or&nbsp;method&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499175">NodeIdentifier</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499206">//&nbsp;An&nbsp;identifier;&nbsp;always&nbsp;a&nbsp;function&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499249">NodeIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499280">//&nbsp;An&nbsp;if&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499298">NodeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499329">//&nbsp;A&nbsp;list&nbsp;of&nbsp;Nodes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499350">NodeNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499381">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499410">NodeNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499441">//&nbsp;A&nbsp;numerical&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499467">NodePipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499498">//&nbsp;A&nbsp;pipeline&nbsp;of&nbsp;commands.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499526">NodeRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499557">//&nbsp;A&nbsp;range&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499577">NodeString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499608">//&nbsp;A&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499631">NodeTemplate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499662">//&nbsp;A&nbsp;template&nbsp;invocation&nbsp;action.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499696">NodeVariable</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499727">//&nbsp;A&nbsp;$&nbsp;variable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499745">NodeWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499776">//&nbsp;A&nbsp;with&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="4499794">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4499797">//&nbsp;Nodes.</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="4499808">//&nbsp;ListNode&nbsp;holds&nbsp;a&nbsp;sequence&nbsp;of&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="4499847">type</span>&nbsp;<span class="ident" id="4499852">ListNode</span>&nbsp;<span class="keyword" id="4499861">struct</span>&nbsp;<span class="op" id="4499868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499871">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499881">Pos</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499886">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4499892">*</span><span class="ident" id="4499893">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499899">Nodes</span>&nbsp;<span class="op" id="4499905">[</span><span class="op" id="4499906">]</span><span class="ident" id="4499907">Node</span>&nbsp;<span class="comment" id="4499912">//&nbsp;The&nbsp;element&nbsp;nodes&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4499951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4499954">func</span>&nbsp;<span class="op" id="4499959">(</span><span class="ident" id="4499960">t</span>&nbsp;<span class="op" id="4499962">*</span><span class="ident" id="4499963">Tree</span><span class="op" id="4499967">)</span>&nbsp;<span class="ident" id="4499969">newList</span><span class="op" id="4499976">(</span><span class="ident" id="4499977">pos</span>&nbsp;<span class="ident" id="4499981">Pos</span><span class="op" id="4499984">)</span>&nbsp;<span class="op" id="4499986">*</span><span class="ident" id="4499987">ListNode</span>&nbsp;<span class="op" id="4499996">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499999">return</span>&nbsp;<span class="op" id="4500006">&amp;</span><span class="ident" id="4500007">ListNode</span><span class="op" id="4500015">{</span><span class="ident" id="4500016">tr</span><span class="op" id="4500018">:</span>&nbsp;<span class="ident" id="4500020">t</span><span class="op" id="4500021">,</span>&nbsp;<span class="ident" id="4500023">NodeType</span><span class="op" id="4500031">:</span>&nbsp;<span class="ident" id="4500033">NodeList</span><span class="op" id="4500041">,</span>&nbsp;<span class="ident" id="4500043">Pos</span><span class="op" id="4500046">:</span>&nbsp;<span class="ident" id="4500048">pos</span><span class="op" id="4500051">}</span><br>
<span class="lineno"></span><span class="op" id="4500053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4500056">func</span>&nbsp;<span class="op" id="4500061">(</span><span class="ident" id="4500062">l</span>&nbsp;<span class="op" id="4500064">*</span><span class="ident" id="4500065">ListNode</span><span class="op" id="4500073">)</span>&nbsp;<span class="builtinfunc" id="4500075">append</span><span class="op" id="4500081">(</span><span class="ident" id="4500082">n</span>&nbsp;<span class="ident" id="4500084">Node</span><span class="op" id="4500088">)</span>&nbsp;<span class="op" id="4500090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500093">l</span><span class="op" id="4500094">.</span><span class="ident" id="4500095">Nodes</span>&nbsp;<span class="op" id="4500101">=</span>&nbsp;<span class="builtinfunc" id="4500103">append</span><span class="op" id="4500109">(</span><span class="ident" id="4500110">l</span><span class="op" id="4500111">.</span><span class="ident" id="4500112">Nodes</span><span class="op" id="4500117">,</span>&nbsp;<span class="ident" id="4500119">n</span><span class="op" id="4500120">)</span><br>
<span class="lineno">90</span><span class="op" id="4500122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4500125">func</span>&nbsp;<span class="op" id="4500130">(</span><span class="ident" id="4500131">l</span>&nbsp;<span class="op" id="4500133">*</span><span class="ident" id="4500134">ListNode</span><span class="op" id="4500142">)</span>&nbsp;<span class="ident" id="4500144">tree</span><span class="op" id="4500148">(</span><span class="op" id="4500149">)</span>&nbsp;<span class="op" id="4500151">*</span><span class="ident" id="4500152">Tree</span>&nbsp;<span class="op" id="4500157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500160">return</span>&nbsp;<span class="ident" id="4500167">l</span><span class="op" id="4500168">.</span><span class="ident" id="4500169">tr</span><br>
<span class="lineno"></span><span class="op" id="4500172">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4500175">func</span>&nbsp;<span class="op" id="4500180">(</span><span class="ident" id="4500181">l</span>&nbsp;<span class="op" id="4500183">*</span><span class="ident" id="4500184">ListNode</span><span class="op" id="4500192">)</span>&nbsp;<span class="ident" id="4500194">String</span><span class="op" id="4500200">(</span><span class="op" id="4500201">)</span>&nbsp;<span class="builtintype" id="4500203">string</span>&nbsp;<span class="op" id="4500210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500213">b</span>&nbsp;<span class="op" id="4500215">:=</span>&nbsp;<span class="builtinfunc" id="4500218">new</span><span class="op" id="4500221">(</span><span class="ident" id="4500222">bytes</span><span class="op" id="4500227">.</span><span class="ident" id="4500228">Buffer</span><span class="op" id="4500234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500237">for</span>&nbsp;<span class="ident" id="4500241">_</span><span class="op" id="4500242">,</span>&nbsp;<span class="ident" id="4500244">n</span>&nbsp;<span class="op" id="4500246">:=</span>&nbsp;<span class="keyword" id="4500249">range</span>&nbsp;<span class="ident" id="4500255">l</span><span class="op" id="4500256">.</span><span class="ident" id="4500257">Nodes</span>&nbsp;<span class="op" id="4500263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500267">fmt</span><span class="op" id="4500270">.</span><span class="ident" id="4500271">Fprint</span><span class="op" id="4500277">(</span><span class="ident" id="4500278">b</span><span class="op" id="4500279">,</span>&nbsp;<span class="ident" id="4500281">n</span><span class="op" id="4500282">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4500285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500288">return</span>&nbsp;<span class="ident" id="4500295">b</span><span class="op" id="4500296">.</span><span class="ident" id="4500297">String</span><span class="op" id="4500303">(</span><span class="op" id="4500304">)</span><br>
<span class="lineno"></span><span class="op" id="4500306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4500309">func</span>&nbsp;<span class="op" id="4500314">(</span><span class="ident" id="4500315">l</span>&nbsp;<span class="op" id="4500317">*</span><span class="ident" id="4500318">ListNode</span><span class="op" id="4500326">)</span>&nbsp;<span class="ident" id="4500328">CopyList</span><span class="op" id="4500336">(</span><span class="op" id="4500337">)</span>&nbsp;<span class="op" id="4500339">*</span><span class="ident" id="4500340">ListNode</span>&nbsp;<span class="op" id="4500349">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500352">if</span>&nbsp;<span class="ident" id="4500355">l</span>&nbsp;<span class="op" id="4500357">==</span>&nbsp;<span class="ident" id="4500360">nil</span>&nbsp;<span class="op" id="4500364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500368">return</span>&nbsp;<span class="ident" id="4500375">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4500378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500381">n</span>&nbsp;<span class="op" id="4500383">:=</span>&nbsp;<span class="ident" id="4500386">l</span><span class="op" id="4500387">.</span><span class="ident" id="4500388">tr</span><span class="op" id="4500390">.</span><span class="ident" id="4500391">newList</span><span class="op" id="4500398">(</span><span class="ident" id="4500399">l</span><span class="op" id="4500400">.</span><span class="ident" id="4500401">Pos</span><span class="op" id="4500404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500407">for</span>&nbsp;<span class="ident" id="4500411">_</span><span class="op" id="4500412">,</span>&nbsp;<span class="ident" id="4500414">elem</span>&nbsp;<span class="op" id="4500419">:=</span>&nbsp;<span class="keyword" id="4500422">range</span>&nbsp;<span class="ident" id="4500428">l</span><span class="op" id="4500429">.</span><span class="ident" id="4500430">Nodes</span>&nbsp;<span class="op" id="4500436">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500440">n</span><span class="op" id="4500441">.</span><span class="builtinfunc" id="4500442">append</span><span class="op" id="4500448">(</span><span class="ident" id="4500449">elem</span><span class="op" id="4500453">.</span><span class="ident" id="4500454">Copy</span><span class="op" id="4500458">(</span><span class="op" id="4500459">)</span><span class="op" id="4500460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4500463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500466">return</span>&nbsp;<span class="ident" id="4500473">n</span><br>
<span class="lineno"></span><span class="op" id="4500475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4500478">func</span>&nbsp;<span class="op" id="4500483">(</span><span class="ident" id="4500484">l</span>&nbsp;<span class="op" id="4500486">*</span><span class="ident" id="4500487">ListNode</span><span class="op" id="4500495">)</span>&nbsp;<span class="ident" id="4500497">Copy</span><span class="op" id="4500501">(</span><span class="op" id="4500502">)</span>&nbsp;<span class="ident" id="4500504">Node</span>&nbsp;<span class="op" id="4500509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500512">return</span>&nbsp;<span class="ident" id="4500519">l</span><span class="op" id="4500520">.</span><span class="ident" id="4500521">CopyList</span><span class="op" id="4500529">(</span><span class="op" id="4500530">)</span><br>
<span class="lineno"></span><span class="op" id="4500532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4500535">//&nbsp;TextNode&nbsp;holds&nbsp;plain&nbsp;text.</span><br>
<span class="lineno">120</span><span class="keyword" id="4500565">type</span>&nbsp;<span class="ident" id="4500570">TextNode</span>&nbsp;<span class="keyword" id="4500579">struct</span>&nbsp;<span class="op" id="4500586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500589">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500599">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500604">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4500609">*</span><span class="ident" id="4500610">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500616">Text</span>&nbsp;<span class="op" id="4500621">[</span><span class="op" id="4500622">]</span><span class="builtintype" id="4500623">byte</span>&nbsp;<span class="comment" id="4500628">//&nbsp;The&nbsp;text;&nbsp;may&nbsp;span&nbsp;newlines.</span><br>
<span class="lineno">125</span><span class="op" id="4500660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4500663">func</span>&nbsp;<span class="op" id="4500668">(</span><span class="ident" id="4500669">t</span>&nbsp;<span class="op" id="4500671">*</span><span class="ident" id="4500672">Tree</span><span class="op" id="4500676">)</span>&nbsp;<span class="ident" id="4500678">newText</span><span class="op" id="4500685">(</span><span class="ident" id="4500686">pos</span>&nbsp;<span class="ident" id="4500690">Pos</span><span class="op" id="4500693">,</span>&nbsp;<span class="ident" id="4500695">text</span>&nbsp;<span class="builtintype" id="4500700">string</span><span class="op" id="4500706">)</span>&nbsp;<span class="op" id="4500708">*</span><span class="ident" id="4500709">TextNode</span>&nbsp;<span class="op" id="4500718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500721">return</span>&nbsp;<span class="op" id="4500728">&amp;</span><span class="ident" id="4500729">TextNode</span><span class="op" id="4500737">{</span><span class="ident" id="4500738">tr</span><span class="op" id="4500740">:</span>&nbsp;<span class="ident" id="4500742">t</span><span class="op" id="4500743">,</span>&nbsp;<span class="ident" id="4500745">NodeType</span><span class="op" id="4500753">:</span>&nbsp;<span class="ident" id="4500755">NodeText</span><span class="op" id="4500763">,</span>&nbsp;<span class="ident" id="4500765">Pos</span><span class="op" id="4500768">:</span>&nbsp;<span class="ident" id="4500770">pos</span><span class="op" id="4500773">,</span>&nbsp;<span class="ident" id="4500775">Text</span><span class="op" id="4500779">:</span>&nbsp;<span class="op" id="4500781">[</span><span class="op" id="4500782">]</span><span class="builtintype" id="4500783">byte</span><span class="op" id="4500787">(</span><span class="ident" id="4500788">text</span><span class="op" id="4500792">)</span><span class="op" id="4500793">}</span><br>
<span class="lineno"></span><span class="op" id="4500795">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="4500798">func</span>&nbsp;<span class="op" id="4500803">(</span><span class="ident" id="4500804">t</span>&nbsp;<span class="op" id="4500806">*</span><span class="ident" id="4500807">TextNode</span><span class="op" id="4500815">)</span>&nbsp;<span class="ident" id="4500817">String</span><span class="op" id="4500823">(</span><span class="op" id="4500824">)</span>&nbsp;<span class="builtintype" id="4500826">string</span>&nbsp;<span class="op" id="4500833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500836">return</span>&nbsp;<span class="ident" id="4500843">fmt</span><span class="op" id="4500846">.</span><span class="ident" id="4500847">Sprintf</span><span class="op" id="4500854">(</span><span class="ident" id="4500855">textFormat</span><span class="op" id="4500865">,</span>&nbsp;<span class="ident" id="4500867">t</span><span class="op" id="4500868">.</span><span class="ident" id="4500869">Text</span><span class="op" id="4500873">)</span><br>
<span class="lineno"></span><span class="op" id="4500875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="4500878">func</span>&nbsp;<span class="op" id="4500883">(</span><span class="ident" id="4500884">t</span>&nbsp;<span class="op" id="4500886">*</span><span class="ident" id="4500887">TextNode</span><span class="op" id="4500895">)</span>&nbsp;<span class="ident" id="4500897">tree</span><span class="op" id="4500901">(</span><span class="op" id="4500902">)</span>&nbsp;<span class="op" id="4500904">*</span><span class="ident" id="4500905">Tree</span>&nbsp;<span class="op" id="4500910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500913">return</span>&nbsp;<span class="ident" id="4500920">t</span><span class="op" id="4500921">.</span><span class="ident" id="4500922">tr</span><br>
<span class="lineno"></span><span class="op" id="4500925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4500928">func</span>&nbsp;<span class="op" id="4500933">(</span><span class="ident" id="4500934">t</span>&nbsp;<span class="op" id="4500936">*</span><span class="ident" id="4500937">TextNode</span><span class="op" id="4500945">)</span>&nbsp;<span class="ident" id="4500947">Copy</span><span class="op" id="4500951">(</span><span class="op" id="4500952">)</span>&nbsp;<span class="ident" id="4500954">Node</span>&nbsp;<span class="op" id="4500959">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500962">return</span>&nbsp;<span class="op" id="4500969">&amp;</span><span class="ident" id="4500970">TextNode</span><span class="op" id="4500978">{</span><span class="ident" id="4500979">tr</span><span class="op" id="4500981">:</span>&nbsp;<span class="ident" id="4500983">t</span><span class="op" id="4500984">.</span><span class="ident" id="4500985">tr</span><span class="op" id="4500987">,</span>&nbsp;<span class="ident" id="4500989">NodeType</span><span class="op" id="4500997">:</span>&nbsp;<span class="ident" id="4500999">NodeText</span><span class="op" id="4501007">,</span>&nbsp;<span class="ident" id="4501009">Pos</span><span class="op" id="4501012">:</span>&nbsp;<span class="ident" id="4501014">t</span><span class="op" id="4501015">.</span><span class="ident" id="4501016">Pos</span><span class="op" id="4501019">,</span>&nbsp;<span class="ident" id="4501021">Text</span><span class="op" id="4501025">:</span>&nbsp;<span class="builtinfunc" id="4501027">append</span><span class="op" id="4501033">(</span><span class="op" id="4501034">[</span><span class="op" id="4501035">]</span><span class="builtintype" id="4501036">byte</span><span class="op" id="4501040">{</span><span class="op" id="4501041">}</span><span class="op" id="4501042">,</span>&nbsp;<span class="ident" id="4501044">t</span><span class="op" id="4501045">.</span><span class="ident" id="4501046">Text</span><span class="op" id="4501050">...</span><span class="op" id="4501053">)</span><span class="op" id="4501054">}</span><br>
<span class="lineno"></span><span class="op" id="4501056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4501059">//&nbsp;PipeNode&nbsp;holds&nbsp;a&nbsp;pipeline&nbsp;with&nbsp;optional&nbsp;declaration</span><br>
<span class="lineno"></span><span class="keyword" id="4501114">type</span>&nbsp;<span class="ident" id="4501119">PipeNode</span>&nbsp;<span class="keyword" id="4501128">struct</span>&nbsp;<span class="op" id="4501135">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501138">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501148">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501153">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4501158">*</span><span class="ident" id="4501159">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501165">Line</span>&nbsp;<span class="builtintype" id="4501170">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4501186">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501256">Decl</span>&nbsp;<span class="op" id="4501261">[</span><span class="op" id="4501262">]</span><span class="op" id="4501263">*</span><span class="ident" id="4501264">VariableNode</span>&nbsp;<span class="comment" id="4501277">//&nbsp;Variable&nbsp;declarations&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501321">Cmds</span>&nbsp;<span class="op" id="4501326">[</span><span class="op" id="4501327">]</span><span class="op" id="4501328">*</span><span class="ident" id="4501329">CommandNode</span>&nbsp;&nbsp;<span class="comment" id="4501342">//&nbsp;The&nbsp;commands&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4501376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4501379">func</span>&nbsp;<span class="op" id="4501384">(</span><span class="ident" id="4501385">t</span>&nbsp;<span class="op" id="4501387">*</span><span class="ident" id="4501388">Tree</span><span class="op" id="4501392">)</span>&nbsp;<span class="ident" id="4501394">newPipeline</span><span class="op" id="4501405">(</span><span class="ident" id="4501406">pos</span>&nbsp;<span class="ident" id="4501410">Pos</span><span class="op" id="4501413">,</span>&nbsp;<span class="ident" id="4501415">line</span>&nbsp;<span class="builtintype" id="4501420">int</span><span class="op" id="4501423">,</span>&nbsp;<span class="ident" id="4501425">decl</span>&nbsp;<span class="op" id="4501430">[</span><span class="op" id="4501431">]</span><span class="op" id="4501432">*</span><span class="ident" id="4501433">VariableNode</span><span class="op" id="4501445">)</span>&nbsp;<span class="op" id="4501447">*</span><span class="ident" id="4501448">PipeNode</span>&nbsp;<span class="op" id="4501457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501460">return</span>&nbsp;<span class="op" id="4501467">&amp;</span><span class="ident" id="4501468">PipeNode</span><span class="op" id="4501476">{</span><span class="ident" id="4501477">tr</span><span class="op" id="4501479">:</span>&nbsp;<span class="ident" id="4501481">t</span><span class="op" id="4501482">,</span>&nbsp;<span class="ident" id="4501484">NodeType</span><span class="op" id="4501492">:</span>&nbsp;<span class="ident" id="4501494">NodePipe</span><span class="op" id="4501502">,</span>&nbsp;<span class="ident" id="4501504">Pos</span><span class="op" id="4501507">:</span>&nbsp;<span class="ident" id="4501509">pos</span><span class="op" id="4501512">,</span>&nbsp;<span class="ident" id="4501514">Line</span><span class="op" id="4501518">:</span>&nbsp;<span class="ident" id="4501520">line</span><span class="op" id="4501524">,</span>&nbsp;<span class="ident" id="4501526">Decl</span><span class="op" id="4501530">:</span>&nbsp;<span class="ident" id="4501532">decl</span><span class="op" id="4501536">}</span><br>
<span class="lineno">155</span><span class="op" id="4501538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4501541">func</span>&nbsp;<span class="op" id="4501546">(</span><span class="ident" id="4501547">p</span>&nbsp;<span class="op" id="4501549">*</span><span class="ident" id="4501550">PipeNode</span><span class="op" id="4501558">)</span>&nbsp;<span class="builtinfunc" id="4501560">append</span><span class="op" id="4501566">(</span><span class="ident" id="4501567">command</span>&nbsp;<span class="op" id="4501575">*</span><span class="ident" id="4501576">CommandNode</span><span class="op" id="4501587">)</span>&nbsp;<span class="op" id="4501589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501592">p</span><span class="op" id="4501593">.</span><span class="ident" id="4501594">Cmds</span>&nbsp;<span class="op" id="4501599">=</span>&nbsp;<span class="builtinfunc" id="4501601">append</span><span class="op" id="4501607">(</span><span class="ident" id="4501608">p</span><span class="op" id="4501609">.</span><span class="ident" id="4501610">Cmds</span><span class="op" id="4501614">,</span>&nbsp;<span class="ident" id="4501616">command</span><span class="op" id="4501623">)</span><br>
<span class="lineno"></span><span class="op" id="4501625">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="4501628">func</span>&nbsp;<span class="op" id="4501633">(</span><span class="ident" id="4501634">p</span>&nbsp;<span class="op" id="4501636">*</span><span class="ident" id="4501637">PipeNode</span><span class="op" id="4501645">)</span>&nbsp;<span class="ident" id="4501647">String</span><span class="op" id="4501653">(</span><span class="op" id="4501654">)</span>&nbsp;<span class="builtintype" id="4501656">string</span>&nbsp;<span class="op" id="4501663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501666">s</span>&nbsp;<span class="op" id="4501668">:=</span>&nbsp;<span class="string" id="4501671">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501675">if</span>&nbsp;<span class="builtinfunc" id="4501678">len</span><span class="op" id="4501681">(</span><span class="ident" id="4501682">p</span><span class="op" id="4501683">.</span><span class="ident" id="4501684">Decl</span><span class="op" id="4501688">)</span>&nbsp;<span class="op" id="4501690">&gt;</span>&nbsp;<span class="num" id="4501692">0</span>&nbsp;<span class="op" id="4501694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501698">for</span>&nbsp;<span class="ident" id="4501702">i</span><span class="op" id="4501703">,</span>&nbsp;<span class="ident" id="4501705">v</span>&nbsp;<span class="op" id="4501707">:=</span>&nbsp;<span class="keyword" id="4501710">range</span>&nbsp;<span class="ident" id="4501716">p</span><span class="op" id="4501717">.</span><span class="ident" id="4501718">Decl</span>&nbsp;<span class="op" id="4501723">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501728">if</span>&nbsp;<span class="ident" id="4501731">i</span>&nbsp;<span class="op" id="4501733">&gt;</span>&nbsp;<span class="num" id="4501735">0</span>&nbsp;<span class="op" id="4501737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501743">s</span>&nbsp;<span class="op" id="4501745">+=</span>&nbsp;<span class="string" id="4501748">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501761">s</span>&nbsp;<span class="op" id="4501763">+=</span>&nbsp;<span class="ident" id="4501766">v</span><span class="op" id="4501767">.</span><span class="ident" id="4501768">String</span><span class="op" id="4501774">(</span><span class="op" id="4501775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501779">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501783">s</span>&nbsp;<span class="op" id="4501785">+=</span>&nbsp;<span class="string" id="4501788">&#34;&nbsp;:=&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501799">for</span>&nbsp;<span class="ident" id="4501803">i</span><span class="op" id="4501804">,</span>&nbsp;<span class="ident" id="4501806">c</span>&nbsp;<span class="op" id="4501808">:=</span>&nbsp;<span class="keyword" id="4501811">range</span>&nbsp;<span class="ident" id="4501817">p</span><span class="op" id="4501818">.</span><span class="ident" id="4501819">Cmds</span>&nbsp;<span class="op" id="4501824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501828">if</span>&nbsp;<span class="ident" id="4501831">i</span>&nbsp;<span class="op" id="4501833">&gt;</span>&nbsp;<span class="num" id="4501835">0</span>&nbsp;<span class="op" id="4501837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501842">s</span>&nbsp;<span class="op" id="4501844">+=</span>&nbsp;<span class="string" id="4501847">&#34;&nbsp;|&nbsp;&#34;</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501859">s</span>&nbsp;<span class="op" id="4501861">+=</span>&nbsp;<span class="ident" id="4501864">c</span><span class="op" id="4501865">.</span><span class="ident" id="4501866">String</span><span class="op" id="4501872">(</span><span class="op" id="4501873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501879">return</span>&nbsp;<span class="ident" id="4501886">s</span><br>
<span class="lineno"></span><span class="op" id="4501888">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="4501891">func</span>&nbsp;<span class="op" id="4501896">(</span><span class="ident" id="4501897">p</span>&nbsp;<span class="op" id="4501899">*</span><span class="ident" id="4501900">PipeNode</span><span class="op" id="4501908">)</span>&nbsp;<span class="ident" id="4501910">tree</span><span class="op" id="4501914">(</span><span class="op" id="4501915">)</span>&nbsp;<span class="op" id="4501917">*</span><span class="ident" id="4501918">Tree</span>&nbsp;<span class="op" id="4501923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501926">return</span>&nbsp;<span class="ident" id="4501933">p</span><span class="op" id="4501934">.</span><span class="ident" id="4501935">tr</span><br>
<span class="lineno"></span><span class="op" id="4501938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4501941">func</span>&nbsp;<span class="op" id="4501946">(</span><span class="ident" id="4501947">p</span>&nbsp;<span class="op" id="4501949">*</span><span class="ident" id="4501950">PipeNode</span><span class="op" id="4501958">)</span>&nbsp;<span class="ident" id="4501960">CopyPipe</span><span class="op" id="4501968">(</span><span class="op" id="4501969">)</span>&nbsp;<span class="op" id="4501971">*</span><span class="ident" id="4501972">PipeNode</span>&nbsp;<span class="op" id="4501981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501984">if</span>&nbsp;<span class="ident" id="4501987">p</span>&nbsp;<span class="op" id="4501989">==</span>&nbsp;<span class="ident" id="4501992">nil</span>&nbsp;<span class="op" id="4501996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502000">return</span>&nbsp;<span class="ident" id="4502007">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4502010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502013">var</span>&nbsp;<span class="ident" id="4502017">decl</span>&nbsp;<span class="op" id="4502022">[</span><span class="op" id="4502023">]</span><span class="op" id="4502024">*</span><span class="ident" id="4502025">VariableNode</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502039">for</span>&nbsp;<span class="ident" id="4502043">_</span><span class="op" id="4502044">,</span>&nbsp;<span class="ident" id="4502046">d</span>&nbsp;<span class="op" id="4502048">:=</span>&nbsp;<span class="keyword" id="4502051">range</span>&nbsp;<span class="ident" id="4502057">p</span><span class="op" id="4502058">.</span><span class="ident" id="4502059">Decl</span>&nbsp;<span class="op" id="4502064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502068">decl</span>&nbsp;<span class="op" id="4502073">=</span>&nbsp;<span class="builtinfunc" id="4502075">append</span><span class="op" id="4502081">(</span><span class="ident" id="4502082">decl</span><span class="op" id="4502086">,</span>&nbsp;<span class="ident" id="4502088">d</span><span class="op" id="4502089">.</span><span class="ident" id="4502090">Copy</span><span class="op" id="4502094">(</span><span class="op" id="4502095">)</span><span class="op" id="4502096">.</span><span class="op" id="4502097">(</span><span class="op" id="4502098">*</span><span class="ident" id="4502099">VariableNode</span><span class="op" id="4502111">)</span><span class="op" id="4502112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4502115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502118">n</span>&nbsp;<span class="op" id="4502120">:=</span>&nbsp;<span class="ident" id="4502123">p</span><span class="op" id="4502124">.</span><span class="ident" id="4502125">tr</span><span class="op" id="4502127">.</span><span class="ident" id="4502128">newPipeline</span><span class="op" id="4502139">(</span><span class="ident" id="4502140">p</span><span class="op" id="4502141">.</span><span class="ident" id="4502142">Pos</span><span class="op" id="4502145">,</span>&nbsp;<span class="ident" id="4502147">p</span><span class="op" id="4502148">.</span><span class="ident" id="4502149">Line</span><span class="op" id="4502153">,</span>&nbsp;<span class="ident" id="4502155">decl</span><span class="op" id="4502159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502162">for</span>&nbsp;<span class="ident" id="4502166">_</span><span class="op" id="4502167">,</span>&nbsp;<span class="ident" id="4502169">c</span>&nbsp;<span class="op" id="4502171">:=</span>&nbsp;<span class="keyword" id="4502174">range</span>&nbsp;<span class="ident" id="4502180">p</span><span class="op" id="4502181">.</span><span class="ident" id="4502182">Cmds</span>&nbsp;<span class="op" id="4502187">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502191">n</span><span class="op" id="4502192">.</span><span class="builtinfunc" id="4502193">append</span><span class="op" id="4502199">(</span><span class="ident" id="4502200">c</span><span class="op" id="4502201">.</span><span class="ident" id="4502202">Copy</span><span class="op" id="4502206">(</span><span class="op" id="4502207">)</span><span class="op" id="4502208">.</span><span class="op" id="4502209">(</span><span class="op" id="4502210">*</span><span class="ident" id="4502211">CommandNode</span><span class="op" id="4502222">)</span><span class="op" id="4502223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4502226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502229">return</span>&nbsp;<span class="ident" id="4502236">n</span><br>
<span class="lineno"></span><span class="op" id="4502238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="4502241">func</span>&nbsp;<span class="op" id="4502246">(</span><span class="ident" id="4502247">p</span>&nbsp;<span class="op" id="4502249">*</span><span class="ident" id="4502250">PipeNode</span><span class="op" id="4502258">)</span>&nbsp;<span class="ident" id="4502260">Copy</span><span class="op" id="4502264">(</span><span class="op" id="4502265">)</span>&nbsp;<span class="ident" id="4502267">Node</span>&nbsp;<span class="op" id="4502272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502275">return</span>&nbsp;<span class="ident" id="4502282">p</span><span class="op" id="4502283">.</span><span class="ident" id="4502284">CopyPipe</span><span class="op" id="4502292">(</span><span class="op" id="4502293">)</span><br>
<span class="lineno"></span><span class="op" id="4502295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4502298">//&nbsp;ActionNode&nbsp;holds&nbsp;an&nbsp;action&nbsp;(something&nbsp;bounded&nbsp;by&nbsp;delimiters).</span><br>
<span class="lineno">205</span><span class="comment" id="4502363">//&nbsp;Control&nbsp;actions&nbsp;have&nbsp;their&nbsp;own&nbsp;nodes;&nbsp;ActionNode&nbsp;represents&nbsp;simple</span><br>
<span class="lineno"></span><span class="comment" id="4502433">//&nbsp;ones&nbsp;such&nbsp;as&nbsp;field&nbsp;evaluations&nbsp;and&nbsp;parenthesized&nbsp;pipelines.</span><br>
<span class="lineno"></span><span class="keyword" id="4502496">type</span>&nbsp;<span class="ident" id="4502501">ActionNode</span>&nbsp;<span class="keyword" id="4502512">struct</span>&nbsp;<span class="op" id="4502519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502522">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502532">Pos</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502537">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4502542">*</span><span class="ident" id="4502543">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502549">Line</span>&nbsp;<span class="builtintype" id="4502554">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4502564">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502634">Pipe</span>&nbsp;<span class="op" id="4502639">*</span><span class="ident" id="4502640">PipeNode</span>&nbsp;<span class="comment" id="4502649">//&nbsp;The&nbsp;pipeline&nbsp;in&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="4502680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="4502683">func</span>&nbsp;<span class="op" id="4502688">(</span><span class="ident" id="4502689">t</span>&nbsp;<span class="op" id="4502691">*</span><span class="ident" id="4502692">Tree</span><span class="op" id="4502696">)</span>&nbsp;<span class="ident" id="4502698">newAction</span><span class="op" id="4502707">(</span><span class="ident" id="4502708">pos</span>&nbsp;<span class="ident" id="4502712">Pos</span><span class="op" id="4502715">,</span>&nbsp;<span class="ident" id="4502717">line</span>&nbsp;<span class="builtintype" id="4502722">int</span><span class="op" id="4502725">,</span>&nbsp;<span class="ident" id="4502727">pipe</span>&nbsp;<span class="op" id="4502732">*</span><span class="ident" id="4502733">PipeNode</span><span class="op" id="4502741">)</span>&nbsp;<span class="op" id="4502743">*</span><span class="ident" id="4502744">ActionNode</span>&nbsp;<span class="op" id="4502755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502758">return</span>&nbsp;<span class="op" id="4502765">&amp;</span><span class="ident" id="4502766">ActionNode</span><span class="op" id="4502776">{</span><span class="ident" id="4502777">tr</span><span class="op" id="4502779">:</span>&nbsp;<span class="ident" id="4502781">t</span><span class="op" id="4502782">,</span>&nbsp;<span class="ident" id="4502784">NodeType</span><span class="op" id="4502792">:</span>&nbsp;<span class="ident" id="4502794">NodeAction</span><span class="op" id="4502804">,</span>&nbsp;<span class="ident" id="4502806">Pos</span><span class="op" id="4502809">:</span>&nbsp;<span class="ident" id="4502811">pos</span><span class="op" id="4502814">,</span>&nbsp;<span class="ident" id="4502816">Line</span><span class="op" id="4502820">:</span>&nbsp;<span class="ident" id="4502822">line</span><span class="op" id="4502826">,</span>&nbsp;<span class="ident" id="4502828">Pipe</span><span class="op" id="4502832">:</span>&nbsp;<span class="ident" id="4502834">pipe</span><span class="op" id="4502838">}</span><br>
<span class="lineno"></span><span class="op" id="4502840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4502843">func</span>&nbsp;<span class="op" id="4502848">(</span><span class="ident" id="4502849">a</span>&nbsp;<span class="op" id="4502851">*</span><span class="ident" id="4502852">ActionNode</span><span class="op" id="4502862">)</span>&nbsp;<span class="ident" id="4502864">String</span><span class="op" id="4502870">(</span><span class="op" id="4502871">)</span>&nbsp;<span class="builtintype" id="4502873">string</span>&nbsp;<span class="op" id="4502880">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502883">return</span>&nbsp;<span class="ident" id="4502890">fmt</span><span class="op" id="4502893">.</span><span class="ident" id="4502894">Sprintf</span><span class="op" id="4502901">(</span><span class="string" id="4502902">&#34;{{%s}}&#34;</span><span class="op" id="4502910">,</span>&nbsp;<span class="ident" id="4502912">a</span><span class="op" id="4502913">.</span><span class="ident" id="4502914">Pipe</span><span class="op" id="4502918">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="4502921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4502924">func</span>&nbsp;<span class="op" id="4502929">(</span><span class="ident" id="4502930">a</span>&nbsp;<span class="op" id="4502932">*</span><span class="ident" id="4502933">ActionNode</span><span class="op" id="4502943">)</span>&nbsp;<span class="ident" id="4502945">tree</span><span class="op" id="4502949">(</span><span class="op" id="4502950">)</span>&nbsp;<span class="op" id="4502952">*</span><span class="ident" id="4502953">Tree</span>&nbsp;<span class="op" id="4502958">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502961">return</span>&nbsp;<span class="ident" id="4502968">a</span><span class="op" id="4502969">.</span><span class="ident" id="4502970">tr</span><br>
<span class="lineno"></span><span class="op" id="4502973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4502976">func</span>&nbsp;<span class="op" id="4502981">(</span><span class="ident" id="4502982">a</span>&nbsp;<span class="op" id="4502984">*</span><span class="ident" id="4502985">ActionNode</span><span class="op" id="4502995">)</span>&nbsp;<span class="ident" id="4502997">Copy</span><span class="op" id="4503001">(</span><span class="op" id="4503002">)</span>&nbsp;<span class="ident" id="4503004">Node</span>&nbsp;<span class="op" id="4503009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503012">return</span>&nbsp;<span class="ident" id="4503019">a</span><span class="op" id="4503020">.</span><span class="ident" id="4503021">tr</span><span class="op" id="4503023">.</span><span class="ident" id="4503024">newAction</span><span class="op" id="4503033">(</span><span class="ident" id="4503034">a</span><span class="op" id="4503035">.</span><span class="ident" id="4503036">Pos</span><span class="op" id="4503039">,</span>&nbsp;<span class="ident" id="4503041">a</span><span class="op" id="4503042">.</span><span class="ident" id="4503043">Line</span><span class="op" id="4503047">,</span>&nbsp;<span class="ident" id="4503049">a</span><span class="op" id="4503050">.</span><span class="ident" id="4503051">Pipe</span><span class="op" id="4503055">.</span><span class="ident" id="4503056">CopyPipe</span><span class="op" id="4503064">(</span><span class="op" id="4503065">)</span><span class="op" id="4503066">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="op" id="4503069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4503072">//&nbsp;CommandNode&nbsp;holds&nbsp;a&nbsp;command&nbsp;(a&nbsp;pipeline&nbsp;inside&nbsp;an&nbsp;evaluating&nbsp;action).</span><br>
<span class="lineno"></span><span class="keyword" id="4503145">type</span>&nbsp;<span class="ident" id="4503150">CommandNode</span>&nbsp;<span class="keyword" id="4503162">struct</span>&nbsp;<span class="op" id="4503169">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503172">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503182">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503187">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4503192">*</span><span class="ident" id="4503193">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503199">Args</span>&nbsp;<span class="op" id="4503204">[</span><span class="op" id="4503205">]</span><span class="ident" id="4503206">Node</span>&nbsp;<span class="comment" id="4503211">//&nbsp;Arguments&nbsp;in&nbsp;lexical&nbsp;order:&nbsp;Identifier,&nbsp;field,&nbsp;or&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="4503274">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="4503277">func</span>&nbsp;<span class="op" id="4503282">(</span><span class="ident" id="4503283">t</span>&nbsp;<span class="op" id="4503285">*</span><span class="ident" id="4503286">Tree</span><span class="op" id="4503290">)</span>&nbsp;<span class="ident" id="4503292">newCommand</span><span class="op" id="4503302">(</span><span class="ident" id="4503303">pos</span>&nbsp;<span class="ident" id="4503307">Pos</span><span class="op" id="4503310">)</span>&nbsp;<span class="op" id="4503312">*</span><span class="ident" id="4503313">CommandNode</span>&nbsp;<span class="op" id="4503325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503328">return</span>&nbsp;<span class="op" id="4503335">&amp;</span><span class="ident" id="4503336">CommandNode</span><span class="op" id="4503347">{</span><span class="ident" id="4503348">tr</span><span class="op" id="4503350">:</span>&nbsp;<span class="ident" id="4503352">t</span><span class="op" id="4503353">,</span>&nbsp;<span class="ident" id="4503355">NodeType</span><span class="op" id="4503363">:</span>&nbsp;<span class="ident" id="4503365">NodeCommand</span><span class="op" id="4503376">,</span>&nbsp;<span class="ident" id="4503378">Pos</span><span class="op" id="4503381">:</span>&nbsp;<span class="ident" id="4503383">pos</span><span class="op" id="4503386">}</span><br>
<span class="lineno"></span><span class="op" id="4503388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="4503391">func</span>&nbsp;<span class="op" id="4503396">(</span><span class="ident" id="4503397">c</span>&nbsp;<span class="op" id="4503399">*</span><span class="ident" id="4503400">CommandNode</span><span class="op" id="4503411">)</span>&nbsp;<span class="builtinfunc" id="4503413">append</span><span class="op" id="4503419">(</span><span class="ident" id="4503420">arg</span>&nbsp;<span class="ident" id="4503424">Node</span><span class="op" id="4503428">)</span>&nbsp;<span class="op" id="4503430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503433">c</span><span class="op" id="4503434">.</span><span class="ident" id="4503435">Args</span>&nbsp;<span class="op" id="4503440">=</span>&nbsp;<span class="builtinfunc" id="4503442">append</span><span class="op" id="4503448">(</span><span class="ident" id="4503449">c</span><span class="op" id="4503450">.</span><span class="ident" id="4503451">Args</span><span class="op" id="4503455">,</span>&nbsp;<span class="ident" id="4503457">arg</span><span class="op" id="4503460">)</span><br>
<span class="lineno"></span><span class="op" id="4503462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4503465">func</span>&nbsp;<span class="op" id="4503470">(</span><span class="ident" id="4503471">c</span>&nbsp;<span class="op" id="4503473">*</span><span class="ident" id="4503474">CommandNode</span><span class="op" id="4503485">)</span>&nbsp;<span class="ident" id="4503487">String</span><span class="op" id="4503493">(</span><span class="op" id="4503494">)</span>&nbsp;<span class="builtintype" id="4503496">string</span>&nbsp;<span class="op" id="4503503">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503506">s</span>&nbsp;<span class="op" id="4503508">:=</span>&nbsp;<span class="string" id="4503511">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503515">for</span>&nbsp;<span class="ident" id="4503519">i</span><span class="op" id="4503520">,</span>&nbsp;<span class="ident" id="4503522">arg</span>&nbsp;<span class="op" id="4503526">:=</span>&nbsp;<span class="keyword" id="4503529">range</span>&nbsp;<span class="ident" id="4503535">c</span><span class="op" id="4503536">.</span><span class="ident" id="4503537">Args</span>&nbsp;<span class="op" id="4503542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503546">if</span>&nbsp;<span class="ident" id="4503549">i</span>&nbsp;<span class="op" id="4503551">&gt;</span>&nbsp;<span class="num" id="4503553">0</span>&nbsp;<span class="op" id="4503555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503560">s</span>&nbsp;<span class="op" id="4503562">+=</span>&nbsp;<span class="string" id="4503565">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4503571">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503575">if</span>&nbsp;<span class="ident" id="4503578">arg</span><span class="op" id="4503581">,</span>&nbsp;<span class="ident" id="4503583">ok</span>&nbsp;<span class="op" id="4503586">:=</span>&nbsp;<span class="ident" id="4503589">arg</span><span class="op" id="4503592">.</span><span class="op" id="4503593">(</span><span class="op" id="4503594">*</span><span class="ident" id="4503595">PipeNode</span><span class="op" id="4503603">)</span><span class="op" id="4503604">;</span>&nbsp;<span class="ident" id="4503606">ok</span>&nbsp;<span class="op" id="4503609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503614">s</span>&nbsp;<span class="op" id="4503616">+=</span>&nbsp;<span class="string" id="4503619">&#34;(&#34;</span>&nbsp;<span class="op" id="4503623">+</span>&nbsp;<span class="ident" id="4503625">arg</span><span class="op" id="4503628">.</span><span class="ident" id="4503629">String</span><span class="op" id="4503635">(</span><span class="op" id="4503636">)</span>&nbsp;<span class="op" id="4503638">+</span>&nbsp;<span class="string" id="4503640">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503647">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4503658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503662">s</span>&nbsp;<span class="op" id="4503664">+=</span>&nbsp;<span class="ident" id="4503667">arg</span><span class="op" id="4503670">.</span><span class="ident" id="4503671">String</span><span class="op" id="4503677">(</span><span class="op" id="4503678">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4503681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503684">return</span>&nbsp;<span class="ident" id="4503691">s</span><br>
<span class="lineno"></span><span class="op" id="4503693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4503696">func</span>&nbsp;<span class="op" id="4503701">(</span><span class="ident" id="4503702">c</span>&nbsp;<span class="op" id="4503704">*</span><span class="ident" id="4503705">CommandNode</span><span class="op" id="4503716">)</span>&nbsp;<span class="ident" id="4503718">tree</span><span class="op" id="4503722">(</span><span class="op" id="4503723">)</span>&nbsp;<span class="op" id="4503725">*</span><span class="ident" id="4503726">Tree</span>&nbsp;<span class="op" id="4503731">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503734">return</span>&nbsp;<span class="ident" id="4503741">c</span><span class="op" id="4503742">.</span><span class="ident" id="4503743">tr</span><br>
<span class="lineno"></span><span class="op" id="4503746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4503749">func</span>&nbsp;<span class="op" id="4503754">(</span><span class="ident" id="4503755">c</span>&nbsp;<span class="op" id="4503757">*</span><span class="ident" id="4503758">CommandNode</span><span class="op" id="4503769">)</span>&nbsp;<span class="ident" id="4503771">Copy</span><span class="op" id="4503775">(</span><span class="op" id="4503776">)</span>&nbsp;<span class="ident" id="4503778">Node</span>&nbsp;<span class="op" id="4503783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503786">if</span>&nbsp;<span class="ident" id="4503789">c</span>&nbsp;<span class="op" id="4503791">==</span>&nbsp;<span class="ident" id="4503794">nil</span>&nbsp;<span class="op" id="4503798">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503802">return</span>&nbsp;<span class="ident" id="4503809">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4503812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503815">n</span>&nbsp;<span class="op" id="4503817">:=</span>&nbsp;<span class="ident" id="4503820">c</span><span class="op" id="4503821">.</span><span class="ident" id="4503822">tr</span><span class="op" id="4503824">.</span><span class="ident" id="4503825">newCommand</span><span class="op" id="4503835">(</span><span class="ident" id="4503836">c</span><span class="op" id="4503837">.</span><span class="ident" id="4503838">Pos</span><span class="op" id="4503841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503844">for</span>&nbsp;<span class="ident" id="4503848">_</span><span class="op" id="4503849">,</span>&nbsp;<span class="ident" id="4503851">c</span>&nbsp;<span class="op" id="4503853">:=</span>&nbsp;<span class="keyword" id="4503856">range</span>&nbsp;<span class="ident" id="4503862">c</span><span class="op" id="4503863">.</span><span class="ident" id="4503864">Args</span>&nbsp;<span class="op" id="4503869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503873">n</span><span class="op" id="4503874">.</span><span class="builtinfunc" id="4503875">append</span><span class="op" id="4503881">(</span><span class="ident" id="4503882">c</span><span class="op" id="4503883">.</span><span class="ident" id="4503884">Copy</span><span class="op" id="4503888">(</span><span class="op" id="4503889">)</span><span class="op" id="4503890">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4503893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503896">return</span>&nbsp;<span class="ident" id="4503903">n</span><br>
<span class="lineno"></span><span class="op" id="4503905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4503908">//&nbsp;IdentifierNode&nbsp;holds&nbsp;an&nbsp;identifier.</span><br>
<span class="lineno">280</span><span class="keyword" id="4503947">type</span>&nbsp;<span class="ident" id="4503952">IdentifierNode</span>&nbsp;<span class="keyword" id="4503967">struct</span>&nbsp;<span class="op" id="4503974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503977">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503987">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503992">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4503998">*</span><span class="ident" id="4503999">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504005">Ident</span>&nbsp;<span class="builtintype" id="4504011">string</span>&nbsp;<span class="comment" id="4504018">//&nbsp;The&nbsp;identifier&#39;s&nbsp;name.</span><br>
<span class="lineno">285</span><span class="op" id="4504044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4504047">//&nbsp;NewIdentifier&nbsp;returns&nbsp;a&nbsp;new&nbsp;IdentifierNode&nbsp;with&nbsp;the&nbsp;given&nbsp;identifier&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4504125">func</span>&nbsp;<span class="ident" id="4504130">NewIdentifier</span><span class="op" id="4504143">(</span><span class="ident" id="4504144">ident</span>&nbsp;<span class="builtintype" id="4504150">string</span><span class="op" id="4504156">)</span>&nbsp;<span class="op" id="4504158">*</span><span class="ident" id="4504159">IdentifierNode</span>&nbsp;<span class="op" id="4504174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504177">return</span>&nbsp;<span class="op" id="4504184">&amp;</span><span class="ident" id="4504185">IdentifierNode</span><span class="op" id="4504199">{</span><span class="ident" id="4504200">NodeType</span><span class="op" id="4504208">:</span>&nbsp;<span class="ident" id="4504210">NodeIdentifier</span><span class="op" id="4504224">,</span>&nbsp;<span class="ident" id="4504226">Ident</span><span class="op" id="4504231">:</span>&nbsp;<span class="ident" id="4504233">ident</span><span class="op" id="4504238">}</span><br>
<span class="lineno">290</span><span class="op" id="4504240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4504243">//&nbsp;SetPos&nbsp;sets&nbsp;the&nbsp;position.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="4504339">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="4504367">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno">295</span><span class="keyword" id="4504389">func</span>&nbsp;<span class="op" id="4504394">(</span><span class="ident" id="4504395">i</span>&nbsp;<span class="op" id="4504397">*</span><span class="ident" id="4504398">IdentifierNode</span><span class="op" id="4504412">)</span>&nbsp;<span class="ident" id="4504414">SetPos</span><span class="op" id="4504420">(</span><span class="ident" id="4504421">pos</span>&nbsp;<span class="ident" id="4504425">Pos</span><span class="op" id="4504428">)</span>&nbsp;<span class="op" id="4504430">*</span><span class="ident" id="4504431">IdentifierNode</span>&nbsp;<span class="op" id="4504446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504449">i</span><span class="op" id="4504450">.</span><span class="ident" id="4504451">Pos</span>&nbsp;<span class="op" id="4504455">=</span>&nbsp;<span class="ident" id="4504457">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504462">return</span>&nbsp;<span class="ident" id="4504469">i</span><br>
<span class="lineno"></span><span class="op" id="4504471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="4504474">//&nbsp;SetTree&nbsp;sets&nbsp;the&nbsp;parent&nbsp;tree&nbsp;for&nbsp;the&nbsp;node.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="4504587">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="4504615">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno"></span><span class="keyword" id="4504637">func</span>&nbsp;<span class="op" id="4504642">(</span><span class="ident" id="4504643">i</span>&nbsp;<span class="op" id="4504645">*</span><span class="ident" id="4504646">IdentifierNode</span><span class="op" id="4504660">)</span>&nbsp;<span class="ident" id="4504662">SetTree</span><span class="op" id="4504669">(</span><span class="ident" id="4504670">t</span>&nbsp;<span class="op" id="4504672">*</span><span class="ident" id="4504673">Tree</span><span class="op" id="4504677">)</span>&nbsp;<span class="op" id="4504679">*</span><span class="ident" id="4504680">IdentifierNode</span>&nbsp;<span class="op" id="4504695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504698">i</span><span class="op" id="4504699">.</span><span class="ident" id="4504700">tr</span>&nbsp;<span class="op" id="4504703">=</span>&nbsp;<span class="ident" id="4504705">t</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504708">return</span>&nbsp;<span class="ident" id="4504715">i</span><br>
<span class="lineno"></span><span class="op" id="4504717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4504720">func</span>&nbsp;<span class="op" id="4504725">(</span><span class="ident" id="4504726">i</span>&nbsp;<span class="op" id="4504728">*</span><span class="ident" id="4504729">IdentifierNode</span><span class="op" id="4504743">)</span>&nbsp;<span class="ident" id="4504745">String</span><span class="op" id="4504751">(</span><span class="op" id="4504752">)</span>&nbsp;<span class="builtintype" id="4504754">string</span>&nbsp;<span class="op" id="4504761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504764">return</span>&nbsp;<span class="ident" id="4504771">i</span><span class="op" id="4504772">.</span><span class="ident" id="4504773">Ident</span><br>
<span class="lineno">310</span><span class="op" id="4504779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4504782">func</span>&nbsp;<span class="op" id="4504787">(</span><span class="ident" id="4504788">i</span>&nbsp;<span class="op" id="4504790">*</span><span class="ident" id="4504791">IdentifierNode</span><span class="op" id="4504805">)</span>&nbsp;<span class="ident" id="4504807">tree</span><span class="op" id="4504811">(</span><span class="op" id="4504812">)</span>&nbsp;<span class="op" id="4504814">*</span><span class="ident" id="4504815">Tree</span>&nbsp;<span class="op" id="4504820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504823">return</span>&nbsp;<span class="ident" id="4504830">i</span><span class="op" id="4504831">.</span><span class="ident" id="4504832">tr</span><br>
<span class="lineno"></span><span class="op" id="4504835">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="4504838">func</span>&nbsp;<span class="op" id="4504843">(</span><span class="ident" id="4504844">i</span>&nbsp;<span class="op" id="4504846">*</span><span class="ident" id="4504847">IdentifierNode</span><span class="op" id="4504861">)</span>&nbsp;<span class="ident" id="4504863">Copy</span><span class="op" id="4504867">(</span><span class="op" id="4504868">)</span>&nbsp;<span class="ident" id="4504870">Node</span>&nbsp;<span class="op" id="4504875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504878">return</span>&nbsp;<span class="ident" id="4504885">NewIdentifier</span><span class="op" id="4504898">(</span><span class="ident" id="4504899">i</span><span class="op" id="4504900">.</span><span class="ident" id="4504901">Ident</span><span class="op" id="4504906">)</span><span class="op" id="4504907">.</span><span class="ident" id="4504908">SetTree</span><span class="op" id="4504915">(</span><span class="ident" id="4504916">i</span><span class="op" id="4504917">.</span><span class="ident" id="4504918">tr</span><span class="op" id="4504920">)</span><span class="op" id="4504921">.</span><span class="ident" id="4504922">SetPos</span><span class="op" id="4504928">(</span><span class="ident" id="4504929">i</span><span class="op" id="4504930">.</span><span class="ident" id="4504931">Pos</span><span class="op" id="4504934">)</span><br>
<span class="lineno"></span><span class="op" id="4504936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="4504939">//&nbsp;VariableNode&nbsp;holds&nbsp;a&nbsp;list&nbsp;of&nbsp;variable&nbsp;names,&nbsp;possibly&nbsp;with&nbsp;chained&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="4505015">//&nbsp;accesses.&nbsp;The&nbsp;dollar&nbsp;sign&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;(first)&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4505073">type</span>&nbsp;<span class="ident" id="4505078">VariableNode</span>&nbsp;<span class="keyword" id="4505091">struct</span>&nbsp;<span class="op" id="4505098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505101">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505111">Pos</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505116">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505122">*</span><span class="ident" id="4505123">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505129">Ident</span>&nbsp;<span class="op" id="4505135">[</span><span class="op" id="4505136">]</span><span class="builtintype" id="4505137">string</span>&nbsp;<span class="comment" id="4505144">//&nbsp;Variable&nbsp;name&nbsp;and&nbsp;fields&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4505190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4505193">func</span>&nbsp;<span class="op" id="4505198">(</span><span class="ident" id="4505199">t</span>&nbsp;<span class="op" id="4505201">*</span><span class="ident" id="4505202">Tree</span><span class="op" id="4505206">)</span>&nbsp;<span class="ident" id="4505208">newVariable</span><span class="op" id="4505219">(</span><span class="ident" id="4505220">pos</span>&nbsp;<span class="ident" id="4505224">Pos</span><span class="op" id="4505227">,</span>&nbsp;<span class="ident" id="4505229">ident</span>&nbsp;<span class="builtintype" id="4505235">string</span><span class="op" id="4505241">)</span>&nbsp;<span class="op" id="4505243">*</span><span class="ident" id="4505244">VariableNode</span>&nbsp;<span class="op" id="4505257">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505260">return</span>&nbsp;<span class="op" id="4505267">&amp;</span><span class="ident" id="4505268">VariableNode</span><span class="op" id="4505280">{</span><span class="ident" id="4505281">tr</span><span class="op" id="4505283">:</span>&nbsp;<span class="ident" id="4505285">t</span><span class="op" id="4505286">,</span>&nbsp;<span class="ident" id="4505288">NodeType</span><span class="op" id="4505296">:</span>&nbsp;<span class="ident" id="4505298">NodeVariable</span><span class="op" id="4505310">,</span>&nbsp;<span class="ident" id="4505312">Pos</span><span class="op" id="4505315">:</span>&nbsp;<span class="ident" id="4505317">pos</span><span class="op" id="4505320">,</span>&nbsp;<span class="ident" id="4505322">Ident</span><span class="op" id="4505327">:</span>&nbsp;<span class="ident" id="4505329">strings</span><span class="op" id="4505336">.</span><span class="ident" id="4505337">Split</span><span class="op" id="4505342">(</span><span class="ident" id="4505343">ident</span><span class="op" id="4505348">,</span>&nbsp;<span class="string" id="4505350">&#34;.&#34;</span><span class="op" id="4505353">)</span><span class="op" id="4505354">}</span><br>
<span class="lineno"></span><span class="op" id="4505356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4505359">func</span>&nbsp;<span class="op" id="4505364">(</span><span class="ident" id="4505365">v</span>&nbsp;<span class="op" id="4505367">*</span><span class="ident" id="4505368">VariableNode</span><span class="op" id="4505380">)</span>&nbsp;<span class="ident" id="4505382">String</span><span class="op" id="4505388">(</span><span class="op" id="4505389">)</span>&nbsp;<span class="builtintype" id="4505391">string</span>&nbsp;<span class="op" id="4505398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505401">s</span>&nbsp;<span class="op" id="4505403">:=</span>&nbsp;<span class="string" id="4505406">&#34;&#34;</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505410">for</span>&nbsp;<span class="ident" id="4505414">i</span><span class="op" id="4505415">,</span>&nbsp;<span class="ident" id="4505417">id</span>&nbsp;<span class="op" id="4505420">:=</span>&nbsp;<span class="keyword" id="4505423">range</span>&nbsp;<span class="ident" id="4505429">v</span><span class="op" id="4505430">.</span><span class="ident" id="4505431">Ident</span>&nbsp;<span class="op" id="4505437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505441">if</span>&nbsp;<span class="ident" id="4505444">i</span>&nbsp;<span class="op" id="4505446">&gt;</span>&nbsp;<span class="num" id="4505448">0</span>&nbsp;<span class="op" id="4505450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505455">s</span>&nbsp;<span class="op" id="4505457">+=</span>&nbsp;<span class="string" id="4505460">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4505466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505470">s</span>&nbsp;<span class="op" id="4505472">+=</span>&nbsp;<span class="ident" id="4505475">id</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4505479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505482">return</span>&nbsp;<span class="ident" id="4505489">s</span><br>
<span class="lineno"></span><span class="op" id="4505491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4505494">func</span>&nbsp;<span class="op" id="4505499">(</span><span class="ident" id="4505500">v</span>&nbsp;<span class="op" id="4505502">*</span><span class="ident" id="4505503">VariableNode</span><span class="op" id="4505515">)</span>&nbsp;<span class="ident" id="4505517">tree</span><span class="op" id="4505521">(</span><span class="op" id="4505522">)</span>&nbsp;<span class="op" id="4505524">*</span><span class="ident" id="4505525">Tree</span>&nbsp;<span class="op" id="4505530">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505533">return</span>&nbsp;<span class="ident" id="4505540">v</span><span class="op" id="4505541">.</span><span class="ident" id="4505542">tr</span><br>
<span class="lineno"></span><span class="op" id="4505545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4505548">func</span>&nbsp;<span class="op" id="4505553">(</span><span class="ident" id="4505554">v</span>&nbsp;<span class="op" id="4505556">*</span><span class="ident" id="4505557">VariableNode</span><span class="op" id="4505569">)</span>&nbsp;<span class="ident" id="4505571">Copy</span><span class="op" id="4505575">(</span><span class="op" id="4505576">)</span>&nbsp;<span class="ident" id="4505578">Node</span>&nbsp;<span class="op" id="4505583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505586">return</span>&nbsp;<span class="op" id="4505593">&amp;</span><span class="ident" id="4505594">VariableNode</span><span class="op" id="4505606">{</span><span class="ident" id="4505607">tr</span><span class="op" id="4505609">:</span>&nbsp;<span class="ident" id="4505611">v</span><span class="op" id="4505612">.</span><span class="ident" id="4505613">tr</span><span class="op" id="4505615">,</span>&nbsp;<span class="ident" id="4505617">NodeType</span><span class="op" id="4505625">:</span>&nbsp;<span class="ident" id="4505627">NodeVariable</span><span class="op" id="4505639">,</span>&nbsp;<span class="ident" id="4505641">Pos</span><span class="op" id="4505644">:</span>&nbsp;<span class="ident" id="4505646">v</span><span class="op" id="4505647">.</span><span class="ident" id="4505648">Pos</span><span class="op" id="4505651">,</span>&nbsp;<span class="ident" id="4505653">Ident</span><span class="op" id="4505658">:</span>&nbsp;<span class="builtinfunc" id="4505660">append</span><span class="op" id="4505666">(</span><span class="op" id="4505667">[</span><span class="op" id="4505668">]</span><span class="builtintype" id="4505669">string</span><span class="op" id="4505675">{</span><span class="op" id="4505676">}</span><span class="op" id="4505677">,</span>&nbsp;<span class="ident" id="4505679">v</span><span class="op" id="4505680">.</span><span class="ident" id="4505681">Ident</span><span class="op" id="4505686">...</span><span class="op" id="4505689">)</span><span class="op" id="4505690">}</span><br>
<span class="lineno">350</span><span class="op" id="4505692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4505695">//&nbsp;DotNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;.&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="4505740">type</span>&nbsp;<span class="ident" id="4505745">DotNode</span>&nbsp;<span class="keyword" id="4505753">struct</span>&nbsp;<span class="op" id="4505760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505763">NodeType</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505773">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505778">tr</span>&nbsp;<span class="op" id="4505781">*</span><span class="ident" id="4505782">Tree</span><br>
<span class="lineno"></span><span class="op" id="4505787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4505790">func</span>&nbsp;<span class="op" id="4505795">(</span><span class="ident" id="4505796">t</span>&nbsp;<span class="op" id="4505798">*</span><span class="ident" id="4505799">Tree</span><span class="op" id="4505803">)</span>&nbsp;<span class="ident" id="4505805">newDot</span><span class="op" id="4505811">(</span><span class="ident" id="4505812">pos</span>&nbsp;<span class="ident" id="4505816">Pos</span><span class="op" id="4505819">)</span>&nbsp;<span class="op" id="4505821">*</span><span class="ident" id="4505822">DotNode</span>&nbsp;<span class="op" id="4505830">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505833">return</span>&nbsp;<span class="op" id="4505840">&amp;</span><span class="ident" id="4505841">DotNode</span><span class="op" id="4505848">{</span><span class="ident" id="4505849">tr</span><span class="op" id="4505851">:</span>&nbsp;<span class="ident" id="4505853">t</span><span class="op" id="4505854">,</span>&nbsp;<span class="ident" id="4505856">NodeType</span><span class="op" id="4505864">:</span>&nbsp;<span class="ident" id="4505866">NodeDot</span><span class="op" id="4505873">,</span>&nbsp;<span class="ident" id="4505875">Pos</span><span class="op" id="4505878">:</span>&nbsp;<span class="ident" id="4505880">pos</span><span class="op" id="4505883">}</span><br>
<span class="lineno"></span><span class="op" id="4505885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4505888">func</span>&nbsp;<span class="op" id="4505893">(</span><span class="ident" id="4505894">d</span>&nbsp;<span class="op" id="4505896">*</span><span class="ident" id="4505897">DotNode</span><span class="op" id="4505904">)</span>&nbsp;<span class="ident" id="4505906">Type</span><span class="op" id="4505910">(</span><span class="op" id="4505911">)</span>&nbsp;<span class="ident" id="4505913">NodeType</span>&nbsp;<span class="op" id="4505922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4505925">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4505989">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4506057">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506081">return</span>&nbsp;<span class="ident" id="4506088">NodeDot</span><br>
<span class="lineno"></span><span class="op" id="4506096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="4506099">func</span>&nbsp;<span class="op" id="4506104">(</span><span class="ident" id="4506105">d</span>&nbsp;<span class="op" id="4506107">*</span><span class="ident" id="4506108">DotNode</span><span class="op" id="4506115">)</span>&nbsp;<span class="ident" id="4506117">String</span><span class="op" id="4506123">(</span><span class="op" id="4506124">)</span>&nbsp;<span class="builtintype" id="4506126">string</span>&nbsp;<span class="op" id="4506133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506136">return</span>&nbsp;<span class="string" id="4506143">&#34;.&#34;</span><br>
<span class="lineno"></span><span class="op" id="4506147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4506150">func</span>&nbsp;<span class="op" id="4506155">(</span><span class="ident" id="4506156">d</span>&nbsp;<span class="op" id="4506158">*</span><span class="ident" id="4506159">DotNode</span><span class="op" id="4506166">)</span>&nbsp;<span class="ident" id="4506168">tree</span><span class="op" id="4506172">(</span><span class="op" id="4506173">)</span>&nbsp;<span class="op" id="4506175">*</span><span class="ident" id="4506176">Tree</span>&nbsp;<span class="op" id="4506181">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506184">return</span>&nbsp;<span class="ident" id="4506191">d</span><span class="op" id="4506192">.</span><span class="ident" id="4506193">tr</span><br>
<span class="lineno"></span><span class="op" id="4506196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4506199">func</span>&nbsp;<span class="op" id="4506204">(</span><span class="ident" id="4506205">d</span>&nbsp;<span class="op" id="4506207">*</span><span class="ident" id="4506208">DotNode</span><span class="op" id="4506215">)</span>&nbsp;<span class="ident" id="4506217">Copy</span><span class="op" id="4506221">(</span><span class="op" id="4506222">)</span>&nbsp;<span class="ident" id="4506224">Node</span>&nbsp;<span class="op" id="4506229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506232">return</span>&nbsp;<span class="ident" id="4506239">d</span><span class="op" id="4506240">.</span><span class="ident" id="4506241">tr</span><span class="op" id="4506243">.</span><span class="ident" id="4506244">newDot</span><span class="op" id="4506250">(</span><span class="ident" id="4506251">d</span><span class="op" id="4506252">.</span><span class="ident" id="4506253">Pos</span><span class="op" id="4506256">)</span><br>
<span class="lineno">380</span><span class="op" id="4506258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4506261">//&nbsp;NilNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;nil&#39;&nbsp;representing&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="4506345">type</span>&nbsp;<span class="ident" id="4506350">NilNode</span>&nbsp;<span class="keyword" id="4506358">struct</span>&nbsp;<span class="op" id="4506365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506368">NodeType</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506378">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506383">tr</span>&nbsp;<span class="op" id="4506386">*</span><span class="ident" id="4506387">Tree</span><br>
<span class="lineno"></span><span class="op" id="4506392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4506395">func</span>&nbsp;<span class="op" id="4506400">(</span><span class="ident" id="4506401">t</span>&nbsp;<span class="op" id="4506403">*</span><span class="ident" id="4506404">Tree</span><span class="op" id="4506408">)</span>&nbsp;<span class="ident" id="4506410">newNil</span><span class="op" id="4506416">(</span><span class="ident" id="4506417">pos</span>&nbsp;<span class="ident" id="4506421">Pos</span><span class="op" id="4506424">)</span>&nbsp;<span class="op" id="4506426">*</span><span class="ident" id="4506427">NilNode</span>&nbsp;<span class="op" id="4506435">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506438">return</span>&nbsp;<span class="op" id="4506445">&amp;</span><span class="ident" id="4506446">NilNode</span><span class="op" id="4506453">{</span><span class="ident" id="4506454">tr</span><span class="op" id="4506456">:</span>&nbsp;<span class="ident" id="4506458">t</span><span class="op" id="4506459">,</span>&nbsp;<span class="ident" id="4506461">NodeType</span><span class="op" id="4506469">:</span>&nbsp;<span class="ident" id="4506471">NodeNil</span><span class="op" id="4506478">,</span>&nbsp;<span class="ident" id="4506480">Pos</span><span class="op" id="4506483">:</span>&nbsp;<span class="ident" id="4506485">pos</span><span class="op" id="4506488">}</span><br>
<span class="lineno"></span><span class="op" id="4506490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4506493">func</span>&nbsp;<span class="op" id="4506498">(</span><span class="ident" id="4506499">n</span>&nbsp;<span class="op" id="4506501">*</span><span class="ident" id="4506502">NilNode</span><span class="op" id="4506509">)</span>&nbsp;<span class="ident" id="4506511">Type</span><span class="op" id="4506515">(</span><span class="op" id="4506516">)</span>&nbsp;<span class="ident" id="4506518">NodeType</span>&nbsp;<span class="op" id="4506527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4506530">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4506594">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4506662">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506686">return</span>&nbsp;<span class="ident" id="4506693">NodeNil</span><br>
<span class="lineno"></span><span class="op" id="4506701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="4506704">func</span>&nbsp;<span class="op" id="4506709">(</span><span class="ident" id="4506710">n</span>&nbsp;<span class="op" id="4506712">*</span><span class="ident" id="4506713">NilNode</span><span class="op" id="4506720">)</span>&nbsp;<span class="ident" id="4506722">String</span><span class="op" id="4506728">(</span><span class="op" id="4506729">)</span>&nbsp;<span class="builtintype" id="4506731">string</span>&nbsp;<span class="op" id="4506738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506741">return</span>&nbsp;<span class="string" id="4506748">&#34;nil&#34;</span><br>
<span class="lineno"></span><span class="op" id="4506754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4506757">func</span>&nbsp;<span class="op" id="4506762">(</span><span class="ident" id="4506763">n</span>&nbsp;<span class="op" id="4506765">*</span><span class="ident" id="4506766">NilNode</span><span class="op" id="4506773">)</span>&nbsp;<span class="ident" id="4506775">tree</span><span class="op" id="4506779">(</span><span class="op" id="4506780">)</span>&nbsp;<span class="op" id="4506782">*</span><span class="ident" id="4506783">Tree</span>&nbsp;<span class="op" id="4506788">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506791">return</span>&nbsp;<span class="ident" id="4506798">n</span><span class="op" id="4506799">.</span><span class="ident" id="4506800">tr</span><br>
<span class="lineno"></span><span class="op" id="4506803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4506806">func</span>&nbsp;<span class="op" id="4506811">(</span><span class="ident" id="4506812">n</span>&nbsp;<span class="op" id="4506814">*</span><span class="ident" id="4506815">NilNode</span><span class="op" id="4506822">)</span>&nbsp;<span class="ident" id="4506824">Copy</span><span class="op" id="4506828">(</span><span class="op" id="4506829">)</span>&nbsp;<span class="ident" id="4506831">Node</span>&nbsp;<span class="op" id="4506836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506839">return</span>&nbsp;<span class="ident" id="4506846">n</span><span class="op" id="4506847">.</span><span class="ident" id="4506848">tr</span><span class="op" id="4506850">.</span><span class="ident" id="4506851">newNil</span><span class="op" id="4506857">(</span><span class="ident" id="4506858">n</span><span class="op" id="4506859">.</span><span class="ident" id="4506860">Pos</span><span class="op" id="4506863">)</span><br>
<span class="lineno">410</span><span class="op" id="4506865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4506868">//&nbsp;FieldNode&nbsp;holds&nbsp;a&nbsp;field&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4506927">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4506965">//&nbsp;The&nbsp;period&nbsp;is&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">415</span><span class="keyword" id="4507007">type</span>&nbsp;<span class="ident" id="4507012">FieldNode</span>&nbsp;<span class="keyword" id="4507022">struct</span>&nbsp;<span class="op" id="4507029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507032">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507042">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507047">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507053">*</span><span class="ident" id="4507054">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507060">Ident</span>&nbsp;<span class="op" id="4507066">[</span><span class="op" id="4507067">]</span><span class="builtintype" id="4507068">string</span>&nbsp;<span class="comment" id="4507075">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">420</span><span class="op" id="4507112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4507115">func</span>&nbsp;<span class="op" id="4507120">(</span><span class="ident" id="4507121">t</span>&nbsp;<span class="op" id="4507123">*</span><span class="ident" id="4507124">Tree</span><span class="op" id="4507128">)</span>&nbsp;<span class="ident" id="4507130">newField</span><span class="op" id="4507138">(</span><span class="ident" id="4507139">pos</span>&nbsp;<span class="ident" id="4507143">Pos</span><span class="op" id="4507146">,</span>&nbsp;<span class="ident" id="4507148">ident</span>&nbsp;<span class="builtintype" id="4507154">string</span><span class="op" id="4507160">)</span>&nbsp;<span class="op" id="4507162">*</span><span class="ident" id="4507163">FieldNode</span>&nbsp;<span class="op" id="4507173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507176">return</span>&nbsp;<span class="op" id="4507183">&amp;</span><span class="ident" id="4507184">FieldNode</span><span class="op" id="4507193">{</span><span class="ident" id="4507194">tr</span><span class="op" id="4507196">:</span>&nbsp;<span class="ident" id="4507198">t</span><span class="op" id="4507199">,</span>&nbsp;<span class="ident" id="4507201">NodeType</span><span class="op" id="4507209">:</span>&nbsp;<span class="ident" id="4507211">NodeField</span><span class="op" id="4507220">,</span>&nbsp;<span class="ident" id="4507222">Pos</span><span class="op" id="4507225">:</span>&nbsp;<span class="ident" id="4507227">pos</span><span class="op" id="4507230">,</span>&nbsp;<span class="ident" id="4507232">Ident</span><span class="op" id="4507237">:</span>&nbsp;<span class="ident" id="4507239">strings</span><span class="op" id="4507246">.</span><span class="ident" id="4507247">Split</span><span class="op" id="4507252">(</span><span class="ident" id="4507253">ident</span><span class="op" id="4507258">[</span><span class="num" id="4507259">1</span><span class="op" id="4507260">:</span><span class="op" id="4507261">]</span><span class="op" id="4507262">,</span>&nbsp;<span class="string" id="4507264">&#34;.&#34;</span><span class="op" id="4507267">)</span><span class="op" id="4507268">}</span>&nbsp;<span class="comment" id="4507270">//&nbsp;[1:]&nbsp;to&nbsp;drop&nbsp;leading&nbsp;period</span><br>
<span class="lineno"></span><span class="op" id="4507301">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="4507304">func</span>&nbsp;<span class="op" id="4507309">(</span><span class="ident" id="4507310">f</span>&nbsp;<span class="op" id="4507312">*</span><span class="ident" id="4507313">FieldNode</span><span class="op" id="4507322">)</span>&nbsp;<span class="ident" id="4507324">String</span><span class="op" id="4507330">(</span><span class="op" id="4507331">)</span>&nbsp;<span class="builtintype" id="4507333">string</span>&nbsp;<span class="op" id="4507340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507343">s</span>&nbsp;<span class="op" id="4507345">:=</span>&nbsp;<span class="string" id="4507348">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507352">for</span>&nbsp;<span class="ident" id="4507356">_</span><span class="op" id="4507357">,</span>&nbsp;<span class="ident" id="4507359">id</span>&nbsp;<span class="op" id="4507362">:=</span>&nbsp;<span class="keyword" id="4507365">range</span>&nbsp;<span class="ident" id="4507371">f</span><span class="op" id="4507372">.</span><span class="ident" id="4507373">Ident</span>&nbsp;<span class="op" id="4507379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507383">s</span>&nbsp;<span class="op" id="4507385">+=</span>&nbsp;<span class="string" id="4507388">&#34;.&#34;</span>&nbsp;<span class="op" id="4507392">+</span>&nbsp;<span class="ident" id="4507394">id</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4507398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507401">return</span>&nbsp;<span class="ident" id="4507408">s</span><br>
<span class="lineno"></span><span class="op" id="4507410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4507413">func</span>&nbsp;<span class="op" id="4507418">(</span><span class="ident" id="4507419">f</span>&nbsp;<span class="op" id="4507421">*</span><span class="ident" id="4507422">FieldNode</span><span class="op" id="4507431">)</span>&nbsp;<span class="ident" id="4507433">tree</span><span class="op" id="4507437">(</span><span class="op" id="4507438">)</span>&nbsp;<span class="op" id="4507440">*</span><span class="ident" id="4507441">Tree</span>&nbsp;<span class="op" id="4507446">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507449">return</span>&nbsp;<span class="ident" id="4507456">f</span><span class="op" id="4507457">.</span><span class="ident" id="4507458">tr</span><br>
<span class="lineno"></span><span class="op" id="4507461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4507464">func</span>&nbsp;<span class="op" id="4507469">(</span><span class="ident" id="4507470">f</span>&nbsp;<span class="op" id="4507472">*</span><span class="ident" id="4507473">FieldNode</span><span class="op" id="4507482">)</span>&nbsp;<span class="ident" id="4507484">Copy</span><span class="op" id="4507488">(</span><span class="op" id="4507489">)</span>&nbsp;<span class="ident" id="4507491">Node</span>&nbsp;<span class="op" id="4507496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507499">return</span>&nbsp;<span class="op" id="4507506">&amp;</span><span class="ident" id="4507507">FieldNode</span><span class="op" id="4507516">{</span><span class="ident" id="4507517">tr</span><span class="op" id="4507519">:</span>&nbsp;<span class="ident" id="4507521">f</span><span class="op" id="4507522">.</span><span class="ident" id="4507523">tr</span><span class="op" id="4507525">,</span>&nbsp;<span class="ident" id="4507527">NodeType</span><span class="op" id="4507535">:</span>&nbsp;<span class="ident" id="4507537">NodeField</span><span class="op" id="4507546">,</span>&nbsp;<span class="ident" id="4507548">Pos</span><span class="op" id="4507551">:</span>&nbsp;<span class="ident" id="4507553">f</span><span class="op" id="4507554">.</span><span class="ident" id="4507555">Pos</span><span class="op" id="4507558">,</span>&nbsp;<span class="ident" id="4507560">Ident</span><span class="op" id="4507565">:</span>&nbsp;<span class="builtinfunc" id="4507567">append</span><span class="op" id="4507573">(</span><span class="op" id="4507574">[</span><span class="op" id="4507575">]</span><span class="builtintype" id="4507576">string</span><span class="op" id="4507582">{</span><span class="op" id="4507583">}</span><span class="op" id="4507584">,</span>&nbsp;<span class="ident" id="4507586">f</span><span class="op" id="4507587">.</span><span class="ident" id="4507588">Ident</span><span class="op" id="4507593">...</span><span class="op" id="4507596">)</span><span class="op" id="4507597">}</span><br>
<span class="lineno">440</span><span class="op" id="4507599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4507602">//&nbsp;ChainNode&nbsp;holds&nbsp;a&nbsp;term&nbsp;followed&nbsp;by&nbsp;a&nbsp;chain&nbsp;of&nbsp;field&nbsp;accesses&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4507698">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4507736">//&nbsp;The&nbsp;periods&nbsp;are&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">445</span><span class="keyword" id="4507780">type</span>&nbsp;<span class="ident" id="4507785">ChainNode</span>&nbsp;<span class="keyword" id="4507795">struct</span>&nbsp;<span class="op" id="4507802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507805">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507815">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507820">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507826">*</span><span class="ident" id="4507827">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507833">Node</span>&nbsp;&nbsp;<span class="ident" id="4507839">Node</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507845">Field</span>&nbsp;<span class="op" id="4507851">[</span><span class="op" id="4507852">]</span><span class="builtintype" id="4507853">string</span>&nbsp;<span class="comment" id="4507860">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4507897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4507900">func</span>&nbsp;<span class="op" id="4507905">(</span><span class="ident" id="4507906">t</span>&nbsp;<span class="op" id="4507908">*</span><span class="ident" id="4507909">Tree</span><span class="op" id="4507913">)</span>&nbsp;<span class="ident" id="4507915">newChain</span><span class="op" id="4507923">(</span><span class="ident" id="4507924">pos</span>&nbsp;<span class="ident" id="4507928">Pos</span><span class="op" id="4507931">,</span>&nbsp;<span class="ident" id="4507933">node</span>&nbsp;<span class="ident" id="4507938">Node</span><span class="op" id="4507942">)</span>&nbsp;<span class="op" id="4507944">*</span><span class="ident" id="4507945">ChainNode</span>&nbsp;<span class="op" id="4507955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507958">return</span>&nbsp;<span class="op" id="4507965">&amp;</span><span class="ident" id="4507966">ChainNode</span><span class="op" id="4507975">{</span><span class="ident" id="4507976">tr</span><span class="op" id="4507978">:</span>&nbsp;<span class="ident" id="4507980">t</span><span class="op" id="4507981">,</span>&nbsp;<span class="ident" id="4507983">NodeType</span><span class="op" id="4507991">:</span>&nbsp;<span class="ident" id="4507993">NodeChain</span><span class="op" id="4508002">,</span>&nbsp;<span class="ident" id="4508004">Pos</span><span class="op" id="4508007">:</span>&nbsp;<span class="ident" id="4508009">pos</span><span class="op" id="4508012">,</span>&nbsp;<span class="ident" id="4508014">Node</span><span class="op" id="4508018">:</span>&nbsp;<span class="ident" id="4508020">node</span><span class="op" id="4508024">}</span><br>
<span class="lineno">455</span><span class="op" id="4508026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4508029">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;named&nbsp;field&nbsp;(which&nbsp;should&nbsp;start&nbsp;with&nbsp;a&nbsp;period)&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="4508117">func</span>&nbsp;<span class="op" id="4508122">(</span><span class="ident" id="4508123">c</span>&nbsp;<span class="op" id="4508125">*</span><span class="ident" id="4508126">ChainNode</span><span class="op" id="4508135">)</span>&nbsp;<span class="ident" id="4508137">Add</span><span class="op" id="4508140">(</span><span class="ident" id="4508141">field</span>&nbsp;<span class="builtintype" id="4508147">string</span><span class="op" id="4508153">)</span>&nbsp;<span class="op" id="4508155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508158">if</span>&nbsp;<span class="builtinfunc" id="4508161">len</span><span class="op" id="4508164">(</span><span class="ident" id="4508165">field</span><span class="op" id="4508170">)</span>&nbsp;<span class="op" id="4508172">==</span>&nbsp;<span class="num" id="4508175">0</span>&nbsp;<span class="op" id="4508177">||</span>&nbsp;<span class="ident" id="4508180">field</span><span class="op" id="4508185">[</span><span class="num" id="4508186">0</span><span class="op" id="4508187">]</span>&nbsp;<span class="op" id="4508189">!=</span>&nbsp;<span class="string" id="4508192">&#39;.&#39;</span>&nbsp;<span class="op" id="4508196">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4508200">panic</span><span class="op" id="4508205">(</span><span class="string" id="4508206">&#34;no&nbsp;dot&nbsp;in&nbsp;field&#34;</span><span class="op" id="4508223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4508226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508229">field</span>&nbsp;<span class="op" id="4508235">=</span>&nbsp;<span class="ident" id="4508237">field</span><span class="op" id="4508242">[</span><span class="num" id="4508243">1</span><span class="op" id="4508244">:</span><span class="op" id="4508245">]</span>&nbsp;<span class="comment" id="4508247">//&nbsp;Remove&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508271">if</span>&nbsp;<span class="ident" id="4508274">field</span>&nbsp;<span class="op" id="4508280">==</span>&nbsp;<span class="string" id="4508283">&#34;&#34;</span>&nbsp;<span class="op" id="4508286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4508290">panic</span><span class="op" id="4508295">(</span><span class="string" id="4508296">&#34;empty&nbsp;field&#34;</span><span class="op" id="4508309">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4508312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508315">c</span><span class="op" id="4508316">.</span><span class="ident" id="4508317">Field</span>&nbsp;<span class="op" id="4508323">=</span>&nbsp;<span class="builtinfunc" id="4508325">append</span><span class="op" id="4508331">(</span><span class="ident" id="4508332">c</span><span class="op" id="4508333">.</span><span class="ident" id="4508334">Field</span><span class="op" id="4508339">,</span>&nbsp;<span class="ident" id="4508341">field</span><span class="op" id="4508346">)</span><br>
<span class="lineno"></span><span class="op" id="4508348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4508351">func</span>&nbsp;<span class="op" id="4508356">(</span><span class="ident" id="4508357">c</span>&nbsp;<span class="op" id="4508359">*</span><span class="ident" id="4508360">ChainNode</span><span class="op" id="4508369">)</span>&nbsp;<span class="ident" id="4508371">String</span><span class="op" id="4508377">(</span><span class="op" id="4508378">)</span>&nbsp;<span class="builtintype" id="4508380">string</span>&nbsp;<span class="op" id="4508387">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508390">s</span>&nbsp;<span class="op" id="4508392">:=</span>&nbsp;<span class="ident" id="4508395">c</span><span class="op" id="4508396">.</span><span class="ident" id="4508397">Node</span><span class="op" id="4508401">.</span><span class="ident" id="4508402">String</span><span class="op" id="4508408">(</span><span class="op" id="4508409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508412">if</span>&nbsp;<span class="ident" id="4508415">_</span><span class="op" id="4508416">,</span>&nbsp;<span class="ident" id="4508418">ok</span>&nbsp;<span class="op" id="4508421">:=</span>&nbsp;<span class="ident" id="4508424">c</span><span class="op" id="4508425">.</span><span class="ident" id="4508426">Node</span><span class="op" id="4508430">.</span><span class="op" id="4508431">(</span><span class="op" id="4508432">*</span><span class="ident" id="4508433">PipeNode</span><span class="op" id="4508441">)</span><span class="op" id="4508442">;</span>&nbsp;<span class="ident" id="4508444">ok</span>&nbsp;<span class="op" id="4508447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508451">s</span>&nbsp;<span class="op" id="4508453">=</span>&nbsp;<span class="string" id="4508455">&#34;(&#34;</span>&nbsp;<span class="op" id="4508459">+</span>&nbsp;<span class="ident" id="4508461">s</span>&nbsp;<span class="op" id="4508463">+</span>&nbsp;<span class="string" id="4508465">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4508470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508473">for</span>&nbsp;<span class="ident" id="4508477">_</span><span class="op" id="4508478">,</span>&nbsp;<span class="ident" id="4508480">field</span>&nbsp;<span class="op" id="4508486">:=</span>&nbsp;<span class="keyword" id="4508489">range</span>&nbsp;<span class="ident" id="4508495">c</span><span class="op" id="4508496">.</span><span class="ident" id="4508497">Field</span>&nbsp;<span class="op" id="4508503">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508507">s</span>&nbsp;<span class="op" id="4508509">+=</span>&nbsp;<span class="string" id="4508512">&#34;.&#34;</span>&nbsp;<span class="op" id="4508516">+</span>&nbsp;<span class="ident" id="4508518">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4508525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508528">return</span>&nbsp;<span class="ident" id="4508535">s</span><br>
<span class="lineno"></span><span class="op" id="4508537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="4508540">func</span>&nbsp;<span class="op" id="4508545">(</span><span class="ident" id="4508546">c</span>&nbsp;<span class="op" id="4508548">*</span><span class="ident" id="4508549">ChainNode</span><span class="op" id="4508558">)</span>&nbsp;<span class="ident" id="4508560">tree</span><span class="op" id="4508564">(</span><span class="op" id="4508565">)</span>&nbsp;<span class="op" id="4508567">*</span><span class="ident" id="4508568">Tree</span>&nbsp;<span class="op" id="4508573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508576">return</span>&nbsp;<span class="ident" id="4508583">c</span><span class="op" id="4508584">.</span><span class="ident" id="4508585">tr</span><br>
<span class="lineno"></span><span class="op" id="4508588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4508591">func</span>&nbsp;<span class="op" id="4508596">(</span><span class="ident" id="4508597">c</span>&nbsp;<span class="op" id="4508599">*</span><span class="ident" id="4508600">ChainNode</span><span class="op" id="4508609">)</span>&nbsp;<span class="ident" id="4508611">Copy</span><span class="op" id="4508615">(</span><span class="op" id="4508616">)</span>&nbsp;<span class="ident" id="4508618">Node</span>&nbsp;<span class="op" id="4508623">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508626">return</span>&nbsp;<span class="op" id="4508633">&amp;</span><span class="ident" id="4508634">ChainNode</span><span class="op" id="4508643">{</span><span class="ident" id="4508644">tr</span><span class="op" id="4508646">:</span>&nbsp;<span class="ident" id="4508648">c</span><span class="op" id="4508649">.</span><span class="ident" id="4508650">tr</span><span class="op" id="4508652">,</span>&nbsp;<span class="ident" id="4508654">NodeType</span><span class="op" id="4508662">:</span>&nbsp;<span class="ident" id="4508664">NodeChain</span><span class="op" id="4508673">,</span>&nbsp;<span class="ident" id="4508675">Pos</span><span class="op" id="4508678">:</span>&nbsp;<span class="ident" id="4508680">c</span><span class="op" id="4508681">.</span><span class="ident" id="4508682">Pos</span><span class="op" id="4508685">,</span>&nbsp;<span class="ident" id="4508687">Node</span><span class="op" id="4508691">:</span>&nbsp;<span class="ident" id="4508693">c</span><span class="op" id="4508694">.</span><span class="ident" id="4508695">Node</span><span class="op" id="4508699">,</span>&nbsp;<span class="ident" id="4508701">Field</span><span class="op" id="4508706">:</span>&nbsp;<span class="builtinfunc" id="4508708">append</span><span class="op" id="4508714">(</span><span class="op" id="4508715">[</span><span class="op" id="4508716">]</span><span class="builtintype" id="4508717">string</span><span class="op" id="4508723">{</span><span class="op" id="4508724">}</span><span class="op" id="4508725">,</span>&nbsp;<span class="ident" id="4508727">c</span><span class="op" id="4508728">.</span><span class="ident" id="4508729">Field</span><span class="op" id="4508734">...</span><span class="op" id="4508737">)</span><span class="op" id="4508738">}</span><br>
<span class="lineno"></span><span class="op" id="4508740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4508743">//&nbsp;BoolNode&nbsp;holds&nbsp;a&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="4508781">type</span>&nbsp;<span class="ident" id="4508786">BoolNode</span>&nbsp;<span class="keyword" id="4508795">struct</span>&nbsp;<span class="op" id="4508802">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508805">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508815">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508820">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4508825">*</span><span class="ident" id="4508826">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508832">True</span>&nbsp;<span class="builtintype" id="4508837">bool</span>&nbsp;<span class="comment" id="4508842">//&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="4508880">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="4508883">func</span>&nbsp;<span class="op" id="4508888">(</span><span class="ident" id="4508889">t</span>&nbsp;<span class="op" id="4508891">*</span><span class="ident" id="4508892">Tree</span><span class="op" id="4508896">)</span>&nbsp;<span class="ident" id="4508898">newBool</span><span class="op" id="4508905">(</span><span class="ident" id="4508906">pos</span>&nbsp;<span class="ident" id="4508910">Pos</span><span class="op" id="4508913">,</span>&nbsp;<span class="ident" id="4508915">true</span>&nbsp;<span class="builtintype" id="4508920">bool</span><span class="op" id="4508924">)</span>&nbsp;<span class="op" id="4508926">*</span><span class="ident" id="4508927">BoolNode</span>&nbsp;<span class="op" id="4508936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508939">return</span>&nbsp;<span class="op" id="4508946">&amp;</span><span class="ident" id="4508947">BoolNode</span><span class="op" id="4508955">{</span><span class="ident" id="4508956">tr</span><span class="op" id="4508958">:</span>&nbsp;<span class="ident" id="4508960">t</span><span class="op" id="4508961">,</span>&nbsp;<span class="ident" id="4508963">NodeType</span><span class="op" id="4508971">:</span>&nbsp;<span class="ident" id="4508973">NodeBool</span><span class="op" id="4508981">,</span>&nbsp;<span class="ident" id="4508983">Pos</span><span class="op" id="4508986">:</span>&nbsp;<span class="ident" id="4508988">pos</span><span class="op" id="4508991">,</span>&nbsp;<span class="ident" id="4508993">True</span><span class="op" id="4508997">:</span>&nbsp;<span class="ident" id="4508999">true</span><span class="op" id="4509003">}</span><br>
<span class="lineno"></span><span class="op" id="4509005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="4509008">func</span>&nbsp;<span class="op" id="4509013">(</span><span class="ident" id="4509014">b</span>&nbsp;<span class="op" id="4509016">*</span><span class="ident" id="4509017">BoolNode</span><span class="op" id="4509025">)</span>&nbsp;<span class="ident" id="4509027">String</span><span class="op" id="4509033">(</span><span class="op" id="4509034">)</span>&nbsp;<span class="builtintype" id="4509036">string</span>&nbsp;<span class="op" id="4509043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509046">if</span>&nbsp;<span class="ident" id="4509049">b</span><span class="op" id="4509050">.</span><span class="ident" id="4509051">True</span>&nbsp;<span class="op" id="4509056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509060">return</span>&nbsp;<span class="string" id="4509067">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4509075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509078">return</span>&nbsp;<span class="string" id="4509085">&#34;false&#34;</span><br>
<span class="lineno">505</span><span class="op" id="4509093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4509096">func</span>&nbsp;<span class="op" id="4509101">(</span><span class="ident" id="4509102">b</span>&nbsp;<span class="op" id="4509104">*</span><span class="ident" id="4509105">BoolNode</span><span class="op" id="4509113">)</span>&nbsp;<span class="ident" id="4509115">tree</span><span class="op" id="4509119">(</span><span class="op" id="4509120">)</span>&nbsp;<span class="op" id="4509122">*</span><span class="ident" id="4509123">Tree</span>&nbsp;<span class="op" id="4509128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509131">return</span>&nbsp;<span class="ident" id="4509138">b</span><span class="op" id="4509139">.</span><span class="ident" id="4509140">tr</span><br>
<span class="lineno"></span><span class="op" id="4509143">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="4509146">func</span>&nbsp;<span class="op" id="4509151">(</span><span class="ident" id="4509152">b</span>&nbsp;<span class="op" id="4509154">*</span><span class="ident" id="4509155">BoolNode</span><span class="op" id="4509163">)</span>&nbsp;<span class="ident" id="4509165">Copy</span><span class="op" id="4509169">(</span><span class="op" id="4509170">)</span>&nbsp;<span class="ident" id="4509172">Node</span>&nbsp;<span class="op" id="4509177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509180">return</span>&nbsp;<span class="ident" id="4509187">b</span><span class="op" id="4509188">.</span><span class="ident" id="4509189">tr</span><span class="op" id="4509191">.</span><span class="ident" id="4509192">newBool</span><span class="op" id="4509199">(</span><span class="ident" id="4509200">b</span><span class="op" id="4509201">.</span><span class="ident" id="4509202">Pos</span><span class="op" id="4509205">,</span>&nbsp;<span class="ident" id="4509207">b</span><span class="op" id="4509208">.</span><span class="ident" id="4509209">True</span><span class="op" id="4509213">)</span><br>
<span class="lineno"></span><span class="op" id="4509215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="4509218">//&nbsp;NumberNode&nbsp;holds&nbsp;a&nbsp;number:&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;integer,&nbsp;float,&nbsp;or&nbsp;complex.</span><br>
<span class="lineno"></span><span class="comment" id="4509295">//&nbsp;The&nbsp;value&nbsp;is&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;under&nbsp;all&nbsp;the&nbsp;types&nbsp;that&nbsp;can&nbsp;represent&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="4509379">//&nbsp;This&nbsp;simulates&nbsp;in&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;code&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Go&#39;s&nbsp;ideal&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4509461">type</span>&nbsp;<span class="ident" id="4509466">NumberNode</span>&nbsp;<span class="keyword" id="4509477">struct</span>&nbsp;<span class="op" id="4509484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509487">NodeType</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509497">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509502">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509513">*</span><span class="ident" id="4509514">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509520">IsInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4509531">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509542">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509576">IsUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4509587">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509598">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;unsigned&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509641">IsFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4509652">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509663">//&nbsp;Number&nbsp;has&nbsp;a&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509702">IsComplex</span>&nbsp;&nbsp;<span class="builtintype" id="4509713">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509724">//&nbsp;Number&nbsp;is&nbsp;complex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509747">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509758">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509769">//&nbsp;The&nbsp;signed&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509799">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509810">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509821">//&nbsp;The&nbsp;unsigned&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509853">Float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4509864">float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509875">//&nbsp;The&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509905">Complex128</span>&nbsp;<span class="builtintype" id="4509916">complex128</span>&nbsp;<span class="comment" id="4509927">//&nbsp;The&nbsp;complex&nbsp;value.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509950">Text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4509961">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509972">//&nbsp;The&nbsp;original&nbsp;textual&nbsp;representation&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="op" id="4510027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4510030">func</span>&nbsp;<span class="op" id="4510035">(</span><span class="ident" id="4510036">t</span>&nbsp;<span class="op" id="4510038">*</span><span class="ident" id="4510039">Tree</span><span class="op" id="4510043">)</span>&nbsp;<span class="ident" id="4510045">newNumber</span><span class="op" id="4510054">(</span><span class="ident" id="4510055">pos</span>&nbsp;<span class="ident" id="4510059">Pos</span><span class="op" id="4510062">,</span>&nbsp;<span class="ident" id="4510064">text</span>&nbsp;<span class="builtintype" id="4510069">string</span><span class="op" id="4510075">,</span>&nbsp;<span class="ident" id="4510077">typ</span>&nbsp;<span class="ident" id="4510081">itemType</span><span class="op" id="4510089">)</span>&nbsp;<span class="op" id="4510091">(</span><span class="op" id="4510092">*</span><span class="ident" id="4510093">NumberNode</span><span class="op" id="4510103">,</span>&nbsp;<span class="builtintype" id="4510105">error</span><span class="op" id="4510110">)</span>&nbsp;<span class="op" id="4510112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510115">n</span>&nbsp;<span class="op" id="4510117">:=</span>&nbsp;<span class="op" id="4510120">&amp;</span><span class="ident" id="4510121">NumberNode</span><span class="op" id="4510131">{</span><span class="ident" id="4510132">tr</span><span class="op" id="4510134">:</span>&nbsp;<span class="ident" id="4510136">t</span><span class="op" id="4510137">,</span>&nbsp;<span class="ident" id="4510139">NodeType</span><span class="op" id="4510147">:</span>&nbsp;<span class="ident" id="4510149">NodeNumber</span><span class="op" id="4510159">,</span>&nbsp;<span class="ident" id="4510161">Pos</span><span class="op" id="4510164">:</span>&nbsp;<span class="ident" id="4510166">pos</span><span class="op" id="4510169">,</span>&nbsp;<span class="ident" id="4510171">Text</span><span class="op" id="4510175">:</span>&nbsp;<span class="ident" id="4510177">text</span><span class="op" id="4510181">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510184">switch</span>&nbsp;<span class="ident" id="4510191">typ</span>&nbsp;<span class="op" id="4510195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510198">case</span>&nbsp;<span class="ident" id="4510203">itemCharConstant</span><span class="op" id="4510219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4510223">rune</span><span class="op" id="4510227">,</span>&nbsp;<span class="ident" id="4510229">_</span><span class="op" id="4510230">,</span>&nbsp;<span class="ident" id="4510232">tail</span><span class="op" id="4510236">,</span>&nbsp;<span class="ident" id="4510238">err</span>&nbsp;<span class="op" id="4510242">:=</span>&nbsp;<span class="ident" id="4510245">strconv</span><span class="op" id="4510252">.</span><span class="ident" id="4510253">UnquoteChar</span><span class="op" id="4510264">(</span><span class="ident" id="4510265">text</span><span class="op" id="4510269">[</span><span class="num" id="4510270">1</span><span class="op" id="4510271">:</span><span class="op" id="4510272">]</span><span class="op" id="4510273">,</span>&nbsp;<span class="ident" id="4510275">text</span><span class="op" id="4510279">[</span><span class="num" id="4510280">0</span><span class="op" id="4510281">]</span><span class="op" id="4510282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510286">if</span>&nbsp;<span class="ident" id="4510289">err</span>&nbsp;<span class="op" id="4510293">!=</span>&nbsp;<span class="ident" id="4510296">nil</span>&nbsp;<span class="op" id="4510300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510305">return</span>&nbsp;<span class="ident" id="4510312">nil</span><span class="op" id="4510315">,</span>&nbsp;<span class="ident" id="4510317">err</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510327">if</span>&nbsp;<span class="ident" id="4510330">tail</span>&nbsp;<span class="op" id="4510335">!=</span>&nbsp;<span class="string" id="4510338">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="4510342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510347">return</span>&nbsp;<span class="ident" id="4510354">nil</span><span class="op" id="4510357">,</span>&nbsp;<span class="ident" id="4510359">fmt</span><span class="op" id="4510362">.</span><span class="ident" id="4510363">Errorf</span><span class="op" id="4510369">(</span><span class="string" id="4510370">&#34;malformed&nbsp;character&nbsp;constant:&nbsp;%s&#34;</span><span class="op" id="4510404">,</span>&nbsp;<span class="ident" id="4510406">text</span><span class="op" id="4510410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510418">n</span><span class="op" id="4510419">.</span><span class="ident" id="4510420">Int64</span>&nbsp;<span class="op" id="4510426">=</span>&nbsp;<span class="ident" id="4510428">int64</span><span class="op" id="4510433">(</span><span class="builtintype" id="4510434">rune</span><span class="op" id="4510438">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510442">n</span><span class="op" id="4510443">.</span><span class="ident" id="4510444">IsInt</span>&nbsp;<span class="op" id="4510450">=</span>&nbsp;<span class="ident" id="4510452">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510459">n</span><span class="op" id="4510460">.</span><span class="ident" id="4510461">Uint64</span>&nbsp;<span class="op" id="4510468">=</span>&nbsp;<span class="ident" id="4510470">uint64</span><span class="op" id="4510476">(</span><span class="builtintype" id="4510477">rune</span><span class="op" id="4510481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510485">n</span><span class="op" id="4510486">.</span><span class="ident" id="4510487">IsUint</span>&nbsp;<span class="op" id="4510494">=</span>&nbsp;<span class="ident" id="4510496">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510503">n</span><span class="op" id="4510504">.</span><span class="ident" id="4510505">Float64</span>&nbsp;<span class="op" id="4510513">=</span>&nbsp;<span class="builtintype" id="4510515">float64</span><span class="op" id="4510522">(</span><span class="builtintype" id="4510523">rune</span><span class="op" id="4510527">)</span>&nbsp;<span class="comment" id="4510529">//&nbsp;odd&nbsp;but&nbsp;those&nbsp;are&nbsp;the&nbsp;rules.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510563">n</span><span class="op" id="4510564">.</span><span class="ident" id="4510565">IsFloat</span>&nbsp;<span class="op" id="4510573">=</span>&nbsp;<span class="ident" id="4510575">true</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510582">return</span>&nbsp;<span class="ident" id="4510589">n</span><span class="op" id="4510590">,</span>&nbsp;<span class="ident" id="4510592">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510597">case</span>&nbsp;<span class="ident" id="4510602">itemComplex</span><span class="op" id="4510613">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4510617">//&nbsp;fmt.Sscan&nbsp;can&nbsp;parse&nbsp;the&nbsp;pair,&nbsp;so&nbsp;let&nbsp;it&nbsp;do&nbsp;the&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510675">if</span>&nbsp;<span class="ident" id="4510678">_</span><span class="op" id="4510679">,</span>&nbsp;<span class="ident" id="4510681">err</span>&nbsp;<span class="op" id="4510685">:=</span>&nbsp;<span class="ident" id="4510688">fmt</span><span class="op" id="4510691">.</span><span class="ident" id="4510692">Sscan</span><span class="op" id="4510697">(</span><span class="ident" id="4510698">text</span><span class="op" id="4510702">,</span>&nbsp;<span class="op" id="4510704">&amp;</span><span class="ident" id="4510705">n</span><span class="op" id="4510706">.</span><span class="ident" id="4510707">Complex128</span><span class="op" id="4510717">)</span><span class="op" id="4510718">;</span>&nbsp;<span class="ident" id="4510720">err</span>&nbsp;<span class="op" id="4510724">!=</span>&nbsp;<span class="ident" id="4510727">nil</span>&nbsp;<span class="op" id="4510731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510736">return</span>&nbsp;<span class="ident" id="4510743">nil</span><span class="op" id="4510746">,</span>&nbsp;<span class="ident" id="4510748">err</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510758">n</span><span class="op" id="4510759">.</span><span class="ident" id="4510760">IsComplex</span>&nbsp;<span class="op" id="4510770">=</span>&nbsp;<span class="ident" id="4510772">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510779">n</span><span class="op" id="4510780">.</span><span class="ident" id="4510781">simplifyComplex</span><span class="op" id="4510796">(</span><span class="op" id="4510797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510801">return</span>&nbsp;<span class="ident" id="4510808">n</span><span class="op" id="4510809">,</span>&nbsp;<span class="ident" id="4510811">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510816">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4510819">//&nbsp;Imaginary&nbsp;constants&nbsp;can&nbsp;only&nbsp;be&nbsp;complex&nbsp;unless&nbsp;they&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510885">if</span>&nbsp;<span class="builtinfunc" id="4510888">len</span><span class="op" id="4510891">(</span><span class="ident" id="4510892">text</span><span class="op" id="4510896">)</span>&nbsp;<span class="op" id="4510898">&gt;</span>&nbsp;<span class="num" id="4510900">0</span>&nbsp;<span class="op" id="4510902">&amp;&amp;</span>&nbsp;<span class="ident" id="4510905">text</span><span class="op" id="4510909">[</span><span class="builtinfunc" id="4510910">len</span><span class="op" id="4510913">(</span><span class="ident" id="4510914">text</span><span class="op" id="4510918">)</span><span class="op" id="4510919">-</span><span class="num" id="4510920">1</span><span class="op" id="4510921">]</span>&nbsp;<span class="op" id="4510923">==</span>&nbsp;<span class="string" id="4510926">&#39;i&#39;</span>&nbsp;<span class="op" id="4510930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510934">f</span><span class="op" id="4510935">,</span>&nbsp;<span class="ident" id="4510937">err</span>&nbsp;<span class="op" id="4510941">:=</span>&nbsp;<span class="ident" id="4510944">strconv</span><span class="op" id="4510951">.</span><span class="ident" id="4510952">ParseFloat</span><span class="op" id="4510962">(</span><span class="ident" id="4510963">text</span><span class="op" id="4510967">[</span><span class="op" id="4510968">:</span><span class="builtinfunc" id="4510969">len</span><span class="op" id="4510972">(</span><span class="ident" id="4510973">text</span><span class="op" id="4510977">)</span><span class="op" id="4510978">-</span><span class="num" id="4510979">1</span><span class="op" id="4510980">]</span><span class="op" id="4510981">,</span>&nbsp;<span class="num" id="4510983">64</span><span class="op" id="4510985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510989">if</span>&nbsp;<span class="ident" id="4510992">err</span>&nbsp;<span class="op" id="4510996">==</span>&nbsp;<span class="ident" id="4510999">nil</span>&nbsp;<span class="op" id="4511003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511008">n</span><span class="op" id="4511009">.</span><span class="ident" id="4511010">IsComplex</span>&nbsp;<span class="op" id="4511020">=</span>&nbsp;<span class="ident" id="4511022">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511030">n</span><span class="op" id="4511031">.</span><span class="ident" id="4511032">Complex128</span>&nbsp;<span class="op" id="4511043">=</span>&nbsp;<span class="builtinfunc" id="4511045">complex</span><span class="op" id="4511052">(</span><span class="num" id="4511053">0</span><span class="op" id="4511054">,</span>&nbsp;<span class="ident" id="4511056">f</span><span class="op" id="4511057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511062">n</span><span class="op" id="4511063">.</span><span class="ident" id="4511064">simplifyComplex</span><span class="op" id="4511079">(</span><span class="op" id="4511080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511085">return</span>&nbsp;<span class="ident" id="4511092">n</span><span class="op" id="4511093">,</span>&nbsp;<span class="ident" id="4511095">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511104">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4511107">//&nbsp;Do&nbsp;integer&nbsp;test&nbsp;first&nbsp;so&nbsp;we&nbsp;get&nbsp;0x123&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511154">u</span><span class="op" id="4511155">,</span>&nbsp;<span class="ident" id="4511157">err</span>&nbsp;<span class="op" id="4511161">:=</span>&nbsp;<span class="ident" id="4511164">strconv</span><span class="op" id="4511171">.</span><span class="ident" id="4511172">ParseUint</span><span class="op" id="4511181">(</span><span class="ident" id="4511182">text</span><span class="op" id="4511186">,</span>&nbsp;<span class="num" id="4511188">0</span><span class="op" id="4511189">,</span>&nbsp;<span class="num" id="4511191">64</span><span class="op" id="4511193">)</span>&nbsp;<span class="comment" id="4511195">//&nbsp;will&nbsp;fail&nbsp;for&nbsp;-0;&nbsp;fixed&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511230">if</span>&nbsp;<span class="ident" id="4511233">err</span>&nbsp;<span class="op" id="4511237">==</span>&nbsp;<span class="ident" id="4511240">nil</span>&nbsp;<span class="op" id="4511244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511248">n</span><span class="op" id="4511249">.</span><span class="ident" id="4511250">IsUint</span>&nbsp;<span class="op" id="4511257">=</span>&nbsp;<span class="ident" id="4511259">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511266">n</span><span class="op" id="4511267">.</span><span class="ident" id="4511268">Uint64</span>&nbsp;<span class="op" id="4511275">=</span>&nbsp;<span class="ident" id="4511277">u</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511283">i</span><span class="op" id="4511284">,</span>&nbsp;<span class="ident" id="4511286">err</span>&nbsp;<span class="op" id="4511290">:=</span>&nbsp;<span class="ident" id="4511293">strconv</span><span class="op" id="4511300">.</span><span class="ident" id="4511301">ParseInt</span><span class="op" id="4511309">(</span><span class="ident" id="4511310">text</span><span class="op" id="4511314">,</span>&nbsp;<span class="num" id="4511316">0</span><span class="op" id="4511317">,</span>&nbsp;<span class="num" id="4511319">64</span><span class="op" id="4511321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511324">if</span>&nbsp;<span class="ident" id="4511327">err</span>&nbsp;<span class="op" id="4511331">==</span>&nbsp;<span class="ident" id="4511334">nil</span>&nbsp;<span class="op" id="4511338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511342">n</span><span class="op" id="4511343">.</span><span class="ident" id="4511344">IsInt</span>&nbsp;<span class="op" id="4511350">=</span>&nbsp;<span class="ident" id="4511352">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511359">n</span><span class="op" id="4511360">.</span><span class="ident" id="4511361">Int64</span>&nbsp;<span class="op" id="4511367">=</span>&nbsp;<span class="ident" id="4511369">i</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511373">if</span>&nbsp;<span class="ident" id="4511376">i</span>&nbsp;<span class="op" id="4511378">==</span>&nbsp;<span class="num" id="4511381">0</span>&nbsp;<span class="op" id="4511383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511388">n</span><span class="op" id="4511389">.</span><span class="ident" id="4511390">IsUint</span>&nbsp;<span class="op" id="4511397">=</span>&nbsp;<span class="ident" id="4511399">true</span>&nbsp;<span class="comment" id="4511404">//&nbsp;in&nbsp;case&nbsp;of&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511425">n</span><span class="op" id="4511426">.</span><span class="ident" id="4511427">Uint64</span>&nbsp;<span class="op" id="4511434">=</span>&nbsp;<span class="ident" id="4511436">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511443">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4511446">//&nbsp;If&nbsp;an&nbsp;integer&nbsp;extraction&nbsp;succeeded,&nbsp;promote&nbsp;the&nbsp;float.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511505">if</span>&nbsp;<span class="ident" id="4511508">n</span><span class="op" id="4511509">.</span><span class="ident" id="4511510">IsInt</span>&nbsp;<span class="op" id="4511516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511520">n</span><span class="op" id="4511521">.</span><span class="ident" id="4511522">IsFloat</span>&nbsp;<span class="op" id="4511530">=</span>&nbsp;<span class="ident" id="4511532">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511539">n</span><span class="op" id="4511540">.</span><span class="ident" id="4511541">Float64</span>&nbsp;<span class="op" id="4511549">=</span>&nbsp;<span class="builtintype" id="4511551">float64</span><span class="op" id="4511558">(</span><span class="ident" id="4511559">n</span><span class="op" id="4511560">.</span><span class="ident" id="4511561">Int64</span><span class="op" id="4511566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511569">}</span>&nbsp;<span class="keyword" id="4511571">else</span>&nbsp;<span class="keyword" id="4511576">if</span>&nbsp;<span class="ident" id="4511579">n</span><span class="op" id="4511580">.</span><span class="ident" id="4511581">IsUint</span>&nbsp;<span class="op" id="4511588">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511592">n</span><span class="op" id="4511593">.</span><span class="ident" id="4511594">IsFloat</span>&nbsp;<span class="op" id="4511602">=</span>&nbsp;<span class="ident" id="4511604">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511611">n</span><span class="op" id="4511612">.</span><span class="ident" id="4511613">Float64</span>&nbsp;<span class="op" id="4511621">=</span>&nbsp;<span class="builtintype" id="4511623">float64</span><span class="op" id="4511630">(</span><span class="ident" id="4511631">n</span><span class="op" id="4511632">.</span><span class="ident" id="4511633">Uint64</span><span class="op" id="4511639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511642">}</span>&nbsp;<span class="keyword" id="4511644">else</span>&nbsp;<span class="op" id="4511649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511653">f</span><span class="op" id="4511654">,</span>&nbsp;<span class="ident" id="4511656">err</span>&nbsp;<span class="op" id="4511660">:=</span>&nbsp;<span class="ident" id="4511663">strconv</span><span class="op" id="4511670">.</span><span class="ident" id="4511671">ParseFloat</span><span class="op" id="4511681">(</span><span class="ident" id="4511682">text</span><span class="op" id="4511686">,</span>&nbsp;<span class="num" id="4511688">64</span><span class="op" id="4511690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511694">if</span>&nbsp;<span class="ident" id="4511697">err</span>&nbsp;<span class="op" id="4511701">==</span>&nbsp;<span class="ident" id="4511704">nil</span>&nbsp;<span class="op" id="4511708">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511713">n</span><span class="op" id="4511714">.</span><span class="ident" id="4511715">IsFloat</span>&nbsp;<span class="op" id="4511723">=</span>&nbsp;<span class="ident" id="4511725">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511733">n</span><span class="op" id="4511734">.</span><span class="ident" id="4511735">Float64</span>&nbsp;<span class="op" id="4511743">=</span>&nbsp;<span class="ident" id="4511745">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4511750">//&nbsp;If&nbsp;a&nbsp;floating-point&nbsp;extraction&nbsp;succeeded,&nbsp;extract&nbsp;the&nbsp;int&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511825">if</span>&nbsp;<span class="op" id="4511828">!</span><span class="ident" id="4511829">n</span><span class="op" id="4511830">.</span><span class="ident" id="4511831">IsInt</span>&nbsp;<span class="op" id="4511837">&amp;&amp;</span>&nbsp;<span class="builtintype" id="4511840">float64</span><span class="op" id="4511847">(</span><span class="ident" id="4511848">int64</span><span class="op" id="4511853">(</span><span class="ident" id="4511854">f</span><span class="op" id="4511855">)</span><span class="op" id="4511856">)</span>&nbsp;<span class="op" id="4511858">==</span>&nbsp;<span class="ident" id="4511861">f</span>&nbsp;<span class="op" id="4511863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511869">n</span><span class="op" id="4511870">.</span><span class="ident" id="4511871">IsInt</span>&nbsp;<span class="op" id="4511877">=</span>&nbsp;<span class="ident" id="4511879">true</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511888">n</span><span class="op" id="4511889">.</span><span class="ident" id="4511890">Int64</span>&nbsp;<span class="op" id="4511896">=</span>&nbsp;<span class="ident" id="4511898">int64</span><span class="op" id="4511903">(</span><span class="ident" id="4511904">f</span><span class="op" id="4511905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511915">if</span>&nbsp;<span class="op" id="4511918">!</span><span class="ident" id="4511919">n</span><span class="op" id="4511920">.</span><span class="ident" id="4511921">IsUint</span>&nbsp;<span class="op" id="4511928">&amp;&amp;</span>&nbsp;<span class="builtintype" id="4511931">float64</span><span class="op" id="4511938">(</span><span class="ident" id="4511939">uint64</span><span class="op" id="4511945">(</span><span class="ident" id="4511946">f</span><span class="op" id="4511947">)</span><span class="op" id="4511948">)</span>&nbsp;<span class="op" id="4511950">==</span>&nbsp;<span class="ident" id="4511953">f</span>&nbsp;<span class="op" id="4511955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511961">n</span><span class="op" id="4511962">.</span><span class="ident" id="4511963">IsUint</span>&nbsp;<span class="op" id="4511970">=</span>&nbsp;<span class="ident" id="4511972">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511981">n</span><span class="op" id="4511982">.</span><span class="ident" id="4511983">Uint64</span>&nbsp;<span class="op" id="4511990">=</span>&nbsp;<span class="ident" id="4511992">uint64</span><span class="op" id="4511998">(</span><span class="ident" id="4511999">f</span><span class="op" id="4512000">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4512005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4512009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4512012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4512015">if</span>&nbsp;<span class="op" id="4512018">!</span><span class="ident" id="4512019">n</span><span class="op" id="4512020">.</span><span class="ident" id="4512021">IsInt</span>&nbsp;<span class="op" id="4512027">&amp;&amp;</span>&nbsp;<span class="op" id="4512030">!</span><span class="ident" id="4512031">n</span><span class="op" id="4512032">.</span><span class="ident" id="4512033">IsUint</span>&nbsp;<span class="op" id="4512040">&amp;&amp;</span>&nbsp;<span class="op" id="4512043">!</span><span class="ident" id="4512044">n</span><span class="op" id="4512045">.</span><span class="ident" id="4512046">IsFloat</span>&nbsp;<span class="op" id="4512054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4512058">return</span>&nbsp;<span class="ident" id="4512065">nil</span><span class="op" id="4512068">,</span>&nbsp;<span class="ident" id="4512070">fmt</span><span class="op" id="4512073">.</span><span class="ident" id="4512074">Errorf</span><span class="op" id="4512080">(</span><span class="string" id="4512081">&#34;illegal&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="4512108">,</span>&nbsp;<span class="ident" id="4512110">text</span><span class="op" id="4512114">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4512117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4512120">return</span>&nbsp;<span class="ident" id="4512127">n</span><span class="op" id="4512128">,</span>&nbsp;<span class="ident" id="4512130">nil</span><br>
<span class="lineno"></span><span class="op" id="4512134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4512137">//&nbsp;simplifyComplex&nbsp;pulls&nbsp;out&nbsp;any&nbsp;other&nbsp;types&nbsp;that&nbsp;are&nbsp;represented&nbsp;by&nbsp;the&nbsp;complex&nbsp;number.</span><br>
<span class="lineno">615</span><span class="comment" id="4512226">//&nbsp;These&nbsp;all&nbsp;require&nbsp;that&nbsp;the&nbsp;imaginary&nbsp;part&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="4512280">func</span>&nbsp;<span class="op" id="4512285">(</span><span class="ident" id="4512286">n</span>&nbsp;<span class="op" id="4512288">*</span><span class="ident" id="4512289">NumberNode</span><span class="op" id="4512299">)</span>&nbsp;<span class="ident" id="4512301">simplifyComplex</span><span class="op" id="4512316">(</span><span class="op" id="4512317">)</span>&nbsp;<span class="op" id="4512319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512322">n</span><span class="op" id="4512323">.</span><span class="ident" id="4512324">IsFloat</span>&nbsp;<span class="op" id="4512332">=</span>&nbsp;<span class="builtinfunc" id="4512334">imag</span><span class="op" id="4512338">(</span><span class="ident" id="4512339">n</span><span class="op" id="4512340">.</span><span class="ident" id="4512341">Complex128</span><span class="op" id="4512351">)</span>&nbsp;<span class="op" id="4512353">==</span>&nbsp;<span class="num" id="4512356">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4512359">if</span>&nbsp;<span class="ident" id="4512362">n</span><span class="op" id="4512363">.</span><span class="ident" id="4512364">IsFloat</span>&nbsp;<span class="op" id="4512372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512376">n</span><span class="op" id="4512377">.</span><span class="ident" id="4512378">Float64</span>&nbsp;<span class="op" id="4512386">=</span>&nbsp;<span class="builtinfunc" id="4512388">real</span><span class="op" id="4512392">(</span><span class="ident" id="4512393">n</span><span class="op" id="4512394">.</span><span class="ident" id="4512395">Complex128</span><span class="op" id="4512405">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512409">n</span><span class="op" id="4512410">.</span><span class="ident" id="4512411">IsInt</span>&nbsp;<span class="op" id="4512417">=</span>&nbsp;<span class="builtintype" id="4512419">float64</span><span class="op" id="4512426">(</span><span class="ident" id="4512427">int64</span><span class="op" id="4512432">(</span><span class="ident" id="4512433">n</span><span class="op" id="4512434">.</span><span class="ident" id="4512435">Float64</span><span class="op" id="4512442">)</span><span class="op" id="4512443">)</span>&nbsp;<span class="op" id="4512445">==</span>&nbsp;<span class="ident" id="4512448">n</span><span class="op" id="4512449">.</span><span class="ident" id="4512450">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4512460">if</span>&nbsp;<span class="ident" id="4512463">n</span><span class="op" id="4512464">.</span><span class="ident" id="4512465">IsInt</span>&nbsp;<span class="op" id="4512471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512476">n</span><span class="op" id="4512477">.</span><span class="ident" id="4512478">Int64</span>&nbsp;<span class="op" id="4512484">=</span>&nbsp;<span class="ident" id="4512486">int64</span><span class="op" id="4512491">(</span><span class="ident" id="4512492">n</span><span class="op" id="4512493">.</span><span class="ident" id="4512494">Float64</span><span class="op" id="4512501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4512505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512509">n</span><span class="op" id="4512510">.</span><span class="ident" id="4512511">IsUint</span>&nbsp;<span class="op" id="4512518">=</span>&nbsp;<span class="builtintype" id="4512520">float64</span><span class="op" id="4512527">(</span><span class="ident" id="4512528">uint64</span><span class="op" id="4512534">(</span><span class="ident" id="4512535">n</span><span class="op" id="4512536">.</span><span class="ident" id="4512537">Float64</span><span class="op" id="4512544">)</span><span class="op" id="4512545">)</span>&nbsp;<span class="op" id="4512547">==</span>&nbsp;<span class="ident" id="4512550">n</span><span class="op" id="4512551">.</span><span class="ident" id="4512552">Float64</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4512562">if</span>&nbsp;<span class="ident" id="4512565">n</span><span class="op" id="4512566">.</span><span class="ident" id="4512567">IsUint</span>&nbsp;<span class="op" id="4512574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512579">n</span><span class="op" id="4512580">.</span><span class="ident" id="4512581">Uint64</span>&nbsp;<span class="op" id="4512588">=</span>&nbsp;<span class="ident" id="4512590">uint64</span><span class="op" id="4512596">(</span><span class="ident" id="4512597">n</span><span class="op" id="4512598">.</span><span class="ident" id="4512599">Float64</span><span class="op" id="4512606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4512610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4512613">}</span><br>
<span class="lineno"></span><span class="op" id="4512615">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="4512618">func</span>&nbsp;<span class="op" id="4512623">(</span><span class="ident" id="4512624">n</span>&nbsp;<span class="op" id="4512626">*</span><span class="ident" id="4512627">NumberNode</span><span class="op" id="4512637">)</span>&nbsp;<span class="ident" id="4512639">String</span><span class="op" id="4512645">(</span><span class="op" id="4512646">)</span>&nbsp;<span class="builtintype" id="4512648">string</span>&nbsp;<span class="op" id="4512655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4512658">return</span>&nbsp;<span class="ident" id="4512665">n</span><span class="op" id="4512666">.</span><span class="ident" id="4512667">Text</span><br>
<span class="lineno"></span><span class="op" id="4512672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span><span class="keyword" id="4512675">func</span>&nbsp;<span class="op" id="4512680">(</span><span class="ident" id="4512681">n</span>&nbsp;<span class="op" id="4512683">*</span><span class="ident" id="4512684">NumberNode</span><span class="op" id="4512694">)</span>&nbsp;<span class="ident" id="4512696">tree</span><span class="op" id="4512700">(</span><span class="op" id="4512701">)</span>&nbsp;<span class="op" id="4512703">*</span><span class="ident" id="4512704">Tree</span>&nbsp;<span class="op" id="4512709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4512712">return</span>&nbsp;<span class="ident" id="4512719">n</span><span class="op" id="4512720">.</span><span class="ident" id="4512721">tr</span><br>
<span class="lineno"></span><span class="op" id="4512724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4512727">func</span>&nbsp;<span class="op" id="4512732">(</span><span class="ident" id="4512733">n</span>&nbsp;<span class="op" id="4512735">*</span><span class="ident" id="4512736">NumberNode</span><span class="op" id="4512746">)</span>&nbsp;<span class="ident" id="4512748">Copy</span><span class="op" id="4512752">(</span><span class="op" id="4512753">)</span>&nbsp;<span class="ident" id="4512755">Node</span>&nbsp;<span class="op" id="4512760">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512763">nn</span>&nbsp;<span class="op" id="4512766">:=</span>&nbsp;<span class="builtinfunc" id="4512769">new</span><span class="op" id="4512772">(</span><span class="ident" id="4512773">NumberNode</span><span class="op" id="4512783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4512786">*</span><span class="ident" id="4512787">nn</span>&nbsp;<span class="op" id="4512790">=</span>&nbsp;<span class="op" id="4512792">*</span><span class="ident" id="4512793">n</span>&nbsp;<span class="comment" id="4512795">//&nbsp;Easy,&nbsp;fast,&nbsp;correct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4512820">return</span>&nbsp;<span class="ident" id="4512827">nn</span><br>
<span class="lineno"></span><span class="op" id="4512830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span><span class="comment" id="4512833">//&nbsp;StringNode&nbsp;holds&nbsp;a&nbsp;string&nbsp;constant.&nbsp;The&nbsp;value&nbsp;has&nbsp;been&nbsp;&#34;unquoted&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4512903">type</span>&nbsp;<span class="ident" id="4512908">StringNode</span>&nbsp;<span class="keyword" id="4512919">struct</span>&nbsp;<span class="op" id="4512926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512929">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512939">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512944">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4512951">*</span><span class="ident" id="4512952">Tree</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512958">Quoted</span>&nbsp;<span class="builtintype" id="4512965">string</span>&nbsp;<span class="comment" id="4512972">//&nbsp;The&nbsp;original&nbsp;text&nbsp;of&nbsp;the&nbsp;string,&nbsp;with&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4513022">Text</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4513029">string</span>&nbsp;<span class="comment" id="4513036">//&nbsp;The&nbsp;string,&nbsp;after&nbsp;quote&nbsp;processing.</span><br>
<span class="lineno"></span><span class="op" id="4513075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4513078">func</span>&nbsp;<span class="op" id="4513083">(</span><span class="ident" id="4513084">t</span>&nbsp;<span class="op" id="4513086">*</span><span class="ident" id="4513087">Tree</span><span class="op" id="4513091">)</span>&nbsp;<span class="ident" id="4513093">newString</span><span class="op" id="4513102">(</span><span class="ident" id="4513103">pos</span>&nbsp;<span class="ident" id="4513107">Pos</span><span class="op" id="4513110">,</span>&nbsp;<span class="ident" id="4513112">orig</span><span class="op" id="4513116">,</span>&nbsp;<span class="ident" id="4513118">text</span>&nbsp;<span class="builtintype" id="4513123">string</span><span class="op" id="4513129">)</span>&nbsp;<span class="op" id="4513131">*</span><span class="ident" id="4513132">StringNode</span>&nbsp;<span class="op" id="4513143">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4513146">return</span>&nbsp;<span class="op" id="4513153">&amp;</span><span class="ident" id="4513154">StringNode</span><span class="op" id="4513164">{</span><span class="ident" id="4513165">tr</span><span class="op" id="4513167">:</span>&nbsp;<span class="ident" id="4513169">t</span><span class="op" id="4513170">,</span>&nbsp;<span class="ident" id="4513172">NodeType</span><span class="op" id="4513180">:</span>&nbsp;<span class="ident" id="4513182">NodeString</span><span class="op" id="4513192">,</span>&nbsp;<span class="ident" id="4513194">Pos</span><span class="op" id="4513197">:</span>&nbsp;<span class="ident" id="4513199">pos</span><span class="op" id="4513202">,</span>&nbsp;<span class="ident" id="4513204">Quoted</span><span class="op" id="4513210">:</span>&nbsp;<span class="ident" id="4513212">orig</span><span class="op" id="4513216">,</span>&nbsp;<span class="ident" id="4513218">Text</span><span class="op" id="4513222">:</span>&nbsp;<span class="ident" id="4513224">text</span><span class="op" id="4513228">}</span><br>
<span class="lineno"></span><span class="op" id="4513230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4513233">func</span>&nbsp;<span class="op" id="4513238">(</span><span class="ident" id="4513239">s</span>&nbsp;<span class="op" id="4513241">*</span><span class="ident" id="4513242">StringNode</span><span class="op" id="4513252">)</span>&nbsp;<span class="ident" id="4513254">String</span><span class="op" id="4513260">(</span><span class="op" id="4513261">)</span>&nbsp;<span class="builtintype" id="4513263">string</span>&nbsp;<span class="op" id="4513270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4513273">return</span>&nbsp;<span class="ident" id="4513280">s</span><span class="op" id="4513281">.</span><span class="ident" id="4513282">Quoted</span><br>
<span class="lineno">660</span><span class="op" id="4513289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4513292">func</span>&nbsp;<span class="op" id="4513297">(</span><span class="ident" id="4513298">s</span>&nbsp;<span class="op" id="4513300">*</span><span class="ident" id="4513301">StringNode</span><span class="op" id="4513311">)</span>&nbsp;<span class="ident" id="4513313">tree</span><span class="op" id="4513317">(</span><span class="op" id="4513318">)</span>&nbsp;<span class="op" id="4513320">*</span><span class="ident" id="4513321">Tree</span>&nbsp;<span class="op" id="4513326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4513329">return</span>&nbsp;<span class="ident" id="4513336">s</span><span class="op" id="4513337">.</span><span class="ident" id="4513338">tr</span><br>
<span class="lineno"></span><span class="op" id="4513341">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="keyword" id="4513344">func</span>&nbsp;<span class="op" id="4513349">(</span><span class="ident" id="4513350">s</span>&nbsp;<span class="op" id="4513352">*</span><span class="ident" id="4513353">StringNode</span><span class="op" id="4513363">)</span>&nbsp;<span class="ident" id="4513365">Copy</span><span class="op" id="4513369">(</span><span class="op" id="4513370">)</span>&nbsp;<span class="ident" id="4513372">Node</span>&nbsp;<span class="op" id="4513377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4513380">return</span>&nbsp;<span class="ident" id="4513387">s</span><span class="op" id="4513388">.</span><span class="ident" id="4513389">tr</span><span class="op" id="4513391">.</span><span class="ident" id="4513392">newString</span><span class="op" id="4513401">(</span><span class="ident" id="4513402">s</span><span class="op" id="4513403">.</span><span class="ident" id="4513404">Pos</span><span class="op" id="4513407">,</span>&nbsp;<span class="ident" id="4513409">s</span><span class="op" id="4513410">.</span><span class="ident" id="4513411">Quoted</span><span class="op" id="4513417">,</span>&nbsp;<span class="ident" id="4513419">s</span><span class="op" id="4513420">.</span><span class="ident" id="4513421">Text</span><span class="op" id="4513425">)</span><br>
<span class="lineno"></span><span class="op" id="4513427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="4513430">//&nbsp;endNode&nbsp;represents&nbsp;an&nbsp;{{end}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="comment" id="4513471">//&nbsp;It&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span><span class="keyword" id="4513518">type</span>&nbsp;<span class="ident" id="4513523">endNode</span>&nbsp;<span class="keyword" id="4513531">struct</span>&nbsp;<span class="op" id="4513538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4513541">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4513551">Pos</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4513556">tr</span>&nbsp;<span class="op" id="4513559">*</span><span class="ident" id="4513560">Tree</span><br>
<span class="lineno"></span><span class="op" id="4513565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4513568">func</span>&nbsp;<span class="op" id="4513573">(</span><span class="ident" id="4513574">t</span>&nbsp;<span class="op" id="4513576">*</span><span class="ident" id="4513577">Tree</span><span class="op" id="4513581">)</span>&nbsp;<span class="ident" id="4513583">newEnd</span><span class="op" id="4513589">(</span><span class="ident" id="4513590">pos</span>&nbsp;<span class="ident" id="4513594">Pos</span><span class="op" id="4513597">)</span>&nbsp;<span class="op" id="4513599">*</span><span class="ident" id="4513600">endNode</span>&nbsp;<span class="op" id="4513608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4513611">return</span>&nbsp;<span class="op" id="4513618">&amp;</span><span class="ident" id="4513619">endNode</span><span class="op" id="4513626">{</span><span class="ident" id="4513627">tr</span><span class="op" id="4513629">:</span>&nbsp;<span class="ident" id="4513631">t</span><span class="op" id="4513632">,</span>&nbsp;<span class="ident" id="4513634">NodeType</span><span class="op" id="4513642">:</span>&nbsp;<span class="ident" id="4513644">nodeEnd</span><span class="op" id="4513651">,</span>&nbsp;<span class="ident" id="4513653">Pos</span><span class="op" id="4513656">:</span>&nbsp;<span class="ident" id="4513658">pos</span><span class="op" id="4513661">}</span><br>
<span class="lineno">680</span><span class="op" id="4513663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4513666">func</span>&nbsp;<span class="op" id="4513671">(</span><span class="ident" id="4513672">e</span>&nbsp;<span class="op" id="4513674">*</span><span class="ident" id="4513675">endNode</span><span class="op" id="4513682">)</span>&nbsp;<span class="ident" id="4513684">String</span><span class="op" id="4513690">(</span><span class="op" id="4513691">)</span>&nbsp;<span class="builtintype" id="4513693">string</span>&nbsp;<span class="op" id="4513700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4513703">return</span>&nbsp;<span class="string" id="4513710">&#34;{{end}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="4513720">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="4513723">func</span>&nbsp;<span class="op" id="4513728">(</span><span class="ident" id="4513729">e</span>&nbsp;<span class="op" id="4513731">*</span><span class="ident" id="4513732">endNode</span><span class="op" id="4513739">)</span>&nbsp;<span class="ident" id="4513741">tree</span><span class="op" id="4513745">(</span><span class="op" id="4513746">)</span>&nbsp;<span class="op" id="4513748">*</span><span class="ident" id="4513749">Tree</span>&nbsp;<span class="op" id="4513754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4513757">return</span>&nbsp;<span class="ident" id="4513764">e</span><span class="op" id="4513765">.</span><span class="ident" id="4513766">tr</span><br>
<span class="lineno"></span><span class="op" id="4513769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="4513772">func</span>&nbsp;<span class="op" id="4513777">(</span><span class="ident" id="4513778">e</span>&nbsp;<span class="op" id="4513780">*</span><span class="ident" id="4513781">endNode</span><span class="op" id="4513788">)</span>&nbsp;<span class="ident" id="4513790">Copy</span><span class="op" id="4513794">(</span><span class="op" id="4513795">)</span>&nbsp;<span class="ident" id="4513797">Node</span>&nbsp;<span class="op" id="4513802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4513805">return</span>&nbsp;<span class="ident" id="4513812">e</span><span class="op" id="4513813">.</span><span class="ident" id="4513814">tr</span><span class="op" id="4513816">.</span><span class="ident" id="4513817">newEnd</span><span class="op" id="4513823">(</span><span class="ident" id="4513824">e</span><span class="op" id="4513825">.</span><span class="ident" id="4513826">Pos</span><span class="op" id="4513829">)</span><br>
<span class="lineno"></span><span class="op" id="4513831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4513834">//&nbsp;elseNode&nbsp;represents&nbsp;an&nbsp;{{else}}&nbsp;action.&nbsp;Does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;tree.</span><br>
<span class="lineno">695</span><span class="keyword" id="4513912">type</span>&nbsp;<span class="ident" id="4513917">elseNode</span>&nbsp;<span class="keyword" id="4513926">struct</span>&nbsp;<span class="op" id="4513933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4513936">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4513946">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4513951">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4513956">*</span><span class="ident" id="4513957">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4513963">Line</span>&nbsp;<span class="builtintype" id="4513968">int</span>&nbsp;<span class="comment" id="4513972">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno">700</span><span class="op" id="4514041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4514044">func</span>&nbsp;<span class="op" id="4514049">(</span><span class="ident" id="4514050">t</span>&nbsp;<span class="op" id="4514052">*</span><span class="ident" id="4514053">Tree</span><span class="op" id="4514057">)</span>&nbsp;<span class="ident" id="4514059">newElse</span><span class="op" id="4514066">(</span><span class="ident" id="4514067">pos</span>&nbsp;<span class="ident" id="4514071">Pos</span><span class="op" id="4514074">,</span>&nbsp;<span class="ident" id="4514076">line</span>&nbsp;<span class="builtintype" id="4514081">int</span><span class="op" id="4514084">)</span>&nbsp;<span class="op" id="4514086">*</span><span class="ident" id="4514087">elseNode</span>&nbsp;<span class="op" id="4514096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514099">return</span>&nbsp;<span class="op" id="4514106">&amp;</span><span class="ident" id="4514107">elseNode</span><span class="op" id="4514115">{</span><span class="ident" id="4514116">tr</span><span class="op" id="4514118">:</span>&nbsp;<span class="ident" id="4514120">t</span><span class="op" id="4514121">,</span>&nbsp;<span class="ident" id="4514123">NodeType</span><span class="op" id="4514131">:</span>&nbsp;<span class="ident" id="4514133">nodeElse</span><span class="op" id="4514141">,</span>&nbsp;<span class="ident" id="4514143">Pos</span><span class="op" id="4514146">:</span>&nbsp;<span class="ident" id="4514148">pos</span><span class="op" id="4514151">,</span>&nbsp;<span class="ident" id="4514153">Line</span><span class="op" id="4514157">:</span>&nbsp;<span class="ident" id="4514159">line</span><span class="op" id="4514163">}</span><br>
<span class="lineno"></span><span class="op" id="4514165">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="4514168">func</span>&nbsp;<span class="op" id="4514173">(</span><span class="ident" id="4514174">e</span>&nbsp;<span class="op" id="4514176">*</span><span class="ident" id="4514177">elseNode</span><span class="op" id="4514185">)</span>&nbsp;<span class="ident" id="4514187">Type</span><span class="op" id="4514191">(</span><span class="op" id="4514192">)</span>&nbsp;<span class="ident" id="4514194">NodeType</span>&nbsp;<span class="op" id="4514203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514206">return</span>&nbsp;<span class="ident" id="4514213">nodeElse</span><br>
<span class="lineno"></span><span class="op" id="4514222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="4514225">func</span>&nbsp;<span class="op" id="4514230">(</span><span class="ident" id="4514231">e</span>&nbsp;<span class="op" id="4514233">*</span><span class="ident" id="4514234">elseNode</span><span class="op" id="4514242">)</span>&nbsp;<span class="ident" id="4514244">String</span><span class="op" id="4514250">(</span><span class="op" id="4514251">)</span>&nbsp;<span class="builtintype" id="4514253">string</span>&nbsp;<span class="op" id="4514260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514263">return</span>&nbsp;<span class="string" id="4514270">&#34;{{else}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="4514281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4514284">func</span>&nbsp;<span class="op" id="4514289">(</span><span class="ident" id="4514290">e</span>&nbsp;<span class="op" id="4514292">*</span><span class="ident" id="4514293">elseNode</span><span class="op" id="4514301">)</span>&nbsp;<span class="ident" id="4514303">tree</span><span class="op" id="4514307">(</span><span class="op" id="4514308">)</span>&nbsp;<span class="op" id="4514310">*</span><span class="ident" id="4514311">Tree</span>&nbsp;<span class="op" id="4514316">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514319">return</span>&nbsp;<span class="ident" id="4514326">e</span><span class="op" id="4514327">.</span><span class="ident" id="4514328">tr</span><br>
<span class="lineno"></span><span class="op" id="4514331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4514334">func</span>&nbsp;<span class="op" id="4514339">(</span><span class="ident" id="4514340">e</span>&nbsp;<span class="op" id="4514342">*</span><span class="ident" id="4514343">elseNode</span><span class="op" id="4514351">)</span>&nbsp;<span class="ident" id="4514353">Copy</span><span class="op" id="4514357">(</span><span class="op" id="4514358">)</span>&nbsp;<span class="ident" id="4514360">Node</span>&nbsp;<span class="op" id="4514365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514368">return</span>&nbsp;<span class="ident" id="4514375">e</span><span class="op" id="4514376">.</span><span class="ident" id="4514377">tr</span><span class="op" id="4514379">.</span><span class="ident" id="4514380">newElse</span><span class="op" id="4514387">(</span><span class="ident" id="4514388">e</span><span class="op" id="4514389">.</span><span class="ident" id="4514390">Pos</span><span class="op" id="4514393">,</span>&nbsp;<span class="ident" id="4514395">e</span><span class="op" id="4514396">.</span><span class="ident" id="4514397">Line</span><span class="op" id="4514401">)</span><br>
<span class="lineno">720</span><span class="op" id="4514403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4514406">//&nbsp;BranchNode&nbsp;is&nbsp;the&nbsp;common&nbsp;representation&nbsp;of&nbsp;if,&nbsp;range,&nbsp;and&nbsp;with.</span><br>
<span class="lineno"></span><span class="keyword" id="4514473">type</span>&nbsp;<span class="ident" id="4514478">BranchNode</span>&nbsp;<span class="keyword" id="4514489">struct</span>&nbsp;<span class="op" id="4514496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514499">NodeType</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514509">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514514">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514523">*</span><span class="ident" id="4514524">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514530">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4514539">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4514549">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514619">Pipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514628">*</span><span class="ident" id="4514629">PipeNode</span>&nbsp;<span class="comment" id="4514638">//&nbsp;The&nbsp;pipeline&nbsp;to&nbsp;be&nbsp;evaluated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514672">List</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514681">*</span><span class="ident" id="4514682">ListNode</span>&nbsp;<span class="comment" id="4514691">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;non-empty.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514738">ElseList</span>&nbsp;<span class="op" id="4514747">*</span><span class="ident" id="4514748">ListNode</span>&nbsp;<span class="comment" id="4514757">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;empty&nbsp;(nil&nbsp;if&nbsp;absent).</span><br>
<span class="lineno"></span><span class="op" id="4514815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4514818">func</span>&nbsp;<span class="op" id="4514823">(</span><span class="ident" id="4514824">b</span>&nbsp;<span class="op" id="4514826">*</span><span class="ident" id="4514827">BranchNode</span><span class="op" id="4514837">)</span>&nbsp;<span class="ident" id="4514839">String</span><span class="op" id="4514845">(</span><span class="op" id="4514846">)</span>&nbsp;<span class="builtintype" id="4514848">string</span>&nbsp;<span class="op" id="4514855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514858">name</span>&nbsp;<span class="op" id="4514863">:=</span>&nbsp;<span class="string" id="4514866">&#34;&#34;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514870">switch</span>&nbsp;<span class="ident" id="4514877">b</span><span class="op" id="4514878">.</span><span class="ident" id="4514879">NodeType</span>&nbsp;<span class="op" id="4514888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514891">case</span>&nbsp;<span class="ident" id="4514896">NodeIf</span><span class="op" id="4514902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514906">name</span>&nbsp;<span class="op" id="4514911">=</span>&nbsp;<span class="string" id="4514913">&#34;if&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514919">case</span>&nbsp;<span class="ident" id="4514924">NodeRange</span><span class="op" id="4514933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514937">name</span>&nbsp;<span class="op" id="4514942">=</span>&nbsp;<span class="string" id="4514944">&#34;range&#34;</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514953">case</span>&nbsp;<span class="ident" id="4514958">NodeWith</span><span class="op" id="4514966">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514970">name</span>&nbsp;<span class="op" id="4514975">=</span>&nbsp;<span class="string" id="4514977">&#34;with&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514985">default</span><span class="op" id="4514992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4514996">panic</span><span class="op" id="4515001">(</span><span class="string" id="4515002">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="4515023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515026">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515029">if</span>&nbsp;<span class="ident" id="4515032">b</span><span class="op" id="4515033">.</span><span class="ident" id="4515034">ElseList</span>&nbsp;<span class="op" id="4515043">!=</span>&nbsp;<span class="ident" id="4515046">nil</span>&nbsp;<span class="op" id="4515050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515054">return</span>&nbsp;<span class="ident" id="4515061">fmt</span><span class="op" id="4515064">.</span><span class="ident" id="4515065">Sprintf</span><span class="op" id="4515072">(</span><span class="string" id="4515073">&#34;{{%s&nbsp;%s}}%s{{else}}%s{{end}}&#34;</span><span class="op" id="4515103">,</span>&nbsp;<span class="ident" id="4515105">name</span><span class="op" id="4515109">,</span>&nbsp;<span class="ident" id="4515111">b</span><span class="op" id="4515112">.</span><span class="ident" id="4515113">Pipe</span><span class="op" id="4515117">,</span>&nbsp;<span class="ident" id="4515119">b</span><span class="op" id="4515120">.</span><span class="ident" id="4515121">List</span><span class="op" id="4515125">,</span>&nbsp;<span class="ident" id="4515127">b</span><span class="op" id="4515128">.</span><span class="ident" id="4515129">ElseList</span><span class="op" id="4515137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515143">return</span>&nbsp;<span class="ident" id="4515150">fmt</span><span class="op" id="4515153">.</span><span class="ident" id="4515154">Sprintf</span><span class="op" id="4515161">(</span><span class="string" id="4515162">&#34;{{%s&nbsp;%s}}%s{{end}}&#34;</span><span class="op" id="4515182">,</span>&nbsp;<span class="ident" id="4515184">name</span><span class="op" id="4515188">,</span>&nbsp;<span class="ident" id="4515190">b</span><span class="op" id="4515191">.</span><span class="ident" id="4515192">Pipe</span><span class="op" id="4515196">,</span>&nbsp;<span class="ident" id="4515198">b</span><span class="op" id="4515199">.</span><span class="ident" id="4515200">List</span><span class="op" id="4515204">)</span><br>
<span class="lineno"></span><span class="op" id="4515206">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="keyword" id="4515209">func</span>&nbsp;<span class="op" id="4515214">(</span><span class="ident" id="4515215">b</span>&nbsp;<span class="op" id="4515217">*</span><span class="ident" id="4515218">BranchNode</span><span class="op" id="4515228">)</span>&nbsp;<span class="ident" id="4515230">tree</span><span class="op" id="4515234">(</span><span class="op" id="4515235">)</span>&nbsp;<span class="op" id="4515237">*</span><span class="ident" id="4515238">Tree</span>&nbsp;<span class="op" id="4515243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515246">return</span>&nbsp;<span class="ident" id="4515253">b</span><span class="op" id="4515254">.</span><span class="ident" id="4515255">tr</span><br>
<span class="lineno"></span><span class="op" id="4515258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="keyword" id="4515261">func</span>&nbsp;<span class="op" id="4515266">(</span><span class="ident" id="4515267">b</span>&nbsp;<span class="op" id="4515269">*</span><span class="ident" id="4515270">BranchNode</span><span class="op" id="4515280">)</span>&nbsp;<span class="ident" id="4515282">Copy</span><span class="op" id="4515286">(</span><span class="op" id="4515287">)</span>&nbsp;<span class="ident" id="4515289">Node</span>&nbsp;<span class="op" id="4515294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515297">switch</span>&nbsp;<span class="ident" id="4515304">b</span><span class="op" id="4515305">.</span><span class="ident" id="4515306">NodeType</span>&nbsp;<span class="op" id="4515315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515318">case</span>&nbsp;<span class="ident" id="4515323">NodeIf</span><span class="op" id="4515329">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515333">return</span>&nbsp;<span class="ident" id="4515340">b</span><span class="op" id="4515341">.</span><span class="ident" id="4515342">tr</span><span class="op" id="4515344">.</span><span class="ident" id="4515345">newIf</span><span class="op" id="4515350">(</span><span class="ident" id="4515351">b</span><span class="op" id="4515352">.</span><span class="ident" id="4515353">Pos</span><span class="op" id="4515356">,</span>&nbsp;<span class="ident" id="4515358">b</span><span class="op" id="4515359">.</span><span class="ident" id="4515360">Line</span><span class="op" id="4515364">,</span>&nbsp;<span class="ident" id="4515366">b</span><span class="op" id="4515367">.</span><span class="ident" id="4515368">Pipe</span><span class="op" id="4515372">,</span>&nbsp;<span class="ident" id="4515374">b</span><span class="op" id="4515375">.</span><span class="ident" id="4515376">List</span><span class="op" id="4515380">,</span>&nbsp;<span class="ident" id="4515382">b</span><span class="op" id="4515383">.</span><span class="ident" id="4515384">ElseList</span><span class="op" id="4515392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515395">case</span>&nbsp;<span class="ident" id="4515400">NodeRange</span><span class="op" id="4515409">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515413">return</span>&nbsp;<span class="ident" id="4515420">b</span><span class="op" id="4515421">.</span><span class="ident" id="4515422">tr</span><span class="op" id="4515424">.</span><span class="ident" id="4515425">newRange</span><span class="op" id="4515433">(</span><span class="ident" id="4515434">b</span><span class="op" id="4515435">.</span><span class="ident" id="4515436">Pos</span><span class="op" id="4515439">,</span>&nbsp;<span class="ident" id="4515441">b</span><span class="op" id="4515442">.</span><span class="ident" id="4515443">Line</span><span class="op" id="4515447">,</span>&nbsp;<span class="ident" id="4515449">b</span><span class="op" id="4515450">.</span><span class="ident" id="4515451">Pipe</span><span class="op" id="4515455">,</span>&nbsp;<span class="ident" id="4515457">b</span><span class="op" id="4515458">.</span><span class="ident" id="4515459">List</span><span class="op" id="4515463">,</span>&nbsp;<span class="ident" id="4515465">b</span><span class="op" id="4515466">.</span><span class="ident" id="4515467">ElseList</span><span class="op" id="4515475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515478">case</span>&nbsp;<span class="ident" id="4515483">NodeWith</span><span class="op" id="4515491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515495">return</span>&nbsp;<span class="ident" id="4515502">b</span><span class="op" id="4515503">.</span><span class="ident" id="4515504">tr</span><span class="op" id="4515506">.</span><span class="ident" id="4515507">newWith</span><span class="op" id="4515514">(</span><span class="ident" id="4515515">b</span><span class="op" id="4515516">.</span><span class="ident" id="4515517">Pos</span><span class="op" id="4515520">,</span>&nbsp;<span class="ident" id="4515522">b</span><span class="op" id="4515523">.</span><span class="ident" id="4515524">Line</span><span class="op" id="4515528">,</span>&nbsp;<span class="ident" id="4515530">b</span><span class="op" id="4515531">.</span><span class="ident" id="4515532">Pipe</span><span class="op" id="4515536">,</span>&nbsp;<span class="ident" id="4515538">b</span><span class="op" id="4515539">.</span><span class="ident" id="4515540">List</span><span class="op" id="4515544">,</span>&nbsp;<span class="ident" id="4515546">b</span><span class="op" id="4515547">.</span><span class="ident" id="4515548">ElseList</span><span class="op" id="4515556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515559">default</span><span class="op" id="4515566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4515570">panic</span><span class="op" id="4515575">(</span><span class="string" id="4515576">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="4515597">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515600">}</span><br>
<span class="lineno"></span><span class="op" id="4515602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4515605">//&nbsp;IfNode&nbsp;represents&nbsp;an&nbsp;{{if}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="4515661">type</span>&nbsp;<span class="ident" id="4515666">IfNode</span>&nbsp;<span class="keyword" id="4515673">struct</span>&nbsp;<span class="op" id="4515680">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515683">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="4515694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4515697">func</span>&nbsp;<span class="op" id="4515702">(</span><span class="ident" id="4515703">t</span>&nbsp;<span class="op" id="4515705">*</span><span class="ident" id="4515706">Tree</span><span class="op" id="4515710">)</span>&nbsp;<span class="ident" id="4515712">newIf</span><span class="op" id="4515717">(</span><span class="ident" id="4515718">pos</span>&nbsp;<span class="ident" id="4515722">Pos</span><span class="op" id="4515725">,</span>&nbsp;<span class="ident" id="4515727">line</span>&nbsp;<span class="builtintype" id="4515732">int</span><span class="op" id="4515735">,</span>&nbsp;<span class="ident" id="4515737">pipe</span>&nbsp;<span class="op" id="4515742">*</span><span class="ident" id="4515743">PipeNode</span><span class="op" id="4515751">,</span>&nbsp;<span class="ident" id="4515753">list</span><span class="op" id="4515757">,</span>&nbsp;<span class="ident" id="4515759">elseList</span>&nbsp;<span class="op" id="4515768">*</span><span class="ident" id="4515769">ListNode</span><span class="op" id="4515777">)</span>&nbsp;<span class="op" id="4515779">*</span><span class="ident" id="4515780">IfNode</span>&nbsp;<span class="op" id="4515787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515790">return</span>&nbsp;<span class="op" id="4515797">&amp;</span><span class="ident" id="4515798">IfNode</span><span class="op" id="4515804">{</span><span class="ident" id="4515805">BranchNode</span><span class="op" id="4515815">{</span><span class="ident" id="4515816">tr</span><span class="op" id="4515818">:</span>&nbsp;<span class="ident" id="4515820">t</span><span class="op" id="4515821">,</span>&nbsp;<span class="ident" id="4515823">NodeType</span><span class="op" id="4515831">:</span>&nbsp;<span class="ident" id="4515833">NodeIf</span><span class="op" id="4515839">,</span>&nbsp;<span class="ident" id="4515841">Pos</span><span class="op" id="4515844">:</span>&nbsp;<span class="ident" id="4515846">pos</span><span class="op" id="4515849">,</span>&nbsp;<span class="ident" id="4515851">Line</span><span class="op" id="4515855">:</span>&nbsp;<span class="ident" id="4515857">line</span><span class="op" id="4515861">,</span>&nbsp;<span class="ident" id="4515863">Pipe</span><span class="op" id="4515867">:</span>&nbsp;<span class="ident" id="4515869">pipe</span><span class="op" id="4515873">,</span>&nbsp;<span class="ident" id="4515875">List</span><span class="op" id="4515879">:</span>&nbsp;<span class="ident" id="4515881">list</span><span class="op" id="4515885">,</span>&nbsp;<span class="ident" id="4515887">ElseList</span><span class="op" id="4515895">:</span>&nbsp;<span class="ident" id="4515897">elseList</span><span class="op" id="4515905">}</span><span class="op" id="4515906">}</span><br>
<span class="lineno">775</span><span class="op" id="4515908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4515911">func</span>&nbsp;<span class="op" id="4515916">(</span><span class="ident" id="4515917">i</span>&nbsp;<span class="op" id="4515919">*</span><span class="ident" id="4515920">IfNode</span><span class="op" id="4515926">)</span>&nbsp;<span class="ident" id="4515928">Copy</span><span class="op" id="4515932">(</span><span class="op" id="4515933">)</span>&nbsp;<span class="ident" id="4515935">Node</span>&nbsp;<span class="op" id="4515940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515943">return</span>&nbsp;<span class="ident" id="4515950">i</span><span class="op" id="4515951">.</span><span class="ident" id="4515952">tr</span><span class="op" id="4515954">.</span><span class="ident" id="4515955">newIf</span><span class="op" id="4515960">(</span><span class="ident" id="4515961">i</span><span class="op" id="4515962">.</span><span class="ident" id="4515963">Pos</span><span class="op" id="4515966">,</span>&nbsp;<span class="ident" id="4515968">i</span><span class="op" id="4515969">.</span><span class="ident" id="4515970">Line</span><span class="op" id="4515974">,</span>&nbsp;<span class="ident" id="4515976">i</span><span class="op" id="4515977">.</span><span class="ident" id="4515978">Pipe</span><span class="op" id="4515982">.</span><span class="ident" id="4515983">CopyPipe</span><span class="op" id="4515991">(</span><span class="op" id="4515992">)</span><span class="op" id="4515993">,</span>&nbsp;<span class="ident" id="4515995">i</span><span class="op" id="4515996">.</span><span class="ident" id="4515997">List</span><span class="op" id="4516001">.</span><span class="ident" id="4516002">CopyList</span><span class="op" id="4516010">(</span><span class="op" id="4516011">)</span><span class="op" id="4516012">,</span>&nbsp;<span class="ident" id="4516014">i</span><span class="op" id="4516015">.</span><span class="ident" id="4516016">ElseList</span><span class="op" id="4516024">.</span><span class="ident" id="4516025">CopyList</span><span class="op" id="4516033">(</span><span class="op" id="4516034">)</span><span class="op" id="4516035">)</span><br>
<span class="lineno"></span><span class="op" id="4516037">}</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span><span class="comment" id="4516040">//&nbsp;RangeNode&nbsp;represents&nbsp;a&nbsp;{{range}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="4516101">type</span>&nbsp;<span class="ident" id="4516106">RangeNode</span>&nbsp;<span class="keyword" id="4516116">struct</span>&nbsp;<span class="op" id="4516123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516126">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="4516137">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="keyword" id="4516140">func</span>&nbsp;<span class="op" id="4516145">(</span><span class="ident" id="4516146">t</span>&nbsp;<span class="op" id="4516148">*</span><span class="ident" id="4516149">Tree</span><span class="op" id="4516153">)</span>&nbsp;<span class="ident" id="4516155">newRange</span><span class="op" id="4516163">(</span><span class="ident" id="4516164">pos</span>&nbsp;<span class="ident" id="4516168">Pos</span><span class="op" id="4516171">,</span>&nbsp;<span class="ident" id="4516173">line</span>&nbsp;<span class="builtintype" id="4516178">int</span><span class="op" id="4516181">,</span>&nbsp;<span class="ident" id="4516183">pipe</span>&nbsp;<span class="op" id="4516188">*</span><span class="ident" id="4516189">PipeNode</span><span class="op" id="4516197">,</span>&nbsp;<span class="ident" id="4516199">list</span><span class="op" id="4516203">,</span>&nbsp;<span class="ident" id="4516205">elseList</span>&nbsp;<span class="op" id="4516214">*</span><span class="ident" id="4516215">ListNode</span><span class="op" id="4516223">)</span>&nbsp;<span class="op" id="4516225">*</span><span class="ident" id="4516226">RangeNode</span>&nbsp;<span class="op" id="4516236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516239">return</span>&nbsp;<span class="op" id="4516246">&amp;</span><span class="ident" id="4516247">RangeNode</span><span class="op" id="4516256">{</span><span class="ident" id="4516257">BranchNode</span><span class="op" id="4516267">{</span><span class="ident" id="4516268">tr</span><span class="op" id="4516270">:</span>&nbsp;<span class="ident" id="4516272">t</span><span class="op" id="4516273">,</span>&nbsp;<span class="ident" id="4516275">NodeType</span><span class="op" id="4516283">:</span>&nbsp;<span class="ident" id="4516285">NodeRange</span><span class="op" id="4516294">,</span>&nbsp;<span class="ident" id="4516296">Pos</span><span class="op" id="4516299">:</span>&nbsp;<span class="ident" id="4516301">pos</span><span class="op" id="4516304">,</span>&nbsp;<span class="ident" id="4516306">Line</span><span class="op" id="4516310">:</span>&nbsp;<span class="ident" id="4516312">line</span><span class="op" id="4516316">,</span>&nbsp;<span class="ident" id="4516318">Pipe</span><span class="op" id="4516322">:</span>&nbsp;<span class="ident" id="4516324">pipe</span><span class="op" id="4516328">,</span>&nbsp;<span class="ident" id="4516330">List</span><span class="op" id="4516334">:</span>&nbsp;<span class="ident" id="4516336">list</span><span class="op" id="4516340">,</span>&nbsp;<span class="ident" id="4516342">ElseList</span><span class="op" id="4516350">:</span>&nbsp;<span class="ident" id="4516352">elseList</span><span class="op" id="4516360">}</span><span class="op" id="4516361">}</span><br>
<span class="lineno"></span><span class="op" id="4516363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword" id="4516366">func</span>&nbsp;<span class="op" id="4516371">(</span><span class="ident" id="4516372">r</span>&nbsp;<span class="op" id="4516374">*</span><span class="ident" id="4516375">RangeNode</span><span class="op" id="4516384">)</span>&nbsp;<span class="ident" id="4516386">Copy</span><span class="op" id="4516390">(</span><span class="op" id="4516391">)</span>&nbsp;<span class="ident" id="4516393">Node</span>&nbsp;<span class="op" id="4516398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516401">return</span>&nbsp;<span class="ident" id="4516408">r</span><span class="op" id="4516409">.</span><span class="ident" id="4516410">tr</span><span class="op" id="4516412">.</span><span class="ident" id="4516413">newRange</span><span class="op" id="4516421">(</span><span class="ident" id="4516422">r</span><span class="op" id="4516423">.</span><span class="ident" id="4516424">Pos</span><span class="op" id="4516427">,</span>&nbsp;<span class="ident" id="4516429">r</span><span class="op" id="4516430">.</span><span class="ident" id="4516431">Line</span><span class="op" id="4516435">,</span>&nbsp;<span class="ident" id="4516437">r</span><span class="op" id="4516438">.</span><span class="ident" id="4516439">Pipe</span><span class="op" id="4516443">.</span><span class="ident" id="4516444">CopyPipe</span><span class="op" id="4516452">(</span><span class="op" id="4516453">)</span><span class="op" id="4516454">,</span>&nbsp;<span class="ident" id="4516456">r</span><span class="op" id="4516457">.</span><span class="ident" id="4516458">List</span><span class="op" id="4516462">.</span><span class="ident" id="4516463">CopyList</span><span class="op" id="4516471">(</span><span class="op" id="4516472">)</span><span class="op" id="4516473">,</span>&nbsp;<span class="ident" id="4516475">r</span><span class="op" id="4516476">.</span><span class="ident" id="4516477">ElseList</span><span class="op" id="4516485">.</span><span class="ident" id="4516486">CopyList</span><span class="op" id="4516494">(</span><span class="op" id="4516495">)</span><span class="op" id="4516496">)</span><br>
<span class="lineno"></span><span class="op" id="4516498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4516501">//&nbsp;WithNode&nbsp;represents&nbsp;a&nbsp;{{with}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno">795</span><span class="keyword" id="4516560">type</span>&nbsp;<span class="ident" id="4516565">WithNode</span>&nbsp;<span class="keyword" id="4516574">struct</span>&nbsp;<span class="op" id="4516581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516584">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="4516595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4516598">func</span>&nbsp;<span class="op" id="4516603">(</span><span class="ident" id="4516604">t</span>&nbsp;<span class="op" id="4516606">*</span><span class="ident" id="4516607">Tree</span><span class="op" id="4516611">)</span>&nbsp;<span class="ident" id="4516613">newWith</span><span class="op" id="4516620">(</span><span class="ident" id="4516621">pos</span>&nbsp;<span class="ident" id="4516625">Pos</span><span class="op" id="4516628">,</span>&nbsp;<span class="ident" id="4516630">line</span>&nbsp;<span class="builtintype" id="4516635">int</span><span class="op" id="4516638">,</span>&nbsp;<span class="ident" id="4516640">pipe</span>&nbsp;<span class="op" id="4516645">*</span><span class="ident" id="4516646">PipeNode</span><span class="op" id="4516654">,</span>&nbsp;<span class="ident" id="4516656">list</span><span class="op" id="4516660">,</span>&nbsp;<span class="ident" id="4516662">elseList</span>&nbsp;<span class="op" id="4516671">*</span><span class="ident" id="4516672">ListNode</span><span class="op" id="4516680">)</span>&nbsp;<span class="op" id="4516682">*</span><span class="ident" id="4516683">WithNode</span>&nbsp;<span class="op" id="4516692">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516695">return</span>&nbsp;<span class="op" id="4516702">&amp;</span><span class="ident" id="4516703">WithNode</span><span class="op" id="4516711">{</span><span class="ident" id="4516712">BranchNode</span><span class="op" id="4516722">{</span><span class="ident" id="4516723">tr</span><span class="op" id="4516725">:</span>&nbsp;<span class="ident" id="4516727">t</span><span class="op" id="4516728">,</span>&nbsp;<span class="ident" id="4516730">NodeType</span><span class="op" id="4516738">:</span>&nbsp;<span class="ident" id="4516740">NodeWith</span><span class="op" id="4516748">,</span>&nbsp;<span class="ident" id="4516750">Pos</span><span class="op" id="4516753">:</span>&nbsp;<span class="ident" id="4516755">pos</span><span class="op" id="4516758">,</span>&nbsp;<span class="ident" id="4516760">Line</span><span class="op" id="4516764">:</span>&nbsp;<span class="ident" id="4516766">line</span><span class="op" id="4516770">,</span>&nbsp;<span class="ident" id="4516772">Pipe</span><span class="op" id="4516776">:</span>&nbsp;<span class="ident" id="4516778">pipe</span><span class="op" id="4516782">,</span>&nbsp;<span class="ident" id="4516784">List</span><span class="op" id="4516788">:</span>&nbsp;<span class="ident" id="4516790">list</span><span class="op" id="4516794">,</span>&nbsp;<span class="ident" id="4516796">ElseList</span><span class="op" id="4516804">:</span>&nbsp;<span class="ident" id="4516806">elseList</span><span class="op" id="4516814">}</span><span class="op" id="4516815">}</span><br>
<span class="lineno"></span><span class="op" id="4516817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4516820">func</span>&nbsp;<span class="op" id="4516825">(</span><span class="ident" id="4516826">w</span>&nbsp;<span class="op" id="4516828">*</span><span class="ident" id="4516829">WithNode</span><span class="op" id="4516837">)</span>&nbsp;<span class="ident" id="4516839">Copy</span><span class="op" id="4516843">(</span><span class="op" id="4516844">)</span>&nbsp;<span class="ident" id="4516846">Node</span>&nbsp;<span class="op" id="4516851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516854">return</span>&nbsp;<span class="ident" id="4516861">w</span><span class="op" id="4516862">.</span><span class="ident" id="4516863">tr</span><span class="op" id="4516865">.</span><span class="ident" id="4516866">newWith</span><span class="op" id="4516873">(</span><span class="ident" id="4516874">w</span><span class="op" id="4516875">.</span><span class="ident" id="4516876">Pos</span><span class="op" id="4516879">,</span>&nbsp;<span class="ident" id="4516881">w</span><span class="op" id="4516882">.</span><span class="ident" id="4516883">Line</span><span class="op" id="4516887">,</span>&nbsp;<span class="ident" id="4516889">w</span><span class="op" id="4516890">.</span><span class="ident" id="4516891">Pipe</span><span class="op" id="4516895">.</span><span class="ident" id="4516896">CopyPipe</span><span class="op" id="4516904">(</span><span class="op" id="4516905">)</span><span class="op" id="4516906">,</span>&nbsp;<span class="ident" id="4516908">w</span><span class="op" id="4516909">.</span><span class="ident" id="4516910">List</span><span class="op" id="4516914">.</span><span class="ident" id="4516915">CopyList</span><span class="op" id="4516923">(</span><span class="op" id="4516924">)</span><span class="op" id="4516925">,</span>&nbsp;<span class="ident" id="4516927">w</span><span class="op" id="4516928">.</span><span class="ident" id="4516929">ElseList</span><span class="op" id="4516937">.</span><span class="ident" id="4516938">CopyList</span><span class="op" id="4516946">(</span><span class="op" id="4516947">)</span><span class="op" id="4516948">)</span><br>
<span class="lineno">805</span><span class="op" id="4516950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4516953">//&nbsp;TemplateNode&nbsp;represents&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4517003">type</span>&nbsp;<span class="ident" id="4517008">TemplateNode</span>&nbsp;<span class="keyword" id="4517021">struct</span>&nbsp;<span class="op" id="4517028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517031">NodeType</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517041">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517046">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4517051">*</span><span class="ident" id="4517052">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517058">Line</span>&nbsp;<span class="builtintype" id="4517063">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4517073">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517143">Name</span>&nbsp;<span class="builtintype" id="4517148">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4517158">//&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;(unquoted).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517199">Pipe</span>&nbsp;<span class="op" id="4517204">*</span><span class="ident" id="4517205">PipeNode</span>&nbsp;<span class="comment" id="4517214">//&nbsp;The&nbsp;command&nbsp;to&nbsp;evaluate&nbsp;as&nbsp;dot&nbsp;for&nbsp;the&nbsp;template.</span><br>
<span class="lineno">815</span><span class="op" id="4517266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4517269">func</span>&nbsp;<span class="op" id="4517274">(</span><span class="ident" id="4517275">t</span>&nbsp;<span class="op" id="4517277">*</span><span class="ident" id="4517278">Tree</span><span class="op" id="4517282">)</span>&nbsp;<span class="ident" id="4517284">newTemplate</span><span class="op" id="4517295">(</span><span class="ident" id="4517296">pos</span>&nbsp;<span class="ident" id="4517300">Pos</span><span class="op" id="4517303">,</span>&nbsp;<span class="ident" id="4517305">line</span>&nbsp;<span class="builtintype" id="4517310">int</span><span class="op" id="4517313">,</span>&nbsp;<span class="ident" id="4517315">name</span>&nbsp;<span class="builtintype" id="4517320">string</span><span class="op" id="4517326">,</span>&nbsp;<span class="ident" id="4517328">pipe</span>&nbsp;<span class="op" id="4517333">*</span><span class="ident" id="4517334">PipeNode</span><span class="op" id="4517342">)</span>&nbsp;<span class="op" id="4517344">*</span><span class="ident" id="4517345">TemplateNode</span>&nbsp;<span class="op" id="4517358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517361">return</span>&nbsp;<span class="op" id="4517368">&amp;</span><span class="ident" id="4517369">TemplateNode</span><span class="op" id="4517381">{</span><span class="ident" id="4517382">tr</span><span class="op" id="4517384">:</span>&nbsp;<span class="ident" id="4517386">t</span><span class="op" id="4517387">,</span>&nbsp;<span class="ident" id="4517389">NodeType</span><span class="op" id="4517397">:</span>&nbsp;<span class="ident" id="4517399">NodeTemplate</span><span class="op" id="4517411">,</span>&nbsp;<span class="ident" id="4517413">Pos</span><span class="op" id="4517416">:</span>&nbsp;<span class="ident" id="4517418">pos</span><span class="op" id="4517421">,</span>&nbsp;<span class="ident" id="4517423">Line</span><span class="op" id="4517427">:</span>&nbsp;<span class="ident" id="4517429">line</span><span class="op" id="4517433">,</span>&nbsp;<span class="ident" id="4517435">Name</span><span class="op" id="4517439">:</span>&nbsp;<span class="ident" id="4517441">name</span><span class="op" id="4517445">,</span>&nbsp;<span class="ident" id="4517447">Pipe</span><span class="op" id="4517451">:</span>&nbsp;<span class="ident" id="4517453">pipe</span><span class="op" id="4517457">}</span><br>
<span class="lineno"></span><span class="op" id="4517459">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="keyword" id="4517462">func</span>&nbsp;<span class="op" id="4517467">(</span><span class="ident" id="4517468">t</span>&nbsp;<span class="op" id="4517470">*</span><span class="ident" id="4517471">TemplateNode</span><span class="op" id="4517483">)</span>&nbsp;<span class="ident" id="4517485">String</span><span class="op" id="4517491">(</span><span class="op" id="4517492">)</span>&nbsp;<span class="builtintype" id="4517494">string</span>&nbsp;<span class="op" id="4517501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517504">if</span>&nbsp;<span class="ident" id="4517507">t</span><span class="op" id="4517508">.</span><span class="ident" id="4517509">Pipe</span>&nbsp;<span class="op" id="4517514">==</span>&nbsp;<span class="ident" id="4517517">nil</span>&nbsp;<span class="op" id="4517521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517525">return</span>&nbsp;<span class="ident" id="4517532">fmt</span><span class="op" id="4517535">.</span><span class="ident" id="4517536">Sprintf</span><span class="op" id="4517543">(</span><span class="string" id="4517544">&#34;{{template&nbsp;%q}}&#34;</span><span class="op" id="4517561">,</span>&nbsp;<span class="ident" id="4517563">t</span><span class="op" id="4517564">.</span><span class="ident" id="4517565">Name</span><span class="op" id="4517569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517572">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517575">return</span>&nbsp;<span class="ident" id="4517582">fmt</span><span class="op" id="4517585">.</span><span class="ident" id="4517586">Sprintf</span><span class="op" id="4517593">(</span><span class="string" id="4517594">&#34;{{template&nbsp;%q&nbsp;%s}}&#34;</span><span class="op" id="4517614">,</span>&nbsp;<span class="ident" id="4517616">t</span><span class="op" id="4517617">.</span><span class="ident" id="4517618">Name</span><span class="op" id="4517622">,</span>&nbsp;<span class="ident" id="4517624">t</span><span class="op" id="4517625">.</span><span class="ident" id="4517626">Pipe</span><span class="op" id="4517630">)</span><br>
<span class="lineno"></span><span class="op" id="4517632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4517635">func</span>&nbsp;<span class="op" id="4517640">(</span><span class="ident" id="4517641">t</span>&nbsp;<span class="op" id="4517643">*</span><span class="ident" id="4517644">TemplateNode</span><span class="op" id="4517656">)</span>&nbsp;<span class="ident" id="4517658">tree</span><span class="op" id="4517662">(</span><span class="op" id="4517663">)</span>&nbsp;<span class="op" id="4517665">*</span><span class="ident" id="4517666">Tree</span>&nbsp;<span class="op" id="4517671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517674">return</span>&nbsp;<span class="ident" id="4517681">t</span><span class="op" id="4517682">.</span><span class="ident" id="4517683">tr</span><br>
<span class="lineno">830</span><span class="op" id="4517686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4517689">func</span>&nbsp;<span class="op" id="4517694">(</span><span class="ident" id="4517695">t</span>&nbsp;<span class="op" id="4517697">*</span><span class="ident" id="4517698">TemplateNode</span><span class="op" id="4517710">)</span>&nbsp;<span class="ident" id="4517712">Copy</span><span class="op" id="4517716">(</span><span class="op" id="4517717">)</span>&nbsp;<span class="ident" id="4517719">Node</span>&nbsp;<span class="op" id="4517724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517727">return</span>&nbsp;<span class="ident" id="4517734">t</span><span class="op" id="4517735">.</span><span class="ident" id="4517736">tr</span><span class="op" id="4517738">.</span><span class="ident" id="4517739">newTemplate</span><span class="op" id="4517750">(</span><span class="ident" id="4517751">t</span><span class="op" id="4517752">.</span><span class="ident" id="4517753">Pos</span><span class="op" id="4517756">,</span>&nbsp;<span class="ident" id="4517758">t</span><span class="op" id="4517759">.</span><span class="ident" id="4517760">Line</span><span class="op" id="4517764">,</span>&nbsp;<span class="ident" id="4517766">t</span><span class="op" id="4517767">.</span><span class="ident" id="4517768">Name</span><span class="op" id="4517772">,</span>&nbsp;<span class="ident" id="4517774">t</span><span class="op" id="4517775">.</span><span class="ident" id="4517776">Pipe</span><span class="op" id="4517780">.</span><span class="ident" id="4517781">CopyPipe</span><span class="op" id="4517789">(</span><span class="op" id="4517790">)</span><span class="op" id="4517791">)</span><br>
<span class="lineno"></span><span class="op" id="4517793">}</span>
</div>
</body>
</html>
