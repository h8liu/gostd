<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5814147">package</span>&nbsp;<span class="ident" id="5814155">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5814161">import</span>&nbsp;<span class="op" id="5814168">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814171">&#34;strconv&#34;</span><br>
<span class="lineno">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814183">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5814205">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5814208">var</span>&nbsp;<span class="op" id="5814212">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5814215">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814236">opShiftMap</span>&nbsp;<span class="op" id="5814247">=</span>&nbsp;<span class="keyword" id="5814249">map</span><span class="op" id="5814252">[</span><span class="builtintype" id="5814253">string</span><span class="op" id="5814259">]</span><span class="builtintype" id="5814260">uint32</span><span class="op" id="5814266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814270">&#34;sll&#34;</span><span class="op" id="5814275">:</span>&nbsp;<span class="num" id="5814277">0</span><span class="op" id="5814278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814282">&#34;srl&#34;</span><span class="op" id="5814287">:</span>&nbsp;<span class="num" id="5814289">1</span><span class="op" id="5814290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814294">&#34;sra&#34;</span><span class="op" id="5814299">:</span>&nbsp;<span class="num" id="5814301">2</span><span class="op" id="5814302">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5814305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5814309">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814328">opReg3Map</span>&nbsp;<span class="op" id="5814338">=</span>&nbsp;<span class="keyword" id="5814340">map</span><span class="op" id="5814343">[</span><span class="builtintype" id="5814344">string</span><span class="op" id="5814350">]</span><span class="builtintype" id="5814351">uint32</span><span class="op" id="5814357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814361">&#34;sllv&#34;</span><span class="op" id="5814367">:</span>&nbsp;<span class="num" id="5814369">3</span><span class="op" id="5814370">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814374">&#34;srlv&#34;</span><span class="op" id="5814380">:</span>&nbsp;<span class="num" id="5814382">4</span><span class="op" id="5814383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814387">&#34;srla&#34;</span><span class="op" id="5814393">:</span>&nbsp;<span class="num" id="5814395">5</span><span class="op" id="5814396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814400">&#34;add&#34;</span><span class="op" id="5814405">:</span>&nbsp;&nbsp;<span class="num" id="5814408">6</span><span class="op" id="5814409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814413">&#34;sub&#34;</span><span class="op" id="5814418">:</span>&nbsp;&nbsp;<span class="num" id="5814421">7</span><span class="op" id="5814422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814426">&#34;and&#34;</span><span class="op" id="5814431">:</span>&nbsp;&nbsp;<span class="num" id="5814434">8</span><span class="op" id="5814435">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814439">&#34;or&#34;</span><span class="op" id="5814443">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="5814447">9</span><span class="op" id="5814448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814452">&#34;xor&#34;</span><span class="op" id="5814457">:</span>&nbsp;&nbsp;<span class="num" id="5814460">10</span><span class="op" id="5814462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814466">&#34;nor&#34;</span><span class="op" id="5814471">:</span>&nbsp;&nbsp;<span class="num" id="5814474">11</span><span class="op" id="5814476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814480">&#34;slt&#34;</span><span class="op" id="5814485">:</span>&nbsp;&nbsp;<span class="num" id="5814488">12</span><span class="op" id="5814490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814494">&#34;sltu&#34;</span><span class="op" id="5814500">:</span>&nbsp;<span class="num" id="5814502">13</span><span class="op" id="5814504">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814508">&#34;mul&#34;</span><span class="op" id="5814513">:</span>&nbsp;&nbsp;<span class="num" id="5814516">14</span><span class="op" id="5814518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814522">&#34;mulu&#34;</span><span class="op" id="5814528">:</span>&nbsp;<span class="num" id="5814530">15</span><span class="op" id="5814532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814536">&#34;div&#34;</span><span class="op" id="5814541">:</span>&nbsp;&nbsp;<span class="num" id="5814544">16</span><span class="op" id="5814546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814550">&#34;divu&#34;</span><span class="op" id="5814556">:</span>&nbsp;<span class="num" id="5814558">17</span><span class="op" id="5814560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814564">&#34;mod&#34;</span><span class="op" id="5814569">:</span>&nbsp;&nbsp;<span class="num" id="5814572">18</span><span class="op" id="5814574">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814578">&#34;modu&#34;</span><span class="op" id="5814584">:</span>&nbsp;<span class="num" id="5814586">19</span><span class="op" id="5814588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5814591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5814595">//&nbsp;op&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814610">opReg2Map</span>&nbsp;<span class="op" id="5814620">=</span>&nbsp;<span class="keyword" id="5814622">map</span><span class="op" id="5814625">[</span><span class="builtintype" id="5814626">string</span><span class="op" id="5814632">]</span><span class="builtintype" id="5814633">uint32</span><span class="op" id="5814639">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814643">&#34;mov&#34;</span><span class="op" id="5814648">:</span>&nbsp;<span class="num" id="5814650">0</span><span class="op" id="5814651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5814654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5814658">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814677">opFloatMap</span>&nbsp;<span class="op" id="5814688">=</span>&nbsp;<span class="keyword" id="5814690">map</span><span class="op" id="5814693">[</span><span class="builtintype" id="5814694">string</span><span class="op" id="5814700">]</span><span class="builtintype" id="5814701">uint32</span><span class="op" id="5814707">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814711">&#34;fadd&#34;</span><span class="op" id="5814717">:</span>&nbsp;<span class="num" id="5814719">0</span><span class="op" id="5814720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814724">&#34;fsub&#34;</span><span class="op" id="5814730">:</span>&nbsp;<span class="num" id="5814732">1</span><span class="op" id="5814733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814737">&#34;fmul&#34;</span><span class="op" id="5814743">:</span>&nbsp;<span class="num" id="5814745">2</span><span class="op" id="5814746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814750">&#34;fdiv&#34;</span><span class="op" id="5814756">:</span>&nbsp;<span class="num" id="5814758">3</span><span class="op" id="5814759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5814763">&#34;fint&#34;</span><span class="op" id="5814769">:</span>&nbsp;<span class="num" id="5814771">4</span><span class="op" id="5814772">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5814775">}</span><br>
<span class="lineno"></span><span class="op" id="5814777">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5814780">func</span>&nbsp;<span class="ident" id="5814785">parseShift</span><span class="op" id="5814795">(</span><span class="ident" id="5814796">p</span>&nbsp;<span class="op" id="5814798">*</span><span class="ident" id="5814799">parser</span><span class="op" id="5814805">,</span>&nbsp;<span class="ident" id="5814807">op</span>&nbsp;<span class="op" id="5814810">*</span><span class="ident" id="5814811">lex8</span><span class="op" id="5814815">.</span><span class="ident" id="5814816">Token</span><span class="op" id="5814821">)</span>&nbsp;<span class="builtintype" id="5814823">uint32</span>&nbsp;<span class="op" id="5814830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814833">ret</span><span class="op" id="5814836">,</span>&nbsp;<span class="ident" id="5814838">e</span>&nbsp;<span class="op" id="5814840">:=</span>&nbsp;<span class="ident" id="5814843">strconv</span><span class="op" id="5814850">.</span><span class="ident" id="5814851">ParseUint</span><span class="op" id="5814860">(</span><span class="ident" id="5814861">op</span><span class="op" id="5814863">.</span><span class="ident" id="5814864">Lit</span><span class="op" id="5814867">,</span>&nbsp;<span class="num" id="5814869">0</span><span class="op" id="5814870">,</span>&nbsp;<span class="num" id="5814872">32</span><span class="op" id="5814874">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5814877">if</span>&nbsp;<span class="ident" id="5814880">e</span>&nbsp;<span class="op" id="5814882">!=</span>&nbsp;<span class="ident" id="5814885">nil</span>&nbsp;<span class="op" id="5814889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814893">p</span><span class="op" id="5814894">.</span><span class="ident" id="5814895">err</span><span class="op" id="5814898">(</span><span class="ident" id="5814899">op</span><span class="op" id="5814901">.</span><span class="ident" id="5814902">Pos</span><span class="op" id="5814905">,</span>&nbsp;<span class="string" id="5814907">&#34;invalid&nbsp;shift&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="5814929">,</span>&nbsp;<span class="ident" id="5814931">op</span><span class="op" id="5814933">.</span><span class="ident" id="5814934">Lit</span><span class="op" id="5814937">,</span>&nbsp;<span class="ident" id="5814939">e</span><span class="op" id="5814940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5814944">return</span>&nbsp;<span class="num" id="5814951">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5814954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5814958">if</span>&nbsp;<span class="op" id="5814961">(</span><span class="ident" id="5814962">ret</span>&nbsp;<span class="op" id="5814966">&amp;</span>&nbsp;<span class="num" id="5814968">0x1f</span><span class="op" id="5814972">)</span>&nbsp;<span class="op" id="5814974">!=</span>&nbsp;<span class="ident" id="5814977">ret</span>&nbsp;<span class="op" id="5814981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814985">p</span><span class="op" id="5814986">.</span><span class="ident" id="5814987">err</span><span class="op" id="5814990">(</span><span class="ident" id="5814991">op</span><span class="op" id="5814993">.</span><span class="ident" id="5814994">Pos</span><span class="op" id="5814997">,</span>&nbsp;<span class="string" id="5814999">&#34;shift&nbsp;too&nbsp;large:&nbsp;%s&#34;</span><span class="op" id="5815020">,</span>&nbsp;<span class="ident" id="5815022">op</span><span class="op" id="5815024">.</span><span class="ident" id="5815025">Lit</span><span class="op" id="5815028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815032">return</span>&nbsp;<span class="num" id="5815039">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815046">return</span>&nbsp;<span class="builtintype" id="5815053">uint32</span><span class="op" id="5815059">(</span><span class="ident" id="5815060">ret</span><span class="op" id="5815063">)</span><br>
<span class="lineno"></span><span class="op" id="5815065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5815068">func</span>&nbsp;<span class="ident" id="5815073">makeInstReg</span><span class="op" id="5815084">(</span><span class="ident" id="5815085">fn</span><span class="op" id="5815087">,</span>&nbsp;<span class="ident" id="5815089">d</span><span class="op" id="5815090">,</span>&nbsp;<span class="ident" id="5815092">s1</span><span class="op" id="5815094">,</span>&nbsp;<span class="ident" id="5815096">s2</span><span class="op" id="5815098">,</span>&nbsp;<span class="ident" id="5815100">sh</span><span class="op" id="5815102">,</span>&nbsp;<span class="ident" id="5815104">isFloat</span>&nbsp;<span class="builtintype" id="5815112">uint32</span><span class="op" id="5815118">)</span>&nbsp;<span class="op" id="5815120">*</span><span class="ident" id="5815121">inst</span>&nbsp;<span class="op" id="5815126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815129">ret</span>&nbsp;<span class="op" id="5815133">:=</span>&nbsp;<span class="builtintype" id="5815136">uint32</span><span class="op" id="5815142">(</span><span class="num" id="5815143">0</span><span class="op" id="5815144">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815147">ret</span>&nbsp;<span class="op" id="5815151">|=</span>&nbsp;<span class="op" id="5815154">(</span><span class="ident" id="5815155">d</span>&nbsp;<span class="op" id="5815157">&amp;</span>&nbsp;<span class="num" id="5815159">0x7</span><span class="op" id="5815162">)</span>&nbsp;<span class="op" id="5815164">&lt;&lt;</span>&nbsp;<span class="num" id="5815167">21</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815171">ret</span>&nbsp;<span class="op" id="5815175">|=</span>&nbsp;<span class="op" id="5815178">(</span><span class="ident" id="5815179">s1</span>&nbsp;<span class="op" id="5815182">&amp;</span>&nbsp;<span class="num" id="5815184">0x7</span><span class="op" id="5815187">)</span>&nbsp;<span class="op" id="5815189">&lt;&lt;</span>&nbsp;<span class="num" id="5815192">18</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815196">ret</span>&nbsp;<span class="op" id="5815200">|=</span>&nbsp;<span class="op" id="5815203">(</span><span class="ident" id="5815204">s2</span>&nbsp;<span class="op" id="5815207">&amp;</span>&nbsp;<span class="num" id="5815209">0x7</span><span class="op" id="5815212">)</span>&nbsp;<span class="op" id="5815214">&lt;&lt;</span>&nbsp;<span class="num" id="5815217">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815221">ret</span>&nbsp;<span class="op" id="5815225">|=</span>&nbsp;<span class="op" id="5815228">(</span><span class="ident" id="5815229">sh</span>&nbsp;<span class="op" id="5815232">&amp;</span>&nbsp;<span class="num" id="5815234">0x1f</span><span class="op" id="5815238">)</span>&nbsp;<span class="op" id="5815240">&lt;&lt;</span>&nbsp;<span class="num" id="5815243">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815247">ret</span>&nbsp;<span class="op" id="5815251">|=</span>&nbsp;<span class="op" id="5815254">(</span><span class="ident" id="5815255">isFloat</span>&nbsp;<span class="op" id="5815263">&amp;</span>&nbsp;<span class="num" id="5815265">0x1</span><span class="op" id="5815268">)</span>&nbsp;<span class="op" id="5815270">&lt;&lt;</span>&nbsp;<span class="num" id="5815273">8</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815276">ret</span>&nbsp;<span class="op" id="5815280">|=</span>&nbsp;<span class="ident" id="5815283">fn</span>&nbsp;<span class="op" id="5815286">&amp;</span>&nbsp;<span class="num" id="5815288">0xff</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815295">return</span>&nbsp;<span class="op" id="5815302">&amp;</span><span class="ident" id="5815303">inst</span><span class="op" id="5815307">{</span><span class="ident" id="5815308">inst</span><span class="op" id="5815312">:</span>&nbsp;<span class="ident" id="5815314">ret</span><span class="op" id="5815317">}</span><br>
<span class="lineno"></span><span class="op" id="5815319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="5815322">func</span>&nbsp;<span class="ident" id="5815327">parseInstReg</span><span class="op" id="5815339">(</span><span class="ident" id="5815340">p</span>&nbsp;<span class="op" id="5815342">*</span><span class="ident" id="5815343">parser</span><span class="op" id="5815349">,</span>&nbsp;<span class="ident" id="5815351">ops</span>&nbsp;<span class="op" id="5815355">[</span><span class="op" id="5815356">]</span><span class="op" id="5815357">*</span><span class="ident" id="5815358">lex8</span><span class="op" id="5815362">.</span><span class="ident" id="5815363">Token</span><span class="op" id="5815368">)</span>&nbsp;<span class="op" id="5815370">(</span><span class="op" id="5815371">*</span><span class="ident" id="5815372">inst</span><span class="op" id="5815376">,</span>&nbsp;<span class="builtintype" id="5815378">bool</span><span class="op" id="5815382">)</span>&nbsp;<span class="op" id="5815384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815387">op0</span>&nbsp;<span class="op" id="5815391">:=</span>&nbsp;<span class="ident" id="5815394">ops</span><span class="op" id="5815397">[</span><span class="num" id="5815398">0</span><span class="op" id="5815399">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815402">opName</span>&nbsp;<span class="op" id="5815409">:=</span>&nbsp;<span class="ident" id="5815412">op0</span><span class="op" id="5815415">.</span><span class="ident" id="5815416">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815421">args</span>&nbsp;<span class="op" id="5815426">:=</span>&nbsp;<span class="ident" id="5815429">ops</span><span class="op" id="5815432">[</span><span class="num" id="5815433">1</span><span class="op" id="5815434">:</span><span class="op" id="5815435">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5815439">//&nbsp;common&nbsp;args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815455">var</span>&nbsp;<span class="ident" id="5815459">fn</span><span class="op" id="5815461">,</span>&nbsp;<span class="ident" id="5815463">d</span><span class="op" id="5815464">,</span>&nbsp;<span class="ident" id="5815466">s1</span><span class="op" id="5815468">,</span>&nbsp;<span class="ident" id="5815470">s2</span><span class="op" id="5815472">,</span>&nbsp;<span class="ident" id="5815474">sh</span><span class="op" id="5815476">,</span>&nbsp;<span class="ident" id="5815478">isFloat</span>&nbsp;<span class="builtintype" id="5815486">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815495">argCount</span>&nbsp;<span class="op" id="5815504">:=</span>&nbsp;<span class="keyword" id="5815507">func</span><span class="op" id="5815511">(</span><span class="ident" id="5815512">n</span>&nbsp;<span class="builtintype" id="5815514">int</span><span class="op" id="5815517">)</span>&nbsp;<span class="builtintype" id="5815519">bool</span>&nbsp;<span class="op" id="5815524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815528">if</span>&nbsp;<span class="op" id="5815531">!</span><span class="ident" id="5815532">argCount</span><span class="op" id="5815540">(</span><span class="ident" id="5815541">p</span><span class="op" id="5815542">,</span>&nbsp;<span class="ident" id="5815544">ops</span><span class="op" id="5815547">,</span>&nbsp;<span class="ident" id="5815549">n</span><span class="op" id="5815550">)</span>&nbsp;<span class="op" id="5815552">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815557">return</span>&nbsp;<span class="ident" id="5815564">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815576">if</span>&nbsp;<span class="ident" id="5815579">n</span>&nbsp;<span class="op" id="5815581">&gt;=</span>&nbsp;<span class="num" id="5815584">2</span>&nbsp;<span class="op" id="5815586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815591">d</span>&nbsp;<span class="op" id="5815593">=</span>&nbsp;<span class="ident" id="5815595">parseReg</span><span class="op" id="5815603">(</span><span class="ident" id="5815604">p</span><span class="op" id="5815605">,</span>&nbsp;<span class="ident" id="5815607">args</span><span class="op" id="5815611">[</span><span class="num" id="5815612">0</span><span class="op" id="5815613">]</span><span class="op" id="5815614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815619">s1</span>&nbsp;<span class="op" id="5815622">=</span>&nbsp;<span class="ident" id="5815624">parseReg</span><span class="op" id="5815632">(</span><span class="ident" id="5815633">p</span><span class="op" id="5815634">,</span>&nbsp;<span class="ident" id="5815636">args</span><span class="op" id="5815640">[</span><span class="num" id="5815641">1</span><span class="op" id="5815642">]</span><span class="op" id="5815643">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815651">return</span>&nbsp;<span class="ident" id="5815658">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815668">var</span>&nbsp;<span class="ident" id="5815672">found</span>&nbsp;<span class="builtintype" id="5815678">bool</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815684">if</span>&nbsp;<span class="ident" id="5815687">fn</span><span class="op" id="5815689">,</span>&nbsp;<span class="ident" id="5815691">found</span>&nbsp;<span class="op" id="5815697">=</span>&nbsp;<span class="ident" id="5815699">opShiftMap</span><span class="op" id="5815709">[</span><span class="ident" id="5815710">opName</span><span class="op" id="5815716">]</span><span class="op" id="5815717">;</span>&nbsp;<span class="ident" id="5815719">found</span>&nbsp;<span class="op" id="5815725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5815729">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815751">if</span>&nbsp;<span class="ident" id="5815754">argCount</span><span class="op" id="5815762">(</span><span class="num" id="5815763">3</span><span class="op" id="5815764">)</span>&nbsp;<span class="op" id="5815766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815771">sh</span>&nbsp;<span class="op" id="5815774">=</span>&nbsp;<span class="ident" id="5815776">parseShift</span><span class="op" id="5815786">(</span><span class="ident" id="5815787">p</span><span class="op" id="5815788">,</span>&nbsp;<span class="ident" id="5815790">args</span><span class="op" id="5815794">[</span><span class="num" id="5815795">2</span><span class="op" id="5815796">]</span><span class="op" id="5815797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815801">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815804">}</span>&nbsp;<span class="keyword" id="5815806">else</span>&nbsp;<span class="keyword" id="5815811">if</span>&nbsp;<span class="ident" id="5815814">fn</span><span class="op" id="5815816">,</span>&nbsp;<span class="ident" id="5815818">found</span>&nbsp;<span class="op" id="5815824">=</span>&nbsp;<span class="ident" id="5815826">opReg3Map</span><span class="op" id="5815835">[</span><span class="ident" id="5815836">opName</span><span class="op" id="5815842">]</span><span class="op" id="5815843">;</span>&nbsp;<span class="ident" id="5815845">found</span>&nbsp;<span class="op" id="5815851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5815855">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815875">if</span>&nbsp;<span class="ident" id="5815878">argCount</span><span class="op" id="5815886">(</span><span class="num" id="5815887">3</span><span class="op" id="5815888">)</span>&nbsp;<span class="op" id="5815890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815895">s2</span>&nbsp;<span class="op" id="5815898">=</span>&nbsp;<span class="ident" id="5815900">parseReg</span><span class="op" id="5815908">(</span><span class="ident" id="5815909">p</span><span class="op" id="5815910">,</span>&nbsp;<span class="ident" id="5815912">args</span><span class="op" id="5815916">[</span><span class="num" id="5815917">2</span><span class="op" id="5815918">]</span><span class="op" id="5815919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815923">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815926">}</span>&nbsp;<span class="keyword" id="5815928">else</span>&nbsp;<span class="keyword" id="5815933">if</span>&nbsp;<span class="ident" id="5815936">fn</span><span class="op" id="5815938">,</span>&nbsp;<span class="ident" id="5815940">found</span>&nbsp;<span class="op" id="5815946">=</span>&nbsp;<span class="ident" id="5815948">opReg2Map</span><span class="op" id="5815957">[</span><span class="ident" id="5815958">opName</span><span class="op" id="5815964">]</span><span class="op" id="5815965">;</span>&nbsp;<span class="ident" id="5815967">found</span>&nbsp;<span class="op" id="5815973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5815977">//&nbsp;op&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815993">argCount</span><span class="op" id="5816001">(</span><span class="num" id="5816002">2</span><span class="op" id="5816003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5816006">}</span>&nbsp;<span class="keyword" id="5816008">else</span>&nbsp;<span class="keyword" id="5816013">if</span>&nbsp;<span class="ident" id="5816016">fn</span><span class="op" id="5816018">,</span>&nbsp;<span class="ident" id="5816020">found</span>&nbsp;<span class="op" id="5816026">=</span>&nbsp;<span class="ident" id="5816028">opFloatMap</span><span class="op" id="5816038">[</span><span class="ident" id="5816039">opName</span><span class="op" id="5816045">]</span><span class="op" id="5816046">;</span>&nbsp;<span class="ident" id="5816048">found</span>&nbsp;<span class="op" id="5816054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5816058">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5816078">if</span>&nbsp;<span class="ident" id="5816081">argCount</span><span class="op" id="5816089">(</span><span class="num" id="5816090">3</span><span class="op" id="5816091">)</span>&nbsp;<span class="op" id="5816093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5816098">s2</span>&nbsp;<span class="op" id="5816101">=</span>&nbsp;<span class="ident" id="5816103">parseReg</span><span class="op" id="5816111">(</span><span class="ident" id="5816112">p</span><span class="op" id="5816113">,</span>&nbsp;<span class="ident" id="5816115">args</span><span class="op" id="5816119">[</span><span class="num" id="5816120">2</span><span class="op" id="5816121">]</span><span class="op" id="5816122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5816126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5816130">isFloat</span>&nbsp;<span class="op" id="5816138">=</span>&nbsp;<span class="num" id="5816140">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5816143">}</span>&nbsp;<span class="keyword" id="5816145">else</span>&nbsp;<span class="op" id="5816150">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5816154">return</span>&nbsp;<span class="ident" id="5816161">nil</span><span class="op" id="5816164">,</span>&nbsp;<span class="ident" id="5816166">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5816173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5816177">return</span>&nbsp;<span class="ident" id="5816184">makeInstReg</span><span class="op" id="5816195">(</span><span class="ident" id="5816196">fn</span><span class="op" id="5816198">,</span>&nbsp;<span class="ident" id="5816200">d</span><span class="op" id="5816201">,</span>&nbsp;<span class="ident" id="5816203">s1</span><span class="op" id="5816205">,</span>&nbsp;<span class="ident" id="5816207">s2</span><span class="op" id="5816209">,</span>&nbsp;<span class="ident" id="5816211">sh</span><span class="op" id="5816213">,</span>&nbsp;<span class="ident" id="5816215">isFloat</span><span class="op" id="5816222">)</span><span class="op" id="5816223">,</span>&nbsp;<span class="ident" id="5816225">true</span><br>
<span class="lineno"></span><span class="op" id="5816230">}</span>
</div>
</body>
</html>
