<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html" class="current">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3068097">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3068153">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3068207">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3068258">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3068334">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="3068387">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3068402">package</span>&nbsp;<span class="ident" id="3068410">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3068416">import</span>&nbsp;<span class="op" id="3068423">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3068426">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3068435">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3068449">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3068466">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3068472">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3068478">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3068489">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3068497">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3068504">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3068507">const</span>&nbsp;<span class="ident" id="3068513">urandomDevice</span>&nbsp;<span class="op" id="3068527">=</span>&nbsp;<span class="string" id="3068529">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3068545">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="3068593">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3068645">func</span>&nbsp;<span class="ident" id="3068650">init</span><span class="op" id="3068654">(</span><span class="op" id="3068655">)</span>&nbsp;<span class="op" id="3068657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3068660">if</span>&nbsp;<span class="ident" id="3068663">runtime</span><span class="op" id="3068670">.</span><span class="ident" id="3068671">GOOS</span>&nbsp;<span class="op" id="3068676">==</span>&nbsp;<span class="string" id="3068679">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3068687">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3068691">Reader</span>&nbsp;<span class="op" id="3068698">=</span>&nbsp;<span class="ident" id="3068700">newReader</span><span class="op" id="3068709">(</span><span class="builtintype" id="3068710">nil</span><span class="op" id="3068713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3068716">}</span>&nbsp;<span class="keyword" id="3068718">else</span>&nbsp;<span class="op" id="3068723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3068727">Reader</span>&nbsp;<span class="op" id="3068734">=</span>&nbsp;<span class="op" id="3068736">&amp;</span><span class="ident" id="3068737">devReader</span><span class="op" id="3068746">{</span><span class="ident" id="3068747">name</span><span class="op" id="3068751">:</span>&nbsp;<span class="ident" id="3068753">urandomDevice</span><span class="op" id="3068766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3068769">}</span><br>
<span class="lineno"></span><span class="op" id="3068771">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3068774">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3068837">type</span>&nbsp;<span class="ident" id="3068842">devReader</span>&nbsp;<span class="keyword" id="3068852">struct</span>&nbsp;<span class="op" id="3068859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3068862">name</span>&nbsp;<span class="builtintype" id="3068867">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3068875">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3068880">io</span><span class="op" id="3068882">.</span><span class="ident" id="3068883">Reader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3068891">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3068896">sync</span><span class="op" id="3068900">.</span><span class="ident" id="3068901">Mutex</span><br>
<span class="lineno"></span><span class="op" id="3068907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3068910">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="3068978">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="3069007">var</span>&nbsp;<span class="ident" id="3069011">altGetRandom</span>&nbsp;<span class="keyword" id="3069024">func</span><span class="op" id="3069028">(</span><span class="op" id="3069029">[</span><span class="op" id="3069030">]</span><span class="builtintype" id="3069031">byte</span><span class="op" id="3069035">)</span>&nbsp;<span class="op" id="3069037">(</span><span class="ident" id="3069038">ok</span>&nbsp;<span class="builtintype" id="3069041">bool</span><span class="op" id="3069045">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3069048">func</span>&nbsp;<span class="op" id="3069053">(</span><span class="ident" id="3069054">r</span>&nbsp;<span class="op" id="3069056">*</span><span class="ident" id="3069057">devReader</span><span class="op" id="3069066">)</span>&nbsp;<span class="ident" id="3069068">Read</span><span class="op" id="3069072">(</span><span class="ident" id="3069073">b</span>&nbsp;<span class="op" id="3069075">[</span><span class="op" id="3069076">]</span><span class="builtintype" id="3069077">byte</span><span class="op" id="3069081">)</span>&nbsp;<span class="op" id="3069083">(</span><span class="ident" id="3069084">n</span>&nbsp;<span class="builtintype" id="3069086">int</span><span class="op" id="3069089">,</span>&nbsp;<span class="ident" id="3069091">err</span>&nbsp;<span class="builtintype" id="3069095">error</span><span class="op" id="3069100">)</span>&nbsp;<span class="op" id="3069102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3069105">if</span>&nbsp;<span class="ident" id="3069108">altGetRandom</span>&nbsp;<span class="op" id="3069121">!=</span>&nbsp;<span class="builtintype" id="3069124">nil</span>&nbsp;<span class="op" id="3069128">&amp;&amp;</span>&nbsp;<span class="ident" id="3069131">r</span><span class="op" id="3069132">.</span><span class="ident" id="3069133">name</span>&nbsp;<span class="op" id="3069138">==</span>&nbsp;<span class="ident" id="3069141">urandomDevice</span>&nbsp;<span class="op" id="3069155">&amp;&amp;</span>&nbsp;<span class="ident" id="3069158">altGetRandom</span><span class="op" id="3069170">(</span><span class="ident" id="3069171">b</span><span class="op" id="3069172">)</span>&nbsp;<span class="op" id="3069174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3069178">return</span>&nbsp;<span class="builtinfunc" id="3069185">len</span><span class="op" id="3069188">(</span><span class="ident" id="3069189">b</span><span class="op" id="3069190">)</span><span class="op" id="3069191">,</span>&nbsp;<span class="builtintype" id="3069193">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3069198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3069201">r</span><span class="op" id="3069202">.</span><span class="ident" id="3069203">mu</span><span class="op" id="3069205">.</span><span class="ident" id="3069206">Lock</span><span class="op" id="3069210">(</span><span class="op" id="3069211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3069214">defer</span>&nbsp;<span class="ident" id="3069220">r</span><span class="op" id="3069221">.</span><span class="ident" id="3069222">mu</span><span class="op" id="3069224">.</span><span class="ident" id="3069225">Unlock</span><span class="op" id="3069231">(</span><span class="op" id="3069232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3069235">if</span>&nbsp;<span class="ident" id="3069238">r</span><span class="op" id="3069239">.</span><span class="ident" id="3069240">f</span>&nbsp;<span class="op" id="3069242">==</span>&nbsp;<span class="builtintype" id="3069245">nil</span>&nbsp;<span class="op" id="3069249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3069253">f</span><span class="op" id="3069254">,</span>&nbsp;<span class="ident" id="3069256">err</span>&nbsp;<span class="op" id="3069260">:=</span>&nbsp;<span class="ident" id="3069263">os</span><span class="op" id="3069265">.</span><span class="ident" id="3069266">Open</span><span class="op" id="3069270">(</span><span class="ident" id="3069271">r</span><span class="op" id="3069272">.</span><span class="ident" id="3069273">name</span><span class="op" id="3069277">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3069281">if</span>&nbsp;<span class="ident" id="3069284">f</span>&nbsp;<span class="op" id="3069286">==</span>&nbsp;<span class="builtintype" id="3069289">nil</span>&nbsp;<span class="op" id="3069293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3069298">return</span>&nbsp;<span class="num" id="3069305">0</span><span class="op" id="3069306">,</span>&nbsp;<span class="ident" id="3069308">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3069314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3069318">if</span>&nbsp;<span class="ident" id="3069321">runtime</span><span class="op" id="3069328">.</span><span class="ident" id="3069329">GOOS</span>&nbsp;<span class="op" id="3069334">==</span>&nbsp;<span class="string" id="3069337">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3069345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3069350">r</span><span class="op" id="3069351">.</span><span class="ident" id="3069352">f</span>&nbsp;<span class="op" id="3069354">=</span>&nbsp;<span class="ident" id="3069356">f</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3069360">}</span>&nbsp;<span class="keyword" id="3069362">else</span>&nbsp;<span class="op" id="3069367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3069372">r</span><span class="op" id="3069373">.</span><span class="ident" id="3069374">f</span>&nbsp;<span class="op" id="3069376">=</span>&nbsp;<span class="ident" id="3069378">bufio</span><span class="op" id="3069383">.</span><span class="ident" id="3069384">NewReader</span><span class="op" id="3069393">(</span><span class="ident" id="3069394">f</span><span class="op" id="3069395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3069399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3069402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3069405">return</span>&nbsp;<span class="ident" id="3069412">r</span><span class="op" id="3069413">.</span><span class="ident" id="3069414">f</span><span class="op" id="3069415">.</span><span class="ident" id="3069416">Read</span><span class="op" id="3069420">(</span><span class="ident" id="3069421">b</span><span class="op" id="3069422">)</span><br>
<span class="lineno">65</span><span class="op" id="3069424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3069427">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3069480">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3069525">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3069580">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="3069641">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3069700">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="3069751">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="3069808">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3069867">//</span><br>
<span class="lineno"></span><span class="comment" id="3069870">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="3069926">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3069975">func</span>&nbsp;<span class="ident" id="3069980">newReader</span><span class="op" id="3069989">(</span><span class="ident" id="3069990">entropy</span>&nbsp;<span class="ident" id="3069998">io</span><span class="op" id="3070000">.</span><span class="ident" id="3070001">Reader</span><span class="op" id="3070007">)</span>&nbsp;<span class="ident" id="3070009">io</span><span class="op" id="3070011">.</span><span class="ident" id="3070012">Reader</span>&nbsp;<span class="op" id="3070019">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3070022">if</span>&nbsp;<span class="ident" id="3070025">entropy</span>&nbsp;<span class="op" id="3070033">==</span>&nbsp;<span class="builtintype" id="3070036">nil</span>&nbsp;<span class="op" id="3070040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070044">entropy</span>&nbsp;<span class="op" id="3070052">=</span>&nbsp;<span class="op" id="3070054">&amp;</span><span class="ident" id="3070055">devReader</span><span class="op" id="3070064">{</span><span class="ident" id="3070065">name</span><span class="op" id="3070069">:</span>&nbsp;<span class="string" id="3070071">&#34;/dev/random&#34;</span><span class="op" id="3070084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3070087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3070090">return</span>&nbsp;<span class="op" id="3070097">&amp;</span><span class="ident" id="3070098">reader</span><span class="op" id="3070104">{</span><span class="ident" id="3070105">entropy</span><span class="op" id="3070112">:</span>&nbsp;<span class="ident" id="3070114">entropy</span><span class="op" id="3070121">}</span><br>
<span class="lineno"></span><span class="op" id="3070123">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="3070126">type</span>&nbsp;<span class="ident" id="3070131">reader</span>&nbsp;<span class="keyword" id="3070138">struct</span>&nbsp;<span class="op" id="3070145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070148">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070169">sync</span><span class="op" id="3070173">.</span><span class="ident" id="3070174">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070181">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3070202">int</span>&nbsp;<span class="comment" id="3070206">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070248">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070269">cipher</span><span class="op" id="3070275">.</span><span class="ident" id="3070276">Block</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070283">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070304">io</span><span class="op" id="3070306">.</span><span class="ident" id="3070307">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070315">time</span><span class="op" id="3070319">,</span>&nbsp;<span class="ident" id="3070321">seed</span><span class="op" id="3070325">,</span>&nbsp;<span class="ident" id="3070327">dst</span><span class="op" id="3070330">,</span>&nbsp;<span class="ident" id="3070332">key</span>&nbsp;<span class="op" id="3070336">[</span><span class="ident" id="3070337">aes</span><span class="op" id="3070340">.</span><span class="ident" id="3070341">BlockSize</span><span class="op" id="3070350">]</span><span class="builtintype" id="3070351">byte</span><br>
<span class="lineno"></span><span class="op" id="3070356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3070359">func</span>&nbsp;<span class="op" id="3070364">(</span><span class="ident" id="3070365">r</span>&nbsp;<span class="op" id="3070367">*</span><span class="ident" id="3070368">reader</span><span class="op" id="3070374">)</span>&nbsp;<span class="ident" id="3070376">Read</span><span class="op" id="3070380">(</span><span class="ident" id="3070381">b</span>&nbsp;<span class="op" id="3070383">[</span><span class="op" id="3070384">]</span><span class="builtintype" id="3070385">byte</span><span class="op" id="3070389">)</span>&nbsp;<span class="op" id="3070391">(</span><span class="ident" id="3070392">n</span>&nbsp;<span class="builtintype" id="3070394">int</span><span class="op" id="3070397">,</span>&nbsp;<span class="ident" id="3070399">err</span>&nbsp;<span class="builtintype" id="3070403">error</span><span class="op" id="3070408">)</span>&nbsp;<span class="op" id="3070410">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070413">r</span><span class="op" id="3070414">.</span><span class="ident" id="3070415">mu</span><span class="op" id="3070417">.</span><span class="ident" id="3070418">Lock</span><span class="op" id="3070422">(</span><span class="op" id="3070423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3070426">defer</span>&nbsp;<span class="ident" id="3070432">r</span><span class="op" id="3070433">.</span><span class="ident" id="3070434">mu</span><span class="op" id="3070436">.</span><span class="ident" id="3070437">Unlock</span><span class="op" id="3070443">(</span><span class="op" id="3070444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070447">n</span>&nbsp;<span class="op" id="3070449">=</span>&nbsp;<span class="builtinfunc" id="3070451">len</span><span class="op" id="3070454">(</span><span class="ident" id="3070455">b</span><span class="op" id="3070456">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3070460">for</span>&nbsp;<span class="builtinfunc" id="3070464">len</span><span class="op" id="3070467">(</span><span class="ident" id="3070468">b</span><span class="op" id="3070469">)</span>&nbsp;<span class="op" id="3070471">&gt;</span>&nbsp;<span class="num" id="3070473">0</span>&nbsp;<span class="op" id="3070475">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3070479">if</span>&nbsp;<span class="ident" id="3070482">r</span><span class="op" id="3070483">.</span><span class="ident" id="3070484">budget</span>&nbsp;<span class="op" id="3070491">==</span>&nbsp;<span class="num" id="3070494">0</span>&nbsp;<span class="op" id="3070496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070501">_</span><span class="op" id="3070502">,</span>&nbsp;<span class="ident" id="3070504">err</span>&nbsp;<span class="op" id="3070508">:=</span>&nbsp;<span class="ident" id="3070511">io</span><span class="op" id="3070513">.</span><span class="ident" id="3070514">ReadFull</span><span class="op" id="3070522">(</span><span class="ident" id="3070523">r</span><span class="op" id="3070524">.</span><span class="ident" id="3070525">entropy</span><span class="op" id="3070532">,</span>&nbsp;<span class="ident" id="3070534">r</span><span class="op" id="3070535">.</span><span class="ident" id="3070536">seed</span><span class="op" id="3070540">[</span><span class="num" id="3070541">0</span><span class="op" id="3070542">:</span><span class="op" id="3070543">]</span><span class="op" id="3070544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3070549">if</span>&nbsp;<span class="ident" id="3070552">err</span>&nbsp;<span class="op" id="3070556">!=</span>&nbsp;<span class="builtintype" id="3070559">nil</span>&nbsp;<span class="op" id="3070563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3070569">return</span>&nbsp;<span class="ident" id="3070576">n</span>&nbsp;<span class="op" id="3070578">-</span>&nbsp;<span class="builtinfunc" id="3070580">len</span><span class="op" id="3070583">(</span><span class="ident" id="3070584">b</span><span class="op" id="3070585">)</span><span class="op" id="3070586">,</span>&nbsp;<span class="ident" id="3070588">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3070595">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070600">_</span><span class="op" id="3070601">,</span>&nbsp;<span class="ident" id="3070603">err</span>&nbsp;<span class="op" id="3070607">=</span>&nbsp;<span class="ident" id="3070609">io</span><span class="op" id="3070611">.</span><span class="ident" id="3070612">ReadFull</span><span class="op" id="3070620">(</span><span class="ident" id="3070621">r</span><span class="op" id="3070622">.</span><span class="ident" id="3070623">entropy</span><span class="op" id="3070630">,</span>&nbsp;<span class="ident" id="3070632">r</span><span class="op" id="3070633">.</span><span class="ident" id="3070634">key</span><span class="op" id="3070637">[</span><span class="num" id="3070638">0</span><span class="op" id="3070639">:</span><span class="op" id="3070640">]</span><span class="op" id="3070641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3070646">if</span>&nbsp;<span class="ident" id="3070649">err</span>&nbsp;<span class="op" id="3070653">!=</span>&nbsp;<span class="builtintype" id="3070656">nil</span>&nbsp;<span class="op" id="3070660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3070666">return</span>&nbsp;<span class="ident" id="3070673">n</span>&nbsp;<span class="op" id="3070675">-</span>&nbsp;<span class="builtinfunc" id="3070677">len</span><span class="op" id="3070680">(</span><span class="ident" id="3070681">b</span><span class="op" id="3070682">)</span><span class="op" id="3070683">,</span>&nbsp;<span class="ident" id="3070685">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3070692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070697">r</span><span class="op" id="3070698">.</span><span class="ident" id="3070699">cipher</span><span class="op" id="3070705">,</span>&nbsp;<span class="ident" id="3070707">err</span>&nbsp;<span class="op" id="3070711">=</span>&nbsp;<span class="ident" id="3070713">aes</span><span class="op" id="3070716">.</span><span class="ident" id="3070717">NewCipher</span><span class="op" id="3070726">(</span><span class="ident" id="3070727">r</span><span class="op" id="3070728">.</span><span class="ident" id="3070729">key</span><span class="op" id="3070732">[</span><span class="num" id="3070733">0</span><span class="op" id="3070734">:</span><span class="op" id="3070735">]</span><span class="op" id="3070736">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3070741">if</span>&nbsp;<span class="ident" id="3070744">err</span>&nbsp;<span class="op" id="3070748">!=</span>&nbsp;<span class="builtintype" id="3070751">nil</span>&nbsp;<span class="op" id="3070755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3070761">return</span>&nbsp;<span class="ident" id="3070768">n</span>&nbsp;<span class="op" id="3070770">-</span>&nbsp;<span class="builtinfunc" id="3070772">len</span><span class="op" id="3070775">(</span><span class="ident" id="3070776">b</span><span class="op" id="3070777">)</span><span class="op" id="3070778">,</span>&nbsp;<span class="ident" id="3070780">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3070787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070792">r</span><span class="op" id="3070793">.</span><span class="ident" id="3070794">budget</span>&nbsp;<span class="op" id="3070801">=</span>&nbsp;<span class="num" id="3070803">1</span>&nbsp;<span class="op" id="3070805">&lt;&lt;</span>&nbsp;<span class="num" id="3070808">20</span>&nbsp;<span class="comment" id="3070811">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3070844">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3070848">r</span><span class="op" id="3070849">.</span><span class="ident" id="3070850">budget</span>&nbsp;<span class="op" id="3070857">-=</span>&nbsp;<span class="ident" id="3070860">aes</span><span class="op" id="3070863">.</span><span class="ident" id="3070864">BlockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3070877">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3070947">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3070952">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3070971">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3070994">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3071021">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071048">ns</span>&nbsp;<span class="op" id="3071051">:=</span>&nbsp;<span class="ident" id="3071054">time</span><span class="op" id="3071058">.</span><span class="ident" id="3071059">Now</span><span class="op" id="3071062">(</span><span class="op" id="3071063">)</span><span class="op" id="3071064">.</span><span class="ident" id="3071065">UnixNano</span><span class="op" id="3071073">(</span><span class="op" id="3071074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071078">r</span><span class="op" id="3071079">.</span><span class="ident" id="3071080">time</span><span class="op" id="3071084">[</span><span class="num" id="3071085">0</span><span class="op" id="3071086">]</span>&nbsp;<span class="op" id="3071088">=</span>&nbsp;<span class="builtintype" id="3071090">byte</span><span class="op" id="3071094">(</span><span class="ident" id="3071095">ns</span>&nbsp;<span class="op" id="3071098">&gt;&gt;</span>&nbsp;<span class="num" id="3071101">56</span><span class="op" id="3071103">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071107">r</span><span class="op" id="3071108">.</span><span class="ident" id="3071109">time</span><span class="op" id="3071113">[</span><span class="num" id="3071114">1</span><span class="op" id="3071115">]</span>&nbsp;<span class="op" id="3071117">=</span>&nbsp;<span class="builtintype" id="3071119">byte</span><span class="op" id="3071123">(</span><span class="ident" id="3071124">ns</span>&nbsp;<span class="op" id="3071127">&gt;&gt;</span>&nbsp;<span class="num" id="3071130">48</span><span class="op" id="3071132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071136">r</span><span class="op" id="3071137">.</span><span class="ident" id="3071138">time</span><span class="op" id="3071142">[</span><span class="num" id="3071143">2</span><span class="op" id="3071144">]</span>&nbsp;<span class="op" id="3071146">=</span>&nbsp;<span class="builtintype" id="3071148">byte</span><span class="op" id="3071152">(</span><span class="ident" id="3071153">ns</span>&nbsp;<span class="op" id="3071156">&gt;&gt;</span>&nbsp;<span class="num" id="3071159">40</span><span class="op" id="3071161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071165">r</span><span class="op" id="3071166">.</span><span class="ident" id="3071167">time</span><span class="op" id="3071171">[</span><span class="num" id="3071172">3</span><span class="op" id="3071173">]</span>&nbsp;<span class="op" id="3071175">=</span>&nbsp;<span class="builtintype" id="3071177">byte</span><span class="op" id="3071181">(</span><span class="ident" id="3071182">ns</span>&nbsp;<span class="op" id="3071185">&gt;&gt;</span>&nbsp;<span class="num" id="3071188">32</span><span class="op" id="3071190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071194">r</span><span class="op" id="3071195">.</span><span class="ident" id="3071196">time</span><span class="op" id="3071200">[</span><span class="num" id="3071201">4</span><span class="op" id="3071202">]</span>&nbsp;<span class="op" id="3071204">=</span>&nbsp;<span class="builtintype" id="3071206">byte</span><span class="op" id="3071210">(</span><span class="ident" id="3071211">ns</span>&nbsp;<span class="op" id="3071214">&gt;&gt;</span>&nbsp;<span class="num" id="3071217">24</span><span class="op" id="3071219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071223">r</span><span class="op" id="3071224">.</span><span class="ident" id="3071225">time</span><span class="op" id="3071229">[</span><span class="num" id="3071230">5</span><span class="op" id="3071231">]</span>&nbsp;<span class="op" id="3071233">=</span>&nbsp;<span class="builtintype" id="3071235">byte</span><span class="op" id="3071239">(</span><span class="ident" id="3071240">ns</span>&nbsp;<span class="op" id="3071243">&gt;&gt;</span>&nbsp;<span class="num" id="3071246">16</span><span class="op" id="3071248">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071252">r</span><span class="op" id="3071253">.</span><span class="ident" id="3071254">time</span><span class="op" id="3071258">[</span><span class="num" id="3071259">6</span><span class="op" id="3071260">]</span>&nbsp;<span class="op" id="3071262">=</span>&nbsp;<span class="builtintype" id="3071264">byte</span><span class="op" id="3071268">(</span><span class="ident" id="3071269">ns</span>&nbsp;<span class="op" id="3071272">&gt;&gt;</span>&nbsp;<span class="num" id="3071275">8</span><span class="op" id="3071276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071280">r</span><span class="op" id="3071281">.</span><span class="ident" id="3071282">time</span><span class="op" id="3071286">[</span><span class="num" id="3071287">7</span><span class="op" id="3071288">]</span>&nbsp;<span class="op" id="3071290">=</span>&nbsp;<span class="builtintype" id="3071292">byte</span><span class="op" id="3071296">(</span><span class="ident" id="3071297">ns</span><span class="op" id="3071299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071303">r</span><span class="op" id="3071304">.</span><span class="ident" id="3071305">cipher</span><span class="op" id="3071311">.</span><span class="ident" id="3071312">Encrypt</span><span class="op" id="3071319">(</span><span class="ident" id="3071320">r</span><span class="op" id="3071321">.</span><span class="ident" id="3071322">time</span><span class="op" id="3071326">[</span><span class="num" id="3071327">0</span><span class="op" id="3071328">:</span><span class="op" id="3071329">]</span><span class="op" id="3071330">,</span>&nbsp;<span class="ident" id="3071332">r</span><span class="op" id="3071333">.</span><span class="ident" id="3071334">time</span><span class="op" id="3071338">[</span><span class="num" id="3071339">0</span><span class="op" id="3071340">:</span><span class="op" id="3071341">]</span><span class="op" id="3071342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3071346">for</span>&nbsp;<span class="ident" id="3071350">i</span>&nbsp;<span class="op" id="3071352">:=</span>&nbsp;<span class="num" id="3071355">0</span><span class="op" id="3071356">;</span>&nbsp;<span class="ident" id="3071358">i</span>&nbsp;<span class="op" id="3071360">&lt;</span>&nbsp;<span class="ident" id="3071362">aes</span><span class="op" id="3071365">.</span><span class="ident" id="3071366">BlockSize</span><span class="op" id="3071375">;</span>&nbsp;<span class="ident" id="3071377">i</span><span class="op" id="3071378">++</span>&nbsp;<span class="op" id="3071381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071386">r</span><span class="op" id="3071387">.</span><span class="ident" id="3071388">dst</span><span class="op" id="3071391">[</span><span class="ident" id="3071392">i</span><span class="op" id="3071393">]</span>&nbsp;<span class="op" id="3071395">=</span>&nbsp;<span class="ident" id="3071397">r</span><span class="op" id="3071398">.</span><span class="ident" id="3071399">time</span><span class="op" id="3071403">[</span><span class="ident" id="3071404">i</span><span class="op" id="3071405">]</span>&nbsp;<span class="op" id="3071407">^</span>&nbsp;<span class="ident" id="3071409">r</span><span class="op" id="3071410">.</span><span class="ident" id="3071411">seed</span><span class="op" id="3071415">[</span><span class="ident" id="3071416">i</span><span class="op" id="3071417">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3071421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071425">r</span><span class="op" id="3071426">.</span><span class="ident" id="3071427">cipher</span><span class="op" id="3071433">.</span><span class="ident" id="3071434">Encrypt</span><span class="op" id="3071441">(</span><span class="ident" id="3071442">r</span><span class="op" id="3071443">.</span><span class="ident" id="3071444">dst</span><span class="op" id="3071447">[</span><span class="num" id="3071448">0</span><span class="op" id="3071449">:</span><span class="op" id="3071450">]</span><span class="op" id="3071451">,</span>&nbsp;<span class="ident" id="3071453">r</span><span class="op" id="3071454">.</span><span class="ident" id="3071455">dst</span><span class="op" id="3071458">[</span><span class="num" id="3071459">0</span><span class="op" id="3071460">:</span><span class="op" id="3071461">]</span><span class="op" id="3071462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3071466">for</span>&nbsp;<span class="ident" id="3071470">i</span>&nbsp;<span class="op" id="3071472">:=</span>&nbsp;<span class="num" id="3071475">0</span><span class="op" id="3071476">;</span>&nbsp;<span class="ident" id="3071478">i</span>&nbsp;<span class="op" id="3071480">&lt;</span>&nbsp;<span class="ident" id="3071482">aes</span><span class="op" id="3071485">.</span><span class="ident" id="3071486">BlockSize</span><span class="op" id="3071495">;</span>&nbsp;<span class="ident" id="3071497">i</span><span class="op" id="3071498">++</span>&nbsp;<span class="op" id="3071501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071506">r</span><span class="op" id="3071507">.</span><span class="ident" id="3071508">seed</span><span class="op" id="3071512">[</span><span class="ident" id="3071513">i</span><span class="op" id="3071514">]</span>&nbsp;<span class="op" id="3071516">=</span>&nbsp;<span class="ident" id="3071518">r</span><span class="op" id="3071519">.</span><span class="ident" id="3071520">time</span><span class="op" id="3071524">[</span><span class="ident" id="3071525">i</span><span class="op" id="3071526">]</span>&nbsp;<span class="op" id="3071528">^</span>&nbsp;<span class="ident" id="3071530">r</span><span class="op" id="3071531">.</span><span class="ident" id="3071532">dst</span><span class="op" id="3071535">[</span><span class="ident" id="3071536">i</span><span class="op" id="3071537">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3071541">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071545">r</span><span class="op" id="3071546">.</span><span class="ident" id="3071547">cipher</span><span class="op" id="3071553">.</span><span class="ident" id="3071554">Encrypt</span><span class="op" id="3071561">(</span><span class="ident" id="3071562">r</span><span class="op" id="3071563">.</span><span class="ident" id="3071564">seed</span><span class="op" id="3071568">[</span><span class="num" id="3071569">0</span><span class="op" id="3071570">:</span><span class="op" id="3071571">]</span><span class="op" id="3071572">,</span>&nbsp;<span class="ident" id="3071574">r</span><span class="op" id="3071575">.</span><span class="ident" id="3071576">seed</span><span class="op" id="3071580">[</span><span class="num" id="3071581">0</span><span class="op" id="3071582">:</span><span class="op" id="3071583">]</span><span class="op" id="3071584">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071589">m</span>&nbsp;<span class="op" id="3071591">:=</span>&nbsp;<span class="builtinfunc" id="3071594">copy</span><span class="op" id="3071598">(</span><span class="ident" id="3071599">b</span><span class="op" id="3071600">,</span>&nbsp;<span class="ident" id="3071602">r</span><span class="op" id="3071603">.</span><span class="ident" id="3071604">dst</span><span class="op" id="3071607">[</span><span class="num" id="3071608">0</span><span class="op" id="3071609">:</span><span class="op" id="3071610">]</span><span class="op" id="3071611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3071615">b</span>&nbsp;<span class="op" id="3071617">=</span>&nbsp;<span class="ident" id="3071619">b</span><span class="op" id="3071620">[</span><span class="ident" id="3071621">m</span><span class="op" id="3071622">:</span><span class="op" id="3071623">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3071626">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3071630">return</span>&nbsp;<span class="ident" id="3071637">n</span><span class="op" id="3071638">,</span>&nbsp;<span class="builtintype" id="3071640">nil</span><br>
<span class="lineno"></span><span class="op" id="3071644">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
