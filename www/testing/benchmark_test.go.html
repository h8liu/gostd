<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1197787">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1197842">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1197896">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1197947">package</span>&nbsp;<span class="ident" id="1197955">testing_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1197969">import</span>&nbsp;<span class="op" id="1197976">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1197979">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1197988">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1197999">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1198014">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1198025">&#34;text/template&#34;</span><br>
<span class="lineno"></span><span class="op" id="1198041">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1198044">var</span>&nbsp;<span class="ident" id="1198048">roundDownTests</span>&nbsp;<span class="op" id="1198063">=</span>&nbsp;<span class="op" id="1198065">[</span><span class="op" id="1198066">]</span><span class="keyword" id="1198067">struct</span>&nbsp;<span class="op" id="1198074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1198077">v</span><span class="op" id="1198078">,</span>&nbsp;<span class="ident" id="1198080">expected</span>&nbsp;<span class="builtintype" id="1198089">int</span><br>
<span class="lineno"></span><span class="op" id="1198093">}</span><span class="op" id="1198094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198097">{</span><span class="num" id="1198098">1</span><span class="op" id="1198099">,</span>&nbsp;<span class="num" id="1198101">1</span><span class="op" id="1198102">}</span><span class="op" id="1198103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198106">{</span><span class="num" id="1198107">9</span><span class="op" id="1198108">,</span>&nbsp;<span class="num" id="1198110">1</span><span class="op" id="1198111">}</span><span class="op" id="1198112">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198115">{</span><span class="num" id="1198116">10</span><span class="op" id="1198118">,</span>&nbsp;<span class="num" id="1198120">10</span><span class="op" id="1198122">}</span><span class="op" id="1198123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198126">{</span><span class="num" id="1198127">11</span><span class="op" id="1198129">,</span>&nbsp;<span class="num" id="1198131">10</span><span class="op" id="1198133">}</span><span class="op" id="1198134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198137">{</span><span class="num" id="1198138">100</span><span class="op" id="1198141">,</span>&nbsp;<span class="num" id="1198143">100</span><span class="op" id="1198146">}</span><span class="op" id="1198147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198150">{</span><span class="num" id="1198151">101</span><span class="op" id="1198154">,</span>&nbsp;<span class="num" id="1198156">100</span><span class="op" id="1198159">}</span><span class="op" id="1198160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198163">{</span><span class="num" id="1198164">999</span><span class="op" id="1198167">,</span>&nbsp;<span class="num" id="1198169">100</span><span class="op" id="1198172">}</span><span class="op" id="1198173">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198176">{</span><span class="num" id="1198177">1000</span><span class="op" id="1198181">,</span>&nbsp;<span class="num" id="1198183">1000</span><span class="op" id="1198187">}</span><span class="op" id="1198188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198191">{</span><span class="num" id="1198192">1001</span><span class="op" id="1198196">,</span>&nbsp;<span class="num" id="1198198">1000</span><span class="op" id="1198202">}</span><span class="op" id="1198203">,</span><br>
<span class="lineno"></span><span class="op" id="1198205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1198208">func</span>&nbsp;<span class="ident" id="1198213">TestRoundDown10</span><span class="op" id="1198228">(</span><span class="ident" id="1198229">t</span>&nbsp;<span class="op" id="1198231">*</span><span class="ident" id="1198232"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1198239">.</span><span class="ident" id="1198240">T</span><span class="op" id="1198241">)</span>&nbsp;<span class="op" id="1198243">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1198246">for</span>&nbsp;<span class="ident" id="1198250">_</span><span class="op" id="1198251">,</span>&nbsp;<span class="ident" id="1198253">tt</span>&nbsp;<span class="op" id="1198256">:=</span>&nbsp;<span class="keyword" id="1198259">range</span>&nbsp;<span class="ident" id="1198265"><a href="/testing/benchmark_test.go.html#1198048">roundDownTests</a></span>&nbsp;<span class="op" id="1198280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1198284">actual</span>&nbsp;<span class="op" id="1198291">:=</span>&nbsp;<span class="ident" id="1198294"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1198301">.</span><span class="ident" id="1198302">RoundDown10</span><span class="op" id="1198313">(</span><span class="ident" id="1198314"><a href="/testing/benchmark_test.go.html#1198253">tt</a></span><span class="op" id="1198316">.</span><span class="ident" id="1198317">v</span><span class="op" id="1198318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1198322">if</span>&nbsp;<span class="ident" id="1198325"><a href="/testing/benchmark_test.go.html#1198253">tt</a></span><span class="op" id="1198327">.</span><span class="ident" id="1198328">expected</span>&nbsp;<span class="op" id="1198337">!=</span>&nbsp;<span class="ident" id="1198340"><a href="/testing/benchmark_test.go.html#1198284">actual</a></span>&nbsp;<span class="op" id="1198347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1198352"><a href="/testing/benchmark_test.go.html#1198229">t</a></span><span class="op" id="1198353">.</span><span class="ident" id="1198354">Errorf</span><span class="op" id="1198360">(</span><span class="string" id="1198361">&#34;roundDown10(%d):&nbsp;expected&nbsp;%d,&nbsp;actual&nbsp;%d&#34;</span><span class="op" id="1198402">,</span>&nbsp;<span class="ident" id="1198404"><a href="/testing/benchmark_test.go.html#1198253">tt</a></span><span class="op" id="1198406">.</span><span class="ident" id="1198407">v</span><span class="op" id="1198408">,</span>&nbsp;<span class="ident" id="1198410"><a href="/testing/benchmark_test.go.html#1198253">tt</a></span><span class="op" id="1198412">.</span><span class="ident" id="1198413">expected</span><span class="op" id="1198421">,</span>&nbsp;<span class="ident" id="1198423"><a href="/testing/benchmark_test.go.html#1198284">actual</a></span><span class="op" id="1198429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198433">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198436">}</span><br>
<span class="lineno"></span><span class="op" id="1198438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1198441">var</span>&nbsp;<span class="ident" id="1198445">roundUpTests</span>&nbsp;<span class="op" id="1198458">=</span>&nbsp;<span class="op" id="1198460">[</span><span class="op" id="1198461">]</span><span class="keyword" id="1198462">struct</span>&nbsp;<span class="op" id="1198469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1198472">v</span><span class="op" id="1198473">,</span>&nbsp;<span class="ident" id="1198475">expected</span>&nbsp;<span class="builtintype" id="1198484">int</span><br>
<span class="lineno">40</span><span class="op" id="1198488">}</span><span class="op" id="1198489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198492">{</span><span class="num" id="1198493">0</span><span class="op" id="1198494">,</span>&nbsp;<span class="num" id="1198496">1</span><span class="op" id="1198497">}</span><span class="op" id="1198498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198501">{</span><span class="num" id="1198502">1</span><span class="op" id="1198503">,</span>&nbsp;<span class="num" id="1198505">1</span><span class="op" id="1198506">}</span><span class="op" id="1198507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198510">{</span><span class="num" id="1198511">2</span><span class="op" id="1198512">,</span>&nbsp;<span class="num" id="1198514">2</span><span class="op" id="1198515">}</span><span class="op" id="1198516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198519">{</span><span class="num" id="1198520">3</span><span class="op" id="1198521">,</span>&nbsp;<span class="num" id="1198523">3</span><span class="op" id="1198524">}</span><span class="op" id="1198525">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198528">{</span><span class="num" id="1198529">5</span><span class="op" id="1198530">,</span>&nbsp;<span class="num" id="1198532">5</span><span class="op" id="1198533">}</span><span class="op" id="1198534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198537">{</span><span class="num" id="1198538">9</span><span class="op" id="1198539">,</span>&nbsp;<span class="num" id="1198541">10</span><span class="op" id="1198543">}</span><span class="op" id="1198544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198547">{</span><span class="num" id="1198548">999</span><span class="op" id="1198551">,</span>&nbsp;<span class="num" id="1198553">1000</span><span class="op" id="1198557">}</span><span class="op" id="1198558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198561">{</span><span class="num" id="1198562">1000</span><span class="op" id="1198566">,</span>&nbsp;<span class="num" id="1198568">1000</span><span class="op" id="1198572">}</span><span class="op" id="1198573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198576">{</span><span class="num" id="1198577">1400</span><span class="op" id="1198581">,</span>&nbsp;<span class="num" id="1198583">2000</span><span class="op" id="1198587">}</span><span class="op" id="1198588">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198591">{</span><span class="num" id="1198592">1700</span><span class="op" id="1198596">,</span>&nbsp;<span class="num" id="1198598">2000</span><span class="op" id="1198602">}</span><span class="op" id="1198603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198606">{</span><span class="num" id="1198607">2700</span><span class="op" id="1198611">,</span>&nbsp;<span class="num" id="1198613">3000</span><span class="op" id="1198617">}</span><span class="op" id="1198618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198621">{</span><span class="num" id="1198622">4999</span><span class="op" id="1198626">,</span>&nbsp;<span class="num" id="1198628">5000</span><span class="op" id="1198632">}</span><span class="op" id="1198633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198636">{</span><span class="num" id="1198637">5000</span><span class="op" id="1198641">,</span>&nbsp;<span class="num" id="1198643">5000</span><span class="op" id="1198647">}</span><span class="op" id="1198648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198651">{</span><span class="num" id="1198652">5001</span><span class="op" id="1198656">,</span>&nbsp;<span class="num" id="1198658">10000</span><span class="op" id="1198663">}</span><span class="op" id="1198664">,</span><br>
<span class="lineno">55</span><span class="op" id="1198666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1198669">func</span>&nbsp;<span class="ident" id="1198674">TestRoundUp</span><span class="op" id="1198685">(</span><span class="ident" id="1198686">t</span>&nbsp;<span class="op" id="1198688">*</span><span class="ident" id="1198689"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1198696">.</span><span class="ident" id="1198697">T</span><span class="op" id="1198698">)</span>&nbsp;<span class="op" id="1198700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1198703">for</span>&nbsp;<span class="ident" id="1198707">_</span><span class="op" id="1198708">,</span>&nbsp;<span class="ident" id="1198710">tt</span>&nbsp;<span class="op" id="1198713">:=</span>&nbsp;<span class="keyword" id="1198716">range</span>&nbsp;<span class="ident" id="1198722"><a href="/testing/benchmark_test.go.html#1198445">roundUpTests</a></span>&nbsp;<span class="op" id="1198735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1198739">actual</span>&nbsp;<span class="op" id="1198746">:=</span>&nbsp;<span class="ident" id="1198749"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1198756">.</span><span class="ident" id="1198757">RoundUp</span><span class="op" id="1198764">(</span><span class="ident" id="1198765"><a href="/testing/benchmark_test.go.html#1198710">tt</a></span><span class="op" id="1198767">.</span><span class="ident" id="1198768">v</span><span class="op" id="1198769">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1198773">if</span>&nbsp;<span class="ident" id="1198776"><a href="/testing/benchmark_test.go.html#1198710">tt</a></span><span class="op" id="1198778">.</span><span class="ident" id="1198779">expected</span>&nbsp;<span class="op" id="1198788">!=</span>&nbsp;<span class="ident" id="1198791"><a href="/testing/benchmark_test.go.html#1198739">actual</a></span>&nbsp;<span class="op" id="1198798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1198803"><a href="/testing/benchmark_test.go.html#1198686">t</a></span><span class="op" id="1198804">.</span><span class="ident" id="1198805">Errorf</span><span class="op" id="1198811">(</span><span class="string" id="1198812">&#34;roundUp(%d):&nbsp;expected&nbsp;%d,&nbsp;actual&nbsp;%d&#34;</span><span class="op" id="1198849">,</span>&nbsp;<span class="ident" id="1198851"><a href="/testing/benchmark_test.go.html#1198710">tt</a></span><span class="op" id="1198853">.</span><span class="ident" id="1198854">v</span><span class="op" id="1198855">,</span>&nbsp;<span class="ident" id="1198857"><a href="/testing/benchmark_test.go.html#1198710">tt</a></span><span class="op" id="1198859">.</span><span class="ident" id="1198860">expected</span><span class="op" id="1198868">,</span>&nbsp;<span class="ident" id="1198870"><a href="/testing/benchmark_test.go.html#1198739">actual</a></span><span class="op" id="1198876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1198883">}</span><br>
<span class="lineno"></span><span class="op" id="1198885">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="1198888">func</span>&nbsp;<span class="ident" id="1198893">TestRunParallel</span><span class="op" id="1198908">(</span><span class="ident" id="1198909">t</span>&nbsp;<span class="op" id="1198911">*</span><span class="ident" id="1198912"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1198919">.</span><span class="ident" id="1198920">T</span><span class="op" id="1198921">)</span>&nbsp;<span class="op" id="1198923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1198926"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1198933">.</span><span class="ident" id="1198934">Benchmark</span><span class="op" id="1198943">(</span><span class="keyword" id="1198944">func</span><span class="op" id="1198948">(</span><span class="ident" id="1198949">b</span>&nbsp;<span class="op" id="1198951">*</span><span class="ident" id="1198952"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1198959">.</span><span class="ident" id="1198960">B</span><span class="op" id="1198961">)</span>&nbsp;<span class="op" id="1198963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1198967">procs</span>&nbsp;<span class="op" id="1198973">:=</span>&nbsp;<span class="builtintype" id="1198976">uint32</span><span class="op" id="1198982">(</span><span class="num" id="1198983">0</span><span class="op" id="1198984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1198988">iters</span>&nbsp;<span class="op" id="1198994">:=</span>&nbsp;<span class="ident" id="1198997">uint64</span><span class="op" id="1199003">(</span><span class="num" id="1199004">0</span><span class="op" id="1199005">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199009"><a href="/testing/benchmark_test.go.html#1198949">b</a></span><span class="op" id="1199010">.</span><span class="ident" id="1199011">SetParallelism</span><span class="op" id="1199025">(</span><span class="num" id="1199026">3</span><span class="op" id="1199027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199031"><a href="/testing/benchmark_test.go.html#1198949">b</a></span><span class="op" id="1199032">.</span><span class="ident" id="1199033">RunParallel</span><span class="op" id="1199044">(</span><span class="keyword" id="1199045">func</span><span class="op" id="1199049">(</span><span class="ident" id="1199050">pb</span>&nbsp;<span class="op" id="1199053">*</span><span class="ident" id="1199054"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1199061">.</span><span class="ident" id="1199062">PB</span><span class="op" id="1199064">)</span>&nbsp;<span class="op" id="1199066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199071"><a href="/testing/benchmark_test.go.html#1197999">atomic</a></span><span class="op" id="1199077">.</span><span class="ident" id="1199078">AddUint32</span><span class="op" id="1199087">(</span><span class="op" id="1199088">&amp;</span><span class="ident" id="1199089"><a href="/testing/benchmark_test.go.html#1198967">procs</a></span><span class="op" id="1199094">,</span>&nbsp;<span class="num" id="1199096">1</span><span class="op" id="1199097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1199102">for</span>&nbsp;<span class="ident" id="1199106"><a href="/testing/benchmark_test.go.html#1199050">pb</a></span><span class="op" id="1199108">.</span><span class="ident" id="1199109">Next</span><span class="op" id="1199113">(</span><span class="op" id="1199114">)</span>&nbsp;<span class="op" id="1199116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199122"><a href="/testing/benchmark_test.go.html#1197999">atomic</a></span><span class="op" id="1199128">.</span><span class="ident" id="1199129">AddUint64</span><span class="op" id="1199138">(</span><span class="op" id="1199139">&amp;</span><span class="ident" id="1199140"><a href="/testing/benchmark_test.go.html#1198988">iters</a></span><span class="op" id="1199145">,</span>&nbsp;<span class="num" id="1199147">1</span><span class="op" id="1199148">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1199153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1199157">}</span><span class="op" id="1199158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1199162">if</span>&nbsp;<span class="ident" id="1199165">want</span>&nbsp;<span class="op" id="1199170">:=</span>&nbsp;<span class="builtintype" id="1199173">uint32</span><span class="op" id="1199179">(</span><span class="num" id="1199180">3</span>&nbsp;<span class="op" id="1199182">*</span>&nbsp;<span class="ident" id="1199184"><a href="/testing/benchmark_test.go.html#1197988">runtime</a></span><span class="op" id="1199191">.</span><span class="ident" id="1199192">GOMAXPROCS</span><span class="op" id="1199202">(</span><span class="num" id="1199203">0</span><span class="op" id="1199204">)</span><span class="op" id="1199205">)</span><span class="op" id="1199206">;</span>&nbsp;<span class="ident" id="1199208"><a href="/testing/benchmark_test.go.html#1198967">procs</a></span>&nbsp;<span class="op" id="1199214">!=</span>&nbsp;<span class="ident" id="1199217"><a href="/testing/benchmark_test.go.html#1199165">want</a></span>&nbsp;<span class="op" id="1199222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199227"><a href="/testing/benchmark_test.go.html#1198909">t</a></span><span class="op" id="1199228">.</span><span class="ident" id="1199229">Errorf</span><span class="op" id="1199235">(</span><span class="string" id="1199236">&#34;got&nbsp;%v&nbsp;procs,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="1199259">,</span>&nbsp;<span class="ident" id="1199261"><a href="/testing/benchmark_test.go.html#1198967">procs</a></span><span class="op" id="1199266">,</span>&nbsp;<span class="ident" id="1199268"><a href="/testing/benchmark_test.go.html#1199165">want</a></span><span class="op" id="1199272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1199276">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1199280">if</span>&nbsp;<span class="ident" id="1199283"><a href="/testing/benchmark_test.go.html#1198988">iters</a></span>&nbsp;<span class="op" id="1199289">!=</span>&nbsp;<span class="ident" id="1199292">uint64</span><span class="op" id="1199298">(</span><span class="ident" id="1199299"><a href="/testing/benchmark_test.go.html#1198949">b</a></span><span class="op" id="1199300">.</span><span class="ident" id="1199301">N</span><span class="op" id="1199302">)</span>&nbsp;<span class="op" id="1199304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199309"><a href="/testing/benchmark_test.go.html#1198909">t</a></span><span class="op" id="1199310">.</span><span class="ident" id="1199311">Errorf</span><span class="op" id="1199317">(</span><span class="string" id="1199318">&#34;got&nbsp;%v&nbsp;iters,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="1199341">,</span>&nbsp;<span class="ident" id="1199343"><a href="/testing/benchmark_test.go.html#1198988">iters</a></span><span class="op" id="1199348">,</span>&nbsp;<span class="ident" id="1199350"><a href="/testing/benchmark_test.go.html#1198949">b</a></span><span class="op" id="1199351">.</span><span class="ident" id="1199352">N</span><span class="op" id="1199353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1199357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1199360">}</span><span class="op" id="1199361">)</span><br>
<span class="lineno"></span><span class="op" id="1199363">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="1199366">func</span>&nbsp;<span class="ident" id="1199371">TestRunParallelFail</span><span class="op" id="1199390">(</span><span class="ident" id="1199391">t</span>&nbsp;<span class="op" id="1199393">*</span><span class="ident" id="1199394"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1199401">.</span><span class="ident" id="1199402">T</span><span class="op" id="1199403">)</span>&nbsp;<span class="op" id="1199405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199408"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1199415">.</span><span class="ident" id="1199416">Benchmark</span><span class="op" id="1199425">(</span><span class="keyword" id="1199426">func</span><span class="op" id="1199430">(</span><span class="ident" id="1199431">b</span>&nbsp;<span class="op" id="1199433">*</span><span class="ident" id="1199434"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1199441">.</span><span class="ident" id="1199442">B</span><span class="op" id="1199443">)</span>&nbsp;<span class="op" id="1199445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199449"><a href="/testing/benchmark_test.go.html#1199431">b</a></span><span class="op" id="1199450">.</span><span class="ident" id="1199451">RunParallel</span><span class="op" id="1199462">(</span><span class="keyword" id="1199463">func</span><span class="op" id="1199467">(</span><span class="ident" id="1199468">pb</span>&nbsp;<span class="op" id="1199471">*</span><span class="ident" id="1199472"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1199479">.</span><span class="ident" id="1199480">PB</span><span class="op" id="1199482">)</span>&nbsp;<span class="op" id="1199484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1199489">//&nbsp;The&nbsp;function&nbsp;must&nbsp;be&nbsp;able&nbsp;to&nbsp;log/abort</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1199534">//&nbsp;w/o&nbsp;crashing/deadlocking&nbsp;the&nbsp;whole&nbsp;benchmark.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199586"><a href="/testing/benchmark_test.go.html#1199431">b</a></span><span class="op" id="1199587">.</span><span class="ident" id="1199588">Log</span><span class="op" id="1199591">(</span><span class="string" id="1199592">&#34;log&#34;</span><span class="op" id="1199597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199602"><a href="/testing/benchmark_test.go.html#1199431">b</a></span><span class="op" id="1199603">.</span><span class="ident" id="1199604">Error</span><span class="op" id="1199609">(</span><span class="string" id="1199610">&#34;error&#34;</span><span class="op" id="1199617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1199621">}</span><span class="op" id="1199622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1199625">}</span><span class="op" id="1199626">)</span><br>
<span class="lineno">95</span><span class="op" id="1199628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1199631">func</span>&nbsp;<span class="ident" id="1199636">ExampleB_RunParallel</span><span class="op" id="1199656">(</span><span class="op" id="1199657">)</span>&nbsp;<span class="op" id="1199659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1199662">//&nbsp;Parallel&nbsp;benchmark&nbsp;for&nbsp;text/template.Template.Execute&nbsp;on&nbsp;a&nbsp;single&nbsp;object.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199740"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1199747">.</span><span class="ident" id="1199748">Benchmark</span><span class="op" id="1199757">(</span><span class="keyword" id="1199758">func</span><span class="op" id="1199762">(</span><span class="ident" id="1199763">b</span>&nbsp;<span class="op" id="1199765">*</span><span class="ident" id="1199766"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1199773">.</span><span class="ident" id="1199774">B</span><span class="op" id="1199775">)</span>&nbsp;<span class="op" id="1199777">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199781">templ</span>&nbsp;<span class="op" id="1199787">:=</span>&nbsp;<span class="ident" id="1199790"><a href="/testing/benchmark_test.go.html#1198025">template</a></span><span class="op" id="1199798">.</span><span class="ident" id="1199799">Must</span><span class="op" id="1199803">(</span><span class="ident" id="1199804"><a href="/testing/benchmark_test.go.html#1198025">template</a></span><span class="op" id="1199812">.</span><span class="ident" id="1199813">New</span><span class="op" id="1199816">(</span><span class="string" id="1199817">&#34;test&#34;</span><span class="op" id="1199823">)</span><span class="op" id="1199824">.</span><span class="ident" id="1199825">Parse</span><span class="op" id="1199830">(</span><span class="string" id="1199831">&#34;Hello,&nbsp;{{.}}!&#34;</span><span class="op" id="1199846">)</span><span class="op" id="1199847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1199851">//&nbsp;RunParallel&nbsp;will&nbsp;create&nbsp;GOMAXPROCS&nbsp;goroutines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1199902">//&nbsp;and&nbsp;distribute&nbsp;work&nbsp;among&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1199939"><a href="/testing/benchmark_test.go.html#1199763">b</a></span><span class="op" id="1199940">.</span><span class="ident" id="1199941">RunParallel</span><span class="op" id="1199952">(</span><span class="keyword" id="1199953">func</span><span class="op" id="1199957">(</span><span class="ident" id="1199958">pb</span>&nbsp;<span class="op" id="1199961">*</span><span class="ident" id="1199962"><a href="/testing/benchmark_test.go.html#1198014">testing</a></span><span class="op" id="1199969">.</span><span class="ident" id="1199970">PB</span><span class="op" id="1199972">)</span>&nbsp;<span class="op" id="1199974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1199979">//&nbsp;Each&nbsp;goroutine&nbsp;has&nbsp;its&nbsp;own&nbsp;bytes.Buffer.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1200026">var</span>&nbsp;<span class="ident" id="1200030">buf</span>&nbsp;<span class="ident" id="1200034"><a href="/testing/benchmark_test.go.html#1197979">bytes</a></span><span class="op" id="1200039">.</span><span class="ident" id="1200040">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1200050">for</span>&nbsp;<span class="ident" id="1200054"><a href="/testing/benchmark_test.go.html#1199958">pb</a></span><span class="op" id="1200056">.</span><span class="ident" id="1200057">Next</span><span class="op" id="1200061">(</span><span class="op" id="1200062">)</span>&nbsp;<span class="op" id="1200064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1200070">//&nbsp;The&nbsp;loop&nbsp;body&nbsp;is&nbsp;executed&nbsp;b.N&nbsp;times&nbsp;total&nbsp;across&nbsp;all&nbsp;goroutines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1200142"><a href="/testing/benchmark_test.go.html#1200030">buf</a></span><span class="op" id="1200145">.</span><span class="ident" id="1200146">Reset</span><span class="op" id="1200151">(</span><span class="op" id="1200152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1200158"><a href="/testing/benchmark_test.go.html#1199781">templ</a></span><span class="op" id="1200163">.</span><span class="ident" id="1200164">Execute</span><span class="op" id="1200171">(</span><span class="op" id="1200172">&amp;</span><span class="ident" id="1200173"><a href="/testing/benchmark_test.go.html#1200030">buf</a></span><span class="op" id="1200176">,</span>&nbsp;<span class="string" id="1200178">&#34;World&#34;</span><span class="op" id="1200185">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1200190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1200194">}</span><span class="op" id="1200195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1200198">}</span><span class="op" id="1200199">)</span><br>
<span class="lineno"></span><span class="op" id="1200201">}</span>
</div>
</body>
</html>
