<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp/syntax</h2>
<ul>
<li><a href="/gostd/regexp/syntax/compile.go.html">compile.go</a></li>
<li><a href="/gostd/regexp/syntax/doc.go.html">doc.go</a></li>
<li><a href="/gostd/regexp/syntax/parse.go.html">parse.go</a></li>
<li><a href="/gostd/regexp/syntax/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/regexp/syntax/perl_groups.go.html">perl_groups.go</a></li>
<li><a href="/gostd/regexp/syntax/prog.go.html">prog.go</a></li>
<li><a href="/gostd/regexp/syntax/prog_test.go.html">prog_test.go</a></li>
<li><a href="/gostd/regexp/syntax/regexp.go.html">regexp.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify.go.html">simplify.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify_test.go.html">simplify_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5607097">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5607152">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5607206">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5607257">package</span>&nbsp;<span class="ident" id="5607265">syntax</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5607273">import</span>&nbsp;<span class="op" id="5607280">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607283">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607292">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607303">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="5607313">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5607316">//&nbsp;Compiled&nbsp;program.</span><br>
<span class="lineno"></span><span class="comment" id="5607337">//&nbsp;May&nbsp;not&nbsp;belong&nbsp;in&nbsp;this&nbsp;package,&nbsp;but&nbsp;convenient&nbsp;for&nbsp;now.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="5607397">//&nbsp;A&nbsp;Prog&nbsp;is&nbsp;a&nbsp;compiled&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="5607449">type</span>&nbsp;<span class="ident" id="5607454">Prog</span>&nbsp;<span class="keyword" id="5607459">struct</span>&nbsp;<span class="op" id="5607466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607469">Inst</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5607476">[</span><span class="op" id="5607477">]</span><span class="ident" id="5607478">Inst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607484">Start</span>&nbsp;&nbsp;<span class="builtintype" id="5607491">int</span>&nbsp;<span class="comment" id="5607495">//&nbsp;index&nbsp;of&nbsp;start&nbsp;instruction</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607526">NumCap</span>&nbsp;<span class="builtintype" id="5607533">int</span>&nbsp;<span class="comment" id="5607537">//&nbsp;number&nbsp;of&nbsp;InstCapture&nbsp;insts&nbsp;in&nbsp;re</span><br>
<span class="lineno"></span><span class="op" id="5607574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5607577">//&nbsp;An&nbsp;InstOp&nbsp;is&nbsp;an&nbsp;instruction&nbsp;opcode.</span><br>
<span class="lineno"></span><span class="keyword" id="5607616">type</span>&nbsp;<span class="ident" id="5607621">InstOp</span>&nbsp;<span class="builtintype" id="5607628">uint8</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="5607635">const</span>&nbsp;<span class="op" id="5607641">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607644">InstAlt</span>&nbsp;<span class="ident" id="5607652">InstOp</span>&nbsp;<span class="op" id="5607659">=</span>&nbsp;<span class="ident" id="5607661">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607667">InstAltMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607681">InstCapture</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607694">InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607710">InstMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607721">InstFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607731">InstNop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607740">InstRune</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607750">InstRune1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607761">InstRuneAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5607774">InstRuneAnyNotNL</span><br>
<span class="lineno"></span><span class="op" id="5607791">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="5607794">var</span>&nbsp;<span class="ident" id="5607798">instOpNames</span>&nbsp;<span class="op" id="5607810">=</span>&nbsp;<span class="op" id="5607812">[</span><span class="op" id="5607813">]</span><span class="builtintype" id="5607814">string</span><span class="op" id="5607820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607823">&#34;InstAlt&#34;</span><span class="op" id="5607832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607835">&#34;InstAltMatch&#34;</span><span class="op" id="5607849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607852">&#34;InstCapture&#34;</span><span class="op" id="5607865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607868">&#34;InstEmptyWidth&#34;</span><span class="op" id="5607884">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607887">&#34;InstMatch&#34;</span><span class="op" id="5607898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607901">&#34;InstFail&#34;</span><span class="op" id="5607911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607914">&#34;InstNop&#34;</span><span class="op" id="5607923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607926">&#34;InstRune&#34;</span><span class="op" id="5607936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607939">&#34;InstRune1&#34;</span><span class="op" id="5607950">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607953">&#34;InstRuneAny&#34;</span><span class="op" id="5607966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607969">&#34;InstRuneAnyNotNL&#34;</span><span class="op" id="5607987">,</span><br>
<span class="lineno"></span><span class="op" id="5607989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5607992">func</span>&nbsp;<span class="op" id="5607997">(</span><span class="ident" id="5607998">i</span>&nbsp;<span class="ident" id="5608000">InstOp</span><span class="op" id="5608006">)</span>&nbsp;<span class="ident" id="5608008">String</span><span class="op" id="5608014">(</span><span class="op" id="5608015">)</span>&nbsp;<span class="builtintype" id="5608017">string</span>&nbsp;<span class="op" id="5608024">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608027">if</span>&nbsp;<span class="builtintype" id="5608030">uint</span><span class="op" id="5608034">(</span><span class="ident" id="5608035">i</span><span class="op" id="5608036">)</span>&nbsp;<span class="op" id="5608038">&gt;=</span>&nbsp;<span class="builtintype" id="5608041">uint</span><span class="op" id="5608045">(</span><span class="builtinfunc" id="5608046">len</span><span class="op" id="5608049">(</span><span class="ident" id="5608050">instOpNames</span><span class="op" id="5608061">)</span><span class="op" id="5608062">)</span>&nbsp;<span class="op" id="5608064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608068">return</span>&nbsp;<span class="string" id="5608075">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5608079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608082">return</span>&nbsp;<span class="ident" id="5608089">instOpNames</span><span class="op" id="5608100">[</span><span class="ident" id="5608101">i</span><span class="op" id="5608102">]</span><br>
<span class="lineno"></span><span class="op" id="5608104">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5608107">//&nbsp;An&nbsp;EmptyOp&nbsp;specifies&nbsp;a&nbsp;kind&nbsp;or&nbsp;mixture&nbsp;of&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="keyword" id="5608175">type</span>&nbsp;<span class="ident" id="5608180">EmptyOp</span>&nbsp;<span class="builtintype" id="5608188">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5608195">const</span>&nbsp;<span class="op" id="5608201">(</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608204">EmptyBeginLine</span>&nbsp;<span class="ident" id="5608219">EmptyOp</span>&nbsp;<span class="op" id="5608227">=</span>&nbsp;<span class="num" id="5608229">1</span>&nbsp;<span class="op" id="5608231">&lt;&lt;</span>&nbsp;<span class="ident" id="5608234">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608240">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608254">EmptyBeginText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608270">EmptyEndText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608284">EmptyWordBoundary</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608303">EmptyNoWordBoundary</span><br>
<span class="lineno"></span><span class="op" id="5608323">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5608326">//&nbsp;EmptyOpContext&nbsp;returns&nbsp;the&nbsp;zero-width&nbsp;assertions</span><br>
<span class="lineno"></span><span class="comment" id="5608378">//&nbsp;satisfied&nbsp;at&nbsp;the&nbsp;position&nbsp;between&nbsp;the&nbsp;runes&nbsp;r1&nbsp;and&nbsp;r2.</span><br>
<span class="lineno">75</span><span class="comment" id="5608436">//&nbsp;Passing&nbsp;r1&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5608487">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="5608520">//&nbsp;Passing&nbsp;r2&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5608571">//&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="5608598">func</span>&nbsp;<span class="ident" id="5608603">EmptyOpContext</span><span class="op" id="5608617">(</span><span class="ident" id="5608618">r1</span><span class="op" id="5608620">,</span>&nbsp;<span class="ident" id="5608622">r2</span>&nbsp;<span class="builtintype" id="5608625">rune</span><span class="op" id="5608629">)</span>&nbsp;<span class="ident" id="5608631">EmptyOp</span>&nbsp;<span class="op" id="5608639">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608642">var</span>&nbsp;<span class="ident" id="5608646">op</span>&nbsp;<span class="ident" id="5608649">EmptyOp</span>&nbsp;<span class="op" id="5608657">=</span>&nbsp;<span class="ident" id="5608659">EmptyNoWordBoundary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608680">var</span>&nbsp;<span class="ident" id="5608684">boundary</span>&nbsp;<span class="builtintype" id="5608693">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608699">switch</span>&nbsp;<span class="op" id="5608706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608709">case</span>&nbsp;<span class="ident" id="5608714">IsWordChar</span><span class="op" id="5608724">(</span><span class="ident" id="5608725">r1</span><span class="op" id="5608727">)</span><span class="op" id="5608728">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608732">boundary</span>&nbsp;<span class="op" id="5608741">=</span>&nbsp;<span class="num" id="5608743">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608746">case</span>&nbsp;<span class="ident" id="5608751">r1</span>&nbsp;<span class="op" id="5608754">==</span>&nbsp;<span class="string" id="5608757">&#39;\n&#39;</span><span class="op" id="5608761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608765">op</span>&nbsp;<span class="op" id="5608768">|=</span>&nbsp;<span class="ident" id="5608771">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608787">case</span>&nbsp;<span class="ident" id="5608792">r1</span>&nbsp;<span class="op" id="5608795">&lt;</span>&nbsp;<span class="num" id="5608797">0</span><span class="op" id="5608798">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608802">op</span>&nbsp;<span class="op" id="5608805">|=</span>&nbsp;<span class="ident" id="5608808">EmptyBeginText</span>&nbsp;<span class="op" id="5608823">|</span>&nbsp;<span class="ident" id="5608825">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5608841">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608844">switch</span>&nbsp;<span class="op" id="5608851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608854">case</span>&nbsp;<span class="ident" id="5608859">IsWordChar</span><span class="op" id="5608869">(</span><span class="ident" id="5608870">r2</span><span class="op" id="5608872">)</span><span class="op" id="5608873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608877">boundary</span>&nbsp;<span class="op" id="5608886">^=</span>&nbsp;<span class="num" id="5608889">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608892">case</span>&nbsp;<span class="ident" id="5608897">r2</span>&nbsp;<span class="op" id="5608900">==</span>&nbsp;<span class="string" id="5608903">&#39;\n&#39;</span><span class="op" id="5608907">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608911">op</span>&nbsp;<span class="op" id="5608914">|=</span>&nbsp;<span class="ident" id="5608917">EmptyEndLine</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608931">case</span>&nbsp;<span class="ident" id="5608936">r2</span>&nbsp;<span class="op" id="5608939">&lt;</span>&nbsp;<span class="num" id="5608941">0</span><span class="op" id="5608942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608946">op</span>&nbsp;<span class="op" id="5608949">|=</span>&nbsp;<span class="ident" id="5608952">EmptyEndText</span>&nbsp;<span class="op" id="5608965">|</span>&nbsp;<span class="ident" id="5608967">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5608981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5608984">if</span>&nbsp;<span class="ident" id="5608987">boundary</span>&nbsp;<span class="op" id="5608996">!=</span>&nbsp;<span class="num" id="5608999">0</span>&nbsp;<span class="op" id="5609001">{</span>&nbsp;<span class="comment" id="5609003">//&nbsp;IsWordChar(r1)&nbsp;!=&nbsp;IsWordChar(r2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609041">op</span>&nbsp;<span class="op" id="5609044">^=</span>&nbsp;<span class="op" id="5609047">(</span><span class="ident" id="5609048">EmptyWordBoundary</span>&nbsp;<span class="op" id="5609066">|</span>&nbsp;<span class="ident" id="5609068">EmptyNoWordBoundary</span><span class="op" id="5609087">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5609090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5609093">return</span>&nbsp;<span class="ident" id="5609100">op</span><br>
<span class="lineno"></span><span class="op" id="5609103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5609106">//&nbsp;IsWordChar&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;consider&nbsp;a&nbsp;``word&nbsp;character&#39;&#39;</span><br>
<span class="lineno">105</span><span class="comment" id="5609171">//&nbsp;during&nbsp;the&nbsp;evaluation&nbsp;of&nbsp;the&nbsp;\b&nbsp;and&nbsp;\B&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="comment" id="5609236">//&nbsp;These&nbsp;assertions&nbsp;are&nbsp;ASCII-only:&nbsp;the&nbsp;word&nbsp;characters&nbsp;are&nbsp;[A-Za-z0-9_].</span><br>
<span class="lineno"></span><span class="keyword" id="5609310">func</span>&nbsp;<span class="ident" id="5609315">IsWordChar</span><span class="op" id="5609325">(</span><span class="ident" id="5609326">r</span>&nbsp;<span class="builtintype" id="5609328">rune</span><span class="op" id="5609332">)</span>&nbsp;<span class="builtintype" id="5609334">bool</span>&nbsp;<span class="op" id="5609339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5609342">return</span>&nbsp;<span class="string" id="5609349">&#39;A&#39;</span>&nbsp;<span class="op" id="5609353">&lt;=</span>&nbsp;<span class="ident" id="5609356">r</span>&nbsp;<span class="op" id="5609358">&amp;&amp;</span>&nbsp;<span class="ident" id="5609361">r</span>&nbsp;<span class="op" id="5609363">&lt;=</span>&nbsp;<span class="string" id="5609366">&#39;Z&#39;</span>&nbsp;<span class="op" id="5609370">||</span>&nbsp;<span class="string" id="5609373">&#39;a&#39;</span>&nbsp;<span class="op" id="5609377">&lt;=</span>&nbsp;<span class="ident" id="5609380">r</span>&nbsp;<span class="op" id="5609382">&amp;&amp;</span>&nbsp;<span class="ident" id="5609385">r</span>&nbsp;<span class="op" id="5609387">&lt;=</span>&nbsp;<span class="string" id="5609390">&#39;z&#39;</span>&nbsp;<span class="op" id="5609394">||</span>&nbsp;<span class="string" id="5609397">&#39;0&#39;</span>&nbsp;<span class="op" id="5609401">&lt;=</span>&nbsp;<span class="ident" id="5609404">r</span>&nbsp;<span class="op" id="5609406">&amp;&amp;</span>&nbsp;<span class="ident" id="5609409">r</span>&nbsp;<span class="op" id="5609411">&lt;=</span>&nbsp;<span class="string" id="5609414">&#39;9&#39;</span>&nbsp;<span class="op" id="5609418">||</span>&nbsp;<span class="ident" id="5609421">r</span>&nbsp;<span class="op" id="5609423">==</span>&nbsp;<span class="string" id="5609426">&#39;_&#39;</span><br>
<span class="lineno"></span><span class="op" id="5609430">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5609433">//&nbsp;An&nbsp;Inst&nbsp;is&nbsp;a&nbsp;single&nbsp;instruction&nbsp;in&nbsp;a&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="5609501">type</span>&nbsp;<span class="ident" id="5609506">Inst</span>&nbsp;<span class="keyword" id="5609511">struct</span>&nbsp;<span class="op" id="5609518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609521">Op</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5609526">InstOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609534">Out</span>&nbsp;&nbsp;<span class="builtintype" id="5609539">uint32</span>&nbsp;<span class="comment" id="5609546">//&nbsp;all&nbsp;but&nbsp;InstMatch,&nbsp;InstFail</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609578">Arg</span>&nbsp;&nbsp;<span class="builtintype" id="5609583">uint32</span>&nbsp;<span class="comment" id="5609590">//&nbsp;InstAlt,&nbsp;InstAltMatch,&nbsp;InstCapture,&nbsp;InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609645">Rune</span>&nbsp;<span class="op" id="5609650">[</span><span class="op" id="5609651">]</span><span class="builtintype" id="5609652">rune</span><br>
<span class="lineno"></span><span class="op" id="5609657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5609660">func</span>&nbsp;<span class="op" id="5609665">(</span><span class="ident" id="5609666">p</span>&nbsp;<span class="op" id="5609668">*</span><span class="ident" id="5609669">Prog</span><span class="op" id="5609673">)</span>&nbsp;<span class="ident" id="5609675">String</span><span class="op" id="5609681">(</span><span class="op" id="5609682">)</span>&nbsp;<span class="builtintype" id="5609684">string</span>&nbsp;<span class="op" id="5609691">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5609694">var</span>&nbsp;<span class="ident" id="5609698">b</span>&nbsp;<span class="ident" id="5609700">bytes</span><span class="op" id="5609705">.</span><span class="ident" id="5609706">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609714">dumpProg</span><span class="op" id="5609722">(</span><span class="op" id="5609723">&amp;</span><span class="ident" id="5609724">b</span><span class="op" id="5609725">,</span>&nbsp;<span class="ident" id="5609727">p</span><span class="op" id="5609728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5609731">return</span>&nbsp;<span class="ident" id="5609738">b</span><span class="op" id="5609739">.</span><span class="ident" id="5609740">String</span><span class="op" id="5609746">(</span><span class="op" id="5609747">)</span><br>
<span class="lineno"></span><span class="op" id="5609749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5609752">//&nbsp;skipNop&nbsp;follows&nbsp;any&nbsp;no-op&nbsp;or&nbsp;capturing&nbsp;instructions</span><br>
<span class="lineno"></span><span class="comment" id="5609807">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;pc.</span><br>
<span class="lineno"></span><span class="keyword" id="5609840">func</span>&nbsp;<span class="op" id="5609845">(</span><span class="ident" id="5609846">p</span>&nbsp;<span class="op" id="5609848">*</span><span class="ident" id="5609849">Prog</span><span class="op" id="5609853">)</span>&nbsp;<span class="ident" id="5609855">skipNop</span><span class="op" id="5609862">(</span><span class="ident" id="5609863">pc</span>&nbsp;<span class="builtintype" id="5609866">uint32</span><span class="op" id="5609872">)</span>&nbsp;<span class="op" id="5609874">(</span><span class="op" id="5609875">*</span><span class="ident" id="5609876">Inst</span><span class="op" id="5609880">,</span>&nbsp;<span class="builtintype" id="5609882">uint32</span><span class="op" id="5609888">)</span>&nbsp;<span class="op" id="5609890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609893">i</span>&nbsp;<span class="op" id="5609895">:=</span>&nbsp;<span class="op" id="5609898">&amp;</span><span class="ident" id="5609899">p</span><span class="op" id="5609900">.</span><span class="ident" id="5609901">Inst</span><span class="op" id="5609905">[</span><span class="ident" id="5609906">pc</span><span class="op" id="5609908">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5609911">for</span>&nbsp;<span class="ident" id="5609915">i</span><span class="op" id="5609916">.</span><span class="ident" id="5609917">Op</span>&nbsp;<span class="op" id="5609920">==</span>&nbsp;<span class="ident" id="5609923">InstNop</span>&nbsp;<span class="op" id="5609931">||</span>&nbsp;<span class="ident" id="5609934">i</span><span class="op" id="5609935">.</span><span class="ident" id="5609936">Op</span>&nbsp;<span class="op" id="5609939">==</span>&nbsp;<span class="ident" id="5609942">InstCapture</span>&nbsp;<span class="op" id="5609954">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609958">pc</span>&nbsp;<span class="op" id="5609961">=</span>&nbsp;<span class="ident" id="5609963">i</span><span class="op" id="5609964">.</span><span class="ident" id="5609965">Out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609971">i</span>&nbsp;<span class="op" id="5609973">=</span>&nbsp;<span class="op" id="5609975">&amp;</span><span class="ident" id="5609976">p</span><span class="op" id="5609977">.</span><span class="ident" id="5609978">Inst</span><span class="op" id="5609982">[</span><span class="ident" id="5609983">pc</span><span class="op" id="5609985">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5609988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5609991">return</span>&nbsp;<span class="ident" id="5609998">i</span><span class="op" id="5609999">,</span>&nbsp;<span class="ident" id="5610001">pc</span><br>
<span class="lineno"></span><span class="op" id="5610004">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="5610007">//&nbsp;op&nbsp;returns&nbsp;i.Op&nbsp;but&nbsp;merges&nbsp;all&nbsp;the&nbsp;Rune&nbsp;special&nbsp;cases&nbsp;into&nbsp;InstRune</span><br>
<span class="lineno"></span><span class="keyword" id="5610078">func</span>&nbsp;<span class="op" id="5610083">(</span><span class="ident" id="5610084">i</span>&nbsp;<span class="op" id="5610086">*</span><span class="ident" id="5610087">Inst</span><span class="op" id="5610091">)</span>&nbsp;<span class="ident" id="5610093">op</span><span class="op" id="5610095">(</span><span class="op" id="5610096">)</span>&nbsp;<span class="ident" id="5610098">InstOp</span>&nbsp;<span class="op" id="5610105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610108">op</span>&nbsp;<span class="op" id="5610111">:=</span>&nbsp;<span class="ident" id="5610114">i</span><span class="op" id="5610115">.</span><span class="ident" id="5610116">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5610120">switch</span>&nbsp;<span class="ident" id="5610127">op</span>&nbsp;<span class="op" id="5610130">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5610133">case</span>&nbsp;<span class="ident" id="5610138">InstRune1</span><span class="op" id="5610147">,</span>&nbsp;<span class="ident" id="5610149">InstRuneAny</span><span class="op" id="5610160">,</span>&nbsp;<span class="ident" id="5610162">InstRuneAnyNotNL</span><span class="op" id="5610178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610182">op</span>&nbsp;<span class="op" id="5610185">=</span>&nbsp;<span class="ident" id="5610187">InstRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5610197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5610200">return</span>&nbsp;<span class="ident" id="5610207">op</span><br>
<span class="lineno"></span><span class="op" id="5610210">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="5610213">//&nbsp;Prefix&nbsp;returns&nbsp;a&nbsp;literal&nbsp;string&nbsp;that&nbsp;all&nbsp;matches&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5610273">//&nbsp;regexp&nbsp;must&nbsp;start&nbsp;with.&nbsp;&nbsp;Complete&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;prefix</span><br>
<span class="lineno"></span><span class="comment" id="5610332">//&nbsp;is&nbsp;the&nbsp;entire&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5610356">func</span>&nbsp;<span class="op" id="5610361">(</span><span class="ident" id="5610362">p</span>&nbsp;<span class="op" id="5610364">*</span><span class="ident" id="5610365">Prog</span><span class="op" id="5610369">)</span>&nbsp;<span class="ident" id="5610371">Prefix</span><span class="op" id="5610377">(</span><span class="op" id="5610378">)</span>&nbsp;<span class="op" id="5610380">(</span><span class="ident" id="5610381">prefix</span>&nbsp;<span class="builtintype" id="5610388">string</span><span class="op" id="5610394">,</span>&nbsp;<span class="ident" id="5610396">complete</span>&nbsp;<span class="builtintype" id="5610405">bool</span><span class="op" id="5610409">)</span>&nbsp;<span class="op" id="5610411">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610414">i</span><span class="op" id="5610415">,</span>&nbsp;<span class="ident" id="5610417">_</span>&nbsp;<span class="op" id="5610419">:=</span>&nbsp;<span class="ident" id="5610422">p</span><span class="op" id="5610423">.</span><span class="ident" id="5610424">skipNop</span><span class="op" id="5610431">(</span><span class="builtintype" id="5610432">uint32</span><span class="op" id="5610438">(</span><span class="ident" id="5610439">p</span><span class="op" id="5610440">.</span><span class="ident" id="5610441">Start</span><span class="op" id="5610446">)</span><span class="op" id="5610447">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5610451">//&nbsp;Avoid&nbsp;allocation&nbsp;of&nbsp;buffer&nbsp;if&nbsp;prefix&nbsp;is&nbsp;empty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5610502">if</span>&nbsp;<span class="ident" id="5610505">i</span><span class="op" id="5610506">.</span><span class="ident" id="5610507">op</span><span class="op" id="5610509">(</span><span class="op" id="5610510">)</span>&nbsp;<span class="op" id="5610512">!=</span>&nbsp;<span class="ident" id="5610515">InstRune</span>&nbsp;<span class="op" id="5610524">||</span>&nbsp;<span class="builtinfunc" id="5610527">len</span><span class="op" id="5610530">(</span><span class="ident" id="5610531">i</span><span class="op" id="5610532">.</span><span class="ident" id="5610533">Rune</span><span class="op" id="5610537">)</span>&nbsp;<span class="op" id="5610539">!=</span>&nbsp;<span class="num" id="5610542">1</span>&nbsp;<span class="op" id="5610544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5610548">return</span>&nbsp;<span class="string" id="5610555">&#34;&#34;</span><span class="op" id="5610557">,</span>&nbsp;<span class="ident" id="5610559">i</span><span class="op" id="5610560">.</span><span class="ident" id="5610561">Op</span>&nbsp;<span class="op" id="5610564">==</span>&nbsp;<span class="ident" id="5610567">InstMatch</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5610578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5610582">//&nbsp;Have&nbsp;prefix;&nbsp;gather&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5610618">var</span>&nbsp;<span class="ident" id="5610622">buf</span>&nbsp;<span class="ident" id="5610626">bytes</span><span class="op" id="5610631">.</span><span class="ident" id="5610632">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5610640">for</span>&nbsp;<span class="ident" id="5610644">i</span><span class="op" id="5610645">.</span><span class="ident" id="5610646">op</span><span class="op" id="5610648">(</span><span class="op" id="5610649">)</span>&nbsp;<span class="op" id="5610651">==</span>&nbsp;<span class="ident" id="5610654">InstRune</span>&nbsp;<span class="op" id="5610663">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5610666">len</span><span class="op" id="5610669">(</span><span class="ident" id="5610670">i</span><span class="op" id="5610671">.</span><span class="ident" id="5610672">Rune</span><span class="op" id="5610676">)</span>&nbsp;<span class="op" id="5610678">==</span>&nbsp;<span class="num" id="5610681">1</span>&nbsp;<span class="op" id="5610683">&amp;&amp;</span>&nbsp;<span class="ident" id="5610686">Flags</span><span class="op" id="5610691">(</span><span class="ident" id="5610692">i</span><span class="op" id="5610693">.</span><span class="ident" id="5610694">Arg</span><span class="op" id="5610697">)</span><span class="op" id="5610698">&amp;</span><span class="ident" id="5610699">FoldCase</span>&nbsp;<span class="op" id="5610708">==</span>&nbsp;<span class="num" id="5610711">0</span>&nbsp;<span class="op" id="5610713">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610717">buf</span><span class="op" id="5610720">.</span><span class="ident" id="5610721">WriteRune</span><span class="op" id="5610730">(</span><span class="ident" id="5610731">i</span><span class="op" id="5610732">.</span><span class="ident" id="5610733">Rune</span><span class="op" id="5610737">[</span><span class="num" id="5610738">0</span><span class="op" id="5610739">]</span><span class="op" id="5610740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610744">i</span><span class="op" id="5610745">,</span>&nbsp;<span class="ident" id="5610747">_</span>&nbsp;<span class="op" id="5610749">=</span>&nbsp;<span class="ident" id="5610751">p</span><span class="op" id="5610752">.</span><span class="ident" id="5610753">skipNop</span><span class="op" id="5610760">(</span><span class="ident" id="5610761">i</span><span class="op" id="5610762">.</span><span class="ident" id="5610763">Out</span><span class="op" id="5610766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5610769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5610772">return</span>&nbsp;<span class="ident" id="5610779">buf</span><span class="op" id="5610782">.</span><span class="ident" id="5610783">String</span><span class="op" id="5610789">(</span><span class="op" id="5610790">)</span><span class="op" id="5610791">,</span>&nbsp;<span class="ident" id="5610793">i</span><span class="op" id="5610794">.</span><span class="ident" id="5610795">Op</span>&nbsp;<span class="op" id="5610798">==</span>&nbsp;<span class="ident" id="5610801">InstMatch</span><br>
<span class="lineno"></span><span class="op" id="5610811">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="5610814">//&nbsp;StartCond&nbsp;returns&nbsp;the&nbsp;leading&nbsp;empty-width&nbsp;conditions&nbsp;that&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="5610880">//&nbsp;be&nbsp;true&nbsp;in&nbsp;any&nbsp;match.&nbsp;&nbsp;It&nbsp;returns&nbsp;^EmptyOp(0)&nbsp;if&nbsp;no&nbsp;matches&nbsp;are&nbsp;possible.</span><br>
<span class="lineno"></span><span class="keyword" id="5610957">func</span>&nbsp;<span class="op" id="5610962">(</span><span class="ident" id="5610963">p</span>&nbsp;<span class="op" id="5610965">*</span><span class="ident" id="5610966">Prog</span><span class="op" id="5610970">)</span>&nbsp;<span class="ident" id="5610972">StartCond</span><span class="op" id="5610981">(</span><span class="op" id="5610982">)</span>&nbsp;<span class="ident" id="5610984">EmptyOp</span>&nbsp;<span class="op" id="5610992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5610995">var</span>&nbsp;<span class="ident" id="5610999">flag</span>&nbsp;<span class="ident" id="5611004">EmptyOp</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611013">pc</span>&nbsp;<span class="op" id="5611016">:=</span>&nbsp;<span class="builtintype" id="5611019">uint32</span><span class="op" id="5611025">(</span><span class="ident" id="5611026">p</span><span class="op" id="5611027">.</span><span class="ident" id="5611028">Start</span><span class="op" id="5611033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611036">i</span>&nbsp;<span class="op" id="5611038">:=</span>&nbsp;<span class="op" id="5611041">&amp;</span><span class="ident" id="5611042">p</span><span class="op" id="5611043">.</span><span class="ident" id="5611044">Inst</span><span class="op" id="5611048">[</span><span class="ident" id="5611049">pc</span><span class="op" id="5611051">]</span><br>
<span class="lineno"></span><span class="ident" id="5611053">Loop</span><span class="op" id="5611057">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611060">for</span>&nbsp;<span class="op" id="5611064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611068">switch</span>&nbsp;<span class="ident" id="5611075">i</span><span class="op" id="5611076">.</span><span class="ident" id="5611077">Op</span>&nbsp;<span class="op" id="5611080">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611084">case</span>&nbsp;<span class="ident" id="5611089">InstEmptyWidth</span><span class="op" id="5611103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611108">flag</span>&nbsp;<span class="op" id="5611113">|=</span>&nbsp;<span class="ident" id="5611116">EmptyOp</span><span class="op" id="5611123">(</span><span class="ident" id="5611124">i</span><span class="op" id="5611125">.</span><span class="ident" id="5611126">Arg</span><span class="op" id="5611129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611133">case</span>&nbsp;<span class="ident" id="5611138">InstFail</span><span class="op" id="5611146">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611151">return</span>&nbsp;<span class="op" id="5611158">^</span><span class="ident" id="5611159">EmptyOp</span><span class="op" id="5611166">(</span><span class="num" id="5611167">0</span><span class="op" id="5611168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611172">case</span>&nbsp;<span class="ident" id="5611177">InstCapture</span><span class="op" id="5611188">,</span>&nbsp;<span class="ident" id="5611190">InstNop</span><span class="op" id="5611197">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5611202">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611212">default</span><span class="op" id="5611219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611224">break</span>&nbsp;<span class="ident" id="5611230">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5611237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611241">pc</span>&nbsp;<span class="op" id="5611244">=</span>&nbsp;<span class="ident" id="5611246">i</span><span class="op" id="5611247">.</span><span class="ident" id="5611248">Out</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611254">i</span>&nbsp;<span class="op" id="5611256">=</span>&nbsp;<span class="op" id="5611258">&amp;</span><span class="ident" id="5611259">p</span><span class="op" id="5611260">.</span><span class="ident" id="5611261">Inst</span><span class="op" id="5611265">[</span><span class="ident" id="5611266">pc</span><span class="op" id="5611268">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5611271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611274">return</span>&nbsp;<span class="ident" id="5611281">flag</span><br>
<span class="lineno"></span><span class="op" id="5611286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="5611289">const</span>&nbsp;<span class="ident" id="5611295">noMatch</span>&nbsp;<span class="op" id="5611303">=</span>&nbsp;<span class="op" id="5611305">-</span><span class="num" id="5611306">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5611309">//&nbsp;MatchRune&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5611380">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="5611431">func</span>&nbsp;<span class="op" id="5611436">(</span><span class="ident" id="5611437">i</span>&nbsp;<span class="op" id="5611439">*</span><span class="ident" id="5611440">Inst</span><span class="op" id="5611444">)</span>&nbsp;<span class="ident" id="5611446">MatchRune</span><span class="op" id="5611455">(</span><span class="ident" id="5611456">r</span>&nbsp;<span class="builtintype" id="5611458">rune</span><span class="op" id="5611462">)</span>&nbsp;<span class="builtintype" id="5611464">bool</span>&nbsp;<span class="op" id="5611469">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611472">return</span>&nbsp;<span class="ident" id="5611479">i</span><span class="op" id="5611480">.</span><span class="ident" id="5611481">MatchRunePos</span><span class="op" id="5611493">(</span><span class="ident" id="5611494">r</span><span class="op" id="5611495">)</span>&nbsp;<span class="op" id="5611497">!=</span>&nbsp;<span class="ident" id="5611500">noMatch</span><br>
<span class="lineno"></span><span class="op" id="5611508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5611511">//&nbsp;MatchRunePos&nbsp;checks&nbsp;whether&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5611584">//&nbsp;If&nbsp;so,&nbsp;MatchRunePos&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;matching&nbsp;rune&nbsp;pair</span><br>
<span class="lineno">200</span><span class="comment" id="5611651">//&nbsp;(or,&nbsp;when&nbsp;len(i.Rune)&nbsp;==&nbsp;1,&nbsp;rune&nbsp;singleton).</span><br>
<span class="lineno"></span><span class="comment" id="5611699">//&nbsp;If&nbsp;not,&nbsp;MatchRunePos&nbsp;returns&nbsp;-1.</span><br>
<span class="lineno"></span><span class="comment" id="5611735">//&nbsp;MatchRunePos&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="5611796">func</span>&nbsp;<span class="op" id="5611801">(</span><span class="ident" id="5611802">i</span>&nbsp;<span class="op" id="5611804">*</span><span class="ident" id="5611805">Inst</span><span class="op" id="5611809">)</span>&nbsp;<span class="ident" id="5611811">MatchRunePos</span><span class="op" id="5611823">(</span><span class="ident" id="5611824">r</span>&nbsp;<span class="builtintype" id="5611826">rune</span><span class="op" id="5611830">)</span>&nbsp;<span class="builtintype" id="5611832">int</span>&nbsp;<span class="op" id="5611836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="5611839">rune</span>&nbsp;<span class="op" id="5611844">:=</span>&nbsp;<span class="ident" id="5611847">i</span><span class="op" id="5611848">.</span><span class="ident" id="5611849">Rune</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5611856">//&nbsp;Special&nbsp;case:&nbsp;single-rune&nbsp;slice&nbsp;is&nbsp;from&nbsp;literal&nbsp;string,&nbsp;not&nbsp;char&nbsp;class.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611932">if</span>&nbsp;<span class="builtinfunc" id="5611935">len</span><span class="op" id="5611938">(</span><span class="builtintype" id="5611939">rune</span><span class="op" id="5611943">)</span>&nbsp;<span class="op" id="5611945">==</span>&nbsp;<span class="num" id="5611948">1</span>&nbsp;<span class="op" id="5611950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611954">r0</span>&nbsp;<span class="op" id="5611957">:=</span>&nbsp;<span class="builtintype" id="5611960">rune</span><span class="op" id="5611964">[</span><span class="num" id="5611965">0</span><span class="op" id="5611966">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611970">if</span>&nbsp;<span class="ident" id="5611973">r</span>&nbsp;<span class="op" id="5611975">==</span>&nbsp;<span class="ident" id="5611978">r0</span>&nbsp;<span class="op" id="5611981">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611986">return</span>&nbsp;<span class="num" id="5611993">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5611997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612001">if</span>&nbsp;<span class="ident" id="5612004">Flags</span><span class="op" id="5612009">(</span><span class="ident" id="5612010">i</span><span class="op" id="5612011">.</span><span class="ident" id="5612012">Arg</span><span class="op" id="5612015">)</span><span class="op" id="5612016">&amp;</span><span class="ident" id="5612017">FoldCase</span>&nbsp;<span class="op" id="5612026">!=</span>&nbsp;<span class="num" id="5612029">0</span>&nbsp;<span class="op" id="5612031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612036">for</span>&nbsp;<span class="ident" id="5612040">r1</span>&nbsp;<span class="op" id="5612043">:=</span>&nbsp;<span class="ident" id="5612046">unicode</span><span class="op" id="5612053">.</span><span class="ident" id="5612054">SimpleFold</span><span class="op" id="5612064">(</span><span class="ident" id="5612065">r0</span><span class="op" id="5612067">)</span><span class="op" id="5612068">;</span>&nbsp;<span class="ident" id="5612070">r1</span>&nbsp;<span class="op" id="5612073">!=</span>&nbsp;<span class="ident" id="5612076">r0</span><span class="op" id="5612078">;</span>&nbsp;<span class="ident" id="5612080">r1</span>&nbsp;<span class="op" id="5612083">=</span>&nbsp;<span class="ident" id="5612085">unicode</span><span class="op" id="5612092">.</span><span class="ident" id="5612093">SimpleFold</span><span class="op" id="5612103">(</span><span class="ident" id="5612104">r1</span><span class="op" id="5612106">)</span>&nbsp;<span class="op" id="5612108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612114">if</span>&nbsp;<span class="ident" id="5612117">r</span>&nbsp;<span class="op" id="5612119">==</span>&nbsp;<span class="ident" id="5612122">r1</span>&nbsp;<span class="op" id="5612125">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612132">return</span>&nbsp;<span class="num" id="5612139">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612158">return</span>&nbsp;<span class="ident" id="5612165">noMatch</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5612178">//&nbsp;Peek&nbsp;at&nbsp;the&nbsp;first&nbsp;few&nbsp;pairs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5612211">//&nbsp;Should&nbsp;handle&nbsp;ASCII&nbsp;well.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612241">for</span>&nbsp;<span class="ident" id="5612245">j</span>&nbsp;<span class="op" id="5612247">:=</span>&nbsp;<span class="num" id="5612250">0</span><span class="op" id="5612251">;</span>&nbsp;<span class="ident" id="5612253">j</span>&nbsp;<span class="op" id="5612255">&lt;</span>&nbsp;<span class="builtinfunc" id="5612257">len</span><span class="op" id="5612260">(</span><span class="builtintype" id="5612261">rune</span><span class="op" id="5612265">)</span>&nbsp;<span class="op" id="5612267">&amp;&amp;</span>&nbsp;<span class="ident" id="5612270">j</span>&nbsp;<span class="op" id="5612272">&lt;=</span>&nbsp;<span class="num" id="5612275">8</span><span class="op" id="5612276">;</span>&nbsp;<span class="ident" id="5612278">j</span>&nbsp;<span class="op" id="5612280">+=</span>&nbsp;<span class="num" id="5612283">2</span>&nbsp;<span class="op" id="5612285">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612289">if</span>&nbsp;<span class="ident" id="5612292">r</span>&nbsp;<span class="op" id="5612294">&lt;</span>&nbsp;<span class="builtintype" id="5612296">rune</span><span class="op" id="5612300">[</span><span class="ident" id="5612301">j</span><span class="op" id="5612302">]</span>&nbsp;<span class="op" id="5612304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612309">return</span>&nbsp;<span class="ident" id="5612316">noMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612330">if</span>&nbsp;<span class="ident" id="5612333">r</span>&nbsp;<span class="op" id="5612335">&lt;=</span>&nbsp;<span class="builtintype" id="5612338">rune</span><span class="op" id="5612342">[</span><span class="ident" id="5612343">j</span><span class="op" id="5612344">+</span><span class="num" id="5612345">1</span><span class="op" id="5612346">]</span>&nbsp;<span class="op" id="5612348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612353">return</span>&nbsp;<span class="ident" id="5612360">j</span>&nbsp;<span class="op" id="5612362">/</span>&nbsp;<span class="num" id="5612364">2</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5612375">//&nbsp;Otherwise&nbsp;binary&nbsp;search.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612404">lo</span>&nbsp;<span class="op" id="5612407">:=</span>&nbsp;<span class="num" id="5612410">0</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612413">hi</span>&nbsp;<span class="op" id="5612416">:=</span>&nbsp;<span class="builtinfunc" id="5612419">len</span><span class="op" id="5612422">(</span><span class="builtintype" id="5612423">rune</span><span class="op" id="5612427">)</span>&nbsp;<span class="op" id="5612429">/</span>&nbsp;<span class="num" id="5612431">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612434">for</span>&nbsp;<span class="ident" id="5612438">lo</span>&nbsp;<span class="op" id="5612441">&lt;</span>&nbsp;<span class="ident" id="5612443">hi</span>&nbsp;<span class="op" id="5612446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612450">m</span>&nbsp;<span class="op" id="5612452">:=</span>&nbsp;<span class="ident" id="5612455">lo</span>&nbsp;<span class="op" id="5612458">+</span>&nbsp;<span class="op" id="5612460">(</span><span class="ident" id="5612461">hi</span><span class="op" id="5612463">-</span><span class="ident" id="5612464">lo</span><span class="op" id="5612466">)</span><span class="op" id="5612467">/</span><span class="num" id="5612468">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612472">if</span>&nbsp;<span class="ident" id="5612475">c</span>&nbsp;<span class="op" id="5612477">:=</span>&nbsp;<span class="builtintype" id="5612480">rune</span><span class="op" id="5612484">[</span><span class="num" id="5612485">2</span><span class="op" id="5612486">*</span><span class="ident" id="5612487">m</span><span class="op" id="5612488">]</span><span class="op" id="5612489">;</span>&nbsp;<span class="ident" id="5612491">c</span>&nbsp;<span class="op" id="5612493">&lt;=</span>&nbsp;<span class="ident" id="5612496">r</span>&nbsp;<span class="op" id="5612498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612503">if</span>&nbsp;<span class="ident" id="5612506">r</span>&nbsp;<span class="op" id="5612508">&lt;=</span>&nbsp;<span class="builtintype" id="5612511">rune</span><span class="op" id="5612515">[</span><span class="num" id="5612516">2</span><span class="op" id="5612517">*</span><span class="ident" id="5612518">m</span><span class="op" id="5612519">+</span><span class="num" id="5612520">1</span><span class="op" id="5612521">]</span>&nbsp;<span class="op" id="5612523">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612529">return</span>&nbsp;<span class="ident" id="5612536">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612546">lo</span>&nbsp;<span class="op" id="5612549">=</span>&nbsp;<span class="ident" id="5612551">m</span>&nbsp;<span class="op" id="5612553">+</span>&nbsp;<span class="num" id="5612555">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612559">}</span>&nbsp;<span class="keyword" id="5612561">else</span>&nbsp;<span class="op" id="5612566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612571">hi</span>&nbsp;<span class="op" id="5612574">=</span>&nbsp;<span class="ident" id="5612576">m</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612586">return</span>&nbsp;<span class="ident" id="5612593">noMatch</span><br>
<span class="lineno"></span><span class="op" id="5612601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="5612604">//&nbsp;As&nbsp;per&nbsp;re2&#39;s&nbsp;Prog::IsWordChar.&nbsp;Determines&nbsp;whether&nbsp;rune&nbsp;is&nbsp;an&nbsp;ASCII&nbsp;word&nbsp;char.</span><br>
<span class="lineno"></span><span class="comment" id="5612685">//&nbsp;Since&nbsp;we&nbsp;act&nbsp;on&nbsp;runes,&nbsp;it&nbsp;would&nbsp;be&nbsp;easy&nbsp;to&nbsp;support&nbsp;Unicode&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="5612753">func</span>&nbsp;<span class="ident" id="5612758">wordRune</span><span class="op" id="5612766">(</span><span class="ident" id="5612767">r</span>&nbsp;<span class="builtintype" id="5612769">rune</span><span class="op" id="5612773">)</span>&nbsp;<span class="builtintype" id="5612775">bool</span>&nbsp;<span class="op" id="5612780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612783">return</span>&nbsp;<span class="ident" id="5612790">r</span>&nbsp;<span class="op" id="5612792">==</span>&nbsp;<span class="string" id="5612795">&#39;_&#39;</span>&nbsp;<span class="op" id="5612799">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612804">(</span><span class="string" id="5612805">&#39;A&#39;</span>&nbsp;<span class="op" id="5612809">&lt;=</span>&nbsp;<span class="ident" id="5612812">r</span>&nbsp;<span class="op" id="5612814">&amp;&amp;</span>&nbsp;<span class="ident" id="5612817">r</span>&nbsp;<span class="op" id="5612819">&lt;=</span>&nbsp;<span class="string" id="5612822">&#39;Z&#39;</span><span class="op" id="5612825">)</span>&nbsp;<span class="op" id="5612827">||</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612832">(</span><span class="string" id="5612833">&#39;a&#39;</span>&nbsp;<span class="op" id="5612837">&lt;=</span>&nbsp;<span class="ident" id="5612840">r</span>&nbsp;<span class="op" id="5612842">&amp;&amp;</span>&nbsp;<span class="ident" id="5612845">r</span>&nbsp;<span class="op" id="5612847">&lt;=</span>&nbsp;<span class="string" id="5612850">&#39;z&#39;</span><span class="op" id="5612853">)</span>&nbsp;<span class="op" id="5612855">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612860">(</span><span class="string" id="5612861">&#39;0&#39;</span>&nbsp;<span class="op" id="5612865">&lt;=</span>&nbsp;<span class="ident" id="5612868">r</span>&nbsp;<span class="op" id="5612870">&amp;&amp;</span>&nbsp;<span class="ident" id="5612873">r</span>&nbsp;<span class="op" id="5612875">&lt;=</span>&nbsp;<span class="string" id="5612878">&#39;9&#39;</span><span class="op" id="5612881">)</span><br>
<span class="lineno"></span><span class="op" id="5612883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5612886">//&nbsp;MatchEmptyWidth&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches</span><br>
<span class="lineno">260</span><span class="comment" id="5612945">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;between&nbsp;the&nbsp;runes&nbsp;before&nbsp;and&nbsp;after.</span><br>
<span class="lineno"></span><span class="comment" id="5613000">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstEmptyWidth.</span><br>
<span class="lineno"></span><span class="keyword" id="5613057">func</span>&nbsp;<span class="op" id="5613062">(</span><span class="ident" id="5613063">i</span>&nbsp;<span class="op" id="5613065">*</span><span class="ident" id="5613066">Inst</span><span class="op" id="5613070">)</span>&nbsp;<span class="ident" id="5613072">MatchEmptyWidth</span><span class="op" id="5613087">(</span><span class="ident" id="5613088">before</span>&nbsp;<span class="builtintype" id="5613095">rune</span><span class="op" id="5613099">,</span>&nbsp;<span class="ident" id="5613101">after</span>&nbsp;<span class="builtintype" id="5613107">rune</span><span class="op" id="5613111">)</span>&nbsp;<span class="builtintype" id="5613113">bool</span>&nbsp;<span class="op" id="5613118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613121">switch</span>&nbsp;<span class="ident" id="5613128">EmptyOp</span><span class="op" id="5613135">(</span><span class="ident" id="5613136">i</span><span class="op" id="5613137">.</span><span class="ident" id="5613138">Arg</span><span class="op" id="5613141">)</span>&nbsp;<span class="op" id="5613143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613146">case</span>&nbsp;<span class="ident" id="5613151">EmptyBeginLine</span><span class="op" id="5613165">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613169">return</span>&nbsp;<span class="ident" id="5613176">before</span>&nbsp;<span class="op" id="5613183">==</span>&nbsp;<span class="string" id="5613186">&#39;\n&#39;</span>&nbsp;<span class="op" id="5613191">||</span>&nbsp;<span class="ident" id="5613194">before</span>&nbsp;<span class="op" id="5613201">==</span>&nbsp;<span class="op" id="5613204">-</span><span class="num" id="5613205">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613208">case</span>&nbsp;<span class="ident" id="5613213">EmptyEndLine</span><span class="op" id="5613225">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613229">return</span>&nbsp;<span class="ident" id="5613236">after</span>&nbsp;<span class="op" id="5613242">==</span>&nbsp;<span class="string" id="5613245">&#39;\n&#39;</span>&nbsp;<span class="op" id="5613250">||</span>&nbsp;<span class="ident" id="5613253">after</span>&nbsp;<span class="op" id="5613259">==</span>&nbsp;<span class="op" id="5613262">-</span><span class="num" id="5613263">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613266">case</span>&nbsp;<span class="ident" id="5613271">EmptyBeginText</span><span class="op" id="5613285">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613289">return</span>&nbsp;<span class="ident" id="5613296">before</span>&nbsp;<span class="op" id="5613303">==</span>&nbsp;<span class="op" id="5613306">-</span><span class="num" id="5613307">1</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613310">case</span>&nbsp;<span class="ident" id="5613315">EmptyEndText</span><span class="op" id="5613327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613331">return</span>&nbsp;<span class="ident" id="5613338">after</span>&nbsp;<span class="op" id="5613344">==</span>&nbsp;<span class="op" id="5613347">-</span><span class="num" id="5613348">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613351">case</span>&nbsp;<span class="ident" id="5613356">EmptyWordBoundary</span><span class="op" id="5613373">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613377">return</span>&nbsp;<span class="ident" id="5613384">wordRune</span><span class="op" id="5613392">(</span><span class="ident" id="5613393">before</span><span class="op" id="5613399">)</span>&nbsp;<span class="op" id="5613401">!=</span>&nbsp;<span class="ident" id="5613404">wordRune</span><span class="op" id="5613412">(</span><span class="ident" id="5613413">after</span><span class="op" id="5613418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613421">case</span>&nbsp;<span class="ident" id="5613426">EmptyNoWordBoundary</span><span class="op" id="5613445">:</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613449">return</span>&nbsp;<span class="ident" id="5613456">wordRune</span><span class="op" id="5613464">(</span><span class="ident" id="5613465">before</span><span class="op" id="5613471">)</span>&nbsp;<span class="op" id="5613473">==</span>&nbsp;<span class="ident" id="5613476">wordRune</span><span class="op" id="5613484">(</span><span class="ident" id="5613485">after</span><span class="op" id="5613490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5613493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5613496">panic</span><span class="op" id="5613501">(</span><span class="string" id="5613502">&#34;unknown&nbsp;empty&nbsp;width&nbsp;arg&#34;</span><span class="op" id="5613527">)</span><br>
<span class="lineno"></span><span class="op" id="5613529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="5613532">func</span>&nbsp;<span class="op" id="5613537">(</span><span class="ident" id="5613538">i</span>&nbsp;<span class="op" id="5613540">*</span><span class="ident" id="5613541">Inst</span><span class="op" id="5613545">)</span>&nbsp;<span class="ident" id="5613547">String</span><span class="op" id="5613553">(</span><span class="op" id="5613554">)</span>&nbsp;<span class="builtintype" id="5613556">string</span>&nbsp;<span class="op" id="5613563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613566">var</span>&nbsp;<span class="ident" id="5613570">b</span>&nbsp;<span class="ident" id="5613572">bytes</span><span class="op" id="5613577">.</span><span class="ident" id="5613578">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613586">dumpInst</span><span class="op" id="5613594">(</span><span class="op" id="5613595">&amp;</span><span class="ident" id="5613596">b</span><span class="op" id="5613597">,</span>&nbsp;<span class="ident" id="5613599">i</span><span class="op" id="5613600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613603">return</span>&nbsp;<span class="ident" id="5613610">b</span><span class="op" id="5613611">.</span><span class="ident" id="5613612">String</span><span class="op" id="5613618">(</span><span class="op" id="5613619">)</span><br>
<span class="lineno"></span><span class="op" id="5613621">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="5613624">func</span>&nbsp;<span class="ident" id="5613629">bw</span><span class="op" id="5613631">(</span><span class="ident" id="5613632">b</span>&nbsp;<span class="op" id="5613634">*</span><span class="ident" id="5613635">bytes</span><span class="op" id="5613640">.</span><span class="ident" id="5613641">Buffer</span><span class="op" id="5613647">,</span>&nbsp;<span class="ident" id="5613649">args</span>&nbsp;<span class="op" id="5613654">...</span><span class="builtintype" id="5613657">string</span><span class="op" id="5613663">)</span>&nbsp;<span class="op" id="5613665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613668">for</span>&nbsp;<span class="ident" id="5613672">_</span><span class="op" id="5613673">,</span>&nbsp;<span class="ident" id="5613675">s</span>&nbsp;<span class="op" id="5613677">:=</span>&nbsp;<span class="keyword" id="5613680">range</span>&nbsp;<span class="ident" id="5613686">args</span>&nbsp;<span class="op" id="5613691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613695">b</span><span class="op" id="5613696">.</span><span class="ident" id="5613697">WriteString</span><span class="op" id="5613708">(</span><span class="ident" id="5613709">s</span><span class="op" id="5613710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5613713">}</span><br>
<span class="lineno">290</span><span class="op" id="5613715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5613718">func</span>&nbsp;<span class="ident" id="5613723">dumpProg</span><span class="op" id="5613731">(</span><span class="ident" id="5613732">b</span>&nbsp;<span class="op" id="5613734">*</span><span class="ident" id="5613735">bytes</span><span class="op" id="5613740">.</span><span class="ident" id="5613741">Buffer</span><span class="op" id="5613747">,</span>&nbsp;<span class="ident" id="5613749">p</span>&nbsp;<span class="op" id="5613751">*</span><span class="ident" id="5613752">Prog</span><span class="op" id="5613756">)</span>&nbsp;<span class="op" id="5613758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613761">for</span>&nbsp;<span class="ident" id="5613765">j</span>&nbsp;<span class="op" id="5613767">:=</span>&nbsp;<span class="keyword" id="5613770">range</span>&nbsp;<span class="ident" id="5613776">p</span><span class="op" id="5613777">.</span><span class="ident" id="5613778">Inst</span>&nbsp;<span class="op" id="5613783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613787">i</span>&nbsp;<span class="op" id="5613789">:=</span>&nbsp;<span class="op" id="5613792">&amp;</span><span class="ident" id="5613793">p</span><span class="op" id="5613794">.</span><span class="ident" id="5613795">Inst</span><span class="op" id="5613799">[</span><span class="ident" id="5613800">j</span><span class="op" id="5613801">]</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613805">pc</span>&nbsp;<span class="op" id="5613808">:=</span>&nbsp;<span class="ident" id="5613811">strconv</span><span class="op" id="5613818">.</span><span class="ident" id="5613819">Itoa</span><span class="op" id="5613823">(</span><span class="ident" id="5613824">j</span><span class="op" id="5613825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613829">if</span>&nbsp;<span class="builtinfunc" id="5613832">len</span><span class="op" id="5613835">(</span><span class="ident" id="5613836">pc</span><span class="op" id="5613838">)</span>&nbsp;<span class="op" id="5613840">&lt;</span>&nbsp;<span class="num" id="5613842">3</span>&nbsp;<span class="op" id="5613844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613849">b</span><span class="op" id="5613850">.</span><span class="ident" id="5613851">WriteString</span><span class="op" id="5613862">(</span><span class="string" id="5613863">&#34;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="5613868">[</span><span class="builtinfunc" id="5613869">len</span><span class="op" id="5613872">(</span><span class="ident" id="5613873">pc</span><span class="op" id="5613875">)</span><span class="op" id="5613876">:</span><span class="op" id="5613877">]</span><span class="op" id="5613878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5613882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613886">if</span>&nbsp;<span class="ident" id="5613889">j</span>&nbsp;<span class="op" id="5613891">==</span>&nbsp;<span class="ident" id="5613894">p</span><span class="op" id="5613895">.</span><span class="ident" id="5613896">Start</span>&nbsp;<span class="op" id="5613902">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613907">pc</span>&nbsp;<span class="op" id="5613910">+=</span>&nbsp;<span class="string" id="5613913">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5613919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613923">bw</span><span class="op" id="5613925">(</span><span class="ident" id="5613926">b</span><span class="op" id="5613927">,</span>&nbsp;<span class="ident" id="5613929">pc</span><span class="op" id="5613931">,</span>&nbsp;<span class="string" id="5613933">&#34;\t&#34;</span><span class="op" id="5613937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613941">dumpInst</span><span class="op" id="5613949">(</span><span class="ident" id="5613950">b</span><span class="op" id="5613951">,</span>&nbsp;<span class="ident" id="5613953">i</span><span class="op" id="5613954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613958">bw</span><span class="op" id="5613960">(</span><span class="ident" id="5613961">b</span><span class="op" id="5613962">,</span>&nbsp;<span class="string" id="5613964">&#34;\n&#34;</span><span class="op" id="5613968">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5613971">}</span><br>
<span class="lineno"></span><span class="op" id="5613973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5613976">func</span>&nbsp;<span class="ident" id="5613981">u32</span><span class="op" id="5613984">(</span><span class="ident" id="5613985">i</span>&nbsp;<span class="builtintype" id="5613987">uint32</span><span class="op" id="5613993">)</span>&nbsp;<span class="builtintype" id="5613995">string</span>&nbsp;<span class="op" id="5614002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614005">return</span>&nbsp;<span class="ident" id="5614012">strconv</span><span class="op" id="5614019">.</span><span class="ident" id="5614020">FormatUint</span><span class="op" id="5614030">(</span><span class="ident" id="5614031">uint64</span><span class="op" id="5614037">(</span><span class="ident" id="5614038">i</span><span class="op" id="5614039">)</span><span class="op" id="5614040">,</span>&nbsp;<span class="num" id="5614042">10</span><span class="op" id="5614044">)</span><br>
<span class="lineno">310</span><span class="op" id="5614046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5614049">func</span>&nbsp;<span class="ident" id="5614054">dumpInst</span><span class="op" id="5614062">(</span><span class="ident" id="5614063">b</span>&nbsp;<span class="op" id="5614065">*</span><span class="ident" id="5614066">bytes</span><span class="op" id="5614071">.</span><span class="ident" id="5614072">Buffer</span><span class="op" id="5614078">,</span>&nbsp;<span class="ident" id="5614080">i</span>&nbsp;<span class="op" id="5614082">*</span><span class="ident" id="5614083">Inst</span><span class="op" id="5614087">)</span>&nbsp;<span class="op" id="5614089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614092">switch</span>&nbsp;<span class="ident" id="5614099">i</span><span class="op" id="5614100">.</span><span class="ident" id="5614101">Op</span>&nbsp;<span class="op" id="5614104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614107">case</span>&nbsp;<span class="ident" id="5614112">InstAlt</span><span class="op" id="5614119">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614123">bw</span><span class="op" id="5614125">(</span><span class="ident" id="5614126">b</span><span class="op" id="5614127">,</span>&nbsp;<span class="string" id="5614129">&#34;alt&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5614138">,</span>&nbsp;<span class="ident" id="5614140">u32</span><span class="op" id="5614143">(</span><span class="ident" id="5614144">i</span><span class="op" id="5614145">.</span><span class="ident" id="5614146">Out</span><span class="op" id="5614149">)</span><span class="op" id="5614150">,</span>&nbsp;<span class="string" id="5614152">&#34;,&nbsp;&#34;</span><span class="op" id="5614156">,</span>&nbsp;<span class="ident" id="5614158">u32</span><span class="op" id="5614161">(</span><span class="ident" id="5614162">i</span><span class="op" id="5614163">.</span><span class="ident" id="5614164">Arg</span><span class="op" id="5614167">)</span><span class="op" id="5614168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614171">case</span>&nbsp;<span class="ident" id="5614176">InstAltMatch</span><span class="op" id="5614188">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614192">bw</span><span class="op" id="5614194">(</span><span class="ident" id="5614195">b</span><span class="op" id="5614196">,</span>&nbsp;<span class="string" id="5614198">&#34;altmatch&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5614212">,</span>&nbsp;<span class="ident" id="5614214">u32</span><span class="op" id="5614217">(</span><span class="ident" id="5614218">i</span><span class="op" id="5614219">.</span><span class="ident" id="5614220">Out</span><span class="op" id="5614223">)</span><span class="op" id="5614224">,</span>&nbsp;<span class="string" id="5614226">&#34;,&nbsp;&#34;</span><span class="op" id="5614230">,</span>&nbsp;<span class="ident" id="5614232">u32</span><span class="op" id="5614235">(</span><span class="ident" id="5614236">i</span><span class="op" id="5614237">.</span><span class="ident" id="5614238">Arg</span><span class="op" id="5614241">)</span><span class="op" id="5614242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614245">case</span>&nbsp;<span class="ident" id="5614250">InstCapture</span><span class="op" id="5614261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614265">bw</span><span class="op" id="5614267">(</span><span class="ident" id="5614268">b</span><span class="op" id="5614269">,</span>&nbsp;<span class="string" id="5614271">&#34;cap&nbsp;&#34;</span><span class="op" id="5614277">,</span>&nbsp;<span class="ident" id="5614279">u32</span><span class="op" id="5614282">(</span><span class="ident" id="5614283">i</span><span class="op" id="5614284">.</span><span class="ident" id="5614285">Arg</span><span class="op" id="5614288">)</span><span class="op" id="5614289">,</span>&nbsp;<span class="string" id="5614291">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5614297">,</span>&nbsp;<span class="ident" id="5614299">u32</span><span class="op" id="5614302">(</span><span class="ident" id="5614303">i</span><span class="op" id="5614304">.</span><span class="ident" id="5614305">Out</span><span class="op" id="5614308">)</span><span class="op" id="5614309">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614312">case</span>&nbsp;<span class="ident" id="5614317">InstEmptyWidth</span><span class="op" id="5614331">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614335">bw</span><span class="op" id="5614337">(</span><span class="ident" id="5614338">b</span><span class="op" id="5614339">,</span>&nbsp;<span class="string" id="5614341">&#34;empty&nbsp;&#34;</span><span class="op" id="5614349">,</span>&nbsp;<span class="ident" id="5614351">u32</span><span class="op" id="5614354">(</span><span class="ident" id="5614355">i</span><span class="op" id="5614356">.</span><span class="ident" id="5614357">Arg</span><span class="op" id="5614360">)</span><span class="op" id="5614361">,</span>&nbsp;<span class="string" id="5614363">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5614369">,</span>&nbsp;<span class="ident" id="5614371">u32</span><span class="op" id="5614374">(</span><span class="ident" id="5614375">i</span><span class="op" id="5614376">.</span><span class="ident" id="5614377">Out</span><span class="op" id="5614380">)</span><span class="op" id="5614381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614384">case</span>&nbsp;<span class="ident" id="5614389">InstMatch</span><span class="op" id="5614398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614402">bw</span><span class="op" id="5614404">(</span><span class="ident" id="5614405">b</span><span class="op" id="5614406">,</span>&nbsp;<span class="string" id="5614408">&#34;match&#34;</span><span class="op" id="5614415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614418">case</span>&nbsp;<span class="ident" id="5614423">InstFail</span><span class="op" id="5614431">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614435">bw</span><span class="op" id="5614437">(</span><span class="ident" id="5614438">b</span><span class="op" id="5614439">,</span>&nbsp;<span class="string" id="5614441">&#34;fail&#34;</span><span class="op" id="5614447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614450">case</span>&nbsp;<span class="ident" id="5614455">InstNop</span><span class="op" id="5614462">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614466">bw</span><span class="op" id="5614468">(</span><span class="ident" id="5614469">b</span><span class="op" id="5614470">,</span>&nbsp;<span class="string" id="5614472">&#34;nop&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5614481">,</span>&nbsp;<span class="ident" id="5614483">u32</span><span class="op" id="5614486">(</span><span class="ident" id="5614487">i</span><span class="op" id="5614488">.</span><span class="ident" id="5614489">Out</span><span class="op" id="5614492">)</span><span class="op" id="5614493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614496">case</span>&nbsp;<span class="ident" id="5614501">InstRune</span><span class="op" id="5614509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614513">if</span>&nbsp;<span class="ident" id="5614516">i</span><span class="op" id="5614517">.</span><span class="ident" id="5614518">Rune</span>&nbsp;<span class="op" id="5614523">==</span>&nbsp;<span class="ident" id="5614526">nil</span>&nbsp;<span class="op" id="5614530">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5614535">//&nbsp;shouldn&#39;t&nbsp;happen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614558">bw</span><span class="op" id="5614560">(</span><span class="ident" id="5614561">b</span><span class="op" id="5614562">,</span>&nbsp;<span class="string" id="5614564">&#34;rune&nbsp;&lt;nil&gt;&#34;</span><span class="op" id="5614576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5614580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614584">bw</span><span class="op" id="5614586">(</span><span class="ident" id="5614587">b</span><span class="op" id="5614588">,</span>&nbsp;<span class="string" id="5614590">&#34;rune&nbsp;&#34;</span><span class="op" id="5614597">,</span>&nbsp;<span class="ident" id="5614599">strconv</span><span class="op" id="5614606">.</span><span class="ident" id="5614607">QuoteToASCII</span><span class="op" id="5614619">(</span><span class="builtintype" id="5614620">string</span><span class="op" id="5614626">(</span><span class="ident" id="5614627">i</span><span class="op" id="5614628">.</span><span class="ident" id="5614629">Rune</span><span class="op" id="5614633">)</span><span class="op" id="5614634">)</span><span class="op" id="5614635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614639">if</span>&nbsp;<span class="ident" id="5614642">Flags</span><span class="op" id="5614647">(</span><span class="ident" id="5614648">i</span><span class="op" id="5614649">.</span><span class="ident" id="5614650">Arg</span><span class="op" id="5614653">)</span><span class="op" id="5614654">&amp;</span><span class="ident" id="5614655">FoldCase</span>&nbsp;<span class="op" id="5614664">!=</span>&nbsp;<span class="num" id="5614667">0</span>&nbsp;<span class="op" id="5614669">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614674">bw</span><span class="op" id="5614676">(</span><span class="ident" id="5614677">b</span><span class="op" id="5614678">,</span>&nbsp;<span class="string" id="5614680">&#34;/i&#34;</span><span class="op" id="5614684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5614688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614692">bw</span><span class="op" id="5614694">(</span><span class="ident" id="5614695">b</span><span class="op" id="5614696">,</span>&nbsp;<span class="string" id="5614698">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5614704">,</span>&nbsp;<span class="ident" id="5614706">u32</span><span class="op" id="5614709">(</span><span class="ident" id="5614710">i</span><span class="op" id="5614711">.</span><span class="ident" id="5614712">Out</span><span class="op" id="5614715">)</span><span class="op" id="5614716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614719">case</span>&nbsp;<span class="ident" id="5614724">InstRune1</span><span class="op" id="5614733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614737">bw</span><span class="op" id="5614739">(</span><span class="ident" id="5614740">b</span><span class="op" id="5614741">,</span>&nbsp;<span class="string" id="5614743">&#34;rune1&nbsp;&#34;</span><span class="op" id="5614751">,</span>&nbsp;<span class="ident" id="5614753">strconv</span><span class="op" id="5614760">.</span><span class="ident" id="5614761">QuoteToASCII</span><span class="op" id="5614773">(</span><span class="builtintype" id="5614774">string</span><span class="op" id="5614780">(</span><span class="ident" id="5614781">i</span><span class="op" id="5614782">.</span><span class="ident" id="5614783">Rune</span><span class="op" id="5614787">)</span><span class="op" id="5614788">)</span><span class="op" id="5614789">,</span>&nbsp;<span class="string" id="5614791">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5614797">,</span>&nbsp;<span class="ident" id="5614799">u32</span><span class="op" id="5614802">(</span><span class="ident" id="5614803">i</span><span class="op" id="5614804">.</span><span class="ident" id="5614805">Out</span><span class="op" id="5614808">)</span><span class="op" id="5614809">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614812">case</span>&nbsp;<span class="ident" id="5614817">InstRuneAny</span><span class="op" id="5614828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614832">bw</span><span class="op" id="5614834">(</span><span class="ident" id="5614835">b</span><span class="op" id="5614836">,</span>&nbsp;<span class="string" id="5614838">&#34;any&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5614847">,</span>&nbsp;<span class="ident" id="5614849">u32</span><span class="op" id="5614852">(</span><span class="ident" id="5614853">i</span><span class="op" id="5614854">.</span><span class="ident" id="5614855">Out</span><span class="op" id="5614858">)</span><span class="op" id="5614859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614862">case</span>&nbsp;<span class="ident" id="5614867">InstRuneAnyNotNL</span><span class="op" id="5614883">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614887">bw</span><span class="op" id="5614889">(</span><span class="ident" id="5614890">b</span><span class="op" id="5614891">,</span>&nbsp;<span class="string" id="5614893">&#34;anynotnl&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5614907">,</span>&nbsp;<span class="ident" id="5614909">u32</span><span class="op" id="5614912">(</span><span class="ident" id="5614913">i</span><span class="op" id="5614914">.</span><span class="ident" id="5614915">Out</span><span class="op" id="5614918">)</span><span class="op" id="5614919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5614922">}</span><br>
<span class="lineno">345</span><span class="op" id="5614924">}</span>
</div>
</body>
</html>
