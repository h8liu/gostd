<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5569398">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5569453">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5569507">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5569558">//&nbsp;Package&nbsp;expvar&nbsp;provides&nbsp;a&nbsp;standardized&nbsp;interface&nbsp;to&nbsp;public&nbsp;variables,&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5569636">//&nbsp;as&nbsp;operation&nbsp;counters&nbsp;in&nbsp;servers.&nbsp;It&nbsp;exposes&nbsp;these&nbsp;variables&nbsp;via&nbsp;HTTP&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5569712">//&nbsp;/debug/vars&nbsp;in&nbsp;JSON&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="5569743">//</span><br>
<span class="lineno"></span><span class="comment" id="5569746">//&nbsp;Operations&nbsp;to&nbsp;set&nbsp;or&nbsp;modify&nbsp;these&nbsp;public&nbsp;variables&nbsp;are&nbsp;atomic.</span><br>
<span class="lineno">10</span><span class="comment" id="5569812">//</span><br>
<span class="lineno"></span><span class="comment" id="5569815">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;adding&nbsp;the&nbsp;HTTP&nbsp;handler,&nbsp;this&nbsp;package&nbsp;registers&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5569885">//&nbsp;following&nbsp;variables:</span><br>
<span class="lineno"></span><span class="comment" id="5569909">//</span><br>
<span class="lineno"></span><span class="comment" id="5569912">//&nbsp;&nbsp;&nbsp;&nbspcmdline&nbsp;&nbsp;&nbsp;os.Args</span><br>
<span class="lineno">15</span><span class="comment" id="5569933">//&nbsp;&nbsp;&nbsp;&nbspmemstats&nbsp;&nbsp;runtime.Memstats</span><br>
<span class="lineno"></span><span class="comment" id="5569963">//</span><br>
<span class="lineno"></span><span class="comment" id="5569966">//&nbsp;The&nbsp;package&nbsp;is&nbsp;sometimes&nbsp;only&nbsp;imported&nbsp;for&nbsp;the&nbsp;side&nbsp;effect&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5570031">//&nbsp;registering&nbsp;its&nbsp;HTTP&nbsp;handler&nbsp;and&nbsp;the&nbsp;above&nbsp;variables.&nbsp;&nbsp;To&nbsp;use&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5570099">//&nbsp;this&nbsp;way,&nbsp;link&nbsp;this&nbsp;package&nbsp;into&nbsp;your&nbsp;program:</span><br>
<span class="lineno">20</span><span class="comment" id="5570149">//&nbsp;&nbsp;&nbsp;&nbspimport&nbsp;_&nbsp;&#34;expvar&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5570170">//</span><br>
<span class="lineno"></span><span class="keyword" id="5570173">package</span>&nbsp;<span class="ident" id="5570181">expvar</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5570189">import</span>&nbsp;<span class="op" id="5570196">(</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5570199">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5570208">&#34;encoding/json&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5570225">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5570232">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5570239">&#34;net/http&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5570251">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5570257">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5570268">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5570276">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5570287">&#34;sync&#34;</span><br>
<span class="lineno">35</span><span class="op" id="5570294">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5570297">//&nbsp;Var&nbsp;is&nbsp;an&nbsp;abstract&nbsp;type&nbsp;for&nbsp;all&nbsp;exported&nbsp;variables.</span><br>
<span class="lineno"></span><span class="keyword" id="5570352">type</span>&nbsp;<span class="ident" id="5570357">Var</span>&nbsp;<span class="keyword" id="5570361">interface</span>&nbsp;<span class="op" id="5570371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5570374">String</span><span class="op" id="5570380">(</span><span class="op" id="5570381">)</span>&nbsp;<span class="builtintype" id="5570383">string</span><br>
<span class="lineno">40</span><span class="op" id="5570390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5570393">//&nbsp;Int&nbsp;is&nbsp;a&nbsp;64-bit&nbsp;integer&nbsp;variable&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;Var&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5570463">type</span>&nbsp;<span class="ident" id="5570468">Int</span>&nbsp;<span class="keyword" id="5570472">struct</span>&nbsp;<span class="op" id="5570479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5570482">mu</span>&nbsp;<span class="ident" id="5570485"><a href="/expvar/expvar.go.html#5570287">sync</a></span><span class="op" id="5570489">.</span><span class="ident" id="5570490">RWMutex</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5570499">i</span>&nbsp;&nbsp;<span class="ident" id="5570502">int64</span><br>
<span class="lineno"></span><span class="op" id="5570508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5570511">func</span>&nbsp;<span class="op" id="5570516">(</span><span class="ident" id="5570517">v</span>&nbsp;<span class="op" id="5570519">*</span><span class="ident" id="5570520"><a href="/expvar/expvar.go.html#5570468">Int</a></span><span class="op" id="5570523">)</span>&nbsp;<span class="ident" id="5570525">String</span><span class="op" id="5570531">(</span><span class="op" id="5570532">)</span>&nbsp;<span class="builtintype" id="5570534">string</span>&nbsp;<span class="op" id="5570541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5570544"><a href="/expvar/expvar.go.html#5570517">v</a></span><span class="op" id="5570545">.</span><span class="ident" id="5570546">mu</span><span class="op" id="5570548">.</span><span class="ident" id="5570549">RLock</span><span class="op" id="5570554">(</span><span class="op" id="5570555">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5570558">defer</span>&nbsp;<span class="ident" id="5570564"><a href="/expvar/expvar.go.html#5570517">v</a></span><span class="op" id="5570565">.</span><span class="ident" id="5570566">mu</span><span class="op" id="5570568">.</span><span class="ident" id="5570569">RUnlock</span><span class="op" id="5570576">(</span><span class="op" id="5570577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5570580">return</span>&nbsp;<span class="ident" id="5570587"><a href="/expvar/expvar.go.html#5570276">strconv</a></span><span class="op" id="5570594">.</span><span class="ident" id="5570595">FormatInt</span><span class="op" id="5570604">(</span><span class="ident" id="5570605"><a href="/expvar/expvar.go.html#5570517">v</a></span><span class="op" id="5570606">.</span><span class="ident" id="5570607">i</span><span class="op" id="5570608">,</span>&nbsp;<span class="num" id="5570610">10</span><span class="op" id="5570612">)</span><br>
<span class="lineno"></span><span class="op" id="5570614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5570617">func</span>&nbsp;<span class="op" id="5570622">(</span><span class="ident" id="5570623">v</span>&nbsp;<span class="op" id="5570625">*</span><span class="ident" id="5570626"><a href="/expvar/expvar.go.html#5570468">Int</a></span><span class="op" id="5570629">)</span>&nbsp;<span class="ident" id="5570631">Add</span><span class="op" id="5570634">(</span><span class="ident" id="5570635">delta</span>&nbsp;<span class="ident" id="5570641">int64</span><span class="op" id="5570646">)</span>&nbsp;<span class="op" id="5570648">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5570651"><a href="/expvar/expvar.go.html#5570623">v</a></span><span class="op" id="5570652">.</span><span class="ident" id="5570653">mu</span><span class="op" id="5570655">.</span><span class="ident" id="5570656">Lock</span><span class="op" id="5570660">(</span><span class="op" id="5570661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5570664">defer</span>&nbsp;<span class="ident" id="5570670"><a href="/expvar/expvar.go.html#5570623">v</a></span><span class="op" id="5570671">.</span><span class="ident" id="5570672">mu</span><span class="op" id="5570674">.</span><span class="ident" id="5570675">Unlock</span><span class="op" id="5570681">(</span><span class="op" id="5570682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5570685"><a href="/expvar/expvar.go.html#5570623">v</a></span><span class="op" id="5570686">.</span><span class="ident" id="5570687">i</span>&nbsp;<span class="op" id="5570689">+=</span>&nbsp;<span class="ident" id="5570692"><a href="/expvar/expvar.go.html#5570635">delta</a></span><br>
<span class="lineno"></span><span class="op" id="5570698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="5570701">func</span>&nbsp;<span class="op" id="5570706">(</span><span class="ident" id="5570707">v</span>&nbsp;<span class="op" id="5570709">*</span><span class="ident" id="5570710"><a href="/expvar/expvar.go.html#5570468">Int</a></span><span class="op" id="5570713">)</span>&nbsp;<span class="ident" id="5570715">Set</span><span class="op" id="5570718">(</span><span class="ident" id="5570719">value</span>&nbsp;<span class="ident" id="5570725">int64</span><span class="op" id="5570730">)</span>&nbsp;<span class="op" id="5570732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5570735"><a href="/expvar/expvar.go.html#5570707">v</a></span><span class="op" id="5570736">.</span><span class="ident" id="5570737">mu</span><span class="op" id="5570739">.</span><span class="ident" id="5570740">Lock</span><span class="op" id="5570744">(</span><span class="op" id="5570745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5570748">defer</span>&nbsp;<span class="ident" id="5570754"><a href="/expvar/expvar.go.html#5570707">v</a></span><span class="op" id="5570755">.</span><span class="ident" id="5570756">mu</span><span class="op" id="5570758">.</span><span class="ident" id="5570759">Unlock</span><span class="op" id="5570765">(</span><span class="op" id="5570766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5570769"><a href="/expvar/expvar.go.html#5570707">v</a></span><span class="op" id="5570770">.</span><span class="ident" id="5570771">i</span>&nbsp;<span class="op" id="5570773">=</span>&nbsp;<span class="ident" id="5570775"><a href="/expvar/expvar.go.html#5570719">value</a></span><br>
<span class="lineno"></span><span class="op" id="5570781">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="5570784">//&nbsp;Float&nbsp;is&nbsp;a&nbsp;64-bit&nbsp;float&nbsp;variable&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;Var&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5570854">type</span>&nbsp;<span class="ident" id="5570859">Float</span>&nbsp;<span class="keyword" id="5570865">struct</span>&nbsp;<span class="op" id="5570872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5570875">mu</span>&nbsp;<span class="ident" id="5570878"><a href="/expvar/expvar.go.html#5570287">sync</a></span><span class="op" id="5570882">.</span><span class="ident" id="5570883">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5570892">f</span>&nbsp;&nbsp;<span class="builtintype" id="5570895">float64</span><br>
<span class="lineno">70</span><span class="op" id="5570903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5570906">func</span>&nbsp;<span class="op" id="5570911">(</span><span class="ident" id="5570912">v</span>&nbsp;<span class="op" id="5570914">*</span><span class="ident" id="5570915"><a href="/expvar/expvar.go.html#5570859">Float</a></span><span class="op" id="5570920">)</span>&nbsp;<span class="ident" id="5570922">String</span><span class="op" id="5570928">(</span><span class="op" id="5570929">)</span>&nbsp;<span class="builtintype" id="5570931">string</span>&nbsp;<span class="op" id="5570938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5570941"><a href="/expvar/expvar.go.html#5570912">v</a></span><span class="op" id="5570942">.</span><span class="ident" id="5570943">mu</span><span class="op" id="5570945">.</span><span class="ident" id="5570946">RLock</span><span class="op" id="5570951">(</span><span class="op" id="5570952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5570955">defer</span>&nbsp;<span class="ident" id="5570961"><a href="/expvar/expvar.go.html#5570912">v</a></span><span class="op" id="5570962">.</span><span class="ident" id="5570963">mu</span><span class="op" id="5570965">.</span><span class="ident" id="5570966">RUnlock</span><span class="op" id="5570973">(</span><span class="op" id="5570974">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5570977">return</span>&nbsp;<span class="ident" id="5570984"><a href="/expvar/expvar.go.html#5570276">strconv</a></span><span class="op" id="5570991">.</span><span class="ident" id="5570992">FormatFloat</span><span class="op" id="5571003">(</span><span class="ident" id="5571004"><a href="/expvar/expvar.go.html#5570912">v</a></span><span class="op" id="5571005">.</span><span class="ident" id="5571006">f</span><span class="op" id="5571007">,</span>&nbsp;<span class="string" id="5571009">&#39;g&#39;</span><span class="op" id="5571012">,</span>&nbsp;<span class="op" id="5571014">-</span><span class="num" id="5571015">1</span><span class="op" id="5571016">,</span>&nbsp;<span class="num" id="5571018">64</span><span class="op" id="5571020">)</span><br>
<span class="lineno"></span><span class="op" id="5571022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5571025">//&nbsp;Add&nbsp;adds&nbsp;delta&nbsp;to&nbsp;v.</span><br>
<span class="lineno"></span><span class="keyword" id="5571049">func</span>&nbsp;<span class="op" id="5571054">(</span><span class="ident" id="5571055">v</span>&nbsp;<span class="op" id="5571057">*</span><span class="ident" id="5571058"><a href="/expvar/expvar.go.html#5570859">Float</a></span><span class="op" id="5571063">)</span>&nbsp;<span class="ident" id="5571065">Add</span><span class="op" id="5571068">(</span><span class="ident" id="5571069">delta</span>&nbsp;<span class="builtintype" id="5571075">float64</span><span class="op" id="5571082">)</span>&nbsp;<span class="op" id="5571084">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571087"><a href="/expvar/expvar.go.html#5571055">v</a></span><span class="op" id="5571088">.</span><span class="ident" id="5571089">mu</span><span class="op" id="5571091">.</span><span class="ident" id="5571092">Lock</span><span class="op" id="5571096">(</span><span class="op" id="5571097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5571100">defer</span>&nbsp;<span class="ident" id="5571106"><a href="/expvar/expvar.go.html#5571055">v</a></span><span class="op" id="5571107">.</span><span class="ident" id="5571108">mu</span><span class="op" id="5571110">.</span><span class="ident" id="5571111">Unlock</span><span class="op" id="5571117">(</span><span class="op" id="5571118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571121"><a href="/expvar/expvar.go.html#5571055">v</a></span><span class="op" id="5571122">.</span><span class="ident" id="5571123">f</span>&nbsp;<span class="op" id="5571125">+=</span>&nbsp;<span class="ident" id="5571128"><a href="/expvar/expvar.go.html#5571069">delta</a></span><br>
<span class="lineno"></span><span class="op" id="5571134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="5571137">//&nbsp;Set&nbsp;sets&nbsp;v&nbsp;to&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5571161">func</span>&nbsp;<span class="op" id="5571166">(</span><span class="ident" id="5571167">v</span>&nbsp;<span class="op" id="5571169">*</span><span class="ident" id="5571170"><a href="/expvar/expvar.go.html#5570859">Float</a></span><span class="op" id="5571175">)</span>&nbsp;<span class="ident" id="5571177">Set</span><span class="op" id="5571180">(</span><span class="ident" id="5571181">value</span>&nbsp;<span class="builtintype" id="5571187">float64</span><span class="op" id="5571194">)</span>&nbsp;<span class="op" id="5571196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571199"><a href="/expvar/expvar.go.html#5571167">v</a></span><span class="op" id="5571200">.</span><span class="ident" id="5571201">mu</span><span class="op" id="5571203">.</span><span class="ident" id="5571204">Lock</span><span class="op" id="5571208">(</span><span class="op" id="5571209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5571212">defer</span>&nbsp;<span class="ident" id="5571218"><a href="/expvar/expvar.go.html#5571167">v</a></span><span class="op" id="5571219">.</span><span class="ident" id="5571220">mu</span><span class="op" id="5571222">.</span><span class="ident" id="5571223">Unlock</span><span class="op" id="5571229">(</span><span class="op" id="5571230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571233"><a href="/expvar/expvar.go.html#5571167">v</a></span><span class="op" id="5571234">.</span><span class="ident" id="5571235">f</span>&nbsp;<span class="op" id="5571237">=</span>&nbsp;<span class="ident" id="5571239"><a href="/expvar/expvar.go.html#5571181">value</a></span><br>
<span class="lineno">90</span><span class="op" id="5571245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5571248">//&nbsp;Map&nbsp;is&nbsp;a&nbsp;string-to-Var&nbsp;map&nbsp;variable&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;Var&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5571321">type</span>&nbsp;<span class="ident" id="5571326">Map</span>&nbsp;<span class="keyword" id="5571330">struct</span>&nbsp;<span class="op" id="5571337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571340">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5571345"><a href="/expvar/expvar.go.html#5570287">sync</a></span><span class="op" id="5571349">.</span><span class="ident" id="5571350">RWMutex</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571359">m</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5571364">map</span><span class="op" id="5571367">[</span><span class="builtintype" id="5571368">string</span><span class="op" id="5571374">]</span><span class="ident" id="5571375"><a href="/expvar/expvar.go.html#5570357">Var</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571380">keys</span>&nbsp;<span class="op" id="5571385">[</span><span class="op" id="5571386">]</span><span class="builtintype" id="5571387">string</span>&nbsp;<span class="comment" id="5571394">//&nbsp;sorted</span><br>
<span class="lineno"></span><span class="op" id="5571404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5571407">//&nbsp;KeyValue&nbsp;represents&nbsp;a&nbsp;single&nbsp;entry&nbsp;in&nbsp;a&nbsp;Map.</span><br>
<span class="lineno">100</span><span class="keyword" id="5571455">type</span>&nbsp;<span class="ident" id="5571460">KeyValue</span>&nbsp;<span class="keyword" id="5571469">struct</span>&nbsp;<span class="op" id="5571476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571479">Key</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5571485">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571493">Value</span>&nbsp;<span class="ident" id="5571499"><a href="/expvar/expvar.go.html#5570357">Var</a></span><br>
<span class="lineno"></span><span class="op" id="5571503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="5571506">func</span>&nbsp;<span class="op" id="5571511">(</span><span class="ident" id="5571512">v</span>&nbsp;<span class="op" id="5571514">*</span><span class="ident" id="5571515"><a href="/expvar/expvar.go.html#5571326">Map</a></span><span class="op" id="5571518">)</span>&nbsp;<span class="ident" id="5571520">String</span><span class="op" id="5571526">(</span><span class="op" id="5571527">)</span>&nbsp;<span class="builtintype" id="5571529">string</span>&nbsp;<span class="op" id="5571536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571539"><a href="/expvar/expvar.go.html#5571512">v</a></span><span class="op" id="5571540">.</span><span class="ident" id="5571541">mu</span><span class="op" id="5571543">.</span><span class="ident" id="5571544">RLock</span><span class="op" id="5571549">(</span><span class="op" id="5571550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5571553">defer</span>&nbsp;<span class="ident" id="5571559"><a href="/expvar/expvar.go.html#5571512">v</a></span><span class="op" id="5571560">.</span><span class="ident" id="5571561">mu</span><span class="op" id="5571563">.</span><span class="ident" id="5571564">RUnlock</span><span class="op" id="5571571">(</span><span class="op" id="5571572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5571575">var</span>&nbsp;<span class="ident" id="5571579">b</span>&nbsp;<span class="ident" id="5571581"><a href="/expvar/expvar.go.html#5570199">bytes</a></span><span class="op" id="5571586">.</span><span class="ident" id="5571587">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571595"><a href="/expvar/expvar.go.html#5570225">fmt</a></span><span class="op" id="5571598">.</span><span class="ident" id="5571599">Fprintf</span><span class="op" id="5571606">(</span><span class="op" id="5571607">&amp;</span><span class="ident" id="5571608"><a href="/expvar/expvar.go.html#5571579">b</a></span><span class="op" id="5571609">,</span>&nbsp;<span class="string" id="5571611">&#34;{&#34;</span><span class="op" id="5571614">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571617">first</span>&nbsp;<span class="op" id="5571623">:=</span>&nbsp;<span class="ident" id="5571626">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571632"><a href="/expvar/expvar.go.html#5571512">v</a></span><span class="op" id="5571633">.</span><span class="ident" id="5571634">doLocked</span><span class="op" id="5571642">(</span><span class="keyword" id="5571643">func</span><span class="op" id="5571647">(</span><span class="ident" id="5571648">kv</span>&nbsp;<span class="ident" id="5571651"><a href="/expvar/expvar.go.html#5571460">KeyValue</a></span><span class="op" id="5571659">)</span>&nbsp;<span class="op" id="5571661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5571665">if</span>&nbsp;<span class="op" id="5571668">!</span><span class="ident" id="5571669"><a href="/expvar/expvar.go.html#5571617">first</a></span>&nbsp;<span class="op" id="5571675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571680"><a href="/expvar/expvar.go.html#5570225">fmt</a></span><span class="op" id="5571683">.</span><span class="ident" id="5571684">Fprintf</span><span class="op" id="5571691">(</span><span class="op" id="5571692">&amp;</span><span class="ident" id="5571693"><a href="/expvar/expvar.go.html#5571579">b</a></span><span class="op" id="5571694">,</span>&nbsp;<span class="string" id="5571696">&#34;,&nbsp;&#34;</span><span class="op" id="5571700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5571704">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571708"><a href="/expvar/expvar.go.html#5570225">fmt</a></span><span class="op" id="5571711">.</span><span class="ident" id="5571712">Fprintf</span><span class="op" id="5571719">(</span><span class="op" id="5571720">&amp;</span><span class="ident" id="5571721"><a href="/expvar/expvar.go.html#5571579">b</a></span><span class="op" id="5571722">,</span>&nbsp;<span class="string" id="5571724">&#34;%q:&nbsp;%v&#34;</span><span class="op" id="5571732">,</span>&nbsp;<span class="ident" id="5571734"><a href="/expvar/expvar.go.html#5571648">kv</a></span><span class="op" id="5571736">.</span><span class="ident" id="5571737">Key</span><span class="op" id="5571740">,</span>&nbsp;<span class="ident" id="5571742"><a href="/expvar/expvar.go.html#5571648">kv</a></span><span class="op" id="5571744">.</span><span class="ident" id="5571745">Value</span><span class="op" id="5571750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571754"><a href="/expvar/expvar.go.html#5571617">first</a></span>&nbsp;<span class="op" id="5571760">=</span>&nbsp;<span class="ident" id="5571762">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5571769">}</span><span class="op" id="5571770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571773"><a href="/expvar/expvar.go.html#5570225">fmt</a></span><span class="op" id="5571776">.</span><span class="ident" id="5571777">Fprintf</span><span class="op" id="5571784">(</span><span class="op" id="5571785">&amp;</span><span class="ident" id="5571786"><a href="/expvar/expvar.go.html#5571579">b</a></span><span class="op" id="5571787">,</span>&nbsp;<span class="string" id="5571789">&#34;}&#34;</span><span class="op" id="5571792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5571795">return</span>&nbsp;<span class="ident" id="5571802"><a href="/expvar/expvar.go.html#5571579">b</a></span><span class="op" id="5571803">.</span><span class="ident" id="5571804">String</span><span class="op" id="5571810">(</span><span class="op" id="5571811">)</span><br>
<span class="lineno">120</span><span class="op" id="5571813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5571816">func</span>&nbsp;<span class="op" id="5571821">(</span><span class="ident" id="5571822">v</span>&nbsp;<span class="op" id="5571824">*</span><span class="ident" id="5571825"><a href="/expvar/expvar.go.html#5571326">Map</a></span><span class="op" id="5571828">)</span>&nbsp;<span class="ident" id="5571830">Init</span><span class="op" id="5571834">(</span><span class="op" id="5571835">)</span>&nbsp;<span class="op" id="5571837">*</span><span class="ident" id="5571838"><a href="/expvar/expvar.go.html#5571326">Map</a></span>&nbsp;<span class="op" id="5571842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5571845"><a href="/expvar/expvar.go.html#5571822">v</a></span><span class="op" id="5571846">.</span><span class="ident" id="5571847">m</span>&nbsp;<span class="op" id="5571849">=</span>&nbsp;<span class="builtinfunc" id="5571851">make</span><span class="op" id="5571855">(</span><span class="keyword" id="5571856">map</span><span class="op" id="5571859">[</span><span class="builtintype" id="5571860">string</span><span class="op" id="5571866">]</span><span class="ident" id="5571867"><a href="/expvar/expvar.go.html#5570357">Var</a></span><span class="op" id="5571870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5571873">return</span>&nbsp;<span class="ident" id="5571880"><a href="/expvar/expvar.go.html#5571822">v</a></span><br>
<span class="lineno">125</span><span class="op" id="5571882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5571885">//&nbsp;updateKeys&nbsp;updates&nbsp;the&nbsp;sorted&nbsp;list&nbsp;of&nbsp;keys&nbsp;in&nbsp;v.keys.</span><br>
<span class="lineno"></span><span class="comment" id="5571942">//&nbsp;must&nbsp;be&nbsp;called&nbsp;with&nbsp;v.mu&nbsp;held.</span><br>
<span class="lineno"></span><span class="keyword" id="5571976">func</span>&nbsp;<span class="op" id="5571981">(</span><span class="ident" id="5571982">v</span>&nbsp;<span class="op" id="5571984">*</span><span class="ident" id="5571985"><a href="/expvar/expvar.go.html#5571326">Map</a></span><span class="op" id="5571988">)</span>&nbsp;<span class="ident" id="5571990">updateKeys</span><span class="op" id="5572000">(</span><span class="op" id="5572001">)</span>&nbsp;<span class="op" id="5572003">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5572006">if</span>&nbsp;<span class="builtinfunc" id="5572009">len</span><span class="op" id="5572012">(</span><span class="ident" id="5572013"><a href="/expvar/expvar.go.html#5571982">v</a></span><span class="op" id="5572014">.</span><span class="ident" id="5572015">m</span><span class="op" id="5572016">)</span>&nbsp;<span class="op" id="5572018">==</span>&nbsp;<span class="builtinfunc" id="5572021">len</span><span class="op" id="5572024">(</span><span class="ident" id="5572025"><a href="/expvar/expvar.go.html#5571982">v</a></span><span class="op" id="5572026">.</span><span class="ident" id="5572027">keys</span><span class="op" id="5572031">)</span>&nbsp;<span class="op" id="5572033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572037">//&nbsp;No&nbsp;new&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5572054">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5572062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572065"><a href="/expvar/expvar.go.html#5571982">v</a></span><span class="op" id="5572066">.</span><span class="ident" id="5572067">keys</span>&nbsp;<span class="op" id="5572072">=</span>&nbsp;<span class="ident" id="5572074"><a href="/expvar/expvar.go.html#5571982">v</a></span><span class="op" id="5572075">.</span><span class="ident" id="5572076">keys</span><span class="op" id="5572080">[</span><span class="op" id="5572081">:</span><span class="num" id="5572082">0</span><span class="op" id="5572083">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5572086">for</span>&nbsp;<span class="ident" id="5572090">k</span>&nbsp;<span class="op" id="5572092">:=</span>&nbsp;<span class="keyword" id="5572095">range</span>&nbsp;<span class="ident" id="5572101"><a href="/expvar/expvar.go.html#5571982">v</a></span><span class="op" id="5572102">.</span><span class="ident" id="5572103">m</span>&nbsp;<span class="op" id="5572105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572109"><a href="/expvar/expvar.go.html#5571982">v</a></span><span class="op" id="5572110">.</span><span class="ident" id="5572111">keys</span>&nbsp;<span class="op" id="5572116">=</span>&nbsp;<span class="builtinfunc" id="5572118">append</span><span class="op" id="5572124">(</span><span class="ident" id="5572125"><a href="/expvar/expvar.go.html#5571982">v</a></span><span class="op" id="5572126">.</span><span class="ident" id="5572127">keys</span><span class="op" id="5572131">,</span>&nbsp;<span class="ident" id="5572133"><a href="/expvar/expvar.go.html#5572090">k</a></span><span class="op" id="5572134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5572137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572140"><a href="/expvar/expvar.go.html#5570268">sort</a></span><span class="op" id="5572144">.</span><span class="ident" id="5572145">Strings</span><span class="op" id="5572152">(</span><span class="ident" id="5572153"><a href="/expvar/expvar.go.html#5571982">v</a></span><span class="op" id="5572154">.</span><span class="ident" id="5572155">keys</span><span class="op" id="5572159">)</span><br>
<span class="lineno"></span><span class="op" id="5572161">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="5572164">func</span>&nbsp;<span class="op" id="5572169">(</span><span class="ident" id="5572170">v</span>&nbsp;<span class="op" id="5572172">*</span><span class="ident" id="5572173"><a href="/expvar/expvar.go.html#5571326">Map</a></span><span class="op" id="5572176">)</span>&nbsp;<span class="ident" id="5572178">Get</span><span class="op" id="5572181">(</span><span class="ident" id="5572182">key</span>&nbsp;<span class="builtintype" id="5572186">string</span><span class="op" id="5572192">)</span>&nbsp;<span class="ident" id="5572194"><a href="/expvar/expvar.go.html#5570357">Var</a></span>&nbsp;<span class="op" id="5572198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572201"><a href="/expvar/expvar.go.html#5572170">v</a></span><span class="op" id="5572202">.</span><span class="ident" id="5572203">mu</span><span class="op" id="5572205">.</span><span class="ident" id="5572206">RLock</span><span class="op" id="5572211">(</span><span class="op" id="5572212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5572215">defer</span>&nbsp;<span class="ident" id="5572221"><a href="/expvar/expvar.go.html#5572170">v</a></span><span class="op" id="5572222">.</span><span class="ident" id="5572223">mu</span><span class="op" id="5572225">.</span><span class="ident" id="5572226">RUnlock</span><span class="op" id="5572233">(</span><span class="op" id="5572234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5572237">return</span>&nbsp;<span class="ident" id="5572244"><a href="/expvar/expvar.go.html#5572170">v</a></span><span class="op" id="5572245">.</span><span class="ident" id="5572246">m</span><span class="op" id="5572247">[</span><span class="ident" id="5572248"><a href="/expvar/expvar.go.html#5572182">key</a></span><span class="op" id="5572251">]</span><br>
<span class="lineno">145</span><span class="op" id="5572253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5572256">func</span>&nbsp;<span class="op" id="5572261">(</span><span class="ident" id="5572262">v</span>&nbsp;<span class="op" id="5572264">*</span><span class="ident" id="5572265"><a href="/expvar/expvar.go.html#5571326">Map</a></span><span class="op" id="5572268">)</span>&nbsp;<span class="ident" id="5572270">Set</span><span class="op" id="5572273">(</span><span class="ident" id="5572274">key</span>&nbsp;<span class="builtintype" id="5572278">string</span><span class="op" id="5572284">,</span>&nbsp;<span class="ident" id="5572286">av</span>&nbsp;<span class="ident" id="5572289"><a href="/expvar/expvar.go.html#5570357">Var</a></span><span class="op" id="5572292">)</span>&nbsp;<span class="op" id="5572294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572297"><a href="/expvar/expvar.go.html#5572262">v</a></span><span class="op" id="5572298">.</span><span class="ident" id="5572299">mu</span><span class="op" id="5572301">.</span><span class="ident" id="5572302">Lock</span><span class="op" id="5572306">(</span><span class="op" id="5572307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5572310">defer</span>&nbsp;<span class="ident" id="5572316"><a href="/expvar/expvar.go.html#5572262">v</a></span><span class="op" id="5572317">.</span><span class="ident" id="5572318">mu</span><span class="op" id="5572320">.</span><span class="ident" id="5572321">Unlock</span><span class="op" id="5572327">(</span><span class="op" id="5572328">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572331"><a href="/expvar/expvar.go.html#5572262">v</a></span><span class="op" id="5572332">.</span><span class="ident" id="5572333">m</span><span class="op" id="5572334">[</span><span class="ident" id="5572335"><a href="/expvar/expvar.go.html#5572274">key</a></span><span class="op" id="5572338">]</span>&nbsp;<span class="op" id="5572340">=</span>&nbsp;<span class="ident" id="5572342"><a href="/expvar/expvar.go.html#5572286">av</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572346"><a href="/expvar/expvar.go.html#5572262">v</a></span><span class="op" id="5572347">.</span><span class="ident" id="5572348">updateKeys</span><span class="op" id="5572358">(</span><span class="op" id="5572359">)</span><br>
<span class="lineno"></span><span class="op" id="5572361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5572364">func</span>&nbsp;<span class="op" id="5572369">(</span><span class="ident" id="5572370">v</span>&nbsp;<span class="op" id="5572372">*</span><span class="ident" id="5572373"><a href="/expvar/expvar.go.html#5571326">Map</a></span><span class="op" id="5572376">)</span>&nbsp;<span class="ident" id="5572378">Add</span><span class="op" id="5572381">(</span><span class="ident" id="5572382">key</span>&nbsp;<span class="builtintype" id="5572386">string</span><span class="op" id="5572392">,</span>&nbsp;<span class="ident" id="5572394">delta</span>&nbsp;<span class="ident" id="5572400">int64</span><span class="op" id="5572405">)</span>&nbsp;<span class="op" id="5572407">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572410"><a href="/expvar/expvar.go.html#5572370">v</a></span><span class="op" id="5572411">.</span><span class="ident" id="5572412">mu</span><span class="op" id="5572414">.</span><span class="ident" id="5572415">RLock</span><span class="op" id="5572420">(</span><span class="op" id="5572421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572424">av</span><span class="op" id="5572426">,</span>&nbsp;<span class="ident" id="5572428">ok</span>&nbsp;<span class="op" id="5572431">:=</span>&nbsp;<span class="ident" id="5572434"><a href="/expvar/expvar.go.html#5572370">v</a></span><span class="op" id="5572435">.</span><span class="ident" id="5572436">m</span><span class="op" id="5572437">[</span><span class="ident" id="5572438"><a href="/expvar/expvar.go.html#5572382">key</a></span><span class="op" id="5572441">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572444"><a href="/expvar/expvar.go.html#5572370">v</a></span><span class="op" id="5572445">.</span><span class="ident" id="5572446">mu</span><span class="op" id="5572448">.</span><span class="ident" id="5572449">RUnlock</span><span class="op" id="5572456">(</span><span class="op" id="5572457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5572460">if</span>&nbsp;<span class="op" id="5572463">!</span><span class="ident" id="5572464"><a href="/expvar/expvar.go.html#5572428">ok</a></span>&nbsp;<span class="op" id="5572467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572471">//&nbsp;check&nbsp;again&nbsp;under&nbsp;the&nbsp;write&nbsp;lock</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572509"><a href="/expvar/expvar.go.html#5572370">v</a></span><span class="op" id="5572510">.</span><span class="ident" id="5572511">mu</span><span class="op" id="5572513">.</span><span class="ident" id="5572514">Lock</span><span class="op" id="5572518">(</span><span class="op" id="5572519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572523"><a href="/expvar/expvar.go.html#5572424">av</a></span><span class="op" id="5572525">,</span>&nbsp;<span class="ident" id="5572527"><a href="/expvar/expvar.go.html#5572428">ok</a></span>&nbsp;<span class="op" id="5572530">=</span>&nbsp;<span class="ident" id="5572532"><a href="/expvar/expvar.go.html#5572370">v</a></span><span class="op" id="5572533">.</span><span class="ident" id="5572534">m</span><span class="op" id="5572535">[</span><span class="ident" id="5572536"><a href="/expvar/expvar.go.html#5572382">key</a></span><span class="op" id="5572539">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5572543">if</span>&nbsp;<span class="op" id="5572546">!</span><span class="ident" id="5572547"><a href="/expvar/expvar.go.html#5572428">ok</a></span>&nbsp;<span class="op" id="5572550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572555"><a href="/expvar/expvar.go.html#5572424">av</a></span>&nbsp;<span class="op" id="5572558">=</span>&nbsp;<span class="builtinfunc" id="5572560">new</span><span class="op" id="5572563">(</span><span class="ident" id="5572564"><a href="/expvar/expvar.go.html#5570468">Int</a></span><span class="op" id="5572567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572572"><a href="/expvar/expvar.go.html#5572370">v</a></span><span class="op" id="5572573">.</span><span class="ident" id="5572574">m</span><span class="op" id="5572575">[</span><span class="ident" id="5572576"><a href="/expvar/expvar.go.html#5572382">key</a></span><span class="op" id="5572579">]</span>&nbsp;<span class="op" id="5572581">=</span>&nbsp;<span class="ident" id="5572583"><a href="/expvar/expvar.go.html#5572424">av</a></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572589"><a href="/expvar/expvar.go.html#5572370">v</a></span><span class="op" id="5572590">.</span><span class="ident" id="5572591">updateKeys</span><span class="op" id="5572601">(</span><span class="op" id="5572602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5572606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572610"><a href="/expvar/expvar.go.html#5572370">v</a></span><span class="op" id="5572611">.</span><span class="ident" id="5572612">mu</span><span class="op" id="5572614">.</span><span class="ident" id="5572615">Unlock</span><span class="op" id="5572621">(</span><span class="op" id="5572622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5572625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572629">//&nbsp;Add&nbsp;to&nbsp;Int;&nbsp;ignore&nbsp;otherwise.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5572663">if</span>&nbsp;<span class="ident" id="5572666">iv</span><span class="op" id="5572668">,</span>&nbsp;<span class="ident" id="5572670">ok</span>&nbsp;<span class="op" id="5572673">:=</span>&nbsp;<span class="ident" id="5572676"><a href="/expvar/expvar.go.html#5572424">av</a></span><span class="op" id="5572678">.</span><span class="op" id="5572679">(</span><span class="op" id="5572680">*</span><span class="ident" id="5572681"><a href="/expvar/expvar.go.html#5570468">Int</a></span><span class="op" id="5572684">)</span><span class="op" id="5572685">;</span>&nbsp;<span class="ident" id="5572687"><a href="/expvar/expvar.go.html#5572670">ok</a></span>&nbsp;<span class="op" id="5572690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572694"><a href="/expvar/expvar.go.html#5572666">iv</a></span><span class="op" id="5572696">.</span><span class="ident" id="5572697">Add</span><span class="op" id="5572700">(</span><span class="ident" id="5572701"><a href="/expvar/expvar.go.html#5572394">delta</a></span><span class="op" id="5572706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5572709">}</span><br>
<span class="lineno"></span><span class="op" id="5572711">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="5572714">//&nbsp;AddFloat&nbsp;adds&nbsp;delta&nbsp;to&nbsp;the&nbsp;*Float&nbsp;value&nbsp;stored&nbsp;under&nbsp;the&nbsp;given&nbsp;map&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="5572789">func</span>&nbsp;<span class="op" id="5572794">(</span><span class="ident" id="5572795">v</span>&nbsp;<span class="op" id="5572797">*</span><span class="ident" id="5572798"><a href="/expvar/expvar.go.html#5571326">Map</a></span><span class="op" id="5572801">)</span>&nbsp;<span class="ident" id="5572803">AddFloat</span><span class="op" id="5572811">(</span><span class="ident" id="5572812">key</span>&nbsp;<span class="builtintype" id="5572816">string</span><span class="op" id="5572822">,</span>&nbsp;<span class="ident" id="5572824">delta</span>&nbsp;<span class="builtintype" id="5572830">float64</span><span class="op" id="5572837">)</span>&nbsp;<span class="op" id="5572839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572842"><a href="/expvar/expvar.go.html#5572795">v</a></span><span class="op" id="5572843">.</span><span class="ident" id="5572844">mu</span><span class="op" id="5572846">.</span><span class="ident" id="5572847">RLock</span><span class="op" id="5572852">(</span><span class="op" id="5572853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572856">av</span><span class="op" id="5572858">,</span>&nbsp;<span class="ident" id="5572860">ok</span>&nbsp;<span class="op" id="5572863">:=</span>&nbsp;<span class="ident" id="5572866"><a href="/expvar/expvar.go.html#5572795">v</a></span><span class="op" id="5572867">.</span><span class="ident" id="5572868">m</span><span class="op" id="5572869">[</span><span class="ident" id="5572870"><a href="/expvar/expvar.go.html#5572812">key</a></span><span class="op" id="5572873">]</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572876"><a href="/expvar/expvar.go.html#5572795">v</a></span><span class="op" id="5572877">.</span><span class="ident" id="5572878">mu</span><span class="op" id="5572880">.</span><span class="ident" id="5572881">RUnlock</span><span class="op" id="5572888">(</span><span class="op" id="5572889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5572892">if</span>&nbsp;<span class="op" id="5572895">!</span><span class="ident" id="5572896"><a href="/expvar/expvar.go.html#5572860">ok</a></span>&nbsp;<span class="op" id="5572899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572903">//&nbsp;check&nbsp;again&nbsp;under&nbsp;the&nbsp;write&nbsp;lock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572941"><a href="/expvar/expvar.go.html#5572795">v</a></span><span class="op" id="5572942">.</span><span class="ident" id="5572943">mu</span><span class="op" id="5572945">.</span><span class="ident" id="5572946">Lock</span><span class="op" id="5572950">(</span><span class="op" id="5572951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572955"><a href="/expvar/expvar.go.html#5572856">av</a></span><span class="op" id="5572957">,</span>&nbsp;<span class="ident" id="5572959"><a href="/expvar/expvar.go.html#5572860">ok</a></span>&nbsp;<span class="op" id="5572962">=</span>&nbsp;<span class="ident" id="5572964"><a href="/expvar/expvar.go.html#5572795">v</a></span><span class="op" id="5572965">.</span><span class="ident" id="5572966">m</span><span class="op" id="5572967">[</span><span class="ident" id="5572968"><a href="/expvar/expvar.go.html#5572812">key</a></span><span class="op" id="5572971">]</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5572975">if</span>&nbsp;<span class="op" id="5572978">!</span><span class="ident" id="5572979"><a href="/expvar/expvar.go.html#5572860">ok</a></span>&nbsp;<span class="op" id="5572982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572987"><a href="/expvar/expvar.go.html#5572856">av</a></span>&nbsp;<span class="op" id="5572990">=</span>&nbsp;<span class="builtinfunc" id="5572992">new</span><span class="op" id="5572995">(</span><span class="ident" id="5572996"><a href="/expvar/expvar.go.html#5570859">Float</a></span><span class="op" id="5573001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573006"><a href="/expvar/expvar.go.html#5572795">v</a></span><span class="op" id="5573007">.</span><span class="ident" id="5573008">m</span><span class="op" id="5573009">[</span><span class="ident" id="5573010"><a href="/expvar/expvar.go.html#5572812">key</a></span><span class="op" id="5573013">]</span>&nbsp;<span class="op" id="5573015">=</span>&nbsp;<span class="ident" id="5573017"><a href="/expvar/expvar.go.html#5572856">av</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573023"><a href="/expvar/expvar.go.html#5572795">v</a></span><span class="op" id="5573024">.</span><span class="ident" id="5573025">updateKeys</span><span class="op" id="5573035">(</span><span class="op" id="5573036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5573040">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573044"><a href="/expvar/expvar.go.html#5572795">v</a></span><span class="op" id="5573045">.</span><span class="ident" id="5573046">mu</span><span class="op" id="5573048">.</span><span class="ident" id="5573049">Unlock</span><span class="op" id="5573055">(</span><span class="op" id="5573056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5573059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573063">//&nbsp;Add&nbsp;to&nbsp;Float;&nbsp;ignore&nbsp;otherwise.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5573099">if</span>&nbsp;<span class="ident" id="5573102">iv</span><span class="op" id="5573104">,</span>&nbsp;<span class="ident" id="5573106">ok</span>&nbsp;<span class="op" id="5573109">:=</span>&nbsp;<span class="ident" id="5573112"><a href="/expvar/expvar.go.html#5572856">av</a></span><span class="op" id="5573114">.</span><span class="op" id="5573115">(</span><span class="op" id="5573116">*</span><span class="ident" id="5573117"><a href="/expvar/expvar.go.html#5570859">Float</a></span><span class="op" id="5573122">)</span><span class="op" id="5573123">;</span>&nbsp;<span class="ident" id="5573125"><a href="/expvar/expvar.go.html#5573106">ok</a></span>&nbsp;<span class="op" id="5573128">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573132"><a href="/expvar/expvar.go.html#5573102">iv</a></span><span class="op" id="5573134">.</span><span class="ident" id="5573135">Add</span><span class="op" id="5573138">(</span><span class="ident" id="5573139"><a href="/expvar/expvar.go.html#5572824">delta</a></span><span class="op" id="5573144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5573147">}</span><br>
<span class="lineno"></span><span class="op" id="5573149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5573152">//&nbsp;Do&nbsp;calls&nbsp;f&nbsp;for&nbsp;each&nbsp;entry&nbsp;in&nbsp;the&nbsp;map.</span><br>
<span class="lineno">200</span><span class="comment" id="5573193">//&nbsp;The&nbsp;map&nbsp;is&nbsp;locked&nbsp;during&nbsp;the&nbsp;iteration,</span><br>
<span class="lineno"></span><span class="comment" id="5573236">//&nbsp;but&nbsp;existing&nbsp;entries&nbsp;may&nbsp;be&nbsp;concurrently&nbsp;updated.</span><br>
<span class="lineno"></span><span class="keyword" id="5573289">func</span>&nbsp;<span class="op" id="5573294">(</span><span class="ident" id="5573295">v</span>&nbsp;<span class="op" id="5573297">*</span><span class="ident" id="5573298"><a href="/expvar/expvar.go.html#5571326">Map</a></span><span class="op" id="5573301">)</span>&nbsp;<span class="ident" id="5573303">Do</span><span class="op" id="5573305">(</span><span class="ident" id="5573306">f</span>&nbsp;<span class="keyword" id="5573308">func</span><span class="op" id="5573312">(</span><span class="ident" id="5573313"><a href="/expvar/expvar.go.html#5571460">KeyValue</a></span><span class="op" id="5573321">)</span><span class="op" id="5573322">)</span>&nbsp;<span class="op" id="5573324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573327"><a href="/expvar/expvar.go.html#5573295">v</a></span><span class="op" id="5573328">.</span><span class="ident" id="5573329">mu</span><span class="op" id="5573331">.</span><span class="ident" id="5573332">RLock</span><span class="op" id="5573337">(</span><span class="op" id="5573338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5573341">defer</span>&nbsp;<span class="ident" id="5573347"><a href="/expvar/expvar.go.html#5573295">v</a></span><span class="op" id="5573348">.</span><span class="ident" id="5573349">mu</span><span class="op" id="5573351">.</span><span class="ident" id="5573352">RUnlock</span><span class="op" id="5573359">(</span><span class="op" id="5573360">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573363"><a href="/expvar/expvar.go.html#5573295">v</a></span><span class="op" id="5573364">.</span><span class="ident" id="5573365">doLocked</span><span class="op" id="5573373">(</span><span class="ident" id="5573374"><a href="/expvar/expvar.go.html#5573306">f</a></span><span class="op" id="5573375">)</span><br>
<span class="lineno"></span><span class="op" id="5573377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5573380">//&nbsp;doLocked&nbsp;calls&nbsp;f&nbsp;for&nbsp;each&nbsp;entry&nbsp;in&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="5573427">//&nbsp;v.mu&nbsp;must&nbsp;be&nbsp;held&nbsp;for&nbsp;reads.</span><br>
<span class="lineno">210</span><span class="keyword" id="5573459">func</span>&nbsp;<span class="op" id="5573464">(</span><span class="ident" id="5573465">v</span>&nbsp;<span class="op" id="5573467">*</span><span class="ident" id="5573468"><a href="/expvar/expvar.go.html#5571326">Map</a></span><span class="op" id="5573471">)</span>&nbsp;<span class="ident" id="5573473">doLocked</span><span class="op" id="5573481">(</span><span class="ident" id="5573482">f</span>&nbsp;<span class="keyword" id="5573484">func</span><span class="op" id="5573488">(</span><span class="ident" id="5573489"><a href="/expvar/expvar.go.html#5571460">KeyValue</a></span><span class="op" id="5573497">)</span><span class="op" id="5573498">)</span>&nbsp;<span class="op" id="5573500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5573503">for</span>&nbsp;<span class="ident" id="5573507">_</span><span class="op" id="5573508">,</span>&nbsp;<span class="ident" id="5573510">k</span>&nbsp;<span class="op" id="5573512">:=</span>&nbsp;<span class="keyword" id="5573515">range</span>&nbsp;<span class="ident" id="5573521"><a href="/expvar/expvar.go.html#5573465">v</a></span><span class="op" id="5573522">.</span><span class="ident" id="5573523">keys</span>&nbsp;<span class="op" id="5573528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573532"><a href="/expvar/expvar.go.html#5573482">f</a></span><span class="op" id="5573533">(</span><span class="ident" id="5573534"><a href="/expvar/expvar.go.html#5571460">KeyValue</a></span><span class="op" id="5573542">{</span><span class="ident" id="5573543"><a href="/expvar/expvar.go.html#5573510">k</a></span><span class="op" id="5573544">,</span>&nbsp;<span class="ident" id="5573546"><a href="/expvar/expvar.go.html#5573465">v</a></span><span class="op" id="5573547">.</span><span class="ident" id="5573548">m</span><span class="op" id="5573549">[</span><span class="ident" id="5573550"><a href="/expvar/expvar.go.html#5573510">k</a></span><span class="op" id="5573551">]</span><span class="op" id="5573552">}</span><span class="op" id="5573553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5573556">}</span><br>
<span class="lineno"></span><span class="op" id="5573558">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="comment" id="5573561">//&nbsp;String&nbsp;is&nbsp;a&nbsp;string&nbsp;variable,&nbsp;and&nbsp;satisfies&nbsp;the&nbsp;Var&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5573626">type</span>&nbsp;<span class="ident" id="5573631">String</span>&nbsp;<span class="keyword" id="5573638">struct</span>&nbsp;<span class="op" id="5573645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573648">mu</span>&nbsp;<span class="ident" id="5573651"><a href="/expvar/expvar.go.html#5570287">sync</a></span><span class="op" id="5573655">.</span><span class="ident" id="5573656">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573665">s</span>&nbsp;&nbsp;<span class="builtintype" id="5573668">string</span><br>
<span class="lineno">220</span><span class="op" id="5573675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5573678">func</span>&nbsp;<span class="op" id="5573683">(</span><span class="ident" id="5573684">v</span>&nbsp;<span class="op" id="5573686">*</span><span class="ident" id="5573687"><a href="/expvar/expvar.go.html#5573631">String</a></span><span class="op" id="5573693">)</span>&nbsp;<span class="ident" id="5573695">String</span><span class="op" id="5573701">(</span><span class="op" id="5573702">)</span>&nbsp;<span class="builtintype" id="5573704">string</span>&nbsp;<span class="op" id="5573711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573714"><a href="/expvar/expvar.go.html#5573684">v</a></span><span class="op" id="5573715">.</span><span class="ident" id="5573716">mu</span><span class="op" id="5573718">.</span><span class="ident" id="5573719">RLock</span><span class="op" id="5573724">(</span><span class="op" id="5573725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5573728">defer</span>&nbsp;<span class="ident" id="5573734"><a href="/expvar/expvar.go.html#5573684">v</a></span><span class="op" id="5573735">.</span><span class="ident" id="5573736">mu</span><span class="op" id="5573738">.</span><span class="ident" id="5573739">RUnlock</span><span class="op" id="5573746">(</span><span class="op" id="5573747">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5573750">return</span>&nbsp;<span class="ident" id="5573757"><a href="/expvar/expvar.go.html#5570276">strconv</a></span><span class="op" id="5573764">.</span><span class="ident" id="5573765">Quote</span><span class="op" id="5573770">(</span><span class="ident" id="5573771"><a href="/expvar/expvar.go.html#5573684">v</a></span><span class="op" id="5573772">.</span><span class="ident" id="5573773">s</span><span class="op" id="5573774">)</span><br>
<span class="lineno"></span><span class="op" id="5573776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5573779">func</span>&nbsp;<span class="op" id="5573784">(</span><span class="ident" id="5573785">v</span>&nbsp;<span class="op" id="5573787">*</span><span class="ident" id="5573788"><a href="/expvar/expvar.go.html#5573631">String</a></span><span class="op" id="5573794">)</span>&nbsp;<span class="ident" id="5573796">Set</span><span class="op" id="5573799">(</span><span class="ident" id="5573800">value</span>&nbsp;<span class="builtintype" id="5573806">string</span><span class="op" id="5573812">)</span>&nbsp;<span class="op" id="5573814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573817"><a href="/expvar/expvar.go.html#5573785">v</a></span><span class="op" id="5573818">.</span><span class="ident" id="5573819">mu</span><span class="op" id="5573821">.</span><span class="ident" id="5573822">Lock</span><span class="op" id="5573826">(</span><span class="op" id="5573827">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5573830">defer</span>&nbsp;<span class="ident" id="5573836"><a href="/expvar/expvar.go.html#5573785">v</a></span><span class="op" id="5573837">.</span><span class="ident" id="5573838">mu</span><span class="op" id="5573840">.</span><span class="ident" id="5573841">Unlock</span><span class="op" id="5573847">(</span><span class="op" id="5573848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573851"><a href="/expvar/expvar.go.html#5573785">v</a></span><span class="op" id="5573852">.</span><span class="ident" id="5573853">s</span>&nbsp;<span class="op" id="5573855">=</span>&nbsp;<span class="ident" id="5573857"><a href="/expvar/expvar.go.html#5573800">value</a></span><br>
<span class="lineno"></span><span class="op" id="5573863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5573866">//&nbsp;Func&nbsp;implements&nbsp;Var&nbsp;by&nbsp;calling&nbsp;the&nbsp;function</span><br>
<span class="lineno">235</span><span class="comment" id="5573913">//&nbsp;and&nbsp;formatting&nbsp;the&nbsp;returned&nbsp;value&nbsp;using&nbsp;JSON.</span><br>
<span class="lineno"></span><span class="keyword" id="5573962">type</span>&nbsp;<span class="ident" id="5573967">Func</span>&nbsp;<span class="keyword" id="5573972">func</span><span class="op" id="5573976">(</span><span class="op" id="5573977">)</span>&nbsp;<span class="keyword" id="5573979">interface</span><span class="op" id="5573988">{</span><span class="op" id="5573989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5573992">func</span>&nbsp;<span class="op" id="5573997">(</span><span class="ident" id="5573998">f</span>&nbsp;<span class="ident" id="5574000"><a href="/expvar/expvar.go.html#5573967">Func</a></span><span class="op" id="5574004">)</span>&nbsp;<span class="ident" id="5574006">String</span><span class="op" id="5574012">(</span><span class="op" id="5574013">)</span>&nbsp;<span class="builtintype" id="5574015">string</span>&nbsp;<span class="op" id="5574022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574025">v</span><span class="op" id="5574026">,</span>&nbsp;<span class="ident" id="5574028">_</span>&nbsp;<span class="op" id="5574030">:=</span>&nbsp;<span class="ident" id="5574033"><a href="/expvar/expvar.go.html#5570208">json</a></span><span class="op" id="5574037">.</span><span class="ident" id="5574038">Marshal</span><span class="op" id="5574045">(</span><span class="ident" id="5574046"><a href="/expvar/expvar.go.html#5573998">f</a></span><span class="op" id="5574047">(</span><span class="op" id="5574048">)</span><span class="op" id="5574049">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5574052">return</span>&nbsp;<span class="builtintype" id="5574059">string</span><span class="op" id="5574065">(</span><span class="ident" id="5574066"><a href="/expvar/expvar.go.html#5574025">v</a></span><span class="op" id="5574067">)</span><br>
<span class="lineno"></span><span class="op" id="5574069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5574072">//&nbsp;All&nbsp;published&nbsp;variables.</span><br>
<span class="lineno"></span><span class="keyword" id="5574100">var</span>&nbsp;<span class="op" id="5574104">(</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574107">mutex</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5574115"><a href="/expvar/expvar.go.html#5570287">sync</a></span><span class="op" id="5574119">.</span><span class="ident" id="5574120">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574129">vars</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5574137">=</span>&nbsp;<span class="builtinfunc" id="5574139">make</span><span class="op" id="5574143">(</span><span class="keyword" id="5574144">map</span><span class="op" id="5574147">[</span><span class="builtintype" id="5574148">string</span><span class="op" id="5574154">]</span><span class="ident" id="5574155"><a href="/expvar/expvar.go.html#5570357">Var</a></span><span class="op" id="5574158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574161">varKeys</span>&nbsp;<span class="op" id="5574169">[</span><span class="op" id="5574170">]</span><span class="builtintype" id="5574171">string</span>&nbsp;<span class="comment" id="5574178">//&nbsp;sorted</span><br>
<span class="lineno"></span><span class="op" id="5574188">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="5574191">//&nbsp;Publish&nbsp;declares&nbsp;a&nbsp;named&nbsp;exported&nbsp;variable.&nbsp;This&nbsp;should&nbsp;be&nbsp;called&nbsp;from&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5574267">//&nbsp;package&#39;s&nbsp;init&nbsp;function&nbsp;when&nbsp;it&nbsp;creates&nbsp;its&nbsp;Vars.&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="5574343">//&nbsp;registered&nbsp;then&nbsp;this&nbsp;will&nbsp;log.Panic.</span><br>
<span class="lineno"></span><span class="keyword" id="5574383">func</span>&nbsp;<span class="ident" id="5574388">Publish</span><span class="op" id="5574395">(</span><span class="ident" id="5574396">name</span>&nbsp;<span class="builtintype" id="5574401">string</span><span class="op" id="5574407">,</span>&nbsp;<span class="ident" id="5574409">v</span>&nbsp;<span class="ident" id="5574411"><a href="/expvar/expvar.go.html#5570357">Var</a></span><span class="op" id="5574414">)</span>&nbsp;<span class="op" id="5574416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574419"><a href="/expvar/expvar.go.html#5574107">mutex</a></span><span class="op" id="5574424">.</span><span class="ident" id="5574425">Lock</span><span class="op" id="5574429">(</span><span class="op" id="5574430">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5574433">defer</span>&nbsp;<span class="ident" id="5574439"><a href="/expvar/expvar.go.html#5574107">mutex</a></span><span class="op" id="5574444">.</span><span class="ident" id="5574445">Unlock</span><span class="op" id="5574451">(</span><span class="op" id="5574452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5574455">if</span>&nbsp;<span class="ident" id="5574458">_</span><span class="op" id="5574459">,</span>&nbsp;<span class="ident" id="5574461">existing</span>&nbsp;<span class="op" id="5574470">:=</span>&nbsp;<span class="ident" id="5574473"><a href="/expvar/expvar.go.html#5574129">vars</a></span><span class="op" id="5574477">[</span><span class="ident" id="5574478"><a href="/expvar/expvar.go.html#5574396">name</a></span><span class="op" id="5574482">]</span><span class="op" id="5574483">;</span>&nbsp;<span class="ident" id="5574485"><a href="/expvar/expvar.go.html#5574461">existing</a></span>&nbsp;<span class="op" id="5574494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574498"><a href="/expvar/expvar.go.html#5570232">log</a></span><span class="op" id="5574501">.</span><span class="ident" id="5574502">Panicln</span><span class="op" id="5574509">(</span><span class="string" id="5574510">&#34;Reuse&nbsp;of&nbsp;exported&nbsp;var&nbsp;name:&#34;</span><span class="op" id="5574539">,</span>&nbsp;<span class="ident" id="5574541"><a href="/expvar/expvar.go.html#5574396">name</a></span><span class="op" id="5574545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5574548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574551"><a href="/expvar/expvar.go.html#5574129">vars</a></span><span class="op" id="5574555">[</span><span class="ident" id="5574556"><a href="/expvar/expvar.go.html#5574396">name</a></span><span class="op" id="5574560">]</span>&nbsp;<span class="op" id="5574562">=</span>&nbsp;<span class="ident" id="5574564"><a href="/expvar/expvar.go.html#5574409">v</a></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574567"><a href="/expvar/expvar.go.html#5574161">varKeys</a></span>&nbsp;<span class="op" id="5574575">=</span>&nbsp;<span class="builtinfunc" id="5574577">append</span><span class="op" id="5574583">(</span><span class="ident" id="5574584"><a href="/expvar/expvar.go.html#5574161">varKeys</a></span><span class="op" id="5574591">,</span>&nbsp;<span class="ident" id="5574593"><a href="/expvar/expvar.go.html#5574396">name</a></span><span class="op" id="5574597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574600"><a href="/expvar/expvar.go.html#5570268">sort</a></span><span class="op" id="5574604">.</span><span class="ident" id="5574605">Strings</span><span class="op" id="5574612">(</span><span class="ident" id="5574613"><a href="/expvar/expvar.go.html#5574161">varKeys</a></span><span class="op" id="5574620">)</span><br>
<span class="lineno"></span><span class="op" id="5574622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5574625">//&nbsp;Get&nbsp;retrieves&nbsp;a&nbsp;named&nbsp;exported&nbsp;variable.</span><br>
<span class="lineno">265</span><span class="keyword" id="5574669">func</span>&nbsp;<span class="ident" id="5574674">Get</span><span class="op" id="5574677">(</span><span class="ident" id="5574678">name</span>&nbsp;<span class="builtintype" id="5574683">string</span><span class="op" id="5574689">)</span>&nbsp;<span class="ident" id="5574691"><a href="/expvar/expvar.go.html#5570357">Var</a></span>&nbsp;<span class="op" id="5574695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574698"><a href="/expvar/expvar.go.html#5574107">mutex</a></span><span class="op" id="5574703">.</span><span class="ident" id="5574704">RLock</span><span class="op" id="5574709">(</span><span class="op" id="5574710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5574713">defer</span>&nbsp;<span class="ident" id="5574719"><a href="/expvar/expvar.go.html#5574107">mutex</a></span><span class="op" id="5574724">.</span><span class="ident" id="5574725">RUnlock</span><span class="op" id="5574732">(</span><span class="op" id="5574733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5574736">return</span>&nbsp;<span class="ident" id="5574743"><a href="/expvar/expvar.go.html#5574129">vars</a></span><span class="op" id="5574747">[</span><span class="ident" id="5574748"><a href="/expvar/expvar.go.html#5574678">name</a></span><span class="op" id="5574752">]</span><br>
<span class="lineno"></span><span class="op" id="5574754">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="5574757">//&nbsp;Convenience&nbsp;functions&nbsp;for&nbsp;creating&nbsp;new&nbsp;exported&nbsp;variables.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5574820">func</span>&nbsp;<span class="ident" id="5574825">NewInt</span><span class="op" id="5574831">(</span><span class="ident" id="5574832">name</span>&nbsp;<span class="builtintype" id="5574837">string</span><span class="op" id="5574843">)</span>&nbsp;<span class="op" id="5574845">*</span><span class="ident" id="5574846"><a href="/expvar/expvar.go.html#5570468">Int</a></span>&nbsp;<span class="op" id="5574850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574853">v</span>&nbsp;<span class="op" id="5574855">:=</span>&nbsp;<span class="builtinfunc" id="5574858">new</span><span class="op" id="5574861">(</span><span class="ident" id="5574862"><a href="/expvar/expvar.go.html#5570468">Int</a></span><span class="op" id="5574865">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574868"><a href="/expvar/expvar.go.html#5574388">Publish</a></span><span class="op" id="5574875">(</span><span class="ident" id="5574876"><a href="/expvar/expvar.go.html#5574832">name</a></span><span class="op" id="5574880">,</span>&nbsp;<span class="ident" id="5574882"><a href="/expvar/expvar.go.html#5574853">v</a></span><span class="op" id="5574883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5574886">return</span>&nbsp;<span class="ident" id="5574893"><a href="/expvar/expvar.go.html#5574853">v</a></span><br>
<span class="lineno"></span><span class="op" id="5574895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5574898">func</span>&nbsp;<span class="ident" id="5574903">NewFloat</span><span class="op" id="5574911">(</span><span class="ident" id="5574912">name</span>&nbsp;<span class="builtintype" id="5574917">string</span><span class="op" id="5574923">)</span>&nbsp;<span class="op" id="5574925">*</span><span class="ident" id="5574926"><a href="/expvar/expvar.go.html#5570859">Float</a></span>&nbsp;<span class="op" id="5574932">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574935">v</span>&nbsp;<span class="op" id="5574937">:=</span>&nbsp;<span class="builtinfunc" id="5574940">new</span><span class="op" id="5574943">(</span><span class="ident" id="5574944"><a href="/expvar/expvar.go.html#5570859">Float</a></span><span class="op" id="5574949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574952"><a href="/expvar/expvar.go.html#5574388">Publish</a></span><span class="op" id="5574959">(</span><span class="ident" id="5574960"><a href="/expvar/expvar.go.html#5574912">name</a></span><span class="op" id="5574964">,</span>&nbsp;<span class="ident" id="5574966"><a href="/expvar/expvar.go.html#5574935">v</a></span><span class="op" id="5574967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5574970">return</span>&nbsp;<span class="ident" id="5574977"><a href="/expvar/expvar.go.html#5574935">v</a></span><br>
<span class="lineno"></span><span class="op" id="5574979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="5574982">func</span>&nbsp;<span class="ident" id="5574987">NewMap</span><span class="op" id="5574993">(</span><span class="ident" id="5574994">name</span>&nbsp;<span class="builtintype" id="5574999">string</span><span class="op" id="5575005">)</span>&nbsp;<span class="op" id="5575007">*</span><span class="ident" id="5575008"><a href="/expvar/expvar.go.html#5571326">Map</a></span>&nbsp;<span class="op" id="5575012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575015">v</span>&nbsp;<span class="op" id="5575017">:=</span>&nbsp;<span class="builtinfunc" id="5575020">new</span><span class="op" id="5575023">(</span><span class="ident" id="5575024"><a href="/expvar/expvar.go.html#5571326">Map</a></span><span class="op" id="5575027">)</span><span class="op" id="5575028">.</span><span class="ident" id="5575029">Init</span><span class="op" id="5575033">(</span><span class="op" id="5575034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575037"><a href="/expvar/expvar.go.html#5574388">Publish</a></span><span class="op" id="5575044">(</span><span class="ident" id="5575045"><a href="/expvar/expvar.go.html#5574994">name</a></span><span class="op" id="5575049">,</span>&nbsp;<span class="ident" id="5575051"><a href="/expvar/expvar.go.html#5575015">v</a></span><span class="op" id="5575052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5575055">return</span>&nbsp;<span class="ident" id="5575062"><a href="/expvar/expvar.go.html#5575015">v</a></span><br>
<span class="lineno"></span><span class="op" id="5575064">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="keyword" id="5575067">func</span>&nbsp;<span class="ident" id="5575072">NewString</span><span class="op" id="5575081">(</span><span class="ident" id="5575082">name</span>&nbsp;<span class="builtintype" id="5575087">string</span><span class="op" id="5575093">)</span>&nbsp;<span class="op" id="5575095">*</span><span class="ident" id="5575096"><a href="/expvar/expvar.go.html#5573631">String</a></span>&nbsp;<span class="op" id="5575103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575106">v</span>&nbsp;<span class="op" id="5575108">:=</span>&nbsp;<span class="builtinfunc" id="5575111">new</span><span class="op" id="5575114">(</span><span class="ident" id="5575115"><a href="/expvar/expvar.go.html#5573631">String</a></span><span class="op" id="5575121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575124"><a href="/expvar/expvar.go.html#5574388">Publish</a></span><span class="op" id="5575131">(</span><span class="ident" id="5575132"><a href="/expvar/expvar.go.html#5575082">name</a></span><span class="op" id="5575136">,</span>&nbsp;<span class="ident" id="5575138"><a href="/expvar/expvar.go.html#5575106">v</a></span><span class="op" id="5575139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5575142">return</span>&nbsp;<span class="ident" id="5575149"><a href="/expvar/expvar.go.html#5575106">v</a></span><br>
<span class="lineno">295</span><span class="op" id="5575151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5575154">//&nbsp;Do&nbsp;calls&nbsp;f&nbsp;for&nbsp;each&nbsp;exported&nbsp;variable.</span><br>
<span class="lineno"></span><span class="comment" id="5575196">//&nbsp;The&nbsp;global&nbsp;variable&nbsp;map&nbsp;is&nbsp;locked&nbsp;during&nbsp;the&nbsp;iteration,</span><br>
<span class="lineno"></span><span class="comment" id="5575255">//&nbsp;but&nbsp;existing&nbsp;entries&nbsp;may&nbsp;be&nbsp;concurrently&nbsp;updated.</span><br>
<span class="lineno">300</span><span class="keyword" id="5575308">func</span>&nbsp;<span class="ident" id="5575313">Do</span><span class="op" id="5575315">(</span><span class="ident" id="5575316">f</span>&nbsp;<span class="keyword" id="5575318">func</span><span class="op" id="5575322">(</span><span class="ident" id="5575323"><a href="/expvar/expvar.go.html#5571460">KeyValue</a></span><span class="op" id="5575331">)</span><span class="op" id="5575332">)</span>&nbsp;<span class="op" id="5575334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575337"><a href="/expvar/expvar.go.html#5574107">mutex</a></span><span class="op" id="5575342">.</span><span class="ident" id="5575343">RLock</span><span class="op" id="5575348">(</span><span class="op" id="5575349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5575352">defer</span>&nbsp;<span class="ident" id="5575358"><a href="/expvar/expvar.go.html#5574107">mutex</a></span><span class="op" id="5575363">.</span><span class="ident" id="5575364">RUnlock</span><span class="op" id="5575371">(</span><span class="op" id="5575372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5575375">for</span>&nbsp;<span class="ident" id="5575379">_</span><span class="op" id="5575380">,</span>&nbsp;<span class="ident" id="5575382">k</span>&nbsp;<span class="op" id="5575384">:=</span>&nbsp;<span class="keyword" id="5575387">range</span>&nbsp;<span class="ident" id="5575393"><a href="/expvar/expvar.go.html#5574161">varKeys</a></span>&nbsp;<span class="op" id="5575401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575405"><a href="/expvar/expvar.go.html#5575316">f</a></span><span class="op" id="5575406">(</span><span class="ident" id="5575407"><a href="/expvar/expvar.go.html#5571460">KeyValue</a></span><span class="op" id="5575415">{</span><span class="ident" id="5575416"><a href="/expvar/expvar.go.html#5575382">k</a></span><span class="op" id="5575417">,</span>&nbsp;<span class="ident" id="5575419"><a href="/expvar/expvar.go.html#5574129">vars</a></span><span class="op" id="5575423">[</span><span class="ident" id="5575424"><a href="/expvar/expvar.go.html#5575382">k</a></span><span class="op" id="5575425">]</span><span class="op" id="5575426">}</span><span class="op" id="5575427">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5575430">}</span><br>
<span class="lineno"></span><span class="op" id="5575432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5575435">func</span>&nbsp;<span class="ident" id="5575440">expvarHandler</span><span class="op" id="5575453">(</span><span class="ident" id="5575454">w</span>&nbsp;<span class="ident" id="5575456"><a href="/expvar/expvar.go.html#5570239">http</a></span><span class="op" id="5575460">.</span><span class="ident" id="5575461">ResponseWriter</span><span class="op" id="5575475">,</span>&nbsp;<span class="ident" id="5575477">r</span>&nbsp;<span class="op" id="5575479">*</span><span class="ident" id="5575480"><a href="/expvar/expvar.go.html#5570239">http</a></span><span class="op" id="5575484">.</span><span class="ident" id="5575485">Request</span><span class="op" id="5575492">)</span>&nbsp;<span class="op" id="5575494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575497"><a href="/expvar/expvar.go.html#5575454">w</a></span><span class="op" id="5575498">.</span><span class="ident" id="5575499">Header</span><span class="op" id="5575505">(</span><span class="op" id="5575506">)</span><span class="op" id="5575507">.</span><span class="ident" id="5575508">Set</span><span class="op" id="5575511">(</span><span class="string" id="5575512">&#34;Content-Type&#34;</span><span class="op" id="5575526">,</span>&nbsp;<span class="string" id="5575528">&#34;application/json;&nbsp;charset=utf-8&#34;</span><span class="op" id="5575561">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575564"><a href="/expvar/expvar.go.html#5570225">fmt</a></span><span class="op" id="5575567">.</span><span class="ident" id="5575568">Fprintf</span><span class="op" id="5575575">(</span><span class="ident" id="5575576"><a href="/expvar/expvar.go.html#5575454">w</a></span><span class="op" id="5575577">,</span>&nbsp;<span class="string" id="5575579">&#34;{\n&#34;</span><span class="op" id="5575584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575587">first</span>&nbsp;<span class="op" id="5575593">:=</span>&nbsp;<span class="ident" id="5575596">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575602"><a href="/expvar/expvar.go.html#5575313">Do</a></span><span class="op" id="5575604">(</span><span class="keyword" id="5575605">func</span><span class="op" id="5575609">(</span><span class="ident" id="5575610">kv</span>&nbsp;<span class="ident" id="5575613"><a href="/expvar/expvar.go.html#5571460">KeyValue</a></span><span class="op" id="5575621">)</span>&nbsp;<span class="op" id="5575623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5575627">if</span>&nbsp;<span class="op" id="5575630">!</span><span class="ident" id="5575631"><a href="/expvar/expvar.go.html#5575587">first</a></span>&nbsp;<span class="op" id="5575637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575642"><a href="/expvar/expvar.go.html#5570225">fmt</a></span><span class="op" id="5575645">.</span><span class="ident" id="5575646">Fprintf</span><span class="op" id="5575653">(</span><span class="ident" id="5575654"><a href="/expvar/expvar.go.html#5575454">w</a></span><span class="op" id="5575655">,</span>&nbsp;<span class="string" id="5575657">&#34;,\n&#34;</span><span class="op" id="5575662">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5575666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575670"><a href="/expvar/expvar.go.html#5575587">first</a></span>&nbsp;<span class="op" id="5575676">=</span>&nbsp;<span class="ident" id="5575678">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575686"><a href="/expvar/expvar.go.html#5570225">fmt</a></span><span class="op" id="5575689">.</span><span class="ident" id="5575690">Fprintf</span><span class="op" id="5575697">(</span><span class="ident" id="5575698"><a href="/expvar/expvar.go.html#5575454">w</a></span><span class="op" id="5575699">,</span>&nbsp;<span class="string" id="5575701">&#34;%q:&nbsp;%s&#34;</span><span class="op" id="5575709">,</span>&nbsp;<span class="ident" id="5575711"><a href="/expvar/expvar.go.html#5575610">kv</a></span><span class="op" id="5575713">.</span><span class="ident" id="5575714">Key</span><span class="op" id="5575717">,</span>&nbsp;<span class="ident" id="5575719"><a href="/expvar/expvar.go.html#5575610">kv</a></span><span class="op" id="5575721">.</span><span class="ident" id="5575722">Value</span><span class="op" id="5575727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5575730">}</span><span class="op" id="5575731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575734"><a href="/expvar/expvar.go.html#5570225">fmt</a></span><span class="op" id="5575737">.</span><span class="ident" id="5575738">Fprintf</span><span class="op" id="5575745">(</span><span class="ident" id="5575746"><a href="/expvar/expvar.go.html#5575454">w</a></span><span class="op" id="5575747">,</span>&nbsp;<span class="string" id="5575749">&#34;\n}\n&#34;</span><span class="op" id="5575756">)</span><br>
<span class="lineno">320</span><span class="op" id="5575758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5575761">func</span>&nbsp;<span class="ident" id="5575766">cmdline</span><span class="op" id="5575773">(</span><span class="op" id="5575774">)</span>&nbsp;<span class="keyword" id="5575776">interface</span><span class="op" id="5575785">{</span><span class="op" id="5575786">}</span>&nbsp;<span class="op" id="5575788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5575791">return</span>&nbsp;<span class="ident" id="5575798"><a href="/expvar/expvar.go.html#5570251">os</a></span><span class="op" id="5575800">.</span><span class="ident" id="5575801">Args</span><br>
<span class="lineno"></span><span class="op" id="5575806">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="5575809">func</span>&nbsp;<span class="ident" id="5575814">memstats</span><span class="op" id="5575822">(</span><span class="op" id="5575823">)</span>&nbsp;<span class="keyword" id="5575825">interface</span><span class="op" id="5575834">{</span><span class="op" id="5575835">}</span>&nbsp;<span class="op" id="5575837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575840">stats</span>&nbsp;<span class="op" id="5575846">:=</span>&nbsp;<span class="builtinfunc" id="5575849">new</span><span class="op" id="5575852">(</span><span class="ident" id="5575853"><a href="/expvar/expvar.go.html#5570257">runtime</a></span><span class="op" id="5575860">.</span><span class="ident" id="5575861">MemStats</span><span class="op" id="5575869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575872"><a href="/expvar/expvar.go.html#5570257">runtime</a></span><span class="op" id="5575879">.</span><span class="ident" id="5575880">ReadMemStats</span><span class="op" id="5575892">(</span><span class="ident" id="5575893"><a href="/expvar/expvar.go.html#5575840">stats</a></span><span class="op" id="5575898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5575901">return</span>&nbsp;<span class="op" id="5575908">*</span><span class="ident" id="5575909"><a href="/expvar/expvar.go.html#5575840">stats</a></span><br>
<span class="lineno">330</span><span class="op" id="5575915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5575918">func</span>&nbsp;<span class="ident" id="5575923">init</span><span class="op" id="5575927">(</span><span class="op" id="5575928">)</span>&nbsp;<span class="op" id="5575930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575933"><a href="/expvar/expvar.go.html#5570239">http</a></span><span class="op" id="5575937">.</span><span class="ident" id="5575938">HandleFunc</span><span class="op" id="5575948">(</span><span class="string" id="5575949">&#34;/debug/vars&#34;</span><span class="op" id="5575962">,</span>&nbsp;<span class="ident" id="5575964"><a href="/expvar/expvar.go.html#5575440">expvarHandler</a></span><span class="op" id="5575977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575980"><a href="/expvar/expvar.go.html#5574388">Publish</a></span><span class="op" id="5575987">(</span><span class="string" id="5575988">&#34;cmdline&#34;</span><span class="op" id="5575997">,</span>&nbsp;<span class="ident" id="5575999"><a href="/expvar/expvar.go.html#5573967">Func</a></span><span class="op" id="5576003">(</span><span class="ident" id="5576004"><a href="/expvar/expvar.go.html#5575766">cmdline</a></span><span class="op" id="5576011">)</span><span class="op" id="5576012">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5576015"><a href="/expvar/expvar.go.html#5574388">Publish</a></span><span class="op" id="5576022">(</span><span class="string" id="5576023">&#34;memstats&#34;</span><span class="op" id="5576033">,</span>&nbsp;<span class="ident" id="5576035"><a href="/expvar/expvar.go.html#5573967">Func</a></span><span class="op" id="5576039">(</span><span class="ident" id="5576040"><a href="/expvar/expvar.go.html#5575814">memstats</a></span><span class="op" id="5576048">)</span><span class="op" id="5576049">)</span><br>
<span class="lineno"></span><span class="op" id="5576051">}</span>
</div>
</body>
</html>
