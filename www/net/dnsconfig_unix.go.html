<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2543298">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2543353">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2543407">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2543458">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2543523">//&nbsp;Read&nbsp;system&nbsp;DNS&nbsp;config&nbsp;from&nbsp;/etc/resolv.conf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2543572">package</span>&nbsp;<span class="ident" id="2543580">net</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="2543585">type</span>&nbsp;<span class="ident" id="2543590">dnsConfig</span>&nbsp;<span class="keyword" id="2543600">struct</span>&nbsp;<span class="op" id="2543607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543610">servers</span>&nbsp;&nbsp;<span class="op" id="2543619">[</span><span class="op" id="2543620">]</span><span class="builtintype" id="2543621">string</span>&nbsp;<span class="comment" id="2543628">//&nbsp;servers&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543647">search</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2543656">[</span><span class="op" id="2543657">]</span><span class="builtintype" id="2543658">string</span>&nbsp;<span class="comment" id="2543665">//&nbsp;suffixes&nbsp;to&nbsp;append&nbsp;to&nbsp;local&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543702">ndots</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2543711">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2543720">//&nbsp;number&nbsp;of&nbsp;dots&nbsp;in&nbsp;name&nbsp;to&nbsp;trigger&nbsp;absolute&nbsp;lookup</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543774">timeout</span>&nbsp;&nbsp;<span class="builtintype" id="2543783">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2543792">//&nbsp;seconds&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;packet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543831">attempts</span>&nbsp;<span class="builtintype" id="2543840">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2543849">//&nbsp;lost&nbsp;packets&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543893">rotate</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2543902">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2543911">//&nbsp;round&nbsp;robin&nbsp;among&nbsp;servers</span><br>
<span class="lineno"></span><span class="op" id="2543940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2543943">//&nbsp;See&nbsp;resolv.conf(5)&nbsp;on&nbsp;a&nbsp;Linux&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="2543985">//&nbsp;TODO(rsc):&nbsp;Supposed&nbsp;to&nbsp;call&nbsp;uname()&nbsp;and&nbsp;chop&nbsp;the&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="2544047">//&nbsp;of&nbsp;the&nbsp;host&nbsp;name&nbsp;to&nbsp;get&nbsp;the&nbsp;default&nbsp;search&nbsp;domain.</span><br>
<span class="lineno"></span><span class="keyword" id="2544101">func</span>&nbsp;<span class="ident" id="2544106">dnsReadConfig</span><span class="op" id="2544119">(</span><span class="ident" id="2544120">filename</span>&nbsp;<span class="builtintype" id="2544129">string</span><span class="op" id="2544135">)</span>&nbsp;<span class="op" id="2544137">(</span><span class="op" id="2544138">*</span><span class="ident" id="2544139"><a href="/net/dnsconfig_unix.go.html#2543590">dnsConfig</a></span><span class="op" id="2544148">,</span>&nbsp;<span class="builtintype" id="2544150">error</span><span class="op" id="2544155">)</span>&nbsp;<span class="op" id="2544157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544160">file</span><span class="op" id="2544164">,</span>&nbsp;<span class="ident" id="2544166">err</span>&nbsp;<span class="op" id="2544170">:=</span>&nbsp;<span class="ident" id="2544173"><a href="/net/parse.go.html#2663938">open</a></span><span class="op" id="2544177">(</span><span class="ident" id="2544178"><a href="/net/dnsconfig_unix.go.html#2544120">filename</a></span><span class="op" id="2544186">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544189">if</span>&nbsp;<span class="ident" id="2544192"><a href="/net/dnsconfig_unix.go.html#2544166">err</a></span>&nbsp;<span class="op" id="2544196">!=</span>&nbsp;<span class="ident" id="2544199">nil</span>&nbsp;<span class="op" id="2544203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544207">return</span>&nbsp;<span class="ident" id="2544214">nil</span><span class="op" id="2544217">,</span>&nbsp;<span class="op" id="2544219">&amp;</span><span class="ident" id="2544220"><a href="/net/net.go.html#2661550">DNSConfigError</a></span><span class="op" id="2544234">{</span><span class="ident" id="2544235"><a href="/net/dnsconfig_unix.go.html#2544166">err</a></span><span class="op" id="2544238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2544241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544244">defer</span>&nbsp;<span class="ident" id="2544250"><a href="/net/dnsconfig_unix.go.html#2544160">file</a></span><span class="op" id="2544254">.</span><span class="builtinfunc" id="2544255">close</span><span class="op" id="2544260">(</span><span class="op" id="2544261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544264">conf</span>&nbsp;<span class="op" id="2544269">:=</span>&nbsp;<span class="op" id="2544272">&amp;</span><span class="ident" id="2544273"><a href="/net/dnsconfig_unix.go.html#2543590">dnsConfig</a></span><span class="op" id="2544282">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544286">ndots</span><span class="op" id="2544291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2544296">1</span><span class="op" id="2544297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544301">timeout</span><span class="op" id="2544308">:</span>&nbsp;&nbsp;<span class="num" id="2544311">5</span><span class="op" id="2544312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544316">attempts</span><span class="op" id="2544324">:</span>&nbsp;<span class="num" id="2544326">2</span><span class="op" id="2544327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2544330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544333">for</span>&nbsp;<span class="ident" id="2544337">line</span><span class="op" id="2544341">,</span>&nbsp;<span class="ident" id="2544343">ok</span>&nbsp;<span class="op" id="2544346">:=</span>&nbsp;<span class="ident" id="2544349"><a href="/net/dnsconfig_unix.go.html#2544160">file</a></span><span class="op" id="2544353">.</span><span class="ident" id="2544354">readLine</span><span class="op" id="2544362">(</span><span class="op" id="2544363">)</span><span class="op" id="2544364">;</span>&nbsp;<span class="ident" id="2544366"><a href="/net/dnsconfig_unix.go.html#2544343">ok</a></span><span class="op" id="2544368">;</span>&nbsp;<span class="ident" id="2544370"><a href="/net/dnsconfig_unix.go.html#2544337">line</a></span><span class="op" id="2544374">,</span>&nbsp;<span class="ident" id="2544376"><a href="/net/dnsconfig_unix.go.html#2544343">ok</a></span>&nbsp;<span class="op" id="2544379">=</span>&nbsp;<span class="ident" id="2544381"><a href="/net/dnsconfig_unix.go.html#2544160">file</a></span><span class="op" id="2544385">.</span><span class="ident" id="2544386">readLine</span><span class="op" id="2544394">(</span><span class="op" id="2544395">)</span>&nbsp;<span class="op" id="2544397">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544401">f</span>&nbsp;<span class="op" id="2544403">:=</span>&nbsp;<span class="ident" id="2544406"><a href="/net/parse.go.html#2664774">getFields</a></span><span class="op" id="2544415">(</span><span class="ident" id="2544416"><a href="/net/dnsconfig_unix.go.html#2544337">line</a></span><span class="op" id="2544420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544424">if</span>&nbsp;<span class="builtinfunc" id="2544427">len</span><span class="op" id="2544430">(</span><span class="ident" id="2544431"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2544432">)</span>&nbsp;<span class="op" id="2544434">&lt;</span>&nbsp;<span class="num" id="2544436">1</span>&nbsp;<span class="op" id="2544438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544443">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2544454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544458">switch</span>&nbsp;<span class="ident" id="2544465"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2544466">[</span><span class="num" id="2544467">0</span><span class="op" id="2544468">]</span>&nbsp;<span class="op" id="2544470">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544474">case</span>&nbsp;<span class="string" id="2544479">&#34;nameserver&#34;</span><span class="op" id="2544491">:</span>&nbsp;<span class="comment" id="2544493">//&nbsp;add&nbsp;one&nbsp;name&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544519">if</span>&nbsp;<span class="builtinfunc" id="2544522">len</span><span class="op" id="2544525">(</span><span class="ident" id="2544526"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2544527">)</span>&nbsp;<span class="op" id="2544529">&gt;</span>&nbsp;<span class="num" id="2544531">1</span>&nbsp;<span class="op" id="2544533">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2544536">len</span><span class="op" id="2544539">(</span><span class="ident" id="2544540"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2544544">.</span><span class="ident" id="2544545">servers</span><span class="op" id="2544552">)</span>&nbsp;<span class="op" id="2544554">&lt;</span>&nbsp;<span class="num" id="2544556">3</span>&nbsp;<span class="op" id="2544558">{</span>&nbsp;<span class="comment" id="2544560">//&nbsp;small,&nbsp;but&nbsp;the&nbsp;standard&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2544597">//&nbsp;One&nbsp;more&nbsp;check:&nbsp;make&nbsp;sure&nbsp;server&nbsp;name&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2544645">//&nbsp;just&nbsp;an&nbsp;IP&nbsp;address.&nbsp;&nbsp;Otherwise&nbsp;we&nbsp;need&nbsp;DNS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2544695">//&nbsp;to&nbsp;look&nbsp;it&nbsp;up.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544717">if</span>&nbsp;<span class="ident" id="2544720"><a href="/net/ip.go.html#2614866">parseIPv4</a></span><span class="op" id="2544729">(</span><span class="ident" id="2544730"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2544731">[</span><span class="num" id="2544732">1</span><span class="op" id="2544733">]</span><span class="op" id="2544734">)</span>&nbsp;<span class="op" id="2544736">!=</span>&nbsp;<span class="ident" id="2544739">nil</span>&nbsp;<span class="op" id="2544743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544750"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2544754">.</span><span class="ident" id="2544755">servers</span>&nbsp;<span class="op" id="2544763">=</span>&nbsp;<span class="builtinfunc" id="2544765">append</span><span class="op" id="2544771">(</span><span class="ident" id="2544772"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2544776">.</span><span class="ident" id="2544777">servers</span><span class="op" id="2544784">,</span>&nbsp;<span class="ident" id="2544786"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2544787">[</span><span class="num" id="2544788">1</span><span class="op" id="2544789">]</span><span class="op" id="2544790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2544796">}</span>&nbsp;<span class="keyword" id="2544798">else</span>&nbsp;<span class="keyword" id="2544803">if</span>&nbsp;<span class="ident" id="2544806">ip</span><span class="op" id="2544808">,</span>&nbsp;<span class="ident" id="2544810">_</span>&nbsp;<span class="op" id="2544812">:=</span>&nbsp;<span class="ident" id="2544815"><a href="/net/ip.go.html#2615492">parseIPv6</a></span><span class="op" id="2544824">(</span><span class="ident" id="2544825"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2544826">[</span><span class="num" id="2544827">1</span><span class="op" id="2544828">]</span><span class="op" id="2544829">,</span>&nbsp;<span class="ident" id="2544831">true</span><span class="op" id="2544835">)</span><span class="op" id="2544836">;</span>&nbsp;<span class="ident" id="2544838"><a href="/net/dnsconfig_unix.go.html#2544806">ip</a></span>&nbsp;<span class="op" id="2544841">!=</span>&nbsp;<span class="ident" id="2544844">nil</span>&nbsp;<span class="op" id="2544848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544855"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2544859">.</span><span class="ident" id="2544860">servers</span>&nbsp;<span class="op" id="2544868">=</span>&nbsp;<span class="builtinfunc" id="2544870">append</span><span class="op" id="2544876">(</span><span class="ident" id="2544877"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2544881">.</span><span class="ident" id="2544882">servers</span><span class="op" id="2544889">,</span>&nbsp;<span class="ident" id="2544891"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2544892">[</span><span class="num" id="2544893">1</span><span class="op" id="2544894">]</span><span class="op" id="2544895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2544901">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2544906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544911">case</span>&nbsp;<span class="string" id="2544916">&#34;domain&#34;</span><span class="op" id="2544924">:</span>&nbsp;<span class="comment" id="2544926">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;just&nbsp;this&nbsp;domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544968">if</span>&nbsp;<span class="builtinfunc" id="2544971">len</span><span class="op" id="2544974">(</span><span class="ident" id="2544975"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2544976">)</span>&nbsp;<span class="op" id="2544978">&gt;</span>&nbsp;<span class="num" id="2544980">1</span>&nbsp;<span class="op" id="2544982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544988"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2544992">.</span><span class="ident" id="2544993">search</span>&nbsp;<span class="op" id="2545000">=</span>&nbsp;<span class="op" id="2545002">[</span><span class="op" id="2545003">]</span><span class="builtintype" id="2545004">string</span><span class="op" id="2545010">{</span><span class="ident" id="2545011"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2545012">[</span><span class="num" id="2545013">1</span><span class="op" id="2545014">]</span><span class="op" id="2545015">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545025">case</span>&nbsp;<span class="string" id="2545030">&#34;search&#34;</span><span class="op" id="2545038">:</span>&nbsp;<span class="comment" id="2545040">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;given&nbsp;servers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545079"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2545083">.</span><span class="ident" id="2545084">search</span>&nbsp;<span class="op" id="2545091">=</span>&nbsp;<span class="builtinfunc" id="2545093">make</span><span class="op" id="2545097">(</span><span class="op" id="2545098">[</span><span class="op" id="2545099">]</span><span class="builtintype" id="2545100">string</span><span class="op" id="2545106">,</span>&nbsp;<span class="builtinfunc" id="2545108">len</span><span class="op" id="2545111">(</span><span class="ident" id="2545112"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2545113">)</span><span class="op" id="2545114">-</span><span class="num" id="2545115">1</span><span class="op" id="2545116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545121">for</span>&nbsp;<span class="ident" id="2545125">i</span>&nbsp;<span class="op" id="2545127">:=</span>&nbsp;<span class="num" id="2545130">0</span><span class="op" id="2545131">;</span>&nbsp;<span class="ident" id="2545133"><a href="/net/dnsconfig_unix.go.html#2545125">i</a></span>&nbsp;<span class="op" id="2545135">&lt;</span>&nbsp;<span class="builtinfunc" id="2545137">len</span><span class="op" id="2545140">(</span><span class="ident" id="2545141"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2545145">.</span><span class="ident" id="2545146">search</span><span class="op" id="2545152">)</span><span class="op" id="2545153">;</span>&nbsp;<span class="ident" id="2545155"><a href="/net/dnsconfig_unix.go.html#2545125">i</a></span><span class="op" id="2545156">++</span>&nbsp;<span class="op" id="2545159">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545165"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2545169">.</span><span class="ident" id="2545170">search</span><span class="op" id="2545176">[</span><span class="ident" id="2545177"><a href="/net/dnsconfig_unix.go.html#2545125">i</a></span><span class="op" id="2545178">]</span>&nbsp;<span class="op" id="2545180">=</span>&nbsp;<span class="ident" id="2545182"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2545183">[</span><span class="ident" id="2545184"><a href="/net/dnsconfig_unix.go.html#2545125">i</a></span><span class="op" id="2545185">+</span><span class="num" id="2545186">1</span><span class="op" id="2545187">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545197">case</span>&nbsp;<span class="string" id="2545202">&#34;options&#34;</span><span class="op" id="2545211">:</span>&nbsp;<span class="comment" id="2545213">//&nbsp;magic&nbsp;options</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545233">for</span>&nbsp;<span class="ident" id="2545237">i</span>&nbsp;<span class="op" id="2545239">:=</span>&nbsp;<span class="num" id="2545242">1</span><span class="op" id="2545243">;</span>&nbsp;<span class="ident" id="2545245"><a href="/net/dnsconfig_unix.go.html#2545237">i</a></span>&nbsp;<span class="op" id="2545247">&lt;</span>&nbsp;<span class="builtinfunc" id="2545249">len</span><span class="op" id="2545252">(</span><span class="ident" id="2545253"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2545254">)</span><span class="op" id="2545255">;</span>&nbsp;<span class="ident" id="2545257"><a href="/net/dnsconfig_unix.go.html#2545237">i</a></span><span class="op" id="2545258">++</span>&nbsp;<span class="op" id="2545261">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545267">s</span>&nbsp;<span class="op" id="2545269">:=</span>&nbsp;<span class="ident" id="2545272"><a href="/net/dnsconfig_unix.go.html#2544401">f</a></span><span class="op" id="2545273">[</span><span class="ident" id="2545274"><a href="/net/dnsconfig_unix.go.html#2545237">i</a></span><span class="op" id="2545275">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545281">switch</span>&nbsp;<span class="op" id="2545288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545294">case</span>&nbsp;<span class="ident" id="2545299"><a href="/net/dnsconfig_unix.go.html#2545737">hasPrefix</a></span><span class="op" id="2545308">(</span><span class="ident" id="2545309"><a href="/net/dnsconfig_unix.go.html#2545267">s</a></span><span class="op" id="2545310">,</span>&nbsp;<span class="string" id="2545312">&#34;ndots:&#34;</span><span class="op" id="2545320">)</span><span class="op" id="2545321">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545328">n</span><span class="op" id="2545329">,</span>&nbsp;<span class="ident" id="2545331">_</span><span class="op" id="2545332">,</span>&nbsp;<span class="ident" id="2545334">_</span>&nbsp;<span class="op" id="2545336">:=</span>&nbsp;<span class="ident" id="2545339"><a href="/net/parse.go.html#2665011">dtoi</a></span><span class="op" id="2545343">(</span><span class="ident" id="2545344"><a href="/net/dnsconfig_unix.go.html#2545267">s</a></span><span class="op" id="2545345">,</span>&nbsp;<span class="num" id="2545347">6</span><span class="op" id="2545348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545355">if</span>&nbsp;<span class="ident" id="2545358"><a href="/net/dnsconfig_unix.go.html#2545328">n</a></span>&nbsp;<span class="op" id="2545360">&lt;</span>&nbsp;<span class="num" id="2545362">1</span>&nbsp;<span class="op" id="2545364">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545372"><a href="/net/dnsconfig_unix.go.html#2545328">n</a></span>&nbsp;<span class="op" id="2545374">=</span>&nbsp;<span class="num" id="2545376">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545390"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2545394">.</span><span class="ident" id="2545395">ndots</span>&nbsp;<span class="op" id="2545401">=</span>&nbsp;<span class="ident" id="2545403"><a href="/net/dnsconfig_unix.go.html#2545328">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545409">case</span>&nbsp;<span class="ident" id="2545414"><a href="/net/dnsconfig_unix.go.html#2545737">hasPrefix</a></span><span class="op" id="2545423">(</span><span class="ident" id="2545424"><a href="/net/dnsconfig_unix.go.html#2545267">s</a></span><span class="op" id="2545425">,</span>&nbsp;<span class="string" id="2545427">&#34;timeout:&#34;</span><span class="op" id="2545437">)</span><span class="op" id="2545438">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545445">n</span><span class="op" id="2545446">,</span>&nbsp;<span class="ident" id="2545448">_</span><span class="op" id="2545449">,</span>&nbsp;<span class="ident" id="2545451">_</span>&nbsp;<span class="op" id="2545453">:=</span>&nbsp;<span class="ident" id="2545456"><a href="/net/parse.go.html#2665011">dtoi</a></span><span class="op" id="2545460">(</span><span class="ident" id="2545461"><a href="/net/dnsconfig_unix.go.html#2545267">s</a></span><span class="op" id="2545462">,</span>&nbsp;<span class="num" id="2545464">8</span><span class="op" id="2545465">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545472">if</span>&nbsp;<span class="ident" id="2545475"><a href="/net/dnsconfig_unix.go.html#2545445">n</a></span>&nbsp;<span class="op" id="2545477">&lt;</span>&nbsp;<span class="num" id="2545479">1</span>&nbsp;<span class="op" id="2545481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545489"><a href="/net/dnsconfig_unix.go.html#2545445">n</a></span>&nbsp;<span class="op" id="2545491">=</span>&nbsp;<span class="num" id="2545493">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545507"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2545511">.</span><span class="ident" id="2545512">timeout</span>&nbsp;<span class="op" id="2545520">=</span>&nbsp;<span class="ident" id="2545522"><a href="/net/dnsconfig_unix.go.html#2545445">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545528">case</span>&nbsp;<span class="ident" id="2545533"><a href="/net/dnsconfig_unix.go.html#2545737">hasPrefix</a></span><span class="op" id="2545542">(</span><span class="ident" id="2545543"><a href="/net/dnsconfig_unix.go.html#2545267">s</a></span><span class="op" id="2545544">,</span>&nbsp;<span class="string" id="2545546">&#34;attempts:&#34;</span><span class="op" id="2545557">)</span><span class="op" id="2545558">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545565">n</span><span class="op" id="2545566">,</span>&nbsp;<span class="ident" id="2545568">_</span><span class="op" id="2545569">,</span>&nbsp;<span class="ident" id="2545571">_</span>&nbsp;<span class="op" id="2545573">:=</span>&nbsp;<span class="ident" id="2545576"><a href="/net/parse.go.html#2665011">dtoi</a></span><span class="op" id="2545580">(</span><span class="ident" id="2545581"><a href="/net/dnsconfig_unix.go.html#2545267">s</a></span><span class="op" id="2545582">,</span>&nbsp;<span class="num" id="2545584">9</span><span class="op" id="2545585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545592">if</span>&nbsp;<span class="ident" id="2545595"><a href="/net/dnsconfig_unix.go.html#2545565">n</a></span>&nbsp;<span class="op" id="2545597">&lt;</span>&nbsp;<span class="num" id="2545599">1</span>&nbsp;<span class="op" id="2545601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545609"><a href="/net/dnsconfig_unix.go.html#2545565">n</a></span>&nbsp;<span class="op" id="2545611">=</span>&nbsp;<span class="num" id="2545613">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545627"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2545631">.</span><span class="ident" id="2545632">attempts</span>&nbsp;<span class="op" id="2545641">=</span>&nbsp;<span class="ident" id="2545643"><a href="/net/dnsconfig_unix.go.html#2545565">n</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545649">case</span>&nbsp;<span class="ident" id="2545654"><a href="/net/dnsconfig_unix.go.html#2545267">s</a></span>&nbsp;<span class="op" id="2545656">==</span>&nbsp;<span class="string" id="2545659">&#34;rotate&#34;</span><span class="op" id="2545667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545674"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2545678">.</span><span class="ident" id="2545679">rotate</span>&nbsp;<span class="op" id="2545686">=</span>&nbsp;<span class="ident" id="2545688">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545706">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545712">return</span>&nbsp;<span class="ident" id="2545719"><a href="/net/dnsconfig_unix.go.html#2544264">conf</a></span><span class="op" id="2545723">,</span>&nbsp;<span class="ident" id="2545725">nil</span><br>
<span class="lineno"></span><span class="op" id="2545729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2545732">func</span>&nbsp;<span class="ident" id="2545737">hasPrefix</span><span class="op" id="2545746">(</span><span class="ident" id="2545747">s</span><span class="op" id="2545748">,</span>&nbsp;<span class="ident" id="2545750">prefix</span>&nbsp;<span class="builtintype" id="2545757">string</span><span class="op" id="2545763">)</span>&nbsp;<span class="builtintype" id="2545765">bool</span>&nbsp;<span class="op" id="2545770">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545773">return</span>&nbsp;<span class="builtinfunc" id="2545780">len</span><span class="op" id="2545783">(</span><span class="ident" id="2545784"><a href="/net/dnsconfig_unix.go.html#2545747">s</a></span><span class="op" id="2545785">)</span>&nbsp;<span class="op" id="2545787">&gt;=</span>&nbsp;<span class="builtinfunc" id="2545790">len</span><span class="op" id="2545793">(</span><span class="ident" id="2545794"><a href="/net/dnsconfig_unix.go.html#2545750">prefix</a></span><span class="op" id="2545800">)</span>&nbsp;<span class="op" id="2545802">&amp;&amp;</span>&nbsp;<span class="ident" id="2545805"><a href="/net/dnsconfig_unix.go.html#2545747">s</a></span><span class="op" id="2545806">[</span><span class="op" id="2545807">:</span><span class="builtinfunc" id="2545808">len</span><span class="op" id="2545811">(</span><span class="ident" id="2545812"><a href="/net/dnsconfig_unix.go.html#2545750">prefix</a></span><span class="op" id="2545818">)</span><span class="op" id="2545819">]</span>&nbsp;<span class="op" id="2545821">==</span>&nbsp;<span class="ident" id="2545824"><a href="/net/dnsconfig_unix.go.html#2545750">prefix</a></span><br>
<span class="lineno"></span><span class="op" id="2545831">}</span>
</div>
</body>
</html>
