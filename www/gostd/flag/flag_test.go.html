<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="184654">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="184709">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="184763">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="184814">package</span>&nbsp;<span class="ident" id="184822">flag_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="184833">import</span>&nbsp;<span class="op" id="184840">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="184843">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="184852">.</span>&nbsp;<span class="string" id="184854">&#34;flag&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="184862">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="184869">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="184875">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="184883">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="184894">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="184905">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="184912">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="184915">func</span>&nbsp;<span class="ident" id="184920">boolString</span><span class="op" id="184930">(</span><span class="ident" id="184931">s</span>&nbsp;<span class="builtintype" id="184933">string</span><span class="op" id="184939">)</span>&nbsp;<span class="builtintype" id="184941">string</span>&nbsp;<span class="op" id="184948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="184951">if</span>&nbsp;<span class="ident" id="184954">s</span>&nbsp;<span class="op" id="184956">==</span>&nbsp;<span class="string" id="184959">&#34;0&#34;</span>&nbsp;<span class="op" id="184963">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="184967">return</span>&nbsp;<span class="string" id="184974">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="184983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="184986">return</span>&nbsp;<span class="string" id="184993">&#34;true&#34;</span><br>
<span class="lineno"></span><span class="op" id="185000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="185003">func</span>&nbsp;<span class="ident" id="185008">TestEverything</span><span class="op" id="185022">(</span><span class="ident" id="185023">t</span>&nbsp;<span class="op" id="185025">*</span><span class="ident" id="185026">testing</span><span class="op" id="185033">.</span><span class="ident" id="185034">T</span><span class="op" id="185035">)</span>&nbsp;<span class="op" id="185037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185040">ResetForTesting</span><span class="op" id="185055">(</span><span class="ident" id="185056">nil</span><span class="op" id="185059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185062">Bool</span><span class="op" id="185066">(</span><span class="string" id="185067">&#34;test_bool&#34;</span><span class="op" id="185078">,</span>&nbsp;<span class="builtintype" id="185080">false</span><span class="op" id="185085">,</span>&nbsp;<span class="string" id="185087">&#34;bool&nbsp;value&#34;</span><span class="op" id="185099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185102">Int</span><span class="op" id="185105">(</span><span class="string" id="185106">&#34;test_int&#34;</span><span class="op" id="185116">,</span>&nbsp;<span class="num" id="185118">0</span><span class="op" id="185119">,</span>&nbsp;<span class="string" id="185121">&#34;int&nbsp;value&#34;</span><span class="op" id="185132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185135">Int64</span><span class="op" id="185140">(</span><span class="string" id="185141">&#34;test_int64&#34;</span><span class="op" id="185153">,</span>&nbsp;<span class="num" id="185155">0</span><span class="op" id="185156">,</span>&nbsp;<span class="string" id="185158">&#34;int64&nbsp;value&#34;</span><span class="op" id="185171">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185174">Uint</span><span class="op" id="185178">(</span><span class="string" id="185179">&#34;test_uint&#34;</span><span class="op" id="185190">,</span>&nbsp;<span class="num" id="185192">0</span><span class="op" id="185193">,</span>&nbsp;<span class="string" id="185195">&#34;uint&nbsp;value&#34;</span><span class="op" id="185207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185210">Uint64</span><span class="op" id="185216">(</span><span class="string" id="185217">&#34;test_uint64&#34;</span><span class="op" id="185230">,</span>&nbsp;<span class="num" id="185232">0</span><span class="op" id="185233">,</span>&nbsp;<span class="string" id="185235">&#34;uint64&nbsp;value&#34;</span><span class="op" id="185249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185252">String</span><span class="op" id="185258">(</span><span class="string" id="185259">&#34;test_string&#34;</span><span class="op" id="185272">,</span>&nbsp;<span class="string" id="185274">&#34;0&#34;</span><span class="op" id="185277">,</span>&nbsp;<span class="string" id="185279">&#34;string&nbsp;value&#34;</span><span class="op" id="185293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185296">Float64</span><span class="op" id="185303">(</span><span class="string" id="185304">&#34;test_float64&#34;</span><span class="op" id="185318">,</span>&nbsp;<span class="num" id="185320">0</span><span class="op" id="185321">,</span>&nbsp;<span class="string" id="185323">&#34;float64&nbsp;value&#34;</span><span class="op" id="185338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185341">Duration</span><span class="op" id="185349">(</span><span class="string" id="185350">&#34;test_duration&#34;</span><span class="op" id="185365">,</span>&nbsp;<span class="num" id="185367">0</span><span class="op" id="185368">,</span>&nbsp;<span class="string" id="185370">&#34;time.Duration&nbsp;value&#34;</span><span class="op" id="185391">)</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185395">m</span>&nbsp;<span class="op" id="185397">:=</span>&nbsp;<span class="builtinfunc" id="185400">make</span><span class="op" id="185404">(</span><span class="keyword" id="185405">map</span><span class="op" id="185408">[</span><span class="builtintype" id="185409">string</span><span class="op" id="185415">]</span><span class="op" id="185416">*</span><span class="ident" id="185417">Flag</span><span class="op" id="185421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185424">desired</span>&nbsp;<span class="op" id="185432">:=</span>&nbsp;<span class="string" id="185435">&#34;0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185440">visitor</span>&nbsp;<span class="op" id="185448">:=</span>&nbsp;<span class="keyword" id="185451">func</span><span class="op" id="185455">(</span><span class="ident" id="185456">f</span>&nbsp;<span class="op" id="185458">*</span><span class="ident" id="185459">Flag</span><span class="op" id="185463">)</span>&nbsp;<span class="op" id="185465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="185469">if</span>&nbsp;<span class="builtinfunc" id="185472">len</span><span class="op" id="185475">(</span><span class="ident" id="185476">f</span><span class="op" id="185477">.</span><span class="ident" id="185478">Name</span><span class="op" id="185482">)</span>&nbsp;<span class="op" id="185484">&gt;</span>&nbsp;<span class="num" id="185486">5</span>&nbsp;<span class="op" id="185488">&amp;&amp;</span>&nbsp;<span class="ident" id="185491">f</span><span class="op" id="185492">.</span><span class="ident" id="185493">Name</span><span class="op" id="185497">[</span><span class="num" id="185498">0</span><span class="op" id="185499">:</span><span class="num" id="185500">5</span><span class="op" id="185501">]</span>&nbsp;<span class="op" id="185503">==</span>&nbsp;<span class="string" id="185506">&#34;test_&#34;</span>&nbsp;<span class="op" id="185514">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185519">m</span><span class="op" id="185520">[</span><span class="ident" id="185521">f</span><span class="op" id="185522">.</span><span class="ident" id="185523">Name</span><span class="op" id="185527">]</span>&nbsp;<span class="op" id="185529">=</span>&nbsp;<span class="ident" id="185531">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185536">ok</span>&nbsp;<span class="op" id="185539">:=</span>&nbsp;<span class="builtintype" id="185542">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="185551">switch</span>&nbsp;<span class="op" id="185558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="185563">case</span>&nbsp;<span class="ident" id="185568">f</span><span class="op" id="185569">.</span><span class="ident" id="185570">Value</span><span class="op" id="185575">.</span><span class="ident" id="185576">String</span><span class="op" id="185582">(</span><span class="op" id="185583">)</span>&nbsp;<span class="op" id="185585">==</span>&nbsp;<span class="ident" id="185588">desired</span><span class="op" id="185595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185601">ok</span>&nbsp;<span class="op" id="185604">=</span>&nbsp;<span class="builtintype" id="185606">true</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="185614">case</span>&nbsp;<span class="ident" id="185619">f</span><span class="op" id="185620">.</span><span class="ident" id="185621">Name</span>&nbsp;<span class="op" id="185626">==</span>&nbsp;<span class="string" id="185629">&#34;test_bool&#34;</span>&nbsp;<span class="op" id="185641">&amp;&amp;</span>&nbsp;<span class="ident" id="185644">f</span><span class="op" id="185645">.</span><span class="ident" id="185646">Value</span><span class="op" id="185651">.</span><span class="ident" id="185652">String</span><span class="op" id="185658">(</span><span class="op" id="185659">)</span>&nbsp;<span class="op" id="185661">==</span>&nbsp;<span class="ident" id="185664">boolString</span><span class="op" id="185674">(</span><span class="ident" id="185675">desired</span><span class="op" id="185682">)</span><span class="op" id="185683">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185689">ok</span>&nbsp;<span class="op" id="185692">=</span>&nbsp;<span class="builtintype" id="185694">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="185702">case</span>&nbsp;<span class="ident" id="185707">f</span><span class="op" id="185708">.</span><span class="ident" id="185709">Name</span>&nbsp;<span class="op" id="185714">==</span>&nbsp;<span class="string" id="185717">&#34;test_duration&#34;</span>&nbsp;<span class="op" id="185733">&amp;&amp;</span>&nbsp;<span class="ident" id="185736">f</span><span class="op" id="185737">.</span><span class="ident" id="185738">Value</span><span class="op" id="185743">.</span><span class="ident" id="185744">String</span><span class="op" id="185750">(</span><span class="op" id="185751">)</span>&nbsp;<span class="op" id="185753">==</span>&nbsp;<span class="ident" id="185756">desired</span><span class="op" id="185763">+</span><span class="string" id="185764">&#34;s&#34;</span><span class="op" id="185767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185773">ok</span>&nbsp;<span class="op" id="185776">=</span>&nbsp;<span class="builtintype" id="185778">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="185786">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="185791">if</span>&nbsp;<span class="op" id="185794">!</span><span class="ident" id="185795">ok</span>&nbsp;<span class="op" id="185798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185804">t</span><span class="op" id="185805">.</span><span class="ident" id="185806">Error</span><span class="op" id="185811">(</span><span class="string" id="185812">&#34;Visit:&nbsp;bad&nbsp;value&#34;</span><span class="op" id="185830">,</span>&nbsp;<span class="ident" id="185832">f</span><span class="op" id="185833">.</span><span class="ident" id="185834">Value</span><span class="op" id="185839">.</span><span class="ident" id="185840">String</span><span class="op" id="185846">(</span><span class="op" id="185847">)</span><span class="op" id="185848">,</span>&nbsp;<span class="string" id="185850">&#34;for&#34;</span><span class="op" id="185855">,</span>&nbsp;<span class="ident" id="185857">f</span><span class="op" id="185858">.</span><span class="ident" id="185859">Name</span><span class="op" id="185863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="185868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="185872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="185875">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185878">VisitAll</span><span class="op" id="185886">(</span><span class="ident" id="185887">visitor</span><span class="op" id="185894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="185897">if</span>&nbsp;<span class="builtinfunc" id="185900">len</span><span class="op" id="185903">(</span><span class="ident" id="185904">m</span><span class="op" id="185905">)</span>&nbsp;<span class="op" id="185907">!=</span>&nbsp;<span class="num" id="185910">8</span>&nbsp;<span class="op" id="185912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185916">t</span><span class="op" id="185917">.</span><span class="ident" id="185918">Error</span><span class="op" id="185923">(</span><span class="string" id="185924">&#34;VisitAll&nbsp;misses&nbsp;some&nbsp;flags&#34;</span><span class="op" id="185952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="185956">for</span>&nbsp;<span class="ident" id="185960">k</span><span class="op" id="185961">,</span>&nbsp;<span class="ident" id="185963">v</span>&nbsp;<span class="op" id="185965">:=</span>&nbsp;<span class="keyword" id="185968">range</span>&nbsp;<span class="ident" id="185974">m</span>&nbsp;<span class="op" id="185976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="185981">t</span><span class="op" id="185982">.</span><span class="ident" id="185983">Log</span><span class="op" id="185986">(</span><span class="ident" id="185987">k</span><span class="op" id="185988">,</span>&nbsp;<span class="op" id="185990">*</span><span class="ident" id="185991">v</span><span class="op" id="185992">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="185996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="185999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186002">m</span>&nbsp;<span class="op" id="186004">=</span>&nbsp;<span class="builtinfunc" id="186006">make</span><span class="op" id="186010">(</span><span class="keyword" id="186011">map</span><span class="op" id="186014">[</span><span class="builtintype" id="186015">string</span><span class="op" id="186021">]</span><span class="op" id="186022">*</span><span class="ident" id="186023">Flag</span><span class="op" id="186027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186030">Visit</span><span class="op" id="186035">(</span><span class="ident" id="186036">visitor</span><span class="op" id="186043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="186046">if</span>&nbsp;<span class="builtinfunc" id="186049">len</span><span class="op" id="186052">(</span><span class="ident" id="186053">m</span><span class="op" id="186054">)</span>&nbsp;<span class="op" id="186056">!=</span>&nbsp;<span class="num" id="186059">0</span>&nbsp;<span class="op" id="186061">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186065">t</span><span class="op" id="186066">.</span><span class="ident" id="186067">Errorf</span><span class="op" id="186073">(</span><span class="string" id="186074">&#34;Visit&nbsp;sees&nbsp;unset&nbsp;flags&#34;</span><span class="op" id="186098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="186102">for</span>&nbsp;<span class="ident" id="186106">k</span><span class="op" id="186107">,</span>&nbsp;<span class="ident" id="186109">v</span>&nbsp;<span class="op" id="186111">:=</span>&nbsp;<span class="keyword" id="186114">range</span>&nbsp;<span class="ident" id="186120">m</span>&nbsp;<span class="op" id="186122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186127">t</span><span class="op" id="186128">.</span><span class="ident" id="186129">Log</span><span class="op" id="186132">(</span><span class="ident" id="186133">k</span><span class="op" id="186134">,</span>&nbsp;<span class="op" id="186136">*</span><span class="ident" id="186137">v</span><span class="op" id="186138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="186142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="186145">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="186148">//&nbsp;Now&nbsp;set&nbsp;all&nbsp;flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186170">Set</span><span class="op" id="186173">(</span><span class="string" id="186174">&#34;test_bool&#34;</span><span class="op" id="186185">,</span>&nbsp;<span class="string" id="186187">&#34;true&#34;</span><span class="op" id="186193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186196">Set</span><span class="op" id="186199">(</span><span class="string" id="186200">&#34;test_int&#34;</span><span class="op" id="186210">,</span>&nbsp;<span class="string" id="186212">&#34;1&#34;</span><span class="op" id="186215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186218">Set</span><span class="op" id="186221">(</span><span class="string" id="186222">&#34;test_int64&#34;</span><span class="op" id="186234">,</span>&nbsp;<span class="string" id="186236">&#34;1&#34;</span><span class="op" id="186239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186242">Set</span><span class="op" id="186245">(</span><span class="string" id="186246">&#34;test_uint&#34;</span><span class="op" id="186257">,</span>&nbsp;<span class="string" id="186259">&#34;1&#34;</span><span class="op" id="186262">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186265">Set</span><span class="op" id="186268">(</span><span class="string" id="186269">&#34;test_uint64&#34;</span><span class="op" id="186282">,</span>&nbsp;<span class="string" id="186284">&#34;1&#34;</span><span class="op" id="186287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186290">Set</span><span class="op" id="186293">(</span><span class="string" id="186294">&#34;test_string&#34;</span><span class="op" id="186307">,</span>&nbsp;<span class="string" id="186309">&#34;1&#34;</span><span class="op" id="186312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186315">Set</span><span class="op" id="186318">(</span><span class="string" id="186319">&#34;test_float64&#34;</span><span class="op" id="186333">,</span>&nbsp;<span class="string" id="186335">&#34;1&#34;</span><span class="op" id="186338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186341">Set</span><span class="op" id="186344">(</span><span class="string" id="186345">&#34;test_duration&#34;</span><span class="op" id="186360">,</span>&nbsp;<span class="string" id="186362">&#34;1s&#34;</span><span class="op" id="186366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186369">desired</span>&nbsp;<span class="op" id="186377">=</span>&nbsp;<span class="string" id="186379">&#34;1&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186384">Visit</span><span class="op" id="186389">(</span><span class="ident" id="186390">visitor</span><span class="op" id="186397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="186400">if</span>&nbsp;<span class="builtinfunc" id="186403">len</span><span class="op" id="186406">(</span><span class="ident" id="186407">m</span><span class="op" id="186408">)</span>&nbsp;<span class="op" id="186410">!=</span>&nbsp;<span class="num" id="186413">8</span>&nbsp;<span class="op" id="186415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186419">t</span><span class="op" id="186420">.</span><span class="ident" id="186421">Error</span><span class="op" id="186426">(</span><span class="string" id="186427">&#34;Visit&nbsp;fails&nbsp;after&nbsp;set&#34;</span><span class="op" id="186450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="186454">for</span>&nbsp;<span class="ident" id="186458">k</span><span class="op" id="186459">,</span>&nbsp;<span class="ident" id="186461">v</span>&nbsp;<span class="op" id="186463">:=</span>&nbsp;<span class="keyword" id="186466">range</span>&nbsp;<span class="ident" id="186472">m</span>&nbsp;<span class="op" id="186474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186479">t</span><span class="op" id="186480">.</span><span class="ident" id="186481">Log</span><span class="op" id="186484">(</span><span class="ident" id="186485">k</span><span class="op" id="186486">,</span>&nbsp;<span class="op" id="186488">*</span><span class="ident" id="186489">v</span><span class="op" id="186490">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="186494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="186497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="186500">//&nbsp;Now&nbsp;test&nbsp;they&#39;re&nbsp;visited&nbsp;in&nbsp;sort&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="186544">var</span>&nbsp;<span class="ident" id="186548">flagNames</span>&nbsp;<span class="op" id="186558">[</span><span class="op" id="186559">]</span><span class="builtintype" id="186560">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186568">Visit</span><span class="op" id="186573">(</span><span class="keyword" id="186574">func</span><span class="op" id="186578">(</span><span class="ident" id="186579">f</span>&nbsp;<span class="op" id="186581">*</span><span class="ident" id="186582">Flag</span><span class="op" id="186586">)</span>&nbsp;<span class="op" id="186588">{</span>&nbsp;<span class="ident" id="186590">flagNames</span>&nbsp;<span class="op" id="186600">=</span>&nbsp;<span class="builtinfunc" id="186602">append</span><span class="op" id="186608">(</span><span class="ident" id="186609">flagNames</span><span class="op" id="186618">,</span>&nbsp;<span class="ident" id="186620">f</span><span class="op" id="186621">.</span><span class="ident" id="186622">Name</span><span class="op" id="186626">)</span>&nbsp;<span class="op" id="186628">}</span><span class="op" id="186629">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="186632">if</span>&nbsp;<span class="op" id="186635">!</span><span class="ident" id="186636">sort</span><span class="op" id="186640">.</span><span class="ident" id="186641">StringsAreSorted</span><span class="op" id="186657">(</span><span class="ident" id="186658">flagNames</span><span class="op" id="186667">)</span>&nbsp;<span class="op" id="186669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186673">t</span><span class="op" id="186674">.</span><span class="ident" id="186675">Errorf</span><span class="op" id="186681">(</span><span class="string" id="186682">&#34;flag&nbsp;names&nbsp;not&nbsp;sorted:&nbsp;%v&#34;</span><span class="op" id="186709">,</span>&nbsp;<span class="ident" id="186711">flagNames</span><span class="op" id="186720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="186723">}</span><br>
<span class="lineno"></span><span class="op" id="186725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="186728">func</span>&nbsp;<span class="ident" id="186733">TestGet</span><span class="op" id="186740">(</span><span class="ident" id="186741">t</span>&nbsp;<span class="op" id="186743">*</span><span class="ident" id="186744">testing</span><span class="op" id="186751">.</span><span class="ident" id="186752">T</span><span class="op" id="186753">)</span>&nbsp;<span class="op" id="186755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186758">ResetForTesting</span><span class="op" id="186773">(</span><span class="ident" id="186774">nil</span><span class="op" id="186777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186780">Bool</span><span class="op" id="186784">(</span><span class="string" id="186785">&#34;test_bool&#34;</span><span class="op" id="186796">,</span>&nbsp;<span class="builtintype" id="186798">true</span><span class="op" id="186802">,</span>&nbsp;<span class="string" id="186804">&#34;bool&nbsp;value&#34;</span><span class="op" id="186816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186819">Int</span><span class="op" id="186822">(</span><span class="string" id="186823">&#34;test_int&#34;</span><span class="op" id="186833">,</span>&nbsp;<span class="num" id="186835">1</span><span class="op" id="186836">,</span>&nbsp;<span class="string" id="186838">&#34;int&nbsp;value&#34;</span><span class="op" id="186849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186852">Int64</span><span class="op" id="186857">(</span><span class="string" id="186858">&#34;test_int64&#34;</span><span class="op" id="186870">,</span>&nbsp;<span class="num" id="186872">2</span><span class="op" id="186873">,</span>&nbsp;<span class="string" id="186875">&#34;int64&nbsp;value&#34;</span><span class="op" id="186888">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186891">Uint</span><span class="op" id="186895">(</span><span class="string" id="186896">&#34;test_uint&#34;</span><span class="op" id="186907">,</span>&nbsp;<span class="num" id="186909">3</span><span class="op" id="186910">,</span>&nbsp;<span class="string" id="186912">&#34;uint&nbsp;value&#34;</span><span class="op" id="186924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186927">Uint64</span><span class="op" id="186933">(</span><span class="string" id="186934">&#34;test_uint64&#34;</span><span class="op" id="186947">,</span>&nbsp;<span class="num" id="186949">4</span><span class="op" id="186950">,</span>&nbsp;<span class="string" id="186952">&#34;uint64&nbsp;value&#34;</span><span class="op" id="186966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="186969">String</span><span class="op" id="186975">(</span><span class="string" id="186976">&#34;test_string&#34;</span><span class="op" id="186989">,</span>&nbsp;<span class="string" id="186991">&#34;5&#34;</span><span class="op" id="186994">,</span>&nbsp;<span class="string" id="186996">&#34;string&nbsp;value&#34;</span><span class="op" id="187010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187013">Float64</span><span class="op" id="187020">(</span><span class="string" id="187021">&#34;test_float64&#34;</span><span class="op" id="187035">,</span>&nbsp;<span class="num" id="187037">6</span><span class="op" id="187038">,</span>&nbsp;<span class="string" id="187040">&#34;float64&nbsp;value&#34;</span><span class="op" id="187055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187058">Duration</span><span class="op" id="187066">(</span><span class="string" id="187067">&#34;test_duration&#34;</span><span class="op" id="187082">,</span>&nbsp;<span class="num" id="187084">7</span><span class="op" id="187085">,</span>&nbsp;<span class="string" id="187087">&#34;time.Duration&nbsp;value&#34;</span><span class="op" id="187108">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187112">visitor</span>&nbsp;<span class="op" id="187120">:=</span>&nbsp;<span class="keyword" id="187123">func</span><span class="op" id="187127">(</span><span class="ident" id="187128">f</span>&nbsp;<span class="op" id="187130">*</span><span class="ident" id="187131">Flag</span><span class="op" id="187135">)</span>&nbsp;<span class="op" id="187137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187141">if</span>&nbsp;<span class="builtinfunc" id="187144">len</span><span class="op" id="187147">(</span><span class="ident" id="187148">f</span><span class="op" id="187149">.</span><span class="ident" id="187150">Name</span><span class="op" id="187154">)</span>&nbsp;<span class="op" id="187156">&gt;</span>&nbsp;<span class="num" id="187158">5</span>&nbsp;<span class="op" id="187160">&amp;&amp;</span>&nbsp;<span class="ident" id="187163">f</span><span class="op" id="187164">.</span><span class="ident" id="187165">Name</span><span class="op" id="187169">[</span><span class="num" id="187170">0</span><span class="op" id="187171">:</span><span class="num" id="187172">5</span><span class="op" id="187173">]</span>&nbsp;<span class="op" id="187175">==</span>&nbsp;<span class="string" id="187178">&#34;test_&#34;</span>&nbsp;<span class="op" id="187186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187191">g</span><span class="op" id="187192">,</span>&nbsp;<span class="ident" id="187194">ok</span>&nbsp;<span class="op" id="187197">:=</span>&nbsp;<span class="ident" id="187200">f</span><span class="op" id="187201">.</span><span class="ident" id="187202">Value</span><span class="op" id="187207">.</span><span class="op" id="187208">(</span><span class="ident" id="187209">Getter</span><span class="op" id="187215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187220">if</span>&nbsp;<span class="op" id="187223">!</span><span class="ident" id="187224">ok</span>&nbsp;<span class="op" id="187227">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187233">t</span><span class="op" id="187234">.</span><span class="ident" id="187235">Errorf</span><span class="op" id="187241">(</span><span class="string" id="187242">&#34;Visit:&nbsp;value&nbsp;does&nbsp;not&nbsp;satisfy&nbsp;Getter:&nbsp;%T&#34;</span><span class="op" id="187284">,</span>&nbsp;<span class="ident" id="187286">f</span><span class="op" id="187287">.</span><span class="ident" id="187288">Value</span><span class="op" id="187293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187299">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="187309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187314">switch</span>&nbsp;<span class="ident" id="187321">f</span><span class="op" id="187322">.</span><span class="ident" id="187323">Name</span>&nbsp;<span class="op" id="187328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187333">case</span>&nbsp;<span class="string" id="187338">&#34;test_bool&#34;</span><span class="op" id="187349">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187355">ok</span>&nbsp;<span class="op" id="187358">=</span>&nbsp;<span class="ident" id="187360">g</span><span class="op" id="187361">.</span><span class="ident" id="187362">Get</span><span class="op" id="187365">(</span><span class="op" id="187366">)</span>&nbsp;<span class="op" id="187368">==</span>&nbsp;<span class="builtintype" id="187371">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187379">case</span>&nbsp;<span class="string" id="187384">&#34;test_int&#34;</span><span class="op" id="187394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187400">ok</span>&nbsp;<span class="op" id="187403">=</span>&nbsp;<span class="ident" id="187405">g</span><span class="op" id="187406">.</span><span class="ident" id="187407">Get</span><span class="op" id="187410">(</span><span class="op" id="187411">)</span>&nbsp;<span class="op" id="187413">==</span>&nbsp;<span class="builtintype" id="187416">int</span><span class="op" id="187419">(</span><span class="num" id="187420">1</span><span class="op" id="187421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187426">case</span>&nbsp;<span class="string" id="187431">&#34;test_int64&#34;</span><span class="op" id="187443">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187449">ok</span>&nbsp;<span class="op" id="187452">=</span>&nbsp;<span class="ident" id="187454">g</span><span class="op" id="187455">.</span><span class="ident" id="187456">Get</span><span class="op" id="187459">(</span><span class="op" id="187460">)</span>&nbsp;<span class="op" id="187462">==</span>&nbsp;<span class="ident" id="187465">int64</span><span class="op" id="187470">(</span><span class="num" id="187471">2</span><span class="op" id="187472">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187477">case</span>&nbsp;<span class="string" id="187482">&#34;test_uint&#34;</span><span class="op" id="187493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187499">ok</span>&nbsp;<span class="op" id="187502">=</span>&nbsp;<span class="ident" id="187504">g</span><span class="op" id="187505">.</span><span class="ident" id="187506">Get</span><span class="op" id="187509">(</span><span class="op" id="187510">)</span>&nbsp;<span class="op" id="187512">==</span>&nbsp;<span class="builtintype" id="187515">uint</span><span class="op" id="187519">(</span><span class="num" id="187520">3</span><span class="op" id="187521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187526">case</span>&nbsp;<span class="string" id="187531">&#34;test_uint64&#34;</span><span class="op" id="187544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187550">ok</span>&nbsp;<span class="op" id="187553">=</span>&nbsp;<span class="ident" id="187555">g</span><span class="op" id="187556">.</span><span class="ident" id="187557">Get</span><span class="op" id="187560">(</span><span class="op" id="187561">)</span>&nbsp;<span class="op" id="187563">==</span>&nbsp;<span class="ident" id="187566">uint64</span><span class="op" id="187572">(</span><span class="num" id="187573">4</span><span class="op" id="187574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187579">case</span>&nbsp;<span class="string" id="187584">&#34;test_string&#34;</span><span class="op" id="187597">:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187603">ok</span>&nbsp;<span class="op" id="187606">=</span>&nbsp;<span class="ident" id="187608">g</span><span class="op" id="187609">.</span><span class="ident" id="187610">Get</span><span class="op" id="187613">(</span><span class="op" id="187614">)</span>&nbsp;<span class="op" id="187616">==</span>&nbsp;<span class="string" id="187619">&#34;5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187626">case</span>&nbsp;<span class="string" id="187631">&#34;test_float64&#34;</span><span class="op" id="187645">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187651">ok</span>&nbsp;<span class="op" id="187654">=</span>&nbsp;<span class="ident" id="187656">g</span><span class="op" id="187657">.</span><span class="ident" id="187658">Get</span><span class="op" id="187661">(</span><span class="op" id="187662">)</span>&nbsp;<span class="op" id="187664">==</span>&nbsp;<span class="builtintype" id="187667">float64</span><span class="op" id="187674">(</span><span class="num" id="187675">6</span><span class="op" id="187676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187681">case</span>&nbsp;<span class="string" id="187686">&#34;test_duration&#34;</span><span class="op" id="187701">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187707">ok</span>&nbsp;<span class="op" id="187710">=</span>&nbsp;<span class="ident" id="187712">g</span><span class="op" id="187713">.</span><span class="ident" id="187714">Get</span><span class="op" id="187717">(</span><span class="op" id="187718">)</span>&nbsp;<span class="op" id="187720">==</span>&nbsp;<span class="ident" id="187723">time</span><span class="op" id="187727">.</span><span class="ident" id="187728">Duration</span><span class="op" id="187736">(</span><span class="num" id="187737">7</span><span class="op" id="187738">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="187743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187748">if</span>&nbsp;<span class="op" id="187751">!</span><span class="ident" id="187752">ok</span>&nbsp;<span class="op" id="187755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187761">t</span><span class="op" id="187762">.</span><span class="ident" id="187763">Errorf</span><span class="op" id="187769">(</span><span class="string" id="187770">&#34;Visit:&nbsp;bad&nbsp;value&nbsp;%T(%v)&nbsp;for&nbsp;%s&#34;</span><span class="op" id="187802">,</span>&nbsp;<span class="ident" id="187804">g</span><span class="op" id="187805">.</span><span class="ident" id="187806">Get</span><span class="op" id="187809">(</span><span class="op" id="187810">)</span><span class="op" id="187811">,</span>&nbsp;<span class="ident" id="187813">g</span><span class="op" id="187814">.</span><span class="ident" id="187815">Get</span><span class="op" id="187818">(</span><span class="op" id="187819">)</span><span class="op" id="187820">,</span>&nbsp;<span class="ident" id="187822">f</span><span class="op" id="187823">.</span><span class="ident" id="187824">Name</span><span class="op" id="187828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="187833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="187837">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="187840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187843">VisitAll</span><span class="op" id="187851">(</span><span class="ident" id="187852">visitor</span><span class="op" id="187859">)</span><br>
<span class="lineno"></span><span class="op" id="187861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="187864">func</span>&nbsp;<span class="ident" id="187869">TestUsage</span><span class="op" id="187878">(</span><span class="ident" id="187879">t</span>&nbsp;<span class="op" id="187881">*</span><span class="ident" id="187882">testing</span><span class="op" id="187889">.</span><span class="ident" id="187890">T</span><span class="op" id="187891">)</span>&nbsp;<span class="op" id="187893">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187896">called</span>&nbsp;<span class="op" id="187903">:=</span>&nbsp;<span class="builtintype" id="187906">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="187913">ResetForTesting</span><span class="op" id="187928">(</span><span class="keyword" id="187929">func</span><span class="op" id="187933">(</span><span class="op" id="187934">)</span>&nbsp;<span class="op" id="187936">{</span>&nbsp;<span class="ident" id="187938">called</span>&nbsp;<span class="op" id="187945">=</span>&nbsp;<span class="builtintype" id="187947">true</span>&nbsp;<span class="op" id="187952">}</span><span class="op" id="187953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="187956">if</span>&nbsp;<span class="ident" id="187959">CommandLine</span><span class="op" id="187970">.</span><span class="ident" id="187971">Parse</span><span class="op" id="187976">(</span><span class="op" id="187977">[</span><span class="op" id="187978">]</span><span class="builtintype" id="187979">string</span><span class="op" id="187985">{</span><span class="string" id="187986">&#34;-x&#34;</span><span class="op" id="187990">}</span><span class="op" id="187991">)</span>&nbsp;<span class="op" id="187993">==</span>&nbsp;<span class="ident" id="187996">nil</span>&nbsp;<span class="op" id="188000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188004">t</span><span class="op" id="188005">.</span><span class="ident" id="188006">Error</span><span class="op" id="188011">(</span><span class="string" id="188012">&#34;parse&nbsp;did&nbsp;not&nbsp;fail&nbsp;for&nbsp;unknown&nbsp;flag&#34;</span><span class="op" id="188049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="188052">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="188055">if</span>&nbsp;<span class="op" id="188058">!</span><span class="ident" id="188059">called</span>&nbsp;<span class="op" id="188066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188070">t</span><span class="op" id="188071">.</span><span class="ident" id="188072">Error</span><span class="op" id="188077">(</span><span class="string" id="188078">&#34;did&nbsp;not&nbsp;call&nbsp;Usage&nbsp;for&nbsp;unknown&nbsp;flag&#34;</span><span class="op" id="188115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="188118">}</span><br>
<span class="lineno"></span><span class="op" id="188120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="188123">func</span>&nbsp;<span class="ident" id="188128">testParse</span><span class="op" id="188137">(</span><span class="ident" id="188138">f</span>&nbsp;<span class="op" id="188140">*</span><span class="ident" id="188141">FlagSet</span><span class="op" id="188148">,</span>&nbsp;<span class="ident" id="188150">t</span>&nbsp;<span class="op" id="188152">*</span><span class="ident" id="188153">testing</span><span class="op" id="188160">.</span><span class="ident" id="188161">T</span><span class="op" id="188162">)</span>&nbsp;<span class="op" id="188164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="188167">if</span>&nbsp;<span class="ident" id="188170">f</span><span class="op" id="188171">.</span><span class="ident" id="188172">Parsed</span><span class="op" id="188178">(</span><span class="op" id="188179">)</span>&nbsp;<span class="op" id="188181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188185">t</span><span class="op" id="188186">.</span><span class="ident" id="188187">Error</span><span class="op" id="188192">(</span><span class="string" id="188193">&#34;f.Parse()&nbsp;=&nbsp;true&nbsp;before&nbsp;Parse&#34;</span><span class="op" id="188224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="188227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188230">boolFlag</span>&nbsp;<span class="op" id="188239">:=</span>&nbsp;<span class="ident" id="188242">f</span><span class="op" id="188243">.</span><span class="ident" id="188244">Bool</span><span class="op" id="188248">(</span><span class="string" id="188249">&#34;bool&#34;</span><span class="op" id="188255">,</span>&nbsp;<span class="builtintype" id="188257">false</span><span class="op" id="188262">,</span>&nbsp;<span class="string" id="188264">&#34;bool&nbsp;value&#34;</span><span class="op" id="188276">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188279">bool2Flag</span>&nbsp;<span class="op" id="188289">:=</span>&nbsp;<span class="ident" id="188292">f</span><span class="op" id="188293">.</span><span class="ident" id="188294">Bool</span><span class="op" id="188298">(</span><span class="string" id="188299">&#34;bool2&#34;</span><span class="op" id="188306">,</span>&nbsp;<span class="builtintype" id="188308">false</span><span class="op" id="188313">,</span>&nbsp;<span class="string" id="188315">&#34;bool2&nbsp;value&#34;</span><span class="op" id="188328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188331">intFlag</span>&nbsp;<span class="op" id="188339">:=</span>&nbsp;<span class="ident" id="188342">f</span><span class="op" id="188343">.</span><span class="ident" id="188344">Int</span><span class="op" id="188347">(</span><span class="string" id="188348">&#34;int&#34;</span><span class="op" id="188353">,</span>&nbsp;<span class="num" id="188355">0</span><span class="op" id="188356">,</span>&nbsp;<span class="string" id="188358">&#34;int&nbsp;value&#34;</span><span class="op" id="188369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188372">int64Flag</span>&nbsp;<span class="op" id="188382">:=</span>&nbsp;<span class="ident" id="188385">f</span><span class="op" id="188386">.</span><span class="ident" id="188387">Int64</span><span class="op" id="188392">(</span><span class="string" id="188393">&#34;int64&#34;</span><span class="op" id="188400">,</span>&nbsp;<span class="num" id="188402">0</span><span class="op" id="188403">,</span>&nbsp;<span class="string" id="188405">&#34;int64&nbsp;value&#34;</span><span class="op" id="188418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188421">uintFlag</span>&nbsp;<span class="op" id="188430">:=</span>&nbsp;<span class="ident" id="188433">f</span><span class="op" id="188434">.</span><span class="ident" id="188435">Uint</span><span class="op" id="188439">(</span><span class="string" id="188440">&#34;uint&#34;</span><span class="op" id="188446">,</span>&nbsp;<span class="num" id="188448">0</span><span class="op" id="188449">,</span>&nbsp;<span class="string" id="188451">&#34;uint&nbsp;value&#34;</span><span class="op" id="188463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188466">uint64Flag</span>&nbsp;<span class="op" id="188477">:=</span>&nbsp;<span class="ident" id="188480">f</span><span class="op" id="188481">.</span><span class="ident" id="188482">Uint64</span><span class="op" id="188488">(</span><span class="string" id="188489">&#34;uint64&#34;</span><span class="op" id="188497">,</span>&nbsp;<span class="num" id="188499">0</span><span class="op" id="188500">,</span>&nbsp;<span class="string" id="188502">&#34;uint64&nbsp;value&#34;</span><span class="op" id="188516">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188519">stringFlag</span>&nbsp;<span class="op" id="188530">:=</span>&nbsp;<span class="ident" id="188533">f</span><span class="op" id="188534">.</span><span class="ident" id="188535">String</span><span class="op" id="188541">(</span><span class="string" id="188542">&#34;string&#34;</span><span class="op" id="188550">,</span>&nbsp;<span class="string" id="188552">&#34;0&#34;</span><span class="op" id="188555">,</span>&nbsp;<span class="string" id="188557">&#34;string&nbsp;value&#34;</span><span class="op" id="188571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188574">float64Flag</span>&nbsp;<span class="op" id="188586">:=</span>&nbsp;<span class="ident" id="188589">f</span><span class="op" id="188590">.</span><span class="ident" id="188591">Float64</span><span class="op" id="188598">(</span><span class="string" id="188599">&#34;float64&#34;</span><span class="op" id="188608">,</span>&nbsp;<span class="num" id="188610">0</span><span class="op" id="188611">,</span>&nbsp;<span class="string" id="188613">&#34;float64&nbsp;value&#34;</span><span class="op" id="188628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188631">durationFlag</span>&nbsp;<span class="op" id="188644">:=</span>&nbsp;<span class="ident" id="188647">f</span><span class="op" id="188648">.</span><span class="ident" id="188649">Duration</span><span class="op" id="188657">(</span><span class="string" id="188658">&#34;duration&#34;</span><span class="op" id="188668">,</span>&nbsp;<span class="num" id="188670">5</span><span class="op" id="188671">*</span><span class="ident" id="188672">time</span><span class="op" id="188676">.</span><span class="ident" id="188677">Second</span><span class="op" id="188683">,</span>&nbsp;<span class="string" id="188685">&#34;time.Duration&nbsp;value&#34;</span><span class="op" id="188706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188709">extra</span>&nbsp;<span class="op" id="188715">:=</span>&nbsp;<span class="string" id="188718">&#34;one-extra-argument&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188740">args</span>&nbsp;<span class="op" id="188745">:=</span>&nbsp;<span class="op" id="188748">[</span><span class="op" id="188749">]</span><span class="builtintype" id="188750">string</span><span class="op" id="188756">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="188760">&#34;-bool&#34;</span><span class="op" id="188767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="188771">&#34;-bool2=true&#34;</span><span class="op" id="188784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="188788">&#34;--int&#34;</span><span class="op" id="188795">,</span>&nbsp;<span class="string" id="188797">&#34;22&#34;</span><span class="op" id="188801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="188805">&#34;--int64&#34;</span><span class="op" id="188814">,</span>&nbsp;<span class="string" id="188816">&#34;0x23&#34;</span><span class="op" id="188822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="188826">&#34;-uint&#34;</span><span class="op" id="188833">,</span>&nbsp;<span class="string" id="188835">&#34;24&#34;</span><span class="op" id="188839">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="188843">&#34;--uint64&#34;</span><span class="op" id="188853">,</span>&nbsp;<span class="string" id="188855">&#34;25&#34;</span><span class="op" id="188859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="188863">&#34;-string&#34;</span><span class="op" id="188872">,</span>&nbsp;<span class="string" id="188874">&#34;hello&#34;</span><span class="op" id="188881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="188885">&#34;-float64&#34;</span><span class="op" id="188895">,</span>&nbsp;<span class="string" id="188897">&#34;2718e28&#34;</span><span class="op" id="188906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="188910">&#34;-duration&#34;</span><span class="op" id="188921">,</span>&nbsp;<span class="string" id="188923">&#34;2m&#34;</span><span class="op" id="188927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188931">extra</span><span class="op" id="188936">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="188939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="188942">if</span>&nbsp;<span class="ident" id="188945">err</span>&nbsp;<span class="op" id="188949">:=</span>&nbsp;<span class="ident" id="188952">f</span><span class="op" id="188953">.</span><span class="ident" id="188954">Parse</span><span class="op" id="188959">(</span><span class="ident" id="188960">args</span><span class="op" id="188964">)</span><span class="op" id="188965">;</span>&nbsp;<span class="ident" id="188967">err</span>&nbsp;<span class="op" id="188971">!=</span>&nbsp;<span class="ident" id="188974">nil</span>&nbsp;<span class="op" id="188978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="188982">t</span><span class="op" id="188983">.</span><span class="ident" id="188984">Fatal</span><span class="op" id="188989">(</span><span class="ident" id="188990">err</span><span class="op" id="188993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="188996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="188999">if</span>&nbsp;<span class="op" id="189002">!</span><span class="ident" id="189003">f</span><span class="op" id="189004">.</span><span class="ident" id="189005">Parsed</span><span class="op" id="189011">(</span><span class="op" id="189012">)</span>&nbsp;<span class="op" id="189014">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="189018">t</span><span class="op" id="189019">.</span><span class="ident" id="189020">Error</span><span class="op" id="189025">(</span><span class="string" id="189026">&#34;f.Parse()&nbsp;=&nbsp;false&nbsp;after&nbsp;Parse&#34;</span><span class="op" id="189057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="189060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="189063">if</span>&nbsp;<span class="op" id="189066">*</span><span class="ident" id="189067">boolFlag</span>&nbsp;<span class="op" id="189076">!=</span>&nbsp;<span class="builtintype" id="189079">true</span>&nbsp;<span class="op" id="189084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="189088">t</span><span class="op" id="189089">.</span><span class="ident" id="189090">Error</span><span class="op" id="189095">(</span><span class="string" id="189096">&#34;bool&nbsp;flag&nbsp;should&nbsp;be&nbsp;true,&nbsp;is&nbsp;&#34;</span><span class="op" id="189127">,</span>&nbsp;<span class="op" id="189129">*</span><span class="ident" id="189130">boolFlag</span><span class="op" id="189138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="189141">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="189144">if</span>&nbsp;<span class="op" id="189147">*</span><span class="ident" id="189148">bool2Flag</span>&nbsp;<span class="op" id="189158">!=</span>&nbsp;<span class="builtintype" id="189161">true</span>&nbsp;<span class="op" id="189166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="189170">t</span><span class="op" id="189171">.</span><span class="ident" id="189172">Error</span><span class="op" id="189177">(</span><span class="string" id="189178">&#34;bool2&nbsp;flag&nbsp;should&nbsp;be&nbsp;true,&nbsp;is&nbsp;&#34;</span><span class="op" id="189210">,</span>&nbsp;<span class="op" id="189212">*</span><span class="ident" id="189213">bool2Flag</span><span class="op" id="189222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="189225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="189228">if</span>&nbsp;<span class="op" id="189231">*</span><span class="ident" id="189232">intFlag</span>&nbsp;<span class="op" id="189240">!=</span>&nbsp;<span class="num" id="189243">22</span>&nbsp;<span class="op" id="189246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="189250">t</span><span class="op" id="189251">.</span><span class="ident" id="189252">Error</span><span class="op" id="189257">(</span><span class="string" id="189258">&#34;int&nbsp;flag&nbsp;should&nbsp;be&nbsp;22,&nbsp;is&nbsp;&#34;</span><span class="op" id="189286">,</span>&nbsp;<span class="op" id="189288">*</span><span class="ident" id="189289">intFlag</span><span class="op" id="189296">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="189299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="189302">if</span>&nbsp;<span class="op" id="189305">*</span><span class="ident" id="189306">int64Flag</span>&nbsp;<span class="op" id="189316">!=</span>&nbsp;<span class="num" id="189319">0x23</span>&nbsp;<span class="op" id="189324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="189328">t</span><span class="op" id="189329">.</span><span class="ident" id="189330">Error</span><span class="op" id="189335">(</span><span class="string" id="189336">&#34;int64&nbsp;flag&nbsp;should&nbsp;be&nbsp;0x23,&nbsp;is&nbsp;&#34;</span><span class="op" id="189368">,</span>&nbsp;<span class="op" id="189370">*</span><span class="ident" id="189371">int64Flag</span><span class="op" id="189380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="189383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="189386">if</span>&nbsp;<span class="op" id="189389">*</span><span class="ident" id="189390">uintFlag</span>&nbsp;<span class="op" id="189399">!=</span>&nbsp;<span class="num" id="189402">24</span>&nbsp;<span class="op" id="189405">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="189409">t</span><span class="op" id="189410">.</span><span class="ident" id="189411">Error</span><span class="op" id="189416">(</span><span class="string" id="189417">&#34;uint&nbsp;flag&nbsp;should&nbsp;be&nbsp;24,&nbsp;is&nbsp;&#34;</span><span class="op" id="189446">,</span>&nbsp;<span class="op" id="189448">*</span><span class="ident" id="189449">uintFlag</span><span class="op" id="189457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="189460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="189463">if</span>&nbsp;<span class="op" id="189466">*</span><span class="ident" id="189467">uint64Flag</span>&nbsp;<span class="op" id="189478">!=</span>&nbsp;<span class="num" id="189481">25</span>&nbsp;<span class="op" id="189484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="189488">t</span><span class="op" id="189489">.</span><span class="ident" id="189490">Error</span><span class="op" id="189495">(</span><span class="string" id="189496">&#34;uint64&nbsp;flag&nbsp;should&nbsp;be&nbsp;25,&nbsp;is&nbsp;&#34;</span><span class="op" id="189527">,</span>&nbsp;<span class="op" id="189529">*</span><span class="ident" id="189530">uint64Flag</span><span class="op" id="189540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="189543">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="189546">if</span>&nbsp;<span class="op" id="189549">*</span><span class="ident" id="189550">stringFlag</span>&nbsp;<span class="op" id="189561">!=</span>&nbsp;<span class="string" id="189564">&#34;hello&#34;</span>&nbsp;<span class="op" id="189572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="189576">t</span><span class="op" id="189577">.</span><span class="ident" id="189578">Error</span><span class="op" id="189583">(</span><span class="string" id="189584">&#34;string&nbsp;flag&nbsp;should&nbsp;be&nbsp;`hello`,&nbsp;is&nbsp;&#34;</span><span class="op" id="189620">,</span>&nbsp;<span class="op" id="189622">*</span><span class="ident" id="189623">stringFlag</span><span class="op" id="189633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="189636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="189639">if</span>&nbsp;<span class="op" id="189642">*</span><span class="ident" id="189643">float64Flag</span>&nbsp;<span class="op" id="189655">!=</span>&nbsp;<span class="num" id="189658">2718e28</span>&nbsp;<span class="op" id="189666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="189670">t</span><span class="op" id="189671">.</span><span class="ident" id="189672">Error</span><span class="op" id="189677">(</span><span class="string" id="189678">&#34;float64&nbsp;flag&nbsp;should&nbsp;be&nbsp;2718e28,&nbsp;is&nbsp;&#34;</span><span class="op" id="189715">,</span>&nbsp;<span class="op" id="189717">*</span><span class="ident" id="189718">float64Flag</span><span class="op" id="189729">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="189732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="189735">if</span>&nbsp;<span class="op" id="189738">*</span><span class="ident" id="189739">durationFlag</span>&nbsp;<span class="op" id="189752">!=</span>&nbsp;<span class="num" id="189755">2</span><span class="op" id="189756">*</span><span class="ident" id="189757">time</span><span class="op" id="189761">.</span><span class="ident" id="189762">Minute</span>&nbsp;<span class="op" id="189769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="189773">t</span><span class="op" id="189774">.</span><span class="ident" id="189775">Error</span><span class="op" id="189780">(</span><span class="string" id="189781">&#34;duration&nbsp;flag&nbsp;should&nbsp;be&nbsp;2m,&nbsp;is&nbsp;&#34;</span><span class="op" id="189814">,</span>&nbsp;<span class="op" id="189816">*</span><span class="ident" id="189817">durationFlag</span><span class="op" id="189829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="189832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="189835">if</span>&nbsp;<span class="builtinfunc" id="189838">len</span><span class="op" id="189841">(</span><span class="ident" id="189842">f</span><span class="op" id="189843">.</span><span class="ident" id="189844">Args</span><span class="op" id="189848">(</span><span class="op" id="189849">)</span><span class="op" id="189850">)</span>&nbsp;<span class="op" id="189852">!=</span>&nbsp;<span class="num" id="189855">1</span>&nbsp;<span class="op" id="189857">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="189861">t</span><span class="op" id="189862">.</span><span class="ident" id="189863">Error</span><span class="op" id="189868">(</span><span class="string" id="189869">&#34;expected&nbsp;one&nbsp;argument,&nbsp;got&#34;</span><span class="op" id="189897">,</span>&nbsp;<span class="builtinfunc" id="189899">len</span><span class="op" id="189902">(</span><span class="ident" id="189903">f</span><span class="op" id="189904">.</span><span class="ident" id="189905">Args</span><span class="op" id="189909">(</span><span class="op" id="189910">)</span><span class="op" id="189911">)</span><span class="op" id="189912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="189915">}</span>&nbsp;<span class="keyword" id="189917">else</span>&nbsp;<span class="keyword" id="189922">if</span>&nbsp;<span class="ident" id="189925">f</span><span class="op" id="189926">.</span><span class="ident" id="189927">Args</span><span class="op" id="189931">(</span><span class="op" id="189932">)</span><span class="op" id="189933">[</span><span class="num" id="189934">0</span><span class="op" id="189935">]</span>&nbsp;<span class="op" id="189937">!=</span>&nbsp;<span class="ident" id="189940">extra</span>&nbsp;<span class="op" id="189946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="189950">t</span><span class="op" id="189951">.</span><span class="ident" id="189952">Errorf</span><span class="op" id="189958">(</span><span class="string" id="189959">&#34;expected&nbsp;argument&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="189988">,</span>&nbsp;<span class="ident" id="189990">extra</span><span class="op" id="189995">,</span>&nbsp;<span class="ident" id="189997">f</span><span class="op" id="189998">.</span><span class="ident" id="189999">Args</span><span class="op" id="190003">(</span><span class="op" id="190004">)</span><span class="op" id="190005">[</span><span class="num" id="190006">0</span><span class="op" id="190007">]</span><span class="op" id="190008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="190011">}</span><br>
<span class="lineno"></span><span class="op" id="190013">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="190016">func</span>&nbsp;<span class="ident" id="190021">TestParse</span><span class="op" id="190030">(</span><span class="ident" id="190031">t</span>&nbsp;<span class="op" id="190033">*</span><span class="ident" id="190034">testing</span><span class="op" id="190041">.</span><span class="ident" id="190042">T</span><span class="op" id="190043">)</span>&nbsp;<span class="op" id="190045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="190048">ResetForTesting</span><span class="op" id="190063">(</span><span class="keyword" id="190064">func</span><span class="op" id="190068">(</span><span class="op" id="190069">)</span>&nbsp;<span class="op" id="190071">{</span>&nbsp;<span class="ident" id="190073">t</span><span class="op" id="190074">.</span><span class="ident" id="190075">Error</span><span class="op" id="190080">(</span><span class="string" id="190081">&#34;bad&nbsp;parse&#34;</span><span class="op" id="190092">)</span>&nbsp;<span class="op" id="190094">}</span><span class="op" id="190095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="190098">testParse</span><span class="op" id="190107">(</span><span class="ident" id="190108">CommandLine</span><span class="op" id="190119">,</span>&nbsp;<span class="ident" id="190121">t</span><span class="op" id="190122">)</span><br>
<span class="lineno"></span><span class="op" id="190124">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="190127">func</span>&nbsp;<span class="ident" id="190132">TestFlagSetParse</span><span class="op" id="190148">(</span><span class="ident" id="190149">t</span>&nbsp;<span class="op" id="190151">*</span><span class="ident" id="190152">testing</span><span class="op" id="190159">.</span><span class="ident" id="190160">T</span><span class="op" id="190161">)</span>&nbsp;<span class="op" id="190163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="190166">testParse</span><span class="op" id="190175">(</span><span class="ident" id="190176">NewFlagSet</span><span class="op" id="190186">(</span><span class="string" id="190187">&#34;test&#34;</span><span class="op" id="190193">,</span>&nbsp;<span class="ident" id="190195">ContinueOnError</span><span class="op" id="190210">)</span><span class="op" id="190211">,</span>&nbsp;<span class="ident" id="190213">t</span><span class="op" id="190214">)</span><br>
<span class="lineno"></span><span class="op" id="190216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="comment" id="190219">//&nbsp;Declare&nbsp;a&nbsp;user-defined&nbsp;flag&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="190256">type</span>&nbsp;<span class="ident" id="190261">flagVar</span>&nbsp;<span class="op" id="190269">[</span><span class="op" id="190270">]</span><span class="builtintype" id="190271">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="190279">func</span>&nbsp;<span class="op" id="190284">(</span><span class="ident" id="190285">f</span>&nbsp;<span class="op" id="190287">*</span><span class="ident" id="190288">flagVar</span><span class="op" id="190295">)</span>&nbsp;<span class="ident" id="190297">String</span><span class="op" id="190303">(</span><span class="op" id="190304">)</span>&nbsp;<span class="builtintype" id="190306">string</span>&nbsp;<span class="op" id="190313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="190316">return</span>&nbsp;<span class="ident" id="190323">fmt</span><span class="op" id="190326">.</span><span class="ident" id="190327">Sprint</span><span class="op" id="190333">(</span><span class="op" id="190334">[</span><span class="op" id="190335">]</span><span class="builtintype" id="190336">string</span><span class="op" id="190342">(</span><span class="op" id="190343">*</span><span class="ident" id="190344">f</span><span class="op" id="190345">)</span><span class="op" id="190346">)</span><br>
<span class="lineno">230</span><span class="op" id="190348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="190351">func</span>&nbsp;<span class="op" id="190356">(</span><span class="ident" id="190357">f</span>&nbsp;<span class="op" id="190359">*</span><span class="ident" id="190360">flagVar</span><span class="op" id="190367">)</span>&nbsp;<span class="ident" id="190369">Set</span><span class="op" id="190372">(</span><span class="ident" id="190373">value</span>&nbsp;<span class="builtintype" id="190379">string</span><span class="op" id="190385">)</span>&nbsp;<span class="builtintype" id="190387">error</span>&nbsp;<span class="op" id="190393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="190396">*</span><span class="ident" id="190397">f</span>&nbsp;<span class="op" id="190399">=</span>&nbsp;<span class="builtinfunc" id="190401">append</span><span class="op" id="190407">(</span><span class="op" id="190408">*</span><span class="ident" id="190409">f</span><span class="op" id="190410">,</span>&nbsp;<span class="ident" id="190412">value</span><span class="op" id="190417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="190420">return</span>&nbsp;<span class="ident" id="190427">nil</span><br>
<span class="lineno">235</span><span class="op" id="190431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="190434">func</span>&nbsp;<span class="ident" id="190439">TestUserDefined</span><span class="op" id="190454">(</span><span class="ident" id="190455">t</span>&nbsp;<span class="op" id="190457">*</span><span class="ident" id="190458">testing</span><span class="op" id="190465">.</span><span class="ident" id="190466">T</span><span class="op" id="190467">)</span>&nbsp;<span class="op" id="190469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="190472">var</span>&nbsp;<span class="ident" id="190476">flags</span>&nbsp;<span class="ident" id="190482">FlagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="190491">flags</span><span class="op" id="190496">.</span><span class="ident" id="190497">Init</span><span class="op" id="190501">(</span><span class="string" id="190502">&#34;test&#34;</span><span class="op" id="190508">,</span>&nbsp;<span class="ident" id="190510">ContinueOnError</span><span class="op" id="190525">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="190528">var</span>&nbsp;<span class="ident" id="190532">v</span>&nbsp;<span class="ident" id="190534">flagVar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="190543">flags</span><span class="op" id="190548">.</span><span class="ident" id="190549">Var</span><span class="op" id="190552">(</span><span class="op" id="190553">&amp;</span><span class="ident" id="190554">v</span><span class="op" id="190555">,</span>&nbsp;<span class="string" id="190557">&#34;v&#34;</span><span class="op" id="190560">,</span>&nbsp;<span class="string" id="190562">&#34;usage&#34;</span><span class="op" id="190569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="190572">if</span>&nbsp;<span class="ident" id="190575">err</span>&nbsp;<span class="op" id="190579">:=</span>&nbsp;<span class="ident" id="190582">flags</span><span class="op" id="190587">.</span><span class="ident" id="190588">Parse</span><span class="op" id="190593">(</span><span class="op" id="190594">[</span><span class="op" id="190595">]</span><span class="builtintype" id="190596">string</span><span class="op" id="190602">{</span><span class="string" id="190603">&#34;-v&#34;</span><span class="op" id="190607">,</span>&nbsp;<span class="string" id="190609">&#34;1&#34;</span><span class="op" id="190612">,</span>&nbsp;<span class="string" id="190614">&#34;-v&#34;</span><span class="op" id="190618">,</span>&nbsp;<span class="string" id="190620">&#34;2&#34;</span><span class="op" id="190623">,</span>&nbsp;<span class="string" id="190625">&#34;-v=3&#34;</span><span class="op" id="190631">}</span><span class="op" id="190632">)</span><span class="op" id="190633">;</span>&nbsp;<span class="ident" id="190635">err</span>&nbsp;<span class="op" id="190639">!=</span>&nbsp;<span class="ident" id="190642">nil</span>&nbsp;<span class="op" id="190646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="190650">t</span><span class="op" id="190651">.</span><span class="ident" id="190652">Error</span><span class="op" id="190657">(</span><span class="ident" id="190658">err</span><span class="op" id="190661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="190664">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="190667">if</span>&nbsp;<span class="builtinfunc" id="190670">len</span><span class="op" id="190673">(</span><span class="ident" id="190674">v</span><span class="op" id="190675">)</span>&nbsp;<span class="op" id="190677">!=</span>&nbsp;<span class="num" id="190680">3</span>&nbsp;<span class="op" id="190682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="190686">t</span><span class="op" id="190687">.</span><span class="ident" id="190688">Fatal</span><span class="op" id="190693">(</span><span class="string" id="190694">&#34;expected&nbsp;3&nbsp;args;&nbsp;got&nbsp;&#34;</span><span class="op" id="190717">,</span>&nbsp;<span class="builtinfunc" id="190719">len</span><span class="op" id="190722">(</span><span class="ident" id="190723">v</span><span class="op" id="190724">)</span><span class="op" id="190725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="190728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="190731">expect</span>&nbsp;<span class="op" id="190738">:=</span>&nbsp;<span class="string" id="190741">&#34;[1&nbsp;2&nbsp;3]&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="190752">if</span>&nbsp;<span class="ident" id="190755">v</span><span class="op" id="190756">.</span><span class="ident" id="190757">String</span><span class="op" id="190763">(</span><span class="op" id="190764">)</span>&nbsp;<span class="op" id="190766">!=</span>&nbsp;<span class="ident" id="190769">expect</span>&nbsp;<span class="op" id="190776">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="190780">t</span><span class="op" id="190781">.</span><span class="ident" id="190782">Errorf</span><span class="op" id="190788">(</span><span class="string" id="190789">&#34;expected&nbsp;value&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="190815">,</span>&nbsp;<span class="ident" id="190817">expect</span><span class="op" id="190823">,</span>&nbsp;<span class="ident" id="190825">v</span><span class="op" id="190826">.</span><span class="ident" id="190827">String</span><span class="op" id="190833">(</span><span class="op" id="190834">)</span><span class="op" id="190835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="190838">}</span><br>
<span class="lineno"></span><span class="op" id="190840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="190843">func</span>&nbsp;<span class="ident" id="190848">TestUserDefinedForCommandLine</span><span class="op" id="190877">(</span><span class="ident" id="190878">t</span>&nbsp;<span class="op" id="190880">*</span><span class="ident" id="190881">testing</span><span class="op" id="190888">.</span><span class="ident" id="190889">T</span><span class="op" id="190890">)</span>&nbsp;<span class="op" id="190892">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="190895">const</span>&nbsp;<span class="ident" id="190901">help</span>&nbsp;<span class="op" id="190906">=</span>&nbsp;<span class="string" id="190908">&#34;HELP&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="190916">var</span>&nbsp;<span class="ident" id="190920">result</span>&nbsp;<span class="builtintype" id="190927">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="190935">ResetForTesting</span><span class="op" id="190950">(</span><span class="keyword" id="190951">func</span><span class="op" id="190955">(</span><span class="op" id="190956">)</span>&nbsp;<span class="op" id="190958">{</span>&nbsp;<span class="ident" id="190960">result</span>&nbsp;<span class="op" id="190967">=</span>&nbsp;<span class="ident" id="190969">help</span>&nbsp;<span class="op" id="190974">}</span><span class="op" id="190975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="190978">Usage</span><span class="op" id="190983">(</span><span class="op" id="190984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="190987">if</span>&nbsp;<span class="ident" id="190990">result</span>&nbsp;<span class="op" id="190997">!=</span>&nbsp;<span class="ident" id="191000">help</span>&nbsp;<span class="op" id="191005">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="191009">t</span><span class="op" id="191010">.</span><span class="ident" id="191011">Fatalf</span><span class="op" id="191017">(</span><span class="string" id="191018">&#34;got&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="191039">,</span>&nbsp;<span class="ident" id="191041">result</span><span class="op" id="191047">,</span>&nbsp;<span class="ident" id="191049">help</span><span class="op" id="191053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="191056">}</span><br>
<span class="lineno"></span><span class="op" id="191058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="191061">//&nbsp;Declare&nbsp;a&nbsp;user-defined&nbsp;boolean&nbsp;flag&nbsp;type.</span><br>
<span class="lineno">265</span><span class="keyword" id="191106">type</span>&nbsp;<span class="ident" id="191111">boolFlagVar</span>&nbsp;<span class="keyword" id="191123">struct</span>&nbsp;<span class="op" id="191130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="191133">count</span>&nbsp;<span class="builtintype" id="191139">int</span><br>
<span class="lineno"></span><span class="op" id="191143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="191146">func</span>&nbsp;<span class="op" id="191151">(</span><span class="ident" id="191152">b</span>&nbsp;<span class="op" id="191154">*</span><span class="ident" id="191155">boolFlagVar</span><span class="op" id="191166">)</span>&nbsp;<span class="ident" id="191168">String</span><span class="op" id="191174">(</span><span class="op" id="191175">)</span>&nbsp;<span class="builtintype" id="191177">string</span>&nbsp;<span class="op" id="191184">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191187">return</span>&nbsp;<span class="ident" id="191194">fmt</span><span class="op" id="191197">.</span><span class="ident" id="191198">Sprintf</span><span class="op" id="191205">(</span><span class="string" id="191206">&#34;%d&#34;</span><span class="op" id="191210">,</span>&nbsp;<span class="ident" id="191212">b</span><span class="op" id="191213">.</span><span class="ident" id="191214">count</span><span class="op" id="191219">)</span><br>
<span class="lineno"></span><span class="op" id="191221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="191224">func</span>&nbsp;<span class="op" id="191229">(</span><span class="ident" id="191230">b</span>&nbsp;<span class="op" id="191232">*</span><span class="ident" id="191233">boolFlagVar</span><span class="op" id="191244">)</span>&nbsp;<span class="ident" id="191246">Set</span><span class="op" id="191249">(</span><span class="ident" id="191250">value</span>&nbsp;<span class="builtintype" id="191256">string</span><span class="op" id="191262">)</span>&nbsp;<span class="builtintype" id="191264">error</span>&nbsp;<span class="op" id="191270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191273">if</span>&nbsp;<span class="ident" id="191276">value</span>&nbsp;<span class="op" id="191282">==</span>&nbsp;<span class="string" id="191285">&#34;true&#34;</span>&nbsp;<span class="op" id="191292">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="191296">b</span><span class="op" id="191297">.</span><span class="ident" id="191298">count</span><span class="op" id="191303">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="191307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191310">return</span>&nbsp;<span class="ident" id="191317">nil</span><br>
<span class="lineno"></span><span class="op" id="191321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="191324">func</span>&nbsp;<span class="op" id="191329">(</span><span class="ident" id="191330">b</span>&nbsp;<span class="op" id="191332">*</span><span class="ident" id="191333">boolFlagVar</span><span class="op" id="191344">)</span>&nbsp;<span class="ident" id="191346">IsBoolFlag</span><span class="op" id="191356">(</span><span class="op" id="191357">)</span>&nbsp;<span class="builtintype" id="191359">bool</span>&nbsp;<span class="op" id="191364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191367">return</span>&nbsp;<span class="ident" id="191374">b</span><span class="op" id="191375">.</span><span class="ident" id="191376">count</span>&nbsp;<span class="op" id="191382">&lt;</span>&nbsp;<span class="num" id="191384">4</span><br>
<span class="lineno"></span><span class="op" id="191386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="191389">func</span>&nbsp;<span class="ident" id="191394">TestUserDefinedBool</span><span class="op" id="191413">(</span><span class="ident" id="191414">t</span>&nbsp;<span class="op" id="191416">*</span><span class="ident" id="191417">testing</span><span class="op" id="191424">.</span><span class="ident" id="191425">T</span><span class="op" id="191426">)</span>&nbsp;<span class="op" id="191428">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191431">var</span>&nbsp;<span class="ident" id="191435">flags</span>&nbsp;<span class="ident" id="191441">FlagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="191450">flags</span><span class="op" id="191455">.</span><span class="ident" id="191456">Init</span><span class="op" id="191460">(</span><span class="string" id="191461">&#34;test&#34;</span><span class="op" id="191467">,</span>&nbsp;<span class="ident" id="191469">ContinueOnError</span><span class="op" id="191484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191487">var</span>&nbsp;<span class="ident" id="191491">b</span>&nbsp;<span class="ident" id="191493">boolFlagVar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191506">var</span>&nbsp;<span class="ident" id="191510">err</span>&nbsp;<span class="builtintype" id="191514">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="191521">flags</span><span class="op" id="191526">.</span><span class="ident" id="191527">Var</span><span class="op" id="191530">(</span><span class="op" id="191531">&amp;</span><span class="ident" id="191532">b</span><span class="op" id="191533">,</span>&nbsp;<span class="string" id="191535">&#34;b&#34;</span><span class="op" id="191538">,</span>&nbsp;<span class="string" id="191540">&#34;usage&#34;</span><span class="op" id="191547">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191550">if</span>&nbsp;<span class="ident" id="191553">err</span>&nbsp;<span class="op" id="191557">=</span>&nbsp;<span class="ident" id="191559">flags</span><span class="op" id="191564">.</span><span class="ident" id="191565">Parse</span><span class="op" id="191570">(</span><span class="op" id="191571">[</span><span class="op" id="191572">]</span><span class="builtintype" id="191573">string</span><span class="op" id="191579">{</span><span class="string" id="191580">&#34;-b&#34;</span><span class="op" id="191584">,</span>&nbsp;<span class="string" id="191586">&#34;-b&#34;</span><span class="op" id="191590">,</span>&nbsp;<span class="string" id="191592">&#34;-b&#34;</span><span class="op" id="191596">,</span>&nbsp;<span class="string" id="191598">&#34;-b=true&#34;</span><span class="op" id="191607">,</span>&nbsp;<span class="string" id="191609">&#34;-b=false&#34;</span><span class="op" id="191619">,</span>&nbsp;<span class="string" id="191621">&#34;-b&#34;</span><span class="op" id="191625">,</span>&nbsp;<span class="string" id="191627">&#34;barg&#34;</span><span class="op" id="191633">,</span>&nbsp;<span class="string" id="191635">&#34;-b&#34;</span><span class="op" id="191639">}</span><span class="op" id="191640">)</span><span class="op" id="191641">;</span>&nbsp;<span class="ident" id="191643">err</span>&nbsp;<span class="op" id="191647">!=</span>&nbsp;<span class="ident" id="191650">nil</span>&nbsp;<span class="op" id="191654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191658">if</span>&nbsp;<span class="ident" id="191661">b</span><span class="op" id="191662">.</span><span class="ident" id="191663">count</span>&nbsp;<span class="op" id="191669">&lt;</span>&nbsp;<span class="num" id="191671">4</span>&nbsp;<span class="op" id="191673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="191678">t</span><span class="op" id="191679">.</span><span class="ident" id="191680">Error</span><span class="op" id="191685">(</span><span class="ident" id="191686">err</span><span class="op" id="191689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="191693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="191696">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191700">if</span>&nbsp;<span class="ident" id="191703">b</span><span class="op" id="191704">.</span><span class="ident" id="191705">count</span>&nbsp;<span class="op" id="191711">!=</span>&nbsp;<span class="num" id="191714">4</span>&nbsp;<span class="op" id="191716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="191720">t</span><span class="op" id="191721">.</span><span class="ident" id="191722">Errorf</span><span class="op" id="191728">(</span><span class="string" id="191729">&#34;want:&nbsp;%d;&nbsp;got:&nbsp;%d&#34;</span><span class="op" id="191748">,</span>&nbsp;<span class="num" id="191750">4</span><span class="op" id="191751">,</span>&nbsp;<span class="ident" id="191753">b</span><span class="op" id="191754">.</span><span class="ident" id="191755">count</span><span class="op" id="191760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="191763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191767">if</span>&nbsp;<span class="ident" id="191770">err</span>&nbsp;<span class="op" id="191774">==</span>&nbsp;<span class="ident" id="191777">nil</span>&nbsp;<span class="op" id="191781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="191785">t</span><span class="op" id="191786">.</span><span class="ident" id="191787">Error</span><span class="op" id="191792">(</span><span class="string" id="191793">&#34;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="191819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="191822">}</span><br>
<span class="lineno"></span><span class="op" id="191824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span><span class="keyword" id="191827">func</span>&nbsp;<span class="ident" id="191832">TestSetOutput</span><span class="op" id="191845">(</span><span class="ident" id="191846">t</span>&nbsp;<span class="op" id="191848">*</span><span class="ident" id="191849">testing</span><span class="op" id="191856">.</span><span class="ident" id="191857">T</span><span class="op" id="191858">)</span>&nbsp;<span class="op" id="191860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191863">var</span>&nbsp;<span class="ident" id="191867">flags</span>&nbsp;<span class="ident" id="191873">FlagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191882">var</span>&nbsp;<span class="ident" id="191886">buf</span>&nbsp;<span class="ident" id="191890">bytes</span><span class="op" id="191895">.</span><span class="ident" id="191896">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="191904">flags</span><span class="op" id="191909">.</span><span class="ident" id="191910">SetOutput</span><span class="op" id="191919">(</span><span class="op" id="191920">&amp;</span><span class="ident" id="191921">buf</span><span class="op" id="191924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="191927">flags</span><span class="op" id="191932">.</span><span class="ident" id="191933">Init</span><span class="op" id="191937">(</span><span class="string" id="191938">&#34;test&#34;</span><span class="op" id="191944">,</span>&nbsp;<span class="ident" id="191946">ContinueOnError</span><span class="op" id="191961">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="191964">flags</span><span class="op" id="191969">.</span><span class="ident" id="191970">Parse</span><span class="op" id="191975">(</span><span class="op" id="191976">[</span><span class="op" id="191977">]</span><span class="builtintype" id="191978">string</span><span class="op" id="191984">{</span><span class="string" id="191985">&#34;-unknown&#34;</span><span class="op" id="191995">}</span><span class="op" id="191996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="191999">if</span>&nbsp;<span class="ident" id="192002">out</span>&nbsp;<span class="op" id="192006">:=</span>&nbsp;<span class="ident" id="192009">buf</span><span class="op" id="192012">.</span><span class="ident" id="192013">String</span><span class="op" id="192019">(</span><span class="op" id="192020">)</span><span class="op" id="192021">;</span>&nbsp;<span class="op" id="192023">!</span><span class="ident" id="192024">strings</span><span class="op" id="192031">.</span><span class="ident" id="192032">Contains</span><span class="op" id="192040">(</span><span class="ident" id="192041">out</span><span class="op" id="192044">,</span>&nbsp;<span class="string" id="192046">&#34;-unknown&#34;</span><span class="op" id="192056">)</span>&nbsp;<span class="op" id="192058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192062">t</span><span class="op" id="192063">.</span><span class="ident" id="192064">Logf</span><span class="op" id="192068">(</span><span class="string" id="192069">&#34;expected&nbsp;output&nbsp;mentioning&nbsp;unknown;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="192113">,</span>&nbsp;<span class="ident" id="192115">out</span><span class="op" id="192118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="192121">}</span><br>
<span class="lineno"></span><span class="op" id="192123">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="192126">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;one&nbsp;can&nbsp;reset&nbsp;the&nbsp;flags.&nbsp;This&nbsp;still&nbsp;works&nbsp;but&nbsp;not&nbsp;well,&nbsp;and&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="192208">//&nbsp;superseded&nbsp;by&nbsp;FlagSet.</span><br>
<span class="lineno"></span><span class="keyword" id="192234">func</span>&nbsp;<span class="ident" id="192239">TestChangingArgs</span><span class="op" id="192255">(</span><span class="ident" id="192256">t</span>&nbsp;<span class="op" id="192258">*</span><span class="ident" id="192259">testing</span><span class="op" id="192266">.</span><span class="ident" id="192267">T</span><span class="op" id="192268">)</span>&nbsp;<span class="op" id="192270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192273">ResetForTesting</span><span class="op" id="192288">(</span><span class="keyword" id="192289">func</span><span class="op" id="192293">(</span><span class="op" id="192294">)</span>&nbsp;<span class="op" id="192296">{</span>&nbsp;<span class="ident" id="192298">t</span><span class="op" id="192299">.</span><span class="ident" id="192300">Fatal</span><span class="op" id="192305">(</span><span class="string" id="192306">&#34;bad&nbsp;parse&#34;</span><span class="op" id="192317">)</span>&nbsp;<span class="op" id="192319">}</span><span class="op" id="192320">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192323">oldArgs</span>&nbsp;<span class="op" id="192331">:=</span>&nbsp;<span class="ident" id="192334">os</span><span class="op" id="192336">.</span><span class="ident" id="192337">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="192343">defer</span>&nbsp;<span class="keyword" id="192349">func</span><span class="op" id="192353">(</span><span class="op" id="192354">)</span>&nbsp;<span class="op" id="192356">{</span>&nbsp;<span class="ident" id="192358">os</span><span class="op" id="192360">.</span><span class="ident" id="192361">Args</span>&nbsp;<span class="op" id="192366">=</span>&nbsp;<span class="ident" id="192368">oldArgs</span>&nbsp;<span class="op" id="192376">}</span><span class="op" id="192377">(</span><span class="op" id="192378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192381">os</span><span class="op" id="192383">.</span><span class="ident" id="192384">Args</span>&nbsp;<span class="op" id="192389">=</span>&nbsp;<span class="op" id="192391">[</span><span class="op" id="192392">]</span><span class="builtintype" id="192393">string</span><span class="op" id="192399">{</span><span class="string" id="192400">&#34;cmd&#34;</span><span class="op" id="192405">,</span>&nbsp;<span class="string" id="192407">&#34;-before&#34;</span><span class="op" id="192416">,</span>&nbsp;<span class="string" id="192418">&#34;subcmd&#34;</span><span class="op" id="192426">,</span>&nbsp;<span class="string" id="192428">&#34;-after&#34;</span><span class="op" id="192436">,</span>&nbsp;<span class="string" id="192438">&#34;args&#34;</span><span class="op" id="192444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192447">before</span>&nbsp;<span class="op" id="192454">:=</span>&nbsp;<span class="ident" id="192457">Bool</span><span class="op" id="192461">(</span><span class="string" id="192462">&#34;before&#34;</span><span class="op" id="192470">,</span>&nbsp;<span class="builtintype" id="192472">false</span><span class="op" id="192477">,</span>&nbsp;<span class="string" id="192479">&#34;&#34;</span><span class="op" id="192481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="192484">if</span>&nbsp;<span class="ident" id="192487">err</span>&nbsp;<span class="op" id="192491">:=</span>&nbsp;<span class="ident" id="192494">CommandLine</span><span class="op" id="192505">.</span><span class="ident" id="192506">Parse</span><span class="op" id="192511">(</span><span class="ident" id="192512">os</span><span class="op" id="192514">.</span><span class="ident" id="192515">Args</span><span class="op" id="192519">[</span><span class="num" id="192520">1</span><span class="op" id="192521">:</span><span class="op" id="192522">]</span><span class="op" id="192523">)</span><span class="op" id="192524">;</span>&nbsp;<span class="ident" id="192526">err</span>&nbsp;<span class="op" id="192530">!=</span>&nbsp;<span class="ident" id="192533">nil</span>&nbsp;<span class="op" id="192537">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192541">t</span><span class="op" id="192542">.</span><span class="ident" id="192543">Fatal</span><span class="op" id="192548">(</span><span class="ident" id="192549">err</span><span class="op" id="192552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="192555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192558">cmd</span>&nbsp;<span class="op" id="192562">:=</span>&nbsp;<span class="ident" id="192565">Arg</span><span class="op" id="192568">(</span><span class="num" id="192569">0</span><span class="op" id="192570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192573">os</span><span class="op" id="192575">.</span><span class="ident" id="192576">Args</span>&nbsp;<span class="op" id="192581">=</span>&nbsp;<span class="ident" id="192583">Args</span><span class="op" id="192587">(</span><span class="op" id="192588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192591">after</span>&nbsp;<span class="op" id="192597">:=</span>&nbsp;<span class="ident" id="192600">Bool</span><span class="op" id="192604">(</span><span class="string" id="192605">&#34;after&#34;</span><span class="op" id="192612">,</span>&nbsp;<span class="builtintype" id="192614">false</span><span class="op" id="192619">,</span>&nbsp;<span class="string" id="192621">&#34;&#34;</span><span class="op" id="192623">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192626">Parse</span><span class="op" id="192631">(</span><span class="op" id="192632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192635">args</span>&nbsp;<span class="op" id="192640">:=</span>&nbsp;<span class="ident" id="192643">Args</span><span class="op" id="192647">(</span><span class="op" id="192648">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="192652">if</span>&nbsp;<span class="op" id="192655">!</span><span class="op" id="192656">*</span><span class="ident" id="192657">before</span>&nbsp;<span class="op" id="192664">||</span>&nbsp;<span class="ident" id="192667">cmd</span>&nbsp;<span class="op" id="192671">!=</span>&nbsp;<span class="string" id="192674">&#34;subcmd&#34;</span>&nbsp;<span class="op" id="192683">||</span>&nbsp;<span class="op" id="192686">!</span><span class="op" id="192687">*</span><span class="ident" id="192688">after</span>&nbsp;<span class="op" id="192694">||</span>&nbsp;<span class="builtinfunc" id="192697">len</span><span class="op" id="192700">(</span><span class="ident" id="192701">args</span><span class="op" id="192705">)</span>&nbsp;<span class="op" id="192707">!=</span>&nbsp;<span class="num" id="192710">1</span>&nbsp;<span class="op" id="192712">||</span>&nbsp;<span class="ident" id="192715">args</span><span class="op" id="192719">[</span><span class="num" id="192720">0</span><span class="op" id="192721">]</span>&nbsp;<span class="op" id="192723">!=</span>&nbsp;<span class="string" id="192726">&#34;args&#34;</span>&nbsp;<span class="op" id="192733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192737">t</span><span class="op" id="192738">.</span><span class="ident" id="192739">Fatalf</span><span class="op" id="192745">(</span><span class="string" id="192746">&#34;expected&nbsp;true&nbsp;subcmd&nbsp;true&nbsp;[args]&nbsp;got&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&#34;</span><span class="op" id="192796">,</span>&nbsp;<span class="op" id="192798">*</span><span class="ident" id="192799">before</span><span class="op" id="192805">,</span>&nbsp;<span class="ident" id="192807">cmd</span><span class="op" id="192810">,</span>&nbsp;<span class="op" id="192812">*</span><span class="ident" id="192813">after</span><span class="op" id="192818">,</span>&nbsp;<span class="ident" id="192820">args</span><span class="op" id="192824">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="192827">}</span><br>
<span class="lineno"></span><span class="op" id="192829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="192832">//&nbsp;Test&nbsp;that&nbsp;-help&nbsp;invokes&nbsp;the&nbsp;usage&nbsp;message&nbsp;and&nbsp;returns&nbsp;ErrHelp.</span><br>
<span class="lineno"></span><span class="keyword" id="192898">func</span>&nbsp;<span class="ident" id="192903">TestHelp</span><span class="op" id="192911">(</span><span class="ident" id="192912">t</span>&nbsp;<span class="op" id="192914">*</span><span class="ident" id="192915">testing</span><span class="op" id="192922">.</span><span class="ident" id="192923">T</span><span class="op" id="192924">)</span>&nbsp;<span class="op" id="192926">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="192929">var</span>&nbsp;<span class="ident" id="192933">helpCalled</span>&nbsp;<span class="op" id="192944">=</span>&nbsp;<span class="builtintype" id="192946">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="192953">fs</span>&nbsp;<span class="op" id="192956">:=</span>&nbsp;<span class="ident" id="192959">NewFlagSet</span><span class="op" id="192969">(</span><span class="string" id="192970">&#34;help&nbsp;test&#34;</span><span class="op" id="192981">,</span>&nbsp;<span class="ident" id="192983">ContinueOnError</span><span class="op" id="192998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193001">fs</span><span class="op" id="193003">.</span><span class="ident" id="193004">Usage</span>&nbsp;<span class="op" id="193010">=</span>&nbsp;<span class="keyword" id="193012">func</span><span class="op" id="193016">(</span><span class="op" id="193017">)</span>&nbsp;<span class="op" id="193019">{</span>&nbsp;<span class="ident" id="193021">helpCalled</span>&nbsp;<span class="op" id="193032">=</span>&nbsp;<span class="builtintype" id="193034">true</span>&nbsp;<span class="op" id="193039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="193042">var</span>&nbsp;<span class="ident" id="193046">flag</span>&nbsp;<span class="builtintype" id="193051">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193057">fs</span><span class="op" id="193059">.</span><span class="ident" id="193060">BoolVar</span><span class="op" id="193067">(</span><span class="op" id="193068">&amp;</span><span class="ident" id="193069">flag</span><span class="op" id="193073">,</span>&nbsp;<span class="string" id="193075">&#34;flag&#34;</span><span class="op" id="193081">,</span>&nbsp;<span class="builtintype" id="193083">false</span><span class="op" id="193088">,</span>&nbsp;<span class="string" id="193090">&#34;regular&nbsp;flag&#34;</span><span class="op" id="193104">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="193107">//&nbsp;Regular&nbsp;flag&nbsp;invocation&nbsp;should&nbsp;work</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193147">err</span>&nbsp;<span class="op" id="193151">:=</span>&nbsp;<span class="ident" id="193154">fs</span><span class="op" id="193156">.</span><span class="ident" id="193157">Parse</span><span class="op" id="193162">(</span><span class="op" id="193163">[</span><span class="op" id="193164">]</span><span class="builtintype" id="193165">string</span><span class="op" id="193171">{</span><span class="string" id="193172">&#34;-flag=true&#34;</span><span class="op" id="193184">}</span><span class="op" id="193185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="193188">if</span>&nbsp;<span class="ident" id="193191">err</span>&nbsp;<span class="op" id="193195">!=</span>&nbsp;<span class="ident" id="193198">nil</span>&nbsp;<span class="op" id="193202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193206">t</span><span class="op" id="193207">.</span><span class="ident" id="193208">Fatal</span><span class="op" id="193213">(</span><span class="string" id="193214">&#34;expected&nbsp;no&nbsp;error;&nbsp;got&nbsp;&#34;</span><span class="op" id="193239">,</span>&nbsp;<span class="ident" id="193241">err</span><span class="op" id="193244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="193247">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="193250">if</span>&nbsp;<span class="op" id="193253">!</span><span class="ident" id="193254">flag</span>&nbsp;<span class="op" id="193259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193263">t</span><span class="op" id="193264">.</span><span class="ident" id="193265">Error</span><span class="op" id="193270">(</span><span class="string" id="193271">&#34;flag&nbsp;was&nbsp;not&nbsp;set&nbsp;by&nbsp;-flag&#34;</span><span class="op" id="193298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="193301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="193304">if</span>&nbsp;<span class="ident" id="193307">helpCalled</span>&nbsp;<span class="op" id="193318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193322">t</span><span class="op" id="193323">.</span><span class="ident" id="193324">Error</span><span class="op" id="193329">(</span><span class="string" id="193330">&#34;help&nbsp;called&nbsp;for&nbsp;regular&nbsp;flag&#34;</span><span class="op" id="193360">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193364">helpCalled</span>&nbsp;<span class="op" id="193375">=</span>&nbsp;<span class="builtintype" id="193377">false</span>&nbsp;<span class="comment" id="193383">//&nbsp;reset&nbsp;for&nbsp;next&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="193407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="193410">//&nbsp;Help&nbsp;flag&nbsp;should&nbsp;work&nbsp;as&nbsp;expected.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193449">err</span>&nbsp;<span class="op" id="193453">=</span>&nbsp;<span class="ident" id="193455">fs</span><span class="op" id="193457">.</span><span class="ident" id="193458">Parse</span><span class="op" id="193463">(</span><span class="op" id="193464">[</span><span class="op" id="193465">]</span><span class="builtintype" id="193466">string</span><span class="op" id="193472">{</span><span class="string" id="193473">&#34;-help&#34;</span><span class="op" id="193480">}</span><span class="op" id="193481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="193484">if</span>&nbsp;<span class="ident" id="193487">err</span>&nbsp;<span class="op" id="193491">==</span>&nbsp;<span class="ident" id="193494">nil</span>&nbsp;<span class="op" id="193498">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193502">t</span><span class="op" id="193503">.</span><span class="ident" id="193504">Fatal</span><span class="op" id="193509">(</span><span class="string" id="193510">&#34;error&nbsp;expected&#34;</span><span class="op" id="193526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="193529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="193532">if</span>&nbsp;<span class="ident" id="193535">err</span>&nbsp;<span class="op" id="193539">!=</span>&nbsp;<span class="ident" id="193542">ErrHelp</span>&nbsp;<span class="op" id="193550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193554">t</span><span class="op" id="193555">.</span><span class="ident" id="193556">Fatal</span><span class="op" id="193561">(</span><span class="string" id="193562">&#34;expected&nbsp;ErrHelp;&nbsp;got&nbsp;&#34;</span><span class="op" id="193586">,</span>&nbsp;<span class="ident" id="193588">err</span><span class="op" id="193591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="193594">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="193597">if</span>&nbsp;<span class="op" id="193600">!</span><span class="ident" id="193601">helpCalled</span>&nbsp;<span class="op" id="193612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193616">t</span><span class="op" id="193617">.</span><span class="ident" id="193618">Fatal</span><span class="op" id="193623">(</span><span class="string" id="193624">&#34;help&nbsp;was&nbsp;not&nbsp;called&#34;</span><span class="op" id="193645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="193648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="193651">//&nbsp;If&nbsp;we&nbsp;define&nbsp;a&nbsp;help&nbsp;flag,&nbsp;that&nbsp;should&nbsp;override.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="193703">var</span>&nbsp;<span class="ident" id="193707">help</span>&nbsp;<span class="builtintype" id="193712">bool</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193718">fs</span><span class="op" id="193720">.</span><span class="ident" id="193721">BoolVar</span><span class="op" id="193728">(</span><span class="op" id="193729">&amp;</span><span class="ident" id="193730">help</span><span class="op" id="193734">,</span>&nbsp;<span class="string" id="193736">&#34;help&#34;</span><span class="op" id="193742">,</span>&nbsp;<span class="builtintype" id="193744">false</span><span class="op" id="193749">,</span>&nbsp;<span class="string" id="193751">&#34;help&nbsp;flag&#34;</span><span class="op" id="193762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193765">helpCalled</span>&nbsp;<span class="op" id="193776">=</span>&nbsp;<span class="builtintype" id="193778">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193785">err</span>&nbsp;<span class="op" id="193789">=</span>&nbsp;<span class="ident" id="193791">fs</span><span class="op" id="193793">.</span><span class="ident" id="193794">Parse</span><span class="op" id="193799">(</span><span class="op" id="193800">[</span><span class="op" id="193801">]</span><span class="builtintype" id="193802">string</span><span class="op" id="193808">{</span><span class="string" id="193809">&#34;-help&#34;</span><span class="op" id="193816">}</span><span class="op" id="193817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="193820">if</span>&nbsp;<span class="ident" id="193823">err</span>&nbsp;<span class="op" id="193827">!=</span>&nbsp;<span class="ident" id="193830">nil</span>&nbsp;<span class="op" id="193834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193838">t</span><span class="op" id="193839">.</span><span class="ident" id="193840">Fatal</span><span class="op" id="193845">(</span><span class="string" id="193846">&#34;expected&nbsp;no&nbsp;error&nbsp;for&nbsp;defined&nbsp;-help;&nbsp;got&nbsp;&#34;</span><span class="op" id="193889">,</span>&nbsp;<span class="ident" id="193891">err</span><span class="op" id="193894">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="193897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="193900">if</span>&nbsp;<span class="ident" id="193903">helpCalled</span>&nbsp;<span class="op" id="193914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="193918">t</span><span class="op" id="193919">.</span><span class="ident" id="193920">Fatal</span><span class="op" id="193925">(</span><span class="string" id="193926">&#34;help&nbsp;was&nbsp;called;&nbsp;should&nbsp;not&nbsp;have&nbsp;been&nbsp;for&nbsp;defined&nbsp;help&nbsp;flag&#34;</span><span class="op" id="193987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="193990">}</span><br>
<span class="lineno"></span><span class="op" id="193992">}</span>
</div>
</body>
</html>
