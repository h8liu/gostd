<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4287603">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4287658">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4287712">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4287763">package</span>&nbsp;<span class="ident" id="4287771">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4287776">import</span>&nbsp;<span class="op" id="4287783">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4287786">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4287803">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4287813">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4287816">//&nbsp;The&nbsp;DES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4287848">const</span>&nbsp;<span class="ident" id="4287854">BlockSize</span>&nbsp;<span class="op" id="4287864">=</span>&nbsp;<span class="num" id="4287866">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4287869">type</span>&nbsp;<span class="ident" id="4287874">KeySizeError</span>&nbsp;<span class="builtintype" id="4287887">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4287892">func</span>&nbsp;<span class="op" id="4287897">(</span><span class="ident" id="4287898">k</span>&nbsp;<span class="ident" id="4287900">KeySizeError</span><span class="op" id="4287912">)</span>&nbsp;<span class="ident" id="4287914">Error</span><span class="op" id="4287919">(</span><span class="op" id="4287920">)</span>&nbsp;<span class="builtintype" id="4287922">string</span>&nbsp;<span class="op" id="4287929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4287932">return</span>&nbsp;<span class="string" id="4287939">&#34;crypto/des:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="4287971">+</span>&nbsp;<span class="ident" id="4287973">strconv</span><span class="op" id="4287980">.</span><span class="ident" id="4287981">Itoa</span><span class="op" id="4287985">(</span><span class="builtintype" id="4287986">int</span><span class="op" id="4287989">(</span><span class="ident" id="4287990">k</span><span class="op" id="4287991">)</span><span class="op" id="4287992">)</span><br>
<span class="lineno"></span><span class="op" id="4287994">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4287997">//&nbsp;desCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;DES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4288044">type</span>&nbsp;<span class="ident" id="4288049">desCipher</span>&nbsp;<span class="keyword" id="4288059">struct</span>&nbsp;<span class="op" id="4288066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288069">subkeys</span>&nbsp;<span class="op" id="4288077">[</span><span class="num" id="4288078">16</span><span class="op" id="4288080">]</span><span class="ident" id="4288081">uint64</span><br>
<span class="lineno"></span><span class="op" id="4288088">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4288091">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4288144">func</span>&nbsp;<span class="ident" id="4288149">NewCipher</span><span class="op" id="4288158">(</span><span class="ident" id="4288159">key</span>&nbsp;<span class="op" id="4288163">[</span><span class="op" id="4288164">]</span><span class="builtintype" id="4288165">byte</span><span class="op" id="4288169">)</span>&nbsp;<span class="op" id="4288171">(</span><span class="ident" id="4288172">cipher</span><span class="op" id="4288178">.</span><span class="ident" id="4288179">Block</span><span class="op" id="4288184">,</span>&nbsp;<span class="builtintype" id="4288186">error</span><span class="op" id="4288191">)</span>&nbsp;<span class="op" id="4288193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288196">if</span>&nbsp;<span class="builtinfunc" id="4288199">len</span><span class="op" id="4288202">(</span><span class="ident" id="4288203">key</span><span class="op" id="4288206">)</span>&nbsp;<span class="op" id="4288208">!=</span>&nbsp;<span class="num" id="4288211">8</span>&nbsp;<span class="op" id="4288213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288217">return</span>&nbsp;<span class="ident" id="4288224">nil</span><span class="op" id="4288227">,</span>&nbsp;<span class="ident" id="4288229">KeySizeError</span><span class="op" id="4288241">(</span><span class="builtinfunc" id="4288242">len</span><span class="op" id="4288245">(</span><span class="ident" id="4288246">key</span><span class="op" id="4288249">)</span><span class="op" id="4288250">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4288253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288257">c</span>&nbsp;<span class="op" id="4288259">:=</span>&nbsp;<span class="builtinfunc" id="4288262">new</span><span class="op" id="4288265">(</span><span class="ident" id="4288266">desCipher</span><span class="op" id="4288275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288278">c</span><span class="op" id="4288279">.</span><span class="ident" id="4288280">generateSubkeys</span><span class="op" id="4288295">(</span><span class="ident" id="4288296">key</span><span class="op" id="4288299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288302">return</span>&nbsp;<span class="ident" id="4288309">c</span><span class="op" id="4288310">,</span>&nbsp;<span class="ident" id="4288312">nil</span><br>
<span class="lineno">35</span><span class="op" id="4288316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4288319">func</span>&nbsp;<span class="op" id="4288324">(</span><span class="ident" id="4288325">c</span>&nbsp;<span class="op" id="4288327">*</span><span class="ident" id="4288328">desCipher</span><span class="op" id="4288337">)</span>&nbsp;<span class="ident" id="4288339">BlockSize</span><span class="op" id="4288348">(</span><span class="op" id="4288349">)</span>&nbsp;<span class="builtintype" id="4288351">int</span>&nbsp;<span class="op" id="4288355">{</span>&nbsp;<span class="keyword" id="4288357">return</span>&nbsp;<span class="ident" id="4288364">BlockSize</span>&nbsp;<span class="op" id="4288374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4288377">func</span>&nbsp;<span class="op" id="4288382">(</span><span class="ident" id="4288383">c</span>&nbsp;<span class="op" id="4288385">*</span><span class="ident" id="4288386">desCipher</span><span class="op" id="4288395">)</span>&nbsp;<span class="ident" id="4288397">Encrypt</span><span class="op" id="4288404">(</span><span class="ident" id="4288405">dst</span><span class="op" id="4288408">,</span>&nbsp;<span class="ident" id="4288410">src</span>&nbsp;<span class="op" id="4288414">[</span><span class="op" id="4288415">]</span><span class="builtintype" id="4288416">byte</span><span class="op" id="4288420">)</span>&nbsp;<span class="op" id="4288422">{</span>&nbsp;<span class="ident" id="4288424">encryptBlock</span><span class="op" id="4288436">(</span><span class="ident" id="4288437">c</span><span class="op" id="4288438">.</span><span class="ident" id="4288439">subkeys</span><span class="op" id="4288446">[</span><span class="op" id="4288447">:</span><span class="op" id="4288448">]</span><span class="op" id="4288449">,</span>&nbsp;<span class="ident" id="4288451">dst</span><span class="op" id="4288454">,</span>&nbsp;<span class="ident" id="4288456">src</span><span class="op" id="4288459">)</span>&nbsp;<span class="op" id="4288461">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4288464">func</span>&nbsp;<span class="op" id="4288469">(</span><span class="ident" id="4288470">c</span>&nbsp;<span class="op" id="4288472">*</span><span class="ident" id="4288473">desCipher</span><span class="op" id="4288482">)</span>&nbsp;<span class="ident" id="4288484">Decrypt</span><span class="op" id="4288491">(</span><span class="ident" id="4288492">dst</span><span class="op" id="4288495">,</span>&nbsp;<span class="ident" id="4288497">src</span>&nbsp;<span class="op" id="4288501">[</span><span class="op" id="4288502">]</span><span class="builtintype" id="4288503">byte</span><span class="op" id="4288507">)</span>&nbsp;<span class="op" id="4288509">{</span>&nbsp;<span class="ident" id="4288511">decryptBlock</span><span class="op" id="4288523">(</span><span class="ident" id="4288524">c</span><span class="op" id="4288525">.</span><span class="ident" id="4288526">subkeys</span><span class="op" id="4288533">[</span><span class="op" id="4288534">:</span><span class="op" id="4288535">]</span><span class="op" id="4288536">,</span>&nbsp;<span class="ident" id="4288538">dst</span><span class="op" id="4288541">,</span>&nbsp;<span class="ident" id="4288543">src</span><span class="op" id="4288546">)</span>&nbsp;<span class="op" id="4288548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4288551">//&nbsp;A&nbsp;tripleDESCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;TripleDES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4288612">type</span>&nbsp;<span class="ident" id="4288617">tripleDESCipher</span>&nbsp;<span class="keyword" id="4288633">struct</span>&nbsp;<span class="op" id="4288640">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288643">cipher1</span><span class="op" id="4288650">,</span>&nbsp;<span class="ident" id="4288652">cipher2</span><span class="op" id="4288659">,</span>&nbsp;<span class="ident" id="4288661">cipher3</span>&nbsp;<span class="ident" id="4288669">desCipher</span><br>
<span class="lineno"></span><span class="op" id="4288679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4288682">//&nbsp;NewTripleDESCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4288744">func</span>&nbsp;<span class="ident" id="4288749">NewTripleDESCipher</span><span class="op" id="4288767">(</span><span class="ident" id="4288768">key</span>&nbsp;<span class="op" id="4288772">[</span><span class="op" id="4288773">]</span><span class="builtintype" id="4288774">byte</span><span class="op" id="4288778">)</span>&nbsp;<span class="op" id="4288780">(</span><span class="ident" id="4288781">cipher</span><span class="op" id="4288787">.</span><span class="ident" id="4288788">Block</span><span class="op" id="4288793">,</span>&nbsp;<span class="builtintype" id="4288795">error</span><span class="op" id="4288800">)</span>&nbsp;<span class="op" id="4288802">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288805">if</span>&nbsp;<span class="builtinfunc" id="4288808">len</span><span class="op" id="4288811">(</span><span class="ident" id="4288812">key</span><span class="op" id="4288815">)</span>&nbsp;<span class="op" id="4288817">!=</span>&nbsp;<span class="num" id="4288820">24</span>&nbsp;<span class="op" id="4288823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288827">return</span>&nbsp;<span class="ident" id="4288834">nil</span><span class="op" id="4288837">,</span>&nbsp;<span class="ident" id="4288839">KeySizeError</span><span class="op" id="4288851">(</span><span class="builtinfunc" id="4288852">len</span><span class="op" id="4288855">(</span><span class="ident" id="4288856">key</span><span class="op" id="4288859">)</span><span class="op" id="4288860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4288863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288867">c</span>&nbsp;<span class="op" id="4288869">:=</span>&nbsp;<span class="builtinfunc" id="4288872">new</span><span class="op" id="4288875">(</span><span class="ident" id="4288876">tripleDESCipher</span><span class="op" id="4288891">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288894">c</span><span class="op" id="4288895">.</span><span class="ident" id="4288896">cipher1</span><span class="op" id="4288903">.</span><span class="ident" id="4288904">generateSubkeys</span><span class="op" id="4288919">(</span><span class="ident" id="4288920">key</span><span class="op" id="4288923">[</span><span class="op" id="4288924">:</span><span class="num" id="4288925">8</span><span class="op" id="4288926">]</span><span class="op" id="4288927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288930">c</span><span class="op" id="4288931">.</span><span class="ident" id="4288932">cipher2</span><span class="op" id="4288939">.</span><span class="ident" id="4288940">generateSubkeys</span><span class="op" id="4288955">(</span><span class="ident" id="4288956">key</span><span class="op" id="4288959">[</span><span class="num" id="4288960">8</span><span class="op" id="4288961">:</span><span class="num" id="4288962">16</span><span class="op" id="4288964">]</span><span class="op" id="4288965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288968">c</span><span class="op" id="4288969">.</span><span class="ident" id="4288970">cipher3</span><span class="op" id="4288977">.</span><span class="ident" id="4288978">generateSubkeys</span><span class="op" id="4288993">(</span><span class="ident" id="4288994">key</span><span class="op" id="4288997">[</span><span class="num" id="4288998">16</span><span class="op" id="4289000">:</span><span class="op" id="4289001">]</span><span class="op" id="4289002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289005">return</span>&nbsp;<span class="ident" id="4289012">c</span><span class="op" id="4289013">,</span>&nbsp;<span class="ident" id="4289015">nil</span><br>
<span class="lineno"></span><span class="op" id="4289019">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4289022">func</span>&nbsp;<span class="op" id="4289027">(</span><span class="ident" id="4289028">c</span>&nbsp;<span class="op" id="4289030">*</span><span class="ident" id="4289031">tripleDESCipher</span><span class="op" id="4289046">)</span>&nbsp;<span class="ident" id="4289048">BlockSize</span><span class="op" id="4289057">(</span><span class="op" id="4289058">)</span>&nbsp;<span class="builtintype" id="4289060">int</span>&nbsp;<span class="op" id="4289064">{</span>&nbsp;<span class="keyword" id="4289066">return</span>&nbsp;<span class="ident" id="4289073">BlockSize</span>&nbsp;<span class="op" id="4289083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4289086">func</span>&nbsp;<span class="op" id="4289091">(</span><span class="ident" id="4289092">c</span>&nbsp;<span class="op" id="4289094">*</span><span class="ident" id="4289095">tripleDESCipher</span><span class="op" id="4289110">)</span>&nbsp;<span class="ident" id="4289112">Encrypt</span><span class="op" id="4289119">(</span><span class="ident" id="4289120">dst</span><span class="op" id="4289123">,</span>&nbsp;<span class="ident" id="4289125">src</span>&nbsp;<span class="op" id="4289129">[</span><span class="op" id="4289130">]</span><span class="builtintype" id="4289131">byte</span><span class="op" id="4289135">)</span>&nbsp;<span class="op" id="4289137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289140">c</span><span class="op" id="4289141">.</span><span class="ident" id="4289142">cipher1</span><span class="op" id="4289149">.</span><span class="ident" id="4289150">Encrypt</span><span class="op" id="4289157">(</span><span class="ident" id="4289158">dst</span><span class="op" id="4289161">,</span>&nbsp;<span class="ident" id="4289163">src</span><span class="op" id="4289166">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289169">c</span><span class="op" id="4289170">.</span><span class="ident" id="4289171">cipher2</span><span class="op" id="4289178">.</span><span class="ident" id="4289179">Decrypt</span><span class="op" id="4289186">(</span><span class="ident" id="4289187">dst</span><span class="op" id="4289190">,</span>&nbsp;<span class="ident" id="4289192">dst</span><span class="op" id="4289195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289198">c</span><span class="op" id="4289199">.</span><span class="ident" id="4289200">cipher3</span><span class="op" id="4289207">.</span><span class="ident" id="4289208">Encrypt</span><span class="op" id="4289215">(</span><span class="ident" id="4289216">dst</span><span class="op" id="4289219">,</span>&nbsp;<span class="ident" id="4289221">dst</span><span class="op" id="4289224">)</span><br>
<span class="lineno"></span><span class="op" id="4289226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4289229">func</span>&nbsp;<span class="op" id="4289234">(</span><span class="ident" id="4289235">c</span>&nbsp;<span class="op" id="4289237">*</span><span class="ident" id="4289238">tripleDESCipher</span><span class="op" id="4289253">)</span>&nbsp;<span class="ident" id="4289255">Decrypt</span><span class="op" id="4289262">(</span><span class="ident" id="4289263">dst</span><span class="op" id="4289266">,</span>&nbsp;<span class="ident" id="4289268">src</span>&nbsp;<span class="op" id="4289272">[</span><span class="op" id="4289273">]</span><span class="builtintype" id="4289274">byte</span><span class="op" id="4289278">)</span>&nbsp;<span class="op" id="4289280">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289283">c</span><span class="op" id="4289284">.</span><span class="ident" id="4289285">cipher3</span><span class="op" id="4289292">.</span><span class="ident" id="4289293">Decrypt</span><span class="op" id="4289300">(</span><span class="ident" id="4289301">dst</span><span class="op" id="4289304">,</span>&nbsp;<span class="ident" id="4289306">src</span><span class="op" id="4289309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289312">c</span><span class="op" id="4289313">.</span><span class="ident" id="4289314">cipher2</span><span class="op" id="4289321">.</span><span class="ident" id="4289322">Encrypt</span><span class="op" id="4289329">(</span><span class="ident" id="4289330">dst</span><span class="op" id="4289333">,</span>&nbsp;<span class="ident" id="4289335">dst</span><span class="op" id="4289338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289341">c</span><span class="op" id="4289342">.</span><span class="ident" id="4289343">cipher1</span><span class="op" id="4289350">.</span><span class="ident" id="4289351">Decrypt</span><span class="op" id="4289358">(</span><span class="ident" id="4289359">dst</span><span class="op" id="4289362">,</span>&nbsp;<span class="ident" id="4289364">dst</span><span class="op" id="4289367">)</span><br>
<span class="lineno"></span><span class="op" id="4289369">}</span>
</div>
</body>
</html>
