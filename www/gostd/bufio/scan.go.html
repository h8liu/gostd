<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bufio</h2>
<ul>
<li><a href="/gostd/bufio/bufio.go.html">bufio.go</a></li>
<li><a href="/gostd/bufio/bufio_test.go.html">bufio_test.go</a></li>
<li><a href="/gostd/bufio/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bufio/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bufio/scan.go.html">scan.go</a></li>
<li><a href="/gostd/bufio/scan_test.go.html">scan_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2934485">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2934540">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2934594">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2934645">package</span>&nbsp;<span class="ident" id="2934653">bufio</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2934660">import</span>&nbsp;<span class="op" id="2934667">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2934670">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2934679">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2934689">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2934695">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2934710">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2934713">//&nbsp;Scanner&nbsp;provides&nbsp;a&nbsp;convenient&nbsp;interface&nbsp;for&nbsp;reading&nbsp;data&nbsp;such&nbsp;as</span><br>
<span class="lineno">15</span><span class="comment" id="2934781">//&nbsp;a&nbsp;file&nbsp;of&nbsp;newline-delimited&nbsp;lines&nbsp;of&nbsp;text.&nbsp;Successive&nbsp;calls&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2934847">//&nbsp;the&nbsp;Scan&nbsp;method&nbsp;will&nbsp;step&nbsp;through&nbsp;the&nbsp;&#39;tokens&#39;&nbsp;of&nbsp;a&nbsp;file,&nbsp;skipping</span><br>
<span class="lineno"></span><span class="comment" id="2934917">//&nbsp;the&nbsp;bytes&nbsp;between&nbsp;the&nbsp;tokens.&nbsp;The&nbsp;specification&nbsp;of&nbsp;a&nbsp;token&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2934982">//&nbsp;defined&nbsp;by&nbsp;a&nbsp;split&nbsp;function&nbsp;of&nbsp;type&nbsp;SplitFunc;&nbsp;the&nbsp;default&nbsp;split</span><br>
<span class="lineno"></span><span class="comment" id="2935050">//&nbsp;function&nbsp;breaks&nbsp;the&nbsp;input&nbsp;into&nbsp;lines&nbsp;with&nbsp;line&nbsp;termination&nbsp;stripped.&nbsp;Split</span><br>
<span class="lineno">20</span><span class="comment" id="2935128">//&nbsp;functions&nbsp;are&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;for&nbsp;scanning&nbsp;a&nbsp;file&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="2935194">//&nbsp;lines,&nbsp;bytes,&nbsp;UTF-8-encoded&nbsp;runes,&nbsp;and&nbsp;space-delimited&nbsp;words.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="2935263">//&nbsp;client&nbsp;may&nbsp;instead&nbsp;provide&nbsp;a&nbsp;custom&nbsp;split&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2935318">//</span><br>
<span class="lineno"></span><span class="comment" id="2935321">//&nbsp;Scanning&nbsp;stops&nbsp;unrecoverably&nbsp;at&nbsp;EOF,&nbsp;the&nbsp;first&nbsp;I/O&nbsp;error,&nbsp;or&nbsp;a&nbsp;token&nbsp;too</span><br>
<span class="lineno">25</span><span class="comment" id="2935397">//&nbsp;large&nbsp;to&nbsp;fit&nbsp;in&nbsp;the&nbsp;buffer.&nbsp;When&nbsp;a&nbsp;scan&nbsp;stops,&nbsp;the&nbsp;reader&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2935467">//&nbsp;advanced&nbsp;arbitrarily&nbsp;far&nbsp;past&nbsp;the&nbsp;last&nbsp;token.&nbsp;Programs&nbsp;that&nbsp;need&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="2935540">//&nbsp;control&nbsp;over&nbsp;error&nbsp;handling&nbsp;or&nbsp;large&nbsp;tokens,&nbsp;or&nbsp;must&nbsp;run&nbsp;sequential&nbsp;scans</span><br>
<span class="lineno"></span><span class="comment" id="2935617">//&nbsp;on&nbsp;a&nbsp;reader,&nbsp;should&nbsp;use&nbsp;bufio.Reader&nbsp;instead.</span><br>
<span class="lineno"></span><span class="comment" id="2935666">//</span><br>
<span class="lineno">30</span><span class="keyword" id="2935669">type</span>&nbsp;<span class="ident" id="2935674">Scanner</span>&nbsp;<span class="keyword" id="2935682">struct</span>&nbsp;<span class="op" id="2935689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935692">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2935705">io</span><span class="op" id="2935707">.</span><span class="ident" id="2935708">Reader</span>&nbsp;<span class="comment" id="2935715">//&nbsp;The&nbsp;reader&nbsp;provided&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935754">split</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2935767">SplitFunc</span>&nbsp;<span class="comment" id="2935777">//&nbsp;The&nbsp;function&nbsp;to&nbsp;split&nbsp;the&nbsp;tokens.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935815">maxTokenSize</span>&nbsp;<span class="builtintype" id="2935828">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2935838">//&nbsp;Maximum&nbsp;size&nbsp;of&nbsp;a&nbsp;token;&nbsp;modified&nbsp;by&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935886">token</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2935899">[</span><span class="op" id="2935900">]</span><span class="builtintype" id="2935901">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2935909">//&nbsp;Last&nbsp;token&nbsp;returned&nbsp;by&nbsp;split.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935943">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2935956">[</span><span class="op" id="2935957">]</span><span class="builtintype" id="2935958">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2935966">//&nbsp;Buffer&nbsp;used&nbsp;as&nbsp;argument&nbsp;to&nbsp;split.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2936004">start</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2936017">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2936027">//&nbsp;First&nbsp;non-processed&nbsp;byte&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2936064">end</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2936077">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2936087">//&nbsp;End&nbsp;of&nbsp;data&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2936111">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2936124">error</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2936134">//&nbsp;Sticky&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2936152">empties</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2936165">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2936175">//&nbsp;Count&nbsp;of&nbsp;successive&nbsp;empty&nbsp;tokens.</span><br>
<span class="lineno">40</span><span class="op" id="2936212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2936215">//&nbsp;SplitFunc&nbsp;is&nbsp;the&nbsp;signature&nbsp;of&nbsp;the&nbsp;split&nbsp;function&nbsp;used&nbsp;to&nbsp;tokenize&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2936288">//&nbsp;input.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;an&nbsp;initial&nbsp;substring&nbsp;of&nbsp;the&nbsp;remaining&nbsp;unprocessed</span><br>
<span class="lineno"></span><span class="comment" id="2936366">//&nbsp;data&nbsp;and&nbsp;a&nbsp;flag,&nbsp;atEOF,&nbsp;that&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Reader&nbsp;has&nbsp;no&nbsp;more&nbsp;data</span><br>
<span class="lineno">45</span><span class="comment" id="2936442">//&nbsp;to&nbsp;give.&nbsp;The&nbsp;return&nbsp;values&nbsp;are&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;advance&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="2936517">//&nbsp;and&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;return&nbsp;to&nbsp;the&nbsp;user,&nbsp;plus&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2936592">//&nbsp;data&nbsp;does&nbsp;not&nbsp;yet&nbsp;hold&nbsp;a&nbsp;complete&nbsp;token,&nbsp;for&nbsp;instance&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="2936670">//&nbsp;while&nbsp;scanning&nbsp;lines,&nbsp;SplitFunc&nbsp;can&nbsp;return&nbsp;(0,&nbsp;nil,&nbsp;nil)&nbsp;to&nbsp;signal&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2936744">//&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;more&nbsp;data&nbsp;into&nbsp;the&nbsp;slice&nbsp;and&nbsp;try&nbsp;again&nbsp;with&nbsp;a&nbsp;longer&nbsp;slice</span><br>
<span class="lineno">50</span><span class="comment" id="2936822">//&nbsp;starting&nbsp;at&nbsp;the&nbsp;same&nbsp;point&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="2936866">//</span><br>
<span class="lineno"></span><span class="comment" id="2936869">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;error&nbsp;is&nbsp;non-nil,&nbsp;scanning&nbsp;stops&nbsp;and&nbsp;the&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2936935">//&nbsp;is&nbsp;returned&nbsp;to&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="2936965">//</span><br>
<span class="lineno">55</span><span class="comment" id="2936968">//&nbsp;The&nbsp;function&nbsp;is&nbsp;never&nbsp;called&nbsp;with&nbsp;an&nbsp;empty&nbsp;data&nbsp;slice&nbsp;unless&nbsp;atEOF</span><br>
<span class="lineno"></span><span class="comment" id="2937038">//&nbsp;is&nbsp;true.&nbsp;If&nbsp;atEOF&nbsp;is&nbsp;true,&nbsp;however,&nbsp;data&nbsp;may&nbsp;be&nbsp;non-empty&nbsp;and,</span><br>
<span class="lineno"></span><span class="comment" id="2937104">//&nbsp;as&nbsp;always,&nbsp;holds&nbsp;unprocessed&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="2937142">type</span>&nbsp;<span class="ident" id="2937147">SplitFunc</span>&nbsp;<span class="keyword" id="2937157">func</span><span class="op" id="2937161">(</span><span class="ident" id="2937162">data</span>&nbsp;<span class="op" id="2937167">[</span><span class="op" id="2937168">]</span><span class="builtintype" id="2937169">byte</span><span class="op" id="2937173">,</span>&nbsp;<span class="ident" id="2937175">atEOF</span>&nbsp;<span class="builtintype" id="2937181">bool</span><span class="op" id="2937185">)</span>&nbsp;<span class="op" id="2937187">(</span><span class="ident" id="2937188">advance</span>&nbsp;<span class="builtintype" id="2937196">int</span><span class="op" id="2937199">,</span>&nbsp;<span class="ident" id="2937201">token</span>&nbsp;<span class="op" id="2937207">[</span><span class="op" id="2937208">]</span><span class="builtintype" id="2937209">byte</span><span class="op" id="2937213">,</span>&nbsp;<span class="ident" id="2937215">err</span>&nbsp;<span class="builtintype" id="2937219">error</span><span class="op" id="2937224">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="2937227">//&nbsp;Errors&nbsp;returned&nbsp;by&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="2937258">var</span>&nbsp;<span class="op" id="2937262">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2937265">ErrTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2937284">=</span>&nbsp;<span class="ident" id="2937286">errors</span><span class="op" id="2937292">.</span><span class="ident" id="2937293">New</span><span class="op" id="2937296">(</span><span class="string" id="2937297">&#34;bufio.Scanner:&nbsp;token&nbsp;too&nbsp;long&#34;</span><span class="op" id="2937328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2937331">ErrNegativeAdvance</span>&nbsp;<span class="op" id="2937350">=</span>&nbsp;<span class="ident" id="2937352">errors</span><span class="op" id="2937358">.</span><span class="ident" id="2937359">New</span><span class="op" id="2937362">(</span><span class="string" id="2937363">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;negative&nbsp;advance&nbsp;count&#34;</span><span class="op" id="2937420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2937423">ErrAdvanceTooFar</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2937442">=</span>&nbsp;<span class="ident" id="2937444">errors</span><span class="op" id="2937450">.</span><span class="ident" id="2937451">New</span><span class="op" id="2937454">(</span><span class="string" id="2937455">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;advance&nbsp;count&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="2937516">)</span><br>
<span class="lineno">65</span><span class="op" id="2937518">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2937521">const</span>&nbsp;<span class="op" id="2937527">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2937530">//&nbsp;MaxScanTokenSize&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;used&nbsp;to&nbsp;buffer&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2937595">//&nbsp;The&nbsp;actual&nbsp;maximum&nbsp;token&nbsp;size&nbsp;may&nbsp;be&nbsp;smaller&nbsp;as&nbsp;the&nbsp;buffer</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2937658">//&nbsp;may&nbsp;need&nbsp;to&nbsp;include,&nbsp;for&nbsp;instance,&nbsp;a&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2937708">MaxScanTokenSize</span>&nbsp;<span class="op" id="2937725">=</span>&nbsp;<span class="num" id="2937727">64</span>&nbsp;<span class="op" id="2937730">*</span>&nbsp;<span class="num" id="2937732">1024</span><br>
<span class="lineno"></span><span class="op" id="2937737">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2937740">//&nbsp;NewScanner&nbsp;returns&nbsp;a&nbsp;new&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;from&nbsp;r.</span><br>
<span class="lineno">75</span><span class="comment" id="2937792">//&nbsp;The&nbsp;split&nbsp;function&nbsp;defaults&nbsp;to&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="2937837">func</span>&nbsp;<span class="ident" id="2937842">NewScanner</span><span class="op" id="2937852">(</span><span class="ident" id="2937853">r</span>&nbsp;<span class="ident" id="2937855">io</span><span class="op" id="2937857">.</span><span class="ident" id="2937858">Reader</span><span class="op" id="2937864">)</span>&nbsp;<span class="op" id="2937866">*</span><span class="ident" id="2937867">Scanner</span>&nbsp;<span class="op" id="2937875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2937878">return</span>&nbsp;<span class="op" id="2937885">&amp;</span><span class="ident" id="2937886">Scanner</span><span class="op" id="2937893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2937897">r</span><span class="op" id="2937898">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2937911">r</span><span class="op" id="2937912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2937916">split</span><span class="op" id="2937921">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2937930">ScanLines</span><span class="op" id="2937939">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2937943">maxTokenSize</span><span class="op" id="2937955">:</span>&nbsp;<span class="ident" id="2937957">MaxScanTokenSize</span><span class="op" id="2937973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2937977">buf</span><span class="op" id="2937980">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2937991">make</span><span class="op" id="2937995">(</span><span class="op" id="2937996">[</span><span class="op" id="2937997">]</span><span class="builtintype" id="2937998">byte</span><span class="op" id="2938002">,</span>&nbsp;<span class="num" id="2938004">4096</span><span class="op" id="2938008">)</span><span class="op" id="2938009">,</span>&nbsp;<span class="comment" id="2938011">//&nbsp;Plausible&nbsp;starting&nbsp;size;&nbsp;needn&#39;t&nbsp;be&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2938058">}</span><br>
<span class="lineno"></span><span class="op" id="2938060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="2938063">//&nbsp;Err&nbsp;returns&nbsp;the&nbsp;first&nbsp;non-EOF&nbsp;error&nbsp;that&nbsp;was&nbsp;encountered&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="2938139">func</span>&nbsp;<span class="op" id="2938144">(</span><span class="ident" id="2938145">s</span>&nbsp;<span class="op" id="2938147">*</span><span class="ident" id="2938148">Scanner</span><span class="op" id="2938155">)</span>&nbsp;<span class="ident" id="2938157">Err</span><span class="op" id="2938160">(</span><span class="op" id="2938161">)</span>&nbsp;<span class="builtintype" id="2938163">error</span>&nbsp;<span class="op" id="2938169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2938172">if</span>&nbsp;<span class="ident" id="2938175">s</span><span class="op" id="2938176">.</span><span class="ident" id="2938177">err</span>&nbsp;<span class="op" id="2938181">==</span>&nbsp;<span class="ident" id="2938184">io</span><span class="op" id="2938186">.</span><span class="ident" id="2938187">EOF</span>&nbsp;<span class="op" id="2938191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2938195">return</span>&nbsp;<span class="ident" id="2938202">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2938207">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2938210">return</span>&nbsp;<span class="ident" id="2938217">s</span><span class="op" id="2938218">.</span><span class="ident" id="2938219">err</span><br>
<span class="lineno"></span><span class="op" id="2938223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2938226">//&nbsp;Bytes&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan.</span><br>
<span class="lineno"></span><span class="comment" id="2938294">//&nbsp;The&nbsp;underlying&nbsp;array&nbsp;may&nbsp;point&nbsp;to&nbsp;data&nbsp;that&nbsp;will&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno">95</span><span class="comment" id="2938361">//&nbsp;by&nbsp;a&nbsp;subsequent&nbsp;call&nbsp;to&nbsp;Scan.&nbsp;It&nbsp;does&nbsp;no&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2938417">func</span>&nbsp;<span class="op" id="2938422">(</span><span class="ident" id="2938423">s</span>&nbsp;<span class="op" id="2938425">*</span><span class="ident" id="2938426">Scanner</span><span class="op" id="2938433">)</span>&nbsp;<span class="ident" id="2938435">Bytes</span><span class="op" id="2938440">(</span><span class="op" id="2938441">)</span>&nbsp;<span class="op" id="2938443">[</span><span class="op" id="2938444">]</span><span class="builtintype" id="2938445">byte</span>&nbsp;<span class="op" id="2938450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2938453">return</span>&nbsp;<span class="ident" id="2938460">s</span><span class="op" id="2938461">.</span><span class="ident" id="2938462">token</span><br>
<span class="lineno"></span><span class="op" id="2938468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="2938471">//&nbsp;Text&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan</span><br>
<span class="lineno"></span><span class="comment" id="2938537">//&nbsp;as&nbsp;a&nbsp;newly&nbsp;allocated&nbsp;string&nbsp;holding&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2938587">func</span>&nbsp;<span class="op" id="2938592">(</span><span class="ident" id="2938593">s</span>&nbsp;<span class="op" id="2938595">*</span><span class="ident" id="2938596">Scanner</span><span class="op" id="2938603">)</span>&nbsp;<span class="ident" id="2938605">Text</span><span class="op" id="2938609">(</span><span class="op" id="2938610">)</span>&nbsp;<span class="builtintype" id="2938612">string</span>&nbsp;<span class="op" id="2938619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2938622">return</span>&nbsp;<span class="builtintype" id="2938629">string</span><span class="op" id="2938635">(</span><span class="ident" id="2938636">s</span><span class="op" id="2938637">.</span><span class="ident" id="2938638">token</span><span class="op" id="2938643">)</span><br>
<span class="lineno"></span><span class="op" id="2938645">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="2938648">//&nbsp;Scan&nbsp;advances&nbsp;the&nbsp;Scanner&nbsp;to&nbsp;the&nbsp;next&nbsp;token,&nbsp;which&nbsp;will&nbsp;then&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2938715">//&nbsp;available&nbsp;through&nbsp;the&nbsp;Bytes&nbsp;or&nbsp;Text&nbsp;method.&nbsp;It&nbsp;returns&nbsp;false&nbsp;when&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2938788">//&nbsp;scan&nbsp;stops,&nbsp;either&nbsp;by&nbsp;reaching&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;or&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="2938856">//&nbsp;After&nbsp;Scan&nbsp;returns&nbsp;false,&nbsp;the&nbsp;Err&nbsp;method&nbsp;will&nbsp;return&nbsp;any&nbsp;error&nbsp;that</span><br>
<span class="lineno">110</span><span class="comment" id="2938927">//&nbsp;occurred&nbsp;during&nbsp;scanning,&nbsp;except&nbsp;that&nbsp;if&nbsp;it&nbsp;was&nbsp;io.EOF,&nbsp;Err</span><br>
<span class="lineno"></span><span class="comment" id="2938990">//&nbsp;will&nbsp;return&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="2939010">//&nbsp;Split&nbsp;panics&nbsp;if&nbsp;the&nbsp;split&nbsp;function&nbsp;returns&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="2939081">//&nbsp;advancing&nbsp;the&nbsp;input.&nbsp;This&nbsp;is&nbsp;a&nbsp;common&nbsp;error&nbsp;mode&nbsp;for&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="keyword" id="2939147">func</span>&nbsp;<span class="op" id="2939152">(</span><span class="ident" id="2939153">s</span>&nbsp;<span class="op" id="2939155">*</span><span class="ident" id="2939156">Scanner</span><span class="op" id="2939163">)</span>&nbsp;<span class="ident" id="2939165">Scan</span><span class="op" id="2939169">(</span><span class="op" id="2939170">)</span>&nbsp;<span class="builtintype" id="2939172">bool</span>&nbsp;<span class="op" id="2939177">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2939180">//&nbsp;Loop&nbsp;until&nbsp;we&nbsp;have&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939212">for</span>&nbsp;<span class="op" id="2939216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2939220">//&nbsp;See&nbsp;if&nbsp;we&nbsp;can&nbsp;get&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;already&nbsp;have.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2939278">//&nbsp;If&nbsp;we&#39;ve&nbsp;run&nbsp;out&nbsp;of&nbsp;data&nbsp;but&nbsp;have&nbsp;an&nbsp;error,&nbsp;give&nbsp;the&nbsp;split&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2939351">//&nbsp;a&nbsp;chance&nbsp;to&nbsp;recover&nbsp;any&nbsp;remaining,&nbsp;possibly&nbsp;empty&nbsp;token.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939413">if</span>&nbsp;<span class="ident" id="2939416">s</span><span class="op" id="2939417">.</span><span class="ident" id="2939418">end</span>&nbsp;<span class="op" id="2939422">&gt;</span>&nbsp;<span class="ident" id="2939424">s</span><span class="op" id="2939425">.</span><span class="ident" id="2939426">start</span>&nbsp;<span class="op" id="2939432">||</span>&nbsp;<span class="ident" id="2939435">s</span><span class="op" id="2939436">.</span><span class="ident" id="2939437">err</span>&nbsp;<span class="op" id="2939441">!=</span>&nbsp;<span class="ident" id="2939444">nil</span>&nbsp;<span class="op" id="2939448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939453">advance</span><span class="op" id="2939460">,</span>&nbsp;<span class="ident" id="2939462">token</span><span class="op" id="2939467">,</span>&nbsp;<span class="ident" id="2939469">err</span>&nbsp;<span class="op" id="2939473">:=</span>&nbsp;<span class="ident" id="2939476">s</span><span class="op" id="2939477">.</span><span class="ident" id="2939478">split</span><span class="op" id="2939483">(</span><span class="ident" id="2939484">s</span><span class="op" id="2939485">.</span><span class="ident" id="2939486">buf</span><span class="op" id="2939489">[</span><span class="ident" id="2939490">s</span><span class="op" id="2939491">.</span><span class="ident" id="2939492">start</span><span class="op" id="2939497">:</span><span class="ident" id="2939498">s</span><span class="op" id="2939499">.</span><span class="ident" id="2939500">end</span><span class="op" id="2939503">]</span><span class="op" id="2939504">,</span>&nbsp;<span class="ident" id="2939506">s</span><span class="op" id="2939507">.</span><span class="ident" id="2939508">err</span>&nbsp;<span class="op" id="2939512">!=</span>&nbsp;<span class="ident" id="2939515">nil</span><span class="op" id="2939518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939523">if</span>&nbsp;<span class="ident" id="2939526">err</span>&nbsp;<span class="op" id="2939530">!=</span>&nbsp;<span class="ident" id="2939533">nil</span>&nbsp;<span class="op" id="2939537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939543">s</span><span class="op" id="2939544">.</span><span class="ident" id="2939545">setErr</span><span class="op" id="2939551">(</span><span class="ident" id="2939552">err</span><span class="op" id="2939555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939561">return</span>&nbsp;<span class="builtintype" id="2939568">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939582">if</span>&nbsp;<span class="op" id="2939585">!</span><span class="ident" id="2939586">s</span><span class="op" id="2939587">.</span><span class="ident" id="2939588">advance</span><span class="op" id="2939595">(</span><span class="ident" id="2939596">advance</span><span class="op" id="2939603">)</span>&nbsp;<span class="op" id="2939605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939611">return</span>&nbsp;<span class="builtintype" id="2939618">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939632">s</span><span class="op" id="2939633">.</span><span class="ident" id="2939634">token</span>&nbsp;<span class="op" id="2939640">=</span>&nbsp;<span class="ident" id="2939642">token</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939651">if</span>&nbsp;<span class="ident" id="2939654">token</span>&nbsp;<span class="op" id="2939660">!=</span>&nbsp;<span class="ident" id="2939663">nil</span>&nbsp;<span class="op" id="2939667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939673">if</span>&nbsp;<span class="ident" id="2939676">s</span><span class="op" id="2939677">.</span><span class="ident" id="2939678">err</span>&nbsp;<span class="op" id="2939682">==</span>&nbsp;<span class="ident" id="2939685">nil</span>&nbsp;<span class="op" id="2939689">||</span>&nbsp;<span class="ident" id="2939692">advance</span>&nbsp;<span class="op" id="2939700">&gt;</span>&nbsp;<span class="num" id="2939702">0</span>&nbsp;<span class="op" id="2939704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939711">s</span><span class="op" id="2939712">.</span><span class="ident" id="2939713">empties</span>&nbsp;<span class="op" id="2939721">=</span>&nbsp;<span class="num" id="2939723">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939729">}</span>&nbsp;<span class="keyword" id="2939731">else</span>&nbsp;<span class="op" id="2939736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2939743">//&nbsp;Returning&nbsp;tokens&nbsp;not&nbsp;advancing&nbsp;input&nbsp;at&nbsp;EOF.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939796">s</span><span class="op" id="2939797">.</span><span class="ident" id="2939798">empties</span><span class="op" id="2939805">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939813">if</span>&nbsp;<span class="ident" id="2939816">s</span><span class="op" id="2939817">.</span><span class="ident" id="2939818">empties</span>&nbsp;<span class="op" id="2939826">&gt;</span>&nbsp;<span class="num" id="2939828">100</span>&nbsp;<span class="op" id="2939832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2939840">panic</span><span class="op" id="2939845">(</span><span class="string" id="2939846">&#34;bufio.Scan:&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without&nbsp;progressing&#34;</span><span class="op" id="2939896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939909">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939915">return</span>&nbsp;<span class="builtintype" id="2939922">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2939938">//&nbsp;We&nbsp;cannot&nbsp;generate&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;are&nbsp;holding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2939996">//&nbsp;If&nbsp;we&#39;ve&nbsp;already&nbsp;hit&nbsp;EOF&nbsp;or&nbsp;an&nbsp;I/O&nbsp;error,&nbsp;we&nbsp;are&nbsp;done.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940056">if</span>&nbsp;<span class="ident" id="2940059">s</span><span class="op" id="2940060">.</span><span class="ident" id="2940061">err</span>&nbsp;<span class="op" id="2940065">!=</span>&nbsp;<span class="ident" id="2940068">nil</span>&nbsp;<span class="op" id="2940072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2940077">//&nbsp;Shut&nbsp;it&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940097">s</span><span class="op" id="2940098">.</span><span class="ident" id="2940099">start</span>&nbsp;<span class="op" id="2940105">=</span>&nbsp;<span class="num" id="2940107">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940112">s</span><span class="op" id="2940113">.</span><span class="ident" id="2940114">end</span>&nbsp;<span class="op" id="2940118">=</span>&nbsp;<span class="num" id="2940120">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940125">return</span>&nbsp;<span class="builtintype" id="2940132">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2940140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2940144">//&nbsp;Must&nbsp;read&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2940170">//&nbsp;First,&nbsp;shift&nbsp;data&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer&nbsp;if&nbsp;there&#39;s&nbsp;lots&nbsp;of&nbsp;empty&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2940247">//&nbsp;or&nbsp;space&nbsp;is&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940272">if</span>&nbsp;<span class="ident" id="2940275">s</span><span class="op" id="2940276">.</span><span class="ident" id="2940277">start</span>&nbsp;<span class="op" id="2940283">&gt;</span>&nbsp;<span class="num" id="2940285">0</span>&nbsp;<span class="op" id="2940287">&amp;&amp;</span>&nbsp;<span class="op" id="2940290">(</span><span class="ident" id="2940291">s</span><span class="op" id="2940292">.</span><span class="ident" id="2940293">end</span>&nbsp;<span class="op" id="2940297">==</span>&nbsp;<span class="builtinfunc" id="2940300">len</span><span class="op" id="2940303">(</span><span class="ident" id="2940304">s</span><span class="op" id="2940305">.</span><span class="ident" id="2940306">buf</span><span class="op" id="2940309">)</span>&nbsp;<span class="op" id="2940311">||</span>&nbsp;<span class="ident" id="2940314">s</span><span class="op" id="2940315">.</span><span class="ident" id="2940316">start</span>&nbsp;<span class="op" id="2940322">&gt;</span>&nbsp;<span class="builtinfunc" id="2940324">len</span><span class="op" id="2940327">(</span><span class="ident" id="2940328">s</span><span class="op" id="2940329">.</span><span class="ident" id="2940330">buf</span><span class="op" id="2940333">)</span><span class="op" id="2940334">/</span><span class="num" id="2940335">2</span><span class="op" id="2940336">)</span>&nbsp;<span class="op" id="2940338">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2940343">copy</span><span class="op" id="2940347">(</span><span class="ident" id="2940348">s</span><span class="op" id="2940349">.</span><span class="ident" id="2940350">buf</span><span class="op" id="2940353">,</span>&nbsp;<span class="ident" id="2940355">s</span><span class="op" id="2940356">.</span><span class="ident" id="2940357">buf</span><span class="op" id="2940360">[</span><span class="ident" id="2940361">s</span><span class="op" id="2940362">.</span><span class="ident" id="2940363">start</span><span class="op" id="2940368">:</span><span class="ident" id="2940369">s</span><span class="op" id="2940370">.</span><span class="ident" id="2940371">end</span><span class="op" id="2940374">]</span><span class="op" id="2940375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940380">s</span><span class="op" id="2940381">.</span><span class="ident" id="2940382">end</span>&nbsp;<span class="op" id="2940386">-=</span>&nbsp;<span class="ident" id="2940389">s</span><span class="op" id="2940390">.</span><span class="ident" id="2940391">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940400">s</span><span class="op" id="2940401">.</span><span class="ident" id="2940402">start</span>&nbsp;<span class="op" id="2940408">=</span>&nbsp;<span class="num" id="2940410">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2940414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2940418">//&nbsp;Is&nbsp;the&nbsp;buffer&nbsp;full?&nbsp;If&nbsp;so,&nbsp;resize.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940458">if</span>&nbsp;<span class="ident" id="2940461">s</span><span class="op" id="2940462">.</span><span class="ident" id="2940463">end</span>&nbsp;<span class="op" id="2940467">==</span>&nbsp;<span class="builtinfunc" id="2940470">len</span><span class="op" id="2940473">(</span><span class="ident" id="2940474">s</span><span class="op" id="2940475">.</span><span class="ident" id="2940476">buf</span><span class="op" id="2940479">)</span>&nbsp;<span class="op" id="2940481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940486">if</span>&nbsp;<span class="builtinfunc" id="2940489">len</span><span class="op" id="2940492">(</span><span class="ident" id="2940493">s</span><span class="op" id="2940494">.</span><span class="ident" id="2940495">buf</span><span class="op" id="2940498">)</span>&nbsp;<span class="op" id="2940500">&gt;=</span>&nbsp;<span class="ident" id="2940503">s</span><span class="op" id="2940504">.</span><span class="ident" id="2940505">maxTokenSize</span>&nbsp;<span class="op" id="2940518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940524">s</span><span class="op" id="2940525">.</span><span class="ident" id="2940526">setErr</span><span class="op" id="2940532">(</span><span class="ident" id="2940533">ErrTooLong</span><span class="op" id="2940543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940549">return</span>&nbsp;<span class="builtintype" id="2940556">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2940565">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940570">newSize</span>&nbsp;<span class="op" id="2940578">:=</span>&nbsp;<span class="builtinfunc" id="2940581">len</span><span class="op" id="2940584">(</span><span class="ident" id="2940585">s</span><span class="op" id="2940586">.</span><span class="ident" id="2940587">buf</span><span class="op" id="2940590">)</span>&nbsp;<span class="op" id="2940592">*</span>&nbsp;<span class="num" id="2940594">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940599">if</span>&nbsp;<span class="ident" id="2940602">newSize</span>&nbsp;<span class="op" id="2940610">&gt;</span>&nbsp;<span class="ident" id="2940612">s</span><span class="op" id="2940613">.</span><span class="ident" id="2940614">maxTokenSize</span>&nbsp;<span class="op" id="2940627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940633">newSize</span>&nbsp;<span class="op" id="2940641">=</span>&nbsp;<span class="ident" id="2940643">s</span><span class="op" id="2940644">.</span><span class="ident" id="2940645">maxTokenSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2940661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940666">newBuf</span>&nbsp;<span class="op" id="2940673">:=</span>&nbsp;<span class="builtinfunc" id="2940676">make</span><span class="op" id="2940680">(</span><span class="op" id="2940681">[</span><span class="op" id="2940682">]</span><span class="builtintype" id="2940683">byte</span><span class="op" id="2940687">,</span>&nbsp;<span class="ident" id="2940689">newSize</span><span class="op" id="2940696">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2940701">copy</span><span class="op" id="2940705">(</span><span class="ident" id="2940706">newBuf</span><span class="op" id="2940712">,</span>&nbsp;<span class="ident" id="2940714">s</span><span class="op" id="2940715">.</span><span class="ident" id="2940716">buf</span><span class="op" id="2940719">[</span><span class="ident" id="2940720">s</span><span class="op" id="2940721">.</span><span class="ident" id="2940722">start</span><span class="op" id="2940727">:</span><span class="ident" id="2940728">s</span><span class="op" id="2940729">.</span><span class="ident" id="2940730">end</span><span class="op" id="2940733">]</span><span class="op" id="2940734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940739">s</span><span class="op" id="2940740">.</span><span class="ident" id="2940741">buf</span>&nbsp;<span class="op" id="2940745">=</span>&nbsp;<span class="ident" id="2940747">newBuf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940757">s</span><span class="op" id="2940758">.</span><span class="ident" id="2940759">end</span>&nbsp;<span class="op" id="2940763">-=</span>&nbsp;<span class="ident" id="2940766">s</span><span class="op" id="2940767">.</span><span class="ident" id="2940768">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940777">s</span><span class="op" id="2940778">.</span><span class="ident" id="2940779">start</span>&nbsp;<span class="op" id="2940785">=</span>&nbsp;<span class="num" id="2940787">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940792">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2940803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2940807">//&nbsp;Finally&nbsp;we&nbsp;can&nbsp;read&nbsp;some&nbsp;input.&nbsp;Make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;get&nbsp;stuck&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2940878">//&nbsp;a&nbsp;misbehaving&nbsp;Reader.&nbsp;Officially&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;do&nbsp;this,&nbsp;but&nbsp;let&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2940952">//&nbsp;be&nbsp;extra&nbsp;careful:&nbsp;Scanner&nbsp;is&nbsp;for&nbsp;safe,&nbsp;simple&nbsp;jobs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941009">for</span>&nbsp;<span class="ident" id="2941013">loop</span>&nbsp;<span class="op" id="2941018">:=</span>&nbsp;<span class="num" id="2941021">0</span><span class="op" id="2941022">;</span>&nbsp;<span class="op" id="2941024">;</span>&nbsp;<span class="op" id="2941026">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2941031">n</span><span class="op" id="2941032">,</span>&nbsp;<span class="ident" id="2941034">err</span>&nbsp;<span class="op" id="2941038">:=</span>&nbsp;<span class="ident" id="2941041">s</span><span class="op" id="2941042">.</span><span class="ident" id="2941043">r</span><span class="op" id="2941044">.</span><span class="ident" id="2941045">Read</span><span class="op" id="2941049">(</span><span class="ident" id="2941050">s</span><span class="op" id="2941051">.</span><span class="ident" id="2941052">buf</span><span class="op" id="2941055">[</span><span class="ident" id="2941056">s</span><span class="op" id="2941057">.</span><span class="ident" id="2941058">end</span><span class="op" id="2941061">:</span><span class="builtinfunc" id="2941062">len</span><span class="op" id="2941065">(</span><span class="ident" id="2941066">s</span><span class="op" id="2941067">.</span><span class="ident" id="2941068">buf</span><span class="op" id="2941071">)</span><span class="op" id="2941072">]</span><span class="op" id="2941073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2941078">s</span><span class="op" id="2941079">.</span><span class="ident" id="2941080">end</span>&nbsp;<span class="op" id="2941084">+=</span>&nbsp;<span class="ident" id="2941087">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941092">if</span>&nbsp;<span class="ident" id="2941095">err</span>&nbsp;<span class="op" id="2941099">!=</span>&nbsp;<span class="ident" id="2941102">nil</span>&nbsp;<span class="op" id="2941106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2941112">s</span><span class="op" id="2941113">.</span><span class="ident" id="2941114">setErr</span><span class="op" id="2941120">(</span><span class="ident" id="2941121">err</span><span class="op" id="2941124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941130">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2941139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941144">if</span>&nbsp;<span class="ident" id="2941147">n</span>&nbsp;<span class="op" id="2941149">&gt;</span>&nbsp;<span class="num" id="2941151">0</span>&nbsp;<span class="op" id="2941153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2941159">s</span><span class="op" id="2941160">.</span><span class="ident" id="2941161">empties</span>&nbsp;<span class="op" id="2941169">=</span>&nbsp;<span class="num" id="2941171">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941177">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2941186">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2941191">loop</span><span class="op" id="2941195">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941201">if</span>&nbsp;<span class="ident" id="2941204">loop</span>&nbsp;<span class="op" id="2941209">&gt;</span>&nbsp;<span class="ident" id="2941211">maxConsecutiveEmptyReads</span>&nbsp;<span class="op" id="2941236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2941242">s</span><span class="op" id="2941243">.</span><span class="ident" id="2941244">setErr</span><span class="op" id="2941250">(</span><span class="ident" id="2941251">io</span><span class="op" id="2941253">.</span><span class="ident" id="2941254">ErrNoProgress</span><span class="op" id="2941267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941273">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2941282">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2941286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2941289">}</span><br>
<span class="lineno"></span><span class="op" id="2941291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2941294">//&nbsp;advance&nbsp;consumes&nbsp;n&nbsp;bytes&nbsp;of&nbsp;the&nbsp;buffer.&nbsp;It&nbsp;reports&nbsp;whether&nbsp;the&nbsp;advance&nbsp;was&nbsp;legal.</span><br>
<span class="lineno">200</span><span class="keyword" id="2941379">func</span>&nbsp;<span class="op" id="2941384">(</span><span class="ident" id="2941385">s</span>&nbsp;<span class="op" id="2941387">*</span><span class="ident" id="2941388">Scanner</span><span class="op" id="2941395">)</span>&nbsp;<span class="ident" id="2941397">advance</span><span class="op" id="2941404">(</span><span class="ident" id="2941405">n</span>&nbsp;<span class="builtintype" id="2941407">int</span><span class="op" id="2941410">)</span>&nbsp;<span class="builtintype" id="2941412">bool</span>&nbsp;<span class="op" id="2941417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941420">if</span>&nbsp;<span class="ident" id="2941423">n</span>&nbsp;<span class="op" id="2941425">&lt;</span>&nbsp;<span class="num" id="2941427">0</span>&nbsp;<span class="op" id="2941429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2941433">s</span><span class="op" id="2941434">.</span><span class="ident" id="2941435">setErr</span><span class="op" id="2941441">(</span><span class="ident" id="2941442">ErrNegativeAdvance</span><span class="op" id="2941460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941464">return</span>&nbsp;<span class="builtintype" id="2941471">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2941478">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941481">if</span>&nbsp;<span class="ident" id="2941484">n</span>&nbsp;<span class="op" id="2941486">&gt;</span>&nbsp;<span class="ident" id="2941488">s</span><span class="op" id="2941489">.</span><span class="ident" id="2941490">end</span><span class="op" id="2941493">-</span><span class="ident" id="2941494">s</span><span class="op" id="2941495">.</span><span class="ident" id="2941496">start</span>&nbsp;<span class="op" id="2941502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2941506">s</span><span class="op" id="2941507">.</span><span class="ident" id="2941508">setErr</span><span class="op" id="2941514">(</span><span class="ident" id="2941515">ErrAdvanceTooFar</span><span class="op" id="2941531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941535">return</span>&nbsp;<span class="builtintype" id="2941542">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2941549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2941552">s</span><span class="op" id="2941553">.</span><span class="ident" id="2941554">start</span>&nbsp;<span class="op" id="2941560">+=</span>&nbsp;<span class="ident" id="2941563">n</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941566">return</span>&nbsp;<span class="builtintype" id="2941573">true</span><br>
<span class="lineno"></span><span class="op" id="2941578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2941581">//&nbsp;setErr&nbsp;records&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="2941628">func</span>&nbsp;<span class="op" id="2941633">(</span><span class="ident" id="2941634">s</span>&nbsp;<span class="op" id="2941636">*</span><span class="ident" id="2941637">Scanner</span><span class="op" id="2941644">)</span>&nbsp;<span class="ident" id="2941646">setErr</span><span class="op" id="2941652">(</span><span class="ident" id="2941653">err</span>&nbsp;<span class="builtintype" id="2941657">error</span><span class="op" id="2941662">)</span>&nbsp;<span class="op" id="2941664">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941667">if</span>&nbsp;<span class="ident" id="2941670">s</span><span class="op" id="2941671">.</span><span class="ident" id="2941672">err</span>&nbsp;<span class="op" id="2941676">==</span>&nbsp;<span class="ident" id="2941679">nil</span>&nbsp;<span class="op" id="2941683">||</span>&nbsp;<span class="ident" id="2941686">s</span><span class="op" id="2941687">.</span><span class="ident" id="2941688">err</span>&nbsp;<span class="op" id="2941692">==</span>&nbsp;<span class="ident" id="2941695">io</span><span class="op" id="2941697">.</span><span class="ident" id="2941698">EOF</span>&nbsp;<span class="op" id="2941702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2941706">s</span><span class="op" id="2941707">.</span><span class="ident" id="2941708">err</span>&nbsp;<span class="op" id="2941712">=</span>&nbsp;<span class="ident" id="2941714">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2941719">}</span><br>
<span class="lineno"></span><span class="op" id="2941721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2941724">//&nbsp;Split&nbsp;sets&nbsp;the&nbsp;split&nbsp;function&nbsp;for&nbsp;the&nbsp;Scanner.&nbsp;If&nbsp;called,&nbsp;it&nbsp;must&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2941796">//&nbsp;called&nbsp;before&nbsp;Scan.&nbsp;The&nbsp;default&nbsp;split&nbsp;function&nbsp;is&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="2941860">func</span>&nbsp;<span class="op" id="2941865">(</span><span class="ident" id="2941866">s</span>&nbsp;<span class="op" id="2941868">*</span><span class="ident" id="2941869">Scanner</span><span class="op" id="2941876">)</span>&nbsp;<span class="ident" id="2941878">Split</span><span class="op" id="2941883">(</span><span class="ident" id="2941884">split</span>&nbsp;<span class="ident" id="2941890">SplitFunc</span><span class="op" id="2941899">)</span>&nbsp;<span class="op" id="2941901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2941904">s</span><span class="op" id="2941905">.</span><span class="ident" id="2941906">split</span>&nbsp;<span class="op" id="2941912">=</span>&nbsp;<span class="ident" id="2941914">split</span><br>
<span class="lineno"></span><span class="op" id="2941920">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="2941923">//&nbsp;Split&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2941943">//&nbsp;ScanBytes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;byte&nbsp;as&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2942025">func</span>&nbsp;<span class="ident" id="2942030">ScanBytes</span><span class="op" id="2942039">(</span><span class="ident" id="2942040">data</span>&nbsp;<span class="op" id="2942045">[</span><span class="op" id="2942046">]</span><span class="builtintype" id="2942047">byte</span><span class="op" id="2942051">,</span>&nbsp;<span class="ident" id="2942053">atEOF</span>&nbsp;<span class="builtintype" id="2942059">bool</span><span class="op" id="2942063">)</span>&nbsp;<span class="op" id="2942065">(</span><span class="ident" id="2942066">advance</span>&nbsp;<span class="builtintype" id="2942074">int</span><span class="op" id="2942077">,</span>&nbsp;<span class="ident" id="2942079">token</span>&nbsp;<span class="op" id="2942085">[</span><span class="op" id="2942086">]</span><span class="builtintype" id="2942087">byte</span><span class="op" id="2942091">,</span>&nbsp;<span class="ident" id="2942093">err</span>&nbsp;<span class="builtintype" id="2942097">error</span><span class="op" id="2942102">)</span>&nbsp;<span class="op" id="2942104">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942107">if</span>&nbsp;<span class="ident" id="2942110">atEOF</span>&nbsp;<span class="op" id="2942116">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2942119">len</span><span class="op" id="2942122">(</span><span class="ident" id="2942123">data</span><span class="op" id="2942127">)</span>&nbsp;<span class="op" id="2942129">==</span>&nbsp;<span class="num" id="2942132">0</span>&nbsp;<span class="op" id="2942134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942138">return</span>&nbsp;<span class="num" id="2942145">0</span><span class="op" id="2942146">,</span>&nbsp;<span class="ident" id="2942148">nil</span><span class="op" id="2942151">,</span>&nbsp;<span class="ident" id="2942153">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2942158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942161">return</span>&nbsp;<span class="num" id="2942168">1</span><span class="op" id="2942169">,</span>&nbsp;<span class="ident" id="2942171">data</span><span class="op" id="2942175">[</span><span class="num" id="2942176">0</span><span class="op" id="2942177">:</span><span class="num" id="2942178">1</span><span class="op" id="2942179">]</span><span class="op" id="2942180">,</span>&nbsp;<span class="ident" id="2942182">nil</span><br>
<span class="lineno"></span><span class="op" id="2942186">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="2942189">var</span>&nbsp;<span class="ident" id="2942193">errorRune</span>&nbsp;<span class="op" id="2942203">=</span>&nbsp;<span class="op" id="2942205">[</span><span class="op" id="2942206">]</span><span class="builtintype" id="2942207">byte</span><span class="op" id="2942211">(</span><span class="builtintype" id="2942212">string</span><span class="op" id="2942218">(</span><span class="ident" id="2942219">utf8</span><span class="op" id="2942223">.</span><span class="ident" id="2942224">RuneError</span><span class="op" id="2942233">)</span><span class="op" id="2942234">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2942237">//&nbsp;ScanRunes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="2942302">//&nbsp;UTF-8-encoded&nbsp;rune&nbsp;as&nbsp;a&nbsp;token.&nbsp;The&nbsp;sequence&nbsp;of&nbsp;runes&nbsp;returned&nbsp;is</span><br>
<span class="lineno">240</span><span class="comment" id="2942370">//&nbsp;equivalent&nbsp;to&nbsp;that&nbsp;from&nbsp;a&nbsp;range&nbsp;loop&nbsp;over&nbsp;the&nbsp;input&nbsp;as&nbsp;a&nbsp;string,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2942444">//&nbsp;means&nbsp;that&nbsp;erroneous&nbsp;UTF-8&nbsp;encodings&nbsp;translate&nbsp;to&nbsp;U+FFFD&nbsp;=&nbsp;&#34;\xef\xbf\xbd&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2942522">//&nbsp;Because&nbsp;of&nbsp;the&nbsp;Scan&nbsp;interface,&nbsp;this&nbsp;makes&nbsp;it&nbsp;impossible&nbsp;for&nbsp;the&nbsp;client&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2942599">//&nbsp;distinguish&nbsp;correctly&nbsp;encoded&nbsp;replacement&nbsp;runes&nbsp;from&nbsp;encoding&nbsp;errors.</span><br>
<span class="lineno"></span><span class="keyword" id="2942672">func</span>&nbsp;<span class="ident" id="2942677">ScanRunes</span><span class="op" id="2942686">(</span><span class="ident" id="2942687">data</span>&nbsp;<span class="op" id="2942692">[</span><span class="op" id="2942693">]</span><span class="builtintype" id="2942694">byte</span><span class="op" id="2942698">,</span>&nbsp;<span class="ident" id="2942700">atEOF</span>&nbsp;<span class="builtintype" id="2942706">bool</span><span class="op" id="2942710">)</span>&nbsp;<span class="op" id="2942712">(</span><span class="ident" id="2942713">advance</span>&nbsp;<span class="builtintype" id="2942721">int</span><span class="op" id="2942724">,</span>&nbsp;<span class="ident" id="2942726">token</span>&nbsp;<span class="op" id="2942732">[</span><span class="op" id="2942733">]</span><span class="builtintype" id="2942734">byte</span><span class="op" id="2942738">,</span>&nbsp;<span class="ident" id="2942740">err</span>&nbsp;<span class="builtintype" id="2942744">error</span><span class="op" id="2942749">)</span>&nbsp;<span class="op" id="2942751">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942754">if</span>&nbsp;<span class="ident" id="2942757">atEOF</span>&nbsp;<span class="op" id="2942763">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2942766">len</span><span class="op" id="2942769">(</span><span class="ident" id="2942770">data</span><span class="op" id="2942774">)</span>&nbsp;<span class="op" id="2942776">==</span>&nbsp;<span class="num" id="2942779">0</span>&nbsp;<span class="op" id="2942781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942785">return</span>&nbsp;<span class="num" id="2942792">0</span><span class="op" id="2942793">,</span>&nbsp;<span class="ident" id="2942795">nil</span><span class="op" id="2942798">,</span>&nbsp;<span class="ident" id="2942800">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2942805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2942809">//&nbsp;Fast&nbsp;path&nbsp;1:&nbsp;ASCII.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942833">if</span>&nbsp;<span class="ident" id="2942836">data</span><span class="op" id="2942840">[</span><span class="num" id="2942841">0</span><span class="op" id="2942842">]</span>&nbsp;<span class="op" id="2942844">&lt;</span>&nbsp;<span class="ident" id="2942846">utf8</span><span class="op" id="2942850">.</span><span class="ident" id="2942851">RuneSelf</span>&nbsp;<span class="op" id="2942860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942864">return</span>&nbsp;<span class="num" id="2942871">1</span><span class="op" id="2942872">,</span>&nbsp;<span class="ident" id="2942874">data</span><span class="op" id="2942878">[</span><span class="num" id="2942879">0</span><span class="op" id="2942880">:</span><span class="num" id="2942881">1</span><span class="op" id="2942882">]</span><span class="op" id="2942883">,</span>&nbsp;<span class="ident" id="2942885">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2942890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2942894">//&nbsp;Fast&nbsp;path&nbsp;2:&nbsp;Correct&nbsp;UTF-8&nbsp;decode&nbsp;without&nbsp;error.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2942947">_</span><span class="op" id="2942948">,</span>&nbsp;<span class="ident" id="2942950">width</span>&nbsp;<span class="op" id="2942956">:=</span>&nbsp;<span class="ident" id="2942959">utf8</span><span class="op" id="2942963">.</span><span class="ident" id="2942964">DecodeRune</span><span class="op" id="2942974">(</span><span class="ident" id="2942975">data</span><span class="op" id="2942979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942982">if</span>&nbsp;<span class="ident" id="2942985">width</span>&nbsp;<span class="op" id="2942991">&gt;</span>&nbsp;<span class="num" id="2942993">1</span>&nbsp;<span class="op" id="2942995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2942999">//&nbsp;It&#39;s&nbsp;a&nbsp;valid&nbsp;encoding.&nbsp;Width&nbsp;cannot&nbsp;be&nbsp;one&nbsp;for&nbsp;a&nbsp;correctly&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2943071">//&nbsp;non-ASCII&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943092">return</span>&nbsp;<span class="ident" id="2943099">width</span><span class="op" id="2943104">,</span>&nbsp;<span class="ident" id="2943106">data</span><span class="op" id="2943110">[</span><span class="num" id="2943111">0</span><span class="op" id="2943112">:</span><span class="ident" id="2943113">width</span><span class="op" id="2943118">]</span><span class="op" id="2943119">,</span>&nbsp;<span class="ident" id="2943121">nil</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2943126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2943130">//&nbsp;We&nbsp;know&nbsp;it&#39;s&nbsp;an&nbsp;error:&nbsp;we&nbsp;have&nbsp;width==1&nbsp;and&nbsp;implicitly&nbsp;r==utf8.RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2943208">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;because&nbsp;there&nbsp;wasn&#39;t&nbsp;a&nbsp;full&nbsp;rune&nbsp;to&nbsp;be&nbsp;decoded?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2943273">//&nbsp;FullRune&nbsp;distinguishes&nbsp;correctly&nbsp;between&nbsp;erroneous&nbsp;and&nbsp;incomplete&nbsp;encodings.</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943354">if</span>&nbsp;<span class="op" id="2943357">!</span><span class="ident" id="2943358">atEOF</span>&nbsp;<span class="op" id="2943364">&amp;&amp;</span>&nbsp;<span class="op" id="2943367">!</span><span class="ident" id="2943368">utf8</span><span class="op" id="2943372">.</span><span class="ident" id="2943373">FullRune</span><span class="op" id="2943381">(</span><span class="ident" id="2943382">data</span><span class="op" id="2943386">)</span>&nbsp;<span class="op" id="2943388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2943392">//&nbsp;Incomplete;&nbsp;get&nbsp;more&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943425">return</span>&nbsp;<span class="num" id="2943432">0</span><span class="op" id="2943433">,</span>&nbsp;<span class="ident" id="2943435">nil</span><span class="op" id="2943438">,</span>&nbsp;<span class="ident" id="2943440">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2943445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2943449">//&nbsp;We&nbsp;have&nbsp;a&nbsp;real&nbsp;UTF-8&nbsp;encoding&nbsp;error.&nbsp;Return&nbsp;a&nbsp;properly&nbsp;encoded&nbsp;error&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2943527">//&nbsp;but&nbsp;advance&nbsp;only&nbsp;one&nbsp;byte.&nbsp;This&nbsp;matches&nbsp;the&nbsp;behavior&nbsp;of&nbsp;a&nbsp;range&nbsp;loop&nbsp;over</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2943605">//&nbsp;an&nbsp;incorrectly&nbsp;encoded&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943640">return</span>&nbsp;<span class="num" id="2943647">1</span><span class="op" id="2943648">,</span>&nbsp;<span class="ident" id="2943650">errorRune</span><span class="op" id="2943659">,</span>&nbsp;<span class="ident" id="2943661">nil</span><br>
<span class="lineno"></span><span class="op" id="2943665">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="2943668">//&nbsp;dropCR&nbsp;drops&nbsp;a&nbsp;terminal&nbsp;\r&nbsp;from&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="2943713">func</span>&nbsp;<span class="ident" id="2943718">dropCR</span><span class="op" id="2943724">(</span><span class="ident" id="2943725">data</span>&nbsp;<span class="op" id="2943730">[</span><span class="op" id="2943731">]</span><span class="builtintype" id="2943732">byte</span><span class="op" id="2943736">)</span>&nbsp;<span class="op" id="2943738">[</span><span class="op" id="2943739">]</span><span class="builtintype" id="2943740">byte</span>&nbsp;<span class="op" id="2943745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943748">if</span>&nbsp;<span class="builtinfunc" id="2943751">len</span><span class="op" id="2943754">(</span><span class="ident" id="2943755">data</span><span class="op" id="2943759">)</span>&nbsp;<span class="op" id="2943761">&gt;</span>&nbsp;<span class="num" id="2943763">0</span>&nbsp;<span class="op" id="2943765">&amp;&amp;</span>&nbsp;<span class="ident" id="2943768">data</span><span class="op" id="2943772">[</span><span class="builtinfunc" id="2943773">len</span><span class="op" id="2943776">(</span><span class="ident" id="2943777">data</span><span class="op" id="2943781">)</span><span class="op" id="2943782">-</span><span class="num" id="2943783">1</span><span class="op" id="2943784">]</span>&nbsp;<span class="op" id="2943786">==</span>&nbsp;<span class="string" id="2943789">&#39;\r&#39;</span>&nbsp;<span class="op" id="2943794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943798">return</span>&nbsp;<span class="ident" id="2943805">data</span><span class="op" id="2943809">[</span><span class="num" id="2943810">0</span>&nbsp;<span class="op" id="2943812">:</span>&nbsp;<span class="builtinfunc" id="2943814">len</span><span class="op" id="2943817">(</span><span class="ident" id="2943818">data</span><span class="op" id="2943822">)</span><span class="op" id="2943823">-</span><span class="num" id="2943824">1</span><span class="op" id="2943825">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2943828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943831">return</span>&nbsp;<span class="ident" id="2943838">data</span><br>
<span class="lineno"></span><span class="op" id="2943843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2943846">//&nbsp;ScanLines&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;line&nbsp;of</span><br>
<span class="lineno">285</span><span class="comment" id="2943919">//&nbsp;text,&nbsp;stripped&nbsp;of&nbsp;any&nbsp;trailing&nbsp;end-of-line&nbsp;marker.&nbsp;The&nbsp;returned&nbsp;line&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2943995">//&nbsp;be&nbsp;empty.&nbsp;The&nbsp;end-of-line&nbsp;marker&nbsp;is&nbsp;one&nbsp;optional&nbsp;carriage&nbsp;return&nbsp;followed</span><br>
<span class="lineno"></span><span class="comment" id="2944072">//&nbsp;by&nbsp;one&nbsp;mandatory&nbsp;newline.&nbsp;In&nbsp;regular&nbsp;expression&nbsp;notation,&nbsp;it&nbsp;is&nbsp;`\r?\n`.</span><br>
<span class="lineno"></span><span class="comment" id="2944148">//&nbsp;The&nbsp;last&nbsp;non-empty&nbsp;line&nbsp;of&nbsp;input&nbsp;will&nbsp;be&nbsp;returned&nbsp;even&nbsp;if&nbsp;it&nbsp;has&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="2944219">//&nbsp;newline.</span><br>
<span class="lineno">290</span><span class="keyword" id="2944231">func</span>&nbsp;<span class="ident" id="2944236">ScanLines</span><span class="op" id="2944245">(</span><span class="ident" id="2944246">data</span>&nbsp;<span class="op" id="2944251">[</span><span class="op" id="2944252">]</span><span class="builtintype" id="2944253">byte</span><span class="op" id="2944257">,</span>&nbsp;<span class="ident" id="2944259">atEOF</span>&nbsp;<span class="builtintype" id="2944265">bool</span><span class="op" id="2944269">)</span>&nbsp;<span class="op" id="2944271">(</span><span class="ident" id="2944272">advance</span>&nbsp;<span class="builtintype" id="2944280">int</span><span class="op" id="2944283">,</span>&nbsp;<span class="ident" id="2944285">token</span>&nbsp;<span class="op" id="2944291">[</span><span class="op" id="2944292">]</span><span class="builtintype" id="2944293">byte</span><span class="op" id="2944297">,</span>&nbsp;<span class="ident" id="2944299">err</span>&nbsp;<span class="builtintype" id="2944303">error</span><span class="op" id="2944308">)</span>&nbsp;<span class="op" id="2944310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944313">if</span>&nbsp;<span class="ident" id="2944316">atEOF</span>&nbsp;<span class="op" id="2944322">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2944325">len</span><span class="op" id="2944328">(</span><span class="ident" id="2944329">data</span><span class="op" id="2944333">)</span>&nbsp;<span class="op" id="2944335">==</span>&nbsp;<span class="num" id="2944338">0</span>&nbsp;<span class="op" id="2944340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944344">return</span>&nbsp;<span class="num" id="2944351">0</span><span class="op" id="2944352">,</span>&nbsp;<span class="ident" id="2944354">nil</span><span class="op" id="2944357">,</span>&nbsp;<span class="ident" id="2944359">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2944364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944367">if</span>&nbsp;<span class="ident" id="2944370">i</span>&nbsp;<span class="op" id="2944372">:=</span>&nbsp;<span class="ident" id="2944375">bytes</span><span class="op" id="2944380">.</span><span class="ident" id="2944381">IndexByte</span><span class="op" id="2944390">(</span><span class="ident" id="2944391">data</span><span class="op" id="2944395">,</span>&nbsp;<span class="string" id="2944397">&#39;\n&#39;</span><span class="op" id="2944401">)</span><span class="op" id="2944402">;</span>&nbsp;<span class="ident" id="2944404">i</span>&nbsp;<span class="op" id="2944406">&gt;=</span>&nbsp;<span class="num" id="2944409">0</span>&nbsp;<span class="op" id="2944411">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2944415">//&nbsp;We&nbsp;have&nbsp;a&nbsp;full&nbsp;newline-terminated&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944460">return</span>&nbsp;<span class="ident" id="2944467">i</span>&nbsp;<span class="op" id="2944469">+</span>&nbsp;<span class="num" id="2944471">1</span><span class="op" id="2944472">,</span>&nbsp;<span class="ident" id="2944474">dropCR</span><span class="op" id="2944480">(</span><span class="ident" id="2944481">data</span><span class="op" id="2944485">[</span><span class="num" id="2944486">0</span><span class="op" id="2944487">:</span><span class="ident" id="2944488">i</span><span class="op" id="2944489">]</span><span class="op" id="2944490">)</span><span class="op" id="2944491">,</span>&nbsp;<span class="ident" id="2944493">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2944498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2944501">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-terminated&nbsp;line.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944571">if</span>&nbsp;<span class="ident" id="2944574">atEOF</span>&nbsp;<span class="op" id="2944580">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944584">return</span>&nbsp;<span class="builtinfunc" id="2944591">len</span><span class="op" id="2944594">(</span><span class="ident" id="2944595">data</span><span class="op" id="2944599">)</span><span class="op" id="2944600">,</span>&nbsp;<span class="ident" id="2944602">dropCR</span><span class="op" id="2944608">(</span><span class="ident" id="2944609">data</span><span class="op" id="2944613">)</span><span class="op" id="2944614">,</span>&nbsp;<span class="ident" id="2944616">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2944621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2944624">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944647">return</span>&nbsp;<span class="num" id="2944654">0</span><span class="op" id="2944655">,</span>&nbsp;<span class="ident" id="2944657">nil</span><span class="op" id="2944660">,</span>&nbsp;<span class="ident" id="2944662">nil</span><br>
<span class="lineno"></span><span class="op" id="2944666">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="comment" id="2944669">//&nbsp;isSpace&nbsp;reports&nbsp;whether&nbsp;the&nbsp;character&nbsp;is&nbsp;a&nbsp;Unicode&nbsp;white&nbsp;space&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="2944746">//&nbsp;We&nbsp;avoid&nbsp;dependency&nbsp;on&nbsp;the&nbsp;unicode&nbsp;package,&nbsp;but&nbsp;check&nbsp;validity&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="2944834">//&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="2944851">func</span>&nbsp;<span class="ident" id="2944856">isSpace</span><span class="op" id="2944863">(</span><span class="ident" id="2944864">r</span>&nbsp;<span class="builtintype" id="2944866">rune</span><span class="op" id="2944870">)</span>&nbsp;<span class="builtintype" id="2944872">bool</span>&nbsp;<span class="op" id="2944877">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944880">if</span>&nbsp;<span class="ident" id="2944883">r</span>&nbsp;<span class="op" id="2944885">&lt;=</span>&nbsp;<span class="string" id="2944888">&#39;\u00FF&#39;</span>&nbsp;<span class="op" id="2944897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2944901">//&nbsp;Obvious&nbsp;ASCII&nbsp;ones:&nbsp;\t&nbsp;through&nbsp;\r&nbsp;plus&nbsp;space.&nbsp;Plus&nbsp;two&nbsp;Latin-1&nbsp;oddballs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944979">switch</span>&nbsp;<span class="ident" id="2944986">r</span>&nbsp;<span class="op" id="2944988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944992">case</span>&nbsp;<span class="string" id="2944997">&#39;&nbsp;&#39;</span><span class="op" id="2945000">,</span>&nbsp;<span class="string" id="2945002">&#39;\t&#39;</span><span class="op" id="2945006">,</span>&nbsp;<span class="string" id="2945008">&#39;\n&#39;</span><span class="op" id="2945012">,</span>&nbsp;<span class="string" id="2945014">&#39;\v&#39;</span><span class="op" id="2945018">,</span>&nbsp;<span class="string" id="2945020">&#39;\f&#39;</span><span class="op" id="2945024">,</span>&nbsp;<span class="string" id="2945026">&#39;\r&#39;</span><span class="op" id="2945030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945035">return</span>&nbsp;<span class="builtintype" id="2945042">true</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945049">case</span>&nbsp;<span class="string" id="2945054">&#39;\u0085&#39;</span><span class="op" id="2945062">,</span>&nbsp;<span class="string" id="2945064">&#39;\u00A0&#39;</span><span class="op" id="2945072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945077">return</span>&nbsp;<span class="builtintype" id="2945084">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2945091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945095">return</span>&nbsp;<span class="builtintype" id="2945102">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2945109">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2945112">//&nbsp;High-valued&nbsp;ones.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945134">if</span>&nbsp;<span class="string" id="2945137">&#39;\u2000&#39;</span>&nbsp;<span class="op" id="2945146">&lt;=</span>&nbsp;<span class="ident" id="2945149">r</span>&nbsp;<span class="op" id="2945151">&amp;&amp;</span>&nbsp;<span class="ident" id="2945154">r</span>&nbsp;<span class="op" id="2945156">&lt;=</span>&nbsp;<span class="string" id="2945159">&#39;\u200a&#39;</span>&nbsp;<span class="op" id="2945168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945172">return</span>&nbsp;<span class="builtintype" id="2945179">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2945185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945188">switch</span>&nbsp;<span class="ident" id="2945195">r</span>&nbsp;<span class="op" id="2945197">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945200">case</span>&nbsp;<span class="string" id="2945205">&#39;\u1680&#39;</span><span class="op" id="2945213">,</span>&nbsp;<span class="string" id="2945215">&#39;\u2028&#39;</span><span class="op" id="2945223">,</span>&nbsp;<span class="string" id="2945225">&#39;\u2029&#39;</span><span class="op" id="2945233">,</span>&nbsp;<span class="string" id="2945235">&#39;\u202f&#39;</span><span class="op" id="2945243">,</span>&nbsp;<span class="string" id="2945245">&#39;\u205f&#39;</span><span class="op" id="2945253">,</span>&nbsp;<span class="string" id="2945255">&#39;\u3000&#39;</span><span class="op" id="2945263">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945267">return</span>&nbsp;<span class="builtintype" id="2945274">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2945280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945283">return</span>&nbsp;<span class="builtintype" id="2945290">false</span><br>
<span class="lineno"></span><span class="op" id="2945296">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="2945299">//&nbsp;ScanWords&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="2945364">//&nbsp;space-separated&nbsp;word&nbsp;of&nbsp;text,&nbsp;with&nbsp;surrounding&nbsp;spaces&nbsp;deleted.&nbsp;It&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="2945438">//&nbsp;never&nbsp;return&nbsp;an&nbsp;empty&nbsp;string.&nbsp;The&nbsp;definition&nbsp;of&nbsp;space&nbsp;is&nbsp;set&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2945505">//&nbsp;unicode.IsSpace.</span><br>
<span class="lineno">335</span><span class="keyword" id="2945525">func</span>&nbsp;<span class="ident" id="2945530">ScanWords</span><span class="op" id="2945539">(</span><span class="ident" id="2945540">data</span>&nbsp;<span class="op" id="2945545">[</span><span class="op" id="2945546">]</span><span class="builtintype" id="2945547">byte</span><span class="op" id="2945551">,</span>&nbsp;<span class="ident" id="2945553">atEOF</span>&nbsp;<span class="builtintype" id="2945559">bool</span><span class="op" id="2945563">)</span>&nbsp;<span class="op" id="2945565">(</span><span class="ident" id="2945566">advance</span>&nbsp;<span class="builtintype" id="2945574">int</span><span class="op" id="2945577">,</span>&nbsp;<span class="ident" id="2945579">token</span>&nbsp;<span class="op" id="2945585">[</span><span class="op" id="2945586">]</span><span class="builtintype" id="2945587">byte</span><span class="op" id="2945591">,</span>&nbsp;<span class="ident" id="2945593">err</span>&nbsp;<span class="builtintype" id="2945597">error</span><span class="op" id="2945602">)</span>&nbsp;<span class="op" id="2945604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2945607">//&nbsp;Skip&nbsp;leading&nbsp;spaces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2945632">start</span>&nbsp;<span class="op" id="2945638">:=</span>&nbsp;<span class="num" id="2945641">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945644">for</span>&nbsp;<span class="ident" id="2945648">width</span>&nbsp;<span class="op" id="2945654">:=</span>&nbsp;<span class="num" id="2945657">0</span><span class="op" id="2945658">;</span>&nbsp;<span class="ident" id="2945660">start</span>&nbsp;<span class="op" id="2945666">&lt;</span>&nbsp;<span class="builtinfunc" id="2945668">len</span><span class="op" id="2945671">(</span><span class="ident" id="2945672">data</span><span class="op" id="2945676">)</span><span class="op" id="2945677">;</span>&nbsp;<span class="ident" id="2945679">start</span>&nbsp;<span class="op" id="2945685">+=</span>&nbsp;<span class="ident" id="2945688">width</span>&nbsp;<span class="op" id="2945694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945698">var</span>&nbsp;<span class="ident" id="2945702">r</span>&nbsp;<span class="builtintype" id="2945704">rune</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2945711">r</span><span class="op" id="2945712">,</span>&nbsp;<span class="ident" id="2945714">width</span>&nbsp;<span class="op" id="2945720">=</span>&nbsp;<span class="ident" id="2945722">utf8</span><span class="op" id="2945726">.</span><span class="ident" id="2945727">DecodeRune</span><span class="op" id="2945737">(</span><span class="ident" id="2945738">data</span><span class="op" id="2945742">[</span><span class="ident" id="2945743">start</span><span class="op" id="2945748">:</span><span class="op" id="2945749">]</span><span class="op" id="2945750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945754">if</span>&nbsp;<span class="op" id="2945757">!</span><span class="ident" id="2945758">isSpace</span><span class="op" id="2945765">(</span><span class="ident" id="2945766">r</span><span class="op" id="2945767">)</span>&nbsp;<span class="op" id="2945769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945774">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2945782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2945785">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2945788">//&nbsp;Scan&nbsp;until&nbsp;space,&nbsp;marking&nbsp;end&nbsp;of&nbsp;word.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945831">for</span>&nbsp;<span class="ident" id="2945835">width</span><span class="op" id="2945840">,</span>&nbsp;<span class="ident" id="2945842">i</span>&nbsp;<span class="op" id="2945844">:=</span>&nbsp;<span class="num" id="2945847">0</span><span class="op" id="2945848">,</span>&nbsp;<span class="ident" id="2945850">start</span><span class="op" id="2945855">;</span>&nbsp;<span class="ident" id="2945857">i</span>&nbsp;<span class="op" id="2945859">&lt;</span>&nbsp;<span class="builtinfunc" id="2945861">len</span><span class="op" id="2945864">(</span><span class="ident" id="2945865">data</span><span class="op" id="2945869">)</span><span class="op" id="2945870">;</span>&nbsp;<span class="ident" id="2945872">i</span>&nbsp;<span class="op" id="2945874">+=</span>&nbsp;<span class="ident" id="2945877">width</span>&nbsp;<span class="op" id="2945883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945887">var</span>&nbsp;<span class="ident" id="2945891">r</span>&nbsp;<span class="builtintype" id="2945893">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2945900">r</span><span class="op" id="2945901">,</span>&nbsp;<span class="ident" id="2945903">width</span>&nbsp;<span class="op" id="2945909">=</span>&nbsp;<span class="ident" id="2945911">utf8</span><span class="op" id="2945915">.</span><span class="ident" id="2945916">DecodeRune</span><span class="op" id="2945926">(</span><span class="ident" id="2945927">data</span><span class="op" id="2945931">[</span><span class="ident" id="2945932">i</span><span class="op" id="2945933">:</span><span class="op" id="2945934">]</span><span class="op" id="2945935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945939">if</span>&nbsp;<span class="ident" id="2945942">isSpace</span><span class="op" id="2945949">(</span><span class="ident" id="2945950">r</span><span class="op" id="2945951">)</span>&nbsp;<span class="op" id="2945953">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2945958">return</span>&nbsp;<span class="ident" id="2945965">i</span>&nbsp;<span class="op" id="2945967">+</span>&nbsp;<span class="ident" id="2945969">width</span><span class="op" id="2945974">,</span>&nbsp;<span class="ident" id="2945976">data</span><span class="op" id="2945980">[</span><span class="ident" id="2945981">start</span><span class="op" id="2945986">:</span><span class="ident" id="2945987">i</span><span class="op" id="2945988">]</span><span class="op" id="2945989">,</span>&nbsp;<span class="ident" id="2945991">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2945997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2946000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2946003">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-empty,&nbsp;non-terminated&nbsp;word.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2946084">if</span>&nbsp;<span class="ident" id="2946087">atEOF</span>&nbsp;<span class="op" id="2946093">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2946096">len</span><span class="op" id="2946099">(</span><span class="ident" id="2946100">data</span><span class="op" id="2946104">)</span>&nbsp;<span class="op" id="2946106">&gt;</span>&nbsp;<span class="ident" id="2946108">start</span>&nbsp;<span class="op" id="2946114">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2946118">return</span>&nbsp;<span class="builtinfunc" id="2946125">len</span><span class="op" id="2946128">(</span><span class="ident" id="2946129">data</span><span class="op" id="2946133">)</span><span class="op" id="2946134">,</span>&nbsp;<span class="ident" id="2946136">data</span><span class="op" id="2946140">[</span><span class="ident" id="2946141">start</span><span class="op" id="2946146">:</span><span class="op" id="2946147">]</span><span class="op" id="2946148">,</span>&nbsp;<span class="ident" id="2946150">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2946155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2946158">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2946181">return</span>&nbsp;<span class="ident" id="2946188">start</span><span class="op" id="2946193">,</span>&nbsp;<span class="ident" id="2946195">nil</span><span class="op" id="2946198">,</span>&nbsp;<span class="ident" id="2946200">nil</span><br>
<span class="lineno"></span><span class="op" id="2946204">}</span>
</div>
</body>
</html>
