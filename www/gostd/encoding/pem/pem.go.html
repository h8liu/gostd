<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/pem</h2>
<ul>
<li><a href="/gostd/encoding/pem/pem.go.html" class="current">pem.go</a></li>
<li><a href="/gostd/encoding/pem/pem_test.go.html">pem_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4703052">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4703107">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4703161">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4703212">//&nbsp;Package&nbsp;pem&nbsp;implements&nbsp;the&nbsp;PEM&nbsp;data&nbsp;encoding,&nbsp;which&nbsp;originated&nbsp;in&nbsp;Privacy</span><br>
<span class="lineno"></span><span class="comment" id="4703289">//&nbsp;Enhanced&nbsp;Mail.&nbsp;The&nbsp;most&nbsp;common&nbsp;use&nbsp;of&nbsp;PEM&nbsp;encoding&nbsp;today&nbsp;is&nbsp;in&nbsp;TLS&nbsp;keys&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4703368">//&nbsp;certificates.&nbsp;See&nbsp;RFC&nbsp;1421.</span><br>
<span class="lineno"></span><span class="keyword" id="4703399">package</span>&nbsp;<span class="ident" id="4703407">pem</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4703412">import</span>&nbsp;<span class="op" id="4703419">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4703422">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4703431">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4703450">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4703456">&#34;sort&#34;</span><br>
<span class="lineno">15</span><span class="op" id="4703463">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4703466">//&nbsp;A&nbsp;Block&nbsp;represents&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="4703513">//</span><br>
<span class="lineno"></span><span class="comment" id="4703516">//&nbsp;The&nbsp;encoded&nbsp;form&nbsp;is:</span><br>
<span class="lineno">20</span><span class="comment" id="4703540">//&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;Type-----</span><br>
<span class="lineno"></span><span class="comment" id="4703567">//&nbsp;&nbsp;&nbsp;&nbsp;Headers</span><br>
<span class="lineno"></span><span class="comment" id="4703581">//&nbsp;&nbsp;&nbsp;&nbsp;base64-encoded&nbsp;Bytes</span><br>
<span class="lineno"></span><span class="comment" id="4703608">//&nbsp;&nbsp;&nbsp;&nbsp;-----END&nbsp;Type-----</span><br>
<span class="lineno"></span><span class="comment" id="4703633">//&nbsp;where&nbsp;Headers&nbsp;is&nbsp;a&nbsp;possibly&nbsp;empty&nbsp;sequence&nbsp;of&nbsp;Key:&nbsp;Value&nbsp;lines.</span><br>
<span class="lineno">25</span><span class="keyword" id="4703700">type</span>&nbsp;<span class="ident" id="4703705">Block</span>&nbsp;<span class="keyword" id="4703711">struct</span>&nbsp;<span class="op" id="4703718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4703721">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4703729">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4703747">//&nbsp;The&nbsp;type,&nbsp;taken&nbsp;from&nbsp;the&nbsp;preamble&nbsp;(i.e.&nbsp;&#34;RSA&nbsp;PRIVATE&nbsp;KEY&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4703811">Headers</span>&nbsp;<span class="keyword" id="4703819">map</span><span class="op" id="4703822">[</span><span class="builtintype" id="4703823">string</span><span class="op" id="4703829">]</span><span class="builtintype" id="4703830">string</span>&nbsp;<span class="comment" id="4703837">//&nbsp;Optional&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4703859">Bytes</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4703867">[</span><span class="op" id="4703868">]</span><span class="builtintype" id="4703869">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4703885">//&nbsp;The&nbsp;decoded&nbsp;bytes&nbsp;of&nbsp;the&nbsp;contents.&nbsp;Typically&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;ASN.1&nbsp;structure.</span><br>
<span class="lineno"></span><span class="op" id="4703964">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4703967">//&nbsp;getLine&nbsp;results&nbsp;the&nbsp;first&nbsp;\r\n&nbsp;or&nbsp;\n&nbsp;delineated&nbsp;line&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4704043">//&nbsp;array.&nbsp;The&nbsp;line&nbsp;does&nbsp;not&nbsp;include&nbsp;trailing&nbsp;whitespace&nbsp;or&nbsp;the&nbsp;trailing&nbsp;new</span><br>
<span class="lineno"></span><span class="comment" id="4704119">//&nbsp;line&nbsp;bytes.&nbsp;The&nbsp;remainder&nbsp;of&nbsp;the&nbsp;byte&nbsp;array&nbsp;(also&nbsp;not&nbsp;including&nbsp;the&nbsp;new&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="4704199">//&nbsp;bytes)&nbsp;is&nbsp;also&nbsp;returned&nbsp;and&nbsp;this&nbsp;will&nbsp;always&nbsp;be&nbsp;smaller&nbsp;than&nbsp;the&nbsp;original</span><br>
<span class="lineno">35</span><span class="comment" id="4704276">//&nbsp;argument.</span><br>
<span class="lineno"></span><span class="keyword" id="4704289">func</span>&nbsp;<span class="ident" id="4704294">getLine</span><span class="op" id="4704301">(</span><span class="ident" id="4704302">data</span>&nbsp;<span class="op" id="4704307">[</span><span class="op" id="4704308">]</span><span class="builtintype" id="4704309">byte</span><span class="op" id="4704313">)</span>&nbsp;<span class="op" id="4704315">(</span><span class="ident" id="4704316">line</span><span class="op" id="4704320">,</span>&nbsp;<span class="ident" id="4704322">rest</span>&nbsp;<span class="op" id="4704327">[</span><span class="op" id="4704328">]</span><span class="builtintype" id="4704329">byte</span><span class="op" id="4704333">)</span>&nbsp;<span class="op" id="4704335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704338">i</span>&nbsp;<span class="op" id="4704340">:=</span>&nbsp;<span class="ident" id="4704343"><a href="/gostd/encoding/pem/pem.go.html#4703422">bytes</a></span><span class="op" id="4704348">.</span><span class="ident" id="4704349"><a href="/gostd/bytes/bytes.go.html#1397659">Index</a></span><span class="op" id="4704354">(</span><span class="ident" id="4704355"><a href="/gostd/encoding/pem/pem.go.html#4704302">data</a></span><span class="op" id="4704359">,</span>&nbsp;<span class="op" id="4704361">[</span><span class="op" id="4704362">]</span><span class="builtintype" id="4704363">byte</span><span class="op" id="4704367">{</span><span class="string" id="4704368">&#39;\n&#39;</span><span class="op" id="4704372">}</span><span class="op" id="4704373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704376">var</span>&nbsp;<span class="ident" id="4704380">j</span>&nbsp;<span class="builtintype" id="4704382">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704387">if</span>&nbsp;<span class="ident" id="4704390"><a href="/gostd/encoding/pem/pem.go.html#4704338">i</a></span>&nbsp;<span class="op" id="4704392">&lt;</span>&nbsp;<span class="num" id="4704394">0</span>&nbsp;<span class="op" id="4704396">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704400"><a href="/gostd/encoding/pem/pem.go.html#4704338">i</a></span>&nbsp;<span class="op" id="4704402">=</span>&nbsp;<span class="builtinfunc" id="4704404">len</span><span class="op" id="4704407">(</span><span class="ident" id="4704408"><a href="/gostd/encoding/pem/pem.go.html#4704302">data</a></span><span class="op" id="4704412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704416"><a href="/gostd/encoding/pem/pem.go.html#4704380">j</a></span>&nbsp;<span class="op" id="4704418">=</span>&nbsp;<span class="ident" id="4704420"><a href="/gostd/encoding/pem/pem.go.html#4704338">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4704423">}</span>&nbsp;<span class="keyword" id="4704425">else</span>&nbsp;<span class="op" id="4704430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704434"><a href="/gostd/encoding/pem/pem.go.html#4704380">j</a></span>&nbsp;<span class="op" id="4704436">=</span>&nbsp;<span class="ident" id="4704438"><a href="/gostd/encoding/pem/pem.go.html#4704338">i</a></span>&nbsp;<span class="op" id="4704440">+</span>&nbsp;<span class="num" id="4704442">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704446">if</span>&nbsp;<span class="ident" id="4704449"><a href="/gostd/encoding/pem/pem.go.html#4704338">i</a></span>&nbsp;<span class="op" id="4704451">&gt;</span>&nbsp;<span class="num" id="4704453">0</span>&nbsp;<span class="op" id="4704455">&amp;&amp;</span>&nbsp;<span class="ident" id="4704458"><a href="/gostd/encoding/pem/pem.go.html#4704302">data</a></span><span class="op" id="4704462">[</span><span class="ident" id="4704463"><a href="/gostd/encoding/pem/pem.go.html#4704338">i</a></span><span class="op" id="4704464">-</span><span class="num" id="4704465">1</span><span class="op" id="4704466">]</span>&nbsp;<span class="op" id="4704468">==</span>&nbsp;<span class="string" id="4704471">&#39;\r&#39;</span>&nbsp;<span class="op" id="4704476">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704481"><a href="/gostd/encoding/pem/pem.go.html#4704338">i</a></span><span class="op" id="4704482">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4704487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4704490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704493">return</span>&nbsp;<span class="ident" id="4704500"><a href="/gostd/encoding/pem/pem.go.html#4703422">bytes</a></span><span class="op" id="4704505">.</span><span class="ident" id="4704506"><a href="/gostd/bytes/bytes.go.html#1411590">TrimRight</a></span><span class="op" id="4704515">(</span><span class="ident" id="4704516"><a href="/gostd/encoding/pem/pem.go.html#4704302">data</a></span><span class="op" id="4704520">[</span><span class="num" id="4704521">0</span><span class="op" id="4704522">:</span><span class="ident" id="4704523"><a href="/gostd/encoding/pem/pem.go.html#4704338">i</a></span><span class="op" id="4704524">]</span><span class="op" id="4704525">,</span>&nbsp;<span class="string" id="4704527">&#34;&nbsp;\t&#34;</span><span class="op" id="4704532">)</span><span class="op" id="4704533">,</span>&nbsp;<span class="ident" id="4704535"><a href="/gostd/encoding/pem/pem.go.html#4704302">data</a></span><span class="op" id="4704539">[</span><span class="ident" id="4704540"><a href="/gostd/encoding/pem/pem.go.html#4704380">j</a></span><span class="op" id="4704541">:</span><span class="op" id="4704542">]</span><br>
<span class="lineno"></span><span class="op" id="4704544">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="4704547">//&nbsp;removeWhitespace&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;its&nbsp;input&nbsp;with&nbsp;all&nbsp;spaces,&nbsp;tab&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4704620">//&nbsp;newline&nbsp;characters&nbsp;removed.</span><br>
<span class="lineno"></span><span class="keyword" id="4704651">func</span>&nbsp;<span class="ident" id="4704656">removeWhitespace</span><span class="op" id="4704672">(</span><span class="ident" id="4704673">data</span>&nbsp;<span class="op" id="4704678">[</span><span class="op" id="4704679">]</span><span class="builtintype" id="4704680">byte</span><span class="op" id="4704684">)</span>&nbsp;<span class="op" id="4704686">[</span><span class="op" id="4704687">]</span><span class="builtintype" id="4704688">byte</span>&nbsp;<span class="op" id="4704693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704696">result</span>&nbsp;<span class="op" id="4704703">:=</span>&nbsp;<span class="builtinfunc" id="4704706">make</span><span class="op" id="4704710">(</span><span class="op" id="4704711">[</span><span class="op" id="4704712">]</span><span class="builtintype" id="4704713">byte</span><span class="op" id="4704717">,</span>&nbsp;<span class="builtinfunc" id="4704719">len</span><span class="op" id="4704722">(</span><span class="ident" id="4704723"><a href="/gostd/encoding/pem/pem.go.html#4704673">data</a></span><span class="op" id="4704727">)</span><span class="op" id="4704728">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704731">n</span>&nbsp;<span class="op" id="4704733">:=</span>&nbsp;<span class="num" id="4704736">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704740">for</span>&nbsp;<span class="ident" id="4704744">_</span><span class="op" id="4704745">,</span>&nbsp;<span class="ident" id="4704747">b</span>&nbsp;<span class="op" id="4704749">:=</span>&nbsp;<span class="keyword" id="4704752">range</span>&nbsp;<span class="ident" id="4704758"><a href="/gostd/encoding/pem/pem.go.html#4704673">data</a></span>&nbsp;<span class="op" id="4704763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704767">if</span>&nbsp;<span class="ident" id="4704770"><a href="/gostd/encoding/pem/pem.go.html#4704747">b</a></span>&nbsp;<span class="op" id="4704772">==</span>&nbsp;<span class="string" id="4704775">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4704779">||</span>&nbsp;<span class="ident" id="4704782"><a href="/gostd/encoding/pem/pem.go.html#4704747">b</a></span>&nbsp;<span class="op" id="4704784">==</span>&nbsp;<span class="string" id="4704787">&#39;\t&#39;</span>&nbsp;<span class="op" id="4704792">||</span>&nbsp;<span class="ident" id="4704795"><a href="/gostd/encoding/pem/pem.go.html#4704747">b</a></span>&nbsp;<span class="op" id="4704797">==</span>&nbsp;<span class="string" id="4704800">&#39;\r&#39;</span>&nbsp;<span class="op" id="4704805">||</span>&nbsp;<span class="ident" id="4704808"><a href="/gostd/encoding/pem/pem.go.html#4704747">b</a></span>&nbsp;<span class="op" id="4704810">==</span>&nbsp;<span class="string" id="4704813">&#39;\n&#39;</span>&nbsp;<span class="op" id="4704818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704823">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4704834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704838"><a href="/gostd/encoding/pem/pem.go.html#4704696">result</a></span><span class="op" id="4704844">[</span><span class="ident" id="4704845"><a href="/gostd/encoding/pem/pem.go.html#4704731">n</a></span><span class="op" id="4704846">]</span>&nbsp;<span class="op" id="4704848">=</span>&nbsp;<span class="ident" id="4704850"><a href="/gostd/encoding/pem/pem.go.html#4704747">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704854"><a href="/gostd/encoding/pem/pem.go.html#4704731">n</a></span><span class="op" id="4704855">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4704859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704863">return</span>&nbsp;<span class="ident" id="4704870"><a href="/gostd/encoding/pem/pem.go.html#4704696">result</a></span><span class="op" id="4704876">[</span><span class="num" id="4704877">0</span><span class="op" id="4704878">:</span><span class="ident" id="4704879"><a href="/gostd/encoding/pem/pem.go.html#4704731">n</a></span><span class="op" id="4704880">]</span><br>
<span class="lineno"></span><span class="op" id="4704882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4704885">var</span>&nbsp;<span class="ident" id="4704889">pemStart</span>&nbsp;<span class="op" id="4704898">=</span>&nbsp;<span class="op" id="4704900">[</span><span class="op" id="4704901">]</span><span class="builtintype" id="4704902">byte</span><span class="op" id="4704906">(</span><span class="string" id="4704907">&#34;\n-----BEGIN&nbsp;&#34;</span><span class="op" id="4704922">)</span><br>
<span class="lineno"></span><span class="keyword" id="4704924">var</span>&nbsp;<span class="ident" id="4704928">pemEnd</span>&nbsp;<span class="op" id="4704935">=</span>&nbsp;<span class="op" id="4704937">[</span><span class="op" id="4704938">]</span><span class="builtintype" id="4704939">byte</span><span class="op" id="4704943">(</span><span class="string" id="4704944">&#34;\n-----END&nbsp;&#34;</span><span class="op" id="4704957">)</span><br>
<span class="lineno">70</span><span class="keyword" id="4704959">var</span>&nbsp;<span class="ident" id="4704963">pemEndOfLine</span>&nbsp;<span class="op" id="4704976">=</span>&nbsp;<span class="op" id="4704978">[</span><span class="op" id="4704979">]</span><span class="builtintype" id="4704980">byte</span><span class="op" id="4704984">(</span><span class="string" id="4704985">&#34;-----&#34;</span><span class="op" id="4704992">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4704995">//&nbsp;Decode&nbsp;will&nbsp;find&nbsp;the&nbsp;next&nbsp;PEM&nbsp;formatted&nbsp;block&nbsp;(certificate,&nbsp;private&nbsp;key</span><br>
<span class="lineno"></span><span class="comment" id="4705070">//&nbsp;etc)&nbsp;in&nbsp;the&nbsp;input.&nbsp;It&nbsp;returns&nbsp;that&nbsp;block&nbsp;and&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;input.&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="4705149">//&nbsp;no&nbsp;PEM&nbsp;data&nbsp;is&nbsp;found,&nbsp;p&nbsp;is&nbsp;nil&nbsp;and&nbsp;the&nbsp;whole&nbsp;of&nbsp;the&nbsp;input&nbsp;is&nbsp;returned&nbsp;in</span><br>
<span class="lineno">75</span><span class="comment" id="4705225">//&nbsp;rest.</span><br>
<span class="lineno"></span><span class="keyword" id="4705234">func</span>&nbsp;<span class="ident" id="4705239">Decode</span><span class="op" id="4705245">(</span><span class="ident" id="4705246">data</span>&nbsp;<span class="op" id="4705251">[</span><span class="op" id="4705252">]</span><span class="builtintype" id="4705253">byte</span><span class="op" id="4705257">)</span>&nbsp;<span class="op" id="4705259">(</span><span class="ident" id="4705260">p</span>&nbsp;<span class="op" id="4705262">*</span><span class="ident" id="4705263"><a href="/gostd/encoding/pem/pem.go.html#4703705">Block</a></span><span class="op" id="4705268">,</span>&nbsp;<span class="ident" id="4705270">rest</span>&nbsp;<span class="op" id="4705275">[</span><span class="op" id="4705276">]</span><span class="builtintype" id="4705277">byte</span><span class="op" id="4705281">)</span>&nbsp;<span class="op" id="4705283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4705286">//&nbsp;pemStart&nbsp;begins&nbsp;with&nbsp;a&nbsp;newline.&nbsp;However,&nbsp;at&nbsp;the&nbsp;very&nbsp;beginning&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4705356">//&nbsp;the&nbsp;byte&nbsp;array,&nbsp;we&#39;ll&nbsp;accept&nbsp;the&nbsp;start&nbsp;string&nbsp;without&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705418"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span>&nbsp;<span class="op" id="4705423">=</span>&nbsp;<span class="ident" id="4705425"><a href="/gostd/encoding/pem/pem.go.html#4705246">data</a></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705431">if</span>&nbsp;<span class="ident" id="4705434"><a href="/gostd/encoding/pem/pem.go.html#4703422">bytes</a></span><span class="op" id="4705439">.</span><span class="ident" id="4705440"><a href="/gostd/bytes/bytes.go.html#1403977">HasPrefix</a></span><span class="op" id="4705449">(</span><span class="ident" id="4705450"><a href="/gostd/encoding/pem/pem.go.html#4705246">data</a></span><span class="op" id="4705454">,</span>&nbsp;<span class="ident" id="4705456"><a href="/gostd/encoding/pem/pem.go.html#4704889">pemStart</a></span><span class="op" id="4705464">[</span><span class="num" id="4705465">1</span><span class="op" id="4705466">:</span><span class="op" id="4705467">]</span><span class="op" id="4705468">)</span>&nbsp;<span class="op" id="4705470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705474"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span>&nbsp;<span class="op" id="4705479">=</span>&nbsp;<span class="ident" id="4705481"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span><span class="op" id="4705485">[</span><span class="builtinfunc" id="4705486">len</span><span class="op" id="4705489">(</span><span class="ident" id="4705490"><a href="/gostd/encoding/pem/pem.go.html#4704889">pemStart</a></span><span class="op" id="4705498">)</span><span class="op" id="4705499">-</span><span class="num" id="4705500">1</span>&nbsp;<span class="op" id="4705502">:</span>&nbsp;<span class="builtinfunc" id="4705504">len</span><span class="op" id="4705507">(</span><span class="ident" id="4705508"><a href="/gostd/encoding/pem/pem.go.html#4705246">data</a></span><span class="op" id="4705512">)</span><span class="op" id="4705513">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4705516">}</span>&nbsp;<span class="keyword" id="4705518">else</span>&nbsp;<span class="keyword" id="4705523">if</span>&nbsp;<span class="ident" id="4705526">i</span>&nbsp;<span class="op" id="4705528">:=</span>&nbsp;<span class="ident" id="4705531"><a href="/gostd/encoding/pem/pem.go.html#4703422">bytes</a></span><span class="op" id="4705536">.</span><span class="ident" id="4705537"><a href="/gostd/bytes/bytes.go.html#1397659">Index</a></span><span class="op" id="4705542">(</span><span class="ident" id="4705543"><a href="/gostd/encoding/pem/pem.go.html#4705246">data</a></span><span class="op" id="4705547">,</span>&nbsp;<span class="ident" id="4705549"><a href="/gostd/encoding/pem/pem.go.html#4704889">pemStart</a></span><span class="op" id="4705557">)</span><span class="op" id="4705558">;</span>&nbsp;<span class="ident" id="4705560"><a href="/gostd/encoding/pem/pem.go.html#4705526">i</a></span>&nbsp;<span class="op" id="4705562">&gt;=</span>&nbsp;<span class="num" id="4705565">0</span>&nbsp;<span class="op" id="4705567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705571"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span>&nbsp;<span class="op" id="4705576">=</span>&nbsp;<span class="ident" id="4705578"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span><span class="op" id="4705582">[</span><span class="ident" id="4705583"><a href="/gostd/encoding/pem/pem.go.html#4705526">i</a></span><span class="op" id="4705584">+</span><span class="builtinfunc" id="4705585">len</span><span class="op" id="4705588">(</span><span class="ident" id="4705589"><a href="/gostd/encoding/pem/pem.go.html#4704889">pemStart</a></span><span class="op" id="4705597">)</span>&nbsp;<span class="op" id="4705599">:</span>&nbsp;<span class="builtinfunc" id="4705601">len</span><span class="op" id="4705604">(</span><span class="ident" id="4705605"><a href="/gostd/encoding/pem/pem.go.html#4705246">data</a></span><span class="op" id="4705609">)</span><span class="op" id="4705610">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4705613">}</span>&nbsp;<span class="keyword" id="4705615">else</span>&nbsp;<span class="op" id="4705620">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705624">return</span>&nbsp;<span class="builtintype" id="4705631">nil</span><span class="op" id="4705634">,</span>&nbsp;<span class="ident" id="4705636"><a href="/gostd/encoding/pem/pem.go.html#4705246">data</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4705642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705646">typeLine</span><span class="op" id="4705654">,</span>&nbsp;<span class="ident" id="4705656"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span>&nbsp;<span class="op" id="4705661">:=</span>&nbsp;<span class="ident" id="4705664"><a href="/gostd/encoding/pem/pem.go.html#4704294">getLine</a></span><span class="op" id="4705671">(</span><span class="ident" id="4705672"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span><span class="op" id="4705676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705679">if</span>&nbsp;<span class="op" id="4705682">!</span><span class="ident" id="4705683"><a href="/gostd/encoding/pem/pem.go.html#4703422">bytes</a></span><span class="op" id="4705688">.</span><span class="ident" id="4705689"><a href="/gostd/bytes/bytes.go.html#1404147">HasSuffix</a></span><span class="op" id="4705698">(</span><span class="ident" id="4705699"><a href="/gostd/encoding/pem/pem.go.html#4705646">typeLine</a></span><span class="op" id="4705707">,</span>&nbsp;<span class="ident" id="4705709"><a href="/gostd/encoding/pem/pem.go.html#4704963">pemEndOfLine</a></span><span class="op" id="4705721">)</span>&nbsp;<span class="op" id="4705723">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705727">return</span>&nbsp;<span class="ident" id="4705734"><a href="/gostd/encoding/pem/pem.go.html#4706761">decodeError</a></span><span class="op" id="4705745">(</span><span class="ident" id="4705746"><a href="/gostd/encoding/pem/pem.go.html#4705246">data</a></span><span class="op" id="4705750">,</span>&nbsp;<span class="ident" id="4705752"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span><span class="op" id="4705756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4705759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705762"><a href="/gostd/encoding/pem/pem.go.html#4705646">typeLine</a></span>&nbsp;<span class="op" id="4705771">=</span>&nbsp;<span class="ident" id="4705773"><a href="/gostd/encoding/pem/pem.go.html#4705646">typeLine</a></span><span class="op" id="4705781">[</span><span class="num" id="4705782">0</span>&nbsp;<span class="op" id="4705784">:</span>&nbsp;<span class="builtinfunc" id="4705786">len</span><span class="op" id="4705789">(</span><span class="ident" id="4705790"><a href="/gostd/encoding/pem/pem.go.html#4705646">typeLine</a></span><span class="op" id="4705798">)</span><span class="op" id="4705799">-</span><span class="builtinfunc" id="4705800">len</span><span class="op" id="4705803">(</span><span class="ident" id="4705804"><a href="/gostd/encoding/pem/pem.go.html#4704963">pemEndOfLine</a></span><span class="op" id="4705816">)</span><span class="op" id="4705817">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705821"><a href="/gostd/encoding/pem/pem.go.html#4705260">p</a></span>&nbsp;<span class="op" id="4705823">=</span>&nbsp;<span class="op" id="4705825">&amp;</span><span class="ident" id="4705826"><a href="/gostd/encoding/pem/pem.go.html#4703705">Block</a></span><span class="op" id="4705831">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705835"><a href="/gostd/encoding/pem/pem.go.html#4703811">Headers</a></span><span class="op" id="4705842">:</span>&nbsp;<span class="builtinfunc" id="4705844">make</span><span class="op" id="4705848">(</span><span class="keyword" id="4705849">map</span><span class="op" id="4705852">[</span><span class="builtintype" id="4705853">string</span><span class="op" id="4705859">]</span><span class="builtintype" id="4705860">string</span><span class="op" id="4705866">)</span><span class="op" id="4705867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705871"><a href="/gostd/encoding/pem/pem.go.html#4703721">Type</a></span><span class="op" id="4705875">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4705880">string</span><span class="op" id="4705886">(</span><span class="ident" id="4705887"><a href="/gostd/encoding/pem/pem.go.html#4705646">typeLine</a></span><span class="op" id="4705895">)</span><span class="op" id="4705896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4705899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705903">for</span>&nbsp;<span class="op" id="4705907">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4705911">//&nbsp;This&nbsp;loop&nbsp;terminates&nbsp;because&nbsp;getLine&#39;s&nbsp;second&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4705972">//&nbsp;always&nbsp;smaller&nbsp;than&nbsp;its&nbsp;argument.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706011">if</span>&nbsp;<span class="builtinfunc" id="4706014">len</span><span class="op" id="4706017">(</span><span class="ident" id="4706018"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span><span class="op" id="4706022">)</span>&nbsp;<span class="op" id="4706024">==</span>&nbsp;<span class="num" id="4706027">0</span>&nbsp;<span class="op" id="4706029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706034">return</span>&nbsp;<span class="builtintype" id="4706041">nil</span><span class="op" id="4706044">,</span>&nbsp;<span class="ident" id="4706046"><a href="/gostd/encoding/pem/pem.go.html#4705246">data</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4706053">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706057">line</span><span class="op" id="4706061">,</span>&nbsp;<span class="ident" id="4706063">next</span>&nbsp;<span class="op" id="4706068">:=</span>&nbsp;<span class="ident" id="4706071"><a href="/gostd/encoding/pem/pem.go.html#4704294">getLine</a></span><span class="op" id="4706078">(</span><span class="ident" id="4706079"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span><span class="op" id="4706083">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706088">i</span>&nbsp;<span class="op" id="4706090">:=</span>&nbsp;<span class="ident" id="4706093"><a href="/gostd/encoding/pem/pem.go.html#4703422">bytes</a></span><span class="op" id="4706098">.</span><span class="ident" id="4706099"><a href="/gostd/bytes/bytes.go.html#1397659">Index</a></span><span class="op" id="4706104">(</span><span class="ident" id="4706105"><a href="/gostd/encoding/pem/pem.go.html#4706057">line</a></span><span class="op" id="4706109">,</span>&nbsp;<span class="op" id="4706111">[</span><span class="op" id="4706112">]</span><span class="builtintype" id="4706113">byte</span><span class="op" id="4706117">{</span><span class="string" id="4706118">&#39;:&#39;</span><span class="op" id="4706121">}</span><span class="op" id="4706122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706126">if</span>&nbsp;<span class="ident" id="4706129"><a href="/gostd/encoding/pem/pem.go.html#4706088">i</a></span>&nbsp;<span class="op" id="4706131">==</span>&nbsp;<span class="op" id="4706134">-</span><span class="num" id="4706135">1</span>&nbsp;<span class="op" id="4706137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706142">break</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4706150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4706155">//&nbsp;TODO(agl):&nbsp;need&nbsp;to&nbsp;cope&nbsp;with&nbsp;values&nbsp;that&nbsp;spread&nbsp;across&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706222">key</span><span class="op" id="4706225">,</span>&nbsp;<span class="ident" id="4706227">val</span>&nbsp;<span class="op" id="4706231">:=</span>&nbsp;<span class="ident" id="4706234"><a href="/gostd/encoding/pem/pem.go.html#4706057">line</a></span><span class="op" id="4706238">[</span><span class="num" id="4706239">0</span><span class="op" id="4706240">:</span><span class="ident" id="4706241"><a href="/gostd/encoding/pem/pem.go.html#4706088">i</a></span><span class="op" id="4706242">]</span><span class="op" id="4706243">,</span>&nbsp;<span class="ident" id="4706245"><a href="/gostd/encoding/pem/pem.go.html#4706057">line</a></span><span class="op" id="4706249">[</span><span class="ident" id="4706250"><a href="/gostd/encoding/pem/pem.go.html#4706088">i</a></span><span class="op" id="4706251">+</span><span class="num" id="4706252">1</span><span class="op" id="4706253">:</span><span class="op" id="4706254">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706258"><a href="/gostd/encoding/pem/pem.go.html#4706222">key</a></span>&nbsp;<span class="op" id="4706262">=</span>&nbsp;<span class="ident" id="4706264"><a href="/gostd/encoding/pem/pem.go.html#4703422">bytes</a></span><span class="op" id="4706269">.</span><span class="ident" id="4706270"><a href="/gostd/bytes/bytes.go.html#1411807">TrimSpace</a></span><span class="op" id="4706279">(</span><span class="ident" id="4706280"><a href="/gostd/encoding/pem/pem.go.html#4706222">key</a></span><span class="op" id="4706283">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706287"><a href="/gostd/encoding/pem/pem.go.html#4706227">val</a></span>&nbsp;<span class="op" id="4706291">=</span>&nbsp;<span class="ident" id="4706293"><a href="/gostd/encoding/pem/pem.go.html#4703422">bytes</a></span><span class="op" id="4706298">.</span><span class="ident" id="4706299"><a href="/gostd/bytes/bytes.go.html#1411807">TrimSpace</a></span><span class="op" id="4706308">(</span><span class="ident" id="4706309"><a href="/gostd/encoding/pem/pem.go.html#4706227">val</a></span><span class="op" id="4706312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706316"><a href="/gostd/encoding/pem/pem.go.html#4705260">p</a></span><span class="op" id="4706317">.</span><span class="ident" id="4706318"><a href="/gostd/encoding/pem/pem.go.html#4703811">Headers</a></span><span class="op" id="4706325">[</span><span class="builtintype" id="4706326">string</span><span class="op" id="4706332">(</span><span class="ident" id="4706333"><a href="/gostd/encoding/pem/pem.go.html#4706222">key</a></span><span class="op" id="4706336">)</span><span class="op" id="4706337">]</span>&nbsp;<span class="op" id="4706339">=</span>&nbsp;<span class="builtintype" id="4706341">string</span><span class="op" id="4706347">(</span><span class="ident" id="4706348"><a href="/gostd/encoding/pem/pem.go.html#4706227">val</a></span><span class="op" id="4706351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706355"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span>&nbsp;<span class="op" id="4706360">=</span>&nbsp;<span class="ident" id="4706362"><a href="/gostd/encoding/pem/pem.go.html#4706063">next</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4706368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706372">i</span>&nbsp;<span class="op" id="4706374">:=</span>&nbsp;<span class="ident" id="4706377"><a href="/gostd/encoding/pem/pem.go.html#4703422">bytes</a></span><span class="op" id="4706382">.</span><span class="ident" id="4706383"><a href="/gostd/bytes/bytes.go.html#1397659">Index</a></span><span class="op" id="4706388">(</span><span class="ident" id="4706389"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span><span class="op" id="4706393">,</span>&nbsp;<span class="ident" id="4706395"><a href="/gostd/encoding/pem/pem.go.html#4704928">pemEnd</a></span><span class="op" id="4706401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706404">if</span>&nbsp;<span class="ident" id="4706407"><a href="/gostd/encoding/pem/pem.go.html#4706372">i</a></span>&nbsp;<span class="op" id="4706409">&lt;</span>&nbsp;<span class="num" id="4706411">0</span>&nbsp;<span class="op" id="4706413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706417">return</span>&nbsp;<span class="ident" id="4706424"><a href="/gostd/encoding/pem/pem.go.html#4706761">decodeError</a></span><span class="op" id="4706435">(</span><span class="ident" id="4706436"><a href="/gostd/encoding/pem/pem.go.html#4705246">data</a></span><span class="op" id="4706440">,</span>&nbsp;<span class="ident" id="4706442"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span><span class="op" id="4706446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4706449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706452">base64Data</span>&nbsp;<span class="op" id="4706463">:=</span>&nbsp;<span class="ident" id="4706466"><a href="/gostd/encoding/pem/pem.go.html#4704656">removeWhitespace</a></span><span class="op" id="4706482">(</span><span class="ident" id="4706483"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span><span class="op" id="4706487">[</span><span class="num" id="4706488">0</span><span class="op" id="4706489">:</span><span class="ident" id="4706490"><a href="/gostd/encoding/pem/pem.go.html#4706372">i</a></span><span class="op" id="4706491">]</span><span class="op" id="4706492">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706496"><a href="/gostd/encoding/pem/pem.go.html#4705260">p</a></span><span class="op" id="4706497">.</span><span class="ident" id="4706498"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span>&nbsp;<span class="op" id="4706504">=</span>&nbsp;<span class="builtinfunc" id="4706506">make</span><span class="op" id="4706510">(</span><span class="op" id="4706511">[</span><span class="op" id="4706512">]</span><span class="builtintype" id="4706513">byte</span><span class="op" id="4706517">,</span>&nbsp;<span class="ident" id="4706519"><a href="/gostd/encoding/pem/pem.go.html#4703431">base64</a></span><span class="op" id="4706525">.</span><span class="ident" id="4706526"><a href="/gostd/encoding/base64/base64.go.html#4053069">StdEncoding</a></span><span class="op" id="4706537">.</span><span class="ident" id="4706538"><a href="/gostd/encoding/base64/base64.go.html#4061047">DecodedLen</a></span><span class="op" id="4706548">(</span><span class="builtinfunc" id="4706549">len</span><span class="op" id="4706552">(</span><span class="ident" id="4706553"><a href="/gostd/encoding/pem/pem.go.html#4706452">base64Data</a></span><span class="op" id="4706563">)</span><span class="op" id="4706564">)</span><span class="op" id="4706565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706568">n</span><span class="op" id="4706569">,</span>&nbsp;<span class="ident" id="4706571">err</span>&nbsp;<span class="op" id="4706575">:=</span>&nbsp;<span class="ident" id="4706578"><a href="/gostd/encoding/pem/pem.go.html#4703431">base64</a></span><span class="op" id="4706584">.</span><span class="ident" id="4706585"><a href="/gostd/encoding/base64/base64.go.html#4053069">StdEncoding</a></span><span class="op" id="4706596">.</span><span class="ident" id="4706597"><a href="/gostd/encoding/base64/base64.go.html#4058717">Decode</a></span><span class="op" id="4706603">(</span><span class="ident" id="4706604"><a href="/gostd/encoding/pem/pem.go.html#4705260">p</a></span><span class="op" id="4706605">.</span><span class="ident" id="4706606"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="4706611">,</span>&nbsp;<span class="ident" id="4706613"><a href="/gostd/encoding/pem/pem.go.html#4706452">base64Data</a></span><span class="op" id="4706623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706626">if</span>&nbsp;<span class="ident" id="4706629"><a href="/gostd/encoding/pem/pem.go.html#4706571">err</a></span>&nbsp;<span class="op" id="4706633">!=</span>&nbsp;<span class="builtintype" id="4706636">nil</span>&nbsp;<span class="op" id="4706640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706644">return</span>&nbsp;<span class="ident" id="4706651"><a href="/gostd/encoding/pem/pem.go.html#4706761">decodeError</a></span><span class="op" id="4706662">(</span><span class="ident" id="4706663"><a href="/gostd/encoding/pem/pem.go.html#4705246">data</a></span><span class="op" id="4706667">,</span>&nbsp;<span class="ident" id="4706669"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span><span class="op" id="4706673">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4706676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706679"><a href="/gostd/encoding/pem/pem.go.html#4705260">p</a></span><span class="op" id="4706680">.</span><span class="ident" id="4706681"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span>&nbsp;<span class="op" id="4706687">=</span>&nbsp;<span class="ident" id="4706689"><a href="/gostd/encoding/pem/pem.go.html#4705260">p</a></span><span class="op" id="4706690">.</span><span class="ident" id="4706691"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="4706696">[</span><span class="num" id="4706697">0</span><span class="op" id="4706698">:</span><span class="ident" id="4706699"><a href="/gostd/encoding/pem/pem.go.html#4706568">n</a></span><span class="op" id="4706700">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706704">_</span><span class="op" id="4706705">,</span>&nbsp;<span class="ident" id="4706707"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span>&nbsp;<span class="op" id="4706712">=</span>&nbsp;<span class="ident" id="4706714"><a href="/gostd/encoding/pem/pem.go.html#4704294">getLine</a></span><span class="op" id="4706721">(</span><span class="ident" id="4706722"><a href="/gostd/encoding/pem/pem.go.html#4705270">rest</a></span><span class="op" id="4706726">[</span><span class="ident" id="4706727"><a href="/gostd/encoding/pem/pem.go.html#4706372">i</a></span><span class="op" id="4706728">+</span><span class="builtinfunc" id="4706729">len</span><span class="op" id="4706732">(</span><span class="ident" id="4706733"><a href="/gostd/encoding/pem/pem.go.html#4704928">pemEnd</a></span><span class="op" id="4706739">)</span><span class="op" id="4706740">:</span><span class="op" id="4706741">]</span><span class="op" id="4706742">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706746">return</span><br>
<span class="lineno"></span><span class="op" id="4706753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4706756">func</span>&nbsp;<span class="ident" id="4706761">decodeError</span><span class="op" id="4706772">(</span><span class="ident" id="4706773">data</span><span class="op" id="4706777">,</span>&nbsp;<span class="ident" id="4706779">rest</span>&nbsp;<span class="op" id="4706784">[</span><span class="op" id="4706785">]</span><span class="builtintype" id="4706786">byte</span><span class="op" id="4706790">)</span>&nbsp;<span class="op" id="4706792">(</span><span class="op" id="4706793">*</span><span class="ident" id="4706794"><a href="/gostd/encoding/pem/pem.go.html#4703705">Block</a></span><span class="op" id="4706799">,</span>&nbsp;<span class="op" id="4706801">[</span><span class="op" id="4706802">]</span><span class="builtintype" id="4706803">byte</span><span class="op" id="4706807">)</span>&nbsp;<span class="op" id="4706809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4706812">//&nbsp;If&nbsp;we&nbsp;get&nbsp;here&nbsp;then&nbsp;we&nbsp;have&nbsp;rejected&nbsp;a&nbsp;likely&nbsp;looking,&nbsp;but</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4706875">//&nbsp;ultimately&nbsp;invalid&nbsp;PEM&nbsp;block.&nbsp;We&nbsp;need&nbsp;to&nbsp;start&nbsp;over&nbsp;from&nbsp;a&nbsp;new</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4706942">//&nbsp;position.&nbsp;&nbsp;We&nbsp;have&nbsp;consumed&nbsp;the&nbsp;preamble&nbsp;line&nbsp;and&nbsp;will&nbsp;have&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707015">//&nbsp;any&nbsp;lines&nbsp;which&nbsp;could&nbsp;be&nbsp;header&nbsp;lines.&nbsp;However,&nbsp;a&nbsp;valid&nbsp;preamble</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707084">//&nbsp;line&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;header&nbsp;line,&nbsp;therefore&nbsp;we&nbsp;cannot&nbsp;have&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707155">//&nbsp;the&nbsp;preamble&nbsp;line&nbsp;for&nbsp;the&nbsp;any&nbsp;subsequent&nbsp;block.&nbsp;Thus,&nbsp;we&nbsp;will&nbsp;always</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707228">//&nbsp;find&nbsp;any&nbsp;valid&nbsp;block,&nbsp;no&nbsp;matter&nbsp;what&nbsp;bytes&nbsp;precede&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707287">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707291">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;input&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707324">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707328">//&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;MALFORMED&nbsp;BLOCK-----</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707367">//&nbsp;&nbsp;&nbsp;&nbsp;junk&nbsp;that&nbsp;may&nbsp;look&nbsp;like&nbsp;header&nbsp;lines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707411">//&nbsp;&nbsp;&nbsp;or&nbsp;data&nbsp;lines,&nbsp;but&nbsp;no&nbsp;END&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707448">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707452">//&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;ACTUAL&nbsp;BLOCK-----</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707488">//&nbsp;&nbsp;&nbsp;&nbsp;realdata</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707504">//&nbsp;&nbsp;&nbsp;&nbsp;-----END&nbsp;ACTUAL&nbsp;BLOCK-----</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707538">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707542">//&nbsp;we&#39;ve&nbsp;failed&nbsp;to&nbsp;parse&nbsp;using&nbsp;the&nbsp;first&nbsp;BEGIN&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707595">//&nbsp;and&nbsp;now&nbsp;will&nbsp;try&nbsp;again,&nbsp;using&nbsp;the&nbsp;second&nbsp;BEGIN&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4707652">p</span><span class="op" id="4707653">,</span>&nbsp;<span class="ident" id="4707655"><a href="/gostd/encoding/pem/pem.go.html#4706779">rest</a></span>&nbsp;<span class="op" id="4707660">:=</span>&nbsp;<span class="ident" id="4707663"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="4707669">(</span><span class="ident" id="4707670"><a href="/gostd/encoding/pem/pem.go.html#4706779">rest</a></span><span class="op" id="4707674">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707677">if</span>&nbsp;<span class="ident" id="4707680"><a href="/gostd/encoding/pem/pem.go.html#4707652">p</a></span>&nbsp;<span class="op" id="4707682">==</span>&nbsp;<span class="builtintype" id="4707685">nil</span>&nbsp;<span class="op" id="4707689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4707693"><a href="/gostd/encoding/pem/pem.go.html#4706779">rest</a></span>&nbsp;<span class="op" id="4707698">=</span>&nbsp;<span class="ident" id="4707700"><a href="/gostd/encoding/pem/pem.go.html#4706773">data</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4707706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707709">return</span>&nbsp;<span class="ident" id="4707716"><a href="/gostd/encoding/pem/pem.go.html#4707652">p</a></span><span class="op" id="4707717">,</span>&nbsp;<span class="ident" id="4707719"><a href="/gostd/encoding/pem/pem.go.html#4706779">rest</a></span><br>
<span class="lineno"></span><span class="op" id="4707724">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="4707727">const</span>&nbsp;<span class="ident" id="4707733">pemLineLength</span>&nbsp;<span class="op" id="4707747">=</span>&nbsp;<span class="num" id="4707749">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4707753">type</span>&nbsp;<span class="ident" id="4707758">lineBreaker</span>&nbsp;<span class="keyword" id="4707770">struct</span>&nbsp;<span class="op" id="4707777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4707780">line</span>&nbsp;<span class="op" id="4707785">[</span><span class="ident" id="4707786"><a href="/gostd/encoding/pem/pem.go.html#4707733">pemLineLength</a></span><span class="op" id="4707799">]</span><span class="builtintype" id="4707800">byte</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4707806">used</span>&nbsp;<span class="builtintype" id="4707811">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4707816">out</span>&nbsp;&nbsp;<span class="ident" id="4707821"><a href="/gostd/encoding/pem/pem.go.html#4703450">io</a></span><span class="op" id="4707823">.</span><span class="ident" id="4707824"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><br>
<span class="lineno"></span><span class="op" id="4707831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4707834">func</span>&nbsp;<span class="op" id="4707839">(</span><span class="ident" id="4707840">l</span>&nbsp;<span class="op" id="4707842">*</span><span class="ident" id="4707843"><a href="/gostd/encoding/pem/pem.go.html#4707758">lineBreaker</a></span><span class="op" id="4707854">)</span>&nbsp;<span class="ident" id="4707856">Write</span><span class="op" id="4707861">(</span><span class="ident" id="4707862">b</span>&nbsp;<span class="op" id="4707864">[</span><span class="op" id="4707865">]</span><span class="builtintype" id="4707866">byte</span><span class="op" id="4707870">)</span>&nbsp;<span class="op" id="4707872">(</span><span class="ident" id="4707873">n</span>&nbsp;<span class="builtintype" id="4707875">int</span><span class="op" id="4707878">,</span>&nbsp;<span class="ident" id="4707880">err</span>&nbsp;<span class="builtintype" id="4707884">error</span><span class="op" id="4707889">)</span>&nbsp;<span class="op" id="4707891">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707894">if</span>&nbsp;<span class="ident" id="4707897"><a href="/gostd/encoding/pem/pem.go.html#4707840">l</a></span><span class="op" id="4707898">.</span><span class="ident" id="4707899"><a href="/gostd/encoding/pem/pem.go.html#4707806">used</a></span><span class="op" id="4707903">+</span><span class="builtinfunc" id="4707904">len</span><span class="op" id="4707907">(</span><span class="ident" id="4707908"><a href="/gostd/encoding/pem/pem.go.html#4707862">b</a></span><span class="op" id="4707909">)</span>&nbsp;<span class="op" id="4707911">&lt;</span>&nbsp;<span class="ident" id="4707913"><a href="/gostd/encoding/pem/pem.go.html#4707733">pemLineLength</a></span>&nbsp;<span class="op" id="4707927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4707931">copy</span><span class="op" id="4707935">(</span><span class="ident" id="4707936"><a href="/gostd/encoding/pem/pem.go.html#4707840">l</a></span><span class="op" id="4707937">.</span><span class="ident" id="4707938"><a href="/gostd/encoding/pem/pem.go.html#4707780">line</a></span><span class="op" id="4707942">[</span><span class="ident" id="4707943"><a href="/gostd/encoding/pem/pem.go.html#4707840">l</a></span><span class="op" id="4707944">.</span><span class="ident" id="4707945"><a href="/gostd/encoding/pem/pem.go.html#4707806">used</a></span><span class="op" id="4707949">:</span><span class="op" id="4707950">]</span><span class="op" id="4707951">,</span>&nbsp;<span class="ident" id="4707953"><a href="/gostd/encoding/pem/pem.go.html#4707862">b</a></span><span class="op" id="4707954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4707958"><a href="/gostd/encoding/pem/pem.go.html#4707840">l</a></span><span class="op" id="4707959">.</span><span class="ident" id="4707960"><a href="/gostd/encoding/pem/pem.go.html#4707806">used</a></span>&nbsp;<span class="op" id="4707965">+=</span>&nbsp;<span class="builtinfunc" id="4707968">len</span><span class="op" id="4707971">(</span><span class="ident" id="4707972"><a href="/gostd/encoding/pem/pem.go.html#4707862">b</a></span><span class="op" id="4707973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707977">return</span>&nbsp;<span class="builtinfunc" id="4707984">len</span><span class="op" id="4707987">(</span><span class="ident" id="4707988"><a href="/gostd/encoding/pem/pem.go.html#4707862">b</a></span><span class="op" id="4707989">)</span><span class="op" id="4707990">,</span>&nbsp;<span class="builtintype" id="4707992">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4707997">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708001"><a href="/gostd/encoding/pem/pem.go.html#4707873">n</a></span><span class="op" id="4708002">,</span>&nbsp;<span class="ident" id="4708004"><a href="/gostd/encoding/pem/pem.go.html#4707880">err</a></span>&nbsp;<span class="op" id="4708008">=</span>&nbsp;<span class="ident" id="4708010"><a href="/gostd/encoding/pem/pem.go.html#4707840">l</a></span><span class="op" id="4708011">.</span><span class="ident" id="4708012"><a href="/gostd/encoding/pem/pem.go.html#4707816">out</a></span><span class="op" id="4708015">.</span><span class="ident" id="4708016"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4708021">(</span><span class="ident" id="4708022"><a href="/gostd/encoding/pem/pem.go.html#4707840">l</a></span><span class="op" id="4708023">.</span><span class="ident" id="4708024"><a href="/gostd/encoding/pem/pem.go.html#4707780">line</a></span><span class="op" id="4708028">[</span><span class="num" id="4708029">0</span><span class="op" id="4708030">:</span><span class="ident" id="4708031"><a href="/gostd/encoding/pem/pem.go.html#4707840">l</a></span><span class="op" id="4708032">.</span><span class="ident" id="4708033"><a href="/gostd/encoding/pem/pem.go.html#4707806">used</a></span><span class="op" id="4708037">]</span><span class="op" id="4708038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708041">if</span>&nbsp;<span class="ident" id="4708044"><a href="/gostd/encoding/pem/pem.go.html#4707880">err</a></span>&nbsp;<span class="op" id="4708048">!=</span>&nbsp;<span class="builtintype" id="4708051">nil</span>&nbsp;<span class="op" id="4708055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708059">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708067">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708070">excess</span>&nbsp;<span class="op" id="4708077">:=</span>&nbsp;<span class="ident" id="4708080"><a href="/gostd/encoding/pem/pem.go.html#4707733">pemLineLength</a></span>&nbsp;<span class="op" id="4708094">-</span>&nbsp;<span class="ident" id="4708096"><a href="/gostd/encoding/pem/pem.go.html#4707840">l</a></span><span class="op" id="4708097">.</span><span class="ident" id="4708098"><a href="/gostd/encoding/pem/pem.go.html#4707806">used</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708104"><a href="/gostd/encoding/pem/pem.go.html#4707840">l</a></span><span class="op" id="4708105">.</span><span class="ident" id="4708106"><a href="/gostd/encoding/pem/pem.go.html#4707806">used</a></span>&nbsp;<span class="op" id="4708111">=</span>&nbsp;<span class="num" id="4708113">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708117"><a href="/gostd/encoding/pem/pem.go.html#4707873">n</a></span><span class="op" id="4708118">,</span>&nbsp;<span class="ident" id="4708120"><a href="/gostd/encoding/pem/pem.go.html#4707880">err</a></span>&nbsp;<span class="op" id="4708124">=</span>&nbsp;<span class="ident" id="4708126"><a href="/gostd/encoding/pem/pem.go.html#4707840">l</a></span><span class="op" id="4708127">.</span><span class="ident" id="4708128"><a href="/gostd/encoding/pem/pem.go.html#4707816">out</a></span><span class="op" id="4708131">.</span><span class="ident" id="4708132"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4708137">(</span><span class="ident" id="4708138"><a href="/gostd/encoding/pem/pem.go.html#4707862">b</a></span><span class="op" id="4708139">[</span><span class="num" id="4708140">0</span><span class="op" id="4708141">:</span><span class="ident" id="4708142"><a href="/gostd/encoding/pem/pem.go.html#4708070">excess</a></span><span class="op" id="4708148">]</span><span class="op" id="4708149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708152">if</span>&nbsp;<span class="ident" id="4708155"><a href="/gostd/encoding/pem/pem.go.html#4707880">err</a></span>&nbsp;<span class="op" id="4708159">!=</span>&nbsp;<span class="builtintype" id="4708162">nil</span>&nbsp;<span class="op" id="4708166">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708170">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708182"><a href="/gostd/encoding/pem/pem.go.html#4707873">n</a></span><span class="op" id="4708183">,</span>&nbsp;<span class="ident" id="4708185"><a href="/gostd/encoding/pem/pem.go.html#4707880">err</a></span>&nbsp;<span class="op" id="4708189">=</span>&nbsp;<span class="ident" id="4708191"><a href="/gostd/encoding/pem/pem.go.html#4707840">l</a></span><span class="op" id="4708192">.</span><span class="ident" id="4708193"><a href="/gostd/encoding/pem/pem.go.html#4707816">out</a></span><span class="op" id="4708196">.</span><span class="ident" id="4708197"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4708202">(</span><span class="op" id="4708203">[</span><span class="op" id="4708204">]</span><span class="builtintype" id="4708205">byte</span><span class="op" id="4708209">{</span><span class="string" id="4708210">&#39;\n&#39;</span><span class="op" id="4708214">}</span><span class="op" id="4708215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708218">if</span>&nbsp;<span class="ident" id="4708221"><a href="/gostd/encoding/pem/pem.go.html#4707880">err</a></span>&nbsp;<span class="op" id="4708225">!=</span>&nbsp;<span class="builtintype" id="4708228">nil</span>&nbsp;<span class="op" id="4708232">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708236">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708248">return</span>&nbsp;<span class="ident" id="4708255"><a href="/gostd/encoding/pem/pem.go.html#4707840">l</a></span><span class="op" id="4708256">.</span><span class="ident" id="4708257"><a href="/gostd/encoding/pem/pem.go.html#4707856">Write</a></span><span class="op" id="4708262">(</span><span class="ident" id="4708263"><a href="/gostd/encoding/pem/pem.go.html#4707862">b</a></span><span class="op" id="4708264">[</span><span class="ident" id="4708265"><a href="/gostd/encoding/pem/pem.go.html#4708070">excess</a></span><span class="op" id="4708271">:</span><span class="op" id="4708272">]</span><span class="op" id="4708273">)</span><br>
<span class="lineno"></span><span class="op" id="4708275">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4708278">func</span>&nbsp;<span class="op" id="4708283">(</span><span class="ident" id="4708284">l</span>&nbsp;<span class="op" id="4708286">*</span><span class="ident" id="4708287"><a href="/gostd/encoding/pem/pem.go.html#4707758">lineBreaker</a></span><span class="op" id="4708298">)</span>&nbsp;<span class="ident" id="4708300">Close</span><span class="op" id="4708305">(</span><span class="op" id="4708306">)</span>&nbsp;<span class="op" id="4708308">(</span><span class="ident" id="4708309">err</span>&nbsp;<span class="builtintype" id="4708313">error</span><span class="op" id="4708318">)</span>&nbsp;<span class="op" id="4708320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708323">if</span>&nbsp;<span class="ident" id="4708326"><a href="/gostd/encoding/pem/pem.go.html#4708284">l</a></span><span class="op" id="4708327">.</span><span class="ident" id="4708328"><a href="/gostd/encoding/pem/pem.go.html#4707806">used</a></span>&nbsp;<span class="op" id="4708333">&gt;</span>&nbsp;<span class="num" id="4708335">0</span>&nbsp;<span class="op" id="4708337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708341">_</span><span class="op" id="4708342">,</span>&nbsp;<span class="ident" id="4708344"><a href="/gostd/encoding/pem/pem.go.html#4708309">err</a></span>&nbsp;<span class="op" id="4708348">=</span>&nbsp;<span class="ident" id="4708350"><a href="/gostd/encoding/pem/pem.go.html#4708284">l</a></span><span class="op" id="4708351">.</span><span class="ident" id="4708352"><a href="/gostd/encoding/pem/pem.go.html#4707816">out</a></span><span class="op" id="4708355">.</span><span class="ident" id="4708356"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4708361">(</span><span class="ident" id="4708362"><a href="/gostd/encoding/pem/pem.go.html#4708284">l</a></span><span class="op" id="4708363">.</span><span class="ident" id="4708364"><a href="/gostd/encoding/pem/pem.go.html#4707780">line</a></span><span class="op" id="4708368">[</span><span class="num" id="4708369">0</span><span class="op" id="4708370">:</span><span class="ident" id="4708371"><a href="/gostd/encoding/pem/pem.go.html#4708284">l</a></span><span class="op" id="4708372">.</span><span class="ident" id="4708373"><a href="/gostd/encoding/pem/pem.go.html#4707806">used</a></span><span class="op" id="4708377">]</span><span class="op" id="4708378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708382">if</span>&nbsp;<span class="ident" id="4708385"><a href="/gostd/encoding/pem/pem.go.html#4708309">err</a></span>&nbsp;<span class="op" id="4708389">!=</span>&nbsp;<span class="builtintype" id="4708392">nil</span>&nbsp;<span class="op" id="4708396">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708401">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708414">_</span><span class="op" id="4708415">,</span>&nbsp;<span class="ident" id="4708417"><a href="/gostd/encoding/pem/pem.go.html#4708309">err</a></span>&nbsp;<span class="op" id="4708421">=</span>&nbsp;<span class="ident" id="4708423"><a href="/gostd/encoding/pem/pem.go.html#4708284">l</a></span><span class="op" id="4708424">.</span><span class="ident" id="4708425"><a href="/gostd/encoding/pem/pem.go.html#4707816">out</a></span><span class="op" id="4708428">.</span><span class="ident" id="4708429"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4708434">(</span><span class="op" id="4708435">[</span><span class="op" id="4708436">]</span><span class="builtintype" id="4708437">byte</span><span class="op" id="4708441">{</span><span class="string" id="4708442">&#39;\n&#39;</span><span class="op" id="4708446">}</span><span class="op" id="4708447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708454">return</span><br>
<span class="lineno"></span><span class="op" id="4708461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4708464">func</span>&nbsp;<span class="ident" id="4708469">writeHeader</span><span class="op" id="4708480">(</span><span class="ident" id="4708481">out</span>&nbsp;<span class="ident" id="4708485"><a href="/gostd/encoding/pem/pem.go.html#4703450">io</a></span><span class="op" id="4708487">.</span><span class="ident" id="4708488"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="4708494">,</span>&nbsp;<span class="ident" id="4708496">k</span><span class="op" id="4708497">,</span>&nbsp;<span class="ident" id="4708499">v</span>&nbsp;<span class="builtintype" id="4708501">string</span><span class="op" id="4708507">)</span>&nbsp;<span class="builtintype" id="4708509">error</span>&nbsp;<span class="op" id="4708515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708518">_</span><span class="op" id="4708519">,</span>&nbsp;<span class="ident" id="4708521">err</span>&nbsp;<span class="op" id="4708525">:=</span>&nbsp;<span class="ident" id="4708528"><a href="/gostd/encoding/pem/pem.go.html#4708481">out</a></span><span class="op" id="4708531">.</span><span class="ident" id="4708532"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4708537">(</span><span class="op" id="4708538">[</span><span class="op" id="4708539">]</span><span class="builtintype" id="4708540">byte</span><span class="op" id="4708544">(</span><span class="ident" id="4708545"><a href="/gostd/encoding/pem/pem.go.html#4708496">k</a></span>&nbsp;<span class="op" id="4708547">+</span>&nbsp;<span class="string" id="4708549">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="4708554">+</span>&nbsp;<span class="ident" id="4708556"><a href="/gostd/encoding/pem/pem.go.html#4708499">v</a></span>&nbsp;<span class="op" id="4708558">+</span>&nbsp;<span class="string" id="4708560">&#34;\n&#34;</span><span class="op" id="4708564">)</span><span class="op" id="4708565">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708568">return</span>&nbsp;<span class="ident" id="4708575"><a href="/gostd/encoding/pem/pem.go.html#4708521">err</a></span><br>
<span class="lineno"></span><span class="op" id="4708579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4708582">func</span>&nbsp;<span class="ident" id="4708587">Encode</span><span class="op" id="4708593">(</span><span class="ident" id="4708594">out</span>&nbsp;<span class="ident" id="4708598"><a href="/gostd/encoding/pem/pem.go.html#4703450">io</a></span><span class="op" id="4708600">.</span><span class="ident" id="4708601"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="4708607">,</span>&nbsp;<span class="ident" id="4708609">b</span>&nbsp;<span class="op" id="4708611">*</span><span class="ident" id="4708612"><a href="/gostd/encoding/pem/pem.go.html#4703705">Block</a></span><span class="op" id="4708617">)</span>&nbsp;<span class="builtintype" id="4708619">error</span>&nbsp;<span class="op" id="4708625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708628">if</span>&nbsp;<span class="ident" id="4708631">_</span><span class="op" id="4708632">,</span>&nbsp;<span class="ident" id="4708634">err</span>&nbsp;<span class="op" id="4708638">:=</span>&nbsp;<span class="ident" id="4708641"><a href="/gostd/encoding/pem/pem.go.html#4708594">out</a></span><span class="op" id="4708644">.</span><span class="ident" id="4708645"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4708650">(</span><span class="ident" id="4708651"><a href="/gostd/encoding/pem/pem.go.html#4704889">pemStart</a></span><span class="op" id="4708659">[</span><span class="num" id="4708660">1</span><span class="op" id="4708661">:</span><span class="op" id="4708662">]</span><span class="op" id="4708663">)</span><span class="op" id="4708664">;</span>&nbsp;<span class="ident" id="4708666"><a href="/gostd/encoding/pem/pem.go.html#4708634">err</a></span>&nbsp;<span class="op" id="4708670">!=</span>&nbsp;<span class="builtintype" id="4708673">nil</span>&nbsp;<span class="op" id="4708677">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708681">return</span>&nbsp;<span class="ident" id="4708688"><a href="/gostd/encoding/pem/pem.go.html#4708634">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708696">if</span>&nbsp;<span class="ident" id="4708699">_</span><span class="op" id="4708700">,</span>&nbsp;<span class="ident" id="4708702">err</span>&nbsp;<span class="op" id="4708706">:=</span>&nbsp;<span class="ident" id="4708709"><a href="/gostd/encoding/pem/pem.go.html#4708594">out</a></span><span class="op" id="4708712">.</span><span class="ident" id="4708713"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4708718">(</span><span class="op" id="4708719">[</span><span class="op" id="4708720">]</span><span class="builtintype" id="4708721">byte</span><span class="op" id="4708725">(</span><span class="ident" id="4708726"><a href="/gostd/encoding/pem/pem.go.html#4708609">b</a></span><span class="op" id="4708727">.</span><span class="ident" id="4708728"><a href="/gostd/encoding/pem/pem.go.html#4703721">Type</a></span>&nbsp;<span class="op" id="4708733">+</span>&nbsp;<span class="string" id="4708735">&#34;-----\n&#34;</span><span class="op" id="4708744">)</span><span class="op" id="4708745">)</span><span class="op" id="4708746">;</span>&nbsp;<span class="ident" id="4708748"><a href="/gostd/encoding/pem/pem.go.html#4708702">err</a></span>&nbsp;<span class="op" id="4708752">!=</span>&nbsp;<span class="builtintype" id="4708755">nil</span>&nbsp;<span class="op" id="4708759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708763">return</span>&nbsp;<span class="ident" id="4708770"><a href="/gostd/encoding/pem/pem.go.html#4708702">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708775">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708779">if</span>&nbsp;<span class="builtinfunc" id="4708782">len</span><span class="op" id="4708785">(</span><span class="ident" id="4708786"><a href="/gostd/encoding/pem/pem.go.html#4708609">b</a></span><span class="op" id="4708787">.</span><span class="ident" id="4708788"><a href="/gostd/encoding/pem/pem.go.html#4703811">Headers</a></span><span class="op" id="4708795">)</span>&nbsp;<span class="op" id="4708797">&gt;</span>&nbsp;<span class="num" id="4708799">0</span>&nbsp;<span class="op" id="4708801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708805">const</span>&nbsp;<span class="ident" id="4708811">procType</span>&nbsp;<span class="op" id="4708820">=</span>&nbsp;<span class="string" id="4708822">&#34;Proc-Type&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708836">h</span>&nbsp;<span class="op" id="4708838">:=</span>&nbsp;<span class="builtinfunc" id="4708841">make</span><span class="op" id="4708845">(</span><span class="op" id="4708846">[</span><span class="op" id="4708847">]</span><span class="builtintype" id="4708848">string</span><span class="op" id="4708854">,</span>&nbsp;<span class="num" id="4708856">0</span><span class="op" id="4708857">,</span>&nbsp;<span class="builtinfunc" id="4708859">len</span><span class="op" id="4708862">(</span><span class="ident" id="4708863"><a href="/gostd/encoding/pem/pem.go.html#4708609">b</a></span><span class="op" id="4708864">.</span><span class="ident" id="4708865"><a href="/gostd/encoding/pem/pem.go.html#4703811">Headers</a></span><span class="op" id="4708872">)</span><span class="op" id="4708873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708877">hasProcType</span>&nbsp;<span class="op" id="4708889">:=</span>&nbsp;<span class="builtintype" id="4708892">false</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708900">for</span>&nbsp;<span class="ident" id="4708904">k</span>&nbsp;<span class="op" id="4708906">:=</span>&nbsp;<span class="keyword" id="4708909">range</span>&nbsp;<span class="ident" id="4708915"><a href="/gostd/encoding/pem/pem.go.html#4708609">b</a></span><span class="op" id="4708916">.</span><span class="ident" id="4708917"><a href="/gostd/encoding/pem/pem.go.html#4703811">Headers</a></span>&nbsp;<span class="op" id="4708925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708930">if</span>&nbsp;<span class="ident" id="4708933"><a href="/gostd/encoding/pem/pem.go.html#4708904">k</a></span>&nbsp;<span class="op" id="4708935">==</span>&nbsp;<span class="ident" id="4708938"><a href="/gostd/encoding/pem/pem.go.html#4708811">procType</a></span>&nbsp;<span class="op" id="4708947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708953"><a href="/gostd/encoding/pem/pem.go.html#4708877">hasProcType</a></span>&nbsp;<span class="op" id="4708965">=</span>&nbsp;<span class="builtintype" id="4708967">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708976">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708988">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708993"><a href="/gostd/encoding/pem/pem.go.html#4708836">h</a></span>&nbsp;<span class="op" id="4708995">=</span>&nbsp;<span class="builtinfunc" id="4708997">append</span><span class="op" id="4709003">(</span><span class="ident" id="4709004"><a href="/gostd/encoding/pem/pem.go.html#4708836">h</a></span><span class="op" id="4709005">,</span>&nbsp;<span class="ident" id="4709007"><a href="/gostd/encoding/pem/pem.go.html#4708904">k</a></span><span class="op" id="4709008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4709016">//&nbsp;The&nbsp;Proc-Type&nbsp;header&nbsp;must&nbsp;be&nbsp;written&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4709065">//&nbsp;See&nbsp;RFC&nbsp;1421,&nbsp;section&nbsp;4.6.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709100">if</span>&nbsp;<span class="ident" id="4709103"><a href="/gostd/encoding/pem/pem.go.html#4708877">hasProcType</a></span>&nbsp;<span class="op" id="4709115">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709120">if</span>&nbsp;<span class="ident" id="4709123">err</span>&nbsp;<span class="op" id="4709127">:=</span>&nbsp;<span class="ident" id="4709130"><a href="/gostd/encoding/pem/pem.go.html#4708469">writeHeader</a></span><span class="op" id="4709141">(</span><span class="ident" id="4709142"><a href="/gostd/encoding/pem/pem.go.html#4708594">out</a></span><span class="op" id="4709145">,</span>&nbsp;<span class="ident" id="4709147"><a href="/gostd/encoding/pem/pem.go.html#4708811">procType</a></span><span class="op" id="4709155">,</span>&nbsp;<span class="ident" id="4709157"><a href="/gostd/encoding/pem/pem.go.html#4708609">b</a></span><span class="op" id="4709158">.</span><span class="ident" id="4709159"><a href="/gostd/encoding/pem/pem.go.html#4703811">Headers</a></span><span class="op" id="4709166">[</span><span class="ident" id="4709167"><a href="/gostd/encoding/pem/pem.go.html#4708811">procType</a></span><span class="op" id="4709175">]</span><span class="op" id="4709176">)</span><span class="op" id="4709177">;</span>&nbsp;<span class="ident" id="4709179"><a href="/gostd/encoding/pem/pem.go.html#4709123">err</a></span>&nbsp;<span class="op" id="4709183">!=</span>&nbsp;<span class="builtintype" id="4709186">nil</span>&nbsp;<span class="op" id="4709190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709196">return</span>&nbsp;<span class="ident" id="4709203"><a href="/gostd/encoding/pem/pem.go.html#4709123">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4709218">//&nbsp;For&nbsp;consistency&nbsp;of&nbsp;output,&nbsp;write&nbsp;other&nbsp;headers&nbsp;sorted&nbsp;by&nbsp;key.</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4709285"><a href="/gostd/encoding/pem/pem.go.html#4703456">sort</a></span><span class="op" id="4709289">.</span><span class="ident" id="4709290"><a href="/gostd/sort/sort.go.html#2017831">Strings</a></span><span class="op" id="4709297">(</span><span class="ident" id="4709298"><a href="/gostd/encoding/pem/pem.go.html#4708836">h</a></span><span class="op" id="4709299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709303">for</span>&nbsp;<span class="ident" id="4709307">_</span><span class="op" id="4709308">,</span>&nbsp;<span class="ident" id="4709310">k</span>&nbsp;<span class="op" id="4709312">:=</span>&nbsp;<span class="keyword" id="4709315">range</span>&nbsp;<span class="ident" id="4709321"><a href="/gostd/encoding/pem/pem.go.html#4708836">h</a></span>&nbsp;<span class="op" id="4709323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709328">if</span>&nbsp;<span class="ident" id="4709331">err</span>&nbsp;<span class="op" id="4709335">:=</span>&nbsp;<span class="ident" id="4709338"><a href="/gostd/encoding/pem/pem.go.html#4708469">writeHeader</a></span><span class="op" id="4709349">(</span><span class="ident" id="4709350"><a href="/gostd/encoding/pem/pem.go.html#4708594">out</a></span><span class="op" id="4709353">,</span>&nbsp;<span class="ident" id="4709355"><a href="/gostd/encoding/pem/pem.go.html#4709310">k</a></span><span class="op" id="4709356">,</span>&nbsp;<span class="ident" id="4709358"><a href="/gostd/encoding/pem/pem.go.html#4708609">b</a></span><span class="op" id="4709359">.</span><span class="ident" id="4709360"><a href="/gostd/encoding/pem/pem.go.html#4703811">Headers</a></span><span class="op" id="4709367">[</span><span class="ident" id="4709368"><a href="/gostd/encoding/pem/pem.go.html#4709310">k</a></span><span class="op" id="4709369">]</span><span class="op" id="4709370">)</span><span class="op" id="4709371">;</span>&nbsp;<span class="ident" id="4709373"><a href="/gostd/encoding/pem/pem.go.html#4709331">err</a></span>&nbsp;<span class="op" id="4709377">!=</span>&nbsp;<span class="builtintype" id="4709380">nil</span>&nbsp;<span class="op" id="4709384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709390">return</span>&nbsp;<span class="ident" id="4709397"><a href="/gostd/encoding/pem/pem.go.html#4709331">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709404">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709412">if</span>&nbsp;<span class="ident" id="4709415">_</span><span class="op" id="4709416">,</span>&nbsp;<span class="ident" id="4709418">err</span>&nbsp;<span class="op" id="4709422">:=</span>&nbsp;<span class="ident" id="4709425"><a href="/gostd/encoding/pem/pem.go.html#4708594">out</a></span><span class="op" id="4709428">.</span><span class="ident" id="4709429"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4709434">(</span><span class="op" id="4709435">[</span><span class="op" id="4709436">]</span><span class="builtintype" id="4709437">byte</span><span class="op" id="4709441">{</span><span class="string" id="4709442">&#39;\n&#39;</span><span class="op" id="4709446">}</span><span class="op" id="4709447">)</span><span class="op" id="4709448">;</span>&nbsp;<span class="ident" id="4709450"><a href="/gostd/encoding/pem/pem.go.html#4709418">err</a></span>&nbsp;<span class="op" id="4709454">!=</span>&nbsp;<span class="builtintype" id="4709457">nil</span>&nbsp;<span class="op" id="4709461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709466">return</span>&nbsp;<span class="ident" id="4709473"><a href="/gostd/encoding/pem/pem.go.html#4709418">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709482">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709486">var</span>&nbsp;<span class="ident" id="4709490">breaker</span>&nbsp;<span class="ident" id="4709498"><a href="/gostd/encoding/pem/pem.go.html#4707758">lineBreaker</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4709511"><a href="/gostd/encoding/pem/pem.go.html#4709490">breaker</a></span><span class="op" id="4709518">.</span><span class="ident" id="4709519"><a href="/gostd/encoding/pem/pem.go.html#4707816">out</a></span>&nbsp;<span class="op" id="4709523">=</span>&nbsp;<span class="ident" id="4709525"><a href="/gostd/encoding/pem/pem.go.html#4708594">out</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4709531">b64</span>&nbsp;<span class="op" id="4709535">:=</span>&nbsp;<span class="ident" id="4709538"><a href="/gostd/encoding/pem/pem.go.html#4703431">base64</a></span><span class="op" id="4709544">.</span><span class="ident" id="4709545"><a href="/gostd/encoding/base64/base64.go.html#4056250">NewEncoder</a></span><span class="op" id="4709555">(</span><span class="ident" id="4709556"><a href="/gostd/encoding/pem/pem.go.html#4703431">base64</a></span><span class="op" id="4709562">.</span><span class="ident" id="4709563"><a href="/gostd/encoding/base64/base64.go.html#4053069">StdEncoding</a></span><span class="op" id="4709574">,</span>&nbsp;<span class="op" id="4709576">&amp;</span><span class="ident" id="4709577"><a href="/gostd/encoding/pem/pem.go.html#4709490">breaker</a></span><span class="op" id="4709584">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709587">if</span>&nbsp;<span class="ident" id="4709590">_</span><span class="op" id="4709591">,</span>&nbsp;<span class="ident" id="4709593">err</span>&nbsp;<span class="op" id="4709597">:=</span>&nbsp;<span class="ident" id="4709600"><a href="/gostd/encoding/pem/pem.go.html#4709531">b64</a></span><span class="op" id="4709603">.</span><span class="ident" id="4709604"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4709609">(</span><span class="ident" id="4709610"><a href="/gostd/encoding/pem/pem.go.html#4708609">b</a></span><span class="op" id="4709611">.</span><span class="ident" id="4709612"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="4709617">)</span><span class="op" id="4709618">;</span>&nbsp;<span class="ident" id="4709620"><a href="/gostd/encoding/pem/pem.go.html#4709593">err</a></span>&nbsp;<span class="op" id="4709624">!=</span>&nbsp;<span class="builtintype" id="4709627">nil</span>&nbsp;<span class="op" id="4709631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709635">return</span>&nbsp;<span class="ident" id="4709642"><a href="/gostd/encoding/pem/pem.go.html#4709593">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4709650"><a href="/gostd/encoding/pem/pem.go.html#4709531">b64</a></span><span class="op" id="4709653">.</span><span class="ident" id="4709654"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="4709659">(</span><span class="op" id="4709660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4709663"><a href="/gostd/encoding/pem/pem.go.html#4709490">breaker</a></span><span class="op" id="4709670">.</span><span class="ident" id="4709671"><a href="/gostd/encoding/pem/pem.go.html#4708300">Close</a></span><span class="op" id="4709676">(</span><span class="op" id="4709677">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709681">if</span>&nbsp;<span class="ident" id="4709684">_</span><span class="op" id="4709685">,</span>&nbsp;<span class="ident" id="4709687">err</span>&nbsp;<span class="op" id="4709691">:=</span>&nbsp;<span class="ident" id="4709694"><a href="/gostd/encoding/pem/pem.go.html#4708594">out</a></span><span class="op" id="4709697">.</span><span class="ident" id="4709698"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4709703">(</span><span class="ident" id="4709704"><a href="/gostd/encoding/pem/pem.go.html#4704928">pemEnd</a></span><span class="op" id="4709710">[</span><span class="num" id="4709711">1</span><span class="op" id="4709712">:</span><span class="op" id="4709713">]</span><span class="op" id="4709714">)</span><span class="op" id="4709715">;</span>&nbsp;<span class="ident" id="4709717"><a href="/gostd/encoding/pem/pem.go.html#4709687">err</a></span>&nbsp;<span class="op" id="4709721">!=</span>&nbsp;<span class="builtintype" id="4709724">nil</span>&nbsp;<span class="op" id="4709728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709732">return</span>&nbsp;<span class="ident" id="4709739"><a href="/gostd/encoding/pem/pem.go.html#4709687">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4709747">_</span><span class="op" id="4709748">,</span>&nbsp;<span class="ident" id="4709750">err</span>&nbsp;<span class="op" id="4709754">:=</span>&nbsp;<span class="ident" id="4709757"><a href="/gostd/encoding/pem/pem.go.html#4708594">out</a></span><span class="op" id="4709760">.</span><span class="ident" id="4709761"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4709766">(</span><span class="op" id="4709767">[</span><span class="op" id="4709768">]</span><span class="builtintype" id="4709769">byte</span><span class="op" id="4709773">(</span><span class="ident" id="4709774"><a href="/gostd/encoding/pem/pem.go.html#4708609">b</a></span><span class="op" id="4709775">.</span><span class="ident" id="4709776"><a href="/gostd/encoding/pem/pem.go.html#4703721">Type</a></span>&nbsp;<span class="op" id="4709781">+</span>&nbsp;<span class="string" id="4709783">&#34;-----\n&#34;</span><span class="op" id="4709792">)</span><span class="op" id="4709793">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709796">return</span>&nbsp;<span class="ident" id="4709803"><a href="/gostd/encoding/pem/pem.go.html#4709750">err</a></span><br>
<span class="lineno"></span><span class="op" id="4709807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4709810">func</span>&nbsp;<span class="ident" id="4709815">EncodeToMemory</span><span class="op" id="4709829">(</span><span class="ident" id="4709830">b</span>&nbsp;<span class="op" id="4709832">*</span><span class="ident" id="4709833"><a href="/gostd/encoding/pem/pem.go.html#4703705">Block</a></span><span class="op" id="4709838">)</span>&nbsp;<span class="op" id="4709840">[</span><span class="op" id="4709841">]</span><span class="builtintype" id="4709842">byte</span>&nbsp;<span class="op" id="4709847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709850">var</span>&nbsp;<span class="ident" id="4709854">buf</span>&nbsp;<span class="ident" id="4709858"><a href="/gostd/encoding/pem/pem.go.html#4703422">bytes</a></span><span class="op" id="4709863">.</span><span class="ident" id="4709864"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4709872"><a href="/gostd/encoding/pem/pem.go.html#4708587">Encode</a></span><span class="op" id="4709878">(</span><span class="op" id="4709879">&amp;</span><span class="ident" id="4709880"><a href="/gostd/encoding/pem/pem.go.html#4709854">buf</a></span><span class="op" id="4709883">,</span>&nbsp;<span class="ident" id="4709885"><a href="/gostd/encoding/pem/pem.go.html#4709830">b</a></span><span class="op" id="4709886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709889">return</span>&nbsp;<span class="ident" id="4709896"><a href="/gostd/encoding/pem/pem.go.html#4709854">buf</a></span><span class="op" id="4709899">.</span><span class="ident" id="4709900"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="4709905">(</span><span class="op" id="4709906">)</span><br>
<span class="lineno"></span><span class="op" id="4709908">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
