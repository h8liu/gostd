<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html" class="current">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8311676">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8311731">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8311785">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8311836">package</span>&nbsp;<span class="ident" id="8311844">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8311849">import</span>&nbsp;<span class="op" id="8311856">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8311859">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8311875">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8311885">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8311888">type</span>&nbsp;<span class="ident" id="8311893">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="8311922">struct</span>&nbsp;<span class="op" id="8311929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311932">in</span><span class="op" id="8311934">,</span>&nbsp;<span class="ident" id="8311936">out1</span><span class="op" id="8311940">,</span>&nbsp;<span class="ident" id="8311942">out2</span>&nbsp;<span class="builtintype" id="8311947">string</span><br>
<span class="lineno"></span><span class="op" id="8311954">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8311957">var</span>&nbsp;<span class="ident" id="8311961">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="8311991">=</span>&nbsp;<span class="op" id="8311993">[</span><span class="op" id="8311994">]</span><span class="ident" id="8311995">testSplitPreMasterSecretTest</span><span class="op" id="8312023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312026">{</span><span class="string" id="8312027">&#34;&#34;</span><span class="op" id="8312029">,</span>&nbsp;<span class="string" id="8312031">&#34;&#34;</span><span class="op" id="8312033">,</span>&nbsp;<span class="string" id="8312035">&#34;&#34;</span><span class="op" id="8312037">}</span><span class="op" id="8312038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312041">{</span><span class="string" id="8312042">&#34;00&#34;</span><span class="op" id="8312046">,</span>&nbsp;<span class="string" id="8312048">&#34;00&#34;</span><span class="op" id="8312052">,</span>&nbsp;<span class="string" id="8312054">&#34;00&#34;</span><span class="op" id="8312058">}</span><span class="op" id="8312059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312062">{</span><span class="string" id="8312063">&#34;0011&#34;</span><span class="op" id="8312069">,</span>&nbsp;<span class="string" id="8312071">&#34;00&#34;</span><span class="op" id="8312075">,</span>&nbsp;<span class="string" id="8312077">&#34;11&#34;</span><span class="op" id="8312081">}</span><span class="op" id="8312082">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312085">{</span><span class="string" id="8312086">&#34;001122&#34;</span><span class="op" id="8312094">,</span>&nbsp;<span class="string" id="8312096">&#34;0011&#34;</span><span class="op" id="8312102">,</span>&nbsp;<span class="string" id="8312104">&#34;1122&#34;</span><span class="op" id="8312110">}</span><span class="op" id="8312111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312114">{</span><span class="string" id="8312115">&#34;00112233&#34;</span><span class="op" id="8312125">,</span>&nbsp;<span class="string" id="8312127">&#34;0011&#34;</span><span class="op" id="8312133">,</span>&nbsp;<span class="string" id="8312135">&#34;2233&#34;</span><span class="op" id="8312141">}</span><span class="op" id="8312142">,</span><br>
<span class="lineno"></span><span class="op" id="8312144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8312147">func</span>&nbsp;<span class="ident" id="8312152">TestSplitPreMasterSecret</span><span class="op" id="8312176">(</span><span class="ident" id="8312177">t</span>&nbsp;<span class="op" id="8312179">*</span><span class="ident" id="8312180">testing</span><span class="op" id="8312187">.</span><span class="ident" id="8312188">T</span><span class="op" id="8312189">)</span>&nbsp;<span class="op" id="8312191">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8312194">for</span>&nbsp;<span class="ident" id="8312198">i</span><span class="op" id="8312199">,</span>&nbsp;<span class="ident" id="8312201">test</span>&nbsp;<span class="op" id="8312206">:=</span>&nbsp;<span class="keyword" id="8312209">range</span>&nbsp;<span class="ident" id="8312215">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="8312245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312249">in</span><span class="op" id="8312251">,</span>&nbsp;<span class="ident" id="8312253">_</span>&nbsp;<span class="op" id="8312255">:=</span>&nbsp;<span class="ident" id="8312258">hex</span><span class="op" id="8312261">.</span><span class="ident" id="8312262">DecodeString</span><span class="op" id="8312274">(</span><span class="ident" id="8312275">test</span><span class="op" id="8312279">.</span><span class="ident" id="8312280">in</span><span class="op" id="8312282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312286">out1</span><span class="op" id="8312290">,</span>&nbsp;<span class="ident" id="8312292">out2</span>&nbsp;<span class="op" id="8312297">:=</span>&nbsp;<span class="ident" id="8312300">splitPreMasterSecret</span><span class="op" id="8312320">(</span><span class="ident" id="8312321">in</span><span class="op" id="8312323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312327">s1</span>&nbsp;<span class="op" id="8312330">:=</span>&nbsp;<span class="ident" id="8312333">hex</span><span class="op" id="8312336">.</span><span class="ident" id="8312337">EncodeToString</span><span class="op" id="8312351">(</span><span class="ident" id="8312352">out1</span><span class="op" id="8312356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312360">s2</span>&nbsp;<span class="op" id="8312363">:=</span>&nbsp;<span class="ident" id="8312366">hex</span><span class="op" id="8312369">.</span><span class="ident" id="8312370">EncodeToString</span><span class="op" id="8312384">(</span><span class="ident" id="8312385">out2</span><span class="op" id="8312389">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8312393">if</span>&nbsp;<span class="ident" id="8312396">s1</span>&nbsp;<span class="op" id="8312399">!=</span>&nbsp;<span class="ident" id="8312402">test</span><span class="op" id="8312406">.</span><span class="ident" id="8312407">out1</span>&nbsp;<span class="op" id="8312412">||</span>&nbsp;<span class="ident" id="8312415">s2</span>&nbsp;<span class="op" id="8312418">!=</span>&nbsp;<span class="ident" id="8312421">test</span><span class="op" id="8312425">.</span><span class="ident" id="8312426">out2</span>&nbsp;<span class="op" id="8312431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312436">t</span><span class="op" id="8312437">.</span><span class="ident" id="8312438">Errorf</span><span class="op" id="8312444">(</span><span class="string" id="8312445">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="8312480">,</span>&nbsp;<span class="ident" id="8312482">i</span><span class="op" id="8312483">,</span>&nbsp;<span class="ident" id="8312485">s1</span><span class="op" id="8312487">,</span>&nbsp;<span class="ident" id="8312489">s2</span><span class="op" id="8312491">,</span>&nbsp;<span class="ident" id="8312493">test</span><span class="op" id="8312497">.</span><span class="ident" id="8312498">out1</span><span class="op" id="8312502">,</span>&nbsp;<span class="ident" id="8312504">test</span><span class="op" id="8312508">.</span><span class="ident" id="8312509">out2</span><span class="op" id="8312513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312520">}</span><br>
<span class="lineno"></span><span class="op" id="8312522">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="8312525">type</span>&nbsp;<span class="ident" id="8312530">testKeysFromTest</span>&nbsp;<span class="keyword" id="8312547">struct</span>&nbsp;<span class="op" id="8312554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312557">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8312584">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312592">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8312619">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312627">clientRandom</span><span class="op" id="8312639">,</span>&nbsp;<span class="ident" id="8312641">serverRandom</span>&nbsp;<span class="builtintype" id="8312654">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312662">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8312689">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312697">clientMAC</span><span class="op" id="8312706">,</span>&nbsp;<span class="ident" id="8312708">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8312724">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312732">clientKey</span><span class="op" id="8312741">,</span>&nbsp;<span class="ident" id="8312743">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8312759">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312767">macLen</span><span class="op" id="8312773">,</span>&nbsp;<span class="ident" id="8312775">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8312794">int</span><br>
<span class="lineno"></span><span class="op" id="8312798">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8312801">func</span>&nbsp;<span class="ident" id="8312806">TestKeysFromPreMasterSecret</span><span class="op" id="8312833">(</span><span class="ident" id="8312834">t</span>&nbsp;<span class="op" id="8312836">*</span><span class="ident" id="8312837">testing</span><span class="op" id="8312844">.</span><span class="ident" id="8312845">T</span><span class="op" id="8312846">)</span>&nbsp;<span class="op" id="8312848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8312851">for</span>&nbsp;<span class="ident" id="8312855">i</span><span class="op" id="8312856">,</span>&nbsp;<span class="ident" id="8312858">test</span>&nbsp;<span class="op" id="8312863">:=</span>&nbsp;<span class="keyword" id="8312866">range</span>&nbsp;<span class="ident" id="8312872">testKeysFromTests</span>&nbsp;<span class="op" id="8312890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312894">in</span><span class="op" id="8312896">,</span>&nbsp;<span class="ident" id="8312898">_</span>&nbsp;<span class="op" id="8312900">:=</span>&nbsp;<span class="ident" id="8312903">hex</span><span class="op" id="8312906">.</span><span class="ident" id="8312907">DecodeString</span><span class="op" id="8312919">(</span><span class="ident" id="8312920">test</span><span class="op" id="8312924">.</span><span class="ident" id="8312925">preMasterSecret</span><span class="op" id="8312940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312944">clientRandom</span><span class="op" id="8312956">,</span>&nbsp;<span class="ident" id="8312958">_</span>&nbsp;<span class="op" id="8312960">:=</span>&nbsp;<span class="ident" id="8312963">hex</span><span class="op" id="8312966">.</span><span class="ident" id="8312967">DecodeString</span><span class="op" id="8312979">(</span><span class="ident" id="8312980">test</span><span class="op" id="8312984">.</span><span class="ident" id="8312985">clientRandom</span><span class="op" id="8312997">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313001">serverRandom</span><span class="op" id="8313013">,</span>&nbsp;<span class="ident" id="8313015">_</span>&nbsp;<span class="op" id="8313017">:=</span>&nbsp;<span class="ident" id="8313020">hex</span><span class="op" id="8313023">.</span><span class="ident" id="8313024">DecodeString</span><span class="op" id="8313036">(</span><span class="ident" id="8313037">test</span><span class="op" id="8313041">.</span><span class="ident" id="8313042">serverRandom</span><span class="op" id="8313054">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313059">masterSecret</span>&nbsp;<span class="op" id="8313072">:=</span>&nbsp;<span class="ident" id="8313075">masterFromPreMasterSecret</span><span class="op" id="8313100">(</span><span class="ident" id="8313101">test</span><span class="op" id="8313105">.</span><span class="ident" id="8313106">version</span><span class="op" id="8313113">,</span>&nbsp;<span class="ident" id="8313115">in</span><span class="op" id="8313117">,</span>&nbsp;<span class="ident" id="8313119">clientRandom</span><span class="op" id="8313131">,</span>&nbsp;<span class="ident" id="8313133">serverRandom</span><span class="op" id="8313145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8313149">if</span>&nbsp;<span class="ident" id="8313152">s</span>&nbsp;<span class="op" id="8313154">:=</span>&nbsp;<span class="ident" id="8313157">hex</span><span class="op" id="8313160">.</span><span class="ident" id="8313161">EncodeToString</span><span class="op" id="8313175">(</span><span class="ident" id="8313176">masterSecret</span><span class="op" id="8313188">)</span><span class="op" id="8313189">;</span>&nbsp;<span class="ident" id="8313191">s</span>&nbsp;<span class="op" id="8313193">!=</span>&nbsp;<span class="ident" id="8313196">test</span><span class="op" id="8313200">.</span><span class="ident" id="8313201">masterSecret</span>&nbsp;<span class="op" id="8313214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313219">t</span><span class="op" id="8313220">.</span><span class="ident" id="8313221">Errorf</span><span class="op" id="8313227">(</span><span class="string" id="8313228">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8313264">,</span>&nbsp;<span class="ident" id="8313266">i</span><span class="op" id="8313267">,</span>&nbsp;<span class="ident" id="8313269">s</span><span class="op" id="8313270">,</span>&nbsp;<span class="ident" id="8313272">test</span><span class="op" id="8313276">.</span><span class="ident" id="8313277">masterSecret</span><span class="op" id="8313289">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8313294">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8313305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313310">clientMAC</span><span class="op" id="8313319">,</span>&nbsp;<span class="ident" id="8313321">serverMAC</span><span class="op" id="8313330">,</span>&nbsp;<span class="ident" id="8313332">clientKey</span><span class="op" id="8313341">,</span>&nbsp;<span class="ident" id="8313343">serverKey</span><span class="op" id="8313352">,</span>&nbsp;<span class="ident" id="8313354">_</span><span class="op" id="8313355">,</span>&nbsp;<span class="ident" id="8313357">_</span>&nbsp;<span class="op" id="8313359">:=</span>&nbsp;<span class="ident" id="8313362">keysFromMasterSecret</span><span class="op" id="8313382">(</span><span class="ident" id="8313383">test</span><span class="op" id="8313387">.</span><span class="ident" id="8313388">version</span><span class="op" id="8313395">,</span>&nbsp;<span class="ident" id="8313397">masterSecret</span><span class="op" id="8313409">,</span>&nbsp;<span class="ident" id="8313411">clientRandom</span><span class="op" id="8313423">,</span>&nbsp;<span class="ident" id="8313425">serverRandom</span><span class="op" id="8313437">,</span>&nbsp;<span class="ident" id="8313439">test</span><span class="op" id="8313443">.</span><span class="ident" id="8313444">macLen</span><span class="op" id="8313450">,</span>&nbsp;<span class="ident" id="8313452">test</span><span class="op" id="8313456">.</span><span class="ident" id="8313457">keyLen</span><span class="op" id="8313463">,</span>&nbsp;<span class="num" id="8313465">0</span><span class="op" id="8313466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313470">clientMACString</span>&nbsp;<span class="op" id="8313486">:=</span>&nbsp;<span class="ident" id="8313489">hex</span><span class="op" id="8313492">.</span><span class="ident" id="8313493">EncodeToString</span><span class="op" id="8313507">(</span><span class="ident" id="8313508">clientMAC</span><span class="op" id="8313517">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313521">serverMACString</span>&nbsp;<span class="op" id="8313537">:=</span>&nbsp;<span class="ident" id="8313540">hex</span><span class="op" id="8313543">.</span><span class="ident" id="8313544">EncodeToString</span><span class="op" id="8313558">(</span><span class="ident" id="8313559">serverMAC</span><span class="op" id="8313568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313572">clientKeyString</span>&nbsp;<span class="op" id="8313588">:=</span>&nbsp;<span class="ident" id="8313591">hex</span><span class="op" id="8313594">.</span><span class="ident" id="8313595">EncodeToString</span><span class="op" id="8313609">(</span><span class="ident" id="8313610">clientKey</span><span class="op" id="8313619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313623">serverKeyString</span>&nbsp;<span class="op" id="8313639">:=</span>&nbsp;<span class="ident" id="8313642">hex</span><span class="op" id="8313645">.</span><span class="ident" id="8313646">EncodeToString</span><span class="op" id="8313660">(</span><span class="ident" id="8313661">serverKey</span><span class="op" id="8313670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8313674">if</span>&nbsp;<span class="ident" id="8313677">clientMACString</span>&nbsp;<span class="op" id="8313693">!=</span>&nbsp;<span class="ident" id="8313696">test</span><span class="op" id="8313700">.</span><span class="ident" id="8313701">clientMAC</span>&nbsp;<span class="op" id="8313711">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313717">serverMACString</span>&nbsp;<span class="op" id="8313733">!=</span>&nbsp;<span class="ident" id="8313736">test</span><span class="op" id="8313740">.</span><span class="ident" id="8313741">serverMAC</span>&nbsp;<span class="op" id="8313751">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313757">clientKeyString</span>&nbsp;<span class="op" id="8313773">!=</span>&nbsp;<span class="ident" id="8313776">test</span><span class="op" id="8313780">.</span><span class="ident" id="8313781">clientKey</span>&nbsp;<span class="op" id="8313791">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313797">serverKeyString</span>&nbsp;<span class="op" id="8313813">!=</span>&nbsp;<span class="ident" id="8313816">test</span><span class="op" id="8313820">.</span><span class="ident" id="8313821">serverKey</span>&nbsp;<span class="op" id="8313831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313836">t</span><span class="op" id="8313837">.</span><span class="ident" id="8313838">Errorf</span><span class="op" id="8313844">(</span><span class="string" id="8313845">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="8313896">,</span>&nbsp;<span class="ident" id="8313898">i</span><span class="op" id="8313899">,</span>&nbsp;<span class="ident" id="8313901">clientMACString</span><span class="op" id="8313916">,</span>&nbsp;<span class="ident" id="8313918">serverMACString</span><span class="op" id="8313933">,</span>&nbsp;<span class="ident" id="8313935">clientKeyString</span><span class="op" id="8313950">,</span>&nbsp;<span class="ident" id="8313952">serverKeyString</span><span class="op" id="8313967">,</span>&nbsp;<span class="ident" id="8313969">test</span><span class="op" id="8313973">.</span><span class="ident" id="8313974">clientMAC</span><span class="op" id="8313983">,</span>&nbsp;<span class="ident" id="8313985">test</span><span class="op" id="8313989">.</span><span class="ident" id="8313990">serverMAC</span><span class="op" id="8313999">,</span>&nbsp;<span class="ident" id="8314001">test</span><span class="op" id="8314005">.</span><span class="ident" id="8314006">clientKey</span><span class="op" id="8314015">,</span>&nbsp;<span class="ident" id="8314017">test</span><span class="op" id="8314021">.</span><span class="ident" id="8314022">serverKey</span><span class="op" id="8314031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314038">}</span><br>
<span class="lineno">70</span><span class="op" id="8314040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8314043">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="8314128">var</span>&nbsp;<span class="ident" id="8314132">testKeysFromTests</span>&nbsp;<span class="op" id="8314150">=</span>&nbsp;<span class="op" id="8314152">[</span><span class="op" id="8314153">]</span><span class="ident" id="8314154">testKeysFromTest</span><span class="op" id="8314170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314173">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8314177">VersionTLS10</span><span class="op" id="8314189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8314193">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="8314291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8314295">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="8314361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8314365">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="8314431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8314435">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="8314533">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8314537">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="8314579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8314583">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="8314625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8314629">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="8314663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8314667">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="8314701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8314705">20</span><span class="op" id="8314707">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8314711">16</span><span class="op" id="8314713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314716">}</span><span class="op" id="8314717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8314724">VersionTLS10</span><span class="op" id="8314736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8314740">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="8314838">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8314842">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="8314908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8314912">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="8314978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8314982">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="8315080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315084">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="8315126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315130">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="8315172">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315176">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="8315210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315214">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="8315248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8315252">20</span><span class="op" id="8315254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8315258">16</span><span class="op" id="8315260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315263">}</span><span class="op" id="8315264">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8315271">VersionTLS10</span><span class="op" id="8315283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315287">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="8315545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315549">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="8315615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315619">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="8315685">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315689">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="8315787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315791">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="8315833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315837">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="8315879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315883">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="8315917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315921">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="8315955">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8315959">20</span><span class="op" id="8315961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8315965">16</span><span class="op" id="8315967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315970">}</span><span class="op" id="8315971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8315978">VersionSSL30</span><span class="op" id="8315990">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8315994">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="8316252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8316256">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="8316322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8316326">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="8316392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8316396">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="8316494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8316498">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="8316540">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8316544">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="8316586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8316590">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="8316624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8316628">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="8316662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8316666">20</span><span class="op" id="8316668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8316672">16</span><span class="op" id="8316674">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8316677">}</span><span class="op" id="8316678">,</span><br>
<span class="lineno"></span><span class="op" id="8316680">}</span>
</div>
</body>
</html>
