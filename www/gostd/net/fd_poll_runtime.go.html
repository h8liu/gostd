<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3278702">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3278757">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3278811">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3278862">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;windows&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3278935">package</span>&nbsp;<span class="ident" id="3278943">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3278948">import</span>&nbsp;<span class="op" id="3278955">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3278958">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3278966">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3278977">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3278984">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3278987">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="3279065">func</span>&nbsp;<span class="ident" id="3279070">runtimeNano</span><span class="op" id="3279081">(</span><span class="op" id="3279082">)</span>&nbsp;<span class="ident" id="3279084">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3279091">func</span>&nbsp;<span class="ident" id="3279096">runtime_pollServerInit</span><span class="op" id="3279118">(</span><span class="op" id="3279119">)</span><br>
<span class="lineno"></span><span class="keyword" id="3279121">func</span>&nbsp;<span class="ident" id="3279126">runtime_pollOpen</span><span class="op" id="3279142">(</span><span class="ident" id="3279143">fd</span>&nbsp;<span class="builtintype" id="3279146">uintptr</span><span class="op" id="3279153">)</span>&nbsp;<span class="op" id="3279155">(</span><span class="builtintype" id="3279156">uintptr</span><span class="op" id="3279163">,</span>&nbsp;<span class="builtintype" id="3279165">int</span><span class="op" id="3279168">)</span><br>
<span class="lineno">20</span><span class="keyword" id="3279170">func</span>&nbsp;<span class="ident" id="3279175">runtime_pollClose</span><span class="op" id="3279192">(</span><span class="ident" id="3279193">ctx</span>&nbsp;<span class="builtintype" id="3279197">uintptr</span><span class="op" id="3279204">)</span><br>
<span class="lineno"></span><span class="keyword" id="3279206">func</span>&nbsp;<span class="ident" id="3279211">runtime_pollWait</span><span class="op" id="3279227">(</span><span class="ident" id="3279228">ctx</span>&nbsp;<span class="builtintype" id="3279232">uintptr</span><span class="op" id="3279239">,</span>&nbsp;<span class="ident" id="3279241">mode</span>&nbsp;<span class="builtintype" id="3279246">int</span><span class="op" id="3279249">)</span>&nbsp;<span class="builtintype" id="3279251">int</span><br>
<span class="lineno"></span><span class="keyword" id="3279255">func</span>&nbsp;<span class="ident" id="3279260">runtime_pollWaitCanceled</span><span class="op" id="3279284">(</span><span class="ident" id="3279285">ctx</span>&nbsp;<span class="builtintype" id="3279289">uintptr</span><span class="op" id="3279296">,</span>&nbsp;<span class="ident" id="3279298">mode</span>&nbsp;<span class="builtintype" id="3279303">int</span><span class="op" id="3279306">)</span>&nbsp;<span class="builtintype" id="3279308">int</span><br>
<span class="lineno"></span><span class="keyword" id="3279312">func</span>&nbsp;<span class="ident" id="3279317">runtime_pollReset</span><span class="op" id="3279334">(</span><span class="ident" id="3279335">ctx</span>&nbsp;<span class="builtintype" id="3279339">uintptr</span><span class="op" id="3279346">,</span>&nbsp;<span class="ident" id="3279348">mode</span>&nbsp;<span class="builtintype" id="3279353">int</span><span class="op" id="3279356">)</span>&nbsp;<span class="builtintype" id="3279358">int</span><br>
<span class="lineno"></span><span class="keyword" id="3279362">func</span>&nbsp;<span class="ident" id="3279367">runtime_pollSetDeadline</span><span class="op" id="3279390">(</span><span class="ident" id="3279391">ctx</span>&nbsp;<span class="builtintype" id="3279395">uintptr</span><span class="op" id="3279402">,</span>&nbsp;<span class="ident" id="3279404">d</span>&nbsp;<span class="ident" id="3279406">int64</span><span class="op" id="3279411">,</span>&nbsp;<span class="ident" id="3279413">mode</span>&nbsp;<span class="builtintype" id="3279418">int</span><span class="op" id="3279421">)</span><br>
<span class="lineno">25</span><span class="keyword" id="3279423">func</span>&nbsp;<span class="ident" id="3279428">runtime_pollUnblock</span><span class="op" id="3279447">(</span><span class="ident" id="3279448">ctx</span>&nbsp;<span class="builtintype" id="3279452">uintptr</span><span class="op" id="3279459">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3279462">type</span>&nbsp;<span class="ident" id="3279467">pollDesc</span>&nbsp;<span class="keyword" id="3279476">struct</span>&nbsp;<span class="op" id="3279483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279486">runtimeCtx</span>&nbsp;<span class="builtintype" id="3279497">uintptr</span><br>
<span class="lineno"></span><span class="op" id="3279505">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3279508">var</span>&nbsp;<span class="ident" id="3279512">serverInit</span>&nbsp;<span class="ident" id="3279523">sync</span><span class="op" id="3279527">.</span><span class="ident" id="3279528">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3279534">func</span>&nbsp;<span class="op" id="3279539">(</span><span class="ident" id="3279540">pd</span>&nbsp;<span class="op" id="3279543">*</span><span class="ident" id="3279544">pollDesc</span><span class="op" id="3279552">)</span>&nbsp;<span class="ident" id="3279554">Init</span><span class="op" id="3279558">(</span><span class="ident" id="3279559">fd</span>&nbsp;<span class="op" id="3279562">*</span><span class="ident" id="3279563">netFD</span><span class="op" id="3279568">)</span>&nbsp;<span class="builtintype" id="3279570">error</span>&nbsp;<span class="op" id="3279576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279579">serverInit</span><span class="op" id="3279589">.</span><span class="ident" id="3279590">Do</span><span class="op" id="3279592">(</span><span class="ident" id="3279593">runtime_pollServerInit</span><span class="op" id="3279615">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279618">ctx</span><span class="op" id="3279621">,</span>&nbsp;<span class="ident" id="3279623">errno</span>&nbsp;<span class="op" id="3279629">:=</span>&nbsp;<span class="ident" id="3279632">runtime_pollOpen</span><span class="op" id="3279648">(</span><span class="builtintype" id="3279649">uintptr</span><span class="op" id="3279656">(</span><span class="ident" id="3279657">fd</span><span class="op" id="3279659">.</span><span class="ident" id="3279660">sysfd</span><span class="op" id="3279665">)</span><span class="op" id="3279666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279669">if</span>&nbsp;<span class="ident" id="3279672">errno</span>&nbsp;<span class="op" id="3279678">!=</span>&nbsp;<span class="num" id="3279681">0</span>&nbsp;<span class="op" id="3279683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279687">return</span>&nbsp;<span class="ident" id="3279694">syscall</span><span class="op" id="3279701">.</span><span class="ident" id="3279702">Errno</span><span class="op" id="3279707">(</span><span class="ident" id="3279708">errno</span><span class="op" id="3279713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279719">pd</span><span class="op" id="3279721">.</span><span class="ident" id="3279722">runtimeCtx</span>&nbsp;<span class="op" id="3279733">=</span>&nbsp;<span class="ident" id="3279735">ctx</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279740">return</span>&nbsp;<span class="ident" id="3279747">nil</span><br>
<span class="lineno"></span><span class="op" id="3279751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3279754">func</span>&nbsp;<span class="op" id="3279759">(</span><span class="ident" id="3279760">pd</span>&nbsp;<span class="op" id="3279763">*</span><span class="ident" id="3279764">pollDesc</span><span class="op" id="3279772">)</span>&nbsp;<span class="ident" id="3279774">Close</span><span class="op" id="3279779">(</span><span class="op" id="3279780">)</span>&nbsp;<span class="op" id="3279782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279785">if</span>&nbsp;<span class="ident" id="3279788">pd</span><span class="op" id="3279790">.</span><span class="ident" id="3279791">runtimeCtx</span>&nbsp;<span class="op" id="3279802">==</span>&nbsp;<span class="num" id="3279805">0</span>&nbsp;<span class="op" id="3279807">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279811">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279822">runtime_pollClose</span><span class="op" id="3279839">(</span><span class="ident" id="3279840">pd</span><span class="op" id="3279842">.</span><span class="ident" id="3279843">runtimeCtx</span><span class="op" id="3279853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279856">pd</span><span class="op" id="3279858">.</span><span class="ident" id="3279859">runtimeCtx</span>&nbsp;<span class="op" id="3279870">=</span>&nbsp;<span class="num" id="3279872">0</span><br>
<span class="lineno"></span><span class="op" id="3279874">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3279877">func</span>&nbsp;<span class="op" id="3279882">(</span><span class="ident" id="3279883">pd</span>&nbsp;<span class="op" id="3279886">*</span><span class="ident" id="3279887">pollDesc</span><span class="op" id="3279895">)</span>&nbsp;<span class="ident" id="3279897">Lock</span><span class="op" id="3279901">(</span><span class="op" id="3279902">)</span>&nbsp;<span class="op" id="3279904">{</span><br>
<span class="lineno"></span><span class="op" id="3279906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3279909">func</span>&nbsp;<span class="op" id="3279914">(</span><span class="ident" id="3279915">pd</span>&nbsp;<span class="op" id="3279918">*</span><span class="ident" id="3279919">pollDesc</span><span class="op" id="3279927">)</span>&nbsp;<span class="ident" id="3279929">Unlock</span><span class="op" id="3279935">(</span><span class="op" id="3279936">)</span>&nbsp;<span class="op" id="3279938">{</span><br>
<span class="lineno">55</span><span class="op" id="3279940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3279943">func</span>&nbsp;<span class="op" id="3279948">(</span><span class="ident" id="3279949">pd</span>&nbsp;<span class="op" id="3279952">*</span><span class="ident" id="3279953">pollDesc</span><span class="op" id="3279961">)</span>&nbsp;<span class="ident" id="3279963">Wakeup</span><span class="op" id="3279969">(</span><span class="op" id="3279970">)</span>&nbsp;<span class="op" id="3279972">{</span><br>
<span class="lineno"></span><span class="op" id="3279974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3279977">//&nbsp;Evict&nbsp;evicts&nbsp;fd&nbsp;from&nbsp;the&nbsp;pending&nbsp;list,&nbsp;unblocking&nbsp;any&nbsp;I/O&nbsp;running&nbsp;on&nbsp;fd.</span><br>
<span class="lineno"></span><span class="comment" id="3280053">//&nbsp;Return&nbsp;value&nbsp;is&nbsp;whether&nbsp;the&nbsp;pollServer&nbsp;should&nbsp;be&nbsp;woken&nbsp;up.</span><br>
<span class="lineno"></span><span class="keyword" id="3280115">func</span>&nbsp;<span class="op" id="3280120">(</span><span class="ident" id="3280121">pd</span>&nbsp;<span class="op" id="3280124">*</span><span class="ident" id="3280125">pollDesc</span><span class="op" id="3280133">)</span>&nbsp;<span class="ident" id="3280135">Evict</span><span class="op" id="3280140">(</span><span class="op" id="3280141">)</span>&nbsp;<span class="builtintype" id="3280143">bool</span>&nbsp;<span class="op" id="3280148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280151">if</span>&nbsp;<span class="ident" id="3280154">pd</span><span class="op" id="3280156">.</span><span class="ident" id="3280157">runtimeCtx</span>&nbsp;<span class="op" id="3280168">==</span>&nbsp;<span class="num" id="3280171">0</span>&nbsp;<span class="op" id="3280173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280177">return</span>&nbsp;<span class="builtintype" id="3280184">false</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3280191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280194">runtime_pollUnblock</span><span class="op" id="3280213">(</span><span class="ident" id="3280214">pd</span><span class="op" id="3280216">.</span><span class="ident" id="3280217">runtimeCtx</span><span class="op" id="3280227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280230">return</span>&nbsp;<span class="builtintype" id="3280237">false</span><br>
<span class="lineno"></span><span class="op" id="3280243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="3280246">func</span>&nbsp;<span class="op" id="3280251">(</span><span class="ident" id="3280252">pd</span>&nbsp;<span class="op" id="3280255">*</span><span class="ident" id="3280256">pollDesc</span><span class="op" id="3280264">)</span>&nbsp;<span class="ident" id="3280266">Prepare</span><span class="op" id="3280273">(</span><span class="ident" id="3280274">mode</span>&nbsp;<span class="builtintype" id="3280279">int</span><span class="op" id="3280282">)</span>&nbsp;<span class="builtintype" id="3280284">error</span>&nbsp;<span class="op" id="3280290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280293">res</span>&nbsp;<span class="op" id="3280297">:=</span>&nbsp;<span class="ident" id="3280300">runtime_pollReset</span><span class="op" id="3280317">(</span><span class="ident" id="3280318">pd</span><span class="op" id="3280320">.</span><span class="ident" id="3280321">runtimeCtx</span><span class="op" id="3280331">,</span>&nbsp;<span class="ident" id="3280333">mode</span><span class="op" id="3280337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280340">return</span>&nbsp;<span class="ident" id="3280347">convertErr</span><span class="op" id="3280357">(</span><span class="ident" id="3280358">res</span><span class="op" id="3280361">)</span><br>
<span class="lineno"></span><span class="op" id="3280363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="3280366">func</span>&nbsp;<span class="op" id="3280371">(</span><span class="ident" id="3280372">pd</span>&nbsp;<span class="op" id="3280375">*</span><span class="ident" id="3280376">pollDesc</span><span class="op" id="3280384">)</span>&nbsp;<span class="ident" id="3280386">PrepareRead</span><span class="op" id="3280397">(</span><span class="op" id="3280398">)</span>&nbsp;<span class="builtintype" id="3280400">error</span>&nbsp;<span class="op" id="3280406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280409">return</span>&nbsp;<span class="ident" id="3280416">pd</span><span class="op" id="3280418">.</span><span class="ident" id="3280419">Prepare</span><span class="op" id="3280426">(</span><span class="string" id="3280427">&#39;r&#39;</span><span class="op" id="3280430">)</span><br>
<span class="lineno"></span><span class="op" id="3280432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280435">func</span>&nbsp;<span class="op" id="3280440">(</span><span class="ident" id="3280441">pd</span>&nbsp;<span class="op" id="3280444">*</span><span class="ident" id="3280445">pollDesc</span><span class="op" id="3280453">)</span>&nbsp;<span class="ident" id="3280455">PrepareWrite</span><span class="op" id="3280467">(</span><span class="op" id="3280468">)</span>&nbsp;<span class="builtintype" id="3280470">error</span>&nbsp;<span class="op" id="3280476">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280479">return</span>&nbsp;<span class="ident" id="3280486">pd</span><span class="op" id="3280488">.</span><span class="ident" id="3280489">Prepare</span><span class="op" id="3280496">(</span><span class="string" id="3280497">&#39;w&#39;</span><span class="op" id="3280500">)</span><br>
<span class="lineno"></span><span class="op" id="3280502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280505">func</span>&nbsp;<span class="op" id="3280510">(</span><span class="ident" id="3280511">pd</span>&nbsp;<span class="op" id="3280514">*</span><span class="ident" id="3280515">pollDesc</span><span class="op" id="3280523">)</span>&nbsp;<span class="ident" id="3280525">Wait</span><span class="op" id="3280529">(</span><span class="ident" id="3280530">mode</span>&nbsp;<span class="builtintype" id="3280535">int</span><span class="op" id="3280538">)</span>&nbsp;<span class="builtintype" id="3280540">error</span>&nbsp;<span class="op" id="3280546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280549">res</span>&nbsp;<span class="op" id="3280553">:=</span>&nbsp;<span class="ident" id="3280556">runtime_pollWait</span><span class="op" id="3280572">(</span><span class="ident" id="3280573">pd</span><span class="op" id="3280575">.</span><span class="ident" id="3280576">runtimeCtx</span><span class="op" id="3280586">,</span>&nbsp;<span class="ident" id="3280588">mode</span><span class="op" id="3280592">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280595">return</span>&nbsp;<span class="ident" id="3280602">convertErr</span><span class="op" id="3280612">(</span><span class="ident" id="3280613">res</span><span class="op" id="3280616">)</span><br>
<span class="lineno"></span><span class="op" id="3280618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280621">func</span>&nbsp;<span class="op" id="3280626">(</span><span class="ident" id="3280627">pd</span>&nbsp;<span class="op" id="3280630">*</span><span class="ident" id="3280631">pollDesc</span><span class="op" id="3280639">)</span>&nbsp;<span class="ident" id="3280641">WaitRead</span><span class="op" id="3280649">(</span><span class="op" id="3280650">)</span>&nbsp;<span class="builtintype" id="3280652">error</span>&nbsp;<span class="op" id="3280658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280661">return</span>&nbsp;<span class="ident" id="3280668">pd</span><span class="op" id="3280670">.</span><span class="ident" id="3280671">Wait</span><span class="op" id="3280675">(</span><span class="string" id="3280676">&#39;r&#39;</span><span class="op" id="3280679">)</span><br>
<span class="lineno">90</span><span class="op" id="3280681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280684">func</span>&nbsp;<span class="op" id="3280689">(</span><span class="ident" id="3280690">pd</span>&nbsp;<span class="op" id="3280693">*</span><span class="ident" id="3280694">pollDesc</span><span class="op" id="3280702">)</span>&nbsp;<span class="ident" id="3280704">WaitWrite</span><span class="op" id="3280713">(</span><span class="op" id="3280714">)</span>&nbsp;<span class="builtintype" id="3280716">error</span>&nbsp;<span class="op" id="3280722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280725">return</span>&nbsp;<span class="ident" id="3280732">pd</span><span class="op" id="3280734">.</span><span class="ident" id="3280735">Wait</span><span class="op" id="3280739">(</span><span class="string" id="3280740">&#39;w&#39;</span><span class="op" id="3280743">)</span><br>
<span class="lineno"></span><span class="op" id="3280745">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3280748">func</span>&nbsp;<span class="op" id="3280753">(</span><span class="ident" id="3280754">pd</span>&nbsp;<span class="op" id="3280757">*</span><span class="ident" id="3280758">pollDesc</span><span class="op" id="3280766">)</span>&nbsp;<span class="ident" id="3280768">WaitCanceled</span><span class="op" id="3280780">(</span><span class="ident" id="3280781">mode</span>&nbsp;<span class="builtintype" id="3280786">int</span><span class="op" id="3280789">)</span>&nbsp;<span class="op" id="3280791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280794">runtime_pollWaitCanceled</span><span class="op" id="3280818">(</span><span class="ident" id="3280819">pd</span><span class="op" id="3280821">.</span><span class="ident" id="3280822">runtimeCtx</span><span class="op" id="3280832">,</span>&nbsp;<span class="ident" id="3280834">mode</span><span class="op" id="3280838">)</span><br>
<span class="lineno"></span><span class="op" id="3280840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3280843">func</span>&nbsp;<span class="op" id="3280848">(</span><span class="ident" id="3280849">pd</span>&nbsp;<span class="op" id="3280852">*</span><span class="ident" id="3280853">pollDesc</span><span class="op" id="3280861">)</span>&nbsp;<span class="ident" id="3280863">WaitCanceledRead</span><span class="op" id="3280879">(</span><span class="op" id="3280880">)</span>&nbsp;<span class="op" id="3280882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280885">pd</span><span class="op" id="3280887">.</span><span class="ident" id="3280888">WaitCanceled</span><span class="op" id="3280900">(</span><span class="string" id="3280901">&#39;r&#39;</span><span class="op" id="3280904">)</span><br>
<span class="lineno"></span><span class="op" id="3280906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280909">func</span>&nbsp;<span class="op" id="3280914">(</span><span class="ident" id="3280915">pd</span>&nbsp;<span class="op" id="3280918">*</span><span class="ident" id="3280919">pollDesc</span><span class="op" id="3280927">)</span>&nbsp;<span class="ident" id="3280929">WaitCanceledWrite</span><span class="op" id="3280946">(</span><span class="op" id="3280947">)</span>&nbsp;<span class="op" id="3280949">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280952">pd</span><span class="op" id="3280954">.</span><span class="ident" id="3280955">WaitCanceled</span><span class="op" id="3280967">(</span><span class="string" id="3280968">&#39;w&#39;</span><span class="op" id="3280971">)</span><br>
<span class="lineno"></span><span class="op" id="3280973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280976">func</span>&nbsp;<span class="ident" id="3280981">convertErr</span><span class="op" id="3280991">(</span><span class="ident" id="3280992">res</span>&nbsp;<span class="builtintype" id="3280996">int</span><span class="op" id="3280999">)</span>&nbsp;<span class="builtintype" id="3281001">error</span>&nbsp;<span class="op" id="3281007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281010">switch</span>&nbsp;<span class="ident" id="3281017">res</span>&nbsp;<span class="op" id="3281021">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281024">case</span>&nbsp;<span class="num" id="3281029">0</span><span class="op" id="3281030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281034">return</span>&nbsp;<span class="ident" id="3281041">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281046">case</span>&nbsp;<span class="num" id="3281051">1</span><span class="op" id="3281052">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281056">return</span>&nbsp;<span class="ident" id="3281063">errClosing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281075">case</span>&nbsp;<span class="num" id="3281080">2</span><span class="op" id="3281081">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281085">return</span>&nbsp;<span class="ident" id="3281092">errTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3281104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3281107">println</span><span class="op" id="3281114">(</span><span class="string" id="3281115">&#34;unreachable:&nbsp;&#34;</span><span class="op" id="3281130">,</span>&nbsp;<span class="ident" id="3281132">res</span><span class="op" id="3281135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3281138">panic</span><span class="op" id="3281143">(</span><span class="string" id="3281144">&#34;unreachable&#34;</span><span class="op" id="3281157">)</span><br>
<span class="lineno"></span><span class="op" id="3281159">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="3281162">func</span>&nbsp;<span class="op" id="3281167">(</span><span class="ident" id="3281168">fd</span>&nbsp;<span class="op" id="3281171">*</span><span class="ident" id="3281172">netFD</span><span class="op" id="3281177">)</span>&nbsp;<span class="ident" id="3281179">setDeadline</span><span class="op" id="3281190">(</span><span class="ident" id="3281191">t</span>&nbsp;<span class="ident" id="3281193">time</span><span class="op" id="3281197">.</span><span class="ident" id="3281198">Time</span><span class="op" id="3281202">)</span>&nbsp;<span class="builtintype" id="3281204">error</span>&nbsp;<span class="op" id="3281210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281213">return</span>&nbsp;<span class="ident" id="3281220">setDeadlineImpl</span><span class="op" id="3281235">(</span><span class="ident" id="3281236">fd</span><span class="op" id="3281238">,</span>&nbsp;<span class="ident" id="3281240">t</span><span class="op" id="3281241">,</span>&nbsp;<span class="string" id="3281243">&#39;r&#39;</span><span class="op" id="3281246">+</span><span class="string" id="3281247">&#39;w&#39;</span><span class="op" id="3281250">)</span><br>
<span class="lineno"></span><span class="op" id="3281252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="3281255">func</span>&nbsp;<span class="op" id="3281260">(</span><span class="ident" id="3281261">fd</span>&nbsp;<span class="op" id="3281264">*</span><span class="ident" id="3281265">netFD</span><span class="op" id="3281270">)</span>&nbsp;<span class="ident" id="3281272">setReadDeadline</span><span class="op" id="3281287">(</span><span class="ident" id="3281288">t</span>&nbsp;<span class="ident" id="3281290">time</span><span class="op" id="3281294">.</span><span class="ident" id="3281295">Time</span><span class="op" id="3281299">)</span>&nbsp;<span class="builtintype" id="3281301">error</span>&nbsp;<span class="op" id="3281307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281310">return</span>&nbsp;<span class="ident" id="3281317">setDeadlineImpl</span><span class="op" id="3281332">(</span><span class="ident" id="3281333">fd</span><span class="op" id="3281335">,</span>&nbsp;<span class="ident" id="3281337">t</span><span class="op" id="3281338">,</span>&nbsp;<span class="string" id="3281340">&#39;r&#39;</span><span class="op" id="3281343">)</span><br>
<span class="lineno"></span><span class="op" id="3281345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3281348">func</span>&nbsp;<span class="op" id="3281353">(</span><span class="ident" id="3281354">fd</span>&nbsp;<span class="op" id="3281357">*</span><span class="ident" id="3281358">netFD</span><span class="op" id="3281363">)</span>&nbsp;<span class="ident" id="3281365">setWriteDeadline</span><span class="op" id="3281381">(</span><span class="ident" id="3281382">t</span>&nbsp;<span class="ident" id="3281384">time</span><span class="op" id="3281388">.</span><span class="ident" id="3281389">Time</span><span class="op" id="3281393">)</span>&nbsp;<span class="builtintype" id="3281395">error</span>&nbsp;<span class="op" id="3281401">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281404">return</span>&nbsp;<span class="ident" id="3281411">setDeadlineImpl</span><span class="op" id="3281426">(</span><span class="ident" id="3281427">fd</span><span class="op" id="3281429">,</span>&nbsp;<span class="ident" id="3281431">t</span><span class="op" id="3281432">,</span>&nbsp;<span class="string" id="3281434">&#39;w&#39;</span><span class="op" id="3281437">)</span><br>
<span class="lineno"></span><span class="op" id="3281439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3281442">func</span>&nbsp;<span class="ident" id="3281447">setDeadlineImpl</span><span class="op" id="3281462">(</span><span class="ident" id="3281463">fd</span>&nbsp;<span class="op" id="3281466">*</span><span class="ident" id="3281467">netFD</span><span class="op" id="3281472">,</span>&nbsp;<span class="ident" id="3281474">t</span>&nbsp;<span class="ident" id="3281476">time</span><span class="op" id="3281480">.</span><span class="ident" id="3281481">Time</span><span class="op" id="3281485">,</span>&nbsp;<span class="ident" id="3281487">mode</span>&nbsp;<span class="builtintype" id="3281492">int</span><span class="op" id="3281495">)</span>&nbsp;<span class="builtintype" id="3281497">error</span>&nbsp;<span class="op" id="3281503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281506">d</span>&nbsp;<span class="op" id="3281508">:=</span>&nbsp;<span class="ident" id="3281511">runtimeNano</span><span class="op" id="3281522">(</span><span class="op" id="3281523">)</span>&nbsp;<span class="op" id="3281525">+</span>&nbsp;<span class="ident" id="3281527">int64</span><span class="op" id="3281532">(</span><span class="ident" id="3281533">t</span><span class="op" id="3281534">.</span><span class="ident" id="3281535">Sub</span><span class="op" id="3281538">(</span><span class="ident" id="3281539">time</span><span class="op" id="3281543">.</span><span class="ident" id="3281544">Now</span><span class="op" id="3281547">(</span><span class="op" id="3281548">)</span><span class="op" id="3281549">)</span><span class="op" id="3281550">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281553">if</span>&nbsp;<span class="ident" id="3281556">t</span><span class="op" id="3281557">.</span><span class="ident" id="3281558">IsZero</span><span class="op" id="3281564">(</span><span class="op" id="3281565">)</span>&nbsp;<span class="op" id="3281567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281571">d</span>&nbsp;<span class="op" id="3281573">=</span>&nbsp;<span class="num" id="3281575">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3281578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281581">if</span>&nbsp;<span class="ident" id="3281584">err</span>&nbsp;<span class="op" id="3281588">:=</span>&nbsp;<span class="ident" id="3281591">fd</span><span class="op" id="3281593">.</span><span class="ident" id="3281594">incref</span><span class="op" id="3281600">(</span><span class="op" id="3281601">)</span><span class="op" id="3281602">;</span>&nbsp;<span class="ident" id="3281604">err</span>&nbsp;<span class="op" id="3281608">!=</span>&nbsp;<span class="ident" id="3281611">nil</span>&nbsp;<span class="op" id="3281615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281619">return</span>&nbsp;<span class="ident" id="3281626">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3281631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281634">runtime_pollSetDeadline</span><span class="op" id="3281657">(</span><span class="ident" id="3281658">fd</span><span class="op" id="3281660">.</span><span class="ident" id="3281661">pd</span><span class="op" id="3281663">.</span><span class="ident" id="3281664">runtimeCtx</span><span class="op" id="3281674">,</span>&nbsp;<span class="ident" id="3281676">d</span><span class="op" id="3281677">,</span>&nbsp;<span class="ident" id="3281679">mode</span><span class="op" id="3281683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281686">fd</span><span class="op" id="3281688">.</span><span class="ident" id="3281689">decref</span><span class="op" id="3281695">(</span><span class="op" id="3281696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281699">return</span>&nbsp;<span class="ident" id="3281706">nil</span><br>
<span class="lineno"></span><span class="op" id="3281710">}</span>
</div>
</body>
</html>
