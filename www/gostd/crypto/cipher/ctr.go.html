<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html" class="current">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3738651">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3738706">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3738760">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3738811">//&nbsp;Counter&nbsp;(CTR)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3738835">//&nbsp;CTR&nbsp;converts&nbsp;a&nbsp;block&nbsp;cipher&nbsp;into&nbsp;a&nbsp;stream&nbsp;cipher&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3738890">//&nbsp;repeatedly&nbsp;encrypting&nbsp;an&nbsp;incrementing&nbsp;counter&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3738943">//&nbsp;xoring&nbsp;the&nbsp;resulting&nbsp;stream&nbsp;of&nbsp;data&nbsp;with&nbsp;the&nbsp;input.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3738999">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;13-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3739033">package</span>&nbsp;<span class="ident" id="3739041">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3739049">type</span>&nbsp;<span class="ident" id="3739054">ctr</span>&nbsp;<span class="keyword" id="3739058">struct</span>&nbsp;<span class="op" id="3739065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739068">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739076">Block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739083">ctr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3739091">[</span><span class="op" id="3739092">]</span><span class="builtintype" id="3739093">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739099">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3739107">[</span><span class="op" id="3739108">]</span><span class="builtintype" id="3739109">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739115">outUsed</span>&nbsp;<span class="builtintype" id="3739123">int</span><br>
<span class="lineno">20</span><span class="op" id="3739127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3739130">const</span>&nbsp;<span class="ident" id="3739136">streamBufferSize</span>&nbsp;<span class="op" id="3739153">=</span>&nbsp;<span class="num" id="3739155">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3739160">//&nbsp;NewCTR&nbsp;returns&nbsp;a&nbsp;Stream&nbsp;which&nbsp;encrypts/decrypts&nbsp;using&nbsp;the&nbsp;given&nbsp;Block&nbsp;in</span><br>
<span class="lineno">25</span><span class="comment" id="3739236">//&nbsp;counter&nbsp;mode.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="3739314">func</span>&nbsp;<span class="ident" id="3739319">NewCTR</span><span class="op" id="3739325">(</span><span class="ident" id="3739326">block</span>&nbsp;<span class="ident" id="3739332">Block</span><span class="op" id="3739337">,</span>&nbsp;<span class="ident" id="3739339">iv</span>&nbsp;<span class="op" id="3739342">[</span><span class="op" id="3739343">]</span><span class="builtintype" id="3739344">byte</span><span class="op" id="3739348">)</span>&nbsp;<span class="ident" id="3739350">Stream</span>&nbsp;<span class="op" id="3739357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3739360">if</span>&nbsp;<span class="builtinfunc" id="3739363">len</span><span class="op" id="3739366">(</span><span class="ident" id="3739367">iv</span><span class="op" id="3739369">)</span>&nbsp;<span class="op" id="3739371">!=</span>&nbsp;<span class="ident" id="3739374">block</span><span class="op" id="3739379">.</span><span class="ident" id="3739380">BlockSize</span><span class="op" id="3739389">(</span><span class="op" id="3739390">)</span>&nbsp;<span class="op" id="3739392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3739396">panic</span><span class="op" id="3739401">(</span><span class="string" id="3739402">&#34;cipher.NewCTR:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="3739450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3739453">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739456">bufSize</span>&nbsp;<span class="op" id="3739464">:=</span>&nbsp;<span class="ident" id="3739467">streamBufferSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3739485">if</span>&nbsp;<span class="ident" id="3739488">bufSize</span>&nbsp;<span class="op" id="3739496">&lt;</span>&nbsp;<span class="ident" id="3739498">block</span><span class="op" id="3739503">.</span><span class="ident" id="3739504">BlockSize</span><span class="op" id="3739513">(</span><span class="op" id="3739514">)</span>&nbsp;<span class="op" id="3739516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739520">bufSize</span>&nbsp;<span class="op" id="3739528">=</span>&nbsp;<span class="ident" id="3739530">block</span><span class="op" id="3739535">.</span><span class="ident" id="3739536">BlockSize</span><span class="op" id="3739545">(</span><span class="op" id="3739546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3739549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3739552">return</span>&nbsp;<span class="op" id="3739559">&amp;</span><span class="ident" id="3739560">ctr</span><span class="op" id="3739563">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739567">b</span><span class="op" id="3739568">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739576">block</span><span class="op" id="3739581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739585">ctr</span><span class="op" id="3739588">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739594">dup</span><span class="op" id="3739597">(</span><span class="ident" id="3739598">iv</span><span class="op" id="3739600">)</span><span class="op" id="3739601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739605">out</span><span class="op" id="3739608">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3739614">make</span><span class="op" id="3739618">(</span><span class="op" id="3739619">[</span><span class="op" id="3739620">]</span><span class="builtintype" id="3739621">byte</span><span class="op" id="3739625">,</span>&nbsp;<span class="num" id="3739627">0</span><span class="op" id="3739628">,</span>&nbsp;<span class="ident" id="3739630">bufSize</span><span class="op" id="3739637">)</span><span class="op" id="3739638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739642">outUsed</span><span class="op" id="3739649">:</span>&nbsp;<span class="num" id="3739651">0</span><span class="op" id="3739652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3739655">}</span><br>
<span class="lineno">40</span><span class="op" id="3739657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3739660">func</span>&nbsp;<span class="op" id="3739665">(</span><span class="ident" id="3739666">x</span>&nbsp;<span class="op" id="3739668">*</span><span class="ident" id="3739669">ctr</span><span class="op" id="3739672">)</span>&nbsp;<span class="ident" id="3739674">refill</span><span class="op" id="3739680">(</span><span class="op" id="3739681">)</span>&nbsp;<span class="op" id="3739683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739686">remain</span>&nbsp;<span class="op" id="3739693">:=</span>&nbsp;<span class="builtinfunc" id="3739696">len</span><span class="op" id="3739699">(</span><span class="ident" id="3739700">x</span><span class="op" id="3739701">.</span><span class="ident" id="3739702">out</span><span class="op" id="3739705">)</span>&nbsp;<span class="op" id="3739707">-</span>&nbsp;<span class="ident" id="3739709">x</span><span class="op" id="3739710">.</span><span class="ident" id="3739711">outUsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3739720">if</span>&nbsp;<span class="ident" id="3739723">remain</span>&nbsp;<span class="op" id="3739730">&gt;</span>&nbsp;<span class="ident" id="3739732">x</span><span class="op" id="3739733">.</span><span class="ident" id="3739734">outUsed</span>&nbsp;<span class="op" id="3739742">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3739746">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3739754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3739757">copy</span><span class="op" id="3739761">(</span><span class="ident" id="3739762">x</span><span class="op" id="3739763">.</span><span class="ident" id="3739764">out</span><span class="op" id="3739767">,</span>&nbsp;<span class="ident" id="3739769">x</span><span class="op" id="3739770">.</span><span class="ident" id="3739771">out</span><span class="op" id="3739774">[</span><span class="ident" id="3739775">x</span><span class="op" id="3739776">.</span><span class="ident" id="3739777">outUsed</span><span class="op" id="3739784">:</span><span class="op" id="3739785">]</span><span class="op" id="3739786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739789">x</span><span class="op" id="3739790">.</span><span class="ident" id="3739791">out</span>&nbsp;<span class="op" id="3739795">=</span>&nbsp;<span class="ident" id="3739797">x</span><span class="op" id="3739798">.</span><span class="ident" id="3739799">out</span><span class="op" id="3739802">[</span><span class="op" id="3739803">:</span><span class="builtinfunc" id="3739804">cap</span><span class="op" id="3739807">(</span><span class="ident" id="3739808">x</span><span class="op" id="3739809">.</span><span class="ident" id="3739810">out</span><span class="op" id="3739813">)</span><span class="op" id="3739814">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739817">bs</span>&nbsp;<span class="op" id="3739820">:=</span>&nbsp;<span class="ident" id="3739823">x</span><span class="op" id="3739824">.</span><span class="ident" id="3739825">b</span><span class="op" id="3739826">.</span><span class="ident" id="3739827">BlockSize</span><span class="op" id="3739836">(</span><span class="op" id="3739837">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3739840">for</span>&nbsp;<span class="ident" id="3739844">remain</span>&nbsp;<span class="op" id="3739851">&lt;</span>&nbsp;<span class="builtinfunc" id="3739853">len</span><span class="op" id="3739856">(</span><span class="ident" id="3739857">x</span><span class="op" id="3739858">.</span><span class="ident" id="3739859">out</span><span class="op" id="3739862">)</span><span class="op" id="3739863">-</span><span class="ident" id="3739864">bs</span>&nbsp;<span class="op" id="3739867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739871">x</span><span class="op" id="3739872">.</span><span class="ident" id="3739873">b</span><span class="op" id="3739874">.</span><span class="ident" id="3739875">Encrypt</span><span class="op" id="3739882">(</span><span class="ident" id="3739883">x</span><span class="op" id="3739884">.</span><span class="ident" id="3739885">out</span><span class="op" id="3739888">[</span><span class="ident" id="3739889">remain</span><span class="op" id="3739895">:</span><span class="op" id="3739896">]</span><span class="op" id="3739897">,</span>&nbsp;<span class="ident" id="3739899">x</span><span class="op" id="3739900">.</span><span class="ident" id="3739901">ctr</span><span class="op" id="3739904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739908">remain</span>&nbsp;<span class="op" id="3739915">+=</span>&nbsp;<span class="ident" id="3739918">bs</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3739924">//&nbsp;Increment&nbsp;counter</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3739947">for</span>&nbsp;<span class="ident" id="3739951">i</span>&nbsp;<span class="op" id="3739953">:=</span>&nbsp;<span class="builtinfunc" id="3739956">len</span><span class="op" id="3739959">(</span><span class="ident" id="3739960">x</span><span class="op" id="3739961">.</span><span class="ident" id="3739962">ctr</span><span class="op" id="3739965">)</span>&nbsp;<span class="op" id="3739967">-</span>&nbsp;<span class="num" id="3739969">1</span><span class="op" id="3739970">;</span>&nbsp;<span class="ident" id="3739972">i</span>&nbsp;<span class="op" id="3739974">&gt;=</span>&nbsp;<span class="num" id="3739977">0</span><span class="op" id="3739978">;</span>&nbsp;<span class="ident" id="3739980">i</span><span class="op" id="3739981">--</span>&nbsp;<span class="op" id="3739984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3739989">x</span><span class="op" id="3739990">.</span><span class="ident" id="3739991">ctr</span><span class="op" id="3739994">[</span><span class="ident" id="3739995">i</span><span class="op" id="3739996">]</span><span class="op" id="3739997">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3740003">if</span>&nbsp;<span class="ident" id="3740006">x</span><span class="op" id="3740007">.</span><span class="ident" id="3740008">ctr</span><span class="op" id="3740011">[</span><span class="ident" id="3740012">i</span><span class="op" id="3740013">]</span>&nbsp;<span class="op" id="3740015">!=</span>&nbsp;<span class="num" id="3740018">0</span>&nbsp;<span class="op" id="3740020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3740026">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3740035">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3740039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3740042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3740045">x</span><span class="op" id="3740046">.</span><span class="ident" id="3740047">out</span>&nbsp;<span class="op" id="3740051">=</span>&nbsp;<span class="ident" id="3740053">x</span><span class="op" id="3740054">.</span><span class="ident" id="3740055">out</span><span class="op" id="3740058">[</span><span class="op" id="3740059">:</span><span class="ident" id="3740060">remain</span><span class="op" id="3740066">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3740069">x</span><span class="op" id="3740070">.</span><span class="ident" id="3740071">outUsed</span>&nbsp;<span class="op" id="3740079">=</span>&nbsp;<span class="num" id="3740081">0</span><br>
<span class="lineno"></span><span class="op" id="3740083">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3740086">func</span>&nbsp;<span class="op" id="3740091">(</span><span class="ident" id="3740092">x</span>&nbsp;<span class="op" id="3740094">*</span><span class="ident" id="3740095">ctr</span><span class="op" id="3740098">)</span>&nbsp;<span class="ident" id="3740100">XORKeyStream</span><span class="op" id="3740112">(</span><span class="ident" id="3740113">dst</span><span class="op" id="3740116">,</span>&nbsp;<span class="ident" id="3740118">src</span>&nbsp;<span class="op" id="3740122">[</span><span class="op" id="3740123">]</span><span class="builtintype" id="3740124">byte</span><span class="op" id="3740128">)</span>&nbsp;<span class="op" id="3740130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3740133">for</span>&nbsp;<span class="builtinfunc" id="3740137">len</span><span class="op" id="3740140">(</span><span class="ident" id="3740141">src</span><span class="op" id="3740144">)</span>&nbsp;<span class="op" id="3740146">&gt;</span>&nbsp;<span class="num" id="3740148">0</span>&nbsp;<span class="op" id="3740150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3740154">if</span>&nbsp;<span class="ident" id="3740157">x</span><span class="op" id="3740158">.</span><span class="ident" id="3740159">outUsed</span>&nbsp;<span class="op" id="3740167">&gt;=</span>&nbsp;<span class="builtinfunc" id="3740170">len</span><span class="op" id="3740173">(</span><span class="ident" id="3740174">x</span><span class="op" id="3740175">.</span><span class="ident" id="3740176">out</span><span class="op" id="3740179">)</span><span class="op" id="3740180">-</span><span class="ident" id="3740181">x</span><span class="op" id="3740182">.</span><span class="ident" id="3740183">b</span><span class="op" id="3740184">.</span><span class="ident" id="3740185">BlockSize</span><span class="op" id="3740194">(</span><span class="op" id="3740195">)</span>&nbsp;<span class="op" id="3740197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3740202">x</span><span class="op" id="3740203">.</span><span class="ident" id="3740204">refill</span><span class="op" id="3740210">(</span><span class="op" id="3740211">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3740215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3740219">n</span>&nbsp;<span class="op" id="3740221">:=</span>&nbsp;<span class="ident" id="3740224">xorBytes</span><span class="op" id="3740232">(</span><span class="ident" id="3740233">dst</span><span class="op" id="3740236">,</span>&nbsp;<span class="ident" id="3740238">src</span><span class="op" id="3740241">,</span>&nbsp;<span class="ident" id="3740243">x</span><span class="op" id="3740244">.</span><span class="ident" id="3740245">out</span><span class="op" id="3740248">[</span><span class="ident" id="3740249">x</span><span class="op" id="3740250">.</span><span class="ident" id="3740251">outUsed</span><span class="op" id="3740258">:</span><span class="op" id="3740259">]</span><span class="op" id="3740260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3740264">dst</span>&nbsp;<span class="op" id="3740268">=</span>&nbsp;<span class="ident" id="3740270">dst</span><span class="op" id="3740273">[</span><span class="ident" id="3740274">n</span><span class="op" id="3740275">:</span><span class="op" id="3740276">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3740280">src</span>&nbsp;<span class="op" id="3740284">=</span>&nbsp;<span class="ident" id="3740286">src</span><span class="op" id="3740289">[</span><span class="ident" id="3740290">n</span><span class="op" id="3740291">:</span><span class="op" id="3740292">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3740296">x</span><span class="op" id="3740297">.</span><span class="ident" id="3740298">outUsed</span>&nbsp;<span class="op" id="3740306">+=</span>&nbsp;<span class="ident" id="3740309">n</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3740312">}</span><br>
<span class="lineno"></span><span class="op" id="3740314">}</span>
</div>
</body>
</html>
