<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6873577">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6873632">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6873686">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6873737">package</span>&nbsp;<span class="ident" id="6873745">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6873750">import</span>&nbsp;<span class="op" id="6873757">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6873760">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6873766">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6873779">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6873785">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6873796">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6873807">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6873814">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6873817">func</span>&nbsp;<span class="ident" id="6873822">TestShutdown</span><span class="op" id="6873834">(</span><span class="ident" id="6873835">t</span>&nbsp;<span class="op" id="6873837">*</span><span class="ident" id="6873838"><a href="/net/net_test.go.html#6873796">testing</a></span><span class="op" id="6873845">.</span><span class="ident" id="6873846">T</span><span class="op" id="6873847">)</span>&nbsp;<span class="op" id="6873849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873852">if</span>&nbsp;<span class="ident" id="6873855"><a href="/net/net_test.go.html#6873785">runtime</a></span><span class="op" id="6873862">.</span><span class="ident" id="6873863">GOOS</span>&nbsp;<span class="op" id="6873868">==</span>&nbsp;<span class="string" id="6873871">&#34;plan9&#34;</span>&nbsp;<span class="op" id="6873879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873883"><a href="/net/net_test.go.html#6873835">t</a></span><span class="op" id="6873884">.</span><span class="ident" id="6873885">Skipf</span><span class="op" id="6873890">(</span><span class="string" id="6873891">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6873912">,</span>&nbsp;<span class="ident" id="6873914"><a href="/net/net_test.go.html#6873785">runtime</a></span><span class="op" id="6873921">.</span><span class="ident" id="6873922">GOOS</span><span class="op" id="6873926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873929">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873932">ln</span><span class="op" id="6873934">,</span>&nbsp;<span class="ident" id="6873936">err</span>&nbsp;<span class="op" id="6873940">:=</span>&nbsp;<span class="ident" id="6873943"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6873949">(</span><span class="string" id="6873950">&#34;tcp&#34;</span><span class="op" id="6873955">,</span>&nbsp;<span class="string" id="6873957">&#34;127.0.0.1:0&#34;</span><span class="op" id="6873970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873973">if</span>&nbsp;<span class="ident" id="6873976"><a href="/net/net_test.go.html#6873936">err</a></span>&nbsp;<span class="op" id="6873980">!=</span>&nbsp;<span class="ident" id="6873983">nil</span>&nbsp;<span class="op" id="6873987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873991">if</span>&nbsp;<span class="ident" id="6873994"><a href="/net/net_test.go.html#6873932">ln</a></span><span class="op" id="6873996">,</span>&nbsp;<span class="ident" id="6873998"><a href="/net/net_test.go.html#6873936">err</a></span>&nbsp;<span class="op" id="6874002">=</span>&nbsp;<span class="ident" id="6874004"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6874010">(</span><span class="string" id="6874011">&#34;tcp6&#34;</span><span class="op" id="6874017">,</span>&nbsp;<span class="string" id="6874019">&#34;[::1]:0&#34;</span><span class="op" id="6874028">)</span><span class="op" id="6874029">;</span>&nbsp;<span class="ident" id="6874031"><a href="/net/net_test.go.html#6873936">err</a></span>&nbsp;<span class="op" id="6874035">!=</span>&nbsp;<span class="ident" id="6874038">nil</span>&nbsp;<span class="op" id="6874042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874047"><a href="/net/net_test.go.html#6873835">t</a></span><span class="op" id="6874048">.</span><span class="ident" id="6874049">Fatalf</span><span class="op" id="6874055">(</span><span class="string" id="6874056">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="6874077">,</span>&nbsp;<span class="ident" id="6874079"><a href="/net/net_test.go.html#6873936">err</a></span><span class="op" id="6874082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874086">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874093">go</span>&nbsp;<span class="keyword" id="6874096">func</span><span class="op" id="6874100">(</span><span class="op" id="6874101">)</span>&nbsp;<span class="op" id="6874103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874107">defer</span>&nbsp;<span class="ident" id="6874113"><a href="/net/net_test.go.html#6873932">ln</a></span><span class="op" id="6874115">.</span><span class="ident" id="6874116">Close</span><span class="op" id="6874121">(</span><span class="op" id="6874122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874126">c</span><span class="op" id="6874127">,</span>&nbsp;<span class="ident" id="6874129">err</span>&nbsp;<span class="op" id="6874133">:=</span>&nbsp;<span class="ident" id="6874136"><a href="/net/net_test.go.html#6873932">ln</a></span><span class="op" id="6874138">.</span><span class="ident" id="6874139">Accept</span><span class="op" id="6874145">(</span><span class="op" id="6874146">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874150">if</span>&nbsp;<span class="ident" id="6874153"><a href="/net/net_test.go.html#6874129">err</a></span>&nbsp;<span class="op" id="6874157">!=</span>&nbsp;<span class="ident" id="6874160">nil</span>&nbsp;<span class="op" id="6874164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874169"><a href="/net/net_test.go.html#6873835">t</a></span><span class="op" id="6874170">.</span><span class="ident" id="6874171">Errorf</span><span class="op" id="6874177">(</span><span class="string" id="6874178">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6874190">,</span>&nbsp;<span class="ident" id="6874192"><a href="/net/net_test.go.html#6874129">err</a></span><span class="op" id="6874195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874200">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874213">var</span>&nbsp;<span class="ident" id="6874217">buf</span>&nbsp;<span class="op" id="6874221">[</span><span class="num" id="6874222">10</span><span class="op" id="6874224">]</span><span class="builtintype" id="6874225">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874232">n</span><span class="op" id="6874233">,</span>&nbsp;<span class="ident" id="6874235"><a href="/net/net_test.go.html#6874129">err</a></span>&nbsp;<span class="op" id="6874239">:=</span>&nbsp;<span class="ident" id="6874242"><a href="/net/net_test.go.html#6874126">c</a></span><span class="op" id="6874243">.</span><span class="ident" id="6874244">Read</span><span class="op" id="6874248">(</span><span class="ident" id="6874249"><a href="/net/net_test.go.html#6874217">buf</a></span><span class="op" id="6874252">[</span><span class="op" id="6874253">:</span><span class="op" id="6874254">]</span><span class="op" id="6874255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874259">if</span>&nbsp;<span class="ident" id="6874262"><a href="/net/net_test.go.html#6874232">n</a></span>&nbsp;<span class="op" id="6874264">!=</span>&nbsp;<span class="num" id="6874267">0</span>&nbsp;<span class="op" id="6874269">||</span>&nbsp;<span class="ident" id="6874272"><a href="/net/net_test.go.html#6874129">err</a></span>&nbsp;<span class="op" id="6874276">!=</span>&nbsp;<span class="ident" id="6874279"><a href="/net/net_test.go.html#6873760">io</a></span><span class="op" id="6874281">.</span><span class="ident" id="6874282">EOF</span>&nbsp;<span class="op" id="6874286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874291"><a href="/net/net_test.go.html#6873835">t</a></span><span class="op" id="6874292">.</span><span class="ident" id="6874293">Errorf</span><span class="op" id="6874299">(</span><span class="string" id="6874300">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="6874338">,</span>&nbsp;<span class="ident" id="6874340"><a href="/net/net_test.go.html#6874232">n</a></span><span class="op" id="6874341">,</span>&nbsp;<span class="ident" id="6874343"><a href="/net/net_test.go.html#6874129">err</a></span><span class="op" id="6874346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874351">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874360">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874364"><a href="/net/net_test.go.html#6874126">c</a></span><span class="op" id="6874365">.</span><span class="ident" id="6874366">Write</span><span class="op" id="6874371">(</span><span class="op" id="6874372">[</span><span class="op" id="6874373">]</span><span class="builtintype" id="6874374">byte</span><span class="op" id="6874378">(</span><span class="string" id="6874379">&#34;response&#34;</span><span class="op" id="6874389">)</span><span class="op" id="6874390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874394"><a href="/net/net_test.go.html#6874126">c</a></span><span class="op" id="6874395">.</span><span class="ident" id="6874396">Close</span><span class="op" id="6874401">(</span><span class="op" id="6874402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874405">}</span><span class="op" id="6874406">(</span><span class="op" id="6874407">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874411">c</span><span class="op" id="6874412">,</span>&nbsp;<span class="ident" id="6874414"><a href="/net/net_test.go.html#6873936">err</a></span>&nbsp;<span class="op" id="6874418">:=</span>&nbsp;<span class="ident" id="6874421"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6874425">(</span><span class="string" id="6874426">&#34;tcp&#34;</span><span class="op" id="6874431">,</span>&nbsp;<span class="ident" id="6874433"><a href="/net/net_test.go.html#6873932">ln</a></span><span class="op" id="6874435">.</span><span class="ident" id="6874436">Addr</span><span class="op" id="6874440">(</span><span class="op" id="6874441">)</span><span class="op" id="6874442">.</span><span class="ident" id="6874443">String</span><span class="op" id="6874449">(</span><span class="op" id="6874450">)</span><span class="op" id="6874451">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874454">if</span>&nbsp;<span class="ident" id="6874457"><a href="/net/net_test.go.html#6873936">err</a></span>&nbsp;<span class="op" id="6874461">!=</span>&nbsp;<span class="ident" id="6874464">nil</span>&nbsp;<span class="op" id="6874468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874472"><a href="/net/net_test.go.html#6873835">t</a></span><span class="op" id="6874473">.</span><span class="ident" id="6874474">Fatalf</span><span class="op" id="6874480">(</span><span class="string" id="6874481">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6874491">,</span>&nbsp;<span class="ident" id="6874493"><a href="/net/net_test.go.html#6873936">err</a></span><span class="op" id="6874496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874502">defer</span>&nbsp;<span class="ident" id="6874508"><a href="/net/net_test.go.html#6874411">c</a></span><span class="op" id="6874509">.</span><span class="ident" id="6874510">Close</span><span class="op" id="6874515">(</span><span class="op" id="6874516">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874520"><a href="/net/net_test.go.html#6873936">err</a></span>&nbsp;<span class="op" id="6874524">=</span>&nbsp;<span class="ident" id="6874526"><a href="/net/net_test.go.html#6874411">c</a></span><span class="op" id="6874527">.</span><span class="op" id="6874528">(</span><span class="op" id="6874529">*</span><span class="ident" id="6874530"><a href="/net/tcpsock_posix.go.html#2694160">TCPConn</a></span><span class="op" id="6874537">)</span><span class="op" id="6874538">.</span><span class="ident" id="6874539">CloseWrite</span><span class="op" id="6874549">(</span><span class="op" id="6874550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874553">if</span>&nbsp;<span class="ident" id="6874556"><a href="/net/net_test.go.html#6873936">err</a></span>&nbsp;<span class="op" id="6874560">!=</span>&nbsp;<span class="ident" id="6874563">nil</span>&nbsp;<span class="op" id="6874567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874571"><a href="/net/net_test.go.html#6873835">t</a></span><span class="op" id="6874572">.</span><span class="ident" id="6874573">Fatalf</span><span class="op" id="6874579">(</span><span class="string" id="6874580">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="6874596">,</span>&nbsp;<span class="ident" id="6874598"><a href="/net/net_test.go.html#6873936">err</a></span><span class="op" id="6874601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874607">var</span>&nbsp;<span class="ident" id="6874611">buf</span>&nbsp;<span class="op" id="6874615">[</span><span class="num" id="6874616">10</span><span class="op" id="6874618">]</span><span class="builtintype" id="6874619">byte</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874625">n</span><span class="op" id="6874626">,</span>&nbsp;<span class="ident" id="6874628"><a href="/net/net_test.go.html#6873936">err</a></span>&nbsp;<span class="op" id="6874632">:=</span>&nbsp;<span class="ident" id="6874635"><a href="/net/net_test.go.html#6874411">c</a></span><span class="op" id="6874636">.</span><span class="ident" id="6874637">Read</span><span class="op" id="6874641">(</span><span class="ident" id="6874642"><a href="/net/net_test.go.html#6874611">buf</a></span><span class="op" id="6874645">[</span><span class="op" id="6874646">:</span><span class="op" id="6874647">]</span><span class="op" id="6874648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874651">if</span>&nbsp;<span class="ident" id="6874654"><a href="/net/net_test.go.html#6873936">err</a></span>&nbsp;<span class="op" id="6874658">!=</span>&nbsp;<span class="ident" id="6874661">nil</span>&nbsp;<span class="op" id="6874665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874669"><a href="/net/net_test.go.html#6873835">t</a></span><span class="op" id="6874670">.</span><span class="ident" id="6874671">Fatalf</span><span class="op" id="6874677">(</span><span class="string" id="6874678">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6874699">,</span>&nbsp;<span class="ident" id="6874701"><a href="/net/net_test.go.html#6874625">n</a></span><span class="op" id="6874702">,</span>&nbsp;<span class="ident" id="6874704"><a href="/net/net_test.go.html#6873936">err</a></span><span class="op" id="6874707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874713">got</span>&nbsp;<span class="op" id="6874717">:=</span>&nbsp;<span class="builtintype" id="6874720">string</span><span class="op" id="6874726">(</span><span class="ident" id="6874727"><a href="/net/net_test.go.html#6874611">buf</a></span><span class="op" id="6874730">[</span><span class="op" id="6874731">:</span><span class="ident" id="6874732"><a href="/net/net_test.go.html#6874625">n</a></span><span class="op" id="6874733">]</span><span class="op" id="6874734">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874737">if</span>&nbsp;<span class="ident" id="6874740"><a href="/net/net_test.go.html#6874713">got</a></span>&nbsp;<span class="op" id="6874744">!=</span>&nbsp;<span class="string" id="6874747">&#34;response&#34;</span>&nbsp;<span class="op" id="6874758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874762"><a href="/net/net_test.go.html#6873835">t</a></span><span class="op" id="6874763">.</span><span class="ident" id="6874764">Errorf</span><span class="op" id="6874770">(</span><span class="string" id="6874771">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="6874801">,</span>&nbsp;<span class="ident" id="6874803"><a href="/net/net_test.go.html#6874713">got</a></span><span class="op" id="6874806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874809">}</span><br>
<span class="lineno"></span><span class="op" id="6874811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6874814">func</span>&nbsp;<span class="ident" id="6874819">TestShutdownUnix</span><span class="op" id="6874835">(</span><span class="ident" id="6874836">t</span>&nbsp;<span class="op" id="6874838">*</span><span class="ident" id="6874839"><a href="/net/net_test.go.html#6873796">testing</a></span><span class="op" id="6874846">.</span><span class="ident" id="6874847">T</span><span class="op" id="6874848">)</span>&nbsp;<span class="op" id="6874850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874853">switch</span>&nbsp;<span class="ident" id="6874860"><a href="/net/net_test.go.html#6873785">runtime</a></span><span class="op" id="6874867">.</span><span class="ident" id="6874868">GOOS</span>&nbsp;<span class="op" id="6874873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874876">case</span>&nbsp;<span class="string" id="6874881">&#34;nacl&#34;</span><span class="op" id="6874887">,</span>&nbsp;<span class="string" id="6874889">&#34;plan9&#34;</span><span class="op" id="6874896">,</span>&nbsp;<span class="string" id="6874898">&#34;windows&#34;</span><span class="op" id="6874907">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874911"><a href="/net/net_test.go.html#6874836">t</a></span><span class="op" id="6874912">.</span><span class="ident" id="6874913">Skipf</span><span class="op" id="6874918">(</span><span class="string" id="6874919">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6874940">,</span>&nbsp;<span class="ident" id="6874942"><a href="/net/net_test.go.html#6873785">runtime</a></span><span class="op" id="6874949">.</span><span class="ident" id="6874950">GOOS</span><span class="op" id="6874954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874957">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874960">f</span><span class="op" id="6874961">,</span>&nbsp;<span class="ident" id="6874963">err</span>&nbsp;<span class="op" id="6874967">:=</span>&nbsp;<span class="ident" id="6874970"><a href="/net/net_test.go.html#6873766">ioutil</a></span><span class="op" id="6874976">.</span><span class="ident" id="6874977">TempFile</span><span class="op" id="6874985">(</span><span class="string" id="6874986">&#34;&#34;</span><span class="op" id="6874988">,</span>&nbsp;<span class="string" id="6874990">&#34;go_net_unixtest&#34;</span><span class="op" id="6875007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875010">if</span>&nbsp;<span class="ident" id="6875013"><a href="/net/net_test.go.html#6874963">err</a></span>&nbsp;<span class="op" id="6875017">!=</span>&nbsp;<span class="ident" id="6875020">nil</span>&nbsp;<span class="op" id="6875024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875028"><a href="/net/net_test.go.html#6874836">t</a></span><span class="op" id="6875029">.</span><span class="ident" id="6875030">Fatalf</span><span class="op" id="6875036">(</span><span class="string" id="6875037">&#34;TempFile:&nbsp;%s&#34;</span><span class="op" id="6875051">,</span>&nbsp;<span class="ident" id="6875053"><a href="/net/net_test.go.html#6874963">err</a></span><span class="op" id="6875056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6875059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875062"><a href="/net/net_test.go.html#6874960">f</a></span><span class="op" id="6875063">.</span><span class="ident" id="6875064">Close</span><span class="op" id="6875069">(</span><span class="op" id="6875070">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875073">tmpname</span>&nbsp;<span class="op" id="6875081">:=</span>&nbsp;<span class="ident" id="6875084"><a href="/net/net_test.go.html#6874960">f</a></span><span class="op" id="6875085">.</span><span class="ident" id="6875086">Name</span><span class="op" id="6875090">(</span><span class="op" id="6875091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875094"><a href="/net/net_test.go.html#6873779">os</a></span><span class="op" id="6875096">.</span><span class="ident" id="6875097">Remove</span><span class="op" id="6875103">(</span><span class="ident" id="6875104"><a href="/net/net_test.go.html#6875073">tmpname</a></span><span class="op" id="6875111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875114">ln</span><span class="op" id="6875116">,</span>&nbsp;<span class="ident" id="6875118"><a href="/net/net_test.go.html#6874963">err</a></span>&nbsp;<span class="op" id="6875122">:=</span>&nbsp;<span class="ident" id="6875125"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6875131">(</span><span class="string" id="6875132">&#34;unix&#34;</span><span class="op" id="6875138">,</span>&nbsp;<span class="ident" id="6875140"><a href="/net/net_test.go.html#6875073">tmpname</a></span><span class="op" id="6875147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875150">if</span>&nbsp;<span class="ident" id="6875153"><a href="/net/net_test.go.html#6874963">err</a></span>&nbsp;<span class="op" id="6875157">!=</span>&nbsp;<span class="ident" id="6875160">nil</span>&nbsp;<span class="op" id="6875164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875168"><a href="/net/net_test.go.html#6874836">t</a></span><span class="op" id="6875169">.</span><span class="ident" id="6875170">Fatalf</span><span class="op" id="6875176">(</span><span class="string" id="6875177">&#34;ListenUnix&nbsp;on&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="6875199">,</span>&nbsp;<span class="ident" id="6875201"><a href="/net/net_test.go.html#6875073">tmpname</a></span><span class="op" id="6875208">,</span>&nbsp;<span class="ident" id="6875210"><a href="/net/net_test.go.html#6874963">err</a></span><span class="op" id="6875213">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6875216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875219">defer</span>&nbsp;<span class="keyword" id="6875225">func</span><span class="op" id="6875229">(</span><span class="op" id="6875230">)</span>&nbsp;<span class="op" id="6875232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875236"><a href="/net/net_test.go.html#6875114">ln</a></span><span class="op" id="6875238">.</span><span class="ident" id="6875239">Close</span><span class="op" id="6875244">(</span><span class="op" id="6875245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875249"><a href="/net/net_test.go.html#6873779">os</a></span><span class="op" id="6875251">.</span><span class="ident" id="6875252">Remove</span><span class="op" id="6875258">(</span><span class="ident" id="6875259"><a href="/net/net_test.go.html#6875073">tmpname</a></span><span class="op" id="6875266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6875269">}</span><span class="op" id="6875270">(</span><span class="op" id="6875271">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875275">go</span>&nbsp;<span class="keyword" id="6875278">func</span><span class="op" id="6875282">(</span><span class="op" id="6875283">)</span>&nbsp;<span class="op" id="6875285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875289">c</span><span class="op" id="6875290">,</span>&nbsp;<span class="ident" id="6875292">err</span>&nbsp;<span class="op" id="6875296">:=</span>&nbsp;<span class="ident" id="6875299"><a href="/net/net_test.go.html#6875114">ln</a></span><span class="op" id="6875301">.</span><span class="ident" id="6875302">Accept</span><span class="op" id="6875308">(</span><span class="op" id="6875309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875313">if</span>&nbsp;<span class="ident" id="6875316"><a href="/net/net_test.go.html#6875292">err</a></span>&nbsp;<span class="op" id="6875320">!=</span>&nbsp;<span class="ident" id="6875323">nil</span>&nbsp;<span class="op" id="6875327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875332"><a href="/net/net_test.go.html#6874836">t</a></span><span class="op" id="6875333">.</span><span class="ident" id="6875334">Errorf</span><span class="op" id="6875340">(</span><span class="string" id="6875341">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6875353">,</span>&nbsp;<span class="ident" id="6875355"><a href="/net/net_test.go.html#6875292">err</a></span><span class="op" id="6875358">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875363">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6875372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875376">var</span>&nbsp;<span class="ident" id="6875380">buf</span>&nbsp;<span class="op" id="6875384">[</span><span class="num" id="6875385">10</span><span class="op" id="6875387">]</span><span class="builtintype" id="6875388">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875395">n</span><span class="op" id="6875396">,</span>&nbsp;<span class="ident" id="6875398"><a href="/net/net_test.go.html#6875292">err</a></span>&nbsp;<span class="op" id="6875402">:=</span>&nbsp;<span class="ident" id="6875405"><a href="/net/net_test.go.html#6875289">c</a></span><span class="op" id="6875406">.</span><span class="ident" id="6875407">Read</span><span class="op" id="6875411">(</span><span class="ident" id="6875412"><a href="/net/net_test.go.html#6875380">buf</a></span><span class="op" id="6875415">[</span><span class="op" id="6875416">:</span><span class="op" id="6875417">]</span><span class="op" id="6875418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875422">if</span>&nbsp;<span class="ident" id="6875425"><a href="/net/net_test.go.html#6875395">n</a></span>&nbsp;<span class="op" id="6875427">!=</span>&nbsp;<span class="num" id="6875430">0</span>&nbsp;<span class="op" id="6875432">||</span>&nbsp;<span class="ident" id="6875435"><a href="/net/net_test.go.html#6875292">err</a></span>&nbsp;<span class="op" id="6875439">!=</span>&nbsp;<span class="ident" id="6875442"><a href="/net/net_test.go.html#6873760">io</a></span><span class="op" id="6875444">.</span><span class="ident" id="6875445">EOF</span>&nbsp;<span class="op" id="6875449">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875454"><a href="/net/net_test.go.html#6874836">t</a></span><span class="op" id="6875455">.</span><span class="ident" id="6875456">Errorf</span><span class="op" id="6875462">(</span><span class="string" id="6875463">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="6875501">,</span>&nbsp;<span class="ident" id="6875503"><a href="/net/net_test.go.html#6875395">n</a></span><span class="op" id="6875504">,</span>&nbsp;<span class="ident" id="6875506"><a href="/net/net_test.go.html#6875292">err</a></span><span class="op" id="6875509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875514">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6875523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875527"><a href="/net/net_test.go.html#6875289">c</a></span><span class="op" id="6875528">.</span><span class="ident" id="6875529">Write</span><span class="op" id="6875534">(</span><span class="op" id="6875535">[</span><span class="op" id="6875536">]</span><span class="builtintype" id="6875537">byte</span><span class="op" id="6875541">(</span><span class="string" id="6875542">&#34;response&#34;</span><span class="op" id="6875552">)</span><span class="op" id="6875553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875557"><a href="/net/net_test.go.html#6875289">c</a></span><span class="op" id="6875558">.</span><span class="ident" id="6875559">Close</span><span class="op" id="6875564">(</span><span class="op" id="6875565">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6875568">}</span><span class="op" id="6875569">(</span><span class="op" id="6875570">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875574">c</span><span class="op" id="6875575">,</span>&nbsp;<span class="ident" id="6875577"><a href="/net/net_test.go.html#6874963">err</a></span>&nbsp;<span class="op" id="6875581">:=</span>&nbsp;<span class="ident" id="6875584"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6875588">(</span><span class="string" id="6875589">&#34;unix&#34;</span><span class="op" id="6875595">,</span>&nbsp;<span class="ident" id="6875597"><a href="/net/net_test.go.html#6875073">tmpname</a></span><span class="op" id="6875604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875607">if</span>&nbsp;<span class="ident" id="6875610"><a href="/net/net_test.go.html#6874963">err</a></span>&nbsp;<span class="op" id="6875614">!=</span>&nbsp;<span class="ident" id="6875617">nil</span>&nbsp;<span class="op" id="6875621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875625"><a href="/net/net_test.go.html#6874836">t</a></span><span class="op" id="6875626">.</span><span class="ident" id="6875627">Fatalf</span><span class="op" id="6875633">(</span><span class="string" id="6875634">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6875644">,</span>&nbsp;<span class="ident" id="6875646"><a href="/net/net_test.go.html#6874963">err</a></span><span class="op" id="6875649">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6875652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875655">defer</span>&nbsp;<span class="ident" id="6875661"><a href="/net/net_test.go.html#6875574">c</a></span><span class="op" id="6875662">.</span><span class="ident" id="6875663">Close</span><span class="op" id="6875668">(</span><span class="op" id="6875669">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875673"><a href="/net/net_test.go.html#6874963">err</a></span>&nbsp;<span class="op" id="6875677">=</span>&nbsp;<span class="ident" id="6875679"><a href="/net/net_test.go.html#6875574">c</a></span><span class="op" id="6875680">.</span><span class="op" id="6875681">(</span><span class="op" id="6875682">*</span><span class="ident" id="6875683"><a href="/net/unixsock_posix.go.html#2716530">UnixConn</a></span><span class="op" id="6875691">)</span><span class="op" id="6875692">.</span><span class="ident" id="6875693">CloseWrite</span><span class="op" id="6875703">(</span><span class="op" id="6875704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875707">if</span>&nbsp;<span class="ident" id="6875710"><a href="/net/net_test.go.html#6874963">err</a></span>&nbsp;<span class="op" id="6875714">!=</span>&nbsp;<span class="ident" id="6875717">nil</span>&nbsp;<span class="op" id="6875721">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875725"><a href="/net/net_test.go.html#6874836">t</a></span><span class="op" id="6875726">.</span><span class="ident" id="6875727">Fatalf</span><span class="op" id="6875733">(</span><span class="string" id="6875734">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="6875750">,</span>&nbsp;<span class="ident" id="6875752"><a href="/net/net_test.go.html#6874963">err</a></span><span class="op" id="6875755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6875758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875761">var</span>&nbsp;<span class="ident" id="6875765">buf</span>&nbsp;<span class="op" id="6875769">[</span><span class="num" id="6875770">10</span><span class="op" id="6875772">]</span><span class="builtintype" id="6875773">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875779">n</span><span class="op" id="6875780">,</span>&nbsp;<span class="ident" id="6875782"><a href="/net/net_test.go.html#6874963">err</a></span>&nbsp;<span class="op" id="6875786">:=</span>&nbsp;<span class="ident" id="6875789"><a href="/net/net_test.go.html#6875574">c</a></span><span class="op" id="6875790">.</span><span class="ident" id="6875791">Read</span><span class="op" id="6875795">(</span><span class="ident" id="6875796"><a href="/net/net_test.go.html#6875765">buf</a></span><span class="op" id="6875799">[</span><span class="op" id="6875800">:</span><span class="op" id="6875801">]</span><span class="op" id="6875802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875805">if</span>&nbsp;<span class="ident" id="6875808"><a href="/net/net_test.go.html#6874963">err</a></span>&nbsp;<span class="op" id="6875812">!=</span>&nbsp;<span class="ident" id="6875815">nil</span>&nbsp;<span class="op" id="6875819">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875823"><a href="/net/net_test.go.html#6874836">t</a></span><span class="op" id="6875824">.</span><span class="ident" id="6875825">Fatalf</span><span class="op" id="6875831">(</span><span class="string" id="6875832">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6875853">,</span>&nbsp;<span class="ident" id="6875855"><a href="/net/net_test.go.html#6875779">n</a></span><span class="op" id="6875856">,</span>&nbsp;<span class="ident" id="6875858"><a href="/net/net_test.go.html#6874963">err</a></span><span class="op" id="6875861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6875864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875867">got</span>&nbsp;<span class="op" id="6875871">:=</span>&nbsp;<span class="builtintype" id="6875874">string</span><span class="op" id="6875880">(</span><span class="ident" id="6875881"><a href="/net/net_test.go.html#6875765">buf</a></span><span class="op" id="6875884">[</span><span class="op" id="6875885">:</span><span class="ident" id="6875886"><a href="/net/net_test.go.html#6875779">n</a></span><span class="op" id="6875887">]</span><span class="op" id="6875888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6875891">if</span>&nbsp;<span class="ident" id="6875894"><a href="/net/net_test.go.html#6875867">got</a></span>&nbsp;<span class="op" id="6875898">!=</span>&nbsp;<span class="string" id="6875901">&#34;response&#34;</span>&nbsp;<span class="op" id="6875912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875916"><a href="/net/net_test.go.html#6874836">t</a></span><span class="op" id="6875917">.</span><span class="ident" id="6875918">Errorf</span><span class="op" id="6875924">(</span><span class="string" id="6875925">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="6875955">,</span>&nbsp;<span class="ident" id="6875957"><a href="/net/net_test.go.html#6875867">got</a></span><span class="op" id="6875960">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6875963">}</span><br>
<span class="lineno"></span><span class="op" id="6875965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6875968">func</span>&nbsp;<span class="ident" id="6875973">TestTCPListenClose</span><span class="op" id="6875991">(</span><span class="ident" id="6875992">t</span>&nbsp;<span class="op" id="6875994">*</span><span class="ident" id="6875995"><a href="/net/net_test.go.html#6873796">testing</a></span><span class="op" id="6876002">.</span><span class="ident" id="6876003">T</span><span class="op" id="6876004">)</span>&nbsp;<span class="op" id="6876006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876009">ln</span><span class="op" id="6876011">,</span>&nbsp;<span class="ident" id="6876013">err</span>&nbsp;<span class="op" id="6876017">:=</span>&nbsp;<span class="ident" id="6876020"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6876026">(</span><span class="string" id="6876027">&#34;tcp&#34;</span><span class="op" id="6876032">,</span>&nbsp;<span class="string" id="6876034">&#34;127.0.0.1:0&#34;</span><span class="op" id="6876047">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876050">if</span>&nbsp;<span class="ident" id="6876053"><a href="/net/net_test.go.html#6876013">err</a></span>&nbsp;<span class="op" id="6876057">!=</span>&nbsp;<span class="ident" id="6876060">nil</span>&nbsp;<span class="op" id="6876064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876068"><a href="/net/net_test.go.html#6875992">t</a></span><span class="op" id="6876069">.</span><span class="ident" id="6876070">Fatalf</span><span class="op" id="6876076">(</span><span class="string" id="6876077">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6876096">,</span>&nbsp;<span class="ident" id="6876098"><a href="/net/net_test.go.html#6876013">err</a></span><span class="op" id="6876101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6876104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876108">done</span>&nbsp;<span class="op" id="6876113">:=</span>&nbsp;<span class="builtinfunc" id="6876116">make</span><span class="op" id="6876120">(</span><span class="keyword" id="6876121">chan</span>&nbsp;<span class="builtintype" id="6876126">bool</span><span class="op" id="6876130">,</span>&nbsp;<span class="num" id="6876132">1</span><span class="op" id="6876133">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876136">go</span>&nbsp;<span class="keyword" id="6876139">func</span><span class="op" id="6876143">(</span><span class="op" id="6876144">)</span>&nbsp;<span class="op" id="6876146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876150"><a href="/net/net_test.go.html#6873807">time</a></span><span class="op" id="6876154">.</span><span class="ident" id="6876155">Sleep</span><span class="op" id="6876160">(</span><span class="num" id="6876161">100</span>&nbsp;<span class="op" id="6876165">*</span>&nbsp;<span class="ident" id="6876167"><a href="/net/net_test.go.html#6873807">time</a></span><span class="op" id="6876171">.</span><span class="ident" id="6876172">Millisecond</span><span class="op" id="6876183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876187"><a href="/net/net_test.go.html#6876009">ln</a></span><span class="op" id="6876189">.</span><span class="ident" id="6876190">Close</span><span class="op" id="6876195">(</span><span class="op" id="6876196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6876199">}</span><span class="op" id="6876200">(</span><span class="op" id="6876201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876204">go</span>&nbsp;<span class="keyword" id="6876207">func</span><span class="op" id="6876211">(</span><span class="op" id="6876212">)</span>&nbsp;<span class="op" id="6876214">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876218">c</span><span class="op" id="6876219">,</span>&nbsp;<span class="ident" id="6876221">err</span>&nbsp;<span class="op" id="6876225">:=</span>&nbsp;<span class="ident" id="6876228"><a href="/net/net_test.go.html#6876009">ln</a></span><span class="op" id="6876230">.</span><span class="ident" id="6876231">Accept</span><span class="op" id="6876237">(</span><span class="op" id="6876238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876242">if</span>&nbsp;<span class="ident" id="6876245"><a href="/net/net_test.go.html#6876221">err</a></span>&nbsp;<span class="op" id="6876249">==</span>&nbsp;<span class="ident" id="6876252">nil</span>&nbsp;<span class="op" id="6876256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876261"><a href="/net/net_test.go.html#6876218">c</a></span><span class="op" id="6876262">.</span><span class="ident" id="6876263">Close</span><span class="op" id="6876268">(</span><span class="op" id="6876269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876274"><a href="/net/net_test.go.html#6875992">t</a></span><span class="op" id="6876275">.</span><span class="ident" id="6876276">Error</span><span class="op" id="6876281">(</span><span class="string" id="6876282">&#34;Accept&nbsp;succeeded&#34;</span><span class="op" id="6876300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6876304">}</span>&nbsp;<span class="keyword" id="6876306">else</span>&nbsp;<span class="op" id="6876311">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876316"><a href="/net/net_test.go.html#6875992">t</a></span><span class="op" id="6876317">.</span><span class="ident" id="6876318">Logf</span><span class="op" id="6876322">(</span><span class="string" id="6876323">&#34;Accept&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="6876369">,</span>&nbsp;<span class="ident" id="6876371"><a href="/net/net_test.go.html#6876221">err</a></span><span class="op" id="6876374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6876378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876382"><a href="/net/net_test.go.html#6876108">done</a></span>&nbsp;<span class="op" id="6876387">&lt;-</span>&nbsp;<span class="ident" id="6876390">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6876396">}</span><span class="op" id="6876397">(</span><span class="op" id="6876398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876401">select</span>&nbsp;<span class="op" id="6876408">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876411">case</span>&nbsp;<span class="op" id="6876416">&lt;-</span><span class="ident" id="6876418"><a href="/net/net_test.go.html#6876108">done</a></span><span class="op" id="6876422">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876425">case</span>&nbsp;<span class="op" id="6876430">&lt;-</span><span class="ident" id="6876432"><a href="/net/net_test.go.html#6873807">time</a></span><span class="op" id="6876436">.</span><span class="ident" id="6876437">After</span><span class="op" id="6876442">(</span><span class="num" id="6876443">2</span>&nbsp;<span class="op" id="6876445">*</span>&nbsp;<span class="ident" id="6876447"><a href="/net/net_test.go.html#6873807">time</a></span><span class="op" id="6876451">.</span><span class="ident" id="6876452">Second</span><span class="op" id="6876458">)</span><span class="op" id="6876459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876463"><a href="/net/net_test.go.html#6875992">t</a></span><span class="op" id="6876464">.</span><span class="ident" id="6876465">Fatal</span><span class="op" id="6876470">(</span><span class="string" id="6876471">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;TCP&nbsp;close&#34;</span><span class="op" id="6876502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6876505">}</span><br>
<span class="lineno"></span><span class="op" id="6876507">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="6876510">func</span>&nbsp;<span class="ident" id="6876515">TestUDPListenClose</span><span class="op" id="6876533">(</span><span class="ident" id="6876534">t</span>&nbsp;<span class="op" id="6876536">*</span><span class="ident" id="6876537"><a href="/net/net_test.go.html#6873796">testing</a></span><span class="op" id="6876544">.</span><span class="ident" id="6876545">T</span><span class="op" id="6876546">)</span>&nbsp;<span class="op" id="6876548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876551">switch</span>&nbsp;<span class="ident" id="6876558"><a href="/net/net_test.go.html#6873785">runtime</a></span><span class="op" id="6876565">.</span><span class="ident" id="6876566">GOOS</span>&nbsp;<span class="op" id="6876571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876574">case</span>&nbsp;<span class="string" id="6876579">&#34;plan9&#34;</span><span class="op" id="6876586">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876590"><a href="/net/net_test.go.html#6876534">t</a></span><span class="op" id="6876591">.</span><span class="ident" id="6876592">Skipf</span><span class="op" id="6876597">(</span><span class="string" id="6876598">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6876619">,</span>&nbsp;<span class="ident" id="6876621"><a href="/net/net_test.go.html#6873785">runtime</a></span><span class="op" id="6876628">.</span><span class="ident" id="6876629">GOOS</span><span class="op" id="6876633">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6876636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876639">ln</span><span class="op" id="6876641">,</span>&nbsp;<span class="ident" id="6876643">err</span>&nbsp;<span class="op" id="6876647">:=</span>&nbsp;<span class="ident" id="6876650"><a href="/net/dial.go.html#2525968">ListenPacket</a></span><span class="op" id="6876662">(</span><span class="string" id="6876663">&#34;udp&#34;</span><span class="op" id="6876668">,</span>&nbsp;<span class="string" id="6876670">&#34;127.0.0.1:0&#34;</span><span class="op" id="6876683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876686">if</span>&nbsp;<span class="ident" id="6876689"><a href="/net/net_test.go.html#6876643">err</a></span>&nbsp;<span class="op" id="6876693">!=</span>&nbsp;<span class="ident" id="6876696">nil</span>&nbsp;<span class="op" id="6876700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876704"><a href="/net/net_test.go.html#6876534">t</a></span><span class="op" id="6876705">.</span><span class="ident" id="6876706">Fatalf</span><span class="op" id="6876712">(</span><span class="string" id="6876713">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6876732">,</span>&nbsp;<span class="ident" id="6876734"><a href="/net/net_test.go.html#6876643">err</a></span><span class="op" id="6876737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6876740">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876744">buf</span>&nbsp;<span class="op" id="6876748">:=</span>&nbsp;<span class="builtinfunc" id="6876751">make</span><span class="op" id="6876755">(</span><span class="op" id="6876756">[</span><span class="op" id="6876757">]</span><span class="builtintype" id="6876758">byte</span><span class="op" id="6876762">,</span>&nbsp;<span class="num" id="6876764">1000</span><span class="op" id="6876768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876771">done</span>&nbsp;<span class="op" id="6876776">:=</span>&nbsp;<span class="builtinfunc" id="6876779">make</span><span class="op" id="6876783">(</span><span class="keyword" id="6876784">chan</span>&nbsp;<span class="builtintype" id="6876789">bool</span><span class="op" id="6876793">,</span>&nbsp;<span class="num" id="6876795">1</span><span class="op" id="6876796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876799">go</span>&nbsp;<span class="keyword" id="6876802">func</span><span class="op" id="6876806">(</span><span class="op" id="6876807">)</span>&nbsp;<span class="op" id="6876809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876813"><a href="/net/net_test.go.html#6873807">time</a></span><span class="op" id="6876817">.</span><span class="ident" id="6876818">Sleep</span><span class="op" id="6876823">(</span><span class="num" id="6876824">100</span>&nbsp;<span class="op" id="6876828">*</span>&nbsp;<span class="ident" id="6876830"><a href="/net/net_test.go.html#6873807">time</a></span><span class="op" id="6876834">.</span><span class="ident" id="6876835">Millisecond</span><span class="op" id="6876846">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876850"><a href="/net/net_test.go.html#6876639">ln</a></span><span class="op" id="6876852">.</span><span class="ident" id="6876853">Close</span><span class="op" id="6876858">(</span><span class="op" id="6876859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6876862">}</span><span class="op" id="6876863">(</span><span class="op" id="6876864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876867">go</span>&nbsp;<span class="keyword" id="6876870">func</span><span class="op" id="6876874">(</span><span class="op" id="6876875">)</span>&nbsp;<span class="op" id="6876877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876881">_</span><span class="op" id="6876882">,</span>&nbsp;<span class="ident" id="6876884">_</span><span class="op" id="6876885">,</span>&nbsp;<span class="ident" id="6876887"><a href="/net/net_test.go.html#6876643">err</a></span>&nbsp;<span class="op" id="6876891">=</span>&nbsp;<span class="ident" id="6876893"><a href="/net/net_test.go.html#6876639">ln</a></span><span class="op" id="6876895">.</span><span class="ident" id="6876896">ReadFrom</span><span class="op" id="6876904">(</span><span class="ident" id="6876905"><a href="/net/net_test.go.html#6876744">buf</a></span><span class="op" id="6876908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6876912">if</span>&nbsp;<span class="ident" id="6876915"><a href="/net/net_test.go.html#6876643">err</a></span>&nbsp;<span class="op" id="6876919">==</span>&nbsp;<span class="ident" id="6876922">nil</span>&nbsp;<span class="op" id="6876926">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876931"><a href="/net/net_test.go.html#6876534">t</a></span><span class="op" id="6876932">.</span><span class="ident" id="6876933">Error</span><span class="op" id="6876938">(</span><span class="string" id="6876939">&#34;ReadFrom&nbsp;succeeded&#34;</span><span class="op" id="6876959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6876963">}</span>&nbsp;<span class="keyword" id="6876965">else</span>&nbsp;<span class="op" id="6876970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6876975"><a href="/net/net_test.go.html#6876534">t</a></span><span class="op" id="6876976">.</span><span class="ident" id="6876977">Logf</span><span class="op" id="6876981">(</span><span class="string" id="6876982">&#34;ReadFrom&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="6877030">,</span>&nbsp;<span class="ident" id="6877032"><a href="/net/net_test.go.html#6876643">err</a></span><span class="op" id="6877035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6877039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877043"><a href="/net/net_test.go.html#6876771">done</a></span>&nbsp;<span class="op" id="6877048">&lt;-</span>&nbsp;<span class="ident" id="6877051">true</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6877057">}</span><span class="op" id="6877058">(</span><span class="op" id="6877059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877062">select</span>&nbsp;<span class="op" id="6877069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877072">case</span>&nbsp;<span class="op" id="6877077">&lt;-</span><span class="ident" id="6877079"><a href="/net/net_test.go.html#6876771">done</a></span><span class="op" id="6877083">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877086">case</span>&nbsp;<span class="op" id="6877091">&lt;-</span><span class="ident" id="6877093"><a href="/net/net_test.go.html#6873807">time</a></span><span class="op" id="6877097">.</span><span class="ident" id="6877098">After</span><span class="op" id="6877103">(</span><span class="num" id="6877104">2</span>&nbsp;<span class="op" id="6877106">*</span>&nbsp;<span class="ident" id="6877108"><a href="/net/net_test.go.html#6873807">time</a></span><span class="op" id="6877112">.</span><span class="ident" id="6877113">Second</span><span class="op" id="6877119">)</span><span class="op" id="6877120">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877124"><a href="/net/net_test.go.html#6876534">t</a></span><span class="op" id="6877125">.</span><span class="ident" id="6877126">Fatal</span><span class="op" id="6877131">(</span><span class="string" id="6877132">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;UDP&nbsp;close&#34;</span><span class="op" id="6877163">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6877166">}</span><br>
<span class="lineno"></span><span class="op" id="6877168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6877171">func</span>&nbsp;<span class="ident" id="6877176">TestTCPClose</span><span class="op" id="6877188">(</span><span class="ident" id="6877189">t</span>&nbsp;<span class="op" id="6877191">*</span><span class="ident" id="6877192"><a href="/net/net_test.go.html#6873796">testing</a></span><span class="op" id="6877199">.</span><span class="ident" id="6877200">T</span><span class="op" id="6877201">)</span>&nbsp;<span class="op" id="6877203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877206">switch</span>&nbsp;<span class="ident" id="6877213"><a href="/net/net_test.go.html#6873785">runtime</a></span><span class="op" id="6877220">.</span><span class="ident" id="6877221">GOOS</span>&nbsp;<span class="op" id="6877226">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877229">case</span>&nbsp;<span class="string" id="6877234">&#34;plan9&#34;</span><span class="op" id="6877241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877245"><a href="/net/net_test.go.html#6877189">t</a></span><span class="op" id="6877246">.</span><span class="ident" id="6877247">Skipf</span><span class="op" id="6877252">(</span><span class="string" id="6877253">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6877274">,</span>&nbsp;<span class="ident" id="6877276"><a href="/net/net_test.go.html#6873785">runtime</a></span><span class="op" id="6877283">.</span><span class="ident" id="6877284">GOOS</span><span class="op" id="6877288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6877291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877294">l</span><span class="op" id="6877295">,</span>&nbsp;<span class="ident" id="6877297">err</span>&nbsp;<span class="op" id="6877301">:=</span>&nbsp;<span class="ident" id="6877304"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6877310">(</span><span class="string" id="6877311">&#34;tcp&#34;</span><span class="op" id="6877316">,</span>&nbsp;<span class="string" id="6877318">&#34;127.0.0.1:0&#34;</span><span class="op" id="6877331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877334">if</span>&nbsp;<span class="ident" id="6877337"><a href="/net/net_test.go.html#6877297">err</a></span>&nbsp;<span class="op" id="6877341">!=</span>&nbsp;<span class="ident" id="6877344">nil</span>&nbsp;<span class="op" id="6877348">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877352"><a href="/net/net_test.go.html#6877189">t</a></span><span class="op" id="6877353">.</span><span class="ident" id="6877354">Fatal</span><span class="op" id="6877359">(</span><span class="ident" id="6877360"><a href="/net/net_test.go.html#6877297">err</a></span><span class="op" id="6877363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6877366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877369">defer</span>&nbsp;<span class="ident" id="6877375"><a href="/net/net_test.go.html#6877294">l</a></span><span class="op" id="6877376">.</span><span class="ident" id="6877377">Close</span><span class="op" id="6877382">(</span><span class="op" id="6877383">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877387">read</span>&nbsp;<span class="op" id="6877392">:=</span>&nbsp;<span class="keyword" id="6877395">func</span><span class="op" id="6877399">(</span><span class="ident" id="6877400">r</span>&nbsp;<span class="ident" id="6877402"><a href="/net/net_test.go.html#6873760">io</a></span><span class="op" id="6877404">.</span><span class="ident" id="6877405">Reader</span><span class="op" id="6877411">)</span>&nbsp;<span class="builtintype" id="6877413">error</span>&nbsp;<span class="op" id="6877419">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877423">var</span>&nbsp;<span class="ident" id="6877427">m</span>&nbsp;<span class="op" id="6877429">[</span><span class="num" id="6877430">1</span><span class="op" id="6877431">]</span><span class="builtintype" id="6877432">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877439">_</span><span class="op" id="6877440">,</span>&nbsp;<span class="ident" id="6877442">err</span>&nbsp;<span class="op" id="6877446">:=</span>&nbsp;<span class="ident" id="6877449"><a href="/net/net_test.go.html#6877400">r</a></span><span class="op" id="6877450">.</span><span class="ident" id="6877451">Read</span><span class="op" id="6877455">(</span><span class="ident" id="6877456"><a href="/net/net_test.go.html#6877427">m</a></span><span class="op" id="6877457">[</span><span class="op" id="6877458">:</span><span class="op" id="6877459">]</span><span class="op" id="6877460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877464">return</span>&nbsp;<span class="ident" id="6877471"><a href="/net/net_test.go.html#6877442">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6877476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877480">go</span>&nbsp;<span class="keyword" id="6877483">func</span><span class="op" id="6877487">(</span><span class="op" id="6877488">)</span>&nbsp;<span class="op" id="6877490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877494">c</span><span class="op" id="6877495">,</span>&nbsp;<span class="ident" id="6877497">err</span>&nbsp;<span class="op" id="6877501">:=</span>&nbsp;<span class="ident" id="6877504"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6877508">(</span><span class="string" id="6877509">&#34;tcp&#34;</span><span class="op" id="6877514">,</span>&nbsp;<span class="ident" id="6877516"><a href="/net/net_test.go.html#6877294">l</a></span><span class="op" id="6877517">.</span><span class="ident" id="6877518">Addr</span><span class="op" id="6877522">(</span><span class="op" id="6877523">)</span><span class="op" id="6877524">.</span><span class="ident" id="6877525">String</span><span class="op" id="6877531">(</span><span class="op" id="6877532">)</span><span class="op" id="6877533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877537">if</span>&nbsp;<span class="ident" id="6877540"><a href="/net/net_test.go.html#6877497">err</a></span>&nbsp;<span class="op" id="6877544">!=</span>&nbsp;<span class="ident" id="6877547">nil</span>&nbsp;<span class="op" id="6877551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877556"><a href="/net/net_test.go.html#6877189">t</a></span><span class="op" id="6877557">.</span><span class="ident" id="6877558">Errorf</span><span class="op" id="6877564">(</span><span class="string" id="6877565">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6877575">,</span>&nbsp;<span class="ident" id="6877577"><a href="/net/net_test.go.html#6877497">err</a></span><span class="op" id="6877580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877585">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6877594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877599">go</span>&nbsp;<span class="ident" id="6877602"><a href="/net/net_test.go.html#6877387">read</a></span><span class="op" id="6877606">(</span><span class="ident" id="6877607"><a href="/net/net_test.go.html#6877494">c</a></span><span class="op" id="6877608">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877613"><a href="/net/net_test.go.html#6873807">time</a></span><span class="op" id="6877617">.</span><span class="ident" id="6877618">Sleep</span><span class="op" id="6877623">(</span><span class="num" id="6877624">10</span>&nbsp;<span class="op" id="6877627">*</span>&nbsp;<span class="ident" id="6877629"><a href="/net/net_test.go.html#6873807">time</a></span><span class="op" id="6877633">.</span><span class="ident" id="6877634">Millisecond</span><span class="op" id="6877645">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877649"><a href="/net/net_test.go.html#6877494">c</a></span><span class="op" id="6877650">.</span><span class="ident" id="6877651">Close</span><span class="op" id="6877656">(</span><span class="op" id="6877657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6877660">}</span><span class="op" id="6877661">(</span><span class="op" id="6877662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877666">c</span><span class="op" id="6877667">,</span>&nbsp;<span class="ident" id="6877669"><a href="/net/net_test.go.html#6877297">err</a></span>&nbsp;<span class="op" id="6877673">:=</span>&nbsp;<span class="ident" id="6877676"><a href="/net/net_test.go.html#6877294">l</a></span><span class="op" id="6877677">.</span><span class="ident" id="6877678">Accept</span><span class="op" id="6877684">(</span><span class="op" id="6877685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877688">if</span>&nbsp;<span class="ident" id="6877691"><a href="/net/net_test.go.html#6877297">err</a></span>&nbsp;<span class="op" id="6877695">!=</span>&nbsp;<span class="ident" id="6877698">nil</span>&nbsp;<span class="op" id="6877702">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877706"><a href="/net/net_test.go.html#6877189">t</a></span><span class="op" id="6877707">.</span><span class="ident" id="6877708">Fatal</span><span class="op" id="6877713">(</span><span class="ident" id="6877714"><a href="/net/net_test.go.html#6877297">err</a></span><span class="op" id="6877717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6877720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877723">defer</span>&nbsp;<span class="ident" id="6877729"><a href="/net/net_test.go.html#6877666">c</a></span><span class="op" id="6877730">.</span><span class="ident" id="6877731">Close</span><span class="op" id="6877736">(</span><span class="op" id="6877737">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877741">for</span>&nbsp;<span class="ident" id="6877745"><a href="/net/net_test.go.html#6877297">err</a></span>&nbsp;<span class="op" id="6877749">==</span>&nbsp;<span class="ident" id="6877752">nil</span>&nbsp;<span class="op" id="6877756">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877760"><a href="/net/net_test.go.html#6877297">err</a></span>&nbsp;<span class="op" id="6877764">=</span>&nbsp;<span class="ident" id="6877766"><a href="/net/net_test.go.html#6877387">read</a></span><span class="op" id="6877770">(</span><span class="ident" id="6877771"><a href="/net/net_test.go.html#6877666">c</a></span><span class="op" id="6877772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6877775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877778">if</span>&nbsp;<span class="ident" id="6877781"><a href="/net/net_test.go.html#6877297">err</a></span>&nbsp;<span class="op" id="6877785">!=</span>&nbsp;<span class="ident" id="6877788">nil</span>&nbsp;<span class="op" id="6877792">&amp;&amp;</span>&nbsp;<span class="ident" id="6877795"><a href="/net/net_test.go.html#6877297">err</a></span>&nbsp;<span class="op" id="6877799">!=</span>&nbsp;<span class="ident" id="6877802"><a href="/net/net_test.go.html#6873760">io</a></span><span class="op" id="6877804">.</span><span class="ident" id="6877805">EOF</span>&nbsp;<span class="op" id="6877809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877813"><a href="/net/net_test.go.html#6877189">t</a></span><span class="op" id="6877814">.</span><span class="ident" id="6877815">Fatal</span><span class="op" id="6877820">(</span><span class="ident" id="6877821"><a href="/net/net_test.go.html#6877297">err</a></span><span class="op" id="6877824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6877827">}</span><br>
<span class="lineno">225</span><span class="op" id="6877829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6877832">func</span>&nbsp;<span class="ident" id="6877837">TestErrorNil</span><span class="op" id="6877849">(</span><span class="ident" id="6877850">t</span>&nbsp;<span class="op" id="6877852">*</span><span class="ident" id="6877853"><a href="/net/net_test.go.html#6873796">testing</a></span><span class="op" id="6877860">.</span><span class="ident" id="6877861">T</span><span class="op" id="6877862">)</span>&nbsp;<span class="op" id="6877864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877867">c</span><span class="op" id="6877868">,</span>&nbsp;<span class="ident" id="6877870">err</span>&nbsp;<span class="op" id="6877874">:=</span>&nbsp;<span class="ident" id="6877877"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6877881">(</span><span class="string" id="6877882">&#34;tcp&#34;</span><span class="op" id="6877887">,</span>&nbsp;<span class="string" id="6877889">&#34;127.0.0.1:65535&#34;</span><span class="op" id="6877906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877909">if</span>&nbsp;<span class="ident" id="6877912"><a href="/net/net_test.go.html#6877870">err</a></span>&nbsp;<span class="op" id="6877916">==</span>&nbsp;<span class="ident" id="6877919">nil</span>&nbsp;<span class="op" id="6877923">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877927"><a href="/net/net_test.go.html#6877850">t</a></span><span class="op" id="6877928">.</span><span class="ident" id="6877929">Fatal</span><span class="op" id="6877934">(</span><span class="string" id="6877935">&#34;Dial&nbsp;127.0.0.1:65535&nbsp;succeeded&#34;</span><span class="op" id="6877967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6877970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6877973">if</span>&nbsp;<span class="ident" id="6877976"><a href="/net/net_test.go.html#6877867">c</a></span>&nbsp;<span class="op" id="6877978">!=</span>&nbsp;<span class="ident" id="6877981">nil</span>&nbsp;<span class="op" id="6877985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6877989"><a href="/net/net_test.go.html#6877850">t</a></span><span class="op" id="6877990">.</span><span class="ident" id="6877991">Fatalf</span><span class="op" id="6877997">(</span><span class="string" id="6877998">&#34;Dial&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6878054">,</span>&nbsp;<span class="ident" id="6878056"><a href="/net/net_test.go.html#6877867">c</a></span><span class="op" id="6878057">,</span>&nbsp;<span class="ident" id="6878059"><a href="/net/net_test.go.html#6877867">c</a></span><span class="op" id="6878060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6878063">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6878067">//&nbsp;Make&nbsp;Listen&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6878124">l</span><span class="op" id="6878125">,</span>&nbsp;<span class="ident" id="6878127"><a href="/net/net_test.go.html#6877870">err</a></span>&nbsp;<span class="op" id="6878131">:=</span>&nbsp;<span class="ident" id="6878134"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6878140">(</span><span class="string" id="6878141">&#34;tcp&#34;</span><span class="op" id="6878146">,</span>&nbsp;<span class="string" id="6878148">&#34;127.0.0.1:0&#34;</span><span class="op" id="6878161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6878164">if</span>&nbsp;<span class="ident" id="6878167"><a href="/net/net_test.go.html#6877870">err</a></span>&nbsp;<span class="op" id="6878171">!=</span>&nbsp;<span class="ident" id="6878174">nil</span>&nbsp;<span class="op" id="6878178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6878182"><a href="/net/net_test.go.html#6877850">t</a></span><span class="op" id="6878183">.</span><span class="ident" id="6878184">Fatalf</span><span class="op" id="6878190">(</span><span class="string" id="6878191">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="6878215">,</span>&nbsp;<span class="ident" id="6878217"><a href="/net/net_test.go.html#6877870">err</a></span><span class="op" id="6878220">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6878223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6878226">defer</span>&nbsp;<span class="ident" id="6878232"><a href="/net/net_test.go.html#6878124">l</a></span><span class="op" id="6878233">.</span><span class="ident" id="6878234">Close</span><span class="op" id="6878239">(</span><span class="op" id="6878240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6878243">l1</span><span class="op" id="6878245">,</span>&nbsp;<span class="ident" id="6878247"><a href="/net/net_test.go.html#6877870">err</a></span>&nbsp;<span class="op" id="6878251">:=</span>&nbsp;<span class="ident" id="6878254"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6878260">(</span><span class="string" id="6878261">&#34;tcp&#34;</span><span class="op" id="6878266">,</span>&nbsp;<span class="ident" id="6878268"><a href="/net/net_test.go.html#6878124">l</a></span><span class="op" id="6878269">.</span><span class="ident" id="6878270">Addr</span><span class="op" id="6878274">(</span><span class="op" id="6878275">)</span><span class="op" id="6878276">.</span><span class="ident" id="6878277">String</span><span class="op" id="6878283">(</span><span class="op" id="6878284">)</span><span class="op" id="6878285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6878288">if</span>&nbsp;<span class="ident" id="6878291"><a href="/net/net_test.go.html#6877870">err</a></span>&nbsp;<span class="op" id="6878295">==</span>&nbsp;<span class="ident" id="6878298">nil</span>&nbsp;<span class="op" id="6878302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6878306"><a href="/net/net_test.go.html#6877850">t</a></span><span class="op" id="6878307">.</span><span class="ident" id="6878308">Fatalf</span><span class="op" id="6878314">(</span><span class="string" id="6878315">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="6878337">,</span>&nbsp;<span class="ident" id="6878339"><a href="/net/net_test.go.html#6878124">l</a></span><span class="op" id="6878340">.</span><span class="ident" id="6878341">Addr</span><span class="op" id="6878345">(</span><span class="op" id="6878346">)</span><span class="op" id="6878347">,</span>&nbsp;<span class="ident" id="6878349"><a href="/net/net_test.go.html#6877870">err</a></span><span class="op" id="6878352">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6878355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6878358">if</span>&nbsp;<span class="ident" id="6878361"><a href="/net/net_test.go.html#6878243">l1</a></span>&nbsp;<span class="op" id="6878364">!=</span>&nbsp;<span class="ident" id="6878367">nil</span>&nbsp;<span class="op" id="6878371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6878375"><a href="/net/net_test.go.html#6877850">t</a></span><span class="op" id="6878376">.</span><span class="ident" id="6878377">Fatalf</span><span class="op" id="6878383">(</span><span class="string" id="6878384">&#34;Listen&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6878442">,</span>&nbsp;<span class="ident" id="6878444"><a href="/net/net_test.go.html#6878243">l1</a></span><span class="op" id="6878446">,</span>&nbsp;<span class="ident" id="6878448"><a href="/net/net_test.go.html#6878243">l1</a></span><span class="op" id="6878450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6878453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6878457">//&nbsp;Make&nbsp;ListenPacket&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6878520">lp</span><span class="op" id="6878522">,</span>&nbsp;<span class="ident" id="6878524"><a href="/net/net_test.go.html#6877870">err</a></span>&nbsp;<span class="op" id="6878528">:=</span>&nbsp;<span class="ident" id="6878531"><a href="/net/dial.go.html#2525968">ListenPacket</a></span><span class="op" id="6878543">(</span><span class="string" id="6878544">&#34;udp&#34;</span><span class="op" id="6878549">,</span>&nbsp;<span class="string" id="6878551">&#34;127.0.0.1:0&#34;</span><span class="op" id="6878564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6878567">if</span>&nbsp;<span class="ident" id="6878570"><a href="/net/net_test.go.html#6877870">err</a></span>&nbsp;<span class="op" id="6878574">!=</span>&nbsp;<span class="ident" id="6878577">nil</span>&nbsp;<span class="op" id="6878581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6878585"><a href="/net/net_test.go.html#6877850">t</a></span><span class="op" id="6878586">.</span><span class="ident" id="6878587">Fatalf</span><span class="op" id="6878593">(</span><span class="string" id="6878594">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="6878618">,</span>&nbsp;<span class="ident" id="6878620"><a href="/net/net_test.go.html#6877870">err</a></span><span class="op" id="6878623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6878626">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6878629">defer</span>&nbsp;<span class="ident" id="6878635"><a href="/net/net_test.go.html#6878520">lp</a></span><span class="op" id="6878637">.</span><span class="ident" id="6878638">Close</span><span class="op" id="6878643">(</span><span class="op" id="6878644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6878647">lp1</span><span class="op" id="6878650">,</span>&nbsp;<span class="ident" id="6878652"><a href="/net/net_test.go.html#6877870">err</a></span>&nbsp;<span class="op" id="6878656">:=</span>&nbsp;<span class="ident" id="6878659"><a href="/net/dial.go.html#2525968">ListenPacket</a></span><span class="op" id="6878671">(</span><span class="string" id="6878672">&#34;udp&#34;</span><span class="op" id="6878677">,</span>&nbsp;<span class="ident" id="6878679"><a href="/net/net_test.go.html#6878520">lp</a></span><span class="op" id="6878681">.</span><span class="ident" id="6878682">LocalAddr</span><span class="op" id="6878691">(</span><span class="op" id="6878692">)</span><span class="op" id="6878693">.</span><span class="ident" id="6878694">String</span><span class="op" id="6878700">(</span><span class="op" id="6878701">)</span><span class="op" id="6878702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6878705">if</span>&nbsp;<span class="ident" id="6878708"><a href="/net/net_test.go.html#6877870">err</a></span>&nbsp;<span class="op" id="6878712">==</span>&nbsp;<span class="ident" id="6878715">nil</span>&nbsp;<span class="op" id="6878719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6878723"><a href="/net/net_test.go.html#6877850">t</a></span><span class="op" id="6878724">.</span><span class="ident" id="6878725">Fatalf</span><span class="op" id="6878731">(</span><span class="string" id="6878732">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="6878754">,</span>&nbsp;<span class="ident" id="6878756"><a href="/net/net_test.go.html#6878520">lp</a></span><span class="op" id="6878758">.</span><span class="ident" id="6878759">LocalAddr</span><span class="op" id="6878768">(</span><span class="op" id="6878769">)</span><span class="op" id="6878770">,</span>&nbsp;<span class="ident" id="6878772"><a href="/net/net_test.go.html#6877870">err</a></span><span class="op" id="6878775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6878778">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6878781">if</span>&nbsp;<span class="ident" id="6878784"><a href="/net/net_test.go.html#6878647">lp1</a></span>&nbsp;<span class="op" id="6878788">!=</span>&nbsp;<span class="ident" id="6878791">nil</span>&nbsp;<span class="op" id="6878795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6878799"><a href="/net/net_test.go.html#6877850">t</a></span><span class="op" id="6878800">.</span><span class="ident" id="6878801">Fatalf</span><span class="op" id="6878807">(</span><span class="string" id="6878808">&#34;ListenPacket&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6878872">,</span>&nbsp;<span class="ident" id="6878874"><a href="/net/net_test.go.html#6878647">lp1</a></span><span class="op" id="6878877">,</span>&nbsp;<span class="ident" id="6878879"><a href="/net/net_test.go.html#6878647">lp1</a></span><span class="op" id="6878882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6878885">}</span><br>
<span class="lineno"></span><span class="op" id="6878887">}</span>
</div>
</body>
</html>
