<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html" class="current">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2534198">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2534254">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2534308">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2534359">//&nbsp;Netlink&nbsp;sockets&nbsp;and&nbsp;messages</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2534392">package</span>&nbsp;<span class="ident" id="2534400">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2534409">import</span>&nbsp;<span class="string" id="2534416">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2534426">//&nbsp;Round&nbsp;the&nbsp;length&nbsp;of&nbsp;a&nbsp;netlink&nbsp;message&nbsp;up&nbsp;to&nbsp;align&nbsp;it&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="2534492">func</span>&nbsp;<span class="ident" id="2534497">nlmAlignOf</span><span class="op" id="2534507">(</span><span class="ident" id="2534508">msglen</span>&nbsp;<span class="builtintype" id="2534515">int</span><span class="op" id="2534518">)</span>&nbsp;<span class="builtintype" id="2534520">int</span>&nbsp;<span class="op" id="2534524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2534527">return</span>&nbsp;<span class="op" id="2534534">(</span><span class="ident" id="2534535">msglen</span>&nbsp;<span class="op" id="2534542">+</span>&nbsp;<span class="ident" id="2534544">NLMSG_ALIGNTO</span>&nbsp;<span class="op" id="2534558">-</span>&nbsp;<span class="num" id="2534560">1</span><span class="op" id="2534561">)</span>&nbsp;<span class="op" id="2534563">&amp;</span>&nbsp;<span class="op" id="2534565">^</span><span class="op" id="2534566">(</span><span class="ident" id="2534567">NLMSG_ALIGNTO</span>&nbsp;<span class="op" id="2534581">-</span>&nbsp;<span class="num" id="2534583">1</span><span class="op" id="2534584">)</span><br>
<span class="lineno"></span><span class="op" id="2534586">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2534589">//&nbsp;Round&nbsp;the&nbsp;length&nbsp;of&nbsp;a&nbsp;netlink&nbsp;route&nbsp;attribute&nbsp;up&nbsp;to&nbsp;align&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2534653">//&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="2534666">func</span>&nbsp;<span class="ident" id="2534671">rtaAlignOf</span><span class="op" id="2534681">(</span><span class="ident" id="2534682">attrlen</span>&nbsp;<span class="builtintype" id="2534690">int</span><span class="op" id="2534693">)</span>&nbsp;<span class="builtintype" id="2534695">int</span>&nbsp;<span class="op" id="2534699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2534702">return</span>&nbsp;<span class="op" id="2534709">(</span><span class="ident" id="2534710">attrlen</span>&nbsp;<span class="op" id="2534718">+</span>&nbsp;<span class="ident" id="2534720">RTA_ALIGNTO</span>&nbsp;<span class="op" id="2534732">-</span>&nbsp;<span class="num" id="2534734">1</span><span class="op" id="2534735">)</span>&nbsp;<span class="op" id="2534737">&amp;</span>&nbsp;<span class="op" id="2534739">^</span><span class="op" id="2534740">(</span><span class="ident" id="2534741">RTA_ALIGNTO</span>&nbsp;<span class="op" id="2534753">-</span>&nbsp;<span class="num" id="2534755">1</span><span class="op" id="2534756">)</span><br>
<span class="lineno">20</span><span class="op" id="2534758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2534761">//&nbsp;NetlinkRouteRequest&nbsp;represents&nbsp;a&nbsp;request&nbsp;message&nbsp;to&nbsp;receive&nbsp;routing</span><br>
<span class="lineno"></span><span class="comment" id="2534832">//&nbsp;and&nbsp;link&nbsp;states&nbsp;from&nbsp;the&nbsp;kernel.</span><br>
<span class="lineno"></span><span class="keyword" id="2534868">type</span>&nbsp;<span class="ident" id="2534873">NetlinkRouteRequest</span>&nbsp;<span class="keyword" id="2534893">struct</span>&nbsp;<span class="op" id="2534900">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2534903">Header</span>&nbsp;<span class="ident" id="2534910">NlMsghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2534920">Data</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2534927">RtGenmsg</span><br>
<span class="lineno"></span><span class="op" id="2534936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2534939">func</span>&nbsp;<span class="op" id="2534944">(</span><span class="ident" id="2534945">rr</span>&nbsp;<span class="op" id="2534948">*</span><span class="ident" id="2534949">NetlinkRouteRequest</span><span class="op" id="2534968">)</span>&nbsp;<span class="ident" id="2534970">toWireFormat</span><span class="op" id="2534982">(</span><span class="op" id="2534983">)</span>&nbsp;<span class="op" id="2534985">[</span><span class="op" id="2534986">]</span><span class="builtintype" id="2534987">byte</span>&nbsp;<span class="op" id="2534992">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2534995">b</span>&nbsp;<span class="op" id="2534997">:=</span>&nbsp;<span class="builtinfunc" id="2535000">make</span><span class="op" id="2535004">(</span><span class="op" id="2535005">[</span><span class="op" id="2535006">]</span><span class="builtintype" id="2535007">byte</span><span class="op" id="2535011">,</span>&nbsp;<span class="ident" id="2535013">rr</span><span class="op" id="2535015">.</span><span class="ident" id="2535016">Header</span><span class="op" id="2535022">.</span><span class="ident" id="2535023">Len</span><span class="op" id="2535026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2535029">*</span><span class="op" id="2535030">(</span><span class="op" id="2535031">*</span><span class="builtintype" id="2535032">uint32</span><span class="op" id="2535038">)</span><span class="op" id="2535039">(</span><span class="ident" id="2535040">unsafe</span><span class="op" id="2535046">.</span><span class="ident" id="2535047">Pointer</span><span class="op" id="2535054">(</span><span class="op" id="2535055">&amp;</span><span class="ident" id="2535056">b</span><span class="op" id="2535057">[</span><span class="num" id="2535058">0</span><span class="op" id="2535059">:</span><span class="num" id="2535060">4</span><span class="op" id="2535061">]</span><span class="op" id="2535062">[</span><span class="num" id="2535063">0</span><span class="op" id="2535064">]</span><span class="op" id="2535065">)</span><span class="op" id="2535066">)</span>&nbsp;<span class="op" id="2535068">=</span>&nbsp;<span class="ident" id="2535070">rr</span><span class="op" id="2535072">.</span><span class="ident" id="2535073">Header</span><span class="op" id="2535079">.</span><span class="ident" id="2535080">Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2535085">*</span><span class="op" id="2535086">(</span><span class="op" id="2535087">*</span><span class="builtintype" id="2535088">uint16</span><span class="op" id="2535094">)</span><span class="op" id="2535095">(</span><span class="ident" id="2535096">unsafe</span><span class="op" id="2535102">.</span><span class="ident" id="2535103">Pointer</span><span class="op" id="2535110">(</span><span class="op" id="2535111">&amp;</span><span class="ident" id="2535112">b</span><span class="op" id="2535113">[</span><span class="num" id="2535114">4</span><span class="op" id="2535115">:</span><span class="num" id="2535116">6</span><span class="op" id="2535117">]</span><span class="op" id="2535118">[</span><span class="num" id="2535119">0</span><span class="op" id="2535120">]</span><span class="op" id="2535121">)</span><span class="op" id="2535122">)</span>&nbsp;<span class="op" id="2535124">=</span>&nbsp;<span class="ident" id="2535126">rr</span><span class="op" id="2535128">.</span><span class="ident" id="2535129">Header</span><span class="op" id="2535135">.</span><span class="ident" id="2535136">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2535142">*</span><span class="op" id="2535143">(</span><span class="op" id="2535144">*</span><span class="builtintype" id="2535145">uint16</span><span class="op" id="2535151">)</span><span class="op" id="2535152">(</span><span class="ident" id="2535153">unsafe</span><span class="op" id="2535159">.</span><span class="ident" id="2535160">Pointer</span><span class="op" id="2535167">(</span><span class="op" id="2535168">&amp;</span><span class="ident" id="2535169">b</span><span class="op" id="2535170">[</span><span class="num" id="2535171">6</span><span class="op" id="2535172">:</span><span class="num" id="2535173">8</span><span class="op" id="2535174">]</span><span class="op" id="2535175">[</span><span class="num" id="2535176">0</span><span class="op" id="2535177">]</span><span class="op" id="2535178">)</span><span class="op" id="2535179">)</span>&nbsp;<span class="op" id="2535181">=</span>&nbsp;<span class="ident" id="2535183">rr</span><span class="op" id="2535185">.</span><span class="ident" id="2535186">Header</span><span class="op" id="2535192">.</span><span class="ident" id="2535193">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2535200">*</span><span class="op" id="2535201">(</span><span class="op" id="2535202">*</span><span class="builtintype" id="2535203">uint32</span><span class="op" id="2535209">)</span><span class="op" id="2535210">(</span><span class="ident" id="2535211">unsafe</span><span class="op" id="2535217">.</span><span class="ident" id="2535218">Pointer</span><span class="op" id="2535225">(</span><span class="op" id="2535226">&amp;</span><span class="ident" id="2535227">b</span><span class="op" id="2535228">[</span><span class="num" id="2535229">8</span><span class="op" id="2535230">:</span><span class="num" id="2535231">12</span><span class="op" id="2535233">]</span><span class="op" id="2535234">[</span><span class="num" id="2535235">0</span><span class="op" id="2535236">]</span><span class="op" id="2535237">)</span><span class="op" id="2535238">)</span>&nbsp;<span class="op" id="2535240">=</span>&nbsp;<span class="ident" id="2535242">rr</span><span class="op" id="2535244">.</span><span class="ident" id="2535245">Header</span><span class="op" id="2535251">.</span><span class="ident" id="2535252">Seq</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2535257">*</span><span class="op" id="2535258">(</span><span class="op" id="2535259">*</span><span class="builtintype" id="2535260">uint32</span><span class="op" id="2535266">)</span><span class="op" id="2535267">(</span><span class="ident" id="2535268">unsafe</span><span class="op" id="2535274">.</span><span class="ident" id="2535275">Pointer</span><span class="op" id="2535282">(</span><span class="op" id="2535283">&amp;</span><span class="ident" id="2535284">b</span><span class="op" id="2535285">[</span><span class="num" id="2535286">12</span><span class="op" id="2535288">:</span><span class="num" id="2535289">16</span><span class="op" id="2535291">]</span><span class="op" id="2535292">[</span><span class="num" id="2535293">0</span><span class="op" id="2535294">]</span><span class="op" id="2535295">)</span><span class="op" id="2535296">)</span>&nbsp;<span class="op" id="2535298">=</span>&nbsp;<span class="ident" id="2535300">rr</span><span class="op" id="2535302">.</span><span class="ident" id="2535303">Header</span><span class="op" id="2535309">.</span><span class="ident" id="2535310">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2535315">b</span><span class="op" id="2535316">[</span><span class="num" id="2535317">16</span><span class="op" id="2535319">]</span>&nbsp;<span class="op" id="2535321">=</span>&nbsp;<span class="builtintype" id="2535323">byte</span><span class="op" id="2535327">(</span><span class="ident" id="2535328">rr</span><span class="op" id="2535330">.</span><span class="ident" id="2535331">Data</span><span class="op" id="2535335">.</span><span class="ident" id="2535336">Family</span><span class="op" id="2535342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2535345">return</span>&nbsp;<span class="ident" id="2535352">b</span><br>
<span class="lineno"></span><span class="op" id="2535354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2535357">func</span>&nbsp;<span class="ident" id="2535362">newNetlinkRouteRequest</span><span class="op" id="2535384">(</span><span class="ident" id="2535385">proto</span><span class="op" id="2535390">,</span>&nbsp;<span class="ident" id="2535392">seq</span><span class="op" id="2535395">,</span>&nbsp;<span class="ident" id="2535397">family</span>&nbsp;<span class="builtintype" id="2535404">int</span><span class="op" id="2535407">)</span>&nbsp;<span class="op" id="2535409">[</span><span class="op" id="2535410">]</span><span class="builtintype" id="2535411">byte</span>&nbsp;<span class="op" id="2535416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2535419">rr</span>&nbsp;<span class="op" id="2535422">:=</span>&nbsp;<span class="op" id="2535425">&amp;</span><span class="ident" id="2535426">NetlinkRouteRequest</span><span class="op" id="2535445">{</span><span class="op" id="2535446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2535449">rr</span><span class="op" id="2535451">.</span><span class="ident" id="2535452">Header</span><span class="op" id="2535458">.</span><span class="ident" id="2535459">Len</span>&nbsp;<span class="op" id="2535463">=</span>&nbsp;<span class="builtintype" id="2535465">uint32</span><span class="op" id="2535471">(</span><span class="ident" id="2535472">NLMSG_HDRLEN</span>&nbsp;<span class="op" id="2535485">+</span>&nbsp;<span class="ident" id="2535487">SizeofRtGenmsg</span><span class="op" id="2535501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2535504">rr</span><span class="op" id="2535506">.</span><span class="ident" id="2535507">Header</span><span class="op" id="2535513">.</span><span class="ident" id="2535514">Type</span>&nbsp;<span class="op" id="2535519">=</span>&nbsp;<span class="builtintype" id="2535521">uint16</span><span class="op" id="2535527">(</span><span class="ident" id="2535528">proto</span><span class="op" id="2535533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2535536">rr</span><span class="op" id="2535538">.</span><span class="ident" id="2535539">Header</span><span class="op" id="2535545">.</span><span class="ident" id="2535546">Flags</span>&nbsp;<span class="op" id="2535552">=</span>&nbsp;<span class="ident" id="2535554">NLM_F_DUMP</span>&nbsp;<span class="op" id="2535565">|</span>&nbsp;<span class="ident" id="2535567">NLM_F_REQUEST</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2535582">rr</span><span class="op" id="2535584">.</span><span class="ident" id="2535585">Header</span><span class="op" id="2535591">.</span><span class="ident" id="2535592">Seq</span>&nbsp;<span class="op" id="2535596">=</span>&nbsp;<span class="builtintype" id="2535598">uint32</span><span class="op" id="2535604">(</span><span class="ident" id="2535605">seq</span><span class="op" id="2535608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2535611">rr</span><span class="op" id="2535613">.</span><span class="ident" id="2535614">Data</span><span class="op" id="2535618">.</span><span class="ident" id="2535619">Family</span>&nbsp;<span class="op" id="2535626">=</span>&nbsp;<span class="builtintype" id="2535628">uint8</span><span class="op" id="2535633">(</span><span class="ident" id="2535634">family</span><span class="op" id="2535640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2535643">return</span>&nbsp;<span class="ident" id="2535650">rr</span><span class="op" id="2535652">.</span><span class="ident" id="2535653">toWireFormat</span><span class="op" id="2535665">(</span><span class="op" id="2535666">)</span><br>
<span class="lineno"></span><span class="op" id="2535668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="2535671">//&nbsp;NetlinkRIB&nbsp;returns&nbsp;routing&nbsp;information&nbsp;base,&nbsp;as&nbsp;known&nbsp;as&nbsp;RIB,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2535742">//&nbsp;consists&nbsp;of&nbsp;network&nbsp;facility&nbsp;information,&nbsp;states&nbsp;and&nbsp;parameters.</span><br>
<span class="lineno"></span><span class="keyword" id="2535810">func</span>&nbsp;<span class="ident" id="2535815">NetlinkRIB</span><span class="op" id="2535825">(</span><span class="ident" id="2535826">proto</span><span class="op" id="2535831">,</span>&nbsp;<span class="ident" id="2535833">family</span>&nbsp;<span class="builtintype" id="2535840">int</span><span class="op" id="2535843">)</span>&nbsp;<span class="op" id="2535845">(</span><span class="op" id="2535846">[</span><span class="op" id="2535847">]</span><span class="builtintype" id="2535848">byte</span><span class="op" id="2535852">,</span>&nbsp;<span class="builtintype" id="2535854">error</span><span class="op" id="2535859">)</span>&nbsp;<span class="op" id="2535861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2535864">s</span><span class="op" id="2535865">,</span>&nbsp;<span class="ident" id="2535867">err</span>&nbsp;<span class="op" id="2535871">:=</span>&nbsp;<span class="ident" id="2535874">Socket</span><span class="op" id="2535880">(</span><span class="ident" id="2535881">AF_NETLINK</span><span class="op" id="2535891">,</span>&nbsp;<span class="ident" id="2535893">SOCK_RAW</span><span class="op" id="2535901">,</span>&nbsp;<span class="ident" id="2535903">NETLINK_ROUTE</span><span class="op" id="2535916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2535919">if</span>&nbsp;<span class="ident" id="2535922">err</span>&nbsp;<span class="op" id="2535926">!=</span>&nbsp;<span class="builtintype" id="2535929">nil</span>&nbsp;<span class="op" id="2535933">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2535937">return</span>&nbsp;<span class="builtintype" id="2535944">nil</span><span class="op" id="2535947">,</span>&nbsp;<span class="ident" id="2535949">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2535954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2535957">defer</span>&nbsp;<span class="ident" id="2535963">Close</span><span class="op" id="2535968">(</span><span class="ident" id="2535969">s</span><span class="op" id="2535970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2535973">lsa</span>&nbsp;<span class="op" id="2535977">:=</span>&nbsp;<span class="op" id="2535980">&amp;</span><span class="ident" id="2535981">SockaddrNetlink</span><span class="op" id="2535996">{</span><span class="ident" id="2535997">Family</span><span class="op" id="2536003">:</span>&nbsp;<span class="ident" id="2536005">AF_NETLINK</span><span class="op" id="2536015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536018">if</span>&nbsp;<span class="ident" id="2536021">err</span>&nbsp;<span class="op" id="2536025">:=</span>&nbsp;<span class="ident" id="2536028">Bind</span><span class="op" id="2536032">(</span><span class="ident" id="2536033">s</span><span class="op" id="2536034">,</span>&nbsp;<span class="ident" id="2536036">lsa</span><span class="op" id="2536039">)</span><span class="op" id="2536040">;</span>&nbsp;<span class="ident" id="2536042">err</span>&nbsp;<span class="op" id="2536046">!=</span>&nbsp;<span class="builtintype" id="2536049">nil</span>&nbsp;<span class="op" id="2536053">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536057">return</span>&nbsp;<span class="builtintype" id="2536064">nil</span><span class="op" id="2536067">,</span>&nbsp;<span class="ident" id="2536069">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2536074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2536077">wb</span>&nbsp;<span class="op" id="2536080">:=</span>&nbsp;<span class="ident" id="2536083">newNetlinkRouteRequest</span><span class="op" id="2536105">(</span><span class="ident" id="2536106">proto</span><span class="op" id="2536111">,</span>&nbsp;<span class="num" id="2536113">1</span><span class="op" id="2536114">,</span>&nbsp;<span class="ident" id="2536116">family</span><span class="op" id="2536122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536125">if</span>&nbsp;<span class="ident" id="2536128">err</span>&nbsp;<span class="op" id="2536132">:=</span>&nbsp;<span class="ident" id="2536135">Sendto</span><span class="op" id="2536141">(</span><span class="ident" id="2536142">s</span><span class="op" id="2536143">,</span>&nbsp;<span class="ident" id="2536145">wb</span><span class="op" id="2536147">,</span>&nbsp;<span class="num" id="2536149">0</span><span class="op" id="2536150">,</span>&nbsp;<span class="ident" id="2536152">lsa</span><span class="op" id="2536155">)</span><span class="op" id="2536156">;</span>&nbsp;<span class="ident" id="2536158">err</span>&nbsp;<span class="op" id="2536162">!=</span>&nbsp;<span class="builtintype" id="2536165">nil</span>&nbsp;<span class="op" id="2536169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536173">return</span>&nbsp;<span class="builtintype" id="2536180">nil</span><span class="op" id="2536183">,</span>&nbsp;<span class="ident" id="2536185">err</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2536190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536193">var</span>&nbsp;<span class="ident" id="2536197">tab</span>&nbsp;<span class="op" id="2536201">[</span><span class="op" id="2536202">]</span><span class="builtintype" id="2536203">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2536209">rbNew</span>&nbsp;<span class="op" id="2536215">:=</span>&nbsp;<span class="builtinfunc" id="2536218">make</span><span class="op" id="2536222">(</span><span class="op" id="2536223">[</span><span class="op" id="2536224">]</span><span class="builtintype" id="2536225">byte</span><span class="op" id="2536229">,</span>&nbsp;<span class="ident" id="2536231">Getpagesize</span><span class="op" id="2536242">(</span><span class="op" id="2536243">)</span><span class="op" id="2536244">)</span><br>
<span class="lineno"></span><span class="ident" id="2536246">done</span><span class="op" id="2536250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536253">for</span>&nbsp;<span class="op" id="2536257">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2536261">rb</span>&nbsp;<span class="op" id="2536264">:=</span>&nbsp;<span class="ident" id="2536267">rbNew</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2536275">nr</span><span class="op" id="2536277">,</span>&nbsp;<span class="ident" id="2536279">_</span><span class="op" id="2536280">,</span>&nbsp;<span class="ident" id="2536282">err</span>&nbsp;<span class="op" id="2536286">:=</span>&nbsp;<span class="ident" id="2536289">Recvfrom</span><span class="op" id="2536297">(</span><span class="ident" id="2536298">s</span><span class="op" id="2536299">,</span>&nbsp;<span class="ident" id="2536301">rb</span><span class="op" id="2536303">,</span>&nbsp;<span class="num" id="2536305">0</span><span class="op" id="2536306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536310">if</span>&nbsp;<span class="ident" id="2536313">err</span>&nbsp;<span class="op" id="2536317">!=</span>&nbsp;<span class="builtintype" id="2536320">nil</span>&nbsp;<span class="op" id="2536324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536329">return</span>&nbsp;<span class="builtintype" id="2536336">nil</span><span class="op" id="2536339">,</span>&nbsp;<span class="ident" id="2536341">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2536347">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536351">if</span>&nbsp;<span class="ident" id="2536354">nr</span>&nbsp;<span class="op" id="2536357">&lt;</span>&nbsp;<span class="ident" id="2536359">NLMSG_HDRLEN</span>&nbsp;<span class="op" id="2536372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536377">return</span>&nbsp;<span class="builtintype" id="2536384">nil</span><span class="op" id="2536387">,</span>&nbsp;<span class="ident" id="2536389">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2536398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2536402">rb</span>&nbsp;<span class="op" id="2536405">=</span>&nbsp;<span class="ident" id="2536407">rb</span><span class="op" id="2536409">[</span><span class="op" id="2536410">:</span><span class="ident" id="2536411">nr</span><span class="op" id="2536413">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2536417">tab</span>&nbsp;<span class="op" id="2536421">=</span>&nbsp;<span class="builtinfunc" id="2536423">append</span><span class="op" id="2536429">(</span><span class="ident" id="2536430">tab</span><span class="op" id="2536433">,</span>&nbsp;<span class="ident" id="2536435">rb</span><span class="op" id="2536437">...</span><span class="op" id="2536440">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2536444">msgs</span><span class="op" id="2536448">,</span>&nbsp;<span class="ident" id="2536450">err</span>&nbsp;<span class="op" id="2536454">:=</span>&nbsp;<span class="ident" id="2536457">ParseNetlinkMessage</span><span class="op" id="2536476">(</span><span class="ident" id="2536477">rb</span><span class="op" id="2536479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536483">if</span>&nbsp;<span class="ident" id="2536486">err</span>&nbsp;<span class="op" id="2536490">!=</span>&nbsp;<span class="builtintype" id="2536493">nil</span>&nbsp;<span class="op" id="2536497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536502">return</span>&nbsp;<span class="builtintype" id="2536509">nil</span><span class="op" id="2536512">,</span>&nbsp;<span class="ident" id="2536514">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2536520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536524">for</span>&nbsp;<span class="ident" id="2536528">_</span><span class="op" id="2536529">,</span>&nbsp;<span class="ident" id="2536531">m</span>&nbsp;<span class="op" id="2536533">:=</span>&nbsp;<span class="keyword" id="2536536">range</span>&nbsp;<span class="ident" id="2536542">msgs</span>&nbsp;<span class="op" id="2536547">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2536552">lsa</span><span class="op" id="2536555">,</span>&nbsp;<span class="ident" id="2536557">err</span>&nbsp;<span class="op" id="2536561">:=</span>&nbsp;<span class="ident" id="2536564">Getsockname</span><span class="op" id="2536575">(</span><span class="ident" id="2536576">s</span><span class="op" id="2536577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536582">if</span>&nbsp;<span class="ident" id="2536585">err</span>&nbsp;<span class="op" id="2536589">!=</span>&nbsp;<span class="builtintype" id="2536592">nil</span>&nbsp;<span class="op" id="2536596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536602">return</span>&nbsp;<span class="builtintype" id="2536609">nil</span><span class="op" id="2536612">,</span>&nbsp;<span class="ident" id="2536614">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2536621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536626">switch</span>&nbsp;<span class="ident" id="2536633">v</span>&nbsp;<span class="op" id="2536635">:=</span>&nbsp;<span class="ident" id="2536638">lsa</span><span class="op" id="2536641">.</span><span class="op" id="2536642">(</span><span class="keyword" id="2536643">type</span><span class="op" id="2536647">)</span>&nbsp;<span class="op" id="2536649">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536654">case</span>&nbsp;<span class="op" id="2536659">*</span><span class="ident" id="2536660">SockaddrNetlink</span><span class="op" id="2536675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536681">if</span>&nbsp;<span class="ident" id="2536684">m</span><span class="op" id="2536685">.</span><span class="ident" id="2536686">Header</span><span class="op" id="2536692">.</span><span class="ident" id="2536693">Seq</span>&nbsp;<span class="op" id="2536697">!=</span>&nbsp;<span class="num" id="2536700">1</span>&nbsp;<span class="op" id="2536702">||</span>&nbsp;<span class="ident" id="2536705">m</span><span class="op" id="2536706">.</span><span class="ident" id="2536707">Header</span><span class="op" id="2536713">.</span><span class="ident" id="2536714">Pid</span>&nbsp;<span class="op" id="2536718">!=</span>&nbsp;<span class="ident" id="2536721">v</span><span class="op" id="2536722">.</span><span class="ident" id="2536723">Pid</span>&nbsp;<span class="op" id="2536727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536734">return</span>&nbsp;<span class="builtintype" id="2536741">nil</span><span class="op" id="2536744">,</span>&nbsp;<span class="ident" id="2536746">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2536757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536762">default</span><span class="op" id="2536769">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536775">return</span>&nbsp;<span class="builtintype" id="2536782">nil</span><span class="op" id="2536785">,</span>&nbsp;<span class="ident" id="2536787">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2536797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536802">if</span>&nbsp;<span class="ident" id="2536805">m</span><span class="op" id="2536806">.</span><span class="ident" id="2536807">Header</span><span class="op" id="2536813">.</span><span class="ident" id="2536814">Type</span>&nbsp;<span class="op" id="2536819">==</span>&nbsp;<span class="ident" id="2536822">NLMSG_DONE</span>&nbsp;<span class="op" id="2536833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536839">break</span>&nbsp;<span class="ident" id="2536845">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2536853">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536858">if</span>&nbsp;<span class="ident" id="2536861">m</span><span class="op" id="2536862">.</span><span class="ident" id="2536863">Header</span><span class="op" id="2536869">.</span><span class="ident" id="2536870">Type</span>&nbsp;<span class="op" id="2536875">==</span>&nbsp;<span class="ident" id="2536878">NLMSG_ERROR</span>&nbsp;<span class="op" id="2536890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536896">return</span>&nbsp;<span class="builtintype" id="2536903">nil</span><span class="op" id="2536906">,</span>&nbsp;<span class="ident" id="2536908">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2536918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2536922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2536925">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2536928">return</span>&nbsp;<span class="ident" id="2536935">tab</span><span class="op" id="2536938">,</span>&nbsp;<span class="builtintype" id="2536940">nil</span><br>
<span class="lineno"></span><span class="op" id="2536944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2536947">//&nbsp;NetlinkMessage&nbsp;represents&nbsp;a&nbsp;netlink&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="2536995">type</span>&nbsp;<span class="ident" id="2537000">NetlinkMessage</span>&nbsp;<span class="keyword" id="2537015">struct</span>&nbsp;<span class="op" id="2537022">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2537025">Header</span>&nbsp;<span class="ident" id="2537032">NlMsghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2537042">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2537049">[</span><span class="op" id="2537050">]</span><span class="builtintype" id="2537051">byte</span><br>
<span class="lineno"></span><span class="op" id="2537056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2537059">//&nbsp;ParseNetlinkMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;array&nbsp;of&nbsp;netlink&nbsp;messages&nbsp;and</span><br>
<span class="lineno">115</span><span class="comment" id="2537127">//&nbsp;returns&nbsp;the&nbsp;slice&nbsp;containing&nbsp;the&nbsp;NetlinkMessage&nbsp;structures.</span><br>
<span class="lineno"></span><span class="keyword" id="2537190">func</span>&nbsp;<span class="ident" id="2537195">ParseNetlinkMessage</span><span class="op" id="2537214">(</span><span class="ident" id="2537215">b</span>&nbsp;<span class="op" id="2537217">[</span><span class="op" id="2537218">]</span><span class="builtintype" id="2537219">byte</span><span class="op" id="2537223">)</span>&nbsp;<span class="op" id="2537225">(</span><span class="op" id="2537226">[</span><span class="op" id="2537227">]</span><span class="ident" id="2537228">NetlinkMessage</span><span class="op" id="2537242">,</span>&nbsp;<span class="builtintype" id="2537244">error</span><span class="op" id="2537249">)</span>&nbsp;<span class="op" id="2537251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2537254">var</span>&nbsp;<span class="ident" id="2537258">msgs</span>&nbsp;<span class="op" id="2537263">[</span><span class="op" id="2537264">]</span><span class="ident" id="2537265">NetlinkMessage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2537281">for</span>&nbsp;<span class="builtinfunc" id="2537285">len</span><span class="op" id="2537288">(</span><span class="ident" id="2537289">b</span><span class="op" id="2537290">)</span>&nbsp;<span class="op" id="2537292">&gt;=</span>&nbsp;<span class="ident" id="2537295">NLMSG_HDRLEN</span>&nbsp;<span class="op" id="2537308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2537312">h</span><span class="op" id="2537313">,</span>&nbsp;<span class="ident" id="2537315">dbuf</span><span class="op" id="2537319">,</span>&nbsp;<span class="ident" id="2537321">dlen</span><span class="op" id="2537325">,</span>&nbsp;<span class="ident" id="2537327">err</span>&nbsp;<span class="op" id="2537331">:=</span>&nbsp;<span class="ident" id="2537334">netlinkMessageHeaderAndData</span><span class="op" id="2537361">(</span><span class="ident" id="2537362">b</span><span class="op" id="2537363">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2537367">if</span>&nbsp;<span class="ident" id="2537370">err</span>&nbsp;<span class="op" id="2537374">!=</span>&nbsp;<span class="builtintype" id="2537377">nil</span>&nbsp;<span class="op" id="2537381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2537386">return</span>&nbsp;<span class="builtintype" id="2537393">nil</span><span class="op" id="2537396">,</span>&nbsp;<span class="ident" id="2537398">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2537404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2537408">m</span>&nbsp;<span class="op" id="2537410">:=</span>&nbsp;<span class="ident" id="2537413">NetlinkMessage</span><span class="op" id="2537427">{</span><span class="ident" id="2537428">Header</span><span class="op" id="2537434">:</span>&nbsp;<span class="op" id="2537436">*</span><span class="ident" id="2537437">h</span><span class="op" id="2537438">,</span>&nbsp;<span class="ident" id="2537440">Data</span><span class="op" id="2537444">:</span>&nbsp;<span class="ident" id="2537446">dbuf</span><span class="op" id="2537450">[</span><span class="op" id="2537451">:</span><span class="builtintype" id="2537452">int</span><span class="op" id="2537455">(</span><span class="ident" id="2537456">h</span><span class="op" id="2537457">.</span><span class="ident" id="2537458">Len</span><span class="op" id="2537461">)</span><span class="op" id="2537462">-</span><span class="ident" id="2537463">NLMSG_HDRLEN</span><span class="op" id="2537475">]</span><span class="op" id="2537476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2537480">msgs</span>&nbsp;<span class="op" id="2537485">=</span>&nbsp;<span class="builtinfunc" id="2537487">append</span><span class="op" id="2537493">(</span><span class="ident" id="2537494">msgs</span><span class="op" id="2537498">,</span>&nbsp;<span class="ident" id="2537500">m</span><span class="op" id="2537501">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2537505">b</span>&nbsp;<span class="op" id="2537507">=</span>&nbsp;<span class="ident" id="2537509">b</span><span class="op" id="2537510">[</span><span class="ident" id="2537511">dlen</span><span class="op" id="2537515">:</span><span class="op" id="2537516">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2537519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2537522">return</span>&nbsp;<span class="ident" id="2537529">msgs</span><span class="op" id="2537533">,</span>&nbsp;<span class="builtintype" id="2537535">nil</span><br>
<span class="lineno"></span><span class="op" id="2537539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="2537542">func</span>&nbsp;<span class="ident" id="2537547">netlinkMessageHeaderAndData</span><span class="op" id="2537574">(</span><span class="ident" id="2537575">b</span>&nbsp;<span class="op" id="2537577">[</span><span class="op" id="2537578">]</span><span class="builtintype" id="2537579">byte</span><span class="op" id="2537583">)</span>&nbsp;<span class="op" id="2537585">(</span><span class="op" id="2537586">*</span><span class="ident" id="2537587">NlMsghdr</span><span class="op" id="2537595">,</span>&nbsp;<span class="op" id="2537597">[</span><span class="op" id="2537598">]</span><span class="builtintype" id="2537599">byte</span><span class="op" id="2537603">,</span>&nbsp;<span class="builtintype" id="2537605">int</span><span class="op" id="2537608">,</span>&nbsp;<span class="builtintype" id="2537610">error</span><span class="op" id="2537615">)</span>&nbsp;<span class="op" id="2537617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2537620">h</span>&nbsp;<span class="op" id="2537622">:=</span>&nbsp;<span class="op" id="2537625">(</span><span class="op" id="2537626">*</span><span class="ident" id="2537627">NlMsghdr</span><span class="op" id="2537635">)</span><span class="op" id="2537636">(</span><span class="ident" id="2537637">unsafe</span><span class="op" id="2537643">.</span><span class="ident" id="2537644">Pointer</span><span class="op" id="2537651">(</span><span class="op" id="2537652">&amp;</span><span class="ident" id="2537653">b</span><span class="op" id="2537654">[</span><span class="num" id="2537655">0</span><span class="op" id="2537656">]</span><span class="op" id="2537657">)</span><span class="op" id="2537658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2537661">if</span>&nbsp;<span class="builtintype" id="2537664">int</span><span class="op" id="2537667">(</span><span class="ident" id="2537668">h</span><span class="op" id="2537669">.</span><span class="ident" id="2537670">Len</span><span class="op" id="2537673">)</span>&nbsp;<span class="op" id="2537675">&lt;</span>&nbsp;<span class="ident" id="2537677">NLMSG_HDRLEN</span>&nbsp;<span class="op" id="2537690">||</span>&nbsp;<span class="builtintype" id="2537693">int</span><span class="op" id="2537696">(</span><span class="ident" id="2537697">h</span><span class="op" id="2537698">.</span><span class="ident" id="2537699">Len</span><span class="op" id="2537702">)</span>&nbsp;<span class="op" id="2537704">&gt;</span>&nbsp;<span class="builtinfunc" id="2537706">len</span><span class="op" id="2537709">(</span><span class="ident" id="2537710">b</span><span class="op" id="2537711">)</span>&nbsp;<span class="op" id="2537713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2537717">return</span>&nbsp;<span class="builtintype" id="2537724">nil</span><span class="op" id="2537727">,</span>&nbsp;<span class="builtintype" id="2537729">nil</span><span class="op" id="2537732">,</span>&nbsp;<span class="num" id="2537734">0</span><span class="op" id="2537735">,</span>&nbsp;<span class="ident" id="2537737">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2537745">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2537748">return</span>&nbsp;<span class="ident" id="2537755">h</span><span class="op" id="2537756">,</span>&nbsp;<span class="ident" id="2537758">b</span><span class="op" id="2537759">[</span><span class="ident" id="2537760">NLMSG_HDRLEN</span><span class="op" id="2537772">:</span><span class="op" id="2537773">]</span><span class="op" id="2537774">,</span>&nbsp;<span class="ident" id="2537776">nlmAlignOf</span><span class="op" id="2537786">(</span><span class="builtintype" id="2537787">int</span><span class="op" id="2537790">(</span><span class="ident" id="2537791">h</span><span class="op" id="2537792">.</span><span class="ident" id="2537793">Len</span><span class="op" id="2537796">)</span><span class="op" id="2537797">)</span><span class="op" id="2537798">,</span>&nbsp;<span class="builtintype" id="2537800">nil</span><br>
<span class="lineno"></span><span class="op" id="2537804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2537807">//&nbsp;NetlinkRouteAttr&nbsp;represents&nbsp;a&nbsp;netlink&nbsp;route&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="2537865">type</span>&nbsp;<span class="ident" id="2537870">NetlinkRouteAttr</span>&nbsp;<span class="keyword" id="2537887">struct</span>&nbsp;<span class="op" id="2537894">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2537897">Attr</span>&nbsp;&nbsp;<span class="ident" id="2537903">RtAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2537911">Value</span>&nbsp;<span class="op" id="2537917">[</span><span class="op" id="2537918">]</span><span class="builtintype" id="2537919">byte</span><br>
<span class="lineno"></span><span class="op" id="2537924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2537927">//&nbsp;ParseNetlinkRouteAttr&nbsp;parses&nbsp;m&#39;s&nbsp;payload&nbsp;as&nbsp;an&nbsp;array&nbsp;of&nbsp;netlink</span><br>
<span class="lineno">145</span><span class="comment" id="2537994">//&nbsp;route&nbsp;attributes&nbsp;and&nbsp;returns&nbsp;the&nbsp;slice&nbsp;containing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2538051">//&nbsp;NetlinkRouteAttr&nbsp;structures.</span><br>
<span class="lineno"></span><span class="keyword" id="2538083">func</span>&nbsp;<span class="ident" id="2538088">ParseNetlinkRouteAttr</span><span class="op" id="2538109">(</span><span class="ident" id="2538110">m</span>&nbsp;<span class="op" id="2538112">*</span><span class="ident" id="2538113">NetlinkMessage</span><span class="op" id="2538127">)</span>&nbsp;<span class="op" id="2538129">(</span><span class="op" id="2538130">[</span><span class="op" id="2538131">]</span><span class="ident" id="2538132">NetlinkRouteAttr</span><span class="op" id="2538148">,</span>&nbsp;<span class="builtintype" id="2538150">error</span><span class="op" id="2538155">)</span>&nbsp;<span class="op" id="2538157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538160">var</span>&nbsp;<span class="ident" id="2538164">b</span>&nbsp;<span class="op" id="2538166">[</span><span class="op" id="2538167">]</span><span class="builtintype" id="2538168">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538174">switch</span>&nbsp;<span class="ident" id="2538181">m</span><span class="op" id="2538182">.</span><span class="ident" id="2538183">Header</span><span class="op" id="2538189">.</span><span class="ident" id="2538190">Type</span>&nbsp;<span class="op" id="2538195">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538198">case</span>&nbsp;<span class="ident" id="2538203">RTM_NEWLINK</span><span class="op" id="2538214">,</span>&nbsp;<span class="ident" id="2538216">RTM_DELLINK</span><span class="op" id="2538227">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2538231">b</span>&nbsp;<span class="op" id="2538233">=</span>&nbsp;<span class="ident" id="2538235">m</span><span class="op" id="2538236">.</span><span class="ident" id="2538237">Data</span><span class="op" id="2538241">[</span><span class="ident" id="2538242">SizeofIfInfomsg</span><span class="op" id="2538257">:</span><span class="op" id="2538258">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538261">case</span>&nbsp;<span class="ident" id="2538266">RTM_NEWADDR</span><span class="op" id="2538277">,</span>&nbsp;<span class="ident" id="2538279">RTM_DELADDR</span><span class="op" id="2538290">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2538294">b</span>&nbsp;<span class="op" id="2538296">=</span>&nbsp;<span class="ident" id="2538298">m</span><span class="op" id="2538299">.</span><span class="ident" id="2538300">Data</span><span class="op" id="2538304">[</span><span class="ident" id="2538305">SizeofIfAddrmsg</span><span class="op" id="2538320">:</span><span class="op" id="2538321">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538324">case</span>&nbsp;<span class="ident" id="2538329">RTM_NEWROUTE</span><span class="op" id="2538341">,</span>&nbsp;<span class="ident" id="2538343">RTM_DELROUTE</span><span class="op" id="2538355">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2538359">b</span>&nbsp;<span class="op" id="2538361">=</span>&nbsp;<span class="ident" id="2538363">m</span><span class="op" id="2538364">.</span><span class="ident" id="2538365">Data</span><span class="op" id="2538369">[</span><span class="ident" id="2538370">SizeofRtMsg</span><span class="op" id="2538381">:</span><span class="op" id="2538382">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538385">default</span><span class="op" id="2538392">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538396">return</span>&nbsp;<span class="builtintype" id="2538403">nil</span><span class="op" id="2538406">,</span>&nbsp;<span class="ident" id="2538408">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2538416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538419">var</span>&nbsp;<span class="ident" id="2538423">attrs</span>&nbsp;<span class="op" id="2538429">[</span><span class="op" id="2538430">]</span><span class="ident" id="2538431">NetlinkRouteAttr</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538449">for</span>&nbsp;<span class="builtinfunc" id="2538453">len</span><span class="op" id="2538456">(</span><span class="ident" id="2538457">b</span><span class="op" id="2538458">)</span>&nbsp;<span class="op" id="2538460">&gt;=</span>&nbsp;<span class="ident" id="2538463">SizeofRtAttr</span>&nbsp;<span class="op" id="2538476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2538480">a</span><span class="op" id="2538481">,</span>&nbsp;<span class="ident" id="2538483">vbuf</span><span class="op" id="2538487">,</span>&nbsp;<span class="ident" id="2538489">alen</span><span class="op" id="2538493">,</span>&nbsp;<span class="ident" id="2538495">err</span>&nbsp;<span class="op" id="2538499">:=</span>&nbsp;<span class="ident" id="2538502">netlinkRouteAttrAndValue</span><span class="op" id="2538526">(</span><span class="ident" id="2538527">b</span><span class="op" id="2538528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538532">if</span>&nbsp;<span class="ident" id="2538535">err</span>&nbsp;<span class="op" id="2538539">!=</span>&nbsp;<span class="builtintype" id="2538542">nil</span>&nbsp;<span class="op" id="2538546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538551">return</span>&nbsp;<span class="builtintype" id="2538558">nil</span><span class="op" id="2538561">,</span>&nbsp;<span class="ident" id="2538563">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2538569">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2538573">ra</span>&nbsp;<span class="op" id="2538576">:=</span>&nbsp;<span class="ident" id="2538579">NetlinkRouteAttr</span><span class="op" id="2538595">{</span><span class="ident" id="2538596">Attr</span><span class="op" id="2538600">:</span>&nbsp;<span class="op" id="2538602">*</span><span class="ident" id="2538603">a</span><span class="op" id="2538604">,</span>&nbsp;<span class="ident" id="2538606">Value</span><span class="op" id="2538611">:</span>&nbsp;<span class="ident" id="2538613">vbuf</span><span class="op" id="2538617">[</span><span class="op" id="2538618">:</span><span class="builtintype" id="2538619">int</span><span class="op" id="2538622">(</span><span class="ident" id="2538623">a</span><span class="op" id="2538624">.</span><span class="ident" id="2538625">Len</span><span class="op" id="2538628">)</span><span class="op" id="2538629">-</span><span class="ident" id="2538630">SizeofRtAttr</span><span class="op" id="2538642">]</span><span class="op" id="2538643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2538647">attrs</span>&nbsp;<span class="op" id="2538653">=</span>&nbsp;<span class="builtinfunc" id="2538655">append</span><span class="op" id="2538661">(</span><span class="ident" id="2538662">attrs</span><span class="op" id="2538667">,</span>&nbsp;<span class="ident" id="2538669">ra</span><span class="op" id="2538671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2538675">b</span>&nbsp;<span class="op" id="2538677">=</span>&nbsp;<span class="ident" id="2538679">b</span><span class="op" id="2538680">[</span><span class="ident" id="2538681">alen</span><span class="op" id="2538685">:</span><span class="op" id="2538686">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2538689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538692">return</span>&nbsp;<span class="ident" id="2538699">attrs</span><span class="op" id="2538704">,</span>&nbsp;<span class="builtintype" id="2538706">nil</span><br>
<span class="lineno">170</span><span class="op" id="2538710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2538713">func</span>&nbsp;<span class="ident" id="2538718">netlinkRouteAttrAndValue</span><span class="op" id="2538742">(</span><span class="ident" id="2538743">b</span>&nbsp;<span class="op" id="2538745">[</span><span class="op" id="2538746">]</span><span class="builtintype" id="2538747">byte</span><span class="op" id="2538751">)</span>&nbsp;<span class="op" id="2538753">(</span><span class="op" id="2538754">*</span><span class="ident" id="2538755">RtAttr</span><span class="op" id="2538761">,</span>&nbsp;<span class="op" id="2538763">[</span><span class="op" id="2538764">]</span><span class="builtintype" id="2538765">byte</span><span class="op" id="2538769">,</span>&nbsp;<span class="builtintype" id="2538771">int</span><span class="op" id="2538774">,</span>&nbsp;<span class="builtintype" id="2538776">error</span><span class="op" id="2538781">)</span>&nbsp;<span class="op" id="2538783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2538786">a</span>&nbsp;<span class="op" id="2538788">:=</span>&nbsp;<span class="op" id="2538791">(</span><span class="op" id="2538792">*</span><span class="ident" id="2538793">RtAttr</span><span class="op" id="2538799">)</span><span class="op" id="2538800">(</span><span class="ident" id="2538801">unsafe</span><span class="op" id="2538807">.</span><span class="ident" id="2538808">Pointer</span><span class="op" id="2538815">(</span><span class="op" id="2538816">&amp;</span><span class="ident" id="2538817">b</span><span class="op" id="2538818">[</span><span class="num" id="2538819">0</span><span class="op" id="2538820">]</span><span class="op" id="2538821">)</span><span class="op" id="2538822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538825">if</span>&nbsp;<span class="builtintype" id="2538828">int</span><span class="op" id="2538831">(</span><span class="ident" id="2538832">a</span><span class="op" id="2538833">.</span><span class="ident" id="2538834">Len</span><span class="op" id="2538837">)</span>&nbsp;<span class="op" id="2538839">&lt;</span>&nbsp;<span class="ident" id="2538841">SizeofRtAttr</span>&nbsp;<span class="op" id="2538854">||</span>&nbsp;<span class="builtintype" id="2538857">int</span><span class="op" id="2538860">(</span><span class="ident" id="2538861">a</span><span class="op" id="2538862">.</span><span class="ident" id="2538863">Len</span><span class="op" id="2538866">)</span>&nbsp;<span class="op" id="2538868">&gt;</span>&nbsp;<span class="builtinfunc" id="2538870">len</span><span class="op" id="2538873">(</span><span class="ident" id="2538874">b</span><span class="op" id="2538875">)</span>&nbsp;<span class="op" id="2538877">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538881">return</span>&nbsp;<span class="builtintype" id="2538888">nil</span><span class="op" id="2538891">,</span>&nbsp;<span class="builtintype" id="2538893">nil</span><span class="op" id="2538896">,</span>&nbsp;<span class="num" id="2538898">0</span><span class="op" id="2538899">,</span>&nbsp;<span class="ident" id="2538901">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2538909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2538912">return</span>&nbsp;<span class="ident" id="2538919">a</span><span class="op" id="2538920">,</span>&nbsp;<span class="ident" id="2538922">b</span><span class="op" id="2538923">[</span><span class="ident" id="2538924">SizeofRtAttr</span><span class="op" id="2538936">:</span><span class="op" id="2538937">]</span><span class="op" id="2538938">,</span>&nbsp;<span class="ident" id="2538940">rtaAlignOf</span><span class="op" id="2538950">(</span><span class="builtintype" id="2538951">int</span><span class="op" id="2538954">(</span><span class="ident" id="2538955">a</span><span class="op" id="2538956">.</span><span class="ident" id="2538957">Len</span><span class="op" id="2538960">)</span><span class="op" id="2538961">)</span><span class="op" id="2538962">,</span>&nbsp;<span class="builtintype" id="2538964">nil</span><br>
<span class="lineno"></span><span class="op" id="2538968">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
