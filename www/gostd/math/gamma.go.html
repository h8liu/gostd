<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1853264">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1853319">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1853373">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1853424">package</span>&nbsp;<span class="ident" id="1853432">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1853438">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1853498">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="1853563">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="1853621">//</span><br>
<span class="lineno"></span><span class="comment" id="1853624">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="1853641">//</span><br>
<span class="lineno"></span><span class="comment" id="1853644">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="1853667">//</span><br>
<span class="lineno">15</span><span class="comment" id="1853670">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="1853683">//</span><br>
<span class="lineno"></span><span class="comment" id="1853686">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="1853712">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="1853735">//</span><br>
<span class="lineno">20</span><span class="comment" id="1853738">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="1853758">//</span><br>
<span class="lineno"></span><span class="comment" id="1853761">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="1853777">//</span><br>
<span class="lineno"></span><span class="comment" id="1853780">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="1853838">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="1853891">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="1853948">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="1854008">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="1854030">//</span><br>
<span class="lineno">30</span><span class="comment" id="1854033">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="1854099">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1854159">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="1854221">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="1854282">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="1854307">//</span><br>
<span class="lineno"></span><span class="comment" id="1854310">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="1854323">//</span><br>
<span class="lineno"></span><span class="comment" id="1854326">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="1854366">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="1854424">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="1854484">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="1854544">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="1854604">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="1854664">//</span><br>
<span class="lineno">45</span><span class="comment" id="1854667">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="1854728">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="1854789">//</span><br>
<span class="lineno"></span><span class="comment" id="1854792">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="1854840">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="1854904">//</span><br>
<span class="lineno"></span><span class="comment" id="1854907">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="1854968">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1855038">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="1855113">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="1855180">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="1855253">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1855325">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="1855339">//</span><br>
<span class="lineno"></span><span class="comment" id="1855342">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="1855408">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="1855474">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="1855487">//</span><br>
<span class="lineno"></span><span class="comment" id="1855490">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="1855514">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="1855544">var</span>&nbsp;<span class="ident" id="1855548">_gamP</span>&nbsp;<span class="op" id="1855554">=</span>&nbsp;<span class="op" id="1855556">[</span><span class="op" id="1855557">...</span><span class="op" id="1855560">]</span><span class="builtintype" id="1855561">float64</span><span class="op" id="1855568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1855571">1.60119522476751861407e-04</span><span class="op" id="1855597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1855600">1.19135147006586384913e-03</span><span class="op" id="1855626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1855629">1.04213797561761569935e-02</span><span class="op" id="1855655">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1855658">4.76367800457137231464e-02</span><span class="op" id="1855684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1855687">2.07448227648435975150e-01</span><span class="op" id="1855713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1855716">4.94214826801497100753e-01</span><span class="op" id="1855742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1855745">9.99999999999999996796e-01</span><span class="op" id="1855771">,</span><br>
<span class="lineno"></span><span class="op" id="1855773">}</span><br>
<span class="lineno">75</span><span class="keyword" id="1855775">var</span>&nbsp;<span class="ident" id="1855779">_gamQ</span>&nbsp;<span class="op" id="1855785">=</span>&nbsp;<span class="op" id="1855787">[</span><span class="op" id="1855788">...</span><span class="op" id="1855791">]</span><span class="builtintype" id="1855792">float64</span><span class="op" id="1855799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1855802">-</span><span class="num" id="1855803">2.31581873324120129819e-05</span><span class="op" id="1855829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1855832">5.39605580493303397842e-04</span><span class="op" id="1855858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1855861">-</span><span class="num" id="1855862">4.45641913851797240494e-03</span><span class="op" id="1855888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1855891">1.18139785222060435552e-02</span><span class="op" id="1855917">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1855920">3.58236398605498653373e-02</span><span class="op" id="1855946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1855949">-</span><span class="num" id="1855950">2.34591795718243348568e-01</span><span class="op" id="1855976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1855979">7.14304917030273074085e-02</span><span class="op" id="1856005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1856008">1.00000000000000000320e+00</span><span class="op" id="1856034">,</span><br>
<span class="lineno"></span><span class="op" id="1856036">}</span><br>
<span class="lineno">85</span><span class="keyword" id="1856038">var</span>&nbsp;<span class="ident" id="1856042">_gamS</span>&nbsp;<span class="op" id="1856048">=</span>&nbsp;<span class="op" id="1856050">[</span><span class="op" id="1856051">...</span><span class="op" id="1856054">]</span><span class="builtintype" id="1856055">float64</span><span class="op" id="1856062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1856065">7.87311395793093628397e-04</span><span class="op" id="1856091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1856094">-</span><span class="num" id="1856095">2.29549961613378126380e-04</span><span class="op" id="1856121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1856124">-</span><span class="num" id="1856125">2.68132617805781232825e-03</span><span class="op" id="1856151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1856154">3.47222221605458667310e-03</span><span class="op" id="1856180">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1856183">8.33333333333482257126e-02</span><span class="op" id="1856209">,</span><br>
<span class="lineno"></span><span class="op" id="1856211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1856214">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="1856264">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="1856311">func</span>&nbsp;<span class="ident" id="1856316">stirling</span><span class="op" id="1856324">(</span><span class="ident" id="1856325">x</span>&nbsp;<span class="builtintype" id="1856327">float64</span><span class="op" id="1856334">)</span>&nbsp;<span class="builtintype" id="1856336">float64</span>&nbsp;<span class="op" id="1856344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1856347">const</span>&nbsp;<span class="op" id="1856353">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1856357">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1856369">=</span>&nbsp;<span class="num" id="1856371">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1856397">MaxStirling</span>&nbsp;<span class="op" id="1856409">=</span>&nbsp;<span class="num" id="1856411">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1856422">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1856425">w</span>&nbsp;<span class="op" id="1856427">:=</span>&nbsp;<span class="num" id="1856430">1</span>&nbsp;<span class="op" id="1856432">/</span>&nbsp;<span class="ident" id="1856434">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1856437">w</span>&nbsp;<span class="op" id="1856439">=</span>&nbsp;<span class="num" id="1856441">1</span>&nbsp;<span class="op" id="1856443">+</span>&nbsp;<span class="ident" id="1856445">w</span><span class="op" id="1856446">*</span><span class="op" id="1856447">(</span><span class="op" id="1856448">(</span><span class="op" id="1856449">(</span><span class="op" id="1856450">(</span><span class="ident" id="1856451">_gamS</span><span class="op" id="1856456">[</span><span class="num" id="1856457">0</span><span class="op" id="1856458">]</span><span class="op" id="1856459">*</span><span class="ident" id="1856460">w</span><span class="op" id="1856461">+</span><span class="ident" id="1856462">_gamS</span><span class="op" id="1856467">[</span><span class="num" id="1856468">1</span><span class="op" id="1856469">]</span><span class="op" id="1856470">)</span><span class="op" id="1856471">*</span><span class="ident" id="1856472">w</span><span class="op" id="1856473">+</span><span class="ident" id="1856474">_gamS</span><span class="op" id="1856479">[</span><span class="num" id="1856480">2</span><span class="op" id="1856481">]</span><span class="op" id="1856482">)</span><span class="op" id="1856483">*</span><span class="ident" id="1856484">w</span><span class="op" id="1856485">+</span><span class="ident" id="1856486">_gamS</span><span class="op" id="1856491">[</span><span class="num" id="1856492">3</span><span class="op" id="1856493">]</span><span class="op" id="1856494">)</span><span class="op" id="1856495">*</span><span class="ident" id="1856496">w</span><span class="op" id="1856497">+</span><span class="ident" id="1856498">_gamS</span><span class="op" id="1856503">[</span><span class="num" id="1856504">4</span><span class="op" id="1856505">]</span><span class="op" id="1856506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1856509">y</span>&nbsp;<span class="op" id="1856511">:=</span>&nbsp;<span class="ident" id="1856514">Exp</span><span class="op" id="1856517">(</span><span class="ident" id="1856518">x</span><span class="op" id="1856519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1856522">if</span>&nbsp;<span class="ident" id="1856525">x</span>&nbsp;<span class="op" id="1856527">&gt;</span>&nbsp;<span class="ident" id="1856529">MaxStirling</span>&nbsp;<span class="op" id="1856541">{</span>&nbsp;<span class="comment" id="1856543">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1856569">v</span>&nbsp;<span class="op" id="1856571">:=</span>&nbsp;<span class="ident" id="1856574">Pow</span><span class="op" id="1856577">(</span><span class="ident" id="1856578">x</span><span class="op" id="1856579">,</span>&nbsp;<span class="num" id="1856581">0.5</span><span class="op" id="1856584">*</span><span class="ident" id="1856585">x</span><span class="op" id="1856586">-</span><span class="num" id="1856587">0.25</span><span class="op" id="1856591">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1856595">y</span>&nbsp;<span class="op" id="1856597">=</span>&nbsp;<span class="ident" id="1856599">v</span>&nbsp;<span class="op" id="1856601">*</span>&nbsp;<span class="op" id="1856603">(</span><span class="ident" id="1856604">v</span>&nbsp;<span class="op" id="1856606">/</span>&nbsp;<span class="ident" id="1856608">y</span><span class="op" id="1856609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1856612">}</span>&nbsp;<span class="keyword" id="1856614">else</span>&nbsp;<span class="op" id="1856619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1856623">y</span>&nbsp;<span class="op" id="1856625">=</span>&nbsp;<span class="ident" id="1856627">Pow</span><span class="op" id="1856630">(</span><span class="ident" id="1856631">x</span><span class="op" id="1856632">,</span>&nbsp;<span class="ident" id="1856634">x</span><span class="op" id="1856635">-</span><span class="num" id="1856636">0.5</span><span class="op" id="1856639">)</span>&nbsp;<span class="op" id="1856641">/</span>&nbsp;<span class="ident" id="1856643">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1856646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1856649">y</span>&nbsp;<span class="op" id="1856651">=</span>&nbsp;<span class="ident" id="1856653">SqrtTwoPi</span>&nbsp;<span class="op" id="1856663">*</span>&nbsp;<span class="ident" id="1856665">y</span>&nbsp;<span class="op" id="1856667">*</span>&nbsp;<span class="ident" id="1856669">w</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1856672">return</span>&nbsp;<span class="ident" id="1856679">y</span><br>
<span class="lineno"></span><span class="op" id="1856681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1856684">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1856726">//</span><br>
<span class="lineno">115</span><span class="comment" id="1856729">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1856751">//&nbsp;&nbsp;&nbsp;&nbspGamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1856773">//&nbsp;&nbsp;&nbsp;&nbspGamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1856793">//&nbsp;&nbsp;&nbsp;&nbspGamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="1856813">//&nbsp;&nbsp;&nbsp;&nbspGamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="1856849">//&nbsp;&nbsp;&nbsp;&nbspGamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1856870">//&nbsp;&nbsp;&nbsp;&nbspGamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1856890">func</span>&nbsp;<span class="ident" id="1856895">Gamma</span><span class="op" id="1856900">(</span><span class="ident" id="1856901">x</span>&nbsp;<span class="builtintype" id="1856903">float64</span><span class="op" id="1856910">)</span>&nbsp;<span class="builtintype" id="1856912">float64</span>&nbsp;<span class="op" id="1856920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1856923">const</span>&nbsp;<span class="ident" id="1856929">Euler</span>&nbsp;<span class="op" id="1856935">=</span>&nbsp;<span class="num" id="1856937">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="1856990">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1857002">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857020">switch</span>&nbsp;<span class="op" id="1857027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857030">case</span>&nbsp;<span class="ident" id="1857035">isNegInt</span><span class="op" id="1857043">(</span><span class="ident" id="1857044">x</span><span class="op" id="1857045">)</span>&nbsp;<span class="op" id="1857047">||</span>&nbsp;<span class="ident" id="1857050">IsInf</span><span class="op" id="1857055">(</span><span class="ident" id="1857056">x</span><span class="op" id="1857057">,</span>&nbsp;<span class="op" id="1857059">-</span><span class="num" id="1857060">1</span><span class="op" id="1857061">)</span>&nbsp;<span class="op" id="1857063">||</span>&nbsp;<span class="ident" id="1857066">IsNaN</span><span class="op" id="1857071">(</span><span class="ident" id="1857072">x</span><span class="op" id="1857073">)</span><span class="op" id="1857074">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857078">return</span>&nbsp;<span class="ident" id="1857085">NaN</span><span class="op" id="1857088">(</span><span class="op" id="1857089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857092">case</span>&nbsp;<span class="ident" id="1857097">x</span>&nbsp;<span class="op" id="1857099">==</span>&nbsp;<span class="num" id="1857102">0</span><span class="op" id="1857103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857107">if</span>&nbsp;<span class="ident" id="1857110">Signbit</span><span class="op" id="1857117">(</span><span class="ident" id="1857118">x</span><span class="op" id="1857119">)</span>&nbsp;<span class="op" id="1857121">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857126">return</span>&nbsp;<span class="ident" id="1857133">Inf</span><span class="op" id="1857136">(</span><span class="op" id="1857137">-</span><span class="num" id="1857138">1</span><span class="op" id="1857139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857147">return</span>&nbsp;<span class="ident" id="1857154">Inf</span><span class="op" id="1857157">(</span><span class="num" id="1857158">1</span><span class="op" id="1857159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857162">case</span>&nbsp;<span class="ident" id="1857167">x</span>&nbsp;<span class="op" id="1857169">&lt;</span>&nbsp;<span class="op" id="1857171">-</span><span class="num" id="1857172">170.5674972726612</span>&nbsp;<span class="op" id="1857190">||</span>&nbsp;<span class="ident" id="1857193">x</span>&nbsp;<span class="op" id="1857195">&gt;</span>&nbsp;<span class="num" id="1857197">171.61447887182298</span><span class="op" id="1857215">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857219">return</span>&nbsp;<span class="ident" id="1857226">Inf</span><span class="op" id="1857229">(</span><span class="num" id="1857230">1</span><span class="op" id="1857231">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857237">q</span>&nbsp;<span class="op" id="1857239">:=</span>&nbsp;<span class="ident" id="1857242">Abs</span><span class="op" id="1857245">(</span><span class="ident" id="1857246">x</span><span class="op" id="1857247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857250">p</span>&nbsp;<span class="op" id="1857252">:=</span>&nbsp;<span class="ident" id="1857255">Floor</span><span class="op" id="1857260">(</span><span class="ident" id="1857261">q</span><span class="op" id="1857262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857265">if</span>&nbsp;<span class="ident" id="1857268">q</span>&nbsp;<span class="op" id="1857270">&gt;</span>&nbsp;<span class="num" id="1857272">33</span>&nbsp;<span class="op" id="1857275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857279">if</span>&nbsp;<span class="ident" id="1857282">x</span>&nbsp;<span class="op" id="1857284">&gt;=</span>&nbsp;<span class="num" id="1857287">0</span>&nbsp;<span class="op" id="1857289">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857294">return</span>&nbsp;<span class="ident" id="1857301">stirling</span><span class="op" id="1857309">(</span><span class="ident" id="1857310">x</span><span class="op" id="1857311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857319">signgam</span>&nbsp;<span class="op" id="1857327">:=</span>&nbsp;<span class="num" id="1857330">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857334">if</span>&nbsp;<span class="ident" id="1857337">ip</span>&nbsp;<span class="op" id="1857340">:=</span>&nbsp;<span class="builtintype" id="1857343">int</span><span class="op" id="1857346">(</span><span class="ident" id="1857347">p</span><span class="op" id="1857348">)</span><span class="op" id="1857349">;</span>&nbsp;<span class="ident" id="1857351">ip</span><span class="op" id="1857353">&amp;</span><span class="num" id="1857354">1</span>&nbsp;<span class="op" id="1857356">==</span>&nbsp;<span class="num" id="1857359">0</span>&nbsp;<span class="op" id="1857361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857366">signgam</span>&nbsp;<span class="op" id="1857374">=</span>&nbsp;<span class="op" id="1857376">-</span><span class="num" id="1857377">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857385">z</span>&nbsp;<span class="op" id="1857387">:=</span>&nbsp;<span class="ident" id="1857390">q</span>&nbsp;<span class="op" id="1857392">-</span>&nbsp;<span class="ident" id="1857394">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857398">if</span>&nbsp;<span class="ident" id="1857401">z</span>&nbsp;<span class="op" id="1857403">&gt;</span>&nbsp;<span class="num" id="1857405">0.5</span>&nbsp;<span class="op" id="1857409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857414">p</span>&nbsp;<span class="op" id="1857416">=</span>&nbsp;<span class="ident" id="1857418">p</span>&nbsp;<span class="op" id="1857420">+</span>&nbsp;<span class="num" id="1857422">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857427">z</span>&nbsp;<span class="op" id="1857429">=</span>&nbsp;<span class="ident" id="1857431">q</span>&nbsp;<span class="op" id="1857433">-</span>&nbsp;<span class="ident" id="1857435">p</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857443">z</span>&nbsp;<span class="op" id="1857445">=</span>&nbsp;<span class="ident" id="1857447">q</span>&nbsp;<span class="op" id="1857449">*</span>&nbsp;<span class="ident" id="1857451">Sin</span><span class="op" id="1857454">(</span><span class="ident" id="1857455">Pi</span><span class="op" id="1857457">*</span><span class="ident" id="1857458">z</span><span class="op" id="1857459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857463">if</span>&nbsp;<span class="ident" id="1857466">z</span>&nbsp;<span class="op" id="1857468">==</span>&nbsp;<span class="num" id="1857471">0</span>&nbsp;<span class="op" id="1857473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857478">return</span>&nbsp;<span class="ident" id="1857485">Inf</span><span class="op" id="1857488">(</span><span class="ident" id="1857489">signgam</span><span class="op" id="1857496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857500">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857504">z</span>&nbsp;<span class="op" id="1857506">=</span>&nbsp;<span class="ident" id="1857508">Pi</span>&nbsp;<span class="op" id="1857511">/</span>&nbsp;<span class="op" id="1857513">(</span><span class="ident" id="1857514">Abs</span><span class="op" id="1857517">(</span><span class="ident" id="1857518">z</span><span class="op" id="1857519">)</span>&nbsp;<span class="op" id="1857521">*</span>&nbsp;<span class="ident" id="1857523">stirling</span><span class="op" id="1857531">(</span><span class="ident" id="1857532">q</span><span class="op" id="1857533">)</span><span class="op" id="1857534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857538">return</span>&nbsp;<span class="builtintype" id="1857545">float64</span><span class="op" id="1857552">(</span><span class="ident" id="1857553">signgam</span><span class="op" id="1857560">)</span>&nbsp;<span class="op" id="1857562">*</span>&nbsp;<span class="ident" id="1857564">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1857571">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857591">z</span>&nbsp;<span class="op" id="1857593">:=</span>&nbsp;<span class="num" id="1857596">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857601">for</span>&nbsp;<span class="ident" id="1857605">x</span>&nbsp;<span class="op" id="1857607">&gt;=</span>&nbsp;<span class="num" id="1857610">3</span>&nbsp;<span class="op" id="1857612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857616">x</span>&nbsp;<span class="op" id="1857618">=</span>&nbsp;<span class="ident" id="1857620">x</span>&nbsp;<span class="op" id="1857622">-</span>&nbsp;<span class="num" id="1857624">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857628">z</span>&nbsp;<span class="op" id="1857630">=</span>&nbsp;<span class="ident" id="1857632">z</span>&nbsp;<span class="op" id="1857634">*</span>&nbsp;<span class="ident" id="1857636">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857639">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857642">for</span>&nbsp;<span class="ident" id="1857646">x</span>&nbsp;<span class="op" id="1857648">&lt;</span>&nbsp;<span class="num" id="1857650">0</span>&nbsp;<span class="op" id="1857652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857656">if</span>&nbsp;<span class="ident" id="1857659">x</span>&nbsp;<span class="op" id="1857661">&gt;</span>&nbsp;<span class="op" id="1857663">-</span><span class="num" id="1857664">1e-09</span>&nbsp;<span class="op" id="1857670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857675">goto</span>&nbsp;<span class="ident" id="1857680">small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857692">z</span>&nbsp;<span class="op" id="1857694">=</span>&nbsp;<span class="ident" id="1857696">z</span>&nbsp;<span class="op" id="1857698">/</span>&nbsp;<span class="ident" id="1857700">x</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857704">x</span>&nbsp;<span class="op" id="1857706">=</span>&nbsp;<span class="ident" id="1857708">x</span>&nbsp;<span class="op" id="1857710">+</span>&nbsp;<span class="num" id="1857712">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857718">for</span>&nbsp;<span class="ident" id="1857722">x</span>&nbsp;<span class="op" id="1857724">&lt;</span>&nbsp;<span class="num" id="1857726">2</span>&nbsp;<span class="op" id="1857728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857732">if</span>&nbsp;<span class="ident" id="1857735">x</span>&nbsp;<span class="op" id="1857737">&lt;</span>&nbsp;<span class="num" id="1857739">1e-09</span>&nbsp;<span class="op" id="1857745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857750">goto</span>&nbsp;<span class="ident" id="1857755">small</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857767">z</span>&nbsp;<span class="op" id="1857769">=</span>&nbsp;<span class="ident" id="1857771">z</span>&nbsp;<span class="op" id="1857773">/</span>&nbsp;<span class="ident" id="1857775">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857779">x</span>&nbsp;<span class="op" id="1857781">=</span>&nbsp;<span class="ident" id="1857783">x</span>&nbsp;<span class="op" id="1857785">+</span>&nbsp;<span class="num" id="1857787">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857794">if</span>&nbsp;<span class="ident" id="1857797">x</span>&nbsp;<span class="op" id="1857799">==</span>&nbsp;<span class="num" id="1857802">2</span>&nbsp;<span class="op" id="1857804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1857808">return</span>&nbsp;<span class="ident" id="1857815">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1857818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857822">x</span>&nbsp;<span class="op" id="1857824">=</span>&nbsp;<span class="ident" id="1857826">x</span>&nbsp;<span class="op" id="1857828">-</span>&nbsp;<span class="num" id="1857830">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857833">p</span>&nbsp;<span class="op" id="1857835">=</span>&nbsp;<span class="op" id="1857837">(</span><span class="op" id="1857838">(</span><span class="op" id="1857839">(</span><span class="op" id="1857840">(</span><span class="op" id="1857841">(</span><span class="ident" id="1857842">x</span><span class="op" id="1857843">*</span><span class="ident" id="1857844">_gamP</span><span class="op" id="1857849">[</span><span class="num" id="1857850">0</span><span class="op" id="1857851">]</span><span class="op" id="1857852">+</span><span class="ident" id="1857853">_gamP</span><span class="op" id="1857858">[</span><span class="num" id="1857859">1</span><span class="op" id="1857860">]</span><span class="op" id="1857861">)</span><span class="op" id="1857862">*</span><span class="ident" id="1857863">x</span><span class="op" id="1857864">+</span><span class="ident" id="1857865">_gamP</span><span class="op" id="1857870">[</span><span class="num" id="1857871">2</span><span class="op" id="1857872">]</span><span class="op" id="1857873">)</span><span class="op" id="1857874">*</span><span class="ident" id="1857875">x</span><span class="op" id="1857876">+</span><span class="ident" id="1857877">_gamP</span><span class="op" id="1857882">[</span><span class="num" id="1857883">3</span><span class="op" id="1857884">]</span><span class="op" id="1857885">)</span><span class="op" id="1857886">*</span><span class="ident" id="1857887">x</span><span class="op" id="1857888">+</span><span class="ident" id="1857889">_gamP</span><span class="op" id="1857894">[</span><span class="num" id="1857895">4</span><span class="op" id="1857896">]</span><span class="op" id="1857897">)</span><span class="op" id="1857898">*</span><span class="ident" id="1857899">x</span><span class="op" id="1857900">+</span><span class="ident" id="1857901">_gamP</span><span class="op" id="1857906">[</span><span class="num" id="1857907">5</span><span class="op" id="1857908">]</span><span class="op" id="1857909">)</span><span class="op" id="1857910">*</span><span class="ident" id="1857911">x</span>&nbsp;<span class="op" id="1857913">+</span>&nbsp;<span class="ident" id="1857915">_gamP</span><span class="op" id="1857920">[</span><span class="num" id="1857921">6</span><span class="op" id="1857922">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1857925">q</span>&nbsp;<span class="op" id="1857927">=</span>&nbsp;<span class="op" id="1857929">(</span><span class="op" id="1857930">(</span><span class="op" id="1857931">(</span><span class="op" id="1857932">(</span><span class="op" id="1857933">(</span><span class="op" id="1857934">(</span><span class="ident" id="1857935">x</span><span class="op" id="1857936">*</span><span class="ident" id="1857937">_gamQ</span><span class="op" id="1857942">[</span><span class="num" id="1857943">0</span><span class="op" id="1857944">]</span><span class="op" id="1857945">+</span><span class="ident" id="1857946">_gamQ</span><span class="op" id="1857951">[</span><span class="num" id="1857952">1</span><span class="op" id="1857953">]</span><span class="op" id="1857954">)</span><span class="op" id="1857955">*</span><span class="ident" id="1857956">x</span><span class="op" id="1857957">+</span><span class="ident" id="1857958">_gamQ</span><span class="op" id="1857963">[</span><span class="num" id="1857964">2</span><span class="op" id="1857965">]</span><span class="op" id="1857966">)</span><span class="op" id="1857967">*</span><span class="ident" id="1857968">x</span><span class="op" id="1857969">+</span><span class="ident" id="1857970">_gamQ</span><span class="op" id="1857975">[</span><span class="num" id="1857976">3</span><span class="op" id="1857977">]</span><span class="op" id="1857978">)</span><span class="op" id="1857979">*</span><span class="ident" id="1857980">x</span><span class="op" id="1857981">+</span><span class="ident" id="1857982">_gamQ</span><span class="op" id="1857987">[</span><span class="num" id="1857988">4</span><span class="op" id="1857989">]</span><span class="op" id="1857990">)</span><span class="op" id="1857991">*</span><span class="ident" id="1857992">x</span><span class="op" id="1857993">+</span><span class="ident" id="1857994">_gamQ</span><span class="op" id="1857999">[</span><span class="num" id="1858000">5</span><span class="op" id="1858001">]</span><span class="op" id="1858002">)</span><span class="op" id="1858003">*</span><span class="ident" id="1858004">x</span><span class="op" id="1858005">+</span><span class="ident" id="1858006">_gamQ</span><span class="op" id="1858011">[</span><span class="num" id="1858012">6</span><span class="op" id="1858013">]</span><span class="op" id="1858014">)</span><span class="op" id="1858015">*</span><span class="ident" id="1858016">x</span>&nbsp;<span class="op" id="1858018">+</span>&nbsp;<span class="ident" id="1858020">_gamQ</span><span class="op" id="1858025">[</span><span class="num" id="1858026">7</span><span class="op" id="1858027">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1858030">return</span>&nbsp;<span class="ident" id="1858037">z</span>&nbsp;<span class="op" id="1858039">*</span>&nbsp;<span class="ident" id="1858041">p</span>&nbsp;<span class="op" id="1858043">/</span>&nbsp;<span class="ident" id="1858045">q</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="1858048">small</span><span class="op" id="1858053">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1858056">if</span>&nbsp;<span class="ident" id="1858059">x</span>&nbsp;<span class="op" id="1858061">==</span>&nbsp;<span class="num" id="1858064">0</span>&nbsp;<span class="op" id="1858066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1858070">return</span>&nbsp;<span class="ident" id="1858077">Inf</span><span class="op" id="1858080">(</span><span class="num" id="1858081">1</span><span class="op" id="1858082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1858085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1858088">return</span>&nbsp;<span class="ident" id="1858095">z</span>&nbsp;<span class="op" id="1858097">/</span>&nbsp;<span class="op" id="1858099">(</span><span class="op" id="1858100">(</span><span class="num" id="1858101">1</span>&nbsp;<span class="op" id="1858103">+</span>&nbsp;<span class="ident" id="1858105">Euler</span><span class="op" id="1858110">*</span><span class="ident" id="1858111">x</span><span class="op" id="1858112">)</span>&nbsp;<span class="op" id="1858114">*</span>&nbsp;<span class="ident" id="1858116">x</span><span class="op" id="1858117">)</span><br>
<span class="lineno"></span><span class="op" id="1858119">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="1858122">func</span>&nbsp;<span class="ident" id="1858127">isNegInt</span><span class="op" id="1858135">(</span><span class="ident" id="1858136">x</span>&nbsp;<span class="builtintype" id="1858138">float64</span><span class="op" id="1858145">)</span>&nbsp;<span class="builtintype" id="1858147">bool</span>&nbsp;<span class="op" id="1858152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1858155">if</span>&nbsp;<span class="ident" id="1858158">x</span>&nbsp;<span class="op" id="1858160">&lt;</span>&nbsp;<span class="num" id="1858162">0</span>&nbsp;<span class="op" id="1858164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1858168">_</span><span class="op" id="1858169">,</span>&nbsp;<span class="ident" id="1858171">xf</span>&nbsp;<span class="op" id="1858174">:=</span>&nbsp;<span class="ident" id="1858177">Modf</span><span class="op" id="1858181">(</span><span class="ident" id="1858182">x</span><span class="op" id="1858183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1858187">return</span>&nbsp;<span class="ident" id="1858194">xf</span>&nbsp;<span class="op" id="1858197">==</span>&nbsp;<span class="num" id="1858200">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1858203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1858206">return</span>&nbsp;<span class="builtintype" id="1858213">false</span><br>
<span class="lineno"></span><span class="op" id="1858219">}</span>
</div>
</body>
</html>
