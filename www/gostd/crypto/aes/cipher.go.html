<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3873830">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3873885">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3873939">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3873990">package</span>&nbsp;<span class="ident" id="3873998">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3874003">import</span>&nbsp;<span class="op" id="3874010">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3874013">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3874030">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3874040">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3874043">//&nbsp;The&nbsp;AES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3874075">const</span>&nbsp;<span class="ident" id="3874081">BlockSize</span>&nbsp;<span class="op" id="3874091">=</span>&nbsp;<span class="num" id="3874093">16</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3874097">//&nbsp;A&nbsp;cipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;AES&nbsp;encryption&nbsp;using&nbsp;a&nbsp;particular&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3874166">type</span>&nbsp;<span class="ident" id="3874171">aesCipher</span>&nbsp;<span class="keyword" id="3874181">struct</span>&nbsp;<span class="op" id="3874188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874191">enc</span>&nbsp;<span class="op" id="3874195">[</span><span class="op" id="3874196">]</span><span class="builtintype" id="3874197">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874205">dec</span>&nbsp;<span class="op" id="3874209">[</span><span class="op" id="3874210">]</span><span class="builtintype" id="3874211">uint32</span><br>
<span class="lineno"></span><span class="op" id="3874218">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3874221">type</span>&nbsp;<span class="ident" id="3874226">KeySizeError</span>&nbsp;<span class="builtintype" id="3874239">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3874244">func</span>&nbsp;<span class="op" id="3874249">(</span><span class="ident" id="3874250">k</span>&nbsp;<span class="ident" id="3874252">KeySizeError</span><span class="op" id="3874264">)</span>&nbsp;<span class="ident" id="3874266">Error</span><span class="op" id="3874271">(</span><span class="op" id="3874272">)</span>&nbsp;<span class="builtintype" id="3874274">string</span>&nbsp;<span class="op" id="3874281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874284">return</span>&nbsp;<span class="string" id="3874291">&#34;crypto/aes:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="3874323">+</span>&nbsp;<span class="ident" id="3874325">strconv</span><span class="op" id="3874332">.</span><span class="ident" id="3874333">Itoa</span><span class="op" id="3874337">(</span><span class="builtintype" id="3874338">int</span><span class="op" id="3874341">(</span><span class="ident" id="3874342">k</span><span class="op" id="3874343">)</span><span class="op" id="3874344">)</span><br>
<span class="lineno">25</span><span class="op" id="3874346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3874349">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="comment" id="3874402">//&nbsp;The&nbsp;key&nbsp;argument&nbsp;should&nbsp;be&nbsp;the&nbsp;AES&nbsp;key,</span><br>
<span class="lineno"></span><span class="comment" id="3874445">//&nbsp;either&nbsp;16,&nbsp;24,&nbsp;or&nbsp;32&nbsp;bytes&nbsp;to&nbsp;select</span><br>
<span class="lineno">30</span><span class="comment" id="3874485">//&nbsp;AES-128,&nbsp;AES-192,&nbsp;or&nbsp;AES-256.</span><br>
<span class="lineno"></span><span class="keyword" id="3874518">func</span>&nbsp;<span class="ident" id="3874523">NewCipher</span><span class="op" id="3874532">(</span><span class="ident" id="3874533">key</span>&nbsp;<span class="op" id="3874537">[</span><span class="op" id="3874538">]</span><span class="builtintype" id="3874539">byte</span><span class="op" id="3874543">)</span>&nbsp;<span class="op" id="3874545">(</span><span class="ident" id="3874546">cipher</span><span class="op" id="3874552">.</span><span class="ident" id="3874553">Block</span><span class="op" id="3874558">,</span>&nbsp;<span class="builtintype" id="3874560">error</span><span class="op" id="3874565">)</span>&nbsp;<span class="op" id="3874567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874570">k</span>&nbsp;<span class="op" id="3874572">:=</span>&nbsp;<span class="builtinfunc" id="3874575">len</span><span class="op" id="3874578">(</span><span class="ident" id="3874579">key</span><span class="op" id="3874582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874585">switch</span>&nbsp;<span class="ident" id="3874592">k</span>&nbsp;<span class="op" id="3874594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874597">default</span><span class="op" id="3874604">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874608">return</span>&nbsp;<span class="ident" id="3874615">nil</span><span class="op" id="3874618">,</span>&nbsp;<span class="ident" id="3874620">KeySizeError</span><span class="op" id="3874632">(</span><span class="ident" id="3874633">k</span><span class="op" id="3874634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874637">case</span>&nbsp;<span class="num" id="3874642">16</span><span class="op" id="3874644">,</span>&nbsp;<span class="num" id="3874646">24</span><span class="op" id="3874648">,</span>&nbsp;<span class="num" id="3874650">32</span><span class="op" id="3874652">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874656">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3874663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874667">n</span>&nbsp;<span class="op" id="3874669">:=</span>&nbsp;<span class="ident" id="3874672">k</span>&nbsp;<span class="op" id="3874674">+</span>&nbsp;<span class="num" id="3874676">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874680">c</span>&nbsp;<span class="op" id="3874682">:=</span>&nbsp;<span class="op" id="3874685">&amp;</span><span class="ident" id="3874686">aesCipher</span><span class="op" id="3874695">{</span><span class="builtinfunc" id="3874696">make</span><span class="op" id="3874700">(</span><span class="op" id="3874701">[</span><span class="op" id="3874702">]</span><span class="builtintype" id="3874703">uint32</span><span class="op" id="3874709">,</span>&nbsp;<span class="ident" id="3874711">n</span><span class="op" id="3874712">)</span><span class="op" id="3874713">,</span>&nbsp;<span class="builtinfunc" id="3874715">make</span><span class="op" id="3874719">(</span><span class="op" id="3874720">[</span><span class="op" id="3874721">]</span><span class="builtintype" id="3874722">uint32</span><span class="op" id="3874728">,</span>&nbsp;<span class="ident" id="3874730">n</span><span class="op" id="3874731">)</span><span class="op" id="3874732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874735">expandKey</span><span class="op" id="3874744">(</span><span class="ident" id="3874745">key</span><span class="op" id="3874748">,</span>&nbsp;<span class="ident" id="3874750">c</span><span class="op" id="3874751">.</span><span class="ident" id="3874752">enc</span><span class="op" id="3874755">,</span>&nbsp;<span class="ident" id="3874757">c</span><span class="op" id="3874758">.</span><span class="ident" id="3874759">dec</span><span class="op" id="3874762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874765">return</span>&nbsp;<span class="ident" id="3874772">c</span><span class="op" id="3874773">,</span>&nbsp;<span class="ident" id="3874775">nil</span><br>
<span class="lineno"></span><span class="op" id="3874779">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="3874782">func</span>&nbsp;<span class="op" id="3874787">(</span><span class="ident" id="3874788">c</span>&nbsp;<span class="op" id="3874790">*</span><span class="ident" id="3874791">aesCipher</span><span class="op" id="3874800">)</span>&nbsp;<span class="ident" id="3874802">BlockSize</span><span class="op" id="3874811">(</span><span class="op" id="3874812">)</span>&nbsp;<span class="builtintype" id="3874814">int</span>&nbsp;<span class="op" id="3874818">{</span>&nbsp;<span class="keyword" id="3874820">return</span>&nbsp;<span class="ident" id="3874827">BlockSize</span>&nbsp;<span class="op" id="3874837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3874840">func</span>&nbsp;<span class="op" id="3874845">(</span><span class="ident" id="3874846">c</span>&nbsp;<span class="op" id="3874848">*</span><span class="ident" id="3874849">aesCipher</span><span class="op" id="3874858">)</span>&nbsp;<span class="ident" id="3874860">Encrypt</span><span class="op" id="3874867">(</span><span class="ident" id="3874868">dst</span><span class="op" id="3874871">,</span>&nbsp;<span class="ident" id="3874873">src</span>&nbsp;<span class="op" id="3874877">[</span><span class="op" id="3874878">]</span><span class="builtintype" id="3874879">byte</span><span class="op" id="3874883">)</span>&nbsp;<span class="op" id="3874885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874888">if</span>&nbsp;<span class="builtinfunc" id="3874891">len</span><span class="op" id="3874894">(</span><span class="ident" id="3874895">src</span><span class="op" id="3874898">)</span>&nbsp;<span class="op" id="3874900">&lt;</span>&nbsp;<span class="ident" id="3874902">BlockSize</span>&nbsp;<span class="op" id="3874912">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3874916">panic</span><span class="op" id="3874921">(</span><span class="string" id="3874922">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3874956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3874959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874962">if</span>&nbsp;<span class="builtinfunc" id="3874965">len</span><span class="op" id="3874968">(</span><span class="ident" id="3874969">dst</span><span class="op" id="3874972">)</span>&nbsp;<span class="op" id="3874974">&lt;</span>&nbsp;<span class="ident" id="3874976">BlockSize</span>&nbsp;<span class="op" id="3874986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3874990">panic</span><span class="op" id="3874995">(</span><span class="string" id="3874996">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3875031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875034">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875037">encryptBlock</span><span class="op" id="3875049">(</span><span class="ident" id="3875050">c</span><span class="op" id="3875051">.</span><span class="ident" id="3875052">enc</span><span class="op" id="3875055">,</span>&nbsp;<span class="ident" id="3875057">dst</span><span class="op" id="3875060">,</span>&nbsp;<span class="ident" id="3875062">src</span><span class="op" id="3875065">)</span><br>
<span class="lineno"></span><span class="op" id="3875067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3875070">func</span>&nbsp;<span class="op" id="3875075">(</span><span class="ident" id="3875076">c</span>&nbsp;<span class="op" id="3875078">*</span><span class="ident" id="3875079">aesCipher</span><span class="op" id="3875088">)</span>&nbsp;<span class="ident" id="3875090">Decrypt</span><span class="op" id="3875097">(</span><span class="ident" id="3875098">dst</span><span class="op" id="3875101">,</span>&nbsp;<span class="ident" id="3875103">src</span>&nbsp;<span class="op" id="3875107">[</span><span class="op" id="3875108">]</span><span class="builtintype" id="3875109">byte</span><span class="op" id="3875113">)</span>&nbsp;<span class="op" id="3875115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875118">if</span>&nbsp;<span class="builtinfunc" id="3875121">len</span><span class="op" id="3875124">(</span><span class="ident" id="3875125">src</span><span class="op" id="3875128">)</span>&nbsp;<span class="op" id="3875130">&lt;</span>&nbsp;<span class="ident" id="3875132">BlockSize</span>&nbsp;<span class="op" id="3875142">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3875146">panic</span><span class="op" id="3875151">(</span><span class="string" id="3875152">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3875186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875192">if</span>&nbsp;<span class="builtinfunc" id="3875195">len</span><span class="op" id="3875198">(</span><span class="ident" id="3875199">dst</span><span class="op" id="3875202">)</span>&nbsp;<span class="op" id="3875204">&lt;</span>&nbsp;<span class="ident" id="3875206">BlockSize</span>&nbsp;<span class="op" id="3875216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3875220">panic</span><span class="op" id="3875225">(</span><span class="string" id="3875226">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3875261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875264">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875267">decryptBlock</span><span class="op" id="3875279">(</span><span class="ident" id="3875280">c</span><span class="op" id="3875281">.</span><span class="ident" id="3875282">dec</span><span class="op" id="3875285">,</span>&nbsp;<span class="ident" id="3875287">dst</span><span class="op" id="3875290">,</span>&nbsp;<span class="ident" id="3875292">src</span><span class="op" id="3875295">)</span><br>
<span class="lineno"></span><span class="op" id="3875297">}</span>
</div>
</body>
</html>
