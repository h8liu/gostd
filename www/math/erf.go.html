<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1433935">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1433990">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1434044">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1434095">package</span>&nbsp;<span class="ident" id="1434103">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1434109">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1434181">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1434235">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1434287">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1434342">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1434372">//</span><br>
<span class="lineno"></span><span class="comment" id="1434375">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1434431">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1434500">//</span><br>
<span class="lineno"></span><span class="comment" id="1434503">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1434562">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1434618">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1434675">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1434692">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1434748">//</span><br>
<span class="lineno">25</span><span class="comment" id="1434751">//</span><br>
<span class="lineno"></span><span class="comment" id="1434754">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1434778">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1434803">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="1434834">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="1434866">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="1434909">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="1434940">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1434971">//</span><br>
<span class="lineno"></span><span class="comment" id="1434974">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="1435001">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1435015">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="1435049">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="1435088">//</span><br>
<span class="lineno"></span><span class="comment" id="1435091">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="1435102">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="1435137">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="1435173">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="1435239">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="1435305">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="1435369">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="1435411">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="1435467">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1435517">//</span><br>
<span class="lineno"></span><span class="comment" id="1435520">//</span><br>
<span class="lineno">50</span><span class="comment" id="1435523">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="1435575">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="1435649">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1435669">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="1435736">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="1435803">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1435871">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1435941">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="1436002">//</span><br>
<span class="lineno"></span><span class="comment" id="1436005">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="1436064">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="1436121">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="1436176">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1436232">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1436288">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="1436340">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="1436407">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="1436453">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="1436502">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="1436567">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="1436630">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="1436690">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1436707">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="1436750">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="1436793">//</span><br>
<span class="lineno">75</span><span class="comment" id="1436796">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="1436842">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="1436897">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="1436935">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1436952">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="1437007">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="1437050">//</span><br>
<span class="lineno"></span><span class="comment" id="1437053">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="1437085">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1437149">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="1437220">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="1437281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="1437346">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="1437393">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1437410">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="1437465">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="1437508">//</span><br>
<span class="lineno"></span><span class="comment" id="1437511">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="1437526">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="1437588">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="1437633">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="1437675">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="1437714">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="1437777">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="1437792">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="1437850">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="1437886">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="1437946">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="1437983">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="1438039">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="1438102">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="1438157">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="1438203">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="1438249">//</span><br>
<span class="lineno"></span><span class="comment" id="1438252">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="1438281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="1438344">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1438407">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="1438449">//</span><br>
<span class="lineno"></span><span class="comment" id="1438452">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="1438477">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="1438537">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="1438597">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1438635">const</span>&nbsp;<span class="op" id="1438641">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1438644">erx</span>&nbsp;<span class="op" id="1438648">=</span>&nbsp;<span class="num" id="1438650">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="1438677">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1438700">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1438759">efx</span>&nbsp;&nbsp;<span class="op" id="1438764">=</span>&nbsp;<span class="num" id="1438766">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="1438794">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1438817">efx8</span>&nbsp;<span class="op" id="1438822">=</span>&nbsp;<span class="num" id="1438824">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="1438852">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1438875">pp0</span>&nbsp;&nbsp;<span class="op" id="1438880">=</span>&nbsp;<span class="num" id="1438882">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="1438910">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1438933">pp1</span>&nbsp;&nbsp;<span class="op" id="1438938">=</span>&nbsp;<span class="op" id="1438940">-</span><span class="num" id="1438941">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="1438968">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1438991">pp2</span>&nbsp;&nbsp;<span class="op" id="1438996">=</span>&nbsp;<span class="op" id="1438998">-</span><span class="num" id="1438999">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="1439026">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439049">pp3</span>&nbsp;&nbsp;<span class="op" id="1439054">=</span>&nbsp;<span class="op" id="1439056">-</span><span class="num" id="1439057">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="1439084">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439107">pp4</span>&nbsp;&nbsp;<span class="op" id="1439112">=</span>&nbsp;<span class="op" id="1439114">-</span><span class="num" id="1439115">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="1439142">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439165">qq1</span>&nbsp;&nbsp;<span class="op" id="1439170">=</span>&nbsp;<span class="num" id="1439172">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="1439200">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439223">qq2</span>&nbsp;&nbsp;<span class="op" id="1439228">=</span>&nbsp;<span class="num" id="1439230">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="1439258">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439281">qq3</span>&nbsp;&nbsp;<span class="op" id="1439286">=</span>&nbsp;<span class="num" id="1439288">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="1439316">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439339">qq4</span>&nbsp;&nbsp;<span class="op" id="1439344">=</span>&nbsp;<span class="num" id="1439346">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="1439374">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439397">qq5</span>&nbsp;&nbsp;<span class="op" id="1439402">=</span>&nbsp;<span class="op" id="1439404">-</span><span class="num" id="1439405">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="1439432">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1439455">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439518">pa0</span>&nbsp;<span class="op" id="1439522">=</span>&nbsp;<span class="op" id="1439524">-</span><span class="num" id="1439525">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="1439552">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439575">pa1</span>&nbsp;<span class="op" id="1439579">=</span>&nbsp;<span class="num" id="1439581">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="1439609">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439632">pa2</span>&nbsp;<span class="op" id="1439636">=</span>&nbsp;<span class="op" id="1439638">-</span><span class="num" id="1439639">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="1439666">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439689">pa3</span>&nbsp;<span class="op" id="1439693">=</span>&nbsp;<span class="num" id="1439695">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="1439723">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439746">pa4</span>&nbsp;<span class="op" id="1439750">=</span>&nbsp;<span class="op" id="1439752">-</span><span class="num" id="1439753">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="1439780">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439803">pa5</span>&nbsp;<span class="op" id="1439807">=</span>&nbsp;<span class="num" id="1439809">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="1439837">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439860">pa6</span>&nbsp;<span class="op" id="1439864">=</span>&nbsp;<span class="op" id="1439866">-</span><span class="num" id="1439867">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="1439894">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439917">qa1</span>&nbsp;<span class="op" id="1439921">=</span>&nbsp;<span class="num" id="1439923">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="1439951">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439974">qa2</span>&nbsp;<span class="op" id="1439978">=</span>&nbsp;<span class="num" id="1439980">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="1440008">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440031">qa3</span>&nbsp;<span class="op" id="1440035">=</span>&nbsp;<span class="num" id="1440037">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="1440065">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440088">qa4</span>&nbsp;<span class="op" id="1440092">=</span>&nbsp;<span class="num" id="1440094">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="1440122">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440145">qa5</span>&nbsp;<span class="op" id="1440149">=</span>&nbsp;<span class="num" id="1440151">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="1440179">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440202">qa6</span>&nbsp;<span class="op" id="1440206">=</span>&nbsp;<span class="num" id="1440208">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="1440236">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1440259">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440321">ra0</span>&nbsp;<span class="op" id="1440325">=</span>&nbsp;<span class="op" id="1440327">-</span><span class="num" id="1440328">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="1440355">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440378">ra1</span>&nbsp;<span class="op" id="1440382">=</span>&nbsp;<span class="op" id="1440384">-</span><span class="num" id="1440385">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="1440412">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440435">ra2</span>&nbsp;<span class="op" id="1440439">=</span>&nbsp;<span class="op" id="1440441">-</span><span class="num" id="1440442">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="1440469">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440492">ra3</span>&nbsp;<span class="op" id="1440496">=</span>&nbsp;<span class="op" id="1440498">-</span><span class="num" id="1440499">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="1440526">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440549">ra4</span>&nbsp;<span class="op" id="1440553">=</span>&nbsp;<span class="op" id="1440555">-</span><span class="num" id="1440556">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="1440583">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440606">ra5</span>&nbsp;<span class="op" id="1440610">=</span>&nbsp;<span class="op" id="1440612">-</span><span class="num" id="1440613">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="1440640">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440663">ra6</span>&nbsp;<span class="op" id="1440667">=</span>&nbsp;<span class="op" id="1440669">-</span><span class="num" id="1440670">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="1440697">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440720">ra7</span>&nbsp;<span class="op" id="1440724">=</span>&nbsp;<span class="op" id="1440726">-</span><span class="num" id="1440727">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="1440754">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440777">sa1</span>&nbsp;<span class="op" id="1440781">=</span>&nbsp;<span class="num" id="1440783">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="1440811">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440834">sa2</span>&nbsp;<span class="op" id="1440838">=</span>&nbsp;<span class="num" id="1440840">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="1440868">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440891">sa3</span>&nbsp;<span class="op" id="1440895">=</span>&nbsp;<span class="num" id="1440897">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="1440925">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440948">sa4</span>&nbsp;<span class="op" id="1440952">=</span>&nbsp;<span class="num" id="1440954">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="1440982">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441005">sa5</span>&nbsp;<span class="op" id="1441009">=</span>&nbsp;<span class="num" id="1441011">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="1441039">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441062">sa6</span>&nbsp;<span class="op" id="1441066">=</span>&nbsp;<span class="num" id="1441068">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="1441096">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441119">sa7</span>&nbsp;<span class="op" id="1441123">=</span>&nbsp;<span class="num" id="1441125">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="1441153">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441176">sa8</span>&nbsp;<span class="op" id="1441180">=</span>&nbsp;<span class="op" id="1441182">-</span><span class="num" id="1441183">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="1441210">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1441233">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441292">rb0</span>&nbsp;<span class="op" id="1441296">=</span>&nbsp;<span class="op" id="1441298">-</span><span class="num" id="1441299">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="1441326">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441349">rb1</span>&nbsp;<span class="op" id="1441353">=</span>&nbsp;<span class="op" id="1441355">-</span><span class="num" id="1441356">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="1441383">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441406">rb2</span>&nbsp;<span class="op" id="1441410">=</span>&nbsp;<span class="op" id="1441412">-</span><span class="num" id="1441413">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="1441440">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441463">rb3</span>&nbsp;<span class="op" id="1441467">=</span>&nbsp;<span class="op" id="1441469">-</span><span class="num" id="1441470">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="1441497">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441520">rb4</span>&nbsp;<span class="op" id="1441524">=</span>&nbsp;<span class="op" id="1441526">-</span><span class="num" id="1441527">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="1441554">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441577">rb5</span>&nbsp;<span class="op" id="1441581">=</span>&nbsp;<span class="op" id="1441583">-</span><span class="num" id="1441584">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="1441611">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441634">rb6</span>&nbsp;<span class="op" id="1441638">=</span>&nbsp;<span class="op" id="1441640">-</span><span class="num" id="1441641">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="1441668">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441691">sb1</span>&nbsp;<span class="op" id="1441695">=</span>&nbsp;<span class="num" id="1441697">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="1441725">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441748">sb2</span>&nbsp;<span class="op" id="1441752">=</span>&nbsp;<span class="num" id="1441754">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="1441782">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441805">sb3</span>&nbsp;<span class="op" id="1441809">=</span>&nbsp;<span class="num" id="1441811">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="1441839">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441862">sb4</span>&nbsp;<span class="op" id="1441866">=</span>&nbsp;<span class="num" id="1441868">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="1441896">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441919">sb5</span>&nbsp;<span class="op" id="1441923">=</span>&nbsp;<span class="num" id="1441925">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="1441953">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441976">sb6</span>&nbsp;<span class="op" id="1441980">=</span>&nbsp;<span class="num" id="1441982">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="1442010">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442033">sb7</span>&nbsp;<span class="op" id="1442037">=</span>&nbsp;<span class="op" id="1442039">-</span><span class="num" id="1442040">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="1442067">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="1442089">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1442092">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1442132">//</span><br>
<span class="lineno"></span><span class="comment" id="1442135">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="1442157">//&nbsp;&nbsp;&nbsp;&nbspErf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="1442174">//&nbsp;&nbsp;&nbsp;&nbspErf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="1442192">//&nbsp;&nbsp;&nbsp;&nbspErf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1442210">func</span>&nbsp;<span class="ident" id="1442215">Erf</span><span class="op" id="1442218">(</span><span class="ident" id="1442219">x</span>&nbsp;<span class="builtintype" id="1442221">float64</span><span class="op" id="1442228">)</span>&nbsp;<span class="builtintype" id="1442230">float64</span>&nbsp;<span class="op" id="1442238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442241">const</span>&nbsp;<span class="op" id="1442247">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442251">VeryTiny</span>&nbsp;<span class="op" id="1442260">=</span>&nbsp;<span class="num" id="1442262">2.848094538889218e-306</span>&nbsp;<span class="comment" id="1442285">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442309">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1442318">=</span>&nbsp;<span class="num" id="1442320">1.0</span>&nbsp;<span class="op" id="1442324">/</span>&nbsp;<span class="op" id="1442326">(</span><span class="num" id="1442327">1</span>&nbsp;<span class="op" id="1442329">&lt;&lt;</span>&nbsp;<span class="num" id="1442332">28</span><span class="op" id="1442334">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1442343">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1442357">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442375">switch</span>&nbsp;<span class="op" id="1442382">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442385">case</span>&nbsp;<span class="ident" id="1442390"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1442395">(</span><span class="ident" id="1442396"><a href="/math/erf.go.html#1442219">x</a></span><span class="op" id="1442397">)</span><span class="op" id="1442398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442402">return</span>&nbsp;<span class="ident" id="1442409"><a href="/math/bits.go.html#1427274">NaN</a></span><span class="op" id="1442412">(</span><span class="op" id="1442413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442416">case</span>&nbsp;<span class="ident" id="1442421"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1442426">(</span><span class="ident" id="1442427"><a href="/math/erf.go.html#1442219">x</a></span><span class="op" id="1442428">,</span>&nbsp;<span class="num" id="1442430">1</span><span class="op" id="1442431">)</span><span class="op" id="1442432">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442436">return</span>&nbsp;<span class="num" id="1442443">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442446">case</span>&nbsp;<span class="ident" id="1442451"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1442456">(</span><span class="ident" id="1442457"><a href="/math/erf.go.html#1442219">x</a></span><span class="op" id="1442458">,</span>&nbsp;<span class="op" id="1442460">-</span><span class="num" id="1442461">1</span><span class="op" id="1442462">)</span><span class="op" id="1442463">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442467">return</span>&nbsp;<span class="op" id="1442474">-</span><span class="num" id="1442475">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442481">sign</span>&nbsp;<span class="op" id="1442486">:=</span>&nbsp;<span class="ident" id="1442489">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442496">if</span>&nbsp;<span class="ident" id="1442499"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1442501">&lt;</span>&nbsp;<span class="num" id="1442503">0</span>&nbsp;<span class="op" id="1442505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442509"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1442511">=</span>&nbsp;<span class="op" id="1442513">-</span><span class="ident" id="1442514"><a href="/math/erf.go.html#1442219">x</a></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442518"><a href="/math/erf.go.html#1442481">sign</a></span>&nbsp;<span class="op" id="1442523">=</span>&nbsp;<span class="ident" id="1442525">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442534">if</span>&nbsp;<span class="ident" id="1442537"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1442539">&lt;</span>&nbsp;<span class="num" id="1442541">0.84375</span>&nbsp;<span class="op" id="1442549">{</span>&nbsp;<span class="comment" id="1442551">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442570">var</span>&nbsp;<span class="ident" id="1442574">temp</span>&nbsp;<span class="builtintype" id="1442579">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442589">if</span>&nbsp;<span class="ident" id="1442592"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1442594">&lt;</span>&nbsp;<span class="ident" id="1442596"><a href="/math/erf.go.html#1442309">Small</a></span>&nbsp;<span class="op" id="1442602">{</span>&nbsp;<span class="comment" id="1442604">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442623">if</span>&nbsp;<span class="ident" id="1442626"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1442628">&lt;</span>&nbsp;<span class="ident" id="1442630"><a href="/math/erf.go.html#1442251">VeryTiny</a></span>&nbsp;<span class="op" id="1442639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442645"><a href="/math/erf.go.html#1442574">temp</a></span>&nbsp;<span class="op" id="1442650">=</span>&nbsp;<span class="num" id="1442652">0.125</span>&nbsp;<span class="op" id="1442658">*</span>&nbsp;<span class="op" id="1442660">(</span><span class="num" id="1442661">8.0</span><span class="op" id="1442664">*</span><span class="ident" id="1442665"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1442667">+</span>&nbsp;<span class="ident" id="1442669"><a href="/math/erf.go.html#1438817">efx8</a></span><span class="op" id="1442673">*</span><span class="ident" id="1442674"><a href="/math/erf.go.html#1442219">x</a></span><span class="op" id="1442675">)</span>&nbsp;<span class="comment" id="1442677">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442699">}</span>&nbsp;<span class="keyword" id="1442701">else</span>&nbsp;<span class="op" id="1442706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442712"><a href="/math/erf.go.html#1442574">temp</a></span>&nbsp;<span class="op" id="1442717">=</span>&nbsp;<span class="ident" id="1442719"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1442721">+</span>&nbsp;<span class="ident" id="1442723"><a href="/math/erf.go.html#1438759">efx</a></span><span class="op" id="1442726">*</span><span class="ident" id="1442727"><a href="/math/erf.go.html#1442219">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442732">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442736">}</span>&nbsp;<span class="keyword" id="1442738">else</span>&nbsp;<span class="op" id="1442743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442748">z</span>&nbsp;<span class="op" id="1442750">:=</span>&nbsp;<span class="ident" id="1442753"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1442755">*</span>&nbsp;<span class="ident" id="1442757"><a href="/math/erf.go.html#1442219">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442762">r</span>&nbsp;<span class="op" id="1442764">:=</span>&nbsp;<span class="ident" id="1442767"><a href="/math/erf.go.html#1438875">pp0</a></span>&nbsp;<span class="op" id="1442771">+</span>&nbsp;<span class="ident" id="1442773"><a href="/math/erf.go.html#1442748">z</a></span><span class="op" id="1442774">*</span><span class="op" id="1442775">(</span><span class="ident" id="1442776"><a href="/math/erf.go.html#1438933">pp1</a></span><span class="op" id="1442779">+</span><span class="ident" id="1442780"><a href="/math/erf.go.html#1442748">z</a></span><span class="op" id="1442781">*</span><span class="op" id="1442782">(</span><span class="ident" id="1442783"><a href="/math/erf.go.html#1438991">pp2</a></span><span class="op" id="1442786">+</span><span class="ident" id="1442787"><a href="/math/erf.go.html#1442748">z</a></span><span class="op" id="1442788">*</span><span class="op" id="1442789">(</span><span class="ident" id="1442790"><a href="/math/erf.go.html#1439049">pp3</a></span><span class="op" id="1442793">+</span><span class="ident" id="1442794"><a href="/math/erf.go.html#1442748">z</a></span><span class="op" id="1442795">*</span><span class="ident" id="1442796"><a href="/math/erf.go.html#1439107">pp4</a></span><span class="op" id="1442799">)</span><span class="op" id="1442800">)</span><span class="op" id="1442801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442806">s</span>&nbsp;<span class="op" id="1442808">:=</span>&nbsp;<span class="num" id="1442811">1</span>&nbsp;<span class="op" id="1442813">+</span>&nbsp;<span class="ident" id="1442815"><a href="/math/erf.go.html#1442748">z</a></span><span class="op" id="1442816">*</span><span class="op" id="1442817">(</span><span class="ident" id="1442818"><a href="/math/erf.go.html#1439165">qq1</a></span><span class="op" id="1442821">+</span><span class="ident" id="1442822"><a href="/math/erf.go.html#1442748">z</a></span><span class="op" id="1442823">*</span><span class="op" id="1442824">(</span><span class="ident" id="1442825"><a href="/math/erf.go.html#1439223">qq2</a></span><span class="op" id="1442828">+</span><span class="ident" id="1442829"><a href="/math/erf.go.html#1442748">z</a></span><span class="op" id="1442830">*</span><span class="op" id="1442831">(</span><span class="ident" id="1442832"><a href="/math/erf.go.html#1439281">qq3</a></span><span class="op" id="1442835">+</span><span class="ident" id="1442836"><a href="/math/erf.go.html#1442748">z</a></span><span class="op" id="1442837">*</span><span class="op" id="1442838">(</span><span class="ident" id="1442839"><a href="/math/erf.go.html#1439339">qq4</a></span><span class="op" id="1442842">+</span><span class="ident" id="1442843"><a href="/math/erf.go.html#1442748">z</a></span><span class="op" id="1442844">*</span><span class="ident" id="1442845"><a href="/math/erf.go.html#1439397">qq5</a></span><span class="op" id="1442848">)</span><span class="op" id="1442849">)</span><span class="op" id="1442850">)</span><span class="op" id="1442851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442856">y</span>&nbsp;<span class="op" id="1442858">:=</span>&nbsp;<span class="ident" id="1442861"><a href="/math/erf.go.html#1442762">r</a></span>&nbsp;<span class="op" id="1442863">/</span>&nbsp;<span class="ident" id="1442865"><a href="/math/erf.go.html#1442806">s</a></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442870"><a href="/math/erf.go.html#1442574">temp</a></span>&nbsp;<span class="op" id="1442875">=</span>&nbsp;<span class="ident" id="1442877"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1442879">+</span>&nbsp;<span class="ident" id="1442881"><a href="/math/erf.go.html#1442219">x</a></span><span class="op" id="1442882">*</span><span class="ident" id="1442883"><a href="/math/erf.go.html#1442856">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442891">if</span>&nbsp;<span class="ident" id="1442894"><a href="/math/erf.go.html#1442481">sign</a></span>&nbsp;<span class="op" id="1442899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442904">return</span>&nbsp;<span class="op" id="1442911">-</span><span class="ident" id="1442912"><a href="/math/erf.go.html#1442574">temp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442919">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442923">return</span>&nbsp;<span class="ident" id="1442930"><a href="/math/erf.go.html#1442574">temp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442939">if</span>&nbsp;<span class="ident" id="1442942"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1442944">&lt;</span>&nbsp;<span class="num" id="1442946">1.25</span>&nbsp;<span class="op" id="1442951">{</span>&nbsp;<span class="comment" id="1442953">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442980">s</span>&nbsp;<span class="op" id="1442982">:=</span>&nbsp;<span class="ident" id="1442985"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1442987">-</span>&nbsp;<span class="num" id="1442989">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442993">P</span>&nbsp;<span class="op" id="1442995">:=</span>&nbsp;<span class="ident" id="1442998"><a href="/math/erf.go.html#1439518">pa0</a></span>&nbsp;<span class="op" id="1443002">+</span>&nbsp;<span class="ident" id="1443004"><a href="/math/erf.go.html#1442980">s</a></span><span class="op" id="1443005">*</span><span class="op" id="1443006">(</span><span class="ident" id="1443007"><a href="/math/erf.go.html#1439575">pa1</a></span><span class="op" id="1443010">+</span><span class="ident" id="1443011"><a href="/math/erf.go.html#1442980">s</a></span><span class="op" id="1443012">*</span><span class="op" id="1443013">(</span><span class="ident" id="1443014"><a href="/math/erf.go.html#1439632">pa2</a></span><span class="op" id="1443017">+</span><span class="ident" id="1443018"><a href="/math/erf.go.html#1442980">s</a></span><span class="op" id="1443019">*</span><span class="op" id="1443020">(</span><span class="ident" id="1443021"><a href="/math/erf.go.html#1439689">pa3</a></span><span class="op" id="1443024">+</span><span class="ident" id="1443025"><a href="/math/erf.go.html#1442980">s</a></span><span class="op" id="1443026">*</span><span class="op" id="1443027">(</span><span class="ident" id="1443028"><a href="/math/erf.go.html#1439746">pa4</a></span><span class="op" id="1443031">+</span><span class="ident" id="1443032"><a href="/math/erf.go.html#1442980">s</a></span><span class="op" id="1443033">*</span><span class="op" id="1443034">(</span><span class="ident" id="1443035"><a href="/math/erf.go.html#1439803">pa5</a></span><span class="op" id="1443038">+</span><span class="ident" id="1443039"><a href="/math/erf.go.html#1442980">s</a></span><span class="op" id="1443040">*</span><span class="ident" id="1443041"><a href="/math/erf.go.html#1439860">pa6</a></span><span class="op" id="1443044">)</span><span class="op" id="1443045">)</span><span class="op" id="1443046">)</span><span class="op" id="1443047">)</span><span class="op" id="1443048">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1443052">Q</span>&nbsp;<span class="op" id="1443054">:=</span>&nbsp;<span class="num" id="1443057">1</span>&nbsp;<span class="op" id="1443059">+</span>&nbsp;<span class="ident" id="1443061"><a href="/math/erf.go.html#1442980">s</a></span><span class="op" id="1443062">*</span><span class="op" id="1443063">(</span><span class="ident" id="1443064"><a href="/math/erf.go.html#1439917">qa1</a></span><span class="op" id="1443067">+</span><span class="ident" id="1443068"><a href="/math/erf.go.html#1442980">s</a></span><span class="op" id="1443069">*</span><span class="op" id="1443070">(</span><span class="ident" id="1443071"><a href="/math/erf.go.html#1439974">qa2</a></span><span class="op" id="1443074">+</span><span class="ident" id="1443075"><a href="/math/erf.go.html#1442980">s</a></span><span class="op" id="1443076">*</span><span class="op" id="1443077">(</span><span class="ident" id="1443078"><a href="/math/erf.go.html#1440031">qa3</a></span><span class="op" id="1443081">+</span><span class="ident" id="1443082"><a href="/math/erf.go.html#1442980">s</a></span><span class="op" id="1443083">*</span><span class="op" id="1443084">(</span><span class="ident" id="1443085"><a href="/math/erf.go.html#1440088">qa4</a></span><span class="op" id="1443088">+</span><span class="ident" id="1443089"><a href="/math/erf.go.html#1442980">s</a></span><span class="op" id="1443090">*</span><span class="op" id="1443091">(</span><span class="ident" id="1443092"><a href="/math/erf.go.html#1440145">qa5</a></span><span class="op" id="1443095">+</span><span class="ident" id="1443096"><a href="/math/erf.go.html#1442980">s</a></span><span class="op" id="1443097">*</span><span class="ident" id="1443098"><a href="/math/erf.go.html#1440202">qa6</a></span><span class="op" id="1443101">)</span><span class="op" id="1443102">)</span><span class="op" id="1443103">)</span><span class="op" id="1443104">)</span><span class="op" id="1443105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443109">if</span>&nbsp;<span class="ident" id="1443112"><a href="/math/erf.go.html#1442481">sign</a></span>&nbsp;<span class="op" id="1443117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443122">return</span>&nbsp;<span class="op" id="1443129">-</span><span class="ident" id="1443130"><a href="/math/erf.go.html#1438644">erx</a></span>&nbsp;<span class="op" id="1443134">-</span>&nbsp;<span class="ident" id="1443136"><a href="/math/erf.go.html#1442993">P</a></span><span class="op" id="1443137">/</span><span class="ident" id="1443138"><a href="/math/erf.go.html#1443052">Q</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1443142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443146">return</span>&nbsp;<span class="ident" id="1443153"><a href="/math/erf.go.html#1438644">erx</a></span>&nbsp;<span class="op" id="1443157">+</span>&nbsp;<span class="ident" id="1443159"><a href="/math/erf.go.html#1442993">P</a></span><span class="op" id="1443160">/</span><span class="ident" id="1443161"><a href="/math/erf.go.html#1443052">Q</a></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1443164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443167">if</span>&nbsp;<span class="ident" id="1443170"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1443172">&gt;=</span>&nbsp;<span class="num" id="1443175">6</span>&nbsp;<span class="op" id="1443177">{</span>&nbsp;<span class="comment" id="1443179">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443199">if</span>&nbsp;<span class="ident" id="1443202"><a href="/math/erf.go.html#1442481">sign</a></span>&nbsp;<span class="op" id="1443207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443212">return</span>&nbsp;<span class="op" id="1443219">-</span><span class="num" id="1443220">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1443224">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443228">return</span>&nbsp;<span class="num" id="1443235">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1443238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1443241">s</span>&nbsp;<span class="op" id="1443243">:=</span>&nbsp;<span class="num" id="1443246">1</span>&nbsp;<span class="op" id="1443248">/</span>&nbsp;<span class="op" id="1443250">(</span><span class="ident" id="1443251"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1443253">*</span>&nbsp;<span class="ident" id="1443255"><a href="/math/erf.go.html#1442219">x</a></span><span class="op" id="1443256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443259">var</span>&nbsp;<span class="ident" id="1443263">R</span><span class="op" id="1443264">,</span>&nbsp;<span class="ident" id="1443266">S</span>&nbsp;<span class="builtintype" id="1443268">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443277">if</span>&nbsp;<span class="ident" id="1443280"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1443282">&lt;</span>&nbsp;<span class="num" id="1443284">1</span><span class="op" id="1443285">/</span><span class="num" id="1443286">0.35</span>&nbsp;<span class="op" id="1443291">{</span>&nbsp;<span class="comment" id="1443293">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1443325"><a href="/math/erf.go.html#1443263">R</a></span>&nbsp;<span class="op" id="1443327">=</span>&nbsp;<span class="ident" id="1443329"><a href="/math/erf.go.html#1440321">ra0</a></span>&nbsp;<span class="op" id="1443333">+</span>&nbsp;<span class="ident" id="1443335"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443336">*</span><span class="op" id="1443337">(</span><span class="ident" id="1443338"><a href="/math/erf.go.html#1440378">ra1</a></span><span class="op" id="1443341">+</span><span class="ident" id="1443342"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443343">*</span><span class="op" id="1443344">(</span><span class="ident" id="1443345"><a href="/math/erf.go.html#1440435">ra2</a></span><span class="op" id="1443348">+</span><span class="ident" id="1443349"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443350">*</span><span class="op" id="1443351">(</span><span class="ident" id="1443352"><a href="/math/erf.go.html#1440492">ra3</a></span><span class="op" id="1443355">+</span><span class="ident" id="1443356"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443357">*</span><span class="op" id="1443358">(</span><span class="ident" id="1443359"><a href="/math/erf.go.html#1440549">ra4</a></span><span class="op" id="1443362">+</span><span class="ident" id="1443363"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443364">*</span><span class="op" id="1443365">(</span><span class="ident" id="1443366"><a href="/math/erf.go.html#1440606">ra5</a></span><span class="op" id="1443369">+</span><span class="ident" id="1443370"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443371">*</span><span class="op" id="1443372">(</span><span class="ident" id="1443373"><a href="/math/erf.go.html#1440663">ra6</a></span><span class="op" id="1443376">+</span><span class="ident" id="1443377"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443378">*</span><span class="ident" id="1443379"><a href="/math/erf.go.html#1440720">ra7</a></span><span class="op" id="1443382">)</span><span class="op" id="1443383">)</span><span class="op" id="1443384">)</span><span class="op" id="1443385">)</span><span class="op" id="1443386">)</span><span class="op" id="1443387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1443391"><a href="/math/erf.go.html#1443266">S</a></span>&nbsp;<span class="op" id="1443393">=</span>&nbsp;<span class="num" id="1443395">1</span>&nbsp;<span class="op" id="1443397">+</span>&nbsp;<span class="ident" id="1443399"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443400">*</span><span class="op" id="1443401">(</span><span class="ident" id="1443402"><a href="/math/erf.go.html#1440777">sa1</a></span><span class="op" id="1443405">+</span><span class="ident" id="1443406"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443407">*</span><span class="op" id="1443408">(</span><span class="ident" id="1443409"><a href="/math/erf.go.html#1440834">sa2</a></span><span class="op" id="1443412">+</span><span class="ident" id="1443413"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443414">*</span><span class="op" id="1443415">(</span><span class="ident" id="1443416"><a href="/math/erf.go.html#1440891">sa3</a></span><span class="op" id="1443419">+</span><span class="ident" id="1443420"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443421">*</span><span class="op" id="1443422">(</span><span class="ident" id="1443423"><a href="/math/erf.go.html#1440948">sa4</a></span><span class="op" id="1443426">+</span><span class="ident" id="1443427"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443428">*</span><span class="op" id="1443429">(</span><span class="ident" id="1443430"><a href="/math/erf.go.html#1441005">sa5</a></span><span class="op" id="1443433">+</span><span class="ident" id="1443434"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443435">*</span><span class="op" id="1443436">(</span><span class="ident" id="1443437"><a href="/math/erf.go.html#1441062">sa6</a></span><span class="op" id="1443440">+</span><span class="ident" id="1443441"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443442">*</span><span class="op" id="1443443">(</span><span class="ident" id="1443444"><a href="/math/erf.go.html#1441119">sa7</a></span><span class="op" id="1443447">+</span><span class="ident" id="1443448"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443449">*</span><span class="ident" id="1443450"><a href="/math/erf.go.html#1441176">sa8</a></span><span class="op" id="1443453">)</span><span class="op" id="1443454">)</span><span class="op" id="1443455">)</span><span class="op" id="1443456">)</span><span class="op" id="1443457">)</span><span class="op" id="1443458">)</span><span class="op" id="1443459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1443462">}</span>&nbsp;<span class="keyword" id="1443464">else</span>&nbsp;<span class="op" id="1443469">{</span>&nbsp;<span class="comment" id="1443471">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1443504"><a href="/math/erf.go.html#1443263">R</a></span>&nbsp;<span class="op" id="1443506">=</span>&nbsp;<span class="ident" id="1443508"><a href="/math/erf.go.html#1441292">rb0</a></span>&nbsp;<span class="op" id="1443512">+</span>&nbsp;<span class="ident" id="1443514"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443515">*</span><span class="op" id="1443516">(</span><span class="ident" id="1443517"><a href="/math/erf.go.html#1441349">rb1</a></span><span class="op" id="1443520">+</span><span class="ident" id="1443521"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443522">*</span><span class="op" id="1443523">(</span><span class="ident" id="1443524"><a href="/math/erf.go.html#1441406">rb2</a></span><span class="op" id="1443527">+</span><span class="ident" id="1443528"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443529">*</span><span class="op" id="1443530">(</span><span class="ident" id="1443531"><a href="/math/erf.go.html#1441463">rb3</a></span><span class="op" id="1443534">+</span><span class="ident" id="1443535"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443536">*</span><span class="op" id="1443537">(</span><span class="ident" id="1443538"><a href="/math/erf.go.html#1441520">rb4</a></span><span class="op" id="1443541">+</span><span class="ident" id="1443542"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443543">*</span><span class="op" id="1443544">(</span><span class="ident" id="1443545"><a href="/math/erf.go.html#1441577">rb5</a></span><span class="op" id="1443548">+</span><span class="ident" id="1443549"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443550">*</span><span class="ident" id="1443551"><a href="/math/erf.go.html#1441634">rb6</a></span><span class="op" id="1443554">)</span><span class="op" id="1443555">)</span><span class="op" id="1443556">)</span><span class="op" id="1443557">)</span><span class="op" id="1443558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1443562"><a href="/math/erf.go.html#1443266">S</a></span>&nbsp;<span class="op" id="1443564">=</span>&nbsp;<span class="num" id="1443566">1</span>&nbsp;<span class="op" id="1443568">+</span>&nbsp;<span class="ident" id="1443570"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443571">*</span><span class="op" id="1443572">(</span><span class="ident" id="1443573"><a href="/math/erf.go.html#1441691">sb1</a></span><span class="op" id="1443576">+</span><span class="ident" id="1443577"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443578">*</span><span class="op" id="1443579">(</span><span class="ident" id="1443580"><a href="/math/erf.go.html#1441748">sb2</a></span><span class="op" id="1443583">+</span><span class="ident" id="1443584"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443585">*</span><span class="op" id="1443586">(</span><span class="ident" id="1443587"><a href="/math/erf.go.html#1441805">sb3</a></span><span class="op" id="1443590">+</span><span class="ident" id="1443591"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443592">*</span><span class="op" id="1443593">(</span><span class="ident" id="1443594"><a href="/math/erf.go.html#1441862">sb4</a></span><span class="op" id="1443597">+</span><span class="ident" id="1443598"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443599">*</span><span class="op" id="1443600">(</span><span class="ident" id="1443601"><a href="/math/erf.go.html#1441919">sb5</a></span><span class="op" id="1443604">+</span><span class="ident" id="1443605"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443606">*</span><span class="op" id="1443607">(</span><span class="ident" id="1443608"><a href="/math/erf.go.html#1441976">sb6</a></span><span class="op" id="1443611">+</span><span class="ident" id="1443612"><a href="/math/erf.go.html#1443241">s</a></span><span class="op" id="1443613">*</span><span class="ident" id="1443614"><a href="/math/erf.go.html#1442033">sb7</a></span><span class="op" id="1443617">)</span><span class="op" id="1443618">)</span><span class="op" id="1443619">)</span><span class="op" id="1443620">)</span><span class="op" id="1443621">)</span><span class="op" id="1443622">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1443625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1443628">z</span>&nbsp;<span class="op" id="1443630">:=</span>&nbsp;<span class="ident" id="1443633"><a href="/math/unsafe.go.html#1556218">Float64frombits</a></span><span class="op" id="1443648">(</span><span class="ident" id="1443649"><a href="/math/unsafe.go.html#1556032">Float64bits</a></span><span class="op" id="1443660">(</span><span class="ident" id="1443661"><a href="/math/erf.go.html#1442219">x</a></span><span class="op" id="1443662">)</span>&nbsp;<span class="op" id="1443664">&amp;</span>&nbsp;<span class="num" id="1443666">0xffffffff00000000</span><span class="op" id="1443684">)</span>&nbsp;<span class="comment" id="1443686">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1443725">r</span>&nbsp;<span class="op" id="1443727">:=</span>&nbsp;<span class="ident" id="1443730"><a href="/math/exp.go.html#1445907">Exp</a></span><span class="op" id="1443733">(</span><span class="op" id="1443734">-</span><span class="ident" id="1443735"><a href="/math/erf.go.html#1443628">z</a></span><span class="op" id="1443736">*</span><span class="ident" id="1443737"><a href="/math/erf.go.html#1443628">z</a></span><span class="op" id="1443738">-</span><span class="num" id="1443739">0.5625</span><span class="op" id="1443745">)</span>&nbsp;<span class="op" id="1443747">*</span>&nbsp;<span class="ident" id="1443749"><a href="/math/exp.go.html#1445907">Exp</a></span><span class="op" id="1443752">(</span><span class="op" id="1443753">(</span><span class="ident" id="1443754"><a href="/math/erf.go.html#1443628">z</a></span><span class="op" id="1443755">-</span><span class="ident" id="1443756"><a href="/math/erf.go.html#1442219">x</a></span><span class="op" id="1443757">)</span><span class="op" id="1443758">*</span><span class="op" id="1443759">(</span><span class="ident" id="1443760"><a href="/math/erf.go.html#1443628">z</a></span><span class="op" id="1443761">+</span><span class="ident" id="1443762"><a href="/math/erf.go.html#1442219">x</a></span><span class="op" id="1443763">)</span><span class="op" id="1443764">+</span><span class="ident" id="1443765"><a href="/math/erf.go.html#1443263">R</a></span><span class="op" id="1443766">/</span><span class="ident" id="1443767"><a href="/math/erf.go.html#1443266">S</a></span><span class="op" id="1443768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443771">if</span>&nbsp;<span class="ident" id="1443774"><a href="/math/erf.go.html#1442481">sign</a></span>&nbsp;<span class="op" id="1443779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443783">return</span>&nbsp;<span class="ident" id="1443790"><a href="/math/erf.go.html#1443725">r</a></span><span class="op" id="1443791">/</span><span class="ident" id="1443792"><a href="/math/erf.go.html#1442219">x</a></span>&nbsp;<span class="op" id="1443794">-</span>&nbsp;<span class="num" id="1443796">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1443799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443802">return</span>&nbsp;<span class="num" id="1443809">1</span>&nbsp;<span class="op" id="1443811">-</span>&nbsp;<span class="ident" id="1443813"><a href="/math/erf.go.html#1443725">r</a></span><span class="op" id="1443814">/</span><span class="ident" id="1443815"><a href="/math/erf.go.html#1442219">x</a></span><br>
<span class="lineno"></span><span class="op" id="1443817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1443820">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="1443875">//</span><br>
<span class="lineno"></span><span class="comment" id="1443878">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1443900">//&nbsp;&nbsp;&nbsp;&nbspErfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1443918">//&nbsp;&nbsp;&nbsp;&nbspErfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1443936">//&nbsp;&nbsp;&nbsp;&nbspErfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="1443955">func</span>&nbsp;<span class="ident" id="1443960">Erfc</span><span class="op" id="1443964">(</span><span class="ident" id="1443965">x</span>&nbsp;<span class="builtintype" id="1443967">float64</span><span class="op" id="1443974">)</span>&nbsp;<span class="builtintype" id="1443976">float64</span>&nbsp;<span class="op" id="1443984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443987">const</span>&nbsp;<span class="ident" id="1443993">Tiny</span>&nbsp;<span class="op" id="1443998">=</span>&nbsp;<span class="num" id="1444000">1.0</span>&nbsp;<span class="op" id="1444004">/</span>&nbsp;<span class="op" id="1444006">(</span><span class="num" id="1444007">1</span>&nbsp;<span class="op" id="1444009">&lt;&lt;</span>&nbsp;<span class="num" id="1444012">56</span><span class="op" id="1444014">)</span>&nbsp;<span class="comment" id="1444016">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1444027">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444045">switch</span>&nbsp;<span class="op" id="1444052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444055">case</span>&nbsp;<span class="ident" id="1444060"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1444065">(</span><span class="ident" id="1444066"><a href="/math/erf.go.html#1443965">x</a></span><span class="op" id="1444067">)</span><span class="op" id="1444068">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444072">return</span>&nbsp;<span class="ident" id="1444079"><a href="/math/bits.go.html#1427274">NaN</a></span><span class="op" id="1444082">(</span><span class="op" id="1444083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444086">case</span>&nbsp;<span class="ident" id="1444091"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1444096">(</span><span class="ident" id="1444097"><a href="/math/erf.go.html#1443965">x</a></span><span class="op" id="1444098">,</span>&nbsp;<span class="num" id="1444100">1</span><span class="op" id="1444101">)</span><span class="op" id="1444102">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444106">return</span>&nbsp;<span class="num" id="1444113">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444116">case</span>&nbsp;<span class="ident" id="1444121"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1444126">(</span><span class="ident" id="1444127"><a href="/math/erf.go.html#1443965">x</a></span><span class="op" id="1444128">,</span>&nbsp;<span class="op" id="1444130">-</span><span class="num" id="1444131">1</span><span class="op" id="1444132">)</span><span class="op" id="1444133">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444137">return</span>&nbsp;<span class="num" id="1444144">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444150">sign</span>&nbsp;<span class="op" id="1444155">:=</span>&nbsp;<span class="ident" id="1444158">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444165">if</span>&nbsp;<span class="ident" id="1444168"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444170">&lt;</span>&nbsp;<span class="num" id="1444172">0</span>&nbsp;<span class="op" id="1444174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444178"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444180">=</span>&nbsp;<span class="op" id="1444182">-</span><span class="ident" id="1444183"><a href="/math/erf.go.html#1443965">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444187"><a href="/math/erf.go.html#1444150">sign</a></span>&nbsp;<span class="op" id="1444192">=</span>&nbsp;<span class="ident" id="1444194">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444203">if</span>&nbsp;<span class="ident" id="1444206"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444208">&lt;</span>&nbsp;<span class="num" id="1444210">0.84375</span>&nbsp;<span class="op" id="1444218">{</span>&nbsp;<span class="comment" id="1444220">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444239">var</span>&nbsp;<span class="ident" id="1444243">temp</span>&nbsp;<span class="builtintype" id="1444248">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444258">if</span>&nbsp;<span class="ident" id="1444261"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444263">&lt;</span>&nbsp;<span class="ident" id="1444265"><a href="/math/erf.go.html#1443993">Tiny</a></span>&nbsp;<span class="op" id="1444270">{</span>&nbsp;<span class="comment" id="1444272">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444291"><a href="/math/erf.go.html#1444243">temp</a></span>&nbsp;<span class="op" id="1444296">=</span>&nbsp;<span class="ident" id="1444298"><a href="/math/erf.go.html#1443965">x</a></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444302">}</span>&nbsp;<span class="keyword" id="1444304">else</span>&nbsp;<span class="op" id="1444309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444314">z</span>&nbsp;<span class="op" id="1444316">:=</span>&nbsp;<span class="ident" id="1444319"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444321">*</span>&nbsp;<span class="ident" id="1444323"><a href="/math/erf.go.html#1443965">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444328">r</span>&nbsp;<span class="op" id="1444330">:=</span>&nbsp;<span class="ident" id="1444333"><a href="/math/erf.go.html#1438875">pp0</a></span>&nbsp;<span class="op" id="1444337">+</span>&nbsp;<span class="ident" id="1444339"><a href="/math/erf.go.html#1444314">z</a></span><span class="op" id="1444340">*</span><span class="op" id="1444341">(</span><span class="ident" id="1444342"><a href="/math/erf.go.html#1438933">pp1</a></span><span class="op" id="1444345">+</span><span class="ident" id="1444346"><a href="/math/erf.go.html#1444314">z</a></span><span class="op" id="1444347">*</span><span class="op" id="1444348">(</span><span class="ident" id="1444349"><a href="/math/erf.go.html#1438991">pp2</a></span><span class="op" id="1444352">+</span><span class="ident" id="1444353"><a href="/math/erf.go.html#1444314">z</a></span><span class="op" id="1444354">*</span><span class="op" id="1444355">(</span><span class="ident" id="1444356"><a href="/math/erf.go.html#1439049">pp3</a></span><span class="op" id="1444359">+</span><span class="ident" id="1444360"><a href="/math/erf.go.html#1444314">z</a></span><span class="op" id="1444361">*</span><span class="ident" id="1444362"><a href="/math/erf.go.html#1439107">pp4</a></span><span class="op" id="1444365">)</span><span class="op" id="1444366">)</span><span class="op" id="1444367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444372">s</span>&nbsp;<span class="op" id="1444374">:=</span>&nbsp;<span class="num" id="1444377">1</span>&nbsp;<span class="op" id="1444379">+</span>&nbsp;<span class="ident" id="1444381"><a href="/math/erf.go.html#1444314">z</a></span><span class="op" id="1444382">*</span><span class="op" id="1444383">(</span><span class="ident" id="1444384"><a href="/math/erf.go.html#1439165">qq1</a></span><span class="op" id="1444387">+</span><span class="ident" id="1444388"><a href="/math/erf.go.html#1444314">z</a></span><span class="op" id="1444389">*</span><span class="op" id="1444390">(</span><span class="ident" id="1444391"><a href="/math/erf.go.html#1439223">qq2</a></span><span class="op" id="1444394">+</span><span class="ident" id="1444395"><a href="/math/erf.go.html#1444314">z</a></span><span class="op" id="1444396">*</span><span class="op" id="1444397">(</span><span class="ident" id="1444398"><a href="/math/erf.go.html#1439281">qq3</a></span><span class="op" id="1444401">+</span><span class="ident" id="1444402"><a href="/math/erf.go.html#1444314">z</a></span><span class="op" id="1444403">*</span><span class="op" id="1444404">(</span><span class="ident" id="1444405"><a href="/math/erf.go.html#1439339">qq4</a></span><span class="op" id="1444408">+</span><span class="ident" id="1444409"><a href="/math/erf.go.html#1444314">z</a></span><span class="op" id="1444410">*</span><span class="ident" id="1444411"><a href="/math/erf.go.html#1439397">qq5</a></span><span class="op" id="1444414">)</span><span class="op" id="1444415">)</span><span class="op" id="1444416">)</span><span class="op" id="1444417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444422">y</span>&nbsp;<span class="op" id="1444424">:=</span>&nbsp;<span class="ident" id="1444427"><a href="/math/erf.go.html#1444328">r</a></span>&nbsp;<span class="op" id="1444429">/</span>&nbsp;<span class="ident" id="1444431"><a href="/math/erf.go.html#1444372">s</a></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444436">if</span>&nbsp;<span class="ident" id="1444439"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444441">&lt;</span>&nbsp;<span class="num" id="1444443">0.25</span>&nbsp;<span class="op" id="1444448">{</span>&nbsp;<span class="comment" id="1444450">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444467"><a href="/math/erf.go.html#1444243">temp</a></span>&nbsp;<span class="op" id="1444472">=</span>&nbsp;<span class="ident" id="1444474"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444476">+</span>&nbsp;<span class="ident" id="1444478"><a href="/math/erf.go.html#1443965">x</a></span><span class="op" id="1444479">*</span><span class="ident" id="1444480"><a href="/math/erf.go.html#1444422">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444485">}</span>&nbsp;<span class="keyword" id="1444487">else</span>&nbsp;<span class="op" id="1444492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444498"><a href="/math/erf.go.html#1444243">temp</a></span>&nbsp;<span class="op" id="1444503">=</span>&nbsp;<span class="num" id="1444505">0.5</span>&nbsp;<span class="op" id="1444509">+</span>&nbsp;<span class="op" id="1444511">(</span><span class="ident" id="1444512"><a href="/math/erf.go.html#1443965">x</a></span><span class="op" id="1444513">*</span><span class="ident" id="1444514"><a href="/math/erf.go.html#1444422">y</a></span>&nbsp;<span class="op" id="1444516">+</span>&nbsp;<span class="op" id="1444518">(</span><span class="ident" id="1444519"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444521">-</span>&nbsp;<span class="num" id="1444523">0.5</span><span class="op" id="1444526">)</span><span class="op" id="1444527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444532">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444540">if</span>&nbsp;<span class="ident" id="1444543"><a href="/math/erf.go.html#1444150">sign</a></span>&nbsp;<span class="op" id="1444548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444553">return</span>&nbsp;<span class="num" id="1444560">1</span>&nbsp;<span class="op" id="1444562">+</span>&nbsp;<span class="ident" id="1444564"><a href="/math/erf.go.html#1444243">temp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444575">return</span>&nbsp;<span class="num" id="1444582">1</span>&nbsp;<span class="op" id="1444584">-</span>&nbsp;<span class="ident" id="1444586"><a href="/math/erf.go.html#1444243">temp</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444595">if</span>&nbsp;<span class="ident" id="1444598"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444600">&lt;</span>&nbsp;<span class="num" id="1444602">1.25</span>&nbsp;<span class="op" id="1444607">{</span>&nbsp;<span class="comment" id="1444609">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444636">s</span>&nbsp;<span class="op" id="1444638">:=</span>&nbsp;<span class="ident" id="1444641"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444643">-</span>&nbsp;<span class="num" id="1444645">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444649">P</span>&nbsp;<span class="op" id="1444651">:=</span>&nbsp;<span class="ident" id="1444654"><a href="/math/erf.go.html#1439518">pa0</a></span>&nbsp;<span class="op" id="1444658">+</span>&nbsp;<span class="ident" id="1444660"><a href="/math/erf.go.html#1444636">s</a></span><span class="op" id="1444661">*</span><span class="op" id="1444662">(</span><span class="ident" id="1444663"><a href="/math/erf.go.html#1439575">pa1</a></span><span class="op" id="1444666">+</span><span class="ident" id="1444667"><a href="/math/erf.go.html#1444636">s</a></span><span class="op" id="1444668">*</span><span class="op" id="1444669">(</span><span class="ident" id="1444670"><a href="/math/erf.go.html#1439632">pa2</a></span><span class="op" id="1444673">+</span><span class="ident" id="1444674"><a href="/math/erf.go.html#1444636">s</a></span><span class="op" id="1444675">*</span><span class="op" id="1444676">(</span><span class="ident" id="1444677"><a href="/math/erf.go.html#1439689">pa3</a></span><span class="op" id="1444680">+</span><span class="ident" id="1444681"><a href="/math/erf.go.html#1444636">s</a></span><span class="op" id="1444682">*</span><span class="op" id="1444683">(</span><span class="ident" id="1444684"><a href="/math/erf.go.html#1439746">pa4</a></span><span class="op" id="1444687">+</span><span class="ident" id="1444688"><a href="/math/erf.go.html#1444636">s</a></span><span class="op" id="1444689">*</span><span class="op" id="1444690">(</span><span class="ident" id="1444691"><a href="/math/erf.go.html#1439803">pa5</a></span><span class="op" id="1444694">+</span><span class="ident" id="1444695"><a href="/math/erf.go.html#1444636">s</a></span><span class="op" id="1444696">*</span><span class="ident" id="1444697"><a href="/math/erf.go.html#1439860">pa6</a></span><span class="op" id="1444700">)</span><span class="op" id="1444701">)</span><span class="op" id="1444702">)</span><span class="op" id="1444703">)</span><span class="op" id="1444704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444708">Q</span>&nbsp;<span class="op" id="1444710">:=</span>&nbsp;<span class="num" id="1444713">1</span>&nbsp;<span class="op" id="1444715">+</span>&nbsp;<span class="ident" id="1444717"><a href="/math/erf.go.html#1444636">s</a></span><span class="op" id="1444718">*</span><span class="op" id="1444719">(</span><span class="ident" id="1444720"><a href="/math/erf.go.html#1439917">qa1</a></span><span class="op" id="1444723">+</span><span class="ident" id="1444724"><a href="/math/erf.go.html#1444636">s</a></span><span class="op" id="1444725">*</span><span class="op" id="1444726">(</span><span class="ident" id="1444727"><a href="/math/erf.go.html#1439974">qa2</a></span><span class="op" id="1444730">+</span><span class="ident" id="1444731"><a href="/math/erf.go.html#1444636">s</a></span><span class="op" id="1444732">*</span><span class="op" id="1444733">(</span><span class="ident" id="1444734"><a href="/math/erf.go.html#1440031">qa3</a></span><span class="op" id="1444737">+</span><span class="ident" id="1444738"><a href="/math/erf.go.html#1444636">s</a></span><span class="op" id="1444739">*</span><span class="op" id="1444740">(</span><span class="ident" id="1444741"><a href="/math/erf.go.html#1440088">qa4</a></span><span class="op" id="1444744">+</span><span class="ident" id="1444745"><a href="/math/erf.go.html#1444636">s</a></span><span class="op" id="1444746">*</span><span class="op" id="1444747">(</span><span class="ident" id="1444748"><a href="/math/erf.go.html#1440145">qa5</a></span><span class="op" id="1444751">+</span><span class="ident" id="1444752"><a href="/math/erf.go.html#1444636">s</a></span><span class="op" id="1444753">*</span><span class="ident" id="1444754"><a href="/math/erf.go.html#1440202">qa6</a></span><span class="op" id="1444757">)</span><span class="op" id="1444758">)</span><span class="op" id="1444759">)</span><span class="op" id="1444760">)</span><span class="op" id="1444761">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444765">if</span>&nbsp;<span class="ident" id="1444768"><a href="/math/erf.go.html#1444150">sign</a></span>&nbsp;<span class="op" id="1444773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444778">return</span>&nbsp;<span class="num" id="1444785">1</span>&nbsp;<span class="op" id="1444787">+</span>&nbsp;<span class="ident" id="1444789"><a href="/math/erf.go.html#1438644">erx</a></span>&nbsp;<span class="op" id="1444793">+</span>&nbsp;<span class="ident" id="1444795"><a href="/math/erf.go.html#1444649">P</a></span><span class="op" id="1444796">/</span><span class="ident" id="1444797"><a href="/math/erf.go.html#1444708">Q</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444805">return</span>&nbsp;<span class="num" id="1444812">1</span>&nbsp;<span class="op" id="1444814">-</span>&nbsp;<span class="ident" id="1444816"><a href="/math/erf.go.html#1438644">erx</a></span>&nbsp;<span class="op" id="1444820">-</span>&nbsp;<span class="ident" id="1444822"><a href="/math/erf.go.html#1444649">P</a></span><span class="op" id="1444823">/</span><span class="ident" id="1444824"><a href="/math/erf.go.html#1444708">Q</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444831">if</span>&nbsp;<span class="ident" id="1444834"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444836">&lt;</span>&nbsp;<span class="num" id="1444838">28</span>&nbsp;<span class="op" id="1444841">{</span>&nbsp;<span class="comment" id="1444843">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444857">s</span>&nbsp;<span class="op" id="1444859">:=</span>&nbsp;<span class="num" id="1444862">1</span>&nbsp;<span class="op" id="1444864">/</span>&nbsp;<span class="op" id="1444866">(</span><span class="ident" id="1444867"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444869">*</span>&nbsp;<span class="ident" id="1444871"><a href="/math/erf.go.html#1443965">x</a></span><span class="op" id="1444872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444876">var</span>&nbsp;<span class="ident" id="1444880">R</span><span class="op" id="1444881">,</span>&nbsp;<span class="ident" id="1444883">S</span>&nbsp;<span class="builtintype" id="1444885">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444895">if</span>&nbsp;<span class="ident" id="1444898"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1444900">&lt;</span>&nbsp;<span class="num" id="1444902">1</span><span class="op" id="1444903">/</span><span class="num" id="1444904">0.35</span>&nbsp;<span class="op" id="1444909">{</span>&nbsp;<span class="comment" id="1444911">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444943"><a href="/math/erf.go.html#1444880">R</a></span>&nbsp;<span class="op" id="1444945">=</span>&nbsp;<span class="ident" id="1444947"><a href="/math/erf.go.html#1440321">ra0</a></span>&nbsp;<span class="op" id="1444951">+</span>&nbsp;<span class="ident" id="1444953"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1444954">*</span><span class="op" id="1444955">(</span><span class="ident" id="1444956"><a href="/math/erf.go.html#1440378">ra1</a></span><span class="op" id="1444959">+</span><span class="ident" id="1444960"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1444961">*</span><span class="op" id="1444962">(</span><span class="ident" id="1444963"><a href="/math/erf.go.html#1440435">ra2</a></span><span class="op" id="1444966">+</span><span class="ident" id="1444967"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1444968">*</span><span class="op" id="1444969">(</span><span class="ident" id="1444970"><a href="/math/erf.go.html#1440492">ra3</a></span><span class="op" id="1444973">+</span><span class="ident" id="1444974"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1444975">*</span><span class="op" id="1444976">(</span><span class="ident" id="1444977"><a href="/math/erf.go.html#1440549">ra4</a></span><span class="op" id="1444980">+</span><span class="ident" id="1444981"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1444982">*</span><span class="op" id="1444983">(</span><span class="ident" id="1444984"><a href="/math/erf.go.html#1440606">ra5</a></span><span class="op" id="1444987">+</span><span class="ident" id="1444988"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1444989">*</span><span class="op" id="1444990">(</span><span class="ident" id="1444991"><a href="/math/erf.go.html#1440663">ra6</a></span><span class="op" id="1444994">+</span><span class="ident" id="1444995"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1444996">*</span><span class="ident" id="1444997"><a href="/math/erf.go.html#1440720">ra7</a></span><span class="op" id="1445000">)</span><span class="op" id="1445001">)</span><span class="op" id="1445002">)</span><span class="op" id="1445003">)</span><span class="op" id="1445004">)</span><span class="op" id="1445005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445010"><a href="/math/erf.go.html#1444883">S</a></span>&nbsp;<span class="op" id="1445012">=</span>&nbsp;<span class="num" id="1445014">1</span>&nbsp;<span class="op" id="1445016">+</span>&nbsp;<span class="ident" id="1445018"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445019">*</span><span class="op" id="1445020">(</span><span class="ident" id="1445021"><a href="/math/erf.go.html#1440777">sa1</a></span><span class="op" id="1445024">+</span><span class="ident" id="1445025"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445026">*</span><span class="op" id="1445027">(</span><span class="ident" id="1445028"><a href="/math/erf.go.html#1440834">sa2</a></span><span class="op" id="1445031">+</span><span class="ident" id="1445032"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445033">*</span><span class="op" id="1445034">(</span><span class="ident" id="1445035"><a href="/math/erf.go.html#1440891">sa3</a></span><span class="op" id="1445038">+</span><span class="ident" id="1445039"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445040">*</span><span class="op" id="1445041">(</span><span class="ident" id="1445042"><a href="/math/erf.go.html#1440948">sa4</a></span><span class="op" id="1445045">+</span><span class="ident" id="1445046"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445047">*</span><span class="op" id="1445048">(</span><span class="ident" id="1445049"><a href="/math/erf.go.html#1441005">sa5</a></span><span class="op" id="1445052">+</span><span class="ident" id="1445053"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445054">*</span><span class="op" id="1445055">(</span><span class="ident" id="1445056"><a href="/math/erf.go.html#1441062">sa6</a></span><span class="op" id="1445059">+</span><span class="ident" id="1445060"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445061">*</span><span class="op" id="1445062">(</span><span class="ident" id="1445063"><a href="/math/erf.go.html#1441119">sa7</a></span><span class="op" id="1445066">+</span><span class="ident" id="1445067"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445068">*</span><span class="ident" id="1445069"><a href="/math/erf.go.html#1441176">sa8</a></span><span class="op" id="1445072">)</span><span class="op" id="1445073">)</span><span class="op" id="1445074">)</span><span class="op" id="1445075">)</span><span class="op" id="1445076">)</span><span class="op" id="1445077">)</span><span class="op" id="1445078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445082">}</span>&nbsp;<span class="keyword" id="1445084">else</span>&nbsp;<span class="op" id="1445089">{</span>&nbsp;<span class="comment" id="1445091">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445124">if</span>&nbsp;<span class="ident" id="1445127"><a href="/math/erf.go.html#1444150">sign</a></span>&nbsp;<span class="op" id="1445132">&amp;&amp;</span>&nbsp;<span class="ident" id="1445135"><a href="/math/erf.go.html#1443965">x</a></span>&nbsp;<span class="op" id="1445137">&gt;</span>&nbsp;<span class="num" id="1445139">6</span>&nbsp;<span class="op" id="1445141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445147">return</span>&nbsp;<span class="num" id="1445154">2</span>&nbsp;<span class="comment" id="1445156">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445174"><a href="/math/erf.go.html#1444880">R</a></span>&nbsp;<span class="op" id="1445176">=</span>&nbsp;<span class="ident" id="1445178"><a href="/math/erf.go.html#1441292">rb0</a></span>&nbsp;<span class="op" id="1445182">+</span>&nbsp;<span class="ident" id="1445184"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445185">*</span><span class="op" id="1445186">(</span><span class="ident" id="1445187"><a href="/math/erf.go.html#1441349">rb1</a></span><span class="op" id="1445190">+</span><span class="ident" id="1445191"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445192">*</span><span class="op" id="1445193">(</span><span class="ident" id="1445194"><a href="/math/erf.go.html#1441406">rb2</a></span><span class="op" id="1445197">+</span><span class="ident" id="1445198"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445199">*</span><span class="op" id="1445200">(</span><span class="ident" id="1445201"><a href="/math/erf.go.html#1441463">rb3</a></span><span class="op" id="1445204">+</span><span class="ident" id="1445205"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445206">*</span><span class="op" id="1445207">(</span><span class="ident" id="1445208"><a href="/math/erf.go.html#1441520">rb4</a></span><span class="op" id="1445211">+</span><span class="ident" id="1445212"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445213">*</span><span class="op" id="1445214">(</span><span class="ident" id="1445215"><a href="/math/erf.go.html#1441577">rb5</a></span><span class="op" id="1445218">+</span><span class="ident" id="1445219"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445220">*</span><span class="ident" id="1445221"><a href="/math/erf.go.html#1441634">rb6</a></span><span class="op" id="1445224">)</span><span class="op" id="1445225">)</span><span class="op" id="1445226">)</span><span class="op" id="1445227">)</span><span class="op" id="1445228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445233"><a href="/math/erf.go.html#1444883">S</a></span>&nbsp;<span class="op" id="1445235">=</span>&nbsp;<span class="num" id="1445237">1</span>&nbsp;<span class="op" id="1445239">+</span>&nbsp;<span class="ident" id="1445241"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445242">*</span><span class="op" id="1445243">(</span><span class="ident" id="1445244"><a href="/math/erf.go.html#1441691">sb1</a></span><span class="op" id="1445247">+</span><span class="ident" id="1445248"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445249">*</span><span class="op" id="1445250">(</span><span class="ident" id="1445251"><a href="/math/erf.go.html#1441748">sb2</a></span><span class="op" id="1445254">+</span><span class="ident" id="1445255"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445256">*</span><span class="op" id="1445257">(</span><span class="ident" id="1445258"><a href="/math/erf.go.html#1441805">sb3</a></span><span class="op" id="1445261">+</span><span class="ident" id="1445262"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445263">*</span><span class="op" id="1445264">(</span><span class="ident" id="1445265"><a href="/math/erf.go.html#1441862">sb4</a></span><span class="op" id="1445268">+</span><span class="ident" id="1445269"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445270">*</span><span class="op" id="1445271">(</span><span class="ident" id="1445272"><a href="/math/erf.go.html#1441919">sb5</a></span><span class="op" id="1445275">+</span><span class="ident" id="1445276"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445277">*</span><span class="op" id="1445278">(</span><span class="ident" id="1445279"><a href="/math/erf.go.html#1441976">sb6</a></span><span class="op" id="1445282">+</span><span class="ident" id="1445283"><a href="/math/erf.go.html#1444857">s</a></span><span class="op" id="1445284">*</span><span class="ident" id="1445285"><a href="/math/erf.go.html#1442033">sb7</a></span><span class="op" id="1445288">)</span><span class="op" id="1445289">)</span><span class="op" id="1445290">)</span><span class="op" id="1445291">)</span><span class="op" id="1445292">)</span><span class="op" id="1445293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445301">z</span>&nbsp;<span class="op" id="1445303">:=</span>&nbsp;<span class="ident" id="1445306"><a href="/math/unsafe.go.html#1556218">Float64frombits</a></span><span class="op" id="1445321">(</span><span class="ident" id="1445322"><a href="/math/unsafe.go.html#1556032">Float64bits</a></span><span class="op" id="1445333">(</span><span class="ident" id="1445334"><a href="/math/erf.go.html#1443965">x</a></span><span class="op" id="1445335">)</span>&nbsp;<span class="op" id="1445337">&amp;</span>&nbsp;<span class="num" id="1445339">0xffffffff00000000</span><span class="op" id="1445357">)</span>&nbsp;<span class="comment" id="1445359">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445399">r</span>&nbsp;<span class="op" id="1445401">:=</span>&nbsp;<span class="ident" id="1445404"><a href="/math/exp.go.html#1445907">Exp</a></span><span class="op" id="1445407">(</span><span class="op" id="1445408">-</span><span class="ident" id="1445409"><a href="/math/erf.go.html#1445301">z</a></span><span class="op" id="1445410">*</span><span class="ident" id="1445411"><a href="/math/erf.go.html#1445301">z</a></span><span class="op" id="1445412">-</span><span class="num" id="1445413">0.5625</span><span class="op" id="1445419">)</span>&nbsp;<span class="op" id="1445421">*</span>&nbsp;<span class="ident" id="1445423"><a href="/math/exp.go.html#1445907">Exp</a></span><span class="op" id="1445426">(</span><span class="op" id="1445427">(</span><span class="ident" id="1445428"><a href="/math/erf.go.html#1445301">z</a></span><span class="op" id="1445429">-</span><span class="ident" id="1445430"><a href="/math/erf.go.html#1443965">x</a></span><span class="op" id="1445431">)</span><span class="op" id="1445432">*</span><span class="op" id="1445433">(</span><span class="ident" id="1445434"><a href="/math/erf.go.html#1445301">z</a></span><span class="op" id="1445435">+</span><span class="ident" id="1445436"><a href="/math/erf.go.html#1443965">x</a></span><span class="op" id="1445437">)</span><span class="op" id="1445438">+</span><span class="ident" id="1445439"><a href="/math/erf.go.html#1444880">R</a></span><span class="op" id="1445440">/</span><span class="ident" id="1445441"><a href="/math/erf.go.html#1444883">S</a></span><span class="op" id="1445442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445446">if</span>&nbsp;<span class="ident" id="1445449"><a href="/math/erf.go.html#1444150">sign</a></span>&nbsp;<span class="op" id="1445454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445459">return</span>&nbsp;<span class="num" id="1445466">2</span>&nbsp;<span class="op" id="1445468">-</span>&nbsp;<span class="ident" id="1445470"><a href="/math/erf.go.html#1445399">r</a></span><span class="op" id="1445471">/</span><span class="ident" id="1445472"><a href="/math/erf.go.html#1443965">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445480">return</span>&nbsp;<span class="ident" id="1445487"><a href="/math/erf.go.html#1445399">r</a></span>&nbsp;<span class="op" id="1445489">/</span>&nbsp;<span class="ident" id="1445491"><a href="/math/erf.go.html#1443965">x</a></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445497">if</span>&nbsp;<span class="ident" id="1445500"><a href="/math/erf.go.html#1444150">sign</a></span>&nbsp;<span class="op" id="1445505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445509">return</span>&nbsp;<span class="num" id="1445516">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445522">return</span>&nbsp;<span class="num" id="1445529">0</span><br>
<span class="lineno">335</span><span class="op" id="1445531">}</span>
</div>
</body>
</html>
