<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html" class="current">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5569917">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5569972">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5570026">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5570077">package</span>&nbsp;<span class="ident" id="5570085">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5570092">import</span>&nbsp;<span class="string" id="5570099">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5570107">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5570167">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5570237">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5570295">//</span><br>
<span class="lineno"></span><span class="comment" id="5570298">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5570346">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5570410">//</span><br>
<span class="lineno"></span><span class="comment" id="5570413">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5570474">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5570544">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5570619">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5570686">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5570759">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5570831">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5570845">//</span><br>
<span class="lineno"></span><span class="comment" id="5570848">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5570914">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5570980">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5570993">//</span><br>
<span class="lineno"></span><span class="comment" id="5570996">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5571020">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5571050">//&nbsp;Complex&nbsp;square&nbsp;root</span><br>
<span class="lineno"></span><span class="comment" id="5571073">//</span><br>
<span class="lineno"></span><span class="comment" id="5571076">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5571092">//</span><br>
<span class="lineno">35</span><span class="comment" id="5571095">//&nbsp;If&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,&nbsp;&nbsp;r&nbsp;=&nbsp;|z|,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5571128">//</span><br>
<span class="lineno"></span><span class="comment" id="5571131">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="5571160">//&nbsp;Re&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;+&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;,</span><br>
<span class="lineno"></span><span class="comment" id="5571190">//</span><br>
<span class="lineno">40</span><span class="comment" id="5571193">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="5571222">//&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;-&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="5571252">//</span><br>
<span class="lineno"></span><span class="comment" id="5571255">//&nbsp;Cancellation&nbsp;error&nbsp;in&nbsp;r-x&nbsp;or&nbsp;r+x&nbsp;is&nbsp;avoided&nbsp;by&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5571315">//&nbsp;identity&nbsp;&nbsp;2&nbsp;Re&nbsp;w&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;y.</span><br>
<span class="lineno">45</span><span class="comment" id="5571347">//</span><br>
<span class="lineno"></span><span class="comment" id="5571350">//&nbsp;Note&nbsp;that&nbsp;-w&nbsp;is&nbsp;also&nbsp;a&nbsp;square&nbsp;root&nbsp;of&nbsp;z.&nbsp;&nbsp;The&nbsp;root&nbsp;chosen</span><br>
<span class="lineno"></span><span class="comment" id="5571411">//&nbsp;is&nbsp;always&nbsp;in&nbsp;the&nbsp;right&nbsp;half&nbsp;plane&nbsp;and&nbsp;Im&nbsp;w&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;y.</span><br>
<span class="lineno"></span><span class="comment" id="5571481">//</span><br>
<span class="lineno"></span><span class="comment" id="5571484">//&nbsp;ACCURACY:</span><br>
<span class="lineno">50</span><span class="comment" id="5571497">//</span><br>
<span class="lineno"></span><span class="comment" id="5571500">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5571540">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5571598">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.6e-18</span><br>
<span class="lineno"></span><span class="comment" id="5571658">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;1,000,000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.9e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.1e-17</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="5571719">//&nbsp;Sqrt&nbsp;returns&nbsp;the&nbsp;square&nbsp;root&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="5571757">//&nbsp;The&nbsp;result&nbsp;r&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;real(r)&nbsp;â‰¥&nbsp;0&nbsp;and&nbsp;imag(r)&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;imag(x).</span><br>
<span class="lineno"></span><span class="keyword" id="5571847">func</span>&nbsp;<span class="ident" id="5571852">Sqrt</span><span class="op" id="5571856">(</span><span class="ident" id="5571857">x</span>&nbsp;<span class="builtintype" id="5571859">complex128</span><span class="op" id="5571869">)</span>&nbsp;<span class="builtintype" id="5571871">complex128</span>&nbsp;<span class="op" id="5571882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5571885">if</span>&nbsp;<span class="builtinfunc" id="5571888">imag</span><span class="op" id="5571892">(</span><span class="ident" id="5571893"><a href="/gostd/math/cmplx/sqrt.go.html#5571857">x</a></span><span class="op" id="5571894">)</span>&nbsp;<span class="op" id="5571896">==</span>&nbsp;<span class="num" id="5571899">0</span>&nbsp;<span class="op" id="5571901">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5571905">if</span>&nbsp;<span class="builtinfunc" id="5571908">real</span><span class="op" id="5571912">(</span><span class="ident" id="5571913"><a href="/gostd/math/cmplx/sqrt.go.html#5571857">x</a></span><span class="op" id="5571914">)</span>&nbsp;<span class="op" id="5571916">==</span>&nbsp;<span class="num" id="5571919">0</span>&nbsp;<span class="op" id="5571921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5571926">return</span>&nbsp;<span class="builtinfunc" id="5571933">complex</span><span class="op" id="5571940">(</span><span class="num" id="5571941">0</span><span class="op" id="5571942">,</span>&nbsp;<span class="num" id="5571944">0</span><span class="op" id="5571945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5571949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5571953">if</span>&nbsp;<span class="builtinfunc" id="5571956">real</span><span class="op" id="5571960">(</span><span class="ident" id="5571961"><a href="/gostd/math/cmplx/sqrt.go.html#5571857">x</a></span><span class="op" id="5571962">)</span>&nbsp;<span class="op" id="5571964">&lt;</span>&nbsp;<span class="num" id="5571966">0</span>&nbsp;<span class="op" id="5571968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5571973">return</span>&nbsp;<span class="builtinfunc" id="5571980">complex</span><span class="op" id="5571987">(</span><span class="num" id="5571988">0</span><span class="op" id="5571989">,</span>&nbsp;<span class="ident" id="5571991"><a href="/gostd/math/cmplx/sqrt.go.html#5570099">math</a></span><span class="op" id="5571995">.</span><span class="ident" id="5571996"><a href="/gostd/math/sqrt.go.html#2332042">Sqrt</a></span><span class="op" id="5572000">(</span><span class="op" id="5572001">-</span><span class="builtinfunc" id="5572002">real</span><span class="op" id="5572006">(</span><span class="ident" id="5572007"><a href="/gostd/math/cmplx/sqrt.go.html#5571857">x</a></span><span class="op" id="5572008">)</span><span class="op" id="5572009">)</span><span class="op" id="5572010">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5572014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5572018">return</span>&nbsp;<span class="builtinfunc" id="5572025">complex</span><span class="op" id="5572032">(</span><span class="ident" id="5572033"><a href="/gostd/math/cmplx/sqrt.go.html#5570099">math</a></span><span class="op" id="5572037">.</span><span class="ident" id="5572038"><a href="/gostd/math/sqrt.go.html#2332042">Sqrt</a></span><span class="op" id="5572042">(</span><span class="builtinfunc" id="5572043">real</span><span class="op" id="5572047">(</span><span class="ident" id="5572048"><a href="/gostd/math/cmplx/sqrt.go.html#5571857">x</a></span><span class="op" id="5572049">)</span><span class="op" id="5572050">)</span><span class="op" id="5572051">,</span>&nbsp;<span class="num" id="5572053">0</span><span class="op" id="5572054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5572057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5572060">if</span>&nbsp;<span class="builtinfunc" id="5572063">real</span><span class="op" id="5572067">(</span><span class="ident" id="5572068"><a href="/gostd/math/cmplx/sqrt.go.html#5571857">x</a></span><span class="op" id="5572069">)</span>&nbsp;<span class="op" id="5572071">==</span>&nbsp;<span class="num" id="5572074">0</span>&nbsp;<span class="op" id="5572076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5572080">if</span>&nbsp;<span class="builtinfunc" id="5572083">imag</span><span class="op" id="5572087">(</span><span class="ident" id="5572088"><a href="/gostd/math/cmplx/sqrt.go.html#5571857">x</a></span><span class="op" id="5572089">)</span>&nbsp;<span class="op" id="5572091">&lt;</span>&nbsp;<span class="num" id="5572093">0</span>&nbsp;<span class="op" id="5572095">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572100">r</span>&nbsp;<span class="op" id="5572102">:=</span>&nbsp;<span class="ident" id="5572105"><a href="/gostd/math/cmplx/sqrt.go.html#5570099">math</a></span><span class="op" id="5572109">.</span><span class="ident" id="5572110"><a href="/gostd/math/sqrt.go.html#2332042">Sqrt</a></span><span class="op" id="5572114">(</span><span class="op" id="5572115">-</span><span class="num" id="5572116">0.5</span>&nbsp;<span class="op" id="5572120">*</span>&nbsp;<span class="builtinfunc" id="5572122">imag</span><span class="op" id="5572126">(</span><span class="ident" id="5572127"><a href="/gostd/math/cmplx/sqrt.go.html#5571857">x</a></span><span class="op" id="5572128">)</span><span class="op" id="5572129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5572134">return</span>&nbsp;<span class="builtinfunc" id="5572141">complex</span><span class="op" id="5572148">(</span><span class="ident" id="5572149"><a href="/gostd/math/cmplx/sqrt.go.html#5572100">r</a></span><span class="op" id="5572150">,</span>&nbsp;<span class="op" id="5572152">-</span><span class="ident" id="5572153"><a href="/gostd/math/cmplx/sqrt.go.html#5572100">r</a></span><span class="op" id="5572154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5572158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572162">r</span>&nbsp;<span class="op" id="5572164">:=</span>&nbsp;<span class="ident" id="5572167"><a href="/gostd/math/cmplx/sqrt.go.html#5570099">math</a></span><span class="op" id="5572171">.</span><span class="ident" id="5572172"><a href="/gostd/math/sqrt.go.html#2332042">Sqrt</a></span><span class="op" id="5572176">(</span><span class="num" id="5572177">0.5</span>&nbsp;<span class="op" id="5572181">*</span>&nbsp;<span class="builtinfunc" id="5572183">imag</span><span class="op" id="5572187">(</span><span class="ident" id="5572188"><a href="/gostd/math/cmplx/sqrt.go.html#5571857">x</a></span><span class="op" id="5572189">)</span><span class="op" id="5572190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5572194">return</span>&nbsp;<span class="builtinfunc" id="5572201">complex</span><span class="op" id="5572208">(</span><span class="ident" id="5572209"><a href="/gostd/math/cmplx/sqrt.go.html#5572162">r</a></span><span class="op" id="5572210">,</span>&nbsp;<span class="ident" id="5572212"><a href="/gostd/math/cmplx/sqrt.go.html#5572162">r</a></span><span class="op" id="5572213">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5572216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572219">a</span>&nbsp;<span class="op" id="5572221">:=</span>&nbsp;<span class="builtinfunc" id="5572224">real</span><span class="op" id="5572228">(</span><span class="ident" id="5572229"><a href="/gostd/math/cmplx/sqrt.go.html#5571857">x</a></span><span class="op" id="5572230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572233">b</span>&nbsp;<span class="op" id="5572235">:=</span>&nbsp;<span class="builtinfunc" id="5572238">imag</span><span class="op" id="5572242">(</span><span class="ident" id="5572243"><a href="/gostd/math/cmplx/sqrt.go.html#5571857">x</a></span><span class="op" id="5572244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5572247">var</span>&nbsp;<span class="ident" id="5572251">scale</span>&nbsp;<span class="builtintype" id="5572257">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5572266">//&nbsp;Rescale&nbsp;to&nbsp;avoid&nbsp;internal&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5572319">if</span>&nbsp;<span class="ident" id="5572322"><a href="/gostd/math/cmplx/sqrt.go.html#5570099">math</a></span><span class="op" id="5572326">.</span><span class="ident" id="5572327"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="5572330">(</span><span class="ident" id="5572331"><a href="/gostd/math/cmplx/sqrt.go.html#5572219">a</a></span><span class="op" id="5572332">)</span>&nbsp;<span class="op" id="5572334">&gt;</span>&nbsp;<span class="num" id="5572336">4</span>&nbsp;<span class="op" id="5572338">||</span>&nbsp;<span class="ident" id="5572341"><a href="/gostd/math/cmplx/sqrt.go.html#5570099">math</a></span><span class="op" id="5572345">.</span><span class="ident" id="5572346"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="5572349">(</span><span class="ident" id="5572350"><a href="/gostd/math/cmplx/sqrt.go.html#5572233">b</a></span><span class="op" id="5572351">)</span>&nbsp;<span class="op" id="5572353">&gt;</span>&nbsp;<span class="num" id="5572355">4</span>&nbsp;<span class="op" id="5572357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572361"><a href="/gostd/math/cmplx/sqrt.go.html#5572219">a</a></span>&nbsp;<span class="op" id="5572363">*=</span>&nbsp;<span class="num" id="5572366">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572373"><a href="/gostd/math/cmplx/sqrt.go.html#5572233">b</a></span>&nbsp;<span class="op" id="5572375">*=</span>&nbsp;<span class="num" id="5572378">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572385"><a href="/gostd/math/cmplx/sqrt.go.html#5572251">scale</a></span>&nbsp;<span class="op" id="5572391">=</span>&nbsp;<span class="num" id="5572393">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5572396">}</span>&nbsp;<span class="keyword" id="5572398">else</span>&nbsp;<span class="op" id="5572403">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572407"><a href="/gostd/math/cmplx/sqrt.go.html#5572219">a</a></span>&nbsp;<span class="op" id="5572409">*=</span>&nbsp;<span class="num" id="5572412">1.8014398509481984e16</span>&nbsp;<span class="comment" id="5572434">//&nbsp;2**54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572445"><a href="/gostd/math/cmplx/sqrt.go.html#5572233">b</a></span>&nbsp;<span class="op" id="5572447">*=</span>&nbsp;<span class="num" id="5572450">1.8014398509481984e16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572474"><a href="/gostd/math/cmplx/sqrt.go.html#5572251">scale</a></span>&nbsp;<span class="op" id="5572480">=</span>&nbsp;<span class="num" id="5572482">7.450580596923828125e-9</span>&nbsp;<span class="comment" id="5572506">//&nbsp;2**-27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5572517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572520">r</span>&nbsp;<span class="op" id="5572522">:=</span>&nbsp;<span class="ident" id="5572525"><a href="/gostd/math/cmplx/sqrt.go.html#5570099">math</a></span><span class="op" id="5572529">.</span><span class="ident" id="5572530"><a href="/gostd/math/hypot.go.html#2250386">Hypot</a></span><span class="op" id="5572535">(</span><span class="ident" id="5572536"><a href="/gostd/math/cmplx/sqrt.go.html#5572219">a</a></span><span class="op" id="5572537">,</span>&nbsp;<span class="ident" id="5572539"><a href="/gostd/math/cmplx/sqrt.go.html#5572233">b</a></span><span class="op" id="5572540">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5572543">var</span>&nbsp;<span class="ident" id="5572547">t</span>&nbsp;<span class="builtintype" id="5572549">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5572558">if</span>&nbsp;<span class="ident" id="5572561"><a href="/gostd/math/cmplx/sqrt.go.html#5572219">a</a></span>&nbsp;<span class="op" id="5572563">&gt;</span>&nbsp;<span class="num" id="5572565">0</span>&nbsp;<span class="op" id="5572567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572571"><a href="/gostd/math/cmplx/sqrt.go.html#5572547">t</a></span>&nbsp;<span class="op" id="5572573">=</span>&nbsp;<span class="ident" id="5572575"><a href="/gostd/math/cmplx/sqrt.go.html#5570099">math</a></span><span class="op" id="5572579">.</span><span class="ident" id="5572580"><a href="/gostd/math/sqrt.go.html#2332042">Sqrt</a></span><span class="op" id="5572584">(</span><span class="num" id="5572585">0.5</span><span class="op" id="5572588">*</span><span class="ident" id="5572589"><a href="/gostd/math/cmplx/sqrt.go.html#5572520">r</a></span>&nbsp;<span class="op" id="5572591">+</span>&nbsp;<span class="num" id="5572593">0.5</span><span class="op" id="5572596">*</span><span class="ident" id="5572597"><a href="/gostd/math/cmplx/sqrt.go.html#5572219">a</a></span><span class="op" id="5572598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572602"><a href="/gostd/math/cmplx/sqrt.go.html#5572520">r</a></span>&nbsp;<span class="op" id="5572604">=</span>&nbsp;<span class="ident" id="5572606"><a href="/gostd/math/cmplx/sqrt.go.html#5572251">scale</a></span>&nbsp;<span class="op" id="5572612">*</span>&nbsp;<span class="ident" id="5572614"><a href="/gostd/math/cmplx/sqrt.go.html#5570099">math</a></span><span class="op" id="5572618">.</span><span class="ident" id="5572619"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="5572622">(</span><span class="op" id="5572623">(</span><span class="num" id="5572624">0.5</span><span class="op" id="5572627">*</span><span class="ident" id="5572628"><a href="/gostd/math/cmplx/sqrt.go.html#5572233">b</a></span><span class="op" id="5572629">)</span><span class="op" id="5572630">/</span><span class="ident" id="5572631"><a href="/gostd/math/cmplx/sqrt.go.html#5572547">t</a></span><span class="op" id="5572632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572636"><a href="/gostd/math/cmplx/sqrt.go.html#5572547">t</a></span>&nbsp;<span class="op" id="5572638">*=</span>&nbsp;<span class="ident" id="5572641"><a href="/gostd/math/cmplx/sqrt.go.html#5572251">scale</a></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5572648">}</span>&nbsp;<span class="keyword" id="5572650">else</span>&nbsp;<span class="op" id="5572655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572659"><a href="/gostd/math/cmplx/sqrt.go.html#5572520">r</a></span>&nbsp;<span class="op" id="5572661">=</span>&nbsp;<span class="ident" id="5572663"><a href="/gostd/math/cmplx/sqrt.go.html#5570099">math</a></span><span class="op" id="5572667">.</span><span class="ident" id="5572668"><a href="/gostd/math/sqrt.go.html#2332042">Sqrt</a></span><span class="op" id="5572672">(</span><span class="num" id="5572673">0.5</span><span class="op" id="5572676">*</span><span class="ident" id="5572677"><a href="/gostd/math/cmplx/sqrt.go.html#5572520">r</a></span>&nbsp;<span class="op" id="5572679">-</span>&nbsp;<span class="num" id="5572681">0.5</span><span class="op" id="5572684">*</span><span class="ident" id="5572685"><a href="/gostd/math/cmplx/sqrt.go.html#5572219">a</a></span><span class="op" id="5572686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572690"><a href="/gostd/math/cmplx/sqrt.go.html#5572547">t</a></span>&nbsp;<span class="op" id="5572692">=</span>&nbsp;<span class="ident" id="5572694"><a href="/gostd/math/cmplx/sqrt.go.html#5572251">scale</a></span>&nbsp;<span class="op" id="5572700">*</span>&nbsp;<span class="ident" id="5572702"><a href="/gostd/math/cmplx/sqrt.go.html#5570099">math</a></span><span class="op" id="5572706">.</span><span class="ident" id="5572707"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="5572710">(</span><span class="op" id="5572711">(</span><span class="num" id="5572712">0.5</span><span class="op" id="5572715">*</span><span class="ident" id="5572716"><a href="/gostd/math/cmplx/sqrt.go.html#5572233">b</a></span><span class="op" id="5572717">)</span><span class="op" id="5572718">/</span><span class="ident" id="5572719"><a href="/gostd/math/cmplx/sqrt.go.html#5572520">r</a></span><span class="op" id="5572720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5572724"><a href="/gostd/math/cmplx/sqrt.go.html#5572520">r</a></span>&nbsp;<span class="op" id="5572726">*=</span>&nbsp;<span class="ident" id="5572729"><a href="/gostd/math/cmplx/sqrt.go.html#5572251">scale</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5572736">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5572739">if</span>&nbsp;<span class="ident" id="5572742"><a href="/gostd/math/cmplx/sqrt.go.html#5572233">b</a></span>&nbsp;<span class="op" id="5572744">&lt;</span>&nbsp;<span class="num" id="5572746">0</span>&nbsp;<span class="op" id="5572748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5572752">return</span>&nbsp;<span class="builtinfunc" id="5572759">complex</span><span class="op" id="5572766">(</span><span class="ident" id="5572767"><a href="/gostd/math/cmplx/sqrt.go.html#5572547">t</a></span><span class="op" id="5572768">,</span>&nbsp;<span class="op" id="5572770">-</span><span class="ident" id="5572771"><a href="/gostd/math/cmplx/sqrt.go.html#5572520">r</a></span><span class="op" id="5572772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5572775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5572778">return</span>&nbsp;<span class="builtinfunc" id="5572785">complex</span><span class="op" id="5572792">(</span><span class="ident" id="5572793"><a href="/gostd/math/cmplx/sqrt.go.html#5572547">t</a></span><span class="op" id="5572794">,</span>&nbsp;<span class="ident" id="5572796"><a href="/gostd/math/cmplx/sqrt.go.html#5572520">r</a></span><span class="op" id="5572797">)</span><br>
<span class="lineno"></span><span class="op" id="5572799">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
