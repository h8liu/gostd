<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4624059">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4624114">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4624168">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4624219">package</span>&nbsp;<span class="ident" id="4624227">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4624233">import</span>&nbsp;<span class="op" id="4624240">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4624243">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4624259">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4624278">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4624295">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4624305">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4624312">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4624323">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4624326">const</span>&nbsp;<span class="ident" id="4624332">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4624349">=</span>&nbsp;<span class="num" id="4624351">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4624354">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4624426">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="4624441">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="4624454">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4624515">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4624588">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="4624613">type</span>&nbsp;<span class="ident" id="4624618">ecPrivateKey</span>&nbsp;<span class="keyword" id="4624631">struct</span>&nbsp;<span class="op" id="4624638">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624641">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4624655">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624660">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624674">[</span><span class="op" id="4624675">]</span><span class="builtintype" id="4624676">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624682">NamedCurveOID</span>&nbsp;<span class="ident" id="4624696">asn1</span><span class="op" id="4624700">.</span><span class="ident" id="4624701">ObjectIdentifier</span>&nbsp;<span class="string" id="4624718">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624752">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4624766">asn1</span><span class="op" id="4624770">.</span><span class="ident" id="4624771">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4624788">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4624821">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4624824">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4624899">func</span>&nbsp;<span class="ident" id="4624904">ParseECPrivateKey</span><span class="op" id="4624921">(</span><span class="ident" id="4624922">der</span>&nbsp;<span class="op" id="4624926">[</span><span class="op" id="4624927">]</span><span class="builtintype" id="4624928">byte</span><span class="op" id="4624932">)</span>&nbsp;<span class="op" id="4624934">(</span><span class="ident" id="4624935">key</span>&nbsp;<span class="op" id="4624939">*</span><span class="ident" id="4624940">ecdsa</span><span class="op" id="4624945">.</span><span class="ident" id="4624946">PrivateKey</span><span class="op" id="4624956">,</span>&nbsp;<span class="ident" id="4624958">err</span>&nbsp;<span class="builtintype" id="4624962">error</span><span class="op" id="4624967">)</span>&nbsp;<span class="op" id="4624969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624972">return</span>&nbsp;<span class="ident" id="4624979">parseECPrivateKey</span><span class="op" id="4624996">(</span><span class="ident" id="4624997">nil</span><span class="op" id="4625000">,</span>&nbsp;<span class="ident" id="4625002">der</span><span class="op" id="4625005">)</span><br>
<span class="lineno"></span><span class="op" id="4625007">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4625010">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="4625084">func</span>&nbsp;<span class="ident" id="4625089">MarshalECPrivateKey</span><span class="op" id="4625108">(</span><span class="ident" id="4625109">key</span>&nbsp;<span class="op" id="4625113">*</span><span class="ident" id="4625114">ecdsa</span><span class="op" id="4625119">.</span><span class="ident" id="4625120">PrivateKey</span><span class="op" id="4625130">)</span>&nbsp;<span class="op" id="4625132">(</span><span class="op" id="4625133">[</span><span class="op" id="4625134">]</span><span class="builtintype" id="4625135">byte</span><span class="op" id="4625139">,</span>&nbsp;<span class="builtintype" id="4625141">error</span><span class="op" id="4625146">)</span>&nbsp;<span class="op" id="4625148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625151">oid</span><span class="op" id="4625154">,</span>&nbsp;<span class="ident" id="4625156">ok</span>&nbsp;<span class="op" id="4625159">:=</span>&nbsp;<span class="ident" id="4625162">oidFromNamedCurve</span><span class="op" id="4625179">(</span><span class="ident" id="4625180">key</span><span class="op" id="4625183">.</span><span class="ident" id="4625184">Curve</span><span class="op" id="4625189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625192">if</span>&nbsp;<span class="op" id="4625195">!</span><span class="ident" id="4625196">ok</span>&nbsp;<span class="op" id="4625199">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625203">return</span>&nbsp;<span class="ident" id="4625210">nil</span><span class="op" id="4625213">,</span>&nbsp;<span class="ident" id="4625215">errors</span><span class="op" id="4625221">.</span><span class="ident" id="4625222">New</span><span class="op" id="4625225">(</span><span class="string" id="4625226">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4625256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4625259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625262">return</span>&nbsp;<span class="ident" id="4625269">asn1</span><span class="op" id="4625273">.</span><span class="ident" id="4625274">Marshal</span><span class="op" id="4625281">(</span><span class="ident" id="4625282">ecPrivateKey</span><span class="op" id="4625294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625298">Version</span><span class="op" id="4625305">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4625313">1</span><span class="op" id="4625314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625318">PrivateKey</span><span class="op" id="4625328">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625333">key</span><span class="op" id="4625336">.</span><span class="ident" id="4625337">D</span><span class="op" id="4625338">.</span><span class="ident" id="4625339">Bytes</span><span class="op" id="4625344">(</span><span class="op" id="4625345">)</span><span class="op" id="4625346">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625350">NamedCurveOID</span><span class="op" id="4625363">:</span>&nbsp;<span class="ident" id="4625365">oid</span><span class="op" id="4625368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625372">PublicKey</span><span class="op" id="4625381">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625387">asn1</span><span class="op" id="4625391">.</span><span class="ident" id="4625392">BitString</span><span class="op" id="4625401">{</span><span class="ident" id="4625402">Bytes</span><span class="op" id="4625407">:</span>&nbsp;<span class="ident" id="4625409">elliptic</span><span class="op" id="4625417">.</span><span class="ident" id="4625418">Marshal</span><span class="op" id="4625425">(</span><span class="ident" id="4625426">key</span><span class="op" id="4625429">.</span><span class="ident" id="4625430">Curve</span><span class="op" id="4625435">,</span>&nbsp;<span class="ident" id="4625437">key</span><span class="op" id="4625440">.</span><span class="ident" id="4625441">X</span><span class="op" id="4625442">,</span>&nbsp;<span class="ident" id="4625444">key</span><span class="op" id="4625447">.</span><span class="ident" id="4625448">Y</span><span class="op" id="4625449">)</span><span class="op" id="4625450">}</span><span class="op" id="4625451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4625454">}</span><span class="op" id="4625455">)</span><br>
<span class="lineno"></span><span class="op" id="4625457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4625460">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4625535">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4625611">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="4625688">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4625739">func</span>&nbsp;<span class="ident" id="4625744">parseECPrivateKey</span><span class="op" id="4625761">(</span><span class="ident" id="4625762">namedCurveOID</span>&nbsp;<span class="op" id="4625776">*</span><span class="ident" id="4625777">asn1</span><span class="op" id="4625781">.</span><span class="ident" id="4625782">ObjectIdentifier</span><span class="op" id="4625798">,</span>&nbsp;<span class="ident" id="4625800">der</span>&nbsp;<span class="op" id="4625804">[</span><span class="op" id="4625805">]</span><span class="builtintype" id="4625806">byte</span><span class="op" id="4625810">)</span>&nbsp;<span class="op" id="4625812">(</span><span class="ident" id="4625813">key</span>&nbsp;<span class="op" id="4625817">*</span><span class="ident" id="4625818">ecdsa</span><span class="op" id="4625823">.</span><span class="ident" id="4625824">PrivateKey</span><span class="op" id="4625834">,</span>&nbsp;<span class="ident" id="4625836">err</span>&nbsp;<span class="builtintype" id="4625840">error</span><span class="op" id="4625845">)</span>&nbsp;<span class="op" id="4625847">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625850">var</span>&nbsp;<span class="ident" id="4625854">privKey</span>&nbsp;<span class="ident" id="4625862">ecPrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625876">if</span>&nbsp;<span class="ident" id="4625879">_</span><span class="op" id="4625880">,</span>&nbsp;<span class="ident" id="4625882">err</span>&nbsp;<span class="op" id="4625886">:=</span>&nbsp;<span class="ident" id="4625889">asn1</span><span class="op" id="4625893">.</span><span class="ident" id="4625894">Unmarshal</span><span class="op" id="4625903">(</span><span class="ident" id="4625904">der</span><span class="op" id="4625907">,</span>&nbsp;<span class="op" id="4625909">&amp;</span><span class="ident" id="4625910">privKey</span><span class="op" id="4625917">)</span><span class="op" id="4625918">;</span>&nbsp;<span class="ident" id="4625920">err</span>&nbsp;<span class="op" id="4625924">!=</span>&nbsp;<span class="ident" id="4625927">nil</span>&nbsp;<span class="op" id="4625931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625935">return</span>&nbsp;<span class="ident" id="4625942">nil</span><span class="op" id="4625945">,</span>&nbsp;<span class="ident" id="4625947">errors</span><span class="op" id="4625953">.</span><span class="ident" id="4625954">New</span><span class="op" id="4625957">(</span><span class="string" id="4625958">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="4625999">+</span>&nbsp;<span class="ident" id="4626001">err</span><span class="op" id="4626004">.</span><span class="ident" id="4626005">Error</span><span class="op" id="4626010">(</span><span class="op" id="4626011">)</span><span class="op" id="4626012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4626015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626018">if</span>&nbsp;<span class="ident" id="4626021">privKey</span><span class="op" id="4626028">.</span><span class="ident" id="4626029">Version</span>&nbsp;<span class="op" id="4626037">!=</span>&nbsp;<span class="ident" id="4626040">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4626057">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626061">return</span>&nbsp;<span class="ident" id="4626068">nil</span><span class="op" id="4626071">,</span>&nbsp;<span class="ident" id="4626073">fmt</span><span class="op" id="4626076">.</span><span class="ident" id="4626077">Errorf</span><span class="op" id="4626083">(</span><span class="string" id="4626084">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="4626125">,</span>&nbsp;<span class="ident" id="4626127">privKey</span><span class="op" id="4626134">.</span><span class="ident" id="4626135">Version</span><span class="op" id="4626142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4626145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626149">var</span>&nbsp;<span class="ident" id="4626153">curve</span>&nbsp;<span class="ident" id="4626159">elliptic</span><span class="op" id="4626167">.</span><span class="ident" id="4626168">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626175">if</span>&nbsp;<span class="ident" id="4626178">namedCurveOID</span>&nbsp;<span class="op" id="4626192">!=</span>&nbsp;<span class="ident" id="4626195">nil</span>&nbsp;<span class="op" id="4626199">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626203">curve</span>&nbsp;<span class="op" id="4626209">=</span>&nbsp;<span class="ident" id="4626211">namedCurveFromOID</span><span class="op" id="4626228">(</span><span class="op" id="4626229">*</span><span class="ident" id="4626230">namedCurveOID</span><span class="op" id="4626243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4626246">}</span>&nbsp;<span class="keyword" id="4626248">else</span>&nbsp;<span class="op" id="4626253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626257">curve</span>&nbsp;<span class="op" id="4626263">=</span>&nbsp;<span class="ident" id="4626265">namedCurveFromOID</span><span class="op" id="4626282">(</span><span class="ident" id="4626283">privKey</span><span class="op" id="4626290">.</span><span class="ident" id="4626291">NamedCurveOID</span><span class="op" id="4626304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4626307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626310">if</span>&nbsp;<span class="ident" id="4626313">curve</span>&nbsp;<span class="op" id="4626319">==</span>&nbsp;<span class="ident" id="4626322">nil</span>&nbsp;<span class="op" id="4626326">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626330">return</span>&nbsp;<span class="ident" id="4626337">nil</span><span class="op" id="4626340">,</span>&nbsp;<span class="ident" id="4626342">errors</span><span class="op" id="4626348">.</span><span class="ident" id="4626349">New</span><span class="op" id="4626352">(</span><span class="string" id="4626353">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4626383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4626386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626390">k</span>&nbsp;<span class="op" id="4626392">:=</span>&nbsp;<span class="builtinfunc" id="4626395">new</span><span class="op" id="4626398">(</span><span class="ident" id="4626399">big</span><span class="op" id="4626402">.</span><span class="ident" id="4626403">Int</span><span class="op" id="4626406">)</span><span class="op" id="4626407">.</span><span class="ident" id="4626408">SetBytes</span><span class="op" id="4626416">(</span><span class="ident" id="4626417">privKey</span><span class="op" id="4626424">.</span><span class="ident" id="4626425">PrivateKey</span><span class="op" id="4626435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626438">if</span>&nbsp;<span class="ident" id="4626441">k</span><span class="op" id="4626442">.</span><span class="ident" id="4626443">Cmp</span><span class="op" id="4626446">(</span><span class="ident" id="4626447">curve</span><span class="op" id="4626452">.</span><span class="ident" id="4626453">Params</span><span class="op" id="4626459">(</span><span class="op" id="4626460">)</span><span class="op" id="4626461">.</span><span class="ident" id="4626462">N</span><span class="op" id="4626463">)</span>&nbsp;<span class="op" id="4626465">&gt;=</span>&nbsp;<span class="num" id="4626468">0</span>&nbsp;<span class="op" id="4626470">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626474">return</span>&nbsp;<span class="ident" id="4626481">nil</span><span class="op" id="4626484">,</span>&nbsp;<span class="ident" id="4626486">errors</span><span class="op" id="4626492">.</span><span class="ident" id="4626493">New</span><span class="op" id="4626496">(</span><span class="string" id="4626497">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="4626545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4626548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626551">priv</span>&nbsp;<span class="op" id="4626556">:=</span>&nbsp;<span class="builtinfunc" id="4626559">new</span><span class="op" id="4626562">(</span><span class="ident" id="4626563">ecdsa</span><span class="op" id="4626568">.</span><span class="ident" id="4626569">PrivateKey</span><span class="op" id="4626579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626582">priv</span><span class="op" id="4626586">.</span><span class="ident" id="4626587">Curve</span>&nbsp;<span class="op" id="4626593">=</span>&nbsp;<span class="ident" id="4626595">curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626602">priv</span><span class="op" id="4626606">.</span><span class="ident" id="4626607">D</span>&nbsp;<span class="op" id="4626609">=</span>&nbsp;<span class="ident" id="4626611">k</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626614">priv</span><span class="op" id="4626618">.</span><span class="ident" id="4626619">X</span><span class="op" id="4626620">,</span>&nbsp;<span class="ident" id="4626622">priv</span><span class="op" id="4626626">.</span><span class="ident" id="4626627">Y</span>&nbsp;<span class="op" id="4626629">=</span>&nbsp;<span class="ident" id="4626631">curve</span><span class="op" id="4626636">.</span><span class="ident" id="4626637">ScalarBaseMult</span><span class="op" id="4626651">(</span><span class="ident" id="4626652">privKey</span><span class="op" id="4626659">.</span><span class="ident" id="4626660">PrivateKey</span><span class="op" id="4626670">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626674">return</span>&nbsp;<span class="ident" id="4626681">priv</span><span class="op" id="4626685">,</span>&nbsp;<span class="ident" id="4626687">nil</span><br>
<span class="lineno"></span><span class="op" id="4626691">}</span>
</div>
</body>
</html>
