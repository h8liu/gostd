<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html" class="current">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8248591">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8248646">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8248700">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8248751">package</span>&nbsp;<span class="ident" id="8248759">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8248764">import</span>&nbsp;<span class="op" id="8248771">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8248774">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8248783">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8248790">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8248800">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8248803">type</span>&nbsp;<span class="ident" id="8248808">rc4Test</span>&nbsp;<span class="keyword" id="8248816">struct</span>&nbsp;<span class="op" id="8248823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8248826">key</span><span class="op" id="8248829">,</span>&nbsp;<span class="ident" id="8248831">keystream</span>&nbsp;<span class="op" id="8248841">[</span><span class="op" id="8248842">]</span><span class="builtintype" id="8248843">byte</span><br>
<span class="lineno">15</span><span class="op" id="8248848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8248851">var</span>&nbsp;<span class="ident" id="8248855">golden</span>&nbsp;<span class="op" id="8248862">=</span>&nbsp;<span class="op" id="8248864">[</span><span class="op" id="8248865">]</span><span class="ident" id="8248866">rc4Test</span><span class="op" id="8248873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8248876">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8248939">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249017">[</span><span class="op" id="8249018">]</span><span class="builtintype" id="8249019">byte</span><span class="op" id="8249023">{</span><span class="num" id="8249024">0x01</span><span class="op" id="8249028">,</span>&nbsp;<span class="num" id="8249030">0x23</span><span class="op" id="8249034">,</span>&nbsp;<span class="num" id="8249036">0x45</span><span class="op" id="8249040">,</span>&nbsp;<span class="num" id="8249042">0x67</span><span class="op" id="8249046">,</span>&nbsp;<span class="num" id="8249048">0x89</span><span class="op" id="8249052">,</span>&nbsp;<span class="num" id="8249054">0xab</span><span class="op" id="8249058">,</span>&nbsp;<span class="num" id="8249060">0xcd</span><span class="op" id="8249064">,</span>&nbsp;<span class="num" id="8249066">0xef</span><span class="op" id="8249070">}</span><span class="op" id="8249071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249075">[</span><span class="op" id="8249076">]</span><span class="builtintype" id="8249077">byte</span><span class="op" id="8249081">{</span><span class="num" id="8249082">0x74</span><span class="op" id="8249086">,</span>&nbsp;<span class="num" id="8249088">0x94</span><span class="op" id="8249092">,</span>&nbsp;<span class="num" id="8249094">0xc2</span><span class="op" id="8249098">,</span>&nbsp;<span class="num" id="8249100">0xe7</span><span class="op" id="8249104">,</span>&nbsp;<span class="num" id="8249106">0x10</span><span class="op" id="8249110">,</span>&nbsp;<span class="num" id="8249112">0x4b</span><span class="op" id="8249116">,</span>&nbsp;<span class="num" id="8249118">0x08</span><span class="op" id="8249122">,</span>&nbsp;<span class="num" id="8249124">0x79</span><span class="op" id="8249128">}</span><span class="op" id="8249129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249132">}</span><span class="op" id="8249133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249136">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249140">[</span><span class="op" id="8249141">]</span><span class="builtintype" id="8249142">byte</span><span class="op" id="8249146">{</span><span class="num" id="8249147">0x00</span><span class="op" id="8249151">,</span>&nbsp;<span class="num" id="8249153">0x00</span><span class="op" id="8249157">,</span>&nbsp;<span class="num" id="8249159">0x00</span><span class="op" id="8249163">,</span>&nbsp;<span class="num" id="8249165">0x00</span><span class="op" id="8249169">,</span>&nbsp;<span class="num" id="8249171">0x00</span><span class="op" id="8249175">,</span>&nbsp;<span class="num" id="8249177">0x00</span><span class="op" id="8249181">,</span>&nbsp;<span class="num" id="8249183">0x00</span><span class="op" id="8249187">,</span>&nbsp;<span class="num" id="8249189">0x00</span><span class="op" id="8249193">}</span><span class="op" id="8249194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249198">[</span><span class="op" id="8249199">]</span><span class="builtintype" id="8249200">byte</span><span class="op" id="8249204">{</span><span class="num" id="8249205">0xde</span><span class="op" id="8249209">,</span>&nbsp;<span class="num" id="8249211">0x18</span><span class="op" id="8249215">,</span>&nbsp;<span class="num" id="8249217">0x89</span><span class="op" id="8249221">,</span>&nbsp;<span class="num" id="8249223">0x41</span><span class="op" id="8249227">,</span>&nbsp;<span class="num" id="8249229">0xa3</span><span class="op" id="8249233">,</span>&nbsp;<span class="num" id="8249235">0x37</span><span class="op" id="8249239">,</span>&nbsp;<span class="num" id="8249241">0x5d</span><span class="op" id="8249245">,</span>&nbsp;<span class="num" id="8249247">0x3a</span><span class="op" id="8249251">}</span><span class="op" id="8249252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249255">}</span><span class="op" id="8249256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249263">[</span><span class="op" id="8249264">]</span><span class="builtintype" id="8249265">byte</span><span class="op" id="8249269">{</span><span class="num" id="8249270">0xef</span><span class="op" id="8249274">,</span>&nbsp;<span class="num" id="8249276">0x01</span><span class="op" id="8249280">,</span>&nbsp;<span class="num" id="8249282">0x23</span><span class="op" id="8249286">,</span>&nbsp;<span class="num" id="8249288">0x45</span><span class="op" id="8249292">}</span><span class="op" id="8249293">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249297">[</span><span class="op" id="8249298">]</span><span class="builtintype" id="8249299">byte</span><span class="op" id="8249303">{</span><span class="num" id="8249304">0xd6</span><span class="op" id="8249308">,</span>&nbsp;<span class="num" id="8249310">0xa1</span><span class="op" id="8249314">,</span>&nbsp;<span class="num" id="8249316">0x41</span><span class="op" id="8249320">,</span>&nbsp;<span class="num" id="8249322">0xa7</span><span class="op" id="8249326">,</span>&nbsp;<span class="num" id="8249328">0xec</span><span class="op" id="8249332">,</span>&nbsp;<span class="num" id="8249334">0x3c</span><span class="op" id="8249338">,</span>&nbsp;<span class="num" id="8249340">0x38</span><span class="op" id="8249344">,</span>&nbsp;<span class="num" id="8249346">0xdf</span><span class="op" id="8249350">,</span>&nbsp;<span class="num" id="8249352">0xbd</span><span class="op" id="8249356">,</span>&nbsp;<span class="num" id="8249358">0x61</span><span class="op" id="8249362">}</span><span class="op" id="8249363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249366">}</span><span class="op" id="8249367">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8249371">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249446">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249450">[</span><span class="op" id="8249451">]</span><span class="builtintype" id="8249452">byte</span><span class="op" id="8249456">{</span><span class="num" id="8249457">0x4b</span><span class="op" id="8249461">,</span>&nbsp;<span class="num" id="8249463">0x65</span><span class="op" id="8249467">,</span>&nbsp;<span class="num" id="8249469">0x79</span><span class="op" id="8249473">}</span><span class="op" id="8249474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249478">[</span><span class="op" id="8249479">]</span><span class="builtintype" id="8249480">byte</span><span class="op" id="8249484">{</span><span class="num" id="8249485">0xeb</span><span class="op" id="8249489">,</span>&nbsp;<span class="num" id="8249491">0x9f</span><span class="op" id="8249495">,</span>&nbsp;<span class="num" id="8249497">0x77</span><span class="op" id="8249501">,</span>&nbsp;<span class="num" id="8249503">0x81</span><span class="op" id="8249507">,</span>&nbsp;<span class="num" id="8249509">0xb7</span><span class="op" id="8249513">,</span>&nbsp;<span class="num" id="8249515">0x34</span><span class="op" id="8249519">,</span>&nbsp;<span class="num" id="8249521">0xca</span><span class="op" id="8249525">,</span>&nbsp;<span class="num" id="8249527">0x72</span><span class="op" id="8249531">,</span>&nbsp;<span class="num" id="8249533">0xa7</span><span class="op" id="8249537">,</span>&nbsp;<span class="num" id="8249539">0x19</span><span class="op" id="8249543">}</span><span class="op" id="8249544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249547">}</span><span class="op" id="8249548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249555">[</span><span class="op" id="8249556">]</span><span class="builtintype" id="8249557">byte</span><span class="op" id="8249561">{</span><span class="num" id="8249562">0x57</span><span class="op" id="8249566">,</span>&nbsp;<span class="num" id="8249568">0x69</span><span class="op" id="8249572">,</span>&nbsp;<span class="num" id="8249574">0x6b</span><span class="op" id="8249578">,</span>&nbsp;<span class="num" id="8249580">0x69</span><span class="op" id="8249584">}</span><span class="op" id="8249585">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249589">[</span><span class="op" id="8249590">]</span><span class="builtintype" id="8249591">byte</span><span class="op" id="8249595">{</span><span class="num" id="8249596">0x60</span><span class="op" id="8249600">,</span>&nbsp;<span class="num" id="8249602">0x44</span><span class="op" id="8249606">,</span>&nbsp;<span class="num" id="8249608">0xdb</span><span class="op" id="8249612">,</span>&nbsp;<span class="num" id="8249614">0x6d</span><span class="op" id="8249618">,</span>&nbsp;<span class="num" id="8249620">0x41</span><span class="op" id="8249624">,</span>&nbsp;<span class="num" id="8249626">0xb7</span><span class="op" id="8249630">}</span><span class="op" id="8249631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249634">}</span><span class="op" id="8249635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249642">[</span><span class="op" id="8249643">]</span><span class="builtintype" id="8249644">byte</span><span class="op" id="8249648">{</span><span class="num" id="8249649">0x00</span><span class="op" id="8249653">,</span>&nbsp;<span class="num" id="8249655">0x00</span><span class="op" id="8249659">,</span>&nbsp;<span class="num" id="8249661">0x00</span><span class="op" id="8249665">,</span>&nbsp;<span class="num" id="8249667">0x00</span><span class="op" id="8249671">,</span>&nbsp;<span class="num" id="8249673">0x00</span><span class="op" id="8249677">,</span>&nbsp;<span class="num" id="8249679">0x00</span><span class="op" id="8249683">,</span>&nbsp;<span class="num" id="8249685">0x00</span><span class="op" id="8249689">,</span>&nbsp;<span class="num" id="8249691">0x00</span><span class="op" id="8249695">}</span><span class="op" id="8249696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249700">[</span><span class="op" id="8249701">]</span><span class="builtintype" id="8249702">byte</span><span class="op" id="8249706">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8249711">0xde</span><span class="op" id="8249715">,</span>&nbsp;<span class="num" id="8249717">0x18</span><span class="op" id="8249721">,</span>&nbsp;<span class="num" id="8249723">0x89</span><span class="op" id="8249727">,</span>&nbsp;<span class="num" id="8249729">0x41</span><span class="op" id="8249733">,</span>&nbsp;<span class="num" id="8249735">0xa3</span><span class="op" id="8249739">,</span>&nbsp;<span class="num" id="8249741">0x37</span><span class="op" id="8249745">,</span>&nbsp;<span class="num" id="8249747">0x5d</span><span class="op" id="8249751">,</span>&nbsp;<span class="num" id="8249753">0x3a</span><span class="op" id="8249757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8249762">0x8a</span><span class="op" id="8249766">,</span>&nbsp;<span class="num" id="8249768">0x06</span><span class="op" id="8249772">,</span>&nbsp;<span class="num" id="8249774">0x1e</span><span class="op" id="8249778">,</span>&nbsp;<span class="num" id="8249780">0x67</span><span class="op" id="8249784">,</span>&nbsp;<span class="num" id="8249786">0x57</span><span class="op" id="8249790">,</span>&nbsp;<span class="num" id="8249792">0x6e</span><span class="op" id="8249796">,</span>&nbsp;<span class="num" id="8249798">0x92</span><span class="op" id="8249802">,</span>&nbsp;<span class="num" id="8249804">0x6d</span><span class="op" id="8249808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8249813">0xc7</span><span class="op" id="8249817">,</span>&nbsp;<span class="num" id="8249819">0x1a</span><span class="op" id="8249823">,</span>&nbsp;<span class="num" id="8249825">0x7f</span><span class="op" id="8249829">,</span>&nbsp;<span class="num" id="8249831">0xa3</span><span class="op" id="8249835">,</span>&nbsp;<span class="num" id="8249837">0xf0</span><span class="op" id="8249841">,</span>&nbsp;<span class="num" id="8249843">0xcc</span><span class="op" id="8249847">,</span>&nbsp;<span class="num" id="8249849">0xeb</span><span class="op" id="8249853">,</span>&nbsp;<span class="num" id="8249855">0x97</span><span class="op" id="8249859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8249864">0x45</span><span class="op" id="8249868">,</span>&nbsp;<span class="num" id="8249870">0x2b</span><span class="op" id="8249874">,</span>&nbsp;<span class="num" id="8249876">0x4d</span><span class="op" id="8249880">,</span>&nbsp;<span class="num" id="8249882">0x32</span><span class="op" id="8249886">,</span>&nbsp;<span class="num" id="8249888">0x27</span><span class="op" id="8249892">,</span>&nbsp;<span class="num" id="8249894">0x96</span><span class="op" id="8249898">,</span>&nbsp;<span class="num" id="8249900">0x5f</span><span class="op" id="8249904">,</span>&nbsp;<span class="num" id="8249906">0x9e</span><span class="op" id="8249910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8249915">0xa8</span><span class="op" id="8249919">,</span>&nbsp;<span class="num" id="8249921">0xcc</span><span class="op" id="8249925">,</span>&nbsp;<span class="num" id="8249927">0x75</span><span class="op" id="8249931">,</span>&nbsp;<span class="num" id="8249933">0x07</span><span class="op" id="8249937">,</span>&nbsp;<span class="num" id="8249939">0x6d</span><span class="op" id="8249943">,</span>&nbsp;<span class="num" id="8249945">0x9f</span><span class="op" id="8249949">,</span>&nbsp;<span class="num" id="8249951">0xb9</span><span class="op" id="8249955">,</span>&nbsp;<span class="num" id="8249957">0xc5</span><span class="op" id="8249961">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8249966">0x41</span><span class="op" id="8249970">,</span>&nbsp;<span class="num" id="8249972">0x7a</span><span class="op" id="8249976">,</span>&nbsp;<span class="num" id="8249978">0xa5</span><span class="op" id="8249982">,</span>&nbsp;<span class="num" id="8249984">0xcb</span><span class="op" id="8249988">,</span>&nbsp;<span class="num" id="8249990">0x30</span><span class="op" id="8249994">,</span>&nbsp;<span class="num" id="8249996">0xfc</span><span class="op" id="8250000">,</span>&nbsp;<span class="num" id="8250002">0x22</span><span class="op" id="8250006">,</span>&nbsp;<span class="num" id="8250008">0x19</span><span class="op" id="8250012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250017">0x8b</span><span class="op" id="8250021">,</span>&nbsp;<span class="num" id="8250023">0x34</span><span class="op" id="8250027">,</span>&nbsp;<span class="num" id="8250029">0x98</span><span class="op" id="8250033">,</span>&nbsp;<span class="num" id="8250035">0x2d</span><span class="op" id="8250039">,</span>&nbsp;<span class="num" id="8250041">0xbb</span><span class="op" id="8250045">,</span>&nbsp;<span class="num" id="8250047">0x62</span><span class="op" id="8250051">,</span>&nbsp;<span class="num" id="8250053">0x9e</span><span class="op" id="8250057">,</span>&nbsp;<span class="num" id="8250059">0xc0</span><span class="op" id="8250063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250068">0x4b</span><span class="op" id="8250072">,</span>&nbsp;<span class="num" id="8250074">0x4f</span><span class="op" id="8250078">,</span>&nbsp;<span class="num" id="8250080">0x8b</span><span class="op" id="8250084">,</span>&nbsp;<span class="num" id="8250086">0x05</span><span class="op" id="8250090">,</span>&nbsp;<span class="num" id="8250092">0xa0</span><span class="op" id="8250096">,</span>&nbsp;<span class="num" id="8250098">0x71</span><span class="op" id="8250102">,</span>&nbsp;<span class="num" id="8250104">0x08</span><span class="op" id="8250108">,</span>&nbsp;<span class="num" id="8250110">0x50</span><span class="op" id="8250114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250119">0x92</span><span class="op" id="8250123">,</span>&nbsp;<span class="num" id="8250125">0xa0</span><span class="op" id="8250129">,</span>&nbsp;<span class="num" id="8250131">0xc3</span><span class="op" id="8250135">,</span>&nbsp;<span class="num" id="8250137">0x58</span><span class="op" id="8250141">,</span>&nbsp;<span class="num" id="8250143">0x4a</span><span class="op" id="8250147">,</span>&nbsp;<span class="num" id="8250149">0x48</span><span class="op" id="8250153">,</span>&nbsp;<span class="num" id="8250155">0xe4</span><span class="op" id="8250159">,</span>&nbsp;<span class="num" id="8250161">0xa3</span><span class="op" id="8250165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250170">0x0a</span><span class="op" id="8250174">,</span>&nbsp;<span class="num" id="8250176">0x39</span><span class="op" id="8250180">,</span>&nbsp;<span class="num" id="8250182">0x7b</span><span class="op" id="8250186">,</span>&nbsp;<span class="num" id="8250188">0x8a</span><span class="op" id="8250192">,</span>&nbsp;<span class="num" id="8250194">0xcd</span><span class="op" id="8250198">,</span>&nbsp;<span class="num" id="8250200">0x1d</span><span class="op" id="8250204">,</span>&nbsp;<span class="num" id="8250206">0x00</span><span class="op" id="8250210">,</span>&nbsp;<span class="num" id="8250212">0x9e</span><span class="op" id="8250216">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250221">0xc8</span><span class="op" id="8250225">,</span>&nbsp;<span class="num" id="8250227">0x7d</span><span class="op" id="8250231">,</span>&nbsp;<span class="num" id="8250233">0x68</span><span class="op" id="8250237">,</span>&nbsp;<span class="num" id="8250239">0x11</span><span class="op" id="8250243">,</span>&nbsp;<span class="num" id="8250245">0xf2</span><span class="op" id="8250249">,</span>&nbsp;<span class="num" id="8250251">0x2c</span><span class="op" id="8250255">,</span>&nbsp;<span class="num" id="8250257">0xf4</span><span class="op" id="8250261">,</span>&nbsp;<span class="num" id="8250263">0x9c</span><span class="op" id="8250267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250272">0xa3</span><span class="op" id="8250276">,</span>&nbsp;<span class="num" id="8250278">0xe5</span><span class="op" id="8250282">,</span>&nbsp;<span class="num" id="8250284">0x93</span><span class="op" id="8250288">,</span>&nbsp;<span class="num" id="8250290">0x54</span><span class="op" id="8250294">,</span>&nbsp;<span class="num" id="8250296">0xb9</span><span class="op" id="8250300">,</span>&nbsp;<span class="num" id="8250302">0x45</span><span class="op" id="8250306">,</span>&nbsp;<span class="num" id="8250308">0x15</span><span class="op" id="8250312">,</span>&nbsp;<span class="num" id="8250314">0x35</span><span class="op" id="8250318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250323">0xa2</span><span class="op" id="8250327">,</span>&nbsp;<span class="num" id="8250329">0x18</span><span class="op" id="8250333">,</span>&nbsp;<span class="num" id="8250335">0x7a</span><span class="op" id="8250339">,</span>&nbsp;<span class="num" id="8250341">0x86</span><span class="op" id="8250345">,</span>&nbsp;<span class="num" id="8250347">0x42</span><span class="op" id="8250351">,</span>&nbsp;<span class="num" id="8250353">0x6c</span><span class="op" id="8250357">,</span>&nbsp;<span class="num" id="8250359">0xca</span><span class="op" id="8250363">,</span>&nbsp;<span class="num" id="8250365">0x7d</span><span class="op" id="8250369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250374">0x5e</span><span class="op" id="8250378">,</span>&nbsp;<span class="num" id="8250380">0x82</span><span class="op" id="8250384">,</span>&nbsp;<span class="num" id="8250386">0x3e</span><span class="op" id="8250390">,</span>&nbsp;<span class="num" id="8250392">0xba</span><span class="op" id="8250396">,</span>&nbsp;<span class="num" id="8250398">0x00</span><span class="op" id="8250402">,</span>&nbsp;<span class="num" id="8250404">0x44</span><span class="op" id="8250408">,</span>&nbsp;<span class="num" id="8250410">0x12</span><span class="op" id="8250414">,</span>&nbsp;<span class="num" id="8250416">0x67</span><span class="op" id="8250420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250425">0x12</span><span class="op" id="8250429">,</span>&nbsp;<span class="num" id="8250431">0x57</span><span class="op" id="8250435">,</span>&nbsp;<span class="num" id="8250437">0xb8</span><span class="op" id="8250441">,</span>&nbsp;<span class="num" id="8250443">0xd8</span><span class="op" id="8250447">,</span>&nbsp;<span class="num" id="8250449">0x60</span><span class="op" id="8250453">,</span>&nbsp;<span class="num" id="8250455">0xae</span><span class="op" id="8250459">,</span>&nbsp;<span class="num" id="8250461">0x4c</span><span class="op" id="8250465">,</span>&nbsp;<span class="num" id="8250467">0xbd</span><span class="op" id="8250471">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250476">0x4c</span><span class="op" id="8250480">,</span>&nbsp;<span class="num" id="8250482">0x49</span><span class="op" id="8250486">,</span>&nbsp;<span class="num" id="8250488">0x06</span><span class="op" id="8250492">,</span>&nbsp;<span class="num" id="8250494">0xbb</span><span class="op" id="8250498">,</span>&nbsp;<span class="num" id="8250500">0xc5</span><span class="op" id="8250504">,</span>&nbsp;<span class="num" id="8250506">0x35</span><span class="op" id="8250510">,</span>&nbsp;<span class="num" id="8250512">0xef</span><span class="op" id="8250516">,</span>&nbsp;<span class="num" id="8250518">0xe1</span><span class="op" id="8250522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250527">0x58</span><span class="op" id="8250531">,</span>&nbsp;<span class="num" id="8250533">0x7f</span><span class="op" id="8250537">,</span>&nbsp;<span class="num" id="8250539">0x08</span><span class="op" id="8250543">,</span>&nbsp;<span class="num" id="8250545">0xdb</span><span class="op" id="8250549">,</span>&nbsp;<span class="num" id="8250551">0x33</span><span class="op" id="8250555">,</span>&nbsp;<span class="num" id="8250557">0x95</span><span class="op" id="8250561">,</span>&nbsp;<span class="num" id="8250563">0x5c</span><span class="op" id="8250567">,</span>&nbsp;<span class="num" id="8250569">0xdb</span><span class="op" id="8250573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250578">0xcb</span><span class="op" id="8250582">,</span>&nbsp;<span class="num" id="8250584">0xad</span><span class="op" id="8250588">,</span>&nbsp;<span class="num" id="8250590">0x9b</span><span class="op" id="8250594">,</span>&nbsp;<span class="num" id="8250596">0x10</span><span class="op" id="8250600">,</span>&nbsp;<span class="num" id="8250602">0xf5</span><span class="op" id="8250606">,</span>&nbsp;<span class="num" id="8250608">0x3f</span><span class="op" id="8250612">,</span>&nbsp;<span class="num" id="8250614">0xc4</span><span class="op" id="8250618">,</span>&nbsp;<span class="num" id="8250620">0xe5</span><span class="op" id="8250624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250629">0x2c</span><span class="op" id="8250633">,</span>&nbsp;<span class="num" id="8250635">0x59</span><span class="op" id="8250639">,</span>&nbsp;<span class="num" id="8250641">0x15</span><span class="op" id="8250645">,</span>&nbsp;<span class="num" id="8250647">0x65</span><span class="op" id="8250651">,</span>&nbsp;<span class="num" id="8250653">0x51</span><span class="op" id="8250657">,</span>&nbsp;<span class="num" id="8250659">0x84</span><span class="op" id="8250663">,</span>&nbsp;<span class="num" id="8250665">0x87</span><span class="op" id="8250669">,</span>&nbsp;<span class="num" id="8250671">0xfe</span><span class="op" id="8250675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250680">0x08</span><span class="op" id="8250684">,</span>&nbsp;<span class="num" id="8250686">0x4d</span><span class="op" id="8250690">,</span>&nbsp;<span class="num" id="8250692">0x0e</span><span class="op" id="8250696">,</span>&nbsp;<span class="num" id="8250698">0x3f</span><span class="op" id="8250702">,</span>&nbsp;<span class="num" id="8250704">0x03</span><span class="op" id="8250708">,</span>&nbsp;<span class="num" id="8250710">0xde</span><span class="op" id="8250714">,</span>&nbsp;<span class="num" id="8250716">0xbc</span><span class="op" id="8250720">,</span>&nbsp;<span class="num" id="8250722">0xc9</span><span class="op" id="8250726">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250731">0xda</span><span class="op" id="8250735">,</span>&nbsp;<span class="num" id="8250737">0x1c</span><span class="op" id="8250741">,</span>&nbsp;<span class="num" id="8250743">0xe9</span><span class="op" id="8250747">,</span>&nbsp;<span class="num" id="8250749">0x0d</span><span class="op" id="8250753">,</span>&nbsp;<span class="num" id="8250755">0x08</span><span class="op" id="8250759">,</span>&nbsp;<span class="num" id="8250761">0x5c</span><span class="op" id="8250765">,</span>&nbsp;<span class="num" id="8250767">0x2d</span><span class="op" id="8250771">,</span>&nbsp;<span class="num" id="8250773">0x8a</span><span class="op" id="8250777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250782">0x19</span><span class="op" id="8250786">,</span>&nbsp;<span class="num" id="8250788">0xd8</span><span class="op" id="8250792">,</span>&nbsp;<span class="num" id="8250794">0x37</span><span class="op" id="8250798">,</span>&nbsp;<span class="num" id="8250800">0x30</span><span class="op" id="8250804">,</span>&nbsp;<span class="num" id="8250806">0x86</span><span class="op" id="8250810">,</span>&nbsp;<span class="num" id="8250812">0x16</span><span class="op" id="8250816">,</span>&nbsp;<span class="num" id="8250818">0x36</span><span class="op" id="8250822">,</span>&nbsp;<span class="num" id="8250824">0x92</span><span class="op" id="8250828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250833">0x14</span><span class="op" id="8250837">,</span>&nbsp;<span class="num" id="8250839">0x2b</span><span class="op" id="8250843">,</span>&nbsp;<span class="num" id="8250845">0xd8</span><span class="op" id="8250849">,</span>&nbsp;<span class="num" id="8250851">0xfc</span><span class="op" id="8250855">,</span>&nbsp;<span class="num" id="8250857">0x5d</span><span class="op" id="8250861">,</span>&nbsp;<span class="num" id="8250863">0x7a</span><span class="op" id="8250867">,</span>&nbsp;<span class="num" id="8250869">0x73</span><span class="op" id="8250873">,</span>&nbsp;<span class="num" id="8250875">0x49</span><span class="op" id="8250879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250884">0x6a</span><span class="op" id="8250888">,</span>&nbsp;<span class="num" id="8250890">0x8e</span><span class="op" id="8250894">,</span>&nbsp;<span class="num" id="8250896">0x59</span><span class="op" id="8250900">,</span>&nbsp;<span class="num" id="8250902">0xee</span><span class="op" id="8250906">,</span>&nbsp;<span class="num" id="8250908">0x7e</span><span class="op" id="8250912">,</span>&nbsp;<span class="num" id="8250914">0xcf</span><span class="op" id="8250918">,</span>&nbsp;<span class="num" id="8250920">0x6b</span><span class="op" id="8250924">,</span>&nbsp;<span class="num" id="8250926">0x94</span><span class="op" id="8250930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250935">0x06</span><span class="op" id="8250939">,</span>&nbsp;<span class="num" id="8250941">0x63</span><span class="op" id="8250945">,</span>&nbsp;<span class="num" id="8250947">0xf4</span><span class="op" id="8250951">,</span>&nbsp;<span class="num" id="8250953">0xa6</span><span class="op" id="8250957">,</span>&nbsp;<span class="num" id="8250959">0xbe</span><span class="op" id="8250963">,</span>&nbsp;<span class="num" id="8250965">0xe6</span><span class="op" id="8250969">,</span>&nbsp;<span class="num" id="8250971">0x5b</span><span class="op" id="8250975">,</span>&nbsp;<span class="num" id="8250977">0xd2</span><span class="op" id="8250981">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8250986">0xc8</span><span class="op" id="8250990">,</span>&nbsp;<span class="num" id="8250992">0x5c</span><span class="op" id="8250996">,</span>&nbsp;<span class="num" id="8250998">0x46</span><span class="op" id="8251002">,</span>&nbsp;<span class="num" id="8251004">0x98</span><span class="op" id="8251008">,</span>&nbsp;<span class="num" id="8251010">0x6c</span><span class="op" id="8251014">,</span>&nbsp;<span class="num" id="8251016">0x1b</span><span class="op" id="8251020">,</span>&nbsp;<span class="num" id="8251022">0xef</span><span class="op" id="8251026">,</span>&nbsp;<span class="num" id="8251028">0x34</span><span class="op" id="8251032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8251037">0x90</span><span class="op" id="8251041">,</span>&nbsp;<span class="num" id="8251043">0xd3</span><span class="op" id="8251047">,</span>&nbsp;<span class="num" id="8251049">0x7b</span><span class="op" id="8251053">,</span>&nbsp;<span class="num" id="8251055">0x38</span><span class="op" id="8251059">,</span>&nbsp;<span class="num" id="8251061">0xda</span><span class="op" id="8251065">,</span>&nbsp;<span class="num" id="8251067">0x85</span><span class="op" id="8251071">,</span>&nbsp;<span class="num" id="8251073">0xd3</span><span class="op" id="8251077">,</span>&nbsp;<span class="num" id="8251079">0x2e</span><span class="op" id="8251083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8251088">0x97</span><span class="op" id="8251092">,</span>&nbsp;<span class="num" id="8251094">0x39</span><span class="op" id="8251098">,</span>&nbsp;<span class="num" id="8251100">0xcb</span><span class="op" id="8251104">,</span>&nbsp;<span class="num" id="8251106">0x23</span><span class="op" id="8251110">,</span>&nbsp;<span class="num" id="8251112">0x4a</span><span class="op" id="8251116">,</span>&nbsp;<span class="num" id="8251118">0x2b</span><span class="op" id="8251122">,</span>&nbsp;<span class="num" id="8251124">0xe7</span><span class="op" id="8251128">,</span>&nbsp;<span class="num" id="8251130">0x40</span><span class="op" id="8251134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251138">}</span><span class="op" id="8251139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251142">}</span><span class="op" id="8251143">,</span><br>
<span class="lineno">75</span><span class="op" id="8251145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8251148">func</span>&nbsp;<span class="ident" id="8251153">testEncrypt</span><span class="op" id="8251164">(</span><span class="ident" id="8251165">t</span>&nbsp;<span class="op" id="8251167">*</span><span class="ident" id="8251168">testing</span><span class="op" id="8251175">.</span><span class="ident" id="8251176">T</span><span class="op" id="8251177">,</span>&nbsp;<span class="ident" id="8251179">desc</span>&nbsp;<span class="builtintype" id="8251184">string</span><span class="op" id="8251190">,</span>&nbsp;<span class="ident" id="8251192">c</span>&nbsp;<span class="op" id="8251194">*</span><span class="ident" id="8251195">Cipher</span><span class="op" id="8251201">,</span>&nbsp;<span class="ident" id="8251203">src</span><span class="op" id="8251206">,</span>&nbsp;<span class="ident" id="8251208">expect</span>&nbsp;<span class="op" id="8251215">[</span><span class="op" id="8251216">]</span><span class="builtintype" id="8251217">byte</span><span class="op" id="8251221">)</span>&nbsp;<span class="op" id="8251223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251226">dst</span>&nbsp;<span class="op" id="8251230">:=</span>&nbsp;<span class="builtinfunc" id="8251233">make</span><span class="op" id="8251237">(</span><span class="op" id="8251238">[</span><span class="op" id="8251239">]</span><span class="builtintype" id="8251240">byte</span><span class="op" id="8251244">,</span>&nbsp;<span class="builtinfunc" id="8251246">len</span><span class="op" id="8251249">(</span><span class="ident" id="8251250">src</span><span class="op" id="8251253">)</span><span class="op" id="8251254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251257">c</span><span class="op" id="8251258">.</span><span class="ident" id="8251259">XORKeyStream</span><span class="op" id="8251271">(</span><span class="ident" id="8251272">dst</span><span class="op" id="8251275">,</span>&nbsp;<span class="ident" id="8251277">src</span><span class="op" id="8251280">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251283">for</span>&nbsp;<span class="ident" id="8251287">i</span><span class="op" id="8251288">,</span>&nbsp;<span class="ident" id="8251290">v</span>&nbsp;<span class="op" id="8251292">:=</span>&nbsp;<span class="keyword" id="8251295">range</span>&nbsp;<span class="ident" id="8251301">dst</span>&nbsp;<span class="op" id="8251305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251309">if</span>&nbsp;<span class="ident" id="8251312">v</span>&nbsp;<span class="op" id="8251314">!=</span>&nbsp;<span class="ident" id="8251317">expect</span><span class="op" id="8251323">[</span><span class="ident" id="8251324">i</span><span class="op" id="8251325">]</span>&nbsp;<span class="op" id="8251327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251332">t</span><span class="op" id="8251333">.</span><span class="ident" id="8251334">Fatalf</span><span class="op" id="8251340">(</span><span class="string" id="8251341">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="8251385">,</span>&nbsp;<span class="ident" id="8251387">desc</span><span class="op" id="8251391">,</span>&nbsp;<span class="ident" id="8251393">i</span><span class="op" id="8251394">,</span>&nbsp;<span class="ident" id="8251396">dst</span><span class="op" id="8251399">,</span>&nbsp;<span class="ident" id="8251401">expect</span><span class="op" id="8251407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251414">}</span><br>
<span class="lineno">85</span><span class="op" id="8251416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8251419">func</span>&nbsp;<span class="ident" id="8251424">TestGolden</span><span class="op" id="8251434">(</span><span class="ident" id="8251435">t</span>&nbsp;<span class="op" id="8251437">*</span><span class="ident" id="8251438">testing</span><span class="op" id="8251445">.</span><span class="ident" id="8251446">T</span><span class="op" id="8251447">)</span>&nbsp;<span class="op" id="8251449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251452">for</span>&nbsp;<span class="ident" id="8251456">gi</span><span class="op" id="8251458">,</span>&nbsp;<span class="ident" id="8251460">g</span>&nbsp;<span class="op" id="8251462">:=</span>&nbsp;<span class="keyword" id="8251465">range</span>&nbsp;<span class="ident" id="8251471">golden</span>&nbsp;<span class="op" id="8251478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251482">data</span>&nbsp;<span class="op" id="8251487">:=</span>&nbsp;<span class="builtinfunc" id="8251490">make</span><span class="op" id="8251494">(</span><span class="op" id="8251495">[</span><span class="op" id="8251496">]</span><span class="builtintype" id="8251497">byte</span><span class="op" id="8251501">,</span>&nbsp;<span class="builtinfunc" id="8251503">len</span><span class="op" id="8251506">(</span><span class="ident" id="8251507">g</span><span class="op" id="8251508">.</span><span class="ident" id="8251509">keystream</span><span class="op" id="8251518">)</span><span class="op" id="8251519">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251523">for</span>&nbsp;<span class="ident" id="8251527">i</span>&nbsp;<span class="op" id="8251529">:=</span>&nbsp;<span class="keyword" id="8251532">range</span>&nbsp;<span class="ident" id="8251538">data</span>&nbsp;<span class="op" id="8251543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251548">data</span><span class="op" id="8251552">[</span><span class="ident" id="8251553">i</span><span class="op" id="8251554">]</span>&nbsp;<span class="op" id="8251556">=</span>&nbsp;<span class="builtintype" id="8251558">byte</span><span class="op" id="8251562">(</span><span class="ident" id="8251563">i</span><span class="op" id="8251564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251573">expect</span>&nbsp;<span class="op" id="8251580">:=</span>&nbsp;<span class="builtinfunc" id="8251583">make</span><span class="op" id="8251587">(</span><span class="op" id="8251588">[</span><span class="op" id="8251589">]</span><span class="builtintype" id="8251590">byte</span><span class="op" id="8251594">,</span>&nbsp;<span class="builtinfunc" id="8251596">len</span><span class="op" id="8251599">(</span><span class="ident" id="8251600">g</span><span class="op" id="8251601">.</span><span class="ident" id="8251602">keystream</span><span class="op" id="8251611">)</span><span class="op" id="8251612">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251616">for</span>&nbsp;<span class="ident" id="8251620">i</span>&nbsp;<span class="op" id="8251622">:=</span>&nbsp;<span class="keyword" id="8251625">range</span>&nbsp;<span class="ident" id="8251631">expect</span>&nbsp;<span class="op" id="8251638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251643">expect</span><span class="op" id="8251649">[</span><span class="ident" id="8251650">i</span><span class="op" id="8251651">]</span>&nbsp;<span class="op" id="8251653">=</span>&nbsp;<span class="builtintype" id="8251655">byte</span><span class="op" id="8251659">(</span><span class="ident" id="8251660">i</span><span class="op" id="8251661">)</span>&nbsp;<span class="op" id="8251663">^</span>&nbsp;<span class="ident" id="8251665">g</span><span class="op" id="8251666">.</span><span class="ident" id="8251667">keystream</span><span class="op" id="8251676">[</span><span class="ident" id="8251677">i</span><span class="op" id="8251678">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251687">for</span>&nbsp;<span class="ident" id="8251691">size</span>&nbsp;<span class="op" id="8251696">:=</span>&nbsp;<span class="num" id="8251699">1</span><span class="op" id="8251700">;</span>&nbsp;<span class="ident" id="8251702">size</span>&nbsp;<span class="op" id="8251707">&lt;=</span>&nbsp;<span class="builtinfunc" id="8251710">len</span><span class="op" id="8251713">(</span><span class="ident" id="8251714">g</span><span class="op" id="8251715">.</span><span class="ident" id="8251716">keystream</span><span class="op" id="8251725">)</span><span class="op" id="8251726">;</span>&nbsp;<span class="ident" id="8251728">size</span><span class="op" id="8251732">++</span>&nbsp;<span class="op" id="8251735">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251740">c</span><span class="op" id="8251741">,</span>&nbsp;<span class="ident" id="8251743">err</span>&nbsp;<span class="op" id="8251747">:=</span>&nbsp;<span class="ident" id="8251750">NewCipher</span><span class="op" id="8251759">(</span><span class="ident" id="8251760">g</span><span class="op" id="8251761">.</span><span class="ident" id="8251762">key</span><span class="op" id="8251765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251770">if</span>&nbsp;<span class="ident" id="8251773">err</span>&nbsp;<span class="op" id="8251777">!=</span>&nbsp;<span class="ident" id="8251780">nil</span>&nbsp;<span class="op" id="8251784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251790">t</span><span class="op" id="8251791">.</span><span class="ident" id="8251792">Fatalf</span><span class="op" id="8251798">(</span><span class="string" id="8251799">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="8251819">,</span>&nbsp;<span class="ident" id="8251821">gi</span><span class="op" id="8251823">,</span>&nbsp;<span class="ident" id="8251825">err</span><span class="op" id="8251828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251839">off</span>&nbsp;<span class="op" id="8251843">:=</span>&nbsp;<span class="num" id="8251846">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251851">for</span>&nbsp;<span class="ident" id="8251855">off</span>&nbsp;<span class="op" id="8251859">&lt;</span>&nbsp;<span class="builtinfunc" id="8251861">len</span><span class="op" id="8251864">(</span><span class="ident" id="8251865">g</span><span class="op" id="8251866">.</span><span class="ident" id="8251867">keystream</span><span class="op" id="8251876">)</span>&nbsp;<span class="op" id="8251878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251884">n</span>&nbsp;<span class="op" id="8251886">:=</span>&nbsp;<span class="builtinfunc" id="8251889">len</span><span class="op" id="8251892">(</span><span class="ident" id="8251893">g</span><span class="op" id="8251894">.</span><span class="ident" id="8251895">keystream</span><span class="op" id="8251904">)</span>&nbsp;<span class="op" id="8251906">-</span>&nbsp;<span class="ident" id="8251908">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251916">if</span>&nbsp;<span class="ident" id="8251919">n</span>&nbsp;<span class="op" id="8251921">&gt;</span>&nbsp;<span class="ident" id="8251923">size</span>&nbsp;<span class="op" id="8251928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251935">n</span>&nbsp;<span class="op" id="8251937">=</span>&nbsp;<span class="ident" id="8251939">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251954">desc</span>&nbsp;<span class="op" id="8251959">:=</span>&nbsp;<span class="ident" id="8251962">fmt</span><span class="op" id="8251965">.</span><span class="ident" id="8251966">Sprintf</span><span class="op" id="8251973">(</span><span class="string" id="8251974">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="8251987">,</span>&nbsp;<span class="ident" id="8251989">gi</span><span class="op" id="8251991">,</span>&nbsp;<span class="ident" id="8251993">off</span><span class="op" id="8251996">,</span>&nbsp;<span class="ident" id="8251998">off</span><span class="op" id="8252001">+</span><span class="ident" id="8252002">n</span><span class="op" id="8252003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252009">testEncrypt</span><span class="op" id="8252020">(</span><span class="ident" id="8252021">t</span><span class="op" id="8252022">,</span>&nbsp;<span class="ident" id="8252024">desc</span><span class="op" id="8252028">,</span>&nbsp;<span class="ident" id="8252030">c</span><span class="op" id="8252031">,</span>&nbsp;<span class="ident" id="8252033">data</span><span class="op" id="8252037">[</span><span class="ident" id="8252038">off</span><span class="op" id="8252041">:</span><span class="ident" id="8252042">off</span><span class="op" id="8252045">+</span><span class="ident" id="8252046">n</span><span class="op" id="8252047">]</span><span class="op" id="8252048">,</span>&nbsp;<span class="ident" id="8252050">expect</span><span class="op" id="8252056">[</span><span class="ident" id="8252057">off</span><span class="op" id="8252060">:</span><span class="ident" id="8252061">off</span><span class="op" id="8252064">+</span><span class="ident" id="8252065">n</span><span class="op" id="8252066">]</span><span class="op" id="8252067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252073">off</span>&nbsp;<span class="op" id="8252077">+=</span>&nbsp;<span class="ident" id="8252080">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252085">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252092">}</span><br>
<span class="lineno"></span><span class="op" id="8252094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8252097">func</span>&nbsp;<span class="ident" id="8252102">TestBlock</span><span class="op" id="8252111">(</span><span class="ident" id="8252112">t</span>&nbsp;<span class="op" id="8252114">*</span><span class="ident" id="8252115">testing</span><span class="op" id="8252122">.</span><span class="ident" id="8252123">T</span><span class="op" id="8252124">)</span>&nbsp;<span class="op" id="8252126">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252129">testBlock</span><span class="op" id="8252138">(</span><span class="ident" id="8252139">t</span><span class="op" id="8252140">,</span>&nbsp;<span class="op" id="8252142">(</span><span class="op" id="8252143">*</span><span class="ident" id="8252144">Cipher</span><span class="op" id="8252150">)</span><span class="op" id="8252151">.</span><span class="ident" id="8252152">XORKeyStream</span><span class="op" id="8252164">)</span><br>
<span class="lineno"></span><span class="op" id="8252166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8252169">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="8252198">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="8252265">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="8252309">func</span>&nbsp;<span class="ident" id="8252314">TestBlockGeneric</span><span class="op" id="8252330">(</span><span class="ident" id="8252331">t</span>&nbsp;<span class="op" id="8252333">*</span><span class="ident" id="8252334">testing</span><span class="op" id="8252341">.</span><span class="ident" id="8252342">T</span><span class="op" id="8252343">)</span>&nbsp;<span class="op" id="8252345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252348">testBlock</span><span class="op" id="8252357">(</span><span class="ident" id="8252358">t</span><span class="op" id="8252359">,</span>&nbsp;<span class="op" id="8252361">(</span><span class="op" id="8252362">*</span><span class="ident" id="8252363">Cipher</span><span class="op" id="8252369">)</span><span class="op" id="8252370">.</span><span class="ident" id="8252371">xorKeyStreamGeneric</span><span class="op" id="8252390">)</span><br>
<span class="lineno"></span><span class="op" id="8252392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="8252395">func</span>&nbsp;<span class="ident" id="8252400">testBlock</span><span class="op" id="8252409">(</span><span class="ident" id="8252410">t</span>&nbsp;<span class="op" id="8252412">*</span><span class="ident" id="8252413">testing</span><span class="op" id="8252420">.</span><span class="ident" id="8252421">T</span><span class="op" id="8252422">,</span>&nbsp;<span class="ident" id="8252424">xor</span>&nbsp;<span class="keyword" id="8252428">func</span><span class="op" id="8252432">(</span><span class="ident" id="8252433">c</span>&nbsp;<span class="op" id="8252435">*</span><span class="ident" id="8252436">Cipher</span><span class="op" id="8252442">,</span>&nbsp;<span class="ident" id="8252444">dst</span><span class="op" id="8252447">,</span>&nbsp;<span class="ident" id="8252449">src</span>&nbsp;<span class="op" id="8252453">[</span><span class="op" id="8252454">]</span><span class="builtintype" id="8252455">byte</span><span class="op" id="8252459">)</span><span class="op" id="8252460">)</span>&nbsp;<span class="op" id="8252462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252465">c1a</span><span class="op" id="8252468">,</span>&nbsp;<span class="ident" id="8252470">_</span>&nbsp;<span class="op" id="8252472">:=</span>&nbsp;<span class="ident" id="8252475">NewCipher</span><span class="op" id="8252484">(</span><span class="ident" id="8252485">golden</span><span class="op" id="8252491">[</span><span class="num" id="8252492">0</span><span class="op" id="8252493">]</span><span class="op" id="8252494">.</span><span class="ident" id="8252495">key</span><span class="op" id="8252498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252501">c1b</span><span class="op" id="8252504">,</span>&nbsp;<span class="ident" id="8252506">_</span>&nbsp;<span class="op" id="8252508">:=</span>&nbsp;<span class="ident" id="8252511">NewCipher</span><span class="op" id="8252520">(</span><span class="ident" id="8252521">golden</span><span class="op" id="8252527">[</span><span class="num" id="8252528">1</span><span class="op" id="8252529">]</span><span class="op" id="8252530">.</span><span class="ident" id="8252531">key</span><span class="op" id="8252534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252537">data1</span>&nbsp;<span class="op" id="8252543">:=</span>&nbsp;<span class="builtinfunc" id="8252546">make</span><span class="op" id="8252550">(</span><span class="op" id="8252551">[</span><span class="op" id="8252552">]</span><span class="builtintype" id="8252553">byte</span><span class="op" id="8252557">,</span>&nbsp;<span class="num" id="8252559">1</span><span class="op" id="8252560">&lt;&lt;</span><span class="num" id="8252562">20</span><span class="op" id="8252564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252567">for</span>&nbsp;<span class="ident" id="8252571">i</span>&nbsp;<span class="op" id="8252573">:=</span>&nbsp;<span class="keyword" id="8252576">range</span>&nbsp;<span class="ident" id="8252582">data1</span>&nbsp;<span class="op" id="8252588">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252592">xor</span><span class="op" id="8252595">(</span><span class="ident" id="8252596">c1a</span><span class="op" id="8252599">,</span>&nbsp;<span class="ident" id="8252601">data1</span><span class="op" id="8252606">[</span><span class="ident" id="8252607">i</span><span class="op" id="8252608">:</span><span class="ident" id="8252609">i</span><span class="op" id="8252610">+</span><span class="num" id="8252611">1</span><span class="op" id="8252612">]</span><span class="op" id="8252613">,</span>&nbsp;<span class="ident" id="8252615">data1</span><span class="op" id="8252620">[</span><span class="ident" id="8252621">i</span><span class="op" id="8252622">:</span><span class="ident" id="8252623">i</span><span class="op" id="8252624">+</span><span class="num" id="8252625">1</span><span class="op" id="8252626">]</span><span class="op" id="8252627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252631">xor</span><span class="op" id="8252634">(</span><span class="ident" id="8252635">c1b</span><span class="op" id="8252638">,</span>&nbsp;<span class="ident" id="8252640">data1</span><span class="op" id="8252645">[</span><span class="ident" id="8252646">i</span><span class="op" id="8252647">:</span><span class="ident" id="8252648">i</span><span class="op" id="8252649">+</span><span class="num" id="8252650">1</span><span class="op" id="8252651">]</span><span class="op" id="8252652">,</span>&nbsp;<span class="ident" id="8252654">data1</span><span class="op" id="8252659">[</span><span class="ident" id="8252660">i</span><span class="op" id="8252661">:</span><span class="ident" id="8252662">i</span><span class="op" id="8252663">+</span><span class="num" id="8252664">1</span><span class="op" id="8252665">]</span><span class="op" id="8252666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252673">c2a</span><span class="op" id="8252676">,</span>&nbsp;<span class="ident" id="8252678">_</span>&nbsp;<span class="op" id="8252680">:=</span>&nbsp;<span class="ident" id="8252683">NewCipher</span><span class="op" id="8252692">(</span><span class="ident" id="8252693">golden</span><span class="op" id="8252699">[</span><span class="num" id="8252700">0</span><span class="op" id="8252701">]</span><span class="op" id="8252702">.</span><span class="ident" id="8252703">key</span><span class="op" id="8252706">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252709">c2b</span><span class="op" id="8252712">,</span>&nbsp;<span class="ident" id="8252714">_</span>&nbsp;<span class="op" id="8252716">:=</span>&nbsp;<span class="ident" id="8252719">NewCipher</span><span class="op" id="8252728">(</span><span class="ident" id="8252729">golden</span><span class="op" id="8252735">[</span><span class="num" id="8252736">1</span><span class="op" id="8252737">]</span><span class="op" id="8252738">.</span><span class="ident" id="8252739">key</span><span class="op" id="8252742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252745">data2</span>&nbsp;<span class="op" id="8252751">:=</span>&nbsp;<span class="builtinfunc" id="8252754">make</span><span class="op" id="8252758">(</span><span class="op" id="8252759">[</span><span class="op" id="8252760">]</span><span class="builtintype" id="8252761">byte</span><span class="op" id="8252765">,</span>&nbsp;<span class="num" id="8252767">1</span><span class="op" id="8252768">&lt;&lt;</span><span class="num" id="8252770">20</span><span class="op" id="8252772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252775">xor</span><span class="op" id="8252778">(</span><span class="ident" id="8252779">c2a</span><span class="op" id="8252782">,</span>&nbsp;<span class="ident" id="8252784">data2</span><span class="op" id="8252789">,</span>&nbsp;<span class="ident" id="8252791">data2</span><span class="op" id="8252796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252799">xor</span><span class="op" id="8252802">(</span><span class="ident" id="8252803">c2b</span><span class="op" id="8252806">,</span>&nbsp;<span class="ident" id="8252808">data2</span><span class="op" id="8252813">,</span>&nbsp;<span class="ident" id="8252815">data2</span><span class="op" id="8252820">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252824">if</span>&nbsp;<span class="op" id="8252827">!</span><span class="ident" id="8252828">bytes</span><span class="op" id="8252833">.</span><span class="ident" id="8252834">Equal</span><span class="op" id="8252839">(</span><span class="ident" id="8252840">data1</span><span class="op" id="8252845">,</span>&nbsp;<span class="ident" id="8252847">data2</span><span class="op" id="8252852">)</span>&nbsp;<span class="op" id="8252854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252858">t</span><span class="op" id="8252859">.</span><span class="ident" id="8252860">Fatalf</span><span class="op" id="8252866">(</span><span class="string" id="8252867">&#34;bad&nbsp;block&#34;</span><span class="op" id="8252878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252881">}</span><br>
<span class="lineno"></span><span class="op" id="8252883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="8252886">func</span>&nbsp;<span class="ident" id="8252891">benchmark</span><span class="op" id="8252900">(</span><span class="ident" id="8252901">b</span>&nbsp;<span class="op" id="8252903">*</span><span class="ident" id="8252904">testing</span><span class="op" id="8252911">.</span><span class="ident" id="8252912">B</span><span class="op" id="8252913">,</span>&nbsp;<span class="ident" id="8252915">size</span>&nbsp;<span class="ident" id="8252920">int64</span><span class="op" id="8252925">)</span>&nbsp;<span class="op" id="8252927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252930">buf</span>&nbsp;<span class="op" id="8252934">:=</span>&nbsp;<span class="builtinfunc" id="8252937">make</span><span class="op" id="8252941">(</span><span class="op" id="8252942">[</span><span class="op" id="8252943">]</span><span class="builtintype" id="8252944">byte</span><span class="op" id="8252948">,</span>&nbsp;<span class="ident" id="8252950">size</span><span class="op" id="8252954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252957">c</span><span class="op" id="8252958">,</span>&nbsp;<span class="ident" id="8252960">err</span>&nbsp;<span class="op" id="8252964">:=</span>&nbsp;<span class="ident" id="8252967">NewCipher</span><span class="op" id="8252976">(</span><span class="ident" id="8252977">golden</span><span class="op" id="8252983">[</span><span class="num" id="8252984">0</span><span class="op" id="8252985">]</span><span class="op" id="8252986">.</span><span class="ident" id="8252987">key</span><span class="op" id="8252990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252993">if</span>&nbsp;<span class="ident" id="8252996">err</span>&nbsp;<span class="op" id="8253000">!=</span>&nbsp;<span class="ident" id="8253003">nil</span>&nbsp;<span class="op" id="8253007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8253011">panic</span><span class="op" id="8253016">(</span><span class="ident" id="8253017">err</span><span class="op" id="8253020">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8253023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253026">b</span><span class="op" id="8253027">.</span><span class="ident" id="8253028">SetBytes</span><span class="op" id="8253036">(</span><span class="ident" id="8253037">size</span><span class="op" id="8253041">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8253045">for</span>&nbsp;<span class="ident" id="8253049">i</span>&nbsp;<span class="op" id="8253051">:=</span>&nbsp;<span class="num" id="8253054">0</span><span class="op" id="8253055">;</span>&nbsp;<span class="ident" id="8253057">i</span>&nbsp;<span class="op" id="8253059">&lt;</span>&nbsp;<span class="ident" id="8253061">b</span><span class="op" id="8253062">.</span><span class="ident" id="8253063">N</span><span class="op" id="8253064">;</span>&nbsp;<span class="ident" id="8253066">i</span><span class="op" id="8253067">++</span>&nbsp;<span class="op" id="8253070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253074">c</span><span class="op" id="8253075">.</span><span class="ident" id="8253076">XORKeyStream</span><span class="op" id="8253088">(</span><span class="ident" id="8253089">buf</span><span class="op" id="8253092">,</span>&nbsp;<span class="ident" id="8253094">buf</span><span class="op" id="8253097">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8253100">}</span><br>
<span class="lineno"></span><span class="op" id="8253102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8253105">func</span>&nbsp;<span class="ident" id="8253110">BenchmarkRC4_128</span><span class="op" id="8253126">(</span><span class="ident" id="8253127">b</span>&nbsp;<span class="op" id="8253129">*</span><span class="ident" id="8253130">testing</span><span class="op" id="8253137">.</span><span class="ident" id="8253138">B</span><span class="op" id="8253139">)</span>&nbsp;<span class="op" id="8253141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253144">benchmark</span><span class="op" id="8253153">(</span><span class="ident" id="8253154">b</span><span class="op" id="8253155">,</span>&nbsp;<span class="num" id="8253157">128</span><span class="op" id="8253160">)</span><br>
<span class="lineno">165</span><span class="op" id="8253162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8253165">func</span>&nbsp;<span class="ident" id="8253170">BenchmarkRC4_1K</span><span class="op" id="8253185">(</span><span class="ident" id="8253186">b</span>&nbsp;<span class="op" id="8253188">*</span><span class="ident" id="8253189">testing</span><span class="op" id="8253196">.</span><span class="ident" id="8253197">B</span><span class="op" id="8253198">)</span>&nbsp;<span class="op" id="8253200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253203">benchmark</span><span class="op" id="8253212">(</span><span class="ident" id="8253213">b</span><span class="op" id="8253214">,</span>&nbsp;<span class="num" id="8253216">1024</span><span class="op" id="8253220">)</span><br>
<span class="lineno"></span><span class="op" id="8253222">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8253225">func</span>&nbsp;<span class="ident" id="8253230">BenchmarkRC4_8K</span><span class="op" id="8253245">(</span><span class="ident" id="8253246">b</span>&nbsp;<span class="op" id="8253248">*</span><span class="ident" id="8253249">testing</span><span class="op" id="8253256">.</span><span class="ident" id="8253257">B</span><span class="op" id="8253258">)</span>&nbsp;<span class="op" id="8253260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253263">benchmark</span><span class="op" id="8253272">(</span><span class="ident" id="8253273">b</span><span class="op" id="8253274">,</span>&nbsp;<span class="num" id="8253276">8096</span><span class="op" id="8253280">)</span><br>
<span class="lineno"></span><span class="op" id="8253282">}</span>
</div>
</body>
</html>
