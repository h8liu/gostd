<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html" class="current">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3844153">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3844209">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3844263">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3844314">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3844387">package</span>&nbsp;<span class="ident" id="3844395">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3844400">import</span>&nbsp;<span class="op" id="3844407">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3844410">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3844416">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3844426">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3844429">//&nbsp;Boolean&nbsp;to&nbsp;int.</span><br>
<span class="lineno">15</span><span class="keyword" id="3844448">func</span>&nbsp;<span class="ident" id="3844453">boolint</span><span class="op" id="3844460">(</span><span class="ident" id="3844461">b</span>&nbsp;<span class="builtintype" id="3844463">bool</span><span class="op" id="3844467">)</span>&nbsp;<span class="builtintype" id="3844469">int</span>&nbsp;<span class="op" id="3844473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844476">if</span>&nbsp;<span class="ident" id="3844479">b</span>&nbsp;<span class="op" id="3844481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844485">return</span>&nbsp;<span class="num" id="3844492">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844498">return</span>&nbsp;<span class="num" id="3844505">0</span><br>
<span class="lineno">20</span><span class="op" id="3844507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3844510">func</span>&nbsp;<span class="ident" id="3844515">ipv4AddrToInterface</span><span class="op" id="3844534">(</span><span class="ident" id="3844535">ip</span>&nbsp;<span class="ident" id="3844538">IP</span><span class="op" id="3844540">)</span>&nbsp;<span class="op" id="3844542">(</span><span class="op" id="3844543">*</span><span class="ident" id="3844544">Interface</span><span class="op" id="3844553">,</span>&nbsp;<span class="builtintype" id="3844555">error</span><span class="op" id="3844560">)</span>&nbsp;<span class="op" id="3844562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844565">ift</span><span class="op" id="3844568">,</span>&nbsp;<span class="ident" id="3844570">err</span>&nbsp;<span class="op" id="3844574">:=</span>&nbsp;<span class="ident" id="3844577">Interfaces</span><span class="op" id="3844587">(</span><span class="op" id="3844588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844591">if</span>&nbsp;<span class="ident" id="3844594">err</span>&nbsp;<span class="op" id="3844598">!=</span>&nbsp;<span class="builtintype" id="3844601">nil</span>&nbsp;<span class="op" id="3844605">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844609">return</span>&nbsp;<span class="builtintype" id="3844616">nil</span><span class="op" id="3844619">,</span>&nbsp;<span class="ident" id="3844621">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844629">for</span>&nbsp;<span class="ident" id="3844633">_</span><span class="op" id="3844634">,</span>&nbsp;<span class="ident" id="3844636">ifi</span>&nbsp;<span class="op" id="3844640">:=</span>&nbsp;<span class="keyword" id="3844643">range</span>&nbsp;<span class="ident" id="3844649">ift</span>&nbsp;<span class="op" id="3844653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844657">ifat</span><span class="op" id="3844661">,</span>&nbsp;<span class="ident" id="3844663">err</span>&nbsp;<span class="op" id="3844667">:=</span>&nbsp;<span class="ident" id="3844670">ifi</span><span class="op" id="3844673">.</span><span class="ident" id="3844674">Addrs</span><span class="op" id="3844679">(</span><span class="op" id="3844680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844684">if</span>&nbsp;<span class="ident" id="3844687">err</span>&nbsp;<span class="op" id="3844691">!=</span>&nbsp;<span class="builtintype" id="3844694">nil</span>&nbsp;<span class="op" id="3844698">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844703">return</span>&nbsp;<span class="builtintype" id="3844710">nil</span><span class="op" id="3844713">,</span>&nbsp;<span class="ident" id="3844715">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844725">for</span>&nbsp;<span class="ident" id="3844729">_</span><span class="op" id="3844730">,</span>&nbsp;<span class="ident" id="3844732">ifa</span>&nbsp;<span class="op" id="3844736">:=</span>&nbsp;<span class="keyword" id="3844739">range</span>&nbsp;<span class="ident" id="3844745">ifat</span>&nbsp;<span class="op" id="3844750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844755">switch</span>&nbsp;<span class="ident" id="3844762">v</span>&nbsp;<span class="op" id="3844764">:=</span>&nbsp;<span class="ident" id="3844767">ifa</span><span class="op" id="3844770">.</span><span class="op" id="3844771">(</span><span class="keyword" id="3844772">type</span><span class="op" id="3844776">)</span>&nbsp;<span class="op" id="3844778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844783">case</span>&nbsp;<span class="op" id="3844788">*</span><span class="ident" id="3844789">IPAddr</span><span class="op" id="3844795">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844801">if</span>&nbsp;<span class="ident" id="3844804">ip</span><span class="op" id="3844806">.</span><span class="ident" id="3844807">Equal</span><span class="op" id="3844812">(</span><span class="ident" id="3844813">v</span><span class="op" id="3844814">.</span><span class="ident" id="3844815">IP</span><span class="op" id="3844817">)</span>&nbsp;<span class="op" id="3844819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844826">return</span>&nbsp;<span class="op" id="3844833">&amp;</span><span class="ident" id="3844834">ifi</span><span class="op" id="3844837">,</span>&nbsp;<span class="builtintype" id="3844839">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844852">case</span>&nbsp;<span class="op" id="3844857">*</span><span class="ident" id="3844858">IPNet</span><span class="op" id="3844863">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844869">if</span>&nbsp;<span class="ident" id="3844872">ip</span><span class="op" id="3844874">.</span><span class="ident" id="3844875">Equal</span><span class="op" id="3844880">(</span><span class="ident" id="3844881">v</span><span class="op" id="3844882">.</span><span class="ident" id="3844883">IP</span><span class="op" id="3844885">)</span>&nbsp;<span class="op" id="3844887">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844894">return</span>&nbsp;<span class="op" id="3844901">&amp;</span><span class="ident" id="3844902">ifi</span><span class="op" id="3844905">,</span>&nbsp;<span class="builtintype" id="3844907">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844927">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844930">if</span>&nbsp;<span class="ident" id="3844933">ip</span><span class="op" id="3844935">.</span><span class="ident" id="3844936">Equal</span><span class="op" id="3844941">(</span><span class="ident" id="3844942">IPv4zero</span><span class="op" id="3844950">)</span>&nbsp;<span class="op" id="3844952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844956">return</span>&nbsp;<span class="builtintype" id="3844963">nil</span><span class="op" id="3844966">,</span>&nbsp;<span class="builtintype" id="3844968">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844976">return</span>&nbsp;<span class="builtintype" id="3844983">nil</span><span class="op" id="3844986">,</span>&nbsp;<span class="ident" id="3844988">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="3845007">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3845010">func</span>&nbsp;<span class="ident" id="3845015">interfaceToIPv4Addr</span><span class="op" id="3845034">(</span><span class="ident" id="3845035">ifi</span>&nbsp;<span class="op" id="3845039">*</span><span class="ident" id="3845040">Interface</span><span class="op" id="3845049">)</span>&nbsp;<span class="op" id="3845051">(</span><span class="ident" id="3845052">IP</span><span class="op" id="3845054">,</span>&nbsp;<span class="builtintype" id="3845056">error</span><span class="op" id="3845061">)</span>&nbsp;<span class="op" id="3845063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845066">if</span>&nbsp;<span class="ident" id="3845069">ifi</span>&nbsp;<span class="op" id="3845073">==</span>&nbsp;<span class="builtintype" id="3845076">nil</span>&nbsp;<span class="op" id="3845080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845084">return</span>&nbsp;<span class="ident" id="3845091">IPv4zero</span><span class="op" id="3845099">,</span>&nbsp;<span class="builtintype" id="3845101">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845106">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3845109">ifat</span><span class="op" id="3845113">,</span>&nbsp;<span class="ident" id="3845115">err</span>&nbsp;<span class="op" id="3845119">:=</span>&nbsp;<span class="ident" id="3845122">ifi</span><span class="op" id="3845125">.</span><span class="ident" id="3845126">Addrs</span><span class="op" id="3845131">(</span><span class="op" id="3845132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845135">if</span>&nbsp;<span class="ident" id="3845138">err</span>&nbsp;<span class="op" id="3845142">!=</span>&nbsp;<span class="builtintype" id="3845145">nil</span>&nbsp;<span class="op" id="3845149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845153">return</span>&nbsp;<span class="builtintype" id="3845160">nil</span><span class="op" id="3845163">,</span>&nbsp;<span class="ident" id="3845165">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845173">for</span>&nbsp;<span class="ident" id="3845177">_</span><span class="op" id="3845178">,</span>&nbsp;<span class="ident" id="3845180">ifa</span>&nbsp;<span class="op" id="3845184">:=</span>&nbsp;<span class="keyword" id="3845187">range</span>&nbsp;<span class="ident" id="3845193">ifat</span>&nbsp;<span class="op" id="3845198">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845202">switch</span>&nbsp;<span class="ident" id="3845209">v</span>&nbsp;<span class="op" id="3845211">:=</span>&nbsp;<span class="ident" id="3845214">ifa</span><span class="op" id="3845217">.</span><span class="op" id="3845218">(</span><span class="keyword" id="3845219">type</span><span class="op" id="3845223">)</span>&nbsp;<span class="op" id="3845225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845229">case</span>&nbsp;<span class="op" id="3845234">*</span><span class="ident" id="3845235">IPAddr</span><span class="op" id="3845241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845246">if</span>&nbsp;<span class="ident" id="3845249">v</span><span class="op" id="3845250">.</span><span class="ident" id="3845251">IP</span><span class="op" id="3845253">.</span><span class="ident" id="3845254">To4</span><span class="op" id="3845257">(</span><span class="op" id="3845258">)</span>&nbsp;<span class="op" id="3845260">!=</span>&nbsp;<span class="builtintype" id="3845263">nil</span>&nbsp;<span class="op" id="3845267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845273">return</span>&nbsp;<span class="ident" id="3845280">v</span><span class="op" id="3845281">.</span><span class="ident" id="3845282">IP</span><span class="op" id="3845284">,</span>&nbsp;<span class="builtintype" id="3845286">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845293">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845297">case</span>&nbsp;<span class="op" id="3845302">*</span><span class="ident" id="3845303">IPNet</span><span class="op" id="3845308">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845313">if</span>&nbsp;<span class="ident" id="3845316">v</span><span class="op" id="3845317">.</span><span class="ident" id="3845318">IP</span><span class="op" id="3845320">.</span><span class="ident" id="3845321">To4</span><span class="op" id="3845324">(</span><span class="op" id="3845325">)</span>&nbsp;<span class="op" id="3845327">!=</span>&nbsp;<span class="builtintype" id="3845330">nil</span>&nbsp;<span class="op" id="3845334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845340">return</span>&nbsp;<span class="ident" id="3845347">v</span><span class="op" id="3845348">.</span><span class="ident" id="3845349">IP</span><span class="op" id="3845351">,</span>&nbsp;<span class="builtintype" id="3845353">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845364">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845370">return</span>&nbsp;<span class="builtintype" id="3845377">nil</span><span class="op" id="3845380">,</span>&nbsp;<span class="ident" id="3845382">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="3845401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3845404">func</span>&nbsp;<span class="ident" id="3845409">setIPv4MreqToInterface</span><span class="op" id="3845431">(</span><span class="ident" id="3845432">mreq</span>&nbsp;<span class="op" id="3845437">*</span><span class="ident" id="3845438">syscall</span><span class="op" id="3845445">.</span><span class="ident" id="3845446">IPMreq</span><span class="op" id="3845452">,</span>&nbsp;<span class="ident" id="3845454">ifi</span>&nbsp;<span class="op" id="3845458">*</span><span class="ident" id="3845459">Interface</span><span class="op" id="3845468">)</span>&nbsp;<span class="builtintype" id="3845470">error</span>&nbsp;<span class="op" id="3845476">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845479">if</span>&nbsp;<span class="ident" id="3845482">ifi</span>&nbsp;<span class="op" id="3845486">==</span>&nbsp;<span class="builtintype" id="3845489">nil</span>&nbsp;<span class="op" id="3845493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845497">return</span>&nbsp;<span class="builtintype" id="3845504">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3845512">ifat</span><span class="op" id="3845516">,</span>&nbsp;<span class="ident" id="3845518">err</span>&nbsp;<span class="op" id="3845522">:=</span>&nbsp;<span class="ident" id="3845525">ifi</span><span class="op" id="3845528">.</span><span class="ident" id="3845529">Addrs</span><span class="op" id="3845534">(</span><span class="op" id="3845535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845538">if</span>&nbsp;<span class="ident" id="3845541">err</span>&nbsp;<span class="op" id="3845545">!=</span>&nbsp;<span class="builtintype" id="3845548">nil</span>&nbsp;<span class="op" id="3845552">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845556">return</span>&nbsp;<span class="ident" id="3845563">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845571">for</span>&nbsp;<span class="ident" id="3845575">_</span><span class="op" id="3845576">,</span>&nbsp;<span class="ident" id="3845578">ifa</span>&nbsp;<span class="op" id="3845582">:=</span>&nbsp;<span class="keyword" id="3845585">range</span>&nbsp;<span class="ident" id="3845591">ifat</span>&nbsp;<span class="op" id="3845596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845600">switch</span>&nbsp;<span class="ident" id="3845607">v</span>&nbsp;<span class="op" id="3845609">:=</span>&nbsp;<span class="ident" id="3845612">ifa</span><span class="op" id="3845615">.</span><span class="op" id="3845616">(</span><span class="keyword" id="3845617">type</span><span class="op" id="3845621">)</span>&nbsp;<span class="op" id="3845623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845627">case</span>&nbsp;<span class="op" id="3845632">*</span><span class="ident" id="3845633">IPAddr</span><span class="op" id="3845639">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845644">if</span>&nbsp;<span class="ident" id="3845647">a</span>&nbsp;<span class="op" id="3845649">:=</span>&nbsp;<span class="ident" id="3845652">v</span><span class="op" id="3845653">.</span><span class="ident" id="3845654">IP</span><span class="op" id="3845656">.</span><span class="ident" id="3845657">To4</span><span class="op" id="3845660">(</span><span class="op" id="3845661">)</span><span class="op" id="3845662">;</span>&nbsp;<span class="ident" id="3845664">a</span>&nbsp;<span class="op" id="3845666">!=</span>&nbsp;<span class="builtintype" id="3845669">nil</span>&nbsp;<span class="op" id="3845673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3845679">copy</span><span class="op" id="3845683">(</span><span class="ident" id="3845684">mreq</span><span class="op" id="3845688">.</span><span class="ident" id="3845689">Interface</span><span class="op" id="3845698">[</span><span class="op" id="3845699">:</span><span class="op" id="3845700">]</span><span class="op" id="3845701">,</span>&nbsp;<span class="ident" id="3845703">a</span><span class="op" id="3845704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845710">goto</span>&nbsp;<span class="ident" id="3845715">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845727">case</span>&nbsp;<span class="op" id="3845732">*</span><span class="ident" id="3845733">IPNet</span><span class="op" id="3845738">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845743">if</span>&nbsp;<span class="ident" id="3845746">a</span>&nbsp;<span class="op" id="3845748">:=</span>&nbsp;<span class="ident" id="3845751">v</span><span class="op" id="3845752">.</span><span class="ident" id="3845753">IP</span><span class="op" id="3845755">.</span><span class="ident" id="3845756">To4</span><span class="op" id="3845759">(</span><span class="op" id="3845760">)</span><span class="op" id="3845761">;</span>&nbsp;<span class="ident" id="3845763">a</span>&nbsp;<span class="op" id="3845765">!=</span>&nbsp;<span class="builtintype" id="3845768">nil</span>&nbsp;<span class="op" id="3845772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3845778">copy</span><span class="op" id="3845782">(</span><span class="ident" id="3845783">mreq</span><span class="op" id="3845787">.</span><span class="ident" id="3845788">Interface</span><span class="op" id="3845797">[</span><span class="op" id="3845798">:</span><span class="op" id="3845799">]</span><span class="op" id="3845800">,</span>&nbsp;<span class="ident" id="3845802">a</span><span class="op" id="3845803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845809">goto</span>&nbsp;<span class="ident" id="3845814">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845826">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845829">}</span><br>
<span class="lineno"></span><span class="ident" id="3845831">done</span><span class="op" id="3845835">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845838">if</span>&nbsp;<span class="ident" id="3845841">bytesEqual</span><span class="op" id="3845851">(</span><span class="ident" id="3845852">mreq</span><span class="op" id="3845856">.</span><span class="ident" id="3845857">Multiaddr</span><span class="op" id="3845866">[</span><span class="op" id="3845867">:</span><span class="op" id="3845868">]</span><span class="op" id="3845869">,</span>&nbsp;<span class="ident" id="3845871">IPv4zero</span><span class="op" id="3845879">.</span><span class="ident" id="3845880">To4</span><span class="op" id="3845883">(</span><span class="op" id="3845884">)</span><span class="op" id="3845885">)</span>&nbsp;<span class="op" id="3845887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845891">return</span>&nbsp;<span class="ident" id="3845898">errNoSuchMulticastInterface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845927">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845930">return</span>&nbsp;<span class="builtintype" id="3845937">nil</span><br>
<span class="lineno"></span><span class="op" id="3845941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3845944">func</span>&nbsp;<span class="ident" id="3845949">setReadBuffer</span><span class="op" id="3845962">(</span><span class="ident" id="3845963">fd</span>&nbsp;<span class="op" id="3845966">*</span><span class="ident" id="3845967">netFD</span><span class="op" id="3845972">,</span>&nbsp;<span class="ident" id="3845974">bytes</span>&nbsp;<span class="builtintype" id="3845980">int</span><span class="op" id="3845983">)</span>&nbsp;<span class="builtintype" id="3845985">error</span>&nbsp;<span class="op" id="3845991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845994">if</span>&nbsp;<span class="ident" id="3845997">err</span>&nbsp;<span class="op" id="3846001">:=</span>&nbsp;<span class="ident" id="3846004">fd</span><span class="op" id="3846006">.</span><span class="ident" id="3846007">incref</span><span class="op" id="3846013">(</span><span class="op" id="3846014">)</span><span class="op" id="3846015">;</span>&nbsp;<span class="ident" id="3846017">err</span>&nbsp;<span class="op" id="3846021">!=</span>&nbsp;<span class="builtintype" id="3846024">nil</span>&nbsp;<span class="op" id="3846028">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846032">return</span>&nbsp;<span class="ident" id="3846039">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3846044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846047">defer</span>&nbsp;<span class="ident" id="3846053">fd</span><span class="op" id="3846055">.</span><span class="ident" id="3846056">decref</span><span class="op" id="3846062">(</span><span class="op" id="3846063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846066">return</span>&nbsp;<span class="ident" id="3846073">os</span><span class="op" id="3846075">.</span><span class="ident" id="3846076">NewSyscallError</span><span class="op" id="3846091">(</span><span class="string" id="3846092">&#34;setsockopt&#34;</span><span class="op" id="3846104">,</span>&nbsp;<span class="ident" id="3846106">syscall</span><span class="op" id="3846113">.</span><span class="ident" id="3846114">SetsockoptInt</span><span class="op" id="3846127">(</span><span class="ident" id="3846128">fd</span><span class="op" id="3846130">.</span><span class="ident" id="3846131">sysfd</span><span class="op" id="3846136">,</span>&nbsp;<span class="ident" id="3846138">syscall</span><span class="op" id="3846145">.</span><span class="ident" id="3846146">SOL_SOCKET</span><span class="op" id="3846156">,</span>&nbsp;<span class="ident" id="3846158">syscall</span><span class="op" id="3846165">.</span><span class="ident" id="3846166">SO_RCVBUF</span><span class="op" id="3846175">,</span>&nbsp;<span class="ident" id="3846177">bytes</span><span class="op" id="3846182">)</span><span class="op" id="3846183">)</span><br>
<span class="lineno"></span><span class="op" id="3846185">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="3846188">func</span>&nbsp;<span class="ident" id="3846193">setWriteBuffer</span><span class="op" id="3846207">(</span><span class="ident" id="3846208">fd</span>&nbsp;<span class="op" id="3846211">*</span><span class="ident" id="3846212">netFD</span><span class="op" id="3846217">,</span>&nbsp;<span class="ident" id="3846219">bytes</span>&nbsp;<span class="builtintype" id="3846225">int</span><span class="op" id="3846228">)</span>&nbsp;<span class="builtintype" id="3846230">error</span>&nbsp;<span class="op" id="3846236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846239">if</span>&nbsp;<span class="ident" id="3846242">err</span>&nbsp;<span class="op" id="3846246">:=</span>&nbsp;<span class="ident" id="3846249">fd</span><span class="op" id="3846251">.</span><span class="ident" id="3846252">incref</span><span class="op" id="3846258">(</span><span class="op" id="3846259">)</span><span class="op" id="3846260">;</span>&nbsp;<span class="ident" id="3846262">err</span>&nbsp;<span class="op" id="3846266">!=</span>&nbsp;<span class="builtintype" id="3846269">nil</span>&nbsp;<span class="op" id="3846273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846277">return</span>&nbsp;<span class="ident" id="3846284">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3846289">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846292">defer</span>&nbsp;<span class="ident" id="3846298">fd</span><span class="op" id="3846300">.</span><span class="ident" id="3846301">decref</span><span class="op" id="3846307">(</span><span class="op" id="3846308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846311">return</span>&nbsp;<span class="ident" id="3846318">os</span><span class="op" id="3846320">.</span><span class="ident" id="3846321">NewSyscallError</span><span class="op" id="3846336">(</span><span class="string" id="3846337">&#34;setsockopt&#34;</span><span class="op" id="3846349">,</span>&nbsp;<span class="ident" id="3846351">syscall</span><span class="op" id="3846358">.</span><span class="ident" id="3846359">SetsockoptInt</span><span class="op" id="3846372">(</span><span class="ident" id="3846373">fd</span><span class="op" id="3846375">.</span><span class="ident" id="3846376">sysfd</span><span class="op" id="3846381">,</span>&nbsp;<span class="ident" id="3846383">syscall</span><span class="op" id="3846390">.</span><span class="ident" id="3846391">SOL_SOCKET</span><span class="op" id="3846401">,</span>&nbsp;<span class="ident" id="3846403">syscall</span><span class="op" id="3846410">.</span><span class="ident" id="3846411">SO_SNDBUF</span><span class="op" id="3846420">,</span>&nbsp;<span class="ident" id="3846422">bytes</span><span class="op" id="3846427">)</span><span class="op" id="3846428">)</span><br>
<span class="lineno"></span><span class="op" id="3846430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3846433">func</span>&nbsp;<span class="ident" id="3846438">setKeepAlive</span><span class="op" id="3846450">(</span><span class="ident" id="3846451">fd</span>&nbsp;<span class="op" id="3846454">*</span><span class="ident" id="3846455">netFD</span><span class="op" id="3846460">,</span>&nbsp;<span class="ident" id="3846462">keepalive</span>&nbsp;<span class="builtintype" id="3846472">bool</span><span class="op" id="3846476">)</span>&nbsp;<span class="builtintype" id="3846478">error</span>&nbsp;<span class="op" id="3846484">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846487">if</span>&nbsp;<span class="ident" id="3846490">err</span>&nbsp;<span class="op" id="3846494">:=</span>&nbsp;<span class="ident" id="3846497">fd</span><span class="op" id="3846499">.</span><span class="ident" id="3846500">incref</span><span class="op" id="3846506">(</span><span class="op" id="3846507">)</span><span class="op" id="3846508">;</span>&nbsp;<span class="ident" id="3846510">err</span>&nbsp;<span class="op" id="3846514">!=</span>&nbsp;<span class="builtintype" id="3846517">nil</span>&nbsp;<span class="op" id="3846521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846525">return</span>&nbsp;<span class="ident" id="3846532">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3846537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846540">defer</span>&nbsp;<span class="ident" id="3846546">fd</span><span class="op" id="3846548">.</span><span class="ident" id="3846549">decref</span><span class="op" id="3846555">(</span><span class="op" id="3846556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846559">return</span>&nbsp;<span class="ident" id="3846566">os</span><span class="op" id="3846568">.</span><span class="ident" id="3846569">NewSyscallError</span><span class="op" id="3846584">(</span><span class="string" id="3846585">&#34;setsockopt&#34;</span><span class="op" id="3846597">,</span>&nbsp;<span class="ident" id="3846599">syscall</span><span class="op" id="3846606">.</span><span class="ident" id="3846607">SetsockoptInt</span><span class="op" id="3846620">(</span><span class="ident" id="3846621">fd</span><span class="op" id="3846623">.</span><span class="ident" id="3846624">sysfd</span><span class="op" id="3846629">,</span>&nbsp;<span class="ident" id="3846631">syscall</span><span class="op" id="3846638">.</span><span class="ident" id="3846639">SOL_SOCKET</span><span class="op" id="3846649">,</span>&nbsp;<span class="ident" id="3846651">syscall</span><span class="op" id="3846658">.</span><span class="ident" id="3846659">SO_KEEPALIVE</span><span class="op" id="3846671">,</span>&nbsp;<span class="ident" id="3846673">boolint</span><span class="op" id="3846680">(</span><span class="ident" id="3846681">keepalive</span><span class="op" id="3846690">)</span><span class="op" id="3846691">)</span><span class="op" id="3846692">)</span><br>
<span class="lineno">125</span><span class="op" id="3846694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3846697">func</span>&nbsp;<span class="ident" id="3846702">setLinger</span><span class="op" id="3846711">(</span><span class="ident" id="3846712">fd</span>&nbsp;<span class="op" id="3846715">*</span><span class="ident" id="3846716">netFD</span><span class="op" id="3846721">,</span>&nbsp;<span class="ident" id="3846723">sec</span>&nbsp;<span class="builtintype" id="3846727">int</span><span class="op" id="3846730">)</span>&nbsp;<span class="builtintype" id="3846732">error</span>&nbsp;<span class="op" id="3846738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846741">var</span>&nbsp;<span class="ident" id="3846745">l</span>&nbsp;<span class="ident" id="3846747">syscall</span><span class="op" id="3846754">.</span><span class="ident" id="3846755">Linger</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846763">if</span>&nbsp;<span class="ident" id="3846766">sec</span>&nbsp;<span class="op" id="3846770">&gt;=</span>&nbsp;<span class="num" id="3846773">0</span>&nbsp;<span class="op" id="3846775">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3846779">l</span><span class="op" id="3846780">.</span><span class="ident" id="3846781">Onoff</span>&nbsp;<span class="op" id="3846787">=</span>&nbsp;<span class="num" id="3846789">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3846793">l</span><span class="op" id="3846794">.</span><span class="ident" id="3846795">Linger</span>&nbsp;<span class="op" id="3846802">=</span>&nbsp;<span class="builtintype" id="3846804">int32</span><span class="op" id="3846809">(</span><span class="ident" id="3846810">sec</span><span class="op" id="3846813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3846816">}</span>&nbsp;<span class="keyword" id="3846818">else</span>&nbsp;<span class="op" id="3846823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3846827">l</span><span class="op" id="3846828">.</span><span class="ident" id="3846829">Onoff</span>&nbsp;<span class="op" id="3846835">=</span>&nbsp;<span class="num" id="3846837">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3846841">l</span><span class="op" id="3846842">.</span><span class="ident" id="3846843">Linger</span>&nbsp;<span class="op" id="3846850">=</span>&nbsp;<span class="num" id="3846852">0</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3846855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846858">if</span>&nbsp;<span class="ident" id="3846861">err</span>&nbsp;<span class="op" id="3846865">:=</span>&nbsp;<span class="ident" id="3846868">fd</span><span class="op" id="3846870">.</span><span class="ident" id="3846871">incref</span><span class="op" id="3846877">(</span><span class="op" id="3846878">)</span><span class="op" id="3846879">;</span>&nbsp;<span class="ident" id="3846881">err</span>&nbsp;<span class="op" id="3846885">!=</span>&nbsp;<span class="builtintype" id="3846888">nil</span>&nbsp;<span class="op" id="3846892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846896">return</span>&nbsp;<span class="ident" id="3846903">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3846908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846911">defer</span>&nbsp;<span class="ident" id="3846917">fd</span><span class="op" id="3846919">.</span><span class="ident" id="3846920">decref</span><span class="op" id="3846926">(</span><span class="op" id="3846927">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846930">return</span>&nbsp;<span class="ident" id="3846937">os</span><span class="op" id="3846939">.</span><span class="ident" id="3846940">NewSyscallError</span><span class="op" id="3846955">(</span><span class="string" id="3846956">&#34;setsockopt&#34;</span><span class="op" id="3846968">,</span>&nbsp;<span class="ident" id="3846970">syscall</span><span class="op" id="3846977">.</span><span class="ident" id="3846978">SetsockoptLinger</span><span class="op" id="3846994">(</span><span class="ident" id="3846995">fd</span><span class="op" id="3846997">.</span><span class="ident" id="3846998">sysfd</span><span class="op" id="3847003">,</span>&nbsp;<span class="ident" id="3847005">syscall</span><span class="op" id="3847012">.</span><span class="ident" id="3847013">SOL_SOCKET</span><span class="op" id="3847023">,</span>&nbsp;<span class="ident" id="3847025">syscall</span><span class="op" id="3847032">.</span><span class="ident" id="3847033">SO_LINGER</span><span class="op" id="3847042">,</span>&nbsp;<span class="op" id="3847044">&amp;</span><span class="ident" id="3847045">l</span><span class="op" id="3847046">)</span><span class="op" id="3847047">)</span><br>
<span class="lineno"></span><span class="op" id="3847049">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
