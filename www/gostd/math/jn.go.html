<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html" class="current">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2245757">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2245812">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2245866">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2245917">package</span>&nbsp;<span class="ident" id="2245925">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2245931">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2245997">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2246051">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2246102">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2246157">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2246187">//</span><br>
<span class="lineno"></span><span class="comment" id="2246190">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2246246">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2246315">//</span><br>
<span class="lineno"></span><span class="comment" id="2246318">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2246377">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2246433">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2246490">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2246507">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2246563">//</span><br>
<span class="lineno">25</span><span class="comment" id="2246566">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2246608">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="2246668">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="2246682">//</span><br>
<span class="lineno"></span><span class="comment" id="2246685">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="2246703">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="2246768">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2246831">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="2246865">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="2246899">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="2246933">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="2246985">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="2247025">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2247080">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="2247135">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="2247192">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2247245">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2247299">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="2247333">//</span><br>
<span class="lineno"></span><span class="comment" id="2247336">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="2247387">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2247434">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2247458">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2247519">//</span><br>
<span class="lineno">50</span><span class="comment" id="2247522">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2247544">//&nbsp;&nbsp;&nbsp;&nbsp;Jn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2247564">//&nbsp;&nbsp;&nbsp;&nbsp;Jn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2247584">func</span>&nbsp;<span class="ident" id="2247589">Jn</span><span class="op" id="2247591">(</span><span class="ident" id="2247592">n</span>&nbsp;<span class="builtintype" id="2247594">int</span><span class="op" id="2247597">,</span>&nbsp;<span class="ident" id="2247599">x</span>&nbsp;<span class="builtintype" id="2247601">float64</span><span class="op" id="2247608">)</span>&nbsp;<span class="builtintype" id="2247610">float64</span>&nbsp;<span class="op" id="2247618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2247621">const</span>&nbsp;<span class="op" id="2247627">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2247631">TwoM29</span>&nbsp;<span class="op" id="2247638">=</span>&nbsp;<span class="num" id="2247640">1.0</span>&nbsp;<span class="op" id="2247644">/</span>&nbsp;<span class="op" id="2247646">(</span><span class="num" id="2247647">1</span>&nbsp;<span class="op" id="2247649">&lt;&lt;</span>&nbsp;<span class="num" id="2247652">29</span><span class="op" id="2247654">)</span>&nbsp;<span class="comment" id="2247656">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2247687">Two302</span>&nbsp;<span class="op" id="2247694">=</span>&nbsp;<span class="num" id="2247696">1</span>&nbsp;<span class="op" id="2247698">&lt;&lt;</span>&nbsp;<span class="num" id="2247701">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2247712">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2247742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2247745">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2247763">switch</span>&nbsp;<span class="op" id="2247770">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2247773">case</span>&nbsp;<span class="ident" id="2247778">IsNaN</span><span class="op" id="2247783">(</span><span class="ident" id="2247784">x</span><span class="op" id="2247785">)</span><span class="op" id="2247786">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2247790">return</span>&nbsp;<span class="ident" id="2247797">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2247800">case</span>&nbsp;<span class="ident" id="2247805">IsInf</span><span class="op" id="2247810">(</span><span class="ident" id="2247811">x</span><span class="op" id="2247812">,</span>&nbsp;<span class="num" id="2247814">0</span><span class="op" id="2247815">)</span><span class="op" id="2247816">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2247820">return</span>&nbsp;<span class="num" id="2247827">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2247830">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2247833">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2247896">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2247927">if</span>&nbsp;<span class="ident" id="2247930">n</span>&nbsp;<span class="op" id="2247932">==</span>&nbsp;<span class="num" id="2247935">0</span>&nbsp;<span class="op" id="2247937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2247941">return</span>&nbsp;<span class="ident" id="2247948">J0</span><span class="op" id="2247950">(</span><span class="ident" id="2247951">x</span><span class="op" id="2247952">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2247955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2247958">if</span>&nbsp;<span class="ident" id="2247961">x</span>&nbsp;<span class="op" id="2247963">==</span>&nbsp;<span class="num" id="2247966">0</span>&nbsp;<span class="op" id="2247968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2247972">return</span>&nbsp;<span class="num" id="2247979">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2247982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2247985">if</span>&nbsp;<span class="ident" id="2247988">n</span>&nbsp;<span class="op" id="2247990">&lt;</span>&nbsp;<span class="num" id="2247992">0</span>&nbsp;<span class="op" id="2247994">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2247998">n</span><span class="op" id="2247999">,</span>&nbsp;<span class="ident" id="2248001">x</span>&nbsp;<span class="op" id="2248003">=</span>&nbsp;<span class="op" id="2248005">-</span><span class="ident" id="2248006">n</span><span class="op" id="2248007">,</span>&nbsp;<span class="op" id="2248009">-</span><span class="ident" id="2248010">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2248013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248016">if</span>&nbsp;<span class="ident" id="2248019">n</span>&nbsp;<span class="op" id="2248021">==</span>&nbsp;<span class="num" id="2248024">1</span>&nbsp;<span class="op" id="2248026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248030">return</span>&nbsp;<span class="ident" id="2248037">J1</span><span class="op" id="2248039">(</span><span class="ident" id="2248040">x</span><span class="op" id="2248041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2248044">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248047">sign</span>&nbsp;<span class="op" id="2248052">:=</span>&nbsp;<span class="builtintype" id="2248055">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248062">if</span>&nbsp;<span class="ident" id="2248065">x</span>&nbsp;<span class="op" id="2248067">&lt;</span>&nbsp;<span class="num" id="2248069">0</span>&nbsp;<span class="op" id="2248071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248075">x</span>&nbsp;<span class="op" id="2248077">=</span>&nbsp;<span class="op" id="2248079">-</span><span class="ident" id="2248080">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248084">if</span>&nbsp;<span class="ident" id="2248087">n</span><span class="op" id="2248088">&amp;</span><span class="num" id="2248089">1</span>&nbsp;<span class="op" id="2248091">==</span>&nbsp;<span class="num" id="2248094">1</span>&nbsp;<span class="op" id="2248096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248101">sign</span>&nbsp;<span class="op" id="2248106">=</span>&nbsp;<span class="builtintype" id="2248108">true</span>&nbsp;<span class="comment" id="2248113">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2248139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2248142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248145">var</span>&nbsp;<span class="ident" id="2248149">b</span>&nbsp;<span class="builtintype" id="2248151">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248160">if</span>&nbsp;<span class="builtintype" id="2248163">float64</span><span class="op" id="2248170">(</span><span class="ident" id="2248171">n</span><span class="op" id="2248172">)</span>&nbsp;<span class="op" id="2248174">&lt;=</span>&nbsp;<span class="ident" id="2248177">x</span>&nbsp;<span class="op" id="2248179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248183">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248231">if</span>&nbsp;<span class="ident" id="2248234">x</span>&nbsp;<span class="op" id="2248236">&gt;=</span>&nbsp;<span class="ident" id="2248239">Two302</span>&nbsp;<span class="op" id="2248246">{</span>&nbsp;<span class="comment" id="2248248">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248266">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248284">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248339">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248394">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248433">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248490">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248496">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248552">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248606">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248654">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248702">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248750">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248799">var</span>&nbsp;<span class="ident" id="2248803">temp</span>&nbsp;<span class="builtintype" id="2248808">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248819">switch</span>&nbsp;<span class="ident" id="2248826">n</span>&nbsp;<span class="op" id="2248828">&amp;</span>&nbsp;<span class="num" id="2248830">3</span>&nbsp;<span class="op" id="2248832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248837">case</span>&nbsp;<span class="num" id="2248842">0</span><span class="op" id="2248843">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248849">temp</span>&nbsp;<span class="op" id="2248854">=</span>&nbsp;<span class="ident" id="2248856">Cos</span><span class="op" id="2248859">(</span><span class="ident" id="2248860">x</span><span class="op" id="2248861">)</span>&nbsp;<span class="op" id="2248863">+</span>&nbsp;<span class="ident" id="2248865">Sin</span><span class="op" id="2248868">(</span><span class="ident" id="2248869">x</span><span class="op" id="2248870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248875">case</span>&nbsp;<span class="num" id="2248880">1</span><span class="op" id="2248881">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248887">temp</span>&nbsp;<span class="op" id="2248892">=</span>&nbsp;<span class="op" id="2248894">-</span><span class="ident" id="2248895">Cos</span><span class="op" id="2248898">(</span><span class="ident" id="2248899">x</span><span class="op" id="2248900">)</span>&nbsp;<span class="op" id="2248902">+</span>&nbsp;<span class="ident" id="2248904">Sin</span><span class="op" id="2248907">(</span><span class="ident" id="2248908">x</span><span class="op" id="2248909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248914">case</span>&nbsp;<span class="num" id="2248919">2</span><span class="op" id="2248920">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248926">temp</span>&nbsp;<span class="op" id="2248931">=</span>&nbsp;<span class="op" id="2248933">-</span><span class="ident" id="2248934">Cos</span><span class="op" id="2248937">(</span><span class="ident" id="2248938">x</span><span class="op" id="2248939">)</span>&nbsp;<span class="op" id="2248941">-</span>&nbsp;<span class="ident" id="2248943">Sin</span><span class="op" id="2248946">(</span><span class="ident" id="2248947">x</span><span class="op" id="2248948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248953">case</span>&nbsp;<span class="num" id="2248958">3</span><span class="op" id="2248959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248965">temp</span>&nbsp;<span class="op" id="2248970">=</span>&nbsp;<span class="ident" id="2248972">Cos</span><span class="op" id="2248975">(</span><span class="ident" id="2248976">x</span><span class="op" id="2248977">)</span>&nbsp;<span class="op" id="2248979">-</span>&nbsp;<span class="ident" id="2248981">Sin</span><span class="op" id="2248984">(</span><span class="ident" id="2248985">x</span><span class="op" id="2248986">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2248991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248996">b</span>&nbsp;<span class="op" id="2248998">=</span>&nbsp;<span class="op" id="2249000">(</span><span class="num" id="2249001">1</span>&nbsp;<span class="op" id="2249003">/</span>&nbsp;<span class="ident" id="2249005">SqrtPi</span><span class="op" id="2249011">)</span>&nbsp;<span class="op" id="2249013">*</span>&nbsp;<span class="ident" id="2249015">temp</span>&nbsp;<span class="op" id="2249020">/</span>&nbsp;<span class="ident" id="2249022">Sqrt</span><span class="op" id="2249026">(</span><span class="ident" id="2249027">x</span><span class="op" id="2249028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249032">}</span>&nbsp;<span class="keyword" id="2249034">else</span>&nbsp;<span class="op" id="2249039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249044">b</span>&nbsp;<span class="op" id="2249046">=</span>&nbsp;<span class="ident" id="2249048">J1</span><span class="op" id="2249050">(</span><span class="ident" id="2249051">x</span><span class="op" id="2249052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249057">for</span>&nbsp;<span class="ident" id="2249061">i</span><span class="op" id="2249062">,</span>&nbsp;<span class="ident" id="2249064">a</span>&nbsp;<span class="op" id="2249066">:=</span>&nbsp;<span class="num" id="2249069">1</span><span class="op" id="2249070">,</span>&nbsp;<span class="ident" id="2249072">J0</span><span class="op" id="2249074">(</span><span class="ident" id="2249075">x</span><span class="op" id="2249076">)</span><span class="op" id="2249077">;</span>&nbsp;<span class="ident" id="2249079">i</span>&nbsp;<span class="op" id="2249081">&lt;</span>&nbsp;<span class="ident" id="2249083">n</span><span class="op" id="2249084">;</span>&nbsp;<span class="ident" id="2249086">i</span><span class="op" id="2249087">++</span>&nbsp;<span class="op" id="2249090">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249096">a</span><span class="op" id="2249097">,</span>&nbsp;<span class="ident" id="2249099">b</span>&nbsp;<span class="op" id="2249101">=</span>&nbsp;<span class="ident" id="2249103">b</span><span class="op" id="2249104">,</span>&nbsp;<span class="ident" id="2249106">b</span><span class="op" id="2249107">*</span><span class="op" id="2249108">(</span><span class="builtintype" id="2249109">float64</span><span class="op" id="2249116">(</span><span class="ident" id="2249117">i</span><span class="op" id="2249118">+</span><span class="ident" id="2249119">i</span><span class="op" id="2249120">)</span><span class="op" id="2249121">/</span><span class="ident" id="2249122">x</span><span class="op" id="2249123">)</span><span class="op" id="2249124">-</span><span class="ident" id="2249125">a</span>&nbsp;<span class="comment" id="2249127">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249156">}</span>&nbsp;<span class="keyword" id="2249158">else</span>&nbsp;<span class="op" id="2249163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249167">if</span>&nbsp;<span class="ident" id="2249170">x</span>&nbsp;<span class="op" id="2249172">&lt;</span>&nbsp;<span class="ident" id="2249174">TwoM29</span>&nbsp;<span class="op" id="2249181">{</span>&nbsp;<span class="comment" id="2249183">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249200">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249261">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249298">if</span>&nbsp;<span class="ident" id="2249301">n</span>&nbsp;<span class="op" id="2249303">&gt;</span>&nbsp;<span class="num" id="2249305">33</span>&nbsp;<span class="op" id="2249308">{</span>&nbsp;<span class="comment" id="2249310">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249327">b</span>&nbsp;<span class="op" id="2249329">=</span>&nbsp;<span class="num" id="2249331">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249336">}</span>&nbsp;<span class="keyword" id="2249338">else</span>&nbsp;<span class="op" id="2249343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249349">temp</span>&nbsp;<span class="op" id="2249354">:=</span>&nbsp;<span class="ident" id="2249357">x</span>&nbsp;<span class="op" id="2249359">*</span>&nbsp;<span class="num" id="2249361">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249369">b</span>&nbsp;<span class="op" id="2249371">=</span>&nbsp;<span class="ident" id="2249373">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249382">a</span>&nbsp;<span class="op" id="2249384">:=</span>&nbsp;<span class="num" id="2249387">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249395">for</span>&nbsp;<span class="ident" id="2249399">i</span>&nbsp;<span class="op" id="2249401">:=</span>&nbsp;<span class="num" id="2249404">2</span><span class="op" id="2249405">;</span>&nbsp;<span class="ident" id="2249407">i</span>&nbsp;<span class="op" id="2249409">&lt;=</span>&nbsp;<span class="ident" id="2249412">n</span><span class="op" id="2249413">;</span>&nbsp;<span class="ident" id="2249415">i</span><span class="op" id="2249416">++</span>&nbsp;<span class="op" id="2249419">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249426">a</span>&nbsp;<span class="op" id="2249428">*=</span>&nbsp;<span class="builtintype" id="2249431">float64</span><span class="op" id="2249438">(</span><span class="ident" id="2249439">i</span><span class="op" id="2249440">)</span>&nbsp;<span class="comment" id="2249442">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249457">b</span>&nbsp;<span class="op" id="2249459">*=</span>&nbsp;<span class="ident" id="2249462">temp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249473">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249499">b</span>&nbsp;<span class="op" id="2249501">/=</span>&nbsp;<span class="ident" id="2249504">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249509">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249513">}</span>&nbsp;<span class="keyword" id="2249515">else</span>&nbsp;<span class="op" id="2249520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249525">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249555">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249604">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249661">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249710">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249716">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249761">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249817">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249865">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249915">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249961">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249967">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250021">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250063">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250088">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250125">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250153">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250189">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250220">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250255">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250292">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250298">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250344">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250379">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250417">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbsp;good&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250455">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbsp;good&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250493">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbsp;good&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250536">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250554">w</span>&nbsp;<span class="op" id="2250556">:=</span>&nbsp;<span class="builtintype" id="2250559">float64</span><span class="op" id="2250566">(</span><span class="ident" id="2250567">n</span><span class="op" id="2250568">+</span><span class="ident" id="2250569">n</span><span class="op" id="2250570">)</span>&nbsp;<span class="op" id="2250572">/</span>&nbsp;<span class="ident" id="2250574">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250579">h</span>&nbsp;<span class="op" id="2250581">:=</span>&nbsp;<span class="num" id="2250584">2</span>&nbsp;<span class="op" id="2250586">/</span>&nbsp;<span class="ident" id="2250588">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250593">q0</span>&nbsp;<span class="op" id="2250596">:=</span>&nbsp;<span class="ident" id="2250599">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250604">z</span>&nbsp;<span class="op" id="2250606">:=</span>&nbsp;<span class="ident" id="2250609">w</span>&nbsp;<span class="op" id="2250611">+</span>&nbsp;<span class="ident" id="2250613">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250618">q1</span>&nbsp;<span class="op" id="2250621">:=</span>&nbsp;<span class="ident" id="2250624">w</span><span class="op" id="2250625">*</span><span class="ident" id="2250626">z</span>&nbsp;<span class="op" id="2250628">-</span>&nbsp;<span class="num" id="2250630">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250635">k</span>&nbsp;<span class="op" id="2250637">:=</span>&nbsp;<span class="num" id="2250640">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2250645">for</span>&nbsp;<span class="ident" id="2250649">q1</span>&nbsp;<span class="op" id="2250652">&lt;</span>&nbsp;<span class="num" id="2250654">1e9</span>&nbsp;<span class="op" id="2250658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250664">k</span>&nbsp;<span class="op" id="2250666">+=</span>&nbsp;<span class="num" id="2250669">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250675">z</span>&nbsp;<span class="op" id="2250677">+=</span>&nbsp;<span class="ident" id="2250680">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250686">q0</span><span class="op" id="2250688">,</span>&nbsp;<span class="ident" id="2250690">q1</span>&nbsp;<span class="op" id="2250693">=</span>&nbsp;<span class="ident" id="2250695">q1</span><span class="op" id="2250697">,</span>&nbsp;<span class="ident" id="2250699">z</span><span class="op" id="2250700">*</span><span class="ident" id="2250701">q1</span><span class="op" id="2250703">-</span><span class="ident" id="2250704">q0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2250710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250715">m</span>&nbsp;<span class="op" id="2250717">:=</span>&nbsp;<span class="ident" id="2250720">n</span>&nbsp;<span class="op" id="2250722">+</span>&nbsp;<span class="ident" id="2250724">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250729">t</span>&nbsp;<span class="op" id="2250731">:=</span>&nbsp;<span class="num" id="2250734">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2250741">for</span>&nbsp;<span class="ident" id="2250745">i</span>&nbsp;<span class="op" id="2250747">:=</span>&nbsp;<span class="num" id="2250750">2</span>&nbsp;<span class="op" id="2250752">*</span>&nbsp;<span class="op" id="2250754">(</span><span class="ident" id="2250755">n</span>&nbsp;<span class="op" id="2250757">+</span>&nbsp;<span class="ident" id="2250759">k</span><span class="op" id="2250760">)</span><span class="op" id="2250761">;</span>&nbsp;<span class="ident" id="2250763">i</span>&nbsp;<span class="op" id="2250765">&gt;=</span>&nbsp;<span class="ident" id="2250768">m</span><span class="op" id="2250769">;</span>&nbsp;<span class="ident" id="2250771">i</span>&nbsp;<span class="op" id="2250773">-=</span>&nbsp;<span class="num" id="2250776">2</span>&nbsp;<span class="op" id="2250778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250784">t</span>&nbsp;<span class="op" id="2250786">=</span>&nbsp;<span class="num" id="2250788">1</span>&nbsp;<span class="op" id="2250790">/</span>&nbsp;<span class="op" id="2250792">(</span><span class="builtintype" id="2250793">float64</span><span class="op" id="2250800">(</span><span class="ident" id="2250801">i</span><span class="op" id="2250802">)</span><span class="op" id="2250803">/</span><span class="ident" id="2250804">x</span>&nbsp;<span class="op" id="2250806">-</span>&nbsp;<span class="ident" id="2250808">t</span><span class="op" id="2250809">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2250814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250819">a</span>&nbsp;<span class="op" id="2250821">:=</span>&nbsp;<span class="ident" id="2250824">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2250829">b</span>&nbsp;<span class="op" id="2250831">=</span>&nbsp;<span class="num" id="2250833">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250838">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250892">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250929">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250960">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251001">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251067">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251126">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251159">tmp</span>&nbsp;<span class="op" id="2251163">:=</span>&nbsp;<span class="builtintype" id="2251166">float64</span><span class="op" id="2251173">(</span><span class="ident" id="2251174">n</span><span class="op" id="2251175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251180">v</span>&nbsp;<span class="op" id="2251182">:=</span>&nbsp;<span class="num" id="2251185">2</span>&nbsp;<span class="op" id="2251187">/</span>&nbsp;<span class="ident" id="2251189">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251194">tmp</span>&nbsp;<span class="op" id="2251198">=</span>&nbsp;<span class="ident" id="2251200">tmp</span>&nbsp;<span class="op" id="2251204">*</span>&nbsp;<span class="ident" id="2251206">Log</span><span class="op" id="2251209">(</span><span class="ident" id="2251210">Abs</span><span class="op" id="2251213">(</span><span class="ident" id="2251214">v</span><span class="op" id="2251215">*</span><span class="ident" id="2251216">tmp</span><span class="op" id="2251219">)</span><span class="op" id="2251220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2251225">if</span>&nbsp;<span class="ident" id="2251228">tmp</span>&nbsp;<span class="op" id="2251232">&lt;</span>&nbsp;<span class="num" id="2251234">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="2251261">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2251267">for</span>&nbsp;<span class="ident" id="2251271">i</span>&nbsp;<span class="op" id="2251273">:=</span>&nbsp;<span class="ident" id="2251276">n</span>&nbsp;<span class="op" id="2251278">-</span>&nbsp;<span class="num" id="2251280">1</span><span class="op" id="2251281">;</span>&nbsp;<span class="ident" id="2251283">i</span>&nbsp;<span class="op" id="2251285">&gt;</span>&nbsp;<span class="num" id="2251287">0</span><span class="op" id="2251288">;</span>&nbsp;<span class="ident" id="2251290">i</span><span class="op" id="2251291">--</span>&nbsp;<span class="op" id="2251294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251301">di</span>&nbsp;<span class="op" id="2251304">:=</span>&nbsp;<span class="builtintype" id="2251307">float64</span><span class="op" id="2251314">(</span><span class="ident" id="2251315">i</span>&nbsp;<span class="op" id="2251317">+</span>&nbsp;<span class="ident" id="2251319">i</span><span class="op" id="2251320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251327">a</span><span class="op" id="2251328">,</span>&nbsp;<span class="ident" id="2251330">b</span>&nbsp;<span class="op" id="2251332">=</span>&nbsp;<span class="ident" id="2251334">b</span><span class="op" id="2251335">,</span>&nbsp;<span class="ident" id="2251337">b</span><span class="op" id="2251338">*</span><span class="ident" id="2251339">di</span><span class="op" id="2251341">/</span><span class="ident" id="2251342">x</span><span class="op" id="2251343">-</span><span class="ident" id="2251344">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251351">di</span>&nbsp;<span class="op" id="2251354">-=</span>&nbsp;<span class="num" id="2251357">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2251363">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2251368">}</span>&nbsp;<span class="keyword" id="2251370">else</span>&nbsp;<span class="op" id="2251375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2251381">for</span>&nbsp;<span class="ident" id="2251385">i</span>&nbsp;<span class="op" id="2251387">:=</span>&nbsp;<span class="ident" id="2251390">n</span>&nbsp;<span class="op" id="2251392">-</span>&nbsp;<span class="num" id="2251394">1</span><span class="op" id="2251395">;</span>&nbsp;<span class="ident" id="2251397">i</span>&nbsp;<span class="op" id="2251399">&gt;</span>&nbsp;<span class="num" id="2251401">0</span><span class="op" id="2251402">;</span>&nbsp;<span class="ident" id="2251404">i</span><span class="op" id="2251405">--</span>&nbsp;<span class="op" id="2251408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251415">di</span>&nbsp;<span class="op" id="2251418">:=</span>&nbsp;<span class="builtintype" id="2251421">float64</span><span class="op" id="2251428">(</span><span class="ident" id="2251429">i</span>&nbsp;<span class="op" id="2251431">+</span>&nbsp;<span class="ident" id="2251433">i</span><span class="op" id="2251434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251441">a</span><span class="op" id="2251442">,</span>&nbsp;<span class="ident" id="2251444">b</span>&nbsp;<span class="op" id="2251446">=</span>&nbsp;<span class="ident" id="2251448">b</span><span class="op" id="2251449">,</span>&nbsp;<span class="ident" id="2251451">b</span><span class="op" id="2251452">*</span><span class="ident" id="2251453">di</span><span class="op" id="2251455">/</span><span class="ident" id="2251456">x</span><span class="op" id="2251457">-</span><span class="ident" id="2251458">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251465">di</span>&nbsp;<span class="op" id="2251468">-=</span>&nbsp;<span class="num" id="2251471">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251478">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2251521">if</span>&nbsp;<span class="ident" id="2251524">b</span>&nbsp;<span class="op" id="2251526">&gt;</span>&nbsp;<span class="num" id="2251528">1e100</span>&nbsp;<span class="op" id="2251534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251542">a</span>&nbsp;<span class="op" id="2251544">/=</span>&nbsp;<span class="ident" id="2251547">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251555">t</span>&nbsp;<span class="op" id="2251557">/=</span>&nbsp;<span class="ident" id="2251560">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251568">b</span>&nbsp;<span class="op" id="2251570">=</span>&nbsp;<span class="num" id="2251572">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2251579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2251585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2251590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2251595">b</span>&nbsp;<span class="op" id="2251597">=</span>&nbsp;<span class="ident" id="2251599">t</span>&nbsp;<span class="op" id="2251601">*</span>&nbsp;<span class="ident" id="2251603">J0</span><span class="op" id="2251605">(</span><span class="ident" id="2251606">x</span><span class="op" id="2251607">)</span>&nbsp;<span class="op" id="2251609">/</span>&nbsp;<span class="ident" id="2251611">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2251615">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2251618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2251621">if</span>&nbsp;<span class="ident" id="2251624">sign</span>&nbsp;<span class="op" id="2251629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2251633">return</span>&nbsp;<span class="op" id="2251640">-</span><span class="ident" id="2251641">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2251644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2251647">return</span>&nbsp;<span class="ident" id="2251654">b</span><br>
<span class="lineno">225</span><span class="op" id="2251656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2251659">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2251721">//</span><br>
<span class="lineno"></span><span class="comment" id="2251724">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="2251746">//&nbsp;&nbsp;&nbsp;&nbsp;Yn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2251765">//&nbsp;&nbsp;&nbsp;&nbsp;Yn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2251788">//&nbsp;&nbsp;&nbsp;&nbsp;Yn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="2251842">//&nbsp;&nbsp;&nbsp;&nbsp;Y1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2251864">//&nbsp;&nbsp;&nbsp;&nbsp;Y1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="2251884">func</span>&nbsp;<span class="ident" id="2251889">Yn</span><span class="op" id="2251891">(</span><span class="ident" id="2251892">n</span>&nbsp;<span class="builtintype" id="2251894">int</span><span class="op" id="2251897">,</span>&nbsp;<span class="ident" id="2251899">x</span>&nbsp;<span class="builtintype" id="2251901">float64</span><span class="op" id="2251908">)</span>&nbsp;<span class="builtintype" id="2251910">float64</span>&nbsp;<span class="op" id="2251918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2251921">const</span>&nbsp;<span class="ident" id="2251927">Two302</span>&nbsp;<span class="op" id="2251934">=</span>&nbsp;<span class="num" id="2251936">1</span>&nbsp;<span class="op" id="2251938">&lt;&lt;</span>&nbsp;<span class="num" id="2251941">302</span>&nbsp;<span class="comment" id="2251945">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251975">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2251993">switch</span>&nbsp;<span class="op" id="2252000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252003">case</span>&nbsp;<span class="ident" id="2252008">x</span>&nbsp;<span class="op" id="2252010">&lt;</span>&nbsp;<span class="num" id="2252012">0</span>&nbsp;<span class="op" id="2252014">||</span>&nbsp;<span class="ident" id="2252017">IsNaN</span><span class="op" id="2252022">(</span><span class="ident" id="2252023">x</span><span class="op" id="2252024">)</span><span class="op" id="2252025">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252029">return</span>&nbsp;<span class="ident" id="2252036">NaN</span><span class="op" id="2252039">(</span><span class="op" id="2252040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252043">case</span>&nbsp;<span class="ident" id="2252048">IsInf</span><span class="op" id="2252053">(</span><span class="ident" id="2252054">x</span><span class="op" id="2252055">,</span>&nbsp;<span class="num" id="2252057">1</span><span class="op" id="2252058">)</span><span class="op" id="2252059">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252063">return</span>&nbsp;<span class="num" id="2252070">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2252073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252077">if</span>&nbsp;<span class="ident" id="2252080">n</span>&nbsp;<span class="op" id="2252082">==</span>&nbsp;<span class="num" id="2252085">0</span>&nbsp;<span class="op" id="2252087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252091">return</span>&nbsp;<span class="ident" id="2252098">Y0</span><span class="op" id="2252100">(</span><span class="ident" id="2252101">x</span><span class="op" id="2252102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2252105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252108">if</span>&nbsp;<span class="ident" id="2252111">x</span>&nbsp;<span class="op" id="2252113">==</span>&nbsp;<span class="num" id="2252116">0</span>&nbsp;<span class="op" id="2252118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252122">if</span>&nbsp;<span class="ident" id="2252125">n</span>&nbsp;<span class="op" id="2252127">&lt;</span>&nbsp;<span class="num" id="2252129">0</span>&nbsp;<span class="op" id="2252131">&amp;&amp;</span>&nbsp;<span class="ident" id="2252134">n</span><span class="op" id="2252135">&amp;</span><span class="num" id="2252136">1</span>&nbsp;<span class="op" id="2252138">==</span>&nbsp;<span class="num" id="2252141">1</span>&nbsp;<span class="op" id="2252143">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252148">return</span>&nbsp;<span class="ident" id="2252155">Inf</span><span class="op" id="2252158">(</span><span class="num" id="2252159">1</span><span class="op" id="2252160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2252164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252168">return</span>&nbsp;<span class="ident" id="2252175">Inf</span><span class="op" id="2252178">(</span><span class="op" id="2252179">-</span><span class="num" id="2252180">1</span><span class="op" id="2252181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2252184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2252187">sign</span>&nbsp;<span class="op" id="2252192">:=</span>&nbsp;<span class="builtintype" id="2252195">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252202">if</span>&nbsp;<span class="ident" id="2252205">n</span>&nbsp;<span class="op" id="2252207">&lt;</span>&nbsp;<span class="num" id="2252209">0</span>&nbsp;<span class="op" id="2252211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2252215">n</span>&nbsp;<span class="op" id="2252217">=</span>&nbsp;<span class="op" id="2252219">-</span><span class="ident" id="2252220">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252224">if</span>&nbsp;<span class="ident" id="2252227">n</span><span class="op" id="2252228">&amp;</span><span class="num" id="2252229">1</span>&nbsp;<span class="op" id="2252231">==</span>&nbsp;<span class="num" id="2252234">1</span>&nbsp;<span class="op" id="2252236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2252241">sign</span>&nbsp;<span class="op" id="2252246">=</span>&nbsp;<span class="builtintype" id="2252248">true</span>&nbsp;<span class="comment" id="2252253">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2252288">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2252291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252294">if</span>&nbsp;<span class="ident" id="2252297">n</span>&nbsp;<span class="op" id="2252299">==</span>&nbsp;<span class="num" id="2252302">1</span>&nbsp;<span class="op" id="2252304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252308">if</span>&nbsp;<span class="ident" id="2252311">sign</span>&nbsp;<span class="op" id="2252316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252321">return</span>&nbsp;<span class="op" id="2252328">-</span><span class="ident" id="2252329">Y1</span><span class="op" id="2252331">(</span><span class="ident" id="2252332">x</span><span class="op" id="2252333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2252337">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252341">return</span>&nbsp;<span class="ident" id="2252348">Y1</span><span class="op" id="2252350">(</span><span class="ident" id="2252351">x</span><span class="op" id="2252352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2252355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252358">var</span>&nbsp;<span class="ident" id="2252362">b</span>&nbsp;<span class="builtintype" id="2252364">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252373">if</span>&nbsp;<span class="ident" id="2252376">x</span>&nbsp;<span class="op" id="2252378">&gt;=</span>&nbsp;<span class="ident" id="2252381">Two302</span>&nbsp;<span class="op" id="2252388">{</span>&nbsp;<span class="comment" id="2252390">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252406">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252423">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252472">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252521">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252554">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252598">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252603">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252640">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252681">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252703">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252726">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252748">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252771">var</span>&nbsp;<span class="ident" id="2252775">temp</span>&nbsp;<span class="builtintype" id="2252780">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252790">switch</span>&nbsp;<span class="ident" id="2252797">n</span>&nbsp;<span class="op" id="2252799">&amp;</span>&nbsp;<span class="num" id="2252801">3</span>&nbsp;<span class="op" id="2252803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252807">case</span>&nbsp;<span class="num" id="2252812">0</span><span class="op" id="2252813">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2252818">temp</span>&nbsp;<span class="op" id="2252823">=</span>&nbsp;<span class="ident" id="2252825">Sin</span><span class="op" id="2252828">(</span><span class="ident" id="2252829">x</span><span class="op" id="2252830">)</span>&nbsp;<span class="op" id="2252832">-</span>&nbsp;<span class="ident" id="2252834">Cos</span><span class="op" id="2252837">(</span><span class="ident" id="2252838">x</span><span class="op" id="2252839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252843">case</span>&nbsp;<span class="num" id="2252848">1</span><span class="op" id="2252849">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2252854">temp</span>&nbsp;<span class="op" id="2252859">=</span>&nbsp;<span class="op" id="2252861">-</span><span class="ident" id="2252862">Sin</span><span class="op" id="2252865">(</span><span class="ident" id="2252866">x</span><span class="op" id="2252867">)</span>&nbsp;<span class="op" id="2252869">-</span>&nbsp;<span class="ident" id="2252871">Cos</span><span class="op" id="2252874">(</span><span class="ident" id="2252875">x</span><span class="op" id="2252876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252880">case</span>&nbsp;<span class="num" id="2252885">2</span><span class="op" id="2252886">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2252891">temp</span>&nbsp;<span class="op" id="2252896">=</span>&nbsp;<span class="op" id="2252898">-</span><span class="ident" id="2252899">Sin</span><span class="op" id="2252902">(</span><span class="ident" id="2252903">x</span><span class="op" id="2252904">)</span>&nbsp;<span class="op" id="2252906">+</span>&nbsp;<span class="ident" id="2252908">Cos</span><span class="op" id="2252911">(</span><span class="ident" id="2252912">x</span><span class="op" id="2252913">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2252917">case</span>&nbsp;<span class="num" id="2252922">3</span><span class="op" id="2252923">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2252928">temp</span>&nbsp;<span class="op" id="2252933">=</span>&nbsp;<span class="ident" id="2252935">Sin</span><span class="op" id="2252938">(</span><span class="ident" id="2252939">x</span><span class="op" id="2252940">)</span>&nbsp;<span class="op" id="2252942">+</span>&nbsp;<span class="ident" id="2252944">Cos</span><span class="op" id="2252947">(</span><span class="ident" id="2252948">x</span><span class="op" id="2252949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2252953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2252957">b</span>&nbsp;<span class="op" id="2252959">=</span>&nbsp;<span class="op" id="2252961">(</span><span class="num" id="2252962">1</span>&nbsp;<span class="op" id="2252964">/</span>&nbsp;<span class="ident" id="2252966">SqrtPi</span><span class="op" id="2252972">)</span>&nbsp;<span class="op" id="2252974">*</span>&nbsp;<span class="ident" id="2252976">temp</span>&nbsp;<span class="op" id="2252981">/</span>&nbsp;<span class="ident" id="2252983">Sqrt</span><span class="op" id="2252987">(</span><span class="ident" id="2252988">x</span><span class="op" id="2252989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2252992">}</span>&nbsp;<span class="keyword" id="2252994">else</span>&nbsp;<span class="op" id="2252999">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2253003">a</span>&nbsp;<span class="op" id="2253005">:=</span>&nbsp;<span class="ident" id="2253008">Y0</span><span class="op" id="2253010">(</span><span class="ident" id="2253011">x</span><span class="op" id="2253012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2253016">b</span>&nbsp;<span class="op" id="2253018">=</span>&nbsp;<span class="ident" id="2253020">Y1</span><span class="op" id="2253022">(</span><span class="ident" id="2253023">x</span><span class="op" id="2253024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2253028">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2253051">for</span>&nbsp;<span class="ident" id="2253055">i</span>&nbsp;<span class="op" id="2253057">:=</span>&nbsp;<span class="num" id="2253060">1</span><span class="op" id="2253061">;</span>&nbsp;<span class="ident" id="2253063">i</span>&nbsp;<span class="op" id="2253065">&lt;</span>&nbsp;<span class="ident" id="2253067">n</span>&nbsp;<span class="op" id="2253069">&amp;&amp;</span>&nbsp;<span class="op" id="2253072">!</span><span class="ident" id="2253073">IsInf</span><span class="op" id="2253078">(</span><span class="ident" id="2253079">b</span><span class="op" id="2253080">,</span>&nbsp;<span class="op" id="2253082">-</span><span class="num" id="2253083">1</span><span class="op" id="2253084">)</span><span class="op" id="2253085">;</span>&nbsp;<span class="ident" id="2253087">i</span><span class="op" id="2253088">++</span>&nbsp;<span class="op" id="2253091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2253096">a</span><span class="op" id="2253097">,</span>&nbsp;<span class="ident" id="2253099">b</span>&nbsp;<span class="op" id="2253101">=</span>&nbsp;<span class="ident" id="2253103">b</span><span class="op" id="2253104">,</span>&nbsp;<span class="op" id="2253106">(</span><span class="builtintype" id="2253107">float64</span><span class="op" id="2253114">(</span><span class="ident" id="2253115">i</span><span class="op" id="2253116">+</span><span class="ident" id="2253117">i</span><span class="op" id="2253118">)</span><span class="op" id="2253119">/</span><span class="ident" id="2253120">x</span><span class="op" id="2253121">)</span><span class="op" id="2253122">*</span><span class="ident" id="2253123">b</span><span class="op" id="2253124">-</span><span class="ident" id="2253125">a</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2253129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2253132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2253135">if</span>&nbsp;<span class="ident" id="2253138">sign</span>&nbsp;<span class="op" id="2253143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2253147">return</span>&nbsp;<span class="op" id="2253154">-</span><span class="ident" id="2253155">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2253158">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2253161">return</span>&nbsp;<span class="ident" id="2253168">b</span><br>
<span class="lineno"></span><span class="op" id="2253170">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
