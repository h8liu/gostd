<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7661037">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7661092">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7661146">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7661197">package</span>&nbsp;<span class="ident" id="7661205">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7661210">import</span>&nbsp;<span class="op" id="7661217">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661220">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661229">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661236">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661245">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661260">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661266">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661279">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661285">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661296">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7661306">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7661309">var</span>&nbsp;<span class="ident" id="7661313">filenames</span>&nbsp;<span class="op" id="7661323">=</span>&nbsp;<span class="op" id="7661325">[</span><span class="op" id="7661326">]</span><span class="builtintype" id="7661327">string</span><span class="op" id="7661333">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661336">&#34;basn0g01&#34;</span><span class="op" id="7661346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661349">&#34;basn0g01-30&#34;</span><span class="op" id="7661362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661365">&#34;basn0g02&#34;</span><span class="op" id="7661375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661378">&#34;basn0g02-29&#34;</span><span class="op" id="7661391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661394">&#34;basn0g04&#34;</span><span class="op" id="7661404">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661407">&#34;basn0g04-31&#34;</span><span class="op" id="7661420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661423">&#34;basn0g08&#34;</span><span class="op" id="7661433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661436">&#34;basn0g16&#34;</span><span class="op" id="7661446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661449">&#34;basn2c08&#34;</span><span class="op" id="7661459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661462">&#34;basn2c16&#34;</span><span class="op" id="7661472">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661475">&#34;basn3p01&#34;</span><span class="op" id="7661485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661488">&#34;basn3p02&#34;</span><span class="op" id="7661498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661501">&#34;basn3p04&#34;</span><span class="op" id="7661511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661514">&#34;basn3p04-31i&#34;</span><span class="op" id="7661528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661531">&#34;basn3p08&#34;</span><span class="op" id="7661541">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661544">&#34;basn3p08-trns&#34;</span><span class="op" id="7661559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661562">&#34;basn4a08&#34;</span><span class="op" id="7661572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661575">&#34;basn4a16&#34;</span><span class="op" id="7661585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661588">&#34;basn6a08&#34;</span><span class="op" id="7661598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661601">&#34;basn6a16&#34;</span><span class="op" id="7661611">,</span><br>
<span class="lineno">40</span><span class="op" id="7661613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7661616">var</span>&nbsp;<span class="ident" id="7661620">filenamesPaletted</span>&nbsp;<span class="op" id="7661638">=</span>&nbsp;<span class="op" id="7661640">[</span><span class="op" id="7661641">]</span><span class="builtintype" id="7661642">string</span><span class="op" id="7661648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661651">&#34;basn3p01&#34;</span><span class="op" id="7661661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661664">&#34;basn3p02&#34;</span><span class="op" id="7661674">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661677">&#34;basn3p04&#34;</span><span class="op" id="7661687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661690">&#34;basn3p08&#34;</span><span class="op" id="7661700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661703">&#34;basn3p08-trns&#34;</span><span class="op" id="7661718">,</span><br>
<span class="lineno"></span><span class="op" id="7661720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="7661723">var</span>&nbsp;<span class="ident" id="7661727">filenamesShort</span>&nbsp;<span class="op" id="7661742">=</span>&nbsp;<span class="op" id="7661744">[</span><span class="op" id="7661745">]</span><span class="builtintype" id="7661746">string</span><span class="op" id="7661752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661755">&#34;basn0g01&#34;</span><span class="op" id="7661765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661768">&#34;basn0g04-31&#34;</span><span class="op" id="7661781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7661784">&#34;basn6a16&#34;</span><span class="op" id="7661794">,</span><br>
<span class="lineno"></span><span class="op" id="7661796">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="7661799">func</span>&nbsp;<span class="ident" id="7661804">readPNG</span><span class="op" id="7661811">(</span><span class="ident" id="7661812">filename</span>&nbsp;<span class="builtintype" id="7661821">string</span><span class="op" id="7661827">)</span>&nbsp;<span class="op" id="7661829">(</span><span class="ident" id="7661830"><a href="/image/png/reader_test.go.html#7661236">image</a></span><span class="op" id="7661835">.</span><span class="ident" id="7661836">Image</span><span class="op" id="7661841">,</span>&nbsp;<span class="builtintype" id="7661843">error</span><span class="op" id="7661848">)</span>&nbsp;<span class="op" id="7661850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661853">f</span><span class="op" id="7661854">,</span>&nbsp;<span class="ident" id="7661856">err</span>&nbsp;<span class="op" id="7661860">:=</span>&nbsp;<span class="ident" id="7661863"><a href="/image/png/reader_test.go.html#7661279">os</a></span><span class="op" id="7661865">.</span><span class="ident" id="7661866">Open</span><span class="op" id="7661870">(</span><span class="ident" id="7661871"><a href="/image/png/reader_test.go.html#7661812">filename</a></span><span class="op" id="7661879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661882">if</span>&nbsp;<span class="ident" id="7661885"><a href="/image/png/reader_test.go.html#7661856">err</a></span>&nbsp;<span class="op" id="7661889">!=</span>&nbsp;<span class="ident" id="7661892">nil</span>&nbsp;<span class="op" id="7661896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661900">return</span>&nbsp;<span class="ident" id="7661907">nil</span><span class="op" id="7661910">,</span>&nbsp;<span class="ident" id="7661912"><a href="/image/png/reader_test.go.html#7661856">err</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661920">defer</span>&nbsp;<span class="ident" id="7661926"><a href="/image/png/reader_test.go.html#7661853">f</a></span><span class="op" id="7661927">.</span><span class="ident" id="7661928">Close</span><span class="op" id="7661933">(</span><span class="op" id="7661934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661937">return</span>&nbsp;<span class="ident" id="7661944"><a href="/image/png/reader.go.html#5596746">Decode</a></span><span class="op" id="7661950">(</span><span class="ident" id="7661951"><a href="/image/png/reader_test.go.html#7661853">f</a></span><span class="op" id="7661952">)</span><br>
<span class="lineno"></span><span class="op" id="7661954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="7661957">//&nbsp;An&nbsp;approximation&nbsp;of&nbsp;the&nbsp;sng&nbsp;command-line&nbsp;tool.</span><br>
<span class="lineno"></span><span class="keyword" id="7662007">func</span>&nbsp;<span class="ident" id="7662012">sng</span><span class="op" id="7662015">(</span><span class="ident" id="7662016">w</span>&nbsp;<span class="ident" id="7662018"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7662020">.</span><span class="ident" id="7662021">WriteCloser</span><span class="op" id="7662032">,</span>&nbsp;<span class="ident" id="7662034">filename</span>&nbsp;<span class="builtintype" id="7662043">string</span><span class="op" id="7662049">,</span>&nbsp;<span class="ident" id="7662051">png</span>&nbsp;<span class="ident" id="7662055"><a href="/image/png/reader_test.go.html#7661236">image</a></span><span class="op" id="7662060">.</span><span class="ident" id="7662061">Image</span><span class="op" id="7662066">)</span>&nbsp;<span class="op" id="7662068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662071">defer</span>&nbsp;<span class="ident" id="7662077"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7662078">.</span><span class="ident" id="7662079">Close</span><span class="op" id="7662084">(</span><span class="op" id="7662085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662088">bounds</span>&nbsp;<span class="op" id="7662095">:=</span>&nbsp;<span class="ident" id="7662098"><a href="/image/png/reader_test.go.html#7662051">png</a></span><span class="op" id="7662101">.</span><span class="ident" id="7662102">Bounds</span><span class="op" id="7662108">(</span><span class="op" id="7662109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662112">cm</span>&nbsp;<span class="op" id="7662115">:=</span>&nbsp;<span class="ident" id="7662118"><a href="/image/png/reader_test.go.html#7662051">png</a></span><span class="op" id="7662121">.</span><span class="ident" id="7662122">ColorModel</span><span class="op" id="7662132">(</span><span class="op" id="7662133">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662136">var</span>&nbsp;<span class="ident" id="7662140">bitdepth</span>&nbsp;<span class="builtintype" id="7662149">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662154">switch</span>&nbsp;<span class="ident" id="7662161"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7662164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662167">case</span>&nbsp;<span class="ident" id="7662172"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7662177">.</span><span class="ident" id="7662178">RGBAModel</span><span class="op" id="7662187">,</span>&nbsp;<span class="ident" id="7662189"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7662194">.</span><span class="ident" id="7662195">NRGBAModel</span><span class="op" id="7662205">,</span>&nbsp;<span class="ident" id="7662207"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7662212">.</span><span class="ident" id="7662213">AlphaModel</span><span class="op" id="7662223">,</span>&nbsp;<span class="ident" id="7662225"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7662230">.</span><span class="ident" id="7662231">GrayModel</span><span class="op" id="7662240">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662244"><a href="/image/png/reader_test.go.html#7662140">bitdepth</a></span>&nbsp;<span class="op" id="7662253">=</span>&nbsp;<span class="num" id="7662255">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662258">default</span><span class="op" id="7662265">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662269"><a href="/image/png/reader_test.go.html#7662140">bitdepth</a></span>&nbsp;<span class="op" id="7662278">=</span>&nbsp;<span class="num" id="7662280">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662287">cpm</span><span class="op" id="7662290">,</span>&nbsp;<span class="ident" id="7662292">_</span>&nbsp;<span class="op" id="7662294">:=</span>&nbsp;<span class="ident" id="7662297"><a href="/image/png/reader_test.go.html#7662112">cm</a></span><span class="op" id="7662299">.</span><span class="op" id="7662300">(</span><span class="ident" id="7662301"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7662306">.</span><span class="ident" id="7662307">Palette</span><span class="op" id="7662314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662317">var</span>&nbsp;<span class="ident" id="7662321">paletted</span>&nbsp;<span class="op" id="7662330">*</span><span class="ident" id="7662331"><a href="/image/png/reader_test.go.html#7661236">image</a></span><span class="op" id="7662336">.</span><span class="ident" id="7662337">Paletted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662347">if</span>&nbsp;<span class="ident" id="7662350"><a href="/image/png/reader_test.go.html#7662287">cpm</a></span>&nbsp;<span class="op" id="7662354">!=</span>&nbsp;<span class="ident" id="7662357">nil</span>&nbsp;<span class="op" id="7662361">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662365">switch</span>&nbsp;<span class="op" id="7662372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662376">case</span>&nbsp;<span class="builtinfunc" id="7662381">len</span><span class="op" id="7662384">(</span><span class="ident" id="7662385"><a href="/image/png/reader_test.go.html#7662287">cpm</a></span><span class="op" id="7662388">)</span>&nbsp;<span class="op" id="7662390">&lt;=</span>&nbsp;<span class="num" id="7662393">2</span><span class="op" id="7662394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662399"><a href="/image/png/reader_test.go.html#7662140">bitdepth</a></span>&nbsp;<span class="op" id="7662408">=</span>&nbsp;<span class="num" id="7662410">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662414">case</span>&nbsp;<span class="builtinfunc" id="7662419">len</span><span class="op" id="7662422">(</span><span class="ident" id="7662423"><a href="/image/png/reader_test.go.html#7662287">cpm</a></span><span class="op" id="7662426">)</span>&nbsp;<span class="op" id="7662428">&lt;=</span>&nbsp;<span class="num" id="7662431">4</span><span class="op" id="7662432">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662437"><a href="/image/png/reader_test.go.html#7662140">bitdepth</a></span>&nbsp;<span class="op" id="7662446">=</span>&nbsp;<span class="num" id="7662448">2</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662452">case</span>&nbsp;<span class="builtinfunc" id="7662457">len</span><span class="op" id="7662460">(</span><span class="ident" id="7662461"><a href="/image/png/reader_test.go.html#7662287">cpm</a></span><span class="op" id="7662464">)</span>&nbsp;<span class="op" id="7662466">&lt;=</span>&nbsp;<span class="num" id="7662469">16</span><span class="op" id="7662471">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662476"><a href="/image/png/reader_test.go.html#7662140">bitdepth</a></span>&nbsp;<span class="op" id="7662485">=</span>&nbsp;<span class="num" id="7662487">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662491">default</span><span class="op" id="7662498">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662503"><a href="/image/png/reader_test.go.html#7662140">bitdepth</a></span>&nbsp;<span class="op" id="7662512">=</span>&nbsp;<span class="num" id="7662514">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662518">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662522"><a href="/image/png/reader_test.go.html#7662321">paletted</a></span>&nbsp;<span class="op" id="7662531">=</span>&nbsp;<span class="ident" id="7662533"><a href="/image/png/reader_test.go.html#7662051">png</a></span><span class="op" id="7662536">.</span><span class="op" id="7662537">(</span><span class="op" id="7662538">*</span><span class="ident" id="7662539"><a href="/image/png/reader_test.go.html#7661236">image</a></span><span class="op" id="7662544">.</span><span class="ident" id="7662545">Paletted</span><span class="op" id="7662553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7662560">//&nbsp;Write&nbsp;the&nbsp;filename&nbsp;and&nbsp;IHDR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662593"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7662595">.</span><span class="ident" id="7662596">WriteString</span><span class="op" id="7662607">(</span><span class="ident" id="7662608"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7662609">,</span>&nbsp;<span class="string" id="7662611">&#34;#SNG:&nbsp;from&nbsp;&#34;</span><span class="op" id="7662624">+</span><span class="ident" id="7662625"><a href="/image/png/reader_test.go.html#7662034">filename</a></span><span class="op" id="7662633">+</span><span class="string" id="7662634">&#34;.png\nIHDR&nbsp;{\n&#34;</span><span class="op" id="7662650">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662653"><a href="/image/png/reader_test.go.html#7661229">fmt</a></span><span class="op" id="7662656">.</span><span class="ident" id="7662657">Fprintf</span><span class="op" id="7662664">(</span><span class="ident" id="7662665"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7662666">,</span>&nbsp;<span class="string" id="7662668">&#34;&nbsp;&nbsp;&nbsp;&nbsp;width:&nbsp;%d;&nbsp;height:&nbsp;%d;&nbsp;bitdepth:&nbsp;%d;\n&#34;</span><span class="op" id="7662712">,</span>&nbsp;<span class="ident" id="7662714"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7662720">.</span><span class="ident" id="7662721">Dx</span><span class="op" id="7662723">(</span><span class="op" id="7662724">)</span><span class="op" id="7662725">,</span>&nbsp;<span class="ident" id="7662727"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7662733">.</span><span class="ident" id="7662734">Dy</span><span class="op" id="7662736">(</span><span class="op" id="7662737">)</span><span class="op" id="7662738">,</span>&nbsp;<span class="ident" id="7662740"><a href="/image/png/reader_test.go.html#7662140">bitdepth</a></span><span class="op" id="7662748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662751">switch</span>&nbsp;<span class="op" id="7662758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662761">case</span>&nbsp;<span class="ident" id="7662766"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7662769">==</span>&nbsp;<span class="ident" id="7662772"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7662777">.</span><span class="ident" id="7662778">RGBAModel</span><span class="op" id="7662787">,</span>&nbsp;<span class="ident" id="7662789"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7662792">==</span>&nbsp;<span class="ident" id="7662795"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7662800">.</span><span class="ident" id="7662801">RGBA64Model</span><span class="op" id="7662812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662816"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7662818">.</span><span class="ident" id="7662819">WriteString</span><span class="op" id="7662830">(</span><span class="ident" id="7662831"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7662832">,</span>&nbsp;<span class="string" id="7662834">&#34;&nbsp;&nbsp;&nbsp;&nbsp;using&nbsp;color;\n&#34;</span><span class="op" id="7662854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662857">case</span>&nbsp;<span class="ident" id="7662862"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7662865">==</span>&nbsp;<span class="ident" id="7662868"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7662873">.</span><span class="ident" id="7662874">NRGBAModel</span><span class="op" id="7662884">,</span>&nbsp;<span class="ident" id="7662886"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7662889">==</span>&nbsp;<span class="ident" id="7662892"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7662897">.</span><span class="ident" id="7662898">NRGBA64Model</span><span class="op" id="7662910">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662914"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7662916">.</span><span class="ident" id="7662917">WriteString</span><span class="op" id="7662928">(</span><span class="ident" id="7662929"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7662930">,</span>&nbsp;<span class="string" id="7662932">&#34;&nbsp;&nbsp;&nbsp;&nbsp;using&nbsp;color&nbsp;alpha;\n&#34;</span><span class="op" id="7662958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662961">case</span>&nbsp;<span class="ident" id="7662966"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7662969">==</span>&nbsp;<span class="ident" id="7662972"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7662977">.</span><span class="ident" id="7662978">GrayModel</span><span class="op" id="7662987">,</span>&nbsp;<span class="ident" id="7662989"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7662992">==</span>&nbsp;<span class="ident" id="7662995"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7663000">.</span><span class="ident" id="7663001">Gray16Model</span><span class="op" id="7663012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663016"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7663018">.</span><span class="ident" id="7663019">WriteString</span><span class="op" id="7663030">(</span><span class="ident" id="7663031"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7663032">,</span>&nbsp;<span class="string" id="7663034">&#34;&nbsp;&nbsp;&nbsp;&nbsp;using&nbsp;grayscale;\n&#34;</span><span class="op" id="7663058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663061">case</span>&nbsp;<span class="ident" id="7663066"><a href="/image/png/reader_test.go.html#7662287">cpm</a></span>&nbsp;<span class="op" id="7663070">!=</span>&nbsp;<span class="ident" id="7663073">nil</span><span class="op" id="7663076">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663080"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7663082">.</span><span class="ident" id="7663083">WriteString</span><span class="op" id="7663094">(</span><span class="ident" id="7663095"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7663096">,</span>&nbsp;<span class="string" id="7663098">&#34;&nbsp;&nbsp;&nbsp;&nbsp;using&nbsp;color&nbsp;palette;\n&#34;</span><span class="op" id="7663126">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663129">default</span><span class="op" id="7663136">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663140"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7663142">.</span><span class="ident" id="7663143">WriteString</span><span class="op" id="7663154">(</span><span class="ident" id="7663155"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7663156">,</span>&nbsp;<span class="string" id="7663158">&#34;unknown&nbsp;PNG&nbsp;decoder&nbsp;color&nbsp;model\n&#34;</span><span class="op" id="7663193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7663196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663199"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7663201">.</span><span class="ident" id="7663202">WriteString</span><span class="op" id="7663213">(</span><span class="ident" id="7663214"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7663215">,</span>&nbsp;<span class="string" id="7663217">&#34;}\n&#34;</span><span class="op" id="7663222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7663226">//&nbsp;We&nbsp;fake&nbsp;a&nbsp;gAMA&nbsp;output.&nbsp;The&nbsp;test&nbsp;files&nbsp;have&nbsp;a&nbsp;gAMA&nbsp;chunk&nbsp;but&nbsp;the&nbsp;go&nbsp;PNG&nbsp;parser&nbsp;ignores&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7663319">//&nbsp;(the&nbsp;PNG&nbsp;spec&nbsp;section&nbsp;11.3&nbsp;says&nbsp;&#34;Ancillary&nbsp;chunks&nbsp;may&nbsp;be&nbsp;ignored&nbsp;by&nbsp;a&nbsp;decoder&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663404"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7663406">.</span><span class="ident" id="7663407">WriteString</span><span class="op" id="7663418">(</span><span class="ident" id="7663419"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7663420">,</span>&nbsp;<span class="string" id="7663422">&#34;gAMA&nbsp;{1.0000}\n&#34;</span><span class="op" id="7663439">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7663443">//&nbsp;Write&nbsp;the&nbsp;PLTE&nbsp;and&nbsp;tRNS&nbsp;(if&nbsp;applicable).</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663488">if</span>&nbsp;<span class="ident" id="7663491"><a href="/image/png/reader_test.go.html#7662287">cpm</a></span>&nbsp;<span class="op" id="7663495">!=</span>&nbsp;<span class="ident" id="7663498">nil</span>&nbsp;<span class="op" id="7663502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663506">lastAlpha</span>&nbsp;<span class="op" id="7663516">:=</span>&nbsp;<span class="op" id="7663519">-</span><span class="num" id="7663520">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663524"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7663526">.</span><span class="ident" id="7663527">WriteString</span><span class="op" id="7663538">(</span><span class="ident" id="7663539"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7663540">,</span>&nbsp;<span class="string" id="7663542">&#34;PLTE&nbsp;{\n&#34;</span><span class="op" id="7663552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663556">for</span>&nbsp;<span class="ident" id="7663560">i</span><span class="op" id="7663561">,</span>&nbsp;<span class="ident" id="7663563">c</span>&nbsp;<span class="op" id="7663565">:=</span>&nbsp;<span class="keyword" id="7663568">range</span>&nbsp;<span class="ident" id="7663574"><a href="/image/png/reader_test.go.html#7662287">cpm</a></span>&nbsp;<span class="op" id="7663578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663583">var</span>&nbsp;<span class="ident" id="7663587">r</span><span class="op" id="7663588">,</span>&nbsp;<span class="ident" id="7663590">g</span><span class="op" id="7663591">,</span>&nbsp;<span class="ident" id="7663593">b</span><span class="op" id="7663594">,</span>&nbsp;<span class="ident" id="7663596">a</span>&nbsp;<span class="builtintype" id="7663598">uint8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663607">switch</span>&nbsp;<span class="ident" id="7663614">c</span>&nbsp;<span class="op" id="7663616">:=</span>&nbsp;<span class="ident" id="7663619"><a href="/image/png/reader_test.go.html#7663563">c</a></span><span class="op" id="7663620">.</span><span class="op" id="7663621">(</span><span class="keyword" id="7663622">type</span><span class="op" id="7663626">)</span>&nbsp;<span class="op" id="7663628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663633">case</span>&nbsp;<span class="ident" id="7663638"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7663643">.</span><span class="ident" id="7663644">RGBA</span><span class="op" id="7663648">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663654"><a href="/image/png/reader_test.go.html#7663587">r</a></span><span class="op" id="7663655">,</span>&nbsp;<span class="ident" id="7663657"><a href="/image/png/reader_test.go.html#7663590">g</a></span><span class="op" id="7663658">,</span>&nbsp;<span class="ident" id="7663660"><a href="/image/png/reader_test.go.html#7663593">b</a></span><span class="op" id="7663661">,</span>&nbsp;<span class="ident" id="7663663"><a href="/image/png/reader_test.go.html#7663596">a</a></span>&nbsp;<span class="op" id="7663665">=</span>&nbsp;<span class="ident" id="7663667"><a href="/image/png/reader_test.go.html#7663614">c</a></span><span class="op" id="7663668">.</span><span class="ident" id="7663669">R</span><span class="op" id="7663670">,</span>&nbsp;<span class="ident" id="7663672"><a href="/image/png/reader_test.go.html#7663614">c</a></span><span class="op" id="7663673">.</span><span class="ident" id="7663674">G</span><span class="op" id="7663675">,</span>&nbsp;<span class="ident" id="7663677"><a href="/image/png/reader_test.go.html#7663614">c</a></span><span class="op" id="7663678">.</span><span class="ident" id="7663679">B</span><span class="op" id="7663680">,</span>&nbsp;<span class="num" id="7663682">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663690">case</span>&nbsp;<span class="ident" id="7663695"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7663700">.</span><span class="ident" id="7663701">NRGBA</span><span class="op" id="7663706">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663712"><a href="/image/png/reader_test.go.html#7663587">r</a></span><span class="op" id="7663713">,</span>&nbsp;<span class="ident" id="7663715"><a href="/image/png/reader_test.go.html#7663590">g</a></span><span class="op" id="7663716">,</span>&nbsp;<span class="ident" id="7663718"><a href="/image/png/reader_test.go.html#7663593">b</a></span><span class="op" id="7663719">,</span>&nbsp;<span class="ident" id="7663721"><a href="/image/png/reader_test.go.html#7663596">a</a></span>&nbsp;<span class="op" id="7663723">=</span>&nbsp;<span class="ident" id="7663725"><a href="/image/png/reader_test.go.html#7663614">c</a></span><span class="op" id="7663726">.</span><span class="ident" id="7663727">R</span><span class="op" id="7663728">,</span>&nbsp;<span class="ident" id="7663730"><a href="/image/png/reader_test.go.html#7663614">c</a></span><span class="op" id="7663731">.</span><span class="ident" id="7663732">G</span><span class="op" id="7663733">,</span>&nbsp;<span class="ident" id="7663735"><a href="/image/png/reader_test.go.html#7663614">c</a></span><span class="op" id="7663736">.</span><span class="ident" id="7663737">B</span><span class="op" id="7663738">,</span>&nbsp;<span class="ident" id="7663740"><a href="/image/png/reader_test.go.html#7663614">c</a></span><span class="op" id="7663741">.</span><span class="ident" id="7663742">A</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663747">default</span><span class="op" id="7663754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7663760">panic</span><span class="op" id="7663765">(</span><span class="string" id="7663766">&#34;unknown&nbsp;palette&nbsp;color&nbsp;type&#34;</span><span class="op" id="7663794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7663799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663804">if</span>&nbsp;<span class="ident" id="7663807"><a href="/image/png/reader_test.go.html#7663596">a</a></span>&nbsp;<span class="op" id="7663809">!=</span>&nbsp;<span class="num" id="7663812">0xff</span>&nbsp;<span class="op" id="7663817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663823"><a href="/image/png/reader_test.go.html#7663506">lastAlpha</a></span>&nbsp;<span class="op" id="7663833">=</span>&nbsp;<span class="ident" id="7663835"><a href="/image/png/reader_test.go.html#7663560">i</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7663840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663845"><a href="/image/png/reader_test.go.html#7661229">fmt</a></span><span class="op" id="7663848">.</span><span class="ident" id="7663849">Fprintf</span><span class="op" id="7663856">(</span><span class="ident" id="7663857"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7663858">,</span>&nbsp;<span class="string" id="7663860">&#34;&nbsp;&nbsp;&nbsp;&nbsp;(%3d,%3d,%3d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;rgb&nbsp;=&nbsp;(0x%02x,0x%02x,0x%02x)\n&#34;</span><span class="op" id="7663916">,</span>&nbsp;<span class="ident" id="7663918"><a href="/image/png/reader_test.go.html#7663587">r</a></span><span class="op" id="7663919">,</span>&nbsp;<span class="ident" id="7663921"><a href="/image/png/reader_test.go.html#7663590">g</a></span><span class="op" id="7663922">,</span>&nbsp;<span class="ident" id="7663924"><a href="/image/png/reader_test.go.html#7663593">b</a></span><span class="op" id="7663925">,</span>&nbsp;<span class="ident" id="7663927"><a href="/image/png/reader_test.go.html#7663587">r</a></span><span class="op" id="7663928">,</span>&nbsp;<span class="ident" id="7663930"><a href="/image/png/reader_test.go.html#7663590">g</a></span><span class="op" id="7663931">,</span>&nbsp;<span class="ident" id="7663933"><a href="/image/png/reader_test.go.html#7663593">b</a></span><span class="op" id="7663934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7663938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663942"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7663944">.</span><span class="ident" id="7663945">WriteString</span><span class="op" id="7663956">(</span><span class="ident" id="7663957"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7663958">,</span>&nbsp;<span class="string" id="7663960">&#34;}\n&#34;</span><span class="op" id="7663965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7663969">if</span>&nbsp;<span class="ident" id="7663972"><a href="/image/png/reader_test.go.html#7663506">lastAlpha</a></span>&nbsp;<span class="op" id="7663982">!=</span>&nbsp;<span class="op" id="7663985">-</span><span class="num" id="7663986">1</span>&nbsp;<span class="op" id="7663988">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7663993"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7663995">.</span><span class="ident" id="7663996">WriteString</span><span class="op" id="7664007">(</span><span class="ident" id="7664008"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7664009">,</span>&nbsp;<span class="string" id="7664011">&#34;tRNS&nbsp;{\n&#34;</span><span class="op" id="7664021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664026">for</span>&nbsp;<span class="ident" id="7664030">i</span>&nbsp;<span class="op" id="7664032">:=</span>&nbsp;<span class="num" id="7664035">0</span><span class="op" id="7664036">;</span>&nbsp;<span class="ident" id="7664038"><a href="/image/png/reader_test.go.html#7664030">i</a></span>&nbsp;<span class="op" id="7664040">&lt;=</span>&nbsp;<span class="ident" id="7664043"><a href="/image/png/reader_test.go.html#7663506">lastAlpha</a></span><span class="op" id="7664052">;</span>&nbsp;<span class="ident" id="7664054"><a href="/image/png/reader_test.go.html#7664030">i</a></span><span class="op" id="7664055">++</span>&nbsp;<span class="op" id="7664058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664064">_</span><span class="op" id="7664065">,</span>&nbsp;<span class="ident" id="7664067">_</span><span class="op" id="7664068">,</span>&nbsp;<span class="ident" id="7664070">_</span><span class="op" id="7664071">,</span>&nbsp;<span class="ident" id="7664073">a</span>&nbsp;<span class="op" id="7664075">:=</span>&nbsp;<span class="ident" id="7664078"><a href="/image/png/reader_test.go.html#7662287">cpm</a></span><span class="op" id="7664081">[</span><span class="ident" id="7664082"><a href="/image/png/reader_test.go.html#7664030">i</a></span><span class="op" id="7664083">]</span><span class="op" id="7664084">.</span><span class="ident" id="7664085">RGBA</span><span class="op" id="7664089">(</span><span class="op" id="7664090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664096"><a href="/image/png/reader_test.go.html#7664073">a</a></span>&nbsp;<span class="op" id="7664098">&gt;&gt;=</span>&nbsp;<span class="num" id="7664102">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664108"><a href="/image/png/reader_test.go.html#7661229">fmt</a></span><span class="op" id="7664111">.</span><span class="ident" id="7664112">Fprintf</span><span class="op" id="7664119">(</span><span class="ident" id="7664120"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7664121">,</span>&nbsp;<span class="string" id="7664123">&#34;&nbsp;%d&#34;</span><span class="op" id="7664128">,</span>&nbsp;<span class="ident" id="7664130"><a href="/image/png/reader_test.go.html#7664073">a</a></span><span class="op" id="7664131">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664141"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7664143">.</span><span class="ident" id="7664144">WriteString</span><span class="op" id="7664155">(</span><span class="ident" id="7664156"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7664157">,</span>&nbsp;<span class="string" id="7664159">&#34;}\n&#34;</span><span class="op" id="7664164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7664175">//&nbsp;Write&nbsp;the&nbsp;IMAGE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664196"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7664198">.</span><span class="ident" id="7664199">WriteString</span><span class="op" id="7664210">(</span><span class="ident" id="7664211"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7664212">,</span>&nbsp;<span class="string" id="7664214">&#34;IMAGE&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;pixels&nbsp;hex\n&#34;</span><span class="op" id="7664241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664244">for</span>&nbsp;<span class="ident" id="7664248">y</span>&nbsp;<span class="op" id="7664250">:=</span>&nbsp;<span class="ident" id="7664253"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7664259">.</span><span class="ident" id="7664260">Min</span><span class="op" id="7664263">.</span><span class="ident" id="7664264">Y</span><span class="op" id="7664265">;</span>&nbsp;<span class="ident" id="7664267"><a href="/image/png/reader_test.go.html#7664248">y</a></span>&nbsp;<span class="op" id="7664269">&lt;</span>&nbsp;<span class="ident" id="7664271"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7664277">.</span><span class="ident" id="7664278">Max</span><span class="op" id="7664281">.</span><span class="ident" id="7664282">Y</span><span class="op" id="7664283">;</span>&nbsp;<span class="ident" id="7664285"><a href="/image/png/reader_test.go.html#7664248">y</a></span><span class="op" id="7664286">++</span>&nbsp;<span class="op" id="7664289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664293">switch</span>&nbsp;<span class="op" id="7664300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664304">case</span>&nbsp;<span class="ident" id="7664309"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7664312">==</span>&nbsp;<span class="ident" id="7664315"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7664320">.</span><span class="ident" id="7664321">GrayModel</span><span class="op" id="7664330">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664335">for</span>&nbsp;<span class="ident" id="7664339">x</span>&nbsp;<span class="op" id="7664341">:=</span>&nbsp;<span class="ident" id="7664344"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7664350">.</span><span class="ident" id="7664351">Min</span><span class="op" id="7664354">.</span><span class="ident" id="7664355">X</span><span class="op" id="7664356">;</span>&nbsp;<span class="ident" id="7664358"><a href="/image/png/reader_test.go.html#7664339">x</a></span>&nbsp;<span class="op" id="7664360">&lt;</span>&nbsp;<span class="ident" id="7664362"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7664368">.</span><span class="ident" id="7664369">Max</span><span class="op" id="7664372">.</span><span class="ident" id="7664373">X</span><span class="op" id="7664374">;</span>&nbsp;<span class="ident" id="7664376"><a href="/image/png/reader_test.go.html#7664339">x</a></span><span class="op" id="7664377">++</span>&nbsp;<span class="op" id="7664380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664386">gray</span>&nbsp;<span class="op" id="7664391">:=</span>&nbsp;<span class="ident" id="7664394"><a href="/image/png/reader_test.go.html#7662051">png</a></span><span class="op" id="7664397">.</span><span class="ident" id="7664398">At</span><span class="op" id="7664400">(</span><span class="ident" id="7664401"><a href="/image/png/reader_test.go.html#7664339">x</a></span><span class="op" id="7664402">,</span>&nbsp;<span class="ident" id="7664404"><a href="/image/png/reader_test.go.html#7664248">y</a></span><span class="op" id="7664405">)</span><span class="op" id="7664406">.</span><span class="op" id="7664407">(</span><span class="ident" id="7664408"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7664413">.</span><span class="ident" id="7664414">Gray</span><span class="op" id="7664418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664424"><a href="/image/png/reader_test.go.html#7661229">fmt</a></span><span class="op" id="7664427">.</span><span class="ident" id="7664428">Fprintf</span><span class="op" id="7664435">(</span><span class="ident" id="7664436"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7664437">,</span>&nbsp;<span class="string" id="7664439">&#34;%02x&#34;</span><span class="op" id="7664445">,</span>&nbsp;<span class="ident" id="7664447"><a href="/image/png/reader_test.go.html#7664386">gray</a></span><span class="op" id="7664451">.</span><span class="ident" id="7664452">Y</span><span class="op" id="7664453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664462">case</span>&nbsp;<span class="ident" id="7664467"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7664470">==</span>&nbsp;<span class="ident" id="7664473"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7664478">.</span><span class="ident" id="7664479">Gray16Model</span><span class="op" id="7664490">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664495">for</span>&nbsp;<span class="ident" id="7664499">x</span>&nbsp;<span class="op" id="7664501">:=</span>&nbsp;<span class="ident" id="7664504"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7664510">.</span><span class="ident" id="7664511">Min</span><span class="op" id="7664514">.</span><span class="ident" id="7664515">X</span><span class="op" id="7664516">;</span>&nbsp;<span class="ident" id="7664518"><a href="/image/png/reader_test.go.html#7664499">x</a></span>&nbsp;<span class="op" id="7664520">&lt;</span>&nbsp;<span class="ident" id="7664522"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7664528">.</span><span class="ident" id="7664529">Max</span><span class="op" id="7664532">.</span><span class="ident" id="7664533">X</span><span class="op" id="7664534">;</span>&nbsp;<span class="ident" id="7664536"><a href="/image/png/reader_test.go.html#7664499">x</a></span><span class="op" id="7664537">++</span>&nbsp;<span class="op" id="7664540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664546">gray16</span>&nbsp;<span class="op" id="7664553">:=</span>&nbsp;<span class="ident" id="7664556"><a href="/image/png/reader_test.go.html#7662051">png</a></span><span class="op" id="7664559">.</span><span class="ident" id="7664560">At</span><span class="op" id="7664562">(</span><span class="ident" id="7664563"><a href="/image/png/reader_test.go.html#7664499">x</a></span><span class="op" id="7664564">,</span>&nbsp;<span class="ident" id="7664566"><a href="/image/png/reader_test.go.html#7664248">y</a></span><span class="op" id="7664567">)</span><span class="op" id="7664568">.</span><span class="op" id="7664569">(</span><span class="ident" id="7664570"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7664575">.</span><span class="ident" id="7664576">Gray16</span><span class="op" id="7664582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664588"><a href="/image/png/reader_test.go.html#7661229">fmt</a></span><span class="op" id="7664591">.</span><span class="ident" id="7664592">Fprintf</span><span class="op" id="7664599">(</span><span class="ident" id="7664600"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7664601">,</span>&nbsp;<span class="string" id="7664603">&#34;%04x&nbsp;&#34;</span><span class="op" id="7664610">,</span>&nbsp;<span class="ident" id="7664612"><a href="/image/png/reader_test.go.html#7664546">gray16</a></span><span class="op" id="7664618">.</span><span class="ident" id="7664619">Y</span><span class="op" id="7664620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664629">case</span>&nbsp;<span class="ident" id="7664634"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7664637">==</span>&nbsp;<span class="ident" id="7664640"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7664645">.</span><span class="ident" id="7664646">RGBAModel</span><span class="op" id="7664655">:</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664660">for</span>&nbsp;<span class="ident" id="7664664">x</span>&nbsp;<span class="op" id="7664666">:=</span>&nbsp;<span class="ident" id="7664669"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7664675">.</span><span class="ident" id="7664676">Min</span><span class="op" id="7664679">.</span><span class="ident" id="7664680">X</span><span class="op" id="7664681">;</span>&nbsp;<span class="ident" id="7664683"><a href="/image/png/reader_test.go.html#7664664">x</a></span>&nbsp;<span class="op" id="7664685">&lt;</span>&nbsp;<span class="ident" id="7664687"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7664693">.</span><span class="ident" id="7664694">Max</span><span class="op" id="7664697">.</span><span class="ident" id="7664698">X</span><span class="op" id="7664699">;</span>&nbsp;<span class="ident" id="7664701"><a href="/image/png/reader_test.go.html#7664664">x</a></span><span class="op" id="7664702">++</span>&nbsp;<span class="op" id="7664705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664711">rgba</span>&nbsp;<span class="op" id="7664716">:=</span>&nbsp;<span class="ident" id="7664719"><a href="/image/png/reader_test.go.html#7662051">png</a></span><span class="op" id="7664722">.</span><span class="ident" id="7664723">At</span><span class="op" id="7664725">(</span><span class="ident" id="7664726"><a href="/image/png/reader_test.go.html#7664664">x</a></span><span class="op" id="7664727">,</span>&nbsp;<span class="ident" id="7664729"><a href="/image/png/reader_test.go.html#7664248">y</a></span><span class="op" id="7664730">)</span><span class="op" id="7664731">.</span><span class="op" id="7664732">(</span><span class="ident" id="7664733"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7664738">.</span><span class="ident" id="7664739">RGBA</span><span class="op" id="7664743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664749"><a href="/image/png/reader_test.go.html#7661229">fmt</a></span><span class="op" id="7664752">.</span><span class="ident" id="7664753">Fprintf</span><span class="op" id="7664760">(</span><span class="ident" id="7664761"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7664762">,</span>&nbsp;<span class="string" id="7664764">&#34;%02x%02x%02x&nbsp;&#34;</span><span class="op" id="7664779">,</span>&nbsp;<span class="ident" id="7664781"><a href="/image/png/reader_test.go.html#7664711">rgba</a></span><span class="op" id="7664785">.</span><span class="ident" id="7664786">R</span><span class="op" id="7664787">,</span>&nbsp;<span class="ident" id="7664789"><a href="/image/png/reader_test.go.html#7664711">rgba</a></span><span class="op" id="7664793">.</span><span class="ident" id="7664794">G</span><span class="op" id="7664795">,</span>&nbsp;<span class="ident" id="7664797"><a href="/image/png/reader_test.go.html#7664711">rgba</a></span><span class="op" id="7664801">.</span><span class="ident" id="7664802">B</span><span class="op" id="7664803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7664808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664812">case</span>&nbsp;<span class="ident" id="7664817"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7664820">==</span>&nbsp;<span class="ident" id="7664823"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7664828">.</span><span class="ident" id="7664829">RGBA64Model</span><span class="op" id="7664840">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7664845">for</span>&nbsp;<span class="ident" id="7664849">x</span>&nbsp;<span class="op" id="7664851">:=</span>&nbsp;<span class="ident" id="7664854"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7664860">.</span><span class="ident" id="7664861">Min</span><span class="op" id="7664864">.</span><span class="ident" id="7664865">X</span><span class="op" id="7664866">;</span>&nbsp;<span class="ident" id="7664868"><a href="/image/png/reader_test.go.html#7664849">x</a></span>&nbsp;<span class="op" id="7664870">&lt;</span>&nbsp;<span class="ident" id="7664872"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7664878">.</span><span class="ident" id="7664879">Max</span><span class="op" id="7664882">.</span><span class="ident" id="7664883">X</span><span class="op" id="7664884">;</span>&nbsp;<span class="ident" id="7664886"><a href="/image/png/reader_test.go.html#7664849">x</a></span><span class="op" id="7664887">++</span>&nbsp;<span class="op" id="7664890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664896">rgba64</span>&nbsp;<span class="op" id="7664903">:=</span>&nbsp;<span class="ident" id="7664906"><a href="/image/png/reader_test.go.html#7662051">png</a></span><span class="op" id="7664909">.</span><span class="ident" id="7664910">At</span><span class="op" id="7664912">(</span><span class="ident" id="7664913"><a href="/image/png/reader_test.go.html#7664849">x</a></span><span class="op" id="7664914">,</span>&nbsp;<span class="ident" id="7664916"><a href="/image/png/reader_test.go.html#7664248">y</a></span><span class="op" id="7664917">)</span><span class="op" id="7664918">.</span><span class="op" id="7664919">(</span><span class="ident" id="7664920"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7664925">.</span><span class="ident" id="7664926">RGBA64</span><span class="op" id="7664932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7664938"><a href="/image/png/reader_test.go.html#7661229">fmt</a></span><span class="op" id="7664941">.</span><span class="ident" id="7664942">Fprintf</span><span class="op" id="7664949">(</span><span class="ident" id="7664950"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7664951">,</span>&nbsp;<span class="string" id="7664953">&#34;%04x%04x%04x&nbsp;&#34;</span><span class="op" id="7664968">,</span>&nbsp;<span class="ident" id="7664970"><a href="/image/png/reader_test.go.html#7664896">rgba64</a></span><span class="op" id="7664976">.</span><span class="ident" id="7664977">R</span><span class="op" id="7664978">,</span>&nbsp;<span class="ident" id="7664980"><a href="/image/png/reader_test.go.html#7664896">rgba64</a></span><span class="op" id="7664986">.</span><span class="ident" id="7664987">G</span><span class="op" id="7664988">,</span>&nbsp;<span class="ident" id="7664990"><a href="/image/png/reader_test.go.html#7664896">rgba64</a></span><span class="op" id="7664996">.</span><span class="ident" id="7664997">B</span><span class="op" id="7664998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665007">case</span>&nbsp;<span class="ident" id="7665012"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7665015">==</span>&nbsp;<span class="ident" id="7665018"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7665023">.</span><span class="ident" id="7665024">NRGBAModel</span><span class="op" id="7665034">:</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665039">for</span>&nbsp;<span class="ident" id="7665043">x</span>&nbsp;<span class="op" id="7665045">:=</span>&nbsp;<span class="ident" id="7665048"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7665054">.</span><span class="ident" id="7665055">Min</span><span class="op" id="7665058">.</span><span class="ident" id="7665059">X</span><span class="op" id="7665060">;</span>&nbsp;<span class="ident" id="7665062"><a href="/image/png/reader_test.go.html#7665043">x</a></span>&nbsp;<span class="op" id="7665064">&lt;</span>&nbsp;<span class="ident" id="7665066"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7665072">.</span><span class="ident" id="7665073">Max</span><span class="op" id="7665076">.</span><span class="ident" id="7665077">X</span><span class="op" id="7665078">;</span>&nbsp;<span class="ident" id="7665080"><a href="/image/png/reader_test.go.html#7665043">x</a></span><span class="op" id="7665081">++</span>&nbsp;<span class="op" id="7665084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665090">nrgba</span>&nbsp;<span class="op" id="7665096">:=</span>&nbsp;<span class="ident" id="7665099"><a href="/image/png/reader_test.go.html#7662051">png</a></span><span class="op" id="7665102">.</span><span class="ident" id="7665103">At</span><span class="op" id="7665105">(</span><span class="ident" id="7665106"><a href="/image/png/reader_test.go.html#7665043">x</a></span><span class="op" id="7665107">,</span>&nbsp;<span class="ident" id="7665109"><a href="/image/png/reader_test.go.html#7664248">y</a></span><span class="op" id="7665110">)</span><span class="op" id="7665111">.</span><span class="op" id="7665112">(</span><span class="ident" id="7665113"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7665118">.</span><span class="ident" id="7665119">NRGBA</span><span class="op" id="7665124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665130"><a href="/image/png/reader_test.go.html#7661229">fmt</a></span><span class="op" id="7665133">.</span><span class="ident" id="7665134">Fprintf</span><span class="op" id="7665141">(</span><span class="ident" id="7665142"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7665143">,</span>&nbsp;<span class="string" id="7665145">&#34;%02x%02x%02x%02x&nbsp;&#34;</span><span class="op" id="7665164">,</span>&nbsp;<span class="ident" id="7665166"><a href="/image/png/reader_test.go.html#7665090">nrgba</a></span><span class="op" id="7665171">.</span><span class="ident" id="7665172">R</span><span class="op" id="7665173">,</span>&nbsp;<span class="ident" id="7665175"><a href="/image/png/reader_test.go.html#7665090">nrgba</a></span><span class="op" id="7665180">.</span><span class="ident" id="7665181">G</span><span class="op" id="7665182">,</span>&nbsp;<span class="ident" id="7665184"><a href="/image/png/reader_test.go.html#7665090">nrgba</a></span><span class="op" id="7665189">.</span><span class="ident" id="7665190">B</span><span class="op" id="7665191">,</span>&nbsp;<span class="ident" id="7665193"><a href="/image/png/reader_test.go.html#7665090">nrgba</a></span><span class="op" id="7665198">.</span><span class="ident" id="7665199">A</span><span class="op" id="7665200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665209">case</span>&nbsp;<span class="ident" id="7665214"><a href="/image/png/reader_test.go.html#7662112">cm</a></span>&nbsp;<span class="op" id="7665217">==</span>&nbsp;<span class="ident" id="7665220"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7665225">.</span><span class="ident" id="7665226">NRGBA64Model</span><span class="op" id="7665238">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665243">for</span>&nbsp;<span class="ident" id="7665247">x</span>&nbsp;<span class="op" id="7665249">:=</span>&nbsp;<span class="ident" id="7665252"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7665258">.</span><span class="ident" id="7665259">Min</span><span class="op" id="7665262">.</span><span class="ident" id="7665263">X</span><span class="op" id="7665264">;</span>&nbsp;<span class="ident" id="7665266"><a href="/image/png/reader_test.go.html#7665247">x</a></span>&nbsp;<span class="op" id="7665268">&lt;</span>&nbsp;<span class="ident" id="7665270"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7665276">.</span><span class="ident" id="7665277">Max</span><span class="op" id="7665280">.</span><span class="ident" id="7665281">X</span><span class="op" id="7665282">;</span>&nbsp;<span class="ident" id="7665284"><a href="/image/png/reader_test.go.html#7665247">x</a></span><span class="op" id="7665285">++</span>&nbsp;<span class="op" id="7665288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665294">nrgba64</span>&nbsp;<span class="op" id="7665302">:=</span>&nbsp;<span class="ident" id="7665305"><a href="/image/png/reader_test.go.html#7662051">png</a></span><span class="op" id="7665308">.</span><span class="ident" id="7665309">At</span><span class="op" id="7665311">(</span><span class="ident" id="7665312"><a href="/image/png/reader_test.go.html#7665247">x</a></span><span class="op" id="7665313">,</span>&nbsp;<span class="ident" id="7665315"><a href="/image/png/reader_test.go.html#7664248">y</a></span><span class="op" id="7665316">)</span><span class="op" id="7665317">.</span><span class="op" id="7665318">(</span><span class="ident" id="7665319"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7665324">.</span><span class="ident" id="7665325">NRGBA64</span><span class="op" id="7665332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665338"><a href="/image/png/reader_test.go.html#7661229">fmt</a></span><span class="op" id="7665341">.</span><span class="ident" id="7665342">Fprintf</span><span class="op" id="7665349">(</span><span class="ident" id="7665350"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7665351">,</span>&nbsp;<span class="string" id="7665353">&#34;%04x%04x%04x%04x&nbsp;&#34;</span><span class="op" id="7665372">,</span>&nbsp;<span class="ident" id="7665374"><a href="/image/png/reader_test.go.html#7665294">nrgba64</a></span><span class="op" id="7665381">.</span><span class="ident" id="7665382">R</span><span class="op" id="7665383">,</span>&nbsp;<span class="ident" id="7665385"><a href="/image/png/reader_test.go.html#7665294">nrgba64</a></span><span class="op" id="7665392">.</span><span class="ident" id="7665393">G</span><span class="op" id="7665394">,</span>&nbsp;<span class="ident" id="7665396"><a href="/image/png/reader_test.go.html#7665294">nrgba64</a></span><span class="op" id="7665403">.</span><span class="ident" id="7665404">B</span><span class="op" id="7665405">,</span>&nbsp;<span class="ident" id="7665407"><a href="/image/png/reader_test.go.html#7665294">nrgba64</a></span><span class="op" id="7665414">.</span><span class="ident" id="7665415">A</span><span class="op" id="7665416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665425">case</span>&nbsp;<span class="ident" id="7665430"><a href="/image/png/reader_test.go.html#7662287">cpm</a></span>&nbsp;<span class="op" id="7665434">!=</span>&nbsp;<span class="ident" id="7665437">nil</span><span class="op" id="7665440">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665445">var</span>&nbsp;<span class="ident" id="7665449">b</span><span class="op" id="7665450">,</span>&nbsp;<span class="ident" id="7665452">c</span>&nbsp;<span class="builtintype" id="7665454">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665461">for</span>&nbsp;<span class="ident" id="7665465">x</span>&nbsp;<span class="op" id="7665467">:=</span>&nbsp;<span class="ident" id="7665470"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7665476">.</span><span class="ident" id="7665477">Min</span><span class="op" id="7665480">.</span><span class="ident" id="7665481">X</span><span class="op" id="7665482">;</span>&nbsp;<span class="ident" id="7665484"><a href="/image/png/reader_test.go.html#7665465">x</a></span>&nbsp;<span class="op" id="7665486">&lt;</span>&nbsp;<span class="ident" id="7665488"><a href="/image/png/reader_test.go.html#7662088">bounds</a></span><span class="op" id="7665494">.</span><span class="ident" id="7665495">Max</span><span class="op" id="7665498">.</span><span class="ident" id="7665499">X</span><span class="op" id="7665500">;</span>&nbsp;<span class="ident" id="7665502"><a href="/image/png/reader_test.go.html#7665465">x</a></span><span class="op" id="7665503">++</span>&nbsp;<span class="op" id="7665506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665512"><a href="/image/png/reader_test.go.html#7665449">b</a></span>&nbsp;<span class="op" id="7665514">=</span>&nbsp;<span class="ident" id="7665516"><a href="/image/png/reader_test.go.html#7665449">b</a></span><span class="op" id="7665517">&lt;&lt;</span><span class="builtintype" id="7665519">uint</span><span class="op" id="7665523">(</span><span class="ident" id="7665524"><a href="/image/png/reader_test.go.html#7662140">bitdepth</a></span><span class="op" id="7665532">)</span>&nbsp;<span class="op" id="7665534">|</span>&nbsp;<span class="builtintype" id="7665536">int</span><span class="op" id="7665539">(</span><span class="ident" id="7665540"><a href="/image/png/reader_test.go.html#7662321">paletted</a></span><span class="op" id="7665548">.</span><span class="ident" id="7665549">ColorIndexAt</span><span class="op" id="7665561">(</span><span class="ident" id="7665562"><a href="/image/png/reader_test.go.html#7665465">x</a></span><span class="op" id="7665563">,</span>&nbsp;<span class="ident" id="7665565"><a href="/image/png/reader_test.go.html#7664248">y</a></span><span class="op" id="7665566">)</span><span class="op" id="7665567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665573"><a href="/image/png/reader_test.go.html#7665452">c</a></span><span class="op" id="7665574">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665581">if</span>&nbsp;<span class="ident" id="7665584"><a href="/image/png/reader_test.go.html#7665452">c</a></span>&nbsp;<span class="op" id="7665586">==</span>&nbsp;<span class="num" id="7665589">8</span><span class="op" id="7665590">/</span><span class="ident" id="7665591"><a href="/image/png/reader_test.go.html#7662140">bitdepth</a></span>&nbsp;<span class="op" id="7665600">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665607"><a href="/image/png/reader_test.go.html#7661229">fmt</a></span><span class="op" id="7665610">.</span><span class="ident" id="7665611">Fprintf</span><span class="op" id="7665618">(</span><span class="ident" id="7665619"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7665620">,</span>&nbsp;<span class="string" id="7665622">&#34;%02x&#34;</span><span class="op" id="7665628">,</span>&nbsp;<span class="ident" id="7665630"><a href="/image/png/reader_test.go.html#7665449">b</a></span><span class="op" id="7665631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665638"><a href="/image/png/reader_test.go.html#7665449">b</a></span>&nbsp;<span class="op" id="7665640">=</span>&nbsp;<span class="num" id="7665642">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665649"><a href="/image/png/reader_test.go.html#7665452">c</a></span>&nbsp;<span class="op" id="7665651">=</span>&nbsp;<span class="num" id="7665653">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665664">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665669">if</span>&nbsp;<span class="ident" id="7665672"><a href="/image/png/reader_test.go.html#7665452">c</a></span>&nbsp;<span class="op" id="7665674">!=</span>&nbsp;<span class="num" id="7665677">0</span>&nbsp;<span class="op" id="7665679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665685">for</span>&nbsp;<span class="ident" id="7665689"><a href="/image/png/reader_test.go.html#7665452">c</a></span>&nbsp;<span class="op" id="7665691">!=</span>&nbsp;<span class="num" id="7665694">8</span><span class="op" id="7665695">/</span><span class="ident" id="7665696"><a href="/image/png/reader_test.go.html#7662140">bitdepth</a></span>&nbsp;<span class="op" id="7665705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665712"><a href="/image/png/reader_test.go.html#7665449">b</a></span>&nbsp;<span class="op" id="7665714">=</span>&nbsp;<span class="ident" id="7665716"><a href="/image/png/reader_test.go.html#7665449">b</a></span>&nbsp;<span class="op" id="7665718">&lt;&lt;</span>&nbsp;<span class="builtintype" id="7665721">uint</span><span class="op" id="7665725">(</span><span class="ident" id="7665726"><a href="/image/png/reader_test.go.html#7662140">bitdepth</a></span><span class="op" id="7665734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665741"><a href="/image/png/reader_test.go.html#7665452">c</a></span><span class="op" id="7665742">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665749">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665755"><a href="/image/png/reader_test.go.html#7661229">fmt</a></span><span class="op" id="7665758">.</span><span class="ident" id="7665759">Fprintf</span><span class="op" id="7665766">(</span><span class="ident" id="7665767"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7665768">,</span>&nbsp;<span class="string" id="7665770">&#34;%02x&#34;</span><span class="op" id="7665776">,</span>&nbsp;<span class="ident" id="7665778"><a href="/image/png/reader_test.go.html#7665449">b</a></span><span class="op" id="7665779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665792"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7665794">.</span><span class="ident" id="7665795">WriteString</span><span class="op" id="7665806">(</span><span class="ident" id="7665807"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7665808">,</span>&nbsp;<span class="string" id="7665810">&#34;\n&#34;</span><span class="op" id="7665814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665817">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665820"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7665822">.</span><span class="ident" id="7665823">WriteString</span><span class="op" id="7665834">(</span><span class="ident" id="7665835"><a href="/image/png/reader_test.go.html#7662016">w</a></span><span class="op" id="7665836">,</span>&nbsp;<span class="string" id="7665838">&#34;}\n&#34;</span><span class="op" id="7665843">)</span><br>
<span class="lineno"></span><span class="op" id="7665845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7665848">func</span>&nbsp;<span class="ident" id="7665853">TestReader</span><span class="op" id="7665863">(</span><span class="ident" id="7665864">t</span>&nbsp;<span class="op" id="7665866">*</span><span class="ident" id="7665867"><a href="/image/png/reader_test.go.html#7661296">testing</a></span><span class="op" id="7665874">.</span><span class="ident" id="7665875">T</span><span class="op" id="7665876">)</span>&nbsp;<span class="op" id="7665878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665881">names</span>&nbsp;<span class="op" id="7665887">:=</span>&nbsp;<span class="ident" id="7665890"><a href="/image/png/reader_test.go.html#7661313">filenames</a></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665901">if</span>&nbsp;<span class="ident" id="7665904"><a href="/image/png/reader_test.go.html#7661296">testing</a></span><span class="op" id="7665911">.</span><span class="ident" id="7665912">Short</span><span class="op" id="7665917">(</span><span class="op" id="7665918">)</span>&nbsp;<span class="op" id="7665920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7665924"><a href="/image/png/reader_test.go.html#7665881">names</a></span>&nbsp;<span class="op" id="7665930">=</span>&nbsp;<span class="ident" id="7665932"><a href="/image/png/reader_test.go.html#7661727">filenamesShort</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7665948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7665951">for</span>&nbsp;<span class="ident" id="7665955">_</span><span class="op" id="7665956">,</span>&nbsp;<span class="ident" id="7665958">fn</span>&nbsp;<span class="op" id="7665961">:=</span>&nbsp;<span class="keyword" id="7665964">range</span>&nbsp;<span class="ident" id="7665970"><a href="/image/png/reader_test.go.html#7665881">names</a></span>&nbsp;<span class="op" id="7665976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7665980">//&nbsp;Read&nbsp;the&nbsp;.png&nbsp;file.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666005">img</span><span class="op" id="7666008">,</span>&nbsp;<span class="ident" id="7666010">err</span>&nbsp;<span class="op" id="7666014">:=</span>&nbsp;<span class="ident" id="7666017"><a href="/image/png/reader_test.go.html#7661804">readPNG</a></span><span class="op" id="7666024">(</span><span class="string" id="7666025">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="7666046">+</span>&nbsp;<span class="ident" id="7666048"><a href="/image/png/reader_test.go.html#7665958">fn</a></span>&nbsp;<span class="op" id="7666051">+</span>&nbsp;<span class="string" id="7666053">&#34;.png&#34;</span><span class="op" id="7666059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666063">if</span>&nbsp;<span class="ident" id="7666066"><a href="/image/png/reader_test.go.html#7666010">err</a></span>&nbsp;<span class="op" id="7666070">!=</span>&nbsp;<span class="ident" id="7666073">nil</span>&nbsp;<span class="op" id="7666077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666082"><a href="/image/png/reader_test.go.html#7665864">t</a></span><span class="op" id="7666083">.</span><span class="ident" id="7666084">Error</span><span class="op" id="7666089">(</span><span class="ident" id="7666090"><a href="/image/png/reader_test.go.html#7665958">fn</a></span><span class="op" id="7666092">,</span>&nbsp;<span class="ident" id="7666094"><a href="/image/png/reader_test.go.html#7666010">err</a></span><span class="op" id="7666097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666102">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7666113">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666118">if</span>&nbsp;<span class="ident" id="7666121"><a href="/image/png/reader_test.go.html#7665958">fn</a></span>&nbsp;<span class="op" id="7666124">==</span>&nbsp;<span class="string" id="7666127">&#34;basn4a16&#34;</span>&nbsp;<span class="op" id="7666138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7666143">//&nbsp;basn4a16.sng&nbsp;is&nbsp;gray&nbsp;+&nbsp;alpha&nbsp;but&nbsp;sng()&nbsp;will&nbsp;produce&nbsp;true&nbsp;color&nbsp;+&nbsp;alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7666220">//&nbsp;so&nbsp;we&nbsp;just&nbsp;check&nbsp;a&nbsp;single&nbsp;random&nbsp;pixel.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666266">c</span>&nbsp;<span class="op" id="7666268">:=</span>&nbsp;<span class="ident" id="7666271"><a href="/image/png/reader_test.go.html#7666005">img</a></span><span class="op" id="7666274">.</span><span class="ident" id="7666275">At</span><span class="op" id="7666277">(</span><span class="num" id="7666278">2</span><span class="op" id="7666279">,</span>&nbsp;<span class="num" id="7666281">1</span><span class="op" id="7666282">)</span><span class="op" id="7666283">.</span><span class="op" id="7666284">(</span><span class="ident" id="7666285"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7666290">.</span><span class="ident" id="7666291">NRGBA64</span><span class="op" id="7666298">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666303">if</span>&nbsp;<span class="ident" id="7666306"><a href="/image/png/reader_test.go.html#7666266">c</a></span><span class="op" id="7666307">.</span><span class="ident" id="7666308">R</span>&nbsp;<span class="op" id="7666310">!=</span>&nbsp;<span class="num" id="7666313">0x11a7</span>&nbsp;<span class="op" id="7666320">||</span>&nbsp;<span class="ident" id="7666323"><a href="/image/png/reader_test.go.html#7666266">c</a></span><span class="op" id="7666324">.</span><span class="ident" id="7666325">G</span>&nbsp;<span class="op" id="7666327">!=</span>&nbsp;<span class="num" id="7666330">0x11a7</span>&nbsp;<span class="op" id="7666337">||</span>&nbsp;<span class="ident" id="7666340"><a href="/image/png/reader_test.go.html#7666266">c</a></span><span class="op" id="7666341">.</span><span class="ident" id="7666342">B</span>&nbsp;<span class="op" id="7666344">!=</span>&nbsp;<span class="num" id="7666347">0x11a7</span>&nbsp;<span class="op" id="7666354">||</span>&nbsp;<span class="ident" id="7666357"><a href="/image/png/reader_test.go.html#7666266">c</a></span><span class="op" id="7666358">.</span><span class="ident" id="7666359">A</span>&nbsp;<span class="op" id="7666361">!=</span>&nbsp;<span class="num" id="7666364">0x1085</span>&nbsp;<span class="op" id="7666371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666377"><a href="/image/png/reader_test.go.html#7665864">t</a></span><span class="op" id="7666378">.</span><span class="ident" id="7666379">Error</span><span class="op" id="7666384">(</span><span class="ident" id="7666385"><a href="/image/png/reader_test.go.html#7665958">fn</a></span><span class="op" id="7666387">,</span>&nbsp;<span class="ident" id="7666389"><a href="/image/png/reader_test.go.html#7661229">fmt</a></span><span class="op" id="7666392">.</span><span class="ident" id="7666393">Errorf</span><span class="op" id="7666399">(</span><span class="string" id="7666400">&#34;wrong&nbsp;pixel&nbsp;value&nbsp;at&nbsp;(2,&nbsp;1):&nbsp;%x&#34;</span><span class="op" id="7666433">,</span>&nbsp;<span class="ident" id="7666435"><a href="/image/png/reader_test.go.html#7666266">c</a></span><span class="op" id="7666436">)</span><span class="op" id="7666437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7666442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666447">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7666458">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666463">piper</span><span class="op" id="7666468">,</span>&nbsp;<span class="ident" id="7666470">pipew</span>&nbsp;<span class="op" id="7666476">:=</span>&nbsp;<span class="ident" id="7666479"><a href="/image/png/reader_test.go.html#7661260">io</a></span><span class="op" id="7666481">.</span><span class="ident" id="7666482">Pipe</span><span class="op" id="7666486">(</span><span class="op" id="7666487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666491">pb</span>&nbsp;<span class="op" id="7666494">:=</span>&nbsp;<span class="ident" id="7666497"><a href="/image/png/reader_test.go.html#7661220">bufio</a></span><span class="op" id="7666502">.</span><span class="ident" id="7666503">NewScanner</span><span class="op" id="7666513">(</span><span class="ident" id="7666514"><a href="/image/png/reader_test.go.html#7666463">piper</a></span><span class="op" id="7666519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666523">go</span>&nbsp;<span class="ident" id="7666526"><a href="/image/png/reader_test.go.html#7662012">sng</a></span><span class="op" id="7666529">(</span><span class="ident" id="7666530"><a href="/image/png/reader_test.go.html#7666470">pipew</a></span><span class="op" id="7666535">,</span>&nbsp;<span class="ident" id="7666537"><a href="/image/png/reader_test.go.html#7665958">fn</a></span><span class="op" id="7666539">,</span>&nbsp;<span class="ident" id="7666541"><a href="/image/png/reader_test.go.html#7666005">img</a></span><span class="op" id="7666544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666548">defer</span>&nbsp;<span class="ident" id="7666554"><a href="/image/png/reader_test.go.html#7666463">piper</a></span><span class="op" id="7666559">.</span><span class="ident" id="7666560">Close</span><span class="op" id="7666565">(</span><span class="op" id="7666566">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7666571">//&nbsp;Read&nbsp;the&nbsp;.sng&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666596">sf</span><span class="op" id="7666598">,</span>&nbsp;<span class="ident" id="7666600"><a href="/image/png/reader_test.go.html#7666010">err</a></span>&nbsp;<span class="op" id="7666604">:=</span>&nbsp;<span class="ident" id="7666607"><a href="/image/png/reader_test.go.html#7661279">os</a></span><span class="op" id="7666609">.</span><span class="ident" id="7666610">Open</span><span class="op" id="7666614">(</span><span class="string" id="7666615">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="7666636">+</span>&nbsp;<span class="ident" id="7666638"><a href="/image/png/reader_test.go.html#7665958">fn</a></span>&nbsp;<span class="op" id="7666641">+</span>&nbsp;<span class="string" id="7666643">&#34;.sng&#34;</span><span class="op" id="7666649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666653">if</span>&nbsp;<span class="ident" id="7666656"><a href="/image/png/reader_test.go.html#7666010">err</a></span>&nbsp;<span class="op" id="7666660">!=</span>&nbsp;<span class="ident" id="7666663">nil</span>&nbsp;<span class="op" id="7666667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666672"><a href="/image/png/reader_test.go.html#7665864">t</a></span><span class="op" id="7666673">.</span><span class="ident" id="7666674">Error</span><span class="op" id="7666679">(</span><span class="ident" id="7666680"><a href="/image/png/reader_test.go.html#7665958">fn</a></span><span class="op" id="7666682">,</span>&nbsp;<span class="ident" id="7666684"><a href="/image/png/reader_test.go.html#7666010">err</a></span><span class="op" id="7666687">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666692">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7666703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666707">defer</span>&nbsp;<span class="ident" id="7666713"><a href="/image/png/reader_test.go.html#7666596">sf</a></span><span class="op" id="7666715">.</span><span class="ident" id="7666716">Close</span><span class="op" id="7666721">(</span><span class="op" id="7666722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666726">sb</span>&nbsp;<span class="op" id="7666729">:=</span>&nbsp;<span class="ident" id="7666732"><a href="/image/png/reader_test.go.html#7661220">bufio</a></span><span class="op" id="7666737">.</span><span class="ident" id="7666738">NewScanner</span><span class="op" id="7666748">(</span><span class="ident" id="7666749"><a href="/image/png/reader_test.go.html#7666596">sf</a></span><span class="op" id="7666751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666755">if</span>&nbsp;<span class="ident" id="7666758"><a href="/image/png/reader_test.go.html#7666010">err</a></span>&nbsp;<span class="op" id="7666762">!=</span>&nbsp;<span class="ident" id="7666765">nil</span>&nbsp;<span class="op" id="7666769">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666774"><a href="/image/png/reader_test.go.html#7665864">t</a></span><span class="op" id="7666775">.</span><span class="ident" id="7666776">Error</span><span class="op" id="7666781">(</span><span class="ident" id="7666782"><a href="/image/png/reader_test.go.html#7665958">fn</a></span><span class="op" id="7666784">,</span>&nbsp;<span class="ident" id="7666786"><a href="/image/png/reader_test.go.html#7666010">err</a></span><span class="op" id="7666789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666794">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7666805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7666810">//&nbsp;Compare&nbsp;the&nbsp;two,&nbsp;in&nbsp;SNG&nbsp;format,&nbsp;line&nbsp;by&nbsp;line.</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666861">for</span>&nbsp;<span class="op" id="7666865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666870">pdone</span>&nbsp;<span class="op" id="7666876">:=</span>&nbsp;<span class="op" id="7666879">!</span><span class="ident" id="7666880"><a href="/image/png/reader_test.go.html#7666491">pb</a></span><span class="op" id="7666882">.</span><span class="ident" id="7666883">Scan</span><span class="op" id="7666887">(</span><span class="op" id="7666888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666893">sdone</span>&nbsp;<span class="op" id="7666899">:=</span>&nbsp;<span class="op" id="7666902">!</span><span class="ident" id="7666903"><a href="/image/png/reader_test.go.html#7666726">sb</a></span><span class="op" id="7666905">.</span><span class="ident" id="7666906">Scan</span><span class="op" id="7666910">(</span><span class="op" id="7666911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666916">if</span>&nbsp;<span class="ident" id="7666919"><a href="/image/png/reader_test.go.html#7666870">pdone</a></span>&nbsp;<span class="op" id="7666925">&amp;&amp;</span>&nbsp;<span class="ident" id="7666928"><a href="/image/png/reader_test.go.html#7666893">sdone</a></span>&nbsp;<span class="op" id="7666934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666940">break</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7666949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7666954">if</span>&nbsp;<span class="ident" id="7666957"><a href="/image/png/reader_test.go.html#7666870">pdone</a></span>&nbsp;<span class="op" id="7666963">||</span>&nbsp;<span class="ident" id="7666966"><a href="/image/png/reader_test.go.html#7666893">sdone</a></span>&nbsp;<span class="op" id="7666972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7666978"><a href="/image/png/reader_test.go.html#7665864">t</a></span><span class="op" id="7666979">.</span><span class="ident" id="7666980">Errorf</span><span class="op" id="7666986">(</span><span class="string" id="7666987">&#34;%s:&nbsp;Different&nbsp;sizes&#34;</span><span class="op" id="7667008">,</span>&nbsp;<span class="ident" id="7667010"><a href="/image/png/reader_test.go.html#7665958">fn</a></span><span class="op" id="7667012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667018">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667027">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667032">ps</span>&nbsp;<span class="op" id="7667035">:=</span>&nbsp;<span class="ident" id="7667038"><a href="/image/png/reader_test.go.html#7666491">pb</a></span><span class="op" id="7667040">.</span><span class="ident" id="7667041">Text</span><span class="op" id="7667045">(</span><span class="op" id="7667046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667051">ss</span>&nbsp;<span class="op" id="7667054">:=</span>&nbsp;<span class="ident" id="7667057"><a href="/image/png/reader_test.go.html#7666726">sb</a></span><span class="op" id="7667059">.</span><span class="ident" id="7667060">Text</span><span class="op" id="7667064">(</span><span class="op" id="7667065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667070">if</span>&nbsp;<span class="ident" id="7667073"><a href="/image/png/reader_test.go.html#7667032">ps</a></span>&nbsp;<span class="op" id="7667076">!=</span>&nbsp;<span class="ident" id="7667079"><a href="/image/png/reader_test.go.html#7667051">ss</a></span>&nbsp;<span class="op" id="7667082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667088"><a href="/image/png/reader_test.go.html#7665864">t</a></span><span class="op" id="7667089">.</span><span class="ident" id="7667090">Errorf</span><span class="op" id="7667096">(</span><span class="string" id="7667097">&#34;%s:&nbsp;Mismatch\n%sversus\n%s\n&#34;</span><span class="op" id="7667127">,</span>&nbsp;<span class="ident" id="7667129"><a href="/image/png/reader_test.go.html#7665958">fn</a></span><span class="op" id="7667131">,</span>&nbsp;<span class="ident" id="7667133"><a href="/image/png/reader_test.go.html#7667032">ps</a></span><span class="op" id="7667135">,</span>&nbsp;<span class="ident" id="7667137"><a href="/image/png/reader_test.go.html#7667051">ss</a></span><span class="op" id="7667139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667145">break</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667162">if</span>&nbsp;<span class="ident" id="7667165"><a href="/image/png/reader_test.go.html#7666491">pb</a></span><span class="op" id="7667167">.</span><span class="ident" id="7667168">Err</span><span class="op" id="7667171">(</span><span class="op" id="7667172">)</span>&nbsp;<span class="op" id="7667174">!=</span>&nbsp;<span class="ident" id="7667177">nil</span>&nbsp;<span class="op" id="7667181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667186"><a href="/image/png/reader_test.go.html#7665864">t</a></span><span class="op" id="7667187">.</span><span class="ident" id="7667188">Error</span><span class="op" id="7667193">(</span><span class="ident" id="7667194"><a href="/image/png/reader_test.go.html#7665958">fn</a></span><span class="op" id="7667196">,</span>&nbsp;<span class="ident" id="7667198"><a href="/image/png/reader_test.go.html#7666491">pb</a></span><span class="op" id="7667200">.</span><span class="ident" id="7667201">Err</span><span class="op" id="7667204">(</span><span class="op" id="7667205">)</span><span class="op" id="7667206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667210">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667214">if</span>&nbsp;<span class="ident" id="7667217"><a href="/image/png/reader_test.go.html#7666726">sb</a></span><span class="op" id="7667219">.</span><span class="ident" id="7667220">Err</span><span class="op" id="7667223">(</span><span class="op" id="7667224">)</span>&nbsp;<span class="op" id="7667226">!=</span>&nbsp;<span class="ident" id="7667229">nil</span>&nbsp;<span class="op" id="7667233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667238"><a href="/image/png/reader_test.go.html#7665864">t</a></span><span class="op" id="7667239">.</span><span class="ident" id="7667240">Error</span><span class="op" id="7667245">(</span><span class="ident" id="7667246"><a href="/image/png/reader_test.go.html#7665958">fn</a></span><span class="op" id="7667248">,</span>&nbsp;<span class="ident" id="7667250"><a href="/image/png/reader_test.go.html#7666726">sb</a></span><span class="op" id="7667252">.</span><span class="ident" id="7667253">Err</span><span class="op" id="7667256">(</span><span class="op" id="7667257">)</span><span class="op" id="7667258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667265">}</span><br>
<span class="lineno"></span><span class="op" id="7667267">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="7667270">var</span>&nbsp;<span class="ident" id="7667274">readerErrors</span>&nbsp;<span class="op" id="7667287">=</span>&nbsp;<span class="op" id="7667289">[</span><span class="op" id="7667290">]</span><span class="keyword" id="7667291">struct</span>&nbsp;<span class="op" id="7667298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667301">file</span>&nbsp;<span class="builtintype" id="7667306">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667314">err</span>&nbsp;&nbsp;<span class="builtintype" id="7667319">string</span><br>
<span class="lineno"></span><span class="op" id="7667326">}</span><span class="op" id="7667327">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667330">{</span><span class="string" id="7667331">&#34;invalid-zlib.png&#34;</span><span class="op" id="7667349">,</span>&nbsp;<span class="string" id="7667351">&#34;zlib:&nbsp;invalid&nbsp;checksum&#34;</span><span class="op" id="7667375">}</span><span class="op" id="7667376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667379">{</span><span class="string" id="7667380">&#34;invalid-crc32.png&#34;</span><span class="op" id="7667399">,</span>&nbsp;<span class="string" id="7667401">&#34;invalid&nbsp;checksum&#34;</span><span class="op" id="7667419">}</span><span class="op" id="7667420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667423">{</span><span class="string" id="7667424">&#34;invalid-noend.png&#34;</span><span class="op" id="7667443">,</span>&nbsp;<span class="string" id="7667445">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="7667461">}</span><span class="op" id="7667462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667465">{</span><span class="string" id="7667466">&#34;invalid-trunc.png&#34;</span><span class="op" id="7667485">,</span>&nbsp;<span class="string" id="7667487">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="7667503">}</span><span class="op" id="7667504">,</span><br>
<span class="lineno"></span><span class="op" id="7667506">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="7667509">func</span>&nbsp;<span class="ident" id="7667514">TestReaderError</span><span class="op" id="7667529">(</span><span class="ident" id="7667530">t</span>&nbsp;<span class="op" id="7667532">*</span><span class="ident" id="7667533"><a href="/image/png/reader_test.go.html#7661296">testing</a></span><span class="op" id="7667540">.</span><span class="ident" id="7667541">T</span><span class="op" id="7667542">)</span>&nbsp;<span class="op" id="7667544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667547">for</span>&nbsp;<span class="ident" id="7667551">_</span><span class="op" id="7667552">,</span>&nbsp;<span class="ident" id="7667554">tt</span>&nbsp;<span class="op" id="7667557">:=</span>&nbsp;<span class="keyword" id="7667560">range</span>&nbsp;<span class="ident" id="7667566"><a href="/image/png/reader_test.go.html#7667274">readerErrors</a></span>&nbsp;<span class="op" id="7667579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667583">img</span><span class="op" id="7667586">,</span>&nbsp;<span class="ident" id="7667588">err</span>&nbsp;<span class="op" id="7667592">:=</span>&nbsp;<span class="ident" id="7667595"><a href="/image/png/reader_test.go.html#7661804">readPNG</a></span><span class="op" id="7667602">(</span><span class="string" id="7667603">&#34;testdata/&#34;</span>&nbsp;<span class="op" id="7667615">+</span>&nbsp;<span class="ident" id="7667617"><a href="/image/png/reader_test.go.html#7667554">tt</a></span><span class="op" id="7667619">.</span><span class="ident" id="7667620">file</span><span class="op" id="7667624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667628">if</span>&nbsp;<span class="ident" id="7667631"><a href="/image/png/reader_test.go.html#7667588">err</a></span>&nbsp;<span class="op" id="7667635">==</span>&nbsp;<span class="ident" id="7667638">nil</span>&nbsp;<span class="op" id="7667642">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667647"><a href="/image/png/reader_test.go.html#7667530">t</a></span><span class="op" id="7667648">.</span><span class="ident" id="7667649">Errorf</span><span class="op" id="7667655">(</span><span class="string" id="7667656">&#34;decoding&nbsp;%s:&nbsp;missing&nbsp;error&#34;</span><span class="op" id="7667684">,</span>&nbsp;<span class="ident" id="7667686"><a href="/image/png/reader_test.go.html#7667554">tt</a></span><span class="op" id="7667688">.</span><span class="ident" id="7667689">file</span><span class="op" id="7667693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667698">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667713">if</span>&nbsp;<span class="op" id="7667716">!</span><span class="ident" id="7667717"><a href="/image/png/reader_test.go.html#7661285">strings</a></span><span class="op" id="7667724">.</span><span class="ident" id="7667725">Contains</span><span class="op" id="7667733">(</span><span class="ident" id="7667734"><a href="/image/png/reader_test.go.html#7667588">err</a></span><span class="op" id="7667737">.</span><span class="ident" id="7667738">Error</span><span class="op" id="7667743">(</span><span class="op" id="7667744">)</span><span class="op" id="7667745">,</span>&nbsp;<span class="ident" id="7667747"><a href="/image/png/reader_test.go.html#7667554">tt</a></span><span class="op" id="7667749">.</span><span class="ident" id="7667750">err</span><span class="op" id="7667753">)</span>&nbsp;<span class="op" id="7667755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667760"><a href="/image/png/reader_test.go.html#7667530">t</a></span><span class="op" id="7667761">.</span><span class="ident" id="7667762">Errorf</span><span class="op" id="7667768">(</span><span class="string" id="7667769">&#34;decoding&nbsp;%s:&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7667795">,</span>&nbsp;<span class="ident" id="7667797"><a href="/image/png/reader_test.go.html#7667554">tt</a></span><span class="op" id="7667799">.</span><span class="ident" id="7667800">file</span><span class="op" id="7667804">,</span>&nbsp;<span class="ident" id="7667806"><a href="/image/png/reader_test.go.html#7667588">err</a></span><span class="op" id="7667809">,</span>&nbsp;<span class="ident" id="7667811"><a href="/image/png/reader_test.go.html#7667554">tt</a></span><span class="op" id="7667813">.</span><span class="ident" id="7667814">err</span><span class="op" id="7667817">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667825">if</span>&nbsp;<span class="ident" id="7667828"><a href="/image/png/reader_test.go.html#7667583">img</a></span>&nbsp;<span class="op" id="7667832">!=</span>&nbsp;<span class="ident" id="7667835">nil</span>&nbsp;<span class="op" id="7667839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667844"><a href="/image/png/reader_test.go.html#7667530">t</a></span><span class="op" id="7667845">.</span><span class="ident" id="7667846">Errorf</span><span class="op" id="7667852">(</span><span class="string" id="7667853">&#34;decoding&nbsp;%s:&nbsp;have&nbsp;image&nbsp;+&nbsp;error&#34;</span><span class="op" id="7667886">,</span>&nbsp;<span class="ident" id="7667888"><a href="/image/png/reader_test.go.html#7667554">tt</a></span><span class="op" id="7667890">.</span><span class="ident" id="7667891">file</span><span class="op" id="7667895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7667902">}</span><br>
<span class="lineno">295</span><span class="op" id="7667904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7667907">func</span>&nbsp;<span class="ident" id="7667912">TestPalettedDecodeConfig</span><span class="op" id="7667936">(</span><span class="ident" id="7667937">t</span>&nbsp;<span class="op" id="7667939">*</span><span class="ident" id="7667940"><a href="/image/png/reader_test.go.html#7661296">testing</a></span><span class="op" id="7667947">.</span><span class="ident" id="7667948">T</span><span class="op" id="7667949">)</span>&nbsp;<span class="op" id="7667951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7667954">for</span>&nbsp;<span class="ident" id="7667958">_</span><span class="op" id="7667959">,</span>&nbsp;<span class="ident" id="7667961">fn</span>&nbsp;<span class="op" id="7667964">:=</span>&nbsp;<span class="keyword" id="7667967">range</span>&nbsp;<span class="ident" id="7667973"><a href="/image/png/reader_test.go.html#7661620">filenamesPaletted</a></span>&nbsp;<span class="op" id="7667991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7667995">f</span><span class="op" id="7667996">,</span>&nbsp;<span class="ident" id="7667998">err</span>&nbsp;<span class="op" id="7668002">:=</span>&nbsp;<span class="ident" id="7668005"><a href="/image/png/reader_test.go.html#7661279">os</a></span><span class="op" id="7668007">.</span><span class="ident" id="7668008">Open</span><span class="op" id="7668012">(</span><span class="string" id="7668013">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="7668034">+</span>&nbsp;<span class="ident" id="7668036"><a href="/image/png/reader_test.go.html#7667961">fn</a></span>&nbsp;<span class="op" id="7668039">+</span>&nbsp;<span class="string" id="7668041">&#34;.png&#34;</span><span class="op" id="7668047">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668051">if</span>&nbsp;<span class="ident" id="7668054"><a href="/image/png/reader_test.go.html#7667998">err</a></span>&nbsp;<span class="op" id="7668058">!=</span>&nbsp;<span class="ident" id="7668061">nil</span>&nbsp;<span class="op" id="7668065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668070"><a href="/image/png/reader_test.go.html#7667937">t</a></span><span class="op" id="7668071">.</span><span class="ident" id="7668072">Errorf</span><span class="op" id="7668078">(</span><span class="string" id="7668079">&#34;%s:&nbsp;open&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7668100">,</span>&nbsp;<span class="ident" id="7668102"><a href="/image/png/reader_test.go.html#7667961">fn</a></span><span class="op" id="7668104">,</span>&nbsp;<span class="ident" id="7668106"><a href="/image/png/reader_test.go.html#7667998">err</a></span><span class="op" id="7668109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668114">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668129">defer</span>&nbsp;<span class="ident" id="7668135"><a href="/image/png/reader_test.go.html#7667995">f</a></span><span class="op" id="7668136">.</span><span class="ident" id="7668137">Close</span><span class="op" id="7668142">(</span><span class="op" id="7668143">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668147">cfg</span><span class="op" id="7668150">,</span>&nbsp;<span class="ident" id="7668152"><a href="/image/png/reader_test.go.html#7667998">err</a></span>&nbsp;<span class="op" id="7668156">:=</span>&nbsp;<span class="ident" id="7668159"><a href="/image/png/reader.go.html#5597246">DecodeConfig</a></span><span class="op" id="7668171">(</span><span class="ident" id="7668172"><a href="/image/png/reader_test.go.html#7667995">f</a></span><span class="op" id="7668173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668177">if</span>&nbsp;<span class="ident" id="7668180"><a href="/image/png/reader_test.go.html#7667998">err</a></span>&nbsp;<span class="op" id="7668184">!=</span>&nbsp;<span class="ident" id="7668187">nil</span>&nbsp;<span class="op" id="7668191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668196"><a href="/image/png/reader_test.go.html#7667937">t</a></span><span class="op" id="7668197">.</span><span class="ident" id="7668198">Errorf</span><span class="op" id="7668204">(</span><span class="string" id="7668205">&#34;%s:&nbsp;%v&#34;</span><span class="op" id="7668213">,</span>&nbsp;<span class="ident" id="7668215"><a href="/image/png/reader_test.go.html#7667961">fn</a></span><span class="op" id="7668217">,</span>&nbsp;<span class="ident" id="7668219"><a href="/image/png/reader_test.go.html#7667998">err</a></span><span class="op" id="7668222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668227">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668238">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668242">pal</span><span class="op" id="7668245">,</span>&nbsp;<span class="ident" id="7668247">ok</span>&nbsp;<span class="op" id="7668250">:=</span>&nbsp;<span class="ident" id="7668253"><a href="/image/png/reader_test.go.html#7668147">cfg</a></span><span class="op" id="7668256">.</span><span class="ident" id="7668257">ColorModel</span><span class="op" id="7668267">.</span><span class="op" id="7668268">(</span><span class="ident" id="7668269"><a href="/image/png/reader_test.go.html#7661245">color</a></span><span class="op" id="7668274">.</span><span class="ident" id="7668275">Palette</span><span class="op" id="7668282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668286">if</span>&nbsp;<span class="op" id="7668289">!</span><span class="ident" id="7668290"><a href="/image/png/reader_test.go.html#7668247">ok</a></span>&nbsp;<span class="op" id="7668293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668298"><a href="/image/png/reader_test.go.html#7667937">t</a></span><span class="op" id="7668299">.</span><span class="ident" id="7668300">Errorf</span><span class="op" id="7668306">(</span><span class="string" id="7668307">&#34;%s:&nbsp;expected&nbsp;paletted&nbsp;color&nbsp;model&#34;</span><span class="op" id="7668342">,</span>&nbsp;<span class="ident" id="7668344"><a href="/image/png/reader_test.go.html#7667961">fn</a></span><span class="op" id="7668346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668351">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668362">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668366">if</span>&nbsp;<span class="ident" id="7668369"><a href="/image/png/reader_test.go.html#7668242">pal</a></span>&nbsp;<span class="op" id="7668373">==</span>&nbsp;<span class="ident" id="7668376">nil</span>&nbsp;<span class="op" id="7668380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668385"><a href="/image/png/reader_test.go.html#7667937">t</a></span><span class="op" id="7668386">.</span><span class="ident" id="7668387">Errorf</span><span class="op" id="7668393">(</span><span class="string" id="7668394">&#34;%s:&nbsp;palette&nbsp;not&nbsp;initialized&#34;</span><span class="op" id="7668423">,</span>&nbsp;<span class="ident" id="7668425"><a href="/image/png/reader_test.go.html#7667961">fn</a></span><span class="op" id="7668427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668432">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668446">}</span><br>
<span class="lineno">320</span><span class="op" id="7668448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7668451">func</span>&nbsp;<span class="ident" id="7668456">benchmarkDecode</span><span class="op" id="7668471">(</span><span class="ident" id="7668472">b</span>&nbsp;<span class="op" id="7668474">*</span><span class="ident" id="7668475"><a href="/image/png/reader_test.go.html#7661296">testing</a></span><span class="op" id="7668482">.</span><span class="ident" id="7668483">B</span><span class="op" id="7668484">,</span>&nbsp;<span class="ident" id="7668486">filename</span>&nbsp;<span class="builtintype" id="7668495">string</span><span class="op" id="7668501">,</span>&nbsp;<span class="ident" id="7668503">bytesPerPixel</span>&nbsp;<span class="builtintype" id="7668517">int</span><span class="op" id="7668520">)</span>&nbsp;<span class="op" id="7668522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668525"><a href="/image/png/reader_test.go.html#7668472">b</a></span><span class="op" id="7668526">.</span><span class="ident" id="7668527">StopTimer</span><span class="op" id="7668536">(</span><span class="op" id="7668537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668540">data</span><span class="op" id="7668544">,</span>&nbsp;<span class="ident" id="7668546">err</span>&nbsp;<span class="op" id="7668550">:=</span>&nbsp;<span class="ident" id="7668553"><a href="/image/png/reader_test.go.html#7661266">ioutil</a></span><span class="op" id="7668559">.</span><span class="ident" id="7668560">ReadFile</span><span class="op" id="7668568">(</span><span class="ident" id="7668569"><a href="/image/png/reader_test.go.html#7668486">filename</a></span><span class="op" id="7668577">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668580">if</span>&nbsp;<span class="ident" id="7668583"><a href="/image/png/reader_test.go.html#7668546">err</a></span>&nbsp;<span class="op" id="7668587">!=</span>&nbsp;<span class="ident" id="7668590">nil</span>&nbsp;<span class="op" id="7668594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668598"><a href="/image/png/reader_test.go.html#7668472">b</a></span><span class="op" id="7668599">.</span><span class="ident" id="7668600">Fatal</span><span class="op" id="7668605">(</span><span class="ident" id="7668606"><a href="/image/png/reader_test.go.html#7668546">err</a></span><span class="op" id="7668609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668615">s</span>&nbsp;<span class="op" id="7668617">:=</span>&nbsp;<span class="builtintype" id="7668620">string</span><span class="op" id="7668626">(</span><span class="ident" id="7668627"><a href="/image/png/reader_test.go.html#7668540">data</a></span><span class="op" id="7668631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668634">cfg</span><span class="op" id="7668637">,</span>&nbsp;<span class="ident" id="7668639"><a href="/image/png/reader_test.go.html#7668546">err</a></span>&nbsp;<span class="op" id="7668643">:=</span>&nbsp;<span class="ident" id="7668646"><a href="/image/png/reader.go.html#5597246">DecodeConfig</a></span><span class="op" id="7668658">(</span><span class="ident" id="7668659"><a href="/image/png/reader_test.go.html#7661285">strings</a></span><span class="op" id="7668666">.</span><span class="ident" id="7668667">NewReader</span><span class="op" id="7668676">(</span><span class="ident" id="7668677"><a href="/image/png/reader_test.go.html#7668615">s</a></span><span class="op" id="7668678">)</span><span class="op" id="7668679">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668682">if</span>&nbsp;<span class="ident" id="7668685"><a href="/image/png/reader_test.go.html#7668546">err</a></span>&nbsp;<span class="op" id="7668689">!=</span>&nbsp;<span class="ident" id="7668692">nil</span>&nbsp;<span class="op" id="7668696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668700"><a href="/image/png/reader_test.go.html#7668472">b</a></span><span class="op" id="7668701">.</span><span class="ident" id="7668702">Fatal</span><span class="op" id="7668707">(</span><span class="ident" id="7668708"><a href="/image/png/reader_test.go.html#7668546">err</a></span><span class="op" id="7668711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668717"><a href="/image/png/reader_test.go.html#7668472">b</a></span><span class="op" id="7668718">.</span><span class="ident" id="7668719">SetBytes</span><span class="op" id="7668727">(</span><span class="ident" id="7668728">int64</span><span class="op" id="7668733">(</span><span class="ident" id="7668734"><a href="/image/png/reader_test.go.html#7668634">cfg</a></span><span class="op" id="7668737">.</span><span class="ident" id="7668738">Width</span>&nbsp;<span class="op" id="7668744">*</span>&nbsp;<span class="ident" id="7668746"><a href="/image/png/reader_test.go.html#7668634">cfg</a></span><span class="op" id="7668749">.</span><span class="ident" id="7668750">Height</span>&nbsp;<span class="op" id="7668757">*</span>&nbsp;<span class="ident" id="7668759"><a href="/image/png/reader_test.go.html#7668503">bytesPerPixel</a></span><span class="op" id="7668772">)</span><span class="op" id="7668773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668776"><a href="/image/png/reader_test.go.html#7668472">b</a></span><span class="op" id="7668777">.</span><span class="ident" id="7668778">StartTimer</span><span class="op" id="7668788">(</span><span class="op" id="7668789">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7668792">for</span>&nbsp;<span class="ident" id="7668796">i</span>&nbsp;<span class="op" id="7668798">:=</span>&nbsp;<span class="num" id="7668801">0</span><span class="op" id="7668802">;</span>&nbsp;<span class="ident" id="7668804"><a href="/image/png/reader_test.go.html#7668796">i</a></span>&nbsp;<span class="op" id="7668806">&lt;</span>&nbsp;<span class="ident" id="7668808"><a href="/image/png/reader_test.go.html#7668472">b</a></span><span class="op" id="7668809">.</span><span class="ident" id="7668810">N</span><span class="op" id="7668811">;</span>&nbsp;<span class="ident" id="7668813"><a href="/image/png/reader_test.go.html#7668796">i</a></span><span class="op" id="7668814">++</span>&nbsp;<span class="op" id="7668817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668821"><a href="/image/png/reader.go.html#5596746">Decode</a></span><span class="op" id="7668827">(</span><span class="ident" id="7668828"><a href="/image/png/reader_test.go.html#7661285">strings</a></span><span class="op" id="7668835">.</span><span class="ident" id="7668836">NewReader</span><span class="op" id="7668845">(</span><span class="ident" id="7668846"><a href="/image/png/reader_test.go.html#7668615">s</a></span><span class="op" id="7668847">)</span><span class="op" id="7668848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7668851">}</span><br>
<span class="lineno"></span><span class="op" id="7668853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="7668856">func</span>&nbsp;<span class="ident" id="7668861">BenchmarkDecodeGray</span><span class="op" id="7668880">(</span><span class="ident" id="7668881">b</span>&nbsp;<span class="op" id="7668883">*</span><span class="ident" id="7668884"><a href="/image/png/reader_test.go.html#7661296">testing</a></span><span class="op" id="7668891">.</span><span class="ident" id="7668892">B</span><span class="op" id="7668893">)</span>&nbsp;<span class="op" id="7668895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7668898"><a href="/image/png/reader_test.go.html#7668456">benchmarkDecode</a></span><span class="op" id="7668913">(</span><span class="ident" id="7668914"><a href="/image/png/reader_test.go.html#7668881">b</a></span><span class="op" id="7668915">,</span>&nbsp;<span class="string" id="7668917">&#34;testdata/benchGray.png&#34;</span><span class="op" id="7668941">,</span>&nbsp;<span class="num" id="7668943">1</span><span class="op" id="7668944">)</span><br>
<span class="lineno"></span><span class="op" id="7668946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7668949">func</span>&nbsp;<span class="ident" id="7668954">BenchmarkDecodeNRGBAGradient</span><span class="op" id="7668982">(</span><span class="ident" id="7668983">b</span>&nbsp;<span class="op" id="7668985">*</span><span class="ident" id="7668986"><a href="/image/png/reader_test.go.html#7661296">testing</a></span><span class="op" id="7668993">.</span><span class="ident" id="7668994">B</span><span class="op" id="7668995">)</span>&nbsp;<span class="op" id="7668997">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7669000"><a href="/image/png/reader_test.go.html#7668456">benchmarkDecode</a></span><span class="op" id="7669015">(</span><span class="ident" id="7669016"><a href="/image/png/reader_test.go.html#7668983">b</a></span><span class="op" id="7669017">,</span>&nbsp;<span class="string" id="7669019">&#34;testdata/benchNRGBA-gradient.png&#34;</span><span class="op" id="7669053">,</span>&nbsp;<span class="num" id="7669055">4</span><span class="op" id="7669056">)</span><br>
<span class="lineno"></span><span class="op" id="7669058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7669061">func</span>&nbsp;<span class="ident" id="7669066">BenchmarkDecodeNRGBAOpaque</span><span class="op" id="7669092">(</span><span class="ident" id="7669093">b</span>&nbsp;<span class="op" id="7669095">*</span><span class="ident" id="7669096"><a href="/image/png/reader_test.go.html#7661296">testing</a></span><span class="op" id="7669103">.</span><span class="ident" id="7669104">B</span><span class="op" id="7669105">)</span>&nbsp;<span class="op" id="7669107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7669110"><a href="/image/png/reader_test.go.html#7668456">benchmarkDecode</a></span><span class="op" id="7669125">(</span><span class="ident" id="7669126"><a href="/image/png/reader_test.go.html#7669093">b</a></span><span class="op" id="7669127">,</span>&nbsp;<span class="string" id="7669129">&#34;testdata/benchNRGBA-opaque.png&#34;</span><span class="op" id="7669161">,</span>&nbsp;<span class="num" id="7669163">4</span><span class="op" id="7669164">)</span><br>
<span class="lineno">350</span><span class="op" id="7669166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7669169">func</span>&nbsp;<span class="ident" id="7669174">BenchmarkDecodePaletted</span><span class="op" id="7669197">(</span><span class="ident" id="7669198">b</span>&nbsp;<span class="op" id="7669200">*</span><span class="ident" id="7669201"><a href="/image/png/reader_test.go.html#7661296">testing</a></span><span class="op" id="7669208">.</span><span class="ident" id="7669209">B</span><span class="op" id="7669210">)</span>&nbsp;<span class="op" id="7669212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7669215"><a href="/image/png/reader_test.go.html#7668456">benchmarkDecode</a></span><span class="op" id="7669230">(</span><span class="ident" id="7669231"><a href="/image/png/reader_test.go.html#7669198">b</a></span><span class="op" id="7669232">,</span>&nbsp;<span class="string" id="7669234">&#34;testdata/benchPaletted.png&#34;</span><span class="op" id="7669262">,</span>&nbsp;<span class="num" id="7669264">1</span><span class="op" id="7669265">)</span><br>
<span class="lineno"></span><span class="op" id="7669267">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="keyword" id="7669270">func</span>&nbsp;<span class="ident" id="7669275">BenchmarkDecodeRGB</span><span class="op" id="7669293">(</span><span class="ident" id="7669294">b</span>&nbsp;<span class="op" id="7669296">*</span><span class="ident" id="7669297"><a href="/image/png/reader_test.go.html#7661296">testing</a></span><span class="op" id="7669304">.</span><span class="ident" id="7669305">B</span><span class="op" id="7669306">)</span>&nbsp;<span class="op" id="7669308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7669311"><a href="/image/png/reader_test.go.html#7668456">benchmarkDecode</a></span><span class="op" id="7669326">(</span><span class="ident" id="7669327"><a href="/image/png/reader_test.go.html#7669294">b</a></span><span class="op" id="7669328">,</span>&nbsp;<span class="string" id="7669330">&#34;testdata/benchRGB.png&#34;</span><span class="op" id="7669353">,</span>&nbsp;<span class="num" id="7669355">4</span><span class="op" id="7669356">)</span><br>
<span class="lineno"></span><span class="op" id="7669358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="keyword" id="7669361">func</span>&nbsp;<span class="ident" id="7669366">BenchmarkDecodeInterlacing</span><span class="op" id="7669392">(</span><span class="ident" id="7669393">b</span>&nbsp;<span class="op" id="7669395">*</span><span class="ident" id="7669396"><a href="/image/png/reader_test.go.html#7661296">testing</a></span><span class="op" id="7669403">.</span><span class="ident" id="7669404">B</span><span class="op" id="7669405">)</span>&nbsp;<span class="op" id="7669407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7669410"><a href="/image/png/reader_test.go.html#7668456">benchmarkDecode</a></span><span class="op" id="7669425">(</span><span class="ident" id="7669426"><a href="/image/png/reader_test.go.html#7669393">b</a></span><span class="op" id="7669427">,</span>&nbsp;<span class="string" id="7669429">&#34;testdata/benchRGB-interlace.png&#34;</span><span class="op" id="7669462">,</span>&nbsp;<span class="num" id="7669464">4</span><span class="op" id="7669465">)</span><br>
<span class="lineno"></span><span class="op" id="7669467">}</span>
</div>
</body>
</html>
