<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html" class="current">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3814456">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3814511">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3814565">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3814616">package</span>&nbsp;<span class="ident" id="3814624">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3814630">import</span>&nbsp;<span class="op" id="3814637">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3814640">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3814647">&#34;io&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3814652">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3814655">//&nbsp;fileTransport&nbsp;implements&nbsp;RoundTripper&nbsp;for&nbsp;the&nbsp;&#39;file&#39;&nbsp;protocol.</span><br>
<span class="lineno"></span><span class="keyword" id="3814721">type</span>&nbsp;<span class="ident" id="3814726">fileTransport</span>&nbsp;<span class="keyword" id="3814740">struct</span>&nbsp;<span class="op" id="3814747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3814750">fh</span>&nbsp;<span class="ident" id="3814753">fileHandler</span><br>
<span class="lineno">15</span><span class="op" id="3814765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3814768">//&nbsp;NewFileTransport&nbsp;returns&nbsp;a&nbsp;new&nbsp;RoundTripper,&nbsp;serving&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span><span class="comment" id="3814837">//&nbsp;FileSystem.&nbsp;The&nbsp;returned&nbsp;RoundTripper&nbsp;ignores&nbsp;the&nbsp;URL&nbsp;host&nbsp;in&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="3814906">//&nbsp;incoming&nbsp;requests,&nbsp;as&nbsp;well&nbsp;as&nbsp;most&nbsp;other&nbsp;properties&nbsp;of&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="3814968">//&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="3814980">//</span><br>
<span class="lineno"></span><span class="comment" id="3814983">//&nbsp;The&nbsp;typical&nbsp;use&nbsp;case&nbsp;for&nbsp;NewFileTransport&nbsp;is&nbsp;to&nbsp;register&nbsp;the&nbsp;&#34;file&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3815054">//&nbsp;protocol&nbsp;with&nbsp;a&nbsp;Transport,&nbsp;as&nbsp;in:</span><br>
<span class="lineno"></span><span class="comment" id="3815091">//</span><br>
<span class="lineno">25</span><span class="comment" id="3815094">//&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;&amp;http.Transport{}</span><br>
<span class="lineno"></span><span class="comment" id="3815122">//&nbsp;&nbsp;&nbsp;t.RegisterProtocol(&#34;file&#34;,&nbsp;http.NewFileTransport(http.Dir(&#34;/&#34;)))</span><br>
<span class="lineno"></span><span class="comment" id="3815192">//&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;&amp;http.Client{Transport:&nbsp;t}</span><br>
<span class="lineno"></span><span class="comment" id="3815229">//&nbsp;&nbsp;&nbsp;res,&nbsp;err&nbsp;:=&nbsp;c.Get(&#34;file:///etc/passwd&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3815274">//&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno">30</span><span class="keyword" id="3815283">func</span>&nbsp;<span class="ident" id="3815288">NewFileTransport</span><span class="op" id="3815304">(</span><span class="ident" id="3815305">fs</span>&nbsp;<span class="ident" id="3815308">FileSystem</span><span class="op" id="3815318">)</span>&nbsp;<span class="ident" id="3815320">RoundTripper</span>&nbsp;<span class="op" id="3815333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815336">return</span>&nbsp;<span class="ident" id="3815343">fileTransport</span><span class="op" id="3815356">{</span><span class="ident" id="3815357">fileHandler</span><span class="op" id="3815368">{</span><span class="ident" id="3815369">fs</span><span class="op" id="3815371">}</span><span class="op" id="3815372">}</span><br>
<span class="lineno"></span><span class="op" id="3815374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3815377">func</span>&nbsp;<span class="op" id="3815382">(</span><span class="ident" id="3815383">t</span>&nbsp;<span class="ident" id="3815385">fileTransport</span><span class="op" id="3815398">)</span>&nbsp;<span class="ident" id="3815400">RoundTrip</span><span class="op" id="3815409">(</span><span class="ident" id="3815410">req</span>&nbsp;<span class="op" id="3815414">*</span><span class="ident" id="3815415">Request</span><span class="op" id="3815422">)</span>&nbsp;<span class="op" id="3815424">(</span><span class="ident" id="3815425">resp</span>&nbsp;<span class="op" id="3815430">*</span><span class="ident" id="3815431">Response</span><span class="op" id="3815439">,</span>&nbsp;<span class="ident" id="3815441">err</span>&nbsp;<span class="builtintype" id="3815445">error</span><span class="op" id="3815450">)</span>&nbsp;<span class="op" id="3815452">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3815455">//&nbsp;We&nbsp;start&nbsp;ServeHTTP&nbsp;in&nbsp;a&nbsp;goroutine,&nbsp;which&nbsp;may&nbsp;take&nbsp;a&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3815516">//&nbsp;time&nbsp;if&nbsp;the&nbsp;file&nbsp;is&nbsp;large.&nbsp;&nbsp;The&nbsp;newPopulateResponseWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3815578">//&nbsp;call&nbsp;returns&nbsp;a&nbsp;channel&nbsp;which&nbsp;either&nbsp;ServeHTTP&nbsp;or&nbsp;finish()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3815640">//&nbsp;sends&nbsp;our&nbsp;*Response&nbsp;on,&nbsp;once&nbsp;the&nbsp;*Response&nbsp;itself&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3815703">//&nbsp;populated&nbsp;(even&nbsp;if&nbsp;the&nbsp;body&nbsp;itself&nbsp;is&nbsp;still&nbsp;being</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3815757">//&nbsp;written&nbsp;to&nbsp;the&nbsp;res.Body,&nbsp;a&nbsp;pipe)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3815794">rw</span><span class="op" id="3815796">,</span>&nbsp;<span class="ident" id="3815798">resc</span>&nbsp;<span class="op" id="3815803">:=</span>&nbsp;<span class="ident" id="3815806">newPopulateResponseWriter</span><span class="op" id="3815831">(</span><span class="op" id="3815832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815835">go</span>&nbsp;<span class="keyword" id="3815838">func</span><span class="op" id="3815842">(</span><span class="op" id="3815843">)</span>&nbsp;<span class="op" id="3815845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3815849">t</span><span class="op" id="3815850">.</span><span class="ident" id="3815851">fh</span><span class="op" id="3815853">.</span><span class="ident" id="3815854">ServeHTTP</span><span class="op" id="3815863">(</span><span class="ident" id="3815864">rw</span><span class="op" id="3815866">,</span>&nbsp;<span class="ident" id="3815868">req</span><span class="op" id="3815871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3815875">rw</span><span class="op" id="3815877">.</span><span class="ident" id="3815878">finish</span><span class="op" id="3815884">(</span><span class="op" id="3815885">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3815888">}</span><span class="op" id="3815889">(</span><span class="op" id="3815890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815893">return</span>&nbsp;<span class="op" id="3815900">&lt;-</span><span class="ident" id="3815902">resc</span><span class="op" id="3815906">,</span>&nbsp;<span class="ident" id="3815908">nil</span><br>
<span class="lineno"></span><span class="op" id="3815912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3815915">func</span>&nbsp;<span class="ident" id="3815920">newPopulateResponseWriter</span><span class="op" id="3815945">(</span><span class="op" id="3815946">)</span>&nbsp;<span class="op" id="3815948">(</span><span class="op" id="3815949">*</span><span class="ident" id="3815950">populateResponse</span><span class="op" id="3815966">,</span>&nbsp;<span class="op" id="3815968">&lt;-</span><span class="keyword" id="3815970">chan</span>&nbsp;<span class="op" id="3815975">*</span><span class="ident" id="3815976">Response</span><span class="op" id="3815984">)</span>&nbsp;<span class="op" id="3815986">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3815989">pr</span><span class="op" id="3815991">,</span>&nbsp;<span class="ident" id="3815993">pw</span>&nbsp;<span class="op" id="3815996">:=</span>&nbsp;<span class="ident" id="3815999">io</span><span class="op" id="3816001">.</span><span class="ident" id="3816002">Pipe</span><span class="op" id="3816006">(</span><span class="op" id="3816007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816010">rw</span>&nbsp;<span class="op" id="3816013">:=</span>&nbsp;<span class="op" id="3816016">&amp;</span><span class="ident" id="3816017">populateResponse</span><span class="op" id="3816033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816037">ch</span><span class="op" id="3816039">:</span>&nbsp;<span class="builtinfunc" id="3816041">make</span><span class="op" id="3816045">(</span><span class="keyword" id="3816046">chan</span>&nbsp;<span class="op" id="3816051">*</span><span class="ident" id="3816052">Response</span><span class="op" id="3816060">)</span><span class="op" id="3816061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816065">pw</span><span class="op" id="3816067">:</span>&nbsp;<span class="ident" id="3816069">pw</span><span class="op" id="3816071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816075">res</span><span class="op" id="3816078">:</span>&nbsp;<span class="op" id="3816080">&amp;</span><span class="ident" id="3816081">Response</span><span class="op" id="3816089">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816094">Proto</span><span class="op" id="3816099">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3816106">&#34;HTTP/1.0&#34;</span><span class="op" id="3816116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816121">ProtoMajor</span><span class="op" id="3816131">:</span>&nbsp;<span class="num" id="3816133">1</span><span class="op" id="3816134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816139">Header</span><span class="op" id="3816145">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3816151">make</span><span class="op" id="3816155">(</span><span class="ident" id="3816156">Header</span><span class="op" id="3816162">)</span><span class="op" id="3816163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816168">Close</span><span class="op" id="3816173">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3816180">true</span><span class="op" id="3816184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816189">Body</span><span class="op" id="3816193">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816201">pr</span><span class="op" id="3816203">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3816207">}</span><span class="op" id="3816208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3816211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816214">return</span>&nbsp;<span class="ident" id="3816221">rw</span><span class="op" id="3816223">,</span>&nbsp;<span class="ident" id="3816225">rw</span><span class="op" id="3816227">.</span><span class="ident" id="3816228">ch</span><br>
<span class="lineno"></span><span class="op" id="3816231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="3816234">//&nbsp;populateResponse&nbsp;is&nbsp;a&nbsp;ResponseWriter&nbsp;that&nbsp;populates&nbsp;the&nbsp;*Response</span><br>
<span class="lineno"></span><span class="comment" id="3816303">//&nbsp;in&nbsp;res,&nbsp;and&nbsp;writes&nbsp;its&nbsp;body&nbsp;to&nbsp;a&nbsp;pipe&nbsp;connected&nbsp;to&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span><span class="comment" id="3816370">//&nbsp;body.&nbsp;Once&nbsp;writes&nbsp;begin&nbsp;or&nbsp;finish()&nbsp;is&nbsp;called,&nbsp;the&nbsp;response&nbsp;is&nbsp;sent</span><br>
<span class="lineno"></span><span class="comment" id="3816441">//&nbsp;on&nbsp;ch.</span><br>
<span class="lineno"></span><span class="keyword" id="3816451">type</span>&nbsp;<span class="ident" id="3816456">populateResponse</span>&nbsp;<span class="keyword" id="3816473">struct</span>&nbsp;<span class="op" id="3816480">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816483">res</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3816496">*</span><span class="ident" id="3816497">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816507">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816520">chan</span>&nbsp;<span class="op" id="3816525">*</span><span class="ident" id="3816526">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816536">wroteHeader</span>&nbsp;&nbsp;<span class="builtintype" id="3816549">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816555">hasContent</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3816568">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816574">sentResponse</span>&nbsp;<span class="builtintype" id="3816587">bool</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816593">pw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3816606">*</span><span class="ident" id="3816607">io</span><span class="op" id="3816609">.</span><span class="ident" id="3816610">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="3816621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3816624">func</span>&nbsp;<span class="op" id="3816629">(</span><span class="ident" id="3816630">pr</span>&nbsp;<span class="op" id="3816633">*</span><span class="ident" id="3816634">populateResponse</span><span class="op" id="3816650">)</span>&nbsp;<span class="ident" id="3816652">finish</span><span class="op" id="3816658">(</span><span class="op" id="3816659">)</span>&nbsp;<span class="op" id="3816661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816664">if</span>&nbsp;<span class="op" id="3816667">!</span><span class="ident" id="3816668">pr</span><span class="op" id="3816670">.</span><span class="ident" id="3816671">wroteHeader</span>&nbsp;<span class="op" id="3816683">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816687">pr</span><span class="op" id="3816689">.</span><span class="ident" id="3816690">WriteHeader</span><span class="op" id="3816701">(</span><span class="num" id="3816702">500</span><span class="op" id="3816705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3816708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816711">if</span>&nbsp;<span class="op" id="3816714">!</span><span class="ident" id="3816715">pr</span><span class="op" id="3816717">.</span><span class="ident" id="3816718">sentResponse</span>&nbsp;<span class="op" id="3816731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816735">pr</span><span class="op" id="3816737">.</span><span class="ident" id="3816738">sendResponse</span><span class="op" id="3816750">(</span><span class="op" id="3816751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3816754">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816757">pr</span><span class="op" id="3816759">.</span><span class="ident" id="3816760">pw</span><span class="op" id="3816762">.</span><span class="ident" id="3816763">Close</span><span class="op" id="3816768">(</span><span class="op" id="3816769">)</span><br>
<span class="lineno"></span><span class="op" id="3816771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3816774">func</span>&nbsp;<span class="op" id="3816779">(</span><span class="ident" id="3816780">pr</span>&nbsp;<span class="op" id="3816783">*</span><span class="ident" id="3816784">populateResponse</span><span class="op" id="3816800">)</span>&nbsp;<span class="ident" id="3816802">sendResponse</span><span class="op" id="3816814">(</span><span class="op" id="3816815">)</span>&nbsp;<span class="op" id="3816817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816820">if</span>&nbsp;<span class="ident" id="3816823">pr</span><span class="op" id="3816825">.</span><span class="ident" id="3816826">sentResponse</span>&nbsp;<span class="op" id="3816839">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816843">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3816851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816854">pr</span><span class="op" id="3816856">.</span><span class="ident" id="3816857">sentResponse</span>&nbsp;<span class="op" id="3816870">=</span>&nbsp;<span class="builtintype" id="3816872">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816879">if</span>&nbsp;<span class="ident" id="3816882">pr</span><span class="op" id="3816884">.</span><span class="ident" id="3816885">hasContent</span>&nbsp;<span class="op" id="3816896">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816900">pr</span><span class="op" id="3816902">.</span><span class="ident" id="3816903">res</span><span class="op" id="3816906">.</span><span class="ident" id="3816907">ContentLength</span>&nbsp;<span class="op" id="3816921">=</span>&nbsp;<span class="op" id="3816923">-</span><span class="num" id="3816924">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3816927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816930">pr</span><span class="op" id="3816932">.</span><span class="ident" id="3816933">ch</span>&nbsp;<span class="op" id="3816936">&lt;-</span>&nbsp;<span class="ident" id="3816939">pr</span><span class="op" id="3816941">.</span><span class="ident" id="3816942">res</span><br>
<span class="lineno"></span><span class="op" id="3816946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3816949">func</span>&nbsp;<span class="op" id="3816954">(</span><span class="ident" id="3816955">pr</span>&nbsp;<span class="op" id="3816958">*</span><span class="ident" id="3816959">populateResponse</span><span class="op" id="3816975">)</span>&nbsp;<span class="ident" id="3816977">Header</span><span class="op" id="3816983">(</span><span class="op" id="3816984">)</span>&nbsp;<span class="ident" id="3816986">Header</span>&nbsp;<span class="op" id="3816993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816996">return</span>&nbsp;<span class="ident" id="3817003">pr</span><span class="op" id="3817005">.</span><span class="ident" id="3817006">res</span><span class="op" id="3817009">.</span><span class="ident" id="3817010">Header</span><br>
<span class="lineno"></span><span class="op" id="3817017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3817020">func</span>&nbsp;<span class="op" id="3817025">(</span><span class="ident" id="3817026">pr</span>&nbsp;<span class="op" id="3817029">*</span><span class="ident" id="3817030">populateResponse</span><span class="op" id="3817046">)</span>&nbsp;<span class="ident" id="3817048">WriteHeader</span><span class="op" id="3817059">(</span><span class="ident" id="3817060">code</span>&nbsp;<span class="builtintype" id="3817065">int</span><span class="op" id="3817068">)</span>&nbsp;<span class="op" id="3817070">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817073">if</span>&nbsp;<span class="ident" id="3817076">pr</span><span class="op" id="3817078">.</span><span class="ident" id="3817079">wroteHeader</span>&nbsp;<span class="op" id="3817091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817095">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3817103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817106">pr</span><span class="op" id="3817108">.</span><span class="ident" id="3817109">wroteHeader</span>&nbsp;<span class="op" id="3817121">=</span>&nbsp;<span class="builtintype" id="3817123">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817130">pr</span><span class="op" id="3817132">.</span><span class="ident" id="3817133">res</span><span class="op" id="3817136">.</span><span class="ident" id="3817137">StatusCode</span>&nbsp;<span class="op" id="3817148">=</span>&nbsp;<span class="ident" id="3817150">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817156">pr</span><span class="op" id="3817158">.</span><span class="ident" id="3817159">res</span><span class="op" id="3817162">.</span><span class="ident" id="3817163">Status</span>&nbsp;<span class="op" id="3817170">=</span>&nbsp;<span class="ident" id="3817172">fmt</span><span class="op" id="3817175">.</span><span class="ident" id="3817176">Sprintf</span><span class="op" id="3817183">(</span><span class="string" id="3817184">&#34;%d&nbsp;%s&#34;</span><span class="op" id="3817191">,</span>&nbsp;<span class="ident" id="3817193">code</span><span class="op" id="3817197">,</span>&nbsp;<span class="ident" id="3817199">StatusText</span><span class="op" id="3817209">(</span><span class="ident" id="3817210">code</span><span class="op" id="3817214">)</span><span class="op" id="3817215">)</span><br>
<span class="lineno"></span><span class="op" id="3817217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3817220">func</span>&nbsp;<span class="op" id="3817225">(</span><span class="ident" id="3817226">pr</span>&nbsp;<span class="op" id="3817229">*</span><span class="ident" id="3817230">populateResponse</span><span class="op" id="3817246">)</span>&nbsp;<span class="ident" id="3817248">Write</span><span class="op" id="3817253">(</span><span class="ident" id="3817254">p</span>&nbsp;<span class="op" id="3817256">[</span><span class="op" id="3817257">]</span><span class="builtintype" id="3817258">byte</span><span class="op" id="3817262">)</span>&nbsp;<span class="op" id="3817264">(</span><span class="ident" id="3817265">n</span>&nbsp;<span class="builtintype" id="3817267">int</span><span class="op" id="3817270">,</span>&nbsp;<span class="ident" id="3817272">err</span>&nbsp;<span class="builtintype" id="3817276">error</span><span class="op" id="3817281">)</span>&nbsp;<span class="op" id="3817283">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817286">if</span>&nbsp;<span class="op" id="3817289">!</span><span class="ident" id="3817290">pr</span><span class="op" id="3817292">.</span><span class="ident" id="3817293">wroteHeader</span>&nbsp;<span class="op" id="3817305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817309">pr</span><span class="op" id="3817311">.</span><span class="ident" id="3817312">WriteHeader</span><span class="op" id="3817323">(</span><span class="ident" id="3817324">StatusOK</span><span class="op" id="3817332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3817335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817338">pr</span><span class="op" id="3817340">.</span><span class="ident" id="3817341">hasContent</span>&nbsp;<span class="op" id="3817352">=</span>&nbsp;<span class="builtintype" id="3817354">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817360">if</span>&nbsp;<span class="op" id="3817363">!</span><span class="ident" id="3817364">pr</span><span class="op" id="3817366">.</span><span class="ident" id="3817367">sentResponse</span>&nbsp;<span class="op" id="3817380">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817384">pr</span><span class="op" id="3817386">.</span><span class="ident" id="3817387">sendResponse</span><span class="op" id="3817399">(</span><span class="op" id="3817400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3817403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817406">return</span>&nbsp;<span class="ident" id="3817413">pr</span><span class="op" id="3817415">.</span><span class="ident" id="3817416">pw</span><span class="op" id="3817418">.</span><span class="ident" id="3817419">Write</span><span class="op" id="3817424">(</span><span class="ident" id="3817425">p</span><span class="op" id="3817426">)</span><br>
<span class="lineno"></span><span class="op" id="3817428">}</span>
</div>
</body>
</html>
