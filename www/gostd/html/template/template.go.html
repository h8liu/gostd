<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html" class="current">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3046874">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3046929">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3046983">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3047034">package</span>&nbsp;<span class="ident" id="3047042">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3047052">import</span>&nbsp;<span class="op" id="3047059">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3047062">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3047069">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3047075">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3047088">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3047105">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3047113">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3047130">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="3047152">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3047155">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="3047235">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="3047262">type</span>&nbsp;<span class="ident" id="3047267">Template</span>&nbsp;<span class="keyword" id="3047276">struct</span>&nbsp;<span class="op" id="3047283">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3047286">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047322">escapeErr</span>&nbsp;<span class="builtintype" id="3047332">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3047339">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3047413">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3047482">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047506">text</span>&nbsp;<span class="op" id="3047511">*</span><span class="ident" id="3047512">template</span><span class="op" id="3047520">.</span><span class="ident" id="3047521">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3047531">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047598">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3047609">*</span><span class="ident" id="3047610">parse</span><span class="op" id="3047615">.</span><span class="ident" id="3047616">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3047622">*</span><span class="ident" id="3047623">nameSpace</span>&nbsp;<span class="comment" id="3047633">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="3047671">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3047674">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="3047739">var</span>&nbsp;<span class="ident" id="3047743">escapeOK</span>&nbsp;<span class="op" id="3047752">=</span>&nbsp;<span class="ident" id="3047754">fmt</span><span class="op" id="3047757">.</span><span class="ident" id="3047758">Errorf</span><span class="op" id="3047764">(</span><span class="string" id="3047765">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="3047793">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3047796">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="3047874">type</span>&nbsp;<span class="ident" id="3047879">nameSpace</span>&nbsp;<span class="keyword" id="3047889">struct</span>&nbsp;<span class="op" id="3047896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047899">mu</span>&nbsp;&nbsp;<span class="ident" id="3047903">sync</span><span class="op" id="3047907">.</span><span class="ident" id="3047908">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047915">set</span>&nbsp;<span class="keyword" id="3047919">map</span><span class="op" id="3047922">[</span><span class="builtintype" id="3047923">string</span><span class="op" id="3047929">]</span><span class="op" id="3047930">*</span><span class="ident" id="3047931">Template</span><br>
<span class="lineno"></span><span class="op" id="3047940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="3047943">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="3048020">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="3048031">func</span>&nbsp;<span class="op" id="3048036">(</span><span class="ident" id="3048037">t</span>&nbsp;<span class="op" id="3048039">*</span><span class="ident" id="3048040">Template</span><span class="op" id="3048048">)</span>&nbsp;<span class="ident" id="3048050">Templates</span><span class="op" id="3048059">(</span><span class="op" id="3048060">)</span>&nbsp;<span class="op" id="3048062">[</span><span class="op" id="3048063">]</span><span class="op" id="3048064">*</span><span class="ident" id="3048065">Template</span>&nbsp;<span class="op" id="3048074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048077">ns</span>&nbsp;<span class="op" id="3048080">:=</span>&nbsp;<span class="ident" id="3048083">t</span><span class="op" id="3048084">.</span><span class="ident" id="3048085">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048096">ns</span><span class="op" id="3048098">.</span><span class="ident" id="3048099">mu</span><span class="op" id="3048101">.</span><span class="ident" id="3048102">Lock</span><span class="op" id="3048106">(</span><span class="op" id="3048107">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048110">defer</span>&nbsp;<span class="ident" id="3048116">ns</span><span class="op" id="3048118">.</span><span class="ident" id="3048119">mu</span><span class="op" id="3048121">.</span><span class="ident" id="3048122">Unlock</span><span class="op" id="3048128">(</span><span class="op" id="3048129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3048132">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048179">m</span>&nbsp;<span class="op" id="3048181">:=</span>&nbsp;<span class="builtinfunc" id="3048184">make</span><span class="op" id="3048188">(</span><span class="op" id="3048189">[</span><span class="op" id="3048190">]</span><span class="op" id="3048191">*</span><span class="ident" id="3048192">Template</span><span class="op" id="3048200">,</span>&nbsp;<span class="num" id="3048202">0</span><span class="op" id="3048203">,</span>&nbsp;<span class="builtinfunc" id="3048205">len</span><span class="op" id="3048208">(</span><span class="ident" id="3048209">ns</span><span class="op" id="3048211">.</span><span class="ident" id="3048212">set</span><span class="op" id="3048215">)</span><span class="op" id="3048216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048219">for</span>&nbsp;<span class="ident" id="3048223">_</span><span class="op" id="3048224">,</span>&nbsp;<span class="ident" id="3048226">v</span>&nbsp;<span class="op" id="3048228">:=</span>&nbsp;<span class="keyword" id="3048231">range</span>&nbsp;<span class="ident" id="3048237">ns</span><span class="op" id="3048239">.</span><span class="ident" id="3048240">set</span>&nbsp;<span class="op" id="3048244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048248">m</span>&nbsp;<span class="op" id="3048250">=</span>&nbsp;<span class="builtinfunc" id="3048252">append</span><span class="op" id="3048258">(</span><span class="ident" id="3048259">m</span><span class="op" id="3048260">,</span>&nbsp;<span class="ident" id="3048262">v</span><span class="op" id="3048263">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048269">return</span>&nbsp;<span class="ident" id="3048276">m</span><br>
<span class="lineno"></span><span class="op" id="3048278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3048281">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="3048325">func</span>&nbsp;<span class="op" id="3048330">(</span><span class="ident" id="3048331">t</span>&nbsp;<span class="op" id="3048333">*</span><span class="ident" id="3048334">Template</span><span class="op" id="3048342">)</span>&nbsp;<span class="ident" id="3048344">escape</span><span class="op" id="3048350">(</span><span class="op" id="3048351">)</span>&nbsp;<span class="builtintype" id="3048353">error</span>&nbsp;<span class="op" id="3048359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048362">t</span><span class="op" id="3048363">.</span><span class="ident" id="3048364">nameSpace</span><span class="op" id="3048373">.</span><span class="ident" id="3048374">mu</span><span class="op" id="3048376">.</span><span class="ident" id="3048377">Lock</span><span class="op" id="3048381">(</span><span class="op" id="3048382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048385">defer</span>&nbsp;<span class="ident" id="3048391">t</span><span class="op" id="3048392">.</span><span class="ident" id="3048393">nameSpace</span><span class="op" id="3048402">.</span><span class="ident" id="3048403">mu</span><span class="op" id="3048405">.</span><span class="ident" id="3048406">Unlock</span><span class="op" id="3048412">(</span><span class="op" id="3048413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048416">if</span>&nbsp;<span class="ident" id="3048419">t</span><span class="op" id="3048420">.</span><span class="ident" id="3048421">escapeErr</span>&nbsp;<span class="op" id="3048431">==</span>&nbsp;<span class="builtintype" id="3048434">nil</span>&nbsp;<span class="op" id="3048438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048442">if</span>&nbsp;<span class="ident" id="3048445">err</span>&nbsp;<span class="op" id="3048449">:=</span>&nbsp;<span class="ident" id="3048452">escapeTemplate</span><span class="op" id="3048466">(</span><span class="ident" id="3048467">t</span><span class="op" id="3048468">,</span>&nbsp;<span class="ident" id="3048470">t</span><span class="op" id="3048471">.</span><span class="ident" id="3048472">text</span><span class="op" id="3048476">.</span><span class="ident" id="3048477">Root</span><span class="op" id="3048481">,</span>&nbsp;<span class="ident" id="3048483">t</span><span class="op" id="3048484">.</span><span class="ident" id="3048485">Name</span><span class="op" id="3048489">(</span><span class="op" id="3048490">)</span><span class="op" id="3048491">)</span><span class="op" id="3048492">;</span>&nbsp;<span class="ident" id="3048494">err</span>&nbsp;<span class="op" id="3048498">!=</span>&nbsp;<span class="builtintype" id="3048501">nil</span>&nbsp;<span class="op" id="3048505">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048510">return</span>&nbsp;<span class="ident" id="3048517">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048526">}</span>&nbsp;<span class="keyword" id="3048528">else</span>&nbsp;<span class="keyword" id="3048533">if</span>&nbsp;<span class="ident" id="3048536">t</span><span class="op" id="3048537">.</span><span class="ident" id="3048538">escapeErr</span>&nbsp;<span class="op" id="3048548">!=</span>&nbsp;<span class="ident" id="3048551">escapeOK</span>&nbsp;<span class="op" id="3048560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048564">return</span>&nbsp;<span class="ident" id="3048571">t</span><span class="op" id="3048572">.</span><span class="ident" id="3048573">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048584">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048587">return</span>&nbsp;<span class="builtintype" id="3048594">nil</span><br>
<span class="lineno"></span><span class="op" id="3048598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3048601">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="3048668">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="3048697">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3048765">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3048838">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3048860">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3048910">func</span>&nbsp;<span class="op" id="3048915">(</span><span class="ident" id="3048916">t</span>&nbsp;<span class="op" id="3048918">*</span><span class="ident" id="3048919">Template</span><span class="op" id="3048927">)</span>&nbsp;<span class="ident" id="3048929">Execute</span><span class="op" id="3048936">(</span><span class="ident" id="3048937">wr</span>&nbsp;<span class="ident" id="3048940">io</span><span class="op" id="3048942">.</span><span class="ident" id="3048943">Writer</span><span class="op" id="3048949">,</span>&nbsp;<span class="ident" id="3048951">data</span>&nbsp;<span class="keyword" id="3048956">interface</span><span class="op" id="3048965">{</span><span class="op" id="3048966">}</span><span class="op" id="3048967">)</span>&nbsp;<span class="builtintype" id="3048969">error</span>&nbsp;<span class="op" id="3048975">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048978">if</span>&nbsp;<span class="ident" id="3048981">err</span>&nbsp;<span class="op" id="3048985">:=</span>&nbsp;<span class="ident" id="3048988">t</span><span class="op" id="3048989">.</span><span class="ident" id="3048990">escape</span><span class="op" id="3048996">(</span><span class="op" id="3048997">)</span><span class="op" id="3048998">;</span>&nbsp;<span class="ident" id="3049000">err</span>&nbsp;<span class="op" id="3049004">!=</span>&nbsp;<span class="builtintype" id="3049007">nil</span>&nbsp;<span class="op" id="3049011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049015">return</span>&nbsp;<span class="ident" id="3049022">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3049027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049030">return</span>&nbsp;<span class="ident" id="3049037">t</span><span class="op" id="3049038">.</span><span class="ident" id="3049039">text</span><span class="op" id="3049043">.</span><span class="ident" id="3049044">Execute</span><span class="op" id="3049051">(</span><span class="ident" id="3049052">wr</span><span class="op" id="3049054">,</span>&nbsp;<span class="ident" id="3049056">data</span><span class="op" id="3049060">)</span><br>
<span class="lineno"></span><span class="op" id="3049062">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="3049065">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3049142">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="3049208">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3049276">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="3049349">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3049371">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3049421">func</span>&nbsp;<span class="op" id="3049426">(</span><span class="ident" id="3049427">t</span>&nbsp;<span class="op" id="3049429">*</span><span class="ident" id="3049430">Template</span><span class="op" id="3049438">)</span>&nbsp;<span class="ident" id="3049440">ExecuteTemplate</span><span class="op" id="3049455">(</span><span class="ident" id="3049456">wr</span>&nbsp;<span class="ident" id="3049459">io</span><span class="op" id="3049461">.</span><span class="ident" id="3049462">Writer</span><span class="op" id="3049468">,</span>&nbsp;<span class="ident" id="3049470">name</span>&nbsp;<span class="builtintype" id="3049475">string</span><span class="op" id="3049481">,</span>&nbsp;<span class="ident" id="3049483">data</span>&nbsp;<span class="keyword" id="3049488">interface</span><span class="op" id="3049497">{</span><span class="op" id="3049498">}</span><span class="op" id="3049499">)</span>&nbsp;<span class="builtintype" id="3049501">error</span>&nbsp;<span class="op" id="3049507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049510">tmpl</span><span class="op" id="3049514">,</span>&nbsp;<span class="ident" id="3049516">err</span>&nbsp;<span class="op" id="3049520">:=</span>&nbsp;<span class="ident" id="3049523">t</span><span class="op" id="3049524">.</span><span class="ident" id="3049525">lookupAndEscapeTemplate</span><span class="op" id="3049548">(</span><span class="ident" id="3049549">name</span><span class="op" id="3049553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049556">if</span>&nbsp;<span class="ident" id="3049559">err</span>&nbsp;<span class="op" id="3049563">!=</span>&nbsp;<span class="builtintype" id="3049566">nil</span>&nbsp;<span class="op" id="3049570">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049574">return</span>&nbsp;<span class="ident" id="3049581">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3049586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049589">return</span>&nbsp;<span class="ident" id="3049596">tmpl</span><span class="op" id="3049600">.</span><span class="ident" id="3049601">text</span><span class="op" id="3049605">.</span><span class="ident" id="3049606">Execute</span><span class="op" id="3049613">(</span><span class="ident" id="3049614">wr</span><span class="op" id="3049616">,</span>&nbsp;<span class="ident" id="3049618">data</span><span class="op" id="3049622">)</span><br>
<span class="lineno"></span><span class="op" id="3049624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="3049627">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="3049703">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="3049776">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="3049789">func</span>&nbsp;<span class="op" id="3049794">(</span><span class="ident" id="3049795">t</span>&nbsp;<span class="op" id="3049797">*</span><span class="ident" id="3049798">Template</span><span class="op" id="3049806">)</span>&nbsp;<span class="ident" id="3049808">lookupAndEscapeTemplate</span><span class="op" id="3049831">(</span><span class="ident" id="3049832">name</span>&nbsp;<span class="builtintype" id="3049837">string</span><span class="op" id="3049843">)</span>&nbsp;<span class="op" id="3049845">(</span><span class="ident" id="3049846">tmpl</span>&nbsp;<span class="op" id="3049851">*</span><span class="ident" id="3049852">Template</span><span class="op" id="3049860">,</span>&nbsp;<span class="ident" id="3049862">err</span>&nbsp;<span class="builtintype" id="3049866">error</span><span class="op" id="3049871">)</span>&nbsp;<span class="op" id="3049873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049876">t</span><span class="op" id="3049877">.</span><span class="ident" id="3049878">nameSpace</span><span class="op" id="3049887">.</span><span class="ident" id="3049888">mu</span><span class="op" id="3049890">.</span><span class="ident" id="3049891">Lock</span><span class="op" id="3049895">(</span><span class="op" id="3049896">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049899">defer</span>&nbsp;<span class="ident" id="3049905">t</span><span class="op" id="3049906">.</span><span class="ident" id="3049907">nameSpace</span><span class="op" id="3049916">.</span><span class="ident" id="3049917">mu</span><span class="op" id="3049919">.</span><span class="ident" id="3049920">Unlock</span><span class="op" id="3049926">(</span><span class="op" id="3049927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049930">tmpl</span>&nbsp;<span class="op" id="3049935">=</span>&nbsp;<span class="ident" id="3049937">t</span><span class="op" id="3049938">.</span><span class="ident" id="3049939">set</span><span class="op" id="3049942">[</span><span class="ident" id="3049943">name</span><span class="op" id="3049947">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049950">if</span>&nbsp;<span class="ident" id="3049953">tmpl</span>&nbsp;<span class="op" id="3049958">==</span>&nbsp;<span class="builtintype" id="3049961">nil</span>&nbsp;<span class="op" id="3049965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049969">return</span>&nbsp;<span class="builtintype" id="3049976">nil</span><span class="op" id="3049979">,</span>&nbsp;<span class="ident" id="3049981">fmt</span><span class="op" id="3049984">.</span><span class="ident" id="3049985">Errorf</span><span class="op" id="3049991">(</span><span class="string" id="3049992">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="3050024">,</span>&nbsp;<span class="ident" id="3050026">name</span><span class="op" id="3050030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3050033">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050036">if</span>&nbsp;<span class="ident" id="3050039">tmpl</span><span class="op" id="3050043">.</span><span class="ident" id="3050044">escapeErr</span>&nbsp;<span class="op" id="3050054">!=</span>&nbsp;<span class="builtintype" id="3050057">nil</span>&nbsp;<span class="op" id="3050061">&amp;&amp;</span>&nbsp;<span class="ident" id="3050064">tmpl</span><span class="op" id="3050068">.</span><span class="ident" id="3050069">escapeErr</span>&nbsp;<span class="op" id="3050079">!=</span>&nbsp;<span class="ident" id="3050082">escapeOK</span>&nbsp;<span class="op" id="3050091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050095">return</span>&nbsp;<span class="builtintype" id="3050102">nil</span><span class="op" id="3050105">,</span>&nbsp;<span class="ident" id="3050107">tmpl</span><span class="op" id="3050111">.</span><span class="ident" id="3050112">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3050123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050126">if</span>&nbsp;<span class="ident" id="3050129">tmpl</span><span class="op" id="3050133">.</span><span class="ident" id="3050134">text</span><span class="op" id="3050138">.</span><span class="ident" id="3050139">Tree</span>&nbsp;<span class="op" id="3050144">==</span>&nbsp;<span class="builtintype" id="3050147">nil</span>&nbsp;<span class="op" id="3050151">||</span>&nbsp;<span class="ident" id="3050154">tmpl</span><span class="op" id="3050158">.</span><span class="ident" id="3050159">text</span><span class="op" id="3050163">.</span><span class="ident" id="3050164">Root</span>&nbsp;<span class="op" id="3050169">==</span>&nbsp;<span class="builtintype" id="3050172">nil</span>&nbsp;<span class="op" id="3050176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050180">return</span>&nbsp;<span class="builtintype" id="3050187">nil</span><span class="op" id="3050190">,</span>&nbsp;<span class="ident" id="3050192">fmt</span><span class="op" id="3050195">.</span><span class="ident" id="3050196">Errorf</span><span class="op" id="3050202">(</span><span class="string" id="3050203">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="3050248">,</span>&nbsp;<span class="ident" id="3050250">name</span><span class="op" id="3050254">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3050257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050260">if</span>&nbsp;<span class="ident" id="3050263">t</span><span class="op" id="3050264">.</span><span class="ident" id="3050265">text</span><span class="op" id="3050269">.</span><span class="ident" id="3050270">Lookup</span><span class="op" id="3050276">(</span><span class="ident" id="3050277">name</span><span class="op" id="3050281">)</span>&nbsp;<span class="op" id="3050283">==</span>&nbsp;<span class="builtintype" id="3050286">nil</span>&nbsp;<span class="op" id="3050290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3050294">panic</span><span class="op" id="3050299">(</span><span class="string" id="3050300">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="3050361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3050364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050367">if</span>&nbsp;<span class="ident" id="3050370">tmpl</span><span class="op" id="3050374">.</span><span class="ident" id="3050375">escapeErr</span>&nbsp;<span class="op" id="3050385">==</span>&nbsp;<span class="builtintype" id="3050388">nil</span>&nbsp;<span class="op" id="3050392">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3050396">err</span>&nbsp;<span class="op" id="3050400">=</span>&nbsp;<span class="ident" id="3050402">escapeTemplate</span><span class="op" id="3050416">(</span><span class="ident" id="3050417">tmpl</span><span class="op" id="3050421">,</span>&nbsp;<span class="ident" id="3050423">tmpl</span><span class="op" id="3050427">.</span><span class="ident" id="3050428">text</span><span class="op" id="3050432">.</span><span class="ident" id="3050433">Root</span><span class="op" id="3050437">,</span>&nbsp;<span class="ident" id="3050439">name</span><span class="op" id="3050443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3050446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050449">return</span>&nbsp;<span class="ident" id="3050456">tmpl</span><span class="op" id="3050460">,</span>&nbsp;<span class="ident" id="3050462">err</span><br>
<span class="lineno"></span><span class="op" id="3050466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3050469">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="3050539">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3050605">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="3050677">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="3050750">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="3050814">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="3050885">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="3050952">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="3051010">func</span>&nbsp;<span class="op" id="3051015">(</span><span class="ident" id="3051016">t</span>&nbsp;<span class="op" id="3051018">*</span><span class="ident" id="3051019">Template</span><span class="op" id="3051027">)</span>&nbsp;<span class="ident" id="3051029">Parse</span><span class="op" id="3051034">(</span><span class="ident" id="3051035">src</span>&nbsp;<span class="builtintype" id="3051039">string</span><span class="op" id="3051045">)</span>&nbsp;<span class="op" id="3051047">(</span><span class="op" id="3051048">*</span><span class="ident" id="3051049">Template</span><span class="op" id="3051057">,</span>&nbsp;<span class="builtintype" id="3051059">error</span><span class="op" id="3051064">)</span>&nbsp;<span class="op" id="3051066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051069">t</span><span class="op" id="3051070">.</span><span class="ident" id="3051071">nameSpace</span><span class="op" id="3051080">.</span><span class="ident" id="3051081">mu</span><span class="op" id="3051083">.</span><span class="ident" id="3051084">Lock</span><span class="op" id="3051088">(</span><span class="op" id="3051089">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051092">t</span><span class="op" id="3051093">.</span><span class="ident" id="3051094">escapeErr</span>&nbsp;<span class="op" id="3051104">=</span>&nbsp;<span class="builtintype" id="3051106">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051111">t</span><span class="op" id="3051112">.</span><span class="ident" id="3051113">nameSpace</span><span class="op" id="3051122">.</span><span class="ident" id="3051123">mu</span><span class="op" id="3051125">.</span><span class="ident" id="3051126">Unlock</span><span class="op" id="3051132">(</span><span class="op" id="3051133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051136">ret</span><span class="op" id="3051139">,</span>&nbsp;<span class="ident" id="3051141">err</span>&nbsp;<span class="op" id="3051145">:=</span>&nbsp;<span class="ident" id="3051148">t</span><span class="op" id="3051149">.</span><span class="ident" id="3051150">text</span><span class="op" id="3051154">.</span><span class="ident" id="3051155">Parse</span><span class="op" id="3051160">(</span><span class="ident" id="3051161">src</span><span class="op" id="3051164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051167">if</span>&nbsp;<span class="ident" id="3051170">err</span>&nbsp;<span class="op" id="3051174">!=</span>&nbsp;<span class="builtintype" id="3051177">nil</span>&nbsp;<span class="op" id="3051181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051185">return</span>&nbsp;<span class="builtintype" id="3051192">nil</span><span class="op" id="3051195">,</span>&nbsp;<span class="ident" id="3051197">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3051202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3051205">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3051275">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3051328">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051389">t</span><span class="op" id="3051390">.</span><span class="ident" id="3051391">nameSpace</span><span class="op" id="3051400">.</span><span class="ident" id="3051401">mu</span><span class="op" id="3051403">.</span><span class="ident" id="3051404">Lock</span><span class="op" id="3051408">(</span><span class="op" id="3051409">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051412">defer</span>&nbsp;<span class="ident" id="3051418">t</span><span class="op" id="3051419">.</span><span class="ident" id="3051420">nameSpace</span><span class="op" id="3051429">.</span><span class="ident" id="3051430">mu</span><span class="op" id="3051432">.</span><span class="ident" id="3051433">Unlock</span><span class="op" id="3051439">(</span><span class="op" id="3051440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051443">for</span>&nbsp;<span class="ident" id="3051447">_</span><span class="op" id="3051448">,</span>&nbsp;<span class="ident" id="3051450">v</span>&nbsp;<span class="op" id="3051452">:=</span>&nbsp;<span class="keyword" id="3051455">range</span>&nbsp;<span class="ident" id="3051461">ret</span><span class="op" id="3051464">.</span><span class="ident" id="3051465">Templates</span><span class="op" id="3051474">(</span><span class="op" id="3051475">)</span>&nbsp;<span class="op" id="3051477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051481">name</span>&nbsp;<span class="op" id="3051486">:=</span>&nbsp;<span class="ident" id="3051489">v</span><span class="op" id="3051490">.</span><span class="ident" id="3051491">Name</span><span class="op" id="3051495">(</span><span class="op" id="3051496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051500">tmpl</span>&nbsp;<span class="op" id="3051505">:=</span>&nbsp;<span class="ident" id="3051508">t</span><span class="op" id="3051509">.</span><span class="ident" id="3051510">set</span><span class="op" id="3051513">[</span><span class="ident" id="3051514">name</span><span class="op" id="3051518">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051522">if</span>&nbsp;<span class="ident" id="3051525">tmpl</span>&nbsp;<span class="op" id="3051530">==</span>&nbsp;<span class="builtintype" id="3051533">nil</span>&nbsp;<span class="op" id="3051537">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051542">tmpl</span>&nbsp;<span class="op" id="3051547">=</span>&nbsp;<span class="ident" id="3051549">t</span><span class="op" id="3051550">.</span><span class="builtinfunc" id="3051551">new</span><span class="op" id="3051554">(</span><span class="ident" id="3051555">name</span><span class="op" id="3051559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3051563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3051567">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051646">tmpl</span><span class="op" id="3051650">.</span><span class="ident" id="3051651">escapeErr</span>&nbsp;<span class="op" id="3051661">=</span>&nbsp;<span class="builtintype" id="3051663">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051669">tmpl</span><span class="op" id="3051673">.</span><span class="ident" id="3051674">text</span>&nbsp;<span class="op" id="3051679">=</span>&nbsp;<span class="ident" id="3051681">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051685">tmpl</span><span class="op" id="3051689">.</span><span class="ident" id="3051690">Tree</span>&nbsp;<span class="op" id="3051695">=</span>&nbsp;<span class="ident" id="3051697">v</span><span class="op" id="3051698">.</span><span class="ident" id="3051699">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3051705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051708">return</span>&nbsp;<span class="ident" id="3051715">t</span><span class="op" id="3051716">,</span>&nbsp;<span class="builtintype" id="3051718">nil</span><br>
<span class="lineno"></span><span class="op" id="3051722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="3051725">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="3051793">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="3051822">//</span><br>
<span class="lineno"></span><span class="comment" id="3051825">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="3051880">func</span>&nbsp;<span class="op" id="3051885">(</span><span class="ident" id="3051886">t</span>&nbsp;<span class="op" id="3051888">*</span><span class="ident" id="3051889">Template</span><span class="op" id="3051897">)</span>&nbsp;<span class="ident" id="3051899">AddParseTree</span><span class="op" id="3051911">(</span><span class="ident" id="3051912">name</span>&nbsp;<span class="builtintype" id="3051917">string</span><span class="op" id="3051923">,</span>&nbsp;<span class="ident" id="3051925">tree</span>&nbsp;<span class="op" id="3051930">*</span><span class="ident" id="3051931">parse</span><span class="op" id="3051936">.</span><span class="ident" id="3051937">Tree</span><span class="op" id="3051941">)</span>&nbsp;<span class="op" id="3051943">(</span><span class="op" id="3051944">*</span><span class="ident" id="3051945">Template</span><span class="op" id="3051953">,</span>&nbsp;<span class="builtintype" id="3051955">error</span><span class="op" id="3051960">)</span>&nbsp;<span class="op" id="3051962">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051965">t</span><span class="op" id="3051966">.</span><span class="ident" id="3051967">nameSpace</span><span class="op" id="3051976">.</span><span class="ident" id="3051977">mu</span><span class="op" id="3051979">.</span><span class="ident" id="3051980">Lock</span><span class="op" id="3051984">(</span><span class="op" id="3051985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051988">defer</span>&nbsp;<span class="ident" id="3051994">t</span><span class="op" id="3051995">.</span><span class="ident" id="3051996">nameSpace</span><span class="op" id="3052005">.</span><span class="ident" id="3052006">mu</span><span class="op" id="3052008">.</span><span class="ident" id="3052009">Unlock</span><span class="op" id="3052015">(</span><span class="op" id="3052016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052019">if</span>&nbsp;<span class="ident" id="3052022">t</span><span class="op" id="3052023">.</span><span class="ident" id="3052024">escapeErr</span>&nbsp;<span class="op" id="3052034">!=</span>&nbsp;<span class="builtintype" id="3052037">nil</span>&nbsp;<span class="op" id="3052041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052045">return</span>&nbsp;<span class="builtintype" id="3052052">nil</span><span class="op" id="3052055">,</span>&nbsp;<span class="ident" id="3052057">fmt</span><span class="op" id="3052060">.</span><span class="ident" id="3052061">Errorf</span><span class="op" id="3052067">(</span><span class="string" id="3052068">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="3052132">,</span>&nbsp;<span class="ident" id="3052134">t</span><span class="op" id="3052135">.</span><span class="ident" id="3052136">Name</span><span class="op" id="3052140">(</span><span class="op" id="3052141">)</span><span class="op" id="3052142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3052145">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052148">text</span><span class="op" id="3052152">,</span>&nbsp;<span class="ident" id="3052154">err</span>&nbsp;<span class="op" id="3052158">:=</span>&nbsp;<span class="ident" id="3052161">t</span><span class="op" id="3052162">.</span><span class="ident" id="3052163">text</span><span class="op" id="3052167">.</span><span class="ident" id="3052168">AddParseTree</span><span class="op" id="3052180">(</span><span class="ident" id="3052181">name</span><span class="op" id="3052185">,</span>&nbsp;<span class="ident" id="3052187">tree</span><span class="op" id="3052191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052194">if</span>&nbsp;<span class="ident" id="3052197">err</span>&nbsp;<span class="op" id="3052201">!=</span>&nbsp;<span class="builtintype" id="3052204">nil</span>&nbsp;<span class="op" id="3052208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052212">return</span>&nbsp;<span class="builtintype" id="3052219">nil</span><span class="op" id="3052222">,</span>&nbsp;<span class="ident" id="3052224">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3052229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052232">ret</span>&nbsp;<span class="op" id="3052236">:=</span>&nbsp;<span class="op" id="3052239">&amp;</span><span class="ident" id="3052240">Template</span><span class="op" id="3052248">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3052252">nil</span><span class="op" id="3052255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052259">text</span><span class="op" id="3052263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052267">text</span><span class="op" id="3052271">.</span><span class="ident" id="3052272">Tree</span><span class="op" id="3052276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052280">t</span><span class="op" id="3052281">.</span><span class="ident" id="3052282">nameSpace</span><span class="op" id="3052291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3052294">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052297">t</span><span class="op" id="3052298">.</span><span class="ident" id="3052299">set</span><span class="op" id="3052302">[</span><span class="ident" id="3052303">name</span><span class="op" id="3052307">]</span>&nbsp;<span class="op" id="3052309">=</span>&nbsp;<span class="ident" id="3052311">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052316">return</span>&nbsp;<span class="ident" id="3052323">ret</span><span class="op" id="3052326">,</span>&nbsp;<span class="builtintype" id="3052328">nil</span><br>
<span class="lineno"></span><span class="op" id="3052332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3052335">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="3052406">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3052483">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="3052558">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="3052637">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="3052715">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="3052766">//</span><br>
<span class="lineno"></span><span class="comment" id="3052769">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="3052824">func</span>&nbsp;<span class="op" id="3052829">(</span><span class="ident" id="3052830">t</span>&nbsp;<span class="op" id="3052832">*</span><span class="ident" id="3052833">Template</span><span class="op" id="3052841">)</span>&nbsp;<span class="ident" id="3052843">Clone</span><span class="op" id="3052848">(</span><span class="op" id="3052849">)</span>&nbsp;<span class="op" id="3052851">(</span><span class="op" id="3052852">*</span><span class="ident" id="3052853">Template</span><span class="op" id="3052861">,</span>&nbsp;<span class="builtintype" id="3052863">error</span><span class="op" id="3052868">)</span>&nbsp;<span class="op" id="3052870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052873">t</span><span class="op" id="3052874">.</span><span class="ident" id="3052875">nameSpace</span><span class="op" id="3052884">.</span><span class="ident" id="3052885">mu</span><span class="op" id="3052887">.</span><span class="ident" id="3052888">Lock</span><span class="op" id="3052892">(</span><span class="op" id="3052893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052896">defer</span>&nbsp;<span class="ident" id="3052902">t</span><span class="op" id="3052903">.</span><span class="ident" id="3052904">nameSpace</span><span class="op" id="3052913">.</span><span class="ident" id="3052914">mu</span><span class="op" id="3052916">.</span><span class="ident" id="3052917">Unlock</span><span class="op" id="3052923">(</span><span class="op" id="3052924">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052927">if</span>&nbsp;<span class="ident" id="3052930">t</span><span class="op" id="3052931">.</span><span class="ident" id="3052932">escapeErr</span>&nbsp;<span class="op" id="3052942">!=</span>&nbsp;<span class="builtintype" id="3052945">nil</span>&nbsp;<span class="op" id="3052949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052953">return</span>&nbsp;<span class="builtintype" id="3052960">nil</span><span class="op" id="3052963">,</span>&nbsp;<span class="ident" id="3052965">fmt</span><span class="op" id="3052968">.</span><span class="ident" id="3052969">Errorf</span><span class="op" id="3052975">(</span><span class="string" id="3052976">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="3053030">,</span>&nbsp;<span class="ident" id="3053032">t</span><span class="op" id="3053033">.</span><span class="ident" id="3053034">Name</span><span class="op" id="3053038">(</span><span class="op" id="3053039">)</span><span class="op" id="3053040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053046">textClone</span><span class="op" id="3053055">,</span>&nbsp;<span class="ident" id="3053057">err</span>&nbsp;<span class="op" id="3053061">:=</span>&nbsp;<span class="ident" id="3053064">t</span><span class="op" id="3053065">.</span><span class="ident" id="3053066">text</span><span class="op" id="3053070">.</span><span class="ident" id="3053071">Clone</span><span class="op" id="3053076">(</span><span class="op" id="3053077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053080">if</span>&nbsp;<span class="ident" id="3053083">err</span>&nbsp;<span class="op" id="3053087">!=</span>&nbsp;<span class="builtintype" id="3053090">nil</span>&nbsp;<span class="op" id="3053094">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053098">return</span>&nbsp;<span class="builtintype" id="3053105">nil</span><span class="op" id="3053108">,</span>&nbsp;<span class="ident" id="3053110">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053118">ret</span>&nbsp;<span class="op" id="3053122">:=</span>&nbsp;<span class="op" id="3053125">&amp;</span><span class="ident" id="3053126">Template</span><span class="op" id="3053134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3053138">nil</span><span class="op" id="3053141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053145">textClone</span><span class="op" id="3053154">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053158">textClone</span><span class="op" id="3053167">.</span><span class="ident" id="3053168">Tree</span><span class="op" id="3053172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053176">&amp;</span><span class="ident" id="3053177">nameSpace</span><span class="op" id="3053186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053191">set</span><span class="op" id="3053194">:</span>&nbsp;<span class="builtinfunc" id="3053196">make</span><span class="op" id="3053200">(</span><span class="keyword" id="3053201">map</span><span class="op" id="3053204">[</span><span class="builtintype" id="3053205">string</span><span class="op" id="3053211">]</span><span class="op" id="3053212">*</span><span class="ident" id="3053213">Template</span><span class="op" id="3053221">)</span><span class="op" id="3053222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053226">}</span><span class="op" id="3053227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053230">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053233">for</span>&nbsp;<span class="ident" id="3053237">_</span><span class="op" id="3053238">,</span>&nbsp;<span class="ident" id="3053240">x</span>&nbsp;<span class="op" id="3053242">:=</span>&nbsp;<span class="keyword" id="3053245">range</span>&nbsp;<span class="ident" id="3053251">textClone</span><span class="op" id="3053260">.</span><span class="ident" id="3053261">Templates</span><span class="op" id="3053270">(</span><span class="op" id="3053271">)</span>&nbsp;<span class="op" id="3053273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053277">name</span>&nbsp;<span class="op" id="3053282">:=</span>&nbsp;<span class="ident" id="3053285">x</span><span class="op" id="3053286">.</span><span class="ident" id="3053287">Name</span><span class="op" id="3053291">(</span><span class="op" id="3053292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053296">src</span>&nbsp;<span class="op" id="3053300">:=</span>&nbsp;<span class="ident" id="3053303">t</span><span class="op" id="3053304">.</span><span class="ident" id="3053305">set</span><span class="op" id="3053308">[</span><span class="ident" id="3053309">name</span><span class="op" id="3053313">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053317">if</span>&nbsp;<span class="ident" id="3053320">src</span>&nbsp;<span class="op" id="3053324">==</span>&nbsp;<span class="builtintype" id="3053327">nil</span>&nbsp;<span class="op" id="3053331">||</span>&nbsp;<span class="ident" id="3053334">src</span><span class="op" id="3053337">.</span><span class="ident" id="3053338">escapeErr</span>&nbsp;<span class="op" id="3053348">!=</span>&nbsp;<span class="builtintype" id="3053351">nil</span>&nbsp;<span class="op" id="3053355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053360">return</span>&nbsp;<span class="builtintype" id="3053367">nil</span><span class="op" id="3053370">,</span>&nbsp;<span class="ident" id="3053372">fmt</span><span class="op" id="3053375">.</span><span class="ident" id="3053376">Errorf</span><span class="op" id="3053382">(</span><span class="string" id="3053383">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="3053437">,</span>&nbsp;<span class="ident" id="3053439">t</span><span class="op" id="3053440">.</span><span class="ident" id="3053441">Name</span><span class="op" id="3053445">(</span><span class="op" id="3053446">)</span><span class="op" id="3053447">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053455">x</span><span class="op" id="3053456">.</span><span class="ident" id="3053457">Tree</span>&nbsp;<span class="op" id="3053462">=</span>&nbsp;<span class="ident" id="3053464">x</span><span class="op" id="3053465">.</span><span class="ident" id="3053466">Tree</span><span class="op" id="3053470">.</span><span class="ident" id="3053471">Copy</span><span class="op" id="3053475">(</span><span class="op" id="3053476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053480">ret</span><span class="op" id="3053483">.</span><span class="ident" id="3053484">set</span><span class="op" id="3053487">[</span><span class="ident" id="3053488">name</span><span class="op" id="3053492">]</span>&nbsp;<span class="op" id="3053494">=</span>&nbsp;<span class="op" id="3053496">&amp;</span><span class="ident" id="3053497">Template</span><span class="op" id="3053505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3053510">nil</span><span class="op" id="3053513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053518">x</span><span class="op" id="3053519">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053524">x</span><span class="op" id="3053525">.</span><span class="ident" id="3053526">Tree</span><span class="op" id="3053530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053535">ret</span><span class="op" id="3053538">.</span><span class="ident" id="3053539">nameSpace</span><span class="op" id="3053548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053558">return</span>&nbsp;<span class="ident" id="3053565">ret</span><span class="op" id="3053568">,</span>&nbsp;<span class="builtintype" id="3053570">nil</span><br>
<span class="lineno">220</span><span class="op" id="3053574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3053577">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3053635">func</span>&nbsp;<span class="ident" id="3053640">New</span><span class="op" id="3053643">(</span><span class="ident" id="3053644">name</span>&nbsp;<span class="builtintype" id="3053649">string</span><span class="op" id="3053655">)</span>&nbsp;<span class="op" id="3053657">*</span><span class="ident" id="3053658">Template</span>&nbsp;<span class="op" id="3053667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053670">tmpl</span>&nbsp;<span class="op" id="3053675">:=</span>&nbsp;<span class="op" id="3053678">&amp;</span><span class="ident" id="3053679">Template</span><span class="op" id="3053687">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3053691">nil</span><span class="op" id="3053694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053698">template</span><span class="op" id="3053706">.</span><span class="ident" id="3053707">New</span><span class="op" id="3053710">(</span><span class="ident" id="3053711">name</span><span class="op" id="3053715">)</span><span class="op" id="3053716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3053720">nil</span><span class="op" id="3053723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053727">&amp;</span><span class="ident" id="3053728">nameSpace</span><span class="op" id="3053737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053742">set</span><span class="op" id="3053745">:</span>&nbsp;<span class="builtinfunc" id="3053747">make</span><span class="op" id="3053751">(</span><span class="keyword" id="3053752">map</span><span class="op" id="3053755">[</span><span class="builtintype" id="3053756">string</span><span class="op" id="3053762">]</span><span class="op" id="3053763">*</span><span class="ident" id="3053764">Template</span><span class="op" id="3053772">)</span><span class="op" id="3053773">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053777">}</span><span class="op" id="3053778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053784">tmpl</span><span class="op" id="3053788">.</span><span class="ident" id="3053789">set</span><span class="op" id="3053792">[</span><span class="ident" id="3053793">name</span><span class="op" id="3053797">]</span>&nbsp;<span class="op" id="3053799">=</span>&nbsp;<span class="ident" id="3053801">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053807">return</span>&nbsp;<span class="ident" id="3053814">tmpl</span><br>
<span class="lineno"></span><span class="op" id="3053819">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="3053822">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="3053889">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="3053960">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="3054029">func</span>&nbsp;<span class="op" id="3054034">(</span><span class="ident" id="3054035">t</span>&nbsp;<span class="op" id="3054037">*</span><span class="ident" id="3054038">Template</span><span class="op" id="3054046">)</span>&nbsp;<span class="ident" id="3054048">New</span><span class="op" id="3054051">(</span><span class="ident" id="3054052">name</span>&nbsp;<span class="builtintype" id="3054057">string</span><span class="op" id="3054063">)</span>&nbsp;<span class="op" id="3054065">*</span><span class="ident" id="3054066">Template</span>&nbsp;<span class="op" id="3054075">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054078">t</span><span class="op" id="3054079">.</span><span class="ident" id="3054080">nameSpace</span><span class="op" id="3054089">.</span><span class="ident" id="3054090">mu</span><span class="op" id="3054092">.</span><span class="ident" id="3054093">Lock</span><span class="op" id="3054097">(</span><span class="op" id="3054098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054101">defer</span>&nbsp;<span class="ident" id="3054107">t</span><span class="op" id="3054108">.</span><span class="ident" id="3054109">nameSpace</span><span class="op" id="3054118">.</span><span class="ident" id="3054119">mu</span><span class="op" id="3054121">.</span><span class="ident" id="3054122">Unlock</span><span class="op" id="3054128">(</span><span class="op" id="3054129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054132">return</span>&nbsp;<span class="ident" id="3054139">t</span><span class="op" id="3054140">.</span><span class="builtinfunc" id="3054141">new</span><span class="op" id="3054144">(</span><span class="ident" id="3054145">name</span><span class="op" id="3054149">)</span><br>
<span class="lineno"></span><span class="op" id="3054151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="3054154">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="3054209">func</span>&nbsp;<span class="op" id="3054214">(</span><span class="ident" id="3054215">t</span>&nbsp;<span class="op" id="3054217">*</span><span class="ident" id="3054218">Template</span><span class="op" id="3054226">)</span>&nbsp;<span class="builtinfunc" id="3054228">new</span><span class="op" id="3054231">(</span><span class="ident" id="3054232">name</span>&nbsp;<span class="builtintype" id="3054237">string</span><span class="op" id="3054243">)</span>&nbsp;<span class="op" id="3054245">*</span><span class="ident" id="3054246">Template</span>&nbsp;<span class="op" id="3054255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054258">tmpl</span>&nbsp;<span class="op" id="3054263">:=</span>&nbsp;<span class="op" id="3054266">&amp;</span><span class="ident" id="3054267">Template</span><span class="op" id="3054275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3054279">nil</span><span class="op" id="3054282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054286">t</span><span class="op" id="3054287">.</span><span class="ident" id="3054288">text</span><span class="op" id="3054292">.</span><span class="ident" id="3054293">New</span><span class="op" id="3054296">(</span><span class="ident" id="3054297">name</span><span class="op" id="3054301">)</span><span class="op" id="3054302">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3054306">nil</span><span class="op" id="3054309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054313">t</span><span class="op" id="3054314">.</span><span class="ident" id="3054315">nameSpace</span><span class="op" id="3054324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3054327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054330">tmpl</span><span class="op" id="3054334">.</span><span class="ident" id="3054335">set</span><span class="op" id="3054338">[</span><span class="ident" id="3054339">name</span><span class="op" id="3054343">]</span>&nbsp;<span class="op" id="3054345">=</span>&nbsp;<span class="ident" id="3054347">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054353">return</span>&nbsp;<span class="ident" id="3054360">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="3054365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3054368">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="3054410">func</span>&nbsp;<span class="op" id="3054415">(</span><span class="ident" id="3054416">t</span>&nbsp;<span class="op" id="3054418">*</span><span class="ident" id="3054419">Template</span><span class="op" id="3054427">)</span>&nbsp;<span class="ident" id="3054429">Name</span><span class="op" id="3054433">(</span><span class="op" id="3054434">)</span>&nbsp;<span class="builtintype" id="3054436">string</span>&nbsp;<span class="op" id="3054443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054446">return</span>&nbsp;<span class="ident" id="3054453">t</span><span class="op" id="3054454">.</span><span class="ident" id="3054455">text</span><span class="op" id="3054459">.</span><span class="ident" id="3054460">Name</span><span class="op" id="3054464">(</span><span class="op" id="3054465">)</span><br>
<span class="lineno">260</span><span class="op" id="3054467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3054470">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3054539">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="3054614">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="3054688">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="3054764">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="3054841">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="3054914">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3054934">type</span>&nbsp;<span class="ident" id="3054939">FuncMap</span>&nbsp;<span class="keyword" id="3054947">map</span><span class="op" id="3054950">[</span><span class="builtintype" id="3054951">string</span><span class="op" id="3054957">]</span><span class="keyword" id="3054958">interface</span><span class="op" id="3054967">{</span><span class="op" id="3054968">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="3054971">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="3055050">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="3055127">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="3055202">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="3055253">func</span>&nbsp;<span class="op" id="3055258">(</span><span class="ident" id="3055259">t</span>&nbsp;<span class="op" id="3055261">*</span><span class="ident" id="3055262">Template</span><span class="op" id="3055270">)</span>&nbsp;<span class="ident" id="3055272">Funcs</span><span class="op" id="3055277">(</span><span class="ident" id="3055278">funcMap</span>&nbsp;<span class="ident" id="3055286">FuncMap</span><span class="op" id="3055293">)</span>&nbsp;<span class="op" id="3055295">*</span><span class="ident" id="3055296">Template</span>&nbsp;<span class="op" id="3055305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3055308">t</span><span class="op" id="3055309">.</span><span class="ident" id="3055310">text</span><span class="op" id="3055314">.</span><span class="ident" id="3055315">Funcs</span><span class="op" id="3055320">(</span><span class="ident" id="3055321">template</span><span class="op" id="3055329">.</span><span class="ident" id="3055330">FuncMap</span><span class="op" id="3055337">(</span><span class="ident" id="3055338">funcMap</span><span class="op" id="3055345">)</span><span class="op" id="3055346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3055349">return</span>&nbsp;<span class="ident" id="3055356">t</span><br>
<span class="lineno"></span><span class="op" id="3055358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="3055361">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3055438">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="3055510">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3055586">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="3055622">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="3055684">func</span>&nbsp;<span class="op" id="3055689">(</span><span class="ident" id="3055690">t</span>&nbsp;<span class="op" id="3055692">*</span><span class="ident" id="3055693">Template</span><span class="op" id="3055701">)</span>&nbsp;<span class="ident" id="3055703">Delims</span><span class="op" id="3055709">(</span><span class="ident" id="3055710">left</span><span class="op" id="3055714">,</span>&nbsp;<span class="ident" id="3055716">right</span>&nbsp;<span class="builtintype" id="3055722">string</span><span class="op" id="3055728">)</span>&nbsp;<span class="op" id="3055730">*</span><span class="ident" id="3055731">Template</span>&nbsp;<span class="op" id="3055740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3055743">t</span><span class="op" id="3055744">.</span><span class="ident" id="3055745">text</span><span class="op" id="3055749">.</span><span class="ident" id="3055750">Delims</span><span class="op" id="3055756">(</span><span class="ident" id="3055757">left</span><span class="op" id="3055761">,</span>&nbsp;<span class="ident" id="3055763">right</span><span class="op" id="3055768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3055771">return</span>&nbsp;<span class="ident" id="3055778">t</span><br>
<span class="lineno"></span><span class="op" id="3055780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="3055783">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="3055861">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="3055901">func</span>&nbsp;<span class="op" id="3055906">(</span><span class="ident" id="3055907">t</span>&nbsp;<span class="op" id="3055909">*</span><span class="ident" id="3055910">Template</span><span class="op" id="3055918">)</span>&nbsp;<span class="ident" id="3055920">Lookup</span><span class="op" id="3055926">(</span><span class="ident" id="3055927">name</span>&nbsp;<span class="builtintype" id="3055932">string</span><span class="op" id="3055938">)</span>&nbsp;<span class="op" id="3055940">*</span><span class="ident" id="3055941">Template</span>&nbsp;<span class="op" id="3055950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3055953">t</span><span class="op" id="3055954">.</span><span class="ident" id="3055955">nameSpace</span><span class="op" id="3055964">.</span><span class="ident" id="3055965">mu</span><span class="op" id="3055967">.</span><span class="ident" id="3055968">Lock</span><span class="op" id="3055972">(</span><span class="op" id="3055973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3055976">defer</span>&nbsp;<span class="ident" id="3055982">t</span><span class="op" id="3055983">.</span><span class="ident" id="3055984">nameSpace</span><span class="op" id="3055993">.</span><span class="ident" id="3055994">mu</span><span class="op" id="3055996">.</span><span class="ident" id="3055997">Unlock</span><span class="op" id="3056003">(</span><span class="op" id="3056004">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3056007">return</span>&nbsp;<span class="ident" id="3056014">t</span><span class="op" id="3056015">.</span><span class="ident" id="3056016">set</span><span class="op" id="3056019">[</span><span class="ident" id="3056020">name</span><span class="op" id="3056024">]</span><br>
<span class="lineno"></span><span class="op" id="3056026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3056029">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="3056110">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="3056200">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3056211">//&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="3056272">func</span>&nbsp;<span class="ident" id="3056277">Must</span><span class="op" id="3056281">(</span><span class="ident" id="3056282">t</span>&nbsp;<span class="op" id="3056284">*</span><span class="ident" id="3056285">Template</span><span class="op" id="3056293">,</span>&nbsp;<span class="ident" id="3056295">err</span>&nbsp;<span class="builtintype" id="3056299">error</span><span class="op" id="3056304">)</span>&nbsp;<span class="op" id="3056306">*</span><span class="ident" id="3056307">Template</span>&nbsp;<span class="op" id="3056316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3056319">if</span>&nbsp;<span class="ident" id="3056322">err</span>&nbsp;<span class="op" id="3056326">!=</span>&nbsp;<span class="builtintype" id="3056329">nil</span>&nbsp;<span class="op" id="3056333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3056337">panic</span><span class="op" id="3056342">(</span><span class="ident" id="3056343">err</span><span class="op" id="3056346">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3056349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3056352">return</span>&nbsp;<span class="ident" id="3056359">t</span><br>
<span class="lineno"></span><span class="op" id="3056361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3056364">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="3056442">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3056521">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="3056594">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3056666">func</span>&nbsp;<span class="ident" id="3056671">ParseFiles</span><span class="op" id="3056681">(</span><span class="ident" id="3056682">filenames</span>&nbsp;<span class="op" id="3056692">...</span><span class="builtintype" id="3056695">string</span><span class="op" id="3056701">)</span>&nbsp;<span class="op" id="3056703">(</span><span class="op" id="3056704">*</span><span class="ident" id="3056705">Template</span><span class="op" id="3056713">,</span>&nbsp;<span class="builtintype" id="3056715">error</span><span class="op" id="3056720">)</span>&nbsp;<span class="op" id="3056722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3056725">return</span>&nbsp;<span class="ident" id="3056732">parseFiles</span><span class="op" id="3056742">(</span><span class="builtintype" id="3056743">nil</span><span class="op" id="3056746">,</span>&nbsp;<span class="ident" id="3056748">filenames</span><span class="op" id="3056757">...</span><span class="op" id="3056760">)</span><br>
<span class="lineno">315</span><span class="op" id="3056762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3056765">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3056846">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="3056920">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="3056975">func</span>&nbsp;<span class="op" id="3056980">(</span><span class="ident" id="3056981">t</span>&nbsp;<span class="op" id="3056983">*</span><span class="ident" id="3056984">Template</span><span class="op" id="3056992">)</span>&nbsp;<span class="ident" id="3056994">ParseFiles</span><span class="op" id="3057004">(</span><span class="ident" id="3057005">filenames</span>&nbsp;<span class="op" id="3057015">...</span><span class="builtintype" id="3057018">string</span><span class="op" id="3057024">)</span>&nbsp;<span class="op" id="3057026">(</span><span class="op" id="3057027">*</span><span class="ident" id="3057028">Template</span><span class="op" id="3057036">,</span>&nbsp;<span class="builtintype" id="3057038">error</span><span class="op" id="3057043">)</span>&nbsp;<span class="op" id="3057045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3057048">return</span>&nbsp;<span class="ident" id="3057055">parseFiles</span><span class="op" id="3057065">(</span><span class="ident" id="3057066">t</span><span class="op" id="3057067">,</span>&nbsp;<span class="ident" id="3057069">filenames</span><span class="op" id="3057078">...</span><span class="op" id="3057081">)</span><br>
<span class="lineno"></span><span class="op" id="3057083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3057086">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="3057159">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="3057214">func</span>&nbsp;<span class="ident" id="3057219">parseFiles</span><span class="op" id="3057229">(</span><span class="ident" id="3057230">t</span>&nbsp;<span class="op" id="3057232">*</span><span class="ident" id="3057233">Template</span><span class="op" id="3057241">,</span>&nbsp;<span class="ident" id="3057243">filenames</span>&nbsp;<span class="op" id="3057253">...</span><span class="builtintype" id="3057256">string</span><span class="op" id="3057262">)</span>&nbsp;<span class="op" id="3057264">(</span><span class="op" id="3057265">*</span><span class="ident" id="3057266">Template</span><span class="op" id="3057274">,</span>&nbsp;<span class="builtintype" id="3057276">error</span><span class="op" id="3057281">)</span>&nbsp;<span class="op" id="3057283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3057286">if</span>&nbsp;<span class="builtinfunc" id="3057289">len</span><span class="op" id="3057292">(</span><span class="ident" id="3057293">filenames</span><span class="op" id="3057302">)</span>&nbsp;<span class="op" id="3057304">==</span>&nbsp;<span class="num" id="3057307">0</span>&nbsp;<span class="op" id="3057309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3057313">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3057359">return</span>&nbsp;<span class="builtintype" id="3057366">nil</span><span class="op" id="3057369">,</span>&nbsp;<span class="ident" id="3057371">fmt</span><span class="op" id="3057374">.</span><span class="ident" id="3057375">Errorf</span><span class="op" id="3057381">(</span><span class="string" id="3057382">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="3057435">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3057438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3057441">for</span>&nbsp;<span class="ident" id="3057445">_</span><span class="op" id="3057446">,</span>&nbsp;<span class="ident" id="3057448">filename</span>&nbsp;<span class="op" id="3057457">:=</span>&nbsp;<span class="keyword" id="3057460">range</span>&nbsp;<span class="ident" id="3057466">filenames</span>&nbsp;<span class="op" id="3057476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3057480">b</span><span class="op" id="3057481">,</span>&nbsp;<span class="ident" id="3057483">err</span>&nbsp;<span class="op" id="3057487">:=</span>&nbsp;<span class="ident" id="3057490">ioutil</span><span class="op" id="3057496">.</span><span class="ident" id="3057497">ReadFile</span><span class="op" id="3057505">(</span><span class="ident" id="3057506">filename</span><span class="op" id="3057514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3057518">if</span>&nbsp;<span class="ident" id="3057521">err</span>&nbsp;<span class="op" id="3057525">!=</span>&nbsp;<span class="builtintype" id="3057528">nil</span>&nbsp;<span class="op" id="3057532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3057537">return</span>&nbsp;<span class="builtintype" id="3057544">nil</span><span class="op" id="3057547">,</span>&nbsp;<span class="ident" id="3057549">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3057555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3057559">s</span>&nbsp;<span class="op" id="3057561">:=</span>&nbsp;<span class="builtintype" id="3057564">string</span><span class="op" id="3057570">(</span><span class="ident" id="3057571">b</span><span class="op" id="3057572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3057576">name</span>&nbsp;<span class="op" id="3057581">:=</span>&nbsp;<span class="ident" id="3057584">filepath</span><span class="op" id="3057592">.</span><span class="ident" id="3057593">Base</span><span class="op" id="3057597">(</span><span class="ident" id="3057598">filename</span><span class="op" id="3057606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3057610">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3057675">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3057738">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3057808">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3057859">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3057913">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3057979">var</span>&nbsp;<span class="ident" id="3057983">tmpl</span>&nbsp;<span class="op" id="3057988">*</span><span class="ident" id="3057989">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3058000">if</span>&nbsp;<span class="ident" id="3058003">t</span>&nbsp;<span class="op" id="3058005">==</span>&nbsp;<span class="builtintype" id="3058008">nil</span>&nbsp;<span class="op" id="3058012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3058017">t</span>&nbsp;<span class="op" id="3058019">=</span>&nbsp;<span class="ident" id="3058021">New</span><span class="op" id="3058024">(</span><span class="ident" id="3058025">name</span><span class="op" id="3058029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3058033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3058037">if</span>&nbsp;<span class="ident" id="3058040">name</span>&nbsp;<span class="op" id="3058045">==</span>&nbsp;<span class="ident" id="3058048">t</span><span class="op" id="3058049">.</span><span class="ident" id="3058050">Name</span><span class="op" id="3058054">(</span><span class="op" id="3058055">)</span>&nbsp;<span class="op" id="3058057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3058062">tmpl</span>&nbsp;<span class="op" id="3058067">=</span>&nbsp;<span class="ident" id="3058069">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3058073">}</span>&nbsp;<span class="keyword" id="3058075">else</span>&nbsp;<span class="op" id="3058080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3058085">tmpl</span>&nbsp;<span class="op" id="3058090">=</span>&nbsp;<span class="ident" id="3058092">t</span><span class="op" id="3058093">.</span><span class="ident" id="3058094">New</span><span class="op" id="3058097">(</span><span class="ident" id="3058098">name</span><span class="op" id="3058102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3058106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3058110">_</span><span class="op" id="3058111">,</span>&nbsp;<span class="ident" id="3058113">err</span>&nbsp;<span class="op" id="3058117">=</span>&nbsp;<span class="ident" id="3058119">tmpl</span><span class="op" id="3058123">.</span><span class="ident" id="3058124">Parse</span><span class="op" id="3058129">(</span><span class="ident" id="3058130">s</span><span class="op" id="3058131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3058135">if</span>&nbsp;<span class="ident" id="3058138">err</span>&nbsp;<span class="op" id="3058142">!=</span>&nbsp;<span class="builtintype" id="3058145">nil</span>&nbsp;<span class="op" id="3058149">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3058154">return</span>&nbsp;<span class="builtintype" id="3058161">nil</span><span class="op" id="3058164">,</span>&nbsp;<span class="ident" id="3058166">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3058172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3058175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3058178">return</span>&nbsp;<span class="ident" id="3058185">t</span><span class="op" id="3058186">,</span>&nbsp;<span class="builtintype" id="3058188">nil</span><br>
<span class="lineno"></span><span class="op" id="3058192">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="3058195">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3058276">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3058352">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3058428">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="3058501">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="3058562">func</span>&nbsp;<span class="ident" id="3058567">ParseGlob</span><span class="op" id="3058576">(</span><span class="ident" id="3058577">pattern</span>&nbsp;<span class="builtintype" id="3058585">string</span><span class="op" id="3058591">)</span>&nbsp;<span class="op" id="3058593">(</span><span class="op" id="3058594">*</span><span class="ident" id="3058595">Template</span><span class="op" id="3058603">,</span>&nbsp;<span class="builtintype" id="3058605">error</span><span class="op" id="3058610">)</span>&nbsp;<span class="op" id="3058612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3058615">return</span>&nbsp;<span class="ident" id="3058622">parseGlob</span><span class="op" id="3058631">(</span><span class="builtintype" id="3058632">nil</span><span class="op" id="3058635">,</span>&nbsp;<span class="ident" id="3058637">pattern</span><span class="op" id="3058644">)</span><br>
<span class="lineno"></span><span class="op" id="3058646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="3058649">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3058725">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3058798">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3058875">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3058951">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="3058963">func</span>&nbsp;<span class="op" id="3058968">(</span><span class="ident" id="3058969">t</span>&nbsp;<span class="op" id="3058971">*</span><span class="ident" id="3058972">Template</span><span class="op" id="3058980">)</span>&nbsp;<span class="ident" id="3058982">ParseGlob</span><span class="op" id="3058991">(</span><span class="ident" id="3058992">pattern</span>&nbsp;<span class="builtintype" id="3059000">string</span><span class="op" id="3059006">)</span>&nbsp;<span class="op" id="3059008">(</span><span class="op" id="3059009">*</span><span class="ident" id="3059010">Template</span><span class="op" id="3059018">,</span>&nbsp;<span class="builtintype" id="3059020">error</span><span class="op" id="3059025">)</span>&nbsp;<span class="op" id="3059027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3059030">return</span>&nbsp;<span class="ident" id="3059037">parseGlob</span><span class="op" id="3059046">(</span><span class="ident" id="3059047">t</span><span class="op" id="3059048">,</span>&nbsp;<span class="ident" id="3059050">pattern</span><span class="op" id="3059057">)</span><br>
<span class="lineno"></span><span class="op" id="3059059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3059062">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="3059135">func</span>&nbsp;<span class="ident" id="3059140">parseGlob</span><span class="op" id="3059149">(</span><span class="ident" id="3059150">t</span>&nbsp;<span class="op" id="3059152">*</span><span class="ident" id="3059153">Template</span><span class="op" id="3059161">,</span>&nbsp;<span class="ident" id="3059163">pattern</span>&nbsp;<span class="builtintype" id="3059171">string</span><span class="op" id="3059177">)</span>&nbsp;<span class="op" id="3059179">(</span><span class="op" id="3059180">*</span><span class="ident" id="3059181">Template</span><span class="op" id="3059189">,</span>&nbsp;<span class="builtintype" id="3059191">error</span><span class="op" id="3059196">)</span>&nbsp;<span class="op" id="3059198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3059201">filenames</span><span class="op" id="3059210">,</span>&nbsp;<span class="ident" id="3059212">err</span>&nbsp;<span class="op" id="3059216">:=</span>&nbsp;<span class="ident" id="3059219">filepath</span><span class="op" id="3059227">.</span><span class="ident" id="3059228">Glob</span><span class="op" id="3059232">(</span><span class="ident" id="3059233">pattern</span><span class="op" id="3059240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3059243">if</span>&nbsp;<span class="ident" id="3059246">err</span>&nbsp;<span class="op" id="3059250">!=</span>&nbsp;<span class="builtintype" id="3059253">nil</span>&nbsp;<span class="op" id="3059257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3059261">return</span>&nbsp;<span class="builtintype" id="3059268">nil</span><span class="op" id="3059271">,</span>&nbsp;<span class="ident" id="3059273">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3059278">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3059281">if</span>&nbsp;<span class="builtinfunc" id="3059284">len</span><span class="op" id="3059287">(</span><span class="ident" id="3059288">filenames</span><span class="op" id="3059297">)</span>&nbsp;<span class="op" id="3059299">==</span>&nbsp;<span class="num" id="3059302">0</span>&nbsp;<span class="op" id="3059304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3059308">return</span>&nbsp;<span class="builtintype" id="3059315">nil</span><span class="op" id="3059318">,</span>&nbsp;<span class="ident" id="3059320">fmt</span><span class="op" id="3059323">.</span><span class="ident" id="3059324">Errorf</span><span class="op" id="3059330">(</span><span class="string" id="3059331">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="3059377">,</span>&nbsp;<span class="ident" id="3059379">pattern</span><span class="op" id="3059386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3059389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3059392">return</span>&nbsp;<span class="ident" id="3059399">parseFiles</span><span class="op" id="3059409">(</span><span class="ident" id="3059410">t</span><span class="op" id="3059411">,</span>&nbsp;<span class="ident" id="3059413">filenames</span><span class="op" id="3059422">...</span><span class="op" id="3059425">)</span><br>
<span class="lineno"></span><span class="op" id="3059427">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
