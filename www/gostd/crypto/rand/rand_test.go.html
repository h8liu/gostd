<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8229939">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8229995">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8230049">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8230100">package</span>&nbsp;<span class="ident" id="8230108">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8230114">import</span>&nbsp;<span class="op" id="8230121">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230124">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230133">&#34;compress/flate&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230151">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230157">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8230167">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8230170">func</span>&nbsp;<span class="ident" id="8230175">TestRead</span><span class="op" id="8230183">(</span><span class="ident" id="8230184">t</span>&nbsp;<span class="op" id="8230186">*</span><span class="ident" id="8230187">testing</span><span class="op" id="8230194">.</span><span class="ident" id="8230195">T</span><span class="op" id="8230196">)</span>&nbsp;<span class="op" id="8230198">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8230201">var</span>&nbsp;<span class="ident" id="8230205">n</span>&nbsp;<span class="builtintype" id="8230207">int</span>&nbsp;<span class="op" id="8230211">=</span>&nbsp;<span class="num" id="8230213">4e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8230218">if</span>&nbsp;<span class="ident" id="8230221">testing</span><span class="op" id="8230228">.</span><span class="ident" id="8230229">Short</span><span class="op" id="8230234">(</span><span class="op" id="8230235">)</span>&nbsp;<span class="op" id="8230237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230241">n</span>&nbsp;<span class="op" id="8230243">=</span>&nbsp;<span class="num" id="8230245">1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230253">b</span>&nbsp;<span class="op" id="8230255">:=</span>&nbsp;<span class="builtinfunc" id="8230258">make</span><span class="op" id="8230262">(</span><span class="op" id="8230263">[</span><span class="op" id="8230264">]</span><span class="builtintype" id="8230265">byte</span><span class="op" id="8230269">,</span>&nbsp;<span class="ident" id="8230271">n</span><span class="op" id="8230272">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230275">n</span><span class="op" id="8230276">,</span>&nbsp;<span class="ident" id="8230278">err</span>&nbsp;<span class="op" id="8230282">:=</span>&nbsp;<span class="ident" id="8230285">io</span><span class="op" id="8230287">.</span><span class="ident" id="8230288">ReadFull</span><span class="op" id="8230296">(</span><span class="ident" id="8230297">Reader</span><span class="op" id="8230303">,</span>&nbsp;<span class="ident" id="8230305">b</span><span class="op" id="8230306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8230309">if</span>&nbsp;<span class="ident" id="8230312">n</span>&nbsp;<span class="op" id="8230314">!=</span>&nbsp;<span class="builtinfunc" id="8230317">len</span><span class="op" id="8230320">(</span><span class="ident" id="8230321">b</span><span class="op" id="8230322">)</span>&nbsp;<span class="op" id="8230324">||</span>&nbsp;<span class="ident" id="8230327">err</span>&nbsp;<span class="op" id="8230331">!=</span>&nbsp;<span class="ident" id="8230334">nil</span>&nbsp;<span class="op" id="8230338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230342">t</span><span class="op" id="8230343">.</span><span class="ident" id="8230344">Fatalf</span><span class="op" id="8230350">(</span><span class="string" id="8230351">&#34;ReadFull(buf)&nbsp;=&nbsp;%d,&nbsp;%s&#34;</span><span class="op" id="8230375">,</span>&nbsp;<span class="ident" id="8230377">n</span><span class="op" id="8230378">,</span>&nbsp;<span class="ident" id="8230380">err</span><span class="op" id="8230383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8230390">var</span>&nbsp;<span class="ident" id="8230394">z</span>&nbsp;<span class="ident" id="8230396">bytes</span><span class="op" id="8230401">.</span><span class="ident" id="8230402">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230410">f</span><span class="op" id="8230411">,</span>&nbsp;<span class="ident" id="8230413">_</span>&nbsp;<span class="op" id="8230415">:=</span>&nbsp;<span class="ident" id="8230418">flate</span><span class="op" id="8230423">.</span><span class="ident" id="8230424">NewWriter</span><span class="op" id="8230433">(</span><span class="op" id="8230434">&amp;</span><span class="ident" id="8230435">z</span><span class="op" id="8230436">,</span>&nbsp;<span class="num" id="8230438">5</span><span class="op" id="8230439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230442">f</span><span class="op" id="8230443">.</span><span class="ident" id="8230444">Write</span><span class="op" id="8230449">(</span><span class="ident" id="8230450">b</span><span class="op" id="8230451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230454">f</span><span class="op" id="8230455">.</span><span class="ident" id="8230456">Close</span><span class="op" id="8230461">(</span><span class="op" id="8230462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8230465">if</span>&nbsp;<span class="ident" id="8230468">z</span><span class="op" id="8230469">.</span><span class="ident" id="8230470">Len</span><span class="op" id="8230473">(</span><span class="op" id="8230474">)</span>&nbsp;<span class="op" id="8230476">&lt;</span>&nbsp;<span class="builtinfunc" id="8230478">len</span><span class="op" id="8230481">(</span><span class="ident" id="8230482">b</span><span class="op" id="8230483">)</span><span class="op" id="8230484">*</span><span class="num" id="8230485">99</span><span class="op" id="8230487">/</span><span class="num" id="8230488">100</span>&nbsp;<span class="op" id="8230492">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230496">t</span><span class="op" id="8230497">.</span><span class="ident" id="8230498">Fatalf</span><span class="op" id="8230504">(</span><span class="string" id="8230505">&#34;Compressed&nbsp;%d&nbsp;-&gt;&nbsp;%d&#34;</span><span class="op" id="8230526">,</span>&nbsp;<span class="builtinfunc" id="8230528">len</span><span class="op" id="8230531">(</span><span class="ident" id="8230532">b</span><span class="op" id="8230533">)</span><span class="op" id="8230534">,</span>&nbsp;<span class="ident" id="8230536">z</span><span class="op" id="8230537">.</span><span class="ident" id="8230538">Len</span><span class="op" id="8230541">(</span><span class="op" id="8230542">)</span><span class="op" id="8230543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230546">}</span><br>
<span class="lineno"></span><span class="op" id="8230548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8230551">func</span>&nbsp;<span class="ident" id="8230556">TestReadEmpty</span><span class="op" id="8230569">(</span><span class="ident" id="8230570">t</span>&nbsp;<span class="op" id="8230572">*</span><span class="ident" id="8230573">testing</span><span class="op" id="8230580">.</span><span class="ident" id="8230581">T</span><span class="op" id="8230582">)</span>&nbsp;<span class="op" id="8230584">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230587">n</span><span class="op" id="8230588">,</span>&nbsp;<span class="ident" id="8230590">err</span>&nbsp;<span class="op" id="8230594">:=</span>&nbsp;<span class="ident" id="8230597">Reader</span><span class="op" id="8230603">.</span><span class="ident" id="8230604">Read</span><span class="op" id="8230608">(</span><span class="builtinfunc" id="8230609">make</span><span class="op" id="8230613">(</span><span class="op" id="8230614">[</span><span class="op" id="8230615">]</span><span class="builtintype" id="8230616">byte</span><span class="op" id="8230620">,</span>&nbsp;<span class="num" id="8230622">0</span><span class="op" id="8230623">)</span><span class="op" id="8230624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8230627">if</span>&nbsp;<span class="ident" id="8230630">n</span>&nbsp;<span class="op" id="8230632">!=</span>&nbsp;<span class="num" id="8230635">0</span>&nbsp;<span class="op" id="8230637">||</span>&nbsp;<span class="ident" id="8230640">err</span>&nbsp;<span class="op" id="8230644">!=</span>&nbsp;<span class="ident" id="8230647">nil</span>&nbsp;<span class="op" id="8230651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230655">t</span><span class="op" id="8230656">.</span><span class="ident" id="8230657">Fatalf</span><span class="op" id="8230663">(</span><span class="string" id="8230664">&#34;Read(make([]byte,&nbsp;0))&nbsp;=&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="8230696">,</span>&nbsp;<span class="ident" id="8230698">n</span><span class="op" id="8230699">,</span>&nbsp;<span class="ident" id="8230701">err</span><span class="op" id="8230704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230710">n</span><span class="op" id="8230711">,</span>&nbsp;<span class="ident" id="8230713">err</span>&nbsp;<span class="op" id="8230717">=</span>&nbsp;<span class="ident" id="8230719">Reader</span><span class="op" id="8230725">.</span><span class="ident" id="8230726">Read</span><span class="op" id="8230730">(</span><span class="ident" id="8230731">nil</span><span class="op" id="8230734">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8230737">if</span>&nbsp;<span class="ident" id="8230740">n</span>&nbsp;<span class="op" id="8230742">!=</span>&nbsp;<span class="num" id="8230745">0</span>&nbsp;<span class="op" id="8230747">||</span>&nbsp;<span class="ident" id="8230750">err</span>&nbsp;<span class="op" id="8230754">!=</span>&nbsp;<span class="ident" id="8230757">nil</span>&nbsp;<span class="op" id="8230761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230765">t</span><span class="op" id="8230766">.</span><span class="ident" id="8230767">Fatalf</span><span class="op" id="8230773">(</span><span class="string" id="8230774">&#34;Read(nil)&nbsp;=&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="8230794">,</span>&nbsp;<span class="ident" id="8230796">n</span><span class="op" id="8230797">,</span>&nbsp;<span class="ident" id="8230799">err</span><span class="op" id="8230802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230805">}</span><br>
<span class="lineno"></span><span class="op" id="8230807">}</span>
</div>
</body>
</html>
