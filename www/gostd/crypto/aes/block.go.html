<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html" class="current">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3076709">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3076764">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3076818">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3076869">//&nbsp;This&nbsp;Go&nbsp;implementation&nbsp;is&nbsp;derived&nbsp;in&nbsp;part&nbsp;from&nbsp;the&nbsp;reference</span><br>
<span class="lineno"></span><span class="comment" id="3076933">//&nbsp;ANSI&nbsp;C&nbsp;implementation,&nbsp;which&nbsp;carries&nbsp;the&nbsp;following&nbsp;notice:</span><br>
<span class="lineno"></span><span class="comment" id="3076995">//</span><br>
<span class="lineno"></span><span class="comment" id="3076998">//&nbsp;&nbsp;&nbsp;&nbsp;rijndael-alg-fst.c</span><br>
<span class="lineno"></span><span class="comment" id="3077020">//</span><br>
<span class="lineno">10</span><span class="comment" id="3077023">//&nbsp;&nbsp;&nbsp;&nbsp;@version&nbsp;3.0&nbsp;(December&nbsp;2000)</span><br>
<span class="lineno"></span><span class="comment" id="3077055">//</span><br>
<span class="lineno"></span><span class="comment" id="3077058">//&nbsp;&nbsp;&nbsp;&nbsp;Optimised&nbsp;ANSI&nbsp;C&nbsp;code&nbsp;for&nbsp;the&nbsp;Rijndael&nbsp;cipher&nbsp;(now&nbsp;AES)</span><br>
<span class="lineno"></span><span class="comment" id="3077117">//</span><br>
<span class="lineno"></span><span class="comment" id="3077120">//&nbsp;&nbsp;&nbsp;&nbsp;@author&nbsp;Vincent&nbsp;Rijmen&nbsp;&lt;vincent.rijmen@esat.kuleuven.ac.be&gt;</span><br>
<span class="lineno">15</span><span class="comment" id="3077183">//&nbsp;&nbsp;&nbsp;&nbsp;@author&nbsp;Antoon&nbsp;Bosselaers&nbsp;&lt;antoon.bosselaers@esat.kuleuven.ac.be&gt;</span><br>
<span class="lineno"></span><span class="comment" id="3077252">//&nbsp;&nbsp;&nbsp;&nbsp;@author&nbsp;Paulo&nbsp;Barreto&nbsp;&lt;paulo.barreto@terra.com.br&gt;</span><br>
<span class="lineno"></span><span class="comment" id="3077306">//</span><br>
<span class="lineno"></span><span class="comment" id="3077309">//&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;code&nbsp;is&nbsp;hereby&nbsp;placed&nbsp;in&nbsp;the&nbsp;public&nbsp;domain.</span><br>
<span class="lineno"></span><span class="comment" id="3077361">//</span><br>
<span class="lineno">20</span><span class="comment" id="3077364">//&nbsp;&nbsp;&nbsp;&nbsp;THIS&nbsp;SOFTWARE&nbsp;IS&nbsp;PROVIDED&nbsp;BY&nbsp;THE&nbsp;AUTHORS&nbsp;&#39;&#39;AS&nbsp;IS&#39;&#39;&nbsp;AND&nbsp;ANY&nbsp;EXPRESS</span><br>
<span class="lineno"></span><span class="comment" id="3077434">//&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;IMPLIED&nbsp;WARRANTIES,&nbsp;INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;THE&nbsp;IMPLIED</span><br>
<span class="lineno"></span><span class="comment" id="3077503">//&nbsp;&nbsp;&nbsp;&nbsp;WARRANTIES&nbsp;OF&nbsp;MERCHANTABILITY&nbsp;AND&nbsp;FITNESS&nbsp;FOR&nbsp;A&nbsp;PARTICULAR&nbsp;PURPOSE</span><br>
<span class="lineno"></span><span class="comment" id="3077573">//&nbsp;&nbsp;&nbsp;&nbsp;ARE&nbsp;DISCLAIMED.&nbsp;&nbsp;IN&nbsp;NO&nbsp;EVENT&nbsp;SHALL&nbsp;THE&nbsp;AUTHORS&nbsp;OR&nbsp;CONTRIBUTORS&nbsp;BE</span><br>
<span class="lineno"></span><span class="comment" id="3077642">//&nbsp;&nbsp;&nbsp;&nbsp;LIABLE&nbsp;FOR&nbsp;ANY&nbsp;DIRECT,&nbsp;INDIRECT,&nbsp;INCIDENTAL,&nbsp;SPECIAL,&nbsp;EXEMPLARY,&nbsp;OR</span><br>
<span class="lineno">25</span><span class="comment" id="3077713">//&nbsp;&nbsp;&nbsp;&nbsp;CONSEQUENTIAL&nbsp;DAMAGES&nbsp;(INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;PROCUREMENT&nbsp;OF</span><br>
<span class="lineno"></span><span class="comment" id="3077785">//&nbsp;&nbsp;&nbsp;&nbsp;SUBSTITUTE&nbsp;GOODS&nbsp;OR&nbsp;SERVICES;&nbsp;LOSS&nbsp;OF&nbsp;USE,&nbsp;DATA,&nbsp;OR&nbsp;PROFITS;&nbsp;OR</span><br>
<span class="lineno"></span><span class="comment" id="3077852">//&nbsp;&nbsp;&nbsp;&nbsp;BUSINESS&nbsp;INTERRUPTION)&nbsp;HOWEVER&nbsp;CAUSED&nbsp;AND&nbsp;ON&nbsp;ANY&nbsp;THEORY&nbsp;OF&nbsp;LIABILITY,</span><br>
<span class="lineno"></span><span class="comment" id="3077925">//&nbsp;&nbsp;&nbsp;&nbsp;WHETHER&nbsp;IN&nbsp;CONTRACT,&nbsp;STRICT&nbsp;LIABILITY,&nbsp;OR&nbsp;TORT&nbsp;(INCLUDING&nbsp;NEGLIGENCE</span><br>
<span class="lineno"></span><span class="comment" id="3077997">//&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;OTHERWISE)&nbsp;ARISING&nbsp;IN&nbsp;ANY&nbsp;WAY&nbsp;OUT&nbsp;OF&nbsp;THE&nbsp;USE&nbsp;OF&nbsp;THIS&nbsp;SOFTWARE,</span><br>
<span class="lineno">30</span><span class="comment" id="3078066">//&nbsp;&nbsp;&nbsp;&nbsp;EVEN&nbsp;IF&nbsp;ADVISED&nbsp;OF&nbsp;THE&nbsp;POSSIBILITY&nbsp;OF&nbsp;SUCH&nbsp;DAMAGE.</span><br>
<span class="lineno"></span><span class="comment" id="3078120">//</span><br>
<span class="lineno"></span><span class="comment" id="3078123">//&nbsp;See&nbsp;FIPS&nbsp;197&nbsp;for&nbsp;specification,&nbsp;and&nbsp;see&nbsp;Daemen&nbsp;and&nbsp;Rijmen&#39;s&nbsp;Rijndael&nbsp;submission</span><br>
<span class="lineno"></span><span class="comment" id="3078206">//&nbsp;for&nbsp;implementation&nbsp;details.</span><br>
<span class="lineno"></span><span class="comment" id="3078237">//&nbsp;&nbsp;&nbsp;&nbsp;http://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno">35</span><span class="comment" id="3078304">//&nbsp;&nbsp;&nbsp;&nbsp;http://csrc.nist.gov/archive/aes/rijndael/Rijndael-ammended.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3078372">package</span>&nbsp;<span class="ident" id="3078380">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3078385">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;expanded&nbsp;key&nbsp;xk.</span><br>
<span class="lineno">40</span><span class="keyword" id="3078452">func</span>&nbsp;<span class="ident" id="3078457">encryptBlockGo</span><span class="op" id="3078471">(</span><span class="ident" id="3078472">xk</span>&nbsp;<span class="op" id="3078475">[</span><span class="op" id="3078476">]</span><span class="builtintype" id="3078477">uint32</span><span class="op" id="3078483">,</span>&nbsp;<span class="ident" id="3078485">dst</span><span class="op" id="3078488">,</span>&nbsp;<span class="ident" id="3078490">src</span>&nbsp;<span class="op" id="3078494">[</span><span class="op" id="3078495">]</span><span class="builtintype" id="3078496">byte</span><span class="op" id="3078500">)</span>&nbsp;<span class="op" id="3078502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078505">var</span>&nbsp;<span class="ident" id="3078509">s0</span><span class="op" id="3078511">,</span>&nbsp;<span class="ident" id="3078513">s1</span><span class="op" id="3078515">,</span>&nbsp;<span class="ident" id="3078517">s2</span><span class="op" id="3078519">,</span>&nbsp;<span class="ident" id="3078521">s3</span><span class="op" id="3078523">,</span>&nbsp;<span class="ident" id="3078525">t0</span><span class="op" id="3078527">,</span>&nbsp;<span class="ident" id="3078529">t1</span><span class="op" id="3078531">,</span>&nbsp;<span class="ident" id="3078533">t2</span><span class="op" id="3078535">,</span>&nbsp;<span class="ident" id="3078537">t3</span>&nbsp;<span class="builtintype" id="3078540">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078549">s0</span>&nbsp;<span class="op" id="3078552">=</span>&nbsp;<span class="builtintype" id="3078554">uint32</span><span class="op" id="3078560">(</span><span class="ident" id="3078561">src</span><span class="op" id="3078564">[</span><span class="num" id="3078565">0</span><span class="op" id="3078566">]</span><span class="op" id="3078567">)</span><span class="op" id="3078568">&lt;&lt;</span><span class="num" id="3078570">24</span>&nbsp;<span class="op" id="3078573">|</span>&nbsp;<span class="builtintype" id="3078575">uint32</span><span class="op" id="3078581">(</span><span class="ident" id="3078582">src</span><span class="op" id="3078585">[</span><span class="num" id="3078586">1</span><span class="op" id="3078587">]</span><span class="op" id="3078588">)</span><span class="op" id="3078589">&lt;&lt;</span><span class="num" id="3078591">16</span>&nbsp;<span class="op" id="3078594">|</span>&nbsp;<span class="builtintype" id="3078596">uint32</span><span class="op" id="3078602">(</span><span class="ident" id="3078603">src</span><span class="op" id="3078606">[</span><span class="num" id="3078607">2</span><span class="op" id="3078608">]</span><span class="op" id="3078609">)</span><span class="op" id="3078610">&lt;&lt;</span><span class="num" id="3078612">8</span>&nbsp;<span class="op" id="3078614">|</span>&nbsp;<span class="builtintype" id="3078616">uint32</span><span class="op" id="3078622">(</span><span class="ident" id="3078623">src</span><span class="op" id="3078626">[</span><span class="num" id="3078627">3</span><span class="op" id="3078628">]</span><span class="op" id="3078629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078632">s1</span>&nbsp;<span class="op" id="3078635">=</span>&nbsp;<span class="builtintype" id="3078637">uint32</span><span class="op" id="3078643">(</span><span class="ident" id="3078644">src</span><span class="op" id="3078647">[</span><span class="num" id="3078648">4</span><span class="op" id="3078649">]</span><span class="op" id="3078650">)</span><span class="op" id="3078651">&lt;&lt;</span><span class="num" id="3078653">24</span>&nbsp;<span class="op" id="3078656">|</span>&nbsp;<span class="builtintype" id="3078658">uint32</span><span class="op" id="3078664">(</span><span class="ident" id="3078665">src</span><span class="op" id="3078668">[</span><span class="num" id="3078669">5</span><span class="op" id="3078670">]</span><span class="op" id="3078671">)</span><span class="op" id="3078672">&lt;&lt;</span><span class="num" id="3078674">16</span>&nbsp;<span class="op" id="3078677">|</span>&nbsp;<span class="builtintype" id="3078679">uint32</span><span class="op" id="3078685">(</span><span class="ident" id="3078686">src</span><span class="op" id="3078689">[</span><span class="num" id="3078690">6</span><span class="op" id="3078691">]</span><span class="op" id="3078692">)</span><span class="op" id="3078693">&lt;&lt;</span><span class="num" id="3078695">8</span>&nbsp;<span class="op" id="3078697">|</span>&nbsp;<span class="builtintype" id="3078699">uint32</span><span class="op" id="3078705">(</span><span class="ident" id="3078706">src</span><span class="op" id="3078709">[</span><span class="num" id="3078710">7</span><span class="op" id="3078711">]</span><span class="op" id="3078712">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078715">s2</span>&nbsp;<span class="op" id="3078718">=</span>&nbsp;<span class="builtintype" id="3078720">uint32</span><span class="op" id="3078726">(</span><span class="ident" id="3078727">src</span><span class="op" id="3078730">[</span><span class="num" id="3078731">8</span><span class="op" id="3078732">]</span><span class="op" id="3078733">)</span><span class="op" id="3078734">&lt;&lt;</span><span class="num" id="3078736">24</span>&nbsp;<span class="op" id="3078739">|</span>&nbsp;<span class="builtintype" id="3078741">uint32</span><span class="op" id="3078747">(</span><span class="ident" id="3078748">src</span><span class="op" id="3078751">[</span><span class="num" id="3078752">9</span><span class="op" id="3078753">]</span><span class="op" id="3078754">)</span><span class="op" id="3078755">&lt;&lt;</span><span class="num" id="3078757">16</span>&nbsp;<span class="op" id="3078760">|</span>&nbsp;<span class="builtintype" id="3078762">uint32</span><span class="op" id="3078768">(</span><span class="ident" id="3078769">src</span><span class="op" id="3078772">[</span><span class="num" id="3078773">10</span><span class="op" id="3078775">]</span><span class="op" id="3078776">)</span><span class="op" id="3078777">&lt;&lt;</span><span class="num" id="3078779">8</span>&nbsp;<span class="op" id="3078781">|</span>&nbsp;<span class="builtintype" id="3078783">uint32</span><span class="op" id="3078789">(</span><span class="ident" id="3078790">src</span><span class="op" id="3078793">[</span><span class="num" id="3078794">11</span><span class="op" id="3078796">]</span><span class="op" id="3078797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078800">s3</span>&nbsp;<span class="op" id="3078803">=</span>&nbsp;<span class="builtintype" id="3078805">uint32</span><span class="op" id="3078811">(</span><span class="ident" id="3078812">src</span><span class="op" id="3078815">[</span><span class="num" id="3078816">12</span><span class="op" id="3078818">]</span><span class="op" id="3078819">)</span><span class="op" id="3078820">&lt;&lt;</span><span class="num" id="3078822">24</span>&nbsp;<span class="op" id="3078825">|</span>&nbsp;<span class="builtintype" id="3078827">uint32</span><span class="op" id="3078833">(</span><span class="ident" id="3078834">src</span><span class="op" id="3078837">[</span><span class="num" id="3078838">13</span><span class="op" id="3078840">]</span><span class="op" id="3078841">)</span><span class="op" id="3078842">&lt;&lt;</span><span class="num" id="3078844">16</span>&nbsp;<span class="op" id="3078847">|</span>&nbsp;<span class="builtintype" id="3078849">uint32</span><span class="op" id="3078855">(</span><span class="ident" id="3078856">src</span><span class="op" id="3078859">[</span><span class="num" id="3078860">14</span><span class="op" id="3078862">]</span><span class="op" id="3078863">)</span><span class="op" id="3078864">&lt;&lt;</span><span class="num" id="3078866">8</span>&nbsp;<span class="op" id="3078868">|</span>&nbsp;<span class="builtintype" id="3078870">uint32</span><span class="op" id="3078876">(</span><span class="ident" id="3078877">src</span><span class="op" id="3078880">[</span><span class="num" id="3078881">15</span><span class="op" id="3078883">]</span><span class="op" id="3078884">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3078888">//&nbsp;First&nbsp;round&nbsp;just&nbsp;XORs&nbsp;input&nbsp;with&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078930">s0</span>&nbsp;<span class="op" id="3078933">^=</span>&nbsp;<span class="ident" id="3078936">xk</span><span class="op" id="3078938">[</span><span class="num" id="3078939">0</span><span class="op" id="3078940">]</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078943">s1</span>&nbsp;<span class="op" id="3078946">^=</span>&nbsp;<span class="ident" id="3078949">xk</span><span class="op" id="3078951">[</span><span class="num" id="3078952">1</span><span class="op" id="3078953">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078956">s2</span>&nbsp;<span class="op" id="3078959">^=</span>&nbsp;<span class="ident" id="3078962">xk</span><span class="op" id="3078964">[</span><span class="num" id="3078965">2</span><span class="op" id="3078966">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078969">s3</span>&nbsp;<span class="op" id="3078972">^=</span>&nbsp;<span class="ident" id="3078975">xk</span><span class="op" id="3078977">[</span><span class="num" id="3078978">3</span><span class="op" id="3078979">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3078983">//&nbsp;Middle&nbsp;rounds&nbsp;shuffle&nbsp;using&nbsp;tables.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3079023">//&nbsp;Number&nbsp;of&nbsp;rounds&nbsp;is&nbsp;set&nbsp;by&nbsp;length&nbsp;of&nbsp;expanded&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079078">nr</span>&nbsp;<span class="op" id="3079081">:=</span>&nbsp;<span class="builtinfunc" id="3079084">len</span><span class="op" id="3079087">(</span><span class="ident" id="3079088">xk</span><span class="op" id="3079090">)</span><span class="op" id="3079091">/</span><span class="num" id="3079092">4</span>&nbsp;<span class="op" id="3079094">-</span>&nbsp;<span class="num" id="3079096">2</span>&nbsp;<span class="comment" id="3079098">//&nbsp;-&nbsp;2:&nbsp;one&nbsp;above,&nbsp;one&nbsp;more&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079133">k</span>&nbsp;<span class="op" id="3079135">:=</span>&nbsp;<span class="num" id="3079138">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3079141">for</span>&nbsp;<span class="ident" id="3079145">r</span>&nbsp;<span class="op" id="3079147">:=</span>&nbsp;<span class="num" id="3079150">0</span><span class="op" id="3079151">;</span>&nbsp;<span class="ident" id="3079153">r</span>&nbsp;<span class="op" id="3079155">&lt;</span>&nbsp;<span class="ident" id="3079157">nr</span><span class="op" id="3079159">;</span>&nbsp;<span class="ident" id="3079161">r</span><span class="op" id="3079162">++</span>&nbsp;<span class="op" id="3079165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079169">t0</span>&nbsp;<span class="op" id="3079172">=</span>&nbsp;<span class="ident" id="3079174">xk</span><span class="op" id="3079176">[</span><span class="ident" id="3079177">k</span><span class="op" id="3079178">+</span><span class="num" id="3079179">0</span><span class="op" id="3079180">]</span>&nbsp;<span class="op" id="3079182">^</span>&nbsp;<span class="ident" id="3079184">te0</span><span class="op" id="3079187">[</span><span class="builtintype" id="3079188">uint8</span><span class="op" id="3079193">(</span><span class="ident" id="3079194">s0</span><span class="op" id="3079196">&gt;&gt;</span><span class="num" id="3079198">24</span><span class="op" id="3079200">)</span><span class="op" id="3079201">]</span>&nbsp;<span class="op" id="3079203">^</span>&nbsp;<span class="ident" id="3079205">te1</span><span class="op" id="3079208">[</span><span class="builtintype" id="3079209">uint8</span><span class="op" id="3079214">(</span><span class="ident" id="3079215">s1</span><span class="op" id="3079217">&gt;&gt;</span><span class="num" id="3079219">16</span><span class="op" id="3079221">)</span><span class="op" id="3079222">]</span>&nbsp;<span class="op" id="3079224">^</span>&nbsp;<span class="ident" id="3079226">te2</span><span class="op" id="3079229">[</span><span class="builtintype" id="3079230">uint8</span><span class="op" id="3079235">(</span><span class="ident" id="3079236">s2</span><span class="op" id="3079238">&gt;&gt;</span><span class="num" id="3079240">8</span><span class="op" id="3079241">)</span><span class="op" id="3079242">]</span>&nbsp;<span class="op" id="3079244">^</span>&nbsp;<span class="ident" id="3079246">te3</span><span class="op" id="3079249">[</span><span class="builtintype" id="3079250">uint8</span><span class="op" id="3079255">(</span><span class="ident" id="3079256">s3</span><span class="op" id="3079258">)</span><span class="op" id="3079259">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079263">t1</span>&nbsp;<span class="op" id="3079266">=</span>&nbsp;<span class="ident" id="3079268">xk</span><span class="op" id="3079270">[</span><span class="ident" id="3079271">k</span><span class="op" id="3079272">+</span><span class="num" id="3079273">1</span><span class="op" id="3079274">]</span>&nbsp;<span class="op" id="3079276">^</span>&nbsp;<span class="ident" id="3079278">te0</span><span class="op" id="3079281">[</span><span class="builtintype" id="3079282">uint8</span><span class="op" id="3079287">(</span><span class="ident" id="3079288">s1</span><span class="op" id="3079290">&gt;&gt;</span><span class="num" id="3079292">24</span><span class="op" id="3079294">)</span><span class="op" id="3079295">]</span>&nbsp;<span class="op" id="3079297">^</span>&nbsp;<span class="ident" id="3079299">te1</span><span class="op" id="3079302">[</span><span class="builtintype" id="3079303">uint8</span><span class="op" id="3079308">(</span><span class="ident" id="3079309">s2</span><span class="op" id="3079311">&gt;&gt;</span><span class="num" id="3079313">16</span><span class="op" id="3079315">)</span><span class="op" id="3079316">]</span>&nbsp;<span class="op" id="3079318">^</span>&nbsp;<span class="ident" id="3079320">te2</span><span class="op" id="3079323">[</span><span class="builtintype" id="3079324">uint8</span><span class="op" id="3079329">(</span><span class="ident" id="3079330">s3</span><span class="op" id="3079332">&gt;&gt;</span><span class="num" id="3079334">8</span><span class="op" id="3079335">)</span><span class="op" id="3079336">]</span>&nbsp;<span class="op" id="3079338">^</span>&nbsp;<span class="ident" id="3079340">te3</span><span class="op" id="3079343">[</span><span class="builtintype" id="3079344">uint8</span><span class="op" id="3079349">(</span><span class="ident" id="3079350">s0</span><span class="op" id="3079352">)</span><span class="op" id="3079353">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079357">t2</span>&nbsp;<span class="op" id="3079360">=</span>&nbsp;<span class="ident" id="3079362">xk</span><span class="op" id="3079364">[</span><span class="ident" id="3079365">k</span><span class="op" id="3079366">+</span><span class="num" id="3079367">2</span><span class="op" id="3079368">]</span>&nbsp;<span class="op" id="3079370">^</span>&nbsp;<span class="ident" id="3079372">te0</span><span class="op" id="3079375">[</span><span class="builtintype" id="3079376">uint8</span><span class="op" id="3079381">(</span><span class="ident" id="3079382">s2</span><span class="op" id="3079384">&gt;&gt;</span><span class="num" id="3079386">24</span><span class="op" id="3079388">)</span><span class="op" id="3079389">]</span>&nbsp;<span class="op" id="3079391">^</span>&nbsp;<span class="ident" id="3079393">te1</span><span class="op" id="3079396">[</span><span class="builtintype" id="3079397">uint8</span><span class="op" id="3079402">(</span><span class="ident" id="3079403">s3</span><span class="op" id="3079405">&gt;&gt;</span><span class="num" id="3079407">16</span><span class="op" id="3079409">)</span><span class="op" id="3079410">]</span>&nbsp;<span class="op" id="3079412">^</span>&nbsp;<span class="ident" id="3079414">te2</span><span class="op" id="3079417">[</span><span class="builtintype" id="3079418">uint8</span><span class="op" id="3079423">(</span><span class="ident" id="3079424">s0</span><span class="op" id="3079426">&gt;&gt;</span><span class="num" id="3079428">8</span><span class="op" id="3079429">)</span><span class="op" id="3079430">]</span>&nbsp;<span class="op" id="3079432">^</span>&nbsp;<span class="ident" id="3079434">te3</span><span class="op" id="3079437">[</span><span class="builtintype" id="3079438">uint8</span><span class="op" id="3079443">(</span><span class="ident" id="3079444">s1</span><span class="op" id="3079446">)</span><span class="op" id="3079447">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079451">t3</span>&nbsp;<span class="op" id="3079454">=</span>&nbsp;<span class="ident" id="3079456">xk</span><span class="op" id="3079458">[</span><span class="ident" id="3079459">k</span><span class="op" id="3079460">+</span><span class="num" id="3079461">3</span><span class="op" id="3079462">]</span>&nbsp;<span class="op" id="3079464">^</span>&nbsp;<span class="ident" id="3079466">te0</span><span class="op" id="3079469">[</span><span class="builtintype" id="3079470">uint8</span><span class="op" id="3079475">(</span><span class="ident" id="3079476">s3</span><span class="op" id="3079478">&gt;&gt;</span><span class="num" id="3079480">24</span><span class="op" id="3079482">)</span><span class="op" id="3079483">]</span>&nbsp;<span class="op" id="3079485">^</span>&nbsp;<span class="ident" id="3079487">te1</span><span class="op" id="3079490">[</span><span class="builtintype" id="3079491">uint8</span><span class="op" id="3079496">(</span><span class="ident" id="3079497">s0</span><span class="op" id="3079499">&gt;&gt;</span><span class="num" id="3079501">16</span><span class="op" id="3079503">)</span><span class="op" id="3079504">]</span>&nbsp;<span class="op" id="3079506">^</span>&nbsp;<span class="ident" id="3079508">te2</span><span class="op" id="3079511">[</span><span class="builtintype" id="3079512">uint8</span><span class="op" id="3079517">(</span><span class="ident" id="3079518">s1</span><span class="op" id="3079520">&gt;&gt;</span><span class="num" id="3079522">8</span><span class="op" id="3079523">)</span><span class="op" id="3079524">]</span>&nbsp;<span class="op" id="3079526">^</span>&nbsp;<span class="ident" id="3079528">te3</span><span class="op" id="3079531">[</span><span class="builtintype" id="3079532">uint8</span><span class="op" id="3079537">(</span><span class="ident" id="3079538">s2</span><span class="op" id="3079540">)</span><span class="op" id="3079541">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079545">k</span>&nbsp;<span class="op" id="3079547">+=</span>&nbsp;<span class="num" id="3079550">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079554">s0</span><span class="op" id="3079556">,</span>&nbsp;<span class="ident" id="3079558">s1</span><span class="op" id="3079560">,</span>&nbsp;<span class="ident" id="3079562">s2</span><span class="op" id="3079564">,</span>&nbsp;<span class="ident" id="3079566">s3</span>&nbsp;<span class="op" id="3079569">=</span>&nbsp;<span class="ident" id="3079571">t0</span><span class="op" id="3079573">,</span>&nbsp;<span class="ident" id="3079575">t1</span><span class="op" id="3079577">,</span>&nbsp;<span class="ident" id="3079579">t2</span><span class="op" id="3079581">,</span>&nbsp;<span class="ident" id="3079583">t3</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3079587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3079591">//&nbsp;Last&nbsp;round&nbsp;uses&nbsp;s-box&nbsp;directly&nbsp;and&nbsp;XORs&nbsp;to&nbsp;produce&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079654">s0</span>&nbsp;<span class="op" id="3079657">=</span>&nbsp;<span class="builtintype" id="3079659">uint32</span><span class="op" id="3079665">(</span><span class="ident" id="3079666">sbox0</span><span class="op" id="3079671">[</span><span class="ident" id="3079672">t0</span><span class="op" id="3079674">&gt;&gt;</span><span class="num" id="3079676">24</span><span class="op" id="3079678">]</span><span class="op" id="3079679">)</span><span class="op" id="3079680">&lt;&lt;</span><span class="num" id="3079682">24</span>&nbsp;<span class="op" id="3079685">|</span>&nbsp;<span class="builtintype" id="3079687">uint32</span><span class="op" id="3079693">(</span><span class="ident" id="3079694">sbox0</span><span class="op" id="3079699">[</span><span class="ident" id="3079700">t1</span><span class="op" id="3079702">&gt;&gt;</span><span class="num" id="3079704">16</span><span class="op" id="3079706">&amp;</span><span class="num" id="3079707">0xff</span><span class="op" id="3079711">]</span><span class="op" id="3079712">)</span><span class="op" id="3079713">&lt;&lt;</span><span class="num" id="3079715">16</span>&nbsp;<span class="op" id="3079718">|</span>&nbsp;<span class="builtintype" id="3079720">uint32</span><span class="op" id="3079726">(</span><span class="ident" id="3079727">sbox0</span><span class="op" id="3079732">[</span><span class="ident" id="3079733">t2</span><span class="op" id="3079735">&gt;&gt;</span><span class="num" id="3079737">8</span><span class="op" id="3079738">&amp;</span><span class="num" id="3079739">0xff</span><span class="op" id="3079743">]</span><span class="op" id="3079744">)</span><span class="op" id="3079745">&lt;&lt;</span><span class="num" id="3079747">8</span>&nbsp;<span class="op" id="3079749">|</span>&nbsp;<span class="builtintype" id="3079751">uint32</span><span class="op" id="3079757">(</span><span class="ident" id="3079758">sbox0</span><span class="op" id="3079763">[</span><span class="ident" id="3079764">t3</span><span class="op" id="3079766">&amp;</span><span class="num" id="3079767">0xff</span><span class="op" id="3079771">]</span><span class="op" id="3079772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079775">s1</span>&nbsp;<span class="op" id="3079778">=</span>&nbsp;<span class="builtintype" id="3079780">uint32</span><span class="op" id="3079786">(</span><span class="ident" id="3079787">sbox0</span><span class="op" id="3079792">[</span><span class="ident" id="3079793">t1</span><span class="op" id="3079795">&gt;&gt;</span><span class="num" id="3079797">24</span><span class="op" id="3079799">]</span><span class="op" id="3079800">)</span><span class="op" id="3079801">&lt;&lt;</span><span class="num" id="3079803">24</span>&nbsp;<span class="op" id="3079806">|</span>&nbsp;<span class="builtintype" id="3079808">uint32</span><span class="op" id="3079814">(</span><span class="ident" id="3079815">sbox0</span><span class="op" id="3079820">[</span><span class="ident" id="3079821">t2</span><span class="op" id="3079823">&gt;&gt;</span><span class="num" id="3079825">16</span><span class="op" id="3079827">&amp;</span><span class="num" id="3079828">0xff</span><span class="op" id="3079832">]</span><span class="op" id="3079833">)</span><span class="op" id="3079834">&lt;&lt;</span><span class="num" id="3079836">16</span>&nbsp;<span class="op" id="3079839">|</span>&nbsp;<span class="builtintype" id="3079841">uint32</span><span class="op" id="3079847">(</span><span class="ident" id="3079848">sbox0</span><span class="op" id="3079853">[</span><span class="ident" id="3079854">t3</span><span class="op" id="3079856">&gt;&gt;</span><span class="num" id="3079858">8</span><span class="op" id="3079859">&amp;</span><span class="num" id="3079860">0xff</span><span class="op" id="3079864">]</span><span class="op" id="3079865">)</span><span class="op" id="3079866">&lt;&lt;</span><span class="num" id="3079868">8</span>&nbsp;<span class="op" id="3079870">|</span>&nbsp;<span class="builtintype" id="3079872">uint32</span><span class="op" id="3079878">(</span><span class="ident" id="3079879">sbox0</span><span class="op" id="3079884">[</span><span class="ident" id="3079885">t0</span><span class="op" id="3079887">&amp;</span><span class="num" id="3079888">0xff</span><span class="op" id="3079892">]</span><span class="op" id="3079893">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079896">s2</span>&nbsp;<span class="op" id="3079899">=</span>&nbsp;<span class="builtintype" id="3079901">uint32</span><span class="op" id="3079907">(</span><span class="ident" id="3079908">sbox0</span><span class="op" id="3079913">[</span><span class="ident" id="3079914">t2</span><span class="op" id="3079916">&gt;&gt;</span><span class="num" id="3079918">24</span><span class="op" id="3079920">]</span><span class="op" id="3079921">)</span><span class="op" id="3079922">&lt;&lt;</span><span class="num" id="3079924">24</span>&nbsp;<span class="op" id="3079927">|</span>&nbsp;<span class="builtintype" id="3079929">uint32</span><span class="op" id="3079935">(</span><span class="ident" id="3079936">sbox0</span><span class="op" id="3079941">[</span><span class="ident" id="3079942">t3</span><span class="op" id="3079944">&gt;&gt;</span><span class="num" id="3079946">16</span><span class="op" id="3079948">&amp;</span><span class="num" id="3079949">0xff</span><span class="op" id="3079953">]</span><span class="op" id="3079954">)</span><span class="op" id="3079955">&lt;&lt;</span><span class="num" id="3079957">16</span>&nbsp;<span class="op" id="3079960">|</span>&nbsp;<span class="builtintype" id="3079962">uint32</span><span class="op" id="3079968">(</span><span class="ident" id="3079969">sbox0</span><span class="op" id="3079974">[</span><span class="ident" id="3079975">t0</span><span class="op" id="3079977">&gt;&gt;</span><span class="num" id="3079979">8</span><span class="op" id="3079980">&amp;</span><span class="num" id="3079981">0xff</span><span class="op" id="3079985">]</span><span class="op" id="3079986">)</span><span class="op" id="3079987">&lt;&lt;</span><span class="num" id="3079989">8</span>&nbsp;<span class="op" id="3079991">|</span>&nbsp;<span class="builtintype" id="3079993">uint32</span><span class="op" id="3079999">(</span><span class="ident" id="3080000">sbox0</span><span class="op" id="3080005">[</span><span class="ident" id="3080006">t1</span><span class="op" id="3080008">&amp;</span><span class="num" id="3080009">0xff</span><span class="op" id="3080013">]</span><span class="op" id="3080014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080017">s3</span>&nbsp;<span class="op" id="3080020">=</span>&nbsp;<span class="builtintype" id="3080022">uint32</span><span class="op" id="3080028">(</span><span class="ident" id="3080029">sbox0</span><span class="op" id="3080034">[</span><span class="ident" id="3080035">t3</span><span class="op" id="3080037">&gt;&gt;</span><span class="num" id="3080039">24</span><span class="op" id="3080041">]</span><span class="op" id="3080042">)</span><span class="op" id="3080043">&lt;&lt;</span><span class="num" id="3080045">24</span>&nbsp;<span class="op" id="3080048">|</span>&nbsp;<span class="builtintype" id="3080050">uint32</span><span class="op" id="3080056">(</span><span class="ident" id="3080057">sbox0</span><span class="op" id="3080062">[</span><span class="ident" id="3080063">t0</span><span class="op" id="3080065">&gt;&gt;</span><span class="num" id="3080067">16</span><span class="op" id="3080069">&amp;</span><span class="num" id="3080070">0xff</span><span class="op" id="3080074">]</span><span class="op" id="3080075">)</span><span class="op" id="3080076">&lt;&lt;</span><span class="num" id="3080078">16</span>&nbsp;<span class="op" id="3080081">|</span>&nbsp;<span class="builtintype" id="3080083">uint32</span><span class="op" id="3080089">(</span><span class="ident" id="3080090">sbox0</span><span class="op" id="3080095">[</span><span class="ident" id="3080096">t1</span><span class="op" id="3080098">&gt;&gt;</span><span class="num" id="3080100">8</span><span class="op" id="3080101">&amp;</span><span class="num" id="3080102">0xff</span><span class="op" id="3080106">]</span><span class="op" id="3080107">)</span><span class="op" id="3080108">&lt;&lt;</span><span class="num" id="3080110">8</span>&nbsp;<span class="op" id="3080112">|</span>&nbsp;<span class="builtintype" id="3080114">uint32</span><span class="op" id="3080120">(</span><span class="ident" id="3080121">sbox0</span><span class="op" id="3080126">[</span><span class="ident" id="3080127">t2</span><span class="op" id="3080129">&amp;</span><span class="num" id="3080130">0xff</span><span class="op" id="3080134">]</span><span class="op" id="3080135">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080139">s0</span>&nbsp;<span class="op" id="3080142">^=</span>&nbsp;<span class="ident" id="3080145">xk</span><span class="op" id="3080147">[</span><span class="ident" id="3080148">k</span><span class="op" id="3080149">+</span><span class="num" id="3080150">0</span><span class="op" id="3080151">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080154">s1</span>&nbsp;<span class="op" id="3080157">^=</span>&nbsp;<span class="ident" id="3080160">xk</span><span class="op" id="3080162">[</span><span class="ident" id="3080163">k</span><span class="op" id="3080164">+</span><span class="num" id="3080165">1</span><span class="op" id="3080166">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080169">s2</span>&nbsp;<span class="op" id="3080172">^=</span>&nbsp;<span class="ident" id="3080175">xk</span><span class="op" id="3080177">[</span><span class="ident" id="3080178">k</span><span class="op" id="3080179">+</span><span class="num" id="3080180">2</span><span class="op" id="3080181">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080184">s3</span>&nbsp;<span class="op" id="3080187">^=</span>&nbsp;<span class="ident" id="3080190">xk</span><span class="op" id="3080192">[</span><span class="ident" id="3080193">k</span><span class="op" id="3080194">+</span><span class="num" id="3080195">3</span><span class="op" id="3080196">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080200">dst</span><span class="op" id="3080203">[</span><span class="num" id="3080204">0</span><span class="op" id="3080205">]</span><span class="op" id="3080206">,</span>&nbsp;<span class="ident" id="3080208">dst</span><span class="op" id="3080211">[</span><span class="num" id="3080212">1</span><span class="op" id="3080213">]</span><span class="op" id="3080214">,</span>&nbsp;<span class="ident" id="3080216">dst</span><span class="op" id="3080219">[</span><span class="num" id="3080220">2</span><span class="op" id="3080221">]</span><span class="op" id="3080222">,</span>&nbsp;<span class="ident" id="3080224">dst</span><span class="op" id="3080227">[</span><span class="num" id="3080228">3</span><span class="op" id="3080229">]</span>&nbsp;<span class="op" id="3080231">=</span>&nbsp;<span class="builtintype" id="3080233">byte</span><span class="op" id="3080237">(</span><span class="ident" id="3080238">s0</span><span class="op" id="3080240">&gt;&gt;</span><span class="num" id="3080242">24</span><span class="op" id="3080244">)</span><span class="op" id="3080245">,</span>&nbsp;<span class="builtintype" id="3080247">byte</span><span class="op" id="3080251">(</span><span class="ident" id="3080252">s0</span><span class="op" id="3080254">&gt;&gt;</span><span class="num" id="3080256">16</span><span class="op" id="3080258">)</span><span class="op" id="3080259">,</span>&nbsp;<span class="builtintype" id="3080261">byte</span><span class="op" id="3080265">(</span><span class="ident" id="3080266">s0</span><span class="op" id="3080268">&gt;&gt;</span><span class="num" id="3080270">8</span><span class="op" id="3080271">)</span><span class="op" id="3080272">,</span>&nbsp;<span class="builtintype" id="3080274">byte</span><span class="op" id="3080278">(</span><span class="ident" id="3080279">s0</span><span class="op" id="3080281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080284">dst</span><span class="op" id="3080287">[</span><span class="num" id="3080288">4</span><span class="op" id="3080289">]</span><span class="op" id="3080290">,</span>&nbsp;<span class="ident" id="3080292">dst</span><span class="op" id="3080295">[</span><span class="num" id="3080296">5</span><span class="op" id="3080297">]</span><span class="op" id="3080298">,</span>&nbsp;<span class="ident" id="3080300">dst</span><span class="op" id="3080303">[</span><span class="num" id="3080304">6</span><span class="op" id="3080305">]</span><span class="op" id="3080306">,</span>&nbsp;<span class="ident" id="3080308">dst</span><span class="op" id="3080311">[</span><span class="num" id="3080312">7</span><span class="op" id="3080313">]</span>&nbsp;<span class="op" id="3080315">=</span>&nbsp;<span class="builtintype" id="3080317">byte</span><span class="op" id="3080321">(</span><span class="ident" id="3080322">s1</span><span class="op" id="3080324">&gt;&gt;</span><span class="num" id="3080326">24</span><span class="op" id="3080328">)</span><span class="op" id="3080329">,</span>&nbsp;<span class="builtintype" id="3080331">byte</span><span class="op" id="3080335">(</span><span class="ident" id="3080336">s1</span><span class="op" id="3080338">&gt;&gt;</span><span class="num" id="3080340">16</span><span class="op" id="3080342">)</span><span class="op" id="3080343">,</span>&nbsp;<span class="builtintype" id="3080345">byte</span><span class="op" id="3080349">(</span><span class="ident" id="3080350">s1</span><span class="op" id="3080352">&gt;&gt;</span><span class="num" id="3080354">8</span><span class="op" id="3080355">)</span><span class="op" id="3080356">,</span>&nbsp;<span class="builtintype" id="3080358">byte</span><span class="op" id="3080362">(</span><span class="ident" id="3080363">s1</span><span class="op" id="3080365">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080368">dst</span><span class="op" id="3080371">[</span><span class="num" id="3080372">8</span><span class="op" id="3080373">]</span><span class="op" id="3080374">,</span>&nbsp;<span class="ident" id="3080376">dst</span><span class="op" id="3080379">[</span><span class="num" id="3080380">9</span><span class="op" id="3080381">]</span><span class="op" id="3080382">,</span>&nbsp;<span class="ident" id="3080384">dst</span><span class="op" id="3080387">[</span><span class="num" id="3080388">10</span><span class="op" id="3080390">]</span><span class="op" id="3080391">,</span>&nbsp;<span class="ident" id="3080393">dst</span><span class="op" id="3080396">[</span><span class="num" id="3080397">11</span><span class="op" id="3080399">]</span>&nbsp;<span class="op" id="3080401">=</span>&nbsp;<span class="builtintype" id="3080403">byte</span><span class="op" id="3080407">(</span><span class="ident" id="3080408">s2</span><span class="op" id="3080410">&gt;&gt;</span><span class="num" id="3080412">24</span><span class="op" id="3080414">)</span><span class="op" id="3080415">,</span>&nbsp;<span class="builtintype" id="3080417">byte</span><span class="op" id="3080421">(</span><span class="ident" id="3080422">s2</span><span class="op" id="3080424">&gt;&gt;</span><span class="num" id="3080426">16</span><span class="op" id="3080428">)</span><span class="op" id="3080429">,</span>&nbsp;<span class="builtintype" id="3080431">byte</span><span class="op" id="3080435">(</span><span class="ident" id="3080436">s2</span><span class="op" id="3080438">&gt;&gt;</span><span class="num" id="3080440">8</span><span class="op" id="3080441">)</span><span class="op" id="3080442">,</span>&nbsp;<span class="builtintype" id="3080444">byte</span><span class="op" id="3080448">(</span><span class="ident" id="3080449">s2</span><span class="op" id="3080451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080454">dst</span><span class="op" id="3080457">[</span><span class="num" id="3080458">12</span><span class="op" id="3080460">]</span><span class="op" id="3080461">,</span>&nbsp;<span class="ident" id="3080463">dst</span><span class="op" id="3080466">[</span><span class="num" id="3080467">13</span><span class="op" id="3080469">]</span><span class="op" id="3080470">,</span>&nbsp;<span class="ident" id="3080472">dst</span><span class="op" id="3080475">[</span><span class="num" id="3080476">14</span><span class="op" id="3080478">]</span><span class="op" id="3080479">,</span>&nbsp;<span class="ident" id="3080481">dst</span><span class="op" id="3080484">[</span><span class="num" id="3080485">15</span><span class="op" id="3080487">]</span>&nbsp;<span class="op" id="3080489">=</span>&nbsp;<span class="builtintype" id="3080491">byte</span><span class="op" id="3080495">(</span><span class="ident" id="3080496">s3</span><span class="op" id="3080498">&gt;&gt;</span><span class="num" id="3080500">24</span><span class="op" id="3080502">)</span><span class="op" id="3080503">,</span>&nbsp;<span class="builtintype" id="3080505">byte</span><span class="op" id="3080509">(</span><span class="ident" id="3080510">s3</span><span class="op" id="3080512">&gt;&gt;</span><span class="num" id="3080514">16</span><span class="op" id="3080516">)</span><span class="op" id="3080517">,</span>&nbsp;<span class="builtintype" id="3080519">byte</span><span class="op" id="3080523">(</span><span class="ident" id="3080524">s3</span><span class="op" id="3080526">&gt;&gt;</span><span class="num" id="3080528">8</span><span class="op" id="3080529">)</span><span class="op" id="3080530">,</span>&nbsp;<span class="builtintype" id="3080532">byte</span><span class="op" id="3080536">(</span><span class="ident" id="3080537">s3</span><span class="op" id="3080539">)</span><br>
<span class="lineno"></span><span class="op" id="3080541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3080544">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;expanded&nbsp;key&nbsp;xk.</span><br>
<span class="lineno">85</span><span class="keyword" id="3080611">func</span>&nbsp;<span class="ident" id="3080616">decryptBlockGo</span><span class="op" id="3080630">(</span><span class="ident" id="3080631">xk</span>&nbsp;<span class="op" id="3080634">[</span><span class="op" id="3080635">]</span><span class="builtintype" id="3080636">uint32</span><span class="op" id="3080642">,</span>&nbsp;<span class="ident" id="3080644">dst</span><span class="op" id="3080647">,</span>&nbsp;<span class="ident" id="3080649">src</span>&nbsp;<span class="op" id="3080653">[</span><span class="op" id="3080654">]</span><span class="builtintype" id="3080655">byte</span><span class="op" id="3080659">)</span>&nbsp;<span class="op" id="3080661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3080664">var</span>&nbsp;<span class="ident" id="3080668">s0</span><span class="op" id="3080670">,</span>&nbsp;<span class="ident" id="3080672">s1</span><span class="op" id="3080674">,</span>&nbsp;<span class="ident" id="3080676">s2</span><span class="op" id="3080678">,</span>&nbsp;<span class="ident" id="3080680">s3</span><span class="op" id="3080682">,</span>&nbsp;<span class="ident" id="3080684">t0</span><span class="op" id="3080686">,</span>&nbsp;<span class="ident" id="3080688">t1</span><span class="op" id="3080690">,</span>&nbsp;<span class="ident" id="3080692">t2</span><span class="op" id="3080694">,</span>&nbsp;<span class="ident" id="3080696">t3</span>&nbsp;<span class="builtintype" id="3080699">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080708">s0</span>&nbsp;<span class="op" id="3080711">=</span>&nbsp;<span class="builtintype" id="3080713">uint32</span><span class="op" id="3080719">(</span><span class="ident" id="3080720">src</span><span class="op" id="3080723">[</span><span class="num" id="3080724">0</span><span class="op" id="3080725">]</span><span class="op" id="3080726">)</span><span class="op" id="3080727">&lt;&lt;</span><span class="num" id="3080729">24</span>&nbsp;<span class="op" id="3080732">|</span>&nbsp;<span class="builtintype" id="3080734">uint32</span><span class="op" id="3080740">(</span><span class="ident" id="3080741">src</span><span class="op" id="3080744">[</span><span class="num" id="3080745">1</span><span class="op" id="3080746">]</span><span class="op" id="3080747">)</span><span class="op" id="3080748">&lt;&lt;</span><span class="num" id="3080750">16</span>&nbsp;<span class="op" id="3080753">|</span>&nbsp;<span class="builtintype" id="3080755">uint32</span><span class="op" id="3080761">(</span><span class="ident" id="3080762">src</span><span class="op" id="3080765">[</span><span class="num" id="3080766">2</span><span class="op" id="3080767">]</span><span class="op" id="3080768">)</span><span class="op" id="3080769">&lt;&lt;</span><span class="num" id="3080771">8</span>&nbsp;<span class="op" id="3080773">|</span>&nbsp;<span class="builtintype" id="3080775">uint32</span><span class="op" id="3080781">(</span><span class="ident" id="3080782">src</span><span class="op" id="3080785">[</span><span class="num" id="3080786">3</span><span class="op" id="3080787">]</span><span class="op" id="3080788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080791">s1</span>&nbsp;<span class="op" id="3080794">=</span>&nbsp;<span class="builtintype" id="3080796">uint32</span><span class="op" id="3080802">(</span><span class="ident" id="3080803">src</span><span class="op" id="3080806">[</span><span class="num" id="3080807">4</span><span class="op" id="3080808">]</span><span class="op" id="3080809">)</span><span class="op" id="3080810">&lt;&lt;</span><span class="num" id="3080812">24</span>&nbsp;<span class="op" id="3080815">|</span>&nbsp;<span class="builtintype" id="3080817">uint32</span><span class="op" id="3080823">(</span><span class="ident" id="3080824">src</span><span class="op" id="3080827">[</span><span class="num" id="3080828">5</span><span class="op" id="3080829">]</span><span class="op" id="3080830">)</span><span class="op" id="3080831">&lt;&lt;</span><span class="num" id="3080833">16</span>&nbsp;<span class="op" id="3080836">|</span>&nbsp;<span class="builtintype" id="3080838">uint32</span><span class="op" id="3080844">(</span><span class="ident" id="3080845">src</span><span class="op" id="3080848">[</span><span class="num" id="3080849">6</span><span class="op" id="3080850">]</span><span class="op" id="3080851">)</span><span class="op" id="3080852">&lt;&lt;</span><span class="num" id="3080854">8</span>&nbsp;<span class="op" id="3080856">|</span>&nbsp;<span class="builtintype" id="3080858">uint32</span><span class="op" id="3080864">(</span><span class="ident" id="3080865">src</span><span class="op" id="3080868">[</span><span class="num" id="3080869">7</span><span class="op" id="3080870">]</span><span class="op" id="3080871">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080874">s2</span>&nbsp;<span class="op" id="3080877">=</span>&nbsp;<span class="builtintype" id="3080879">uint32</span><span class="op" id="3080885">(</span><span class="ident" id="3080886">src</span><span class="op" id="3080889">[</span><span class="num" id="3080890">8</span><span class="op" id="3080891">]</span><span class="op" id="3080892">)</span><span class="op" id="3080893">&lt;&lt;</span><span class="num" id="3080895">24</span>&nbsp;<span class="op" id="3080898">|</span>&nbsp;<span class="builtintype" id="3080900">uint32</span><span class="op" id="3080906">(</span><span class="ident" id="3080907">src</span><span class="op" id="3080910">[</span><span class="num" id="3080911">9</span><span class="op" id="3080912">]</span><span class="op" id="3080913">)</span><span class="op" id="3080914">&lt;&lt;</span><span class="num" id="3080916">16</span>&nbsp;<span class="op" id="3080919">|</span>&nbsp;<span class="builtintype" id="3080921">uint32</span><span class="op" id="3080927">(</span><span class="ident" id="3080928">src</span><span class="op" id="3080931">[</span><span class="num" id="3080932">10</span><span class="op" id="3080934">]</span><span class="op" id="3080935">)</span><span class="op" id="3080936">&lt;&lt;</span><span class="num" id="3080938">8</span>&nbsp;<span class="op" id="3080940">|</span>&nbsp;<span class="builtintype" id="3080942">uint32</span><span class="op" id="3080948">(</span><span class="ident" id="3080949">src</span><span class="op" id="3080952">[</span><span class="num" id="3080953">11</span><span class="op" id="3080955">]</span><span class="op" id="3080956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080959">s3</span>&nbsp;<span class="op" id="3080962">=</span>&nbsp;<span class="builtintype" id="3080964">uint32</span><span class="op" id="3080970">(</span><span class="ident" id="3080971">src</span><span class="op" id="3080974">[</span><span class="num" id="3080975">12</span><span class="op" id="3080977">]</span><span class="op" id="3080978">)</span><span class="op" id="3080979">&lt;&lt;</span><span class="num" id="3080981">24</span>&nbsp;<span class="op" id="3080984">|</span>&nbsp;<span class="builtintype" id="3080986">uint32</span><span class="op" id="3080992">(</span><span class="ident" id="3080993">src</span><span class="op" id="3080996">[</span><span class="num" id="3080997">13</span><span class="op" id="3080999">]</span><span class="op" id="3081000">)</span><span class="op" id="3081001">&lt;&lt;</span><span class="num" id="3081003">16</span>&nbsp;<span class="op" id="3081006">|</span>&nbsp;<span class="builtintype" id="3081008">uint32</span><span class="op" id="3081014">(</span><span class="ident" id="3081015">src</span><span class="op" id="3081018">[</span><span class="num" id="3081019">14</span><span class="op" id="3081021">]</span><span class="op" id="3081022">)</span><span class="op" id="3081023">&lt;&lt;</span><span class="num" id="3081025">8</span>&nbsp;<span class="op" id="3081027">|</span>&nbsp;<span class="builtintype" id="3081029">uint32</span><span class="op" id="3081035">(</span><span class="ident" id="3081036">src</span><span class="op" id="3081039">[</span><span class="num" id="3081040">15</span><span class="op" id="3081042">]</span><span class="op" id="3081043">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3081047">//&nbsp;First&nbsp;round&nbsp;just&nbsp;XORs&nbsp;input&nbsp;with&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081089">s0</span>&nbsp;<span class="op" id="3081092">^=</span>&nbsp;<span class="ident" id="3081095">xk</span><span class="op" id="3081097">[</span><span class="num" id="3081098">0</span><span class="op" id="3081099">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081102">s1</span>&nbsp;<span class="op" id="3081105">^=</span>&nbsp;<span class="ident" id="3081108">xk</span><span class="op" id="3081110">[</span><span class="num" id="3081111">1</span><span class="op" id="3081112">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081115">s2</span>&nbsp;<span class="op" id="3081118">^=</span>&nbsp;<span class="ident" id="3081121">xk</span><span class="op" id="3081123">[</span><span class="num" id="3081124">2</span><span class="op" id="3081125">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081128">s3</span>&nbsp;<span class="op" id="3081131">^=</span>&nbsp;<span class="ident" id="3081134">xk</span><span class="op" id="3081136">[</span><span class="num" id="3081137">3</span><span class="op" id="3081138">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3081142">//&nbsp;Middle&nbsp;rounds&nbsp;shuffle&nbsp;using&nbsp;tables.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3081182">//&nbsp;Number&nbsp;of&nbsp;rounds&nbsp;is&nbsp;set&nbsp;by&nbsp;length&nbsp;of&nbsp;expanded&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081237">nr</span>&nbsp;<span class="op" id="3081240">:=</span>&nbsp;<span class="builtinfunc" id="3081243">len</span><span class="op" id="3081246">(</span><span class="ident" id="3081247">xk</span><span class="op" id="3081249">)</span><span class="op" id="3081250">/</span><span class="num" id="3081251">4</span>&nbsp;<span class="op" id="3081253">-</span>&nbsp;<span class="num" id="3081255">2</span>&nbsp;<span class="comment" id="3081257">//&nbsp;-&nbsp;2:&nbsp;one&nbsp;above,&nbsp;one&nbsp;more&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081292">k</span>&nbsp;<span class="op" id="3081294">:=</span>&nbsp;<span class="num" id="3081297">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3081300">for</span>&nbsp;<span class="ident" id="3081304">r</span>&nbsp;<span class="op" id="3081306">:=</span>&nbsp;<span class="num" id="3081309">0</span><span class="op" id="3081310">;</span>&nbsp;<span class="ident" id="3081312">r</span>&nbsp;<span class="op" id="3081314">&lt;</span>&nbsp;<span class="ident" id="3081316">nr</span><span class="op" id="3081318">;</span>&nbsp;<span class="ident" id="3081320">r</span><span class="op" id="3081321">++</span>&nbsp;<span class="op" id="3081324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081328">t0</span>&nbsp;<span class="op" id="3081331">=</span>&nbsp;<span class="ident" id="3081333">xk</span><span class="op" id="3081335">[</span><span class="ident" id="3081336">k</span><span class="op" id="3081337">+</span><span class="num" id="3081338">0</span><span class="op" id="3081339">]</span>&nbsp;<span class="op" id="3081341">^</span>&nbsp;<span class="ident" id="3081343">td0</span><span class="op" id="3081346">[</span><span class="builtintype" id="3081347">uint8</span><span class="op" id="3081352">(</span><span class="ident" id="3081353">s0</span><span class="op" id="3081355">&gt;&gt;</span><span class="num" id="3081357">24</span><span class="op" id="3081359">)</span><span class="op" id="3081360">]</span>&nbsp;<span class="op" id="3081362">^</span>&nbsp;<span class="ident" id="3081364">td1</span><span class="op" id="3081367">[</span><span class="builtintype" id="3081368">uint8</span><span class="op" id="3081373">(</span><span class="ident" id="3081374">s3</span><span class="op" id="3081376">&gt;&gt;</span><span class="num" id="3081378">16</span><span class="op" id="3081380">)</span><span class="op" id="3081381">]</span>&nbsp;<span class="op" id="3081383">^</span>&nbsp;<span class="ident" id="3081385">td2</span><span class="op" id="3081388">[</span><span class="builtintype" id="3081389">uint8</span><span class="op" id="3081394">(</span><span class="ident" id="3081395">s2</span><span class="op" id="3081397">&gt;&gt;</span><span class="num" id="3081399">8</span><span class="op" id="3081400">)</span><span class="op" id="3081401">]</span>&nbsp;<span class="op" id="3081403">^</span>&nbsp;<span class="ident" id="3081405">td3</span><span class="op" id="3081408">[</span><span class="builtintype" id="3081409">uint8</span><span class="op" id="3081414">(</span><span class="ident" id="3081415">s1</span><span class="op" id="3081417">)</span><span class="op" id="3081418">]</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081422">t1</span>&nbsp;<span class="op" id="3081425">=</span>&nbsp;<span class="ident" id="3081427">xk</span><span class="op" id="3081429">[</span><span class="ident" id="3081430">k</span><span class="op" id="3081431">+</span><span class="num" id="3081432">1</span><span class="op" id="3081433">]</span>&nbsp;<span class="op" id="3081435">^</span>&nbsp;<span class="ident" id="3081437">td0</span><span class="op" id="3081440">[</span><span class="builtintype" id="3081441">uint8</span><span class="op" id="3081446">(</span><span class="ident" id="3081447">s1</span><span class="op" id="3081449">&gt;&gt;</span><span class="num" id="3081451">24</span><span class="op" id="3081453">)</span><span class="op" id="3081454">]</span>&nbsp;<span class="op" id="3081456">^</span>&nbsp;<span class="ident" id="3081458">td1</span><span class="op" id="3081461">[</span><span class="builtintype" id="3081462">uint8</span><span class="op" id="3081467">(</span><span class="ident" id="3081468">s0</span><span class="op" id="3081470">&gt;&gt;</span><span class="num" id="3081472">16</span><span class="op" id="3081474">)</span><span class="op" id="3081475">]</span>&nbsp;<span class="op" id="3081477">^</span>&nbsp;<span class="ident" id="3081479">td2</span><span class="op" id="3081482">[</span><span class="builtintype" id="3081483">uint8</span><span class="op" id="3081488">(</span><span class="ident" id="3081489">s3</span><span class="op" id="3081491">&gt;&gt;</span><span class="num" id="3081493">8</span><span class="op" id="3081494">)</span><span class="op" id="3081495">]</span>&nbsp;<span class="op" id="3081497">^</span>&nbsp;<span class="ident" id="3081499">td3</span><span class="op" id="3081502">[</span><span class="builtintype" id="3081503">uint8</span><span class="op" id="3081508">(</span><span class="ident" id="3081509">s2</span><span class="op" id="3081511">)</span><span class="op" id="3081512">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081516">t2</span>&nbsp;<span class="op" id="3081519">=</span>&nbsp;<span class="ident" id="3081521">xk</span><span class="op" id="3081523">[</span><span class="ident" id="3081524">k</span><span class="op" id="3081525">+</span><span class="num" id="3081526">2</span><span class="op" id="3081527">]</span>&nbsp;<span class="op" id="3081529">^</span>&nbsp;<span class="ident" id="3081531">td0</span><span class="op" id="3081534">[</span><span class="builtintype" id="3081535">uint8</span><span class="op" id="3081540">(</span><span class="ident" id="3081541">s2</span><span class="op" id="3081543">&gt;&gt;</span><span class="num" id="3081545">24</span><span class="op" id="3081547">)</span><span class="op" id="3081548">]</span>&nbsp;<span class="op" id="3081550">^</span>&nbsp;<span class="ident" id="3081552">td1</span><span class="op" id="3081555">[</span><span class="builtintype" id="3081556">uint8</span><span class="op" id="3081561">(</span><span class="ident" id="3081562">s1</span><span class="op" id="3081564">&gt;&gt;</span><span class="num" id="3081566">16</span><span class="op" id="3081568">)</span><span class="op" id="3081569">]</span>&nbsp;<span class="op" id="3081571">^</span>&nbsp;<span class="ident" id="3081573">td2</span><span class="op" id="3081576">[</span><span class="builtintype" id="3081577">uint8</span><span class="op" id="3081582">(</span><span class="ident" id="3081583">s0</span><span class="op" id="3081585">&gt;&gt;</span><span class="num" id="3081587">8</span><span class="op" id="3081588">)</span><span class="op" id="3081589">]</span>&nbsp;<span class="op" id="3081591">^</span>&nbsp;<span class="ident" id="3081593">td3</span><span class="op" id="3081596">[</span><span class="builtintype" id="3081597">uint8</span><span class="op" id="3081602">(</span><span class="ident" id="3081603">s3</span><span class="op" id="3081605">)</span><span class="op" id="3081606">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081610">t3</span>&nbsp;<span class="op" id="3081613">=</span>&nbsp;<span class="ident" id="3081615">xk</span><span class="op" id="3081617">[</span><span class="ident" id="3081618">k</span><span class="op" id="3081619">+</span><span class="num" id="3081620">3</span><span class="op" id="3081621">]</span>&nbsp;<span class="op" id="3081623">^</span>&nbsp;<span class="ident" id="3081625">td0</span><span class="op" id="3081628">[</span><span class="builtintype" id="3081629">uint8</span><span class="op" id="3081634">(</span><span class="ident" id="3081635">s3</span><span class="op" id="3081637">&gt;&gt;</span><span class="num" id="3081639">24</span><span class="op" id="3081641">)</span><span class="op" id="3081642">]</span>&nbsp;<span class="op" id="3081644">^</span>&nbsp;<span class="ident" id="3081646">td1</span><span class="op" id="3081649">[</span><span class="builtintype" id="3081650">uint8</span><span class="op" id="3081655">(</span><span class="ident" id="3081656">s2</span><span class="op" id="3081658">&gt;&gt;</span><span class="num" id="3081660">16</span><span class="op" id="3081662">)</span><span class="op" id="3081663">]</span>&nbsp;<span class="op" id="3081665">^</span>&nbsp;<span class="ident" id="3081667">td2</span><span class="op" id="3081670">[</span><span class="builtintype" id="3081671">uint8</span><span class="op" id="3081676">(</span><span class="ident" id="3081677">s1</span><span class="op" id="3081679">&gt;&gt;</span><span class="num" id="3081681">8</span><span class="op" id="3081682">)</span><span class="op" id="3081683">]</span>&nbsp;<span class="op" id="3081685">^</span>&nbsp;<span class="ident" id="3081687">td3</span><span class="op" id="3081690">[</span><span class="builtintype" id="3081691">uint8</span><span class="op" id="3081696">(</span><span class="ident" id="3081697">s0</span><span class="op" id="3081699">)</span><span class="op" id="3081700">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081704">k</span>&nbsp;<span class="op" id="3081706">+=</span>&nbsp;<span class="num" id="3081709">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081713">s0</span><span class="op" id="3081715">,</span>&nbsp;<span class="ident" id="3081717">s1</span><span class="op" id="3081719">,</span>&nbsp;<span class="ident" id="3081721">s2</span><span class="op" id="3081723">,</span>&nbsp;<span class="ident" id="3081725">s3</span>&nbsp;<span class="op" id="3081728">=</span>&nbsp;<span class="ident" id="3081730">t0</span><span class="op" id="3081732">,</span>&nbsp;<span class="ident" id="3081734">t1</span><span class="op" id="3081736">,</span>&nbsp;<span class="ident" id="3081738">t2</span><span class="op" id="3081740">,</span>&nbsp;<span class="ident" id="3081742">t3</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3081746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3081750">//&nbsp;Last&nbsp;round&nbsp;uses&nbsp;s-box&nbsp;directly&nbsp;and&nbsp;XORs&nbsp;to&nbsp;produce&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081813">s0</span>&nbsp;<span class="op" id="3081816">=</span>&nbsp;<span class="builtintype" id="3081818">uint32</span><span class="op" id="3081824">(</span><span class="ident" id="3081825">sbox1</span><span class="op" id="3081830">[</span><span class="ident" id="3081831">t0</span><span class="op" id="3081833">&gt;&gt;</span><span class="num" id="3081835">24</span><span class="op" id="3081837">]</span><span class="op" id="3081838">)</span><span class="op" id="3081839">&lt;&lt;</span><span class="num" id="3081841">24</span>&nbsp;<span class="op" id="3081844">|</span>&nbsp;<span class="builtintype" id="3081846">uint32</span><span class="op" id="3081852">(</span><span class="ident" id="3081853">sbox1</span><span class="op" id="3081858">[</span><span class="ident" id="3081859">t3</span><span class="op" id="3081861">&gt;&gt;</span><span class="num" id="3081863">16</span><span class="op" id="3081865">&amp;</span><span class="num" id="3081866">0xff</span><span class="op" id="3081870">]</span><span class="op" id="3081871">)</span><span class="op" id="3081872">&lt;&lt;</span><span class="num" id="3081874">16</span>&nbsp;<span class="op" id="3081877">|</span>&nbsp;<span class="builtintype" id="3081879">uint32</span><span class="op" id="3081885">(</span><span class="ident" id="3081886">sbox1</span><span class="op" id="3081891">[</span><span class="ident" id="3081892">t2</span><span class="op" id="3081894">&gt;&gt;</span><span class="num" id="3081896">8</span><span class="op" id="3081897">&amp;</span><span class="num" id="3081898">0xff</span><span class="op" id="3081902">]</span><span class="op" id="3081903">)</span><span class="op" id="3081904">&lt;&lt;</span><span class="num" id="3081906">8</span>&nbsp;<span class="op" id="3081908">|</span>&nbsp;<span class="builtintype" id="3081910">uint32</span><span class="op" id="3081916">(</span><span class="ident" id="3081917">sbox1</span><span class="op" id="3081922">[</span><span class="ident" id="3081923">t1</span><span class="op" id="3081925">&amp;</span><span class="num" id="3081926">0xff</span><span class="op" id="3081930">]</span><span class="op" id="3081931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081934">s1</span>&nbsp;<span class="op" id="3081937">=</span>&nbsp;<span class="builtintype" id="3081939">uint32</span><span class="op" id="3081945">(</span><span class="ident" id="3081946">sbox1</span><span class="op" id="3081951">[</span><span class="ident" id="3081952">t1</span><span class="op" id="3081954">&gt;&gt;</span><span class="num" id="3081956">24</span><span class="op" id="3081958">]</span><span class="op" id="3081959">)</span><span class="op" id="3081960">&lt;&lt;</span><span class="num" id="3081962">24</span>&nbsp;<span class="op" id="3081965">|</span>&nbsp;<span class="builtintype" id="3081967">uint32</span><span class="op" id="3081973">(</span><span class="ident" id="3081974">sbox1</span><span class="op" id="3081979">[</span><span class="ident" id="3081980">t0</span><span class="op" id="3081982">&gt;&gt;</span><span class="num" id="3081984">16</span><span class="op" id="3081986">&amp;</span><span class="num" id="3081987">0xff</span><span class="op" id="3081991">]</span><span class="op" id="3081992">)</span><span class="op" id="3081993">&lt;&lt;</span><span class="num" id="3081995">16</span>&nbsp;<span class="op" id="3081998">|</span>&nbsp;<span class="builtintype" id="3082000">uint32</span><span class="op" id="3082006">(</span><span class="ident" id="3082007">sbox1</span><span class="op" id="3082012">[</span><span class="ident" id="3082013">t3</span><span class="op" id="3082015">&gt;&gt;</span><span class="num" id="3082017">8</span><span class="op" id="3082018">&amp;</span><span class="num" id="3082019">0xff</span><span class="op" id="3082023">]</span><span class="op" id="3082024">)</span><span class="op" id="3082025">&lt;&lt;</span><span class="num" id="3082027">8</span>&nbsp;<span class="op" id="3082029">|</span>&nbsp;<span class="builtintype" id="3082031">uint32</span><span class="op" id="3082037">(</span><span class="ident" id="3082038">sbox1</span><span class="op" id="3082043">[</span><span class="ident" id="3082044">t2</span><span class="op" id="3082046">&amp;</span><span class="num" id="3082047">0xff</span><span class="op" id="3082051">]</span><span class="op" id="3082052">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082055">s2</span>&nbsp;<span class="op" id="3082058">=</span>&nbsp;<span class="builtintype" id="3082060">uint32</span><span class="op" id="3082066">(</span><span class="ident" id="3082067">sbox1</span><span class="op" id="3082072">[</span><span class="ident" id="3082073">t2</span><span class="op" id="3082075">&gt;&gt;</span><span class="num" id="3082077">24</span><span class="op" id="3082079">]</span><span class="op" id="3082080">)</span><span class="op" id="3082081">&lt;&lt;</span><span class="num" id="3082083">24</span>&nbsp;<span class="op" id="3082086">|</span>&nbsp;<span class="builtintype" id="3082088">uint32</span><span class="op" id="3082094">(</span><span class="ident" id="3082095">sbox1</span><span class="op" id="3082100">[</span><span class="ident" id="3082101">t1</span><span class="op" id="3082103">&gt;&gt;</span><span class="num" id="3082105">16</span><span class="op" id="3082107">&amp;</span><span class="num" id="3082108">0xff</span><span class="op" id="3082112">]</span><span class="op" id="3082113">)</span><span class="op" id="3082114">&lt;&lt;</span><span class="num" id="3082116">16</span>&nbsp;<span class="op" id="3082119">|</span>&nbsp;<span class="builtintype" id="3082121">uint32</span><span class="op" id="3082127">(</span><span class="ident" id="3082128">sbox1</span><span class="op" id="3082133">[</span><span class="ident" id="3082134">t0</span><span class="op" id="3082136">&gt;&gt;</span><span class="num" id="3082138">8</span><span class="op" id="3082139">&amp;</span><span class="num" id="3082140">0xff</span><span class="op" id="3082144">]</span><span class="op" id="3082145">)</span><span class="op" id="3082146">&lt;&lt;</span><span class="num" id="3082148">8</span>&nbsp;<span class="op" id="3082150">|</span>&nbsp;<span class="builtintype" id="3082152">uint32</span><span class="op" id="3082158">(</span><span class="ident" id="3082159">sbox1</span><span class="op" id="3082164">[</span><span class="ident" id="3082165">t3</span><span class="op" id="3082167">&amp;</span><span class="num" id="3082168">0xff</span><span class="op" id="3082172">]</span><span class="op" id="3082173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082176">s3</span>&nbsp;<span class="op" id="3082179">=</span>&nbsp;<span class="builtintype" id="3082181">uint32</span><span class="op" id="3082187">(</span><span class="ident" id="3082188">sbox1</span><span class="op" id="3082193">[</span><span class="ident" id="3082194">t3</span><span class="op" id="3082196">&gt;&gt;</span><span class="num" id="3082198">24</span><span class="op" id="3082200">]</span><span class="op" id="3082201">)</span><span class="op" id="3082202">&lt;&lt;</span><span class="num" id="3082204">24</span>&nbsp;<span class="op" id="3082207">|</span>&nbsp;<span class="builtintype" id="3082209">uint32</span><span class="op" id="3082215">(</span><span class="ident" id="3082216">sbox1</span><span class="op" id="3082221">[</span><span class="ident" id="3082222">t2</span><span class="op" id="3082224">&gt;&gt;</span><span class="num" id="3082226">16</span><span class="op" id="3082228">&amp;</span><span class="num" id="3082229">0xff</span><span class="op" id="3082233">]</span><span class="op" id="3082234">)</span><span class="op" id="3082235">&lt;&lt;</span><span class="num" id="3082237">16</span>&nbsp;<span class="op" id="3082240">|</span>&nbsp;<span class="builtintype" id="3082242">uint32</span><span class="op" id="3082248">(</span><span class="ident" id="3082249">sbox1</span><span class="op" id="3082254">[</span><span class="ident" id="3082255">t1</span><span class="op" id="3082257">&gt;&gt;</span><span class="num" id="3082259">8</span><span class="op" id="3082260">&amp;</span><span class="num" id="3082261">0xff</span><span class="op" id="3082265">]</span><span class="op" id="3082266">)</span><span class="op" id="3082267">&lt;&lt;</span><span class="num" id="3082269">8</span>&nbsp;<span class="op" id="3082271">|</span>&nbsp;<span class="builtintype" id="3082273">uint32</span><span class="op" id="3082279">(</span><span class="ident" id="3082280">sbox1</span><span class="op" id="3082285">[</span><span class="ident" id="3082286">t0</span><span class="op" id="3082288">&amp;</span><span class="num" id="3082289">0xff</span><span class="op" id="3082293">]</span><span class="op" id="3082294">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082298">s0</span>&nbsp;<span class="op" id="3082301">^=</span>&nbsp;<span class="ident" id="3082304">xk</span><span class="op" id="3082306">[</span><span class="ident" id="3082307">k</span><span class="op" id="3082308">+</span><span class="num" id="3082309">0</span><span class="op" id="3082310">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082313">s1</span>&nbsp;<span class="op" id="3082316">^=</span>&nbsp;<span class="ident" id="3082319">xk</span><span class="op" id="3082321">[</span><span class="ident" id="3082322">k</span><span class="op" id="3082323">+</span><span class="num" id="3082324">1</span><span class="op" id="3082325">]</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082328">s2</span>&nbsp;<span class="op" id="3082331">^=</span>&nbsp;<span class="ident" id="3082334">xk</span><span class="op" id="3082336">[</span><span class="ident" id="3082337">k</span><span class="op" id="3082338">+</span><span class="num" id="3082339">2</span><span class="op" id="3082340">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082343">s3</span>&nbsp;<span class="op" id="3082346">^=</span>&nbsp;<span class="ident" id="3082349">xk</span><span class="op" id="3082351">[</span><span class="ident" id="3082352">k</span><span class="op" id="3082353">+</span><span class="num" id="3082354">3</span><span class="op" id="3082355">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082359">dst</span><span class="op" id="3082362">[</span><span class="num" id="3082363">0</span><span class="op" id="3082364">]</span><span class="op" id="3082365">,</span>&nbsp;<span class="ident" id="3082367">dst</span><span class="op" id="3082370">[</span><span class="num" id="3082371">1</span><span class="op" id="3082372">]</span><span class="op" id="3082373">,</span>&nbsp;<span class="ident" id="3082375">dst</span><span class="op" id="3082378">[</span><span class="num" id="3082379">2</span><span class="op" id="3082380">]</span><span class="op" id="3082381">,</span>&nbsp;<span class="ident" id="3082383">dst</span><span class="op" id="3082386">[</span><span class="num" id="3082387">3</span><span class="op" id="3082388">]</span>&nbsp;<span class="op" id="3082390">=</span>&nbsp;<span class="builtintype" id="3082392">byte</span><span class="op" id="3082396">(</span><span class="ident" id="3082397">s0</span><span class="op" id="3082399">&gt;&gt;</span><span class="num" id="3082401">24</span><span class="op" id="3082403">)</span><span class="op" id="3082404">,</span>&nbsp;<span class="builtintype" id="3082406">byte</span><span class="op" id="3082410">(</span><span class="ident" id="3082411">s0</span><span class="op" id="3082413">&gt;&gt;</span><span class="num" id="3082415">16</span><span class="op" id="3082417">)</span><span class="op" id="3082418">,</span>&nbsp;<span class="builtintype" id="3082420">byte</span><span class="op" id="3082424">(</span><span class="ident" id="3082425">s0</span><span class="op" id="3082427">&gt;&gt;</span><span class="num" id="3082429">8</span><span class="op" id="3082430">)</span><span class="op" id="3082431">,</span>&nbsp;<span class="builtintype" id="3082433">byte</span><span class="op" id="3082437">(</span><span class="ident" id="3082438">s0</span><span class="op" id="3082440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082443">dst</span><span class="op" id="3082446">[</span><span class="num" id="3082447">4</span><span class="op" id="3082448">]</span><span class="op" id="3082449">,</span>&nbsp;<span class="ident" id="3082451">dst</span><span class="op" id="3082454">[</span><span class="num" id="3082455">5</span><span class="op" id="3082456">]</span><span class="op" id="3082457">,</span>&nbsp;<span class="ident" id="3082459">dst</span><span class="op" id="3082462">[</span><span class="num" id="3082463">6</span><span class="op" id="3082464">]</span><span class="op" id="3082465">,</span>&nbsp;<span class="ident" id="3082467">dst</span><span class="op" id="3082470">[</span><span class="num" id="3082471">7</span><span class="op" id="3082472">]</span>&nbsp;<span class="op" id="3082474">=</span>&nbsp;<span class="builtintype" id="3082476">byte</span><span class="op" id="3082480">(</span><span class="ident" id="3082481">s1</span><span class="op" id="3082483">&gt;&gt;</span><span class="num" id="3082485">24</span><span class="op" id="3082487">)</span><span class="op" id="3082488">,</span>&nbsp;<span class="builtintype" id="3082490">byte</span><span class="op" id="3082494">(</span><span class="ident" id="3082495">s1</span><span class="op" id="3082497">&gt;&gt;</span><span class="num" id="3082499">16</span><span class="op" id="3082501">)</span><span class="op" id="3082502">,</span>&nbsp;<span class="builtintype" id="3082504">byte</span><span class="op" id="3082508">(</span><span class="ident" id="3082509">s1</span><span class="op" id="3082511">&gt;&gt;</span><span class="num" id="3082513">8</span><span class="op" id="3082514">)</span><span class="op" id="3082515">,</span>&nbsp;<span class="builtintype" id="3082517">byte</span><span class="op" id="3082521">(</span><span class="ident" id="3082522">s1</span><span class="op" id="3082524">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082527">dst</span><span class="op" id="3082530">[</span><span class="num" id="3082531">8</span><span class="op" id="3082532">]</span><span class="op" id="3082533">,</span>&nbsp;<span class="ident" id="3082535">dst</span><span class="op" id="3082538">[</span><span class="num" id="3082539">9</span><span class="op" id="3082540">]</span><span class="op" id="3082541">,</span>&nbsp;<span class="ident" id="3082543">dst</span><span class="op" id="3082546">[</span><span class="num" id="3082547">10</span><span class="op" id="3082549">]</span><span class="op" id="3082550">,</span>&nbsp;<span class="ident" id="3082552">dst</span><span class="op" id="3082555">[</span><span class="num" id="3082556">11</span><span class="op" id="3082558">]</span>&nbsp;<span class="op" id="3082560">=</span>&nbsp;<span class="builtintype" id="3082562">byte</span><span class="op" id="3082566">(</span><span class="ident" id="3082567">s2</span><span class="op" id="3082569">&gt;&gt;</span><span class="num" id="3082571">24</span><span class="op" id="3082573">)</span><span class="op" id="3082574">,</span>&nbsp;<span class="builtintype" id="3082576">byte</span><span class="op" id="3082580">(</span><span class="ident" id="3082581">s2</span><span class="op" id="3082583">&gt;&gt;</span><span class="num" id="3082585">16</span><span class="op" id="3082587">)</span><span class="op" id="3082588">,</span>&nbsp;<span class="builtintype" id="3082590">byte</span><span class="op" id="3082594">(</span><span class="ident" id="3082595">s2</span><span class="op" id="3082597">&gt;&gt;</span><span class="num" id="3082599">8</span><span class="op" id="3082600">)</span><span class="op" id="3082601">,</span>&nbsp;<span class="builtintype" id="3082603">byte</span><span class="op" id="3082607">(</span><span class="ident" id="3082608">s2</span><span class="op" id="3082610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082613">dst</span><span class="op" id="3082616">[</span><span class="num" id="3082617">12</span><span class="op" id="3082619">]</span><span class="op" id="3082620">,</span>&nbsp;<span class="ident" id="3082622">dst</span><span class="op" id="3082625">[</span><span class="num" id="3082626">13</span><span class="op" id="3082628">]</span><span class="op" id="3082629">,</span>&nbsp;<span class="ident" id="3082631">dst</span><span class="op" id="3082634">[</span><span class="num" id="3082635">14</span><span class="op" id="3082637">]</span><span class="op" id="3082638">,</span>&nbsp;<span class="ident" id="3082640">dst</span><span class="op" id="3082643">[</span><span class="num" id="3082644">15</span><span class="op" id="3082646">]</span>&nbsp;<span class="op" id="3082648">=</span>&nbsp;<span class="builtintype" id="3082650">byte</span><span class="op" id="3082654">(</span><span class="ident" id="3082655">s3</span><span class="op" id="3082657">&gt;&gt;</span><span class="num" id="3082659">24</span><span class="op" id="3082661">)</span><span class="op" id="3082662">,</span>&nbsp;<span class="builtintype" id="3082664">byte</span><span class="op" id="3082668">(</span><span class="ident" id="3082669">s3</span><span class="op" id="3082671">&gt;&gt;</span><span class="num" id="3082673">16</span><span class="op" id="3082675">)</span><span class="op" id="3082676">,</span>&nbsp;<span class="builtintype" id="3082678">byte</span><span class="op" id="3082682">(</span><span class="ident" id="3082683">s3</span><span class="op" id="3082685">&gt;&gt;</span><span class="num" id="3082687">8</span><span class="op" id="3082688">)</span><span class="op" id="3082689">,</span>&nbsp;<span class="builtintype" id="3082691">byte</span><span class="op" id="3082695">(</span><span class="ident" id="3082696">s3</span><span class="op" id="3082698">)</span><br>
<span class="lineno"></span><span class="op" id="3082700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3082703">//&nbsp;Apply&nbsp;sbox0&nbsp;to&nbsp;each&nbsp;byte&nbsp;in&nbsp;w.</span><br>
<span class="lineno">130</span><span class="keyword" id="3082737">func</span>&nbsp;<span class="ident" id="3082742">subw</span><span class="op" id="3082746">(</span><span class="ident" id="3082747">w</span>&nbsp;<span class="builtintype" id="3082749">uint32</span><span class="op" id="3082755">)</span>&nbsp;<span class="builtintype" id="3082757">uint32</span>&nbsp;<span class="op" id="3082764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3082767">return</span>&nbsp;<span class="builtintype" id="3082774">uint32</span><span class="op" id="3082780">(</span><span class="ident" id="3082781">sbox0</span><span class="op" id="3082786">[</span><span class="ident" id="3082787">w</span><span class="op" id="3082788">&gt;&gt;</span><span class="num" id="3082790">24</span><span class="op" id="3082792">]</span><span class="op" id="3082793">)</span><span class="op" id="3082794">&lt;&lt;</span><span class="num" id="3082796">24</span>&nbsp;<span class="op" id="3082799">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3082803">uint32</span><span class="op" id="3082809">(</span><span class="ident" id="3082810">sbox0</span><span class="op" id="3082815">[</span><span class="ident" id="3082816">w</span><span class="op" id="3082817">&gt;&gt;</span><span class="num" id="3082819">16</span><span class="op" id="3082821">&amp;</span><span class="num" id="3082822">0xff</span><span class="op" id="3082826">]</span><span class="op" id="3082827">)</span><span class="op" id="3082828">&lt;&lt;</span><span class="num" id="3082830">16</span>&nbsp;<span class="op" id="3082833">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3082837">uint32</span><span class="op" id="3082843">(</span><span class="ident" id="3082844">sbox0</span><span class="op" id="3082849">[</span><span class="ident" id="3082850">w</span><span class="op" id="3082851">&gt;&gt;</span><span class="num" id="3082853">8</span><span class="op" id="3082854">&amp;</span><span class="num" id="3082855">0xff</span><span class="op" id="3082859">]</span><span class="op" id="3082860">)</span><span class="op" id="3082861">&lt;&lt;</span><span class="num" id="3082863">8</span>&nbsp;<span class="op" id="3082865">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3082869">uint32</span><span class="op" id="3082875">(</span><span class="ident" id="3082876">sbox0</span><span class="op" id="3082881">[</span><span class="ident" id="3082882">w</span><span class="op" id="3082883">&amp;</span><span class="num" id="3082884">0xff</span><span class="op" id="3082888">]</span><span class="op" id="3082889">)</span><br>
<span class="lineno">135</span><span class="op" id="3082891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3082894">//&nbsp;Rotate</span><br>
<span class="lineno"></span><span class="keyword" id="3082904">func</span>&nbsp;<span class="ident" id="3082909">rotw</span><span class="op" id="3082913">(</span><span class="ident" id="3082914">w</span>&nbsp;<span class="builtintype" id="3082916">uint32</span><span class="op" id="3082922">)</span>&nbsp;<span class="builtintype" id="3082924">uint32</span>&nbsp;<span class="op" id="3082931">{</span>&nbsp;<span class="keyword" id="3082933">return</span>&nbsp;<span class="ident" id="3082940">w</span><span class="op" id="3082941">&lt;&lt;</span><span class="num" id="3082943">8</span>&nbsp;<span class="op" id="3082945">|</span>&nbsp;<span class="ident" id="3082947">w</span><span class="op" id="3082948">&gt;&gt;</span><span class="num" id="3082950">24</span>&nbsp;<span class="op" id="3082953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="3082956">//&nbsp;Key&nbsp;expansion&nbsp;algorithm.&nbsp;&nbsp;See&nbsp;FIPS-197,&nbsp;Figure&nbsp;11.</span><br>
<span class="lineno"></span><span class="comment" id="3083010">//&nbsp;Their&nbsp;rcon[i]&nbsp;is&nbsp;our&nbsp;powx[i-1]&nbsp;&lt;&lt;&nbsp;24.</span><br>
<span class="lineno"></span><span class="keyword" id="3083051">func</span>&nbsp;<span class="ident" id="3083056">expandKeyGo</span><span class="op" id="3083067">(</span><span class="ident" id="3083068">key</span>&nbsp;<span class="op" id="3083072">[</span><span class="op" id="3083073">]</span><span class="builtintype" id="3083074">byte</span><span class="op" id="3083078">,</span>&nbsp;<span class="ident" id="3083080">enc</span><span class="op" id="3083083">,</span>&nbsp;<span class="ident" id="3083085">dec</span>&nbsp;<span class="op" id="3083089">[</span><span class="op" id="3083090">]</span><span class="builtintype" id="3083091">uint32</span><span class="op" id="3083097">)</span>&nbsp;<span class="op" id="3083099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3083102">//&nbsp;Encryption&nbsp;key&nbsp;setup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083128">var</span>&nbsp;<span class="ident" id="3083132">i</span>&nbsp;<span class="builtintype" id="3083134">int</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083139">nk</span>&nbsp;<span class="op" id="3083142">:=</span>&nbsp;<span class="builtinfunc" id="3083145">len</span><span class="op" id="3083148">(</span><span class="ident" id="3083149">key</span><span class="op" id="3083152">)</span>&nbsp;<span class="op" id="3083154">/</span>&nbsp;<span class="num" id="3083156">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083159">for</span>&nbsp;<span class="ident" id="3083163">i</span>&nbsp;<span class="op" id="3083165">=</span>&nbsp;<span class="num" id="3083167">0</span><span class="op" id="3083168">;</span>&nbsp;<span class="ident" id="3083170">i</span>&nbsp;<span class="op" id="3083172">&lt;</span>&nbsp;<span class="ident" id="3083174">nk</span><span class="op" id="3083176">;</span>&nbsp;<span class="ident" id="3083178">i</span><span class="op" id="3083179">++</span>&nbsp;<span class="op" id="3083182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083186">enc</span><span class="op" id="3083189">[</span><span class="ident" id="3083190">i</span><span class="op" id="3083191">]</span>&nbsp;<span class="op" id="3083193">=</span>&nbsp;<span class="builtintype" id="3083195">uint32</span><span class="op" id="3083201">(</span><span class="ident" id="3083202">key</span><span class="op" id="3083205">[</span><span class="num" id="3083206">4</span><span class="op" id="3083207">*</span><span class="ident" id="3083208">i</span><span class="op" id="3083209">]</span><span class="op" id="3083210">)</span><span class="op" id="3083211">&lt;&lt;</span><span class="num" id="3083213">24</span>&nbsp;<span class="op" id="3083216">|</span>&nbsp;<span class="builtintype" id="3083218">uint32</span><span class="op" id="3083224">(</span><span class="ident" id="3083225">key</span><span class="op" id="3083228">[</span><span class="num" id="3083229">4</span><span class="op" id="3083230">*</span><span class="ident" id="3083231">i</span><span class="op" id="3083232">+</span><span class="num" id="3083233">1</span><span class="op" id="3083234">]</span><span class="op" id="3083235">)</span><span class="op" id="3083236">&lt;&lt;</span><span class="num" id="3083238">16</span>&nbsp;<span class="op" id="3083241">|</span>&nbsp;<span class="builtintype" id="3083243">uint32</span><span class="op" id="3083249">(</span><span class="ident" id="3083250">key</span><span class="op" id="3083253">[</span><span class="num" id="3083254">4</span><span class="op" id="3083255">*</span><span class="ident" id="3083256">i</span><span class="op" id="3083257">+</span><span class="num" id="3083258">2</span><span class="op" id="3083259">]</span><span class="op" id="3083260">)</span><span class="op" id="3083261">&lt;&lt;</span><span class="num" id="3083263">8</span>&nbsp;<span class="op" id="3083265">|</span>&nbsp;<span class="builtintype" id="3083267">uint32</span><span class="op" id="3083273">(</span><span class="ident" id="3083274">key</span><span class="op" id="3083277">[</span><span class="num" id="3083278">4</span><span class="op" id="3083279">*</span><span class="ident" id="3083280">i</span><span class="op" id="3083281">+</span><span class="num" id="3083282">3</span><span class="op" id="3083283">]</span><span class="op" id="3083284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083290">for</span>&nbsp;<span class="op" id="3083294">;</span>&nbsp;<span class="ident" id="3083296">i</span>&nbsp;<span class="op" id="3083298">&lt;</span>&nbsp;<span class="builtinfunc" id="3083300">len</span><span class="op" id="3083303">(</span><span class="ident" id="3083304">enc</span><span class="op" id="3083307">)</span><span class="op" id="3083308">;</span>&nbsp;<span class="ident" id="3083310">i</span><span class="op" id="3083311">++</span>&nbsp;<span class="op" id="3083314">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083318">t</span>&nbsp;<span class="op" id="3083320">:=</span>&nbsp;<span class="ident" id="3083323">enc</span><span class="op" id="3083326">[</span><span class="ident" id="3083327">i</span><span class="op" id="3083328">-</span><span class="num" id="3083329">1</span><span class="op" id="3083330">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083334">if</span>&nbsp;<span class="ident" id="3083337">i</span><span class="op" id="3083338">%</span><span class="ident" id="3083339">nk</span>&nbsp;<span class="op" id="3083342">==</span>&nbsp;<span class="num" id="3083345">0</span>&nbsp;<span class="op" id="3083347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083352">t</span>&nbsp;<span class="op" id="3083354">=</span>&nbsp;<span class="ident" id="3083356">subw</span><span class="op" id="3083360">(</span><span class="ident" id="3083361">rotw</span><span class="op" id="3083365">(</span><span class="ident" id="3083366">t</span><span class="op" id="3083367">)</span><span class="op" id="3083368">)</span>&nbsp;<span class="op" id="3083370">^</span>&nbsp;<span class="op" id="3083372">(</span><span class="builtintype" id="3083373">uint32</span><span class="op" id="3083379">(</span><span class="ident" id="3083380">powx</span><span class="op" id="3083384">[</span><span class="ident" id="3083385">i</span><span class="op" id="3083386">/</span><span class="ident" id="3083387">nk</span><span class="op" id="3083389">-</span><span class="num" id="3083390">1</span><span class="op" id="3083391">]</span><span class="op" id="3083392">)</span>&nbsp;<span class="op" id="3083394">&lt;&lt;</span>&nbsp;<span class="num" id="3083397">24</span><span class="op" id="3083399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083403">}</span>&nbsp;<span class="keyword" id="3083405">else</span>&nbsp;<span class="keyword" id="3083410">if</span>&nbsp;<span class="ident" id="3083413">nk</span>&nbsp;<span class="op" id="3083416">&gt;</span>&nbsp;<span class="num" id="3083418">6</span>&nbsp;<span class="op" id="3083420">&amp;&amp;</span>&nbsp;<span class="ident" id="3083423">i</span><span class="op" id="3083424">%</span><span class="ident" id="3083425">nk</span>&nbsp;<span class="op" id="3083428">==</span>&nbsp;<span class="num" id="3083431">4</span>&nbsp;<span class="op" id="3083433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083438">t</span>&nbsp;<span class="op" id="3083440">=</span>&nbsp;<span class="ident" id="3083442">subw</span><span class="op" id="3083446">(</span><span class="ident" id="3083447">t</span><span class="op" id="3083448">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083456">enc</span><span class="op" id="3083459">[</span><span class="ident" id="3083460">i</span><span class="op" id="3083461">]</span>&nbsp;<span class="op" id="3083463">=</span>&nbsp;<span class="ident" id="3083465">enc</span><span class="op" id="3083468">[</span><span class="ident" id="3083469">i</span><span class="op" id="3083470">-</span><span class="ident" id="3083471">nk</span><span class="op" id="3083473">]</span>&nbsp;<span class="op" id="3083475">^</span>&nbsp;<span class="ident" id="3083477">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3083484">//&nbsp;Derive&nbsp;decryption&nbsp;key&nbsp;from&nbsp;encryption&nbsp;key.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3083531">//&nbsp;Reverse&nbsp;the&nbsp;4-word&nbsp;round&nbsp;key&nbsp;sets&nbsp;from&nbsp;enc&nbsp;to&nbsp;produce&nbsp;dec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3083594">//&nbsp;All&nbsp;sets&nbsp;but&nbsp;the&nbsp;first&nbsp;and&nbsp;last&nbsp;get&nbsp;the&nbsp;MixColumn&nbsp;transform&nbsp;applied.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083667">if</span>&nbsp;<span class="ident" id="3083670">dec</span>&nbsp;<span class="op" id="3083674">==</span>&nbsp;<span class="builtintype" id="3083677">nil</span>&nbsp;<span class="op" id="3083681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083685">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083693">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083696">n</span>&nbsp;<span class="op" id="3083698">:=</span>&nbsp;<span class="builtinfunc" id="3083701">len</span><span class="op" id="3083704">(</span><span class="ident" id="3083705">enc</span><span class="op" id="3083708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083711">for</span>&nbsp;<span class="ident" id="3083715">i</span>&nbsp;<span class="op" id="3083717">:=</span>&nbsp;<span class="num" id="3083720">0</span><span class="op" id="3083721">;</span>&nbsp;<span class="ident" id="3083723">i</span>&nbsp;<span class="op" id="3083725">&lt;</span>&nbsp;<span class="ident" id="3083727">n</span><span class="op" id="3083728">;</span>&nbsp;<span class="ident" id="3083730">i</span>&nbsp;<span class="op" id="3083732">+=</span>&nbsp;<span class="num" id="3083735">4</span>&nbsp;<span class="op" id="3083737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083741">ei</span>&nbsp;<span class="op" id="3083744">:=</span>&nbsp;<span class="ident" id="3083747">n</span>&nbsp;<span class="op" id="3083749">-</span>&nbsp;<span class="ident" id="3083751">i</span>&nbsp;<span class="op" id="3083753">-</span>&nbsp;<span class="num" id="3083755">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083759">for</span>&nbsp;<span class="ident" id="3083763">j</span>&nbsp;<span class="op" id="3083765">:=</span>&nbsp;<span class="num" id="3083768">0</span><span class="op" id="3083769">;</span>&nbsp;<span class="ident" id="3083771">j</span>&nbsp;<span class="op" id="3083773">&lt;</span>&nbsp;<span class="num" id="3083775">4</span><span class="op" id="3083776">;</span>&nbsp;<span class="ident" id="3083778">j</span><span class="op" id="3083779">++</span>&nbsp;<span class="op" id="3083782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083787">x</span>&nbsp;<span class="op" id="3083789">:=</span>&nbsp;<span class="ident" id="3083792">enc</span><span class="op" id="3083795">[</span><span class="ident" id="3083796">ei</span><span class="op" id="3083798">+</span><span class="ident" id="3083799">j</span><span class="op" id="3083800">]</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083805">if</span>&nbsp;<span class="ident" id="3083808">i</span>&nbsp;<span class="op" id="3083810">&gt;</span>&nbsp;<span class="num" id="3083812">0</span>&nbsp;<span class="op" id="3083814">&amp;&amp;</span>&nbsp;<span class="ident" id="3083817">i</span><span class="op" id="3083818">+</span><span class="num" id="3083819">4</span>&nbsp;<span class="op" id="3083821">&lt;</span>&nbsp;<span class="ident" id="3083823">n</span>&nbsp;<span class="op" id="3083825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083831">x</span>&nbsp;<span class="op" id="3083833">=</span>&nbsp;<span class="ident" id="3083835">td0</span><span class="op" id="3083838">[</span><span class="ident" id="3083839">sbox0</span><span class="op" id="3083844">[</span><span class="ident" id="3083845">x</span><span class="op" id="3083846">&gt;&gt;</span><span class="num" id="3083848">24</span><span class="op" id="3083850">]</span><span class="op" id="3083851">]</span>&nbsp;<span class="op" id="3083853">^</span>&nbsp;<span class="ident" id="3083855">td1</span><span class="op" id="3083858">[</span><span class="ident" id="3083859">sbox0</span><span class="op" id="3083864">[</span><span class="ident" id="3083865">x</span><span class="op" id="3083866">&gt;&gt;</span><span class="num" id="3083868">16</span><span class="op" id="3083870">&amp;</span><span class="num" id="3083871">0xff</span><span class="op" id="3083875">]</span><span class="op" id="3083876">]</span>&nbsp;<span class="op" id="3083878">^</span>&nbsp;<span class="ident" id="3083880">td2</span><span class="op" id="3083883">[</span><span class="ident" id="3083884">sbox0</span><span class="op" id="3083889">[</span><span class="ident" id="3083890">x</span><span class="op" id="3083891">&gt;&gt;</span><span class="num" id="3083893">8</span><span class="op" id="3083894">&amp;</span><span class="num" id="3083895">0xff</span><span class="op" id="3083899">]</span><span class="op" id="3083900">]</span>&nbsp;<span class="op" id="3083902">^</span>&nbsp;<span class="ident" id="3083904">td3</span><span class="op" id="3083907">[</span><span class="ident" id="3083908">sbox0</span><span class="op" id="3083913">[</span><span class="ident" id="3083914">x</span><span class="op" id="3083915">&amp;</span><span class="num" id="3083916">0xff</span><span class="op" id="3083920">]</span><span class="op" id="3083921">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083931">dec</span><span class="op" id="3083934">[</span><span class="ident" id="3083935">i</span><span class="op" id="3083936">+</span><span class="ident" id="3083937">j</span><span class="op" id="3083938">]</span>&nbsp;<span class="op" id="3083940">=</span>&nbsp;<span class="ident" id="3083942">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083946">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083949">}</span><br>
<span class="lineno"></span><span class="op" id="3083951">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
