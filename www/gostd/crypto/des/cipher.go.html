<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html" class="current">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4656938">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4656993">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4657047">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4657098">package</span>&nbsp;<span class="ident" id="4657106">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4657111">import</span>&nbsp;<span class="op" id="4657118">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4657121">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4657138">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4657148">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4657151">//&nbsp;The&nbsp;DES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4657183">const</span>&nbsp;<span class="ident" id="4657189">BlockSize</span>&nbsp;<span class="op" id="4657199">=</span>&nbsp;<span class="num" id="4657201">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4657204">type</span>&nbsp;<span class="ident" id="4657209">KeySizeError</span>&nbsp;<span class="builtintype" id="4657222">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4657227">func</span>&nbsp;<span class="op" id="4657232">(</span><span class="ident" id="4657233">k</span>&nbsp;<span class="ident" id="4657235">KeySizeError</span><span class="op" id="4657247">)</span>&nbsp;<span class="ident" id="4657249">Error</span><span class="op" id="4657254">(</span><span class="op" id="4657255">)</span>&nbsp;<span class="builtintype" id="4657257">string</span>&nbsp;<span class="op" id="4657264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4657267">return</span>&nbsp;<span class="string" id="4657274">&#34;crypto/des:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="4657306">+</span>&nbsp;<span class="ident" id="4657308">strconv</span><span class="op" id="4657315">.</span><span class="ident" id="4657316">Itoa</span><span class="op" id="4657320">(</span><span class="builtintype" id="4657321">int</span><span class="op" id="4657324">(</span><span class="ident" id="4657325">k</span><span class="op" id="4657326">)</span><span class="op" id="4657327">)</span><br>
<span class="lineno"></span><span class="op" id="4657329">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4657332">//&nbsp;desCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;DES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4657379">type</span>&nbsp;<span class="ident" id="4657384">desCipher</span>&nbsp;<span class="keyword" id="4657394">struct</span>&nbsp;<span class="op" id="4657401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657404">subkeys</span>&nbsp;<span class="op" id="4657412">[</span><span class="num" id="4657413">16</span><span class="op" id="4657415">]</span><span class="ident" id="4657416">uint64</span><br>
<span class="lineno"></span><span class="op" id="4657423">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4657426">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4657479">func</span>&nbsp;<span class="ident" id="4657484">NewCipher</span><span class="op" id="4657493">(</span><span class="ident" id="4657494">key</span>&nbsp;<span class="op" id="4657498">[</span><span class="op" id="4657499">]</span><span class="builtintype" id="4657500">byte</span><span class="op" id="4657504">)</span>&nbsp;<span class="op" id="4657506">(</span><span class="ident" id="4657507">cipher</span><span class="op" id="4657513">.</span><span class="ident" id="4657514">Block</span><span class="op" id="4657519">,</span>&nbsp;<span class="builtintype" id="4657521">error</span><span class="op" id="4657526">)</span>&nbsp;<span class="op" id="4657528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4657531">if</span>&nbsp;<span class="builtinfunc" id="4657534">len</span><span class="op" id="4657537">(</span><span class="ident" id="4657538">key</span><span class="op" id="4657541">)</span>&nbsp;<span class="op" id="4657543">!=</span>&nbsp;<span class="num" id="4657546">8</span>&nbsp;<span class="op" id="4657548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4657552">return</span>&nbsp;<span class="ident" id="4657559">nil</span><span class="op" id="4657562">,</span>&nbsp;<span class="ident" id="4657564">KeySizeError</span><span class="op" id="4657576">(</span><span class="builtinfunc" id="4657577">len</span><span class="op" id="4657580">(</span><span class="ident" id="4657581">key</span><span class="op" id="4657584">)</span><span class="op" id="4657585">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4657588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657592">c</span>&nbsp;<span class="op" id="4657594">:=</span>&nbsp;<span class="builtinfunc" id="4657597">new</span><span class="op" id="4657600">(</span><span class="ident" id="4657601">desCipher</span><span class="op" id="4657610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657613">c</span><span class="op" id="4657614">.</span><span class="ident" id="4657615">generateSubkeys</span><span class="op" id="4657630">(</span><span class="ident" id="4657631">key</span><span class="op" id="4657634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4657637">return</span>&nbsp;<span class="ident" id="4657644">c</span><span class="op" id="4657645">,</span>&nbsp;<span class="ident" id="4657647">nil</span><br>
<span class="lineno">35</span><span class="op" id="4657651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4657654">func</span>&nbsp;<span class="op" id="4657659">(</span><span class="ident" id="4657660">c</span>&nbsp;<span class="op" id="4657662">*</span><span class="ident" id="4657663">desCipher</span><span class="op" id="4657672">)</span>&nbsp;<span class="ident" id="4657674">BlockSize</span><span class="op" id="4657683">(</span><span class="op" id="4657684">)</span>&nbsp;<span class="builtintype" id="4657686">int</span>&nbsp;<span class="op" id="4657690">{</span>&nbsp;<span class="keyword" id="4657692">return</span>&nbsp;<span class="ident" id="4657699">BlockSize</span>&nbsp;<span class="op" id="4657709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4657712">func</span>&nbsp;<span class="op" id="4657717">(</span><span class="ident" id="4657718">c</span>&nbsp;<span class="op" id="4657720">*</span><span class="ident" id="4657721">desCipher</span><span class="op" id="4657730">)</span>&nbsp;<span class="ident" id="4657732">Encrypt</span><span class="op" id="4657739">(</span><span class="ident" id="4657740">dst</span><span class="op" id="4657743">,</span>&nbsp;<span class="ident" id="4657745">src</span>&nbsp;<span class="op" id="4657749">[</span><span class="op" id="4657750">]</span><span class="builtintype" id="4657751">byte</span><span class="op" id="4657755">)</span>&nbsp;<span class="op" id="4657757">{</span>&nbsp;<span class="ident" id="4657759">encryptBlock</span><span class="op" id="4657771">(</span><span class="ident" id="4657772">c</span><span class="op" id="4657773">.</span><span class="ident" id="4657774">subkeys</span><span class="op" id="4657781">[</span><span class="op" id="4657782">:</span><span class="op" id="4657783">]</span><span class="op" id="4657784">,</span>&nbsp;<span class="ident" id="4657786">dst</span><span class="op" id="4657789">,</span>&nbsp;<span class="ident" id="4657791">src</span><span class="op" id="4657794">)</span>&nbsp;<span class="op" id="4657796">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4657799">func</span>&nbsp;<span class="op" id="4657804">(</span><span class="ident" id="4657805">c</span>&nbsp;<span class="op" id="4657807">*</span><span class="ident" id="4657808">desCipher</span><span class="op" id="4657817">)</span>&nbsp;<span class="ident" id="4657819">Decrypt</span><span class="op" id="4657826">(</span><span class="ident" id="4657827">dst</span><span class="op" id="4657830">,</span>&nbsp;<span class="ident" id="4657832">src</span>&nbsp;<span class="op" id="4657836">[</span><span class="op" id="4657837">]</span><span class="builtintype" id="4657838">byte</span><span class="op" id="4657842">)</span>&nbsp;<span class="op" id="4657844">{</span>&nbsp;<span class="ident" id="4657846">decryptBlock</span><span class="op" id="4657858">(</span><span class="ident" id="4657859">c</span><span class="op" id="4657860">.</span><span class="ident" id="4657861">subkeys</span><span class="op" id="4657868">[</span><span class="op" id="4657869">:</span><span class="op" id="4657870">]</span><span class="op" id="4657871">,</span>&nbsp;<span class="ident" id="4657873">dst</span><span class="op" id="4657876">,</span>&nbsp;<span class="ident" id="4657878">src</span><span class="op" id="4657881">)</span>&nbsp;<span class="op" id="4657883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4657886">//&nbsp;A&nbsp;tripleDESCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;TripleDES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4657947">type</span>&nbsp;<span class="ident" id="4657952">tripleDESCipher</span>&nbsp;<span class="keyword" id="4657968">struct</span>&nbsp;<span class="op" id="4657975">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657978">cipher1</span><span class="op" id="4657985">,</span>&nbsp;<span class="ident" id="4657987">cipher2</span><span class="op" id="4657994">,</span>&nbsp;<span class="ident" id="4657996">cipher3</span>&nbsp;<span class="ident" id="4658004">desCipher</span><br>
<span class="lineno"></span><span class="op" id="4658014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4658017">//&nbsp;NewTripleDESCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4658079">func</span>&nbsp;<span class="ident" id="4658084">NewTripleDESCipher</span><span class="op" id="4658102">(</span><span class="ident" id="4658103">key</span>&nbsp;<span class="op" id="4658107">[</span><span class="op" id="4658108">]</span><span class="builtintype" id="4658109">byte</span><span class="op" id="4658113">)</span>&nbsp;<span class="op" id="4658115">(</span><span class="ident" id="4658116">cipher</span><span class="op" id="4658122">.</span><span class="ident" id="4658123">Block</span><span class="op" id="4658128">,</span>&nbsp;<span class="builtintype" id="4658130">error</span><span class="op" id="4658135">)</span>&nbsp;<span class="op" id="4658137">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658140">if</span>&nbsp;<span class="builtinfunc" id="4658143">len</span><span class="op" id="4658146">(</span><span class="ident" id="4658147">key</span><span class="op" id="4658150">)</span>&nbsp;<span class="op" id="4658152">!=</span>&nbsp;<span class="num" id="4658155">24</span>&nbsp;<span class="op" id="4658158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658162">return</span>&nbsp;<span class="ident" id="4658169">nil</span><span class="op" id="4658172">,</span>&nbsp;<span class="ident" id="4658174">KeySizeError</span><span class="op" id="4658186">(</span><span class="builtinfunc" id="4658187">len</span><span class="op" id="4658190">(</span><span class="ident" id="4658191">key</span><span class="op" id="4658194">)</span><span class="op" id="4658195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4658198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658202">c</span>&nbsp;<span class="op" id="4658204">:=</span>&nbsp;<span class="builtinfunc" id="4658207">new</span><span class="op" id="4658210">(</span><span class="ident" id="4658211">tripleDESCipher</span><span class="op" id="4658226">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658229">c</span><span class="op" id="4658230">.</span><span class="ident" id="4658231">cipher1</span><span class="op" id="4658238">.</span><span class="ident" id="4658239">generateSubkeys</span><span class="op" id="4658254">(</span><span class="ident" id="4658255">key</span><span class="op" id="4658258">[</span><span class="op" id="4658259">:</span><span class="num" id="4658260">8</span><span class="op" id="4658261">]</span><span class="op" id="4658262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658265">c</span><span class="op" id="4658266">.</span><span class="ident" id="4658267">cipher2</span><span class="op" id="4658274">.</span><span class="ident" id="4658275">generateSubkeys</span><span class="op" id="4658290">(</span><span class="ident" id="4658291">key</span><span class="op" id="4658294">[</span><span class="num" id="4658295">8</span><span class="op" id="4658296">:</span><span class="num" id="4658297">16</span><span class="op" id="4658299">]</span><span class="op" id="4658300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658303">c</span><span class="op" id="4658304">.</span><span class="ident" id="4658305">cipher3</span><span class="op" id="4658312">.</span><span class="ident" id="4658313">generateSubkeys</span><span class="op" id="4658328">(</span><span class="ident" id="4658329">key</span><span class="op" id="4658332">[</span><span class="num" id="4658333">16</span><span class="op" id="4658335">:</span><span class="op" id="4658336">]</span><span class="op" id="4658337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658340">return</span>&nbsp;<span class="ident" id="4658347">c</span><span class="op" id="4658348">,</span>&nbsp;<span class="ident" id="4658350">nil</span><br>
<span class="lineno"></span><span class="op" id="4658354">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4658357">func</span>&nbsp;<span class="op" id="4658362">(</span><span class="ident" id="4658363">c</span>&nbsp;<span class="op" id="4658365">*</span><span class="ident" id="4658366">tripleDESCipher</span><span class="op" id="4658381">)</span>&nbsp;<span class="ident" id="4658383">BlockSize</span><span class="op" id="4658392">(</span><span class="op" id="4658393">)</span>&nbsp;<span class="builtintype" id="4658395">int</span>&nbsp;<span class="op" id="4658399">{</span>&nbsp;<span class="keyword" id="4658401">return</span>&nbsp;<span class="ident" id="4658408">BlockSize</span>&nbsp;<span class="op" id="4658418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4658421">func</span>&nbsp;<span class="op" id="4658426">(</span><span class="ident" id="4658427">c</span>&nbsp;<span class="op" id="4658429">*</span><span class="ident" id="4658430">tripleDESCipher</span><span class="op" id="4658445">)</span>&nbsp;<span class="ident" id="4658447">Encrypt</span><span class="op" id="4658454">(</span><span class="ident" id="4658455">dst</span><span class="op" id="4658458">,</span>&nbsp;<span class="ident" id="4658460">src</span>&nbsp;<span class="op" id="4658464">[</span><span class="op" id="4658465">]</span><span class="builtintype" id="4658466">byte</span><span class="op" id="4658470">)</span>&nbsp;<span class="op" id="4658472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658475">c</span><span class="op" id="4658476">.</span><span class="ident" id="4658477">cipher1</span><span class="op" id="4658484">.</span><span class="ident" id="4658485">Encrypt</span><span class="op" id="4658492">(</span><span class="ident" id="4658493">dst</span><span class="op" id="4658496">,</span>&nbsp;<span class="ident" id="4658498">src</span><span class="op" id="4658501">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658504">c</span><span class="op" id="4658505">.</span><span class="ident" id="4658506">cipher2</span><span class="op" id="4658513">.</span><span class="ident" id="4658514">Decrypt</span><span class="op" id="4658521">(</span><span class="ident" id="4658522">dst</span><span class="op" id="4658525">,</span>&nbsp;<span class="ident" id="4658527">dst</span><span class="op" id="4658530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658533">c</span><span class="op" id="4658534">.</span><span class="ident" id="4658535">cipher3</span><span class="op" id="4658542">.</span><span class="ident" id="4658543">Encrypt</span><span class="op" id="4658550">(</span><span class="ident" id="4658551">dst</span><span class="op" id="4658554">,</span>&nbsp;<span class="ident" id="4658556">dst</span><span class="op" id="4658559">)</span><br>
<span class="lineno"></span><span class="op" id="4658561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4658564">func</span>&nbsp;<span class="op" id="4658569">(</span><span class="ident" id="4658570">c</span>&nbsp;<span class="op" id="4658572">*</span><span class="ident" id="4658573">tripleDESCipher</span><span class="op" id="4658588">)</span>&nbsp;<span class="ident" id="4658590">Decrypt</span><span class="op" id="4658597">(</span><span class="ident" id="4658598">dst</span><span class="op" id="4658601">,</span>&nbsp;<span class="ident" id="4658603">src</span>&nbsp;<span class="op" id="4658607">[</span><span class="op" id="4658608">]</span><span class="builtintype" id="4658609">byte</span><span class="op" id="4658613">)</span>&nbsp;<span class="op" id="4658615">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658618">c</span><span class="op" id="4658619">.</span><span class="ident" id="4658620">cipher3</span><span class="op" id="4658627">.</span><span class="ident" id="4658628">Decrypt</span><span class="op" id="4658635">(</span><span class="ident" id="4658636">dst</span><span class="op" id="4658639">,</span>&nbsp;<span class="ident" id="4658641">src</span><span class="op" id="4658644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658647">c</span><span class="op" id="4658648">.</span><span class="ident" id="4658649">cipher2</span><span class="op" id="4658656">.</span><span class="ident" id="4658657">Encrypt</span><span class="op" id="4658664">(</span><span class="ident" id="4658665">dst</span><span class="op" id="4658668">,</span>&nbsp;<span class="ident" id="4658670">dst</span><span class="op" id="4658673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658676">c</span><span class="op" id="4658677">.</span><span class="ident" id="4658678">cipher1</span><span class="op" id="4658685">.</span><span class="ident" id="4658686">Decrypt</span><span class="op" id="4658693">(</span><span class="ident" id="4658694">dst</span><span class="op" id="4658697">,</span>&nbsp;<span class="ident" id="4658699">dst</span><span class="op" id="4658702">)</span><br>
<span class="lineno"></span><span class="op" id="4658704">}</span>
</div>
</body>
</html>
