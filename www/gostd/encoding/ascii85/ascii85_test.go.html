<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/ascii85</h2>
<ul>
<li><a href="/gostd/encoding/ascii85/ascii85.go.html">ascii85.go</a></li>
<li><a href="/gostd/encoding/ascii85/ascii85_test.go.html" class="current">ascii85_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6969774">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6969829">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6969883">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6969934">package</span>&nbsp;<span class="ident" id="6969942">ascii85</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6969951">import</span>&nbsp;<span class="op" id="6969958">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6969961">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6969970">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6969976">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6969989">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970000">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6970010">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="6970013">type</span>&nbsp;<span class="ident" id="6970018">testpair</span>&nbsp;<span class="keyword" id="6970027">struct</span>&nbsp;<span class="op" id="6970034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6970037">decoded</span><span class="op" id="6970044">,</span>&nbsp;<span class="ident" id="6970046">encoded</span>&nbsp;<span class="builtintype" id="6970054">string</span><br>
<span class="lineno"></span><span class="op" id="6970061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6970064">var</span>&nbsp;<span class="ident" id="6970068">pairs</span>&nbsp;<span class="op" id="6970074">=</span>&nbsp;<span class="op" id="6970076">[</span><span class="op" id="6970077">]</span><span class="ident" id="6970078">testpair</span><span class="op" id="6970086">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6970089">//&nbsp;Encode&nbsp;returns&nbsp;0&nbsp;when&nbsp;len(src)&nbsp;is&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6970129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970133">&#34;&#34;</span><span class="op" id="6970135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970139">&#34;&#34;</span><span class="op" id="6970141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6970144">}</span><span class="op" id="6970145">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6970148">//&nbsp;Wikipedia&nbsp;example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6970170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970174">&#34;Man&nbsp;is&nbsp;distinguished,&nbsp;not&nbsp;only&nbsp;by&nbsp;his&nbsp;reason,&nbsp;but&nbsp;by&nbsp;this&nbsp;singular&nbsp;passion&nbsp;from&nbsp;&#34;</span>&nbsp;<span class="op" id="6970257">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970262">&#34;other&nbsp;animals,&nbsp;which&nbsp;is&nbsp;a&nbsp;lust&nbsp;of&nbsp;the&nbsp;mind,&nbsp;that&nbsp;by&nbsp;a&nbsp;perseverance&nbsp;of&nbsp;delight&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="6970346">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970351">&#34;the&nbsp;continued&nbsp;and&nbsp;indefatigable&nbsp;generation&nbsp;of&nbsp;knowledge,&nbsp;exceeds&nbsp;the&nbsp;short&nbsp;&#34;</span>&nbsp;<span class="op" id="6970429">+</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970434">&#34;vehemence&nbsp;of&nbsp;any&nbsp;carnal&nbsp;pleasure.&#34;</span><span class="op" id="6970469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970473">&#34;9jqo^BlbD-BleB1DJ+*+F(f,q/0JhKF&lt;GL&gt;Cj@.4Gp$d7F!,L7@&lt;6@)/0JDEF&lt;G%&lt;+EV:2F!,\n&#34;</span>&nbsp;<span class="op" id="6970551">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970556">&#34;O&lt;DJ+*.@&lt;*K0@&lt;6L(Df-\\0Ec5e;DffZ(EZee.Bl.9pF\&#34;AGXBPCsi+DGm&gt;@3BB/F*&amp;OCAfu2/AKY\n&#34;</span>&nbsp;<span class="op" id="6970638">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970643">&#34;i(DIb:@FD,*)+C]U=@3BN#EcYf8ATD3s@q?d$AftVqCh[NqF&lt;G:8+EV:.+Cf&gt;-FD5W8ARlolDIa\n&#34;</span>&nbsp;<span class="op" id="6970723">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970728">&#34;l(DId&lt;j@&lt;?3r@:F%a+D58&#39;ATD4$Bl@l3De:,-DJs`8ARoFb/0JMK@qB4^F!,R&lt;AKZ&amp;-DfTqBG%G\n&#34;</span>&nbsp;<span class="op" id="6970808">+</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970813">&#34;&gt;uD.RTpAKYo&#39;+CT/5+Cei#DII?(E,9)oF*2M7/c\n&#34;</span><span class="op" id="6970856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6970859">}</span><span class="op" id="6970860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6970863">//&nbsp;Special&nbsp;case&nbsp;when&nbsp;shortening&nbsp;!!!!!&nbsp;to&nbsp;z.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6970908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970912">&#34;\000\000\000\000&#34;</span><span class="op" id="6970930">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6970934">&#34;z&#34;</span><span class="op" id="6970937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6970940">}</span><span class="op" id="6970941">,</span><br>
<span class="lineno"></span><span class="op" id="6970943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6970946">var</span>&nbsp;<span class="ident" id="6970950">bigtest</span>&nbsp;<span class="op" id="6970958">=</span>&nbsp;<span class="ident" id="6970960">pairs</span><span class="op" id="6970965">[</span><span class="builtinfunc" id="6970966">len</span><span class="op" id="6970969">(</span><span class="ident" id="6970970">pairs</span><span class="op" id="6970975">)</span><span class="op" id="6970976">-</span><span class="num" id="6970977">1</span><span class="op" id="6970978">]</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6970981">func</span>&nbsp;<span class="ident" id="6970986">testEqual</span><span class="op" id="6970995">(</span><span class="ident" id="6970996">t</span>&nbsp;<span class="op" id="6970998">*</span><span class="ident" id="6970999">testing</span><span class="op" id="6971006">.</span><span class="ident" id="6971007">T</span><span class="op" id="6971008">,</span>&nbsp;<span class="ident" id="6971010">msg</span>&nbsp;<span class="builtintype" id="6971014">string</span><span class="op" id="6971020">,</span>&nbsp;<span class="ident" id="6971022">args</span>&nbsp;<span class="op" id="6971027">...</span><span class="keyword" id="6971030">interface</span><span class="op" id="6971039">{</span><span class="op" id="6971040">}</span><span class="op" id="6971041">)</span>&nbsp;<span class="builtintype" id="6971043">bool</span>&nbsp;<span class="op" id="6971048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6971051">if</span>&nbsp;<span class="ident" id="6971054">args</span><span class="op" id="6971058">[</span><span class="builtinfunc" id="6971059">len</span><span class="op" id="6971062">(</span><span class="ident" id="6971063">args</span><span class="op" id="6971067">)</span><span class="op" id="6971068">-</span><span class="num" id="6971069">2</span><span class="op" id="6971070">]</span>&nbsp;<span class="op" id="6971072">!=</span>&nbsp;<span class="ident" id="6971075">args</span><span class="op" id="6971079">[</span><span class="builtinfunc" id="6971080">len</span><span class="op" id="6971083">(</span><span class="ident" id="6971084">args</span><span class="op" id="6971088">)</span><span class="op" id="6971089">-</span><span class="num" id="6971090">1</span><span class="op" id="6971091">]</span>&nbsp;<span class="op" id="6971093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971097">t</span><span class="op" id="6971098">.</span><span class="ident" id="6971099">Errorf</span><span class="op" id="6971105">(</span><span class="ident" id="6971106">msg</span><span class="op" id="6971109">,</span>&nbsp;<span class="ident" id="6971111">args</span><span class="op" id="6971115">...</span><span class="op" id="6971118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6971122">return</span>&nbsp;<span class="builtintype" id="6971129">false</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6971136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6971139">return</span>&nbsp;<span class="builtintype" id="6971146">true</span><br>
<span class="lineno"></span><span class="op" id="6971151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6971154">func</span>&nbsp;<span class="ident" id="6971159">strip85</span><span class="op" id="6971166">(</span><span class="ident" id="6971167">s</span>&nbsp;<span class="builtintype" id="6971169">string</span><span class="op" id="6971175">)</span>&nbsp;<span class="builtintype" id="6971177">string</span>&nbsp;<span class="op" id="6971184">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971187">t</span>&nbsp;<span class="op" id="6971189">:=</span>&nbsp;<span class="builtinfunc" id="6971192">make</span><span class="op" id="6971196">(</span><span class="op" id="6971197">[</span><span class="op" id="6971198">]</span><span class="builtintype" id="6971199">byte</span><span class="op" id="6971203">,</span>&nbsp;<span class="builtinfunc" id="6971205">len</span><span class="op" id="6971208">(</span><span class="ident" id="6971209">s</span><span class="op" id="6971210">)</span><span class="op" id="6971211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971214">w</span>&nbsp;<span class="op" id="6971216">:=</span>&nbsp;<span class="num" id="6971219">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6971222">for</span>&nbsp;<span class="ident" id="6971226">r</span>&nbsp;<span class="op" id="6971228">:=</span>&nbsp;<span class="num" id="6971231">0</span><span class="op" id="6971232">;</span>&nbsp;<span class="ident" id="6971234">r</span>&nbsp;<span class="op" id="6971236">&lt;</span>&nbsp;<span class="builtinfunc" id="6971238">len</span><span class="op" id="6971241">(</span><span class="ident" id="6971242">s</span><span class="op" id="6971243">)</span><span class="op" id="6971244">;</span>&nbsp;<span class="ident" id="6971246">r</span><span class="op" id="6971247">++</span>&nbsp;<span class="op" id="6971250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971254">c</span>&nbsp;<span class="op" id="6971256">:=</span>&nbsp;<span class="ident" id="6971259">s</span><span class="op" id="6971260">[</span><span class="ident" id="6971261">r</span><span class="op" id="6971262">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6971266">if</span>&nbsp;<span class="ident" id="6971269">c</span>&nbsp;<span class="op" id="6971271">&gt;</span>&nbsp;<span class="string" id="6971273">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6971277">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971282">t</span><span class="op" id="6971283">[</span><span class="ident" id="6971284">w</span><span class="op" id="6971285">]</span>&nbsp;<span class="op" id="6971287">=</span>&nbsp;<span class="ident" id="6971289">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971294">w</span><span class="op" id="6971295">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6971300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6971303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6971306">return</span>&nbsp;<span class="builtintype" id="6971313">string</span><span class="op" id="6971319">(</span><span class="ident" id="6971320">t</span><span class="op" id="6971321">[</span><span class="num" id="6971322">0</span><span class="op" id="6971323">:</span><span class="ident" id="6971324">w</span><span class="op" id="6971325">]</span><span class="op" id="6971326">)</span><br>
<span class="lineno">65</span><span class="op" id="6971328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6971331">func</span>&nbsp;<span class="ident" id="6971336">TestEncode</span><span class="op" id="6971346">(</span><span class="ident" id="6971347">t</span>&nbsp;<span class="op" id="6971349">*</span><span class="ident" id="6971350">testing</span><span class="op" id="6971357">.</span><span class="ident" id="6971358">T</span><span class="op" id="6971359">)</span>&nbsp;<span class="op" id="6971361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6971364">for</span>&nbsp;<span class="ident" id="6971368">_</span><span class="op" id="6971369">,</span>&nbsp;<span class="ident" id="6971371">p</span>&nbsp;<span class="op" id="6971373">:=</span>&nbsp;<span class="keyword" id="6971376">range</span>&nbsp;<span class="ident" id="6971382">pairs</span>&nbsp;<span class="op" id="6971388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971392">buf</span>&nbsp;<span class="op" id="6971396">:=</span>&nbsp;<span class="builtinfunc" id="6971399">make</span><span class="op" id="6971403">(</span><span class="op" id="6971404">[</span><span class="op" id="6971405">]</span><span class="builtintype" id="6971406">byte</span><span class="op" id="6971410">,</span>&nbsp;<span class="ident" id="6971412">MaxEncodedLen</span><span class="op" id="6971425">(</span><span class="builtinfunc" id="6971426">len</span><span class="op" id="6971429">(</span><span class="ident" id="6971430">p</span><span class="op" id="6971431">.</span><span class="ident" id="6971432">decoded</span><span class="op" id="6971439">)</span><span class="op" id="6971440">)</span><span class="op" id="6971441">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971445">n</span>&nbsp;<span class="op" id="6971447">:=</span>&nbsp;<span class="ident" id="6971450">Encode</span><span class="op" id="6971456">(</span><span class="ident" id="6971457">buf</span><span class="op" id="6971460">,</span>&nbsp;<span class="op" id="6971462">[</span><span class="op" id="6971463">]</span><span class="builtintype" id="6971464">byte</span><span class="op" id="6971468">(</span><span class="ident" id="6971469">p</span><span class="op" id="6971470">.</span><span class="ident" id="6971471">decoded</span><span class="op" id="6971478">)</span><span class="op" id="6971479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971483">buf</span>&nbsp;<span class="op" id="6971487">=</span>&nbsp;<span class="ident" id="6971489">buf</span><span class="op" id="6971492">[</span><span class="num" id="6971493">0</span><span class="op" id="6971494">:</span><span class="ident" id="6971495">n</span><span class="op" id="6971496">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971500">testEqual</span><span class="op" id="6971509">(</span><span class="ident" id="6971510">t</span><span class="op" id="6971511">,</span>&nbsp;<span class="string" id="6971513">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6971539">,</span>&nbsp;<span class="ident" id="6971541">p</span><span class="op" id="6971542">.</span><span class="ident" id="6971543">decoded</span><span class="op" id="6971550">,</span>&nbsp;<span class="ident" id="6971552">strip85</span><span class="op" id="6971559">(</span><span class="builtintype" id="6971560">string</span><span class="op" id="6971566">(</span><span class="ident" id="6971567">buf</span><span class="op" id="6971570">)</span><span class="op" id="6971571">)</span><span class="op" id="6971572">,</span>&nbsp;<span class="ident" id="6971574">strip85</span><span class="op" id="6971581">(</span><span class="ident" id="6971582">p</span><span class="op" id="6971583">.</span><span class="ident" id="6971584">encoded</span><span class="op" id="6971591">)</span><span class="op" id="6971592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6971595">}</span><br>
<span class="lineno"></span><span class="op" id="6971597">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="6971600">func</span>&nbsp;<span class="ident" id="6971605">TestEncoder</span><span class="op" id="6971616">(</span><span class="ident" id="6971617">t</span>&nbsp;<span class="op" id="6971619">*</span><span class="ident" id="6971620">testing</span><span class="op" id="6971627">.</span><span class="ident" id="6971628">T</span><span class="op" id="6971629">)</span>&nbsp;<span class="op" id="6971631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6971634">for</span>&nbsp;<span class="ident" id="6971638">_</span><span class="op" id="6971639">,</span>&nbsp;<span class="ident" id="6971641">p</span>&nbsp;<span class="op" id="6971643">:=</span>&nbsp;<span class="keyword" id="6971646">range</span>&nbsp;<span class="ident" id="6971652">pairs</span>&nbsp;<span class="op" id="6971658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971662">bb</span>&nbsp;<span class="op" id="6971665">:=</span>&nbsp;<span class="op" id="6971668">&amp;</span><span class="ident" id="6971669">bytes</span><span class="op" id="6971674">.</span><span class="ident" id="6971675">Buffer</span><span class="op" id="6971681">{</span><span class="op" id="6971682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971686">encoder</span>&nbsp;<span class="op" id="6971694">:=</span>&nbsp;<span class="ident" id="6971697">NewEncoder</span><span class="op" id="6971707">(</span><span class="ident" id="6971708">bb</span><span class="op" id="6971710">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971714">encoder</span><span class="op" id="6971721">.</span><span class="ident" id="6971722">Write</span><span class="op" id="6971727">(</span><span class="op" id="6971728">[</span><span class="op" id="6971729">]</span><span class="builtintype" id="6971730">byte</span><span class="op" id="6971734">(</span><span class="ident" id="6971735">p</span><span class="op" id="6971736">.</span><span class="ident" id="6971737">decoded</span><span class="op" id="6971744">)</span><span class="op" id="6971745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971749">encoder</span><span class="op" id="6971756">.</span><span class="ident" id="6971757">Close</span><span class="op" id="6971762">(</span><span class="op" id="6971763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971767">testEqual</span><span class="op" id="6971776">(</span><span class="ident" id="6971777">t</span><span class="op" id="6971778">,</span>&nbsp;<span class="string" id="6971780">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6971806">,</span>&nbsp;<span class="ident" id="6971808">p</span><span class="op" id="6971809">.</span><span class="ident" id="6971810">decoded</span><span class="op" id="6971817">,</span>&nbsp;<span class="ident" id="6971819">strip85</span><span class="op" id="6971826">(</span><span class="ident" id="6971827">bb</span><span class="op" id="6971829">.</span><span class="ident" id="6971830">String</span><span class="op" id="6971836">(</span><span class="op" id="6971837">)</span><span class="op" id="6971838">)</span><span class="op" id="6971839">,</span>&nbsp;<span class="ident" id="6971841">strip85</span><span class="op" id="6971848">(</span><span class="ident" id="6971849">p</span><span class="op" id="6971850">.</span><span class="ident" id="6971851">encoded</span><span class="op" id="6971858">)</span><span class="op" id="6971859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6971862">}</span><br>
<span class="lineno"></span><span class="op" id="6971864">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="6971867">func</span>&nbsp;<span class="ident" id="6971872">TestEncoderBuffering</span><span class="op" id="6971892">(</span><span class="ident" id="6971893">t</span>&nbsp;<span class="op" id="6971895">*</span><span class="ident" id="6971896">testing</span><span class="op" id="6971903">.</span><span class="ident" id="6971904">T</span><span class="op" id="6971905">)</span>&nbsp;<span class="op" id="6971907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971910">input</span>&nbsp;<span class="op" id="6971916">:=</span>&nbsp;<span class="op" id="6971919">[</span><span class="op" id="6971920">]</span><span class="builtintype" id="6971921">byte</span><span class="op" id="6971925">(</span><span class="ident" id="6971926">bigtest</span><span class="op" id="6971933">.</span><span class="ident" id="6971934">decoded</span><span class="op" id="6971941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6971944">for</span>&nbsp;<span class="ident" id="6971948">bs</span>&nbsp;<span class="op" id="6971951">:=</span>&nbsp;<span class="num" id="6971954">1</span><span class="op" id="6971955">;</span>&nbsp;<span class="ident" id="6971957">bs</span>&nbsp;<span class="op" id="6971960">&lt;=</span>&nbsp;<span class="num" id="6971963">12</span><span class="op" id="6971965">;</span>&nbsp;<span class="ident" id="6971967">bs</span><span class="op" id="6971969">++</span>&nbsp;<span class="op" id="6971972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6971976">bb</span>&nbsp;<span class="op" id="6971979">:=</span>&nbsp;<span class="op" id="6971982">&amp;</span><span class="ident" id="6971983">bytes</span><span class="op" id="6971988">.</span><span class="ident" id="6971989">Buffer</span><span class="op" id="6971995">{</span><span class="op" id="6971996">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972000">encoder</span>&nbsp;<span class="op" id="6972008">:=</span>&nbsp;<span class="ident" id="6972011">NewEncoder</span><span class="op" id="6972021">(</span><span class="ident" id="6972022">bb</span><span class="op" id="6972024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6972028">for</span>&nbsp;<span class="ident" id="6972032">pos</span>&nbsp;<span class="op" id="6972036">:=</span>&nbsp;<span class="num" id="6972039">0</span><span class="op" id="6972040">;</span>&nbsp;<span class="ident" id="6972042">pos</span>&nbsp;<span class="op" id="6972046">&lt;</span>&nbsp;<span class="builtinfunc" id="6972048">len</span><span class="op" id="6972051">(</span><span class="ident" id="6972052">input</span><span class="op" id="6972057">)</span><span class="op" id="6972058">;</span>&nbsp;<span class="ident" id="6972060">pos</span>&nbsp;<span class="op" id="6972064">+=</span>&nbsp;<span class="ident" id="6972067">bs</span>&nbsp;<span class="op" id="6972070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972075">end</span>&nbsp;<span class="op" id="6972079">:=</span>&nbsp;<span class="ident" id="6972082">pos</span>&nbsp;<span class="op" id="6972086">+</span>&nbsp;<span class="ident" id="6972088">bs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6972094">if</span>&nbsp;<span class="ident" id="6972097">end</span>&nbsp;<span class="op" id="6972101">&gt;</span>&nbsp;<span class="builtinfunc" id="6972103">len</span><span class="op" id="6972106">(</span><span class="ident" id="6972107">input</span><span class="op" id="6972112">)</span>&nbsp;<span class="op" id="6972114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972120">end</span>&nbsp;<span class="op" id="6972124">=</span>&nbsp;<span class="builtinfunc" id="6972126">len</span><span class="op" id="6972129">(</span><span class="ident" id="6972130">input</span><span class="op" id="6972135">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6972140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972145">n</span><span class="op" id="6972146">,</span>&nbsp;<span class="ident" id="6972148">err</span>&nbsp;<span class="op" id="6972152">:=</span>&nbsp;<span class="ident" id="6972155">encoder</span><span class="op" id="6972162">.</span><span class="ident" id="6972163">Write</span><span class="op" id="6972168">(</span><span class="ident" id="6972169">input</span><span class="op" id="6972174">[</span><span class="ident" id="6972175">pos</span><span class="op" id="6972178">:</span><span class="ident" id="6972179">end</span><span class="op" id="6972182">]</span><span class="op" id="6972183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972188">testEqual</span><span class="op" id="6972197">(</span><span class="ident" id="6972198">t</span><span class="op" id="6972199">,</span>&nbsp;<span class="string" id="6972201">&#34;Write(%q)&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6972235">,</span>&nbsp;<span class="ident" id="6972237">input</span><span class="op" id="6972242">[</span><span class="ident" id="6972243">pos</span><span class="op" id="6972246">:</span><span class="ident" id="6972247">end</span><span class="op" id="6972250">]</span><span class="op" id="6972251">,</span>&nbsp;<span class="ident" id="6972253">err</span><span class="op" id="6972256">,</span>&nbsp;<span class="builtintype" id="6972258">error</span><span class="op" id="6972263">(</span><span class="ident" id="6972264">nil</span><span class="op" id="6972267">)</span><span class="op" id="6972268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972273">testEqual</span><span class="op" id="6972282">(</span><span class="ident" id="6972283">t</span><span class="op" id="6972284">,</span>&nbsp;<span class="string" id="6972286">&#34;Write(%q)&nbsp;gave&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6972321">,</span>&nbsp;<span class="ident" id="6972323">input</span><span class="op" id="6972328">[</span><span class="ident" id="6972329">pos</span><span class="op" id="6972332">:</span><span class="ident" id="6972333">end</span><span class="op" id="6972336">]</span><span class="op" id="6972337">,</span>&nbsp;<span class="ident" id="6972339">n</span><span class="op" id="6972340">,</span>&nbsp;<span class="ident" id="6972342">end</span><span class="op" id="6972345">-</span><span class="ident" id="6972346">pos</span><span class="op" id="6972349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6972353">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972357">err</span>&nbsp;<span class="op" id="6972361">:=</span>&nbsp;<span class="ident" id="6972364">encoder</span><span class="op" id="6972371">.</span><span class="ident" id="6972372">Close</span><span class="op" id="6972377">(</span><span class="op" id="6972378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972382">testEqual</span><span class="op" id="6972391">(</span><span class="ident" id="6972392">t</span><span class="op" id="6972393">,</span>&nbsp;<span class="string" id="6972395">&#34;Close&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6972425">,</span>&nbsp;<span class="ident" id="6972427">err</span><span class="op" id="6972430">,</span>&nbsp;<span class="builtintype" id="6972432">error</span><span class="op" id="6972437">(</span><span class="ident" id="6972438">nil</span><span class="op" id="6972441">)</span><span class="op" id="6972442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972446">testEqual</span><span class="op" id="6972455">(</span><span class="ident" id="6972456">t</span><span class="op" id="6972457">,</span>&nbsp;<span class="string" id="6972459">&#34;Encoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6972492">,</span>&nbsp;<span class="ident" id="6972494">bs</span><span class="op" id="6972496">,</span>&nbsp;<span class="ident" id="6972498">bigtest</span><span class="op" id="6972505">.</span><span class="ident" id="6972506">decoded</span><span class="op" id="6972513">,</span>&nbsp;<span class="ident" id="6972515">strip85</span><span class="op" id="6972522">(</span><span class="ident" id="6972523">bb</span><span class="op" id="6972525">.</span><span class="ident" id="6972526">String</span><span class="op" id="6972532">(</span><span class="op" id="6972533">)</span><span class="op" id="6972534">)</span><span class="op" id="6972535">,</span>&nbsp;<span class="ident" id="6972537">strip85</span><span class="op" id="6972544">(</span><span class="ident" id="6972545">bigtest</span><span class="op" id="6972552">.</span><span class="ident" id="6972553">encoded</span><span class="op" id="6972560">)</span><span class="op" id="6972561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6972564">}</span><br>
<span class="lineno"></span><span class="op" id="6972566">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="6972569">func</span>&nbsp;<span class="ident" id="6972574">TestDecode</span><span class="op" id="6972584">(</span><span class="ident" id="6972585">t</span>&nbsp;<span class="op" id="6972587">*</span><span class="ident" id="6972588">testing</span><span class="op" id="6972595">.</span><span class="ident" id="6972596">T</span><span class="op" id="6972597">)</span>&nbsp;<span class="op" id="6972599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6972602">for</span>&nbsp;<span class="ident" id="6972606">_</span><span class="op" id="6972607">,</span>&nbsp;<span class="ident" id="6972609">p</span>&nbsp;<span class="op" id="6972611">:=</span>&nbsp;<span class="keyword" id="6972614">range</span>&nbsp;<span class="ident" id="6972620">pairs</span>&nbsp;<span class="op" id="6972626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972630">dbuf</span>&nbsp;<span class="op" id="6972635">:=</span>&nbsp;<span class="builtinfunc" id="6972638">make</span><span class="op" id="6972642">(</span><span class="op" id="6972643">[</span><span class="op" id="6972644">]</span><span class="builtintype" id="6972645">byte</span><span class="op" id="6972649">,</span>&nbsp;<span class="num" id="6972651">4</span><span class="op" id="6972652">*</span><span class="builtinfunc" id="6972653">len</span><span class="op" id="6972656">(</span><span class="ident" id="6972657">p</span><span class="op" id="6972658">.</span><span class="ident" id="6972659">encoded</span><span class="op" id="6972666">)</span><span class="op" id="6972667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972671">ndst</span><span class="op" id="6972675">,</span>&nbsp;<span class="ident" id="6972677">nsrc</span><span class="op" id="6972681">,</span>&nbsp;<span class="ident" id="6972683">err</span>&nbsp;<span class="op" id="6972687">:=</span>&nbsp;<span class="ident" id="6972690">Decode</span><span class="op" id="6972696">(</span><span class="ident" id="6972697">dbuf</span><span class="op" id="6972701">,</span>&nbsp;<span class="op" id="6972703">[</span><span class="op" id="6972704">]</span><span class="builtintype" id="6972705">byte</span><span class="op" id="6972709">(</span><span class="ident" id="6972710">p</span><span class="op" id="6972711">.</span><span class="ident" id="6972712">encoded</span><span class="op" id="6972719">)</span><span class="op" id="6972720">,</span>&nbsp;<span class="builtintype" id="6972722">true</span><span class="op" id="6972726">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972730">testEqual</span><span class="op" id="6972739">(</span><span class="ident" id="6972740">t</span><span class="op" id="6972741">,</span>&nbsp;<span class="string" id="6972743">&#34;Decode(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6972775">,</span>&nbsp;<span class="ident" id="6972777">p</span><span class="op" id="6972778">.</span><span class="ident" id="6972779">encoded</span><span class="op" id="6972786">,</span>&nbsp;<span class="ident" id="6972788">err</span><span class="op" id="6972791">,</span>&nbsp;<span class="builtintype" id="6972793">error</span><span class="op" id="6972798">(</span><span class="ident" id="6972799">nil</span><span class="op" id="6972802">)</span><span class="op" id="6972803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972807">testEqual</span><span class="op" id="6972816">(</span><span class="ident" id="6972817">t</span><span class="op" id="6972818">,</span>&nbsp;<span class="string" id="6972820">&#34;Decode(%q)&nbsp;=&nbsp;nsrc&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6972851">,</span>&nbsp;<span class="ident" id="6972853">p</span><span class="op" id="6972854">.</span><span class="ident" id="6972855">encoded</span><span class="op" id="6972862">,</span>&nbsp;<span class="ident" id="6972864">nsrc</span><span class="op" id="6972868">,</span>&nbsp;<span class="builtinfunc" id="6972870">len</span><span class="op" id="6972873">(</span><span class="ident" id="6972874">p</span><span class="op" id="6972875">.</span><span class="ident" id="6972876">encoded</span><span class="op" id="6972883">)</span><span class="op" id="6972884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972888">testEqual</span><span class="op" id="6972897">(</span><span class="ident" id="6972898">t</span><span class="op" id="6972899">,</span>&nbsp;<span class="string" id="6972901">&#34;Decode(%q)&nbsp;=&nbsp;ndst&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6972932">,</span>&nbsp;<span class="ident" id="6972934">p</span><span class="op" id="6972935">.</span><span class="ident" id="6972936">encoded</span><span class="op" id="6972943">,</span>&nbsp;<span class="ident" id="6972945">ndst</span><span class="op" id="6972949">,</span>&nbsp;<span class="builtinfunc" id="6972951">len</span><span class="op" id="6972954">(</span><span class="ident" id="6972955">p</span><span class="op" id="6972956">.</span><span class="ident" id="6972957">decoded</span><span class="op" id="6972964">)</span><span class="op" id="6972965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6972969">testEqual</span><span class="op" id="6972978">(</span><span class="ident" id="6972979">t</span><span class="op" id="6972980">,</span>&nbsp;<span class="string" id="6972982">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6973008">,</span>&nbsp;<span class="ident" id="6973010">p</span><span class="op" id="6973011">.</span><span class="ident" id="6973012">encoded</span><span class="op" id="6973019">,</span>&nbsp;<span class="builtintype" id="6973021">string</span><span class="op" id="6973027">(</span><span class="ident" id="6973028">dbuf</span><span class="op" id="6973032">[</span><span class="num" id="6973033">0</span><span class="op" id="6973034">:</span><span class="ident" id="6973035">ndst</span><span class="op" id="6973039">]</span><span class="op" id="6973040">)</span><span class="op" id="6973041">,</span>&nbsp;<span class="ident" id="6973043">p</span><span class="op" id="6973044">.</span><span class="ident" id="6973045">decoded</span><span class="op" id="6973052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6973055">}</span><br>
<span class="lineno">115</span><span class="op" id="6973057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6973060">func</span>&nbsp;<span class="ident" id="6973065">TestDecoder</span><span class="op" id="6973076">(</span><span class="ident" id="6973077">t</span>&nbsp;<span class="op" id="6973079">*</span><span class="ident" id="6973080">testing</span><span class="op" id="6973087">.</span><span class="ident" id="6973088">T</span><span class="op" id="6973089">)</span>&nbsp;<span class="op" id="6973091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6973094">for</span>&nbsp;<span class="ident" id="6973098">_</span><span class="op" id="6973099">,</span>&nbsp;<span class="ident" id="6973101">p</span>&nbsp;<span class="op" id="6973103">:=</span>&nbsp;<span class="keyword" id="6973106">range</span>&nbsp;<span class="ident" id="6973112">pairs</span>&nbsp;<span class="op" id="6973118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6973122">decoder</span>&nbsp;<span class="op" id="6973130">:=</span>&nbsp;<span class="ident" id="6973133">NewDecoder</span><span class="op" id="6973143">(</span><span class="ident" id="6973144">strings</span><span class="op" id="6973151">.</span><span class="ident" id="6973152">NewReader</span><span class="op" id="6973161">(</span><span class="ident" id="6973162">p</span><span class="op" id="6973163">.</span><span class="ident" id="6973164">encoded</span><span class="op" id="6973171">)</span><span class="op" id="6973172">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6973176">dbuf</span><span class="op" id="6973180">,</span>&nbsp;<span class="ident" id="6973182">err</span>&nbsp;<span class="op" id="6973186">:=</span>&nbsp;<span class="ident" id="6973189">ioutil</span><span class="op" id="6973195">.</span><span class="ident" id="6973196">ReadAll</span><span class="op" id="6973203">(</span><span class="ident" id="6973204">decoder</span><span class="op" id="6973211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6973215">if</span>&nbsp;<span class="ident" id="6973218">err</span>&nbsp;<span class="op" id="6973222">!=</span>&nbsp;<span class="ident" id="6973225">nil</span>&nbsp;<span class="op" id="6973229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6973234">t</span><span class="op" id="6973235">.</span><span class="ident" id="6973236">Fatal</span><span class="op" id="6973241">(</span><span class="string" id="6973242">&#34;Read&nbsp;failed&#34;</span><span class="op" id="6973255">,</span>&nbsp;<span class="ident" id="6973257">err</span><span class="op" id="6973260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6973264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6973268">testEqual</span><span class="op" id="6973277">(</span><span class="ident" id="6973278">t</span><span class="op" id="6973279">,</span>&nbsp;<span class="string" id="6973281">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6973316">,</span>&nbsp;<span class="ident" id="6973318">p</span><span class="op" id="6973319">.</span><span class="ident" id="6973320">encoded</span><span class="op" id="6973327">,</span>&nbsp;<span class="builtinfunc" id="6973329">len</span><span class="op" id="6973332">(</span><span class="ident" id="6973333">dbuf</span><span class="op" id="6973337">)</span><span class="op" id="6973338">,</span>&nbsp;<span class="builtinfunc" id="6973340">len</span><span class="op" id="6973343">(</span><span class="ident" id="6973344">p</span><span class="op" id="6973345">.</span><span class="ident" id="6973346">decoded</span><span class="op" id="6973353">)</span><span class="op" id="6973354">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6973358">testEqual</span><span class="op" id="6973367">(</span><span class="ident" id="6973368">t</span><span class="op" id="6973369">,</span>&nbsp;<span class="string" id="6973371">&#34;Decoding&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6973401">,</span>&nbsp;<span class="ident" id="6973403">p</span><span class="op" id="6973404">.</span><span class="ident" id="6973405">encoded</span><span class="op" id="6973412">,</span>&nbsp;<span class="builtintype" id="6973414">string</span><span class="op" id="6973420">(</span><span class="ident" id="6973421">dbuf</span><span class="op" id="6973425">)</span><span class="op" id="6973426">,</span>&nbsp;<span class="ident" id="6973428">p</span><span class="op" id="6973429">.</span><span class="ident" id="6973430">decoded</span><span class="op" id="6973437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6973441">if</span>&nbsp;<span class="ident" id="6973444">err</span>&nbsp;<span class="op" id="6973448">!=</span>&nbsp;<span class="ident" id="6973451">nil</span>&nbsp;<span class="op" id="6973455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6973460">testEqual</span><span class="op" id="6973469">(</span><span class="ident" id="6973470">t</span><span class="op" id="6973471">,</span>&nbsp;<span class="string" id="6973473">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6973501">,</span>&nbsp;<span class="ident" id="6973503">p</span><span class="op" id="6973504">.</span><span class="ident" id="6973505">encoded</span><span class="op" id="6973512">,</span>&nbsp;<span class="ident" id="6973514">err</span><span class="op" id="6973517">,</span>&nbsp;<span class="ident" id="6973519">io</span><span class="op" id="6973521">.</span><span class="ident" id="6973522">EOF</span><span class="op" id="6973525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6973529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6973532">}</span><br>
<span class="lineno">130</span><span class="op" id="6973534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6973537">func</span>&nbsp;<span class="ident" id="6973542">TestDecoderBuffering</span><span class="op" id="6973562">(</span><span class="ident" id="6973563">t</span>&nbsp;<span class="op" id="6973565">*</span><span class="ident" id="6973566">testing</span><span class="op" id="6973573">.</span><span class="ident" id="6973574">T</span><span class="op" id="6973575">)</span>&nbsp;<span class="op" id="6973577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6973580">for</span>&nbsp;<span class="ident" id="6973584">bs</span>&nbsp;<span class="op" id="6973587">:=</span>&nbsp;<span class="num" id="6973590">1</span><span class="op" id="6973591">;</span>&nbsp;<span class="ident" id="6973593">bs</span>&nbsp;<span class="op" id="6973596">&lt;=</span>&nbsp;<span class="num" id="6973599">12</span><span class="op" id="6973601">;</span>&nbsp;<span class="ident" id="6973603">bs</span><span class="op" id="6973605">++</span>&nbsp;<span class="op" id="6973608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6973612">decoder</span>&nbsp;<span class="op" id="6973620">:=</span>&nbsp;<span class="ident" id="6973623">NewDecoder</span><span class="op" id="6973633">(</span><span class="ident" id="6973634">strings</span><span class="op" id="6973641">.</span><span class="ident" id="6973642">NewReader</span><span class="op" id="6973651">(</span><span class="ident" id="6973652">bigtest</span><span class="op" id="6973659">.</span><span class="ident" id="6973660">encoded</span><span class="op" id="6973667">)</span><span class="op" id="6973668">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6973672">buf</span>&nbsp;<span class="op" id="6973676">:=</span>&nbsp;<span class="builtinfunc" id="6973679">make</span><span class="op" id="6973683">(</span><span class="op" id="6973684">[</span><span class="op" id="6973685">]</span><span class="builtintype" id="6973686">byte</span><span class="op" id="6973690">,</span>&nbsp;<span class="builtinfunc" id="6973692">len</span><span class="op" id="6973695">(</span><span class="ident" id="6973696">bigtest</span><span class="op" id="6973703">.</span><span class="ident" id="6973704">decoded</span><span class="op" id="6973711">)</span><span class="op" id="6973712">+</span><span class="num" id="6973713">12</span><span class="op" id="6973715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6973719">var</span>&nbsp;<span class="ident" id="6973723">total</span>&nbsp;<span class="builtintype" id="6973729">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6973735">for</span>&nbsp;<span class="ident" id="6973739">total</span>&nbsp;<span class="op" id="6973745">=</span>&nbsp;<span class="num" id="6973747">0</span><span class="op" id="6973748">;</span>&nbsp;<span class="ident" id="6973750">total</span>&nbsp;<span class="op" id="6973756">&lt;</span>&nbsp;<span class="builtinfunc" id="6973758">len</span><span class="op" id="6973761">(</span><span class="ident" id="6973762">bigtest</span><span class="op" id="6973769">.</span><span class="ident" id="6973770">decoded</span><span class="op" id="6973777">)</span><span class="op" id="6973778">;</span>&nbsp;<span class="op" id="6973780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6973785">n</span><span class="op" id="6973786">,</span>&nbsp;<span class="ident" id="6973788">err</span>&nbsp;<span class="op" id="6973792">:=</span>&nbsp;<span class="ident" id="6973795">decoder</span><span class="op" id="6973802">.</span><span class="ident" id="6973803">Read</span><span class="op" id="6973807">(</span><span class="ident" id="6973808">buf</span><span class="op" id="6973811">[</span><span class="ident" id="6973812">total</span>&nbsp;<span class="op" id="6973818">:</span>&nbsp;<span class="ident" id="6973820">total</span><span class="op" id="6973825">+</span><span class="ident" id="6973826">bs</span><span class="op" id="6973828">]</span><span class="op" id="6973829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6973834">testEqual</span><span class="op" id="6973843">(</span><span class="ident" id="6973844">t</span><span class="op" id="6973845">,</span>&nbsp;<span class="string" id="6973847">&#34;Read&nbsp;from&nbsp;%q&nbsp;at&nbsp;pos&nbsp;%d&nbsp;=&nbsp;%d,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="6973892">,</span>&nbsp;<span class="ident" id="6973894">bigtest</span><span class="op" id="6973901">.</span><span class="ident" id="6973902">encoded</span><span class="op" id="6973909">,</span>&nbsp;<span class="ident" id="6973911">total</span><span class="op" id="6973916">,</span>&nbsp;<span class="ident" id="6973918">n</span><span class="op" id="6973919">,</span>&nbsp;<span class="ident" id="6973921">err</span><span class="op" id="6973924">,</span>&nbsp;<span class="builtintype" id="6973926">error</span><span class="op" id="6973931">(</span><span class="ident" id="6973932">nil</span><span class="op" id="6973935">)</span><span class="op" id="6973936">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6973941">total</span>&nbsp;<span class="op" id="6973947">+=</span>&nbsp;<span class="ident" id="6973950">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6973954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6973958">testEqual</span><span class="op" id="6973967">(</span><span class="ident" id="6973968">t</span><span class="op" id="6973969">,</span>&nbsp;<span class="string" id="6973971">&#34;Decoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6974004">,</span>&nbsp;<span class="ident" id="6974006">bs</span><span class="op" id="6974008">,</span>&nbsp;<span class="ident" id="6974010">bigtest</span><span class="op" id="6974017">.</span><span class="ident" id="6974018">encoded</span><span class="op" id="6974025">,</span>&nbsp;<span class="builtintype" id="6974027">string</span><span class="op" id="6974033">(</span><span class="ident" id="6974034">buf</span><span class="op" id="6974037">[</span><span class="num" id="6974038">0</span><span class="op" id="6974039">:</span><span class="ident" id="6974040">total</span><span class="op" id="6974045">]</span><span class="op" id="6974046">)</span><span class="op" id="6974047">,</span>&nbsp;<span class="ident" id="6974049">bigtest</span><span class="op" id="6974056">.</span><span class="ident" id="6974057">decoded</span><span class="op" id="6974064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6974067">}</span><br>
<span class="lineno"></span><span class="op" id="6974069">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="6974072">func</span>&nbsp;<span class="ident" id="6974077">TestDecodeCorrupt</span><span class="op" id="6974094">(</span><span class="ident" id="6974095">t</span>&nbsp;<span class="op" id="6974097">*</span><span class="ident" id="6974098">testing</span><span class="op" id="6974105">.</span><span class="ident" id="6974106">T</span><span class="op" id="6974107">)</span>&nbsp;<span class="op" id="6974109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6974112">type</span>&nbsp;<span class="ident" id="6974117">corrupt</span>&nbsp;<span class="keyword" id="6974125">struct</span>&nbsp;<span class="op" id="6974132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974136">e</span>&nbsp;<span class="builtintype" id="6974138">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974147">p</span>&nbsp;<span class="builtintype" id="6974149">int</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6974154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974157">examples</span>&nbsp;<span class="op" id="6974166">:=</span>&nbsp;<span class="op" id="6974169">[</span><span class="op" id="6974170">]</span><span class="ident" id="6974171">corrupt</span><span class="op" id="6974178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6974182">{</span><span class="string" id="6974183">&#34;v&#34;</span><span class="op" id="6974186">,</span>&nbsp;<span class="num" id="6974188">0</span><span class="op" id="6974189">}</span><span class="op" id="6974190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6974194">{</span><span class="string" id="6974195">&#34;!z!!!!!!!!!&#34;</span><span class="op" id="6974208">,</span>&nbsp;<span class="num" id="6974210">1</span><span class="op" id="6974211">}</span><span class="op" id="6974212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6974215">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6974219">for</span>&nbsp;<span class="ident" id="6974223">_</span><span class="op" id="6974224">,</span>&nbsp;<span class="ident" id="6974226">e</span>&nbsp;<span class="op" id="6974228">:=</span>&nbsp;<span class="keyword" id="6974231">range</span>&nbsp;<span class="ident" id="6974237">examples</span>&nbsp;<span class="op" id="6974246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974250">dbuf</span>&nbsp;<span class="op" id="6974255">:=</span>&nbsp;<span class="builtinfunc" id="6974258">make</span><span class="op" id="6974262">(</span><span class="op" id="6974263">[</span><span class="op" id="6974264">]</span><span class="builtintype" id="6974265">byte</span><span class="op" id="6974269">,</span>&nbsp;<span class="num" id="6974271">4</span><span class="op" id="6974272">*</span><span class="builtinfunc" id="6974273">len</span><span class="op" id="6974276">(</span><span class="ident" id="6974277">e</span><span class="op" id="6974278">.</span><span class="ident" id="6974279">e</span><span class="op" id="6974280">)</span><span class="op" id="6974281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974285">_</span><span class="op" id="6974286">,</span>&nbsp;<span class="ident" id="6974288">_</span><span class="op" id="6974289">,</span>&nbsp;<span class="ident" id="6974291">err</span>&nbsp;<span class="op" id="6974295">:=</span>&nbsp;<span class="ident" id="6974298">Decode</span><span class="op" id="6974304">(</span><span class="ident" id="6974305">dbuf</span><span class="op" id="6974309">,</span>&nbsp;<span class="op" id="6974311">[</span><span class="op" id="6974312">]</span><span class="builtintype" id="6974313">byte</span><span class="op" id="6974317">(</span><span class="ident" id="6974318">e</span><span class="op" id="6974319">.</span><span class="ident" id="6974320">e</span><span class="op" id="6974321">)</span><span class="op" id="6974322">,</span>&nbsp;<span class="builtintype" id="6974324">true</span><span class="op" id="6974328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6974332">switch</span>&nbsp;<span class="ident" id="6974339">err</span>&nbsp;<span class="op" id="6974343">:=</span>&nbsp;<span class="ident" id="6974346">err</span><span class="op" id="6974349">.</span><span class="op" id="6974350">(</span><span class="keyword" id="6974351">type</span><span class="op" id="6974355">)</span>&nbsp;<span class="op" id="6974357">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6974361">case</span>&nbsp;<span class="ident" id="6974366">CorruptInputError</span><span class="op" id="6974383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974388">testEqual</span><span class="op" id="6974397">(</span><span class="ident" id="6974398">t</span><span class="op" id="6974399">,</span>&nbsp;<span class="string" id="6974401">&#34;Corruption&nbsp;in&nbsp;%q&nbsp;at&nbsp;offset&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6974441">,</span>&nbsp;<span class="ident" id="6974443">e</span><span class="op" id="6974444">.</span><span class="ident" id="6974445">e</span><span class="op" id="6974446">,</span>&nbsp;<span class="builtintype" id="6974448">int</span><span class="op" id="6974451">(</span><span class="ident" id="6974452">err</span><span class="op" id="6974455">)</span><span class="op" id="6974456">,</span>&nbsp;<span class="ident" id="6974458">e</span><span class="op" id="6974459">.</span><span class="ident" id="6974460">p</span><span class="op" id="6974461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6974465">default</span><span class="op" id="6974472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974477">t</span><span class="op" id="6974478">.</span><span class="ident" id="6974479">Error</span><span class="op" id="6974484">(</span><span class="string" id="6974485">&#34;Decoder&nbsp;failed&nbsp;to&nbsp;detect&nbsp;corruption&nbsp;in&#34;</span><span class="op" id="6974525">,</span>&nbsp;<span class="ident" id="6974527">e</span><span class="op" id="6974528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6974532">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6974535">}</span><br>
<span class="lineno"></span><span class="op" id="6974537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6974540">func</span>&nbsp;<span class="ident" id="6974545">TestBig</span><span class="op" id="6974552">(</span><span class="ident" id="6974553">t</span>&nbsp;<span class="op" id="6974555">*</span><span class="ident" id="6974556">testing</span><span class="op" id="6974563">.</span><span class="ident" id="6974564">T</span><span class="op" id="6974565">)</span>&nbsp;<span class="op" id="6974567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974570">n</span>&nbsp;<span class="op" id="6974572">:=</span>&nbsp;<span class="num" id="6974575">3</span><span class="op" id="6974576">*</span><span class="num" id="6974577">1000</span>&nbsp;<span class="op" id="6974582">+</span>&nbsp;<span class="num" id="6974584">1</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974587">raw</span>&nbsp;<span class="op" id="6974591">:=</span>&nbsp;<span class="builtinfunc" id="6974594">make</span><span class="op" id="6974598">(</span><span class="op" id="6974599">[</span><span class="op" id="6974600">]</span><span class="builtintype" id="6974601">byte</span><span class="op" id="6974605">,</span>&nbsp;<span class="ident" id="6974607">n</span><span class="op" id="6974608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6974611">const</span>&nbsp;<span class="ident" id="6974617">alpha</span>&nbsp;<span class="op" id="6974623">=</span>&nbsp;<span class="string" id="6974625">&#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6974691">for</span>&nbsp;<span class="ident" id="6974695">i</span>&nbsp;<span class="op" id="6974697">:=</span>&nbsp;<span class="num" id="6974700">0</span><span class="op" id="6974701">;</span>&nbsp;<span class="ident" id="6974703">i</span>&nbsp;<span class="op" id="6974705">&lt;</span>&nbsp;<span class="ident" id="6974707">n</span><span class="op" id="6974708">;</span>&nbsp;<span class="ident" id="6974710">i</span><span class="op" id="6974711">++</span>&nbsp;<span class="op" id="6974714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974718">raw</span><span class="op" id="6974721">[</span><span class="ident" id="6974722">i</span><span class="op" id="6974723">]</span>&nbsp;<span class="op" id="6974725">=</span>&nbsp;<span class="ident" id="6974727">alpha</span><span class="op" id="6974732">[</span><span class="ident" id="6974733">i</span><span class="op" id="6974734">%</span><span class="builtinfunc" id="6974735">len</span><span class="op" id="6974738">(</span><span class="ident" id="6974739">alpha</span><span class="op" id="6974744">)</span><span class="op" id="6974745">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6974748">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974751">encoded</span>&nbsp;<span class="op" id="6974759">:=</span>&nbsp;<span class="builtinfunc" id="6974762">new</span><span class="op" id="6974765">(</span><span class="ident" id="6974766">bytes</span><span class="op" id="6974771">.</span><span class="ident" id="6974772">Buffer</span><span class="op" id="6974778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974781">w</span>&nbsp;<span class="op" id="6974783">:=</span>&nbsp;<span class="ident" id="6974786">NewEncoder</span><span class="op" id="6974796">(</span><span class="ident" id="6974797">encoded</span><span class="op" id="6974804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974807">nn</span><span class="op" id="6974809">,</span>&nbsp;<span class="ident" id="6974811">err</span>&nbsp;<span class="op" id="6974815">:=</span>&nbsp;<span class="ident" id="6974818">w</span><span class="op" id="6974819">.</span><span class="ident" id="6974820">Write</span><span class="op" id="6974825">(</span><span class="ident" id="6974826">raw</span><span class="op" id="6974829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6974832">if</span>&nbsp;<span class="ident" id="6974835">nn</span>&nbsp;<span class="op" id="6974838">!=</span>&nbsp;<span class="ident" id="6974841">n</span>&nbsp;<span class="op" id="6974843">||</span>&nbsp;<span class="ident" id="6974846">err</span>&nbsp;<span class="op" id="6974850">!=</span>&nbsp;<span class="ident" id="6974853">nil</span>&nbsp;<span class="op" id="6974857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974861">t</span><span class="op" id="6974862">.</span><span class="ident" id="6974863">Fatalf</span><span class="op" id="6974869">(</span><span class="string" id="6974870">&#34;Encoder.Write(raw)&nbsp;=&nbsp;%d,&nbsp;%v&nbsp;want&nbsp;%d,&nbsp;nil&#34;</span><span class="op" id="6974912">,</span>&nbsp;<span class="ident" id="6974914">nn</span><span class="op" id="6974916">,</span>&nbsp;<span class="ident" id="6974918">err</span><span class="op" id="6974921">,</span>&nbsp;<span class="ident" id="6974923">n</span><span class="op" id="6974924">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6974927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974930">err</span>&nbsp;<span class="op" id="6974934">=</span>&nbsp;<span class="ident" id="6974936">w</span><span class="op" id="6974937">.</span><span class="ident" id="6974938">Close</span><span class="op" id="6974943">(</span><span class="op" id="6974944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6974947">if</span>&nbsp;<span class="ident" id="6974950">err</span>&nbsp;<span class="op" id="6974954">!=</span>&nbsp;<span class="ident" id="6974957">nil</span>&nbsp;<span class="op" id="6974961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6974965">t</span><span class="op" id="6974966">.</span><span class="ident" id="6974967">Fatalf</span><span class="op" id="6974973">(</span><span class="string" id="6974974">&#34;Encoder.Close()&nbsp;=&nbsp;%v&nbsp;want&nbsp;nil&#34;</span><span class="op" id="6975005">,</span>&nbsp;<span class="ident" id="6975007">err</span><span class="op" id="6975010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6975013">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6975016">decoded</span><span class="op" id="6975023">,</span>&nbsp;<span class="ident" id="6975025">err</span>&nbsp;<span class="op" id="6975029">:=</span>&nbsp;<span class="ident" id="6975032">ioutil</span><span class="op" id="6975038">.</span><span class="ident" id="6975039">ReadAll</span><span class="op" id="6975046">(</span><span class="ident" id="6975047">NewDecoder</span><span class="op" id="6975057">(</span><span class="ident" id="6975058">encoded</span><span class="op" id="6975065">)</span><span class="op" id="6975066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6975069">if</span>&nbsp;<span class="ident" id="6975072">err</span>&nbsp;<span class="op" id="6975076">!=</span>&nbsp;<span class="ident" id="6975079">nil</span>&nbsp;<span class="op" id="6975083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6975087">t</span><span class="op" id="6975088">.</span><span class="ident" id="6975089">Fatalf</span><span class="op" id="6975095">(</span><span class="string" id="6975096">&#34;io.ReadAll(NewDecoder(...)):&nbsp;%v&#34;</span><span class="op" id="6975129">,</span>&nbsp;<span class="ident" id="6975131">err</span><span class="op" id="6975134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6975137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6975141">if</span>&nbsp;<span class="op" id="6975144">!</span><span class="ident" id="6975145">bytes</span><span class="op" id="6975150">.</span><span class="ident" id="6975151">Equal</span><span class="op" id="6975156">(</span><span class="ident" id="6975157">raw</span><span class="op" id="6975160">,</span>&nbsp;<span class="ident" id="6975162">decoded</span><span class="op" id="6975169">)</span>&nbsp;<span class="op" id="6975171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6975175">var</span>&nbsp;<span class="ident" id="6975179">i</span>&nbsp;<span class="builtintype" id="6975181">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6975187">for</span>&nbsp;<span class="ident" id="6975191">i</span>&nbsp;<span class="op" id="6975193">=</span>&nbsp;<span class="num" id="6975195">0</span><span class="op" id="6975196">;</span>&nbsp;<span class="ident" id="6975198">i</span>&nbsp;<span class="op" id="6975200">&lt;</span>&nbsp;<span class="builtinfunc" id="6975202">len</span><span class="op" id="6975205">(</span><span class="ident" id="6975206">decoded</span><span class="op" id="6975213">)</span>&nbsp;<span class="op" id="6975215">&amp;&amp;</span>&nbsp;<span class="ident" id="6975218">i</span>&nbsp;<span class="op" id="6975220">&lt;</span>&nbsp;<span class="builtinfunc" id="6975222">len</span><span class="op" id="6975225">(</span><span class="ident" id="6975226">raw</span><span class="op" id="6975229">)</span><span class="op" id="6975230">;</span>&nbsp;<span class="ident" id="6975232">i</span><span class="op" id="6975233">++</span>&nbsp;<span class="op" id="6975236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6975241">if</span>&nbsp;<span class="ident" id="6975244">decoded</span><span class="op" id="6975251">[</span><span class="ident" id="6975252">i</span><span class="op" id="6975253">]</span>&nbsp;<span class="op" id="6975255">!=</span>&nbsp;<span class="ident" id="6975258">raw</span><span class="op" id="6975261">[</span><span class="ident" id="6975262">i</span><span class="op" id="6975263">]</span>&nbsp;<span class="op" id="6975265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6975271">break</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6975280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6975284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6975288">t</span><span class="op" id="6975289">.</span><span class="ident" id="6975290">Errorf</span><span class="op" id="6975296">(</span><span class="string" id="6975297">&#34;Decode(Encode(%d-byte&nbsp;string))&nbsp;failed&nbsp;at&nbsp;offset&nbsp;%d&#34;</span><span class="op" id="6975349">,</span>&nbsp;<span class="ident" id="6975351">n</span><span class="op" id="6975352">,</span>&nbsp;<span class="ident" id="6975354">i</span><span class="op" id="6975355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6975358">}</span><br>
<span class="lineno"></span><span class="op" id="6975360">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="6975363">func</span>&nbsp;<span class="ident" id="6975368">TestDecoderInternalWhitespace</span><span class="op" id="6975397">(</span><span class="ident" id="6975398">t</span>&nbsp;<span class="op" id="6975400">*</span><span class="ident" id="6975401">testing</span><span class="op" id="6975408">.</span><span class="ident" id="6975409">T</span><span class="op" id="6975410">)</span>&nbsp;<span class="op" id="6975412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6975415">s</span>&nbsp;<span class="op" id="6975417">:=</span>&nbsp;<span class="ident" id="6975420">strings</span><span class="op" id="6975427">.</span><span class="ident" id="6975428">Repeat</span><span class="op" id="6975434">(</span><span class="string" id="6975435">&#34;&nbsp;&#34;</span><span class="op" id="6975438">,</span>&nbsp;<span class="num" id="6975440">2048</span><span class="op" id="6975444">)</span>&nbsp;<span class="op" id="6975446">+</span>&nbsp;<span class="string" id="6975448">&#34;z&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6975453">decoded</span><span class="op" id="6975460">,</span>&nbsp;<span class="ident" id="6975462">err</span>&nbsp;<span class="op" id="6975466">:=</span>&nbsp;<span class="ident" id="6975469">ioutil</span><span class="op" id="6975475">.</span><span class="ident" id="6975476">ReadAll</span><span class="op" id="6975483">(</span><span class="ident" id="6975484">NewDecoder</span><span class="op" id="6975494">(</span><span class="ident" id="6975495">strings</span><span class="op" id="6975502">.</span><span class="ident" id="6975503">NewReader</span><span class="op" id="6975512">(</span><span class="ident" id="6975513">s</span><span class="op" id="6975514">)</span><span class="op" id="6975515">)</span><span class="op" id="6975516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6975519">if</span>&nbsp;<span class="ident" id="6975522">err</span>&nbsp;<span class="op" id="6975526">!=</span>&nbsp;<span class="ident" id="6975529">nil</span>&nbsp;<span class="op" id="6975533">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6975537">t</span><span class="op" id="6975538">.</span><span class="ident" id="6975539">Errorf</span><span class="op" id="6975545">(</span><span class="string" id="6975546">&#34;Decode&nbsp;gave&nbsp;error&nbsp;%v&#34;</span><span class="op" id="6975568">,</span>&nbsp;<span class="ident" id="6975570">err</span><span class="op" id="6975573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6975576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6975579">if</span>&nbsp;<span class="ident" id="6975582">want</span>&nbsp;<span class="op" id="6975587">:=</span>&nbsp;<span class="op" id="6975590">[</span><span class="op" id="6975591">]</span><span class="builtintype" id="6975592">byte</span><span class="op" id="6975596">(</span><span class="string" id="6975597">&#34;\000\000\000\000&#34;</span><span class="op" id="6975615">)</span><span class="op" id="6975616">;</span>&nbsp;<span class="op" id="6975618">!</span><span class="ident" id="6975619">bytes</span><span class="op" id="6975624">.</span><span class="ident" id="6975625">Equal</span><span class="op" id="6975630">(</span><span class="ident" id="6975631">want</span><span class="op" id="6975635">,</span>&nbsp;<span class="ident" id="6975637">decoded</span><span class="op" id="6975644">)</span>&nbsp;<span class="op" id="6975646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6975650">t</span><span class="op" id="6975651">.</span><span class="ident" id="6975652">Errorf</span><span class="op" id="6975658">(</span><span class="string" id="6975659">&#34;Decode&nbsp;failed:&nbsp;got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6975691">,</span>&nbsp;<span class="ident" id="6975693">decoded</span><span class="op" id="6975700">,</span>&nbsp;<span class="ident" id="6975702">want</span><span class="op" id="6975706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6975709">}</span><br>
<span class="lineno">210</span><span class="op" id="6975711">}</span>
</div>
</body>
</html>
