<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp/syntax</h2>
<ul>
<li><a href="/gostd/regexp/syntax/compile.go.html">compile.go</a></li>
<li><a href="/gostd/regexp/syntax/doc.go.html">doc.go</a></li>
<li><a href="/gostd/regexp/syntax/parse.go.html">parse.go</a></li>
<li><a href="/gostd/regexp/syntax/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/regexp/syntax/perl_groups.go.html">perl_groups.go</a></li>
<li><a href="/gostd/regexp/syntax/prog.go.html" class="current">prog.go</a></li>
<li><a href="/gostd/regexp/syntax/prog_test.go.html">prog_test.go</a></li>
<li><a href="/gostd/regexp/syntax/regexp.go.html">regexp.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify.go.html">simplify.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify_test.go.html">simplify_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3513381">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3513436">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3513490">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3513541">package</span>&nbsp;<span class="ident" id="3513549">syntax</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3513557">import</span>&nbsp;<span class="op" id="3513564">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3513567">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3513576">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3513587">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="3513597">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3513600">//&nbsp;Compiled&nbsp;program.</span><br>
<span class="lineno"></span><span class="comment" id="3513621">//&nbsp;May&nbsp;not&nbsp;belong&nbsp;in&nbsp;this&nbsp;package,&nbsp;but&nbsp;convenient&nbsp;for&nbsp;now.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3513681">//&nbsp;A&nbsp;Prog&nbsp;is&nbsp;a&nbsp;compiled&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="3513733">type</span>&nbsp;<span class="ident" id="3513738">Prog</span>&nbsp;<span class="keyword" id="3513743">struct</span>&nbsp;<span class="op" id="3513750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3513753">Inst</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3513760">[</span><span class="op" id="3513761">]</span><span class="ident" id="3513762">Inst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3513768">Start</span>&nbsp;&nbsp;<span class="builtintype" id="3513775">int</span>&nbsp;<span class="comment" id="3513779">//&nbsp;index&nbsp;of&nbsp;start&nbsp;instruction</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3513810">NumCap</span>&nbsp;<span class="builtintype" id="3513817">int</span>&nbsp;<span class="comment" id="3513821">//&nbsp;number&nbsp;of&nbsp;InstCapture&nbsp;insts&nbsp;in&nbsp;re</span><br>
<span class="lineno"></span><span class="op" id="3513858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3513861">//&nbsp;An&nbsp;InstOp&nbsp;is&nbsp;an&nbsp;instruction&nbsp;opcode.</span><br>
<span class="lineno"></span><span class="keyword" id="3513900">type</span>&nbsp;<span class="ident" id="3513905">InstOp</span>&nbsp;<span class="builtintype" id="3513912">uint8</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="3513919">const</span>&nbsp;<span class="op" id="3513925">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3513928">InstAlt</span>&nbsp;<span class="ident" id="3513936">InstOp</span>&nbsp;<span class="op" id="3513943">=</span>&nbsp;<span class="ident" id="3513945">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3513951">InstAltMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3513965">InstCapture</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3513978">InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3513994">InstMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3514005">InstFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3514015">InstNop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3514024">InstRune</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3514034">InstRune1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3514045">InstRuneAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3514058">InstRuneAnyNotNL</span><br>
<span class="lineno"></span><span class="op" id="3514075">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3514078">var</span>&nbsp;<span class="ident" id="3514082">instOpNames</span>&nbsp;<span class="op" id="3514094">=</span>&nbsp;<span class="op" id="3514096">[</span><span class="op" id="3514097">]</span><span class="builtintype" id="3514098">string</span><span class="op" id="3514104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3514107">&#34;InstAlt&#34;</span><span class="op" id="3514116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3514119">&#34;InstAltMatch&#34;</span><span class="op" id="3514133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3514136">&#34;InstCapture&#34;</span><span class="op" id="3514149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3514152">&#34;InstEmptyWidth&#34;</span><span class="op" id="3514168">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3514171">&#34;InstMatch&#34;</span><span class="op" id="3514182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3514185">&#34;InstFail&#34;</span><span class="op" id="3514195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3514198">&#34;InstNop&#34;</span><span class="op" id="3514207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3514210">&#34;InstRune&#34;</span><span class="op" id="3514220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3514223">&#34;InstRune1&#34;</span><span class="op" id="3514234">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3514237">&#34;InstRuneAny&#34;</span><span class="op" id="3514250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3514253">&#34;InstRuneAnyNotNL&#34;</span><span class="op" id="3514271">,</span><br>
<span class="lineno"></span><span class="op" id="3514273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3514276">func</span>&nbsp;<span class="op" id="3514281">(</span><span class="ident" id="3514282">i</span>&nbsp;<span class="ident" id="3514284">InstOp</span><span class="op" id="3514290">)</span>&nbsp;<span class="ident" id="3514292">String</span><span class="op" id="3514298">(</span><span class="op" id="3514299">)</span>&nbsp;<span class="builtintype" id="3514301">string</span>&nbsp;<span class="op" id="3514308">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3514311">if</span>&nbsp;<span class="builtintype" id="3514314">uint</span><span class="op" id="3514318">(</span><span class="ident" id="3514319">i</span><span class="op" id="3514320">)</span>&nbsp;<span class="op" id="3514322">&gt;=</span>&nbsp;<span class="builtintype" id="3514325">uint</span><span class="op" id="3514329">(</span><span class="builtinfunc" id="3514330">len</span><span class="op" id="3514333">(</span><span class="ident" id="3514334">instOpNames</span><span class="op" id="3514345">)</span><span class="op" id="3514346">)</span>&nbsp;<span class="op" id="3514348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3514352">return</span>&nbsp;<span class="string" id="3514359">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3514363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3514366">return</span>&nbsp;<span class="ident" id="3514373">instOpNames</span><span class="op" id="3514384">[</span><span class="ident" id="3514385">i</span><span class="op" id="3514386">]</span><br>
<span class="lineno"></span><span class="op" id="3514388">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="3514391">//&nbsp;An&nbsp;EmptyOp&nbsp;specifies&nbsp;a&nbsp;kind&nbsp;or&nbsp;mixture&nbsp;of&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="keyword" id="3514459">type</span>&nbsp;<span class="ident" id="3514464">EmptyOp</span>&nbsp;<span class="builtintype" id="3514472">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3514479">const</span>&nbsp;<span class="op" id="3514485">(</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3514488">EmptyBeginLine</span>&nbsp;<span class="ident" id="3514503">EmptyOp</span>&nbsp;<span class="op" id="3514511">=</span>&nbsp;<span class="num" id="3514513">1</span>&nbsp;<span class="op" id="3514515">&lt;&lt;</span>&nbsp;<span class="ident" id="3514518">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3514524">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3514538">EmptyBeginText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3514554">EmptyEndText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3514568">EmptyWordBoundary</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3514587">EmptyNoWordBoundary</span><br>
<span class="lineno"></span><span class="op" id="3514607">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3514610">//&nbsp;EmptyOpContext&nbsp;returns&nbsp;the&nbsp;zero-width&nbsp;assertions</span><br>
<span class="lineno"></span><span class="comment" id="3514662">//&nbsp;satisfied&nbsp;at&nbsp;the&nbsp;position&nbsp;between&nbsp;the&nbsp;runes&nbsp;r1&nbsp;and&nbsp;r2.</span><br>
<span class="lineno">75</span><span class="comment" id="3514720">//&nbsp;Passing&nbsp;r1&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3514771">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="3514804">//&nbsp;Passing&nbsp;r2&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3514855">//&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="3514882">func</span>&nbsp;<span class="ident" id="3514887">EmptyOpContext</span><span class="op" id="3514901">(</span><span class="ident" id="3514902">r1</span><span class="op" id="3514904">,</span>&nbsp;<span class="ident" id="3514906">r2</span>&nbsp;<span class="builtintype" id="3514909">rune</span><span class="op" id="3514913">)</span>&nbsp;<span class="ident" id="3514915">EmptyOp</span>&nbsp;<span class="op" id="3514923">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3514926">var</span>&nbsp;<span class="ident" id="3514930">op</span>&nbsp;<span class="ident" id="3514933">EmptyOp</span>&nbsp;<span class="op" id="3514941">=</span>&nbsp;<span class="ident" id="3514943">EmptyNoWordBoundary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3514964">var</span>&nbsp;<span class="ident" id="3514968">boundary</span>&nbsp;<span class="builtintype" id="3514977">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3514983">switch</span>&nbsp;<span class="op" id="3514990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3514993">case</span>&nbsp;<span class="ident" id="3514998">IsWordChar</span><span class="op" id="3515008">(</span><span class="ident" id="3515009">r1</span><span class="op" id="3515011">)</span><span class="op" id="3515012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515016">boundary</span>&nbsp;<span class="op" id="3515025">=</span>&nbsp;<span class="num" id="3515027">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3515030">case</span>&nbsp;<span class="ident" id="3515035">r1</span>&nbsp;<span class="op" id="3515038">==</span>&nbsp;<span class="string" id="3515041">&#39;\n&#39;</span><span class="op" id="3515045">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515049">op</span>&nbsp;<span class="op" id="3515052">|=</span>&nbsp;<span class="ident" id="3515055">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3515071">case</span>&nbsp;<span class="ident" id="3515076">r1</span>&nbsp;<span class="op" id="3515079">&lt;</span>&nbsp;<span class="num" id="3515081">0</span><span class="op" id="3515082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515086">op</span>&nbsp;<span class="op" id="3515089">|=</span>&nbsp;<span class="ident" id="3515092">EmptyBeginText</span>&nbsp;<span class="op" id="3515107">|</span>&nbsp;<span class="ident" id="3515109">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3515125">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3515128">switch</span>&nbsp;<span class="op" id="3515135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3515138">case</span>&nbsp;<span class="ident" id="3515143">IsWordChar</span><span class="op" id="3515153">(</span><span class="ident" id="3515154">r2</span><span class="op" id="3515156">)</span><span class="op" id="3515157">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515161">boundary</span>&nbsp;<span class="op" id="3515170">^=</span>&nbsp;<span class="num" id="3515173">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3515176">case</span>&nbsp;<span class="ident" id="3515181">r2</span>&nbsp;<span class="op" id="3515184">==</span>&nbsp;<span class="string" id="3515187">&#39;\n&#39;</span><span class="op" id="3515191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515195">op</span>&nbsp;<span class="op" id="3515198">|=</span>&nbsp;<span class="ident" id="3515201">EmptyEndLine</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3515215">case</span>&nbsp;<span class="ident" id="3515220">r2</span>&nbsp;<span class="op" id="3515223">&lt;</span>&nbsp;<span class="num" id="3515225">0</span><span class="op" id="3515226">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515230">op</span>&nbsp;<span class="op" id="3515233">|=</span>&nbsp;<span class="ident" id="3515236">EmptyEndText</span>&nbsp;<span class="op" id="3515249">|</span>&nbsp;<span class="ident" id="3515251">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3515265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3515268">if</span>&nbsp;<span class="ident" id="3515271">boundary</span>&nbsp;<span class="op" id="3515280">!=</span>&nbsp;<span class="num" id="3515283">0</span>&nbsp;<span class="op" id="3515285">{</span>&nbsp;<span class="comment" id="3515287">//&nbsp;IsWordChar(r1)&nbsp;!=&nbsp;IsWordChar(r2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515325">op</span>&nbsp;<span class="op" id="3515328">^=</span>&nbsp;<span class="op" id="3515331">(</span><span class="ident" id="3515332">EmptyWordBoundary</span>&nbsp;<span class="op" id="3515350">|</span>&nbsp;<span class="ident" id="3515352">EmptyNoWordBoundary</span><span class="op" id="3515371">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3515374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3515377">return</span>&nbsp;<span class="ident" id="3515384">op</span><br>
<span class="lineno"></span><span class="op" id="3515387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3515390">//&nbsp;IsWordChar&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;consider&nbsp;a&nbsp;``word&nbsp;character&#39;&#39;</span><br>
<span class="lineno">105</span><span class="comment" id="3515455">//&nbsp;during&nbsp;the&nbsp;evaluation&nbsp;of&nbsp;the&nbsp;\b&nbsp;and&nbsp;\B&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="comment" id="3515520">//&nbsp;These&nbsp;assertions&nbsp;are&nbsp;ASCII-only:&nbsp;the&nbsp;word&nbsp;characters&nbsp;are&nbsp;[A-Za-z0-9_].</span><br>
<span class="lineno"></span><span class="keyword" id="3515594">func</span>&nbsp;<span class="ident" id="3515599">IsWordChar</span><span class="op" id="3515609">(</span><span class="ident" id="3515610">r</span>&nbsp;<span class="builtintype" id="3515612">rune</span><span class="op" id="3515616">)</span>&nbsp;<span class="builtintype" id="3515618">bool</span>&nbsp;<span class="op" id="3515623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3515626">return</span>&nbsp;<span class="string" id="3515633">&#39;A&#39;</span>&nbsp;<span class="op" id="3515637">&lt;=</span>&nbsp;<span class="ident" id="3515640">r</span>&nbsp;<span class="op" id="3515642">&amp;&amp;</span>&nbsp;<span class="ident" id="3515645">r</span>&nbsp;<span class="op" id="3515647">&lt;=</span>&nbsp;<span class="string" id="3515650">&#39;Z&#39;</span>&nbsp;<span class="op" id="3515654">||</span>&nbsp;<span class="string" id="3515657">&#39;a&#39;</span>&nbsp;<span class="op" id="3515661">&lt;=</span>&nbsp;<span class="ident" id="3515664">r</span>&nbsp;<span class="op" id="3515666">&amp;&amp;</span>&nbsp;<span class="ident" id="3515669">r</span>&nbsp;<span class="op" id="3515671">&lt;=</span>&nbsp;<span class="string" id="3515674">&#39;z&#39;</span>&nbsp;<span class="op" id="3515678">||</span>&nbsp;<span class="string" id="3515681">&#39;0&#39;</span>&nbsp;<span class="op" id="3515685">&lt;=</span>&nbsp;<span class="ident" id="3515688">r</span>&nbsp;<span class="op" id="3515690">&amp;&amp;</span>&nbsp;<span class="ident" id="3515693">r</span>&nbsp;<span class="op" id="3515695">&lt;=</span>&nbsp;<span class="string" id="3515698">&#39;9&#39;</span>&nbsp;<span class="op" id="3515702">||</span>&nbsp;<span class="ident" id="3515705">r</span>&nbsp;<span class="op" id="3515707">==</span>&nbsp;<span class="string" id="3515710">&#39;_&#39;</span><br>
<span class="lineno"></span><span class="op" id="3515714">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="3515717">//&nbsp;An&nbsp;Inst&nbsp;is&nbsp;a&nbsp;single&nbsp;instruction&nbsp;in&nbsp;a&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="3515785">type</span>&nbsp;<span class="ident" id="3515790">Inst</span>&nbsp;<span class="keyword" id="3515795">struct</span>&nbsp;<span class="op" id="3515802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515805">Op</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3515810">InstOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515818">Out</span>&nbsp;&nbsp;<span class="builtintype" id="3515823">uint32</span>&nbsp;<span class="comment" id="3515830">//&nbsp;all&nbsp;but&nbsp;InstMatch,&nbsp;InstFail</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515862">Arg</span>&nbsp;&nbsp;<span class="builtintype" id="3515867">uint32</span>&nbsp;<span class="comment" id="3515874">//&nbsp;InstAlt,&nbsp;InstAltMatch,&nbsp;InstCapture,&nbsp;InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515929">Rune</span>&nbsp;<span class="op" id="3515934">[</span><span class="op" id="3515935">]</span><span class="builtintype" id="3515936">rune</span><br>
<span class="lineno"></span><span class="op" id="3515941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3515944">func</span>&nbsp;<span class="op" id="3515949">(</span><span class="ident" id="3515950">p</span>&nbsp;<span class="op" id="3515952">*</span><span class="ident" id="3515953">Prog</span><span class="op" id="3515957">)</span>&nbsp;<span class="ident" id="3515959">String</span><span class="op" id="3515965">(</span><span class="op" id="3515966">)</span>&nbsp;<span class="builtintype" id="3515968">string</span>&nbsp;<span class="op" id="3515975">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3515978">var</span>&nbsp;<span class="ident" id="3515982">b</span>&nbsp;<span class="ident" id="3515984">bytes</span><span class="op" id="3515989">.</span><span class="ident" id="3515990">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515998">dumpProg</span><span class="op" id="3516006">(</span><span class="op" id="3516007">&amp;</span><span class="ident" id="3516008">b</span><span class="op" id="3516009">,</span>&nbsp;<span class="ident" id="3516011">p</span><span class="op" id="3516012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3516015">return</span>&nbsp;<span class="ident" id="3516022">b</span><span class="op" id="3516023">.</span><span class="ident" id="3516024">String</span><span class="op" id="3516030">(</span><span class="op" id="3516031">)</span><br>
<span class="lineno"></span><span class="op" id="3516033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3516036">//&nbsp;skipNop&nbsp;follows&nbsp;any&nbsp;no-op&nbsp;or&nbsp;capturing&nbsp;instructions</span><br>
<span class="lineno"></span><span class="comment" id="3516091">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;pc.</span><br>
<span class="lineno"></span><span class="keyword" id="3516124">func</span>&nbsp;<span class="op" id="3516129">(</span><span class="ident" id="3516130">p</span>&nbsp;<span class="op" id="3516132">*</span><span class="ident" id="3516133">Prog</span><span class="op" id="3516137">)</span>&nbsp;<span class="ident" id="3516139">skipNop</span><span class="op" id="3516146">(</span><span class="ident" id="3516147">pc</span>&nbsp;<span class="builtintype" id="3516150">uint32</span><span class="op" id="3516156">)</span>&nbsp;<span class="op" id="3516158">(</span><span class="op" id="3516159">*</span><span class="ident" id="3516160">Inst</span><span class="op" id="3516164">,</span>&nbsp;<span class="builtintype" id="3516166">uint32</span><span class="op" id="3516172">)</span>&nbsp;<span class="op" id="3516174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3516177">i</span>&nbsp;<span class="op" id="3516179">:=</span>&nbsp;<span class="op" id="3516182">&amp;</span><span class="ident" id="3516183">p</span><span class="op" id="3516184">.</span><span class="ident" id="3516185">Inst</span><span class="op" id="3516189">[</span><span class="ident" id="3516190">pc</span><span class="op" id="3516192">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3516195">for</span>&nbsp;<span class="ident" id="3516199">i</span><span class="op" id="3516200">.</span><span class="ident" id="3516201">Op</span>&nbsp;<span class="op" id="3516204">==</span>&nbsp;<span class="ident" id="3516207">InstNop</span>&nbsp;<span class="op" id="3516215">||</span>&nbsp;<span class="ident" id="3516218">i</span><span class="op" id="3516219">.</span><span class="ident" id="3516220">Op</span>&nbsp;<span class="op" id="3516223">==</span>&nbsp;<span class="ident" id="3516226">InstCapture</span>&nbsp;<span class="op" id="3516238">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3516242">pc</span>&nbsp;<span class="op" id="3516245">=</span>&nbsp;<span class="ident" id="3516247">i</span><span class="op" id="3516248">.</span><span class="ident" id="3516249">Out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3516255">i</span>&nbsp;<span class="op" id="3516257">=</span>&nbsp;<span class="op" id="3516259">&amp;</span><span class="ident" id="3516260">p</span><span class="op" id="3516261">.</span><span class="ident" id="3516262">Inst</span><span class="op" id="3516266">[</span><span class="ident" id="3516267">pc</span><span class="op" id="3516269">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3516272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3516275">return</span>&nbsp;<span class="ident" id="3516282">i</span><span class="op" id="3516283">,</span>&nbsp;<span class="ident" id="3516285">pc</span><br>
<span class="lineno"></span><span class="op" id="3516288">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="3516291">//&nbsp;op&nbsp;returns&nbsp;i.Op&nbsp;but&nbsp;merges&nbsp;all&nbsp;the&nbsp;Rune&nbsp;special&nbsp;cases&nbsp;into&nbsp;InstRune</span><br>
<span class="lineno"></span><span class="keyword" id="3516362">func</span>&nbsp;<span class="op" id="3516367">(</span><span class="ident" id="3516368">i</span>&nbsp;<span class="op" id="3516370">*</span><span class="ident" id="3516371">Inst</span><span class="op" id="3516375">)</span>&nbsp;<span class="ident" id="3516377">op</span><span class="op" id="3516379">(</span><span class="op" id="3516380">)</span>&nbsp;<span class="ident" id="3516382">InstOp</span>&nbsp;<span class="op" id="3516389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3516392">op</span>&nbsp;<span class="op" id="3516395">:=</span>&nbsp;<span class="ident" id="3516398">i</span><span class="op" id="3516399">.</span><span class="ident" id="3516400">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3516404">switch</span>&nbsp;<span class="ident" id="3516411">op</span>&nbsp;<span class="op" id="3516414">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3516417">case</span>&nbsp;<span class="ident" id="3516422">InstRune1</span><span class="op" id="3516431">,</span>&nbsp;<span class="ident" id="3516433">InstRuneAny</span><span class="op" id="3516444">,</span>&nbsp;<span class="ident" id="3516446">InstRuneAnyNotNL</span><span class="op" id="3516462">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3516466">op</span>&nbsp;<span class="op" id="3516469">=</span>&nbsp;<span class="ident" id="3516471">InstRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3516481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3516484">return</span>&nbsp;<span class="ident" id="3516491">op</span><br>
<span class="lineno"></span><span class="op" id="3516494">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="3516497">//&nbsp;Prefix&nbsp;returns&nbsp;a&nbsp;literal&nbsp;string&nbsp;that&nbsp;all&nbsp;matches&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3516557">//&nbsp;regexp&nbsp;must&nbsp;start&nbsp;with.&nbsp;&nbsp;Complete&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;prefix</span><br>
<span class="lineno"></span><span class="comment" id="3516616">//&nbsp;is&nbsp;the&nbsp;entire&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3516640">func</span>&nbsp;<span class="op" id="3516645">(</span><span class="ident" id="3516646">p</span>&nbsp;<span class="op" id="3516648">*</span><span class="ident" id="3516649">Prog</span><span class="op" id="3516653">)</span>&nbsp;<span class="ident" id="3516655">Prefix</span><span class="op" id="3516661">(</span><span class="op" id="3516662">)</span>&nbsp;<span class="op" id="3516664">(</span><span class="ident" id="3516665">prefix</span>&nbsp;<span class="builtintype" id="3516672">string</span><span class="op" id="3516678">,</span>&nbsp;<span class="ident" id="3516680">complete</span>&nbsp;<span class="builtintype" id="3516689">bool</span><span class="op" id="3516693">)</span>&nbsp;<span class="op" id="3516695">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3516698">i</span><span class="op" id="3516699">,</span>&nbsp;<span class="ident" id="3516701">_</span>&nbsp;<span class="op" id="3516703">:=</span>&nbsp;<span class="ident" id="3516706">p</span><span class="op" id="3516707">.</span><span class="ident" id="3516708">skipNop</span><span class="op" id="3516715">(</span><span class="builtintype" id="3516716">uint32</span><span class="op" id="3516722">(</span><span class="ident" id="3516723">p</span><span class="op" id="3516724">.</span><span class="ident" id="3516725">Start</span><span class="op" id="3516730">)</span><span class="op" id="3516731">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3516735">//&nbsp;Avoid&nbsp;allocation&nbsp;of&nbsp;buffer&nbsp;if&nbsp;prefix&nbsp;is&nbsp;empty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3516786">if</span>&nbsp;<span class="ident" id="3516789">i</span><span class="op" id="3516790">.</span><span class="ident" id="3516791">op</span><span class="op" id="3516793">(</span><span class="op" id="3516794">)</span>&nbsp;<span class="op" id="3516796">!=</span>&nbsp;<span class="ident" id="3516799">InstRune</span>&nbsp;<span class="op" id="3516808">||</span>&nbsp;<span class="builtinfunc" id="3516811">len</span><span class="op" id="3516814">(</span><span class="ident" id="3516815">i</span><span class="op" id="3516816">.</span><span class="ident" id="3516817">Rune</span><span class="op" id="3516821">)</span>&nbsp;<span class="op" id="3516823">!=</span>&nbsp;<span class="num" id="3516826">1</span>&nbsp;<span class="op" id="3516828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3516832">return</span>&nbsp;<span class="string" id="3516839">&#34;&#34;</span><span class="op" id="3516841">,</span>&nbsp;<span class="ident" id="3516843">i</span><span class="op" id="3516844">.</span><span class="ident" id="3516845">Op</span>&nbsp;<span class="op" id="3516848">==</span>&nbsp;<span class="ident" id="3516851">InstMatch</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3516862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3516866">//&nbsp;Have&nbsp;prefix;&nbsp;gather&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3516902">var</span>&nbsp;<span class="ident" id="3516906">buf</span>&nbsp;<span class="ident" id="3516910">bytes</span><span class="op" id="3516915">.</span><span class="ident" id="3516916">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3516924">for</span>&nbsp;<span class="ident" id="3516928">i</span><span class="op" id="3516929">.</span><span class="ident" id="3516930">op</span><span class="op" id="3516932">(</span><span class="op" id="3516933">)</span>&nbsp;<span class="op" id="3516935">==</span>&nbsp;<span class="ident" id="3516938">InstRune</span>&nbsp;<span class="op" id="3516947">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3516950">len</span><span class="op" id="3516953">(</span><span class="ident" id="3516954">i</span><span class="op" id="3516955">.</span><span class="ident" id="3516956">Rune</span><span class="op" id="3516960">)</span>&nbsp;<span class="op" id="3516962">==</span>&nbsp;<span class="num" id="3516965">1</span>&nbsp;<span class="op" id="3516967">&amp;&amp;</span>&nbsp;<span class="ident" id="3516970">Flags</span><span class="op" id="3516975">(</span><span class="ident" id="3516976">i</span><span class="op" id="3516977">.</span><span class="ident" id="3516978">Arg</span><span class="op" id="3516981">)</span><span class="op" id="3516982">&amp;</span><span class="ident" id="3516983">FoldCase</span>&nbsp;<span class="op" id="3516992">==</span>&nbsp;<span class="num" id="3516995">0</span>&nbsp;<span class="op" id="3516997">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3517001">buf</span><span class="op" id="3517004">.</span><span class="ident" id="3517005">WriteRune</span><span class="op" id="3517014">(</span><span class="ident" id="3517015">i</span><span class="op" id="3517016">.</span><span class="ident" id="3517017">Rune</span><span class="op" id="3517021">[</span><span class="num" id="3517022">0</span><span class="op" id="3517023">]</span><span class="op" id="3517024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3517028">i</span><span class="op" id="3517029">,</span>&nbsp;<span class="ident" id="3517031">_</span>&nbsp;<span class="op" id="3517033">=</span>&nbsp;<span class="ident" id="3517035">p</span><span class="op" id="3517036">.</span><span class="ident" id="3517037">skipNop</span><span class="op" id="3517044">(</span><span class="ident" id="3517045">i</span><span class="op" id="3517046">.</span><span class="ident" id="3517047">Out</span><span class="op" id="3517050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3517053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3517056">return</span>&nbsp;<span class="ident" id="3517063">buf</span><span class="op" id="3517066">.</span><span class="ident" id="3517067">String</span><span class="op" id="3517073">(</span><span class="op" id="3517074">)</span><span class="op" id="3517075">,</span>&nbsp;<span class="ident" id="3517077">i</span><span class="op" id="3517078">.</span><span class="ident" id="3517079">Op</span>&nbsp;<span class="op" id="3517082">==</span>&nbsp;<span class="ident" id="3517085">InstMatch</span><br>
<span class="lineno"></span><span class="op" id="3517095">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="3517098">//&nbsp;StartCond&nbsp;returns&nbsp;the&nbsp;leading&nbsp;empty-width&nbsp;conditions&nbsp;that&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="3517164">//&nbsp;be&nbsp;true&nbsp;in&nbsp;any&nbsp;match.&nbsp;&nbsp;It&nbsp;returns&nbsp;^EmptyOp(0)&nbsp;if&nbsp;no&nbsp;matches&nbsp;are&nbsp;possible.</span><br>
<span class="lineno"></span><span class="keyword" id="3517241">func</span>&nbsp;<span class="op" id="3517246">(</span><span class="ident" id="3517247">p</span>&nbsp;<span class="op" id="3517249">*</span><span class="ident" id="3517250">Prog</span><span class="op" id="3517254">)</span>&nbsp;<span class="ident" id="3517256">StartCond</span><span class="op" id="3517265">(</span><span class="op" id="3517266">)</span>&nbsp;<span class="ident" id="3517268">EmptyOp</span>&nbsp;<span class="op" id="3517276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3517279">var</span>&nbsp;<span class="ident" id="3517283">flag</span>&nbsp;<span class="ident" id="3517288">EmptyOp</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3517297">pc</span>&nbsp;<span class="op" id="3517300">:=</span>&nbsp;<span class="builtintype" id="3517303">uint32</span><span class="op" id="3517309">(</span><span class="ident" id="3517310">p</span><span class="op" id="3517311">.</span><span class="ident" id="3517312">Start</span><span class="op" id="3517317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3517320">i</span>&nbsp;<span class="op" id="3517322">:=</span>&nbsp;<span class="op" id="3517325">&amp;</span><span class="ident" id="3517326">p</span><span class="op" id="3517327">.</span><span class="ident" id="3517328">Inst</span><span class="op" id="3517332">[</span><span class="ident" id="3517333">pc</span><span class="op" id="3517335">]</span><br>
<span class="lineno"></span><span class="ident" id="3517337">Loop</span><span class="op" id="3517341">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3517344">for</span>&nbsp;<span class="op" id="3517348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3517352">switch</span>&nbsp;<span class="ident" id="3517359">i</span><span class="op" id="3517360">.</span><span class="ident" id="3517361">Op</span>&nbsp;<span class="op" id="3517364">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3517368">case</span>&nbsp;<span class="ident" id="3517373">InstEmptyWidth</span><span class="op" id="3517387">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3517392">flag</span>&nbsp;<span class="op" id="3517397">|=</span>&nbsp;<span class="ident" id="3517400">EmptyOp</span><span class="op" id="3517407">(</span><span class="ident" id="3517408">i</span><span class="op" id="3517409">.</span><span class="ident" id="3517410">Arg</span><span class="op" id="3517413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3517417">case</span>&nbsp;<span class="ident" id="3517422">InstFail</span><span class="op" id="3517430">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3517435">return</span>&nbsp;<span class="op" id="3517442">^</span><span class="ident" id="3517443">EmptyOp</span><span class="op" id="3517450">(</span><span class="num" id="3517451">0</span><span class="op" id="3517452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3517456">case</span>&nbsp;<span class="ident" id="3517461">InstCapture</span><span class="op" id="3517472">,</span>&nbsp;<span class="ident" id="3517474">InstNop</span><span class="op" id="3517481">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3517486">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3517496">default</span><span class="op" id="3517503">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3517508">break</span>&nbsp;<span class="ident" id="3517514">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3517521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3517525">pc</span>&nbsp;<span class="op" id="3517528">=</span>&nbsp;<span class="ident" id="3517530">i</span><span class="op" id="3517531">.</span><span class="ident" id="3517532">Out</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3517538">i</span>&nbsp;<span class="op" id="3517540">=</span>&nbsp;<span class="op" id="3517542">&amp;</span><span class="ident" id="3517543">p</span><span class="op" id="3517544">.</span><span class="ident" id="3517545">Inst</span><span class="op" id="3517549">[</span><span class="ident" id="3517550">pc</span><span class="op" id="3517552">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3517555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3517558">return</span>&nbsp;<span class="ident" id="3517565">flag</span><br>
<span class="lineno"></span><span class="op" id="3517570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="3517573">const</span>&nbsp;<span class="ident" id="3517579">noMatch</span>&nbsp;<span class="op" id="3517587">=</span>&nbsp;<span class="op" id="3517589">-</span><span class="num" id="3517590">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3517593">//&nbsp;MatchRune&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="3517664">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="3517715">func</span>&nbsp;<span class="op" id="3517720">(</span><span class="ident" id="3517721">i</span>&nbsp;<span class="op" id="3517723">*</span><span class="ident" id="3517724">Inst</span><span class="op" id="3517728">)</span>&nbsp;<span class="ident" id="3517730">MatchRune</span><span class="op" id="3517739">(</span><span class="ident" id="3517740">r</span>&nbsp;<span class="builtintype" id="3517742">rune</span><span class="op" id="3517746">)</span>&nbsp;<span class="builtintype" id="3517748">bool</span>&nbsp;<span class="op" id="3517753">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3517756">return</span>&nbsp;<span class="ident" id="3517763">i</span><span class="op" id="3517764">.</span><span class="ident" id="3517765">MatchRunePos</span><span class="op" id="3517777">(</span><span class="ident" id="3517778">r</span><span class="op" id="3517779">)</span>&nbsp;<span class="op" id="3517781">!=</span>&nbsp;<span class="ident" id="3517784">noMatch</span><br>
<span class="lineno"></span><span class="op" id="3517792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3517795">//&nbsp;MatchRunePos&nbsp;checks&nbsp;whether&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="3517868">//&nbsp;If&nbsp;so,&nbsp;MatchRunePos&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;matching&nbsp;rune&nbsp;pair</span><br>
<span class="lineno">200</span><span class="comment" id="3517935">//&nbsp;(or,&nbsp;when&nbsp;len(i.Rune)&nbsp;==&nbsp;1,&nbsp;rune&nbsp;singleton).</span><br>
<span class="lineno"></span><span class="comment" id="3517983">//&nbsp;If&nbsp;not,&nbsp;MatchRunePos&nbsp;returns&nbsp;-1.</span><br>
<span class="lineno"></span><span class="comment" id="3518019">//&nbsp;MatchRunePos&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="3518080">func</span>&nbsp;<span class="op" id="3518085">(</span><span class="ident" id="3518086">i</span>&nbsp;<span class="op" id="3518088">*</span><span class="ident" id="3518089">Inst</span><span class="op" id="3518093">)</span>&nbsp;<span class="ident" id="3518095">MatchRunePos</span><span class="op" id="3518107">(</span><span class="ident" id="3518108">r</span>&nbsp;<span class="builtintype" id="3518110">rune</span><span class="op" id="3518114">)</span>&nbsp;<span class="builtintype" id="3518116">int</span>&nbsp;<span class="op" id="3518120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3518123">rune</span>&nbsp;<span class="op" id="3518128">:=</span>&nbsp;<span class="ident" id="3518131">i</span><span class="op" id="3518132">.</span><span class="ident" id="3518133">Rune</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3518140">//&nbsp;Special&nbsp;case:&nbsp;single-rune&nbsp;slice&nbsp;is&nbsp;from&nbsp;literal&nbsp;string,&nbsp;not&nbsp;char&nbsp;class.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518216">if</span>&nbsp;<span class="builtinfunc" id="3518219">len</span><span class="op" id="3518222">(</span><span class="builtintype" id="3518223">rune</span><span class="op" id="3518227">)</span>&nbsp;<span class="op" id="3518229">==</span>&nbsp;<span class="num" id="3518232">1</span>&nbsp;<span class="op" id="3518234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3518238">r0</span>&nbsp;<span class="op" id="3518241">:=</span>&nbsp;<span class="builtintype" id="3518244">rune</span><span class="op" id="3518248">[</span><span class="num" id="3518249">0</span><span class="op" id="3518250">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518254">if</span>&nbsp;<span class="ident" id="3518257">r</span>&nbsp;<span class="op" id="3518259">==</span>&nbsp;<span class="ident" id="3518262">r0</span>&nbsp;<span class="op" id="3518265">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518270">return</span>&nbsp;<span class="num" id="3518277">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3518281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518285">if</span>&nbsp;<span class="ident" id="3518288">Flags</span><span class="op" id="3518293">(</span><span class="ident" id="3518294">i</span><span class="op" id="3518295">.</span><span class="ident" id="3518296">Arg</span><span class="op" id="3518299">)</span><span class="op" id="3518300">&amp;</span><span class="ident" id="3518301">FoldCase</span>&nbsp;<span class="op" id="3518310">!=</span>&nbsp;<span class="num" id="3518313">0</span>&nbsp;<span class="op" id="3518315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518320">for</span>&nbsp;<span class="ident" id="3518324">r1</span>&nbsp;<span class="op" id="3518327">:=</span>&nbsp;<span class="ident" id="3518330">unicode</span><span class="op" id="3518337">.</span><span class="ident" id="3518338">SimpleFold</span><span class="op" id="3518348">(</span><span class="ident" id="3518349">r0</span><span class="op" id="3518351">)</span><span class="op" id="3518352">;</span>&nbsp;<span class="ident" id="3518354">r1</span>&nbsp;<span class="op" id="3518357">!=</span>&nbsp;<span class="ident" id="3518360">r0</span><span class="op" id="3518362">;</span>&nbsp;<span class="ident" id="3518364">r1</span>&nbsp;<span class="op" id="3518367">=</span>&nbsp;<span class="ident" id="3518369">unicode</span><span class="op" id="3518376">.</span><span class="ident" id="3518377">SimpleFold</span><span class="op" id="3518387">(</span><span class="ident" id="3518388">r1</span><span class="op" id="3518390">)</span>&nbsp;<span class="op" id="3518392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518398">if</span>&nbsp;<span class="ident" id="3518401">r</span>&nbsp;<span class="op" id="3518403">==</span>&nbsp;<span class="ident" id="3518406">r1</span>&nbsp;<span class="op" id="3518409">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518416">return</span>&nbsp;<span class="num" id="3518423">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3518429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3518434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3518438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518442">return</span>&nbsp;<span class="ident" id="3518449">noMatch</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3518458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3518462">//&nbsp;Peek&nbsp;at&nbsp;the&nbsp;first&nbsp;few&nbsp;pairs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3518495">//&nbsp;Should&nbsp;handle&nbsp;ASCII&nbsp;well.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518525">for</span>&nbsp;<span class="ident" id="3518529">j</span>&nbsp;<span class="op" id="3518531">:=</span>&nbsp;<span class="num" id="3518534">0</span><span class="op" id="3518535">;</span>&nbsp;<span class="ident" id="3518537">j</span>&nbsp;<span class="op" id="3518539">&lt;</span>&nbsp;<span class="builtinfunc" id="3518541">len</span><span class="op" id="3518544">(</span><span class="builtintype" id="3518545">rune</span><span class="op" id="3518549">)</span>&nbsp;<span class="op" id="3518551">&amp;&amp;</span>&nbsp;<span class="ident" id="3518554">j</span>&nbsp;<span class="op" id="3518556">&lt;=</span>&nbsp;<span class="num" id="3518559">8</span><span class="op" id="3518560">;</span>&nbsp;<span class="ident" id="3518562">j</span>&nbsp;<span class="op" id="3518564">+=</span>&nbsp;<span class="num" id="3518567">2</span>&nbsp;<span class="op" id="3518569">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518573">if</span>&nbsp;<span class="ident" id="3518576">r</span>&nbsp;<span class="op" id="3518578">&lt;</span>&nbsp;<span class="builtintype" id="3518580">rune</span><span class="op" id="3518584">[</span><span class="ident" id="3518585">j</span><span class="op" id="3518586">]</span>&nbsp;<span class="op" id="3518588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518593">return</span>&nbsp;<span class="ident" id="3518600">noMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3518610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518614">if</span>&nbsp;<span class="ident" id="3518617">r</span>&nbsp;<span class="op" id="3518619">&lt;=</span>&nbsp;<span class="builtintype" id="3518622">rune</span><span class="op" id="3518626">[</span><span class="ident" id="3518627">j</span><span class="op" id="3518628">+</span><span class="num" id="3518629">1</span><span class="op" id="3518630">]</span>&nbsp;<span class="op" id="3518632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518637">return</span>&nbsp;<span class="ident" id="3518644">j</span>&nbsp;<span class="op" id="3518646">/</span>&nbsp;<span class="num" id="3518648">2</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3518652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3518655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3518659">//&nbsp;Otherwise&nbsp;binary&nbsp;search.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3518688">lo</span>&nbsp;<span class="op" id="3518691">:=</span>&nbsp;<span class="num" id="3518694">0</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3518697">hi</span>&nbsp;<span class="op" id="3518700">:=</span>&nbsp;<span class="builtinfunc" id="3518703">len</span><span class="op" id="3518706">(</span><span class="builtintype" id="3518707">rune</span><span class="op" id="3518711">)</span>&nbsp;<span class="op" id="3518713">/</span>&nbsp;<span class="num" id="3518715">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518718">for</span>&nbsp;<span class="ident" id="3518722">lo</span>&nbsp;<span class="op" id="3518725">&lt;</span>&nbsp;<span class="ident" id="3518727">hi</span>&nbsp;<span class="op" id="3518730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3518734">m</span>&nbsp;<span class="op" id="3518736">:=</span>&nbsp;<span class="ident" id="3518739">lo</span>&nbsp;<span class="op" id="3518742">+</span>&nbsp;<span class="op" id="3518744">(</span><span class="ident" id="3518745">hi</span><span class="op" id="3518747">-</span><span class="ident" id="3518748">lo</span><span class="op" id="3518750">)</span><span class="op" id="3518751">/</span><span class="num" id="3518752">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518756">if</span>&nbsp;<span class="ident" id="3518759">c</span>&nbsp;<span class="op" id="3518761">:=</span>&nbsp;<span class="builtintype" id="3518764">rune</span><span class="op" id="3518768">[</span><span class="num" id="3518769">2</span><span class="op" id="3518770">*</span><span class="ident" id="3518771">m</span><span class="op" id="3518772">]</span><span class="op" id="3518773">;</span>&nbsp;<span class="ident" id="3518775">c</span>&nbsp;<span class="op" id="3518777">&lt;=</span>&nbsp;<span class="ident" id="3518780">r</span>&nbsp;<span class="op" id="3518782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518787">if</span>&nbsp;<span class="ident" id="3518790">r</span>&nbsp;<span class="op" id="3518792">&lt;=</span>&nbsp;<span class="builtintype" id="3518795">rune</span><span class="op" id="3518799">[</span><span class="num" id="3518800">2</span><span class="op" id="3518801">*</span><span class="ident" id="3518802">m</span><span class="op" id="3518803">+</span><span class="num" id="3518804">1</span><span class="op" id="3518805">]</span>&nbsp;<span class="op" id="3518807">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518813">return</span>&nbsp;<span class="ident" id="3518820">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3518825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3518830">lo</span>&nbsp;<span class="op" id="3518833">=</span>&nbsp;<span class="ident" id="3518835">m</span>&nbsp;<span class="op" id="3518837">+</span>&nbsp;<span class="num" id="3518839">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3518843">}</span>&nbsp;<span class="keyword" id="3518845">else</span>&nbsp;<span class="op" id="3518850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3518855">hi</span>&nbsp;<span class="op" id="3518858">=</span>&nbsp;<span class="ident" id="3518860">m</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3518864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3518867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3518870">return</span>&nbsp;<span class="ident" id="3518877">noMatch</span><br>
<span class="lineno"></span><span class="op" id="3518885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="3518888">//&nbsp;As&nbsp;per&nbsp;re2&#39;s&nbsp;Prog::IsWordChar.&nbsp;Determines&nbsp;whether&nbsp;rune&nbsp;is&nbsp;an&nbsp;ASCII&nbsp;word&nbsp;char.</span><br>
<span class="lineno"></span><span class="comment" id="3518969">//&nbsp;Since&nbsp;we&nbsp;act&nbsp;on&nbsp;runes,&nbsp;it&nbsp;would&nbsp;be&nbsp;easy&nbsp;to&nbsp;support&nbsp;Unicode&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="3519037">func</span>&nbsp;<span class="ident" id="3519042">wordRune</span><span class="op" id="3519050">(</span><span class="ident" id="3519051">r</span>&nbsp;<span class="builtintype" id="3519053">rune</span><span class="op" id="3519057">)</span>&nbsp;<span class="builtintype" id="3519059">bool</span>&nbsp;<span class="op" id="3519064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519067">return</span>&nbsp;<span class="ident" id="3519074">r</span>&nbsp;<span class="op" id="3519076">==</span>&nbsp;<span class="string" id="3519079">&#39;_&#39;</span>&nbsp;<span class="op" id="3519083">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3519088">(</span><span class="string" id="3519089">&#39;A&#39;</span>&nbsp;<span class="op" id="3519093">&lt;=</span>&nbsp;<span class="ident" id="3519096">r</span>&nbsp;<span class="op" id="3519098">&amp;&amp;</span>&nbsp;<span class="ident" id="3519101">r</span>&nbsp;<span class="op" id="3519103">&lt;=</span>&nbsp;<span class="string" id="3519106">&#39;Z&#39;</span><span class="op" id="3519109">)</span>&nbsp;<span class="op" id="3519111">||</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3519116">(</span><span class="string" id="3519117">&#39;a&#39;</span>&nbsp;<span class="op" id="3519121">&lt;=</span>&nbsp;<span class="ident" id="3519124">r</span>&nbsp;<span class="op" id="3519126">&amp;&amp;</span>&nbsp;<span class="ident" id="3519129">r</span>&nbsp;<span class="op" id="3519131">&lt;=</span>&nbsp;<span class="string" id="3519134">&#39;z&#39;</span><span class="op" id="3519137">)</span>&nbsp;<span class="op" id="3519139">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3519144">(</span><span class="string" id="3519145">&#39;0&#39;</span>&nbsp;<span class="op" id="3519149">&lt;=</span>&nbsp;<span class="ident" id="3519152">r</span>&nbsp;<span class="op" id="3519154">&amp;&amp;</span>&nbsp;<span class="ident" id="3519157">r</span>&nbsp;<span class="op" id="3519159">&lt;=</span>&nbsp;<span class="string" id="3519162">&#39;9&#39;</span><span class="op" id="3519165">)</span><br>
<span class="lineno"></span><span class="op" id="3519167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3519170">//&nbsp;MatchEmptyWidth&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches</span><br>
<span class="lineno">260</span><span class="comment" id="3519229">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;between&nbsp;the&nbsp;runes&nbsp;before&nbsp;and&nbsp;after.</span><br>
<span class="lineno"></span><span class="comment" id="3519284">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstEmptyWidth.</span><br>
<span class="lineno"></span><span class="keyword" id="3519341">func</span>&nbsp;<span class="op" id="3519346">(</span><span class="ident" id="3519347">i</span>&nbsp;<span class="op" id="3519349">*</span><span class="ident" id="3519350">Inst</span><span class="op" id="3519354">)</span>&nbsp;<span class="ident" id="3519356">MatchEmptyWidth</span><span class="op" id="3519371">(</span><span class="ident" id="3519372">before</span>&nbsp;<span class="builtintype" id="3519379">rune</span><span class="op" id="3519383">,</span>&nbsp;<span class="ident" id="3519385">after</span>&nbsp;<span class="builtintype" id="3519391">rune</span><span class="op" id="3519395">)</span>&nbsp;<span class="builtintype" id="3519397">bool</span>&nbsp;<span class="op" id="3519402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519405">switch</span>&nbsp;<span class="ident" id="3519412">EmptyOp</span><span class="op" id="3519419">(</span><span class="ident" id="3519420">i</span><span class="op" id="3519421">.</span><span class="ident" id="3519422">Arg</span><span class="op" id="3519425">)</span>&nbsp;<span class="op" id="3519427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519430">case</span>&nbsp;<span class="ident" id="3519435">EmptyBeginLine</span><span class="op" id="3519449">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519453">return</span>&nbsp;<span class="ident" id="3519460">before</span>&nbsp;<span class="op" id="3519467">==</span>&nbsp;<span class="string" id="3519470">&#39;\n&#39;</span>&nbsp;<span class="op" id="3519475">||</span>&nbsp;<span class="ident" id="3519478">before</span>&nbsp;<span class="op" id="3519485">==</span>&nbsp;<span class="op" id="3519488">-</span><span class="num" id="3519489">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519492">case</span>&nbsp;<span class="ident" id="3519497">EmptyEndLine</span><span class="op" id="3519509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519513">return</span>&nbsp;<span class="ident" id="3519520">after</span>&nbsp;<span class="op" id="3519526">==</span>&nbsp;<span class="string" id="3519529">&#39;\n&#39;</span>&nbsp;<span class="op" id="3519534">||</span>&nbsp;<span class="ident" id="3519537">after</span>&nbsp;<span class="op" id="3519543">==</span>&nbsp;<span class="op" id="3519546">-</span><span class="num" id="3519547">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519550">case</span>&nbsp;<span class="ident" id="3519555">EmptyBeginText</span><span class="op" id="3519569">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519573">return</span>&nbsp;<span class="ident" id="3519580">before</span>&nbsp;<span class="op" id="3519587">==</span>&nbsp;<span class="op" id="3519590">-</span><span class="num" id="3519591">1</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519594">case</span>&nbsp;<span class="ident" id="3519599">EmptyEndText</span><span class="op" id="3519611">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519615">return</span>&nbsp;<span class="ident" id="3519622">after</span>&nbsp;<span class="op" id="3519628">==</span>&nbsp;<span class="op" id="3519631">-</span><span class="num" id="3519632">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519635">case</span>&nbsp;<span class="ident" id="3519640">EmptyWordBoundary</span><span class="op" id="3519657">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519661">return</span>&nbsp;<span class="ident" id="3519668">wordRune</span><span class="op" id="3519676">(</span><span class="ident" id="3519677">before</span><span class="op" id="3519683">)</span>&nbsp;<span class="op" id="3519685">!=</span>&nbsp;<span class="ident" id="3519688">wordRune</span><span class="op" id="3519696">(</span><span class="ident" id="3519697">after</span><span class="op" id="3519702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519705">case</span>&nbsp;<span class="ident" id="3519710">EmptyNoWordBoundary</span><span class="op" id="3519729">:</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519733">return</span>&nbsp;<span class="ident" id="3519740">wordRune</span><span class="op" id="3519748">(</span><span class="ident" id="3519749">before</span><span class="op" id="3519755">)</span>&nbsp;<span class="op" id="3519757">==</span>&nbsp;<span class="ident" id="3519760">wordRune</span><span class="op" id="3519768">(</span><span class="ident" id="3519769">after</span><span class="op" id="3519774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3519777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3519780">panic</span><span class="op" id="3519785">(</span><span class="string" id="3519786">&#34;unknown&nbsp;empty&nbsp;width&nbsp;arg&#34;</span><span class="op" id="3519811">)</span><br>
<span class="lineno"></span><span class="op" id="3519813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="3519816">func</span>&nbsp;<span class="op" id="3519821">(</span><span class="ident" id="3519822">i</span>&nbsp;<span class="op" id="3519824">*</span><span class="ident" id="3519825">Inst</span><span class="op" id="3519829">)</span>&nbsp;<span class="ident" id="3519831">String</span><span class="op" id="3519837">(</span><span class="op" id="3519838">)</span>&nbsp;<span class="builtintype" id="3519840">string</span>&nbsp;<span class="op" id="3519847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519850">var</span>&nbsp;<span class="ident" id="3519854">b</span>&nbsp;<span class="ident" id="3519856">bytes</span><span class="op" id="3519861">.</span><span class="ident" id="3519862">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3519870">dumpInst</span><span class="op" id="3519878">(</span><span class="op" id="3519879">&amp;</span><span class="ident" id="3519880">b</span><span class="op" id="3519881">,</span>&nbsp;<span class="ident" id="3519883">i</span><span class="op" id="3519884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519887">return</span>&nbsp;<span class="ident" id="3519894">b</span><span class="op" id="3519895">.</span><span class="ident" id="3519896">String</span><span class="op" id="3519902">(</span><span class="op" id="3519903">)</span><br>
<span class="lineno"></span><span class="op" id="3519905">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="3519908">func</span>&nbsp;<span class="ident" id="3519913">bw</span><span class="op" id="3519915">(</span><span class="ident" id="3519916">b</span>&nbsp;<span class="op" id="3519918">*</span><span class="ident" id="3519919">bytes</span><span class="op" id="3519924">.</span><span class="ident" id="3519925">Buffer</span><span class="op" id="3519931">,</span>&nbsp;<span class="ident" id="3519933">args</span>&nbsp;<span class="op" id="3519938">...</span><span class="builtintype" id="3519941">string</span><span class="op" id="3519947">)</span>&nbsp;<span class="op" id="3519949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3519952">for</span>&nbsp;<span class="ident" id="3519956">_</span><span class="op" id="3519957">,</span>&nbsp;<span class="ident" id="3519959">s</span>&nbsp;<span class="op" id="3519961">:=</span>&nbsp;<span class="keyword" id="3519964">range</span>&nbsp;<span class="ident" id="3519970">args</span>&nbsp;<span class="op" id="3519975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3519979">b</span><span class="op" id="3519980">.</span><span class="ident" id="3519981">WriteString</span><span class="op" id="3519992">(</span><span class="ident" id="3519993">s</span><span class="op" id="3519994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3519997">}</span><br>
<span class="lineno">290</span><span class="op" id="3519999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3520002">func</span>&nbsp;<span class="ident" id="3520007">dumpProg</span><span class="op" id="3520015">(</span><span class="ident" id="3520016">b</span>&nbsp;<span class="op" id="3520018">*</span><span class="ident" id="3520019">bytes</span><span class="op" id="3520024">.</span><span class="ident" id="3520025">Buffer</span><span class="op" id="3520031">,</span>&nbsp;<span class="ident" id="3520033">p</span>&nbsp;<span class="op" id="3520035">*</span><span class="ident" id="3520036">Prog</span><span class="op" id="3520040">)</span>&nbsp;<span class="op" id="3520042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520045">for</span>&nbsp;<span class="ident" id="3520049">j</span>&nbsp;<span class="op" id="3520051">:=</span>&nbsp;<span class="keyword" id="3520054">range</span>&nbsp;<span class="ident" id="3520060">p</span><span class="op" id="3520061">.</span><span class="ident" id="3520062">Inst</span>&nbsp;<span class="op" id="3520067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520071">i</span>&nbsp;<span class="op" id="3520073">:=</span>&nbsp;<span class="op" id="3520076">&amp;</span><span class="ident" id="3520077">p</span><span class="op" id="3520078">.</span><span class="ident" id="3520079">Inst</span><span class="op" id="3520083">[</span><span class="ident" id="3520084">j</span><span class="op" id="3520085">]</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520089">pc</span>&nbsp;<span class="op" id="3520092">:=</span>&nbsp;<span class="ident" id="3520095">strconv</span><span class="op" id="3520102">.</span><span class="ident" id="3520103">Itoa</span><span class="op" id="3520107">(</span><span class="ident" id="3520108">j</span><span class="op" id="3520109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520113">if</span>&nbsp;<span class="builtinfunc" id="3520116">len</span><span class="op" id="3520119">(</span><span class="ident" id="3520120">pc</span><span class="op" id="3520122">)</span>&nbsp;<span class="op" id="3520124">&lt;</span>&nbsp;<span class="num" id="3520126">3</span>&nbsp;<span class="op" id="3520128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520133">b</span><span class="op" id="3520134">.</span><span class="ident" id="3520135">WriteString</span><span class="op" id="3520146">(</span><span class="string" id="3520147">&#34;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="3520152">[</span><span class="builtinfunc" id="3520153">len</span><span class="op" id="3520156">(</span><span class="ident" id="3520157">pc</span><span class="op" id="3520159">)</span><span class="op" id="3520160">:</span><span class="op" id="3520161">]</span><span class="op" id="3520162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3520166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520170">if</span>&nbsp;<span class="ident" id="3520173">j</span>&nbsp;<span class="op" id="3520175">==</span>&nbsp;<span class="ident" id="3520178">p</span><span class="op" id="3520179">.</span><span class="ident" id="3520180">Start</span>&nbsp;<span class="op" id="3520186">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520191">pc</span>&nbsp;<span class="op" id="3520194">+=</span>&nbsp;<span class="string" id="3520197">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3520203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520207">bw</span><span class="op" id="3520209">(</span><span class="ident" id="3520210">b</span><span class="op" id="3520211">,</span>&nbsp;<span class="ident" id="3520213">pc</span><span class="op" id="3520215">,</span>&nbsp;<span class="string" id="3520217">&#34;\t&#34;</span><span class="op" id="3520221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520225">dumpInst</span><span class="op" id="3520233">(</span><span class="ident" id="3520234">b</span><span class="op" id="3520235">,</span>&nbsp;<span class="ident" id="3520237">i</span><span class="op" id="3520238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520242">bw</span><span class="op" id="3520244">(</span><span class="ident" id="3520245">b</span><span class="op" id="3520246">,</span>&nbsp;<span class="string" id="3520248">&#34;\n&#34;</span><span class="op" id="3520252">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3520255">}</span><br>
<span class="lineno"></span><span class="op" id="3520257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3520260">func</span>&nbsp;<span class="ident" id="3520265">u32</span><span class="op" id="3520268">(</span><span class="ident" id="3520269">i</span>&nbsp;<span class="builtintype" id="3520271">uint32</span><span class="op" id="3520277">)</span>&nbsp;<span class="builtintype" id="3520279">string</span>&nbsp;<span class="op" id="3520286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520289">return</span>&nbsp;<span class="ident" id="3520296">strconv</span><span class="op" id="3520303">.</span><span class="ident" id="3520304">FormatUint</span><span class="op" id="3520314">(</span><span class="ident" id="3520315">uint64</span><span class="op" id="3520321">(</span><span class="ident" id="3520322">i</span><span class="op" id="3520323">)</span><span class="op" id="3520324">,</span>&nbsp;<span class="num" id="3520326">10</span><span class="op" id="3520328">)</span><br>
<span class="lineno">310</span><span class="op" id="3520330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3520333">func</span>&nbsp;<span class="ident" id="3520338">dumpInst</span><span class="op" id="3520346">(</span><span class="ident" id="3520347">b</span>&nbsp;<span class="op" id="3520349">*</span><span class="ident" id="3520350">bytes</span><span class="op" id="3520355">.</span><span class="ident" id="3520356">Buffer</span><span class="op" id="3520362">,</span>&nbsp;<span class="ident" id="3520364">i</span>&nbsp;<span class="op" id="3520366">*</span><span class="ident" id="3520367">Inst</span><span class="op" id="3520371">)</span>&nbsp;<span class="op" id="3520373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520376">switch</span>&nbsp;<span class="ident" id="3520383">i</span><span class="op" id="3520384">.</span><span class="ident" id="3520385">Op</span>&nbsp;<span class="op" id="3520388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520391">case</span>&nbsp;<span class="ident" id="3520396">InstAlt</span><span class="op" id="3520403">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520407">bw</span><span class="op" id="3520409">(</span><span class="ident" id="3520410">b</span><span class="op" id="3520411">,</span>&nbsp;<span class="string" id="3520413">&#34;alt&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3520422">,</span>&nbsp;<span class="ident" id="3520424">u32</span><span class="op" id="3520427">(</span><span class="ident" id="3520428">i</span><span class="op" id="3520429">.</span><span class="ident" id="3520430">Out</span><span class="op" id="3520433">)</span><span class="op" id="3520434">,</span>&nbsp;<span class="string" id="3520436">&#34;,&nbsp;&#34;</span><span class="op" id="3520440">,</span>&nbsp;<span class="ident" id="3520442">u32</span><span class="op" id="3520445">(</span><span class="ident" id="3520446">i</span><span class="op" id="3520447">.</span><span class="ident" id="3520448">Arg</span><span class="op" id="3520451">)</span><span class="op" id="3520452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520455">case</span>&nbsp;<span class="ident" id="3520460">InstAltMatch</span><span class="op" id="3520472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520476">bw</span><span class="op" id="3520478">(</span><span class="ident" id="3520479">b</span><span class="op" id="3520480">,</span>&nbsp;<span class="string" id="3520482">&#34;altmatch&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3520496">,</span>&nbsp;<span class="ident" id="3520498">u32</span><span class="op" id="3520501">(</span><span class="ident" id="3520502">i</span><span class="op" id="3520503">.</span><span class="ident" id="3520504">Out</span><span class="op" id="3520507">)</span><span class="op" id="3520508">,</span>&nbsp;<span class="string" id="3520510">&#34;,&nbsp;&#34;</span><span class="op" id="3520514">,</span>&nbsp;<span class="ident" id="3520516">u32</span><span class="op" id="3520519">(</span><span class="ident" id="3520520">i</span><span class="op" id="3520521">.</span><span class="ident" id="3520522">Arg</span><span class="op" id="3520525">)</span><span class="op" id="3520526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520529">case</span>&nbsp;<span class="ident" id="3520534">InstCapture</span><span class="op" id="3520545">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520549">bw</span><span class="op" id="3520551">(</span><span class="ident" id="3520552">b</span><span class="op" id="3520553">,</span>&nbsp;<span class="string" id="3520555">&#34;cap&nbsp;&#34;</span><span class="op" id="3520561">,</span>&nbsp;<span class="ident" id="3520563">u32</span><span class="op" id="3520566">(</span><span class="ident" id="3520567">i</span><span class="op" id="3520568">.</span><span class="ident" id="3520569">Arg</span><span class="op" id="3520572">)</span><span class="op" id="3520573">,</span>&nbsp;<span class="string" id="3520575">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3520581">,</span>&nbsp;<span class="ident" id="3520583">u32</span><span class="op" id="3520586">(</span><span class="ident" id="3520587">i</span><span class="op" id="3520588">.</span><span class="ident" id="3520589">Out</span><span class="op" id="3520592">)</span><span class="op" id="3520593">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520596">case</span>&nbsp;<span class="ident" id="3520601">InstEmptyWidth</span><span class="op" id="3520615">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520619">bw</span><span class="op" id="3520621">(</span><span class="ident" id="3520622">b</span><span class="op" id="3520623">,</span>&nbsp;<span class="string" id="3520625">&#34;empty&nbsp;&#34;</span><span class="op" id="3520633">,</span>&nbsp;<span class="ident" id="3520635">u32</span><span class="op" id="3520638">(</span><span class="ident" id="3520639">i</span><span class="op" id="3520640">.</span><span class="ident" id="3520641">Arg</span><span class="op" id="3520644">)</span><span class="op" id="3520645">,</span>&nbsp;<span class="string" id="3520647">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3520653">,</span>&nbsp;<span class="ident" id="3520655">u32</span><span class="op" id="3520658">(</span><span class="ident" id="3520659">i</span><span class="op" id="3520660">.</span><span class="ident" id="3520661">Out</span><span class="op" id="3520664">)</span><span class="op" id="3520665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520668">case</span>&nbsp;<span class="ident" id="3520673">InstMatch</span><span class="op" id="3520682">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520686">bw</span><span class="op" id="3520688">(</span><span class="ident" id="3520689">b</span><span class="op" id="3520690">,</span>&nbsp;<span class="string" id="3520692">&#34;match&#34;</span><span class="op" id="3520699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520702">case</span>&nbsp;<span class="ident" id="3520707">InstFail</span><span class="op" id="3520715">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520719">bw</span><span class="op" id="3520721">(</span><span class="ident" id="3520722">b</span><span class="op" id="3520723">,</span>&nbsp;<span class="string" id="3520725">&#34;fail&#34;</span><span class="op" id="3520731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520734">case</span>&nbsp;<span class="ident" id="3520739">InstNop</span><span class="op" id="3520746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520750">bw</span><span class="op" id="3520752">(</span><span class="ident" id="3520753">b</span><span class="op" id="3520754">,</span>&nbsp;<span class="string" id="3520756">&#34;nop&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3520765">,</span>&nbsp;<span class="ident" id="3520767">u32</span><span class="op" id="3520770">(</span><span class="ident" id="3520771">i</span><span class="op" id="3520772">.</span><span class="ident" id="3520773">Out</span><span class="op" id="3520776">)</span><span class="op" id="3520777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520780">case</span>&nbsp;<span class="ident" id="3520785">InstRune</span><span class="op" id="3520793">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520797">if</span>&nbsp;<span class="ident" id="3520800">i</span><span class="op" id="3520801">.</span><span class="ident" id="3520802">Rune</span>&nbsp;<span class="op" id="3520807">==</span>&nbsp;<span class="builtintype" id="3520810">nil</span>&nbsp;<span class="op" id="3520814">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3520819">//&nbsp;shouldn&#39;t&nbsp;happen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520842">bw</span><span class="op" id="3520844">(</span><span class="ident" id="3520845">b</span><span class="op" id="3520846">,</span>&nbsp;<span class="string" id="3520848">&#34;rune&nbsp;&lt;nil&gt;&#34;</span><span class="op" id="3520860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3520864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520868">bw</span><span class="op" id="3520870">(</span><span class="ident" id="3520871">b</span><span class="op" id="3520872">,</span>&nbsp;<span class="string" id="3520874">&#34;rune&nbsp;&#34;</span><span class="op" id="3520881">,</span>&nbsp;<span class="ident" id="3520883">strconv</span><span class="op" id="3520890">.</span><span class="ident" id="3520891">QuoteToASCII</span><span class="op" id="3520903">(</span><span class="builtintype" id="3520904">string</span><span class="op" id="3520910">(</span><span class="ident" id="3520911">i</span><span class="op" id="3520912">.</span><span class="ident" id="3520913">Rune</span><span class="op" id="3520917">)</span><span class="op" id="3520918">)</span><span class="op" id="3520919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3520923">if</span>&nbsp;<span class="ident" id="3520926">Flags</span><span class="op" id="3520931">(</span><span class="ident" id="3520932">i</span><span class="op" id="3520933">.</span><span class="ident" id="3520934">Arg</span><span class="op" id="3520937">)</span><span class="op" id="3520938">&amp;</span><span class="ident" id="3520939">FoldCase</span>&nbsp;<span class="op" id="3520948">!=</span>&nbsp;<span class="num" id="3520951">0</span>&nbsp;<span class="op" id="3520953">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520958">bw</span><span class="op" id="3520960">(</span><span class="ident" id="3520961">b</span><span class="op" id="3520962">,</span>&nbsp;<span class="string" id="3520964">&#34;/i&#34;</span><span class="op" id="3520968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3520972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3520976">bw</span><span class="op" id="3520978">(</span><span class="ident" id="3520979">b</span><span class="op" id="3520980">,</span>&nbsp;<span class="string" id="3520982">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3520988">,</span>&nbsp;<span class="ident" id="3520990">u32</span><span class="op" id="3520993">(</span><span class="ident" id="3520994">i</span><span class="op" id="3520995">.</span><span class="ident" id="3520996">Out</span><span class="op" id="3520999">)</span><span class="op" id="3521000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3521003">case</span>&nbsp;<span class="ident" id="3521008">InstRune1</span><span class="op" id="3521017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3521021">bw</span><span class="op" id="3521023">(</span><span class="ident" id="3521024">b</span><span class="op" id="3521025">,</span>&nbsp;<span class="string" id="3521027">&#34;rune1&nbsp;&#34;</span><span class="op" id="3521035">,</span>&nbsp;<span class="ident" id="3521037">strconv</span><span class="op" id="3521044">.</span><span class="ident" id="3521045">QuoteToASCII</span><span class="op" id="3521057">(</span><span class="builtintype" id="3521058">string</span><span class="op" id="3521064">(</span><span class="ident" id="3521065">i</span><span class="op" id="3521066">.</span><span class="ident" id="3521067">Rune</span><span class="op" id="3521071">)</span><span class="op" id="3521072">)</span><span class="op" id="3521073">,</span>&nbsp;<span class="string" id="3521075">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3521081">,</span>&nbsp;<span class="ident" id="3521083">u32</span><span class="op" id="3521086">(</span><span class="ident" id="3521087">i</span><span class="op" id="3521088">.</span><span class="ident" id="3521089">Out</span><span class="op" id="3521092">)</span><span class="op" id="3521093">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3521096">case</span>&nbsp;<span class="ident" id="3521101">InstRuneAny</span><span class="op" id="3521112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3521116">bw</span><span class="op" id="3521118">(</span><span class="ident" id="3521119">b</span><span class="op" id="3521120">,</span>&nbsp;<span class="string" id="3521122">&#34;any&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3521131">,</span>&nbsp;<span class="ident" id="3521133">u32</span><span class="op" id="3521136">(</span><span class="ident" id="3521137">i</span><span class="op" id="3521138">.</span><span class="ident" id="3521139">Out</span><span class="op" id="3521142">)</span><span class="op" id="3521143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3521146">case</span>&nbsp;<span class="ident" id="3521151">InstRuneAnyNotNL</span><span class="op" id="3521167">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3521171">bw</span><span class="op" id="3521173">(</span><span class="ident" id="3521174">b</span><span class="op" id="3521175">,</span>&nbsp;<span class="string" id="3521177">&#34;anynotnl&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3521191">,</span>&nbsp;<span class="ident" id="3521193">u32</span><span class="op" id="3521196">(</span><span class="ident" id="3521197">i</span><span class="op" id="3521198">.</span><span class="ident" id="3521199">Out</span><span class="op" id="3521202">)</span><span class="op" id="3521203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3521206">}</span><br>
<span class="lineno">345</span><span class="op" id="3521208">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
