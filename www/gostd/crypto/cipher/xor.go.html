<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html" class="current">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3492956">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3493011">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3493065">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3493116">package</span>&nbsp;<span class="ident" id="3493124">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3493132">import</span>&nbsp;<span class="op" id="3493139">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3493142">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3493153">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3493162">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3493165">const</span>&nbsp;<span class="ident" id="3493171">wordSize</span>&nbsp;<span class="op" id="3493180">=</span>&nbsp;<span class="builtintype" id="3493182">int</span><span class="op" id="3493185">(</span><span class="ident" id="3493186">unsafe</span><span class="op" id="3493192">.</span><span class="ident" id="3493193">Sizeof</span><span class="op" id="3493199">(</span><span class="builtintype" id="3493200">uintptr</span><span class="op" id="3493207">(</span><span class="num" id="3493208">0</span><span class="op" id="3493209">)</span><span class="op" id="3493210">)</span><span class="op" id="3493211">)</span><br>
<span class="lineno"></span><span class="keyword" id="3493213">const</span>&nbsp;<span class="ident" id="3493219">supportsUnaligned</span>&nbsp;<span class="op" id="3493237">=</span>&nbsp;<span class="ident" id="3493239">runtime</span><span class="op" id="3493246">.</span><span class="ident" id="3493247">GOARCH</span>&nbsp;<span class="op" id="3493254">==</span>&nbsp;<span class="string" id="3493257">&#34;386&#34;</span>&nbsp;<span class="op" id="3493263">||</span>&nbsp;<span class="ident" id="3493266">runtime</span><span class="op" id="3493273">.</span><span class="ident" id="3493274">GOARCH</span>&nbsp;<span class="op" id="3493281">==</span>&nbsp;<span class="string" id="3493284">&#34;amd64&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3493293">//&nbsp;fastXORBytes&nbsp;xors&nbsp;in&nbsp;bulk.&nbsp;It&nbsp;only&nbsp;works&nbsp;on&nbsp;architectures&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3493359">//&nbsp;support&nbsp;unaligned&nbsp;read/writes.</span><br>
<span class="lineno"></span><span class="keyword" id="3493393">func</span>&nbsp;<span class="ident" id="3493398">fastXORBytes</span><span class="op" id="3493410">(</span><span class="ident" id="3493411">dst</span><span class="op" id="3493414">,</span>&nbsp;<span class="ident" id="3493416">a</span><span class="op" id="3493417">,</span>&nbsp;<span class="ident" id="3493419">b</span>&nbsp;<span class="op" id="3493421">[</span><span class="op" id="3493422">]</span><span class="builtintype" id="3493423">byte</span><span class="op" id="3493427">)</span>&nbsp;<span class="builtintype" id="3493429">int</span>&nbsp;<span class="op" id="3493433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493436">n</span>&nbsp;<span class="op" id="3493438">:=</span>&nbsp;<span class="builtinfunc" id="3493441">len</span><span class="op" id="3493444">(</span><span class="ident" id="3493445">a</span><span class="op" id="3493446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493449">if</span>&nbsp;<span class="builtinfunc" id="3493452">len</span><span class="op" id="3493455">(</span><span class="ident" id="3493456">b</span><span class="op" id="3493457">)</span>&nbsp;<span class="op" id="3493459">&lt;</span>&nbsp;<span class="ident" id="3493461">n</span>&nbsp;<span class="op" id="3493463">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493467">n</span>&nbsp;<span class="op" id="3493469">=</span>&nbsp;<span class="builtinfunc" id="3493471">len</span><span class="op" id="3493474">(</span><span class="ident" id="3493475">b</span><span class="op" id="3493476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3493479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493483">w</span>&nbsp;<span class="op" id="3493485">:=</span>&nbsp;<span class="ident" id="3493488">n</span>&nbsp;<span class="op" id="3493490">/</span>&nbsp;<span class="ident" id="3493492">wordSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493502">if</span>&nbsp;<span class="ident" id="3493505">w</span>&nbsp;<span class="op" id="3493507">&gt;</span>&nbsp;<span class="num" id="3493509">0</span>&nbsp;<span class="op" id="3493511">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493515">dw</span>&nbsp;<span class="op" id="3493518">:=</span>&nbsp;<span class="op" id="3493521">*</span><span class="op" id="3493522">(</span><span class="op" id="3493523">*</span><span class="op" id="3493524">[</span><span class="op" id="3493525">]</span><span class="builtintype" id="3493526">uintptr</span><span class="op" id="3493533">)</span><span class="op" id="3493534">(</span><span class="ident" id="3493535">unsafe</span><span class="op" id="3493541">.</span><span class="ident" id="3493542">Pointer</span><span class="op" id="3493549">(</span><span class="op" id="3493550">&amp;</span><span class="ident" id="3493551">dst</span><span class="op" id="3493554">)</span><span class="op" id="3493555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493559">aw</span>&nbsp;<span class="op" id="3493562">:=</span>&nbsp;<span class="op" id="3493565">*</span><span class="op" id="3493566">(</span><span class="op" id="3493567">*</span><span class="op" id="3493568">[</span><span class="op" id="3493569">]</span><span class="builtintype" id="3493570">uintptr</span><span class="op" id="3493577">)</span><span class="op" id="3493578">(</span><span class="ident" id="3493579">unsafe</span><span class="op" id="3493585">.</span><span class="ident" id="3493586">Pointer</span><span class="op" id="3493593">(</span><span class="op" id="3493594">&amp;</span><span class="ident" id="3493595">a</span><span class="op" id="3493596">)</span><span class="op" id="3493597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493601">bw</span>&nbsp;<span class="op" id="3493604">:=</span>&nbsp;<span class="op" id="3493607">*</span><span class="op" id="3493608">(</span><span class="op" id="3493609">*</span><span class="op" id="3493610">[</span><span class="op" id="3493611">]</span><span class="builtintype" id="3493612">uintptr</span><span class="op" id="3493619">)</span><span class="op" id="3493620">(</span><span class="ident" id="3493621">unsafe</span><span class="op" id="3493627">.</span><span class="ident" id="3493628">Pointer</span><span class="op" id="3493635">(</span><span class="op" id="3493636">&amp;</span><span class="ident" id="3493637">b</span><span class="op" id="3493638">)</span><span class="op" id="3493639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493643">for</span>&nbsp;<span class="ident" id="3493647">i</span>&nbsp;<span class="op" id="3493649">:=</span>&nbsp;<span class="num" id="3493652">0</span><span class="op" id="3493653">;</span>&nbsp;<span class="ident" id="3493655">i</span>&nbsp;<span class="op" id="3493657">&lt;</span>&nbsp;<span class="ident" id="3493659">w</span><span class="op" id="3493660">;</span>&nbsp;<span class="ident" id="3493662">i</span><span class="op" id="3493663">++</span>&nbsp;<span class="op" id="3493666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493671">dw</span><span class="op" id="3493673">[</span><span class="ident" id="3493674">i</span><span class="op" id="3493675">]</span>&nbsp;<span class="op" id="3493677">=</span>&nbsp;<span class="ident" id="3493679">aw</span><span class="op" id="3493681">[</span><span class="ident" id="3493682">i</span><span class="op" id="3493683">]</span>&nbsp;<span class="op" id="3493685">^</span>&nbsp;<span class="ident" id="3493687">bw</span><span class="op" id="3493689">[</span><span class="ident" id="3493690">i</span><span class="op" id="3493691">]</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3493695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3493698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493702">for</span>&nbsp;<span class="ident" id="3493706">i</span>&nbsp;<span class="op" id="3493708">:=</span>&nbsp;<span class="op" id="3493711">(</span><span class="ident" id="3493712">n</span>&nbsp;<span class="op" id="3493714">-</span>&nbsp;<span class="ident" id="3493716">n</span><span class="op" id="3493717">%</span><span class="ident" id="3493718">wordSize</span><span class="op" id="3493726">)</span><span class="op" id="3493727">;</span>&nbsp;<span class="ident" id="3493729">i</span>&nbsp;<span class="op" id="3493731">&lt;</span>&nbsp;<span class="ident" id="3493733">n</span><span class="op" id="3493734">;</span>&nbsp;<span class="ident" id="3493736">i</span><span class="op" id="3493737">++</span>&nbsp;<span class="op" id="3493740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493744">dst</span><span class="op" id="3493747">[</span><span class="ident" id="3493748">i</span><span class="op" id="3493749">]</span>&nbsp;<span class="op" id="3493751">=</span>&nbsp;<span class="ident" id="3493753">a</span><span class="op" id="3493754">[</span><span class="ident" id="3493755">i</span><span class="op" id="3493756">]</span>&nbsp;<span class="op" id="3493758">^</span>&nbsp;<span class="ident" id="3493760">b</span><span class="op" id="3493761">[</span><span class="ident" id="3493762">i</span><span class="op" id="3493763">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3493766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493770">return</span>&nbsp;<span class="ident" id="3493777">n</span><br>
<span class="lineno"></span><span class="op" id="3493779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3493782">func</span>&nbsp;<span class="ident" id="3493787">safeXORBytes</span><span class="op" id="3493799">(</span><span class="ident" id="3493800">dst</span><span class="op" id="3493803">,</span>&nbsp;<span class="ident" id="3493805">a</span><span class="op" id="3493806">,</span>&nbsp;<span class="ident" id="3493808">b</span>&nbsp;<span class="op" id="3493810">[</span><span class="op" id="3493811">]</span><span class="builtintype" id="3493812">byte</span><span class="op" id="3493816">)</span>&nbsp;<span class="builtintype" id="3493818">int</span>&nbsp;<span class="op" id="3493822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493825">n</span>&nbsp;<span class="op" id="3493827">:=</span>&nbsp;<span class="builtinfunc" id="3493830">len</span><span class="op" id="3493833">(</span><span class="ident" id="3493834">a</span><span class="op" id="3493835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493838">if</span>&nbsp;<span class="builtinfunc" id="3493841">len</span><span class="op" id="3493844">(</span><span class="ident" id="3493845">b</span><span class="op" id="3493846">)</span>&nbsp;<span class="op" id="3493848">&lt;</span>&nbsp;<span class="ident" id="3493850">n</span>&nbsp;<span class="op" id="3493852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493856">n</span>&nbsp;<span class="op" id="3493858">=</span>&nbsp;<span class="builtinfunc" id="3493860">len</span><span class="op" id="3493863">(</span><span class="ident" id="3493864">b</span><span class="op" id="3493865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3493868">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493871">for</span>&nbsp;<span class="ident" id="3493875">i</span>&nbsp;<span class="op" id="3493877">:=</span>&nbsp;<span class="num" id="3493880">0</span><span class="op" id="3493881">;</span>&nbsp;<span class="ident" id="3493883">i</span>&nbsp;<span class="op" id="3493885">&lt;</span>&nbsp;<span class="ident" id="3493887">n</span><span class="op" id="3493888">;</span>&nbsp;<span class="ident" id="3493890">i</span><span class="op" id="3493891">++</span>&nbsp;<span class="op" id="3493894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493898">dst</span><span class="op" id="3493901">[</span><span class="ident" id="3493902">i</span><span class="op" id="3493903">]</span>&nbsp;<span class="op" id="3493905">=</span>&nbsp;<span class="ident" id="3493907">a</span><span class="op" id="3493908">[</span><span class="ident" id="3493909">i</span><span class="op" id="3493910">]</span>&nbsp;<span class="op" id="3493912">^</span>&nbsp;<span class="ident" id="3493914">b</span><span class="op" id="3493915">[</span><span class="ident" id="3493916">i</span><span class="op" id="3493917">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3493920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493923">return</span>&nbsp;<span class="ident" id="3493930">n</span><br>
<span class="lineno"></span><span class="op" id="3493932">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="3493935">//&nbsp;xorBytes&nbsp;xors&nbsp;the&nbsp;bytes&nbsp;in&nbsp;a&nbsp;and&nbsp;b.&nbsp;The&nbsp;destination&nbsp;is&nbsp;assumed&nbsp;to&nbsp;have&nbsp;enough</span><br>
<span class="lineno"></span><span class="comment" id="3494016">//&nbsp;space.&nbsp;Returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;xor&#39;d.</span><br>
<span class="lineno"></span><span class="keyword" id="3494061">func</span>&nbsp;<span class="ident" id="3494066">xorBytes</span><span class="op" id="3494074">(</span><span class="ident" id="3494075">dst</span><span class="op" id="3494078">,</span>&nbsp;<span class="ident" id="3494080">a</span><span class="op" id="3494081">,</span>&nbsp;<span class="ident" id="3494083">b</span>&nbsp;<span class="op" id="3494085">[</span><span class="op" id="3494086">]</span><span class="builtintype" id="3494087">byte</span><span class="op" id="3494091">)</span>&nbsp;<span class="builtintype" id="3494093">int</span>&nbsp;<span class="op" id="3494097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494100">if</span>&nbsp;<span class="ident" id="3494103">supportsUnaligned</span>&nbsp;<span class="op" id="3494121">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494125">return</span>&nbsp;<span class="ident" id="3494132">fastXORBytes</span><span class="op" id="3494144">(</span><span class="ident" id="3494145">dst</span><span class="op" id="3494148">,</span>&nbsp;<span class="ident" id="3494150">a</span><span class="op" id="3494151">,</span>&nbsp;<span class="ident" id="3494153">b</span><span class="op" id="3494154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3494157">}</span>&nbsp;<span class="keyword" id="3494159">else</span>&nbsp;<span class="op" id="3494164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3494168">//&nbsp;TODO(hanwen):&nbsp;if&nbsp;(dst,&nbsp;a,&nbsp;b)&nbsp;have&nbsp;common&nbsp;alignment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3494224">//&nbsp;we&nbsp;could&nbsp;still&nbsp;try&nbsp;fastXORBytes.&nbsp;It&nbsp;is&nbsp;not&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3494278">//&nbsp;how&nbsp;often&nbsp;this&nbsp;happens,&nbsp;and&nbsp;it&#39;s&nbsp;only&nbsp;worth&nbsp;it&nbsp;if</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3494333">//&nbsp;the&nbsp;block&nbsp;encryption&nbsp;itself&nbsp;is&nbsp;hardware</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3494378">//&nbsp;accelerated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494396">return</span>&nbsp;<span class="ident" id="3494403">safeXORBytes</span><span class="op" id="3494415">(</span><span class="ident" id="3494416">dst</span><span class="op" id="3494419">,</span>&nbsp;<span class="ident" id="3494421">a</span><span class="op" id="3494422">,</span>&nbsp;<span class="ident" id="3494424">b</span><span class="op" id="3494425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3494428">}</span><br>
<span class="lineno"></span><span class="op" id="3494430">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="3494433">//&nbsp;fastXORWords&nbsp;XORs&nbsp;multiples&nbsp;of&nbsp;4&nbsp;or&nbsp;8&nbsp;bytes&nbsp;(depending&nbsp;on&nbsp;architecture.)</span><br>
<span class="lineno"></span><span class="comment" id="3494509">//&nbsp;The&nbsp;arguments&nbsp;are&nbsp;assumed&nbsp;to&nbsp;be&nbsp;of&nbsp;equal&nbsp;length.</span><br>
<span class="lineno"></span><span class="keyword" id="3494561">func</span>&nbsp;<span class="ident" id="3494566">fastXORWords</span><span class="op" id="3494578">(</span><span class="ident" id="3494579">dst</span><span class="op" id="3494582">,</span>&nbsp;<span class="ident" id="3494584">a</span><span class="op" id="3494585">,</span>&nbsp;<span class="ident" id="3494587">b</span>&nbsp;<span class="op" id="3494589">[</span><span class="op" id="3494590">]</span><span class="builtintype" id="3494591">byte</span><span class="op" id="3494595">)</span>&nbsp;<span class="op" id="3494597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494600">dw</span>&nbsp;<span class="op" id="3494603">:=</span>&nbsp;<span class="op" id="3494606">*</span><span class="op" id="3494607">(</span><span class="op" id="3494608">*</span><span class="op" id="3494609">[</span><span class="op" id="3494610">]</span><span class="builtintype" id="3494611">uintptr</span><span class="op" id="3494618">)</span><span class="op" id="3494619">(</span><span class="ident" id="3494620">unsafe</span><span class="op" id="3494626">.</span><span class="ident" id="3494627">Pointer</span><span class="op" id="3494634">(</span><span class="op" id="3494635">&amp;</span><span class="ident" id="3494636">dst</span><span class="op" id="3494639">)</span><span class="op" id="3494640">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494643">aw</span>&nbsp;<span class="op" id="3494646">:=</span>&nbsp;<span class="op" id="3494649">*</span><span class="op" id="3494650">(</span><span class="op" id="3494651">*</span><span class="op" id="3494652">[</span><span class="op" id="3494653">]</span><span class="builtintype" id="3494654">uintptr</span><span class="op" id="3494661">)</span><span class="op" id="3494662">(</span><span class="ident" id="3494663">unsafe</span><span class="op" id="3494669">.</span><span class="ident" id="3494670">Pointer</span><span class="op" id="3494677">(</span><span class="op" id="3494678">&amp;</span><span class="ident" id="3494679">a</span><span class="op" id="3494680">)</span><span class="op" id="3494681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494684">bw</span>&nbsp;<span class="op" id="3494687">:=</span>&nbsp;<span class="op" id="3494690">*</span><span class="op" id="3494691">(</span><span class="op" id="3494692">*</span><span class="op" id="3494693">[</span><span class="op" id="3494694">]</span><span class="builtintype" id="3494695">uintptr</span><span class="op" id="3494702">)</span><span class="op" id="3494703">(</span><span class="ident" id="3494704">unsafe</span><span class="op" id="3494710">.</span><span class="ident" id="3494711">Pointer</span><span class="op" id="3494718">(</span><span class="op" id="3494719">&amp;</span><span class="ident" id="3494720">b</span><span class="op" id="3494721">)</span><span class="op" id="3494722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494725">n</span>&nbsp;<span class="op" id="3494727">:=</span>&nbsp;<span class="builtinfunc" id="3494730">len</span><span class="op" id="3494733">(</span><span class="ident" id="3494734">b</span><span class="op" id="3494735">)</span>&nbsp;<span class="op" id="3494737">/</span>&nbsp;<span class="ident" id="3494739">wordSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494749">for</span>&nbsp;<span class="ident" id="3494753">i</span>&nbsp;<span class="op" id="3494755">:=</span>&nbsp;<span class="num" id="3494758">0</span><span class="op" id="3494759">;</span>&nbsp;<span class="ident" id="3494761">i</span>&nbsp;<span class="op" id="3494763">&lt;</span>&nbsp;<span class="ident" id="3494765">n</span><span class="op" id="3494766">;</span>&nbsp;<span class="ident" id="3494768">i</span><span class="op" id="3494769">++</span>&nbsp;<span class="op" id="3494772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494776">dw</span><span class="op" id="3494778">[</span><span class="ident" id="3494779">i</span><span class="op" id="3494780">]</span>&nbsp;<span class="op" id="3494782">=</span>&nbsp;<span class="ident" id="3494784">aw</span><span class="op" id="3494786">[</span><span class="ident" id="3494787">i</span><span class="op" id="3494788">]</span>&nbsp;<span class="op" id="3494790">^</span>&nbsp;<span class="ident" id="3494792">bw</span><span class="op" id="3494794">[</span><span class="ident" id="3494795">i</span><span class="op" id="3494796">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3494799">}</span><br>
<span class="lineno"></span><span class="op" id="3494801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3494804">func</span>&nbsp;<span class="ident" id="3494809">xorWords</span><span class="op" id="3494817">(</span><span class="ident" id="3494818">dst</span><span class="op" id="3494821">,</span>&nbsp;<span class="ident" id="3494823">a</span><span class="op" id="3494824">,</span>&nbsp;<span class="ident" id="3494826">b</span>&nbsp;<span class="op" id="3494828">[</span><span class="op" id="3494829">]</span><span class="builtintype" id="3494830">byte</span><span class="op" id="3494834">)</span>&nbsp;<span class="op" id="3494836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494839">if</span>&nbsp;<span class="ident" id="3494842">supportsUnaligned</span>&nbsp;<span class="op" id="3494860">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494864">fastXORWords</span><span class="op" id="3494876">(</span><span class="ident" id="3494877">dst</span><span class="op" id="3494880">,</span>&nbsp;<span class="ident" id="3494882">a</span><span class="op" id="3494883">,</span>&nbsp;<span class="ident" id="3494885">b</span><span class="op" id="3494886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3494889">}</span>&nbsp;<span class="keyword" id="3494891">else</span>&nbsp;<span class="op" id="3494896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494900">safeXORBytes</span><span class="op" id="3494912">(</span><span class="ident" id="3494913">dst</span><span class="op" id="3494916">,</span>&nbsp;<span class="ident" id="3494918">a</span><span class="op" id="3494919">,</span>&nbsp;<span class="ident" id="3494921">b</span><span class="op" id="3494922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3494925">}</span><br>
<span class="lineno"></span><span class="op" id="3494927">}</span>
</div>
</body>
</html>
