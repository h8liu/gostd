<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html" class="current">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4492721">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4492776">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4492830">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4492881">package</span>&nbsp;<span class="ident" id="4492889">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4492894">import</span>&nbsp;<span class="op" id="4492901">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4492904">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4492918">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4492935">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4492949">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4492964">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4492978">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4492993">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4493008">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4493015">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4493018">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="4493097">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="4493161">type</span>&nbsp;<span class="ident" id="4493166">keyAgreement</span>&nbsp;<span class="keyword" id="4493179">interface</span>&nbsp;<span class="op" id="4493189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4493192">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4493260">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4493322">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4493395">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493404">generateServerKeyExchange</span><span class="op" id="4493429">(</span><span class="op" id="4493430">*</span><span class="ident" id="4493431">Config</span><span class="op" id="4493437">,</span>&nbsp;<span class="op" id="4493439">*</span><span class="ident" id="4493440">Certificate</span><span class="op" id="4493451">,</span>&nbsp;<span class="op" id="4493453">*</span><span class="ident" id="4493454">clientHelloMsg</span><span class="op" id="4493468">,</span>&nbsp;<span class="op" id="4493470">*</span><span class="ident" id="4493471">serverHelloMsg</span><span class="op" id="4493485">)</span>&nbsp;<span class="op" id="4493487">(</span><span class="op" id="4493488">*</span><span class="ident" id="4493489">serverKeyExchangeMsg</span><span class="op" id="4493509">,</span>&nbsp;<span class="builtintype" id="4493511">error</span><span class="op" id="4493516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493519">processClientKeyExchange</span><span class="op" id="4493543">(</span><span class="op" id="4493544">*</span><span class="ident" id="4493545">Config</span><span class="op" id="4493551">,</span>&nbsp;<span class="op" id="4493553">*</span><span class="ident" id="4493554">Certificate</span><span class="op" id="4493565">,</span>&nbsp;<span class="op" id="4493567">*</span><span class="ident" id="4493568">clientKeyExchangeMsg</span><span class="op" id="4493588">,</span>&nbsp;<span class="builtintype" id="4493590">uint16</span><span class="op" id="4493596">)</span>&nbsp;<span class="op" id="4493598">(</span><span class="op" id="4493599">[</span><span class="op" id="4493600">]</span><span class="builtintype" id="4493601">byte</span><span class="op" id="4493605">,</span>&nbsp;<span class="builtintype" id="4493607">error</span><span class="op" id="4493612">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4493616">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4493683">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4493746">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493777">processServerKeyExchange</span><span class="op" id="4493801">(</span><span class="op" id="4493802">*</span><span class="ident" id="4493803">Config</span><span class="op" id="4493809">,</span>&nbsp;<span class="op" id="4493811">*</span><span class="ident" id="4493812">clientHelloMsg</span><span class="op" id="4493826">,</span>&nbsp;<span class="op" id="4493828">*</span><span class="ident" id="4493829">serverHelloMsg</span><span class="op" id="4493843">,</span>&nbsp;<span class="op" id="4493845">*</span><span class="ident" id="4493846">x509</span><span class="op" id="4493850">.</span><span class="ident" id="4493851">Certificate</span><span class="op" id="4493862">,</span>&nbsp;<span class="op" id="4493864">*</span><span class="ident" id="4493865">serverKeyExchangeMsg</span><span class="op" id="4493885">)</span>&nbsp;<span class="builtintype" id="4493887">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493894">generateClientKeyExchange</span><span class="op" id="4493919">(</span><span class="op" id="4493920">*</span><span class="ident" id="4493921">Config</span><span class="op" id="4493927">,</span>&nbsp;<span class="op" id="4493929">*</span><span class="ident" id="4493930">clientHelloMsg</span><span class="op" id="4493944">,</span>&nbsp;<span class="op" id="4493946">*</span><span class="ident" id="4493947">x509</span><span class="op" id="4493951">.</span><span class="ident" id="4493952">Certificate</span><span class="op" id="4493963">)</span>&nbsp;<span class="op" id="4493965">(</span><span class="op" id="4493966">[</span><span class="op" id="4493967">]</span><span class="builtintype" id="4493968">byte</span><span class="op" id="4493972">,</span>&nbsp;<span class="op" id="4493974">*</span><span class="ident" id="4493975">clientKeyExchangeMsg</span><span class="op" id="4493995">,</span>&nbsp;<span class="builtintype" id="4493997">error</span><span class="op" id="4494002">)</span><br>
<span class="lineno">35</span><span class="op" id="4494004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4494007">const</span>&nbsp;<span class="op" id="4494013">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4494016">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4494086">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4494158">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4494230">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494257">suiteECDHE</span>&nbsp;<span class="op" id="4494268">=</span>&nbsp;<span class="num" id="4494270">1</span>&nbsp;<span class="op" id="4494272">&lt;&lt;</span>&nbsp;<span class="ident" id="4494275">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4494281">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4494346">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4494413">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4494483">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494498">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4494510">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4494583">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494620">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="4494631">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4494634">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="4494710">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="4494777">type</span>&nbsp;<span class="ident" id="4494782">cipherSuite</span>&nbsp;<span class="keyword" id="4494794">struct</span>&nbsp;<span class="op" id="4494801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494804">id</span>&nbsp;<span class="builtintype" id="4494807">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4494815">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494889">keyLen</span>&nbsp;<span class="builtintype" id="4494896">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494901">macLen</span>&nbsp;<span class="builtintype" id="4494908">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494913">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="4494920">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494925">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4494932">func</span><span class="op" id="4494936">(</span><span class="ident" id="4494937">version</span>&nbsp;<span class="builtintype" id="4494945">uint16</span><span class="op" id="4494951">)</span>&nbsp;<span class="ident" id="4494953">keyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4494967">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495019">flags</span>&nbsp;&nbsp;<span class="builtintype" id="4495026">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495031">cipher</span>&nbsp;<span class="keyword" id="4495038">func</span><span class="op" id="4495042">(</span><span class="ident" id="4495043">key</span><span class="op" id="4495046">,</span>&nbsp;<span class="ident" id="4495048">iv</span>&nbsp;<span class="op" id="4495051">[</span><span class="op" id="4495052">]</span><span class="builtintype" id="4495053">byte</span><span class="op" id="4495057">,</span>&nbsp;<span class="ident" id="4495059">isRead</span>&nbsp;<span class="builtintype" id="4495066">bool</span><span class="op" id="4495070">)</span>&nbsp;<span class="keyword" id="4495072">interface</span><span class="op" id="4495081">{</span><span class="op" id="4495082">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495085">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4495092">func</span><span class="op" id="4495096">(</span><span class="ident" id="4495097">version</span>&nbsp;<span class="builtintype" id="4495105">uint16</span><span class="op" id="4495111">,</span>&nbsp;<span class="ident" id="4495113">macKey</span>&nbsp;<span class="op" id="4495120">[</span><span class="op" id="4495121">]</span><span class="builtintype" id="4495122">byte</span><span class="op" id="4495126">)</span>&nbsp;<span class="ident" id="4495128">macFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495141">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4495148">func</span><span class="op" id="4495152">(</span><span class="ident" id="4495153">key</span><span class="op" id="4495156">,</span>&nbsp;<span class="ident" id="4495158">fixedNonce</span>&nbsp;<span class="op" id="4495169">[</span><span class="op" id="4495170">]</span><span class="builtintype" id="4495171">byte</span><span class="op" id="4495175">)</span>&nbsp;<span class="ident" id="4495177">cipher</span><span class="op" id="4495183">.</span><span class="ident" id="4495184">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4495189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4495192">var</span>&nbsp;<span class="ident" id="4495196">cipherSuites</span>&nbsp;<span class="op" id="4495209">=</span>&nbsp;<span class="op" id="4495211">[</span><span class="op" id="4495212">]</span><span class="op" id="4495213">*</span><span class="ident" id="4495214">cipherSuite</span><span class="op" id="4495225">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4495228">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4495297">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4495359">{</span><span class="ident" id="4495360">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="4495397">,</span>&nbsp;<span class="num" id="4495399">16</span><span class="op" id="4495401">,</span>&nbsp;<span class="num" id="4495403">0</span><span class="op" id="4495404">,</span>&nbsp;<span class="num" id="4495406">4</span><span class="op" id="4495407">,</span>&nbsp;<span class="ident" id="4495409">ecdheRSAKA</span><span class="op" id="4495419">,</span>&nbsp;<span class="ident" id="4495421">suiteECDHE</span>&nbsp;<span class="op" id="4495432">|</span>&nbsp;<span class="ident" id="4495434">suiteTLS12</span><span class="op" id="4495444">,</span>&nbsp;<span class="ident" id="4495446">nil</span><span class="op" id="4495449">,</span>&nbsp;<span class="ident" id="4495451">nil</span><span class="op" id="4495454">,</span>&nbsp;<span class="ident" id="4495456">aeadAESGCM</span><span class="op" id="4495466">}</span><span class="op" id="4495467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4495470">{</span><span class="ident" id="4495471">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="4495510">,</span>&nbsp;<span class="num" id="4495512">16</span><span class="op" id="4495514">,</span>&nbsp;<span class="num" id="4495516">0</span><span class="op" id="4495517">,</span>&nbsp;<span class="num" id="4495519">4</span><span class="op" id="4495520">,</span>&nbsp;<span class="ident" id="4495522">ecdheECDSAKA</span><span class="op" id="4495534">,</span>&nbsp;<span class="ident" id="4495536">suiteECDHE</span>&nbsp;<span class="op" id="4495547">|</span>&nbsp;<span class="ident" id="4495549">suiteECDSA</span>&nbsp;<span class="op" id="4495560">|</span>&nbsp;<span class="ident" id="4495562">suiteTLS12</span><span class="op" id="4495572">,</span>&nbsp;<span class="ident" id="4495574">nil</span><span class="op" id="4495577">,</span>&nbsp;<span class="ident" id="4495579">nil</span><span class="op" id="4495582">,</span>&nbsp;<span class="ident" id="4495584">aeadAESGCM</span><span class="op" id="4495594">}</span><span class="op" id="4495595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4495598">{</span><span class="ident" id="4495599">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="op" id="4495629">,</span>&nbsp;<span class="num" id="4495631">16</span><span class="op" id="4495633">,</span>&nbsp;<span class="num" id="4495635">20</span><span class="op" id="4495637">,</span>&nbsp;<span class="num" id="4495639">0</span><span class="op" id="4495640">,</span>&nbsp;<span class="ident" id="4495642">ecdheRSAKA</span><span class="op" id="4495652">,</span>&nbsp;<span class="ident" id="4495654">suiteECDHE</span><span class="op" id="4495664">,</span>&nbsp;<span class="ident" id="4495666">cipherRC4</span><span class="op" id="4495675">,</span>&nbsp;<span class="ident" id="4495677">macSHA1</span><span class="op" id="4495684">,</span>&nbsp;<span class="ident" id="4495686">nil</span><span class="op" id="4495689">}</span><span class="op" id="4495690">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4495693">{</span><span class="ident" id="4495694">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span><span class="op" id="4495726">,</span>&nbsp;<span class="num" id="4495728">16</span><span class="op" id="4495730">,</span>&nbsp;<span class="num" id="4495732">20</span><span class="op" id="4495734">,</span>&nbsp;<span class="num" id="4495736">0</span><span class="op" id="4495737">,</span>&nbsp;<span class="ident" id="4495739">ecdheECDSAKA</span><span class="op" id="4495751">,</span>&nbsp;<span class="ident" id="4495753">suiteECDHE</span>&nbsp;<span class="op" id="4495764">|</span>&nbsp;<span class="ident" id="4495766">suiteECDSA</span><span class="op" id="4495776">,</span>&nbsp;<span class="ident" id="4495778">cipherRC4</span><span class="op" id="4495787">,</span>&nbsp;<span class="ident" id="4495789">macSHA1</span><span class="op" id="4495796">,</span>&nbsp;<span class="ident" id="4495798">nil</span><span class="op" id="4495801">}</span><span class="op" id="4495802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4495805">{</span><span class="ident" id="4495806">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4495840">,</span>&nbsp;<span class="num" id="4495842">16</span><span class="op" id="4495844">,</span>&nbsp;<span class="num" id="4495846">20</span><span class="op" id="4495848">,</span>&nbsp;<span class="num" id="4495850">16</span><span class="op" id="4495852">,</span>&nbsp;<span class="ident" id="4495854">ecdheRSAKA</span><span class="op" id="4495864">,</span>&nbsp;<span class="ident" id="4495866">suiteECDHE</span><span class="op" id="4495876">,</span>&nbsp;<span class="ident" id="4495878">cipherAES</span><span class="op" id="4495887">,</span>&nbsp;<span class="ident" id="4495889">macSHA1</span><span class="op" id="4495896">,</span>&nbsp;<span class="ident" id="4495898">nil</span><span class="op" id="4495901">}</span><span class="op" id="4495902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4495905">{</span><span class="ident" id="4495906">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4495942">,</span>&nbsp;<span class="num" id="4495944">16</span><span class="op" id="4495946">,</span>&nbsp;<span class="num" id="4495948">20</span><span class="op" id="4495950">,</span>&nbsp;<span class="num" id="4495952">16</span><span class="op" id="4495954">,</span>&nbsp;<span class="ident" id="4495956">ecdheECDSAKA</span><span class="op" id="4495968">,</span>&nbsp;<span class="ident" id="4495970">suiteECDHE</span>&nbsp;<span class="op" id="4495981">|</span>&nbsp;<span class="ident" id="4495983">suiteECDSA</span><span class="op" id="4495993">,</span>&nbsp;<span class="ident" id="4495995">cipherAES</span><span class="op" id="4496004">,</span>&nbsp;<span class="ident" id="4496006">macSHA1</span><span class="op" id="4496013">,</span>&nbsp;<span class="ident" id="4496015">nil</span><span class="op" id="4496018">}</span><span class="op" id="4496019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496022">{</span><span class="ident" id="4496023">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4496057">,</span>&nbsp;<span class="num" id="4496059">32</span><span class="op" id="4496061">,</span>&nbsp;<span class="num" id="4496063">20</span><span class="op" id="4496065">,</span>&nbsp;<span class="num" id="4496067">16</span><span class="op" id="4496069">,</span>&nbsp;<span class="ident" id="4496071">ecdheRSAKA</span><span class="op" id="4496081">,</span>&nbsp;<span class="ident" id="4496083">suiteECDHE</span><span class="op" id="4496093">,</span>&nbsp;<span class="ident" id="4496095">cipherAES</span><span class="op" id="4496104">,</span>&nbsp;<span class="ident" id="4496106">macSHA1</span><span class="op" id="4496113">,</span>&nbsp;<span class="ident" id="4496115">nil</span><span class="op" id="4496118">}</span><span class="op" id="4496119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496122">{</span><span class="ident" id="4496123">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4496159">,</span>&nbsp;<span class="num" id="4496161">32</span><span class="op" id="4496163">,</span>&nbsp;<span class="num" id="4496165">20</span><span class="op" id="4496167">,</span>&nbsp;<span class="num" id="4496169">16</span><span class="op" id="4496171">,</span>&nbsp;<span class="ident" id="4496173">ecdheECDSAKA</span><span class="op" id="4496185">,</span>&nbsp;<span class="ident" id="4496187">suiteECDHE</span>&nbsp;<span class="op" id="4496198">|</span>&nbsp;<span class="ident" id="4496200">suiteECDSA</span><span class="op" id="4496210">,</span>&nbsp;<span class="ident" id="4496212">cipherAES</span><span class="op" id="4496221">,</span>&nbsp;<span class="ident" id="4496223">macSHA1</span><span class="op" id="4496230">,</span>&nbsp;<span class="ident" id="4496232">nil</span><span class="op" id="4496235">}</span><span class="op" id="4496236">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496239">{</span><span class="ident" id="4496240">TLS_RSA_WITH_RC4_128_SHA</span><span class="op" id="4496264">,</span>&nbsp;<span class="num" id="4496266">16</span><span class="op" id="4496268">,</span>&nbsp;<span class="num" id="4496270">20</span><span class="op" id="4496272">,</span>&nbsp;<span class="num" id="4496274">0</span><span class="op" id="4496275">,</span>&nbsp;<span class="ident" id="4496277">rsaKA</span><span class="op" id="4496282">,</span>&nbsp;<span class="num" id="4496284">0</span><span class="op" id="4496285">,</span>&nbsp;<span class="ident" id="4496287">cipherRC4</span><span class="op" id="4496296">,</span>&nbsp;<span class="ident" id="4496298">macSHA1</span><span class="op" id="4496305">,</span>&nbsp;<span class="ident" id="4496307">nil</span><span class="op" id="4496310">}</span><span class="op" id="4496311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496314">{</span><span class="ident" id="4496315">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4496343">,</span>&nbsp;<span class="num" id="4496345">16</span><span class="op" id="4496347">,</span>&nbsp;<span class="num" id="4496349">20</span><span class="op" id="4496351">,</span>&nbsp;<span class="num" id="4496353">16</span><span class="op" id="4496355">,</span>&nbsp;<span class="ident" id="4496357">rsaKA</span><span class="op" id="4496362">,</span>&nbsp;<span class="num" id="4496364">0</span><span class="op" id="4496365">,</span>&nbsp;<span class="ident" id="4496367">cipherAES</span><span class="op" id="4496376">,</span>&nbsp;<span class="ident" id="4496378">macSHA1</span><span class="op" id="4496385">,</span>&nbsp;<span class="ident" id="4496387">nil</span><span class="op" id="4496390">}</span><span class="op" id="4496391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496394">{</span><span class="ident" id="4496395">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4496423">,</span>&nbsp;<span class="num" id="4496425">32</span><span class="op" id="4496427">,</span>&nbsp;<span class="num" id="4496429">20</span><span class="op" id="4496431">,</span>&nbsp;<span class="num" id="4496433">16</span><span class="op" id="4496435">,</span>&nbsp;<span class="ident" id="4496437">rsaKA</span><span class="op" id="4496442">,</span>&nbsp;<span class="num" id="4496444">0</span><span class="op" id="4496445">,</span>&nbsp;<span class="ident" id="4496447">cipherAES</span><span class="op" id="4496456">,</span>&nbsp;<span class="ident" id="4496458">macSHA1</span><span class="op" id="4496465">,</span>&nbsp;<span class="ident" id="4496467">nil</span><span class="op" id="4496470">}</span><span class="op" id="4496471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496474">{</span><span class="ident" id="4496475">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="4496510">,</span>&nbsp;<span class="num" id="4496512">24</span><span class="op" id="4496514">,</span>&nbsp;<span class="num" id="4496516">20</span><span class="op" id="4496518">,</span>&nbsp;<span class="num" id="4496520">8</span><span class="op" id="4496521">,</span>&nbsp;<span class="ident" id="4496523">ecdheRSAKA</span><span class="op" id="4496533">,</span>&nbsp;<span class="ident" id="4496535">suiteECDHE</span><span class="op" id="4496545">,</span>&nbsp;<span class="ident" id="4496547">cipher3DES</span><span class="op" id="4496557">,</span>&nbsp;<span class="ident" id="4496559">macSHA1</span><span class="op" id="4496566">,</span>&nbsp;<span class="ident" id="4496568">nil</span><span class="op" id="4496571">}</span><span class="op" id="4496572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496575">{</span><span class="ident" id="4496576">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="4496605">,</span>&nbsp;<span class="num" id="4496607">24</span><span class="op" id="4496609">,</span>&nbsp;<span class="num" id="4496611">20</span><span class="op" id="4496613">,</span>&nbsp;<span class="num" id="4496615">8</span><span class="op" id="4496616">,</span>&nbsp;<span class="ident" id="4496618">rsaKA</span><span class="op" id="4496623">,</span>&nbsp;<span class="num" id="4496625">0</span><span class="op" id="4496626">,</span>&nbsp;<span class="ident" id="4496628">cipher3DES</span><span class="op" id="4496638">,</span>&nbsp;<span class="ident" id="4496640">macSHA1</span><span class="op" id="4496647">,</span>&nbsp;<span class="ident" id="4496649">nil</span><span class="op" id="4496652">}</span><span class="op" id="4496653">,</span><br>
<span class="lineno">85</span><span class="op" id="4496655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4496658">func</span>&nbsp;<span class="ident" id="4496663">cipherRC4</span><span class="op" id="4496672">(</span><span class="ident" id="4496673">key</span><span class="op" id="4496676">,</span>&nbsp;<span class="ident" id="4496678">iv</span>&nbsp;<span class="op" id="4496681">[</span><span class="op" id="4496682">]</span><span class="builtintype" id="4496683">byte</span><span class="op" id="4496687">,</span>&nbsp;<span class="ident" id="4496689">isRead</span>&nbsp;<span class="builtintype" id="4496696">bool</span><span class="op" id="4496700">)</span>&nbsp;<span class="keyword" id="4496702">interface</span><span class="op" id="4496711">{</span><span class="op" id="4496712">}</span>&nbsp;<span class="op" id="4496714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496717">cipher</span><span class="op" id="4496723">,</span>&nbsp;<span class="ident" id="4496725">_</span>&nbsp;<span class="op" id="4496727">:=</span>&nbsp;<span class="ident" id="4496730">rc4</span><span class="op" id="4496733">.</span><span class="ident" id="4496734">NewCipher</span><span class="op" id="4496743">(</span><span class="ident" id="4496744">key</span><span class="op" id="4496747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496750">return</span>&nbsp;<span class="ident" id="4496757">cipher</span><br>
<span class="lineno">90</span><span class="op" id="4496764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4496767">func</span>&nbsp;<span class="ident" id="4496772">cipher3DES</span><span class="op" id="4496782">(</span><span class="ident" id="4496783">key</span><span class="op" id="4496786">,</span>&nbsp;<span class="ident" id="4496788">iv</span>&nbsp;<span class="op" id="4496791">[</span><span class="op" id="4496792">]</span><span class="builtintype" id="4496793">byte</span><span class="op" id="4496797">,</span>&nbsp;<span class="ident" id="4496799">isRead</span>&nbsp;<span class="builtintype" id="4496806">bool</span><span class="op" id="4496810">)</span>&nbsp;<span class="keyword" id="4496812">interface</span><span class="op" id="4496821">{</span><span class="op" id="4496822">}</span>&nbsp;<span class="op" id="4496824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496827">block</span><span class="op" id="4496832">,</span>&nbsp;<span class="ident" id="4496834">_</span>&nbsp;<span class="op" id="4496836">:=</span>&nbsp;<span class="ident" id="4496839">des</span><span class="op" id="4496842">.</span><span class="ident" id="4496843">NewTripleDESCipher</span><span class="op" id="4496861">(</span><span class="ident" id="4496862">key</span><span class="op" id="4496865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496868">if</span>&nbsp;<span class="ident" id="4496871">isRead</span>&nbsp;<span class="op" id="4496878">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496882">return</span>&nbsp;<span class="ident" id="4496889">cipher</span><span class="op" id="4496895">.</span><span class="ident" id="4496896">NewCBCDecrypter</span><span class="op" id="4496911">(</span><span class="ident" id="4496912">block</span><span class="op" id="4496917">,</span>&nbsp;<span class="ident" id="4496919">iv</span><span class="op" id="4496921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496927">return</span>&nbsp;<span class="ident" id="4496934">cipher</span><span class="op" id="4496940">.</span><span class="ident" id="4496941">NewCBCEncrypter</span><span class="op" id="4496956">(</span><span class="ident" id="4496957">block</span><span class="op" id="4496962">,</span>&nbsp;<span class="ident" id="4496964">iv</span><span class="op" id="4496966">)</span><br>
<span class="lineno"></span><span class="op" id="4496968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4496971">func</span>&nbsp;<span class="ident" id="4496976">cipherAES</span><span class="op" id="4496985">(</span><span class="ident" id="4496986">key</span><span class="op" id="4496989">,</span>&nbsp;<span class="ident" id="4496991">iv</span>&nbsp;<span class="op" id="4496994">[</span><span class="op" id="4496995">]</span><span class="builtintype" id="4496996">byte</span><span class="op" id="4497000">,</span>&nbsp;<span class="ident" id="4497002">isRead</span>&nbsp;<span class="builtintype" id="4497009">bool</span><span class="op" id="4497013">)</span>&nbsp;<span class="keyword" id="4497015">interface</span><span class="op" id="4497024">{</span><span class="op" id="4497025">}</span>&nbsp;<span class="op" id="4497027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497030">block</span><span class="op" id="4497035">,</span>&nbsp;<span class="ident" id="4497037">_</span>&nbsp;<span class="op" id="4497039">:=</span>&nbsp;<span class="ident" id="4497042">aes</span><span class="op" id="4497045">.</span><span class="ident" id="4497046">NewCipher</span><span class="op" id="4497055">(</span><span class="ident" id="4497056">key</span><span class="op" id="4497059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497062">if</span>&nbsp;<span class="ident" id="4497065">isRead</span>&nbsp;<span class="op" id="4497072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497076">return</span>&nbsp;<span class="ident" id="4497083">cipher</span><span class="op" id="4497089">.</span><span class="ident" id="4497090">NewCBCDecrypter</span><span class="op" id="4497105">(</span><span class="ident" id="4497106">block</span><span class="op" id="4497111">,</span>&nbsp;<span class="ident" id="4497113">iv</span><span class="op" id="4497115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497118">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497121">return</span>&nbsp;<span class="ident" id="4497128">cipher</span><span class="op" id="4497134">.</span><span class="ident" id="4497135">NewCBCEncrypter</span><span class="op" id="4497150">(</span><span class="ident" id="4497151">block</span><span class="op" id="4497156">,</span>&nbsp;<span class="ident" id="4497158">iv</span><span class="op" id="4497160">)</span><br>
<span class="lineno"></span><span class="op" id="4497162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4497165">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="4497230">func</span>&nbsp;<span class="ident" id="4497235">macSHA1</span><span class="op" id="4497242">(</span><span class="ident" id="4497243">version</span>&nbsp;<span class="builtintype" id="4497251">uint16</span><span class="op" id="4497257">,</span>&nbsp;<span class="ident" id="4497259">key</span>&nbsp;<span class="op" id="4497263">[</span><span class="op" id="4497264">]</span><span class="builtintype" id="4497265">byte</span><span class="op" id="4497269">)</span>&nbsp;<span class="ident" id="4497271">macFunction</span>&nbsp;<span class="op" id="4497283">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497286">if</span>&nbsp;<span class="ident" id="4497289">version</span>&nbsp;<span class="op" id="4497297">==</span>&nbsp;<span class="ident" id="4497300">VersionSSL30</span>&nbsp;<span class="op" id="4497313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497317">mac</span>&nbsp;<span class="op" id="4497321">:=</span>&nbsp;<span class="ident" id="4497324">ssl30MAC</span><span class="op" id="4497332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497337">h</span><span class="op" id="4497338">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4497342">sha1</span><span class="op" id="4497346">.</span><span class="ident" id="4497347">New</span><span class="op" id="4497350">(</span><span class="op" id="4497351">)</span><span class="op" id="4497352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497357">key</span><span class="op" id="4497360">:</span>&nbsp;<span class="builtinfunc" id="4497362">make</span><span class="op" id="4497366">(</span><span class="op" id="4497367">[</span><span class="op" id="4497368">]</span><span class="builtintype" id="4497369">byte</span><span class="op" id="4497373">,</span>&nbsp;<span class="builtinfunc" id="4497375">len</span><span class="op" id="4497378">(</span><span class="ident" id="4497379">key</span><span class="op" id="4497382">)</span><span class="op" id="4497383">)</span><span class="op" id="4497384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497388">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4497392">copy</span><span class="op" id="4497396">(</span><span class="ident" id="4497397">mac</span><span class="op" id="4497400">.</span><span class="ident" id="4497401">key</span><span class="op" id="4497404">,</span>&nbsp;<span class="ident" id="4497406">key</span><span class="op" id="4497409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497413">return</span>&nbsp;<span class="ident" id="4497420">mac</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497428">return</span>&nbsp;<span class="ident" id="4497435">tls10MAC</span><span class="op" id="4497443">{</span><span class="ident" id="4497444">hmac</span><span class="op" id="4497448">.</span><span class="ident" id="4497449">New</span><span class="op" id="4497452">(</span><span class="ident" id="4497453">sha1</span><span class="op" id="4497457">.</span><span class="ident" id="4497458">New</span><span class="op" id="4497461">,</span>&nbsp;<span class="ident" id="4497463">key</span><span class="op" id="4497466">)</span><span class="op" id="4497467">}</span><br>
<span class="lineno"></span><span class="op" id="4497469">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4497472">type</span>&nbsp;<span class="ident" id="4497477">macFunction</span>&nbsp;<span class="keyword" id="4497489">interface</span>&nbsp;<span class="op" id="4497499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497502">Size</span><span class="op" id="4497506">(</span><span class="op" id="4497507">)</span>&nbsp;<span class="builtintype" id="4497509">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497514">MAC</span><span class="op" id="4497517">(</span><span class="ident" id="4497518">digestBuf</span><span class="op" id="4497527">,</span>&nbsp;<span class="ident" id="4497529">seq</span><span class="op" id="4497532">,</span>&nbsp;<span class="ident" id="4497534">header</span><span class="op" id="4497540">,</span>&nbsp;<span class="ident" id="4497542">data</span>&nbsp;<span class="op" id="4497547">[</span><span class="op" id="4497548">]</span><span class="builtintype" id="4497549">byte</span><span class="op" id="4497553">)</span>&nbsp;<span class="op" id="4497555">[</span><span class="op" id="4497556">]</span><span class="builtintype" id="4497557">byte</span><br>
<span class="lineno"></span><span class="op" id="4497562">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4497565">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4497642">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="4497656">type</span>&nbsp;<span class="ident" id="4497661">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="4497676">struct</span>&nbsp;<span class="op" id="4497683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4497686">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4497757">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4497821">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497876">sealNonce</span><span class="op" id="4497885">,</span>&nbsp;<span class="ident" id="4497887">openNonce</span>&nbsp;<span class="op" id="4497897">[</span><span class="op" id="4497898">]</span><span class="builtintype" id="4497899">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497905">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4497926">cipher</span><span class="op" id="4497932">.</span><span class="ident" id="4497933">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4497938">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="4497941">func</span>&nbsp;<span class="op" id="4497946">(</span><span class="ident" id="4497947">f</span>&nbsp;<span class="op" id="4497949">*</span><span class="ident" id="4497950">fixedNonceAEAD</span><span class="op" id="4497964">)</span>&nbsp;<span class="ident" id="4497966">NonceSize</span><span class="op" id="4497975">(</span><span class="op" id="4497976">)</span>&nbsp;<span class="builtintype" id="4497978">int</span>&nbsp;<span class="op" id="4497982">{</span>&nbsp;<span class="keyword" id="4497984">return</span>&nbsp;<span class="num" id="4497991">8</span>&nbsp;<span class="op" id="4497993">}</span><br>
<span class="lineno"></span><span class="keyword" id="4497995">func</span>&nbsp;<span class="op" id="4498000">(</span><span class="ident" id="4498001">f</span>&nbsp;<span class="op" id="4498003">*</span><span class="ident" id="4498004">fixedNonceAEAD</span><span class="op" id="4498018">)</span>&nbsp;<span class="ident" id="4498020">Overhead</span><span class="op" id="4498028">(</span><span class="op" id="4498029">)</span>&nbsp;<span class="builtintype" id="4498031">int</span>&nbsp;&nbsp;<span class="op" id="4498036">{</span>&nbsp;<span class="keyword" id="4498038">return</span>&nbsp;<span class="ident" id="4498045">f</span><span class="op" id="4498046">.</span><span class="ident" id="4498047">aead</span><span class="op" id="4498051">.</span><span class="ident" id="4498052">Overhead</span><span class="op" id="4498060">(</span><span class="op" id="4498061">)</span>&nbsp;<span class="op" id="4498063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4498066">func</span>&nbsp;<span class="op" id="4498071">(</span><span class="ident" id="4498072">f</span>&nbsp;<span class="op" id="4498074">*</span><span class="ident" id="4498075">fixedNonceAEAD</span><span class="op" id="4498089">)</span>&nbsp;<span class="ident" id="4498091">Seal</span><span class="op" id="4498095">(</span><span class="ident" id="4498096">out</span><span class="op" id="4498099">,</span>&nbsp;<span class="ident" id="4498101">nonce</span><span class="op" id="4498106">,</span>&nbsp;<span class="ident" id="4498108">plaintext</span><span class="op" id="4498117">,</span>&nbsp;<span class="ident" id="4498119">additionalData</span>&nbsp;<span class="op" id="4498134">[</span><span class="op" id="4498135">]</span><span class="builtintype" id="4498136">byte</span><span class="op" id="4498140">)</span>&nbsp;<span class="op" id="4498142">[</span><span class="op" id="4498143">]</span><span class="builtintype" id="4498144">byte</span>&nbsp;<span class="op" id="4498149">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4498152">copy</span><span class="op" id="4498156">(</span><span class="ident" id="4498157">f</span><span class="op" id="4498158">.</span><span class="ident" id="4498159">sealNonce</span><span class="op" id="4498168">[</span><span class="builtinfunc" id="4498169">len</span><span class="op" id="4498172">(</span><span class="ident" id="4498173">f</span><span class="op" id="4498174">.</span><span class="ident" id="4498175">sealNonce</span><span class="op" id="4498184">)</span><span class="op" id="4498185">-</span><span class="num" id="4498186">8</span><span class="op" id="4498187">:</span><span class="op" id="4498188">]</span><span class="op" id="4498189">,</span>&nbsp;<span class="ident" id="4498191">nonce</span><span class="op" id="4498196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498199">return</span>&nbsp;<span class="ident" id="4498206">f</span><span class="op" id="4498207">.</span><span class="ident" id="4498208">aead</span><span class="op" id="4498212">.</span><span class="ident" id="4498213">Seal</span><span class="op" id="4498217">(</span><span class="ident" id="4498218">out</span><span class="op" id="4498221">,</span>&nbsp;<span class="ident" id="4498223">f</span><span class="op" id="4498224">.</span><span class="ident" id="4498225">sealNonce</span><span class="op" id="4498234">,</span>&nbsp;<span class="ident" id="4498236">plaintext</span><span class="op" id="4498245">,</span>&nbsp;<span class="ident" id="4498247">additionalData</span><span class="op" id="4498261">)</span><br>
<span class="lineno"></span><span class="op" id="4498263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4498266">func</span>&nbsp;<span class="op" id="4498271">(</span><span class="ident" id="4498272">f</span>&nbsp;<span class="op" id="4498274">*</span><span class="ident" id="4498275">fixedNonceAEAD</span><span class="op" id="4498289">)</span>&nbsp;<span class="ident" id="4498291">Open</span><span class="op" id="4498295">(</span><span class="ident" id="4498296">out</span><span class="op" id="4498299">,</span>&nbsp;<span class="ident" id="4498301">nonce</span><span class="op" id="4498306">,</span>&nbsp;<span class="ident" id="4498308">plaintext</span><span class="op" id="4498317">,</span>&nbsp;<span class="ident" id="4498319">additionalData</span>&nbsp;<span class="op" id="4498334">[</span><span class="op" id="4498335">]</span><span class="builtintype" id="4498336">byte</span><span class="op" id="4498340">)</span>&nbsp;<span class="op" id="4498342">(</span><span class="op" id="4498343">[</span><span class="op" id="4498344">]</span><span class="builtintype" id="4498345">byte</span><span class="op" id="4498349">,</span>&nbsp;<span class="builtintype" id="4498351">error</span><span class="op" id="4498356">)</span>&nbsp;<span class="op" id="4498358">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4498361">copy</span><span class="op" id="4498365">(</span><span class="ident" id="4498366">f</span><span class="op" id="4498367">.</span><span class="ident" id="4498368">openNonce</span><span class="op" id="4498377">[</span><span class="builtinfunc" id="4498378">len</span><span class="op" id="4498381">(</span><span class="ident" id="4498382">f</span><span class="op" id="4498383">.</span><span class="ident" id="4498384">openNonce</span><span class="op" id="4498393">)</span><span class="op" id="4498394">-</span><span class="num" id="4498395">8</span><span class="op" id="4498396">:</span><span class="op" id="4498397">]</span><span class="op" id="4498398">,</span>&nbsp;<span class="ident" id="4498400">nonce</span><span class="op" id="4498405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498408">return</span>&nbsp;<span class="ident" id="4498415">f</span><span class="op" id="4498416">.</span><span class="ident" id="4498417">aead</span><span class="op" id="4498421">.</span><span class="ident" id="4498422">Open</span><span class="op" id="4498426">(</span><span class="ident" id="4498427">out</span><span class="op" id="4498430">,</span>&nbsp;<span class="ident" id="4498432">f</span><span class="op" id="4498433">.</span><span class="ident" id="4498434">openNonce</span><span class="op" id="4498443">,</span>&nbsp;<span class="ident" id="4498445">plaintext</span><span class="op" id="4498454">,</span>&nbsp;<span class="ident" id="4498456">additionalData</span><span class="op" id="4498470">)</span><br>
<span class="lineno"></span><span class="op" id="4498472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4498475">func</span>&nbsp;<span class="ident" id="4498480">aeadAESGCM</span><span class="op" id="4498490">(</span><span class="ident" id="4498491">key</span><span class="op" id="4498494">,</span>&nbsp;<span class="ident" id="4498496">fixedNonce</span>&nbsp;<span class="op" id="4498507">[</span><span class="op" id="4498508">]</span><span class="builtintype" id="4498509">byte</span><span class="op" id="4498513">)</span>&nbsp;<span class="ident" id="4498515">cipher</span><span class="op" id="4498521">.</span><span class="ident" id="4498522">AEAD</span>&nbsp;<span class="op" id="4498527">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498530">aes</span><span class="op" id="4498533">,</span>&nbsp;<span class="ident" id="4498535">err</span>&nbsp;<span class="op" id="4498539">:=</span>&nbsp;<span class="ident" id="4498542">aes</span><span class="op" id="4498545">.</span><span class="ident" id="4498546">NewCipher</span><span class="op" id="4498555">(</span><span class="ident" id="4498556">key</span><span class="op" id="4498559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498562">if</span>&nbsp;<span class="ident" id="4498565">err</span>&nbsp;<span class="op" id="4498569">!=</span>&nbsp;<span class="ident" id="4498572">nil</span>&nbsp;<span class="op" id="4498576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4498580">panic</span><span class="op" id="4498585">(</span><span class="ident" id="4498586">err</span><span class="op" id="4498589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4498592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498595">aead</span><span class="op" id="4498599">,</span>&nbsp;<span class="ident" id="4498601">err</span>&nbsp;<span class="op" id="4498605">:=</span>&nbsp;<span class="ident" id="4498608">cipher</span><span class="op" id="4498614">.</span><span class="ident" id="4498615">NewGCM</span><span class="op" id="4498621">(</span><span class="ident" id="4498622">aes</span><span class="op" id="4498625">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498628">if</span>&nbsp;<span class="ident" id="4498631">err</span>&nbsp;<span class="op" id="4498635">!=</span>&nbsp;<span class="ident" id="4498638">nil</span>&nbsp;<span class="op" id="4498642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4498646">panic</span><span class="op" id="4498651">(</span><span class="ident" id="4498652">err</span><span class="op" id="4498655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4498658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498662">nonce1</span><span class="op" id="4498668">,</span>&nbsp;<span class="ident" id="4498670">nonce2</span>&nbsp;<span class="op" id="4498677">:=</span>&nbsp;<span class="builtinfunc" id="4498680">make</span><span class="op" id="4498684">(</span><span class="op" id="4498685">[</span><span class="op" id="4498686">]</span><span class="builtintype" id="4498687">byte</span><span class="op" id="4498691">,</span>&nbsp;<span class="num" id="4498693">12</span><span class="op" id="4498695">)</span><span class="op" id="4498696">,</span>&nbsp;<span class="builtinfunc" id="4498698">make</span><span class="op" id="4498702">(</span><span class="op" id="4498703">[</span><span class="op" id="4498704">]</span><span class="builtintype" id="4498705">byte</span><span class="op" id="4498709">,</span>&nbsp;<span class="num" id="4498711">12</span><span class="op" id="4498713">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4498716">copy</span><span class="op" id="4498720">(</span><span class="ident" id="4498721">nonce1</span><span class="op" id="4498727">,</span>&nbsp;<span class="ident" id="4498729">fixedNonce</span><span class="op" id="4498739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4498742">copy</span><span class="op" id="4498746">(</span><span class="ident" id="4498747">nonce2</span><span class="op" id="4498753">,</span>&nbsp;<span class="ident" id="4498755">fixedNonce</span><span class="op" id="4498765">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498769">return</span>&nbsp;<span class="op" id="4498776">&amp;</span><span class="ident" id="4498777">fixedNonceAEAD</span><span class="op" id="4498791">{</span><span class="ident" id="4498792">nonce1</span><span class="op" id="4498798">,</span>&nbsp;<span class="ident" id="4498800">nonce2</span><span class="op" id="4498806">,</span>&nbsp;<span class="ident" id="4498808">aead</span><span class="op" id="4498812">}</span><br>
<span class="lineno"></span><span class="op" id="4498814">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="4498817">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4498878">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="4498956">type</span>&nbsp;<span class="ident" id="4498961">ssl30MAC</span>&nbsp;<span class="keyword" id="4498970">struct</span>&nbsp;<span class="op" id="4498977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498980">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4498984">hash</span><span class="op" id="4498988">.</span><span class="ident" id="4498989">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498995">key</span>&nbsp;<span class="op" id="4498999">[</span><span class="op" id="4499000">]</span><span class="builtintype" id="4499001">byte</span><br>
<span class="lineno"></span><span class="op" id="4499006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4499009">func</span>&nbsp;<span class="op" id="4499014">(</span><span class="ident" id="4499015">s</span>&nbsp;<span class="ident" id="4499017">ssl30MAC</span><span class="op" id="4499025">)</span>&nbsp;<span class="ident" id="4499027">Size</span><span class="op" id="4499031">(</span><span class="op" id="4499032">)</span>&nbsp;<span class="builtintype" id="4499034">int</span>&nbsp;<span class="op" id="4499038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499041">return</span>&nbsp;<span class="ident" id="4499048">s</span><span class="op" id="4499049">.</span><span class="ident" id="4499050">h</span><span class="op" id="4499051">.</span><span class="ident" id="4499052">Size</span><span class="op" id="4499056">(</span><span class="op" id="4499057">)</span><br>
<span class="lineno">175</span><span class="op" id="4499059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4499062">var</span>&nbsp;<span class="ident" id="4499066">ssl30Pad1</span>&nbsp;<span class="op" id="4499076">=</span>&nbsp;<span class="op" id="4499078">[</span><span class="num" id="4499079">48</span><span class="op" id="4499081">]</span><span class="builtintype" id="4499082">byte</span><span class="op" id="4499086">{</span><span class="num" id="4499087">0x36</span><span class="op" id="4499091">,</span>&nbsp;<span class="num" id="4499093">0x36</span><span class="op" id="4499097">,</span>&nbsp;<span class="num" id="4499099">0x36</span><span class="op" id="4499103">,</span>&nbsp;<span class="num" id="4499105">0x36</span><span class="op" id="4499109">,</span>&nbsp;<span class="num" id="4499111">0x36</span><span class="op" id="4499115">,</span>&nbsp;<span class="num" id="4499117">0x36</span><span class="op" id="4499121">,</span>&nbsp;<span class="num" id="4499123">0x36</span><span class="op" id="4499127">,</span>&nbsp;<span class="num" id="4499129">0x36</span><span class="op" id="4499133">,</span>&nbsp;<span class="num" id="4499135">0x36</span><span class="op" id="4499139">,</span>&nbsp;<span class="num" id="4499141">0x36</span><span class="op" id="4499145">,</span>&nbsp;<span class="num" id="4499147">0x36</span><span class="op" id="4499151">,</span>&nbsp;<span class="num" id="4499153">0x36</span><span class="op" id="4499157">,</span>&nbsp;<span class="num" id="4499159">0x36</span><span class="op" id="4499163">,</span>&nbsp;<span class="num" id="4499165">0x36</span><span class="op" id="4499169">,</span>&nbsp;<span class="num" id="4499171">0x36</span><span class="op" id="4499175">,</span>&nbsp;<span class="num" id="4499177">0x36</span><span class="op" id="4499181">,</span>&nbsp;<span class="num" id="4499183">0x36</span><span class="op" id="4499187">,</span>&nbsp;<span class="num" id="4499189">0x36</span><span class="op" id="4499193">,</span>&nbsp;<span class="num" id="4499195">0x36</span><span class="op" id="4499199">,</span>&nbsp;<span class="num" id="4499201">0x36</span><span class="op" id="4499205">,</span>&nbsp;<span class="num" id="4499207">0x36</span><span class="op" id="4499211">,</span>&nbsp;<span class="num" id="4499213">0x36</span><span class="op" id="4499217">,</span>&nbsp;<span class="num" id="4499219">0x36</span><span class="op" id="4499223">,</span>&nbsp;<span class="num" id="4499225">0x36</span><span class="op" id="4499229">,</span>&nbsp;<span class="num" id="4499231">0x36</span><span class="op" id="4499235">,</span>&nbsp;<span class="num" id="4499237">0x36</span><span class="op" id="4499241">,</span>&nbsp;<span class="num" id="4499243">0x36</span><span class="op" id="4499247">,</span>&nbsp;<span class="num" id="4499249">0x36</span><span class="op" id="4499253">,</span>&nbsp;<span class="num" id="4499255">0x36</span><span class="op" id="4499259">,</span>&nbsp;<span class="num" id="4499261">0x36</span><span class="op" id="4499265">,</span>&nbsp;<span class="num" id="4499267">0x36</span><span class="op" id="4499271">,</span>&nbsp;<span class="num" id="4499273">0x36</span><span class="op" id="4499277">,</span>&nbsp;<span class="num" id="4499279">0x36</span><span class="op" id="4499283">,</span>&nbsp;<span class="num" id="4499285">0x36</span><span class="op" id="4499289">,</span>&nbsp;<span class="num" id="4499291">0x36</span><span class="op" id="4499295">,</span>&nbsp;<span class="num" id="4499297">0x36</span><span class="op" id="4499301">,</span>&nbsp;<span class="num" id="4499303">0x36</span><span class="op" id="4499307">,</span>&nbsp;<span class="num" id="4499309">0x36</span><span class="op" id="4499313">,</span>&nbsp;<span class="num" id="4499315">0x36</span><span class="op" id="4499319">,</span>&nbsp;<span class="num" id="4499321">0x36</span><span class="op" id="4499325">,</span>&nbsp;<span class="num" id="4499327">0x36</span><span class="op" id="4499331">,</span>&nbsp;<span class="num" id="4499333">0x36</span><span class="op" id="4499337">,</span>&nbsp;<span class="num" id="4499339">0x36</span><span class="op" id="4499343">,</span>&nbsp;<span class="num" id="4499345">0x36</span><span class="op" id="4499349">,</span>&nbsp;<span class="num" id="4499351">0x36</span><span class="op" id="4499355">,</span>&nbsp;<span class="num" id="4499357">0x36</span><span class="op" id="4499361">,</span>&nbsp;<span class="num" id="4499363">0x36</span><span class="op" id="4499367">,</span>&nbsp;<span class="num" id="4499369">0x36</span><span class="op" id="4499373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4499376">var</span>&nbsp;<span class="ident" id="4499380">ssl30Pad2</span>&nbsp;<span class="op" id="4499390">=</span>&nbsp;<span class="op" id="4499392">[</span><span class="num" id="4499393">48</span><span class="op" id="4499395">]</span><span class="builtintype" id="4499396">byte</span><span class="op" id="4499400">{</span><span class="num" id="4499401">0x5c</span><span class="op" id="4499405">,</span>&nbsp;<span class="num" id="4499407">0x5c</span><span class="op" id="4499411">,</span>&nbsp;<span class="num" id="4499413">0x5c</span><span class="op" id="4499417">,</span>&nbsp;<span class="num" id="4499419">0x5c</span><span class="op" id="4499423">,</span>&nbsp;<span class="num" id="4499425">0x5c</span><span class="op" id="4499429">,</span>&nbsp;<span class="num" id="4499431">0x5c</span><span class="op" id="4499435">,</span>&nbsp;<span class="num" id="4499437">0x5c</span><span class="op" id="4499441">,</span>&nbsp;<span class="num" id="4499443">0x5c</span><span class="op" id="4499447">,</span>&nbsp;<span class="num" id="4499449">0x5c</span><span class="op" id="4499453">,</span>&nbsp;<span class="num" id="4499455">0x5c</span><span class="op" id="4499459">,</span>&nbsp;<span class="num" id="4499461">0x5c</span><span class="op" id="4499465">,</span>&nbsp;<span class="num" id="4499467">0x5c</span><span class="op" id="4499471">,</span>&nbsp;<span class="num" id="4499473">0x5c</span><span class="op" id="4499477">,</span>&nbsp;<span class="num" id="4499479">0x5c</span><span class="op" id="4499483">,</span>&nbsp;<span class="num" id="4499485">0x5c</span><span class="op" id="4499489">,</span>&nbsp;<span class="num" id="4499491">0x5c</span><span class="op" id="4499495">,</span>&nbsp;<span class="num" id="4499497">0x5c</span><span class="op" id="4499501">,</span>&nbsp;<span class="num" id="4499503">0x5c</span><span class="op" id="4499507">,</span>&nbsp;<span class="num" id="4499509">0x5c</span><span class="op" id="4499513">,</span>&nbsp;<span class="num" id="4499515">0x5c</span><span class="op" id="4499519">,</span>&nbsp;<span class="num" id="4499521">0x5c</span><span class="op" id="4499525">,</span>&nbsp;<span class="num" id="4499527">0x5c</span><span class="op" id="4499531">,</span>&nbsp;<span class="num" id="4499533">0x5c</span><span class="op" id="4499537">,</span>&nbsp;<span class="num" id="4499539">0x5c</span><span class="op" id="4499543">,</span>&nbsp;<span class="num" id="4499545">0x5c</span><span class="op" id="4499549">,</span>&nbsp;<span class="num" id="4499551">0x5c</span><span class="op" id="4499555">,</span>&nbsp;<span class="num" id="4499557">0x5c</span><span class="op" id="4499561">,</span>&nbsp;<span class="num" id="4499563">0x5c</span><span class="op" id="4499567">,</span>&nbsp;<span class="num" id="4499569">0x5c</span><span class="op" id="4499573">,</span>&nbsp;<span class="num" id="4499575">0x5c</span><span class="op" id="4499579">,</span>&nbsp;<span class="num" id="4499581">0x5c</span><span class="op" id="4499585">,</span>&nbsp;<span class="num" id="4499587">0x5c</span><span class="op" id="4499591">,</span>&nbsp;<span class="num" id="4499593">0x5c</span><span class="op" id="4499597">,</span>&nbsp;<span class="num" id="4499599">0x5c</span><span class="op" id="4499603">,</span>&nbsp;<span class="num" id="4499605">0x5c</span><span class="op" id="4499609">,</span>&nbsp;<span class="num" id="4499611">0x5c</span><span class="op" id="4499615">,</span>&nbsp;<span class="num" id="4499617">0x5c</span><span class="op" id="4499621">,</span>&nbsp;<span class="num" id="4499623">0x5c</span><span class="op" id="4499627">,</span>&nbsp;<span class="num" id="4499629">0x5c</span><span class="op" id="4499633">,</span>&nbsp;<span class="num" id="4499635">0x5c</span><span class="op" id="4499639">,</span>&nbsp;<span class="num" id="4499641">0x5c</span><span class="op" id="4499645">,</span>&nbsp;<span class="num" id="4499647">0x5c</span><span class="op" id="4499651">,</span>&nbsp;<span class="num" id="4499653">0x5c</span><span class="op" id="4499657">,</span>&nbsp;<span class="num" id="4499659">0x5c</span><span class="op" id="4499663">,</span>&nbsp;<span class="num" id="4499665">0x5c</span><span class="op" id="4499669">,</span>&nbsp;<span class="num" id="4499671">0x5c</span><span class="op" id="4499675">,</span>&nbsp;<span class="num" id="4499677">0x5c</span><span class="op" id="4499681">,</span>&nbsp;<span class="num" id="4499683">0x5c</span><span class="op" id="4499687">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="4499690">func</span>&nbsp;<span class="op" id="4499695">(</span><span class="ident" id="4499696">s</span>&nbsp;<span class="ident" id="4499698">ssl30MAC</span><span class="op" id="4499706">)</span>&nbsp;<span class="ident" id="4499708">MAC</span><span class="op" id="4499711">(</span><span class="ident" id="4499712">digestBuf</span><span class="op" id="4499721">,</span>&nbsp;<span class="ident" id="4499723">seq</span><span class="op" id="4499726">,</span>&nbsp;<span class="ident" id="4499728">header</span><span class="op" id="4499734">,</span>&nbsp;<span class="ident" id="4499736">data</span>&nbsp;<span class="op" id="4499741">[</span><span class="op" id="4499742">]</span><span class="builtintype" id="4499743">byte</span><span class="op" id="4499747">)</span>&nbsp;<span class="op" id="4499749">[</span><span class="op" id="4499750">]</span><span class="builtintype" id="4499751">byte</span>&nbsp;<span class="op" id="4499756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499759">padLength</span>&nbsp;<span class="op" id="4499769">:=</span>&nbsp;<span class="num" id="4499772">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499776">if</span>&nbsp;<span class="ident" id="4499779">s</span><span class="op" id="4499780">.</span><span class="ident" id="4499781">h</span><span class="op" id="4499782">.</span><span class="ident" id="4499783">Size</span><span class="op" id="4499787">(</span><span class="op" id="4499788">)</span>&nbsp;<span class="op" id="4499790">==</span>&nbsp;<span class="num" id="4499793">20</span>&nbsp;<span class="op" id="4499796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499800">padLength</span>&nbsp;<span class="op" id="4499810">=</span>&nbsp;<span class="num" id="4499812">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4499816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499820">s</span><span class="op" id="4499821">.</span><span class="ident" id="4499822">h</span><span class="op" id="4499823">.</span><span class="ident" id="4499824">Reset</span><span class="op" id="4499829">(</span><span class="op" id="4499830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499833">s</span><span class="op" id="4499834">.</span><span class="ident" id="4499835">h</span><span class="op" id="4499836">.</span><span class="ident" id="4499837">Write</span><span class="op" id="4499842">(</span><span class="ident" id="4499843">s</span><span class="op" id="4499844">.</span><span class="ident" id="4499845">key</span><span class="op" id="4499848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499851">s</span><span class="op" id="4499852">.</span><span class="ident" id="4499853">h</span><span class="op" id="4499854">.</span><span class="ident" id="4499855">Write</span><span class="op" id="4499860">(</span><span class="ident" id="4499861">ssl30Pad1</span><span class="op" id="4499870">[</span><span class="op" id="4499871">:</span><span class="ident" id="4499872">padLength</span><span class="op" id="4499881">]</span><span class="op" id="4499882">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499885">s</span><span class="op" id="4499886">.</span><span class="ident" id="4499887">h</span><span class="op" id="4499888">.</span><span class="ident" id="4499889">Write</span><span class="op" id="4499894">(</span><span class="ident" id="4499895">seq</span><span class="op" id="4499898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499901">s</span><span class="op" id="4499902">.</span><span class="ident" id="4499903">h</span><span class="op" id="4499904">.</span><span class="ident" id="4499905">Write</span><span class="op" id="4499910">(</span><span class="ident" id="4499911">header</span><span class="op" id="4499917">[</span><span class="op" id="4499918">:</span><span class="num" id="4499919">1</span><span class="op" id="4499920">]</span><span class="op" id="4499921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499924">s</span><span class="op" id="4499925">.</span><span class="ident" id="4499926">h</span><span class="op" id="4499927">.</span><span class="ident" id="4499928">Write</span><span class="op" id="4499933">(</span><span class="ident" id="4499934">header</span><span class="op" id="4499940">[</span><span class="num" id="4499941">3</span><span class="op" id="4499942">:</span><span class="num" id="4499943">5</span><span class="op" id="4499944">]</span><span class="op" id="4499945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499948">s</span><span class="op" id="4499949">.</span><span class="ident" id="4499950">h</span><span class="op" id="4499951">.</span><span class="ident" id="4499952">Write</span><span class="op" id="4499957">(</span><span class="ident" id="4499958">data</span><span class="op" id="4499962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499965">digestBuf</span>&nbsp;<span class="op" id="4499975">=</span>&nbsp;<span class="ident" id="4499977">s</span><span class="op" id="4499978">.</span><span class="ident" id="4499979">h</span><span class="op" id="4499980">.</span><span class="ident" id="4499981">Sum</span><span class="op" id="4499984">(</span><span class="ident" id="4499985">digestBuf</span><span class="op" id="4499994">[</span><span class="op" id="4499995">:</span><span class="num" id="4499996">0</span><span class="op" id="4499997">]</span><span class="op" id="4499998">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500002">s</span><span class="op" id="4500003">.</span><span class="ident" id="4500004">h</span><span class="op" id="4500005">.</span><span class="ident" id="4500006">Reset</span><span class="op" id="4500011">(</span><span class="op" id="4500012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500015">s</span><span class="op" id="4500016">.</span><span class="ident" id="4500017">h</span><span class="op" id="4500018">.</span><span class="ident" id="4500019">Write</span><span class="op" id="4500024">(</span><span class="ident" id="4500025">s</span><span class="op" id="4500026">.</span><span class="ident" id="4500027">key</span><span class="op" id="4500030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500033">s</span><span class="op" id="4500034">.</span><span class="ident" id="4500035">h</span><span class="op" id="4500036">.</span><span class="ident" id="4500037">Write</span><span class="op" id="4500042">(</span><span class="ident" id="4500043">ssl30Pad2</span><span class="op" id="4500052">[</span><span class="op" id="4500053">:</span><span class="ident" id="4500054">padLength</span><span class="op" id="4500063">]</span><span class="op" id="4500064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500067">s</span><span class="op" id="4500068">.</span><span class="ident" id="4500069">h</span><span class="op" id="4500070">.</span><span class="ident" id="4500071">Write</span><span class="op" id="4500076">(</span><span class="ident" id="4500077">digestBuf</span><span class="op" id="4500086">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500089">return</span>&nbsp;<span class="ident" id="4500096">s</span><span class="op" id="4500097">.</span><span class="ident" id="4500098">h</span><span class="op" id="4500099">.</span><span class="ident" id="4500100">Sum</span><span class="op" id="4500103">(</span><span class="ident" id="4500104">digestBuf</span><span class="op" id="4500113">[</span><span class="op" id="4500114">:</span><span class="num" id="4500115">0</span><span class="op" id="4500116">]</span><span class="op" id="4500117">)</span><br>
<span class="lineno"></span><span class="op" id="4500119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4500122">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="4500196">type</span>&nbsp;<span class="ident" id="4500201">tls10MAC</span>&nbsp;<span class="keyword" id="4500210">struct</span>&nbsp;<span class="op" id="4500217">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500220">h</span>&nbsp;<span class="ident" id="4500222">hash</span><span class="op" id="4500226">.</span><span class="ident" id="4500227">Hash</span><br>
<span class="lineno"></span><span class="op" id="4500232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4500235">func</span>&nbsp;<span class="op" id="4500240">(</span><span class="ident" id="4500241">s</span>&nbsp;<span class="ident" id="4500243">tls10MAC</span><span class="op" id="4500251">)</span>&nbsp;<span class="ident" id="4500253">Size</span><span class="op" id="4500257">(</span><span class="op" id="4500258">)</span>&nbsp;<span class="builtintype" id="4500260">int</span>&nbsp;<span class="op" id="4500264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500267">return</span>&nbsp;<span class="ident" id="4500274">s</span><span class="op" id="4500275">.</span><span class="ident" id="4500276">h</span><span class="op" id="4500277">.</span><span class="ident" id="4500278">Size</span><span class="op" id="4500282">(</span><span class="op" id="4500283">)</span><br>
<span class="lineno">210</span><span class="op" id="4500285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4500288">func</span>&nbsp;<span class="op" id="4500293">(</span><span class="ident" id="4500294">s</span>&nbsp;<span class="ident" id="4500296">tls10MAC</span><span class="op" id="4500304">)</span>&nbsp;<span class="ident" id="4500306">MAC</span><span class="op" id="4500309">(</span><span class="ident" id="4500310">digestBuf</span><span class="op" id="4500319">,</span>&nbsp;<span class="ident" id="4500321">seq</span><span class="op" id="4500324">,</span>&nbsp;<span class="ident" id="4500326">header</span><span class="op" id="4500332">,</span>&nbsp;<span class="ident" id="4500334">data</span>&nbsp;<span class="op" id="4500339">[</span><span class="op" id="4500340">]</span><span class="builtintype" id="4500341">byte</span><span class="op" id="4500345">)</span>&nbsp;<span class="op" id="4500347">[</span><span class="op" id="4500348">]</span><span class="builtintype" id="4500349">byte</span>&nbsp;<span class="op" id="4500354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500357">s</span><span class="op" id="4500358">.</span><span class="ident" id="4500359">h</span><span class="op" id="4500360">.</span><span class="ident" id="4500361">Reset</span><span class="op" id="4500366">(</span><span class="op" id="4500367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500370">s</span><span class="op" id="4500371">.</span><span class="ident" id="4500372">h</span><span class="op" id="4500373">.</span><span class="ident" id="4500374">Write</span><span class="op" id="4500379">(</span><span class="ident" id="4500380">seq</span><span class="op" id="4500383">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500386">s</span><span class="op" id="4500387">.</span><span class="ident" id="4500388">h</span><span class="op" id="4500389">.</span><span class="ident" id="4500390">Write</span><span class="op" id="4500395">(</span><span class="ident" id="4500396">header</span><span class="op" id="4500402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500405">s</span><span class="op" id="4500406">.</span><span class="ident" id="4500407">h</span><span class="op" id="4500408">.</span><span class="ident" id="4500409">Write</span><span class="op" id="4500414">(</span><span class="ident" id="4500415">data</span><span class="op" id="4500419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500422">return</span>&nbsp;<span class="ident" id="4500429">s</span><span class="op" id="4500430">.</span><span class="ident" id="4500431">h</span><span class="op" id="4500432">.</span><span class="ident" id="4500433">Sum</span><span class="op" id="4500436">(</span><span class="ident" id="4500437">digestBuf</span><span class="op" id="4500446">[</span><span class="op" id="4500447">:</span><span class="num" id="4500448">0</span><span class="op" id="4500449">]</span><span class="op" id="4500450">)</span><br>
<span class="lineno"></span><span class="op" id="4500452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="4500455">func</span>&nbsp;<span class="ident" id="4500460">rsaKA</span><span class="op" id="4500465">(</span><span class="ident" id="4500466">version</span>&nbsp;<span class="builtintype" id="4500474">uint16</span><span class="op" id="4500480">)</span>&nbsp;<span class="ident" id="4500482">keyAgreement</span>&nbsp;<span class="op" id="4500495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500498">return</span>&nbsp;<span class="ident" id="4500505">rsaKeyAgreement</span><span class="op" id="4500520">{</span><span class="op" id="4500521">}</span><br>
<span class="lineno"></span><span class="op" id="4500523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4500526">func</span>&nbsp;<span class="ident" id="4500531">ecdheECDSAKA</span><span class="op" id="4500543">(</span><span class="ident" id="4500544">version</span>&nbsp;<span class="builtintype" id="4500552">uint16</span><span class="op" id="4500558">)</span>&nbsp;<span class="ident" id="4500560">keyAgreement</span>&nbsp;<span class="op" id="4500573">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500576">return</span>&nbsp;<span class="op" id="4500583">&amp;</span><span class="ident" id="4500584">ecdheKeyAgreement</span><span class="op" id="4500601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500605">sigType</span><span class="op" id="4500612">:</span>&nbsp;<span class="ident" id="4500614">signatureECDSA</span><span class="op" id="4500628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500632">version</span><span class="op" id="4500639">:</span>&nbsp;<span class="ident" id="4500641">version</span><span class="op" id="4500648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4500651">}</span><br>
<span class="lineno"></span><span class="op" id="4500653">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4500656">func</span>&nbsp;<span class="ident" id="4500661">ecdheRSAKA</span><span class="op" id="4500671">(</span><span class="ident" id="4500672">version</span>&nbsp;<span class="builtintype" id="4500680">uint16</span><span class="op" id="4500686">)</span>&nbsp;<span class="ident" id="4500688">keyAgreement</span>&nbsp;<span class="op" id="4500701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500704">return</span>&nbsp;<span class="op" id="4500711">&amp;</span><span class="ident" id="4500712">ecdheKeyAgreement</span><span class="op" id="4500729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500733">sigType</span><span class="op" id="4500740">:</span>&nbsp;<span class="ident" id="4500742">signatureRSA</span><span class="op" id="4500754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500758">version</span><span class="op" id="4500765">:</span>&nbsp;<span class="ident" id="4500767">version</span><span class="op" id="4500774">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4500777">}</span><br>
<span class="lineno"></span><span class="op" id="4500779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4500782">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="4500851">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="4500901">func</span>&nbsp;<span class="ident" id="4500906">mutualCipherSuite</span><span class="op" id="4500923">(</span><span class="ident" id="4500924">have</span>&nbsp;<span class="op" id="4500929">[</span><span class="op" id="4500930">]</span><span class="builtintype" id="4500931">uint16</span><span class="op" id="4500937">,</span>&nbsp;<span class="ident" id="4500939">want</span>&nbsp;<span class="builtintype" id="4500944">uint16</span><span class="op" id="4500950">)</span>&nbsp;<span class="op" id="4500952">*</span><span class="ident" id="4500953">cipherSuite</span>&nbsp;<span class="op" id="4500965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500968">for</span>&nbsp;<span class="ident" id="4500972">_</span><span class="op" id="4500973">,</span>&nbsp;<span class="ident" id="4500975">id</span>&nbsp;<span class="op" id="4500978">:=</span>&nbsp;<span class="keyword" id="4500981">range</span>&nbsp;<span class="ident" id="4500987">have</span>&nbsp;<span class="op" id="4500992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500996">if</span>&nbsp;<span class="ident" id="4500999">id</span>&nbsp;<span class="op" id="4501002">==</span>&nbsp;<span class="ident" id="4501005">want</span>&nbsp;<span class="op" id="4501010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501015">for</span>&nbsp;<span class="ident" id="4501019">_</span><span class="op" id="4501020">,</span>&nbsp;<span class="ident" id="4501022">suite</span>&nbsp;<span class="op" id="4501028">:=</span>&nbsp;<span class="keyword" id="4501031">range</span>&nbsp;<span class="ident" id="4501037">cipherSuites</span>&nbsp;<span class="op" id="4501050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501056">if</span>&nbsp;<span class="ident" id="4501059">suite</span><span class="op" id="4501064">.</span><span class="ident" id="4501065">id</span>&nbsp;<span class="op" id="4501068">==</span>&nbsp;<span class="ident" id="4501071">want</span>&nbsp;<span class="op" id="4501076">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501083">return</span>&nbsp;<span class="ident" id="4501090">suite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501110">return</span>&nbsp;<span class="ident" id="4501117">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501123">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501129">return</span>&nbsp;<span class="ident" id="4501136">nil</span><br>
<span class="lineno"></span><span class="op" id="4501140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4501143">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="4501198">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="4501267">const</span>&nbsp;<span class="op" id="4501273">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501276">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4501316">uint16</span>&nbsp;<span class="op" id="4501323">=</span>&nbsp;<span class="num" id="4501325">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501333">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4501373">uint16</span>&nbsp;<span class="op" id="4501380">=</span>&nbsp;<span class="num" id="4501382">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501390">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4501430">uint16</span>&nbsp;<span class="op" id="4501437">=</span>&nbsp;<span class="num" id="4501439">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501447">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4501487">uint16</span>&nbsp;<span class="op" id="4501494">=</span>&nbsp;<span class="num" id="4501496">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501504">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4501544">uint16</span>&nbsp;<span class="op" id="4501551">=</span>&nbsp;<span class="num" id="4501553">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501561">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4501601">uint16</span>&nbsp;<span class="op" id="4501608">=</span>&nbsp;<span class="num" id="4501610">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501618">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4501658">uint16</span>&nbsp;<span class="op" id="4501665">=</span>&nbsp;<span class="num" id="4501667">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501675">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4501715">uint16</span>&nbsp;<span class="op" id="4501722">=</span>&nbsp;<span class="num" id="4501724">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501732">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4501772">uint16</span>&nbsp;<span class="op" id="4501779">=</span>&nbsp;<span class="num" id="4501781">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501789">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4501829">uint16</span>&nbsp;<span class="op" id="4501836">=</span>&nbsp;<span class="num" id="4501838">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501846">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4501886">uint16</span>&nbsp;<span class="op" id="4501893">=</span>&nbsp;<span class="num" id="4501895">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501903">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4501943">uint16</span>&nbsp;<span class="op" id="4501950">=</span>&nbsp;<span class="num" id="4501952">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501960">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="4502000">uint16</span>&nbsp;<span class="op" id="4502007">=</span>&nbsp;<span class="num" id="4502009">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4502018">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4502087">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4502138">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502204">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="4502222">uint16</span>&nbsp;<span class="op" id="4502229">=</span>&nbsp;<span class="num" id="4502231">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="4502238">)</span>
</div>
</body>
</html>
