<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha256</h2>
<ul>
<li><a href="/gostd/crypto/sha256/sha256.go.html" class="current">sha256.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256_test.go.html">sha256_test.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256block_decl.go.html">sha256block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4180416">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4180471">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4180525">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4180576">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4180654">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="4180672">package</span>&nbsp;<span class="ident" id="4180680">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4180688">import</span>&nbsp;<span class="op" id="4180695">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4180698">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4180708">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4180715">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4180718">func</span>&nbsp;<span class="ident" id="4180723">init</span><span class="op" id="4180727">(</span><span class="op" id="4180728">)</span>&nbsp;<span class="op" id="4180730">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4180733">crypto</span><span class="op" id="4180739">.</span><span class="ident" id="4180740">RegisterHash</span><span class="op" id="4180752">(</span><span class="ident" id="4180753">crypto</span><span class="op" id="4180759">.</span><span class="ident" id="4180760">SHA224</span><span class="op" id="4180766">,</span>&nbsp;<span class="ident" id="4180768">New224</span><span class="op" id="4180774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4180777">crypto</span><span class="op" id="4180783">.</span><span class="ident" id="4180784">RegisterHash</span><span class="op" id="4180796">(</span><span class="ident" id="4180797">crypto</span><span class="op" id="4180803">.</span><span class="ident" id="4180804">SHA256</span><span class="op" id="4180810">,</span>&nbsp;<span class="ident" id="4180812">New</span><span class="op" id="4180815">)</span><br>
<span class="lineno"></span><span class="op" id="4180817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4180820">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4180863">const</span>&nbsp;<span class="ident" id="4180869">Size</span>&nbsp;<span class="op" id="4180874">=</span>&nbsp;<span class="num" id="4180876">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4180880">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4180923">const</span>&nbsp;<span class="ident" id="4180929">Size224</span>&nbsp;<span class="op" id="4180937">=</span>&nbsp;<span class="num" id="4180939">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4180943">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4180991">const</span>&nbsp;<span class="ident" id="4180997">BlockSize</span>&nbsp;<span class="op" id="4181007">=</span>&nbsp;<span class="num" id="4181009">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4181013">const</span>&nbsp;<span class="op" id="4181019">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181022">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181032">=</span>&nbsp;<span class="num" id="4181034">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181038">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181048">=</span>&nbsp;<span class="num" id="4181050">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181062">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181072">=</span>&nbsp;<span class="num" id="4181074">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181086">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181096">=</span>&nbsp;<span class="num" id="4181098">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181110">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181120">=</span>&nbsp;<span class="num" id="4181122">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181134">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181144">=</span>&nbsp;<span class="num" id="4181146">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181158">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181168">=</span>&nbsp;<span class="num" id="4181170">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181182">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181192">=</span>&nbsp;<span class="num" id="4181194">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181206">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181216">=</span>&nbsp;<span class="num" id="4181218">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181230">init0_224</span>&nbsp;<span class="op" id="4181240">=</span>&nbsp;<span class="num" id="4181242">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181254">init1_224</span>&nbsp;<span class="op" id="4181264">=</span>&nbsp;<span class="num" id="4181266">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181278">init2_224</span>&nbsp;<span class="op" id="4181288">=</span>&nbsp;<span class="num" id="4181290">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181302">init3_224</span>&nbsp;<span class="op" id="4181312">=</span>&nbsp;<span class="num" id="4181314">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181326">init4_224</span>&nbsp;<span class="op" id="4181336">=</span>&nbsp;<span class="num" id="4181338">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181350">init5_224</span>&nbsp;<span class="op" id="4181360">=</span>&nbsp;<span class="num" id="4181362">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181374">init6_224</span>&nbsp;<span class="op" id="4181384">=</span>&nbsp;<span class="num" id="4181386">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181398">init7_224</span>&nbsp;<span class="op" id="4181408">=</span>&nbsp;<span class="num" id="4181410">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="4181421">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4181424">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4181483">type</span>&nbsp;<span class="ident" id="4181488">digest</span>&nbsp;<span class="keyword" id="4181495">struct</span>&nbsp;<span class="op" id="4181502">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181505">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181511">[</span><span class="num" id="4181512">8</span><span class="op" id="4181513">]</span><span class="builtintype" id="4181514">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181522">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181528">[</span><span class="ident" id="4181529">chunk</span><span class="op" id="4181534">]</span><span class="builtintype" id="4181535">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181541">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4181547">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4181552">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4181558">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181566">is224</span>&nbsp;<span class="builtintype" id="4181572">bool</span>&nbsp;<span class="comment" id="4181577">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="4181611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4181614">func</span>&nbsp;<span class="op" id="4181619">(</span><span class="ident" id="4181620">d</span>&nbsp;<span class="op" id="4181622">*</span><span class="ident" id="4181623">digest</span><span class="op" id="4181629">)</span>&nbsp;<span class="ident" id="4181631">Reset</span><span class="op" id="4181636">(</span><span class="op" id="4181637">)</span>&nbsp;<span class="op" id="4181639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4181642">if</span>&nbsp;<span class="op" id="4181645">!</span><span class="ident" id="4181646">d</span><span class="op" id="4181647">.</span><span class="ident" id="4181648">is224</span>&nbsp;<span class="op" id="4181654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181658">d</span><span class="op" id="4181659">.</span><span class="ident" id="4181660">h</span><span class="op" id="4181661">[</span><span class="num" id="4181662">0</span><span class="op" id="4181663">]</span>&nbsp;<span class="op" id="4181665">=</span>&nbsp;<span class="ident" id="4181667">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181675">d</span><span class="op" id="4181676">.</span><span class="ident" id="4181677">h</span><span class="op" id="4181678">[</span><span class="num" id="4181679">1</span><span class="op" id="4181680">]</span>&nbsp;<span class="op" id="4181682">=</span>&nbsp;<span class="ident" id="4181684">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181692">d</span><span class="op" id="4181693">.</span><span class="ident" id="4181694">h</span><span class="op" id="4181695">[</span><span class="num" id="4181696">2</span><span class="op" id="4181697">]</span>&nbsp;<span class="op" id="4181699">=</span>&nbsp;<span class="ident" id="4181701">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181709">d</span><span class="op" id="4181710">.</span><span class="ident" id="4181711">h</span><span class="op" id="4181712">[</span><span class="num" id="4181713">3</span><span class="op" id="4181714">]</span>&nbsp;<span class="op" id="4181716">=</span>&nbsp;<span class="ident" id="4181718">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181726">d</span><span class="op" id="4181727">.</span><span class="ident" id="4181728">h</span><span class="op" id="4181729">[</span><span class="num" id="4181730">4</span><span class="op" id="4181731">]</span>&nbsp;<span class="op" id="4181733">=</span>&nbsp;<span class="ident" id="4181735">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181743">d</span><span class="op" id="4181744">.</span><span class="ident" id="4181745">h</span><span class="op" id="4181746">[</span><span class="num" id="4181747">5</span><span class="op" id="4181748">]</span>&nbsp;<span class="op" id="4181750">=</span>&nbsp;<span class="ident" id="4181752">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181760">d</span><span class="op" id="4181761">.</span><span class="ident" id="4181762">h</span><span class="op" id="4181763">[</span><span class="num" id="4181764">6</span><span class="op" id="4181765">]</span>&nbsp;<span class="op" id="4181767">=</span>&nbsp;<span class="ident" id="4181769">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181777">d</span><span class="op" id="4181778">.</span><span class="ident" id="4181779">h</span><span class="op" id="4181780">[</span><span class="num" id="4181781">7</span><span class="op" id="4181782">]</span>&nbsp;<span class="op" id="4181784">=</span>&nbsp;<span class="ident" id="4181786">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181793">}</span>&nbsp;<span class="keyword" id="4181795">else</span>&nbsp;<span class="op" id="4181800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181804">d</span><span class="op" id="4181805">.</span><span class="ident" id="4181806">h</span><span class="op" id="4181807">[</span><span class="num" id="4181808">0</span><span class="op" id="4181809">]</span>&nbsp;<span class="op" id="4181811">=</span>&nbsp;<span class="ident" id="4181813">init0_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181825">d</span><span class="op" id="4181826">.</span><span class="ident" id="4181827">h</span><span class="op" id="4181828">[</span><span class="num" id="4181829">1</span><span class="op" id="4181830">]</span>&nbsp;<span class="op" id="4181832">=</span>&nbsp;<span class="ident" id="4181834">init1_224</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181846">d</span><span class="op" id="4181847">.</span><span class="ident" id="4181848">h</span><span class="op" id="4181849">[</span><span class="num" id="4181850">2</span><span class="op" id="4181851">]</span>&nbsp;<span class="op" id="4181853">=</span>&nbsp;<span class="ident" id="4181855">init2_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181867">d</span><span class="op" id="4181868">.</span><span class="ident" id="4181869">h</span><span class="op" id="4181870">[</span><span class="num" id="4181871">3</span><span class="op" id="4181872">]</span>&nbsp;<span class="op" id="4181874">=</span>&nbsp;<span class="ident" id="4181876">init3_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181888">d</span><span class="op" id="4181889">.</span><span class="ident" id="4181890">h</span><span class="op" id="4181891">[</span><span class="num" id="4181892">4</span><span class="op" id="4181893">]</span>&nbsp;<span class="op" id="4181895">=</span>&nbsp;<span class="ident" id="4181897">init4_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181909">d</span><span class="op" id="4181910">.</span><span class="ident" id="4181911">h</span><span class="op" id="4181912">[</span><span class="num" id="4181913">5</span><span class="op" id="4181914">]</span>&nbsp;<span class="op" id="4181916">=</span>&nbsp;<span class="ident" id="4181918">init5_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181930">d</span><span class="op" id="4181931">.</span><span class="ident" id="4181932">h</span><span class="op" id="4181933">[</span><span class="num" id="4181934">6</span><span class="op" id="4181935">]</span>&nbsp;<span class="op" id="4181937">=</span>&nbsp;<span class="ident" id="4181939">init6_224</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181951">d</span><span class="op" id="4181952">.</span><span class="ident" id="4181953">h</span><span class="op" id="4181954">[</span><span class="num" id="4181955">7</span><span class="op" id="4181956">]</span>&nbsp;<span class="op" id="4181958">=</span>&nbsp;<span class="ident" id="4181960">init7_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4181971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181974">d</span><span class="op" id="4181975">.</span><span class="ident" id="4181976">nx</span>&nbsp;<span class="op" id="4181979">=</span>&nbsp;<span class="num" id="4181981">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4181984">d</span><span class="op" id="4181985">.</span><span class="builtinfunc" id="4181986">len</span>&nbsp;<span class="op" id="4181990">=</span>&nbsp;<span class="num" id="4181992">0</span><br>
<span class="lineno"></span><span class="op" id="4181994">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4181997">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4182059">func</span>&nbsp;<span class="ident" id="4182064">New</span><span class="op" id="4182067">(</span><span class="op" id="4182068">)</span>&nbsp;<span class="ident" id="4182070">hash</span><span class="op" id="4182074">.</span><span class="ident" id="4182075">Hash</span>&nbsp;<span class="op" id="4182080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182083">d</span>&nbsp;<span class="op" id="4182085">:=</span>&nbsp;<span class="builtinfunc" id="4182088">new</span><span class="op" id="4182091">(</span><span class="ident" id="4182092">digest</span><span class="op" id="4182098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182101">d</span><span class="op" id="4182102">.</span><span class="ident" id="4182103">Reset</span><span class="op" id="4182108">(</span><span class="op" id="4182109">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182112">return</span>&nbsp;<span class="ident" id="4182119">d</span><br>
<span class="lineno"></span><span class="op" id="4182121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4182124">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4182189">func</span>&nbsp;<span class="ident" id="4182194">New224</span><span class="op" id="4182200">(</span><span class="op" id="4182201">)</span>&nbsp;<span class="ident" id="4182203">hash</span><span class="op" id="4182207">.</span><span class="ident" id="4182208">Hash</span>&nbsp;<span class="op" id="4182213">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182216">d</span>&nbsp;<span class="op" id="4182218">:=</span>&nbsp;<span class="builtinfunc" id="4182221">new</span><span class="op" id="4182224">(</span><span class="ident" id="4182225">digest</span><span class="op" id="4182231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182234">d</span><span class="op" id="4182235">.</span><span class="ident" id="4182236">is224</span>&nbsp;<span class="op" id="4182242">=</span>&nbsp;<span class="builtintype" id="4182244">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182250">d</span><span class="op" id="4182251">.</span><span class="ident" id="4182252">Reset</span><span class="op" id="4182257">(</span><span class="op" id="4182258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182261">return</span>&nbsp;<span class="ident" id="4182268">d</span><br>
<span class="lineno"></span><span class="op" id="4182270">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4182273">func</span>&nbsp;<span class="op" id="4182278">(</span><span class="ident" id="4182279">d</span>&nbsp;<span class="op" id="4182281">*</span><span class="ident" id="4182282">digest</span><span class="op" id="4182288">)</span>&nbsp;<span class="ident" id="4182290">Size</span><span class="op" id="4182294">(</span><span class="op" id="4182295">)</span>&nbsp;<span class="builtintype" id="4182297">int</span>&nbsp;<span class="op" id="4182301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182304">if</span>&nbsp;<span class="op" id="4182307">!</span><span class="ident" id="4182308">d</span><span class="op" id="4182309">.</span><span class="ident" id="4182310">is224</span>&nbsp;<span class="op" id="4182316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182320">return</span>&nbsp;<span class="ident" id="4182327">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4182333">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182336">return</span>&nbsp;<span class="ident" id="4182343">Size224</span><br>
<span class="lineno"></span><span class="op" id="4182351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4182354">func</span>&nbsp;<span class="op" id="4182359">(</span><span class="ident" id="4182360">d</span>&nbsp;<span class="op" id="4182362">*</span><span class="ident" id="4182363">digest</span><span class="op" id="4182369">)</span>&nbsp;<span class="ident" id="4182371">BlockSize</span><span class="op" id="4182380">(</span><span class="op" id="4182381">)</span>&nbsp;<span class="builtintype" id="4182383">int</span>&nbsp;<span class="op" id="4182387">{</span>&nbsp;<span class="keyword" id="4182389">return</span>&nbsp;<span class="ident" id="4182396">BlockSize</span>&nbsp;<span class="op" id="4182406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4182409">func</span>&nbsp;<span class="op" id="4182414">(</span><span class="ident" id="4182415">d</span>&nbsp;<span class="op" id="4182417">*</span><span class="ident" id="4182418">digest</span><span class="op" id="4182424">)</span>&nbsp;<span class="ident" id="4182426">Write</span><span class="op" id="4182431">(</span><span class="ident" id="4182432">p</span>&nbsp;<span class="op" id="4182434">[</span><span class="op" id="4182435">]</span><span class="builtintype" id="4182436">byte</span><span class="op" id="4182440">)</span>&nbsp;<span class="op" id="4182442">(</span><span class="ident" id="4182443">nn</span>&nbsp;<span class="builtintype" id="4182446">int</span><span class="op" id="4182449">,</span>&nbsp;<span class="ident" id="4182451">err</span>&nbsp;<span class="builtintype" id="4182455">error</span><span class="op" id="4182460">)</span>&nbsp;<span class="op" id="4182462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182465">nn</span>&nbsp;<span class="op" id="4182468">=</span>&nbsp;<span class="builtinfunc" id="4182470">len</span><span class="op" id="4182473">(</span><span class="ident" id="4182474">p</span><span class="op" id="4182475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182478">d</span><span class="op" id="4182479">.</span><span class="builtinfunc" id="4182480">len</span>&nbsp;<span class="op" id="4182484">+=</span>&nbsp;<span class="ident" id="4182487">uint64</span><span class="op" id="4182493">(</span><span class="ident" id="4182494">nn</span><span class="op" id="4182496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182499">if</span>&nbsp;<span class="ident" id="4182502">d</span><span class="op" id="4182503">.</span><span class="ident" id="4182504">nx</span>&nbsp;<span class="op" id="4182507">&gt;</span>&nbsp;<span class="num" id="4182509">0</span>&nbsp;<span class="op" id="4182511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182515">n</span>&nbsp;<span class="op" id="4182517">:=</span>&nbsp;<span class="builtinfunc" id="4182520">copy</span><span class="op" id="4182524">(</span><span class="ident" id="4182525">d</span><span class="op" id="4182526">.</span><span class="ident" id="4182527">x</span><span class="op" id="4182528">[</span><span class="ident" id="4182529">d</span><span class="op" id="4182530">.</span><span class="ident" id="4182531">nx</span><span class="op" id="4182533">:</span><span class="op" id="4182534">]</span><span class="op" id="4182535">,</span>&nbsp;<span class="ident" id="4182537">p</span><span class="op" id="4182538">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182542">d</span><span class="op" id="4182543">.</span><span class="ident" id="4182544">nx</span>&nbsp;<span class="op" id="4182547">+=</span>&nbsp;<span class="ident" id="4182550">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182554">if</span>&nbsp;<span class="ident" id="4182557">d</span><span class="op" id="4182558">.</span><span class="ident" id="4182559">nx</span>&nbsp;<span class="op" id="4182562">==</span>&nbsp;<span class="ident" id="4182565">chunk</span>&nbsp;<span class="op" id="4182571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182576">block</span><span class="op" id="4182581">(</span><span class="ident" id="4182582">d</span><span class="op" id="4182583">,</span>&nbsp;<span class="ident" id="4182585">d</span><span class="op" id="4182586">.</span><span class="ident" id="4182587">x</span><span class="op" id="4182588">[</span><span class="op" id="4182589">:</span><span class="op" id="4182590">]</span><span class="op" id="4182591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182596">d</span><span class="op" id="4182597">.</span><span class="ident" id="4182598">nx</span>&nbsp;<span class="op" id="4182601">=</span>&nbsp;<span class="num" id="4182603">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4182607">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182611">p</span>&nbsp;<span class="op" id="4182613">=</span>&nbsp;<span class="ident" id="4182615">p</span><span class="op" id="4182616">[</span><span class="ident" id="4182617">n</span><span class="op" id="4182618">:</span><span class="op" id="4182619">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4182622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182625">if</span>&nbsp;<span class="builtinfunc" id="4182628">len</span><span class="op" id="4182631">(</span><span class="ident" id="4182632">p</span><span class="op" id="4182633">)</span>&nbsp;<span class="op" id="4182635">&gt;=</span>&nbsp;<span class="ident" id="4182638">chunk</span>&nbsp;<span class="op" id="4182644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182648">n</span>&nbsp;<span class="op" id="4182650">:=</span>&nbsp;<span class="builtinfunc" id="4182653">len</span><span class="op" id="4182656">(</span><span class="ident" id="4182657">p</span><span class="op" id="4182658">)</span>&nbsp;<span class="op" id="4182660">&amp;^</span>&nbsp;<span class="op" id="4182663">(</span><span class="ident" id="4182664">chunk</span>&nbsp;<span class="op" id="4182670">-</span>&nbsp;<span class="num" id="4182672">1</span><span class="op" id="4182673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182677">block</span><span class="op" id="4182682">(</span><span class="ident" id="4182683">d</span><span class="op" id="4182684">,</span>&nbsp;<span class="ident" id="4182686">p</span><span class="op" id="4182687">[</span><span class="op" id="4182688">:</span><span class="ident" id="4182689">n</span><span class="op" id="4182690">]</span><span class="op" id="4182691">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182695">p</span>&nbsp;<span class="op" id="4182697">=</span>&nbsp;<span class="ident" id="4182699">p</span><span class="op" id="4182700">[</span><span class="ident" id="4182701">n</span><span class="op" id="4182702">:</span><span class="op" id="4182703">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4182706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182709">if</span>&nbsp;<span class="builtinfunc" id="4182712">len</span><span class="op" id="4182715">(</span><span class="ident" id="4182716">p</span><span class="op" id="4182717">)</span>&nbsp;<span class="op" id="4182719">&gt;</span>&nbsp;<span class="num" id="4182721">0</span>&nbsp;<span class="op" id="4182723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182727">d</span><span class="op" id="4182728">.</span><span class="ident" id="4182729">nx</span>&nbsp;<span class="op" id="4182732">=</span>&nbsp;<span class="builtinfunc" id="4182734">copy</span><span class="op" id="4182738">(</span><span class="ident" id="4182739">d</span><span class="op" id="4182740">.</span><span class="ident" id="4182741">x</span><span class="op" id="4182742">[</span><span class="op" id="4182743">:</span><span class="op" id="4182744">]</span><span class="op" id="4182745">,</span>&nbsp;<span class="ident" id="4182747">p</span><span class="op" id="4182748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4182751">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182754">return</span><br>
<span class="lineno"></span><span class="op" id="4182761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4182764">func</span>&nbsp;<span class="op" id="4182769">(</span><span class="ident" id="4182770">d0</span>&nbsp;<span class="op" id="4182773">*</span><span class="ident" id="4182774">digest</span><span class="op" id="4182780">)</span>&nbsp;<span class="ident" id="4182782">Sum</span><span class="op" id="4182785">(</span><span class="ident" id="4182786">in</span>&nbsp;<span class="op" id="4182789">[</span><span class="op" id="4182790">]</span><span class="builtintype" id="4182791">byte</span><span class="op" id="4182795">)</span>&nbsp;<span class="op" id="4182797">[</span><span class="op" id="4182798">]</span><span class="builtintype" id="4182799">byte</span>&nbsp;<span class="op" id="4182804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4182807">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182874">d</span>&nbsp;<span class="op" id="4182876">:=</span>&nbsp;<span class="op" id="4182879">*</span><span class="ident" id="4182880">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4182884">hash</span>&nbsp;<span class="op" id="4182889">:=</span>&nbsp;<span class="ident" id="4182892">d</span><span class="op" id="4182893">.</span><span class="ident" id="4182894">checkSum</span><span class="op" id="4182902">(</span><span class="op" id="4182903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182906">if</span>&nbsp;<span class="ident" id="4182909">d</span><span class="op" id="4182910">.</span><span class="ident" id="4182911">is224</span>&nbsp;<span class="op" id="4182917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182921">return</span>&nbsp;<span class="builtinfunc" id="4182928">append</span><span class="op" id="4182934">(</span><span class="ident" id="4182935">in</span><span class="op" id="4182937">,</span>&nbsp;<span class="ident" id="4182939">hash</span><span class="op" id="4182943">[</span><span class="op" id="4182944">:</span><span class="ident" id="4182945">Size224</span><span class="op" id="4182952">]</span><span class="op" id="4182953">...</span><span class="op" id="4182956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4182959">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4182962">return</span>&nbsp;<span class="builtinfunc" id="4182969">append</span><span class="op" id="4182975">(</span><span class="ident" id="4182976">in</span><span class="op" id="4182978">,</span>&nbsp;<span class="ident" id="4182980">hash</span><span class="op" id="4182984">[</span><span class="op" id="4182985">:</span><span class="op" id="4182986">]</span><span class="op" id="4182987">...</span><span class="op" id="4182990">)</span><br>
<span class="lineno"></span><span class="op" id="4182992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4182995">func</span>&nbsp;<span class="op" id="4183000">(</span><span class="ident" id="4183001">d</span>&nbsp;<span class="op" id="4183003">*</span><span class="ident" id="4183004">digest</span><span class="op" id="4183010">)</span>&nbsp;<span class="ident" id="4183012">checkSum</span><span class="op" id="4183020">(</span><span class="op" id="4183021">)</span>&nbsp;<span class="op" id="4183023">[</span><span class="ident" id="4183024">Size</span><span class="op" id="4183028">]</span><span class="builtintype" id="4183029">byte</span>&nbsp;<span class="op" id="4183034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4183037">len</span>&nbsp;<span class="op" id="4183041">:=</span>&nbsp;<span class="ident" id="4183044">d</span><span class="op" id="4183045">.</span><span class="builtinfunc" id="4183046">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4183051">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4183111">var</span>&nbsp;<span class="ident" id="4183115">tmp</span>&nbsp;<span class="op" id="4183119">[</span><span class="num" id="4183120">64</span><span class="op" id="4183122">]</span><span class="builtintype" id="4183123">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183129">tmp</span><span class="op" id="4183132">[</span><span class="num" id="4183133">0</span><span class="op" id="4183134">]</span>&nbsp;<span class="op" id="4183136">=</span>&nbsp;<span class="num" id="4183138">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4183144">if</span>&nbsp;<span class="builtinfunc" id="4183147">len</span><span class="op" id="4183150">%</span><span class="num" id="4183151">64</span>&nbsp;<span class="op" id="4183154">&lt;</span>&nbsp;<span class="num" id="4183156">56</span>&nbsp;<span class="op" id="4183159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183163">d</span><span class="op" id="4183164">.</span><span class="ident" id="4183165">Write</span><span class="op" id="4183170">(</span><span class="ident" id="4183171">tmp</span><span class="op" id="4183174">[</span><span class="num" id="4183175">0</span>&nbsp;<span class="op" id="4183177">:</span>&nbsp;<span class="num" id="4183179">56</span><span class="op" id="4183181">-</span><span class="builtinfunc" id="4183182">len</span><span class="op" id="4183185">%</span><span class="num" id="4183186">64</span><span class="op" id="4183188">]</span><span class="op" id="4183189">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4183192">}</span>&nbsp;<span class="keyword" id="4183194">else</span>&nbsp;<span class="op" id="4183199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183203">d</span><span class="op" id="4183204">.</span><span class="ident" id="4183205">Write</span><span class="op" id="4183210">(</span><span class="ident" id="4183211">tmp</span><span class="op" id="4183214">[</span><span class="num" id="4183215">0</span>&nbsp;<span class="op" id="4183217">:</span>&nbsp;<span class="num" id="4183219">64</span><span class="op" id="4183221">+</span><span class="num" id="4183222">56</span><span class="op" id="4183224">-</span><span class="builtinfunc" id="4183225">len</span><span class="op" id="4183228">%</span><span class="num" id="4183229">64</span><span class="op" id="4183231">]</span><span class="op" id="4183232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4183235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4183239">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4183259">len</span>&nbsp;<span class="op" id="4183263">&lt;&lt;=</span>&nbsp;<span class="num" id="4183267">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4183270">for</span>&nbsp;<span class="ident" id="4183274">i</span>&nbsp;<span class="op" id="4183276">:=</span>&nbsp;<span class="builtintype" id="4183279">uint</span><span class="op" id="4183283">(</span><span class="num" id="4183284">0</span><span class="op" id="4183285">)</span><span class="op" id="4183286">;</span>&nbsp;<span class="ident" id="4183288">i</span>&nbsp;<span class="op" id="4183290">&lt;</span>&nbsp;<span class="num" id="4183292">8</span><span class="op" id="4183293">;</span>&nbsp;<span class="ident" id="4183295">i</span><span class="op" id="4183296">++</span>&nbsp;<span class="op" id="4183299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183303">tmp</span><span class="op" id="4183306">[</span><span class="ident" id="4183307">i</span><span class="op" id="4183308">]</span>&nbsp;<span class="op" id="4183310">=</span>&nbsp;<span class="builtintype" id="4183312">byte</span><span class="op" id="4183316">(</span><span class="builtinfunc" id="4183317">len</span>&nbsp;<span class="op" id="4183321">&gt;&gt;</span>&nbsp;<span class="op" id="4183324">(</span><span class="num" id="4183325">56</span>&nbsp;<span class="op" id="4183328">-</span>&nbsp;<span class="num" id="4183330">8</span><span class="op" id="4183331">*</span><span class="ident" id="4183332">i</span><span class="op" id="4183333">)</span><span class="op" id="4183334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4183337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183340">d</span><span class="op" id="4183341">.</span><span class="ident" id="4183342">Write</span><span class="op" id="4183347">(</span><span class="ident" id="4183348">tmp</span><span class="op" id="4183351">[</span><span class="num" id="4183352">0</span><span class="op" id="4183353">:</span><span class="num" id="4183354">8</span><span class="op" id="4183355">]</span><span class="op" id="4183356">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4183360">if</span>&nbsp;<span class="ident" id="4183363">d</span><span class="op" id="4183364">.</span><span class="ident" id="4183365">nx</span>&nbsp;<span class="op" id="4183368">!=</span>&nbsp;<span class="num" id="4183371">0</span>&nbsp;<span class="op" id="4183373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4183377">panic</span><span class="op" id="4183382">(</span><span class="string" id="4183383">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4183394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4183397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183401">h</span>&nbsp;<span class="op" id="4183403">:=</span>&nbsp;<span class="ident" id="4183406">d</span><span class="op" id="4183407">.</span><span class="ident" id="4183408">h</span><span class="op" id="4183409">[</span><span class="op" id="4183410">:</span><span class="op" id="4183411">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4183414">if</span>&nbsp;<span class="ident" id="4183417">d</span><span class="op" id="4183418">.</span><span class="ident" id="4183419">is224</span>&nbsp;<span class="op" id="4183425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183429">h</span>&nbsp;<span class="op" id="4183431">=</span>&nbsp;<span class="ident" id="4183433">d</span><span class="op" id="4183434">.</span><span class="ident" id="4183435">h</span><span class="op" id="4183436">[</span><span class="op" id="4183437">:</span><span class="num" id="4183438">7</span><span class="op" id="4183439">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4183442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4183446">var</span>&nbsp;<span class="ident" id="4183450">digest</span>&nbsp;<span class="op" id="4183457">[</span><span class="ident" id="4183458">Size</span><span class="op" id="4183462">]</span><span class="builtintype" id="4183463">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4183469">for</span>&nbsp;<span class="ident" id="4183473">i</span><span class="op" id="4183474">,</span>&nbsp;<span class="ident" id="4183476">s</span>&nbsp;<span class="op" id="4183478">:=</span>&nbsp;<span class="keyword" id="4183481">range</span>&nbsp;<span class="ident" id="4183487">h</span>&nbsp;<span class="op" id="4183489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183493">digest</span><span class="op" id="4183499">[</span><span class="ident" id="4183500">i</span><span class="op" id="4183501">*</span><span class="num" id="4183502">4</span><span class="op" id="4183503">]</span>&nbsp;<span class="op" id="4183505">=</span>&nbsp;<span class="builtintype" id="4183507">byte</span><span class="op" id="4183511">(</span><span class="ident" id="4183512">s</span>&nbsp;<span class="op" id="4183514">&gt;&gt;</span>&nbsp;<span class="num" id="4183517">24</span><span class="op" id="4183519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183523">digest</span><span class="op" id="4183529">[</span><span class="ident" id="4183530">i</span><span class="op" id="4183531">*</span><span class="num" id="4183532">4</span><span class="op" id="4183533">+</span><span class="num" id="4183534">1</span><span class="op" id="4183535">]</span>&nbsp;<span class="op" id="4183537">=</span>&nbsp;<span class="builtintype" id="4183539">byte</span><span class="op" id="4183543">(</span><span class="ident" id="4183544">s</span>&nbsp;<span class="op" id="4183546">&gt;&gt;</span>&nbsp;<span class="num" id="4183549">16</span><span class="op" id="4183551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183555">digest</span><span class="op" id="4183561">[</span><span class="ident" id="4183562">i</span><span class="op" id="4183563">*</span><span class="num" id="4183564">4</span><span class="op" id="4183565">+</span><span class="num" id="4183566">2</span><span class="op" id="4183567">]</span>&nbsp;<span class="op" id="4183569">=</span>&nbsp;<span class="builtintype" id="4183571">byte</span><span class="op" id="4183575">(</span><span class="ident" id="4183576">s</span>&nbsp;<span class="op" id="4183578">&gt;&gt;</span>&nbsp;<span class="num" id="4183581">8</span><span class="op" id="4183582">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183586">digest</span><span class="op" id="4183592">[</span><span class="ident" id="4183593">i</span><span class="op" id="4183594">*</span><span class="num" id="4183595">4</span><span class="op" id="4183596">+</span><span class="num" id="4183597">3</span><span class="op" id="4183598">]</span>&nbsp;<span class="op" id="4183600">=</span>&nbsp;<span class="builtintype" id="4183602">byte</span><span class="op" id="4183606">(</span><span class="ident" id="4183607">s</span><span class="op" id="4183608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4183611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4183615">return</span>&nbsp;<span class="ident" id="4183622">digest</span><br>
<span class="lineno"></span><span class="op" id="4183629">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4183632">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4183683">func</span>&nbsp;<span class="ident" id="4183688">Sum256</span><span class="op" id="4183694">(</span><span class="ident" id="4183695">data</span>&nbsp;<span class="op" id="4183700">[</span><span class="op" id="4183701">]</span><span class="builtintype" id="4183702">byte</span><span class="op" id="4183706">)</span>&nbsp;<span class="op" id="4183708">[</span><span class="ident" id="4183709">Size</span><span class="op" id="4183713">]</span><span class="builtintype" id="4183714">byte</span>&nbsp;<span class="op" id="4183719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4183722">var</span>&nbsp;<span class="ident" id="4183726">d</span>&nbsp;<span class="ident" id="4183728">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183736">d</span><span class="op" id="4183737">.</span><span class="ident" id="4183738">Reset</span><span class="op" id="4183743">(</span><span class="op" id="4183744">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183747">d</span><span class="op" id="4183748">.</span><span class="ident" id="4183749">Write</span><span class="op" id="4183754">(</span><span class="ident" id="4183755">data</span><span class="op" id="4183759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4183762">return</span>&nbsp;<span class="ident" id="4183769">d</span><span class="op" id="4183770">.</span><span class="ident" id="4183771">checkSum</span><span class="op" id="4183779">(</span><span class="op" id="4183780">)</span><br>
<span class="lineno"></span><span class="op" id="4183782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4183785">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="4183836">func</span>&nbsp;<span class="ident" id="4183841">Sum224</span><span class="op" id="4183847">(</span><span class="ident" id="4183848">data</span>&nbsp;<span class="op" id="4183853">[</span><span class="op" id="4183854">]</span><span class="builtintype" id="4183855">byte</span><span class="op" id="4183859">)</span>&nbsp;<span class="op" id="4183861">(</span><span class="ident" id="4183862">sum224</span>&nbsp;<span class="op" id="4183869">[</span><span class="ident" id="4183870">Size224</span><span class="op" id="4183877">]</span><span class="builtintype" id="4183878">byte</span><span class="op" id="4183882">)</span>&nbsp;<span class="op" id="4183884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4183887">var</span>&nbsp;<span class="ident" id="4183891">d</span>&nbsp;<span class="ident" id="4183893">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183901">d</span><span class="op" id="4183902">.</span><span class="ident" id="4183903">is224</span>&nbsp;<span class="op" id="4183909">=</span>&nbsp;<span class="builtintype" id="4183911">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183917">d</span><span class="op" id="4183918">.</span><span class="ident" id="4183919">Reset</span><span class="op" id="4183924">(</span><span class="op" id="4183925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183928">d</span><span class="op" id="4183929">.</span><span class="ident" id="4183930">Write</span><span class="op" id="4183935">(</span><span class="ident" id="4183936">data</span><span class="op" id="4183940">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4183943">sum</span>&nbsp;<span class="op" id="4183947">:=</span>&nbsp;<span class="ident" id="4183950">d</span><span class="op" id="4183951">.</span><span class="ident" id="4183952">checkSum</span><span class="op" id="4183960">(</span><span class="op" id="4183961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4183964">copy</span><span class="op" id="4183968">(</span><span class="ident" id="4183969">sum224</span><span class="op" id="4183975">[</span><span class="op" id="4183976">:</span><span class="op" id="4183977">]</span><span class="op" id="4183978">,</span>&nbsp;<span class="ident" id="4183980">sum</span><span class="op" id="4183983">[</span><span class="op" id="4183984">:</span><span class="ident" id="4183985">Size224</span><span class="op" id="4183992">]</span><span class="op" id="4183993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4183996">return</span><br>
<span class="lineno"></span><span class="op" id="4184003">}</span>
</div>
</body>
</html>
