<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/plan9obj</h2>
<ul>
<li><a href="/gostd/debug/plan9obj/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/plan9obj/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/plan9obj/plan9obj.go.html">plan9obj.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6476939">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6476995">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6477049">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6477100">//&nbsp;Package&nbsp;plan9obj&nbsp;implements&nbsp;access&nbsp;to&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6477168">package</span>&nbsp;<span class="ident" id="6477176">plan9obj</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6477186">import</span>&nbsp;<span class="op" id="6477193">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6477196">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6477215">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6477225">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6477232">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6477238">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6477243">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6477246">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6477301">type</span>&nbsp;<span class="ident" id="6477306">FileHeader</span>&nbsp;<span class="keyword" id="6477317">struct</span>&nbsp;<span class="op" id="6477324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477327">Magic</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6477339">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477347">Bss</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6477359">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477367">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6477379">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477387">PtrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6477399">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477404">LoadAddress</span>&nbsp;<span class="ident" id="6477416">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477424">HdrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6477436">uint64</span><br>
<span class="lineno"></span><span class="op" id="6477443">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="6477446">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6477494">type</span>&nbsp;<span class="ident" id="6477499">File</span>&nbsp;<span class="keyword" id="6477504">struct</span>&nbsp;<span class="op" id="6477511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477514">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477526">Sections</span>&nbsp;<span class="op" id="6477535">[</span><span class="op" id="6477536">]</span><span class="op" id="6477537">*</span><span class="ident" id="6477538">Section</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477547">closer</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6477556">io</span><span class="op" id="6477558">.</span><span class="ident" id="6477559">Closer</span><br>
<span class="lineno"></span><span class="op" id="6477566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6477569">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="comment" id="6477637">//&nbsp;This&nbsp;structure&nbsp;doesn&#39;t&nbsp;exist&nbsp;on-disk,&nbsp;but&nbsp;eases&nbsp;navigation</span><br>
<span class="lineno">35</span><span class="comment" id="6477699">//&nbsp;through&nbsp;the&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6477727">type</span>&nbsp;<span class="ident" id="6477732">SectionHeader</span>&nbsp;<span class="keyword" id="6477746">struct</span>&nbsp;<span class="op" id="6477753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477756">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6477763">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477771">Size</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6477778">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477786">Offset</span>&nbsp;<span class="builtintype" id="6477793">uint32</span><br>
<span class="lineno">40</span><span class="op" id="6477800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6477803">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6477868">type</span>&nbsp;<span class="ident" id="6477873">Section</span>&nbsp;<span class="keyword" id="6477881">struct</span>&nbsp;<span class="op" id="6477888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6477891">SectionHeader</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6477907">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6477945">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6477985">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6478020">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6478068">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6478118">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478142">io</span><span class="op" id="6478144">.</span><span class="ident" id="6478145">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478155">sr</span>&nbsp;<span class="op" id="6478158">*</span><span class="ident" id="6478159">io</span><span class="op" id="6478161">.</span><span class="ident" id="6478162">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6478176">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="6478179">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6478247">func</span>&nbsp;<span class="op" id="6478252">(</span><span class="ident" id="6478253">s</span>&nbsp;<span class="op" id="6478255">*</span><span class="ident" id="6478256">Section</span><span class="op" id="6478263">)</span>&nbsp;<span class="ident" id="6478265">Data</span><span class="op" id="6478269">(</span><span class="op" id="6478270">)</span>&nbsp;<span class="op" id="6478272">(</span><span class="op" id="6478273">[</span><span class="op" id="6478274">]</span><span class="builtintype" id="6478275">byte</span><span class="op" id="6478279">,</span>&nbsp;<span class="builtintype" id="6478281">error</span><span class="op" id="6478286">)</span>&nbsp;<span class="op" id="6478288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478291">dat</span>&nbsp;<span class="op" id="6478295">:=</span>&nbsp;<span class="builtinfunc" id="6478298">make</span><span class="op" id="6478302">(</span><span class="op" id="6478303">[</span><span class="op" id="6478304">]</span><span class="builtintype" id="6478305">byte</span><span class="op" id="6478309">,</span>&nbsp;<span class="ident" id="6478311">s</span><span class="op" id="6478312">.</span><span class="ident" id="6478313">sr</span><span class="op" id="6478315">.</span><span class="ident" id="6478316">Size</span><span class="op" id="6478320">(</span><span class="op" id="6478321">)</span><span class="op" id="6478322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478325">n</span><span class="op" id="6478326">,</span>&nbsp;<span class="ident" id="6478328">err</span>&nbsp;<span class="op" id="6478332">:=</span>&nbsp;<span class="ident" id="6478335">s</span><span class="op" id="6478336">.</span><span class="ident" id="6478337">sr</span><span class="op" id="6478339">.</span><span class="ident" id="6478340">ReadAt</span><span class="op" id="6478346">(</span><span class="ident" id="6478347">dat</span><span class="op" id="6478350">,</span>&nbsp;<span class="num" id="6478352">0</span><span class="op" id="6478353">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6478356">if</span>&nbsp;<span class="ident" id="6478359">n</span>&nbsp;<span class="op" id="6478361">==</span>&nbsp;<span class="builtinfunc" id="6478364">len</span><span class="op" id="6478367">(</span><span class="ident" id="6478368">dat</span><span class="op" id="6478371">)</span>&nbsp;<span class="op" id="6478373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478377">err</span>&nbsp;<span class="op" id="6478381">=</span>&nbsp;<span class="ident" id="6478383">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6478388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6478391">return</span>&nbsp;<span class="ident" id="6478398">dat</span><span class="op" id="6478401">[</span><span class="num" id="6478402">0</span><span class="op" id="6478403">:</span><span class="ident" id="6478404">n</span><span class="op" id="6478405">]</span><span class="op" id="6478406">,</span>&nbsp;<span class="ident" id="6478408">err</span><br>
<span class="lineno"></span><span class="op" id="6478412">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="6478415">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6478482">func</span>&nbsp;<span class="op" id="6478487">(</span><span class="ident" id="6478488">s</span>&nbsp;<span class="op" id="6478490">*</span><span class="ident" id="6478491">Section</span><span class="op" id="6478498">)</span>&nbsp;<span class="ident" id="6478500">Open</span><span class="op" id="6478504">(</span><span class="op" id="6478505">)</span>&nbsp;<span class="ident" id="6478507">io</span><span class="op" id="6478509">.</span><span class="ident" id="6478510">ReadSeeker</span>&nbsp;<span class="op" id="6478521">{</span>&nbsp;<span class="keyword" id="6478523">return</span>&nbsp;<span class="ident" id="6478530">io</span><span class="op" id="6478532">.</span><span class="ident" id="6478533">NewSectionReader</span><span class="op" id="6478549">(</span><span class="ident" id="6478550">s</span><span class="op" id="6478551">.</span><span class="ident" id="6478552">sr</span><span class="op" id="6478554">,</span>&nbsp;<span class="num" id="6478556">0</span><span class="op" id="6478557">,</span>&nbsp;<span class="num" id="6478559">1</span><span class="op" id="6478560">&lt;&lt;</span><span class="num" id="6478562">63</span><span class="op" id="6478564">-</span><span class="num" id="6478565">1</span><span class="op" id="6478566">)</span>&nbsp;<span class="op" id="6478568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6478571">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno">70</span><span class="keyword" id="6478643">type</span>&nbsp;<span class="ident" id="6478648">Sym</span>&nbsp;<span class="keyword" id="6478652">struct</span>&nbsp;<span class="op" id="6478659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478662">Value</span>&nbsp;<span class="ident" id="6478668">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478676">Type</span>&nbsp;&nbsp;<span class="builtintype" id="6478682">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478688">Name</span>&nbsp;&nbsp;<span class="builtintype" id="6478694">string</span><br>
<span class="lineno"></span><span class="op" id="6478701">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="6478704">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="6478735">//&nbsp;formatError&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;operations&nbsp;if&nbsp;the&nbsp;data&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="6478798">//&nbsp;not&nbsp;have&nbsp;the&nbsp;correct&nbsp;format&nbsp;for&nbsp;an&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6478849">type</span>&nbsp;<span class="ident" id="6478854">formatError</span>&nbsp;<span class="keyword" id="6478866">struct</span>&nbsp;<span class="op" id="6478873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478876">off</span>&nbsp;<span class="builtintype" id="6478880">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478885">msg</span>&nbsp;<span class="builtintype" id="6478889">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478897">val</span>&nbsp;<span class="keyword" id="6478901">interface</span><span class="op" id="6478910">{</span><span class="op" id="6478911">}</span><br>
<span class="lineno"></span><span class="op" id="6478913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6478916">func</span>&nbsp;<span class="op" id="6478921">(</span><span class="ident" id="6478922">e</span>&nbsp;<span class="op" id="6478924">*</span><span class="ident" id="6478925">formatError</span><span class="op" id="6478936">)</span>&nbsp;<span class="ident" id="6478938">Error</span><span class="op" id="6478943">(</span><span class="op" id="6478944">)</span>&nbsp;<span class="builtintype" id="6478946">string</span>&nbsp;<span class="op" id="6478953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478956">msg</span>&nbsp;<span class="op" id="6478960">:=</span>&nbsp;<span class="ident" id="6478963">e</span><span class="op" id="6478964">.</span><span class="ident" id="6478965">msg</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6478970">if</span>&nbsp;<span class="ident" id="6478973">e</span><span class="op" id="6478974">.</span><span class="ident" id="6478975">val</span>&nbsp;<span class="op" id="6478979">!=</span>&nbsp;<span class="ident" id="6478982">nil</span>&nbsp;<span class="op" id="6478986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6478990">msg</span>&nbsp;<span class="op" id="6478994">+=</span>&nbsp;<span class="ident" id="6478997">fmt</span><span class="op" id="6479000">.</span><span class="ident" id="6479001">Sprintf</span><span class="op" id="6479008">(</span><span class="string" id="6479009">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="6479016">,</span>&nbsp;<span class="ident" id="6479018">e</span><span class="op" id="6479019">.</span><span class="ident" id="6479020">val</span><span class="op" id="6479023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6479026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6479029">msg</span>&nbsp;<span class="op" id="6479033">+=</span>&nbsp;<span class="ident" id="6479036">fmt</span><span class="op" id="6479039">.</span><span class="ident" id="6479040">Sprintf</span><span class="op" id="6479047">(</span><span class="string" id="6479048">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6479072">,</span>&nbsp;<span class="ident" id="6479074">e</span><span class="op" id="6479075">.</span><span class="ident" id="6479076">off</span><span class="op" id="6479079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479082">return</span>&nbsp;<span class="ident" id="6479089">msg</span><br>
<span class="lineno">95</span><span class="op" id="6479093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6479096">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6479189">func</span>&nbsp;<span class="ident" id="6479194">Open</span><span class="op" id="6479198">(</span><span class="ident" id="6479199">name</span>&nbsp;<span class="builtintype" id="6479204">string</span><span class="op" id="6479210">)</span>&nbsp;<span class="op" id="6479212">(</span><span class="op" id="6479213">*</span><span class="ident" id="6479214">File</span><span class="op" id="6479218">,</span>&nbsp;<span class="builtintype" id="6479220">error</span><span class="op" id="6479225">)</span>&nbsp;<span class="op" id="6479227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6479230">f</span><span class="op" id="6479231">,</span>&nbsp;<span class="ident" id="6479233">err</span>&nbsp;<span class="op" id="6479237">:=</span>&nbsp;<span class="ident" id="6479240">os</span><span class="op" id="6479242">.</span><span class="ident" id="6479243">Open</span><span class="op" id="6479247">(</span><span class="ident" id="6479248">name</span><span class="op" id="6479252">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479255">if</span>&nbsp;<span class="ident" id="6479258">err</span>&nbsp;<span class="op" id="6479262">!=</span>&nbsp;<span class="ident" id="6479265">nil</span>&nbsp;<span class="op" id="6479269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479273">return</span>&nbsp;<span class="ident" id="6479280">nil</span><span class="op" id="6479283">,</span>&nbsp;<span class="ident" id="6479285">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6479290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6479293">ff</span><span class="op" id="6479295">,</span>&nbsp;<span class="ident" id="6479297">err</span>&nbsp;<span class="op" id="6479301">:=</span>&nbsp;<span class="ident" id="6479304">NewFile</span><span class="op" id="6479311">(</span><span class="ident" id="6479312">f</span><span class="op" id="6479313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479316">if</span>&nbsp;<span class="ident" id="6479319">err</span>&nbsp;<span class="op" id="6479323">!=</span>&nbsp;<span class="ident" id="6479326">nil</span>&nbsp;<span class="op" id="6479330">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6479334">f</span><span class="op" id="6479335">.</span><span class="ident" id="6479336">Close</span><span class="op" id="6479341">(</span><span class="op" id="6479342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479346">return</span>&nbsp;<span class="ident" id="6479353">nil</span><span class="op" id="6479356">,</span>&nbsp;<span class="ident" id="6479358">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6479363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6479366">ff</span><span class="op" id="6479368">.</span><span class="ident" id="6479369">closer</span>&nbsp;<span class="op" id="6479376">=</span>&nbsp;<span class="ident" id="6479378">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479381">return</span>&nbsp;<span class="ident" id="6479388">ff</span><span class="op" id="6479390">,</span>&nbsp;<span class="ident" id="6479392">nil</span><br>
<span class="lineno">110</span><span class="op" id="6479396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6479399">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6479425">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="6479492">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno">115</span><span class="keyword" id="6479516">func</span>&nbsp;<span class="op" id="6479521">(</span><span class="ident" id="6479522">f</span>&nbsp;<span class="op" id="6479524">*</span><span class="ident" id="6479525">File</span><span class="op" id="6479529">)</span>&nbsp;<span class="ident" id="6479531">Close</span><span class="op" id="6479536">(</span><span class="op" id="6479537">)</span>&nbsp;<span class="builtintype" id="6479539">error</span>&nbsp;<span class="op" id="6479545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479548">var</span>&nbsp;<span class="ident" id="6479552">err</span>&nbsp;<span class="builtintype" id="6479556">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479563">if</span>&nbsp;<span class="ident" id="6479566">f</span><span class="op" id="6479567">.</span><span class="ident" id="6479568">closer</span>&nbsp;<span class="op" id="6479575">!=</span>&nbsp;<span class="ident" id="6479578">nil</span>&nbsp;<span class="op" id="6479582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6479586">err</span>&nbsp;<span class="op" id="6479590">=</span>&nbsp;<span class="ident" id="6479592">f</span><span class="op" id="6479593">.</span><span class="ident" id="6479594">closer</span><span class="op" id="6479600">.</span><span class="ident" id="6479601">Close</span><span class="op" id="6479606">(</span><span class="op" id="6479607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6479611">f</span><span class="op" id="6479612">.</span><span class="ident" id="6479613">closer</span>&nbsp;<span class="op" id="6479620">=</span>&nbsp;<span class="ident" id="6479622">nil</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6479627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479630">return</span>&nbsp;<span class="ident" id="6479637">err</span><br>
<span class="lineno"></span><span class="op" id="6479641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6479644">func</span>&nbsp;<span class="ident" id="6479649">parseMagic</span><span class="op" id="6479659">(</span><span class="ident" id="6479660">magic</span>&nbsp;<span class="op" id="6479666">[</span><span class="op" id="6479667">]</span><span class="builtintype" id="6479668">byte</span><span class="op" id="6479672">)</span>&nbsp;<span class="op" id="6479674">(</span><span class="builtintype" id="6479675">uint32</span><span class="op" id="6479681">,</span>&nbsp;<span class="builtintype" id="6479683">error</span><span class="op" id="6479688">)</span>&nbsp;<span class="op" id="6479690">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6479693">m</span>&nbsp;<span class="op" id="6479695">:=</span>&nbsp;<span class="ident" id="6479698">binary</span><span class="op" id="6479704">.</span><span class="ident" id="6479705">BigEndian</span><span class="op" id="6479714">.</span><span class="ident" id="6479715">Uint32</span><span class="op" id="6479721">(</span><span class="ident" id="6479722">magic</span><span class="op" id="6479727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479730">switch</span>&nbsp;<span class="ident" id="6479737">m</span>&nbsp;<span class="op" id="6479739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479742">case</span>&nbsp;<span class="ident" id="6479747">Magic386</span><span class="op" id="6479755">,</span>&nbsp;<span class="ident" id="6479757">MagicAMD64</span><span class="op" id="6479767">,</span>&nbsp;<span class="ident" id="6479769">MagicARM</span><span class="op" id="6479777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479781">return</span>&nbsp;<span class="ident" id="6479788">m</span><span class="op" id="6479789">,</span>&nbsp;<span class="ident" id="6479791">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6479796">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6479799">return</span>&nbsp;<span class="num" id="6479806">0</span><span class="op" id="6479807">,</span>&nbsp;<span class="op" id="6479809">&amp;</span><span class="ident" id="6479810">formatError</span><span class="op" id="6479821">{</span><span class="num" id="6479822">0</span><span class="op" id="6479823">,</span>&nbsp;<span class="string" id="6479825">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6479843">,</span>&nbsp;<span class="ident" id="6479845">magic</span><span class="op" id="6479850">}</span><br>
<span class="lineno"></span><span class="op" id="6479852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6479855">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="6479940">//&nbsp;The&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno">135</span><span class="keyword" id="6480013">func</span>&nbsp;<span class="ident" id="6480018">NewFile</span><span class="op" id="6480025">(</span><span class="ident" id="6480026">r</span>&nbsp;<span class="ident" id="6480028">io</span><span class="op" id="6480030">.</span><span class="ident" id="6480031">ReaderAt</span><span class="op" id="6480039">)</span>&nbsp;<span class="op" id="6480041">(</span><span class="op" id="6480042">*</span><span class="ident" id="6480043">File</span><span class="op" id="6480047">,</span>&nbsp;<span class="builtintype" id="6480049">error</span><span class="op" id="6480054">)</span>&nbsp;<span class="op" id="6480056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480059">sr</span>&nbsp;<span class="op" id="6480062">:=</span>&nbsp;<span class="ident" id="6480065">io</span><span class="op" id="6480067">.</span><span class="ident" id="6480068">NewSectionReader</span><span class="op" id="6480084">(</span><span class="ident" id="6480085">r</span><span class="op" id="6480086">,</span>&nbsp;<span class="num" id="6480088">0</span><span class="op" id="6480089">,</span>&nbsp;<span class="num" id="6480091">1</span><span class="op" id="6480092">&lt;&lt;</span><span class="num" id="6480094">63</span><span class="op" id="6480096">-</span><span class="num" id="6480097">1</span><span class="op" id="6480098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6480101">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;Plan&nbsp;9&nbsp;magic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6480134">var</span>&nbsp;<span class="ident" id="6480138">magic</span>&nbsp;<span class="op" id="6480144">[</span><span class="num" id="6480145">4</span><span class="op" id="6480146">]</span><span class="builtintype" id="6480147">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6480153">if</span>&nbsp;<span class="ident" id="6480156">_</span><span class="op" id="6480157">,</span>&nbsp;<span class="ident" id="6480159">err</span>&nbsp;<span class="op" id="6480163">:=</span>&nbsp;<span class="ident" id="6480166">r</span><span class="op" id="6480167">.</span><span class="ident" id="6480168">ReadAt</span><span class="op" id="6480174">(</span><span class="ident" id="6480175">magic</span><span class="op" id="6480180">[</span><span class="op" id="6480181">:</span><span class="op" id="6480182">]</span><span class="op" id="6480183">,</span>&nbsp;<span class="num" id="6480185">0</span><span class="op" id="6480186">)</span><span class="op" id="6480187">;</span>&nbsp;<span class="ident" id="6480189">err</span>&nbsp;<span class="op" id="6480193">!=</span>&nbsp;<span class="ident" id="6480196">nil</span>&nbsp;<span class="op" id="6480200">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6480204">return</span>&nbsp;<span class="ident" id="6480211">nil</span><span class="op" id="6480214">,</span>&nbsp;<span class="ident" id="6480216">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480224">_</span><span class="op" id="6480225">,</span>&nbsp;<span class="ident" id="6480227">err</span>&nbsp;<span class="op" id="6480231">:=</span>&nbsp;<span class="ident" id="6480234">parseMagic</span><span class="op" id="6480244">(</span><span class="ident" id="6480245">magic</span><span class="op" id="6480250">[</span><span class="op" id="6480251">:</span><span class="op" id="6480252">]</span><span class="op" id="6480253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6480256">if</span>&nbsp;<span class="ident" id="6480259">err</span>&nbsp;<span class="op" id="6480263">!=</span>&nbsp;<span class="ident" id="6480266">nil</span>&nbsp;<span class="op" id="6480270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6480274">return</span>&nbsp;<span class="ident" id="6480281">nil</span><span class="op" id="6480284">,</span>&nbsp;<span class="ident" id="6480286">err</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480295">ph</span>&nbsp;<span class="op" id="6480298">:=</span>&nbsp;<span class="builtinfunc" id="6480301">new</span><span class="op" id="6480304">(</span><span class="ident" id="6480305">prog</span><span class="op" id="6480309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6480312">if</span>&nbsp;<span class="ident" id="6480315">err</span>&nbsp;<span class="op" id="6480319">:=</span>&nbsp;<span class="ident" id="6480322">binary</span><span class="op" id="6480328">.</span><span class="ident" id="6480329">Read</span><span class="op" id="6480333">(</span><span class="ident" id="6480334">sr</span><span class="op" id="6480336">,</span>&nbsp;<span class="ident" id="6480338">binary</span><span class="op" id="6480344">.</span><span class="ident" id="6480345">BigEndian</span><span class="op" id="6480354">,</span>&nbsp;<span class="ident" id="6480356">ph</span><span class="op" id="6480358">)</span><span class="op" id="6480359">;</span>&nbsp;<span class="ident" id="6480361">err</span>&nbsp;<span class="op" id="6480365">!=</span>&nbsp;<span class="ident" id="6480368">nil</span>&nbsp;<span class="op" id="6480372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6480376">return</span>&nbsp;<span class="ident" id="6480383">nil</span><span class="op" id="6480386">,</span>&nbsp;<span class="ident" id="6480388">err</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480397">f</span>&nbsp;<span class="op" id="6480399">:=</span>&nbsp;<span class="op" id="6480402">&amp;</span><span class="ident" id="6480403">File</span><span class="op" id="6480407">{</span><span class="ident" id="6480408">FileHeader</span><span class="op" id="6480418">:</span>&nbsp;<span class="ident" id="6480420">FileHeader</span><span class="op" id="6480430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480434">Magic</span><span class="op" id="6480439">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6480447">ph</span><span class="op" id="6480449">.</span><span class="ident" id="6480450">Magic</span><span class="op" id="6480455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480459">Bss</span><span class="op" id="6480462">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6480472">ph</span><span class="op" id="6480474">.</span><span class="ident" id="6480475">Bss</span><span class="op" id="6480478">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480482">Entry</span><span class="op" id="6480487">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6480495">uint64</span><span class="op" id="6480501">(</span><span class="ident" id="6480502">ph</span><span class="op" id="6480504">.</span><span class="ident" id="6480505">Entry</span><span class="op" id="6480510">)</span><span class="op" id="6480511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480515">PtrSize</span><span class="op" id="6480522">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6480528">4</span><span class="op" id="6480529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480533">LoadAddress</span><span class="op" id="6480544">:</span>&nbsp;<span class="num" id="6480546">0x1000</span><span class="op" id="6480552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480556">HdrSize</span><span class="op" id="6480563">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6480569">4</span>&nbsp;<span class="op" id="6480571">*</span>&nbsp;<span class="num" id="6480573">8</span><span class="op" id="6480574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480577">}</span><span class="op" id="6480578">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6480582">if</span>&nbsp;<span class="ident" id="6480585">ph</span><span class="op" id="6480587">.</span><span class="ident" id="6480588">Magic</span><span class="op" id="6480593">&amp;</span><span class="ident" id="6480594">Magic64</span>&nbsp;<span class="op" id="6480602">!=</span>&nbsp;<span class="num" id="6480605">0</span>&nbsp;<span class="op" id="6480607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6480611">if</span>&nbsp;<span class="ident" id="6480614">err</span>&nbsp;<span class="op" id="6480618">:=</span>&nbsp;<span class="ident" id="6480621">binary</span><span class="op" id="6480627">.</span><span class="ident" id="6480628">Read</span><span class="op" id="6480632">(</span><span class="ident" id="6480633">sr</span><span class="op" id="6480635">,</span>&nbsp;<span class="ident" id="6480637">binary</span><span class="op" id="6480643">.</span><span class="ident" id="6480644">BigEndian</span><span class="op" id="6480653">,</span>&nbsp;<span class="op" id="6480655">&amp;</span><span class="ident" id="6480656">f</span><span class="op" id="6480657">.</span><span class="ident" id="6480658">Entry</span><span class="op" id="6480663">)</span><span class="op" id="6480664">;</span>&nbsp;<span class="ident" id="6480666">err</span>&nbsp;<span class="op" id="6480670">!=</span>&nbsp;<span class="ident" id="6480673">nil</span>&nbsp;<span class="op" id="6480677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6480682">return</span>&nbsp;<span class="ident" id="6480689">nil</span><span class="op" id="6480692">,</span>&nbsp;<span class="ident" id="6480694">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480700">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480704">f</span><span class="op" id="6480705">.</span><span class="ident" id="6480706">PtrSize</span>&nbsp;<span class="op" id="6480714">=</span>&nbsp;<span class="num" id="6480716">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480720">f</span><span class="op" id="6480721">.</span><span class="ident" id="6480722">LoadAddress</span>&nbsp;<span class="op" id="6480734">=</span>&nbsp;<span class="num" id="6480736">0x200000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480747">f</span><span class="op" id="6480748">.</span><span class="ident" id="6480749">HdrSize</span>&nbsp;<span class="op" id="6480757">+=</span>&nbsp;<span class="num" id="6480760">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6480767">var</span>&nbsp;<span class="ident" id="6480771">sects</span>&nbsp;<span class="op" id="6480777">=</span>&nbsp;<span class="op" id="6480779">[</span><span class="op" id="6480780">]</span><span class="keyword" id="6480781">struct</span>&nbsp;<span class="op" id="6480788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480792">name</span>&nbsp;<span class="builtintype" id="6480797">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480806">size</span>&nbsp;<span class="builtintype" id="6480811">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480819">}</span><span class="op" id="6480820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480824">{</span><span class="string" id="6480825">&#34;text&#34;</span><span class="op" id="6480831">,</span>&nbsp;<span class="ident" id="6480833">ph</span><span class="op" id="6480835">.</span><span class="ident" id="6480836">Text</span><span class="op" id="6480840">}</span><span class="op" id="6480841">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480845">{</span><span class="string" id="6480846">&#34;data&#34;</span><span class="op" id="6480852">,</span>&nbsp;<span class="ident" id="6480854">ph</span><span class="op" id="6480856">.</span><span class="ident" id="6480857">Data</span><span class="op" id="6480861">}</span><span class="op" id="6480862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480866">{</span><span class="string" id="6480867">&#34;syms&#34;</span><span class="op" id="6480873">,</span>&nbsp;<span class="ident" id="6480875">ph</span><span class="op" id="6480877">.</span><span class="ident" id="6480878">Syms</span><span class="op" id="6480882">}</span><span class="op" id="6480883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480887">{</span><span class="string" id="6480888">&#34;spsz&#34;</span><span class="op" id="6480894">,</span>&nbsp;<span class="ident" id="6480896">ph</span><span class="op" id="6480898">.</span><span class="ident" id="6480899">Spsz</span><span class="op" id="6480903">}</span><span class="op" id="6480904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480908">{</span><span class="string" id="6480909">&#34;pcsz&#34;</span><span class="op" id="6480915">,</span>&nbsp;<span class="ident" id="6480917">ph</span><span class="op" id="6480919">.</span><span class="ident" id="6480920">Pcsz</span><span class="op" id="6480924">}</span><span class="op" id="6480925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6480928">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480932">f</span><span class="op" id="6480933">.</span><span class="ident" id="6480934">Sections</span>&nbsp;<span class="op" id="6480943">=</span>&nbsp;<span class="builtinfunc" id="6480945">make</span><span class="op" id="6480949">(</span><span class="op" id="6480950">[</span><span class="op" id="6480951">]</span><span class="op" id="6480952">*</span><span class="ident" id="6480953">Section</span><span class="op" id="6480960">,</span>&nbsp;<span class="num" id="6480962">5</span><span class="op" id="6480963">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6480967">off</span>&nbsp;<span class="op" id="6480971">:=</span>&nbsp;<span class="builtintype" id="6480974">uint32</span><span class="op" id="6480980">(</span><span class="ident" id="6480981">f</span><span class="op" id="6480982">.</span><span class="ident" id="6480983">HdrSize</span><span class="op" id="6480990">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6480994">for</span>&nbsp;<span class="ident" id="6480998">i</span><span class="op" id="6480999">,</span>&nbsp;<span class="ident" id="6481001">sect</span>&nbsp;<span class="op" id="6481006">:=</span>&nbsp;<span class="keyword" id="6481009">range</span>&nbsp;<span class="ident" id="6481015">sects</span>&nbsp;<span class="op" id="6481021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481025">s</span>&nbsp;<span class="op" id="6481027">:=</span>&nbsp;<span class="builtinfunc" id="6481030">new</span><span class="op" id="6481033">(</span><span class="ident" id="6481034">Section</span><span class="op" id="6481041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481045">s</span><span class="op" id="6481046">.</span><span class="ident" id="6481047">SectionHeader</span>&nbsp;<span class="op" id="6481061">=</span>&nbsp;<span class="ident" id="6481063">SectionHeader</span><span class="op" id="6481076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481081">Name</span><span class="op" id="6481085">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6481089">sect</span><span class="op" id="6481093">.</span><span class="ident" id="6481094">name</span><span class="op" id="6481098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481103">Size</span><span class="op" id="6481107">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6481111">sect</span><span class="op" id="6481115">.</span><span class="ident" id="6481116">size</span><span class="op" id="6481120">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481125">Offset</span><span class="op" id="6481131">:</span>&nbsp;<span class="ident" id="6481133">off</span><span class="op" id="6481136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6481140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481144">off</span>&nbsp;<span class="op" id="6481148">+=</span>&nbsp;<span class="ident" id="6481151">sect</span><span class="op" id="6481155">.</span><span class="ident" id="6481156">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481163">s</span><span class="op" id="6481164">.</span><span class="ident" id="6481165">sr</span>&nbsp;<span class="op" id="6481168">=</span>&nbsp;<span class="ident" id="6481170">io</span><span class="op" id="6481172">.</span><span class="ident" id="6481173">NewSectionReader</span><span class="op" id="6481189">(</span><span class="ident" id="6481190">r</span><span class="op" id="6481191">,</span>&nbsp;<span class="ident" id="6481193">int64</span><span class="op" id="6481198">(</span><span class="ident" id="6481199">s</span><span class="op" id="6481200">.</span><span class="ident" id="6481201">Offset</span><span class="op" id="6481207">)</span><span class="op" id="6481208">,</span>&nbsp;<span class="ident" id="6481210">int64</span><span class="op" id="6481215">(</span><span class="ident" id="6481216">s</span><span class="op" id="6481217">.</span><span class="ident" id="6481218">Size</span><span class="op" id="6481222">)</span><span class="op" id="6481223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481227">s</span><span class="op" id="6481228">.</span><span class="ident" id="6481229">ReaderAt</span>&nbsp;<span class="op" id="6481238">=</span>&nbsp;<span class="ident" id="6481240">s</span><span class="op" id="6481241">.</span><span class="ident" id="6481242">sr</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481247">f</span><span class="op" id="6481248">.</span><span class="ident" id="6481249">Sections</span><span class="op" id="6481257">[</span><span class="ident" id="6481258">i</span><span class="op" id="6481259">]</span>&nbsp;<span class="op" id="6481261">=</span>&nbsp;<span class="ident" id="6481263">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6481266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481270">return</span>&nbsp;<span class="ident" id="6481277">f</span><span class="op" id="6481278">,</span>&nbsp;<span class="ident" id="6481280">nil</span><br>
<span class="lineno"></span><span class="op" id="6481284">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="6481287">func</span>&nbsp;<span class="ident" id="6481292">walksymtab</span><span class="op" id="6481302">(</span><span class="ident" id="6481303">data</span>&nbsp;<span class="op" id="6481308">[</span><span class="op" id="6481309">]</span><span class="builtintype" id="6481310">byte</span><span class="op" id="6481314">,</span>&nbsp;<span class="ident" id="6481316">ptrsz</span>&nbsp;<span class="builtintype" id="6481322">int</span><span class="op" id="6481325">,</span>&nbsp;<span class="ident" id="6481327">fn</span>&nbsp;<span class="keyword" id="6481330">func</span><span class="op" id="6481334">(</span><span class="ident" id="6481335">sym</span><span class="op" id="6481338">)</span>&nbsp;<span class="builtintype" id="6481340">error</span><span class="op" id="6481345">)</span>&nbsp;<span class="builtintype" id="6481347">error</span>&nbsp;<span class="op" id="6481353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481356">var</span>&nbsp;<span class="ident" id="6481360">order</span>&nbsp;<span class="ident" id="6481366">binary</span><span class="op" id="6481372">.</span><span class="ident" id="6481373">ByteOrder</span>&nbsp;<span class="op" id="6481383">=</span>&nbsp;<span class="ident" id="6481385">binary</span><span class="op" id="6481391">.</span><span class="ident" id="6481392">BigEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481403">var</span>&nbsp;<span class="ident" id="6481407">s</span>&nbsp;<span class="ident" id="6481409">sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481414">p</span>&nbsp;<span class="op" id="6481416">:=</span>&nbsp;<span class="ident" id="6481419">data</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481425">for</span>&nbsp;<span class="builtinfunc" id="6481429">len</span><span class="op" id="6481432">(</span><span class="ident" id="6481433">p</span><span class="op" id="6481434">)</span>&nbsp;<span class="op" id="6481436">&gt;=</span>&nbsp;<span class="num" id="6481439">4</span>&nbsp;<span class="op" id="6481441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6481445">//&nbsp;Symbol&nbsp;type,&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481470">if</span>&nbsp;<span class="builtinfunc" id="6481473">len</span><span class="op" id="6481476">(</span><span class="ident" id="6481477">p</span><span class="op" id="6481478">)</span>&nbsp;<span class="op" id="6481480">&lt;</span>&nbsp;<span class="ident" id="6481482">ptrsz</span>&nbsp;<span class="op" id="6481488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481493">return</span>&nbsp;<span class="op" id="6481500">&amp;</span><span class="ident" id="6481501">formatError</span><span class="op" id="6481512">{</span><span class="builtinfunc" id="6481513">len</span><span class="op" id="6481516">(</span><span class="ident" id="6481517">data</span><span class="op" id="6481521">)</span><span class="op" id="6481522">,</span>&nbsp;<span class="string" id="6481524">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6481540">,</span>&nbsp;<span class="ident" id="6481542">nil</span><span class="op" id="6481545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6481549">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6481553">//&nbsp;fixed-width&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481576">if</span>&nbsp;<span class="ident" id="6481579">ptrsz</span>&nbsp;<span class="op" id="6481585">==</span>&nbsp;<span class="num" id="6481588">8</span>&nbsp;<span class="op" id="6481590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481595">s</span><span class="op" id="6481596">.</span><span class="ident" id="6481597">value</span>&nbsp;<span class="op" id="6481603">=</span>&nbsp;<span class="ident" id="6481605">order</span><span class="op" id="6481610">.</span><span class="ident" id="6481611">Uint64</span><span class="op" id="6481617">(</span><span class="ident" id="6481618">p</span><span class="op" id="6481619">[</span><span class="num" id="6481620">0</span><span class="op" id="6481621">:</span><span class="num" id="6481622">8</span><span class="op" id="6481623">]</span><span class="op" id="6481624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481629">p</span>&nbsp;<span class="op" id="6481631">=</span>&nbsp;<span class="ident" id="6481633">p</span><span class="op" id="6481634">[</span><span class="num" id="6481635">8</span><span class="op" id="6481636">:</span><span class="op" id="6481637">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6481641">}</span>&nbsp;<span class="keyword" id="6481643">else</span>&nbsp;<span class="op" id="6481648">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481653">s</span><span class="op" id="6481654">.</span><span class="ident" id="6481655">value</span>&nbsp;<span class="op" id="6481661">=</span>&nbsp;<span class="ident" id="6481663">uint64</span><span class="op" id="6481669">(</span><span class="ident" id="6481670">order</span><span class="op" id="6481675">.</span><span class="ident" id="6481676">Uint32</span><span class="op" id="6481682">(</span><span class="ident" id="6481683">p</span><span class="op" id="6481684">[</span><span class="num" id="6481685">0</span><span class="op" id="6481686">:</span><span class="num" id="6481687">4</span><span class="op" id="6481688">]</span><span class="op" id="6481689">)</span><span class="op" id="6481690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481695">p</span>&nbsp;<span class="op" id="6481697">=</span>&nbsp;<span class="ident" id="6481699">p</span><span class="op" id="6481700">[</span><span class="num" id="6481701">4</span><span class="op" id="6481702">:</span><span class="op" id="6481703">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6481707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481712">var</span>&nbsp;<span class="ident" id="6481716">typ</span>&nbsp;<span class="builtintype" id="6481720">byte</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481727">typ</span>&nbsp;<span class="op" id="6481731">=</span>&nbsp;<span class="ident" id="6481733">p</span><span class="op" id="6481734">[</span><span class="num" id="6481735">0</span><span class="op" id="6481736">]</span>&nbsp;<span class="op" id="6481738">&amp;</span>&nbsp;<span class="num" id="6481740">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481747">s</span><span class="op" id="6481748">.</span><span class="ident" id="6481749">typ</span>&nbsp;<span class="op" id="6481753">=</span>&nbsp;<span class="ident" id="6481755">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481761">p</span>&nbsp;<span class="op" id="6481763">=</span>&nbsp;<span class="ident" id="6481765">p</span><span class="op" id="6481766">[</span><span class="num" id="6481767">1</span><span class="op" id="6481768">:</span><span class="op" id="6481769">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6481774">//&nbsp;Name.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481785">var</span>&nbsp;<span class="ident" id="6481789">i</span>&nbsp;<span class="builtintype" id="6481791">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481797">var</span>&nbsp;<span class="ident" id="6481801">nnul</span>&nbsp;<span class="builtintype" id="6481806">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481812">for</span>&nbsp;<span class="ident" id="6481816">i</span>&nbsp;<span class="op" id="6481818">=</span>&nbsp;<span class="num" id="6481820">0</span><span class="op" id="6481821">;</span>&nbsp;<span class="ident" id="6481823">i</span>&nbsp;<span class="op" id="6481825">&lt;</span>&nbsp;<span class="builtinfunc" id="6481827">len</span><span class="op" id="6481830">(</span><span class="ident" id="6481831">p</span><span class="op" id="6481832">)</span><span class="op" id="6481833">;</span>&nbsp;<span class="ident" id="6481835">i</span><span class="op" id="6481836">++</span>&nbsp;<span class="op" id="6481839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481844">if</span>&nbsp;<span class="ident" id="6481847">p</span><span class="op" id="6481848">[</span><span class="ident" id="6481849">i</span><span class="op" id="6481850">]</span>&nbsp;<span class="op" id="6481852">==</span>&nbsp;<span class="num" id="6481855">0</span>&nbsp;<span class="op" id="6481857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481863">nnul</span>&nbsp;<span class="op" id="6481868">=</span>&nbsp;<span class="num" id="6481870">1</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481876">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6481885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6481889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481893">switch</span>&nbsp;<span class="ident" id="6481900">typ</span>&nbsp;<span class="op" id="6481904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481908">case</span>&nbsp;<span class="string" id="6481913">&#39;z&#39;</span><span class="op" id="6481916">,</span>&nbsp;<span class="string" id="6481918">&#39;Z&#39;</span><span class="op" id="6481921">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6481926">p</span>&nbsp;<span class="op" id="6481928">=</span>&nbsp;<span class="ident" id="6481930">p</span><span class="op" id="6481931">[</span><span class="ident" id="6481932">i</span><span class="op" id="6481933">+</span><span class="ident" id="6481934">nnul</span><span class="op" id="6481938">:</span><span class="op" id="6481939">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481944">for</span>&nbsp;<span class="ident" id="6481948">i</span>&nbsp;<span class="op" id="6481950">=</span>&nbsp;<span class="num" id="6481952">0</span><span class="op" id="6481953">;</span>&nbsp;<span class="ident" id="6481955">i</span><span class="op" id="6481956">+</span><span class="num" id="6481957">2</span>&nbsp;<span class="op" id="6481959">&lt;=</span>&nbsp;<span class="builtinfunc" id="6481962">len</span><span class="op" id="6481965">(</span><span class="ident" id="6481966">p</span><span class="op" id="6481967">)</span><span class="op" id="6481968">;</span>&nbsp;<span class="ident" id="6481970">i</span>&nbsp;<span class="op" id="6481972">+=</span>&nbsp;<span class="num" id="6481975">2</span>&nbsp;<span class="op" id="6481977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6481983">if</span>&nbsp;<span class="ident" id="6481986">p</span><span class="op" id="6481987">[</span><span class="ident" id="6481988">i</span><span class="op" id="6481989">]</span>&nbsp;<span class="op" id="6481991">==</span>&nbsp;<span class="num" id="6481994">0</span>&nbsp;<span class="op" id="6481996">&amp;&amp;</span>&nbsp;<span class="ident" id="6481999">p</span><span class="op" id="6482000">[</span><span class="ident" id="6482001">i</span><span class="op" id="6482002">+</span><span class="num" id="6482003">1</span><span class="op" id="6482004">]</span>&nbsp;<span class="op" id="6482006">==</span>&nbsp;<span class="num" id="6482009">0</span>&nbsp;<span class="op" id="6482011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482018">nnul</span>&nbsp;<span class="op" id="6482023">=</span>&nbsp;<span class="num" id="6482025">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482032">break</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6482042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6482047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6482051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482055">if</span>&nbsp;<span class="builtinfunc" id="6482058">len</span><span class="op" id="6482061">(</span><span class="ident" id="6482062">p</span><span class="op" id="6482063">)</span>&nbsp;<span class="op" id="6482065">&lt;</span>&nbsp;<span class="ident" id="6482067">i</span><span class="op" id="6482068">+</span><span class="ident" id="6482069">nnul</span>&nbsp;<span class="op" id="6482074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482079">return</span>&nbsp;<span class="op" id="6482086">&amp;</span><span class="ident" id="6482087">formatError</span><span class="op" id="6482098">{</span><span class="builtinfunc" id="6482099">len</span><span class="op" id="6482102">(</span><span class="ident" id="6482103">data</span><span class="op" id="6482107">)</span><span class="op" id="6482108">,</span>&nbsp;<span class="string" id="6482110">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6482126">,</span>&nbsp;<span class="ident" id="6482128">nil</span><span class="op" id="6482131">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6482135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482139">s</span><span class="op" id="6482140">.</span><span class="ident" id="6482141">name</span>&nbsp;<span class="op" id="6482146">=</span>&nbsp;<span class="ident" id="6482148">p</span><span class="op" id="6482149">[</span><span class="num" id="6482150">0</span><span class="op" id="6482151">:</span><span class="ident" id="6482152">i</span><span class="op" id="6482153">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482157">i</span>&nbsp;<span class="op" id="6482159">+=</span>&nbsp;<span class="ident" id="6482162">nnul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482169">p</span>&nbsp;<span class="op" id="6482171">=</span>&nbsp;<span class="ident" id="6482173">p</span><span class="op" id="6482174">[</span><span class="ident" id="6482175">i</span><span class="op" id="6482176">:</span><span class="op" id="6482177">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482182">fn</span><span class="op" id="6482184">(</span><span class="ident" id="6482185">s</span><span class="op" id="6482186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6482189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482192">return</span>&nbsp;<span class="ident" id="6482199">nil</span><br>
<span class="lineno"></span><span class="op" id="6482203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="6482206">//&nbsp;NewTable&nbsp;decodes&nbsp;the&nbsp;Go&nbsp;symbol&nbsp;table&nbsp;in&nbsp;data,</span><br>
<span class="lineno"></span><span class="comment" id="6482255">//&nbsp;returning&nbsp;an&nbsp;in-memory&nbsp;representation.</span><br>
<span class="lineno"></span><span class="keyword" id="6482297">func</span>&nbsp;<span class="ident" id="6482302">newTable</span><span class="op" id="6482310">(</span><span class="ident" id="6482311">symtab</span>&nbsp;<span class="op" id="6482318">[</span><span class="op" id="6482319">]</span><span class="builtintype" id="6482320">byte</span><span class="op" id="6482324">,</span>&nbsp;<span class="ident" id="6482326">ptrsz</span>&nbsp;<span class="builtintype" id="6482332">int</span><span class="op" id="6482335">)</span>&nbsp;<span class="op" id="6482337">(</span><span class="op" id="6482338">[</span><span class="op" id="6482339">]</span><span class="ident" id="6482340">Sym</span><span class="op" id="6482343">,</span>&nbsp;<span class="builtintype" id="6482345">error</span><span class="op" id="6482350">)</span>&nbsp;<span class="op" id="6482352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482355">var</span>&nbsp;<span class="ident" id="6482359">n</span>&nbsp;<span class="builtintype" id="6482361">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482366">err</span>&nbsp;<span class="op" id="6482370">:=</span>&nbsp;<span class="ident" id="6482373">walksymtab</span><span class="op" id="6482383">(</span><span class="ident" id="6482384">symtab</span><span class="op" id="6482390">,</span>&nbsp;<span class="ident" id="6482392">ptrsz</span><span class="op" id="6482397">,</span>&nbsp;<span class="keyword" id="6482399">func</span><span class="op" id="6482403">(</span><span class="ident" id="6482404">s</span>&nbsp;<span class="ident" id="6482406">sym</span><span class="op" id="6482409">)</span>&nbsp;<span class="builtintype" id="6482411">error</span>&nbsp;<span class="op" id="6482417">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482421">n</span><span class="op" id="6482422">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482427">return</span>&nbsp;<span class="ident" id="6482434">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6482439">}</span><span class="op" id="6482440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482443">if</span>&nbsp;<span class="ident" id="6482446">err</span>&nbsp;<span class="op" id="6482450">!=</span>&nbsp;<span class="ident" id="6482453">nil</span>&nbsp;<span class="op" id="6482457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482461">return</span>&nbsp;<span class="ident" id="6482468">nil</span><span class="op" id="6482471">,</span>&nbsp;<span class="ident" id="6482473">err</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6482478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482482">fname</span>&nbsp;<span class="op" id="6482488">:=</span>&nbsp;<span class="builtinfunc" id="6482491">make</span><span class="op" id="6482495">(</span><span class="keyword" id="6482496">map</span><span class="op" id="6482499">[</span><span class="builtintype" id="6482500">uint16</span><span class="op" id="6482506">]</span><span class="builtintype" id="6482507">string</span><span class="op" id="6482513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482516">syms</span>&nbsp;<span class="op" id="6482521">:=</span>&nbsp;<span class="builtinfunc" id="6482524">make</span><span class="op" id="6482528">(</span><span class="op" id="6482529">[</span><span class="op" id="6482530">]</span><span class="ident" id="6482531">Sym</span><span class="op" id="6482534">,</span>&nbsp;<span class="num" id="6482536">0</span><span class="op" id="6482537">,</span>&nbsp;<span class="ident" id="6482539">n</span><span class="op" id="6482540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482543">err</span>&nbsp;<span class="op" id="6482547">=</span>&nbsp;<span class="ident" id="6482549">walksymtab</span><span class="op" id="6482559">(</span><span class="ident" id="6482560">symtab</span><span class="op" id="6482566">,</span>&nbsp;<span class="ident" id="6482568">ptrsz</span><span class="op" id="6482573">,</span>&nbsp;<span class="keyword" id="6482575">func</span><span class="op" id="6482579">(</span><span class="ident" id="6482580">s</span>&nbsp;<span class="ident" id="6482582">sym</span><span class="op" id="6482585">)</span>&nbsp;<span class="builtintype" id="6482587">error</span>&nbsp;<span class="op" id="6482593">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482597">n</span>&nbsp;<span class="op" id="6482599">:=</span>&nbsp;<span class="builtinfunc" id="6482602">len</span><span class="op" id="6482605">(</span><span class="ident" id="6482606">syms</span><span class="op" id="6482610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482614">syms</span>&nbsp;<span class="op" id="6482619">=</span>&nbsp;<span class="ident" id="6482621">syms</span><span class="op" id="6482625">[</span><span class="num" id="6482626">0</span>&nbsp;<span class="op" id="6482628">:</span>&nbsp;<span class="ident" id="6482630">n</span><span class="op" id="6482631">+</span><span class="num" id="6482632">1</span><span class="op" id="6482633">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482637">ts</span>&nbsp;<span class="op" id="6482640">:=</span>&nbsp;<span class="op" id="6482643">&amp;</span><span class="ident" id="6482644">syms</span><span class="op" id="6482648">[</span><span class="ident" id="6482649">n</span><span class="op" id="6482650">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482654">ts</span><span class="op" id="6482656">.</span><span class="ident" id="6482657">Type</span>&nbsp;<span class="op" id="6482662">=</span>&nbsp;<span class="builtintype" id="6482664">rune</span><span class="op" id="6482668">(</span><span class="ident" id="6482669">s</span><span class="op" id="6482670">.</span><span class="ident" id="6482671">typ</span><span class="op" id="6482674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482678">ts</span><span class="op" id="6482680">.</span><span class="ident" id="6482681">Value</span>&nbsp;<span class="op" id="6482687">=</span>&nbsp;<span class="ident" id="6482689">s</span><span class="op" id="6482690">.</span><span class="ident" id="6482691">value</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482699">switch</span>&nbsp;<span class="ident" id="6482706">s</span><span class="op" id="6482707">.</span><span class="ident" id="6482708">typ</span>&nbsp;<span class="op" id="6482712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482716">default</span><span class="op" id="6482723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482728">ts</span><span class="op" id="6482730">.</span><span class="ident" id="6482731">Name</span>&nbsp;<span class="op" id="6482736">=</span>&nbsp;<span class="builtintype" id="6482738">string</span><span class="op" id="6482744">(</span><span class="ident" id="6482745">s</span><span class="op" id="6482746">.</span><span class="ident" id="6482747">name</span><span class="op" id="6482751">[</span><span class="op" id="6482752">:</span><span class="op" id="6482753">]</span><span class="op" id="6482754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482758">case</span>&nbsp;<span class="string" id="6482763">&#39;z&#39;</span><span class="op" id="6482766">,</span>&nbsp;<span class="string" id="6482768">&#39;Z&#39;</span><span class="op" id="6482771">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482776">for</span>&nbsp;<span class="ident" id="6482780">i</span>&nbsp;<span class="op" id="6482782">:=</span>&nbsp;<span class="num" id="6482785">0</span><span class="op" id="6482786">;</span>&nbsp;<span class="ident" id="6482788">i</span>&nbsp;<span class="op" id="6482790">&lt;</span>&nbsp;<span class="builtinfunc" id="6482792">len</span><span class="op" id="6482795">(</span><span class="ident" id="6482796">s</span><span class="op" id="6482797">.</span><span class="ident" id="6482798">name</span><span class="op" id="6482802">)</span><span class="op" id="6482803">;</span>&nbsp;<span class="ident" id="6482805">i</span>&nbsp;<span class="op" id="6482807">+=</span>&nbsp;<span class="num" id="6482810">2</span>&nbsp;<span class="op" id="6482812">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482818">eltIdx</span>&nbsp;<span class="op" id="6482825">:=</span>&nbsp;<span class="ident" id="6482828">binary</span><span class="op" id="6482834">.</span><span class="ident" id="6482835">BigEndian</span><span class="op" id="6482844">.</span><span class="ident" id="6482845">Uint16</span><span class="op" id="6482851">(</span><span class="ident" id="6482852">s</span><span class="op" id="6482853">.</span><span class="ident" id="6482854">name</span><span class="op" id="6482858">[</span><span class="ident" id="6482859">i</span>&nbsp;<span class="op" id="6482861">:</span>&nbsp;<span class="ident" id="6482863">i</span><span class="op" id="6482864">+</span><span class="num" id="6482865">2</span><span class="op" id="6482866">]</span><span class="op" id="6482867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482873">elt</span><span class="op" id="6482876">,</span>&nbsp;<span class="ident" id="6482878">ok</span>&nbsp;<span class="op" id="6482881">:=</span>&nbsp;<span class="ident" id="6482884">fname</span><span class="op" id="6482889">[</span><span class="ident" id="6482890">eltIdx</span><span class="op" id="6482896">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482902">if</span>&nbsp;<span class="op" id="6482905">!</span><span class="ident" id="6482906">ok</span>&nbsp;<span class="op" id="6482909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482916">return</span>&nbsp;<span class="op" id="6482923">&amp;</span><span class="ident" id="6482924">formatError</span><span class="op" id="6482935">{</span><span class="op" id="6482936">-</span><span class="num" id="6482937">1</span><span class="op" id="6482938">,</span>&nbsp;<span class="string" id="6482940">&#34;bad&nbsp;filename&nbsp;code&#34;</span><span class="op" id="6482959">,</span>&nbsp;<span class="ident" id="6482961">eltIdx</span><span class="op" id="6482967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6482973">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6482979">if</span>&nbsp;<span class="ident" id="6482982">n</span>&nbsp;<span class="op" id="6482984">:=</span>&nbsp;<span class="builtinfunc" id="6482987">len</span><span class="op" id="6482990">(</span><span class="ident" id="6482991">ts</span><span class="op" id="6482993">.</span><span class="ident" id="6482994">Name</span><span class="op" id="6482998">)</span><span class="op" id="6482999">;</span>&nbsp;<span class="ident" id="6483001">n</span>&nbsp;<span class="op" id="6483003">&gt;</span>&nbsp;<span class="num" id="6483005">0</span>&nbsp;<span class="op" id="6483007">&amp;&amp;</span>&nbsp;<span class="ident" id="6483010">ts</span><span class="op" id="6483012">.</span><span class="ident" id="6483013">Name</span><span class="op" id="6483017">[</span><span class="ident" id="6483018">n</span><span class="op" id="6483019">-</span><span class="num" id="6483020">1</span><span class="op" id="6483021">]</span>&nbsp;<span class="op" id="6483023">!=</span>&nbsp;<span class="string" id="6483026">&#39;/&#39;</span>&nbsp;<span class="op" id="6483030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483037">ts</span><span class="op" id="6483039">.</span><span class="ident" id="6483040">Name</span>&nbsp;<span class="op" id="6483045">+=</span>&nbsp;<span class="string" id="6483048">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6483056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483062">ts</span><span class="op" id="6483064">.</span><span class="ident" id="6483065">Name</span>&nbsp;<span class="op" id="6483070">+=</span>&nbsp;<span class="ident" id="6483073">elt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6483080">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6483084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483088">switch</span>&nbsp;<span class="ident" id="6483095">s</span><span class="op" id="6483096">.</span><span class="ident" id="6483097">typ</span>&nbsp;<span class="op" id="6483101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483105">case</span>&nbsp;<span class="string" id="6483110">&#39;f&#39;</span><span class="op" id="6483113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483118">fname</span><span class="op" id="6483123">[</span><span class="builtintype" id="6483124">uint16</span><span class="op" id="6483130">(</span><span class="ident" id="6483131">s</span><span class="op" id="6483132">.</span><span class="ident" id="6483133">value</span><span class="op" id="6483138">)</span><span class="op" id="6483139">]</span>&nbsp;<span class="op" id="6483141">=</span>&nbsp;<span class="ident" id="6483143">ts</span><span class="op" id="6483145">.</span><span class="ident" id="6483146">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6483153">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483157">return</span>&nbsp;<span class="ident" id="6483164">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6483169">}</span><span class="op" id="6483170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483173">if</span>&nbsp;<span class="ident" id="6483176">err</span>&nbsp;<span class="op" id="6483180">!=</span>&nbsp;<span class="ident" id="6483183">nil</span>&nbsp;<span class="op" id="6483187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483191">return</span>&nbsp;<span class="ident" id="6483198">nil</span><span class="op" id="6483201">,</span>&nbsp;<span class="ident" id="6483203">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6483208">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483212">return</span>&nbsp;<span class="ident" id="6483219">syms</span><span class="op" id="6483223">,</span>&nbsp;<span class="ident" id="6483225">nil</span><br>
<span class="lineno"></span><span class="op" id="6483229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6483232">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.</span><br>
<span class="lineno">305</span><span class="keyword" id="6483275">func</span>&nbsp;<span class="op" id="6483280">(</span><span class="ident" id="6483281">f</span>&nbsp;<span class="op" id="6483283">*</span><span class="ident" id="6483284">File</span><span class="op" id="6483288">)</span>&nbsp;<span class="ident" id="6483290">Symbols</span><span class="op" id="6483297">(</span><span class="op" id="6483298">)</span>&nbsp;<span class="op" id="6483300">(</span><span class="op" id="6483301">[</span><span class="op" id="6483302">]</span><span class="ident" id="6483303">Sym</span><span class="op" id="6483306">,</span>&nbsp;<span class="builtintype" id="6483308">error</span><span class="op" id="6483313">)</span>&nbsp;<span class="op" id="6483315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483318">symtabSection</span>&nbsp;<span class="op" id="6483332">:=</span>&nbsp;<span class="ident" id="6483335">f</span><span class="op" id="6483336">.</span><span class="ident" id="6483337">Section</span><span class="op" id="6483344">(</span><span class="string" id="6483345">&#34;syms&#34;</span><span class="op" id="6483351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483354">if</span>&nbsp;<span class="ident" id="6483357">symtabSection</span>&nbsp;<span class="op" id="6483371">==</span>&nbsp;<span class="ident" id="6483374">nil</span>&nbsp;<span class="op" id="6483378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483382">return</span>&nbsp;<span class="ident" id="6483389">nil</span><span class="op" id="6483392">,</span>&nbsp;<span class="ident" id="6483394">errors</span><span class="op" id="6483400">.</span><span class="ident" id="6483401">New</span><span class="op" id="6483404">(</span><span class="string" id="6483405">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6483424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6483427">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483431">symtab</span><span class="op" id="6483437">,</span>&nbsp;<span class="ident" id="6483439">err</span>&nbsp;<span class="op" id="6483443">:=</span>&nbsp;<span class="ident" id="6483446">symtabSection</span><span class="op" id="6483459">.</span><span class="ident" id="6483460">Data</span><span class="op" id="6483464">(</span><span class="op" id="6483465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483468">if</span>&nbsp;<span class="ident" id="6483471">err</span>&nbsp;<span class="op" id="6483475">!=</span>&nbsp;<span class="ident" id="6483478">nil</span>&nbsp;<span class="op" id="6483482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483486">return</span>&nbsp;<span class="ident" id="6483493">nil</span><span class="op" id="6483496">,</span>&nbsp;<span class="ident" id="6483498">errors</span><span class="op" id="6483504">.</span><span class="ident" id="6483505">New</span><span class="op" id="6483508">(</span><span class="string" id="6483509">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6483537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6483540">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483544">return</span>&nbsp;<span class="ident" id="6483551">newTable</span><span class="op" id="6483559">(</span><span class="ident" id="6483560">symtab</span><span class="op" id="6483566">,</span>&nbsp;<span class="ident" id="6483568">f</span><span class="op" id="6483569">.</span><span class="ident" id="6483570">PtrSize</span><span class="op" id="6483577">)</span><br>
<span class="lineno"></span><span class="op" id="6483579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6483582">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno">320</span><span class="comment" id="6483650">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6483669">func</span>&nbsp;<span class="op" id="6483674">(</span><span class="ident" id="6483675">f</span>&nbsp;<span class="op" id="6483677">*</span><span class="ident" id="6483678">File</span><span class="op" id="6483682">)</span>&nbsp;<span class="ident" id="6483684">Section</span><span class="op" id="6483691">(</span><span class="ident" id="6483692">name</span>&nbsp;<span class="builtintype" id="6483697">string</span><span class="op" id="6483703">)</span>&nbsp;<span class="op" id="6483705">*</span><span class="ident" id="6483706">Section</span>&nbsp;<span class="op" id="6483714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483717">for</span>&nbsp;<span class="ident" id="6483721">_</span><span class="op" id="6483722">,</span>&nbsp;<span class="ident" id="6483724">s</span>&nbsp;<span class="op" id="6483726">:=</span>&nbsp;<span class="keyword" id="6483729">range</span>&nbsp;<span class="ident" id="6483735">f</span><span class="op" id="6483736">.</span><span class="ident" id="6483737">Sections</span>&nbsp;<span class="op" id="6483746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483750">if</span>&nbsp;<span class="ident" id="6483753">s</span><span class="op" id="6483754">.</span><span class="ident" id="6483755">Name</span>&nbsp;<span class="op" id="6483760">==</span>&nbsp;<span class="ident" id="6483763">name</span>&nbsp;<span class="op" id="6483768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483773">return</span>&nbsp;<span class="ident" id="6483780">s</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6483784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6483787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483790">return</span>&nbsp;<span class="ident" id="6483797">nil</span><br>
<span class="lineno"></span><span class="op" id="6483801">}</span>
</div>
</body>
</html>
