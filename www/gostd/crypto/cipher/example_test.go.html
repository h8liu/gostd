<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html" class="current">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="133410">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="133465">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="133519">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="133570">package</span>&nbsp;<span class="ident" id="133578">cipher_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="133591">import</span>&nbsp;<span class="op" id="133598">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="133601">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="133615">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="133632">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="133647">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="133663">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="133670">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="133676">&#34;os&#34;</span><br>
<span class="lineno">15</span><span class="op" id="133681">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="133684">func</span>&nbsp;<span class="ident" id="133689">ExampleNewCBCDecrypter</span><span class="op" id="133711">(</span><span class="op" id="133712">)</span>&nbsp;<span class="op" id="133714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="133717">key</span>&nbsp;<span class="op" id="133721">:=</span>&nbsp;<span class="op" id="133724">[</span><span class="op" id="133725">]</span><span class="builtintype" id="133726">byte</span><span class="op" id="133730">(</span><span class="string" id="133731">&#34;example&nbsp;key&nbsp;1234&#34;</span><span class="op" id="133749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="133752">ciphertext</span><span class="op" id="133762">,</span>&nbsp;<span class="ident" id="133764">_</span>&nbsp;<span class="op" id="133766">:=</span>&nbsp;<span class="ident" id="133769"><a href="/gostd/crypto/cipher/example_test.go.html#133647">hex</a></span><span class="op" id="133772">.</span><span class="ident" id="133773"><a href="/gostd/encoding/hex/hex.go.html#4721563">DecodeString</a></span><span class="op" id="133785">(</span><span class="string" id="133786">&#34;f363f3ccdcb12bb883abf484ba77d9cd7d32b5baecb3d4b1b3e0e4beffdb3ded&#34;</span><span class="op" id="133852">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="133856">block</span><span class="op" id="133861">,</span>&nbsp;<span class="ident" id="133863">err</span>&nbsp;<span class="op" id="133867">:=</span>&nbsp;<span class="ident" id="133870"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="133873">.</span><span class="ident" id="133874"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="133883">(</span><span class="ident" id="133884"><a href="/gostd/crypto/cipher/example_test.go.html#133717">key</a></span><span class="op" id="133887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="133890">if</span>&nbsp;<span class="ident" id="133893"><a href="/gostd/crypto/cipher/example_test.go.html#133863">err</a></span>&nbsp;<span class="op" id="133897">!=</span>&nbsp;<span class="builtintype" id="133900">nil</span>&nbsp;<span class="op" id="133904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="133908">panic</span><span class="op" id="133913">(</span><span class="ident" id="133914"><a href="/gostd/crypto/cipher/example_test.go.html#133863">err</a></span><span class="op" id="133917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="133920">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="133924">//&nbsp;The&nbsp;IV&nbsp;needs&nbsp;to&nbsp;be&nbsp;unique,&nbsp;but&nbsp;not&nbsp;secure.&nbsp;Therefore&nbsp;it&#39;s&nbsp;common&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="133996">//&nbsp;include&nbsp;it&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;ciphertext.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="134047">if</span>&nbsp;<span class="builtinfunc" id="134050">len</span><span class="op" id="134053">(</span><span class="ident" id="134054"><a href="/gostd/crypto/cipher/example_test.go.html#133752">ciphertext</a></span><span class="op" id="134064">)</span>&nbsp;<span class="op" id="134066">&lt;</span>&nbsp;<span class="ident" id="134068"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="134071">.</span><span class="ident" id="134072"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span>&nbsp;<span class="op" id="134082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="134086">panic</span><span class="op" id="134091">(</span><span class="string" id="134092">&#34;ciphertext&nbsp;too&nbsp;short&#34;</span><span class="op" id="134114">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="134117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="134120">iv</span>&nbsp;<span class="op" id="134123">:=</span>&nbsp;<span class="ident" id="134126"><a href="/gostd/crypto/cipher/example_test.go.html#133752">ciphertext</a></span><span class="op" id="134136">[</span><span class="op" id="134137">:</span><span class="ident" id="134138"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="134141">.</span><span class="ident" id="134142"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="134151">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="134154"><a href="/gostd/crypto/cipher/example_test.go.html#133752">ciphertext</a></span>&nbsp;<span class="op" id="134165">=</span>&nbsp;<span class="ident" id="134167"><a href="/gostd/crypto/cipher/example_test.go.html#133752">ciphertext</a></span><span class="op" id="134177">[</span><span class="ident" id="134178"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="134181">.</span><span class="ident" id="134182"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="134191">:</span><span class="op" id="134192">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="134196">//&nbsp;CBC&nbsp;mode&nbsp;always&nbsp;works&nbsp;in&nbsp;whole&nbsp;blocks.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="134239">if</span>&nbsp;<span class="builtinfunc" id="134242">len</span><span class="op" id="134245">(</span><span class="ident" id="134246"><a href="/gostd/crypto/cipher/example_test.go.html#133752">ciphertext</a></span><span class="op" id="134256">)</span><span class="op" id="134257">%</span><span class="ident" id="134258"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="134261">.</span><span class="ident" id="134262"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span>&nbsp;<span class="op" id="134272">!=</span>&nbsp;<span class="num" id="134275">0</span>&nbsp;<span class="op" id="134277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="134281">panic</span><span class="op" id="134286">(</span><span class="string" id="134287">&#34;ciphertext&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;the&nbsp;block&nbsp;size&#34;</span><span class="op" id="134335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="134338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="134342">mode</span>&nbsp;<span class="op" id="134347">:=</span>&nbsp;<span class="ident" id="134350"><a href="/gostd/crypto/cipher/example_test.go.html#133615">cipher</a></span><span class="op" id="134356">.</span><span class="ident" id="134357"><a href="/gostd/crypto/cipher/cbc.go.html#4406839">NewCBCDecrypter</a></span><span class="op" id="134372">(</span><span class="ident" id="134373"><a href="/gostd/crypto/cipher/example_test.go.html#133856">block</a></span><span class="op" id="134378">,</span>&nbsp;<span class="ident" id="134380"><a href="/gostd/crypto/cipher/example_test.go.html#134120">iv</a></span><span class="op" id="134382">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="134386">//&nbsp;CryptBlocks&nbsp;can&nbsp;work&nbsp;in-place&nbsp;if&nbsp;the&nbsp;two&nbsp;arguments&nbsp;are&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="134455"><a href="/gostd/crypto/cipher/example_test.go.html#134342">mode</a></span><span class="op" id="134459">.</span><span class="ident" id="134460"><a href="/gostd/crypto/cipher/cipher.go.html#4411618">CryptBlocks</a></span><span class="op" id="134471">(</span><span class="ident" id="134472"><a href="/gostd/crypto/cipher/example_test.go.html#133752">ciphertext</a></span><span class="op" id="134482">,</span>&nbsp;<span class="ident" id="134484"><a href="/gostd/crypto/cipher/example_test.go.html#133752">ciphertext</a></span><span class="op" id="134494">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="134498">//&nbsp;If&nbsp;the&nbsp;original&nbsp;plaintext&nbsp;lengths&nbsp;are&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;the&nbsp;block</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="134568">//&nbsp;size,&nbsp;padding&nbsp;would&nbsp;have&nbsp;to&nbsp;be&nbsp;added&nbsp;when&nbsp;encrypting,&nbsp;which&nbsp;would&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="134641">//&nbsp;removed&nbsp;at&nbsp;this&nbsp;point.&nbsp;For&nbsp;an&nbsp;example,&nbsp;see</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="134688">//&nbsp;https://tools.ietf.org/html/rfc5246#section-6.2.3.2.&nbsp;However,&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="134759">//&nbsp;critical&nbsp;to&nbsp;note&nbsp;that&nbsp;ciphertexts&nbsp;must&nbsp;be&nbsp;authenticated&nbsp;(i.e.&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="134828">//&nbsp;using&nbsp;crypto/hmac)&nbsp;before&nbsp;being&nbsp;decrypted&nbsp;in&nbsp;order&nbsp;to&nbsp;avoid&nbsp;creating</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="134901">//&nbsp;a&nbsp;padding&nbsp;oracle.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="134924"><a href="/gostd/crypto/cipher/example_test.go.html#133663">fmt</a></span><span class="op" id="134927">.</span><span class="ident" id="134928"><a href="/gostd/fmt/print.go.html#2143442">Printf</a></span><span class="op" id="134934">(</span><span class="string" id="134935">&#34;%s\n&#34;</span><span class="op" id="134941">,</span>&nbsp;<span class="ident" id="134943"><a href="/gostd/crypto/cipher/example_test.go.html#133752">ciphertext</a></span><span class="op" id="134953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="134956">//&nbsp;Output:&nbsp;exampleplaintext</span><br>
<span class="lineno"></span><span class="op" id="134984">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="134987">func</span>&nbsp;<span class="ident" id="134992">ExampleNewCBCEncrypter</span><span class="op" id="135014">(</span><span class="op" id="135015">)</span>&nbsp;<span class="op" id="135017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="135020">key</span>&nbsp;<span class="op" id="135024">:=</span>&nbsp;<span class="op" id="135027">[</span><span class="op" id="135028">]</span><span class="builtintype" id="135029">byte</span><span class="op" id="135033">(</span><span class="string" id="135034">&#34;example&nbsp;key&nbsp;1234&#34;</span><span class="op" id="135052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="135055">plaintext</span>&nbsp;<span class="op" id="135065">:=</span>&nbsp;<span class="op" id="135068">[</span><span class="op" id="135069">]</span><span class="builtintype" id="135070">byte</span><span class="op" id="135074">(</span><span class="string" id="135075">&#34;exampleplaintext&#34;</span><span class="op" id="135093">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="135097">//&nbsp;CBC&nbsp;mode&nbsp;works&nbsp;on&nbsp;blocks&nbsp;so&nbsp;plaintexts&nbsp;may&nbsp;need&nbsp;to&nbsp;be&nbsp;padded&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="135169">//&nbsp;next&nbsp;whole&nbsp;block.&nbsp;For&nbsp;an&nbsp;example&nbsp;of&nbsp;such&nbsp;padding,&nbsp;see</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="135227">//&nbsp;https://tools.ietf.org/html/rfc5246#section-6.2.3.2.&nbsp;Here&nbsp;we&#39;ll</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="135295">//&nbsp;assume&nbsp;that&nbsp;the&nbsp;plaintext&nbsp;is&nbsp;already&nbsp;of&nbsp;the&nbsp;correct&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="135359">if</span>&nbsp;<span class="builtinfunc" id="135362">len</span><span class="op" id="135365">(</span><span class="ident" id="135366"><a href="/gostd/crypto/cipher/example_test.go.html#135055">plaintext</a></span><span class="op" id="135375">)</span><span class="op" id="135376">%</span><span class="ident" id="135377"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="135380">.</span><span class="ident" id="135381"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span>&nbsp;<span class="op" id="135391">!=</span>&nbsp;<span class="num" id="135394">0</span>&nbsp;<span class="op" id="135396">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="135400">panic</span><span class="op" id="135405">(</span><span class="string" id="135406">&#34;plaintext&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;the&nbsp;block&nbsp;size&#34;</span><span class="op" id="135453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="135456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="135460">block</span><span class="op" id="135465">,</span>&nbsp;<span class="ident" id="135467">err</span>&nbsp;<span class="op" id="135471">:=</span>&nbsp;<span class="ident" id="135474"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="135477">.</span><span class="ident" id="135478"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="135487">(</span><span class="ident" id="135488"><a href="/gostd/crypto/cipher/example_test.go.html#135020">key</a></span><span class="op" id="135491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="135494">if</span>&nbsp;<span class="ident" id="135497"><a href="/gostd/crypto/cipher/example_test.go.html#135467">err</a></span>&nbsp;<span class="op" id="135501">!=</span>&nbsp;<span class="builtintype" id="135504">nil</span>&nbsp;<span class="op" id="135508">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="135512">panic</span><span class="op" id="135517">(</span><span class="ident" id="135518"><a href="/gostd/crypto/cipher/example_test.go.html#135467">err</a></span><span class="op" id="135521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="135524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="135528">//&nbsp;The&nbsp;IV&nbsp;needs&nbsp;to&nbsp;be&nbsp;unique,&nbsp;but&nbsp;not&nbsp;secure.&nbsp;Therefore&nbsp;it&#39;s&nbsp;common&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="135600">//&nbsp;include&nbsp;it&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;ciphertext.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="135651">ciphertext</span>&nbsp;<span class="op" id="135662">:=</span>&nbsp;<span class="builtinfunc" id="135665">make</span><span class="op" id="135669">(</span><span class="op" id="135670">[</span><span class="op" id="135671">]</span><span class="builtintype" id="135672">byte</span><span class="op" id="135676">,</span>&nbsp;<span class="ident" id="135678"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="135681">.</span><span class="ident" id="135682"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="135691">+</span><span class="builtinfunc" id="135692">len</span><span class="op" id="135695">(</span><span class="ident" id="135696"><a href="/gostd/crypto/cipher/example_test.go.html#135055">plaintext</a></span><span class="op" id="135705">)</span><span class="op" id="135706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="135709">iv</span>&nbsp;<span class="op" id="135712">:=</span>&nbsp;<span class="ident" id="135715"><a href="/gostd/crypto/cipher/example_test.go.html#135651">ciphertext</a></span><span class="op" id="135725">[</span><span class="op" id="135726">:</span><span class="ident" id="135727"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="135730">.</span><span class="ident" id="135731"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="135740">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="135743">if</span>&nbsp;<span class="ident" id="135746">_</span><span class="op" id="135747">,</span>&nbsp;<span class="ident" id="135749">err</span>&nbsp;<span class="op" id="135753">:=</span>&nbsp;<span class="ident" id="135756"><a href="/gostd/crypto/cipher/example_test.go.html#133670">io</a></span><span class="op" id="135758">.</span><span class="ident" id="135759"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="135767">(</span><span class="ident" id="135768"><a href="/gostd/crypto/cipher/example_test.go.html#133632">rand</a></span><span class="op" id="135772">.</span><span class="ident" id="135773"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="135779">,</span>&nbsp;<span class="ident" id="135781"><a href="/gostd/crypto/cipher/example_test.go.html#135709">iv</a></span><span class="op" id="135783">)</span><span class="op" id="135784">;</span>&nbsp;<span class="ident" id="135786"><a href="/gostd/crypto/cipher/example_test.go.html#135749">err</a></span>&nbsp;<span class="op" id="135790">!=</span>&nbsp;<span class="builtintype" id="135793">nil</span>&nbsp;<span class="op" id="135797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="135801">panic</span><span class="op" id="135806">(</span><span class="ident" id="135807"><a href="/gostd/crypto/cipher/example_test.go.html#135749">err</a></span><span class="op" id="135810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="135813">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="135817">mode</span>&nbsp;<span class="op" id="135822">:=</span>&nbsp;<span class="ident" id="135825"><a href="/gostd/crypto/cipher/example_test.go.html#133615">cipher</a></span><span class="op" id="135831">.</span><span class="ident" id="135832"><a href="/gostd/crypto/cipher/cbc.go.html#4405590">NewCBCEncrypter</a></span><span class="op" id="135847">(</span><span class="ident" id="135848"><a href="/gostd/crypto/cipher/example_test.go.html#135460">block</a></span><span class="op" id="135853">,</span>&nbsp;<span class="ident" id="135855"><a href="/gostd/crypto/cipher/example_test.go.html#135709">iv</a></span><span class="op" id="135857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="135860"><a href="/gostd/crypto/cipher/example_test.go.html#135817">mode</a></span><span class="op" id="135864">.</span><span class="ident" id="135865"><a href="/gostd/crypto/cipher/cipher.go.html#4411618">CryptBlocks</a></span><span class="op" id="135876">(</span><span class="ident" id="135877"><a href="/gostd/crypto/cipher/example_test.go.html#135651">ciphertext</a></span><span class="op" id="135887">[</span><span class="ident" id="135888"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="135891">.</span><span class="ident" id="135892"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="135901">:</span><span class="op" id="135902">]</span><span class="op" id="135903">,</span>&nbsp;<span class="ident" id="135905"><a href="/gostd/crypto/cipher/example_test.go.html#135055">plaintext</a></span><span class="op" id="135914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="135918">//&nbsp;It&#39;s&nbsp;important&nbsp;to&nbsp;remember&nbsp;that&nbsp;ciphertexts&nbsp;must&nbsp;be&nbsp;authenticated</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="135988">//&nbsp;(i.e.&nbsp;by&nbsp;using&nbsp;crypto/hmac)&nbsp;as&nbsp;well&nbsp;as&nbsp;being&nbsp;encrypted&nbsp;in&nbsp;order&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="136059">//&nbsp;be&nbsp;secure.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="136075"><a href="/gostd/crypto/cipher/example_test.go.html#133663">fmt</a></span><span class="op" id="136078">.</span><span class="ident" id="136079"><a href="/gostd/fmt/print.go.html#2143442">Printf</a></span><span class="op" id="136085">(</span><span class="string" id="136086">&#34;%x\n&#34;</span><span class="op" id="136092">,</span>&nbsp;<span class="ident" id="136094"><a href="/gostd/crypto/cipher/example_test.go.html#135651">ciphertext</a></span><span class="op" id="136104">)</span><br>
<span class="lineno"></span><span class="op" id="136106">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="136109">func</span>&nbsp;<span class="ident" id="136114">ExampleNewCFBDecrypter</span><span class="op" id="136136">(</span><span class="op" id="136137">)</span>&nbsp;<span class="op" id="136139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="136142">key</span>&nbsp;<span class="op" id="136146">:=</span>&nbsp;<span class="op" id="136149">[</span><span class="op" id="136150">]</span><span class="builtintype" id="136151">byte</span><span class="op" id="136155">(</span><span class="string" id="136156">&#34;example&nbsp;key&nbsp;1234&#34;</span><span class="op" id="136174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="136177">ciphertext</span><span class="op" id="136187">,</span>&nbsp;<span class="ident" id="136189">_</span>&nbsp;<span class="op" id="136191">:=</span>&nbsp;<span class="ident" id="136194"><a href="/gostd/crypto/cipher/example_test.go.html#133647">hex</a></span><span class="op" id="136197">.</span><span class="ident" id="136198"><a href="/gostd/encoding/hex/hex.go.html#4721563">DecodeString</a></span><span class="op" id="136210">(</span><span class="string" id="136211">&#34;22277966616d9bc47177bd02603d08c9a67d5380d0fe8cf3b44438dff7b9&#34;</span><span class="op" id="136273">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="136277">block</span><span class="op" id="136282">,</span>&nbsp;<span class="ident" id="136284">err</span>&nbsp;<span class="op" id="136288">:=</span>&nbsp;<span class="ident" id="136291"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="136294">.</span><span class="ident" id="136295"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="136304">(</span><span class="ident" id="136305"><a href="/gostd/crypto/cipher/example_test.go.html#136142">key</a></span><span class="op" id="136308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="136311">if</span>&nbsp;<span class="ident" id="136314"><a href="/gostd/crypto/cipher/example_test.go.html#136284">err</a></span>&nbsp;<span class="op" id="136318">!=</span>&nbsp;<span class="builtintype" id="136321">nil</span>&nbsp;<span class="op" id="136325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="136329">panic</span><span class="op" id="136334">(</span><span class="ident" id="136335"><a href="/gostd/crypto/cipher/example_test.go.html#136284">err</a></span><span class="op" id="136338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="136341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="136345">//&nbsp;The&nbsp;IV&nbsp;needs&nbsp;to&nbsp;be&nbsp;unique,&nbsp;but&nbsp;not&nbsp;secure.&nbsp;Therefore&nbsp;it&#39;s&nbsp;common&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="136417">//&nbsp;include&nbsp;it&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;ciphertext.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="136468">if</span>&nbsp;<span class="builtinfunc" id="136471">len</span><span class="op" id="136474">(</span><span class="ident" id="136475"><a href="/gostd/crypto/cipher/example_test.go.html#136177">ciphertext</a></span><span class="op" id="136485">)</span>&nbsp;<span class="op" id="136487">&lt;</span>&nbsp;<span class="ident" id="136489"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="136492">.</span><span class="ident" id="136493"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span>&nbsp;<span class="op" id="136503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="136507">panic</span><span class="op" id="136512">(</span><span class="string" id="136513">&#34;ciphertext&nbsp;too&nbsp;short&#34;</span><span class="op" id="136535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="136538">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="136541">iv</span>&nbsp;<span class="op" id="136544">:=</span>&nbsp;<span class="ident" id="136547"><a href="/gostd/crypto/cipher/example_test.go.html#136177">ciphertext</a></span><span class="op" id="136557">[</span><span class="op" id="136558">:</span><span class="ident" id="136559"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="136562">.</span><span class="ident" id="136563"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="136572">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="136575"><a href="/gostd/crypto/cipher/example_test.go.html#136177">ciphertext</a></span>&nbsp;<span class="op" id="136586">=</span>&nbsp;<span class="ident" id="136588"><a href="/gostd/crypto/cipher/example_test.go.html#136177">ciphertext</a></span><span class="op" id="136598">[</span><span class="ident" id="136599"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="136602">.</span><span class="ident" id="136603"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="136612">:</span><span class="op" id="136613">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="136617">stream</span>&nbsp;<span class="op" id="136624">:=</span>&nbsp;<span class="ident" id="136627"><a href="/gostd/crypto/cipher/example_test.go.html#133615">cipher</a></span><span class="op" id="136633">.</span><span class="ident" id="136634"><a href="/gostd/crypto/cipher/cfb.go.html#4409551">NewCFBDecrypter</a></span><span class="op" id="136649">(</span><span class="ident" id="136650"><a href="/gostd/crypto/cipher/example_test.go.html#136277">block</a></span><span class="op" id="136655">,</span>&nbsp;<span class="ident" id="136657"><a href="/gostd/crypto/cipher/example_test.go.html#136541">iv</a></span><span class="op" id="136659">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="136663">//&nbsp;XORKeyStream&nbsp;can&nbsp;work&nbsp;in-place&nbsp;if&nbsp;the&nbsp;two&nbsp;arguments&nbsp;are&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="136733"><a href="/gostd/crypto/cipher/example_test.go.html#136617">stream</a></span><span class="op" id="136739">.</span><span class="ident" id="136740"><a href="/gostd/crypto/cipher/cipher.go.html#4411241">XORKeyStream</a></span><span class="op" id="136752">(</span><span class="ident" id="136753"><a href="/gostd/crypto/cipher/example_test.go.html#136177">ciphertext</a></span><span class="op" id="136763">,</span>&nbsp;<span class="ident" id="136765"><a href="/gostd/crypto/cipher/example_test.go.html#136177">ciphertext</a></span><span class="op" id="136775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="136778"><a href="/gostd/crypto/cipher/example_test.go.html#133663">fmt</a></span><span class="op" id="136781">.</span><span class="ident" id="136782"><a href="/gostd/fmt/print.go.html#2143442">Printf</a></span><span class="op" id="136788">(</span><span class="string" id="136789">&#34;%s&#34;</span><span class="op" id="136793">,</span>&nbsp;<span class="ident" id="136795"><a href="/gostd/crypto/cipher/example_test.go.html#136177">ciphertext</a></span><span class="op" id="136805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="136808">//&nbsp;Output:&nbsp;some&nbsp;plaintext</span><br>
<span class="lineno"></span><span class="op" id="136834">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="136837">func</span>&nbsp;<span class="ident" id="136842">ExampleNewCFBEncrypter</span><span class="op" id="136864">(</span><span class="op" id="136865">)</span>&nbsp;<span class="op" id="136867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="136870">key</span>&nbsp;<span class="op" id="136874">:=</span>&nbsp;<span class="op" id="136877">[</span><span class="op" id="136878">]</span><span class="builtintype" id="136879">byte</span><span class="op" id="136883">(</span><span class="string" id="136884">&#34;example&nbsp;key&nbsp;1234&#34;</span><span class="op" id="136902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="136905">plaintext</span>&nbsp;<span class="op" id="136915">:=</span>&nbsp;<span class="op" id="136918">[</span><span class="op" id="136919">]</span><span class="builtintype" id="136920">byte</span><span class="op" id="136924">(</span><span class="string" id="136925">&#34;some&nbsp;plaintext&#34;</span><span class="op" id="136941">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="136945">block</span><span class="op" id="136950">,</span>&nbsp;<span class="ident" id="136952">err</span>&nbsp;<span class="op" id="136956">:=</span>&nbsp;<span class="ident" id="136959"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="136962">.</span><span class="ident" id="136963"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="136972">(</span><span class="ident" id="136973"><a href="/gostd/crypto/cipher/example_test.go.html#136870">key</a></span><span class="op" id="136976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="136979">if</span>&nbsp;<span class="ident" id="136982"><a href="/gostd/crypto/cipher/example_test.go.html#136952">err</a></span>&nbsp;<span class="op" id="136986">!=</span>&nbsp;<span class="builtintype" id="136989">nil</span>&nbsp;<span class="op" id="136993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="136997">panic</span><span class="op" id="137002">(</span><span class="ident" id="137003"><a href="/gostd/crypto/cipher/example_test.go.html#136952">err</a></span><span class="op" id="137006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="137009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="137013">//&nbsp;The&nbsp;IV&nbsp;needs&nbsp;to&nbsp;be&nbsp;unique,&nbsp;but&nbsp;not&nbsp;secure.&nbsp;Therefore&nbsp;it&#39;s&nbsp;common&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="137085">//&nbsp;include&nbsp;it&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;ciphertext.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="137136">ciphertext</span>&nbsp;<span class="op" id="137147">:=</span>&nbsp;<span class="builtinfunc" id="137150">make</span><span class="op" id="137154">(</span><span class="op" id="137155">[</span><span class="op" id="137156">]</span><span class="builtintype" id="137157">byte</span><span class="op" id="137161">,</span>&nbsp;<span class="ident" id="137163"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="137166">.</span><span class="ident" id="137167"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="137176">+</span><span class="builtinfunc" id="137177">len</span><span class="op" id="137180">(</span><span class="ident" id="137181"><a href="/gostd/crypto/cipher/example_test.go.html#136905">plaintext</a></span><span class="op" id="137190">)</span><span class="op" id="137191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="137194">iv</span>&nbsp;<span class="op" id="137197">:=</span>&nbsp;<span class="ident" id="137200"><a href="/gostd/crypto/cipher/example_test.go.html#137136">ciphertext</a></span><span class="op" id="137210">[</span><span class="op" id="137211">:</span><span class="ident" id="137212"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="137215">.</span><span class="ident" id="137216"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="137225">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="137228">if</span>&nbsp;<span class="ident" id="137231">_</span><span class="op" id="137232">,</span>&nbsp;<span class="ident" id="137234">err</span>&nbsp;<span class="op" id="137238">:=</span>&nbsp;<span class="ident" id="137241"><a href="/gostd/crypto/cipher/example_test.go.html#133670">io</a></span><span class="op" id="137243">.</span><span class="ident" id="137244"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="137252">(</span><span class="ident" id="137253"><a href="/gostd/crypto/cipher/example_test.go.html#133632">rand</a></span><span class="op" id="137257">.</span><span class="ident" id="137258"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="137264">,</span>&nbsp;<span class="ident" id="137266"><a href="/gostd/crypto/cipher/example_test.go.html#137194">iv</a></span><span class="op" id="137268">)</span><span class="op" id="137269">;</span>&nbsp;<span class="ident" id="137271"><a href="/gostd/crypto/cipher/example_test.go.html#137234">err</a></span>&nbsp;<span class="op" id="137275">!=</span>&nbsp;<span class="builtintype" id="137278">nil</span>&nbsp;<span class="op" id="137282">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="137286">panic</span><span class="op" id="137291">(</span><span class="ident" id="137292"><a href="/gostd/crypto/cipher/example_test.go.html#137234">err</a></span><span class="op" id="137295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="137298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="137302">stream</span>&nbsp;<span class="op" id="137309">:=</span>&nbsp;<span class="ident" id="137312"><a href="/gostd/crypto/cipher/example_test.go.html#133615">cipher</a></span><span class="op" id="137318">.</span><span class="ident" id="137319"><a href="/gostd/crypto/cipher/cfb.go.html#4409296">NewCFBEncrypter</a></span><span class="op" id="137334">(</span><span class="ident" id="137335"><a href="/gostd/crypto/cipher/example_test.go.html#136945">block</a></span><span class="op" id="137340">,</span>&nbsp;<span class="ident" id="137342"><a href="/gostd/crypto/cipher/example_test.go.html#137194">iv</a></span><span class="op" id="137344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="137347"><a href="/gostd/crypto/cipher/example_test.go.html#137302">stream</a></span><span class="op" id="137353">.</span><span class="ident" id="137354"><a href="/gostd/crypto/cipher/cipher.go.html#4411241">XORKeyStream</a></span><span class="op" id="137366">(</span><span class="ident" id="137367"><a href="/gostd/crypto/cipher/example_test.go.html#137136">ciphertext</a></span><span class="op" id="137377">[</span><span class="ident" id="137378"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="137381">.</span><span class="ident" id="137382"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="137391">:</span><span class="op" id="137392">]</span><span class="op" id="137393">,</span>&nbsp;<span class="ident" id="137395"><a href="/gostd/crypto/cipher/example_test.go.html#136905">plaintext</a></span><span class="op" id="137404">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="137408">//&nbsp;It&#39;s&nbsp;important&nbsp;to&nbsp;remember&nbsp;that&nbsp;ciphertexts&nbsp;must&nbsp;be&nbsp;authenticated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="137478">//&nbsp;(i.e.&nbsp;by&nbsp;using&nbsp;crypto/hmac)&nbsp;as&nbsp;well&nbsp;as&nbsp;being&nbsp;encrypted&nbsp;in&nbsp;order&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="137549">//&nbsp;be&nbsp;secure.</span><br>
<span class="lineno"></span><span class="op" id="137563">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="137566">func</span>&nbsp;<span class="ident" id="137571">ExampleNewCTR</span><span class="op" id="137584">(</span><span class="op" id="137585">)</span>&nbsp;<span class="op" id="137587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="137590">key</span>&nbsp;<span class="op" id="137594">:=</span>&nbsp;<span class="op" id="137597">[</span><span class="op" id="137598">]</span><span class="builtintype" id="137599">byte</span><span class="op" id="137603">(</span><span class="string" id="137604">&#34;example&nbsp;key&nbsp;1234&#34;</span><span class="op" id="137622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="137625">plaintext</span>&nbsp;<span class="op" id="137635">:=</span>&nbsp;<span class="op" id="137638">[</span><span class="op" id="137639">]</span><span class="builtintype" id="137640">byte</span><span class="op" id="137644">(</span><span class="string" id="137645">&#34;some&nbsp;plaintext&#34;</span><span class="op" id="137661">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="137665">block</span><span class="op" id="137670">,</span>&nbsp;<span class="ident" id="137672">err</span>&nbsp;<span class="op" id="137676">:=</span>&nbsp;<span class="ident" id="137679"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="137682">.</span><span class="ident" id="137683"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="137692">(</span><span class="ident" id="137693"><a href="/gostd/crypto/cipher/example_test.go.html#137590">key</a></span><span class="op" id="137696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="137699">if</span>&nbsp;<span class="ident" id="137702"><a href="/gostd/crypto/cipher/example_test.go.html#137672">err</a></span>&nbsp;<span class="op" id="137706">!=</span>&nbsp;<span class="builtintype" id="137709">nil</span>&nbsp;<span class="op" id="137713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="137717">panic</span><span class="op" id="137722">(</span><span class="ident" id="137723"><a href="/gostd/crypto/cipher/example_test.go.html#137672">err</a></span><span class="op" id="137726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="137729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="137733">//&nbsp;The&nbsp;IV&nbsp;needs&nbsp;to&nbsp;be&nbsp;unique,&nbsp;but&nbsp;not&nbsp;secure.&nbsp;Therefore&nbsp;it&#39;s&nbsp;common&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="137805">//&nbsp;include&nbsp;it&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;ciphertext.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="137856">ciphertext</span>&nbsp;<span class="op" id="137867">:=</span>&nbsp;<span class="builtinfunc" id="137870">make</span><span class="op" id="137874">(</span><span class="op" id="137875">[</span><span class="op" id="137876">]</span><span class="builtintype" id="137877">byte</span><span class="op" id="137881">,</span>&nbsp;<span class="ident" id="137883"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="137886">.</span><span class="ident" id="137887"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="137896">+</span><span class="builtinfunc" id="137897">len</span><span class="op" id="137900">(</span><span class="ident" id="137901"><a href="/gostd/crypto/cipher/example_test.go.html#137625">plaintext</a></span><span class="op" id="137910">)</span><span class="op" id="137911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="137914">iv</span>&nbsp;<span class="op" id="137917">:=</span>&nbsp;<span class="ident" id="137920"><a href="/gostd/crypto/cipher/example_test.go.html#137856">ciphertext</a></span><span class="op" id="137930">[</span><span class="op" id="137931">:</span><span class="ident" id="137932"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="137935">.</span><span class="ident" id="137936"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="137945">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="137948">if</span>&nbsp;<span class="ident" id="137951">_</span><span class="op" id="137952">,</span>&nbsp;<span class="ident" id="137954">err</span>&nbsp;<span class="op" id="137958">:=</span>&nbsp;<span class="ident" id="137961"><a href="/gostd/crypto/cipher/example_test.go.html#133670">io</a></span><span class="op" id="137963">.</span><span class="ident" id="137964"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="137972">(</span><span class="ident" id="137973"><a href="/gostd/crypto/cipher/example_test.go.html#133632">rand</a></span><span class="op" id="137977">.</span><span class="ident" id="137978"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="137984">,</span>&nbsp;<span class="ident" id="137986"><a href="/gostd/crypto/cipher/example_test.go.html#137914">iv</a></span><span class="op" id="137988">)</span><span class="op" id="137989">;</span>&nbsp;<span class="ident" id="137991"><a href="/gostd/crypto/cipher/example_test.go.html#137954">err</a></span>&nbsp;<span class="op" id="137995">!=</span>&nbsp;<span class="builtintype" id="137998">nil</span>&nbsp;<span class="op" id="138002">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="138006">panic</span><span class="op" id="138011">(</span><span class="ident" id="138012"><a href="/gostd/crypto/cipher/example_test.go.html#137954">err</a></span><span class="op" id="138015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="138018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="138022">stream</span>&nbsp;<span class="op" id="138029">:=</span>&nbsp;<span class="ident" id="138032"><a href="/gostd/crypto/cipher/example_test.go.html#133615">cipher</a></span><span class="op" id="138038">.</span><span class="ident" id="138039"><a href="/gostd/crypto/cipher/ctr.go.html#4412419">NewCTR</a></span><span class="op" id="138045">(</span><span class="ident" id="138046"><a href="/gostd/crypto/cipher/example_test.go.html#137665">block</a></span><span class="op" id="138051">,</span>&nbsp;<span class="ident" id="138053"><a href="/gostd/crypto/cipher/example_test.go.html#137914">iv</a></span><span class="op" id="138055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="138058"><a href="/gostd/crypto/cipher/example_test.go.html#138022">stream</a></span><span class="op" id="138064">.</span><span class="ident" id="138065"><a href="/gostd/crypto/cipher/cipher.go.html#4411241">XORKeyStream</a></span><span class="op" id="138077">(</span><span class="ident" id="138078"><a href="/gostd/crypto/cipher/example_test.go.html#137856">ciphertext</a></span><span class="op" id="138088">[</span><span class="ident" id="138089"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="138092">.</span><span class="ident" id="138093"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="138102">:</span><span class="op" id="138103">]</span><span class="op" id="138104">,</span>&nbsp;<span class="ident" id="138106"><a href="/gostd/crypto/cipher/example_test.go.html#137625">plaintext</a></span><span class="op" id="138115">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="138119">//&nbsp;It&#39;s&nbsp;important&nbsp;to&nbsp;remember&nbsp;that&nbsp;ciphertexts&nbsp;must&nbsp;be&nbsp;authenticated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="138189">//&nbsp;(i.e.&nbsp;by&nbsp;using&nbsp;crypto/hmac)&nbsp;as&nbsp;well&nbsp;as&nbsp;being&nbsp;encrypted&nbsp;in&nbsp;order&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="138260">//&nbsp;be&nbsp;secure.</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="138276">//&nbsp;CTR&nbsp;mode&nbsp;is&nbsp;the&nbsp;same&nbsp;for&nbsp;both&nbsp;encryption&nbsp;and&nbsp;decryption,&nbsp;so&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="138347">//&nbsp;also&nbsp;decrypt&nbsp;that&nbsp;ciphertext&nbsp;with&nbsp;NewCTR.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="138394">plaintext2</span>&nbsp;<span class="op" id="138405">:=</span>&nbsp;<span class="builtinfunc" id="138408">make</span><span class="op" id="138412">(</span><span class="op" id="138413">[</span><span class="op" id="138414">]</span><span class="builtintype" id="138415">byte</span><span class="op" id="138419">,</span>&nbsp;<span class="builtinfunc" id="138421">len</span><span class="op" id="138424">(</span><span class="ident" id="138425"><a href="/gostd/crypto/cipher/example_test.go.html#137625">plaintext</a></span><span class="op" id="138434">)</span><span class="op" id="138435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="138438"><a href="/gostd/crypto/cipher/example_test.go.html#138022">stream</a></span>&nbsp;<span class="op" id="138445">=</span>&nbsp;<span class="ident" id="138447"><a href="/gostd/crypto/cipher/example_test.go.html#133615">cipher</a></span><span class="op" id="138453">.</span><span class="ident" id="138454"><a href="/gostd/crypto/cipher/ctr.go.html#4412419">NewCTR</a></span><span class="op" id="138460">(</span><span class="ident" id="138461"><a href="/gostd/crypto/cipher/example_test.go.html#137665">block</a></span><span class="op" id="138466">,</span>&nbsp;<span class="ident" id="138468"><a href="/gostd/crypto/cipher/example_test.go.html#137914">iv</a></span><span class="op" id="138470">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="138473"><a href="/gostd/crypto/cipher/example_test.go.html#138022">stream</a></span><span class="op" id="138479">.</span><span class="ident" id="138480"><a href="/gostd/crypto/cipher/cipher.go.html#4411241">XORKeyStream</a></span><span class="op" id="138492">(</span><span class="ident" id="138493"><a href="/gostd/crypto/cipher/example_test.go.html#138394">plaintext2</a></span><span class="op" id="138503">,</span>&nbsp;<span class="ident" id="138505"><a href="/gostd/crypto/cipher/example_test.go.html#137856">ciphertext</a></span><span class="op" id="138515">[</span><span class="ident" id="138516"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="138519">.</span><span class="ident" id="138520"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="138529">:</span><span class="op" id="138530">]</span><span class="op" id="138531">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="138535"><a href="/gostd/crypto/cipher/example_test.go.html#133663">fmt</a></span><span class="op" id="138538">.</span><span class="ident" id="138539"><a href="/gostd/fmt/print.go.html#2143442">Printf</a></span><span class="op" id="138545">(</span><span class="string" id="138546">&#34;%s\n&#34;</span><span class="op" id="138552">,</span>&nbsp;<span class="ident" id="138554"><a href="/gostd/crypto/cipher/example_test.go.html#138394">plaintext2</a></span><span class="op" id="138564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="138567">//&nbsp;Output:&nbsp;some&nbsp;plaintext</span><br>
<span class="lineno"></span><span class="op" id="138593">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="138596">func</span>&nbsp;<span class="ident" id="138601">ExampleNewOFB</span><span class="op" id="138614">(</span><span class="op" id="138615">)</span>&nbsp;<span class="op" id="138617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="138620">key</span>&nbsp;<span class="op" id="138624">:=</span>&nbsp;<span class="op" id="138627">[</span><span class="op" id="138628">]</span><span class="builtintype" id="138629">byte</span><span class="op" id="138633">(</span><span class="string" id="138634">&#34;example&nbsp;key&nbsp;1234&#34;</span><span class="op" id="138652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="138655">plaintext</span>&nbsp;<span class="op" id="138665">:=</span>&nbsp;<span class="op" id="138668">[</span><span class="op" id="138669">]</span><span class="builtintype" id="138670">byte</span><span class="op" id="138674">(</span><span class="string" id="138675">&#34;some&nbsp;plaintext&#34;</span><span class="op" id="138691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="138695">block</span><span class="op" id="138700">,</span>&nbsp;<span class="ident" id="138702">err</span>&nbsp;<span class="op" id="138706">:=</span>&nbsp;<span class="ident" id="138709"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="138712">.</span><span class="ident" id="138713"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="138722">(</span><span class="ident" id="138723"><a href="/gostd/crypto/cipher/example_test.go.html#138620">key</a></span><span class="op" id="138726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="138729">if</span>&nbsp;<span class="ident" id="138732"><a href="/gostd/crypto/cipher/example_test.go.html#138702">err</a></span>&nbsp;<span class="op" id="138736">!=</span>&nbsp;<span class="builtintype" id="138739">nil</span>&nbsp;<span class="op" id="138743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="138747">panic</span><span class="op" id="138752">(</span><span class="ident" id="138753"><a href="/gostd/crypto/cipher/example_test.go.html#138702">err</a></span><span class="op" id="138756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="138759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="138763">//&nbsp;The&nbsp;IV&nbsp;needs&nbsp;to&nbsp;be&nbsp;unique,&nbsp;but&nbsp;not&nbsp;secure.&nbsp;Therefore&nbsp;it&#39;s&nbsp;common&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="138835">//&nbsp;include&nbsp;it&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;ciphertext.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="138886">ciphertext</span>&nbsp;<span class="op" id="138897">:=</span>&nbsp;<span class="builtinfunc" id="138900">make</span><span class="op" id="138904">(</span><span class="op" id="138905">[</span><span class="op" id="138906">]</span><span class="builtintype" id="138907">byte</span><span class="op" id="138911">,</span>&nbsp;<span class="ident" id="138913"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="138916">.</span><span class="ident" id="138917"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="138926">+</span><span class="builtinfunc" id="138927">len</span><span class="op" id="138930">(</span><span class="ident" id="138931"><a href="/gostd/crypto/cipher/example_test.go.html#138655">plaintext</a></span><span class="op" id="138940">)</span><span class="op" id="138941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="138944">iv</span>&nbsp;<span class="op" id="138947">:=</span>&nbsp;<span class="ident" id="138950"><a href="/gostd/crypto/cipher/example_test.go.html#138886">ciphertext</a></span><span class="op" id="138960">[</span><span class="op" id="138961">:</span><span class="ident" id="138962"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="138965">.</span><span class="ident" id="138966"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="138975">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="138978">if</span>&nbsp;<span class="ident" id="138981">_</span><span class="op" id="138982">,</span>&nbsp;<span class="ident" id="138984">err</span>&nbsp;<span class="op" id="138988">:=</span>&nbsp;<span class="ident" id="138991"><a href="/gostd/crypto/cipher/example_test.go.html#133670">io</a></span><span class="op" id="138993">.</span><span class="ident" id="138994"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="139002">(</span><span class="ident" id="139003"><a href="/gostd/crypto/cipher/example_test.go.html#133632">rand</a></span><span class="op" id="139007">.</span><span class="ident" id="139008"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="139014">,</span>&nbsp;<span class="ident" id="139016"><a href="/gostd/crypto/cipher/example_test.go.html#138944">iv</a></span><span class="op" id="139018">)</span><span class="op" id="139019">;</span>&nbsp;<span class="ident" id="139021"><a href="/gostd/crypto/cipher/example_test.go.html#138984">err</a></span>&nbsp;<span class="op" id="139025">!=</span>&nbsp;<span class="builtintype" id="139028">nil</span>&nbsp;<span class="op" id="139032">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="139036">panic</span><span class="op" id="139041">(</span><span class="ident" id="139042"><a href="/gostd/crypto/cipher/example_test.go.html#138984">err</a></span><span class="op" id="139045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="139048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="139052">stream</span>&nbsp;<span class="op" id="139059">:=</span>&nbsp;<span class="ident" id="139062"><a href="/gostd/crypto/cipher/example_test.go.html#133615">cipher</a></span><span class="op" id="139068">.</span><span class="ident" id="139069"><a href="/gostd/crypto/cipher/ofb.go.html#4425187">NewOFB</a></span><span class="op" id="139075">(</span><span class="ident" id="139076"><a href="/gostd/crypto/cipher/example_test.go.html#138695">block</a></span><span class="op" id="139081">,</span>&nbsp;<span class="ident" id="139083"><a href="/gostd/crypto/cipher/example_test.go.html#138944">iv</a></span><span class="op" id="139085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="139088"><a href="/gostd/crypto/cipher/example_test.go.html#139052">stream</a></span><span class="op" id="139094">.</span><span class="ident" id="139095"><a href="/gostd/crypto/cipher/cipher.go.html#4411241">XORKeyStream</a></span><span class="op" id="139107">(</span><span class="ident" id="139108"><a href="/gostd/crypto/cipher/example_test.go.html#138886">ciphertext</a></span><span class="op" id="139118">[</span><span class="ident" id="139119"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="139122">.</span><span class="ident" id="139123"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="139132">:</span><span class="op" id="139133">]</span><span class="op" id="139134">,</span>&nbsp;<span class="ident" id="139136"><a href="/gostd/crypto/cipher/example_test.go.html#138655">plaintext</a></span><span class="op" id="139145">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="139149">//&nbsp;It&#39;s&nbsp;important&nbsp;to&nbsp;remember&nbsp;that&nbsp;ciphertexts&nbsp;must&nbsp;be&nbsp;authenticated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="139219">//&nbsp;(i.e.&nbsp;by&nbsp;using&nbsp;crypto/hmac)&nbsp;as&nbsp;well&nbsp;as&nbsp;being&nbsp;encrypted&nbsp;in&nbsp;order&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="139290">//&nbsp;be&nbsp;secure.</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="139306">//&nbsp;OFB&nbsp;mode&nbsp;is&nbsp;the&nbsp;same&nbsp;for&nbsp;both&nbsp;encryption&nbsp;and&nbsp;decryption,&nbsp;so&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="139377">//&nbsp;also&nbsp;decrypt&nbsp;that&nbsp;ciphertext&nbsp;with&nbsp;NewOFB.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="139424">plaintext2</span>&nbsp;<span class="op" id="139435">:=</span>&nbsp;<span class="builtinfunc" id="139438">make</span><span class="op" id="139442">(</span><span class="op" id="139443">[</span><span class="op" id="139444">]</span><span class="builtintype" id="139445">byte</span><span class="op" id="139449">,</span>&nbsp;<span class="builtinfunc" id="139451">len</span><span class="op" id="139454">(</span><span class="ident" id="139455"><a href="/gostd/crypto/cipher/example_test.go.html#138655">plaintext</a></span><span class="op" id="139464">)</span><span class="op" id="139465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="139468"><a href="/gostd/crypto/cipher/example_test.go.html#139052">stream</a></span>&nbsp;<span class="op" id="139475">=</span>&nbsp;<span class="ident" id="139477"><a href="/gostd/crypto/cipher/example_test.go.html#133615">cipher</a></span><span class="op" id="139483">.</span><span class="ident" id="139484"><a href="/gostd/crypto/cipher/ofb.go.html#4425187">NewOFB</a></span><span class="op" id="139490">(</span><span class="ident" id="139491"><a href="/gostd/crypto/cipher/example_test.go.html#138695">block</a></span><span class="op" id="139496">,</span>&nbsp;<span class="ident" id="139498"><a href="/gostd/crypto/cipher/example_test.go.html#138944">iv</a></span><span class="op" id="139500">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="139503"><a href="/gostd/crypto/cipher/example_test.go.html#139052">stream</a></span><span class="op" id="139509">.</span><span class="ident" id="139510"><a href="/gostd/crypto/cipher/cipher.go.html#4411241">XORKeyStream</a></span><span class="op" id="139522">(</span><span class="ident" id="139523"><a href="/gostd/crypto/cipher/example_test.go.html#139424">plaintext2</a></span><span class="op" id="139533">,</span>&nbsp;<span class="ident" id="139535"><a href="/gostd/crypto/cipher/example_test.go.html#138886">ciphertext</a></span><span class="op" id="139545">[</span><span class="ident" id="139546"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="139549">.</span><span class="ident" id="139550"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="139559">:</span><span class="op" id="139560">]</span><span class="op" id="139561">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="139565"><a href="/gostd/crypto/cipher/example_test.go.html#133663">fmt</a></span><span class="op" id="139568">.</span><span class="ident" id="139569"><a href="/gostd/fmt/print.go.html#2143442">Printf</a></span><span class="op" id="139575">(</span><span class="string" id="139576">&#34;%s\n&#34;</span><span class="op" id="139582">,</span>&nbsp;<span class="ident" id="139584"><a href="/gostd/crypto/cipher/example_test.go.html#139424">plaintext2</a></span><span class="op" id="139594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="139597">//&nbsp;Output:&nbsp;some&nbsp;plaintext</span><br>
<span class="lineno"></span><span class="op" id="139623">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="139626">func</span>&nbsp;<span class="ident" id="139631">ExampleStreamReader</span><span class="op" id="139650">(</span><span class="op" id="139651">)</span>&nbsp;<span class="op" id="139653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="139656">key</span>&nbsp;<span class="op" id="139660">:=</span>&nbsp;<span class="op" id="139663">[</span><span class="op" id="139664">]</span><span class="builtintype" id="139665">byte</span><span class="op" id="139669">(</span><span class="string" id="139670">&#34;example&nbsp;key&nbsp;1234&#34;</span><span class="op" id="139688">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="139692">inFile</span><span class="op" id="139698">,</span>&nbsp;<span class="ident" id="139700">err</span>&nbsp;<span class="op" id="139704">:=</span>&nbsp;<span class="ident" id="139707"><a href="/gostd/crypto/cipher/example_test.go.html#133676">os</a></span><span class="op" id="139709">.</span><span class="ident" id="139710"><a href="/gostd/os/file.go.html#2446863">Open</a></span><span class="op" id="139714">(</span><span class="string" id="139715">&#34;encrypted-file&#34;</span><span class="op" id="139731">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="139734">if</span>&nbsp;<span class="ident" id="139737"><a href="/gostd/crypto/cipher/example_test.go.html#139700">err</a></span>&nbsp;<span class="op" id="139741">!=</span>&nbsp;<span class="builtintype" id="139744">nil</span>&nbsp;<span class="op" id="139748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="139752">panic</span><span class="op" id="139757">(</span><span class="ident" id="139758"><a href="/gostd/crypto/cipher/example_test.go.html#139700">err</a></span><span class="op" id="139761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="139764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="139767">defer</span>&nbsp;<span class="ident" id="139773"><a href="/gostd/crypto/cipher/example_test.go.html#139692">inFile</a></span><span class="op" id="139779">.</span><span class="ident" id="139780"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="139785">(</span><span class="op" id="139786">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="139790">block</span><span class="op" id="139795">,</span>&nbsp;<span class="ident" id="139797"><a href="/gostd/crypto/cipher/example_test.go.html#139700">err</a></span>&nbsp;<span class="op" id="139801">:=</span>&nbsp;<span class="ident" id="139804"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="139807">.</span><span class="ident" id="139808"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="139817">(</span><span class="ident" id="139818"><a href="/gostd/crypto/cipher/example_test.go.html#139656">key</a></span><span class="op" id="139821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="139824">if</span>&nbsp;<span class="ident" id="139827"><a href="/gostd/crypto/cipher/example_test.go.html#139700">err</a></span>&nbsp;<span class="op" id="139831">!=</span>&nbsp;<span class="builtintype" id="139834">nil</span>&nbsp;<span class="op" id="139838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="139842">panic</span><span class="op" id="139847">(</span><span class="ident" id="139848"><a href="/gostd/crypto/cipher/example_test.go.html#139700">err</a></span><span class="op" id="139851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="139854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="139858">//&nbsp;If&nbsp;the&nbsp;key&nbsp;is&nbsp;unique&nbsp;for&nbsp;each&nbsp;ciphertext,&nbsp;then&nbsp;it&#39;s&nbsp;ok&nbsp;to&nbsp;use&nbsp;a&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="139931">//&nbsp;IV.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="139939">var</span>&nbsp;<span class="ident" id="139943">iv</span>&nbsp;<span class="op" id="139946">[</span><span class="ident" id="139947"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="139950">.</span><span class="ident" id="139951"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="139960">]</span><span class="builtintype" id="139961">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="139967">stream</span>&nbsp;<span class="op" id="139974">:=</span>&nbsp;<span class="ident" id="139977"><a href="/gostd/crypto/cipher/example_test.go.html#133615">cipher</a></span><span class="op" id="139983">.</span><span class="ident" id="139984"><a href="/gostd/crypto/cipher/ofb.go.html#4425187">NewOFB</a></span><span class="op" id="139990">(</span><span class="ident" id="139991"><a href="/gostd/crypto/cipher/example_test.go.html#139790">block</a></span><span class="op" id="139996">,</span>&nbsp;<span class="ident" id="139998"><a href="/gostd/crypto/cipher/example_test.go.html#139943">iv</a></span><span class="op" id="140000">[</span><span class="op" id="140001">:</span><span class="op" id="140002">]</span><span class="op" id="140003">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="140007">outFile</span><span class="op" id="140014">,</span>&nbsp;<span class="ident" id="140016"><a href="/gostd/crypto/cipher/example_test.go.html#139700">err</a></span>&nbsp;<span class="op" id="140020">:=</span>&nbsp;<span class="ident" id="140023"><a href="/gostd/crypto/cipher/example_test.go.html#133676">os</a></span><span class="op" id="140025">.</span><span class="ident" id="140026"><a href="/gostd/os/file_unix.go.html#2454095">OpenFile</a></span><span class="op" id="140034">(</span><span class="string" id="140035">&#34;decrypted-file&#34;</span><span class="op" id="140051">,</span>&nbsp;<span class="ident" id="140053"><a href="/gostd/crypto/cipher/example_test.go.html#133676">os</a></span><span class="op" id="140055">.</span><span class="ident" id="140056"><a href="/gostd/os/file.go.html#2442115">O_WRONLY</a></span><span class="op" id="140064">|</span><span class="ident" id="140065"><a href="/gostd/crypto/cipher/example_test.go.html#133676">os</a></span><span class="op" id="140067">.</span><span class="ident" id="140068"><a href="/gostd/os/file.go.html#2442313">O_CREATE</a></span><span class="op" id="140076">|</span><span class="ident" id="140077"><a href="/gostd/crypto/cipher/example_test.go.html#133676">os</a></span><span class="op" id="140079">.</span><span class="ident" id="140080"><a href="/gostd/os/file.go.html#2442521">O_TRUNC</a></span><span class="op" id="140087">,</span>&nbsp;<span class="num" id="140089">0600</span><span class="op" id="140093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="140096">if</span>&nbsp;<span class="ident" id="140099"><a href="/gostd/crypto/cipher/example_test.go.html#139700">err</a></span>&nbsp;<span class="op" id="140103">!=</span>&nbsp;<span class="builtintype" id="140106">nil</span>&nbsp;<span class="op" id="140110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="140114">panic</span><span class="op" id="140119">(</span><span class="ident" id="140120"><a href="/gostd/crypto/cipher/example_test.go.html#139700">err</a></span><span class="op" id="140123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="140126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="140129">defer</span>&nbsp;<span class="ident" id="140135"><a href="/gostd/crypto/cipher/example_test.go.html#140007">outFile</a></span><span class="op" id="140142">.</span><span class="ident" id="140143"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="140148">(</span><span class="op" id="140149">)</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="140153">reader</span>&nbsp;<span class="op" id="140160">:=</span>&nbsp;<span class="op" id="140163">&amp;</span><span class="ident" id="140164"><a href="/gostd/crypto/cipher/example_test.go.html#133615">cipher</a></span><span class="op" id="140170">.</span><span class="ident" id="140171"><a href="/gostd/crypto/cipher/io.go.html#4423639">StreamReader</a></span><span class="op" id="140183">{</span><span class="ident" id="140184"><a href="/gostd/crypto/cipher/io.go.html#4423662">S</a></span><span class="op" id="140185">:</span>&nbsp;<span class="ident" id="140187"><a href="/gostd/crypto/cipher/example_test.go.html#139967">stream</a></span><span class="op" id="140193">,</span>&nbsp;<span class="ident" id="140195"><a href="/gostd/crypto/cipher/io.go.html#4423672">R</a></span><span class="op" id="140196">:</span>&nbsp;<span class="ident" id="140198"><a href="/gostd/crypto/cipher/example_test.go.html#139692">inFile</a></span><span class="op" id="140204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="140207">//&nbsp;Copy&nbsp;the&nbsp;input&nbsp;file&nbsp;to&nbsp;the&nbsp;output&nbsp;file,&nbsp;decrypting&nbsp;as&nbsp;we&nbsp;go.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="140272">if</span>&nbsp;<span class="ident" id="140275">_</span><span class="op" id="140276">,</span>&nbsp;<span class="ident" id="140278">err</span>&nbsp;<span class="op" id="140282">:=</span>&nbsp;<span class="ident" id="140285"><a href="/gostd/crypto/cipher/example_test.go.html#133670">io</a></span><span class="op" id="140287">.</span><span class="ident" id="140288"><a href="/gostd/io/io.go.html#1430946">Copy</a></span><span class="op" id="140292">(</span><span class="ident" id="140293"><a href="/gostd/crypto/cipher/example_test.go.html#140007">outFile</a></span><span class="op" id="140300">,</span>&nbsp;<span class="ident" id="140302"><a href="/gostd/crypto/cipher/example_test.go.html#140153">reader</a></span><span class="op" id="140308">)</span><span class="op" id="140309">;</span>&nbsp;<span class="ident" id="140311"><a href="/gostd/crypto/cipher/example_test.go.html#140278">err</a></span>&nbsp;<span class="op" id="140315">!=</span>&nbsp;<span class="builtintype" id="140318">nil</span>&nbsp;<span class="op" id="140322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="140326">panic</span><span class="op" id="140331">(</span><span class="ident" id="140332"><a href="/gostd/crypto/cipher/example_test.go.html#140278">err</a></span><span class="op" id="140335">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="140338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="140342">//&nbsp;Note&nbsp;that&nbsp;this&nbsp;example&nbsp;is&nbsp;simplistic&nbsp;in&nbsp;that&nbsp;it&nbsp;omits&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="140404">//&nbsp;authentication&nbsp;of&nbsp;the&nbsp;encrypted&nbsp;data.&nbsp;If&nbsp;you&nbsp;were&nbsp;actually&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="140474">//&nbsp;StreamReader&nbsp;in&nbsp;this&nbsp;manner,&nbsp;an&nbsp;attacker&nbsp;could&nbsp;flip&nbsp;arbitrary&nbsp;bits&nbsp;in</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="140548">//&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="op" id="140563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="140566">func</span>&nbsp;<span class="ident" id="140571">ExampleStreamWriter</span><span class="op" id="140590">(</span><span class="op" id="140591">)</span>&nbsp;<span class="op" id="140593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="140596">key</span>&nbsp;<span class="op" id="140600">:=</span>&nbsp;<span class="op" id="140603">[</span><span class="op" id="140604">]</span><span class="builtintype" id="140605">byte</span><span class="op" id="140609">(</span><span class="string" id="140610">&#34;example&nbsp;key&nbsp;1234&#34;</span><span class="op" id="140628">)</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="140632">inFile</span><span class="op" id="140638">,</span>&nbsp;<span class="ident" id="140640">err</span>&nbsp;<span class="op" id="140644">:=</span>&nbsp;<span class="ident" id="140647"><a href="/gostd/crypto/cipher/example_test.go.html#133676">os</a></span><span class="op" id="140649">.</span><span class="ident" id="140650"><a href="/gostd/os/file.go.html#2446863">Open</a></span><span class="op" id="140654">(</span><span class="string" id="140655">&#34;plaintext-file&#34;</span><span class="op" id="140671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="140674">if</span>&nbsp;<span class="ident" id="140677"><a href="/gostd/crypto/cipher/example_test.go.html#140640">err</a></span>&nbsp;<span class="op" id="140681">!=</span>&nbsp;<span class="builtintype" id="140684">nil</span>&nbsp;<span class="op" id="140688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="140692">panic</span><span class="op" id="140697">(</span><span class="ident" id="140698"><a href="/gostd/crypto/cipher/example_test.go.html#140640">err</a></span><span class="op" id="140701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="140704">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="140707">defer</span>&nbsp;<span class="ident" id="140713"><a href="/gostd/crypto/cipher/example_test.go.html#140632">inFile</a></span><span class="op" id="140719">.</span><span class="ident" id="140720"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="140725">(</span><span class="op" id="140726">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="140730">block</span><span class="op" id="140735">,</span>&nbsp;<span class="ident" id="140737"><a href="/gostd/crypto/cipher/example_test.go.html#140640">err</a></span>&nbsp;<span class="op" id="140741">:=</span>&nbsp;<span class="ident" id="140744"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="140747">.</span><span class="ident" id="140748"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="140757">(</span><span class="ident" id="140758"><a href="/gostd/crypto/cipher/example_test.go.html#140596">key</a></span><span class="op" id="140761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="140764">if</span>&nbsp;<span class="ident" id="140767"><a href="/gostd/crypto/cipher/example_test.go.html#140640">err</a></span>&nbsp;<span class="op" id="140771">!=</span>&nbsp;<span class="builtintype" id="140774">nil</span>&nbsp;<span class="op" id="140778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="140782">panic</span><span class="op" id="140787">(</span><span class="ident" id="140788"><a href="/gostd/crypto/cipher/example_test.go.html#140640">err</a></span><span class="op" id="140791">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="140794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="140798">//&nbsp;If&nbsp;the&nbsp;key&nbsp;is&nbsp;unique&nbsp;for&nbsp;each&nbsp;ciphertext,&nbsp;then&nbsp;it&#39;s&nbsp;ok&nbsp;to&nbsp;use&nbsp;a&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="140871">//&nbsp;IV.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="140879">var</span>&nbsp;<span class="ident" id="140883">iv</span>&nbsp;<span class="op" id="140886">[</span><span class="ident" id="140887"><a href="/gostd/crypto/cipher/example_test.go.html#133601">aes</a></span><span class="op" id="140890">.</span><span class="ident" id="140891"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="140900">]</span><span class="builtintype" id="140901">byte</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="140907">stream</span>&nbsp;<span class="op" id="140914">:=</span>&nbsp;<span class="ident" id="140917"><a href="/gostd/crypto/cipher/example_test.go.html#133615">cipher</a></span><span class="op" id="140923">.</span><span class="ident" id="140924"><a href="/gostd/crypto/cipher/ofb.go.html#4425187">NewOFB</a></span><span class="op" id="140930">(</span><span class="ident" id="140931"><a href="/gostd/crypto/cipher/example_test.go.html#140730">block</a></span><span class="op" id="140936">,</span>&nbsp;<span class="ident" id="140938"><a href="/gostd/crypto/cipher/example_test.go.html#140883">iv</a></span><span class="op" id="140940">[</span><span class="op" id="140941">:</span><span class="op" id="140942">]</span><span class="op" id="140943">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="140947">outFile</span><span class="op" id="140954">,</span>&nbsp;<span class="ident" id="140956"><a href="/gostd/crypto/cipher/example_test.go.html#140640">err</a></span>&nbsp;<span class="op" id="140960">:=</span>&nbsp;<span class="ident" id="140963"><a href="/gostd/crypto/cipher/example_test.go.html#133676">os</a></span><span class="op" id="140965">.</span><span class="ident" id="140966"><a href="/gostd/os/file_unix.go.html#2454095">OpenFile</a></span><span class="op" id="140974">(</span><span class="string" id="140975">&#34;encrypted-file&#34;</span><span class="op" id="140991">,</span>&nbsp;<span class="ident" id="140993"><a href="/gostd/crypto/cipher/example_test.go.html#133676">os</a></span><span class="op" id="140995">.</span><span class="ident" id="140996"><a href="/gostd/os/file.go.html#2442115">O_WRONLY</a></span><span class="op" id="141004">|</span><span class="ident" id="141005"><a href="/gostd/crypto/cipher/example_test.go.html#133676">os</a></span><span class="op" id="141007">.</span><span class="ident" id="141008"><a href="/gostd/os/file.go.html#2442313">O_CREATE</a></span><span class="op" id="141016">|</span><span class="ident" id="141017"><a href="/gostd/crypto/cipher/example_test.go.html#133676">os</a></span><span class="op" id="141019">.</span><span class="ident" id="141020"><a href="/gostd/os/file.go.html#2442521">O_TRUNC</a></span><span class="op" id="141027">,</span>&nbsp;<span class="num" id="141029">0600</span><span class="op" id="141033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="141036">if</span>&nbsp;<span class="ident" id="141039"><a href="/gostd/crypto/cipher/example_test.go.html#140640">err</a></span>&nbsp;<span class="op" id="141043">!=</span>&nbsp;<span class="builtintype" id="141046">nil</span>&nbsp;<span class="op" id="141050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="141054">panic</span><span class="op" id="141059">(</span><span class="ident" id="141060"><a href="/gostd/crypto/cipher/example_test.go.html#140640">err</a></span><span class="op" id="141063">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="141066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="141069">defer</span>&nbsp;<span class="ident" id="141075"><a href="/gostd/crypto/cipher/example_test.go.html#140947">outFile</a></span><span class="op" id="141082">.</span><span class="ident" id="141083"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="141088">(</span><span class="op" id="141089">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="141093">writer</span>&nbsp;<span class="op" id="141100">:=</span>&nbsp;<span class="op" id="141103">&amp;</span><span class="ident" id="141104"><a href="/gostd/crypto/cipher/example_test.go.html#133615">cipher</a></span><span class="op" id="141110">.</span><span class="ident" id="141111"><a href="/gostd/crypto/cipher/io.go.html#4424147">StreamWriter</a></span><span class="op" id="141123">{</span><span class="ident" id="141124"><a href="/gostd/crypto/cipher/io.go.html#4424170">S</a></span><span class="op" id="141125">:</span>&nbsp;<span class="ident" id="141127"><a href="/gostd/crypto/cipher/example_test.go.html#140907">stream</a></span><span class="op" id="141133">,</span>&nbsp;<span class="ident" id="141135"><a href="/gostd/crypto/cipher/io.go.html#4424182">W</a></span><span class="op" id="141136">:</span>&nbsp;<span class="ident" id="141138"><a href="/gostd/crypto/cipher/example_test.go.html#140947">outFile</a></span><span class="op" id="141145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="141148">//&nbsp;Copy&nbsp;the&nbsp;input&nbsp;file&nbsp;to&nbsp;the&nbsp;output&nbsp;file,&nbsp;encrypting&nbsp;as&nbsp;we&nbsp;go.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="141213">if</span>&nbsp;<span class="ident" id="141216">_</span><span class="op" id="141217">,</span>&nbsp;<span class="ident" id="141219">err</span>&nbsp;<span class="op" id="141223">:=</span>&nbsp;<span class="ident" id="141226"><a href="/gostd/crypto/cipher/example_test.go.html#133670">io</a></span><span class="op" id="141228">.</span><span class="ident" id="141229"><a href="/gostd/io/io.go.html#1430946">Copy</a></span><span class="op" id="141233">(</span><span class="ident" id="141234"><a href="/gostd/crypto/cipher/example_test.go.html#141093">writer</a></span><span class="op" id="141240">,</span>&nbsp;<span class="ident" id="141242"><a href="/gostd/crypto/cipher/example_test.go.html#140632">inFile</a></span><span class="op" id="141248">)</span><span class="op" id="141249">;</span>&nbsp;<span class="ident" id="141251"><a href="/gostd/crypto/cipher/example_test.go.html#141219">err</a></span>&nbsp;<span class="op" id="141255">!=</span>&nbsp;<span class="builtintype" id="141258">nil</span>&nbsp;<span class="op" id="141262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="141266">panic</span><span class="op" id="141271">(</span><span class="ident" id="141272"><a href="/gostd/crypto/cipher/example_test.go.html#141219">err</a></span><span class="op" id="141275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="141278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="141282">//&nbsp;Note&nbsp;that&nbsp;this&nbsp;example&nbsp;is&nbsp;simplistic&nbsp;in&nbsp;that&nbsp;it&nbsp;omits&nbsp;any</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="141344">//&nbsp;authentication&nbsp;of&nbsp;the&nbsp;encrypted&nbsp;data.&nbsp;If&nbsp;you&nbsp;were&nbsp;actually&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="141414">//&nbsp;StreamReader&nbsp;in&nbsp;this&nbsp;manner,&nbsp;an&nbsp;attacker&nbsp;could&nbsp;flip&nbsp;arbitrary&nbsp;bits&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="141488">//&nbsp;the&nbsp;decrypted&nbsp;result.</span><br>
<span class="lineno"></span><span class="op" id="141513">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
