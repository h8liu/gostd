<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6223471">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6223527">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6223581">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6223632">package</span>&nbsp;<span class="ident" id="6223640">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6223647">import</span>&nbsp;<span class="op" id="6223654">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6223657">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6223666">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6223676">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="6223681">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6223684">type</span>&nbsp;<span class="ident" id="6223689">importReader</span>&nbsp;<span class="keyword" id="6223702">struct</span>&nbsp;<span class="op" id="6223709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6223712">b</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6223717">*</span><span class="ident" id="6223718">bufio</span><span class="op" id="6223723">.</span><span class="ident" id="6223724">Reader</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6223732">buf</span>&nbsp;&nbsp;<span class="op" id="6223737">[</span><span class="op" id="6223738">]</span><span class="builtintype" id="6223739">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6223745">peek</span>&nbsp;<span class="builtintype" id="6223750">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6223756">err</span>&nbsp;&nbsp;<span class="builtintype" id="6223761">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6223768">eof</span>&nbsp;&nbsp;<span class="builtintype" id="6223773">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6223779">nerr</span>&nbsp;<span class="builtintype" id="6223784">int</span><br>
<span class="lineno">20</span><span class="op" id="6223788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6223791">func</span>&nbsp;<span class="ident" id="6223796">isIdent</span><span class="op" id="6223803">(</span><span class="ident" id="6223804">c</span>&nbsp;<span class="builtintype" id="6223806">byte</span><span class="op" id="6223810">)</span>&nbsp;<span class="builtintype" id="6223812">bool</span>&nbsp;<span class="op" id="6223817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6223820">return</span>&nbsp;<span class="string" id="6223827">&#39;A&#39;</span>&nbsp;<span class="op" id="6223831">&lt;=</span>&nbsp;<span class="ident" id="6223834">c</span>&nbsp;<span class="op" id="6223836">&amp;&amp;</span>&nbsp;<span class="ident" id="6223839">c</span>&nbsp;<span class="op" id="6223841">&lt;=</span>&nbsp;<span class="string" id="6223844">&#39;Z&#39;</span>&nbsp;<span class="op" id="6223848">||</span>&nbsp;<span class="string" id="6223851">&#39;a&#39;</span>&nbsp;<span class="op" id="6223855">&lt;=</span>&nbsp;<span class="ident" id="6223858">c</span>&nbsp;<span class="op" id="6223860">&amp;&amp;</span>&nbsp;<span class="ident" id="6223863">c</span>&nbsp;<span class="op" id="6223865">&lt;=</span>&nbsp;<span class="string" id="6223868">&#39;z&#39;</span>&nbsp;<span class="op" id="6223872">||</span>&nbsp;<span class="string" id="6223875">&#39;0&#39;</span>&nbsp;<span class="op" id="6223879">&lt;=</span>&nbsp;<span class="ident" id="6223882">c</span>&nbsp;<span class="op" id="6223884">&amp;&amp;</span>&nbsp;<span class="ident" id="6223887">c</span>&nbsp;<span class="op" id="6223889">&lt;=</span>&nbsp;<span class="string" id="6223892">&#39;9&#39;</span>&nbsp;<span class="op" id="6223896">||</span>&nbsp;<span class="ident" id="6223899">c</span>&nbsp;<span class="op" id="6223901">==</span>&nbsp;<span class="string" id="6223904">&#39;_&#39;</span>&nbsp;<span class="op" id="6223908">||</span>&nbsp;<span class="ident" id="6223911">c</span>&nbsp;<span class="op" id="6223913">&gt;=</span>&nbsp;<span class="num" id="6223916">0x80</span><br>
<span class="lineno"></span><span class="op" id="6223921">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6223924">var</span>&nbsp;<span class="op" id="6223928">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6223931">errSyntax</span>&nbsp;<span class="op" id="6223941">=</span>&nbsp;<span class="ident" id="6223943">errors</span><span class="op" id="6223949">.</span><span class="ident" id="6223950">New</span><span class="op" id="6223953">(</span><span class="string" id="6223954">&#34;syntax&nbsp;error&#34;</span><span class="op" id="6223968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6223971">errNUL</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6223981">=</span>&nbsp;<span class="ident" id="6223983">errors</span><span class="op" id="6223989">.</span><span class="ident" id="6223990">New</span><span class="op" id="6223993">(</span><span class="string" id="6223994">&#34;unexpected&nbsp;NUL&nbsp;in&nbsp;input&#34;</span><span class="op" id="6224019">)</span><br>
<span class="lineno"></span><span class="op" id="6224021">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6224024">//&nbsp;syntaxError&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;but&nbsp;only&nbsp;if&nbsp;an&nbsp;I/O&nbsp;error&nbsp;has&nbsp;not&nbsp;already&nbsp;been&nbsp;recorded.</span><br>
<span class="lineno"></span><span class="keyword" id="6224119">func</span>&nbsp;<span class="op" id="6224124">(</span><span class="ident" id="6224125">r</span>&nbsp;<span class="op" id="6224127">*</span><span class="ident" id="6224128">importReader</span><span class="op" id="6224140">)</span>&nbsp;<span class="ident" id="6224142">syntaxError</span><span class="op" id="6224153">(</span><span class="op" id="6224154">)</span>&nbsp;<span class="op" id="6224156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224159">if</span>&nbsp;<span class="ident" id="6224162">r</span><span class="op" id="6224163">.</span><span class="ident" id="6224164">err</span>&nbsp;<span class="op" id="6224168">==</span>&nbsp;<span class="ident" id="6224171">nil</span>&nbsp;<span class="op" id="6224175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224179">r</span><span class="op" id="6224180">.</span><span class="ident" id="6224181">err</span>&nbsp;<span class="op" id="6224185">=</span>&nbsp;<span class="ident" id="6224187">errSyntax</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6224198">}</span><br>
<span class="lineno"></span><span class="op" id="6224200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6224203">//&nbsp;readByte&nbsp;reads&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;saves&nbsp;it&nbsp;in&nbsp;buf,&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6224284">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;readByte&nbsp;records&nbsp;the&nbsp;error&nbsp;in&nbsp;r.err&nbsp;and&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="keyword" id="6224358">func</span>&nbsp;<span class="op" id="6224363">(</span><span class="ident" id="6224364">r</span>&nbsp;<span class="op" id="6224366">*</span><span class="ident" id="6224367">importReader</span><span class="op" id="6224379">)</span>&nbsp;<span class="ident" id="6224381">readByte</span><span class="op" id="6224389">(</span><span class="op" id="6224390">)</span>&nbsp;<span class="builtintype" id="6224392">byte</span>&nbsp;<span class="op" id="6224397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224400">c</span><span class="op" id="6224401">,</span>&nbsp;<span class="ident" id="6224403">err</span>&nbsp;<span class="op" id="6224407">:=</span>&nbsp;<span class="ident" id="6224410">r</span><span class="op" id="6224411">.</span><span class="ident" id="6224412">b</span><span class="op" id="6224413">.</span><span class="ident" id="6224414">ReadByte</span><span class="op" id="6224422">(</span><span class="op" id="6224423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224426">if</span>&nbsp;<span class="ident" id="6224429">err</span>&nbsp;<span class="op" id="6224433">==</span>&nbsp;<span class="ident" id="6224436">nil</span>&nbsp;<span class="op" id="6224440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224444">r</span><span class="op" id="6224445">.</span><span class="ident" id="6224446">buf</span>&nbsp;<span class="op" id="6224450">=</span>&nbsp;<span class="builtinfunc" id="6224452">append</span><span class="op" id="6224458">(</span><span class="ident" id="6224459">r</span><span class="op" id="6224460">.</span><span class="ident" id="6224461">buf</span><span class="op" id="6224464">,</span>&nbsp;<span class="ident" id="6224466">c</span><span class="op" id="6224467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224471">if</span>&nbsp;<span class="ident" id="6224474">c</span>&nbsp;<span class="op" id="6224476">==</span>&nbsp;<span class="num" id="6224479">0</span>&nbsp;<span class="op" id="6224481">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224486">err</span>&nbsp;<span class="op" id="6224490">=</span>&nbsp;<span class="ident" id="6224492">errNUL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6224501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6224504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224507">if</span>&nbsp;<span class="ident" id="6224510">err</span>&nbsp;<span class="op" id="6224514">!=</span>&nbsp;<span class="ident" id="6224517">nil</span>&nbsp;<span class="op" id="6224521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224525">if</span>&nbsp;<span class="ident" id="6224528">err</span>&nbsp;<span class="op" id="6224532">==</span>&nbsp;<span class="ident" id="6224535">io</span><span class="op" id="6224537">.</span><span class="ident" id="6224538">EOF</span>&nbsp;<span class="op" id="6224542">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224547">r</span><span class="op" id="6224548">.</span><span class="ident" id="6224549">eof</span>&nbsp;<span class="op" id="6224553">=</span>&nbsp;<span class="builtintype" id="6224555">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6224562">}</span>&nbsp;<span class="keyword" id="6224564">else</span>&nbsp;<span class="keyword" id="6224569">if</span>&nbsp;<span class="ident" id="6224572">r</span><span class="op" id="6224573">.</span><span class="ident" id="6224574">err</span>&nbsp;<span class="op" id="6224578">==</span>&nbsp;<span class="ident" id="6224581">nil</span>&nbsp;<span class="op" id="6224585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224590">r</span><span class="op" id="6224591">.</span><span class="ident" id="6224592">err</span>&nbsp;<span class="op" id="6224596">=</span>&nbsp;<span class="ident" id="6224598">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6224604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224608">c</span>&nbsp;<span class="op" id="6224610">=</span>&nbsp;<span class="num" id="6224612">0</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6224615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224618">return</span>&nbsp;<span class="ident" id="6224625">c</span><br>
<span class="lineno"></span><span class="op" id="6224627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6224630">//&nbsp;peekByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input&nbsp;reader&nbsp;but&nbsp;does&nbsp;not&nbsp;advance&nbsp;beyond&nbsp;it.</span><br>
<span class="lineno">60</span><span class="comment" id="6224718">//&nbsp;If&nbsp;skipSpace&nbsp;is&nbsp;set,&nbsp;peekByte&nbsp;skips&nbsp;leading&nbsp;spaces&nbsp;and&nbsp;comments.</span><br>
<span class="lineno"></span><span class="keyword" id="6224786">func</span>&nbsp;<span class="op" id="6224791">(</span><span class="ident" id="6224792">r</span>&nbsp;<span class="op" id="6224794">*</span><span class="ident" id="6224795">importReader</span><span class="op" id="6224807">)</span>&nbsp;<span class="ident" id="6224809">peekByte</span><span class="op" id="6224817">(</span><span class="ident" id="6224818">skipSpace</span>&nbsp;<span class="builtintype" id="6224828">bool</span><span class="op" id="6224832">)</span>&nbsp;<span class="builtintype" id="6224834">byte</span>&nbsp;<span class="op" id="6224839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224842">if</span>&nbsp;<span class="ident" id="6224845">r</span><span class="op" id="6224846">.</span><span class="ident" id="6224847">err</span>&nbsp;<span class="op" id="6224851">!=</span>&nbsp;<span class="ident" id="6224854">nil</span>&nbsp;<span class="op" id="6224858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224862">if</span>&nbsp;<span class="ident" id="6224865">r</span><span class="op" id="6224866">.</span><span class="ident" id="6224867">nerr</span><span class="op" id="6224871">++</span><span class="op" id="6224873">;</span>&nbsp;<span class="ident" id="6224875">r</span><span class="op" id="6224876">.</span><span class="ident" id="6224877">nerr</span>&nbsp;<span class="op" id="6224882">&gt;</span>&nbsp;<span class="num" id="6224884">10000</span>&nbsp;<span class="op" id="6224890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6224895">panic</span><span class="op" id="6224900">(</span><span class="string" id="6224901">&#34;go/build:&nbsp;import&nbsp;reader&nbsp;looping&#34;</span><span class="op" id="6224934">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6224938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224942">return</span>&nbsp;<span class="num" id="6224949">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6224952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6224956">//&nbsp;Use&nbsp;r.peek&nbsp;as&nbsp;first&nbsp;input&nbsp;byte.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6224992">//&nbsp;Don&#39;t&nbsp;just&nbsp;return&nbsp;r.peek&nbsp;here:&nbsp;it&nbsp;might&nbsp;have&nbsp;been&nbsp;left&nbsp;by&nbsp;peekByte(false)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6225070">//&nbsp;and&nbsp;this&nbsp;might&nbsp;be&nbsp;peekByte(true).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6225108">c</span>&nbsp;<span class="op" id="6225110">:=</span>&nbsp;<span class="ident" id="6225113">r</span><span class="op" id="6225114">.</span><span class="ident" id="6225115">peek</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225121">if</span>&nbsp;<span class="ident" id="6225124">c</span>&nbsp;<span class="op" id="6225126">==</span>&nbsp;<span class="num" id="6225129">0</span>&nbsp;<span class="op" id="6225131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6225135">c</span>&nbsp;<span class="op" id="6225137">=</span>&nbsp;<span class="ident" id="6225139">r</span><span class="op" id="6225140">.</span><span class="ident" id="6225141">readByte</span><span class="op" id="6225149">(</span><span class="op" id="6225150">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6225153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225156">for</span>&nbsp;<span class="ident" id="6225160">r</span><span class="op" id="6225161">.</span><span class="ident" id="6225162">err</span>&nbsp;<span class="op" id="6225166">==</span>&nbsp;<span class="ident" id="6225169">nil</span>&nbsp;<span class="op" id="6225173">&amp;&amp;</span>&nbsp;<span class="op" id="6225176">!</span><span class="ident" id="6225177">r</span><span class="op" id="6225178">.</span><span class="ident" id="6225179">eof</span>&nbsp;<span class="op" id="6225183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225187">if</span>&nbsp;<span class="ident" id="6225190">skipSpace</span>&nbsp;<span class="op" id="6225200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6225205">//&nbsp;For&nbsp;the&nbsp;purposes&nbsp;of&nbsp;this&nbsp;reader,&nbsp;semicolons&nbsp;are&nbsp;never&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6225278">//&nbsp;understand&nbsp;the&nbsp;input&nbsp;and&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225332">switch</span>&nbsp;<span class="ident" id="6225339">c</span>&nbsp;<span class="op" id="6225341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225346">case</span>&nbsp;<span class="string" id="6225351">&#39;&nbsp;&#39;</span><span class="op" id="6225354">,</span>&nbsp;<span class="string" id="6225356">&#39;\f&#39;</span><span class="op" id="6225360">,</span>&nbsp;<span class="string" id="6225362">&#39;\t&#39;</span><span class="op" id="6225366">,</span>&nbsp;<span class="string" id="6225368">&#39;\r&#39;</span><span class="op" id="6225372">,</span>&nbsp;<span class="string" id="6225374">&#39;\n&#39;</span><span class="op" id="6225378">,</span>&nbsp;<span class="string" id="6225380">&#39;;&#39;</span><span class="op" id="6225383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6225389">c</span>&nbsp;<span class="op" id="6225391">=</span>&nbsp;<span class="ident" id="6225393">r</span><span class="op" id="6225394">.</span><span class="ident" id="6225395">readByte</span><span class="op" id="6225403">(</span><span class="op" id="6225404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225410">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225423">case</span>&nbsp;<span class="string" id="6225428">&#39;/&#39;</span><span class="op" id="6225431">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6225437">c</span>&nbsp;<span class="op" id="6225439">=</span>&nbsp;<span class="ident" id="6225441">r</span><span class="op" id="6225442">.</span><span class="ident" id="6225443">readByte</span><span class="op" id="6225451">(</span><span class="op" id="6225452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225458">if</span>&nbsp;<span class="ident" id="6225461">c</span>&nbsp;<span class="op" id="6225463">==</span>&nbsp;<span class="string" id="6225466">&#39;/&#39;</span>&nbsp;<span class="op" id="6225470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225477">for</span>&nbsp;<span class="ident" id="6225481">c</span>&nbsp;<span class="op" id="6225483">!=</span>&nbsp;<span class="string" id="6225486">&#39;\n&#39;</span>&nbsp;<span class="op" id="6225491">&amp;&amp;</span>&nbsp;<span class="ident" id="6225494">r</span><span class="op" id="6225495">.</span><span class="ident" id="6225496">err</span>&nbsp;<span class="op" id="6225500">==</span>&nbsp;<span class="ident" id="6225503">nil</span>&nbsp;<span class="op" id="6225507">&amp;&amp;</span>&nbsp;<span class="op" id="6225510">!</span><span class="ident" id="6225511">r</span><span class="op" id="6225512">.</span><span class="ident" id="6225513">eof</span>&nbsp;<span class="op" id="6225517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6225525">c</span>&nbsp;<span class="op" id="6225527">=</span>&nbsp;<span class="ident" id="6225529">r</span><span class="op" id="6225530">.</span><span class="ident" id="6225531">readByte</span><span class="op" id="6225539">(</span><span class="op" id="6225540">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6225547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6225553">}</span>&nbsp;<span class="keyword" id="6225555">else</span>&nbsp;<span class="keyword" id="6225560">if</span>&nbsp;<span class="ident" id="6225563">c</span>&nbsp;<span class="op" id="6225565">==</span>&nbsp;<span class="string" id="6225568">&#39;*&#39;</span>&nbsp;<span class="op" id="6225572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225579">var</span>&nbsp;<span class="ident" id="6225583">c1</span>&nbsp;<span class="builtintype" id="6225586">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225596">for</span>&nbsp;<span class="op" id="6225600">(</span><span class="ident" id="6225601">c</span>&nbsp;<span class="op" id="6225603">!=</span>&nbsp;<span class="string" id="6225606">&#39;*&#39;</span>&nbsp;<span class="op" id="6225610">||</span>&nbsp;<span class="ident" id="6225613">c1</span>&nbsp;<span class="op" id="6225616">!=</span>&nbsp;<span class="string" id="6225619">&#39;/&#39;</span><span class="op" id="6225622">)</span>&nbsp;<span class="op" id="6225624">&amp;&amp;</span>&nbsp;<span class="ident" id="6225627">r</span><span class="op" id="6225628">.</span><span class="ident" id="6225629">err</span>&nbsp;<span class="op" id="6225633">==</span>&nbsp;<span class="ident" id="6225636">nil</span>&nbsp;<span class="op" id="6225640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225648">if</span>&nbsp;<span class="ident" id="6225651">r</span><span class="op" id="6225652">.</span><span class="ident" id="6225653">eof</span>&nbsp;<span class="op" id="6225657">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6225666">r</span><span class="op" id="6225667">.</span><span class="ident" id="6225668">syntaxError</span><span class="op" id="6225679">(</span><span class="op" id="6225680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6225688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6225696">c</span><span class="op" id="6225697">,</span>&nbsp;<span class="ident" id="6225699">c1</span>&nbsp;<span class="op" id="6225702">=</span>&nbsp;<span class="ident" id="6225704">c1</span><span class="op" id="6225706">,</span>&nbsp;<span class="ident" id="6225708">r</span><span class="op" id="6225709">.</span><span class="ident" id="6225710">readByte</span><span class="op" id="6225718">(</span><span class="op" id="6225719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6225726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6225732">}</span>&nbsp;<span class="keyword" id="6225734">else</span>&nbsp;<span class="op" id="6225739">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6225746">r</span><span class="op" id="6225747">.</span><span class="ident" id="6225748">syntaxError</span><span class="op" id="6225759">(</span><span class="op" id="6225760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6225766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6225772">c</span>&nbsp;<span class="op" id="6225774">=</span>&nbsp;<span class="ident" id="6225776">r</span><span class="op" id="6225777">.</span><span class="ident" id="6225778">readByte</span><span class="op" id="6225786">(</span><span class="op" id="6225787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225793">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6225805">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6225809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225813">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6225820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6225823">r</span><span class="op" id="6225824">.</span><span class="ident" id="6225825">peek</span>&nbsp;<span class="op" id="6225830">=</span>&nbsp;<span class="ident" id="6225832">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6225835">return</span>&nbsp;<span class="ident" id="6225842">r</span><span class="op" id="6225843">.</span><span class="ident" id="6225844">peek</span><br>
<span class="lineno">110</span><span class="op" id="6225849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6225852">//&nbsp;nextByte&nbsp;is&nbsp;like&nbsp;peekByte&nbsp;but&nbsp;advances&nbsp;beyond&nbsp;the&nbsp;returned&nbsp;byte.</span><br>
<span class="lineno"></span><span class="keyword" id="6225920">func</span>&nbsp;<span class="op" id="6225925">(</span><span class="ident" id="6225926">r</span>&nbsp;<span class="op" id="6225928">*</span><span class="ident" id="6225929">importReader</span><span class="op" id="6225941">)</span>&nbsp;<span class="ident" id="6225943">nextByte</span><span class="op" id="6225951">(</span><span class="ident" id="6225952">skipSpace</span>&nbsp;<span class="builtintype" id="6225962">bool</span><span class="op" id="6225966">)</span>&nbsp;<span class="builtintype" id="6225968">byte</span>&nbsp;<span class="op" id="6225973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6225976">c</span>&nbsp;<span class="op" id="6225978">:=</span>&nbsp;<span class="ident" id="6225981">r</span><span class="op" id="6225982">.</span><span class="ident" id="6225983">peekByte</span><span class="op" id="6225991">(</span><span class="ident" id="6225992">skipSpace</span><span class="op" id="6226001">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226004">r</span><span class="op" id="6226005">.</span><span class="ident" id="6226006">peek</span>&nbsp;<span class="op" id="6226011">=</span>&nbsp;<span class="num" id="6226013">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226016">return</span>&nbsp;<span class="ident" id="6226023">c</span><br>
<span class="lineno"></span><span class="op" id="6226025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6226028">//&nbsp;readKeyword&nbsp;reads&nbsp;the&nbsp;given&nbsp;keyword&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">120</span><span class="comment" id="6226083">//&nbsp;If&nbsp;the&nbsp;keyword&nbsp;is&nbsp;not&nbsp;present,&nbsp;readKeyword&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6226153">func</span>&nbsp;<span class="op" id="6226158">(</span><span class="ident" id="6226159">r</span>&nbsp;<span class="op" id="6226161">*</span><span class="ident" id="6226162">importReader</span><span class="op" id="6226174">)</span>&nbsp;<span class="ident" id="6226176">readKeyword</span><span class="op" id="6226187">(</span><span class="ident" id="6226188">kw</span>&nbsp;<span class="builtintype" id="6226191">string</span><span class="op" id="6226197">)</span>&nbsp;<span class="op" id="6226199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226202">r</span><span class="op" id="6226203">.</span><span class="ident" id="6226204">peekByte</span><span class="op" id="6226212">(</span><span class="builtintype" id="6226213">true</span><span class="op" id="6226217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226220">for</span>&nbsp;<span class="ident" id="6226224">i</span>&nbsp;<span class="op" id="6226226">:=</span>&nbsp;<span class="num" id="6226229">0</span><span class="op" id="6226230">;</span>&nbsp;<span class="ident" id="6226232">i</span>&nbsp;<span class="op" id="6226234">&lt;</span>&nbsp;<span class="builtinfunc" id="6226236">len</span><span class="op" id="6226239">(</span><span class="ident" id="6226240">kw</span><span class="op" id="6226242">)</span><span class="op" id="6226243">;</span>&nbsp;<span class="ident" id="6226245">i</span><span class="op" id="6226246">++</span>&nbsp;<span class="op" id="6226249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226253">if</span>&nbsp;<span class="ident" id="6226256">r</span><span class="op" id="6226257">.</span><span class="ident" id="6226258">nextByte</span><span class="op" id="6226266">(</span><span class="builtintype" id="6226267">false</span><span class="op" id="6226272">)</span>&nbsp;<span class="op" id="6226274">!=</span>&nbsp;<span class="ident" id="6226277">kw</span><span class="op" id="6226279">[</span><span class="ident" id="6226280">i</span><span class="op" id="6226281">]</span>&nbsp;<span class="op" id="6226283">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226288">r</span><span class="op" id="6226289">.</span><span class="ident" id="6226290">syntaxError</span><span class="op" id="6226301">(</span><span class="op" id="6226302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226307">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226322">if</span>&nbsp;<span class="ident" id="6226325">isIdent</span><span class="op" id="6226332">(</span><span class="ident" id="6226333">r</span><span class="op" id="6226334">.</span><span class="ident" id="6226335">peekByte</span><span class="op" id="6226343">(</span><span class="builtintype" id="6226344">false</span><span class="op" id="6226349">)</span><span class="op" id="6226350">)</span>&nbsp;<span class="op" id="6226352">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226356">r</span><span class="op" id="6226357">.</span><span class="ident" id="6226358">syntaxError</span><span class="op" id="6226369">(</span><span class="op" id="6226370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226373">}</span><br>
<span class="lineno"></span><span class="op" id="6226375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6226378">//&nbsp;readIdent&nbsp;reads&nbsp;an&nbsp;identifier&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">135</span><span class="comment" id="6226427">//&nbsp;If&nbsp;an&nbsp;identifier&nbsp;is&nbsp;not&nbsp;present,&nbsp;readIdent&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6226497">func</span>&nbsp;<span class="op" id="6226502">(</span><span class="ident" id="6226503">r</span>&nbsp;<span class="op" id="6226505">*</span><span class="ident" id="6226506">importReader</span><span class="op" id="6226518">)</span>&nbsp;<span class="ident" id="6226520">readIdent</span><span class="op" id="6226529">(</span><span class="op" id="6226530">)</span>&nbsp;<span class="op" id="6226532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226535">c</span>&nbsp;<span class="op" id="6226537">:=</span>&nbsp;<span class="ident" id="6226540">r</span><span class="op" id="6226541">.</span><span class="ident" id="6226542">peekByte</span><span class="op" id="6226550">(</span><span class="builtintype" id="6226551">true</span><span class="op" id="6226555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226558">if</span>&nbsp;<span class="op" id="6226561">!</span><span class="ident" id="6226562">isIdent</span><span class="op" id="6226569">(</span><span class="ident" id="6226570">c</span><span class="op" id="6226571">)</span>&nbsp;<span class="op" id="6226573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226577">r</span><span class="op" id="6226578">.</span><span class="ident" id="6226579">syntaxError</span><span class="op" id="6226590">(</span><span class="op" id="6226591">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226595">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226606">for</span>&nbsp;<span class="ident" id="6226610">isIdent</span><span class="op" id="6226617">(</span><span class="ident" id="6226618">r</span><span class="op" id="6226619">.</span><span class="ident" id="6226620">peekByte</span><span class="op" id="6226628">(</span><span class="builtintype" id="6226629">false</span><span class="op" id="6226634">)</span><span class="op" id="6226635">)</span>&nbsp;<span class="op" id="6226637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226641">r</span><span class="op" id="6226642">.</span><span class="ident" id="6226643">peek</span>&nbsp;<span class="op" id="6226648">=</span>&nbsp;<span class="num" id="6226650">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226653">}</span><br>
<span class="lineno">145</span><span class="op" id="6226655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6226658">//&nbsp;readString&nbsp;reads&nbsp;a&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="6226718">//&nbsp;If&nbsp;an&nbsp;identifier&nbsp;is&nbsp;not&nbsp;present,&nbsp;readString&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6226789">func</span>&nbsp;<span class="op" id="6226794">(</span><span class="ident" id="6226795">r</span>&nbsp;<span class="op" id="6226797">*</span><span class="ident" id="6226798">importReader</span><span class="op" id="6226810">)</span>&nbsp;<span class="ident" id="6226812">readString</span><span class="op" id="6226822">(</span><span class="op" id="6226823">)</span>&nbsp;<span class="op" id="6226825">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226828">switch</span>&nbsp;<span class="ident" id="6226835">r</span><span class="op" id="6226836">.</span><span class="ident" id="6226837">nextByte</span><span class="op" id="6226845">(</span><span class="builtintype" id="6226846">true</span><span class="op" id="6226850">)</span>&nbsp;<span class="op" id="6226852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226855">case</span>&nbsp;<span class="string" id="6226860">&#39;`&#39;</span><span class="op" id="6226863">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226867">for</span>&nbsp;<span class="ident" id="6226871">r</span><span class="op" id="6226872">.</span><span class="ident" id="6226873">err</span>&nbsp;<span class="op" id="6226877">==</span>&nbsp;<span class="ident" id="6226880">nil</span>&nbsp;<span class="op" id="6226884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226889">if</span>&nbsp;<span class="ident" id="6226892">r</span><span class="op" id="6226893">.</span><span class="ident" id="6226894">nextByte</span><span class="op" id="6226902">(</span><span class="builtintype" id="6226903">false</span><span class="op" id="6226908">)</span>&nbsp;<span class="op" id="6226910">==</span>&nbsp;<span class="string" id="6226913">&#39;`&#39;</span>&nbsp;<span class="op" id="6226917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226923">break</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226937">if</span>&nbsp;<span class="ident" id="6226940">r</span><span class="op" id="6226941">.</span><span class="ident" id="6226942">eof</span>&nbsp;<span class="op" id="6226946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226952">r</span><span class="op" id="6226953">.</span><span class="ident" id="6226954">syntaxError</span><span class="op" id="6226965">(</span><span class="op" id="6226966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226975">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226978">case</span>&nbsp;<span class="string" id="6226983">&#39;&#34;&#39;</span><span class="op" id="6226986">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226990">for</span>&nbsp;<span class="ident" id="6226994">r</span><span class="op" id="6226995">.</span><span class="ident" id="6226996">err</span>&nbsp;<span class="op" id="6227000">==</span>&nbsp;<span class="ident" id="6227003">nil</span>&nbsp;<span class="op" id="6227007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227012">c</span>&nbsp;<span class="op" id="6227014">:=</span>&nbsp;<span class="ident" id="6227017">r</span><span class="op" id="6227018">.</span><span class="ident" id="6227019">nextByte</span><span class="op" id="6227027">(</span><span class="builtintype" id="6227028">false</span><span class="op" id="6227033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6227038">if</span>&nbsp;<span class="ident" id="6227041">c</span>&nbsp;<span class="op" id="6227043">==</span>&nbsp;<span class="string" id="6227046">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6227050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6227056">break</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6227065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6227070">if</span>&nbsp;<span class="ident" id="6227073">r</span><span class="op" id="6227074">.</span><span class="ident" id="6227075">eof</span>&nbsp;<span class="op" id="6227079">||</span>&nbsp;<span class="ident" id="6227082">c</span>&nbsp;<span class="op" id="6227084">==</span>&nbsp;<span class="string" id="6227087">&#39;\n&#39;</span>&nbsp;<span class="op" id="6227092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227098">r</span><span class="op" id="6227099">.</span><span class="ident" id="6227100">syntaxError</span><span class="op" id="6227111">(</span><span class="op" id="6227112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6227117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6227122">if</span>&nbsp;<span class="ident" id="6227125">c</span>&nbsp;<span class="op" id="6227127">==</span>&nbsp;<span class="string" id="6227130">&#39;\\&#39;</span>&nbsp;<span class="op" id="6227135">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227141">r</span><span class="op" id="6227142">.</span><span class="ident" id="6227143">nextByte</span><span class="op" id="6227151">(</span><span class="builtintype" id="6227152">false</span><span class="op" id="6227157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6227162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6227166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6227169">default</span><span class="op" id="6227176">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227180">r</span><span class="op" id="6227181">.</span><span class="ident" id="6227182">syntaxError</span><span class="op" id="6227193">(</span><span class="op" id="6227194">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6227197">}</span><br>
<span class="lineno"></span><span class="op" id="6227199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6227202">//&nbsp;readImport&nbsp;reads&nbsp;an&nbsp;import&nbsp;clause&nbsp;-&nbsp;optional&nbsp;identifier&nbsp;followed&nbsp;by&nbsp;quoted&nbsp;string&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="6227289">//&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">180</span><span class="keyword" id="6227308">func</span>&nbsp;<span class="op" id="6227313">(</span><span class="ident" id="6227314">r</span>&nbsp;<span class="op" id="6227316">*</span><span class="ident" id="6227317">importReader</span><span class="op" id="6227329">)</span>&nbsp;<span class="ident" id="6227331">readImport</span><span class="op" id="6227341">(</span><span class="op" id="6227342">)</span>&nbsp;<span class="op" id="6227344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227347">c</span>&nbsp;<span class="op" id="6227349">:=</span>&nbsp;<span class="ident" id="6227352">r</span><span class="op" id="6227353">.</span><span class="ident" id="6227354">peekByte</span><span class="op" id="6227362">(</span><span class="builtintype" id="6227363">true</span><span class="op" id="6227367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6227370">if</span>&nbsp;<span class="ident" id="6227373">c</span>&nbsp;<span class="op" id="6227375">==</span>&nbsp;<span class="string" id="6227378">&#39;.&#39;</span>&nbsp;<span class="op" id="6227382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227386">r</span><span class="op" id="6227387">.</span><span class="ident" id="6227388">peek</span>&nbsp;<span class="op" id="6227393">=</span>&nbsp;<span class="num" id="6227395">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6227398">}</span>&nbsp;<span class="keyword" id="6227400">else</span>&nbsp;<span class="keyword" id="6227405">if</span>&nbsp;<span class="ident" id="6227408">isIdent</span><span class="op" id="6227415">(</span><span class="ident" id="6227416">c</span><span class="op" id="6227417">)</span>&nbsp;<span class="op" id="6227419">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227423">r</span><span class="op" id="6227424">.</span><span class="ident" id="6227425">readIdent</span><span class="op" id="6227434">(</span><span class="op" id="6227435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6227438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227441">r</span><span class="op" id="6227442">.</span><span class="ident" id="6227443">readString</span><span class="op" id="6227453">(</span><span class="op" id="6227454">)</span><br>
<span class="lineno"></span><span class="op" id="6227456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="6227459">//&nbsp;readComments&nbsp;is&nbsp;like&nbsp;ioutil.ReadAll,&nbsp;except&nbsp;that&nbsp;it&nbsp;only&nbsp;reads&nbsp;the&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="6227537">//&nbsp;block&nbsp;of&nbsp;comments&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6227571">func</span>&nbsp;<span class="ident" id="6227576">readComments</span><span class="op" id="6227588">(</span><span class="ident" id="6227589">f</span>&nbsp;<span class="ident" id="6227591">io</span><span class="op" id="6227593">.</span><span class="ident" id="6227594">Reader</span><span class="op" id="6227600">)</span>&nbsp;<span class="op" id="6227602">(</span><span class="op" id="6227603">[</span><span class="op" id="6227604">]</span><span class="builtintype" id="6227605">byte</span><span class="op" id="6227609">,</span>&nbsp;<span class="builtintype" id="6227611">error</span><span class="op" id="6227616">)</span>&nbsp;<span class="op" id="6227618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227621">r</span>&nbsp;<span class="op" id="6227623">:=</span>&nbsp;<span class="op" id="6227626">&amp;</span><span class="ident" id="6227627">importReader</span><span class="op" id="6227639">{</span><span class="ident" id="6227640">b</span><span class="op" id="6227641">:</span>&nbsp;<span class="ident" id="6227643">bufio</span><span class="op" id="6227648">.</span><span class="ident" id="6227649">NewReader</span><span class="op" id="6227658">(</span><span class="ident" id="6227659">f</span><span class="op" id="6227660">)</span><span class="op" id="6227661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227664">r</span><span class="op" id="6227665">.</span><span class="ident" id="6227666">peekByte</span><span class="op" id="6227674">(</span><span class="builtintype" id="6227675">true</span><span class="op" id="6227679">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6227682">if</span>&nbsp;<span class="ident" id="6227685">r</span><span class="op" id="6227686">.</span><span class="ident" id="6227687">err</span>&nbsp;<span class="op" id="6227691">==</span>&nbsp;<span class="ident" id="6227694">nil</span>&nbsp;<span class="op" id="6227698">&amp;&amp;</span>&nbsp;<span class="op" id="6227701">!</span><span class="ident" id="6227702">r</span><span class="op" id="6227703">.</span><span class="ident" id="6227704">eof</span>&nbsp;<span class="op" id="6227708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227712">//&nbsp;Didn&#39;t&nbsp;reach&nbsp;EOF,&nbsp;so&nbsp;must&nbsp;have&nbsp;found&nbsp;a&nbsp;non-space&nbsp;byte.&nbsp;Remove&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227783">r</span><span class="op" id="6227784">.</span><span class="ident" id="6227785">buf</span>&nbsp;<span class="op" id="6227789">=</span>&nbsp;<span class="ident" id="6227791">r</span><span class="op" id="6227792">.</span><span class="ident" id="6227793">buf</span><span class="op" id="6227796">[</span><span class="op" id="6227797">:</span><span class="builtinfunc" id="6227798">len</span><span class="op" id="6227801">(</span><span class="ident" id="6227802">r</span><span class="op" id="6227803">.</span><span class="ident" id="6227804">buf</span><span class="op" id="6227807">)</span><span class="op" id="6227808">-</span><span class="num" id="6227809">1</span><span class="op" id="6227810">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6227813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6227816">return</span>&nbsp;<span class="ident" id="6227823">r</span><span class="op" id="6227824">.</span><span class="ident" id="6227825">buf</span><span class="op" id="6227828">,</span>&nbsp;<span class="ident" id="6227830">r</span><span class="op" id="6227831">.</span><span class="ident" id="6227832">err</span><br>
<span class="lineno">200</span><span class="op" id="6227836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6227839">//&nbsp;readImports&nbsp;is&nbsp;like&nbsp;ioutil.ReadAll,&nbsp;except&nbsp;that&nbsp;it&nbsp;expects&nbsp;a&nbsp;Go&nbsp;file&nbsp;as&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="6227920">//&nbsp;and&nbsp;stops&nbsp;reading&nbsp;the&nbsp;input&nbsp;once&nbsp;the&nbsp;imports&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="keyword" id="6227984">func</span>&nbsp;<span class="ident" id="6227989">readImports</span><span class="op" id="6228000">(</span><span class="ident" id="6228001">f</span>&nbsp;<span class="ident" id="6228003">io</span><span class="op" id="6228005">.</span><span class="ident" id="6228006">Reader</span><span class="op" id="6228012">,</span>&nbsp;<span class="ident" id="6228014">reportSyntaxError</span>&nbsp;<span class="builtintype" id="6228032">bool</span><span class="op" id="6228036">)</span>&nbsp;<span class="op" id="6228038">(</span><span class="op" id="6228039">[</span><span class="op" id="6228040">]</span><span class="builtintype" id="6228041">byte</span><span class="op" id="6228045">,</span>&nbsp;<span class="builtintype" id="6228047">error</span><span class="op" id="6228052">)</span>&nbsp;<span class="op" id="6228054">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228057">r</span>&nbsp;<span class="op" id="6228059">:=</span>&nbsp;<span class="op" id="6228062">&amp;</span><span class="ident" id="6228063">importReader</span><span class="op" id="6228075">{</span><span class="ident" id="6228076">b</span><span class="op" id="6228077">:</span>&nbsp;<span class="ident" id="6228079">bufio</span><span class="op" id="6228084">.</span><span class="ident" id="6228085">NewReader</span><span class="op" id="6228094">(</span><span class="ident" id="6228095">f</span><span class="op" id="6228096">)</span><span class="op" id="6228097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228101">r</span><span class="op" id="6228102">.</span><span class="ident" id="6228103">readKeyword</span><span class="op" id="6228114">(</span><span class="string" id="6228115">&#34;package&#34;</span><span class="op" id="6228124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228127">r</span><span class="op" id="6228128">.</span><span class="ident" id="6228129">readIdent</span><span class="op" id="6228138">(</span><span class="op" id="6228139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6228142">for</span>&nbsp;<span class="ident" id="6228146">r</span><span class="op" id="6228147">.</span><span class="ident" id="6228148">peekByte</span><span class="op" id="6228156">(</span><span class="builtintype" id="6228157">true</span><span class="op" id="6228161">)</span>&nbsp;<span class="op" id="6228163">==</span>&nbsp;<span class="string" id="6228166">&#39;i&#39;</span>&nbsp;<span class="op" id="6228170">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228174">r</span><span class="op" id="6228175">.</span><span class="ident" id="6228176">readKeyword</span><span class="op" id="6228187">(</span><span class="string" id="6228188">&#34;import&#34;</span><span class="op" id="6228196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6228200">if</span>&nbsp;<span class="ident" id="6228203">r</span><span class="op" id="6228204">.</span><span class="ident" id="6228205">peekByte</span><span class="op" id="6228213">(</span><span class="builtintype" id="6228214">true</span><span class="op" id="6228218">)</span>&nbsp;<span class="op" id="6228220">==</span>&nbsp;<span class="string" id="6228223">&#39;(&#39;</span>&nbsp;<span class="op" id="6228227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228232">r</span><span class="op" id="6228233">.</span><span class="ident" id="6228234">nextByte</span><span class="op" id="6228242">(</span><span class="builtintype" id="6228243">false</span><span class="op" id="6228248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6228253">for</span>&nbsp;<span class="ident" id="6228257">r</span><span class="op" id="6228258">.</span><span class="ident" id="6228259">peekByte</span><span class="op" id="6228267">(</span><span class="builtintype" id="6228268">true</span><span class="op" id="6228272">)</span>&nbsp;<span class="op" id="6228274">!=</span>&nbsp;<span class="string" id="6228277">&#39;)&#39;</span>&nbsp;<span class="op" id="6228281">&amp;&amp;</span>&nbsp;<span class="ident" id="6228284">r</span><span class="op" id="6228285">.</span><span class="ident" id="6228286">err</span>&nbsp;<span class="op" id="6228290">==</span>&nbsp;<span class="ident" id="6228293">nil</span>&nbsp;<span class="op" id="6228297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228303">r</span><span class="op" id="6228304">.</span><span class="ident" id="6228305">readImport</span><span class="op" id="6228315">(</span><span class="op" id="6228316">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6228321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228326">r</span><span class="op" id="6228327">.</span><span class="ident" id="6228328">nextByte</span><span class="op" id="6228336">(</span><span class="builtintype" id="6228337">false</span><span class="op" id="6228342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6228346">}</span>&nbsp;<span class="keyword" id="6228348">else</span>&nbsp;<span class="op" id="6228353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228358">r</span><span class="op" id="6228359">.</span><span class="ident" id="6228360">readImport</span><span class="op" id="6228370">(</span><span class="op" id="6228371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6228375">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6228378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228382">//&nbsp;If&nbsp;we&nbsp;stopped&nbsp;successfully&nbsp;before&nbsp;EOF,&nbsp;we&nbsp;read&nbsp;a&nbsp;byte&nbsp;that&nbsp;told&nbsp;us&nbsp;we&nbsp;were&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228467">//&nbsp;Return&nbsp;all&nbsp;but&nbsp;that&nbsp;last&nbsp;byte,&nbsp;which&nbsp;would&nbsp;cause&nbsp;a&nbsp;syntax&nbsp;error&nbsp;if&nbsp;we&nbsp;let&nbsp;it&nbsp;through.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6228557">if</span>&nbsp;<span class="ident" id="6228560">r</span><span class="op" id="6228561">.</span><span class="ident" id="6228562">err</span>&nbsp;<span class="op" id="6228566">==</span>&nbsp;<span class="ident" id="6228569">nil</span>&nbsp;<span class="op" id="6228573">&amp;&amp;</span>&nbsp;<span class="op" id="6228576">!</span><span class="ident" id="6228577">r</span><span class="op" id="6228578">.</span><span class="ident" id="6228579">eof</span>&nbsp;<span class="op" id="6228583">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6228587">return</span>&nbsp;<span class="ident" id="6228594">r</span><span class="op" id="6228595">.</span><span class="ident" id="6228596">buf</span><span class="op" id="6228599">[</span><span class="op" id="6228600">:</span><span class="builtinfunc" id="6228601">len</span><span class="op" id="6228604">(</span><span class="ident" id="6228605">r</span><span class="op" id="6228606">.</span><span class="ident" id="6228607">buf</span><span class="op" id="6228610">)</span><span class="op" id="6228611">-</span><span class="num" id="6228612">1</span><span class="op" id="6228613">]</span><span class="op" id="6228614">,</span>&nbsp;<span class="ident" id="6228616">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6228621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228625">//&nbsp;If&nbsp;we&nbsp;stopped&nbsp;for&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;consume&nbsp;the&nbsp;whole&nbsp;file&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228694">//&nbsp;we&nbsp;are&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;the&nbsp;errors&nbsp;that&nbsp;go/parser&nbsp;returns.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6228761">if</span>&nbsp;<span class="ident" id="6228764">r</span><span class="op" id="6228765">.</span><span class="ident" id="6228766">err</span>&nbsp;<span class="op" id="6228770">==</span>&nbsp;<span class="ident" id="6228773">errSyntax</span>&nbsp;<span class="op" id="6228783">&amp;&amp;</span>&nbsp;<span class="op" id="6228786">!</span><span class="ident" id="6228787">reportSyntaxError</span>&nbsp;<span class="op" id="6228805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228809">r</span><span class="op" id="6228810">.</span><span class="ident" id="6228811">err</span>&nbsp;<span class="op" id="6228815">=</span>&nbsp;<span class="ident" id="6228817">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6228823">for</span>&nbsp;<span class="ident" id="6228827">r</span><span class="op" id="6228828">.</span><span class="ident" id="6228829">err</span>&nbsp;<span class="op" id="6228833">==</span>&nbsp;<span class="ident" id="6228836">nil</span>&nbsp;<span class="op" id="6228840">&amp;&amp;</span>&nbsp;<span class="op" id="6228843">!</span><span class="ident" id="6228844">r</span><span class="op" id="6228845">.</span><span class="ident" id="6228846">eof</span>&nbsp;<span class="op" id="6228850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228855">r</span><span class="op" id="6228856">.</span><span class="ident" id="6228857">readByte</span><span class="op" id="6228865">(</span><span class="op" id="6228866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6228870">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6228873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6228877">return</span>&nbsp;<span class="ident" id="6228884">r</span><span class="op" id="6228885">.</span><span class="ident" id="6228886">buf</span><span class="op" id="6228889">,</span>&nbsp;<span class="ident" id="6228891">r</span><span class="op" id="6228892">.</span><span class="ident" id="6228893">err</span><br>
<span class="lineno"></span><span class="op" id="6228897">}</span>
</div>
</body>
</html>
