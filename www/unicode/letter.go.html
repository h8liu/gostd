<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2763373">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2763428">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2763482">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2763533">//&nbsp;Package&nbsp;unicode&nbsp;provides&nbsp;data&nbsp;and&nbsp;functions&nbsp;to&nbsp;test&nbsp;some&nbsp;properties&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2763607">//&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="2763631">package</span>&nbsp;<span class="ident" id="2763639">unicode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2763648">//&nbsp;Tables&nbsp;are&nbsp;regenerated&nbsp;each&nbsp;time&nbsp;we&nbsp;update&nbsp;the&nbsp;Unicode&nbsp;version.</span><br>
<span class="lineno">10</span><span class="comment" id="2763715">//go:generate&nbsp;go&nbsp;run&nbsp;maketables.go&nbsp;-tables=all&nbsp;-output&nbsp;tables.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2763781">const</span>&nbsp;<span class="op" id="2763787">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2763790">MaxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2763806">=</span>&nbsp;<span class="string" id="2763808">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="2763821">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2763859">ReplacementChar</span>&nbsp;<span class="op" id="2763875">=</span>&nbsp;<span class="string" id="2763877">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2763890">//&nbsp;Represents&nbsp;invalid&nbsp;code&nbsp;points.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2763926">MaxASCII</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2763942">=</span>&nbsp;<span class="string" id="2763944">&#39;\u007F&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2763957">//&nbsp;maximum&nbsp;ASCII&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2763982">MaxLatin1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2763998">=</span>&nbsp;<span class="string" id="2764000">&#39;\u00FF&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2764013">//&nbsp;maximum&nbsp;Latin-1&nbsp;value.</span><br>
<span class="lineno"></span><span class="op" id="2764039">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2764042">//&nbsp;RangeTable&nbsp;defines&nbsp;a&nbsp;set&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;by&nbsp;listing&nbsp;the&nbsp;ranges&nbsp;of</span><br>
<span class="lineno">20</span><span class="comment" id="2764118">//&nbsp;code&nbsp;points&nbsp;within&nbsp;the&nbsp;set.&nbsp;The&nbsp;ranges&nbsp;are&nbsp;listed&nbsp;in&nbsp;two&nbsp;slices</span><br>
<span class="lineno"></span><span class="comment" id="2764185">//&nbsp;to&nbsp;save&nbsp;space:&nbsp;a&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges&nbsp;and&nbsp;a&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="comment" id="2764258">//&nbsp;The&nbsp;two&nbsp;slices&nbsp;must&nbsp;be&nbsp;in&nbsp;sorted&nbsp;order&nbsp;and&nbsp;non-overlapping.</span><br>
<span class="lineno"></span><span class="comment" id="2764321">//&nbsp;Also,&nbsp;R32&nbsp;should&nbsp;contain&nbsp;only&nbsp;values&nbsp;&gt;=&nbsp;0x10000&nbsp;(1&lt;&lt;16).</span><br>
<span class="lineno"></span><span class="keyword" id="2764381">type</span>&nbsp;<span class="ident" id="2764386">RangeTable</span>&nbsp;<span class="keyword" id="2764397">struct</span>&nbsp;<span class="op" id="2764404">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2764407">R16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2764419">[</span><span class="op" id="2764420">]</span><span class="ident" id="2764421">Range16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2764430">R32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2764442">[</span><span class="op" id="2764443">]</span><span class="ident" id="2764444">Range32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2764453">LatinOffset</span>&nbsp;<span class="builtintype" id="2764465">int</span>&nbsp;<span class="comment" id="2764469">//&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;R16&nbsp;with&nbsp;Hi&nbsp;&lt;=&nbsp;MaxLatin1</span><br>
<span class="lineno"></span><span class="op" id="2764518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="2764521">//&nbsp;Range16&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;16-bit&nbsp;Unicode&nbsp;code&nbsp;points.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno"></span><span class="comment" id="2764615">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.</span><br>
<span class="lineno"></span><span class="keyword" id="2764658">type</span>&nbsp;<span class="ident" id="2764663">Range16</span>&nbsp;<span class="keyword" id="2764671">struct</span>&nbsp;<span class="op" id="2764678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2764681">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2764688">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2764696">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2764703">uint16</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2764711">Stride</span>&nbsp;<span class="builtintype" id="2764718">uint16</span><br>
<span class="lineno"></span><span class="op" id="2764725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2764728">//&nbsp;Range32&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;and&nbsp;is&nbsp;used&nbsp;when&nbsp;one&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2764808">//&nbsp;more&nbsp;of&nbsp;the&nbsp;values&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;16&nbsp;bits.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno">40</span><span class="comment" id="2764885">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.&nbsp;Lo&nbsp;and&nbsp;Hi&nbsp;must&nbsp;always&nbsp;be&nbsp;&gt;=&nbsp;1&lt;&lt;16.</span><br>
<span class="lineno"></span><span class="keyword" id="2764963">type</span>&nbsp;<span class="ident" id="2764968">Range32</span>&nbsp;<span class="keyword" id="2764976">struct</span>&nbsp;<span class="op" id="2764983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2764986">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2764993">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765001">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2765008">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765016">Stride</span>&nbsp;<span class="builtintype" id="2765023">uint32</span><br>
<span class="lineno">45</span><span class="op" id="2765030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2765033">//&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;for&nbsp;simple&nbsp;(one</span><br>
<span class="lineno"></span><span class="comment" id="2765104">//&nbsp;code&nbsp;point&nbsp;to&nbsp;one&nbsp;code&nbsp;point)&nbsp;case&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="2765154">//&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi&nbsp;inclusive,&nbsp;with&nbsp;a&nbsp;fixed&nbsp;stride&nbsp;of&nbsp;1.&nbsp;&nbsp;Deltas</span><br>
<span class="lineno">50</span><span class="comment" id="2765231">//&nbsp;are&nbsp;the&nbsp;number&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;code&nbsp;point&nbsp;to&nbsp;reach&nbsp;the&nbsp;code&nbsp;point&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2765304">//&nbsp;different&nbsp;case&nbsp;for&nbsp;that&nbsp;character.&nbsp;&nbsp;They&nbsp;may&nbsp;be&nbsp;negative.&nbsp;&nbsp;If&nbsp;zero,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2765378">//&nbsp;means&nbsp;the&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;corresponding&nbsp;case.&nbsp;There&nbsp;is&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="2765450">//&nbsp;case&nbsp;representing&nbsp;sequences&nbsp;of&nbsp;alternating&nbsp;corresponding&nbsp;Upper&nbsp;and&nbsp;Lower</span><br>
<span class="lineno"></span><span class="comment" id="2765526">//&nbsp;pairs.&nbsp;&nbsp;It&nbsp;appears&nbsp;with&nbsp;a&nbsp;fixed&nbsp;Delta&nbsp;of</span><br>
<span class="lineno">55</span><span class="comment" id="2765570">//&nbsp;&nbsp;&nbsp;&nbsp{UpperLower,&nbsp;UpperLower,&nbsp;UpperLower}</span><br>
<span class="lineno"></span><span class="comment" id="2765610">//&nbsp;The&nbsp;constant&nbsp;UpperLower&nbsp;has&nbsp;an&nbsp;otherwise&nbsp;impossible&nbsp;delta&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2765678">type</span>&nbsp;<span class="ident" id="2765683">CaseRange</span>&nbsp;<span class="keyword" id="2765693">struct</span>&nbsp;<span class="op" id="2765700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765703">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2765709">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765717">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2765723">uint32</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765731">Delta</span>&nbsp;<span class="ident" id="2765737">d</span><br>
<span class="lineno"></span><span class="op" id="2765739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2765742">//&nbsp;SpecialCase&nbsp;represents&nbsp;language-specific&nbsp;case&nbsp;mappings&nbsp;such&nbsp;as&nbsp;Turkish.</span><br>
<span class="lineno"></span><span class="comment" id="2765817">//&nbsp;Methods&nbsp;of&nbsp;SpecialCase&nbsp;customize&nbsp;(by&nbsp;overriding)&nbsp;the&nbsp;standard&nbsp;mappings.</span><br>
<span class="lineno">65</span><span class="keyword" id="2765892">type</span>&nbsp;<span class="ident" id="2765897">SpecialCase</span>&nbsp;<span class="op" id="2765909">[</span><span class="op" id="2765910">]</span><span class="ident" id="2765911">CaseRange</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2765922">//&nbsp;BUG(r):&nbsp;There&nbsp;is&nbsp;no&nbsp;mechanism&nbsp;for&nbsp;full&nbsp;case&nbsp;folding,&nbsp;that&nbsp;is,&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2765991">//&nbsp;characters&nbsp;that&nbsp;involve&nbsp;multiple&nbsp;runes&nbsp;in&nbsp;the&nbsp;input&nbsp;or&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="2766058">//&nbsp;Indices&nbsp;into&nbsp;the&nbsp;Delta&nbsp;arrays&nbsp;inside&nbsp;CaseRanges&nbsp;for&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="2766127">const</span>&nbsp;<span class="op" id="2766133">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766136">UpperCase</span>&nbsp;<span class="op" id="2766146">=</span>&nbsp;<span class="ident" id="2766148">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766154">LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766165">TitleCase</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766176">MaxCase</span><br>
<span class="lineno"></span><span class="op" id="2766184">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2766187">type</span>&nbsp;<span class="ident" id="2766192">d</span>&nbsp;<span class="op" id="2766194">[</span><span class="ident" id="2766195">MaxCase</span><span class="op" id="2766202">]</span><span class="builtintype" id="2766203">rune</span>&nbsp;<span class="comment" id="2766208">//&nbsp;to&nbsp;make&nbsp;the&nbsp;CaseRanges&nbsp;text&nbsp;shorter</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2766248">//&nbsp;If&nbsp;the&nbsp;Delta&nbsp;field&nbsp;of&nbsp;a&nbsp;CaseRange&nbsp;is&nbsp;UpperLower,&nbsp;it&nbsp;means</span><br>
<span class="lineno"></span><span class="comment" id="2766309">//&nbsp;this&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;sequence&nbsp;of&nbsp;the&nbsp;form&nbsp;(say)</span><br>
<span class="lineno"></span><span class="comment" id="2766367">//&nbsp;Upper&nbsp;Lower&nbsp;Upper&nbsp;Lower.</span><br>
<span class="lineno"></span><span class="keyword" id="2766395">const</span>&nbsp;<span class="op" id="2766401">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766404">UpperLower</span>&nbsp;<span class="op" id="2766415">=</span>&nbsp;<span class="ident" id="2766417">MaxRune</span>&nbsp;<span class="op" id="2766425">+</span>&nbsp;<span class="num" id="2766427">1</span>&nbsp;<span class="comment" id="2766429">//&nbsp;(Cannot&nbsp;be&nbsp;a&nbsp;valid&nbsp;delta.)</span><br>
<span class="lineno">85</span><span class="op" id="2766459">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2766462">//&nbsp;linearMax&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;table&nbsp;for&nbsp;linear&nbsp;search&nbsp;for&nbsp;non-Latin1&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="2766540">//&nbsp;Derived&nbsp;by&nbsp;running&nbsp;&#39;go&nbsp;test&nbsp;-calibrate&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="2766584">const</span>&nbsp;<span class="ident" id="2766590">linearMax</span>&nbsp;<span class="op" id="2766600">=</span>&nbsp;<span class="num" id="2766602">18</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="2766606">//&nbsp;is16&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="2766673">func</span>&nbsp;<span class="ident" id="2766678">is16</span><span class="op" id="2766682">(</span><span class="ident" id="2766683">ranges</span>&nbsp;<span class="op" id="2766690">[</span><span class="op" id="2766691">]</span><span class="ident" id="2766692">Range16</span><span class="op" id="2766699">,</span>&nbsp;<span class="ident" id="2766701">r</span>&nbsp;<span class="builtintype" id="2766703">uint16</span><span class="op" id="2766709">)</span>&nbsp;<span class="builtintype" id="2766711">bool</span>&nbsp;<span class="op" id="2766716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766719">if</span>&nbsp;<span class="builtinfunc" id="2766722">len</span><span class="op" id="2766725">(</span><span class="ident" id="2766726">ranges</span><span class="op" id="2766732">)</span>&nbsp;<span class="op" id="2766734">&lt;=</span>&nbsp;<span class="ident" id="2766737">linearMax</span>&nbsp;<span class="op" id="2766747">||</span>&nbsp;<span class="ident" id="2766750">r</span>&nbsp;<span class="op" id="2766752">&lt;=</span>&nbsp;<span class="ident" id="2766755">MaxLatin1</span>&nbsp;<span class="op" id="2766765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766769">for</span>&nbsp;<span class="ident" id="2766773">i</span>&nbsp;<span class="op" id="2766775">:=</span>&nbsp;<span class="keyword" id="2766778">range</span>&nbsp;<span class="ident" id="2766784">ranges</span>&nbsp;<span class="op" id="2766791">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766796">range_</span>&nbsp;<span class="op" id="2766803">:=</span>&nbsp;<span class="op" id="2766806">&amp;</span><span class="ident" id="2766807">ranges</span><span class="op" id="2766813">[</span><span class="ident" id="2766814">i</span><span class="op" id="2766815">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766820">if</span>&nbsp;<span class="ident" id="2766823">r</span>&nbsp;<span class="op" id="2766825">&lt;</span>&nbsp;<span class="ident" id="2766827">range_</span><span class="op" id="2766833">.</span><span class="ident" id="2766834">Lo</span>&nbsp;<span class="op" id="2766837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766843">return</span>&nbsp;<span class="ident" id="2766850">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2766859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766864">if</span>&nbsp;<span class="ident" id="2766867">r</span>&nbsp;<span class="op" id="2766869">&lt;=</span>&nbsp;<span class="ident" id="2766872">range_</span><span class="op" id="2766878">.</span><span class="ident" id="2766879">Hi</span>&nbsp;<span class="op" id="2766882">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766888">return</span>&nbsp;<span class="op" id="2766895">(</span><span class="ident" id="2766896">r</span><span class="op" id="2766897">-</span><span class="ident" id="2766898">range_</span><span class="op" id="2766904">.</span><span class="ident" id="2766905">Lo</span><span class="op" id="2766907">)</span><span class="op" id="2766908">%</span><span class="ident" id="2766909">range_</span><span class="op" id="2766915">.</span><span class="ident" id="2766916">Stride</span>&nbsp;<span class="op" id="2766923">==</span>&nbsp;<span class="num" id="2766926">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2766931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2766935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766939">return</span>&nbsp;<span class="ident" id="2766946">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2766953">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2766957">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766987">lo</span>&nbsp;<span class="op" id="2766990">:=</span>&nbsp;<span class="num" id="2766993">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766996">hi</span>&nbsp;<span class="op" id="2766999">:=</span>&nbsp;<span class="builtinfunc" id="2767002">len</span><span class="op" id="2767005">(</span><span class="ident" id="2767006">ranges</span><span class="op" id="2767012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767015">for</span>&nbsp;<span class="ident" id="2767019">lo</span>&nbsp;<span class="op" id="2767022">&lt;</span>&nbsp;<span class="ident" id="2767024">hi</span>&nbsp;<span class="op" id="2767027">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2767031">m</span>&nbsp;<span class="op" id="2767033">:=</span>&nbsp;<span class="ident" id="2767036">lo</span>&nbsp;<span class="op" id="2767039">+</span>&nbsp;<span class="op" id="2767041">(</span><span class="ident" id="2767042">hi</span><span class="op" id="2767044">-</span><span class="ident" id="2767045">lo</span><span class="op" id="2767047">)</span><span class="op" id="2767048">/</span><span class="num" id="2767049">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2767053">range_</span>&nbsp;<span class="op" id="2767060">:=</span>&nbsp;<span class="op" id="2767063">&amp;</span><span class="ident" id="2767064">ranges</span><span class="op" id="2767070">[</span><span class="ident" id="2767071">m</span><span class="op" id="2767072">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767076">if</span>&nbsp;<span class="ident" id="2767079">range_</span><span class="op" id="2767085">.</span><span class="ident" id="2767086">Lo</span>&nbsp;<span class="op" id="2767089">&lt;=</span>&nbsp;<span class="ident" id="2767092">r</span>&nbsp;<span class="op" id="2767094">&amp;&amp;</span>&nbsp;<span class="ident" id="2767097">r</span>&nbsp;<span class="op" id="2767099">&lt;=</span>&nbsp;<span class="ident" id="2767102">range_</span><span class="op" id="2767108">.</span><span class="ident" id="2767109">Hi</span>&nbsp;<span class="op" id="2767112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767117">return</span>&nbsp;<span class="op" id="2767124">(</span><span class="ident" id="2767125">r</span><span class="op" id="2767126">-</span><span class="ident" id="2767127">range_</span><span class="op" id="2767133">.</span><span class="ident" id="2767134">Lo</span><span class="op" id="2767136">)</span><span class="op" id="2767137">%</span><span class="ident" id="2767138">range_</span><span class="op" id="2767144">.</span><span class="ident" id="2767145">Stride</span>&nbsp;<span class="op" id="2767152">==</span>&nbsp;<span class="num" id="2767155">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2767159">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767163">if</span>&nbsp;<span class="ident" id="2767166">r</span>&nbsp;<span class="op" id="2767168">&lt;</span>&nbsp;<span class="ident" id="2767170">range_</span><span class="op" id="2767176">.</span><span class="ident" id="2767177">Lo</span>&nbsp;<span class="op" id="2767180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2767185">hi</span>&nbsp;<span class="op" id="2767188">=</span>&nbsp;<span class="ident" id="2767190">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2767194">}</span>&nbsp;<span class="keyword" id="2767196">else</span>&nbsp;<span class="op" id="2767201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2767206">lo</span>&nbsp;<span class="op" id="2767209">=</span>&nbsp;<span class="ident" id="2767211">m</span>&nbsp;<span class="op" id="2767213">+</span>&nbsp;<span class="num" id="2767215">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2767219">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2767222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767225">return</span>&nbsp;<span class="ident" id="2767232">false</span><br>
<span class="lineno"></span><span class="op" id="2767238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2767241">//&nbsp;is32&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno">125</span><span class="keyword" id="2767308">func</span>&nbsp;<span class="ident" id="2767313">is32</span><span class="op" id="2767317">(</span><span class="ident" id="2767318">ranges</span>&nbsp;<span class="op" id="2767325">[</span><span class="op" id="2767326">]</span><span class="ident" id="2767327">Range32</span><span class="op" id="2767334">,</span>&nbsp;<span class="ident" id="2767336">r</span>&nbsp;<span class="builtintype" id="2767338">uint32</span><span class="op" id="2767344">)</span>&nbsp;<span class="builtintype" id="2767346">bool</span>&nbsp;<span class="op" id="2767351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767354">if</span>&nbsp;<span class="builtinfunc" id="2767357">len</span><span class="op" id="2767360">(</span><span class="ident" id="2767361">ranges</span><span class="op" id="2767367">)</span>&nbsp;<span class="op" id="2767369">&lt;=</span>&nbsp;<span class="ident" id="2767372">linearMax</span>&nbsp;<span class="op" id="2767382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767386">for</span>&nbsp;<span class="ident" id="2767390">i</span>&nbsp;<span class="op" id="2767392">:=</span>&nbsp;<span class="keyword" id="2767395">range</span>&nbsp;<span class="ident" id="2767401">ranges</span>&nbsp;<span class="op" id="2767408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2767413">range_</span>&nbsp;<span class="op" id="2767420">:=</span>&nbsp;<span class="op" id="2767423">&amp;</span><span class="ident" id="2767424">ranges</span><span class="op" id="2767430">[</span><span class="ident" id="2767431">i</span><span class="op" id="2767432">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767437">if</span>&nbsp;<span class="ident" id="2767440">r</span>&nbsp;<span class="op" id="2767442">&lt;</span>&nbsp;<span class="ident" id="2767444">range_</span><span class="op" id="2767450">.</span><span class="ident" id="2767451">Lo</span>&nbsp;<span class="op" id="2767454">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767460">return</span>&nbsp;<span class="ident" id="2767467">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2767476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767481">if</span>&nbsp;<span class="ident" id="2767484">r</span>&nbsp;<span class="op" id="2767486">&lt;=</span>&nbsp;<span class="ident" id="2767489">range_</span><span class="op" id="2767495">.</span><span class="ident" id="2767496">Hi</span>&nbsp;<span class="op" id="2767499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767505">return</span>&nbsp;<span class="op" id="2767512">(</span><span class="ident" id="2767513">r</span><span class="op" id="2767514">-</span><span class="ident" id="2767515">range_</span><span class="op" id="2767521">.</span><span class="ident" id="2767522">Lo</span><span class="op" id="2767524">)</span><span class="op" id="2767525">%</span><span class="ident" id="2767526">range_</span><span class="op" id="2767532">.</span><span class="ident" id="2767533">Stride</span>&nbsp;<span class="op" id="2767540">==</span>&nbsp;<span class="num" id="2767543">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2767548">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2767552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767556">return</span>&nbsp;<span class="ident" id="2767563">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2767570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2767574">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2767604">lo</span>&nbsp;<span class="op" id="2767607">:=</span>&nbsp;<span class="num" id="2767610">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2767613">hi</span>&nbsp;<span class="op" id="2767616">:=</span>&nbsp;<span class="builtinfunc" id="2767619">len</span><span class="op" id="2767622">(</span><span class="ident" id="2767623">ranges</span><span class="op" id="2767629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767632">for</span>&nbsp;<span class="ident" id="2767636">lo</span>&nbsp;<span class="op" id="2767639">&lt;</span>&nbsp;<span class="ident" id="2767641">hi</span>&nbsp;<span class="op" id="2767644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2767648">m</span>&nbsp;<span class="op" id="2767650">:=</span>&nbsp;<span class="ident" id="2767653">lo</span>&nbsp;<span class="op" id="2767656">+</span>&nbsp;<span class="op" id="2767658">(</span><span class="ident" id="2767659">hi</span><span class="op" id="2767661">-</span><span class="ident" id="2767662">lo</span><span class="op" id="2767664">)</span><span class="op" id="2767665">/</span><span class="num" id="2767666">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2767670">range_</span>&nbsp;<span class="op" id="2767677">:=</span>&nbsp;<span class="ident" id="2767680">ranges</span><span class="op" id="2767686">[</span><span class="ident" id="2767687">m</span><span class="op" id="2767688">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767692">if</span>&nbsp;<span class="ident" id="2767695">range_</span><span class="op" id="2767701">.</span><span class="ident" id="2767702">Lo</span>&nbsp;<span class="op" id="2767705">&lt;=</span>&nbsp;<span class="ident" id="2767708">r</span>&nbsp;<span class="op" id="2767710">&amp;&amp;</span>&nbsp;<span class="ident" id="2767713">r</span>&nbsp;<span class="op" id="2767715">&lt;=</span>&nbsp;<span class="ident" id="2767718">range_</span><span class="op" id="2767724">.</span><span class="ident" id="2767725">Hi</span>&nbsp;<span class="op" id="2767728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767733">return</span>&nbsp;<span class="op" id="2767740">(</span><span class="ident" id="2767741">r</span><span class="op" id="2767742">-</span><span class="ident" id="2767743">range_</span><span class="op" id="2767749">.</span><span class="ident" id="2767750">Lo</span><span class="op" id="2767752">)</span><span class="op" id="2767753">%</span><span class="ident" id="2767754">range_</span><span class="op" id="2767760">.</span><span class="ident" id="2767761">Stride</span>&nbsp;<span class="op" id="2767768">==</span>&nbsp;<span class="num" id="2767771">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2767775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767779">if</span>&nbsp;<span class="ident" id="2767782">r</span>&nbsp;<span class="op" id="2767784">&lt;</span>&nbsp;<span class="ident" id="2767786">range_</span><span class="op" id="2767792">.</span><span class="ident" id="2767793">Lo</span>&nbsp;<span class="op" id="2767796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2767801">hi</span>&nbsp;<span class="op" id="2767804">=</span>&nbsp;<span class="ident" id="2767806">m</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2767810">}</span>&nbsp;<span class="keyword" id="2767812">else</span>&nbsp;<span class="op" id="2767817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2767822">lo</span>&nbsp;<span class="op" id="2767825">=</span>&nbsp;<span class="ident" id="2767827">m</span>&nbsp;<span class="op" id="2767829">+</span>&nbsp;<span class="num" id="2767831">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2767835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2767838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767841">return</span>&nbsp;<span class="ident" id="2767848">false</span><br>
<span class="lineno">155</span><span class="op" id="2767854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2767857">//&nbsp;Is&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;in&nbsp;the&nbsp;specified&nbsp;table&nbsp;of&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="2767925">func</span>&nbsp;<span class="ident" id="2767930">Is</span><span class="op" id="2767932">(</span><span class="ident" id="2767933">rangeTab</span>&nbsp;<span class="op" id="2767942">*</span><span class="ident" id="2767943">RangeTable</span><span class="op" id="2767953">,</span>&nbsp;<span class="ident" id="2767955">r</span>&nbsp;<span class="builtintype" id="2767957">rune</span><span class="op" id="2767961">)</span>&nbsp;<span class="builtintype" id="2767963">bool</span>&nbsp;<span class="op" id="2767968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2767971">r16</span>&nbsp;<span class="op" id="2767975">:=</span>&nbsp;<span class="ident" id="2767978">rangeTab</span><span class="op" id="2767986">.</span><span class="ident" id="2767987">R16</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2767992">if</span>&nbsp;<span class="builtinfunc" id="2767995">len</span><span class="op" id="2767998">(</span><span class="ident" id="2767999">r16</span><span class="op" id="2768002">)</span>&nbsp;<span class="op" id="2768004">&gt;</span>&nbsp;<span class="num" id="2768006">0</span>&nbsp;<span class="op" id="2768008">&amp;&amp;</span>&nbsp;<span class="ident" id="2768011">r</span>&nbsp;<span class="op" id="2768013">&lt;=</span>&nbsp;<span class="builtintype" id="2768016">rune</span><span class="op" id="2768020">(</span><span class="ident" id="2768021">r16</span><span class="op" id="2768024">[</span><span class="builtinfunc" id="2768025">len</span><span class="op" id="2768028">(</span><span class="ident" id="2768029">r16</span><span class="op" id="2768032">)</span><span class="op" id="2768033">-</span><span class="num" id="2768034">1</span><span class="op" id="2768035">]</span><span class="op" id="2768036">.</span><span class="ident" id="2768037">Hi</span><span class="op" id="2768039">)</span>&nbsp;<span class="op" id="2768041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768045">return</span>&nbsp;<span class="ident" id="2768052">is16</span><span class="op" id="2768056">(</span><span class="ident" id="2768057">r16</span><span class="op" id="2768060">,</span>&nbsp;<span class="builtintype" id="2768062">uint16</span><span class="op" id="2768068">(</span><span class="ident" id="2768069">r</span><span class="op" id="2768070">)</span><span class="op" id="2768071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2768074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2768077">r32</span>&nbsp;<span class="op" id="2768081">:=</span>&nbsp;<span class="ident" id="2768084">rangeTab</span><span class="op" id="2768092">.</span><span class="ident" id="2768093">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768098">if</span>&nbsp;<span class="builtinfunc" id="2768101">len</span><span class="op" id="2768104">(</span><span class="ident" id="2768105">r32</span><span class="op" id="2768108">)</span>&nbsp;<span class="op" id="2768110">&gt;</span>&nbsp;<span class="num" id="2768112">0</span>&nbsp;<span class="op" id="2768114">&amp;&amp;</span>&nbsp;<span class="ident" id="2768117">r</span>&nbsp;<span class="op" id="2768119">&gt;=</span>&nbsp;<span class="builtintype" id="2768122">rune</span><span class="op" id="2768126">(</span><span class="ident" id="2768127">r32</span><span class="op" id="2768130">[</span><span class="num" id="2768131">0</span><span class="op" id="2768132">]</span><span class="op" id="2768133">.</span><span class="ident" id="2768134">Lo</span><span class="op" id="2768136">)</span>&nbsp;<span class="op" id="2768138">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768142">return</span>&nbsp;<span class="ident" id="2768149">is32</span><span class="op" id="2768153">(</span><span class="ident" id="2768154">r32</span><span class="op" id="2768157">,</span>&nbsp;<span class="builtintype" id="2768159">uint32</span><span class="op" id="2768165">(</span><span class="ident" id="2768166">r</span><span class="op" id="2768167">)</span><span class="op" id="2768168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2768171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768174">return</span>&nbsp;<span class="ident" id="2768181">false</span><br>
<span class="lineno"></span><span class="op" id="2768187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="2768190">func</span>&nbsp;<span class="ident" id="2768195">isExcludingLatin</span><span class="op" id="2768211">(</span><span class="ident" id="2768212">rangeTab</span>&nbsp;<span class="op" id="2768221">*</span><span class="ident" id="2768222">RangeTable</span><span class="op" id="2768232">,</span>&nbsp;<span class="ident" id="2768234">r</span>&nbsp;<span class="builtintype" id="2768236">rune</span><span class="op" id="2768240">)</span>&nbsp;<span class="builtintype" id="2768242">bool</span>&nbsp;<span class="op" id="2768247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2768250">r16</span>&nbsp;<span class="op" id="2768254">:=</span>&nbsp;<span class="ident" id="2768257">rangeTab</span><span class="op" id="2768265">.</span><span class="ident" id="2768266">R16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768271">if</span>&nbsp;<span class="ident" id="2768274">off</span>&nbsp;<span class="op" id="2768278">:=</span>&nbsp;<span class="ident" id="2768281">rangeTab</span><span class="op" id="2768289">.</span><span class="ident" id="2768290">LatinOffset</span><span class="op" id="2768301">;</span>&nbsp;<span class="builtinfunc" id="2768303">len</span><span class="op" id="2768306">(</span><span class="ident" id="2768307">r16</span><span class="op" id="2768310">)</span>&nbsp;<span class="op" id="2768312">&gt;</span>&nbsp;<span class="ident" id="2768314">off</span>&nbsp;<span class="op" id="2768318">&amp;&amp;</span>&nbsp;<span class="ident" id="2768321">r</span>&nbsp;<span class="op" id="2768323">&lt;=</span>&nbsp;<span class="builtintype" id="2768326">rune</span><span class="op" id="2768330">(</span><span class="ident" id="2768331">r16</span><span class="op" id="2768334">[</span><span class="builtinfunc" id="2768335">len</span><span class="op" id="2768338">(</span><span class="ident" id="2768339">r16</span><span class="op" id="2768342">)</span><span class="op" id="2768343">-</span><span class="num" id="2768344">1</span><span class="op" id="2768345">]</span><span class="op" id="2768346">.</span><span class="ident" id="2768347">Hi</span><span class="op" id="2768349">)</span>&nbsp;<span class="op" id="2768351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768355">return</span>&nbsp;<span class="ident" id="2768362">is16</span><span class="op" id="2768366">(</span><span class="ident" id="2768367">r16</span><span class="op" id="2768370">[</span><span class="ident" id="2768371">off</span><span class="op" id="2768374">:</span><span class="op" id="2768375">]</span><span class="op" id="2768376">,</span>&nbsp;<span class="builtintype" id="2768378">uint16</span><span class="op" id="2768384">(</span><span class="ident" id="2768385">r</span><span class="op" id="2768386">)</span><span class="op" id="2768387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2768390">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2768393">r32</span>&nbsp;<span class="op" id="2768397">:=</span>&nbsp;<span class="ident" id="2768400">rangeTab</span><span class="op" id="2768408">.</span><span class="ident" id="2768409">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768414">if</span>&nbsp;<span class="builtinfunc" id="2768417">len</span><span class="op" id="2768420">(</span><span class="ident" id="2768421">r32</span><span class="op" id="2768424">)</span>&nbsp;<span class="op" id="2768426">&gt;</span>&nbsp;<span class="num" id="2768428">0</span>&nbsp;<span class="op" id="2768430">&amp;&amp;</span>&nbsp;<span class="ident" id="2768433">r</span>&nbsp;<span class="op" id="2768435">&gt;=</span>&nbsp;<span class="builtintype" id="2768438">rune</span><span class="op" id="2768442">(</span><span class="ident" id="2768443">r32</span><span class="op" id="2768446">[</span><span class="num" id="2768447">0</span><span class="op" id="2768448">]</span><span class="op" id="2768449">.</span><span class="ident" id="2768450">Lo</span><span class="op" id="2768452">)</span>&nbsp;<span class="op" id="2768454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768458">return</span>&nbsp;<span class="ident" id="2768465">is32</span><span class="op" id="2768469">(</span><span class="ident" id="2768470">r32</span><span class="op" id="2768473">,</span>&nbsp;<span class="builtintype" id="2768475">uint32</span><span class="op" id="2768481">(</span><span class="ident" id="2768482">r</span><span class="op" id="2768483">)</span><span class="op" id="2768484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2768487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768490">return</span>&nbsp;<span class="ident" id="2768497">false</span><br>
<span class="lineno">180</span><span class="op" id="2768503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2768506">//&nbsp;IsUpper&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="2768567">func</span>&nbsp;<span class="ident" id="2768572">IsUpper</span><span class="op" id="2768579">(</span><span class="ident" id="2768580">r</span>&nbsp;<span class="builtintype" id="2768582">rune</span><span class="op" id="2768586">)</span>&nbsp;<span class="builtintype" id="2768588">bool</span>&nbsp;<span class="op" id="2768593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2768596">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768626">if</span>&nbsp;<span class="builtintype" id="2768629">uint32</span><span class="op" id="2768635">(</span><span class="ident" id="2768636">r</span><span class="op" id="2768637">)</span>&nbsp;<span class="op" id="2768639">&lt;=</span>&nbsp;<span class="ident" id="2768642">MaxLatin1</span>&nbsp;<span class="op" id="2768652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768656">return</span>&nbsp;<span class="ident" id="2768663">properties</span><span class="op" id="2768673">[</span><span class="builtintype" id="2768674">uint8</span><span class="op" id="2768679">(</span><span class="ident" id="2768680">r</span><span class="op" id="2768681">)</span><span class="op" id="2768682">]</span><span class="op" id="2768683">&amp;</span><span class="ident" id="2768684">pLmask</span>&nbsp;<span class="op" id="2768691">==</span>&nbsp;<span class="ident" id="2768694">pLu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2768699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768702">return</span>&nbsp;<span class="ident" id="2768709">isExcludingLatin</span><span class="op" id="2768725">(</span><span class="ident" id="2768726">Upper</span><span class="op" id="2768731">,</span>&nbsp;<span class="ident" id="2768733">r</span><span class="op" id="2768734">)</span><br>
<span class="lineno"></span><span class="op" id="2768736">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="2768739">//&nbsp;IsLower&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;lower&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="2768799">func</span>&nbsp;<span class="ident" id="2768804">IsLower</span><span class="op" id="2768811">(</span><span class="ident" id="2768812">r</span>&nbsp;<span class="builtintype" id="2768814">rune</span><span class="op" id="2768818">)</span>&nbsp;<span class="builtintype" id="2768820">bool</span>&nbsp;<span class="op" id="2768825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2768828">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768858">if</span>&nbsp;<span class="builtintype" id="2768861">uint32</span><span class="op" id="2768867">(</span><span class="ident" id="2768868">r</span><span class="op" id="2768869">)</span>&nbsp;<span class="op" id="2768871">&lt;=</span>&nbsp;<span class="ident" id="2768874">MaxLatin1</span>&nbsp;<span class="op" id="2768884">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768888">return</span>&nbsp;<span class="ident" id="2768895">properties</span><span class="op" id="2768905">[</span><span class="builtintype" id="2768906">uint8</span><span class="op" id="2768911">(</span><span class="ident" id="2768912">r</span><span class="op" id="2768913">)</span><span class="op" id="2768914">]</span><span class="op" id="2768915">&amp;</span><span class="ident" id="2768916">pLmask</span>&nbsp;<span class="op" id="2768923">==</span>&nbsp;<span class="ident" id="2768926">pLl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2768931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2768934">return</span>&nbsp;<span class="ident" id="2768941">isExcludingLatin</span><span class="op" id="2768957">(</span><span class="ident" id="2768958">Lower</span><span class="op" id="2768963">,</span>&nbsp;<span class="ident" id="2768965">r</span><span class="op" id="2768966">)</span><br>
<span class="lineno"></span><span class="op" id="2768968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="2768971">//&nbsp;IsTitle&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;title&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="2769031">func</span>&nbsp;<span class="ident" id="2769036">IsTitle</span><span class="op" id="2769043">(</span><span class="ident" id="2769044">r</span>&nbsp;<span class="builtintype" id="2769046">rune</span><span class="op" id="2769050">)</span>&nbsp;<span class="builtintype" id="2769052">bool</span>&nbsp;<span class="op" id="2769057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2769060">if</span>&nbsp;<span class="ident" id="2769063">r</span>&nbsp;<span class="op" id="2769065">&lt;=</span>&nbsp;<span class="ident" id="2769068">MaxLatin1</span>&nbsp;<span class="op" id="2769078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2769082">return</span>&nbsp;<span class="ident" id="2769089">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2769096">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2769099">return</span>&nbsp;<span class="ident" id="2769106">isExcludingLatin</span><span class="op" id="2769122">(</span><span class="ident" id="2769123">Title</span><span class="op" id="2769128">,</span>&nbsp;<span class="ident" id="2769130">r</span><span class="op" id="2769131">)</span><br>
<span class="lineno"></span><span class="op" id="2769133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2769136">//&nbsp;to&nbsp;maps&nbsp;the&nbsp;rune&nbsp;using&nbsp;the&nbsp;specified&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="2769190">func</span>&nbsp;<span class="ident" id="2769195">to</span><span class="op" id="2769197">(</span><span class="ident" id="2769198">_case</span>&nbsp;<span class="builtintype" id="2769204">int</span><span class="op" id="2769207">,</span>&nbsp;<span class="ident" id="2769209">r</span>&nbsp;<span class="builtintype" id="2769211">rune</span><span class="op" id="2769215">,</span>&nbsp;<span class="ident" id="2769217">caseRange</span>&nbsp;<span class="op" id="2769227">[</span><span class="op" id="2769228">]</span><span class="ident" id="2769229">CaseRange</span><span class="op" id="2769238">)</span>&nbsp;<span class="builtintype" id="2769240">rune</span>&nbsp;<span class="op" id="2769245">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2769248">if</span>&nbsp;<span class="ident" id="2769251">_case</span>&nbsp;<span class="op" id="2769257">&lt;</span>&nbsp;<span class="num" id="2769259">0</span>&nbsp;<span class="op" id="2769261">||</span>&nbsp;<span class="ident" id="2769264">MaxCase</span>&nbsp;<span class="op" id="2769272">&lt;=</span>&nbsp;<span class="ident" id="2769275">_case</span>&nbsp;<span class="op" id="2769281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2769285">return</span>&nbsp;<span class="ident" id="2769292">ReplacementChar</span>&nbsp;<span class="comment" id="2769308">//&nbsp;as&nbsp;reasonable&nbsp;an&nbsp;error&nbsp;as&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2769342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2769345">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2769375">lo</span>&nbsp;<span class="op" id="2769378">:=</span>&nbsp;<span class="num" id="2769381">0</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2769384">hi</span>&nbsp;<span class="op" id="2769387">:=</span>&nbsp;<span class="builtinfunc" id="2769390">len</span><span class="op" id="2769393">(</span><span class="ident" id="2769394">caseRange</span><span class="op" id="2769403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2769406">for</span>&nbsp;<span class="ident" id="2769410">lo</span>&nbsp;<span class="op" id="2769413">&lt;</span>&nbsp;<span class="ident" id="2769415">hi</span>&nbsp;<span class="op" id="2769418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2769422">m</span>&nbsp;<span class="op" id="2769424">:=</span>&nbsp;<span class="ident" id="2769427">lo</span>&nbsp;<span class="op" id="2769430">+</span>&nbsp;<span class="op" id="2769432">(</span><span class="ident" id="2769433">hi</span><span class="op" id="2769435">-</span><span class="ident" id="2769436">lo</span><span class="op" id="2769438">)</span><span class="op" id="2769439">/</span><span class="num" id="2769440">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2769444">cr</span>&nbsp;<span class="op" id="2769447">:=</span>&nbsp;<span class="ident" id="2769450">caseRange</span><span class="op" id="2769459">[</span><span class="ident" id="2769460">m</span><span class="op" id="2769461">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2769465">if</span>&nbsp;<span class="builtintype" id="2769468">rune</span><span class="op" id="2769472">(</span><span class="ident" id="2769473">cr</span><span class="op" id="2769475">.</span><span class="ident" id="2769476">Lo</span><span class="op" id="2769478">)</span>&nbsp;<span class="op" id="2769480">&lt;=</span>&nbsp;<span class="ident" id="2769483">r</span>&nbsp;<span class="op" id="2769485">&amp;&amp;</span>&nbsp;<span class="ident" id="2769488">r</span>&nbsp;<span class="op" id="2769490">&lt;=</span>&nbsp;<span class="builtintype" id="2769493">rune</span><span class="op" id="2769497">(</span><span class="ident" id="2769498">cr</span><span class="op" id="2769500">.</span><span class="ident" id="2769501">Hi</span><span class="op" id="2769503">)</span>&nbsp;<span class="op" id="2769505">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2769510">delta</span>&nbsp;<span class="op" id="2769516">:=</span>&nbsp;<span class="builtintype" id="2769519">rune</span><span class="op" id="2769523">(</span><span class="ident" id="2769524">cr</span><span class="op" id="2769526">.</span><span class="ident" id="2769527">Delta</span><span class="op" id="2769532">[</span><span class="ident" id="2769533">_case</span><span class="op" id="2769538">]</span><span class="op" id="2769539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2769544">if</span>&nbsp;<span class="ident" id="2769547">delta</span>&nbsp;<span class="op" id="2769553">&gt;</span>&nbsp;<span class="ident" id="2769555">MaxRune</span>&nbsp;<span class="op" id="2769563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2769569">//&nbsp;In&nbsp;an&nbsp;Upper-Lower&nbsp;sequence,&nbsp;which&nbsp;always&nbsp;starts&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2769629">//&nbsp;an&nbsp;UpperCase&nbsp;letter,&nbsp;the&nbsp;real&nbsp;deltas&nbsp;always&nbsp;look&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2769691">//&nbsp;&nbsp;&nbsp;&nbsp{0,&nbsp;1,&nbsp;0}&nbsp;&nbsp;&nbsp;&nbsp;UpperCase&nbsp;(Lower&nbsp;is&nbsp;next)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2769737">//&nbsp;&nbsp;&nbsp;&nbsp{-1,&nbsp;0,&nbsp;-1}&nbsp;&nbsp;LowerCase&nbsp;(Upper,&nbsp;Title&nbsp;are&nbsp;previous)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2769795">//&nbsp;The&nbsp;characters&nbsp;at&nbsp;even&nbsp;offsets&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2769859">//&nbsp;sequence&nbsp;are&nbsp;upper&nbsp;case;&nbsp;the&nbsp;ones&nbsp;at&nbsp;odd&nbsp;offsets&nbsp;are&nbsp;lower.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2769926">//&nbsp;The&nbsp;correct&nbsp;mapping&nbsp;can&nbsp;be&nbsp;done&nbsp;by&nbsp;clearing&nbsp;or&nbsp;setting&nbsp;the&nbsp;low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2769996">//&nbsp;bit&nbsp;in&nbsp;the&nbsp;sequence&nbsp;offset.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2770031">//&nbsp;The&nbsp;constants&nbsp;UpperCase&nbsp;and&nbsp;TitleCase&nbsp;are&nbsp;even&nbsp;while&nbsp;LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2770101">//&nbsp;is&nbsp;odd&nbsp;so&nbsp;we&nbsp;take&nbsp;the&nbsp;low&nbsp;bit&nbsp;from&nbsp;_case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770150">return</span>&nbsp;<span class="builtintype" id="2770157">rune</span><span class="op" id="2770161">(</span><span class="ident" id="2770162">cr</span><span class="op" id="2770164">.</span><span class="ident" id="2770165">Lo</span><span class="op" id="2770167">)</span>&nbsp;<span class="op" id="2770169">+</span>&nbsp;<span class="op" id="2770171">(</span><span class="op" id="2770172">(</span><span class="ident" id="2770173">r</span><span class="op" id="2770174">-</span><span class="builtintype" id="2770175">rune</span><span class="op" id="2770179">(</span><span class="ident" id="2770180">cr</span><span class="op" id="2770182">.</span><span class="ident" id="2770183">Lo</span><span class="op" id="2770185">)</span><span class="op" id="2770186">)</span><span class="op" id="2770187">&amp;^</span><span class="num" id="2770189">1</span>&nbsp;<span class="op" id="2770191">|</span>&nbsp;<span class="builtintype" id="2770193">rune</span><span class="op" id="2770197">(</span><span class="ident" id="2770198">_case</span><span class="op" id="2770203">&amp;</span><span class="num" id="2770204">1</span><span class="op" id="2770205">)</span><span class="op" id="2770206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2770211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770216">return</span>&nbsp;<span class="ident" id="2770223">r</span>&nbsp;<span class="op" id="2770225">+</span>&nbsp;<span class="ident" id="2770227">delta</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2770235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770239">if</span>&nbsp;<span class="ident" id="2770242">r</span>&nbsp;<span class="op" id="2770244">&lt;</span>&nbsp;<span class="builtintype" id="2770246">rune</span><span class="op" id="2770250">(</span><span class="ident" id="2770251">cr</span><span class="op" id="2770253">.</span><span class="ident" id="2770254">Lo</span><span class="op" id="2770256">)</span>&nbsp;<span class="op" id="2770258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2770263">hi</span>&nbsp;<span class="op" id="2770266">=</span>&nbsp;<span class="ident" id="2770268">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2770272">}</span>&nbsp;<span class="keyword" id="2770274">else</span>&nbsp;<span class="op" id="2770279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2770284">lo</span>&nbsp;<span class="op" id="2770287">=</span>&nbsp;<span class="ident" id="2770289">m</span>&nbsp;<span class="op" id="2770291">+</span>&nbsp;<span class="num" id="2770293">1</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2770297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2770300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770303">return</span>&nbsp;<span class="ident" id="2770310">r</span><br>
<span class="lineno"></span><span class="op" id="2770312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="2770315">//&nbsp;To&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;the&nbsp;specified&nbsp;case:&nbsp;UpperCase,&nbsp;LowerCase,&nbsp;or&nbsp;TitleCase.</span><br>
<span class="lineno"></span><span class="keyword" id="2770394">func</span>&nbsp;<span class="ident" id="2770399">To</span><span class="op" id="2770401">(</span><span class="ident" id="2770402">_case</span>&nbsp;<span class="builtintype" id="2770408">int</span><span class="op" id="2770411">,</span>&nbsp;<span class="ident" id="2770413">r</span>&nbsp;<span class="builtintype" id="2770415">rune</span><span class="op" id="2770419">)</span>&nbsp;<span class="builtintype" id="2770421">rune</span>&nbsp;<span class="op" id="2770426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770429">return</span>&nbsp;<span class="ident" id="2770436">to</span><span class="op" id="2770438">(</span><span class="ident" id="2770439">_case</span><span class="op" id="2770444">,</span>&nbsp;<span class="ident" id="2770446">r</span><span class="op" id="2770447">,</span>&nbsp;<span class="ident" id="2770449">CaseRanges</span><span class="op" id="2770459">)</span><br>
<span class="lineno"></span><span class="op" id="2770461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="2770464">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="2770504">func</span>&nbsp;<span class="ident" id="2770509">ToUpper</span><span class="op" id="2770516">(</span><span class="ident" id="2770517">r</span>&nbsp;<span class="builtintype" id="2770519">rune</span><span class="op" id="2770523">)</span>&nbsp;<span class="builtintype" id="2770525">rune</span>&nbsp;<span class="op" id="2770530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770533">if</span>&nbsp;<span class="ident" id="2770536">r</span>&nbsp;<span class="op" id="2770538">&lt;=</span>&nbsp;<span class="ident" id="2770541">MaxASCII</span>&nbsp;<span class="op" id="2770550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770554">if</span>&nbsp;<span class="string" id="2770557">&#39;a&#39;</span>&nbsp;<span class="op" id="2770561">&lt;=</span>&nbsp;<span class="ident" id="2770564">r</span>&nbsp;<span class="op" id="2770566">&amp;&amp;</span>&nbsp;<span class="ident" id="2770569">r</span>&nbsp;<span class="op" id="2770571">&lt;=</span>&nbsp;<span class="string" id="2770574">&#39;z&#39;</span>&nbsp;<span class="op" id="2770578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2770583">r</span>&nbsp;<span class="op" id="2770585">-=</span>&nbsp;<span class="string" id="2770588">&#39;a&#39;</span>&nbsp;<span class="op" id="2770592">-</span>&nbsp;<span class="string" id="2770594">&#39;A&#39;</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2770600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770604">return</span>&nbsp;<span class="ident" id="2770611">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2770614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770617">return</span>&nbsp;<span class="ident" id="2770624">To</span><span class="op" id="2770626">(</span><span class="ident" id="2770627">UpperCase</span><span class="op" id="2770636">,</span>&nbsp;<span class="ident" id="2770638">r</span><span class="op" id="2770639">)</span><br>
<span class="lineno"></span><span class="op" id="2770641">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="2770644">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="2770684">func</span>&nbsp;<span class="ident" id="2770689">ToLower</span><span class="op" id="2770696">(</span><span class="ident" id="2770697">r</span>&nbsp;<span class="builtintype" id="2770699">rune</span><span class="op" id="2770703">)</span>&nbsp;<span class="builtintype" id="2770705">rune</span>&nbsp;<span class="op" id="2770710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770713">if</span>&nbsp;<span class="ident" id="2770716">r</span>&nbsp;<span class="op" id="2770718">&lt;=</span>&nbsp;<span class="ident" id="2770721">MaxASCII</span>&nbsp;<span class="op" id="2770730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770734">if</span>&nbsp;<span class="string" id="2770737">&#39;A&#39;</span>&nbsp;<span class="op" id="2770741">&lt;=</span>&nbsp;<span class="ident" id="2770744">r</span>&nbsp;<span class="op" id="2770746">&amp;&amp;</span>&nbsp;<span class="ident" id="2770749">r</span>&nbsp;<span class="op" id="2770751">&lt;=</span>&nbsp;<span class="string" id="2770754">&#39;Z&#39;</span>&nbsp;<span class="op" id="2770758">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2770763">r</span>&nbsp;<span class="op" id="2770765">+=</span>&nbsp;<span class="string" id="2770768">&#39;a&#39;</span>&nbsp;<span class="op" id="2770772">-</span>&nbsp;<span class="string" id="2770774">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2770780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770784">return</span>&nbsp;<span class="ident" id="2770791">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2770794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770797">return</span>&nbsp;<span class="ident" id="2770804">To</span><span class="op" id="2770806">(</span><span class="ident" id="2770807">LowerCase</span><span class="op" id="2770816">,</span>&nbsp;<span class="ident" id="2770818">r</span><span class="op" id="2770819">)</span><br>
<span class="lineno">270</span><span class="op" id="2770821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2770824">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="2770864">func</span>&nbsp;<span class="ident" id="2770869">ToTitle</span><span class="op" id="2770876">(</span><span class="ident" id="2770877">r</span>&nbsp;<span class="builtintype" id="2770879">rune</span><span class="op" id="2770883">)</span>&nbsp;<span class="builtintype" id="2770885">rune</span>&nbsp;<span class="op" id="2770890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770893">if</span>&nbsp;<span class="ident" id="2770896">r</span>&nbsp;<span class="op" id="2770898">&lt;=</span>&nbsp;<span class="ident" id="2770901">MaxASCII</span>&nbsp;<span class="op" id="2770910">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2770914">if</span>&nbsp;<span class="string" id="2770917">&#39;a&#39;</span>&nbsp;<span class="op" id="2770921">&lt;=</span>&nbsp;<span class="ident" id="2770924">r</span>&nbsp;<span class="op" id="2770926">&amp;&amp;</span>&nbsp;<span class="ident" id="2770929">r</span>&nbsp;<span class="op" id="2770931">&lt;=</span>&nbsp;<span class="string" id="2770934">&#39;z&#39;</span>&nbsp;<span class="op" id="2770938">{</span>&nbsp;<span class="comment" id="2770940">//&nbsp;title&nbsp;case&nbsp;is&nbsp;upper&nbsp;case&nbsp;for&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2770981">r</span>&nbsp;<span class="op" id="2770983">-=</span>&nbsp;<span class="string" id="2770986">&#39;a&#39;</span>&nbsp;<span class="op" id="2770990">-</span>&nbsp;<span class="string" id="2770992">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2770998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2771002">return</span>&nbsp;<span class="ident" id="2771009">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2771012">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2771015">return</span>&nbsp;<span class="ident" id="2771022">To</span><span class="op" id="2771024">(</span><span class="ident" id="2771025">TitleCase</span><span class="op" id="2771034">,</span>&nbsp;<span class="ident" id="2771036">r</span><span class="op" id="2771037">)</span><br>
<span class="lineno"></span><span class="op" id="2771039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2771042">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="2771121">func</span>&nbsp;<span class="op" id="2771126">(</span><span class="ident" id="2771127">special</span>&nbsp;<span class="ident" id="2771135">SpecialCase</span><span class="op" id="2771146">)</span>&nbsp;<span class="ident" id="2771148">ToUpper</span><span class="op" id="2771155">(</span><span class="ident" id="2771156">r</span>&nbsp;<span class="builtintype" id="2771158">rune</span><span class="op" id="2771162">)</span>&nbsp;<span class="builtintype" id="2771164">rune</span>&nbsp;<span class="op" id="2771169">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2771172">r1</span>&nbsp;<span class="op" id="2771175">:=</span>&nbsp;<span class="ident" id="2771178">to</span><span class="op" id="2771180">(</span><span class="ident" id="2771181">UpperCase</span><span class="op" id="2771190">,</span>&nbsp;<span class="ident" id="2771192">r</span><span class="op" id="2771193">,</span>&nbsp;<span class="op" id="2771195">[</span><span class="op" id="2771196">]</span><span class="ident" id="2771197">CaseRange</span><span class="op" id="2771206">(</span><span class="ident" id="2771207">special</span><span class="op" id="2771214">)</span><span class="op" id="2771215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2771218">if</span>&nbsp;<span class="ident" id="2771221">r1</span>&nbsp;<span class="op" id="2771224">==</span>&nbsp;<span class="ident" id="2771227">r</span>&nbsp;<span class="op" id="2771229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2771233">r1</span>&nbsp;<span class="op" id="2771236">=</span>&nbsp;<span class="ident" id="2771238">ToUpper</span><span class="op" id="2771245">(</span><span class="ident" id="2771246">r</span><span class="op" id="2771247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2771250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2771253">return</span>&nbsp;<span class="ident" id="2771260">r1</span><br>
<span class="lineno">290</span><span class="op" id="2771263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2771266">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="2771345">func</span>&nbsp;<span class="op" id="2771350">(</span><span class="ident" id="2771351">special</span>&nbsp;<span class="ident" id="2771359">SpecialCase</span><span class="op" id="2771370">)</span>&nbsp;<span class="ident" id="2771372">ToTitle</span><span class="op" id="2771379">(</span><span class="ident" id="2771380">r</span>&nbsp;<span class="builtintype" id="2771382">rune</span><span class="op" id="2771386">)</span>&nbsp;<span class="builtintype" id="2771388">rune</span>&nbsp;<span class="op" id="2771393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2771396">r1</span>&nbsp;<span class="op" id="2771399">:=</span>&nbsp;<span class="ident" id="2771402">to</span><span class="op" id="2771404">(</span><span class="ident" id="2771405">TitleCase</span><span class="op" id="2771414">,</span>&nbsp;<span class="ident" id="2771416">r</span><span class="op" id="2771417">,</span>&nbsp;<span class="op" id="2771419">[</span><span class="op" id="2771420">]</span><span class="ident" id="2771421">CaseRange</span><span class="op" id="2771430">(</span><span class="ident" id="2771431">special</span><span class="op" id="2771438">)</span><span class="op" id="2771439">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2771442">if</span>&nbsp;<span class="ident" id="2771445">r1</span>&nbsp;<span class="op" id="2771448">==</span>&nbsp;<span class="ident" id="2771451">r</span>&nbsp;<span class="op" id="2771453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2771457">r1</span>&nbsp;<span class="op" id="2771460">=</span>&nbsp;<span class="ident" id="2771462">ToTitle</span><span class="op" id="2771469">(</span><span class="ident" id="2771470">r</span><span class="op" id="2771471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2771474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2771477">return</span>&nbsp;<span class="ident" id="2771484">r1</span><br>
<span class="lineno"></span><span class="op" id="2771487">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2771490">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="2771569">func</span>&nbsp;<span class="op" id="2771574">(</span><span class="ident" id="2771575">special</span>&nbsp;<span class="ident" id="2771583">SpecialCase</span><span class="op" id="2771594">)</span>&nbsp;<span class="ident" id="2771596">ToLower</span><span class="op" id="2771603">(</span><span class="ident" id="2771604">r</span>&nbsp;<span class="builtintype" id="2771606">rune</span><span class="op" id="2771610">)</span>&nbsp;<span class="builtintype" id="2771612">rune</span>&nbsp;<span class="op" id="2771617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2771620">r1</span>&nbsp;<span class="op" id="2771623">:=</span>&nbsp;<span class="ident" id="2771626">to</span><span class="op" id="2771628">(</span><span class="ident" id="2771629">LowerCase</span><span class="op" id="2771638">,</span>&nbsp;<span class="ident" id="2771640">r</span><span class="op" id="2771641">,</span>&nbsp;<span class="op" id="2771643">[</span><span class="op" id="2771644">]</span><span class="ident" id="2771645">CaseRange</span><span class="op" id="2771654">(</span><span class="ident" id="2771655">special</span><span class="op" id="2771662">)</span><span class="op" id="2771663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2771666">if</span>&nbsp;<span class="ident" id="2771669">r1</span>&nbsp;<span class="op" id="2771672">==</span>&nbsp;<span class="ident" id="2771675">r</span>&nbsp;<span class="op" id="2771677">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2771681">r1</span>&nbsp;<span class="op" id="2771684">=</span>&nbsp;<span class="ident" id="2771686">ToLower</span><span class="op" id="2771693">(</span><span class="ident" id="2771694">r</span><span class="op" id="2771695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2771698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2771701">return</span>&nbsp;<span class="ident" id="2771708">r1</span><br>
<span class="lineno"></span><span class="op" id="2771711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="2771714">//&nbsp;caseOrbit&nbsp;is&nbsp;defined&nbsp;in&nbsp;tables.go&nbsp;as&nbsp;[]foldPair.&nbsp;&nbsp;Right&nbsp;now&nbsp;all&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2771785">//&nbsp;entries&nbsp;fit&nbsp;in&nbsp;uint16,&nbsp;so&nbsp;use&nbsp;uint16.&nbsp;&nbsp;If&nbsp;that&nbsp;changes,&nbsp;compilation</span><br>
<span class="lineno"></span><span class="comment" id="2771856">//&nbsp;will&nbsp;fail&nbsp;(the&nbsp;constants&nbsp;in&nbsp;the&nbsp;composite&nbsp;literal&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;uint16)</span><br>
<span class="lineno"></span><span class="comment" id="2771933">//&nbsp;and&nbsp;the&nbsp;types&nbsp;here&nbsp;can&nbsp;change&nbsp;to&nbsp;uint32.</span><br>
<span class="lineno"></span><span class="keyword" id="2771977">type</span>&nbsp;<span class="ident" id="2771982">foldPair</span>&nbsp;<span class="keyword" id="2771991">struct</span>&nbsp;<span class="op" id="2771998">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2772001">From</span>&nbsp;<span class="builtintype" id="2772006">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2772014">To</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2772019">uint16</span><br>
<span class="lineno"></span><span class="op" id="2772026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2772029">//&nbsp;SimpleFold&nbsp;iterates&nbsp;over&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;equivalent&nbsp;under</span><br>
<span class="lineno">320</span><span class="comment" id="2772094">//&nbsp;the&nbsp;Unicode-defined&nbsp;simple&nbsp;case&nbsp;folding.&nbsp;&nbsp;Among&nbsp;the&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="2772161">//&nbsp;equivalent&nbsp;to&nbsp;rune&nbsp;(including&nbsp;rune&nbsp;itself),&nbsp;SimpleFold&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2772231">//&nbsp;smallest&nbsp;rune&nbsp;&gt;&nbsp;r&nbsp;if&nbsp;one&nbsp;exists,&nbsp;or&nbsp;else&nbsp;the&nbsp;smallest&nbsp;rune&nbsp;&gt;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="2772299">//</span><br>
<span class="lineno"></span><span class="comment" id="2772302">//&nbsp;For&nbsp;example:</span><br>
<span class="lineno">325</span><span class="comment" id="2772318">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;A&#39;)&nbsp;=&nbsp;&#39;a&#39;</span><br>
<span class="lineno"></span><span class="comment" id="2772343">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;a&#39;)&nbsp;=&nbsp;&#39;A&#39;</span><br>
<span class="lineno"></span><span class="comment" id="2772368">//</span><br>
<span class="lineno"></span><span class="comment" id="2772371">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;K&#39;)&nbsp;=&nbsp;&#39;k&#39;</span><br>
<span class="lineno"></span><span class="comment" id="2772396">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;k&#39;)&nbsp;=&nbsp;&#39;\u212A&#39;&nbsp;(Kelvin&nbsp;symbol,&nbsp;K)</span><br>
<span class="lineno">330</span><span class="comment" id="2772447">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;\u212A&#39;)&nbsp;=&nbsp;&#39;K&#39;</span><br>
<span class="lineno"></span><span class="comment" id="2772477">//</span><br>
<span class="lineno"></span><span class="comment" id="2772480">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;1&#39;)&nbsp;=&nbsp;&#39;1&#39;</span><br>
<span class="lineno"></span><span class="comment" id="2772505">//</span><br>
<span class="lineno"></span><span class="keyword" id="2772508">func</span>&nbsp;<span class="ident" id="2772513">SimpleFold</span><span class="op" id="2772523">(</span><span class="ident" id="2772524">r</span>&nbsp;<span class="builtintype" id="2772526">rune</span><span class="op" id="2772530">)</span>&nbsp;<span class="builtintype" id="2772532">rune</span>&nbsp;<span class="op" id="2772537">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2772540">//&nbsp;Consult&nbsp;caseOrbit&nbsp;table&nbsp;for&nbsp;special&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2772587">lo</span>&nbsp;<span class="op" id="2772590">:=</span>&nbsp;<span class="num" id="2772593">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2772596">hi</span>&nbsp;<span class="op" id="2772599">:=</span>&nbsp;<span class="builtinfunc" id="2772602">len</span><span class="op" id="2772605">(</span><span class="ident" id="2772606">caseOrbit</span><span class="op" id="2772615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2772618">for</span>&nbsp;<span class="ident" id="2772622">lo</span>&nbsp;<span class="op" id="2772625">&lt;</span>&nbsp;<span class="ident" id="2772627">hi</span>&nbsp;<span class="op" id="2772630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2772634">m</span>&nbsp;<span class="op" id="2772636">:=</span>&nbsp;<span class="ident" id="2772639">lo</span>&nbsp;<span class="op" id="2772642">+</span>&nbsp;<span class="op" id="2772644">(</span><span class="ident" id="2772645">hi</span><span class="op" id="2772647">-</span><span class="ident" id="2772648">lo</span><span class="op" id="2772650">)</span><span class="op" id="2772651">/</span><span class="num" id="2772652">2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2772656">if</span>&nbsp;<span class="builtintype" id="2772659">rune</span><span class="op" id="2772663">(</span><span class="ident" id="2772664">caseOrbit</span><span class="op" id="2772673">[</span><span class="ident" id="2772674">m</span><span class="op" id="2772675">]</span><span class="op" id="2772676">.</span><span class="ident" id="2772677">From</span><span class="op" id="2772681">)</span>&nbsp;<span class="op" id="2772683">&lt;</span>&nbsp;<span class="ident" id="2772685">r</span>&nbsp;<span class="op" id="2772687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2772692">lo</span>&nbsp;<span class="op" id="2772695">=</span>&nbsp;<span class="ident" id="2772697">m</span>&nbsp;<span class="op" id="2772699">+</span>&nbsp;<span class="num" id="2772701">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2772705">}</span>&nbsp;<span class="keyword" id="2772707">else</span>&nbsp;<span class="op" id="2772712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2772717">hi</span>&nbsp;<span class="op" id="2772720">=</span>&nbsp;<span class="ident" id="2772722">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2772726">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2772729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2772732">if</span>&nbsp;<span class="ident" id="2772735">lo</span>&nbsp;<span class="op" id="2772738">&lt;</span>&nbsp;<span class="builtinfunc" id="2772740">len</span><span class="op" id="2772743">(</span><span class="ident" id="2772744">caseOrbit</span><span class="op" id="2772753">)</span>&nbsp;<span class="op" id="2772755">&amp;&amp;</span>&nbsp;<span class="builtintype" id="2772758">rune</span><span class="op" id="2772762">(</span><span class="ident" id="2772763">caseOrbit</span><span class="op" id="2772772">[</span><span class="ident" id="2772773">lo</span><span class="op" id="2772775">]</span><span class="op" id="2772776">.</span><span class="ident" id="2772777">From</span><span class="op" id="2772781">)</span>&nbsp;<span class="op" id="2772783">==</span>&nbsp;<span class="ident" id="2772786">r</span>&nbsp;<span class="op" id="2772788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2772792">return</span>&nbsp;<span class="builtintype" id="2772799">rune</span><span class="op" id="2772803">(</span><span class="ident" id="2772804">caseOrbit</span><span class="op" id="2772813">[</span><span class="ident" id="2772814">lo</span><span class="op" id="2772816">]</span><span class="op" id="2772817">.</span><span class="ident" id="2772818">To</span><span class="op" id="2772820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2772823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2772827">//&nbsp;No&nbsp;folding&nbsp;specified.&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;one-&nbsp;or&nbsp;two-element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2772884">//&nbsp;equivalence&nbsp;class&nbsp;containing&nbsp;rune&nbsp;and&nbsp;ToLower(rune)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2772940">//&nbsp;and&nbsp;ToUpper(rune)&nbsp;if&nbsp;they&nbsp;are&nbsp;different&nbsp;from&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2772995">if</span>&nbsp;<span class="ident" id="2772998">l</span>&nbsp;<span class="op" id="2773000">:=</span>&nbsp;<span class="ident" id="2773003">ToLower</span><span class="op" id="2773010">(</span><span class="ident" id="2773011">r</span><span class="op" id="2773012">)</span><span class="op" id="2773013">;</span>&nbsp;<span class="ident" id="2773015">l</span>&nbsp;<span class="op" id="2773017">!=</span>&nbsp;<span class="ident" id="2773020">r</span>&nbsp;<span class="op" id="2773022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2773026">return</span>&nbsp;<span class="ident" id="2773033">l</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2773036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2773039">return</span>&nbsp;<span class="ident" id="2773046">ToUpper</span><span class="op" id="2773053">(</span><span class="ident" id="2773054">r</span><span class="op" id="2773055">)</span><br>
<span class="lineno"></span><span class="op" id="2773057">}</span>
</div>
</body>
</html>
