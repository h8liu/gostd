<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html" class="current">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4673006">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4673062">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4673116">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4673167">package</span>&nbsp;<span class="ident" id="4673175">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4673185">//&nbsp;This&nbsp;is&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P224.&nbsp;See&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="4673260">//&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><span class="comment" id="4673278">//</span><br>
<span class="lineno">10</span><span class="comment" id="4673281">//&nbsp;See&nbsp;http://www.imperialviolet.org/2010/12/04/ecc.html&nbsp;([1])&nbsp;for&nbsp;background.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4673361">import</span>&nbsp;<span class="op" id="4673368">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4673371">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4673382">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4673385">var</span>&nbsp;<span class="ident" id="4673389">p224</span>&nbsp;<span class="ident" id="4673394">p224Curve</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4673405">type</span>&nbsp;<span class="ident" id="4673410">p224Curve</span>&nbsp;<span class="keyword" id="4673420">struct</span>&nbsp;<span class="op" id="4673427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4673430">*</span><span class="ident" id="4673431">CurveParams</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673444">gx</span><span class="op" id="4673446">,</span>&nbsp;<span class="ident" id="4673448">gy</span><span class="op" id="4673450">,</span>&nbsp;<span class="ident" id="4673452">b</span>&nbsp;<span class="ident" id="4673454">p224FieldElement</span><br>
<span class="lineno"></span><span class="op" id="4673471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4673474">func</span>&nbsp;<span class="ident" id="4673479">initP224</span><span class="op" id="4673487">(</span><span class="op" id="4673488">)</span>&nbsp;<span class="op" id="4673490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4673493">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673527">p224</span><span class="op" id="4673531">.</span><span class="ident" id="4673532">CurveParams</span>&nbsp;<span class="op" id="4673544">=</span>&nbsp;<span class="builtinfunc" id="4673546">new</span><span class="op" id="4673549">(</span><span class="ident" id="4673550">CurveParams</span><span class="op" id="4673561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673564">p224</span><span class="op" id="4673568">.</span><span class="ident" id="4673569">P</span><span class="op" id="4673570">,</span>&nbsp;<span class="ident" id="4673572">_</span>&nbsp;<span class="op" id="4673574">=</span>&nbsp;<span class="builtinfunc" id="4673576">new</span><span class="op" id="4673579">(</span><span class="ident" id="4673580">big</span><span class="op" id="4673583">.</span><span class="ident" id="4673584">Int</span><span class="op" id="4673587">)</span><span class="op" id="4673588">.</span><span class="ident" id="4673589">SetString</span><span class="op" id="4673598">(</span><span class="string" id="4673599">&#34;26959946667150639794667015087019630673557916260026308143510066298881&#34;</span><span class="op" id="4673669">,</span>&nbsp;<span class="num" id="4673671">10</span><span class="op" id="4673673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673676">p224</span><span class="op" id="4673680">.</span><span class="ident" id="4673681">N</span><span class="op" id="4673682">,</span>&nbsp;<span class="ident" id="4673684">_</span>&nbsp;<span class="op" id="4673686">=</span>&nbsp;<span class="builtinfunc" id="4673688">new</span><span class="op" id="4673691">(</span><span class="ident" id="4673692">big</span><span class="op" id="4673695">.</span><span class="ident" id="4673696">Int</span><span class="op" id="4673699">)</span><span class="op" id="4673700">.</span><span class="ident" id="4673701">SetString</span><span class="op" id="4673710">(</span><span class="string" id="4673711">&#34;26959946667150639794667015087019625940457807714424391721682722368061&#34;</span><span class="op" id="4673781">,</span>&nbsp;<span class="num" id="4673783">10</span><span class="op" id="4673785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673788">p224</span><span class="op" id="4673792">.</span><span class="ident" id="4673793">B</span><span class="op" id="4673794">,</span>&nbsp;<span class="ident" id="4673796">_</span>&nbsp;<span class="op" id="4673798">=</span>&nbsp;<span class="builtinfunc" id="4673800">new</span><span class="op" id="4673803">(</span><span class="ident" id="4673804">big</span><span class="op" id="4673807">.</span><span class="ident" id="4673808">Int</span><span class="op" id="4673811">)</span><span class="op" id="4673812">.</span><span class="ident" id="4673813">SetString</span><span class="op" id="4673822">(</span><span class="string" id="4673823">&#34;b4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4&#34;</span><span class="op" id="4673881">,</span>&nbsp;<span class="num" id="4673883">16</span><span class="op" id="4673885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673888">p224</span><span class="op" id="4673892">.</span><span class="ident" id="4673893">Gx</span><span class="op" id="4673895">,</span>&nbsp;<span class="ident" id="4673897">_</span>&nbsp;<span class="op" id="4673899">=</span>&nbsp;<span class="builtinfunc" id="4673901">new</span><span class="op" id="4673904">(</span><span class="ident" id="4673905">big</span><span class="op" id="4673908">.</span><span class="ident" id="4673909">Int</span><span class="op" id="4673912">)</span><span class="op" id="4673913">.</span><span class="ident" id="4673914">SetString</span><span class="op" id="4673923">(</span><span class="string" id="4673924">&#34;b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21&#34;</span><span class="op" id="4673982">,</span>&nbsp;<span class="num" id="4673984">16</span><span class="op" id="4673986">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673989">p224</span><span class="op" id="4673993">.</span><span class="ident" id="4673994">Gy</span><span class="op" id="4673996">,</span>&nbsp;<span class="ident" id="4673998">_</span>&nbsp;<span class="op" id="4674000">=</span>&nbsp;<span class="builtinfunc" id="4674002">new</span><span class="op" id="4674005">(</span><span class="ident" id="4674006">big</span><span class="op" id="4674009">.</span><span class="ident" id="4674010">Int</span><span class="op" id="4674013">)</span><span class="op" id="4674014">.</span><span class="ident" id="4674015">SetString</span><span class="op" id="4674024">(</span><span class="string" id="4674025">&#34;bd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34&#34;</span><span class="op" id="4674083">,</span>&nbsp;<span class="num" id="4674085">16</span><span class="op" id="4674087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674090">p224</span><span class="op" id="4674094">.</span><span class="ident" id="4674095">BitSize</span>&nbsp;<span class="op" id="4674103">=</span>&nbsp;<span class="num" id="4674105">224</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674111">p224FromBig</span><span class="op" id="4674122">(</span><span class="op" id="4674123">&amp;</span><span class="ident" id="4674124">p224</span><span class="op" id="4674128">.</span><span class="ident" id="4674129">gx</span><span class="op" id="4674131">,</span>&nbsp;<span class="ident" id="4674133">p224</span><span class="op" id="4674137">.</span><span class="ident" id="4674138">Gx</span><span class="op" id="4674140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674143">p224FromBig</span><span class="op" id="4674154">(</span><span class="op" id="4674155">&amp;</span><span class="ident" id="4674156">p224</span><span class="op" id="4674160">.</span><span class="ident" id="4674161">gy</span><span class="op" id="4674163">,</span>&nbsp;<span class="ident" id="4674165">p224</span><span class="op" id="4674169">.</span><span class="ident" id="4674170">Gy</span><span class="op" id="4674172">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674175">p224FromBig</span><span class="op" id="4674186">(</span><span class="op" id="4674187">&amp;</span><span class="ident" id="4674188">p224</span><span class="op" id="4674192">.</span><span class="ident" id="4674193">b</span><span class="op" id="4674194">,</span>&nbsp;<span class="ident" id="4674196">p224</span><span class="op" id="4674200">.</span><span class="ident" id="4674201">B</span><span class="op" id="4674202">)</span><br>
<span class="lineno"></span><span class="op" id="4674204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4674207">//&nbsp;P224&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-224&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2)</span><br>
<span class="lineno"></span><span class="keyword" id="4674286">func</span>&nbsp;<span class="ident" id="4674291">P224</span><span class="op" id="4674295">(</span><span class="op" id="4674296">)</span>&nbsp;<span class="ident" id="4674298">Curve</span>&nbsp;<span class="op" id="4674304">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674307">initonce</span><span class="op" id="4674315">.</span><span class="ident" id="4674316">Do</span><span class="op" id="4674318">(</span><span class="ident" id="4674319">initAll</span><span class="op" id="4674326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674329">return</span>&nbsp;<span class="ident" id="4674336">p224</span><br>
<span class="lineno"></span><span class="op" id="4674341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4674344">func</span>&nbsp;<span class="op" id="4674349">(</span><span class="ident" id="4674350">curve</span>&nbsp;<span class="ident" id="4674356">p224Curve</span><span class="op" id="4674365">)</span>&nbsp;<span class="ident" id="4674367">Params</span><span class="op" id="4674373">(</span><span class="op" id="4674374">)</span>&nbsp;<span class="op" id="4674376">*</span><span class="ident" id="4674377">CurveParams</span>&nbsp;<span class="op" id="4674389">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674392">return</span>&nbsp;<span class="ident" id="4674399">curve</span><span class="op" id="4674404">.</span><span class="ident" id="4674405">CurveParams</span><br>
<span class="lineno"></span><span class="op" id="4674417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4674420">func</span>&nbsp;<span class="op" id="4674425">(</span><span class="ident" id="4674426">curve</span>&nbsp;<span class="ident" id="4674432">p224Curve</span><span class="op" id="4674441">)</span>&nbsp;<span class="ident" id="4674443">IsOnCurve</span><span class="op" id="4674452">(</span><span class="ident" id="4674453">bigX</span><span class="op" id="4674457">,</span>&nbsp;<span class="ident" id="4674459">bigY</span>&nbsp;<span class="op" id="4674464">*</span><span class="ident" id="4674465">big</span><span class="op" id="4674468">.</span><span class="ident" id="4674469">Int</span><span class="op" id="4674472">)</span>&nbsp;<span class="builtintype" id="4674474">bool</span>&nbsp;<span class="op" id="4674479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674482">var</span>&nbsp;<span class="ident" id="4674486">x</span><span class="op" id="4674487">,</span>&nbsp;<span class="ident" id="4674489">y</span>&nbsp;<span class="ident" id="4674491">p224FieldElement</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674509">p224FromBig</span><span class="op" id="4674520">(</span><span class="op" id="4674521">&amp;</span><span class="ident" id="4674522">x</span><span class="op" id="4674523">,</span>&nbsp;<span class="ident" id="4674525">bigX</span><span class="op" id="4674529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674532">p224FromBig</span><span class="op" id="4674543">(</span><span class="op" id="4674544">&amp;</span><span class="ident" id="4674545">y</span><span class="op" id="4674546">,</span>&nbsp;<span class="ident" id="4674548">bigY</span><span class="op" id="4674552">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4674556">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674579">var</span>&nbsp;<span class="ident" id="4674583">tmp</span>&nbsp;<span class="ident" id="4674587">p224LargeFieldElement</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674610">var</span>&nbsp;<span class="ident" id="4674614">x3</span>&nbsp;<span class="ident" id="4674617">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674635">p224Square</span><span class="op" id="4674645">(</span><span class="op" id="4674646">&amp;</span><span class="ident" id="4674647">x3</span><span class="op" id="4674649">,</span>&nbsp;<span class="op" id="4674651">&amp;</span><span class="ident" id="4674652">x</span><span class="op" id="4674653">,</span>&nbsp;<span class="op" id="4674655">&amp;</span><span class="ident" id="4674656">tmp</span><span class="op" id="4674659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674662">p224Mul</span><span class="op" id="4674669">(</span><span class="op" id="4674670">&amp;</span><span class="ident" id="4674671">x3</span><span class="op" id="4674673">,</span>&nbsp;<span class="op" id="4674675">&amp;</span><span class="ident" id="4674676">x3</span><span class="op" id="4674678">,</span>&nbsp;<span class="op" id="4674680">&amp;</span><span class="ident" id="4674681">x</span><span class="op" id="4674682">,</span>&nbsp;<span class="op" id="4674684">&amp;</span><span class="ident" id="4674685">tmp</span><span class="op" id="4674688">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674692">for</span>&nbsp;<span class="ident" id="4674696">i</span>&nbsp;<span class="op" id="4674698">:=</span>&nbsp;<span class="num" id="4674701">0</span><span class="op" id="4674702">;</span>&nbsp;<span class="ident" id="4674704">i</span>&nbsp;<span class="op" id="4674706">&lt;</span>&nbsp;<span class="num" id="4674708">8</span><span class="op" id="4674709">;</span>&nbsp;<span class="ident" id="4674711">i</span><span class="op" id="4674712">++</span>&nbsp;<span class="op" id="4674715">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674719">x</span><span class="op" id="4674720">[</span><span class="ident" id="4674721">i</span><span class="op" id="4674722">]</span>&nbsp;<span class="op" id="4674724">*=</span>&nbsp;<span class="num" id="4674727">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4674730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674733">p224Sub</span><span class="op" id="4674740">(</span><span class="op" id="4674741">&amp;</span><span class="ident" id="4674742">x3</span><span class="op" id="4674744">,</span>&nbsp;<span class="op" id="4674746">&amp;</span><span class="ident" id="4674747">x3</span><span class="op" id="4674749">,</span>&nbsp;<span class="op" id="4674751">&amp;</span><span class="ident" id="4674752">x</span><span class="op" id="4674753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674756">p224Reduce</span><span class="op" id="4674766">(</span><span class="op" id="4674767">&amp;</span><span class="ident" id="4674768">x3</span><span class="op" id="4674770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674773">p224Add</span><span class="op" id="4674780">(</span><span class="op" id="4674781">&amp;</span><span class="ident" id="4674782">x3</span><span class="op" id="4674784">,</span>&nbsp;<span class="op" id="4674786">&amp;</span><span class="ident" id="4674787">x3</span><span class="op" id="4674789">,</span>&nbsp;<span class="op" id="4674791">&amp;</span><span class="ident" id="4674792">curve</span><span class="op" id="4674797">.</span><span class="ident" id="4674798">b</span><span class="op" id="4674799">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674802">p224Contract</span><span class="op" id="4674814">(</span><span class="op" id="4674815">&amp;</span><span class="ident" id="4674816">x3</span><span class="op" id="4674818">,</span>&nbsp;<span class="op" id="4674820">&amp;</span><span class="ident" id="4674821">x3</span><span class="op" id="4674823">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674827">p224Square</span><span class="op" id="4674837">(</span><span class="op" id="4674838">&amp;</span><span class="ident" id="4674839">y</span><span class="op" id="4674840">,</span>&nbsp;<span class="op" id="4674842">&amp;</span><span class="ident" id="4674843">y</span><span class="op" id="4674844">,</span>&nbsp;<span class="op" id="4674846">&amp;</span><span class="ident" id="4674847">tmp</span><span class="op" id="4674850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674853">p224Contract</span><span class="op" id="4674865">(</span><span class="op" id="4674866">&amp;</span><span class="ident" id="4674867">y</span><span class="op" id="4674868">,</span>&nbsp;<span class="op" id="4674870">&amp;</span><span class="ident" id="4674871">y</span><span class="op" id="4674872">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674876">for</span>&nbsp;<span class="ident" id="4674880">i</span>&nbsp;<span class="op" id="4674882">:=</span>&nbsp;<span class="num" id="4674885">0</span><span class="op" id="4674886">;</span>&nbsp;<span class="ident" id="4674888">i</span>&nbsp;<span class="op" id="4674890">&lt;</span>&nbsp;<span class="num" id="4674892">8</span><span class="op" id="4674893">;</span>&nbsp;<span class="ident" id="4674895">i</span><span class="op" id="4674896">++</span>&nbsp;<span class="op" id="4674899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674903">if</span>&nbsp;<span class="ident" id="4674906">y</span><span class="op" id="4674907">[</span><span class="ident" id="4674908">i</span><span class="op" id="4674909">]</span>&nbsp;<span class="op" id="4674911">!=</span>&nbsp;<span class="ident" id="4674914">x3</span><span class="op" id="4674916">[</span><span class="ident" id="4674917">i</span><span class="op" id="4674918">]</span>&nbsp;<span class="op" id="4674920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674925">return</span>&nbsp;<span class="builtintype" id="4674932">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4674940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4674943">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674946">return</span>&nbsp;<span class="builtintype" id="4674953">true</span><br>
<span class="lineno"></span><span class="op" id="4674958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4674961">func</span>&nbsp;<span class="op" id="4674966">(</span><span class="ident" id="4674967">p224Curve</span><span class="op" id="4674976">)</span>&nbsp;<span class="ident" id="4674978">Add</span><span class="op" id="4674981">(</span><span class="ident" id="4674982">bigX1</span><span class="op" id="4674987">,</span>&nbsp;<span class="ident" id="4674989">bigY1</span><span class="op" id="4674994">,</span>&nbsp;<span class="ident" id="4674996">bigX2</span><span class="op" id="4675001">,</span>&nbsp;<span class="ident" id="4675003">bigY2</span>&nbsp;<span class="op" id="4675009">*</span><span class="ident" id="4675010">big</span><span class="op" id="4675013">.</span><span class="ident" id="4675014">Int</span><span class="op" id="4675017">)</span>&nbsp;<span class="op" id="4675019">(</span><span class="ident" id="4675020">x</span><span class="op" id="4675021">,</span>&nbsp;<span class="ident" id="4675023">y</span>&nbsp;<span class="op" id="4675025">*</span><span class="ident" id="4675026">big</span><span class="op" id="4675029">.</span><span class="ident" id="4675030">Int</span><span class="op" id="4675033">)</span>&nbsp;<span class="op" id="4675035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675038">var</span>&nbsp;<span class="ident" id="4675042">x1</span><span class="op" id="4675044">,</span>&nbsp;<span class="ident" id="4675046">y1</span><span class="op" id="4675048">,</span>&nbsp;<span class="ident" id="4675050">z1</span><span class="op" id="4675052">,</span>&nbsp;<span class="ident" id="4675054">x2</span><span class="op" id="4675056">,</span>&nbsp;<span class="ident" id="4675058">y2</span><span class="op" id="4675060">,</span>&nbsp;<span class="ident" id="4675062">z2</span><span class="op" id="4675064">,</span>&nbsp;<span class="ident" id="4675066">x3</span><span class="op" id="4675068">,</span>&nbsp;<span class="ident" id="4675070">y3</span><span class="op" id="4675072">,</span>&nbsp;<span class="ident" id="4675074">z3</span>&nbsp;<span class="ident" id="4675077">p224FieldElement</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675096">p224FromBig</span><span class="op" id="4675107">(</span><span class="op" id="4675108">&amp;</span><span class="ident" id="4675109">x1</span><span class="op" id="4675111">,</span>&nbsp;<span class="ident" id="4675113">bigX1</span><span class="op" id="4675118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675121">p224FromBig</span><span class="op" id="4675132">(</span><span class="op" id="4675133">&amp;</span><span class="ident" id="4675134">y1</span><span class="op" id="4675136">,</span>&nbsp;<span class="ident" id="4675138">bigY1</span><span class="op" id="4675143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675146">if</span>&nbsp;<span class="ident" id="4675149">bigX1</span><span class="op" id="4675154">.</span><span class="ident" id="4675155">Sign</span><span class="op" id="4675159">(</span><span class="op" id="4675160">)</span>&nbsp;<span class="op" id="4675162">!=</span>&nbsp;<span class="num" id="4675165">0</span>&nbsp;<span class="op" id="4675167">||</span>&nbsp;<span class="ident" id="4675170">bigY1</span><span class="op" id="4675175">.</span><span class="ident" id="4675176">Sign</span><span class="op" id="4675180">(</span><span class="op" id="4675181">)</span>&nbsp;<span class="op" id="4675183">!=</span>&nbsp;<span class="num" id="4675186">0</span>&nbsp;<span class="op" id="4675188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675192">z1</span><span class="op" id="4675194">[</span><span class="num" id="4675195">0</span><span class="op" id="4675196">]</span>&nbsp;<span class="op" id="4675198">=</span>&nbsp;<span class="num" id="4675200">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675206">p224FromBig</span><span class="op" id="4675217">(</span><span class="op" id="4675218">&amp;</span><span class="ident" id="4675219">x2</span><span class="op" id="4675221">,</span>&nbsp;<span class="ident" id="4675223">bigX2</span><span class="op" id="4675228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675231">p224FromBig</span><span class="op" id="4675242">(</span><span class="op" id="4675243">&amp;</span><span class="ident" id="4675244">y2</span><span class="op" id="4675246">,</span>&nbsp;<span class="ident" id="4675248">bigY2</span><span class="op" id="4675253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675256">if</span>&nbsp;<span class="ident" id="4675259">bigX2</span><span class="op" id="4675264">.</span><span class="ident" id="4675265">Sign</span><span class="op" id="4675269">(</span><span class="op" id="4675270">)</span>&nbsp;<span class="op" id="4675272">!=</span>&nbsp;<span class="num" id="4675275">0</span>&nbsp;<span class="op" id="4675277">||</span>&nbsp;<span class="ident" id="4675280">bigY2</span><span class="op" id="4675285">.</span><span class="ident" id="4675286">Sign</span><span class="op" id="4675290">(</span><span class="op" id="4675291">)</span>&nbsp;<span class="op" id="4675293">!=</span>&nbsp;<span class="num" id="4675296">0</span>&nbsp;<span class="op" id="4675298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675302">z2</span><span class="op" id="4675304">[</span><span class="num" id="4675305">0</span><span class="op" id="4675306">]</span>&nbsp;<span class="op" id="4675308">=</span>&nbsp;<span class="num" id="4675310">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675317">p224AddJacobian</span><span class="op" id="4675332">(</span><span class="op" id="4675333">&amp;</span><span class="ident" id="4675334">x3</span><span class="op" id="4675336">,</span>&nbsp;<span class="op" id="4675338">&amp;</span><span class="ident" id="4675339">y3</span><span class="op" id="4675341">,</span>&nbsp;<span class="op" id="4675343">&amp;</span><span class="ident" id="4675344">z3</span><span class="op" id="4675346">,</span>&nbsp;<span class="op" id="4675348">&amp;</span><span class="ident" id="4675349">x1</span><span class="op" id="4675351">,</span>&nbsp;<span class="op" id="4675353">&amp;</span><span class="ident" id="4675354">y1</span><span class="op" id="4675356">,</span>&nbsp;<span class="op" id="4675358">&amp;</span><span class="ident" id="4675359">z1</span><span class="op" id="4675361">,</span>&nbsp;<span class="op" id="4675363">&amp;</span><span class="ident" id="4675364">x2</span><span class="op" id="4675366">,</span>&nbsp;<span class="op" id="4675368">&amp;</span><span class="ident" id="4675369">y2</span><span class="op" id="4675371">,</span>&nbsp;<span class="op" id="4675373">&amp;</span><span class="ident" id="4675374">z2</span><span class="op" id="4675376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675379">return</span>&nbsp;<span class="ident" id="4675386">p224ToAffine</span><span class="op" id="4675398">(</span><span class="op" id="4675399">&amp;</span><span class="ident" id="4675400">x3</span><span class="op" id="4675402">,</span>&nbsp;<span class="op" id="4675404">&amp;</span><span class="ident" id="4675405">y3</span><span class="op" id="4675407">,</span>&nbsp;<span class="op" id="4675409">&amp;</span><span class="ident" id="4675410">z3</span><span class="op" id="4675412">)</span><br>
<span class="lineno"></span><span class="op" id="4675414">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4675417">func</span>&nbsp;<span class="op" id="4675422">(</span><span class="ident" id="4675423">p224Curve</span><span class="op" id="4675432">)</span>&nbsp;<span class="ident" id="4675434">Double</span><span class="op" id="4675440">(</span><span class="ident" id="4675441">bigX1</span><span class="op" id="4675446">,</span>&nbsp;<span class="ident" id="4675448">bigY1</span>&nbsp;<span class="op" id="4675454">*</span><span class="ident" id="4675455">big</span><span class="op" id="4675458">.</span><span class="ident" id="4675459">Int</span><span class="op" id="4675462">)</span>&nbsp;<span class="op" id="4675464">(</span><span class="ident" id="4675465">x</span><span class="op" id="4675466">,</span>&nbsp;<span class="ident" id="4675468">y</span>&nbsp;<span class="op" id="4675470">*</span><span class="ident" id="4675471">big</span><span class="op" id="4675474">.</span><span class="ident" id="4675475">Int</span><span class="op" id="4675478">)</span>&nbsp;<span class="op" id="4675480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675483">var</span>&nbsp;<span class="ident" id="4675487">x1</span><span class="op" id="4675489">,</span>&nbsp;<span class="ident" id="4675491">y1</span><span class="op" id="4675493">,</span>&nbsp;<span class="ident" id="4675495">z1</span><span class="op" id="4675497">,</span>&nbsp;<span class="ident" id="4675499">x2</span><span class="op" id="4675501">,</span>&nbsp;<span class="ident" id="4675503">y2</span><span class="op" id="4675505">,</span>&nbsp;<span class="ident" id="4675507">z2</span>&nbsp;<span class="ident" id="4675510">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675529">p224FromBig</span><span class="op" id="4675540">(</span><span class="op" id="4675541">&amp;</span><span class="ident" id="4675542">x1</span><span class="op" id="4675544">,</span>&nbsp;<span class="ident" id="4675546">bigX1</span><span class="op" id="4675551">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675554">p224FromBig</span><span class="op" id="4675565">(</span><span class="op" id="4675566">&amp;</span><span class="ident" id="4675567">y1</span><span class="op" id="4675569">,</span>&nbsp;<span class="ident" id="4675571">bigY1</span><span class="op" id="4675576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675579">z1</span><span class="op" id="4675581">[</span><span class="num" id="4675582">0</span><span class="op" id="4675583">]</span>&nbsp;<span class="op" id="4675585">=</span>&nbsp;<span class="num" id="4675587">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675591">p224DoubleJacobian</span><span class="op" id="4675609">(</span><span class="op" id="4675610">&amp;</span><span class="ident" id="4675611">x2</span><span class="op" id="4675613">,</span>&nbsp;<span class="op" id="4675615">&amp;</span><span class="ident" id="4675616">y2</span><span class="op" id="4675618">,</span>&nbsp;<span class="op" id="4675620">&amp;</span><span class="ident" id="4675621">z2</span><span class="op" id="4675623">,</span>&nbsp;<span class="op" id="4675625">&amp;</span><span class="ident" id="4675626">x1</span><span class="op" id="4675628">,</span>&nbsp;<span class="op" id="4675630">&amp;</span><span class="ident" id="4675631">y1</span><span class="op" id="4675633">,</span>&nbsp;<span class="op" id="4675635">&amp;</span><span class="ident" id="4675636">z1</span><span class="op" id="4675638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675641">return</span>&nbsp;<span class="ident" id="4675648">p224ToAffine</span><span class="op" id="4675660">(</span><span class="op" id="4675661">&amp;</span><span class="ident" id="4675662">x2</span><span class="op" id="4675664">,</span>&nbsp;<span class="op" id="4675666">&amp;</span><span class="ident" id="4675667">y2</span><span class="op" id="4675669">,</span>&nbsp;<span class="op" id="4675671">&amp;</span><span class="ident" id="4675672">z2</span><span class="op" id="4675674">)</span><br>
<span class="lineno">105</span><span class="op" id="4675676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4675679">func</span>&nbsp;<span class="op" id="4675684">(</span><span class="ident" id="4675685">p224Curve</span><span class="op" id="4675694">)</span>&nbsp;<span class="ident" id="4675696">ScalarMult</span><span class="op" id="4675706">(</span><span class="ident" id="4675707">bigX1</span><span class="op" id="4675712">,</span>&nbsp;<span class="ident" id="4675714">bigY1</span>&nbsp;<span class="op" id="4675720">*</span><span class="ident" id="4675721">big</span><span class="op" id="4675724">.</span><span class="ident" id="4675725">Int</span><span class="op" id="4675728">,</span>&nbsp;<span class="ident" id="4675730">scalar</span>&nbsp;<span class="op" id="4675737">[</span><span class="op" id="4675738">]</span><span class="builtintype" id="4675739">byte</span><span class="op" id="4675743">)</span>&nbsp;<span class="op" id="4675745">(</span><span class="ident" id="4675746">x</span><span class="op" id="4675747">,</span>&nbsp;<span class="ident" id="4675749">y</span>&nbsp;<span class="op" id="4675751">*</span><span class="ident" id="4675752">big</span><span class="op" id="4675755">.</span><span class="ident" id="4675756">Int</span><span class="op" id="4675759">)</span>&nbsp;<span class="op" id="4675761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675764">var</span>&nbsp;<span class="ident" id="4675768">x1</span><span class="op" id="4675770">,</span>&nbsp;<span class="ident" id="4675772">y1</span><span class="op" id="4675774">,</span>&nbsp;<span class="ident" id="4675776">z1</span><span class="op" id="4675778">,</span>&nbsp;<span class="ident" id="4675780">x2</span><span class="op" id="4675782">,</span>&nbsp;<span class="ident" id="4675784">y2</span><span class="op" id="4675786">,</span>&nbsp;<span class="ident" id="4675788">z2</span>&nbsp;<span class="ident" id="4675791">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675810">p224FromBig</span><span class="op" id="4675821">(</span><span class="op" id="4675822">&amp;</span><span class="ident" id="4675823">x1</span><span class="op" id="4675825">,</span>&nbsp;<span class="ident" id="4675827">bigX1</span><span class="op" id="4675832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675835">p224FromBig</span><span class="op" id="4675846">(</span><span class="op" id="4675847">&amp;</span><span class="ident" id="4675848">y1</span><span class="op" id="4675850">,</span>&nbsp;<span class="ident" id="4675852">bigY1</span><span class="op" id="4675857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675860">z1</span><span class="op" id="4675862">[</span><span class="num" id="4675863">0</span><span class="op" id="4675864">]</span>&nbsp;<span class="op" id="4675866">=</span>&nbsp;<span class="num" id="4675868">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675872">p224ScalarMult</span><span class="op" id="4675886">(</span><span class="op" id="4675887">&amp;</span><span class="ident" id="4675888">x2</span><span class="op" id="4675890">,</span>&nbsp;<span class="op" id="4675892">&amp;</span><span class="ident" id="4675893">y2</span><span class="op" id="4675895">,</span>&nbsp;<span class="op" id="4675897">&amp;</span><span class="ident" id="4675898">z2</span><span class="op" id="4675900">,</span>&nbsp;<span class="op" id="4675902">&amp;</span><span class="ident" id="4675903">x1</span><span class="op" id="4675905">,</span>&nbsp;<span class="op" id="4675907">&amp;</span><span class="ident" id="4675908">y1</span><span class="op" id="4675910">,</span>&nbsp;<span class="op" id="4675912">&amp;</span><span class="ident" id="4675913">z1</span><span class="op" id="4675915">,</span>&nbsp;<span class="ident" id="4675917">scalar</span><span class="op" id="4675923">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675926">return</span>&nbsp;<span class="ident" id="4675933">p224ToAffine</span><span class="op" id="4675945">(</span><span class="op" id="4675946">&amp;</span><span class="ident" id="4675947">x2</span><span class="op" id="4675949">,</span>&nbsp;<span class="op" id="4675951">&amp;</span><span class="ident" id="4675952">y2</span><span class="op" id="4675954">,</span>&nbsp;<span class="op" id="4675956">&amp;</span><span class="ident" id="4675957">z2</span><span class="op" id="4675959">)</span><br>
<span class="lineno"></span><span class="op" id="4675961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4675964">func</span>&nbsp;<span class="op" id="4675969">(</span><span class="ident" id="4675970">curve</span>&nbsp;<span class="ident" id="4675976">p224Curve</span><span class="op" id="4675985">)</span>&nbsp;<span class="ident" id="4675987">ScalarBaseMult</span><span class="op" id="4676001">(</span><span class="ident" id="4676002">scalar</span>&nbsp;<span class="op" id="4676009">[</span><span class="op" id="4676010">]</span><span class="builtintype" id="4676011">byte</span><span class="op" id="4676015">)</span>&nbsp;<span class="op" id="4676017">(</span><span class="ident" id="4676018">x</span><span class="op" id="4676019">,</span>&nbsp;<span class="ident" id="4676021">y</span>&nbsp;<span class="op" id="4676023">*</span><span class="ident" id="4676024">big</span><span class="op" id="4676027">.</span><span class="ident" id="4676028">Int</span><span class="op" id="4676031">)</span>&nbsp;<span class="op" id="4676033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676036">var</span>&nbsp;<span class="ident" id="4676040">z1</span><span class="op" id="4676042">,</span>&nbsp;<span class="ident" id="4676044">x2</span><span class="op" id="4676046">,</span>&nbsp;<span class="ident" id="4676048">y2</span><span class="op" id="4676050">,</span>&nbsp;<span class="ident" id="4676052">z2</span>&nbsp;<span class="ident" id="4676055">p224FieldElement</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4676074">z1</span><span class="op" id="4676076">[</span><span class="num" id="4676077">0</span><span class="op" id="4676078">]</span>&nbsp;<span class="op" id="4676080">=</span>&nbsp;<span class="num" id="4676082">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4676085">p224ScalarMult</span><span class="op" id="4676099">(</span><span class="op" id="4676100">&amp;</span><span class="ident" id="4676101">x2</span><span class="op" id="4676103">,</span>&nbsp;<span class="op" id="4676105">&amp;</span><span class="ident" id="4676106">y2</span><span class="op" id="4676108">,</span>&nbsp;<span class="op" id="4676110">&amp;</span><span class="ident" id="4676111">z2</span><span class="op" id="4676113">,</span>&nbsp;<span class="op" id="4676115">&amp;</span><span class="ident" id="4676116">curve</span><span class="op" id="4676121">.</span><span class="ident" id="4676122">gx</span><span class="op" id="4676124">,</span>&nbsp;<span class="op" id="4676126">&amp;</span><span class="ident" id="4676127">curve</span><span class="op" id="4676132">.</span><span class="ident" id="4676133">gy</span><span class="op" id="4676135">,</span>&nbsp;<span class="op" id="4676137">&amp;</span><span class="ident" id="4676138">z1</span><span class="op" id="4676140">,</span>&nbsp;<span class="ident" id="4676142">scalar</span><span class="op" id="4676148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676151">return</span>&nbsp;<span class="ident" id="4676158">p224ToAffine</span><span class="op" id="4676170">(</span><span class="op" id="4676171">&amp;</span><span class="ident" id="4676172">x2</span><span class="op" id="4676174">,</span>&nbsp;<span class="op" id="4676176">&amp;</span><span class="ident" id="4676177">y2</span><span class="op" id="4676179">,</span>&nbsp;<span class="op" id="4676181">&amp;</span><span class="ident" id="4676182">z2</span><span class="op" id="4676184">)</span><br>
<span class="lineno"></span><span class="op" id="4676186">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4676189">//&nbsp;Field&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4676217">//</span><br>
<span class="lineno"></span><span class="comment" id="4676220">//&nbsp;The&nbsp;field&nbsp;that&nbsp;we&#39;re&nbsp;dealing&nbsp;with&nbsp;is&nbsp;ℤ/pℤ&nbsp;where&nbsp;p&nbsp;=&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;+&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="4676299">//</span><br>
<span class="lineno">130</span><span class="comment" id="4676302">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;by&nbsp;a&nbsp;FieldElement,&nbsp;which&nbsp;is&nbsp;a&nbsp;typedef&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4676380">//&nbsp;array&nbsp;of&nbsp;8&nbsp;uint32&#39;s.&nbsp;The&nbsp;value&nbsp;of&nbsp;a&nbsp;FieldElement,&nbsp;a,&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="4676440">//&nbsp;&nbsp;&nbsp;a[0]&nbsp;+&nbsp;2**28·a[1]&nbsp;+&nbsp;2**56·a[1]&nbsp;+&nbsp;...&nbsp;+&nbsp;2**196·a[7]</span><br>
<span class="lineno"></span><span class="comment" id="4676499">//</span><br>
<span class="lineno"></span><span class="comment" id="4676502">//&nbsp;Using&nbsp;28-bit&nbsp;limbs&nbsp;means&nbsp;that&nbsp;there&#39;s&nbsp;only&nbsp;4&nbsp;bits&nbsp;of&nbsp;headroom,&nbsp;which&nbsp;is&nbsp;less</span><br>
<span class="lineno">135</span><span class="comment" id="4676582">//&nbsp;than&nbsp;we&nbsp;would&nbsp;really&nbsp;like.&nbsp;But&nbsp;it&nbsp;has&nbsp;the&nbsp;useful&nbsp;feature&nbsp;that&nbsp;we&nbsp;hit&nbsp;2**224</span><br>
<span class="lineno"></span><span class="comment" id="4676661">//&nbsp;exactly,&nbsp;making&nbsp;the&nbsp;reflections&nbsp;during&nbsp;a&nbsp;reduce&nbsp;much&nbsp;nicer.</span><br>
<span class="lineno"></span><span class="keyword" id="4676724">type</span>&nbsp;<span class="ident" id="4676729">p224FieldElement</span>&nbsp;<span class="op" id="4676746">[</span><span class="num" id="4676747">8</span><span class="op" id="4676748">]</span><span class="builtintype" id="4676749">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4676757">//&nbsp;p224P&nbsp;is&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;field,&nbsp;represented&nbsp;as&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno">140</span><span class="keyword" id="4676828">var</span>&nbsp;<span class="ident" id="4676832">p224P</span>&nbsp;<span class="op" id="4676838">=</span>&nbsp;<span class="op" id="4676840">[</span><span class="num" id="4676841">8</span><span class="op" id="4676842">]</span><span class="builtintype" id="4676843">uint32</span><span class="op" id="4676849">{</span><span class="num" id="4676850">1</span><span class="op" id="4676851">,</span>&nbsp;<span class="num" id="4676853">0</span><span class="op" id="4676854">,</span>&nbsp;<span class="num" id="4676856">0</span><span class="op" id="4676857">,</span>&nbsp;<span class="num" id="4676859">0xffff000</span><span class="op" id="4676868">,</span>&nbsp;<span class="num" id="4676870">0xfffffff</span><span class="op" id="4676879">,</span>&nbsp;<span class="num" id="4676881">0xfffffff</span><span class="op" id="4676890">,</span>&nbsp;<span class="num" id="4676892">0xfffffff</span><span class="op" id="4676901">,</span>&nbsp;<span class="num" id="4676903">0xfffffff</span><span class="op" id="4676912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4676915">//&nbsp;p224IsZero&nbsp;returns&nbsp;1&nbsp;if&nbsp;a&nbsp;==&nbsp;0&nbsp;mod&nbsp;p&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4676972">//</span><br>
<span class="lineno"></span><span class="comment" id="4676975">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">145</span><span class="keyword" id="4676991">func</span>&nbsp;<span class="ident" id="4676996">p224IsZero</span><span class="op" id="4677006">(</span><span class="ident" id="4677007">a</span>&nbsp;<span class="op" id="4677009">*</span><span class="ident" id="4677010">p224FieldElement</span><span class="op" id="4677026">)</span>&nbsp;<span class="builtintype" id="4677028">uint32</span>&nbsp;<span class="op" id="4677035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677038">//&nbsp;Since&nbsp;a&nbsp;p224FieldElement&nbsp;contains&nbsp;224&nbsp;bits&nbsp;there&nbsp;are&nbsp;two&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677108">//&nbsp;representations&nbsp;of&nbsp;0:&nbsp;0&nbsp;and&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677143">var</span>&nbsp;<span class="ident" id="4677147">minimal</span>&nbsp;<span class="ident" id="4677155">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677173">p224Contract</span><span class="op" id="4677185">(</span><span class="op" id="4677186">&amp;</span><span class="ident" id="4677187">minimal</span><span class="op" id="4677194">,</span>&nbsp;<span class="ident" id="4677196">a</span><span class="op" id="4677197">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677201">var</span>&nbsp;<span class="ident" id="4677205">isZero</span><span class="op" id="4677211">,</span>&nbsp;<span class="ident" id="4677213">isP</span>&nbsp;<span class="builtintype" id="4677217">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677225">for</span>&nbsp;<span class="ident" id="4677229">i</span><span class="op" id="4677230">,</span>&nbsp;<span class="ident" id="4677232">v</span>&nbsp;<span class="op" id="4677234">:=</span>&nbsp;<span class="keyword" id="4677237">range</span>&nbsp;<span class="ident" id="4677243">minimal</span>&nbsp;<span class="op" id="4677251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677255">isZero</span>&nbsp;<span class="op" id="4677262">|=</span>&nbsp;<span class="ident" id="4677265">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677269">isP</span>&nbsp;<span class="op" id="4677273">|=</span>&nbsp;<span class="ident" id="4677276">v</span>&nbsp;<span class="op" id="4677278">-</span>&nbsp;<span class="ident" id="4677280">p224P</span><span class="op" id="4677285">[</span><span class="ident" id="4677286">i</span><span class="op" id="4677287">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4677290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677294">//&nbsp;If&nbsp;either&nbsp;isZero&nbsp;or&nbsp;isP&nbsp;is&nbsp;0,&nbsp;then&nbsp;we&nbsp;should&nbsp;return&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677353">isZero</span>&nbsp;<span class="op" id="4677360">|=</span>&nbsp;<span class="ident" id="4677363">isZero</span>&nbsp;<span class="op" id="4677370">&gt;&gt;</span>&nbsp;<span class="num" id="4677373">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677377">isZero</span>&nbsp;<span class="op" id="4677384">|=</span>&nbsp;<span class="ident" id="4677387">isZero</span>&nbsp;<span class="op" id="4677394">&gt;&gt;</span>&nbsp;<span class="num" id="4677397">8</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677400">isZero</span>&nbsp;<span class="op" id="4677407">|=</span>&nbsp;<span class="ident" id="4677410">isZero</span>&nbsp;<span class="op" id="4677417">&gt;&gt;</span>&nbsp;<span class="num" id="4677420">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677423">isZero</span>&nbsp;<span class="op" id="4677430">|=</span>&nbsp;<span class="ident" id="4677433">isZero</span>&nbsp;<span class="op" id="4677440">&gt;&gt;</span>&nbsp;<span class="num" id="4677443">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677446">isZero</span>&nbsp;<span class="op" id="4677453">|=</span>&nbsp;<span class="ident" id="4677456">isZero</span>&nbsp;<span class="op" id="4677463">&gt;&gt;</span>&nbsp;<span class="num" id="4677466">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677470">isP</span>&nbsp;<span class="op" id="4677474">|=</span>&nbsp;<span class="ident" id="4677477">isP</span>&nbsp;<span class="op" id="4677481">&gt;&gt;</span>&nbsp;<span class="num" id="4677484">16</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677488">isP</span>&nbsp;<span class="op" id="4677492">|=</span>&nbsp;<span class="ident" id="4677495">isP</span>&nbsp;<span class="op" id="4677499">&gt;&gt;</span>&nbsp;<span class="num" id="4677502">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677505">isP</span>&nbsp;<span class="op" id="4677509">|=</span>&nbsp;<span class="ident" id="4677512">isP</span>&nbsp;<span class="op" id="4677516">&gt;&gt;</span>&nbsp;<span class="num" id="4677519">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677522">isP</span>&nbsp;<span class="op" id="4677526">|=</span>&nbsp;<span class="ident" id="4677529">isP</span>&nbsp;<span class="op" id="4677533">&gt;&gt;</span>&nbsp;<span class="num" id="4677536">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677539">isP</span>&nbsp;<span class="op" id="4677543">|=</span>&nbsp;<span class="ident" id="4677546">isP</span>&nbsp;<span class="op" id="4677550">&gt;&gt;</span>&nbsp;<span class="num" id="4677553">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677557">//&nbsp;For&nbsp;isZero&nbsp;and&nbsp;isP,&nbsp;the&nbsp;LSB&nbsp;is&nbsp;0&nbsp;iff&nbsp;all&nbsp;the&nbsp;bits&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677621">result</span>&nbsp;<span class="op" id="4677628">:=</span>&nbsp;<span class="ident" id="4677631">isZero</span>&nbsp;<span class="op" id="4677638">&amp;</span>&nbsp;<span class="ident" id="4677640">isP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677645">result</span>&nbsp;<span class="op" id="4677652">=</span>&nbsp;<span class="op" id="4677654">(</span><span class="op" id="4677655">^</span><span class="ident" id="4677656">result</span><span class="op" id="4677662">)</span>&nbsp;<span class="op" id="4677664">&amp;</span>&nbsp;<span class="num" id="4677666">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677670">return</span>&nbsp;<span class="ident" id="4677677">result</span><br>
<span class="lineno">175</span><span class="op" id="4677684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4677687">//&nbsp;p224Add&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b</span><br>
<span class="lineno"></span><span class="comment" id="4677718">//</span><br>
<span class="lineno"></span><span class="comment" id="4677721">//&nbsp;a[i]&nbsp;+&nbsp;b[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno">180</span><span class="keyword" id="4677744">func</span>&nbsp;<span class="ident" id="4677749">p224Add</span><span class="op" id="4677756">(</span><span class="ident" id="4677757">out</span><span class="op" id="4677760">,</span>&nbsp;<span class="ident" id="4677762">a</span><span class="op" id="4677763">,</span>&nbsp;<span class="ident" id="4677765">b</span>&nbsp;<span class="op" id="4677767">*</span><span class="ident" id="4677768">p224FieldElement</span><span class="op" id="4677784">)</span>&nbsp;<span class="op" id="4677786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677789">for</span>&nbsp;<span class="ident" id="4677793">i</span>&nbsp;<span class="op" id="4677795">:=</span>&nbsp;<span class="num" id="4677798">0</span><span class="op" id="4677799">;</span>&nbsp;<span class="ident" id="4677801">i</span>&nbsp;<span class="op" id="4677803">&lt;</span>&nbsp;<span class="num" id="4677805">8</span><span class="op" id="4677806">;</span>&nbsp;<span class="ident" id="4677808">i</span><span class="op" id="4677809">++</span>&nbsp;<span class="op" id="4677812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677816">out</span><span class="op" id="4677819">[</span><span class="ident" id="4677820">i</span><span class="op" id="4677821">]</span>&nbsp;<span class="op" id="4677823">=</span>&nbsp;<span class="ident" id="4677825">a</span><span class="op" id="4677826">[</span><span class="ident" id="4677827">i</span><span class="op" id="4677828">]</span>&nbsp;<span class="op" id="4677830">+</span>&nbsp;<span class="ident" id="4677832">b</span><span class="op" id="4677833">[</span><span class="ident" id="4677834">i</span><span class="op" id="4677835">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4677838">}</span><br>
<span class="lineno"></span><span class="op" id="4677840">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="4677843">const</span>&nbsp;<span class="ident" id="4677849">two31p3</span>&nbsp;<span class="op" id="4677857">=</span>&nbsp;<span class="num" id="4677859">1</span><span class="op" id="4677860">&lt;&lt;</span><span class="num" id="4677862">31</span>&nbsp;<span class="op" id="4677865">+</span>&nbsp;<span class="num" id="4677867">1</span><span class="op" id="4677868">&lt;&lt;</span><span class="num" id="4677870">3</span><br>
<span class="lineno"></span><span class="keyword" id="4677872">const</span>&nbsp;<span class="ident" id="4677878">two31m3</span>&nbsp;<span class="op" id="4677886">=</span>&nbsp;<span class="num" id="4677888">1</span><span class="op" id="4677889">&lt;&lt;</span><span class="num" id="4677891">31</span>&nbsp;<span class="op" id="4677894">-</span>&nbsp;<span class="num" id="4677896">1</span><span class="op" id="4677897">&lt;&lt;</span><span class="num" id="4677899">3</span><br>
<span class="lineno"></span><span class="keyword" id="4677901">const</span>&nbsp;<span class="ident" id="4677907">two31m15m3</span>&nbsp;<span class="op" id="4677918">=</span>&nbsp;<span class="num" id="4677920">1</span><span class="op" id="4677921">&lt;&lt;</span><span class="num" id="4677923">31</span>&nbsp;<span class="op" id="4677926">-</span>&nbsp;<span class="num" id="4677928">1</span><span class="op" id="4677929">&lt;&lt;</span><span class="num" id="4677931">15</span>&nbsp;<span class="op" id="4677934">-</span>&nbsp;<span class="num" id="4677936">1</span><span class="op" id="4677937">&lt;&lt;</span><span class="num" id="4677939">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4677942">//&nbsp;p224ZeroModP31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;31&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="4678019">//&nbsp;subtract&nbsp;smaller&nbsp;amounts&nbsp;without&nbsp;underflow.&nbsp;See&nbsp;the&nbsp;section&nbsp;&#34;Subtraction&#34;&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4678099">//&nbsp;[1]&nbsp;for&nbsp;reasoning.</span><br>
<span class="lineno"></span><span class="keyword" id="4678121">var</span>&nbsp;<span class="ident" id="4678125">p224ZeroModP31</span>&nbsp;<span class="op" id="4678140">=</span>&nbsp;<span class="op" id="4678142">[</span><span class="op" id="4678143">]</span><span class="builtintype" id="4678144">uint32</span><span class="op" id="4678150">{</span><span class="ident" id="4678151">two31p3</span><span class="op" id="4678158">,</span>&nbsp;<span class="ident" id="4678160">two31m3</span><span class="op" id="4678167">,</span>&nbsp;<span class="ident" id="4678169">two31m3</span><span class="op" id="4678176">,</span>&nbsp;<span class="ident" id="4678178">two31m15m3</span><span class="op" id="4678188">,</span>&nbsp;<span class="ident" id="4678190">two31m3</span><span class="op" id="4678197">,</span>&nbsp;<span class="ident" id="4678199">two31m3</span><span class="op" id="4678206">,</span>&nbsp;<span class="ident" id="4678208">two31m3</span><span class="op" id="4678215">,</span>&nbsp;<span class="ident" id="4678217">two31m3</span><span class="op" id="4678224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="4678227">//&nbsp;p224Sub&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a-b</span><br>
<span class="lineno"></span><span class="comment" id="4678258">//</span><br>
<span class="lineno"></span><span class="comment" id="4678261">//&nbsp;a[i],&nbsp;b[i]&nbsp;&lt;&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4678283">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno"></span><span class="keyword" id="4678301">func</span>&nbsp;<span class="ident" id="4678306">p224Sub</span><span class="op" id="4678313">(</span><span class="ident" id="4678314">out</span><span class="op" id="4678317">,</span>&nbsp;<span class="ident" id="4678319">a</span><span class="op" id="4678320">,</span>&nbsp;<span class="ident" id="4678322">b</span>&nbsp;<span class="op" id="4678324">*</span><span class="ident" id="4678325">p224FieldElement</span><span class="op" id="4678341">)</span>&nbsp;<span class="op" id="4678343">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678346">for</span>&nbsp;<span class="ident" id="4678350">i</span>&nbsp;<span class="op" id="4678352">:=</span>&nbsp;<span class="num" id="4678355">0</span><span class="op" id="4678356">;</span>&nbsp;<span class="ident" id="4678358">i</span>&nbsp;<span class="op" id="4678360">&lt;</span>&nbsp;<span class="num" id="4678362">8</span><span class="op" id="4678363">;</span>&nbsp;<span class="ident" id="4678365">i</span><span class="op" id="4678366">++</span>&nbsp;<span class="op" id="4678369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4678373">out</span><span class="op" id="4678376">[</span><span class="ident" id="4678377">i</span><span class="op" id="4678378">]</span>&nbsp;<span class="op" id="4678380">=</span>&nbsp;<span class="ident" id="4678382">a</span><span class="op" id="4678383">[</span><span class="ident" id="4678384">i</span><span class="op" id="4678385">]</span>&nbsp;<span class="op" id="4678387">+</span>&nbsp;<span class="ident" id="4678389">p224ZeroModP31</span><span class="op" id="4678403">[</span><span class="ident" id="4678404">i</span><span class="op" id="4678405">]</span>&nbsp;<span class="op" id="4678407">-</span>&nbsp;<span class="ident" id="4678409">b</span><span class="op" id="4678410">[</span><span class="ident" id="4678411">i</span><span class="op" id="4678412">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4678415">}</span><br>
<span class="lineno"></span><span class="op" id="4678417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="4678420">//&nbsp;LargeFieldElement&nbsp;also&nbsp;represents&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;field.&nbsp;The&nbsp;limbs&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4678496">//&nbsp;still&nbsp;spaced&nbsp;28-bits&nbsp;apart&nbsp;and&nbsp;in&nbsp;little-endian&nbsp;order.&nbsp;So&nbsp;the&nbsp;limbs&nbsp;are&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4678574">//&nbsp;0,&nbsp;28,&nbsp;56,&nbsp;...,&nbsp;392&nbsp;bits,&nbsp;each&nbsp;64-bits&nbsp;wide.</span><br>
<span class="lineno"></span><span class="keyword" id="4678622">type</span>&nbsp;<span class="ident" id="4678627">p224LargeFieldElement</span>&nbsp;<span class="op" id="4678649">[</span><span class="num" id="4678650">15</span><span class="op" id="4678652">]</span><span class="ident" id="4678653">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4678661">const</span>&nbsp;<span class="ident" id="4678667">two63p35</span>&nbsp;<span class="op" id="4678676">=</span>&nbsp;<span class="num" id="4678678">1</span><span class="op" id="4678679">&lt;&lt;</span><span class="num" id="4678681">63</span>&nbsp;<span class="op" id="4678684">+</span>&nbsp;<span class="num" id="4678686">1</span><span class="op" id="4678687">&lt;&lt;</span><span class="num" id="4678689">35</span><br>
<span class="lineno"></span><span class="keyword" id="4678692">const</span>&nbsp;<span class="ident" id="4678698">two63m35</span>&nbsp;<span class="op" id="4678707">=</span>&nbsp;<span class="num" id="4678709">1</span><span class="op" id="4678710">&lt;&lt;</span><span class="num" id="4678712">63</span>&nbsp;<span class="op" id="4678715">-</span>&nbsp;<span class="num" id="4678717">1</span><span class="op" id="4678718">&lt;&lt;</span><span class="num" id="4678720">35</span><br>
<span class="lineno"></span><span class="keyword" id="4678723">const</span>&nbsp;<span class="ident" id="4678729">two63m35m19</span>&nbsp;<span class="op" id="4678741">=</span>&nbsp;<span class="num" id="4678743">1</span><span class="op" id="4678744">&lt;&lt;</span><span class="num" id="4678746">63</span>&nbsp;<span class="op" id="4678749">-</span>&nbsp;<span class="num" id="4678751">1</span><span class="op" id="4678752">&lt;&lt;</span><span class="num" id="4678754">35</span>&nbsp;<span class="op" id="4678757">-</span>&nbsp;<span class="num" id="4678759">1</span><span class="op" id="4678760">&lt;&lt;</span><span class="num" id="4678762">19</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4678766">//&nbsp;p224ZeroModP63&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;63&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs.&nbsp;See&nbsp;the&nbsp;section</span><br>
<span class="lineno">215</span><span class="comment" id="4678845">//&nbsp;&#34;Subtraction&#34;&nbsp;in&nbsp;[1]&nbsp;for&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="4678878">var</span>&nbsp;<span class="ident" id="4678882">p224ZeroModP63</span>&nbsp;<span class="op" id="4678897">=</span>&nbsp;<span class="op" id="4678899">[</span><span class="num" id="4678900">8</span><span class="op" id="4678901">]</span><span class="ident" id="4678902">uint64</span><span class="op" id="4678908">{</span><span class="ident" id="4678909">two63p35</span><span class="op" id="4678917">,</span>&nbsp;<span class="ident" id="4678919">two63m35</span><span class="op" id="4678927">,</span>&nbsp;<span class="ident" id="4678929">two63m35</span><span class="op" id="4678937">,</span>&nbsp;<span class="ident" id="4678939">two63m35</span><span class="op" id="4678947">,</span>&nbsp;<span class="ident" id="4678949">two63m35m19</span><span class="op" id="4678960">,</span>&nbsp;<span class="ident" id="4678962">two63m35</span><span class="op" id="4678970">,</span>&nbsp;<span class="ident" id="4678972">two63m35</span><span class="op" id="4678980">,</span>&nbsp;<span class="ident" id="4678982">two63m35</span><span class="op" id="4678990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4678993">const</span>&nbsp;<span class="ident" id="4678999">bottom12Bits</span>&nbsp;<span class="op" id="4679012">=</span>&nbsp;<span class="num" id="4679014">0xfff</span><br>
<span class="lineno"></span><span class="keyword" id="4679020">const</span>&nbsp;<span class="ident" id="4679026">bottom28Bits</span>&nbsp;<span class="op" id="4679039">=</span>&nbsp;<span class="num" id="4679041">0xfffffff</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="4679052">//&nbsp;p224Mul&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*b</span><br>
<span class="lineno"></span><span class="comment" id="4679083">//</span><br>
<span class="lineno"></span><span class="comment" id="4679086">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29,&nbsp;b[i]&nbsp;&lt;&nbsp;2**30&nbsp;(or&nbsp;vice&nbsp;versa)</span><br>
<span class="lineno"></span><span class="comment" id="4679132">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">225</span><span class="keyword" id="4679150">func</span>&nbsp;<span class="ident" id="4679155">p224Mul</span><span class="op" id="4679162">(</span><span class="ident" id="4679163">out</span><span class="op" id="4679166">,</span>&nbsp;<span class="ident" id="4679168">a</span><span class="op" id="4679169">,</span>&nbsp;<span class="ident" id="4679171">b</span>&nbsp;<span class="op" id="4679173">*</span><span class="ident" id="4679174">p224FieldElement</span><span class="op" id="4679190">,</span>&nbsp;<span class="ident" id="4679192">tmp</span>&nbsp;<span class="op" id="4679196">*</span><span class="ident" id="4679197">p224LargeFieldElement</span><span class="op" id="4679218">)</span>&nbsp;<span class="op" id="4679220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679223">for</span>&nbsp;<span class="ident" id="4679227">i</span>&nbsp;<span class="op" id="4679229">:=</span>&nbsp;<span class="num" id="4679232">0</span><span class="op" id="4679233">;</span>&nbsp;<span class="ident" id="4679235">i</span>&nbsp;<span class="op" id="4679237">&lt;</span>&nbsp;<span class="num" id="4679239">15</span><span class="op" id="4679241">;</span>&nbsp;<span class="ident" id="4679243">i</span><span class="op" id="4679244">++</span>&nbsp;<span class="op" id="4679247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679251">tmp</span><span class="op" id="4679254">[</span><span class="ident" id="4679255">i</span><span class="op" id="4679256">]</span>&nbsp;<span class="op" id="4679258">=</span>&nbsp;<span class="num" id="4679260">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679267">for</span>&nbsp;<span class="ident" id="4679271">i</span>&nbsp;<span class="op" id="4679273">:=</span>&nbsp;<span class="num" id="4679276">0</span><span class="op" id="4679277">;</span>&nbsp;<span class="ident" id="4679279">i</span>&nbsp;<span class="op" id="4679281">&lt;</span>&nbsp;<span class="num" id="4679283">8</span><span class="op" id="4679284">;</span>&nbsp;<span class="ident" id="4679286">i</span><span class="op" id="4679287">++</span>&nbsp;<span class="op" id="4679290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679294">for</span>&nbsp;<span class="ident" id="4679298">j</span>&nbsp;<span class="op" id="4679300">:=</span>&nbsp;<span class="num" id="4679303">0</span><span class="op" id="4679304">;</span>&nbsp;<span class="ident" id="4679306">j</span>&nbsp;<span class="op" id="4679308">&lt;</span>&nbsp;<span class="num" id="4679310">8</span><span class="op" id="4679311">;</span>&nbsp;<span class="ident" id="4679313">j</span><span class="op" id="4679314">++</span>&nbsp;<span class="op" id="4679317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679322">tmp</span><span class="op" id="4679325">[</span><span class="ident" id="4679326">i</span><span class="op" id="4679327">+</span><span class="ident" id="4679328">j</span><span class="op" id="4679329">]</span>&nbsp;<span class="op" id="4679331">+=</span>&nbsp;<span class="ident" id="4679334">uint64</span><span class="op" id="4679340">(</span><span class="ident" id="4679341">a</span><span class="op" id="4679342">[</span><span class="ident" id="4679343">i</span><span class="op" id="4679344">]</span><span class="op" id="4679345">)</span>&nbsp;<span class="op" id="4679347">*</span>&nbsp;<span class="ident" id="4679349">uint64</span><span class="op" id="4679355">(</span><span class="ident" id="4679356">b</span><span class="op" id="4679357">[</span><span class="ident" id="4679358">j</span><span class="op" id="4679359">]</span><span class="op" id="4679360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679367">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679371">p224ReduceLarge</span><span class="op" id="4679386">(</span><span class="ident" id="4679387">out</span><span class="op" id="4679390">,</span>&nbsp;<span class="ident" id="4679392">tmp</span><span class="op" id="4679395">)</span><br>
<span class="lineno"></span><span class="op" id="4679397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4679400">//&nbsp;Square&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*a</span><br>
<span class="lineno">240</span><span class="comment" id="4679430">//</span><br>
<span class="lineno"></span><span class="comment" id="4679433">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4679449">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword" id="4679467">func</span>&nbsp;<span class="ident" id="4679472">p224Square</span><span class="op" id="4679482">(</span><span class="ident" id="4679483">out</span><span class="op" id="4679486">,</span>&nbsp;<span class="ident" id="4679488">a</span>&nbsp;<span class="op" id="4679490">*</span><span class="ident" id="4679491">p224FieldElement</span><span class="op" id="4679507">,</span>&nbsp;<span class="ident" id="4679509">tmp</span>&nbsp;<span class="op" id="4679513">*</span><span class="ident" id="4679514">p224LargeFieldElement</span><span class="op" id="4679535">)</span>&nbsp;<span class="op" id="4679537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679540">for</span>&nbsp;<span class="ident" id="4679544">i</span>&nbsp;<span class="op" id="4679546">:=</span>&nbsp;<span class="num" id="4679549">0</span><span class="op" id="4679550">;</span>&nbsp;<span class="ident" id="4679552">i</span>&nbsp;<span class="op" id="4679554">&lt;</span>&nbsp;<span class="num" id="4679556">15</span><span class="op" id="4679558">;</span>&nbsp;<span class="ident" id="4679560">i</span><span class="op" id="4679561">++</span>&nbsp;<span class="op" id="4679564">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679568">tmp</span><span class="op" id="4679571">[</span><span class="ident" id="4679572">i</span><span class="op" id="4679573">]</span>&nbsp;<span class="op" id="4679575">=</span>&nbsp;<span class="num" id="4679577">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679584">for</span>&nbsp;<span class="ident" id="4679588">i</span>&nbsp;<span class="op" id="4679590">:=</span>&nbsp;<span class="num" id="4679593">0</span><span class="op" id="4679594">;</span>&nbsp;<span class="ident" id="4679596">i</span>&nbsp;<span class="op" id="4679598">&lt;</span>&nbsp;<span class="num" id="4679600">8</span><span class="op" id="4679601">;</span>&nbsp;<span class="ident" id="4679603">i</span><span class="op" id="4679604">++</span>&nbsp;<span class="op" id="4679607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679611">for</span>&nbsp;<span class="ident" id="4679615">j</span>&nbsp;<span class="op" id="4679617">:=</span>&nbsp;<span class="num" id="4679620">0</span><span class="op" id="4679621">;</span>&nbsp;<span class="ident" id="4679623">j</span>&nbsp;<span class="op" id="4679625">&lt;=</span>&nbsp;<span class="ident" id="4679628">i</span><span class="op" id="4679629">;</span>&nbsp;<span class="ident" id="4679631">j</span><span class="op" id="4679632">++</span>&nbsp;<span class="op" id="4679635">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679640">r</span>&nbsp;<span class="op" id="4679642">:=</span>&nbsp;<span class="ident" id="4679645">uint64</span><span class="op" id="4679651">(</span><span class="ident" id="4679652">a</span><span class="op" id="4679653">[</span><span class="ident" id="4679654">i</span><span class="op" id="4679655">]</span><span class="op" id="4679656">)</span>&nbsp;<span class="op" id="4679658">*</span>&nbsp;<span class="ident" id="4679660">uint64</span><span class="op" id="4679666">(</span><span class="ident" id="4679667">a</span><span class="op" id="4679668">[</span><span class="ident" id="4679669">j</span><span class="op" id="4679670">]</span><span class="op" id="4679671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679676">if</span>&nbsp;<span class="ident" id="4679679">i</span>&nbsp;<span class="op" id="4679681">==</span>&nbsp;<span class="ident" id="4679684">j</span>&nbsp;<span class="op" id="4679686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679692">tmp</span><span class="op" id="4679695">[</span><span class="ident" id="4679696">i</span><span class="op" id="4679697">+</span><span class="ident" id="4679698">j</span><span class="op" id="4679699">]</span>&nbsp;<span class="op" id="4679701">+=</span>&nbsp;<span class="ident" id="4679704">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679709">}</span>&nbsp;<span class="keyword" id="4679711">else</span>&nbsp;<span class="op" id="4679716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679722">tmp</span><span class="op" id="4679725">[</span><span class="ident" id="4679726">i</span><span class="op" id="4679727">+</span><span class="ident" id="4679728">j</span><span class="op" id="4679729">]</span>&nbsp;<span class="op" id="4679731">+=</span>&nbsp;<span class="ident" id="4679734">r</span>&nbsp;<span class="op" id="4679736">&lt;&lt;</span>&nbsp;<span class="num" id="4679739">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679755">p224ReduceLarge</span><span class="op" id="4679770">(</span><span class="ident" id="4679771">out</span><span class="op" id="4679774">,</span>&nbsp;<span class="ident" id="4679776">tmp</span><span class="op" id="4679779">)</span><br>
<span class="lineno">260</span><span class="op" id="4679781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4679784">//&nbsp;ReduceLarge&nbsp;converts&nbsp;a&nbsp;p224LargeFieldElement&nbsp;to&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno"></span><span class="comment" id="4679855">//</span><br>
<span class="lineno"></span><span class="comment" id="4679858">//&nbsp;in[i]&nbsp;&lt;&nbsp;2**62</span><br>
<span class="lineno">265</span><span class="keyword" id="4679875">func</span>&nbsp;<span class="ident" id="4679880">p224ReduceLarge</span><span class="op" id="4679895">(</span><span class="ident" id="4679896">out</span>&nbsp;<span class="op" id="4679900">*</span><span class="ident" id="4679901">p224FieldElement</span><span class="op" id="4679917">,</span>&nbsp;<span class="ident" id="4679919">in</span>&nbsp;<span class="op" id="4679922">*</span><span class="ident" id="4679923">p224LargeFieldElement</span><span class="op" id="4679944">)</span>&nbsp;<span class="op" id="4679946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679949">for</span>&nbsp;<span class="ident" id="4679953">i</span>&nbsp;<span class="op" id="4679955">:=</span>&nbsp;<span class="num" id="4679958">0</span><span class="op" id="4679959">;</span>&nbsp;<span class="ident" id="4679961">i</span>&nbsp;<span class="op" id="4679963">&lt;</span>&nbsp;<span class="num" id="4679965">8</span><span class="op" id="4679966">;</span>&nbsp;<span class="ident" id="4679968">i</span><span class="op" id="4679969">++</span>&nbsp;<span class="op" id="4679972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679976">in</span><span class="op" id="4679978">[</span><span class="ident" id="4679979">i</span><span class="op" id="4679980">]</span>&nbsp;<span class="op" id="4679982">+=</span>&nbsp;<span class="ident" id="4679985">p224ZeroModP63</span><span class="op" id="4679999">[</span><span class="ident" id="4680000">i</span><span class="op" id="4680001">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680008">//&nbsp;Eliminate&nbsp;the&nbsp;coefficients&nbsp;at&nbsp;2**224&nbsp;and&nbsp;greater.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680062">for</span>&nbsp;<span class="ident" id="4680066">i</span>&nbsp;<span class="op" id="4680068">:=</span>&nbsp;<span class="num" id="4680071">14</span><span class="op" id="4680073">;</span>&nbsp;<span class="ident" id="4680075">i</span>&nbsp;<span class="op" id="4680077">&gt;=</span>&nbsp;<span class="num" id="4680080">8</span><span class="op" id="4680081">;</span>&nbsp;<span class="ident" id="4680083">i</span><span class="op" id="4680084">--</span>&nbsp;<span class="op" id="4680087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680091">in</span><span class="op" id="4680093">[</span><span class="ident" id="4680094">i</span><span class="op" id="4680095">-</span><span class="num" id="4680096">8</span><span class="op" id="4680097">]</span>&nbsp;<span class="op" id="4680099">-=</span>&nbsp;<span class="ident" id="4680102">in</span><span class="op" id="4680104">[</span><span class="ident" id="4680105">i</span><span class="op" id="4680106">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680110">in</span><span class="op" id="4680112">[</span><span class="ident" id="4680113">i</span><span class="op" id="4680114">-</span><span class="num" id="4680115">5</span><span class="op" id="4680116">]</span>&nbsp;<span class="op" id="4680118">+=</span>&nbsp;<span class="op" id="4680121">(</span><span class="ident" id="4680122">in</span><span class="op" id="4680124">[</span><span class="ident" id="4680125">i</span><span class="op" id="4680126">]</span>&nbsp;<span class="op" id="4680128">&amp;</span>&nbsp;<span class="num" id="4680130">0xffff</span><span class="op" id="4680136">)</span>&nbsp;<span class="op" id="4680138">&lt;&lt;</span>&nbsp;<span class="num" id="4680141">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680146">in</span><span class="op" id="4680148">[</span><span class="ident" id="4680149">i</span><span class="op" id="4680150">-</span><span class="num" id="4680151">4</span><span class="op" id="4680152">]</span>&nbsp;<span class="op" id="4680154">+=</span>&nbsp;<span class="ident" id="4680157">in</span><span class="op" id="4680159">[</span><span class="ident" id="4680160">i</span><span class="op" id="4680161">]</span>&nbsp;<span class="op" id="4680163">&gt;&gt;</span>&nbsp;<span class="num" id="4680166">16</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680173">in</span><span class="op" id="4680175">[</span><span class="num" id="4680176">8</span><span class="op" id="4680177">]</span>&nbsp;<span class="op" id="4680179">=</span>&nbsp;<span class="num" id="4680181">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680184">//&nbsp;in[0..8]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680206">//&nbsp;As&nbsp;the&nbsp;values&nbsp;become&nbsp;small&nbsp;enough,&nbsp;we&nbsp;start&nbsp;to&nbsp;store&nbsp;them&nbsp;in&nbsp;|out|</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680277">//&nbsp;and&nbsp;use&nbsp;32-bit&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680308">for</span>&nbsp;<span class="ident" id="4680312">i</span>&nbsp;<span class="op" id="4680314">:=</span>&nbsp;<span class="num" id="4680317">1</span><span class="op" id="4680318">;</span>&nbsp;<span class="ident" id="4680320">i</span>&nbsp;<span class="op" id="4680322">&lt;</span>&nbsp;<span class="num" id="4680324">8</span><span class="op" id="4680325">;</span>&nbsp;<span class="ident" id="4680327">i</span><span class="op" id="4680328">++</span>&nbsp;<span class="op" id="4680331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680335">in</span><span class="op" id="4680337">[</span><span class="ident" id="4680338">i</span><span class="op" id="4680339">+</span><span class="num" id="4680340">1</span><span class="op" id="4680341">]</span>&nbsp;<span class="op" id="4680343">+=</span>&nbsp;<span class="ident" id="4680346">in</span><span class="op" id="4680348">[</span><span class="ident" id="4680349">i</span><span class="op" id="4680350">]</span>&nbsp;<span class="op" id="4680352">&gt;&gt;</span>&nbsp;<span class="num" id="4680355">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680360">out</span><span class="op" id="4680363">[</span><span class="ident" id="4680364">i</span><span class="op" id="4680365">]</span>&nbsp;<span class="op" id="4680367">=</span>&nbsp;<span class="builtintype" id="4680369">uint32</span><span class="op" id="4680375">(</span><span class="ident" id="4680376">in</span><span class="op" id="4680378">[</span><span class="ident" id="4680379">i</span><span class="op" id="4680380">]</span>&nbsp;<span class="op" id="4680382">&amp;</span>&nbsp;<span class="ident" id="4680384">bottom28Bits</span><span class="op" id="4680396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680399">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680402">in</span><span class="op" id="4680404">[</span><span class="num" id="4680405">0</span><span class="op" id="4680406">]</span>&nbsp;<span class="op" id="4680408">-=</span>&nbsp;<span class="ident" id="4680411">in</span><span class="op" id="4680413">[</span><span class="num" id="4680414">8</span><span class="op" id="4680415">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680418">out</span><span class="op" id="4680421">[</span><span class="num" id="4680422">3</span><span class="op" id="4680423">]</span>&nbsp;<span class="op" id="4680425">+=</span>&nbsp;<span class="builtintype" id="4680428">uint32</span><span class="op" id="4680434">(</span><span class="ident" id="4680435">in</span><span class="op" id="4680437">[</span><span class="num" id="4680438">8</span><span class="op" id="4680439">]</span><span class="op" id="4680440">&amp;</span><span class="num" id="4680441">0xffff</span><span class="op" id="4680447">)</span>&nbsp;<span class="op" id="4680449">&lt;&lt;</span>&nbsp;<span class="num" id="4680452">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680456">out</span><span class="op" id="4680459">[</span><span class="num" id="4680460">4</span><span class="op" id="4680461">]</span>&nbsp;<span class="op" id="4680463">+=</span>&nbsp;<span class="builtintype" id="4680466">uint32</span><span class="op" id="4680472">(</span><span class="ident" id="4680473">in</span><span class="op" id="4680475">[</span><span class="num" id="4680476">8</span><span class="op" id="4680477">]</span>&nbsp;<span class="op" id="4680479">&gt;&gt;</span>&nbsp;<span class="num" id="4680482">16</span><span class="op" id="4680484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680487">//&nbsp;in[0]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680505">//&nbsp;out[3]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680524">//&nbsp;out[4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680543">//&nbsp;out[1,2,5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680570">out</span><span class="op" id="4680573">[</span><span class="num" id="4680574">0</span><span class="op" id="4680575">]</span>&nbsp;<span class="op" id="4680577">=</span>&nbsp;<span class="builtintype" id="4680579">uint32</span><span class="op" id="4680585">(</span><span class="ident" id="4680586">in</span><span class="op" id="4680588">[</span><span class="num" id="4680589">0</span><span class="op" id="4680590">]</span>&nbsp;<span class="op" id="4680592">&amp;</span>&nbsp;<span class="ident" id="4680594">bottom28Bits</span><span class="op" id="4680606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680609">out</span><span class="op" id="4680612">[</span><span class="num" id="4680613">1</span><span class="op" id="4680614">]</span>&nbsp;<span class="op" id="4680616">+=</span>&nbsp;<span class="builtintype" id="4680619">uint32</span><span class="op" id="4680625">(</span><span class="op" id="4680626">(</span><span class="ident" id="4680627">in</span><span class="op" id="4680629">[</span><span class="num" id="4680630">0</span><span class="op" id="4680631">]</span>&nbsp;<span class="op" id="4680633">&gt;&gt;</span>&nbsp;<span class="num" id="4680636">28</span><span class="op" id="4680638">)</span>&nbsp;<span class="op" id="4680640">&amp;</span>&nbsp;<span class="ident" id="4680642">bottom28Bits</span><span class="op" id="4680654">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680657">out</span><span class="op" id="4680660">[</span><span class="num" id="4680661">2</span><span class="op" id="4680662">]</span>&nbsp;<span class="op" id="4680664">+=</span>&nbsp;<span class="builtintype" id="4680667">uint32</span><span class="op" id="4680673">(</span><span class="ident" id="4680674">in</span><span class="op" id="4680676">[</span><span class="num" id="4680677">0</span><span class="op" id="4680678">]</span>&nbsp;<span class="op" id="4680680">&gt;&gt;</span>&nbsp;<span class="num" id="4680683">56</span><span class="op" id="4680685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680688">//&nbsp;out[0]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680707">//&nbsp;out[1..4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680729">//&nbsp;out[5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="op" id="4680750">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="4680753">//&nbsp;Reduce&nbsp;reduces&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;a&nbsp;to&nbsp;smaller&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="comment" id="4680812">//</span><br>
<span class="lineno"></span><span class="comment" id="4680815">//&nbsp;On&nbsp;entry:&nbsp;a[i]&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4680849">//&nbsp;On&nbsp;exit:&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">305</span><span class="keyword" id="4680874">func</span>&nbsp;<span class="ident" id="4680879">p224Reduce</span><span class="op" id="4680889">(</span><span class="ident" id="4680890">a</span>&nbsp;<span class="op" id="4680892">*</span><span class="ident" id="4680893">p224FieldElement</span><span class="op" id="4680909">)</span>&nbsp;<span class="op" id="4680911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680914">for</span>&nbsp;<span class="ident" id="4680918">i</span>&nbsp;<span class="op" id="4680920">:=</span>&nbsp;<span class="num" id="4680923">0</span><span class="op" id="4680924">;</span>&nbsp;<span class="ident" id="4680926">i</span>&nbsp;<span class="op" id="4680928">&lt;</span>&nbsp;<span class="num" id="4680930">7</span><span class="op" id="4680931">;</span>&nbsp;<span class="ident" id="4680933">i</span><span class="op" id="4680934">++</span>&nbsp;<span class="op" id="4680937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680941">a</span><span class="op" id="4680942">[</span><span class="ident" id="4680943">i</span><span class="op" id="4680944">+</span><span class="num" id="4680945">1</span><span class="op" id="4680946">]</span>&nbsp;<span class="op" id="4680948">+=</span>&nbsp;<span class="ident" id="4680951">a</span><span class="op" id="4680952">[</span><span class="ident" id="4680953">i</span><span class="op" id="4680954">]</span>&nbsp;<span class="op" id="4680956">&gt;&gt;</span>&nbsp;<span class="num" id="4680959">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680964">a</span><span class="op" id="4680965">[</span><span class="ident" id="4680966">i</span><span class="op" id="4680967">]</span>&nbsp;<span class="op" id="4680969">&amp;=</span>&nbsp;<span class="ident" id="4680972">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680986">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680989">top</span>&nbsp;<span class="op" id="4680993">:=</span>&nbsp;<span class="ident" id="4680996">a</span><span class="op" id="4680997">[</span><span class="num" id="4680998">7</span><span class="op" id="4680999">]</span>&nbsp;<span class="op" id="4681001">&gt;&gt;</span>&nbsp;<span class="num" id="4681004">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681008">a</span><span class="op" id="4681009">[</span><span class="num" id="4681010">7</span><span class="op" id="4681011">]</span>&nbsp;<span class="op" id="4681013">&amp;=</span>&nbsp;<span class="ident" id="4681016">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4681031">//&nbsp;top&nbsp;&lt;&nbsp;2**4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681046">mask</span>&nbsp;<span class="op" id="4681051">:=</span>&nbsp;<span class="ident" id="4681054">top</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681059">mask</span>&nbsp;<span class="op" id="4681064">|=</span>&nbsp;<span class="ident" id="4681067">mask</span>&nbsp;<span class="op" id="4681072">&gt;&gt;</span>&nbsp;<span class="num" id="4681075">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681078">mask</span>&nbsp;<span class="op" id="4681083">|=</span>&nbsp;<span class="ident" id="4681086">mask</span>&nbsp;<span class="op" id="4681091">&gt;&gt;</span>&nbsp;<span class="num" id="4681094">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681097">mask</span>&nbsp;<span class="op" id="4681102">&lt;&lt;=</span>&nbsp;<span class="num" id="4681106">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681110">mask</span>&nbsp;<span class="op" id="4681115">=</span>&nbsp;<span class="builtintype" id="4681117">uint32</span><span class="op" id="4681123">(</span><span class="builtintype" id="4681124">int32</span><span class="op" id="4681129">(</span><span class="ident" id="4681130">mask</span><span class="op" id="4681134">)</span>&nbsp;<span class="op" id="4681136">&gt;&gt;</span>&nbsp;<span class="num" id="4681139">31</span><span class="op" id="4681141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4681144">//&nbsp;Mask&nbsp;is&nbsp;all&nbsp;ones&nbsp;if&nbsp;top&nbsp;!=&nbsp;0,&nbsp;all&nbsp;zero&nbsp;otherwise</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681198">a</span><span class="op" id="4681199">[</span><span class="num" id="4681200">0</span><span class="op" id="4681201">]</span>&nbsp;<span class="op" id="4681203">-=</span>&nbsp;<span class="ident" id="4681206">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681211">a</span><span class="op" id="4681212">[</span><span class="num" id="4681213">3</span><span class="op" id="4681214">]</span>&nbsp;<span class="op" id="4681216">+=</span>&nbsp;<span class="ident" id="4681219">top</span>&nbsp;<span class="op" id="4681223">&lt;&lt;</span>&nbsp;<span class="num" id="4681226">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4681231">//&nbsp;We&nbsp;may&nbsp;have&nbsp;just&nbsp;made&nbsp;a[0]&nbsp;negative&nbsp;but,&nbsp;if&nbsp;we&nbsp;did,&nbsp;then&nbsp;we&nbsp;must</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4681300">//&nbsp;have&nbsp;added&nbsp;something&nbsp;to&nbsp;a[3],&nbsp;this&nbsp;it&#39;s&nbsp;&gt;&nbsp;2**12.&nbsp;Therefore&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4681370">//&nbsp;carry&nbsp;down&nbsp;to&nbsp;a[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681394">a</span><span class="op" id="4681395">[</span><span class="num" id="4681396">3</span><span class="op" id="4681397">]</span>&nbsp;<span class="op" id="4681399">-=</span>&nbsp;<span class="num" id="4681402">1</span>&nbsp;<span class="op" id="4681404">&amp;</span>&nbsp;<span class="ident" id="4681406">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681412">a</span><span class="op" id="4681413">[</span><span class="num" id="4681414">2</span><span class="op" id="4681415">]</span>&nbsp;<span class="op" id="4681417">+=</span>&nbsp;<span class="ident" id="4681420">mask</span>&nbsp;<span class="op" id="4681425">&amp;</span>&nbsp;<span class="op" id="4681427">(</span><span class="num" id="4681428">1</span><span class="op" id="4681429">&lt;&lt;</span><span class="num" id="4681431">28</span>&nbsp;<span class="op" id="4681434">-</span>&nbsp;<span class="num" id="4681436">1</span><span class="op" id="4681437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681440">a</span><span class="op" id="4681441">[</span><span class="num" id="4681442">1</span><span class="op" id="4681443">]</span>&nbsp;<span class="op" id="4681445">+=</span>&nbsp;<span class="ident" id="4681448">mask</span>&nbsp;<span class="op" id="4681453">&amp;</span>&nbsp;<span class="op" id="4681455">(</span><span class="num" id="4681456">1</span><span class="op" id="4681457">&lt;&lt;</span><span class="num" id="4681459">28</span>&nbsp;<span class="op" id="4681462">-</span>&nbsp;<span class="num" id="4681464">1</span><span class="op" id="4681465">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681468">a</span><span class="op" id="4681469">[</span><span class="num" id="4681470">0</span><span class="op" id="4681471">]</span>&nbsp;<span class="op" id="4681473">+=</span>&nbsp;<span class="ident" id="4681476">mask</span>&nbsp;<span class="op" id="4681481">&amp;</span>&nbsp;<span class="op" id="4681483">(</span><span class="num" id="4681484">1</span>&nbsp;<span class="op" id="4681486">&lt;&lt;</span>&nbsp;<span class="num" id="4681489">28</span><span class="op" id="4681491">)</span><br>
<span class="lineno"></span><span class="op" id="4681493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4681496">//&nbsp;p224Invert&nbsp;calculates&nbsp;*out&nbsp;=&nbsp;in**-1&nbsp;by&nbsp;computing&nbsp;in**(2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="4681574">//&nbsp;i.e.&nbsp;Fermat&#39;s&nbsp;little&nbsp;theorem.</span><br>
<span class="lineno">335</span><span class="keyword" id="4681607">func</span>&nbsp;<span class="ident" id="4681612">p224Invert</span><span class="op" id="4681622">(</span><span class="ident" id="4681623">out</span><span class="op" id="4681626">,</span>&nbsp;<span class="ident" id="4681628">in</span>&nbsp;<span class="op" id="4681631">*</span><span class="ident" id="4681632">p224FieldElement</span><span class="op" id="4681648">)</span>&nbsp;<span class="op" id="4681650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4681653">var</span>&nbsp;<span class="ident" id="4681657">f1</span><span class="op" id="4681659">,</span>&nbsp;<span class="ident" id="4681661">f2</span><span class="op" id="4681663">,</span>&nbsp;<span class="ident" id="4681665">f3</span><span class="op" id="4681667">,</span>&nbsp;<span class="ident" id="4681669">f4</span>&nbsp;<span class="ident" id="4681672">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4681690">var</span>&nbsp;<span class="ident" id="4681694">c</span>&nbsp;<span class="ident" id="4681696">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681720">p224Square</span><span class="op" id="4681730">(</span><span class="op" id="4681731">&amp;</span><span class="ident" id="4681732">f1</span><span class="op" id="4681734">,</span>&nbsp;<span class="ident" id="4681736">in</span><span class="op" id="4681738">,</span>&nbsp;<span class="op" id="4681740">&amp;</span><span class="ident" id="4681741">c</span><span class="op" id="4681742">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4681747">//&nbsp;2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681753">p224Mul</span><span class="op" id="4681760">(</span><span class="op" id="4681761">&amp;</span><span class="ident" id="4681762">f1</span><span class="op" id="4681764">,</span>&nbsp;<span class="op" id="4681766">&amp;</span><span class="ident" id="4681767">f1</span><span class="op" id="4681769">,</span>&nbsp;<span class="ident" id="4681771">in</span><span class="op" id="4681773">,</span>&nbsp;<span class="op" id="4681775">&amp;</span><span class="ident" id="4681776">c</span><span class="op" id="4681777">)</span>&nbsp;&nbsp;<span class="comment" id="4681780">//&nbsp;2**2&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681793">p224Square</span><span class="op" id="4681803">(</span><span class="op" id="4681804">&amp;</span><span class="ident" id="4681805">f1</span><span class="op" id="4681807">,</span>&nbsp;<span class="op" id="4681809">&amp;</span><span class="ident" id="4681810">f1</span><span class="op" id="4681812">,</span>&nbsp;<span class="op" id="4681814">&amp;</span><span class="ident" id="4681815">c</span><span class="op" id="4681816">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4681820">//&nbsp;2**3&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681833">p224Mul</span><span class="op" id="4681840">(</span><span class="op" id="4681841">&amp;</span><span class="ident" id="4681842">f1</span><span class="op" id="4681844">,</span>&nbsp;<span class="op" id="4681846">&amp;</span><span class="ident" id="4681847">f1</span><span class="op" id="4681849">,</span>&nbsp;<span class="ident" id="4681851">in</span><span class="op" id="4681853">,</span>&nbsp;<span class="op" id="4681855">&amp;</span><span class="ident" id="4681856">c</span><span class="op" id="4681857">)</span>&nbsp;&nbsp;<span class="comment" id="4681860">//&nbsp;2**3&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681873">p224Square</span><span class="op" id="4681883">(</span><span class="op" id="4681884">&amp;</span><span class="ident" id="4681885">f2</span><span class="op" id="4681887">,</span>&nbsp;<span class="op" id="4681889">&amp;</span><span class="ident" id="4681890">f1</span><span class="op" id="4681892">,</span>&nbsp;<span class="op" id="4681894">&amp;</span><span class="ident" id="4681895">c</span><span class="op" id="4681896">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4681900">//&nbsp;2**4&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681913">p224Square</span><span class="op" id="4681923">(</span><span class="op" id="4681924">&amp;</span><span class="ident" id="4681925">f2</span><span class="op" id="4681927">,</span>&nbsp;<span class="op" id="4681929">&amp;</span><span class="ident" id="4681930">f2</span><span class="op" id="4681932">,</span>&nbsp;<span class="op" id="4681934">&amp;</span><span class="ident" id="4681935">c</span><span class="op" id="4681936">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4681940">//&nbsp;2**5&nbsp;-&nbsp;4</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681953">p224Square</span><span class="op" id="4681963">(</span><span class="op" id="4681964">&amp;</span><span class="ident" id="4681965">f2</span><span class="op" id="4681967">,</span>&nbsp;<span class="op" id="4681969">&amp;</span><span class="ident" id="4681970">f2</span><span class="op" id="4681972">,</span>&nbsp;<span class="op" id="4681974">&amp;</span><span class="ident" id="4681975">c</span><span class="op" id="4681976">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4681980">//&nbsp;2**6&nbsp;-&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681993">p224Mul</span><span class="op" id="4682000">(</span><span class="op" id="4682001">&amp;</span><span class="ident" id="4682002">f1</span><span class="op" id="4682004">,</span>&nbsp;<span class="op" id="4682006">&amp;</span><span class="ident" id="4682007">f1</span><span class="op" id="4682009">,</span>&nbsp;<span class="op" id="4682011">&amp;</span><span class="ident" id="4682012">f2</span><span class="op" id="4682014">,</span>&nbsp;<span class="op" id="4682016">&amp;</span><span class="ident" id="4682017">c</span><span class="op" id="4682018">)</span>&nbsp;<span class="comment" id="4682020">//&nbsp;2**6&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682033">p224Square</span><span class="op" id="4682043">(</span><span class="op" id="4682044">&amp;</span><span class="ident" id="4682045">f2</span><span class="op" id="4682047">,</span>&nbsp;<span class="op" id="4682049">&amp;</span><span class="ident" id="4682050">f1</span><span class="op" id="4682052">,</span>&nbsp;<span class="op" id="4682054">&amp;</span><span class="ident" id="4682055">c</span><span class="op" id="4682056">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4682060">//&nbsp;2**7&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682073">for</span>&nbsp;<span class="ident" id="4682077">i</span>&nbsp;<span class="op" id="4682079">:=</span>&nbsp;<span class="num" id="4682082">0</span><span class="op" id="4682083">;</span>&nbsp;<span class="ident" id="4682085">i</span>&nbsp;<span class="op" id="4682087">&lt;</span>&nbsp;<span class="num" id="4682089">5</span><span class="op" id="4682090">;</span>&nbsp;<span class="ident" id="4682092">i</span><span class="op" id="4682093">++</span>&nbsp;<span class="op" id="4682096">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4682100">//&nbsp;2**12&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682118">p224Square</span><span class="op" id="4682128">(</span><span class="op" id="4682129">&amp;</span><span class="ident" id="4682130">f2</span><span class="op" id="4682132">,</span>&nbsp;<span class="op" id="4682134">&amp;</span><span class="ident" id="4682135">f2</span><span class="op" id="4682137">,</span>&nbsp;<span class="op" id="4682139">&amp;</span><span class="ident" id="4682140">c</span><span class="op" id="4682141">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682147">p224Mul</span><span class="op" id="4682154">(</span><span class="op" id="4682155">&amp;</span><span class="ident" id="4682156">f2</span><span class="op" id="4682158">,</span>&nbsp;<span class="op" id="4682160">&amp;</span><span class="ident" id="4682161">f2</span><span class="op" id="4682163">,</span>&nbsp;<span class="op" id="4682165">&amp;</span><span class="ident" id="4682166">f1</span><span class="op" id="4682168">,</span>&nbsp;<span class="op" id="4682170">&amp;</span><span class="ident" id="4682171">c</span><span class="op" id="4682172">)</span>&nbsp;<span class="comment" id="4682174">//&nbsp;2**12&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682188">p224Square</span><span class="op" id="4682198">(</span><span class="op" id="4682199">&amp;</span><span class="ident" id="4682200">f3</span><span class="op" id="4682202">,</span>&nbsp;<span class="op" id="4682204">&amp;</span><span class="ident" id="4682205">f2</span><span class="op" id="4682207">,</span>&nbsp;<span class="op" id="4682209">&amp;</span><span class="ident" id="4682210">c</span><span class="op" id="4682211">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4682215">//&nbsp;2**13&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682229">for</span>&nbsp;<span class="ident" id="4682233">i</span>&nbsp;<span class="op" id="4682235">:=</span>&nbsp;<span class="num" id="4682238">0</span><span class="op" id="4682239">;</span>&nbsp;<span class="ident" id="4682241">i</span>&nbsp;<span class="op" id="4682243">&lt;</span>&nbsp;<span class="num" id="4682245">11</span><span class="op" id="4682247">;</span>&nbsp;<span class="ident" id="4682249">i</span><span class="op" id="4682250">++</span>&nbsp;<span class="op" id="4682253">{</span>&nbsp;&nbsp;<span class="comment" id="4682256">//&nbsp;2**24&nbsp;-&nbsp;2**12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682275">p224Square</span><span class="op" id="4682285">(</span><span class="op" id="4682286">&amp;</span><span class="ident" id="4682287">f3</span><span class="op" id="4682289">,</span>&nbsp;<span class="op" id="4682291">&amp;</span><span class="ident" id="4682292">f3</span><span class="op" id="4682294">,</span>&nbsp;<span class="op" id="4682296">&amp;</span><span class="ident" id="4682297">c</span><span class="op" id="4682298">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682304">p224Mul</span><span class="op" id="4682311">(</span><span class="op" id="4682312">&amp;</span><span class="ident" id="4682313">f2</span><span class="op" id="4682315">,</span>&nbsp;<span class="op" id="4682317">&amp;</span><span class="ident" id="4682318">f3</span><span class="op" id="4682320">,</span>&nbsp;<span class="op" id="4682322">&amp;</span><span class="ident" id="4682323">f2</span><span class="op" id="4682325">,</span>&nbsp;<span class="op" id="4682327">&amp;</span><span class="ident" id="4682328">c</span><span class="op" id="4682329">)</span>&nbsp;<span class="comment" id="4682331">//&nbsp;2**24&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682345">p224Square</span><span class="op" id="4682355">(</span><span class="op" id="4682356">&amp;</span><span class="ident" id="4682357">f3</span><span class="op" id="4682359">,</span>&nbsp;<span class="op" id="4682361">&amp;</span><span class="ident" id="4682362">f2</span><span class="op" id="4682364">,</span>&nbsp;<span class="op" id="4682366">&amp;</span><span class="ident" id="4682367">c</span><span class="op" id="4682368">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4682372">//&nbsp;2**25&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682386">for</span>&nbsp;<span class="ident" id="4682390">i</span>&nbsp;<span class="op" id="4682392">:=</span>&nbsp;<span class="num" id="4682395">0</span><span class="op" id="4682396">;</span>&nbsp;<span class="ident" id="4682398">i</span>&nbsp;<span class="op" id="4682400">&lt;</span>&nbsp;<span class="num" id="4682402">23</span><span class="op" id="4682404">;</span>&nbsp;<span class="ident" id="4682406">i</span><span class="op" id="4682407">++</span>&nbsp;<span class="op" id="4682410">{</span>&nbsp;&nbsp;<span class="comment" id="4682413">//&nbsp;2**48&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682432">p224Square</span><span class="op" id="4682442">(</span><span class="op" id="4682443">&amp;</span><span class="ident" id="4682444">f3</span><span class="op" id="4682446">,</span>&nbsp;<span class="op" id="4682448">&amp;</span><span class="ident" id="4682449">f3</span><span class="op" id="4682451">,</span>&nbsp;<span class="op" id="4682453">&amp;</span><span class="ident" id="4682454">c</span><span class="op" id="4682455">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682461">p224Mul</span><span class="op" id="4682468">(</span><span class="op" id="4682469">&amp;</span><span class="ident" id="4682470">f3</span><span class="op" id="4682472">,</span>&nbsp;<span class="op" id="4682474">&amp;</span><span class="ident" id="4682475">f3</span><span class="op" id="4682477">,</span>&nbsp;<span class="op" id="4682479">&amp;</span><span class="ident" id="4682480">f2</span><span class="op" id="4682482">,</span>&nbsp;<span class="op" id="4682484">&amp;</span><span class="ident" id="4682485">c</span><span class="op" id="4682486">)</span>&nbsp;<span class="comment" id="4682488">//&nbsp;2**48&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682502">p224Square</span><span class="op" id="4682512">(</span><span class="op" id="4682513">&amp;</span><span class="ident" id="4682514">f4</span><span class="op" id="4682516">,</span>&nbsp;<span class="op" id="4682518">&amp;</span><span class="ident" id="4682519">f3</span><span class="op" id="4682521">,</span>&nbsp;<span class="op" id="4682523">&amp;</span><span class="ident" id="4682524">c</span><span class="op" id="4682525">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4682529">//&nbsp;2**49&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682543">for</span>&nbsp;<span class="ident" id="4682547">i</span>&nbsp;<span class="op" id="4682549">:=</span>&nbsp;<span class="num" id="4682552">0</span><span class="op" id="4682553">;</span>&nbsp;<span class="ident" id="4682555">i</span>&nbsp;<span class="op" id="4682557">&lt;</span>&nbsp;<span class="num" id="4682559">47</span><span class="op" id="4682561">;</span>&nbsp;<span class="ident" id="4682563">i</span><span class="op" id="4682564">++</span>&nbsp;<span class="op" id="4682567">{</span>&nbsp;&nbsp;<span class="comment" id="4682570">//&nbsp;2**96&nbsp;-&nbsp;2**48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682589">p224Square</span><span class="op" id="4682599">(</span><span class="op" id="4682600">&amp;</span><span class="ident" id="4682601">f4</span><span class="op" id="4682603">,</span>&nbsp;<span class="op" id="4682605">&amp;</span><span class="ident" id="4682606">f4</span><span class="op" id="4682608">,</span>&nbsp;<span class="op" id="4682610">&amp;</span><span class="ident" id="4682611">c</span><span class="op" id="4682612">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682618">p224Mul</span><span class="op" id="4682625">(</span><span class="op" id="4682626">&amp;</span><span class="ident" id="4682627">f3</span><span class="op" id="4682629">,</span>&nbsp;<span class="op" id="4682631">&amp;</span><span class="ident" id="4682632">f3</span><span class="op" id="4682634">,</span>&nbsp;<span class="op" id="4682636">&amp;</span><span class="ident" id="4682637">f4</span><span class="op" id="4682639">,</span>&nbsp;<span class="op" id="4682641">&amp;</span><span class="ident" id="4682642">c</span><span class="op" id="4682643">)</span>&nbsp;<span class="comment" id="4682645">//&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682659">p224Square</span><span class="op" id="4682669">(</span><span class="op" id="4682670">&amp;</span><span class="ident" id="4682671">f4</span><span class="op" id="4682673">,</span>&nbsp;<span class="op" id="4682675">&amp;</span><span class="ident" id="4682676">f3</span><span class="op" id="4682678">,</span>&nbsp;<span class="op" id="4682680">&amp;</span><span class="ident" id="4682681">c</span><span class="op" id="4682682">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4682686">//&nbsp;2**97&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682700">for</span>&nbsp;<span class="ident" id="4682704">i</span>&nbsp;<span class="op" id="4682706">:=</span>&nbsp;<span class="num" id="4682709">0</span><span class="op" id="4682710">;</span>&nbsp;<span class="ident" id="4682712">i</span>&nbsp;<span class="op" id="4682714">&lt;</span>&nbsp;<span class="num" id="4682716">23</span><span class="op" id="4682718">;</span>&nbsp;<span class="ident" id="4682720">i</span><span class="op" id="4682721">++</span>&nbsp;<span class="op" id="4682724">{</span>&nbsp;&nbsp;<span class="comment" id="4682727">//&nbsp;2**120&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682747">p224Square</span><span class="op" id="4682757">(</span><span class="op" id="4682758">&amp;</span><span class="ident" id="4682759">f4</span><span class="op" id="4682761">,</span>&nbsp;<span class="op" id="4682763">&amp;</span><span class="ident" id="4682764">f4</span><span class="op" id="4682766">,</span>&nbsp;<span class="op" id="4682768">&amp;</span><span class="ident" id="4682769">c</span><span class="op" id="4682770">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682776">p224Mul</span><span class="op" id="4682783">(</span><span class="op" id="4682784">&amp;</span><span class="ident" id="4682785">f2</span><span class="op" id="4682787">,</span>&nbsp;<span class="op" id="4682789">&amp;</span><span class="ident" id="4682790">f4</span><span class="op" id="4682792">,</span>&nbsp;<span class="op" id="4682794">&amp;</span><span class="ident" id="4682795">f2</span><span class="op" id="4682797">,</span>&nbsp;<span class="op" id="4682799">&amp;</span><span class="ident" id="4682800">c</span><span class="op" id="4682801">)</span>&nbsp;<span class="comment" id="4682803">//&nbsp;2**120&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682818">for</span>&nbsp;<span class="ident" id="4682822">i</span>&nbsp;<span class="op" id="4682824">:=</span>&nbsp;<span class="num" id="4682827">0</span><span class="op" id="4682828">;</span>&nbsp;<span class="ident" id="4682830">i</span>&nbsp;<span class="op" id="4682832">&lt;</span>&nbsp;<span class="num" id="4682834">6</span><span class="op" id="4682835">;</span>&nbsp;<span class="ident" id="4682837">i</span><span class="op" id="4682838">++</span>&nbsp;<span class="op" id="4682841">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4682845">//&nbsp;2**126&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682864">p224Square</span><span class="op" id="4682874">(</span><span class="op" id="4682875">&amp;</span><span class="ident" id="4682876">f2</span><span class="op" id="4682878">,</span>&nbsp;<span class="op" id="4682880">&amp;</span><span class="ident" id="4682881">f2</span><span class="op" id="4682883">,</span>&nbsp;<span class="op" id="4682885">&amp;</span><span class="ident" id="4682886">c</span><span class="op" id="4682887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682890">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682893">p224Mul</span><span class="op" id="4682900">(</span><span class="op" id="4682901">&amp;</span><span class="ident" id="4682902">f1</span><span class="op" id="4682904">,</span>&nbsp;<span class="op" id="4682906">&amp;</span><span class="ident" id="4682907">f1</span><span class="op" id="4682909">,</span>&nbsp;<span class="op" id="4682911">&amp;</span><span class="ident" id="4682912">f2</span><span class="op" id="4682914">,</span>&nbsp;<span class="op" id="4682916">&amp;</span><span class="ident" id="4682917">c</span><span class="op" id="4682918">)</span>&nbsp;<span class="comment" id="4682920">//&nbsp;2**126&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682935">p224Square</span><span class="op" id="4682945">(</span><span class="op" id="4682946">&amp;</span><span class="ident" id="4682947">f1</span><span class="op" id="4682949">,</span>&nbsp;<span class="op" id="4682951">&amp;</span><span class="ident" id="4682952">f1</span><span class="op" id="4682954">,</span>&nbsp;<span class="op" id="4682956">&amp;</span><span class="ident" id="4682957">c</span><span class="op" id="4682958">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4682962">//&nbsp;2**127&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682977">p224Mul</span><span class="op" id="4682984">(</span><span class="op" id="4682985">&amp;</span><span class="ident" id="4682986">f1</span><span class="op" id="4682988">,</span>&nbsp;<span class="op" id="4682990">&amp;</span><span class="ident" id="4682991">f1</span><span class="op" id="4682993">,</span>&nbsp;<span class="ident" id="4682995">in</span><span class="op" id="4682997">,</span>&nbsp;<span class="op" id="4682999">&amp;</span><span class="ident" id="4683000">c</span><span class="op" id="4683001">)</span>&nbsp;&nbsp;<span class="comment" id="4683004">//&nbsp;2**127&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683019">for</span>&nbsp;<span class="ident" id="4683023">i</span>&nbsp;<span class="op" id="4683025">:=</span>&nbsp;<span class="num" id="4683028">0</span><span class="op" id="4683029">;</span>&nbsp;<span class="ident" id="4683031">i</span>&nbsp;<span class="op" id="4683033">&lt;</span>&nbsp;<span class="num" id="4683035">97</span><span class="op" id="4683037">;</span>&nbsp;<span class="ident" id="4683039">i</span><span class="op" id="4683040">++</span>&nbsp;<span class="op" id="4683043">{</span>&nbsp;&nbsp;<span class="comment" id="4683046">//&nbsp;2**224&nbsp;-&nbsp;2**97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683066">p224Square</span><span class="op" id="4683076">(</span><span class="op" id="4683077">&amp;</span><span class="ident" id="4683078">f1</span><span class="op" id="4683080">,</span>&nbsp;<span class="op" id="4683082">&amp;</span><span class="ident" id="4683083">f1</span><span class="op" id="4683085">,</span>&nbsp;<span class="op" id="4683087">&amp;</span><span class="ident" id="4683088">c</span><span class="op" id="4683089">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683095">p224Mul</span><span class="op" id="4683102">(</span><span class="ident" id="4683103">out</span><span class="op" id="4683106">,</span>&nbsp;<span class="op" id="4683108">&amp;</span><span class="ident" id="4683109">f1</span><span class="op" id="4683111">,</span>&nbsp;<span class="op" id="4683113">&amp;</span><span class="ident" id="4683114">f3</span><span class="op" id="4683116">,</span>&nbsp;<span class="op" id="4683118">&amp;</span><span class="ident" id="4683119">c</span><span class="op" id="4683120">)</span>&nbsp;<span class="comment" id="4683122">//&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span><span class="op" id="4683144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4683147">//&nbsp;p224Contract&nbsp;converts&nbsp;a&nbsp;FieldElement&nbsp;to&nbsp;its&nbsp;unique,&nbsp;minimal&nbsp;form.</span><br>
<span class="lineno">385</span><span class="comment" id="4683216">//</span><br>
<span class="lineno"></span><span class="comment" id="4683219">//&nbsp;On&nbsp;entry,&nbsp;in[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4683246">//&nbsp;On&nbsp;exit,&nbsp;in[i]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="keyword" id="4683272">func</span>&nbsp;<span class="ident" id="4683277">p224Contract</span><span class="op" id="4683289">(</span><span class="ident" id="4683290">out</span><span class="op" id="4683293">,</span>&nbsp;<span class="ident" id="4683295">in</span>&nbsp;<span class="op" id="4683298">*</span><span class="ident" id="4683299">p224FieldElement</span><span class="op" id="4683315">)</span>&nbsp;<span class="op" id="4683317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4683320">copy</span><span class="op" id="4683324">(</span><span class="ident" id="4683325">out</span><span class="op" id="4683328">[</span><span class="op" id="4683329">:</span><span class="op" id="4683330">]</span><span class="op" id="4683331">,</span>&nbsp;<span class="ident" id="4683333">in</span><span class="op" id="4683335">[</span><span class="op" id="4683336">:</span><span class="op" id="4683337">]</span><span class="op" id="4683338">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683342">for</span>&nbsp;<span class="ident" id="4683346">i</span>&nbsp;<span class="op" id="4683348">:=</span>&nbsp;<span class="num" id="4683351">0</span><span class="op" id="4683352">;</span>&nbsp;<span class="ident" id="4683354">i</span>&nbsp;<span class="op" id="4683356">&lt;</span>&nbsp;<span class="num" id="4683358">7</span><span class="op" id="4683359">;</span>&nbsp;<span class="ident" id="4683361">i</span><span class="op" id="4683362">++</span>&nbsp;<span class="op" id="4683365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683369">out</span><span class="op" id="4683372">[</span><span class="ident" id="4683373">i</span><span class="op" id="4683374">+</span><span class="num" id="4683375">1</span><span class="op" id="4683376">]</span>&nbsp;<span class="op" id="4683378">+=</span>&nbsp;<span class="ident" id="4683381">out</span><span class="op" id="4683384">[</span><span class="ident" id="4683385">i</span><span class="op" id="4683386">]</span>&nbsp;<span class="op" id="4683388">&gt;&gt;</span>&nbsp;<span class="num" id="4683391">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683396">out</span><span class="op" id="4683399">[</span><span class="ident" id="4683400">i</span><span class="op" id="4683401">]</span>&nbsp;<span class="op" id="4683403">&amp;=</span>&nbsp;<span class="ident" id="4683406">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683420">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683423">top</span>&nbsp;<span class="op" id="4683427">:=</span>&nbsp;<span class="ident" id="4683430">out</span><span class="op" id="4683433">[</span><span class="num" id="4683434">7</span><span class="op" id="4683435">]</span>&nbsp;<span class="op" id="4683437">&gt;&gt;</span>&nbsp;<span class="num" id="4683440">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683444">out</span><span class="op" id="4683447">[</span><span class="num" id="4683448">7</span><span class="op" id="4683449">]</span>&nbsp;<span class="op" id="4683451">&amp;=</span>&nbsp;<span class="ident" id="4683454">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683469">out</span><span class="op" id="4683472">[</span><span class="num" id="4683473">0</span><span class="op" id="4683474">]</span>&nbsp;<span class="op" id="4683476">-=</span>&nbsp;<span class="ident" id="4683479">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683484">out</span><span class="op" id="4683487">[</span><span class="num" id="4683488">3</span><span class="op" id="4683489">]</span>&nbsp;<span class="op" id="4683491">+=</span>&nbsp;<span class="ident" id="4683494">top</span>&nbsp;<span class="op" id="4683498">&lt;&lt;</span>&nbsp;<span class="num" id="4683501">12</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4683506">//&nbsp;We&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[i]&nbsp;negative.&nbsp;So&nbsp;we&nbsp;carry&nbsp;down.&nbsp;If&nbsp;we&nbsp;made</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4683578">//&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is&nbsp;sufficiently&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4683648">//&nbsp;because&nbsp;we&nbsp;just&nbsp;added&nbsp;to&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683681">for</span>&nbsp;<span class="ident" id="4683685">i</span>&nbsp;<span class="op" id="4683687">:=</span>&nbsp;<span class="num" id="4683690">0</span><span class="op" id="4683691">;</span>&nbsp;<span class="ident" id="4683693">i</span>&nbsp;<span class="op" id="4683695">&lt;</span>&nbsp;<span class="num" id="4683697">3</span><span class="op" id="4683698">;</span>&nbsp;<span class="ident" id="4683700">i</span><span class="op" id="4683701">++</span>&nbsp;<span class="op" id="4683704">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683708">mask</span>&nbsp;<span class="op" id="4683713">:=</span>&nbsp;<span class="builtintype" id="4683716">uint32</span><span class="op" id="4683722">(</span><span class="builtintype" id="4683723">int32</span><span class="op" id="4683728">(</span><span class="ident" id="4683729">out</span><span class="op" id="4683732">[</span><span class="ident" id="4683733">i</span><span class="op" id="4683734">]</span><span class="op" id="4683735">)</span>&nbsp;<span class="op" id="4683737">&gt;&gt;</span>&nbsp;<span class="num" id="4683740">31</span><span class="op" id="4683742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683746">out</span><span class="op" id="4683749">[</span><span class="ident" id="4683750">i</span><span class="op" id="4683751">]</span>&nbsp;<span class="op" id="4683753">+=</span>&nbsp;<span class="op" id="4683756">(</span><span class="num" id="4683757">1</span>&nbsp;<span class="op" id="4683759">&lt;&lt;</span>&nbsp;<span class="num" id="4683762">28</span><span class="op" id="4683764">)</span>&nbsp;<span class="op" id="4683766">&amp;</span>&nbsp;<span class="ident" id="4683768">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683775">out</span><span class="op" id="4683778">[</span><span class="ident" id="4683779">i</span><span class="op" id="4683780">+</span><span class="num" id="4683781">1</span><span class="op" id="4683782">]</span>&nbsp;<span class="op" id="4683784">-=</span>&nbsp;<span class="num" id="4683787">1</span>&nbsp;<span class="op" id="4683789">&amp;</span>&nbsp;<span class="ident" id="4683791">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4683801">//&nbsp;We&nbsp;might&nbsp;have&nbsp;pushed&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;so&nbsp;we&nbsp;perform&nbsp;another,&nbsp;partial,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4683876">//&nbsp;carry&nbsp;chain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683893">for</span>&nbsp;<span class="ident" id="4683897">i</span>&nbsp;<span class="op" id="4683899">:=</span>&nbsp;<span class="num" id="4683902">3</span><span class="op" id="4683903">;</span>&nbsp;<span class="ident" id="4683905">i</span>&nbsp;<span class="op" id="4683907">&lt;</span>&nbsp;<span class="num" id="4683909">7</span><span class="op" id="4683910">;</span>&nbsp;<span class="ident" id="4683912">i</span><span class="op" id="4683913">++</span>&nbsp;<span class="op" id="4683916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683920">out</span><span class="op" id="4683923">[</span><span class="ident" id="4683924">i</span><span class="op" id="4683925">+</span><span class="num" id="4683926">1</span><span class="op" id="4683927">]</span>&nbsp;<span class="op" id="4683929">+=</span>&nbsp;<span class="ident" id="4683932">out</span><span class="op" id="4683935">[</span><span class="ident" id="4683936">i</span><span class="op" id="4683937">]</span>&nbsp;<span class="op" id="4683939">&gt;&gt;</span>&nbsp;<span class="num" id="4683942">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683947">out</span><span class="op" id="4683950">[</span><span class="ident" id="4683951">i</span><span class="op" id="4683952">]</span>&nbsp;<span class="op" id="4683954">&amp;=</span>&nbsp;<span class="ident" id="4683957">bottom28Bits</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683974">top</span>&nbsp;<span class="op" id="4683978">=</span>&nbsp;<span class="ident" id="4683980">out</span><span class="op" id="4683983">[</span><span class="num" id="4683984">7</span><span class="op" id="4683985">]</span>&nbsp;<span class="op" id="4683987">&gt;&gt;</span>&nbsp;<span class="num" id="4683990">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683994">out</span><span class="op" id="4683997">[</span><span class="num" id="4683998">7</span><span class="op" id="4683999">]</span>&nbsp;<span class="op" id="4684001">&amp;=</span>&nbsp;<span class="ident" id="4684004">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684019">//&nbsp;Eliminate&nbsp;top&nbsp;while&nbsp;maintaining&nbsp;the&nbsp;same&nbsp;value&nbsp;mod&nbsp;p.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684077">out</span><span class="op" id="4684080">[</span><span class="num" id="4684081">0</span><span class="op" id="4684082">]</span>&nbsp;<span class="op" id="4684084">-=</span>&nbsp;<span class="ident" id="4684087">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684092">out</span><span class="op" id="4684095">[</span><span class="num" id="4684096">3</span><span class="op" id="4684097">]</span>&nbsp;<span class="op" id="4684099">+=</span>&nbsp;<span class="ident" id="4684102">top</span>&nbsp;<span class="op" id="4684106">&lt;&lt;</span>&nbsp;<span class="num" id="4684109">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684114">//&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider&nbsp;for&nbsp;out[3]:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684162">//&nbsp;&nbsp;&nbsp;1)&nbsp;The&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top,&nbsp;we&nbsp;didn&#39;t&nbsp;push&nbsp;out[3]&nbsp;over</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684237">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2**28.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;partial&nbsp;carry&nbsp;chain&nbsp;didn&#39;t&nbsp;change&nbsp;any&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684316">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;top&nbsp;is&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684342">//&nbsp;&nbsp;&nbsp;2)&nbsp;We&nbsp;did&nbsp;push&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;the&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684420">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;value&nbsp;of&nbsp;top&nbsp;was&nbsp;in&nbsp;[0..16),&nbsp;therefore,&nbsp;prior&nbsp;to&nbsp;eliminating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684500">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;top,&nbsp;0xfff1000&nbsp;&lt;=&nbsp;out[3]&nbsp;&lt;=&nbsp;0xfffffff.&nbsp;Therefore,&nbsp;after</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684575">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflowing&nbsp;and&nbsp;being&nbsp;reduced&nbsp;by&nbsp;the&nbsp;second&nbsp;carry&nbsp;chain,&nbsp;out[3]&nbsp;&lt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684651">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf000.&nbsp;Thus&nbsp;it&nbsp;cannot&nbsp;have&nbsp;overflowed&nbsp;when&nbsp;we&nbsp;eliminated&nbsp;top&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684730">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684753">//&nbsp;Again,&nbsp;we&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[0]&nbsp;negative,&nbsp;so&nbsp;do&nbsp;the&nbsp;same&nbsp;carry&nbsp;down.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684830">//&nbsp;As&nbsp;before,&nbsp;if&nbsp;we&nbsp;made&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4684900">//&nbsp;sufficiently&nbsp;positive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684927">for</span>&nbsp;<span class="ident" id="4684931">i</span>&nbsp;<span class="op" id="4684933">:=</span>&nbsp;<span class="num" id="4684936">0</span><span class="op" id="4684937">;</span>&nbsp;<span class="ident" id="4684939">i</span>&nbsp;<span class="op" id="4684941">&lt;</span>&nbsp;<span class="num" id="4684943">3</span><span class="op" id="4684944">;</span>&nbsp;<span class="ident" id="4684946">i</span><span class="op" id="4684947">++</span>&nbsp;<span class="op" id="4684950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684954">mask</span>&nbsp;<span class="op" id="4684959">:=</span>&nbsp;<span class="builtintype" id="4684962">uint32</span><span class="op" id="4684968">(</span><span class="builtintype" id="4684969">int32</span><span class="op" id="4684974">(</span><span class="ident" id="4684975">out</span><span class="op" id="4684978">[</span><span class="ident" id="4684979">i</span><span class="op" id="4684980">]</span><span class="op" id="4684981">)</span>&nbsp;<span class="op" id="4684983">&gt;&gt;</span>&nbsp;<span class="num" id="4684986">31</span><span class="op" id="4684988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684992">out</span><span class="op" id="4684995">[</span><span class="ident" id="4684996">i</span><span class="op" id="4684997">]</span>&nbsp;<span class="op" id="4684999">+=</span>&nbsp;<span class="op" id="4685002">(</span><span class="num" id="4685003">1</span>&nbsp;<span class="op" id="4685005">&lt;&lt;</span>&nbsp;<span class="num" id="4685008">28</span><span class="op" id="4685010">)</span>&nbsp;<span class="op" id="4685012">&amp;</span>&nbsp;<span class="ident" id="4685014">mask</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685021">out</span><span class="op" id="4685024">[</span><span class="ident" id="4685025">i</span><span class="op" id="4685026">+</span><span class="num" id="4685027">1</span><span class="op" id="4685028">]</span>&nbsp;<span class="op" id="4685030">-=</span>&nbsp;<span class="num" id="4685033">1</span>&nbsp;<span class="op" id="4685035">&amp;</span>&nbsp;<span class="ident" id="4685037">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4685047">//&nbsp;Now&nbsp;we&nbsp;see&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p&nbsp;and,&nbsp;if&nbsp;so,&nbsp;subtract&nbsp;p.</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4685108">//&nbsp;First&nbsp;we&nbsp;build&nbsp;a&nbsp;mask&nbsp;from&nbsp;the&nbsp;top&nbsp;four&nbsp;limbs,&nbsp;which&nbsp;must&nbsp;all&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4685177">//&nbsp;equal&nbsp;to&nbsp;bottom28Bits&nbsp;if&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p.&nbsp;If&nbsp;top4AllOnes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4685246">//&nbsp;ends&nbsp;up&nbsp;with&nbsp;any&nbsp;zero&nbsp;bits&nbsp;in&nbsp;the&nbsp;bottom&nbsp;28&nbsp;bits,&nbsp;then&nbsp;this&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4685317">//&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685327">top4AllOnes</span>&nbsp;<span class="op" id="4685339">:=</span>&nbsp;<span class="builtintype" id="4685342">uint32</span><span class="op" id="4685348">(</span><span class="num" id="4685349">0xffffffff</span><span class="op" id="4685359">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685362">for</span>&nbsp;<span class="ident" id="4685366">i</span>&nbsp;<span class="op" id="4685368">:=</span>&nbsp;<span class="num" id="4685371">4</span><span class="op" id="4685372">;</span>&nbsp;<span class="ident" id="4685374">i</span>&nbsp;<span class="op" id="4685376">&lt;</span>&nbsp;<span class="num" id="4685378">8</span><span class="op" id="4685379">;</span>&nbsp;<span class="ident" id="4685381">i</span><span class="op" id="4685382">++</span>&nbsp;<span class="op" id="4685385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685389">top4AllOnes</span>&nbsp;<span class="op" id="4685401">&amp;=</span>&nbsp;<span class="ident" id="4685404">out</span><span class="op" id="4685407">[</span><span class="ident" id="4685408">i</span><span class="op" id="4685409">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685415">top4AllOnes</span>&nbsp;<span class="op" id="4685427">|=</span>&nbsp;<span class="num" id="4685430">0xf0000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4685442">//&nbsp;Now&nbsp;we&nbsp;replicate&nbsp;any&nbsp;zero&nbsp;bits&nbsp;to&nbsp;all&nbsp;the&nbsp;bits&nbsp;in&nbsp;top4AllOnes.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685509">top4AllOnes</span>&nbsp;<span class="op" id="4685521">&amp;=</span>&nbsp;<span class="ident" id="4685524">top4AllOnes</span>&nbsp;<span class="op" id="4685536">&gt;&gt;</span>&nbsp;<span class="num" id="4685539">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685543">top4AllOnes</span>&nbsp;<span class="op" id="4685555">&amp;=</span>&nbsp;<span class="ident" id="4685558">top4AllOnes</span>&nbsp;<span class="op" id="4685570">&gt;&gt;</span>&nbsp;<span class="num" id="4685573">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685576">top4AllOnes</span>&nbsp;<span class="op" id="4685588">&amp;=</span>&nbsp;<span class="ident" id="4685591">top4AllOnes</span>&nbsp;<span class="op" id="4685603">&gt;&gt;</span>&nbsp;<span class="num" id="4685606">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685609">top4AllOnes</span>&nbsp;<span class="op" id="4685621">&amp;=</span>&nbsp;<span class="ident" id="4685624">top4AllOnes</span>&nbsp;<span class="op" id="4685636">&gt;&gt;</span>&nbsp;<span class="num" id="4685639">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685642">top4AllOnes</span>&nbsp;<span class="op" id="4685654">&amp;=</span>&nbsp;<span class="ident" id="4685657">top4AllOnes</span>&nbsp;<span class="op" id="4685669">&gt;&gt;</span>&nbsp;<span class="num" id="4685672">1</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685675">top4AllOnes</span>&nbsp;<span class="op" id="4685687">=</span>&nbsp;<span class="builtintype" id="4685689">uint32</span><span class="op" id="4685695">(</span><span class="builtintype" id="4685696">int32</span><span class="op" id="4685701">(</span><span class="ident" id="4685702">top4AllOnes</span><span class="op" id="4685713">&lt;&lt;</span><span class="num" id="4685715">31</span><span class="op" id="4685717">)</span>&nbsp;<span class="op" id="4685719">&gt;&gt;</span>&nbsp;<span class="num" id="4685722">31</span><span class="op" id="4685724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4685728">//&nbsp;Now&nbsp;we&nbsp;test&nbsp;whether&nbsp;the&nbsp;bottom&nbsp;three&nbsp;limbs&nbsp;are&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685789">bottom3NonZero</span>&nbsp;<span class="op" id="4685804">:=</span>&nbsp;<span class="ident" id="4685807">out</span><span class="op" id="4685810">[</span><span class="num" id="4685811">0</span><span class="op" id="4685812">]</span>&nbsp;<span class="op" id="4685814">|</span>&nbsp;<span class="ident" id="4685816">out</span><span class="op" id="4685819">[</span><span class="num" id="4685820">1</span><span class="op" id="4685821">]</span>&nbsp;<span class="op" id="4685823">|</span>&nbsp;<span class="ident" id="4685825">out</span><span class="op" id="4685828">[</span><span class="num" id="4685829">2</span><span class="op" id="4685830">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685833">bottom3NonZero</span>&nbsp;<span class="op" id="4685848">|=</span>&nbsp;<span class="ident" id="4685851">bottom3NonZero</span>&nbsp;<span class="op" id="4685866">&gt;&gt;</span>&nbsp;<span class="num" id="4685869">16</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685873">bottom3NonZero</span>&nbsp;<span class="op" id="4685888">|=</span>&nbsp;<span class="ident" id="4685891">bottom3NonZero</span>&nbsp;<span class="op" id="4685906">&gt;&gt;</span>&nbsp;<span class="num" id="4685909">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685912">bottom3NonZero</span>&nbsp;<span class="op" id="4685927">|=</span>&nbsp;<span class="ident" id="4685930">bottom3NonZero</span>&nbsp;<span class="op" id="4685945">&gt;&gt;</span>&nbsp;<span class="num" id="4685948">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685951">bottom3NonZero</span>&nbsp;<span class="op" id="4685966">|=</span>&nbsp;<span class="ident" id="4685969">bottom3NonZero</span>&nbsp;<span class="op" id="4685984">&gt;&gt;</span>&nbsp;<span class="num" id="4685987">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685990">bottom3NonZero</span>&nbsp;<span class="op" id="4686005">|=</span>&nbsp;<span class="ident" id="4686008">bottom3NonZero</span>&nbsp;<span class="op" id="4686023">&gt;&gt;</span>&nbsp;<span class="num" id="4686026">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686029">bottom3NonZero</span>&nbsp;<span class="op" id="4686044">=</span>&nbsp;<span class="builtintype" id="4686046">uint32</span><span class="op" id="4686052">(</span><span class="builtintype" id="4686053">int32</span><span class="op" id="4686058">(</span><span class="ident" id="4686059">bottom3NonZero</span><span class="op" id="4686073">&lt;&lt;</span><span class="num" id="4686075">31</span><span class="op" id="4686077">)</span>&nbsp;<span class="op" id="4686079">&gt;&gt;</span>&nbsp;<span class="num" id="4686082">31</span><span class="op" id="4686084">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4686088">//&nbsp;Everything&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;out[3].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4686135">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&gt;&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4686212">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;=&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;and&nbsp;bottom3NonZero&nbsp;!=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4686285">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4686323">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&lt;&nbsp;0xffff000,&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&lt;&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686379">n</span>&nbsp;<span class="op" id="4686381">:=</span>&nbsp;<span class="ident" id="4686384">out</span><span class="op" id="4686387">[</span><span class="num" id="4686388">3</span><span class="op" id="4686389">]</span>&nbsp;<span class="op" id="4686391">-</span>&nbsp;<span class="num" id="4686393">0xffff000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686404">out3Equal</span>&nbsp;<span class="op" id="4686414">:=</span>&nbsp;<span class="ident" id="4686417">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686420">out3Equal</span>&nbsp;<span class="op" id="4686430">|=</span>&nbsp;<span class="ident" id="4686433">out3Equal</span>&nbsp;<span class="op" id="4686443">&gt;&gt;</span>&nbsp;<span class="num" id="4686446">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686450">out3Equal</span>&nbsp;<span class="op" id="4686460">|=</span>&nbsp;<span class="ident" id="4686463">out3Equal</span>&nbsp;<span class="op" id="4686473">&gt;&gt;</span>&nbsp;<span class="num" id="4686476">8</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686479">out3Equal</span>&nbsp;<span class="op" id="4686489">|=</span>&nbsp;<span class="ident" id="4686492">out3Equal</span>&nbsp;<span class="op" id="4686502">&gt;&gt;</span>&nbsp;<span class="num" id="4686505">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686508">out3Equal</span>&nbsp;<span class="op" id="4686518">|=</span>&nbsp;<span class="ident" id="4686521">out3Equal</span>&nbsp;<span class="op" id="4686531">&gt;&gt;</span>&nbsp;<span class="num" id="4686534">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686537">out3Equal</span>&nbsp;<span class="op" id="4686547">|=</span>&nbsp;<span class="ident" id="4686550">out3Equal</span>&nbsp;<span class="op" id="4686560">&gt;&gt;</span>&nbsp;<span class="num" id="4686563">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686566">out3Equal</span>&nbsp;<span class="op" id="4686576">=</span>&nbsp;<span class="op" id="4686578">^</span><span class="builtintype" id="4686579">uint32</span><span class="op" id="4686585">(</span><span class="builtintype" id="4686586">int32</span><span class="op" id="4686591">(</span><span class="ident" id="4686592">out3Equal</span><span class="op" id="4686601">&lt;&lt;</span><span class="num" id="4686603">31</span><span class="op" id="4686605">)</span>&nbsp;<span class="op" id="4686607">&gt;&gt;</span>&nbsp;<span class="num" id="4686610">31</span><span class="op" id="4686612">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4686616">//&nbsp;If&nbsp;out[3]&nbsp;&gt;&nbsp;0xffff000&nbsp;then&nbsp;n&#39;s&nbsp;MSB&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686669">out3GT</span>&nbsp;<span class="op" id="4686676">:=</span>&nbsp;<span class="op" id="4686679">^</span><span class="builtintype" id="4686680">uint32</span><span class="op" id="4686686">(</span><span class="builtintype" id="4686687">int32</span><span class="op" id="4686692">(</span><span class="ident" id="4686693">n</span><span class="op" id="4686694">)</span>&nbsp;<span class="op" id="4686696">&gt;&gt;</span>&nbsp;<span class="num" id="4686699">31</span><span class="op" id="4686701">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686705">mask</span>&nbsp;<span class="op" id="4686710">:=</span>&nbsp;<span class="ident" id="4686713">top4AllOnes</span>&nbsp;<span class="op" id="4686725">&amp;</span>&nbsp;<span class="op" id="4686727">(</span><span class="op" id="4686728">(</span><span class="ident" id="4686729">out3Equal</span>&nbsp;<span class="op" id="4686739">&amp;</span>&nbsp;<span class="ident" id="4686741">bottom3NonZero</span><span class="op" id="4686755">)</span>&nbsp;<span class="op" id="4686757">|</span>&nbsp;<span class="ident" id="4686759">out3GT</span><span class="op" id="4686765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686768">out</span><span class="op" id="4686771">[</span><span class="num" id="4686772">0</span><span class="op" id="4686773">]</span>&nbsp;<span class="op" id="4686775">-=</span>&nbsp;<span class="num" id="4686778">1</span>&nbsp;<span class="op" id="4686780">&amp;</span>&nbsp;<span class="ident" id="4686782">mask</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686788">out</span><span class="op" id="4686791">[</span><span class="num" id="4686792">3</span><span class="op" id="4686793">]</span>&nbsp;<span class="op" id="4686795">-=</span>&nbsp;<span class="num" id="4686798">0xffff000</span>&nbsp;<span class="op" id="4686808">&amp;</span>&nbsp;<span class="ident" id="4686810">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686816">out</span><span class="op" id="4686819">[</span><span class="num" id="4686820">4</span><span class="op" id="4686821">]</span>&nbsp;<span class="op" id="4686823">-=</span>&nbsp;<span class="num" id="4686826">0xfffffff</span>&nbsp;<span class="op" id="4686836">&amp;</span>&nbsp;<span class="ident" id="4686838">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686844">out</span><span class="op" id="4686847">[</span><span class="num" id="4686848">5</span><span class="op" id="4686849">]</span>&nbsp;<span class="op" id="4686851">-=</span>&nbsp;<span class="num" id="4686854">0xfffffff</span>&nbsp;<span class="op" id="4686864">&amp;</span>&nbsp;<span class="ident" id="4686866">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686872">out</span><span class="op" id="4686875">[</span><span class="num" id="4686876">6</span><span class="op" id="4686877">]</span>&nbsp;<span class="op" id="4686879">-=</span>&nbsp;<span class="num" id="4686882">0xfffffff</span>&nbsp;<span class="op" id="4686892">&amp;</span>&nbsp;<span class="ident" id="4686894">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686900">out</span><span class="op" id="4686903">[</span><span class="num" id="4686904">7</span><span class="op" id="4686905">]</span>&nbsp;<span class="op" id="4686907">-=</span>&nbsp;<span class="num" id="4686910">0xfffffff</span>&nbsp;<span class="op" id="4686920">&amp;</span>&nbsp;<span class="ident" id="4686922">mask</span><br>
<span class="lineno">495</span><span class="op" id="4686927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4686930">//&nbsp;Group&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4686958">//</span><br>
<span class="lineno"></span><span class="comment" id="4686961">//&nbsp;These&nbsp;functions&nbsp;deal&nbsp;with&nbsp;group&nbsp;elements.&nbsp;The&nbsp;group&nbsp;is&nbsp;an&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno">500</span><span class="comment" id="4687037">//&nbsp;group&nbsp;with&nbsp;a&nbsp;=&nbsp;-3&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4687097">//&nbsp;p224AddJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b&nbsp;where&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="4687150">func</span>&nbsp;<span class="ident" id="4687155">p224AddJacobian</span><span class="op" id="4687170">(</span><span class="ident" id="4687171">x3</span><span class="op" id="4687173">,</span>&nbsp;<span class="ident" id="4687175">y3</span><span class="op" id="4687177">,</span>&nbsp;<span class="ident" id="4687179">z3</span><span class="op" id="4687181">,</span>&nbsp;<span class="ident" id="4687183">x1</span><span class="op" id="4687185">,</span>&nbsp;<span class="ident" id="4687187">y1</span><span class="op" id="4687189">,</span>&nbsp;<span class="ident" id="4687191">z1</span><span class="op" id="4687193">,</span>&nbsp;<span class="ident" id="4687195">x2</span><span class="op" id="4687197">,</span>&nbsp;<span class="ident" id="4687199">y2</span><span class="op" id="4687201">,</span>&nbsp;<span class="ident" id="4687203">z2</span>&nbsp;<span class="op" id="4687206">*</span><span class="ident" id="4687207">p224FieldElement</span><span class="op" id="4687223">)</span>&nbsp;<span class="op" id="4687225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4687228">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-p224Add-2007-bl</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687322">var</span>&nbsp;<span class="ident" id="4687326">z1z1</span><span class="op" id="4687330">,</span>&nbsp;<span class="ident" id="4687332">z2z2</span><span class="op" id="4687336">,</span>&nbsp;<span class="ident" id="4687338">u1</span><span class="op" id="4687340">,</span>&nbsp;<span class="ident" id="4687342">u2</span><span class="op" id="4687344">,</span>&nbsp;<span class="ident" id="4687346">s1</span><span class="op" id="4687348">,</span>&nbsp;<span class="ident" id="4687350">s2</span><span class="op" id="4687352">,</span>&nbsp;<span class="ident" id="4687354">h</span><span class="op" id="4687355">,</span>&nbsp;<span class="ident" id="4687357">i</span><span class="op" id="4687358">,</span>&nbsp;<span class="ident" id="4687360">j</span><span class="op" id="4687361">,</span>&nbsp;<span class="ident" id="4687363">r</span><span class="op" id="4687364">,</span>&nbsp;<span class="ident" id="4687366">v</span>&nbsp;<span class="ident" id="4687368">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687386">var</span>&nbsp;<span class="ident" id="4687390">c</span>&nbsp;<span class="ident" id="4687392">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687416">z1IsZero</span>&nbsp;<span class="op" id="4687425">:=</span>&nbsp;<span class="ident" id="4687428">p224IsZero</span><span class="op" id="4687438">(</span><span class="ident" id="4687439">z1</span><span class="op" id="4687441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687444">z2IsZero</span>&nbsp;<span class="op" id="4687453">:=</span>&nbsp;<span class="ident" id="4687456">p224IsZero</span><span class="op" id="4687466">(</span><span class="ident" id="4687467">z2</span><span class="op" id="4687469">)</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4687473">//&nbsp;Z1Z1&nbsp;=&nbsp;Z1²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687489">p224Square</span><span class="op" id="4687499">(</span><span class="op" id="4687500">&amp;</span><span class="ident" id="4687501">z1z1</span><span class="op" id="4687505">,</span>&nbsp;<span class="ident" id="4687507">z1</span><span class="op" id="4687509">,</span>&nbsp;<span class="op" id="4687511">&amp;</span><span class="ident" id="4687512">c</span><span class="op" id="4687513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4687516">//&nbsp;Z2Z2&nbsp;=&nbsp;Z2²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687532">p224Square</span><span class="op" id="4687542">(</span><span class="op" id="4687543">&amp;</span><span class="ident" id="4687544">z2z2</span><span class="op" id="4687548">,</span>&nbsp;<span class="ident" id="4687550">z2</span><span class="op" id="4687552">,</span>&nbsp;<span class="op" id="4687554">&amp;</span><span class="ident" id="4687555">c</span><span class="op" id="4687556">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4687559">//&nbsp;U1&nbsp;=&nbsp;X1*Z2Z2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687576">p224Mul</span><span class="op" id="4687583">(</span><span class="op" id="4687584">&amp;</span><span class="ident" id="4687585">u1</span><span class="op" id="4687587">,</span>&nbsp;<span class="ident" id="4687589">x1</span><span class="op" id="4687591">,</span>&nbsp;<span class="op" id="4687593">&amp;</span><span class="ident" id="4687594">z2z2</span><span class="op" id="4687598">,</span>&nbsp;<span class="op" id="4687600">&amp;</span><span class="ident" id="4687601">c</span><span class="op" id="4687602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4687605">//&nbsp;U2&nbsp;=&nbsp;X2*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687622">p224Mul</span><span class="op" id="4687629">(</span><span class="op" id="4687630">&amp;</span><span class="ident" id="4687631">u2</span><span class="op" id="4687633">,</span>&nbsp;<span class="ident" id="4687635">x2</span><span class="op" id="4687637">,</span>&nbsp;<span class="op" id="4687639">&amp;</span><span class="ident" id="4687640">z1z1</span><span class="op" id="4687644">,</span>&nbsp;<span class="op" id="4687646">&amp;</span><span class="ident" id="4687647">c</span><span class="op" id="4687648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4687651">//&nbsp;S1&nbsp;=&nbsp;Y1*Z2*Z2Z2</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687671">p224Mul</span><span class="op" id="4687678">(</span><span class="op" id="4687679">&amp;</span><span class="ident" id="4687680">s1</span><span class="op" id="4687682">,</span>&nbsp;<span class="ident" id="4687684">z2</span><span class="op" id="4687686">,</span>&nbsp;<span class="op" id="4687688">&amp;</span><span class="ident" id="4687689">z2z2</span><span class="op" id="4687693">,</span>&nbsp;<span class="op" id="4687695">&amp;</span><span class="ident" id="4687696">c</span><span class="op" id="4687697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687700">p224Mul</span><span class="op" id="4687707">(</span><span class="op" id="4687708">&amp;</span><span class="ident" id="4687709">s1</span><span class="op" id="4687711">,</span>&nbsp;<span class="ident" id="4687713">y1</span><span class="op" id="4687715">,</span>&nbsp;<span class="op" id="4687717">&amp;</span><span class="ident" id="4687718">s1</span><span class="op" id="4687720">,</span>&nbsp;<span class="op" id="4687722">&amp;</span><span class="ident" id="4687723">c</span><span class="op" id="4687724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4687727">//&nbsp;S2&nbsp;=&nbsp;Y2*Z1*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687747">p224Mul</span><span class="op" id="4687754">(</span><span class="op" id="4687755">&amp;</span><span class="ident" id="4687756">s2</span><span class="op" id="4687758">,</span>&nbsp;<span class="ident" id="4687760">z1</span><span class="op" id="4687762">,</span>&nbsp;<span class="op" id="4687764">&amp;</span><span class="ident" id="4687765">z1z1</span><span class="op" id="4687769">,</span>&nbsp;<span class="op" id="4687771">&amp;</span><span class="ident" id="4687772">c</span><span class="op" id="4687773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687776">p224Mul</span><span class="op" id="4687783">(</span><span class="op" id="4687784">&amp;</span><span class="ident" id="4687785">s2</span><span class="op" id="4687787">,</span>&nbsp;<span class="ident" id="4687789">y2</span><span class="op" id="4687791">,</span>&nbsp;<span class="op" id="4687793">&amp;</span><span class="ident" id="4687794">s2</span><span class="op" id="4687796">,</span>&nbsp;<span class="op" id="4687798">&amp;</span><span class="ident" id="4687799">c</span><span class="op" id="4687800">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4687803">//&nbsp;H&nbsp;=&nbsp;U2-U1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687817">p224Sub</span><span class="op" id="4687824">(</span><span class="op" id="4687825">&amp;</span><span class="ident" id="4687826">h</span><span class="op" id="4687827">,</span>&nbsp;<span class="op" id="4687829">&amp;</span><span class="ident" id="4687830">u2</span><span class="op" id="4687832">,</span>&nbsp;<span class="op" id="4687834">&amp;</span><span class="ident" id="4687835">u1</span><span class="op" id="4687837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687840">p224Reduce</span><span class="op" id="4687850">(</span><span class="op" id="4687851">&amp;</span><span class="ident" id="4687852">h</span><span class="op" id="4687853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687856">xEqual</span>&nbsp;<span class="op" id="4687863">:=</span>&nbsp;<span class="ident" id="4687866">p224IsZero</span><span class="op" id="4687876">(</span><span class="op" id="4687877">&amp;</span><span class="ident" id="4687878">h</span><span class="op" id="4687879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4687882">//&nbsp;I&nbsp;=&nbsp;(2*H)²</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687898">for</span>&nbsp;<span class="ident" id="4687902">j</span>&nbsp;<span class="op" id="4687904">:=</span>&nbsp;<span class="num" id="4687907">0</span><span class="op" id="4687908">;</span>&nbsp;<span class="ident" id="4687910">j</span>&nbsp;<span class="op" id="4687912">&lt;</span>&nbsp;<span class="num" id="4687914">8</span><span class="op" id="4687915">;</span>&nbsp;<span class="ident" id="4687917">j</span><span class="op" id="4687918">++</span>&nbsp;<span class="op" id="4687921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687925">i</span><span class="op" id="4687926">[</span><span class="ident" id="4687927">j</span><span class="op" id="4687928">]</span>&nbsp;<span class="op" id="4687930">=</span>&nbsp;<span class="ident" id="4687932">h</span><span class="op" id="4687933">[</span><span class="ident" id="4687934">j</span><span class="op" id="4687935">]</span>&nbsp;<span class="op" id="4687937">&lt;&lt;</span>&nbsp;<span class="num" id="4687940">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687946">p224Reduce</span><span class="op" id="4687956">(</span><span class="op" id="4687957">&amp;</span><span class="ident" id="4687958">i</span><span class="op" id="4687959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687962">p224Square</span><span class="op" id="4687972">(</span><span class="op" id="4687973">&amp;</span><span class="ident" id="4687974">i</span><span class="op" id="4687975">,</span>&nbsp;<span class="op" id="4687977">&amp;</span><span class="ident" id="4687978">i</span><span class="op" id="4687979">,</span>&nbsp;<span class="op" id="4687981">&amp;</span><span class="ident" id="4687982">c</span><span class="op" id="4687983">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4687986">//&nbsp;J&nbsp;=&nbsp;H*I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687998">p224Mul</span><span class="op" id="4688005">(</span><span class="op" id="4688006">&amp;</span><span class="ident" id="4688007">j</span><span class="op" id="4688008">,</span>&nbsp;<span class="op" id="4688010">&amp;</span><span class="ident" id="4688011">h</span><span class="op" id="4688012">,</span>&nbsp;<span class="op" id="4688014">&amp;</span><span class="ident" id="4688015">i</span><span class="op" id="4688016">,</span>&nbsp;<span class="op" id="4688018">&amp;</span><span class="ident" id="4688019">c</span><span class="op" id="4688020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4688023">//&nbsp;r&nbsp;=&nbsp;2*(S2-S1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688041">p224Sub</span><span class="op" id="4688048">(</span><span class="op" id="4688049">&amp;</span><span class="ident" id="4688050">r</span><span class="op" id="4688051">,</span>&nbsp;<span class="op" id="4688053">&amp;</span><span class="ident" id="4688054">s2</span><span class="op" id="4688056">,</span>&nbsp;<span class="op" id="4688058">&amp;</span><span class="ident" id="4688059">s1</span><span class="op" id="4688061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688064">p224Reduce</span><span class="op" id="4688074">(</span><span class="op" id="4688075">&amp;</span><span class="ident" id="4688076">r</span><span class="op" id="4688077">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688080">yEqual</span>&nbsp;<span class="op" id="4688087">:=</span>&nbsp;<span class="ident" id="4688090">p224IsZero</span><span class="op" id="4688100">(</span><span class="op" id="4688101">&amp;</span><span class="ident" id="4688102">r</span><span class="op" id="4688103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688106">if</span>&nbsp;<span class="ident" id="4688109">xEqual</span>&nbsp;<span class="op" id="4688116">==</span>&nbsp;<span class="num" id="4688119">1</span>&nbsp;<span class="op" id="4688121">&amp;&amp;</span>&nbsp;<span class="ident" id="4688124">yEqual</span>&nbsp;<span class="op" id="4688131">==</span>&nbsp;<span class="num" id="4688134">1</span>&nbsp;<span class="op" id="4688136">&amp;&amp;</span>&nbsp;<span class="ident" id="4688139">z1IsZero</span>&nbsp;<span class="op" id="4688148">==</span>&nbsp;<span class="num" id="4688151">0</span>&nbsp;<span class="op" id="4688153">&amp;&amp;</span>&nbsp;<span class="ident" id="4688156">z2IsZero</span>&nbsp;<span class="op" id="4688165">==</span>&nbsp;<span class="num" id="4688168">0</span>&nbsp;<span class="op" id="4688170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688174">p224DoubleJacobian</span><span class="op" id="4688192">(</span><span class="ident" id="4688193">x3</span><span class="op" id="4688195">,</span>&nbsp;<span class="ident" id="4688197">y3</span><span class="op" id="4688199">,</span>&nbsp;<span class="ident" id="4688201">z3</span><span class="op" id="4688203">,</span>&nbsp;<span class="ident" id="4688205">x1</span><span class="op" id="4688207">,</span>&nbsp;<span class="ident" id="4688209">y1</span><span class="op" id="4688211">,</span>&nbsp;<span class="ident" id="4688213">z1</span><span class="op" id="4688215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688219">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4688227">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688230">for</span>&nbsp;<span class="ident" id="4688234">i</span>&nbsp;<span class="op" id="4688236">:=</span>&nbsp;<span class="num" id="4688239">0</span><span class="op" id="4688240">;</span>&nbsp;<span class="ident" id="4688242">i</span>&nbsp;<span class="op" id="4688244">&lt;</span>&nbsp;<span class="num" id="4688246">8</span><span class="op" id="4688247">;</span>&nbsp;<span class="ident" id="4688249">i</span><span class="op" id="4688250">++</span>&nbsp;<span class="op" id="4688253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688257">r</span><span class="op" id="4688258">[</span><span class="ident" id="4688259">i</span><span class="op" id="4688260">]</span>&nbsp;<span class="op" id="4688262">&lt;&lt;=</span>&nbsp;<span class="num" id="4688266">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4688269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688272">p224Reduce</span><span class="op" id="4688282">(</span><span class="op" id="4688283">&amp;</span><span class="ident" id="4688284">r</span><span class="op" id="4688285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4688288">//&nbsp;V&nbsp;=&nbsp;U1*I</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688301">p224Mul</span><span class="op" id="4688308">(</span><span class="op" id="4688309">&amp;</span><span class="ident" id="4688310">v</span><span class="op" id="4688311">,</span>&nbsp;<span class="op" id="4688313">&amp;</span><span class="ident" id="4688314">u1</span><span class="op" id="4688316">,</span>&nbsp;<span class="op" id="4688318">&amp;</span><span class="ident" id="4688319">i</span><span class="op" id="4688320">,</span>&nbsp;<span class="op" id="4688322">&amp;</span><span class="ident" id="4688323">c</span><span class="op" id="4688324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4688327">//&nbsp;Z3&nbsp;=&nbsp;((Z1+Z2)²-Z1Z1-Z2Z2)*H</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688360">p224Add</span><span class="op" id="4688367">(</span><span class="op" id="4688368">&amp;</span><span class="ident" id="4688369">z1z1</span><span class="op" id="4688373">,</span>&nbsp;<span class="op" id="4688375">&amp;</span><span class="ident" id="4688376">z1z1</span><span class="op" id="4688380">,</span>&nbsp;<span class="op" id="4688382">&amp;</span><span class="ident" id="4688383">z2z2</span><span class="op" id="4688387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688390">p224Add</span><span class="op" id="4688397">(</span><span class="op" id="4688398">&amp;</span><span class="ident" id="4688399">z2z2</span><span class="op" id="4688403">,</span>&nbsp;<span class="ident" id="4688405">z1</span><span class="op" id="4688407">,</span>&nbsp;<span class="ident" id="4688409">z2</span><span class="op" id="4688411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688414">p224Reduce</span><span class="op" id="4688424">(</span><span class="op" id="4688425">&amp;</span><span class="ident" id="4688426">z2z2</span><span class="op" id="4688430">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688433">p224Square</span><span class="op" id="4688443">(</span><span class="op" id="4688444">&amp;</span><span class="ident" id="4688445">z2z2</span><span class="op" id="4688449">,</span>&nbsp;<span class="op" id="4688451">&amp;</span><span class="ident" id="4688452">z2z2</span><span class="op" id="4688456">,</span>&nbsp;<span class="op" id="4688458">&amp;</span><span class="ident" id="4688459">c</span><span class="op" id="4688460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688463">p224Sub</span><span class="op" id="4688470">(</span><span class="ident" id="4688471">z3</span><span class="op" id="4688473">,</span>&nbsp;<span class="op" id="4688475">&amp;</span><span class="ident" id="4688476">z2z2</span><span class="op" id="4688480">,</span>&nbsp;<span class="op" id="4688482">&amp;</span><span class="ident" id="4688483">z1z1</span><span class="op" id="4688487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688490">p224Reduce</span><span class="op" id="4688500">(</span><span class="ident" id="4688501">z3</span><span class="op" id="4688503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688506">p224Mul</span><span class="op" id="4688513">(</span><span class="ident" id="4688514">z3</span><span class="op" id="4688516">,</span>&nbsp;<span class="ident" id="4688518">z3</span><span class="op" id="4688520">,</span>&nbsp;<span class="op" id="4688522">&amp;</span><span class="ident" id="4688523">h</span><span class="op" id="4688524">,</span>&nbsp;<span class="op" id="4688526">&amp;</span><span class="ident" id="4688527">c</span><span class="op" id="4688528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4688531">//&nbsp;X3&nbsp;=&nbsp;r²-J-2*V</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688550">for</span>&nbsp;<span class="ident" id="4688554">i</span>&nbsp;<span class="op" id="4688556">:=</span>&nbsp;<span class="num" id="4688559">0</span><span class="op" id="4688560">;</span>&nbsp;<span class="ident" id="4688562">i</span>&nbsp;<span class="op" id="4688564">&lt;</span>&nbsp;<span class="num" id="4688566">8</span><span class="op" id="4688567">;</span>&nbsp;<span class="ident" id="4688569">i</span><span class="op" id="4688570">++</span>&nbsp;<span class="op" id="4688573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688577">z1z1</span><span class="op" id="4688581">[</span><span class="ident" id="4688582">i</span><span class="op" id="4688583">]</span>&nbsp;<span class="op" id="4688585">=</span>&nbsp;<span class="ident" id="4688587">v</span><span class="op" id="4688588">[</span><span class="ident" id="4688589">i</span><span class="op" id="4688590">]</span>&nbsp;<span class="op" id="4688592">&lt;&lt;</span>&nbsp;<span class="num" id="4688595">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4688598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688601">p224Add</span><span class="op" id="4688608">(</span><span class="op" id="4688609">&amp;</span><span class="ident" id="4688610">z1z1</span><span class="op" id="4688614">,</span>&nbsp;<span class="op" id="4688616">&amp;</span><span class="ident" id="4688617">j</span><span class="op" id="4688618">,</span>&nbsp;<span class="op" id="4688620">&amp;</span><span class="ident" id="4688621">z1z1</span><span class="op" id="4688625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688628">p224Reduce</span><span class="op" id="4688638">(</span><span class="op" id="4688639">&amp;</span><span class="ident" id="4688640">z1z1</span><span class="op" id="4688644">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688647">p224Square</span><span class="op" id="4688657">(</span><span class="ident" id="4688658">x3</span><span class="op" id="4688660">,</span>&nbsp;<span class="op" id="4688662">&amp;</span><span class="ident" id="4688663">r</span><span class="op" id="4688664">,</span>&nbsp;<span class="op" id="4688666">&amp;</span><span class="ident" id="4688667">c</span><span class="op" id="4688668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688671">p224Sub</span><span class="op" id="4688678">(</span><span class="ident" id="4688679">x3</span><span class="op" id="4688681">,</span>&nbsp;<span class="ident" id="4688683">x3</span><span class="op" id="4688685">,</span>&nbsp;<span class="op" id="4688687">&amp;</span><span class="ident" id="4688688">z1z1</span><span class="op" id="4688692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688695">p224Reduce</span><span class="op" id="4688705">(</span><span class="ident" id="4688706">x3</span><span class="op" id="4688708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4688711">//&nbsp;Y3&nbsp;=&nbsp;r*(V-X3)-2*S1*J</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688736">for</span>&nbsp;<span class="ident" id="4688740">i</span>&nbsp;<span class="op" id="4688742">:=</span>&nbsp;<span class="num" id="4688745">0</span><span class="op" id="4688746">;</span>&nbsp;<span class="ident" id="4688748">i</span>&nbsp;<span class="op" id="4688750">&lt;</span>&nbsp;<span class="num" id="4688752">8</span><span class="op" id="4688753">;</span>&nbsp;<span class="ident" id="4688755">i</span><span class="op" id="4688756">++</span>&nbsp;<span class="op" id="4688759">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688763">s1</span><span class="op" id="4688765">[</span><span class="ident" id="4688766">i</span><span class="op" id="4688767">]</span>&nbsp;<span class="op" id="4688769">&lt;&lt;=</span>&nbsp;<span class="num" id="4688773">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4688776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688779">p224Mul</span><span class="op" id="4688786">(</span><span class="op" id="4688787">&amp;</span><span class="ident" id="4688788">s1</span><span class="op" id="4688790">,</span>&nbsp;<span class="op" id="4688792">&amp;</span><span class="ident" id="4688793">s1</span><span class="op" id="4688795">,</span>&nbsp;<span class="op" id="4688797">&amp;</span><span class="ident" id="4688798">j</span><span class="op" id="4688799">,</span>&nbsp;<span class="op" id="4688801">&amp;</span><span class="ident" id="4688802">c</span><span class="op" id="4688803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688806">p224Sub</span><span class="op" id="4688813">(</span><span class="op" id="4688814">&amp;</span><span class="ident" id="4688815">z1z1</span><span class="op" id="4688819">,</span>&nbsp;<span class="op" id="4688821">&amp;</span><span class="ident" id="4688822">v</span><span class="op" id="4688823">,</span>&nbsp;<span class="ident" id="4688825">x3</span><span class="op" id="4688827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688830">p224Reduce</span><span class="op" id="4688840">(</span><span class="op" id="4688841">&amp;</span><span class="ident" id="4688842">z1z1</span><span class="op" id="4688846">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688849">p224Mul</span><span class="op" id="4688856">(</span><span class="op" id="4688857">&amp;</span><span class="ident" id="4688858">z1z1</span><span class="op" id="4688862">,</span>&nbsp;<span class="op" id="4688864">&amp;</span><span class="ident" id="4688865">z1z1</span><span class="op" id="4688869">,</span>&nbsp;<span class="op" id="4688871">&amp;</span><span class="ident" id="4688872">r</span><span class="op" id="4688873">,</span>&nbsp;<span class="op" id="4688875">&amp;</span><span class="ident" id="4688876">c</span><span class="op" id="4688877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688880">p224Sub</span><span class="op" id="4688887">(</span><span class="ident" id="4688888">y3</span><span class="op" id="4688890">,</span>&nbsp;<span class="op" id="4688892">&amp;</span><span class="ident" id="4688893">z1z1</span><span class="op" id="4688897">,</span>&nbsp;<span class="op" id="4688899">&amp;</span><span class="ident" id="4688900">s1</span><span class="op" id="4688902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688905">p224Reduce</span><span class="op" id="4688915">(</span><span class="ident" id="4688916">y3</span><span class="op" id="4688918">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688922">p224CopyConditional</span><span class="op" id="4688941">(</span><span class="ident" id="4688942">x3</span><span class="op" id="4688944">,</span>&nbsp;<span class="ident" id="4688946">x2</span><span class="op" id="4688948">,</span>&nbsp;<span class="ident" id="4688950">z1IsZero</span><span class="op" id="4688958">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688961">p224CopyConditional</span><span class="op" id="4688980">(</span><span class="ident" id="4688981">x3</span><span class="op" id="4688983">,</span>&nbsp;<span class="ident" id="4688985">x1</span><span class="op" id="4688987">,</span>&nbsp;<span class="ident" id="4688989">z2IsZero</span><span class="op" id="4688997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689000">p224CopyConditional</span><span class="op" id="4689019">(</span><span class="ident" id="4689020">y3</span><span class="op" id="4689022">,</span>&nbsp;<span class="ident" id="4689024">y2</span><span class="op" id="4689026">,</span>&nbsp;<span class="ident" id="4689028">z1IsZero</span><span class="op" id="4689036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689039">p224CopyConditional</span><span class="op" id="4689058">(</span><span class="ident" id="4689059">y3</span><span class="op" id="4689061">,</span>&nbsp;<span class="ident" id="4689063">y1</span><span class="op" id="4689065">,</span>&nbsp;<span class="ident" id="4689067">z2IsZero</span><span class="op" id="4689075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689078">p224CopyConditional</span><span class="op" id="4689097">(</span><span class="ident" id="4689098">z3</span><span class="op" id="4689100">,</span>&nbsp;<span class="ident" id="4689102">z2</span><span class="op" id="4689104">,</span>&nbsp;<span class="ident" id="4689106">z1IsZero</span><span class="op" id="4689114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689117">p224CopyConditional</span><span class="op" id="4689136">(</span><span class="ident" id="4689137">z3</span><span class="op" id="4689139">,</span>&nbsp;<span class="ident" id="4689141">z1</span><span class="op" id="4689143">,</span>&nbsp;<span class="ident" id="4689145">z2IsZero</span><span class="op" id="4689153">)</span><br>
<span class="lineno">585</span><span class="op" id="4689155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4689158">//&nbsp;p224DoubleJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+a.</span><br>
<span class="lineno"></span><span class="keyword" id="4689201">func</span>&nbsp;<span class="ident" id="4689206">p224DoubleJacobian</span><span class="op" id="4689224">(</span><span class="ident" id="4689225">x3</span><span class="op" id="4689227">,</span>&nbsp;<span class="ident" id="4689229">y3</span><span class="op" id="4689231">,</span>&nbsp;<span class="ident" id="4689233">z3</span><span class="op" id="4689235">,</span>&nbsp;<span class="ident" id="4689237">x1</span><span class="op" id="4689239">,</span>&nbsp;<span class="ident" id="4689241">y1</span><span class="op" id="4689243">,</span>&nbsp;<span class="ident" id="4689245">z1</span>&nbsp;<span class="op" id="4689248">*</span><span class="ident" id="4689249">p224FieldElement</span><span class="op" id="4689265">)</span>&nbsp;<span class="op" id="4689267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689270">var</span>&nbsp;<span class="ident" id="4689274">delta</span><span class="op" id="4689279">,</span>&nbsp;<span class="ident" id="4689281">gamma</span><span class="op" id="4689286">,</span>&nbsp;<span class="ident" id="4689288">beta</span><span class="op" id="4689292">,</span>&nbsp;<span class="ident" id="4689294">alpha</span><span class="op" id="4689299">,</span>&nbsp;<span class="ident" id="4689301">t</span>&nbsp;<span class="ident" id="4689303">p224FieldElement</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689321">var</span>&nbsp;<span class="ident" id="4689325">c</span>&nbsp;<span class="ident" id="4689327">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689351">p224Square</span><span class="op" id="4689361">(</span><span class="op" id="4689362">&amp;</span><span class="ident" id="4689363">delta</span><span class="op" id="4689368">,</span>&nbsp;<span class="ident" id="4689370">z1</span><span class="op" id="4689372">,</span>&nbsp;<span class="op" id="4689374">&amp;</span><span class="ident" id="4689375">c</span><span class="op" id="4689376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689379">p224Square</span><span class="op" id="4689389">(</span><span class="op" id="4689390">&amp;</span><span class="ident" id="4689391">gamma</span><span class="op" id="4689396">,</span>&nbsp;<span class="ident" id="4689398">y1</span><span class="op" id="4689400">,</span>&nbsp;<span class="op" id="4689402">&amp;</span><span class="ident" id="4689403">c</span><span class="op" id="4689404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689407">p224Mul</span><span class="op" id="4689414">(</span><span class="op" id="4689415">&amp;</span><span class="ident" id="4689416">beta</span><span class="op" id="4689420">,</span>&nbsp;<span class="ident" id="4689422">x1</span><span class="op" id="4689424">,</span>&nbsp;<span class="op" id="4689426">&amp;</span><span class="ident" id="4689427">gamma</span><span class="op" id="4689432">,</span>&nbsp;<span class="op" id="4689434">&amp;</span><span class="ident" id="4689435">c</span><span class="op" id="4689436">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4689440">//&nbsp;alpha&nbsp;=&nbsp;3*(X1-delta)*(X1+delta)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689476">p224Add</span><span class="op" id="4689483">(</span><span class="op" id="4689484">&amp;</span><span class="ident" id="4689485">t</span><span class="op" id="4689486">,</span>&nbsp;<span class="ident" id="4689488">x1</span><span class="op" id="4689490">,</span>&nbsp;<span class="op" id="4689492">&amp;</span><span class="ident" id="4689493">delta</span><span class="op" id="4689498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689501">for</span>&nbsp;<span class="ident" id="4689505">i</span>&nbsp;<span class="op" id="4689507">:=</span>&nbsp;<span class="num" id="4689510">0</span><span class="op" id="4689511">;</span>&nbsp;<span class="ident" id="4689513">i</span>&nbsp;<span class="op" id="4689515">&lt;</span>&nbsp;<span class="num" id="4689517">8</span><span class="op" id="4689518">;</span>&nbsp;<span class="ident" id="4689520">i</span><span class="op" id="4689521">++</span>&nbsp;<span class="op" id="4689524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689528">t</span><span class="op" id="4689529">[</span><span class="ident" id="4689530">i</span><span class="op" id="4689531">]</span>&nbsp;<span class="op" id="4689533">+=</span>&nbsp;<span class="ident" id="4689536">t</span><span class="op" id="4689537">[</span><span class="ident" id="4689538">i</span><span class="op" id="4689539">]</span>&nbsp;<span class="op" id="4689541">&lt;&lt;</span>&nbsp;<span class="num" id="4689544">1</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689550">p224Reduce</span><span class="op" id="4689560">(</span><span class="op" id="4689561">&amp;</span><span class="ident" id="4689562">t</span><span class="op" id="4689563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689566">p224Sub</span><span class="op" id="4689573">(</span><span class="op" id="4689574">&amp;</span><span class="ident" id="4689575">alpha</span><span class="op" id="4689580">,</span>&nbsp;<span class="ident" id="4689582">x1</span><span class="op" id="4689584">,</span>&nbsp;<span class="op" id="4689586">&amp;</span><span class="ident" id="4689587">delta</span><span class="op" id="4689592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689595">p224Reduce</span><span class="op" id="4689605">(</span><span class="op" id="4689606">&amp;</span><span class="ident" id="4689607">alpha</span><span class="op" id="4689612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689615">p224Mul</span><span class="op" id="4689622">(</span><span class="op" id="4689623">&amp;</span><span class="ident" id="4689624">alpha</span><span class="op" id="4689629">,</span>&nbsp;<span class="op" id="4689631">&amp;</span><span class="ident" id="4689632">alpha</span><span class="op" id="4689637">,</span>&nbsp;<span class="op" id="4689639">&amp;</span><span class="ident" id="4689640">t</span><span class="op" id="4689641">,</span>&nbsp;<span class="op" id="4689643">&amp;</span><span class="ident" id="4689644">c</span><span class="op" id="4689645">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4689649">//&nbsp;Z3&nbsp;=&nbsp;(Y1+Z1)²-gamma-delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689680">p224Add</span><span class="op" id="4689687">(</span><span class="ident" id="4689688">z3</span><span class="op" id="4689690">,</span>&nbsp;<span class="ident" id="4689692">y1</span><span class="op" id="4689694">,</span>&nbsp;<span class="ident" id="4689696">z1</span><span class="op" id="4689698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689701">p224Reduce</span><span class="op" id="4689711">(</span><span class="ident" id="4689712">z3</span><span class="op" id="4689714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689717">p224Square</span><span class="op" id="4689727">(</span><span class="ident" id="4689728">z3</span><span class="op" id="4689730">,</span>&nbsp;<span class="ident" id="4689732">z3</span><span class="op" id="4689734">,</span>&nbsp;<span class="op" id="4689736">&amp;</span><span class="ident" id="4689737">c</span><span class="op" id="4689738">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689741">p224Sub</span><span class="op" id="4689748">(</span><span class="ident" id="4689749">z3</span><span class="op" id="4689751">,</span>&nbsp;<span class="ident" id="4689753">z3</span><span class="op" id="4689755">,</span>&nbsp;<span class="op" id="4689757">&amp;</span><span class="ident" id="4689758">gamma</span><span class="op" id="4689763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689766">p224Reduce</span><span class="op" id="4689776">(</span><span class="ident" id="4689777">z3</span><span class="op" id="4689779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689782">p224Sub</span><span class="op" id="4689789">(</span><span class="ident" id="4689790">z3</span><span class="op" id="4689792">,</span>&nbsp;<span class="ident" id="4689794">z3</span><span class="op" id="4689796">,</span>&nbsp;<span class="op" id="4689798">&amp;</span><span class="ident" id="4689799">delta</span><span class="op" id="4689804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689807">p224Reduce</span><span class="op" id="4689817">(</span><span class="ident" id="4689818">z3</span><span class="op" id="4689820">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4689824">//&nbsp;X3&nbsp;=&nbsp;alpha²-8*beta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689848">for</span>&nbsp;<span class="ident" id="4689852">i</span>&nbsp;<span class="op" id="4689854">:=</span>&nbsp;<span class="num" id="4689857">0</span><span class="op" id="4689858">;</span>&nbsp;<span class="ident" id="4689860">i</span>&nbsp;<span class="op" id="4689862">&lt;</span>&nbsp;<span class="num" id="4689864">8</span><span class="op" id="4689865">;</span>&nbsp;<span class="ident" id="4689867">i</span><span class="op" id="4689868">++</span>&nbsp;<span class="op" id="4689871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689875">delta</span><span class="op" id="4689880">[</span><span class="ident" id="4689881">i</span><span class="op" id="4689882">]</span>&nbsp;<span class="op" id="4689884">=</span>&nbsp;<span class="ident" id="4689886">beta</span><span class="op" id="4689890">[</span><span class="ident" id="4689891">i</span><span class="op" id="4689892">]</span>&nbsp;<span class="op" id="4689894">&lt;&lt;</span>&nbsp;<span class="num" id="4689897">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689903">p224Reduce</span><span class="op" id="4689913">(</span><span class="op" id="4689914">&amp;</span><span class="ident" id="4689915">delta</span><span class="op" id="4689920">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689923">p224Square</span><span class="op" id="4689933">(</span><span class="ident" id="4689934">x3</span><span class="op" id="4689936">,</span>&nbsp;<span class="op" id="4689938">&amp;</span><span class="ident" id="4689939">alpha</span><span class="op" id="4689944">,</span>&nbsp;<span class="op" id="4689946">&amp;</span><span class="ident" id="4689947">c</span><span class="op" id="4689948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689951">p224Sub</span><span class="op" id="4689958">(</span><span class="ident" id="4689959">x3</span><span class="op" id="4689961">,</span>&nbsp;<span class="ident" id="4689963">x3</span><span class="op" id="4689965">,</span>&nbsp;<span class="op" id="4689967">&amp;</span><span class="ident" id="4689968">delta</span><span class="op" id="4689973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689976">p224Reduce</span><span class="op" id="4689986">(</span><span class="ident" id="4689987">x3</span><span class="op" id="4689989">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4689993">//&nbsp;Y3&nbsp;=&nbsp;alpha*(4*beta-X3)-8*gamma²</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690030">for</span>&nbsp;<span class="ident" id="4690034">i</span>&nbsp;<span class="op" id="4690036">:=</span>&nbsp;<span class="num" id="4690039">0</span><span class="op" id="4690040">;</span>&nbsp;<span class="ident" id="4690042">i</span>&nbsp;<span class="op" id="4690044">&lt;</span>&nbsp;<span class="num" id="4690046">8</span><span class="op" id="4690047">;</span>&nbsp;<span class="ident" id="4690049">i</span><span class="op" id="4690050">++</span>&nbsp;<span class="op" id="4690053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690057">beta</span><span class="op" id="4690061">[</span><span class="ident" id="4690062">i</span><span class="op" id="4690063">]</span>&nbsp;<span class="op" id="4690065">&lt;&lt;=</span>&nbsp;<span class="num" id="4690069">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690075">p224Sub</span><span class="op" id="4690082">(</span><span class="op" id="4690083">&amp;</span><span class="ident" id="4690084">beta</span><span class="op" id="4690088">,</span>&nbsp;<span class="op" id="4690090">&amp;</span><span class="ident" id="4690091">beta</span><span class="op" id="4690095">,</span>&nbsp;<span class="ident" id="4690097">x3</span><span class="op" id="4690099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690102">p224Reduce</span><span class="op" id="4690112">(</span><span class="op" id="4690113">&amp;</span><span class="ident" id="4690114">beta</span><span class="op" id="4690118">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690121">p224Square</span><span class="op" id="4690131">(</span><span class="op" id="4690132">&amp;</span><span class="ident" id="4690133">gamma</span><span class="op" id="4690138">,</span>&nbsp;<span class="op" id="4690140">&amp;</span><span class="ident" id="4690141">gamma</span><span class="op" id="4690146">,</span>&nbsp;<span class="op" id="4690148">&amp;</span><span class="ident" id="4690149">c</span><span class="op" id="4690150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690153">for</span>&nbsp;<span class="ident" id="4690157">i</span>&nbsp;<span class="op" id="4690159">:=</span>&nbsp;<span class="num" id="4690162">0</span><span class="op" id="4690163">;</span>&nbsp;<span class="ident" id="4690165">i</span>&nbsp;<span class="op" id="4690167">&lt;</span>&nbsp;<span class="num" id="4690169">8</span><span class="op" id="4690170">;</span>&nbsp;<span class="ident" id="4690172">i</span><span class="op" id="4690173">++</span>&nbsp;<span class="op" id="4690176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690180">gamma</span><span class="op" id="4690185">[</span><span class="ident" id="4690186">i</span><span class="op" id="4690187">]</span>&nbsp;<span class="op" id="4690189">&lt;&lt;=</span>&nbsp;<span class="num" id="4690193">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690199">p224Reduce</span><span class="op" id="4690209">(</span><span class="op" id="4690210">&amp;</span><span class="ident" id="4690211">gamma</span><span class="op" id="4690216">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690219">p224Mul</span><span class="op" id="4690226">(</span><span class="ident" id="4690227">y3</span><span class="op" id="4690229">,</span>&nbsp;<span class="op" id="4690231">&amp;</span><span class="ident" id="4690232">alpha</span><span class="op" id="4690237">,</span>&nbsp;<span class="op" id="4690239">&amp;</span><span class="ident" id="4690240">beta</span><span class="op" id="4690244">,</span>&nbsp;<span class="op" id="4690246">&amp;</span><span class="ident" id="4690247">c</span><span class="op" id="4690248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690251">p224Sub</span><span class="op" id="4690258">(</span><span class="ident" id="4690259">y3</span><span class="op" id="4690261">,</span>&nbsp;<span class="ident" id="4690263">y3</span><span class="op" id="4690265">,</span>&nbsp;<span class="op" id="4690267">&amp;</span><span class="ident" id="4690268">gamma</span><span class="op" id="4690273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690276">p224Reduce</span><span class="op" id="4690286">(</span><span class="ident" id="4690287">y3</span><span class="op" id="4690289">)</span><br>
<span class="lineno"></span><span class="op" id="4690291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span><span class="comment" id="4690294">//&nbsp;p224CopyConditional&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in&nbsp;iff&nbsp;the&nbsp;least-significant-bit&nbsp;of&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="4690374">//&nbsp;is&nbsp;true,&nbsp;and&nbsp;it&nbsp;runs&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4690416">func</span>&nbsp;<span class="ident" id="4690421">p224CopyConditional</span><span class="op" id="4690440">(</span><span class="ident" id="4690441">out</span><span class="op" id="4690444">,</span>&nbsp;<span class="ident" id="4690446">in</span>&nbsp;<span class="op" id="4690449">*</span><span class="ident" id="4690450">p224FieldElement</span><span class="op" id="4690466">,</span>&nbsp;<span class="ident" id="4690468">control</span>&nbsp;<span class="builtintype" id="4690476">uint32</span><span class="op" id="4690482">)</span>&nbsp;<span class="op" id="4690484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690487">control</span>&nbsp;<span class="op" id="4690495">&lt;&lt;=</span>&nbsp;<span class="num" id="4690499">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690503">control</span>&nbsp;<span class="op" id="4690511">=</span>&nbsp;<span class="builtintype" id="4690513">uint32</span><span class="op" id="4690519">(</span><span class="builtintype" id="4690520">int32</span><span class="op" id="4690525">(</span><span class="ident" id="4690526">control</span><span class="op" id="4690533">)</span>&nbsp;<span class="op" id="4690535">&gt;&gt;</span>&nbsp;<span class="num" id="4690538">31</span><span class="op" id="4690540">)</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690544">for</span>&nbsp;<span class="ident" id="4690548">i</span>&nbsp;<span class="op" id="4690550">:=</span>&nbsp;<span class="num" id="4690553">0</span><span class="op" id="4690554">;</span>&nbsp;<span class="ident" id="4690556">i</span>&nbsp;<span class="op" id="4690558">&lt;</span>&nbsp;<span class="num" id="4690560">8</span><span class="op" id="4690561">;</span>&nbsp;<span class="ident" id="4690563">i</span><span class="op" id="4690564">++</span>&nbsp;<span class="op" id="4690567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690571">out</span><span class="op" id="4690574">[</span><span class="ident" id="4690575">i</span><span class="op" id="4690576">]</span>&nbsp;<span class="op" id="4690578">^=</span>&nbsp;<span class="op" id="4690581">(</span><span class="ident" id="4690582">out</span><span class="op" id="4690585">[</span><span class="ident" id="4690586">i</span><span class="op" id="4690587">]</span>&nbsp;<span class="op" id="4690589">^</span>&nbsp;<span class="ident" id="4690591">in</span><span class="op" id="4690593">[</span><span class="ident" id="4690594">i</span><span class="op" id="4690595">]</span><span class="op" id="4690596">)</span>&nbsp;<span class="op" id="4690598">&amp;</span>&nbsp;<span class="ident" id="4690600">control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690609">}</span><br>
<span class="lineno"></span><span class="op" id="4690611">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span><span class="keyword" id="4690614">func</span>&nbsp;<span class="ident" id="4690619">p224ScalarMult</span><span class="op" id="4690633">(</span><span class="ident" id="4690634">outX</span><span class="op" id="4690638">,</span>&nbsp;<span class="ident" id="4690640">outY</span><span class="op" id="4690644">,</span>&nbsp;<span class="ident" id="4690646">outZ</span><span class="op" id="4690650">,</span>&nbsp;<span class="ident" id="4690652">inX</span><span class="op" id="4690655">,</span>&nbsp;<span class="ident" id="4690657">inY</span><span class="op" id="4690660">,</span>&nbsp;<span class="ident" id="4690662">inZ</span>&nbsp;<span class="op" id="4690666">*</span><span class="ident" id="4690667">p224FieldElement</span><span class="op" id="4690683">,</span>&nbsp;<span class="ident" id="4690685">scalar</span>&nbsp;<span class="op" id="4690692">[</span><span class="op" id="4690693">]</span><span class="builtintype" id="4690694">byte</span><span class="op" id="4690698">)</span>&nbsp;<span class="op" id="4690700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690703">var</span>&nbsp;<span class="ident" id="4690707">xx</span><span class="op" id="4690709">,</span>&nbsp;<span class="ident" id="4690711">yy</span><span class="op" id="4690713">,</span>&nbsp;<span class="ident" id="4690715">zz</span>&nbsp;<span class="ident" id="4690718">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690736">for</span>&nbsp;<span class="ident" id="4690740">i</span>&nbsp;<span class="op" id="4690742">:=</span>&nbsp;<span class="num" id="4690745">0</span><span class="op" id="4690746">;</span>&nbsp;<span class="ident" id="4690748">i</span>&nbsp;<span class="op" id="4690750">&lt;</span>&nbsp;<span class="num" id="4690752">8</span><span class="op" id="4690753">;</span>&nbsp;<span class="ident" id="4690755">i</span><span class="op" id="4690756">++</span>&nbsp;<span class="op" id="4690759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690763">outX</span><span class="op" id="4690767">[</span><span class="ident" id="4690768">i</span><span class="op" id="4690769">]</span>&nbsp;<span class="op" id="4690771">=</span>&nbsp;<span class="num" id="4690773">0</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690777">outY</span><span class="op" id="4690781">[</span><span class="ident" id="4690782">i</span><span class="op" id="4690783">]</span>&nbsp;<span class="op" id="4690785">=</span>&nbsp;<span class="num" id="4690787">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690791">outZ</span><span class="op" id="4690795">[</span><span class="ident" id="4690796">i</span><span class="op" id="4690797">]</span>&nbsp;<span class="op" id="4690799">=</span>&nbsp;<span class="num" id="4690801">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690808">for</span>&nbsp;<span class="ident" id="4690812">_</span><span class="op" id="4690813">,</span>&nbsp;<span class="builtintype" id="4690815">byte</span>&nbsp;<span class="op" id="4690820">:=</span>&nbsp;<span class="keyword" id="4690823">range</span>&nbsp;<span class="ident" id="4690829">scalar</span>&nbsp;<span class="op" id="4690836">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690840">for</span>&nbsp;<span class="ident" id="4690844">bitNum</span>&nbsp;<span class="op" id="4690851">:=</span>&nbsp;<span class="builtintype" id="4690854">uint</span><span class="op" id="4690858">(</span><span class="num" id="4690859">0</span><span class="op" id="4690860">)</span><span class="op" id="4690861">;</span>&nbsp;<span class="ident" id="4690863">bitNum</span>&nbsp;<span class="op" id="4690870">&lt;</span>&nbsp;<span class="num" id="4690872">8</span><span class="op" id="4690873">;</span>&nbsp;<span class="ident" id="4690875">bitNum</span><span class="op" id="4690881">++</span>&nbsp;<span class="op" id="4690884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690889">p224DoubleJacobian</span><span class="op" id="4690907">(</span><span class="ident" id="4690908">outX</span><span class="op" id="4690912">,</span>&nbsp;<span class="ident" id="4690914">outY</span><span class="op" id="4690918">,</span>&nbsp;<span class="ident" id="4690920">outZ</span><span class="op" id="4690924">,</span>&nbsp;<span class="ident" id="4690926">outX</span><span class="op" id="4690930">,</span>&nbsp;<span class="ident" id="4690932">outY</span><span class="op" id="4690936">,</span>&nbsp;<span class="ident" id="4690938">outZ</span><span class="op" id="4690942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690947">bit</span>&nbsp;<span class="op" id="4690951">:=</span>&nbsp;<span class="builtintype" id="4690954">uint32</span><span class="op" id="4690960">(</span><span class="op" id="4690961">(</span><span class="builtintype" id="4690962">byte</span>&nbsp;<span class="op" id="4690967">&gt;&gt;</span>&nbsp;<span class="op" id="4690970">(</span><span class="num" id="4690971">7</span>&nbsp;<span class="op" id="4690973">-</span>&nbsp;<span class="ident" id="4690975">bitNum</span><span class="op" id="4690981">)</span><span class="op" id="4690982">)</span>&nbsp;<span class="op" id="4690984">&amp;</span>&nbsp;<span class="num" id="4690986">1</span><span class="op" id="4690987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690992">p224AddJacobian</span><span class="op" id="4691007">(</span><span class="op" id="4691008">&amp;</span><span class="ident" id="4691009">xx</span><span class="op" id="4691011">,</span>&nbsp;<span class="op" id="4691013">&amp;</span><span class="ident" id="4691014">yy</span><span class="op" id="4691016">,</span>&nbsp;<span class="op" id="4691018">&amp;</span><span class="ident" id="4691019">zz</span><span class="op" id="4691021">,</span>&nbsp;<span class="ident" id="4691023">inX</span><span class="op" id="4691026">,</span>&nbsp;<span class="ident" id="4691028">inY</span><span class="op" id="4691031">,</span>&nbsp;<span class="ident" id="4691033">inZ</span><span class="op" id="4691036">,</span>&nbsp;<span class="ident" id="4691038">outX</span><span class="op" id="4691042">,</span>&nbsp;<span class="ident" id="4691044">outY</span><span class="op" id="4691048">,</span>&nbsp;<span class="ident" id="4691050">outZ</span><span class="op" id="4691054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691059">p224CopyConditional</span><span class="op" id="4691078">(</span><span class="ident" id="4691079">outX</span><span class="op" id="4691083">,</span>&nbsp;<span class="op" id="4691085">&amp;</span><span class="ident" id="4691086">xx</span><span class="op" id="4691088">,</span>&nbsp;<span class="ident" id="4691090">bit</span><span class="op" id="4691093">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691098">p224CopyConditional</span><span class="op" id="4691117">(</span><span class="ident" id="4691118">outY</span><span class="op" id="4691122">,</span>&nbsp;<span class="op" id="4691124">&amp;</span><span class="ident" id="4691125">yy</span><span class="op" id="4691127">,</span>&nbsp;<span class="ident" id="4691129">bit</span><span class="op" id="4691132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691137">p224CopyConditional</span><span class="op" id="4691156">(</span><span class="ident" id="4691157">outZ</span><span class="op" id="4691161">,</span>&nbsp;<span class="op" id="4691163">&amp;</span><span class="ident" id="4691164">zz</span><span class="op" id="4691166">,</span>&nbsp;<span class="ident" id="4691168">bit</span><span class="op" id="4691171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4691175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4691178">}</span><br>
<span class="lineno"></span><span class="op" id="4691180">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="4691183">//&nbsp;p224ToAffine&nbsp;converts&nbsp;from&nbsp;Jacobian&nbsp;to&nbsp;affine&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4691238">func</span>&nbsp;<span class="ident" id="4691243">p224ToAffine</span><span class="op" id="4691255">(</span><span class="ident" id="4691256">x</span><span class="op" id="4691257">,</span>&nbsp;<span class="ident" id="4691259">y</span><span class="op" id="4691260">,</span>&nbsp;<span class="ident" id="4691262">z</span>&nbsp;<span class="op" id="4691264">*</span><span class="ident" id="4691265">p224FieldElement</span><span class="op" id="4691281">)</span>&nbsp;<span class="op" id="4691283">(</span><span class="op" id="4691284">*</span><span class="ident" id="4691285">big</span><span class="op" id="4691288">.</span><span class="ident" id="4691289">Int</span><span class="op" id="4691292">,</span>&nbsp;<span class="op" id="4691294">*</span><span class="ident" id="4691295">big</span><span class="op" id="4691298">.</span><span class="ident" id="4691299">Int</span><span class="op" id="4691302">)</span>&nbsp;<span class="op" id="4691304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691307">var</span>&nbsp;<span class="ident" id="4691311">zinv</span><span class="op" id="4691315">,</span>&nbsp;<span class="ident" id="4691317">zinvsq</span><span class="op" id="4691323">,</span>&nbsp;<span class="ident" id="4691325">outx</span><span class="op" id="4691329">,</span>&nbsp;<span class="ident" id="4691331">outy</span>&nbsp;<span class="ident" id="4691336">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691354">var</span>&nbsp;<span class="ident" id="4691358">tmp</span>&nbsp;<span class="ident" id="4691362">p224LargeFieldElement</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691386">if</span>&nbsp;<span class="ident" id="4691389">isPointAtInfinity</span>&nbsp;<span class="op" id="4691407">:=</span>&nbsp;<span class="ident" id="4691410">p224IsZero</span><span class="op" id="4691420">(</span><span class="ident" id="4691421">z</span><span class="op" id="4691422">)</span><span class="op" id="4691423">;</span>&nbsp;<span class="ident" id="4691425">isPointAtInfinity</span>&nbsp;<span class="op" id="4691443">==</span>&nbsp;<span class="num" id="4691446">1</span>&nbsp;<span class="op" id="4691448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691452">return</span>&nbsp;<span class="builtinfunc" id="4691459">new</span><span class="op" id="4691462">(</span><span class="ident" id="4691463">big</span><span class="op" id="4691466">.</span><span class="ident" id="4691467">Int</span><span class="op" id="4691470">)</span><span class="op" id="4691471">,</span>&nbsp;<span class="builtinfunc" id="4691473">new</span><span class="op" id="4691476">(</span><span class="ident" id="4691477">big</span><span class="op" id="4691480">.</span><span class="ident" id="4691481">Int</span><span class="op" id="4691484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4691487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691491">p224Invert</span><span class="op" id="4691501">(</span><span class="op" id="4691502">&amp;</span><span class="ident" id="4691503">zinv</span><span class="op" id="4691507">,</span>&nbsp;<span class="ident" id="4691509">z</span><span class="op" id="4691510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691513">p224Square</span><span class="op" id="4691523">(</span><span class="op" id="4691524">&amp;</span><span class="ident" id="4691525">zinvsq</span><span class="op" id="4691531">,</span>&nbsp;<span class="op" id="4691533">&amp;</span><span class="ident" id="4691534">zinv</span><span class="op" id="4691538">,</span>&nbsp;<span class="op" id="4691540">&amp;</span><span class="ident" id="4691541">tmp</span><span class="op" id="4691544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691547">p224Mul</span><span class="op" id="4691554">(</span><span class="ident" id="4691555">x</span><span class="op" id="4691556">,</span>&nbsp;<span class="ident" id="4691558">x</span><span class="op" id="4691559">,</span>&nbsp;<span class="op" id="4691561">&amp;</span><span class="ident" id="4691562">zinvsq</span><span class="op" id="4691568">,</span>&nbsp;<span class="op" id="4691570">&amp;</span><span class="ident" id="4691571">tmp</span><span class="op" id="4691574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691577">p224Mul</span><span class="op" id="4691584">(</span><span class="op" id="4691585">&amp;</span><span class="ident" id="4691586">zinvsq</span><span class="op" id="4691592">,</span>&nbsp;<span class="op" id="4691594">&amp;</span><span class="ident" id="4691595">zinvsq</span><span class="op" id="4691601">,</span>&nbsp;<span class="op" id="4691603">&amp;</span><span class="ident" id="4691604">zinv</span><span class="op" id="4691608">,</span>&nbsp;<span class="op" id="4691610">&amp;</span><span class="ident" id="4691611">tmp</span><span class="op" id="4691614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691617">p224Mul</span><span class="op" id="4691624">(</span><span class="ident" id="4691625">y</span><span class="op" id="4691626">,</span>&nbsp;<span class="ident" id="4691628">y</span><span class="op" id="4691629">,</span>&nbsp;<span class="op" id="4691631">&amp;</span><span class="ident" id="4691632">zinvsq</span><span class="op" id="4691638">,</span>&nbsp;<span class="op" id="4691640">&amp;</span><span class="ident" id="4691641">tmp</span><span class="op" id="4691644">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691648">p224Contract</span><span class="op" id="4691660">(</span><span class="op" id="4691661">&amp;</span><span class="ident" id="4691662">outx</span><span class="op" id="4691666">,</span>&nbsp;<span class="ident" id="4691668">x</span><span class="op" id="4691669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691672">p224Contract</span><span class="op" id="4691684">(</span><span class="op" id="4691685">&amp;</span><span class="ident" id="4691686">outy</span><span class="op" id="4691690">,</span>&nbsp;<span class="ident" id="4691692">y</span><span class="op" id="4691693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691696">return</span>&nbsp;<span class="ident" id="4691703">p224ToBig</span><span class="op" id="4691712">(</span><span class="op" id="4691713">&amp;</span><span class="ident" id="4691714">outx</span><span class="op" id="4691718">)</span><span class="op" id="4691719">,</span>&nbsp;<span class="ident" id="4691721">p224ToBig</span><span class="op" id="4691730">(</span><span class="op" id="4691731">&amp;</span><span class="ident" id="4691732">outy</span><span class="op" id="4691736">)</span><br>
<span class="lineno"></span><span class="op" id="4691738">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="4691741">//&nbsp;get28BitsFromEnd&nbsp;returns&nbsp;the&nbsp;least-significant&nbsp;28&nbsp;bits&nbsp;from&nbsp;buf&gt;&gt;shift,</span><br>
<span class="lineno"></span><span class="comment" id="4691816">//&nbsp;where&nbsp;buf&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4691868">func</span>&nbsp;<span class="ident" id="4691873">get28BitsFromEnd</span><span class="op" id="4691889">(</span><span class="ident" id="4691890">buf</span>&nbsp;<span class="op" id="4691894">[</span><span class="op" id="4691895">]</span><span class="builtintype" id="4691896">byte</span><span class="op" id="4691900">,</span>&nbsp;<span class="ident" id="4691902">shift</span>&nbsp;<span class="builtintype" id="4691908">uint</span><span class="op" id="4691912">)</span>&nbsp;<span class="op" id="4691914">(</span><span class="builtintype" id="4691915">uint32</span><span class="op" id="4691921">,</span>&nbsp;<span class="op" id="4691923">[</span><span class="op" id="4691924">]</span><span class="builtintype" id="4691925">byte</span><span class="op" id="4691929">)</span>&nbsp;<span class="op" id="4691931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691934">var</span>&nbsp;<span class="ident" id="4691938">ret</span>&nbsp;<span class="builtintype" id="4691942">uint32</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691951">for</span>&nbsp;<span class="ident" id="4691955">i</span>&nbsp;<span class="op" id="4691957">:=</span>&nbsp;<span class="builtintype" id="4691960">uint</span><span class="op" id="4691964">(</span><span class="num" id="4691965">0</span><span class="op" id="4691966">)</span><span class="op" id="4691967">;</span>&nbsp;<span class="ident" id="4691969">i</span>&nbsp;<span class="op" id="4691971">&lt;</span>&nbsp;<span class="num" id="4691973">4</span><span class="op" id="4691974">;</span>&nbsp;<span class="ident" id="4691976">i</span><span class="op" id="4691977">++</span>&nbsp;<span class="op" id="4691980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691984">var</span>&nbsp;<span class="ident" id="4691988">b</span>&nbsp;<span class="builtintype" id="4691990">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691997">if</span>&nbsp;<span class="ident" id="4692000">l</span>&nbsp;<span class="op" id="4692002">:=</span>&nbsp;<span class="builtinfunc" id="4692005">len</span><span class="op" id="4692008">(</span><span class="ident" id="4692009">buf</span><span class="op" id="4692012">)</span><span class="op" id="4692013">;</span>&nbsp;<span class="ident" id="4692015">l</span>&nbsp;<span class="op" id="4692017">&gt;</span>&nbsp;<span class="num" id="4692019">0</span>&nbsp;<span class="op" id="4692021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692026">b</span>&nbsp;<span class="op" id="4692028">=</span>&nbsp;<span class="ident" id="4692030">buf</span><span class="op" id="4692033">[</span><span class="ident" id="4692034">l</span><span class="op" id="4692035">-</span><span class="num" id="4692036">1</span><span class="op" id="4692037">]</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4692042">//&nbsp;We&nbsp;don&#39;t&nbsp;remove&nbsp;the&nbsp;byte&nbsp;if&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;return&nbsp;and&nbsp;we&#39;re&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4692112">//&nbsp;reading&nbsp;all&nbsp;of&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4692137">if</span>&nbsp;<span class="ident" id="4692140">i</span>&nbsp;<span class="op" id="4692142">!=</span>&nbsp;<span class="num" id="4692145">3</span>&nbsp;<span class="op" id="4692147">||</span>&nbsp;<span class="ident" id="4692150">shift</span>&nbsp;<span class="op" id="4692156">==</span>&nbsp;<span class="num" id="4692159">4</span>&nbsp;<span class="op" id="4692161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692167">buf</span>&nbsp;<span class="op" id="4692171">=</span>&nbsp;<span class="ident" id="4692173">buf</span><span class="op" id="4692176">[</span><span class="op" id="4692177">:</span><span class="ident" id="4692178">l</span><span class="op" id="4692179">-</span><span class="num" id="4692180">1</span><span class="op" id="4692181">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4692186">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4692190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692194">ret</span>&nbsp;<span class="op" id="4692198">|=</span>&nbsp;<span class="builtintype" id="4692201">uint32</span><span class="op" id="4692207">(</span><span class="ident" id="4692208">b</span><span class="op" id="4692209">)</span>&nbsp;<span class="op" id="4692211">&lt;&lt;</span>&nbsp;<span class="op" id="4692214">(</span><span class="num" id="4692215">8</span>&nbsp;<span class="op" id="4692217">*</span>&nbsp;<span class="ident" id="4692219">i</span><span class="op" id="4692220">)</span>&nbsp;<span class="op" id="4692222">&gt;&gt;</span>&nbsp;<span class="ident" id="4692225">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4692232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692235">ret</span>&nbsp;<span class="op" id="4692239">&amp;=</span>&nbsp;<span class="ident" id="4692242">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4692256">return</span>&nbsp;<span class="ident" id="4692263">ret</span><span class="op" id="4692266">,</span>&nbsp;<span class="ident" id="4692268">buf</span><br>
<span class="lineno">710</span><span class="op" id="4692272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4692275">//&nbsp;p224FromBig&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in.</span><br>
<span class="lineno"></span><span class="keyword" id="4692307">func</span>&nbsp;<span class="ident" id="4692312">p224FromBig</span><span class="op" id="4692323">(</span><span class="ident" id="4692324">out</span>&nbsp;<span class="op" id="4692328">*</span><span class="ident" id="4692329">p224FieldElement</span><span class="op" id="4692345">,</span>&nbsp;<span class="ident" id="4692347">in</span>&nbsp;<span class="op" id="4692350">*</span><span class="ident" id="4692351">big</span><span class="op" id="4692354">.</span><span class="ident" id="4692355">Int</span><span class="op" id="4692358">)</span>&nbsp;<span class="op" id="4692360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692363">bytes</span>&nbsp;<span class="op" id="4692369">:=</span>&nbsp;<span class="ident" id="4692372">in</span><span class="op" id="4692374">.</span><span class="ident" id="4692375">Bytes</span><span class="op" id="4692380">(</span><span class="op" id="4692381">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692384">out</span><span class="op" id="4692387">[</span><span class="num" id="4692388">0</span><span class="op" id="4692389">]</span><span class="op" id="4692390">,</span>&nbsp;<span class="ident" id="4692392">bytes</span>&nbsp;<span class="op" id="4692398">=</span>&nbsp;<span class="ident" id="4692400">get28BitsFromEnd</span><span class="op" id="4692416">(</span><span class="ident" id="4692417">bytes</span><span class="op" id="4692422">,</span>&nbsp;<span class="num" id="4692424">0</span><span class="op" id="4692425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692428">out</span><span class="op" id="4692431">[</span><span class="num" id="4692432">1</span><span class="op" id="4692433">]</span><span class="op" id="4692434">,</span>&nbsp;<span class="ident" id="4692436">bytes</span>&nbsp;<span class="op" id="4692442">=</span>&nbsp;<span class="ident" id="4692444">get28BitsFromEnd</span><span class="op" id="4692460">(</span><span class="ident" id="4692461">bytes</span><span class="op" id="4692466">,</span>&nbsp;<span class="num" id="4692468">4</span><span class="op" id="4692469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692472">out</span><span class="op" id="4692475">[</span><span class="num" id="4692476">2</span><span class="op" id="4692477">]</span><span class="op" id="4692478">,</span>&nbsp;<span class="ident" id="4692480">bytes</span>&nbsp;<span class="op" id="4692486">=</span>&nbsp;<span class="ident" id="4692488">get28BitsFromEnd</span><span class="op" id="4692504">(</span><span class="ident" id="4692505">bytes</span><span class="op" id="4692510">,</span>&nbsp;<span class="num" id="4692512">0</span><span class="op" id="4692513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692516">out</span><span class="op" id="4692519">[</span><span class="num" id="4692520">3</span><span class="op" id="4692521">]</span><span class="op" id="4692522">,</span>&nbsp;<span class="ident" id="4692524">bytes</span>&nbsp;<span class="op" id="4692530">=</span>&nbsp;<span class="ident" id="4692532">get28BitsFromEnd</span><span class="op" id="4692548">(</span><span class="ident" id="4692549">bytes</span><span class="op" id="4692554">,</span>&nbsp;<span class="num" id="4692556">4</span><span class="op" id="4692557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692560">out</span><span class="op" id="4692563">[</span><span class="num" id="4692564">4</span><span class="op" id="4692565">]</span><span class="op" id="4692566">,</span>&nbsp;<span class="ident" id="4692568">bytes</span>&nbsp;<span class="op" id="4692574">=</span>&nbsp;<span class="ident" id="4692576">get28BitsFromEnd</span><span class="op" id="4692592">(</span><span class="ident" id="4692593">bytes</span><span class="op" id="4692598">,</span>&nbsp;<span class="num" id="4692600">0</span><span class="op" id="4692601">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692604">out</span><span class="op" id="4692607">[</span><span class="num" id="4692608">5</span><span class="op" id="4692609">]</span><span class="op" id="4692610">,</span>&nbsp;<span class="ident" id="4692612">bytes</span>&nbsp;<span class="op" id="4692618">=</span>&nbsp;<span class="ident" id="4692620">get28BitsFromEnd</span><span class="op" id="4692636">(</span><span class="ident" id="4692637">bytes</span><span class="op" id="4692642">,</span>&nbsp;<span class="num" id="4692644">4</span><span class="op" id="4692645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692648">out</span><span class="op" id="4692651">[</span><span class="num" id="4692652">6</span><span class="op" id="4692653">]</span><span class="op" id="4692654">,</span>&nbsp;<span class="ident" id="4692656">bytes</span>&nbsp;<span class="op" id="4692662">=</span>&nbsp;<span class="ident" id="4692664">get28BitsFromEnd</span><span class="op" id="4692680">(</span><span class="ident" id="4692681">bytes</span><span class="op" id="4692686">,</span>&nbsp;<span class="num" id="4692688">0</span><span class="op" id="4692689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692692">out</span><span class="op" id="4692695">[</span><span class="num" id="4692696">7</span><span class="op" id="4692697">]</span><span class="op" id="4692698">,</span>&nbsp;<span class="ident" id="4692700">bytes</span>&nbsp;<span class="op" id="4692706">=</span>&nbsp;<span class="ident" id="4692708">get28BitsFromEnd</span><span class="op" id="4692724">(</span><span class="ident" id="4692725">bytes</span><span class="op" id="4692730">,</span>&nbsp;<span class="num" id="4692732">4</span><span class="op" id="4692733">)</span><br>
<span class="lineno"></span><span class="op" id="4692735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="comment" id="4692738">//&nbsp;p224ToBig&nbsp;returns&nbsp;in&nbsp;as&nbsp;a&nbsp;big.Int.</span><br>
<span class="lineno"></span><span class="keyword" id="4692776">func</span>&nbsp;<span class="ident" id="4692781">p224ToBig</span><span class="op" id="4692790">(</span><span class="ident" id="4692791">in</span>&nbsp;<span class="op" id="4692794">*</span><span class="ident" id="4692795">p224FieldElement</span><span class="op" id="4692811">)</span>&nbsp;<span class="op" id="4692813">*</span><span class="ident" id="4692814">big</span><span class="op" id="4692817">.</span><span class="ident" id="4692818">Int</span>&nbsp;<span class="op" id="4692822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4692825">var</span>&nbsp;<span class="ident" id="4692829">buf</span>&nbsp;<span class="op" id="4692833">[</span><span class="num" id="4692834">28</span><span class="op" id="4692836">]</span><span class="builtintype" id="4692837">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692843">buf</span><span class="op" id="4692846">[</span><span class="num" id="4692847">27</span><span class="op" id="4692849">]</span>&nbsp;<span class="op" id="4692851">=</span>&nbsp;<span class="builtintype" id="4692853">byte</span><span class="op" id="4692857">(</span><span class="ident" id="4692858">in</span><span class="op" id="4692860">[</span><span class="num" id="4692861">0</span><span class="op" id="4692862">]</span><span class="op" id="4692863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692866">buf</span><span class="op" id="4692869">[</span><span class="num" id="4692870">26</span><span class="op" id="4692872">]</span>&nbsp;<span class="op" id="4692874">=</span>&nbsp;<span class="builtintype" id="4692876">byte</span><span class="op" id="4692880">(</span><span class="ident" id="4692881">in</span><span class="op" id="4692883">[</span><span class="num" id="4692884">0</span><span class="op" id="4692885">]</span>&nbsp;<span class="op" id="4692887">&gt;&gt;</span>&nbsp;<span class="num" id="4692890">8</span><span class="op" id="4692891">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692894">buf</span><span class="op" id="4692897">[</span><span class="num" id="4692898">25</span><span class="op" id="4692900">]</span>&nbsp;<span class="op" id="4692902">=</span>&nbsp;<span class="builtintype" id="4692904">byte</span><span class="op" id="4692908">(</span><span class="ident" id="4692909">in</span><span class="op" id="4692911">[</span><span class="num" id="4692912">0</span><span class="op" id="4692913">]</span>&nbsp;<span class="op" id="4692915">&gt;&gt;</span>&nbsp;<span class="num" id="4692918">16</span><span class="op" id="4692920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692923">buf</span><span class="op" id="4692926">[</span><span class="num" id="4692927">24</span><span class="op" id="4692929">]</span>&nbsp;<span class="op" id="4692931">=</span>&nbsp;<span class="builtintype" id="4692933">byte</span><span class="op" id="4692937">(</span><span class="op" id="4692938">(</span><span class="op" id="4692939">(</span><span class="ident" id="4692940">in</span><span class="op" id="4692942">[</span><span class="num" id="4692943">0</span><span class="op" id="4692944">]</span>&nbsp;<span class="op" id="4692946">&gt;&gt;</span>&nbsp;<span class="num" id="4692949">24</span><span class="op" id="4692951">)</span>&nbsp;<span class="op" id="4692953">&amp;</span>&nbsp;<span class="num" id="4692955">0x0f</span><span class="op" id="4692959">)</span>&nbsp;<span class="op" id="4692961">|</span>&nbsp;<span class="op" id="4692963">(</span><span class="ident" id="4692964">in</span><span class="op" id="4692966">[</span><span class="num" id="4692967">1</span><span class="op" id="4692968">]</span><span class="op" id="4692969">&lt;&lt;</span><span class="num" id="4692971">4</span><span class="op" id="4692972">)</span><span class="op" id="4692973">&amp;</span><span class="num" id="4692974">0xf0</span><span class="op" id="4692978">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692982">buf</span><span class="op" id="4692985">[</span><span class="num" id="4692986">23</span><span class="op" id="4692988">]</span>&nbsp;<span class="op" id="4692990">=</span>&nbsp;<span class="builtintype" id="4692992">byte</span><span class="op" id="4692996">(</span><span class="ident" id="4692997">in</span><span class="op" id="4692999">[</span><span class="num" id="4693000">1</span><span class="op" id="4693001">]</span>&nbsp;<span class="op" id="4693003">&gt;&gt;</span>&nbsp;<span class="num" id="4693006">4</span><span class="op" id="4693007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693010">buf</span><span class="op" id="4693013">[</span><span class="num" id="4693014">22</span><span class="op" id="4693016">]</span>&nbsp;<span class="op" id="4693018">=</span>&nbsp;<span class="builtintype" id="4693020">byte</span><span class="op" id="4693024">(</span><span class="ident" id="4693025">in</span><span class="op" id="4693027">[</span><span class="num" id="4693028">1</span><span class="op" id="4693029">]</span>&nbsp;<span class="op" id="4693031">&gt;&gt;</span>&nbsp;<span class="num" id="4693034">12</span><span class="op" id="4693036">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693039">buf</span><span class="op" id="4693042">[</span><span class="num" id="4693043">21</span><span class="op" id="4693045">]</span>&nbsp;<span class="op" id="4693047">=</span>&nbsp;<span class="builtintype" id="4693049">byte</span><span class="op" id="4693053">(</span><span class="ident" id="4693054">in</span><span class="op" id="4693056">[</span><span class="num" id="4693057">1</span><span class="op" id="4693058">]</span>&nbsp;<span class="op" id="4693060">&gt;&gt;</span>&nbsp;<span class="num" id="4693063">20</span><span class="op" id="4693065">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693069">buf</span><span class="op" id="4693072">[</span><span class="num" id="4693073">20</span><span class="op" id="4693075">]</span>&nbsp;<span class="op" id="4693077">=</span>&nbsp;<span class="builtintype" id="4693079">byte</span><span class="op" id="4693083">(</span><span class="ident" id="4693084">in</span><span class="op" id="4693086">[</span><span class="num" id="4693087">2</span><span class="op" id="4693088">]</span><span class="op" id="4693089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693092">buf</span><span class="op" id="4693095">[</span><span class="num" id="4693096">19</span><span class="op" id="4693098">]</span>&nbsp;<span class="op" id="4693100">=</span>&nbsp;<span class="builtintype" id="4693102">byte</span><span class="op" id="4693106">(</span><span class="ident" id="4693107">in</span><span class="op" id="4693109">[</span><span class="num" id="4693110">2</span><span class="op" id="4693111">]</span>&nbsp;<span class="op" id="4693113">&gt;&gt;</span>&nbsp;<span class="num" id="4693116">8</span><span class="op" id="4693117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693120">buf</span><span class="op" id="4693123">[</span><span class="num" id="4693124">18</span><span class="op" id="4693126">]</span>&nbsp;<span class="op" id="4693128">=</span>&nbsp;<span class="builtintype" id="4693130">byte</span><span class="op" id="4693134">(</span><span class="ident" id="4693135">in</span><span class="op" id="4693137">[</span><span class="num" id="4693138">2</span><span class="op" id="4693139">]</span>&nbsp;<span class="op" id="4693141">&gt;&gt;</span>&nbsp;<span class="num" id="4693144">16</span><span class="op" id="4693146">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693149">buf</span><span class="op" id="4693152">[</span><span class="num" id="4693153">17</span><span class="op" id="4693155">]</span>&nbsp;<span class="op" id="4693157">=</span>&nbsp;<span class="builtintype" id="4693159">byte</span><span class="op" id="4693163">(</span><span class="op" id="4693164">(</span><span class="op" id="4693165">(</span><span class="ident" id="4693166">in</span><span class="op" id="4693168">[</span><span class="num" id="4693169">2</span><span class="op" id="4693170">]</span>&nbsp;<span class="op" id="4693172">&gt;&gt;</span>&nbsp;<span class="num" id="4693175">24</span><span class="op" id="4693177">)</span>&nbsp;<span class="op" id="4693179">&amp;</span>&nbsp;<span class="num" id="4693181">0x0f</span><span class="op" id="4693185">)</span>&nbsp;<span class="op" id="4693187">|</span>&nbsp;<span class="op" id="4693189">(</span><span class="ident" id="4693190">in</span><span class="op" id="4693192">[</span><span class="num" id="4693193">3</span><span class="op" id="4693194">]</span><span class="op" id="4693195">&lt;&lt;</span><span class="num" id="4693197">4</span><span class="op" id="4693198">)</span><span class="op" id="4693199">&amp;</span><span class="num" id="4693200">0xf0</span><span class="op" id="4693204">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693208">buf</span><span class="op" id="4693211">[</span><span class="num" id="4693212">16</span><span class="op" id="4693214">]</span>&nbsp;<span class="op" id="4693216">=</span>&nbsp;<span class="builtintype" id="4693218">byte</span><span class="op" id="4693222">(</span><span class="ident" id="4693223">in</span><span class="op" id="4693225">[</span><span class="num" id="4693226">3</span><span class="op" id="4693227">]</span>&nbsp;<span class="op" id="4693229">&gt;&gt;</span>&nbsp;<span class="num" id="4693232">4</span><span class="op" id="4693233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693236">buf</span><span class="op" id="4693239">[</span><span class="num" id="4693240">15</span><span class="op" id="4693242">]</span>&nbsp;<span class="op" id="4693244">=</span>&nbsp;<span class="builtintype" id="4693246">byte</span><span class="op" id="4693250">(</span><span class="ident" id="4693251">in</span><span class="op" id="4693253">[</span><span class="num" id="4693254">3</span><span class="op" id="4693255">]</span>&nbsp;<span class="op" id="4693257">&gt;&gt;</span>&nbsp;<span class="num" id="4693260">12</span><span class="op" id="4693262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693265">buf</span><span class="op" id="4693268">[</span><span class="num" id="4693269">14</span><span class="op" id="4693271">]</span>&nbsp;<span class="op" id="4693273">=</span>&nbsp;<span class="builtintype" id="4693275">byte</span><span class="op" id="4693279">(</span><span class="ident" id="4693280">in</span><span class="op" id="4693282">[</span><span class="num" id="4693283">3</span><span class="op" id="4693284">]</span>&nbsp;<span class="op" id="4693286">&gt;&gt;</span>&nbsp;<span class="num" id="4693289">20</span><span class="op" id="4693291">)</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693295">buf</span><span class="op" id="4693298">[</span><span class="num" id="4693299">13</span><span class="op" id="4693301">]</span>&nbsp;<span class="op" id="4693303">=</span>&nbsp;<span class="builtintype" id="4693305">byte</span><span class="op" id="4693309">(</span><span class="ident" id="4693310">in</span><span class="op" id="4693312">[</span><span class="num" id="4693313">4</span><span class="op" id="4693314">]</span><span class="op" id="4693315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693318">buf</span><span class="op" id="4693321">[</span><span class="num" id="4693322">12</span><span class="op" id="4693324">]</span>&nbsp;<span class="op" id="4693326">=</span>&nbsp;<span class="builtintype" id="4693328">byte</span><span class="op" id="4693332">(</span><span class="ident" id="4693333">in</span><span class="op" id="4693335">[</span><span class="num" id="4693336">4</span><span class="op" id="4693337">]</span>&nbsp;<span class="op" id="4693339">&gt;&gt;</span>&nbsp;<span class="num" id="4693342">8</span><span class="op" id="4693343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693346">buf</span><span class="op" id="4693349">[</span><span class="num" id="4693350">11</span><span class="op" id="4693352">]</span>&nbsp;<span class="op" id="4693354">=</span>&nbsp;<span class="builtintype" id="4693356">byte</span><span class="op" id="4693360">(</span><span class="ident" id="4693361">in</span><span class="op" id="4693363">[</span><span class="num" id="4693364">4</span><span class="op" id="4693365">]</span>&nbsp;<span class="op" id="4693367">&gt;&gt;</span>&nbsp;<span class="num" id="4693370">16</span><span class="op" id="4693372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693375">buf</span><span class="op" id="4693378">[</span><span class="num" id="4693379">10</span><span class="op" id="4693381">]</span>&nbsp;<span class="op" id="4693383">=</span>&nbsp;<span class="builtintype" id="4693385">byte</span><span class="op" id="4693389">(</span><span class="op" id="4693390">(</span><span class="op" id="4693391">(</span><span class="ident" id="4693392">in</span><span class="op" id="4693394">[</span><span class="num" id="4693395">4</span><span class="op" id="4693396">]</span>&nbsp;<span class="op" id="4693398">&gt;&gt;</span>&nbsp;<span class="num" id="4693401">24</span><span class="op" id="4693403">)</span>&nbsp;<span class="op" id="4693405">&amp;</span>&nbsp;<span class="num" id="4693407">0x0f</span><span class="op" id="4693411">)</span>&nbsp;<span class="op" id="4693413">|</span>&nbsp;<span class="op" id="4693415">(</span><span class="ident" id="4693416">in</span><span class="op" id="4693418">[</span><span class="num" id="4693419">5</span><span class="op" id="4693420">]</span><span class="op" id="4693421">&lt;&lt;</span><span class="num" id="4693423">4</span><span class="op" id="4693424">)</span><span class="op" id="4693425">&amp;</span><span class="num" id="4693426">0xf0</span><span class="op" id="4693430">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693434">buf</span><span class="op" id="4693437">[</span><span class="num" id="4693438">9</span><span class="op" id="4693439">]</span>&nbsp;<span class="op" id="4693441">=</span>&nbsp;<span class="builtintype" id="4693443">byte</span><span class="op" id="4693447">(</span><span class="ident" id="4693448">in</span><span class="op" id="4693450">[</span><span class="num" id="4693451">5</span><span class="op" id="4693452">]</span>&nbsp;<span class="op" id="4693454">&gt;&gt;</span>&nbsp;<span class="num" id="4693457">4</span><span class="op" id="4693458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693461">buf</span><span class="op" id="4693464">[</span><span class="num" id="4693465">8</span><span class="op" id="4693466">]</span>&nbsp;<span class="op" id="4693468">=</span>&nbsp;<span class="builtintype" id="4693470">byte</span><span class="op" id="4693474">(</span><span class="ident" id="4693475">in</span><span class="op" id="4693477">[</span><span class="num" id="4693478">5</span><span class="op" id="4693479">]</span>&nbsp;<span class="op" id="4693481">&gt;&gt;</span>&nbsp;<span class="num" id="4693484">12</span><span class="op" id="4693486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693489">buf</span><span class="op" id="4693492">[</span><span class="num" id="4693493">7</span><span class="op" id="4693494">]</span>&nbsp;<span class="op" id="4693496">=</span>&nbsp;<span class="builtintype" id="4693498">byte</span><span class="op" id="4693502">(</span><span class="ident" id="4693503">in</span><span class="op" id="4693505">[</span><span class="num" id="4693506">5</span><span class="op" id="4693507">]</span>&nbsp;<span class="op" id="4693509">&gt;&gt;</span>&nbsp;<span class="num" id="4693512">20</span><span class="op" id="4693514">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693518">buf</span><span class="op" id="4693521">[</span><span class="num" id="4693522">6</span><span class="op" id="4693523">]</span>&nbsp;<span class="op" id="4693525">=</span>&nbsp;<span class="builtintype" id="4693527">byte</span><span class="op" id="4693531">(</span><span class="ident" id="4693532">in</span><span class="op" id="4693534">[</span><span class="num" id="4693535">6</span><span class="op" id="4693536">]</span><span class="op" id="4693537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693540">buf</span><span class="op" id="4693543">[</span><span class="num" id="4693544">5</span><span class="op" id="4693545">]</span>&nbsp;<span class="op" id="4693547">=</span>&nbsp;<span class="builtintype" id="4693549">byte</span><span class="op" id="4693553">(</span><span class="ident" id="4693554">in</span><span class="op" id="4693556">[</span><span class="num" id="4693557">6</span><span class="op" id="4693558">]</span>&nbsp;<span class="op" id="4693560">&gt;&gt;</span>&nbsp;<span class="num" id="4693563">8</span><span class="op" id="4693564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693567">buf</span><span class="op" id="4693570">[</span><span class="num" id="4693571">4</span><span class="op" id="4693572">]</span>&nbsp;<span class="op" id="4693574">=</span>&nbsp;<span class="builtintype" id="4693576">byte</span><span class="op" id="4693580">(</span><span class="ident" id="4693581">in</span><span class="op" id="4693583">[</span><span class="num" id="4693584">6</span><span class="op" id="4693585">]</span>&nbsp;<span class="op" id="4693587">&gt;&gt;</span>&nbsp;<span class="num" id="4693590">16</span><span class="op" id="4693592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693595">buf</span><span class="op" id="4693598">[</span><span class="num" id="4693599">3</span><span class="op" id="4693600">]</span>&nbsp;<span class="op" id="4693602">=</span>&nbsp;<span class="builtintype" id="4693604">byte</span><span class="op" id="4693608">(</span><span class="op" id="4693609">(</span><span class="op" id="4693610">(</span><span class="ident" id="4693611">in</span><span class="op" id="4693613">[</span><span class="num" id="4693614">6</span><span class="op" id="4693615">]</span>&nbsp;<span class="op" id="4693617">&gt;&gt;</span>&nbsp;<span class="num" id="4693620">24</span><span class="op" id="4693622">)</span>&nbsp;<span class="op" id="4693624">&amp;</span>&nbsp;<span class="num" id="4693626">0x0f</span><span class="op" id="4693630">)</span>&nbsp;<span class="op" id="4693632">|</span>&nbsp;<span class="op" id="4693634">(</span><span class="ident" id="4693635">in</span><span class="op" id="4693637">[</span><span class="num" id="4693638">7</span><span class="op" id="4693639">]</span><span class="op" id="4693640">&lt;&lt;</span><span class="num" id="4693642">4</span><span class="op" id="4693643">)</span><span class="op" id="4693644">&amp;</span><span class="num" id="4693645">0xf0</span><span class="op" id="4693649">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693653">buf</span><span class="op" id="4693656">[</span><span class="num" id="4693657">2</span><span class="op" id="4693658">]</span>&nbsp;<span class="op" id="4693660">=</span>&nbsp;<span class="builtintype" id="4693662">byte</span><span class="op" id="4693666">(</span><span class="ident" id="4693667">in</span><span class="op" id="4693669">[</span><span class="num" id="4693670">7</span><span class="op" id="4693671">]</span>&nbsp;<span class="op" id="4693673">&gt;&gt;</span>&nbsp;<span class="num" id="4693676">4</span><span class="op" id="4693677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693680">buf</span><span class="op" id="4693683">[</span><span class="num" id="4693684">1</span><span class="op" id="4693685">]</span>&nbsp;<span class="op" id="4693687">=</span>&nbsp;<span class="builtintype" id="4693689">byte</span><span class="op" id="4693693">(</span><span class="ident" id="4693694">in</span><span class="op" id="4693696">[</span><span class="num" id="4693697">7</span><span class="op" id="4693698">]</span>&nbsp;<span class="op" id="4693700">&gt;&gt;</span>&nbsp;<span class="num" id="4693703">12</span><span class="op" id="4693705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693708">buf</span><span class="op" id="4693711">[</span><span class="num" id="4693712">0</span><span class="op" id="4693713">]</span>&nbsp;<span class="op" id="4693715">=</span>&nbsp;<span class="builtintype" id="4693717">byte</span><span class="op" id="4693721">(</span><span class="ident" id="4693722">in</span><span class="op" id="4693724">[</span><span class="num" id="4693725">7</span><span class="op" id="4693726">]</span>&nbsp;<span class="op" id="4693728">&gt;&gt;</span>&nbsp;<span class="num" id="4693731">20</span><span class="op" id="4693733">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4693737">return</span>&nbsp;<span class="builtinfunc" id="4693744">new</span><span class="op" id="4693747">(</span><span class="ident" id="4693748">big</span><span class="op" id="4693751">.</span><span class="ident" id="4693752">Int</span><span class="op" id="4693755">)</span><span class="op" id="4693756">.</span><span class="ident" id="4693757">SetBytes</span><span class="op" id="4693765">(</span><span class="ident" id="4693766">buf</span><span class="op" id="4693769">[</span><span class="op" id="4693770">:</span><span class="op" id="4693771">]</span><span class="op" id="4693772">)</span><br>
<span class="lineno">765</span><span class="op" id="4693774">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
