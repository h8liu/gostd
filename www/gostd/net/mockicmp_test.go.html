<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html" class="current">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6712829">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6712885">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6712939">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6712990">package</span>&nbsp;<span class="ident" id="6712998">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6713003">import</span>&nbsp;<span class="string" id="6713010">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6713020">const</span>&nbsp;<span class="op" id="6713026">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713029">icmpv4EchoRequest</span>&nbsp;<span class="op" id="6713047">=</span>&nbsp;<span class="num" id="6713049">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713052">icmpv4EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6713070">=</span>&nbsp;<span class="num" id="6713072">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713075">icmpv6EchoRequest</span>&nbsp;<span class="op" id="6713093">=</span>&nbsp;<span class="num" id="6713095">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713100">icmpv6EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6713118">=</span>&nbsp;<span class="num" id="6713120">129</span><br>
<span class="lineno"></span><span class="op" id="6713124">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6713127">//&nbsp;icmpMessage&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6713170">type</span>&nbsp;<span class="ident" id="6713175">icmpMessage</span>&nbsp;<span class="keyword" id="6713187">struct</span>&nbsp;<span class="op" id="6713194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713197">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6713206">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6713222">//&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713231">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6713240">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6713256">//&nbsp;code</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713265">Checksum</span>&nbsp;<span class="builtintype" id="6713274">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6713290">//&nbsp;checksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713303">Body</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713312">icmpMessageBody</span>&nbsp;<span class="comment" id="6713328">//&nbsp;body</span><br>
<span class="lineno"></span><span class="op" id="6713336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6713339">//&nbsp;icmpMessageBody&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message&nbsp;body.</span><br>
<span class="lineno">25</span><span class="keyword" id="6713391">type</span>&nbsp;<span class="ident" id="6713396">icmpMessageBody</span>&nbsp;<span class="keyword" id="6713412">interface</span>&nbsp;<span class="op" id="6713422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713425">Len</span><span class="op" id="6713428">(</span><span class="op" id="6713429">)</span>&nbsp;<span class="builtintype" id="6713431">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713436">Marshal</span><span class="op" id="6713443">(</span><span class="op" id="6713444">)</span>&nbsp;<span class="op" id="6713446">(</span><span class="op" id="6713447">[</span><span class="op" id="6713448">]</span><span class="builtintype" id="6713449">byte</span><span class="op" id="6713453">,</span>&nbsp;<span class="builtintype" id="6713455">error</span><span class="op" id="6713460">)</span><br>
<span class="lineno"></span><span class="op" id="6713462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="6713465">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6713533">//&nbsp;reply&nbsp;message&nbsp;m.</span><br>
<span class="lineno"></span><span class="keyword" id="6713553">func</span>&nbsp;<span class="op" id="6713558">(</span><span class="ident" id="6713559">m</span>&nbsp;<span class="op" id="6713561">*</span><span class="ident" id="6713562">icmpMessage</span><span class="op" id="6713573">)</span>&nbsp;<span class="ident" id="6713575">Marshal</span><span class="op" id="6713582">(</span><span class="op" id="6713583">)</span>&nbsp;<span class="op" id="6713585">(</span><span class="op" id="6713586">[</span><span class="op" id="6713587">]</span><span class="builtintype" id="6713588">byte</span><span class="op" id="6713592">,</span>&nbsp;<span class="builtintype" id="6713594">error</span><span class="op" id="6713599">)</span>&nbsp;<span class="op" id="6713601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713604">b</span>&nbsp;<span class="op" id="6713606">:=</span>&nbsp;<span class="op" id="6713609">[</span><span class="op" id="6713610">]</span><span class="builtintype" id="6713611">byte</span><span class="op" id="6713615">{</span><span class="builtintype" id="6713616">byte</span><span class="op" id="6713620">(</span><span class="ident" id="6713621">m</span><span class="op" id="6713622">.</span><span class="ident" id="6713623">Type</span><span class="op" id="6713627">)</span><span class="op" id="6713628">,</span>&nbsp;<span class="builtintype" id="6713630">byte</span><span class="op" id="6713634">(</span><span class="ident" id="6713635">m</span><span class="op" id="6713636">.</span><span class="ident" id="6713637">Code</span><span class="op" id="6713641">)</span><span class="op" id="6713642">,</span>&nbsp;<span class="num" id="6713644">0</span><span class="op" id="6713645">,</span>&nbsp;<span class="num" id="6713647">0</span><span class="op" id="6713648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713651">if</span>&nbsp;<span class="ident" id="6713654">m</span><span class="op" id="6713655">.</span><span class="ident" id="6713656">Body</span>&nbsp;<span class="op" id="6713661">!=</span>&nbsp;<span class="builtintype" id="6713664">nil</span>&nbsp;<span class="op" id="6713668">&amp;&amp;</span>&nbsp;<span class="ident" id="6713671">m</span><span class="op" id="6713672">.</span><span class="ident" id="6713673">Body</span><span class="op" id="6713677">.</span><span class="ident" id="6713678">Len</span><span class="op" id="6713681">(</span><span class="op" id="6713682">)</span>&nbsp;<span class="op" id="6713684">!=</span>&nbsp;<span class="num" id="6713687">0</span>&nbsp;<span class="op" id="6713689">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713693">mb</span><span class="op" id="6713695">,</span>&nbsp;<span class="ident" id="6713697">err</span>&nbsp;<span class="op" id="6713701">:=</span>&nbsp;<span class="ident" id="6713704">m</span><span class="op" id="6713705">.</span><span class="ident" id="6713706">Body</span><span class="op" id="6713710">.</span><span class="ident" id="6713711">Marshal</span><span class="op" id="6713718">(</span><span class="op" id="6713719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713723">if</span>&nbsp;<span class="ident" id="6713726">err</span>&nbsp;<span class="op" id="6713730">!=</span>&nbsp;<span class="builtintype" id="6713733">nil</span>&nbsp;<span class="op" id="6713737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713742">return</span>&nbsp;<span class="builtintype" id="6713749">nil</span><span class="op" id="6713752">,</span>&nbsp;<span class="ident" id="6713754">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713764">b</span>&nbsp;<span class="op" id="6713766">=</span>&nbsp;<span class="builtinfunc" id="6713768">append</span><span class="op" id="6713774">(</span><span class="ident" id="6713775">b</span><span class="op" id="6713776">,</span>&nbsp;<span class="ident" id="6713778">mb</span><span class="op" id="6713780">...</span><span class="op" id="6713783">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713789">switch</span>&nbsp;<span class="ident" id="6713796">m</span><span class="op" id="6713797">.</span><span class="ident" id="6713798">Type</span>&nbsp;<span class="op" id="6713803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713806">case</span>&nbsp;<span class="ident" id="6713811">icmpv6EchoRequest</span><span class="op" id="6713828">,</span>&nbsp;<span class="ident" id="6713830">icmpv6EchoReply</span><span class="op" id="6713845">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713849">return</span>&nbsp;<span class="ident" id="6713856">b</span><span class="op" id="6713857">,</span>&nbsp;<span class="builtintype" id="6713859">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713864">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713867">csumcv</span>&nbsp;<span class="op" id="6713874">:=</span>&nbsp;<span class="builtinfunc" id="6713877">len</span><span class="op" id="6713880">(</span><span class="ident" id="6713881">b</span><span class="op" id="6713882">)</span>&nbsp;<span class="op" id="6713884">-</span>&nbsp;<span class="num" id="6713886">1</span>&nbsp;<span class="comment" id="6713888">//&nbsp;checksum&nbsp;coverage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713910">s</span>&nbsp;<span class="op" id="6713912">:=</span>&nbsp;<span class="builtintype" id="6713915">uint32</span><span class="op" id="6713921">(</span><span class="num" id="6713922">0</span><span class="op" id="6713923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713926">for</span>&nbsp;<span class="ident" id="6713930">i</span>&nbsp;<span class="op" id="6713932">:=</span>&nbsp;<span class="num" id="6713935">0</span><span class="op" id="6713936">;</span>&nbsp;<span class="ident" id="6713938">i</span>&nbsp;<span class="op" id="6713940">&lt;</span>&nbsp;<span class="ident" id="6713942">csumcv</span><span class="op" id="6713948">;</span>&nbsp;<span class="ident" id="6713950">i</span>&nbsp;<span class="op" id="6713952">+=</span>&nbsp;<span class="num" id="6713955">2</span>&nbsp;<span class="op" id="6713957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713961">s</span>&nbsp;<span class="op" id="6713963">+=</span>&nbsp;<span class="builtintype" id="6713966">uint32</span><span class="op" id="6713972">(</span><span class="ident" id="6713973">b</span><span class="op" id="6713974">[</span><span class="ident" id="6713975">i</span><span class="op" id="6713976">+</span><span class="num" id="6713977">1</span><span class="op" id="6713978">]</span><span class="op" id="6713979">)</span><span class="op" id="6713980">&lt;&lt;</span><span class="num" id="6713982">8</span>&nbsp;<span class="op" id="6713984">|</span>&nbsp;<span class="builtintype" id="6713986">uint32</span><span class="op" id="6713992">(</span><span class="ident" id="6713993">b</span><span class="op" id="6713994">[</span><span class="ident" id="6713995">i</span><span class="op" id="6713996">]</span><span class="op" id="6713997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714000">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714003">if</span>&nbsp;<span class="ident" id="6714006">csumcv</span><span class="op" id="6714012">&amp;</span><span class="num" id="6714013">1</span>&nbsp;<span class="op" id="6714015">==</span>&nbsp;<span class="num" id="6714018">0</span>&nbsp;<span class="op" id="6714020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714024">s</span>&nbsp;<span class="op" id="6714026">+=</span>&nbsp;<span class="builtintype" id="6714029">uint32</span><span class="op" id="6714035">(</span><span class="ident" id="6714036">b</span><span class="op" id="6714037">[</span><span class="ident" id="6714038">csumcv</span><span class="op" id="6714044">]</span><span class="op" id="6714045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714051">s</span>&nbsp;<span class="op" id="6714053">=</span>&nbsp;<span class="ident" id="6714055">s</span><span class="op" id="6714056">&gt;&gt;</span><span class="num" id="6714058">16</span>&nbsp;<span class="op" id="6714061">+</span>&nbsp;<span class="ident" id="6714063">s</span><span class="op" id="6714064">&amp;</span><span class="num" id="6714065">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714073">s</span>&nbsp;<span class="op" id="6714075">=</span>&nbsp;<span class="ident" id="6714077">s</span>&nbsp;<span class="op" id="6714079">+</span>&nbsp;<span class="ident" id="6714081">s</span><span class="op" id="6714082">&gt;&gt;</span><span class="num" id="6714084">16</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6714088">//&nbsp;Place&nbsp;checksum&nbsp;back&nbsp;in&nbsp;header;&nbsp;using&nbsp;^=&nbsp;avoids&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6714143">//&nbsp;assumption&nbsp;the&nbsp;checksum&nbsp;bytes&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714187">b</span><span class="op" id="6714188">[</span><span class="num" id="6714189">2</span><span class="op" id="6714190">]</span>&nbsp;<span class="op" id="6714192">^=</span>&nbsp;<span class="builtintype" id="6714195">byte</span><span class="op" id="6714199">(</span><span class="op" id="6714200">^</span><span class="ident" id="6714201">s</span><span class="op" id="6714202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714205">b</span><span class="op" id="6714206">[</span><span class="num" id="6714207">3</span><span class="op" id="6714208">]</span>&nbsp;<span class="op" id="6714210">^=</span>&nbsp;<span class="builtintype" id="6714213">byte</span><span class="op" id="6714217">(</span><span class="op" id="6714218">^</span><span class="ident" id="6714219">s</span>&nbsp;<span class="op" id="6714221">&gt;&gt;</span>&nbsp;<span class="num" id="6714224">8</span><span class="op" id="6714225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714228">return</span>&nbsp;<span class="ident" id="6714235">b</span><span class="op" id="6714236">,</span>&nbsp;<span class="builtintype" id="6714238">nil</span><br>
<span class="lineno">60</span><span class="op" id="6714242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6714245">//&nbsp;parseICMPMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6714294">func</span>&nbsp;<span class="ident" id="6714299">parseICMPMessage</span><span class="op" id="6714315">(</span><span class="ident" id="6714316">b</span>&nbsp;<span class="op" id="6714318">[</span><span class="op" id="6714319">]</span><span class="builtintype" id="6714320">byte</span><span class="op" id="6714324">)</span>&nbsp;<span class="op" id="6714326">(</span><span class="op" id="6714327">*</span><span class="ident" id="6714328">icmpMessage</span><span class="op" id="6714339">,</span>&nbsp;<span class="builtintype" id="6714341">error</span><span class="op" id="6714346">)</span>&nbsp;<span class="op" id="6714348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714351">msglen</span>&nbsp;<span class="op" id="6714358">:=</span>&nbsp;<span class="builtinfunc" id="6714361">len</span><span class="op" id="6714364">(</span><span class="ident" id="6714365">b</span><span class="op" id="6714366">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714369">if</span>&nbsp;<span class="ident" id="6714372">msglen</span>&nbsp;<span class="op" id="6714379">&lt;</span>&nbsp;<span class="num" id="6714381">4</span>&nbsp;<span class="op" id="6714383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714387">return</span>&nbsp;<span class="builtintype" id="6714394">nil</span><span class="op" id="6714397">,</span>&nbsp;<span class="ident" id="6714399">errors</span><span class="op" id="6714405">.</span><span class="ident" id="6714406">New</span><span class="op" id="6714409">(</span><span class="string" id="6714410">&#34;message&nbsp;too&nbsp;short&#34;</span><span class="op" id="6714429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714435">m</span>&nbsp;<span class="op" id="6714437">:=</span>&nbsp;<span class="op" id="6714440">&amp;</span><span class="ident" id="6714441">icmpMessage</span><span class="op" id="6714452">{</span><span class="ident" id="6714453">Type</span><span class="op" id="6714457">:</span>&nbsp;<span class="builtintype" id="6714459">int</span><span class="op" id="6714462">(</span><span class="ident" id="6714463">b</span><span class="op" id="6714464">[</span><span class="num" id="6714465">0</span><span class="op" id="6714466">]</span><span class="op" id="6714467">)</span><span class="op" id="6714468">,</span>&nbsp;<span class="ident" id="6714470">Code</span><span class="op" id="6714474">:</span>&nbsp;<span class="builtintype" id="6714476">int</span><span class="op" id="6714479">(</span><span class="ident" id="6714480">b</span><span class="op" id="6714481">[</span><span class="num" id="6714482">1</span><span class="op" id="6714483">]</span><span class="op" id="6714484">)</span><span class="op" id="6714485">,</span>&nbsp;<span class="ident" id="6714487">Checksum</span><span class="op" id="6714495">:</span>&nbsp;<span class="builtintype" id="6714497">int</span><span class="op" id="6714500">(</span><span class="ident" id="6714501">b</span><span class="op" id="6714502">[</span><span class="num" id="6714503">2</span><span class="op" id="6714504">]</span><span class="op" id="6714505">)</span><span class="op" id="6714506">&lt;&lt;</span><span class="num" id="6714508">8</span>&nbsp;<span class="op" id="6714510">|</span>&nbsp;<span class="builtintype" id="6714512">int</span><span class="op" id="6714515">(</span><span class="ident" id="6714516">b</span><span class="op" id="6714517">[</span><span class="num" id="6714518">3</span><span class="op" id="6714519">]</span><span class="op" id="6714520">)</span><span class="op" id="6714521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714524">if</span>&nbsp;<span class="ident" id="6714527">msglen</span>&nbsp;<span class="op" id="6714534">&gt;</span>&nbsp;<span class="num" id="6714536">4</span>&nbsp;<span class="op" id="6714538">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714542">var</span>&nbsp;<span class="ident" id="6714546">err</span>&nbsp;<span class="builtintype" id="6714550">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714558">switch</span>&nbsp;<span class="ident" id="6714565">m</span><span class="op" id="6714566">.</span><span class="ident" id="6714567">Type</span>&nbsp;<span class="op" id="6714572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714576">case</span>&nbsp;<span class="ident" id="6714581">icmpv4EchoRequest</span><span class="op" id="6714598">,</span>&nbsp;<span class="ident" id="6714600">icmpv4EchoReply</span><span class="op" id="6714615">,</span>&nbsp;<span class="ident" id="6714617">icmpv6EchoRequest</span><span class="op" id="6714634">,</span>&nbsp;<span class="ident" id="6714636">icmpv6EchoReply</span><span class="op" id="6714651">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714656">m</span><span class="op" id="6714657">.</span><span class="ident" id="6714658">Body</span><span class="op" id="6714662">,</span>&nbsp;<span class="ident" id="6714664">err</span>&nbsp;<span class="op" id="6714668">=</span>&nbsp;<span class="ident" id="6714670">parseICMPEcho</span><span class="op" id="6714683">(</span><span class="ident" id="6714684">b</span><span class="op" id="6714685">[</span><span class="num" id="6714686">4</span><span class="op" id="6714687">:</span><span class="op" id="6714688">]</span><span class="op" id="6714689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714694">if</span>&nbsp;<span class="ident" id="6714697">err</span>&nbsp;<span class="op" id="6714701">!=</span>&nbsp;<span class="builtintype" id="6714704">nil</span>&nbsp;<span class="op" id="6714708">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714714">return</span>&nbsp;<span class="builtintype" id="6714721">nil</span><span class="op" id="6714724">,</span>&nbsp;<span class="ident" id="6714726">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714743">return</span>&nbsp;<span class="ident" id="6714750">m</span><span class="op" id="6714751">,</span>&nbsp;<span class="builtintype" id="6714753">nil</span><br>
<span class="lineno">80</span><span class="op" id="6714757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6714760">//&nbsp;imcpEcho&nbsp;represenets&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6714828">type</span>&nbsp;<span class="ident" id="6714833">icmpEcho</span>&nbsp;<span class="keyword" id="6714842">struct</span>&nbsp;<span class="op" id="6714849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714852">ID</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6714857">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6714864">//&nbsp;identifier</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714879">Seq</span>&nbsp;&nbsp;<span class="builtintype" id="6714884">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6714891">//&nbsp;sequence&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714911">Data</span>&nbsp;<span class="op" id="6714916">[</span><span class="op" id="6714917">]</span><span class="builtintype" id="6714918">byte</span>&nbsp;<span class="comment" id="6714923">//&nbsp;data</span><br>
<span class="lineno"></span><span class="op" id="6714931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6714934">func</span>&nbsp;<span class="op" id="6714939">(</span><span class="ident" id="6714940">p</span>&nbsp;<span class="op" id="6714942">*</span><span class="ident" id="6714943">icmpEcho</span><span class="op" id="6714951">)</span>&nbsp;<span class="ident" id="6714953">Len</span><span class="op" id="6714956">(</span><span class="op" id="6714957">)</span>&nbsp;<span class="builtintype" id="6714959">int</span>&nbsp;<span class="op" id="6714963">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714966">if</span>&nbsp;<span class="ident" id="6714969">p</span>&nbsp;<span class="op" id="6714971">==</span>&nbsp;<span class="builtintype" id="6714974">nil</span>&nbsp;<span class="op" id="6714978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714982">return</span>&nbsp;<span class="num" id="6714989">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714995">return</span>&nbsp;<span class="num" id="6715002">4</span>&nbsp;<span class="op" id="6715004">+</span>&nbsp;<span class="builtinfunc" id="6715006">len</span><span class="op" id="6715009">(</span><span class="ident" id="6715010">p</span><span class="op" id="6715011">.</span><span class="ident" id="6715012">Data</span><span class="op" id="6715016">)</span><br>
<span class="lineno"></span><span class="op" id="6715018">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="6715021">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6715089">//&nbsp;reply&nbsp;message&nbsp;body&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6715114">func</span>&nbsp;<span class="op" id="6715119">(</span><span class="ident" id="6715120">p</span>&nbsp;<span class="op" id="6715122">*</span><span class="ident" id="6715123">icmpEcho</span><span class="op" id="6715131">)</span>&nbsp;<span class="ident" id="6715133">Marshal</span><span class="op" id="6715140">(</span><span class="op" id="6715141">)</span>&nbsp;<span class="op" id="6715143">(</span><span class="op" id="6715144">[</span><span class="op" id="6715145">]</span><span class="builtintype" id="6715146">byte</span><span class="op" id="6715150">,</span>&nbsp;<span class="builtintype" id="6715152">error</span><span class="op" id="6715157">)</span>&nbsp;<span class="op" id="6715159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715162">b</span>&nbsp;<span class="op" id="6715164">:=</span>&nbsp;<span class="builtinfunc" id="6715167">make</span><span class="op" id="6715171">(</span><span class="op" id="6715172">[</span><span class="op" id="6715173">]</span><span class="builtintype" id="6715174">byte</span><span class="op" id="6715178">,</span>&nbsp;<span class="num" id="6715180">4</span><span class="op" id="6715181">+</span><span class="builtinfunc" id="6715182">len</span><span class="op" id="6715185">(</span><span class="ident" id="6715186">p</span><span class="op" id="6715187">.</span><span class="ident" id="6715188">Data</span><span class="op" id="6715192">)</span><span class="op" id="6715193">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715196">b</span><span class="op" id="6715197">[</span><span class="num" id="6715198">0</span><span class="op" id="6715199">]</span><span class="op" id="6715200">,</span>&nbsp;<span class="ident" id="6715202">b</span><span class="op" id="6715203">[</span><span class="num" id="6715204">1</span><span class="op" id="6715205">]</span>&nbsp;<span class="op" id="6715207">=</span>&nbsp;<span class="builtintype" id="6715209">byte</span><span class="op" id="6715213">(</span><span class="ident" id="6715214">p</span><span class="op" id="6715215">.</span><span class="ident" id="6715216">ID</span><span class="op" id="6715218">&gt;&gt;</span><span class="num" id="6715220">8</span><span class="op" id="6715221">)</span><span class="op" id="6715222">,</span>&nbsp;<span class="builtintype" id="6715224">byte</span><span class="op" id="6715228">(</span><span class="ident" id="6715229">p</span><span class="op" id="6715230">.</span><span class="ident" id="6715231">ID</span><span class="op" id="6715233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715236">b</span><span class="op" id="6715237">[</span><span class="num" id="6715238">2</span><span class="op" id="6715239">]</span><span class="op" id="6715240">,</span>&nbsp;<span class="ident" id="6715242">b</span><span class="op" id="6715243">[</span><span class="num" id="6715244">3</span><span class="op" id="6715245">]</span>&nbsp;<span class="op" id="6715247">=</span>&nbsp;<span class="builtintype" id="6715249">byte</span><span class="op" id="6715253">(</span><span class="ident" id="6715254">p</span><span class="op" id="6715255">.</span><span class="ident" id="6715256">Seq</span><span class="op" id="6715259">&gt;&gt;</span><span class="num" id="6715261">8</span><span class="op" id="6715262">)</span><span class="op" id="6715263">,</span>&nbsp;<span class="builtintype" id="6715265">byte</span><span class="op" id="6715269">(</span><span class="ident" id="6715270">p</span><span class="op" id="6715271">.</span><span class="ident" id="6715272">Seq</span><span class="op" id="6715275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6715278">copy</span><span class="op" id="6715282">(</span><span class="ident" id="6715283">b</span><span class="op" id="6715284">[</span><span class="num" id="6715285">4</span><span class="op" id="6715286">:</span><span class="op" id="6715287">]</span><span class="op" id="6715288">,</span>&nbsp;<span class="ident" id="6715290">p</span><span class="op" id="6715291">.</span><span class="ident" id="6715292">Data</span><span class="op" id="6715296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6715299">return</span>&nbsp;<span class="ident" id="6715306">b</span><span class="op" id="6715307">,</span>&nbsp;<span class="builtintype" id="6715309">nil</span><br>
<span class="lineno"></span><span class="op" id="6715313">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="6715316">//&nbsp;parseICMPEcho&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="6715383">//&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6715392">func</span>&nbsp;<span class="ident" id="6715397">parseICMPEcho</span><span class="op" id="6715410">(</span><span class="ident" id="6715411">b</span>&nbsp;<span class="op" id="6715413">[</span><span class="op" id="6715414">]</span><span class="builtintype" id="6715415">byte</span><span class="op" id="6715419">)</span>&nbsp;<span class="op" id="6715421">(</span><span class="op" id="6715422">*</span><span class="ident" id="6715423">icmpEcho</span><span class="op" id="6715431">,</span>&nbsp;<span class="builtintype" id="6715433">error</span><span class="op" id="6715438">)</span>&nbsp;<span class="op" id="6715440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715443">bodylen</span>&nbsp;<span class="op" id="6715451">:=</span>&nbsp;<span class="builtinfunc" id="6715454">len</span><span class="op" id="6715457">(</span><span class="ident" id="6715458">b</span><span class="op" id="6715459">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715462">p</span>&nbsp;<span class="op" id="6715464">:=</span>&nbsp;<span class="op" id="6715467">&amp;</span><span class="ident" id="6715468">icmpEcho</span><span class="op" id="6715476">{</span><span class="ident" id="6715477">ID</span><span class="op" id="6715479">:</span>&nbsp;<span class="builtintype" id="6715481">int</span><span class="op" id="6715484">(</span><span class="ident" id="6715485">b</span><span class="op" id="6715486">[</span><span class="num" id="6715487">0</span><span class="op" id="6715488">]</span><span class="op" id="6715489">)</span><span class="op" id="6715490">&lt;&lt;</span><span class="num" id="6715492">8</span>&nbsp;<span class="op" id="6715494">|</span>&nbsp;<span class="builtintype" id="6715496">int</span><span class="op" id="6715499">(</span><span class="ident" id="6715500">b</span><span class="op" id="6715501">[</span><span class="num" id="6715502">1</span><span class="op" id="6715503">]</span><span class="op" id="6715504">)</span><span class="op" id="6715505">,</span>&nbsp;<span class="ident" id="6715507">Seq</span><span class="op" id="6715510">:</span>&nbsp;<span class="builtintype" id="6715512">int</span><span class="op" id="6715515">(</span><span class="ident" id="6715516">b</span><span class="op" id="6715517">[</span><span class="num" id="6715518">2</span><span class="op" id="6715519">]</span><span class="op" id="6715520">)</span><span class="op" id="6715521">&lt;&lt;</span><span class="num" id="6715523">8</span>&nbsp;<span class="op" id="6715525">|</span>&nbsp;<span class="builtintype" id="6715527">int</span><span class="op" id="6715530">(</span><span class="ident" id="6715531">b</span><span class="op" id="6715532">[</span><span class="num" id="6715533">3</span><span class="op" id="6715534">]</span><span class="op" id="6715535">)</span><span class="op" id="6715536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6715539">if</span>&nbsp;<span class="ident" id="6715542">bodylen</span>&nbsp;<span class="op" id="6715550">&gt;</span>&nbsp;<span class="num" id="6715552">4</span>&nbsp;<span class="op" id="6715554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715558">p</span><span class="op" id="6715559">.</span><span class="ident" id="6715560">Data</span>&nbsp;<span class="op" id="6715565">=</span>&nbsp;<span class="builtinfunc" id="6715567">make</span><span class="op" id="6715571">(</span><span class="op" id="6715572">[</span><span class="op" id="6715573">]</span><span class="builtintype" id="6715574">byte</span><span class="op" id="6715578">,</span>&nbsp;<span class="ident" id="6715580">bodylen</span><span class="op" id="6715587">-</span><span class="num" id="6715588">4</span><span class="op" id="6715589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6715593">copy</span><span class="op" id="6715597">(</span><span class="ident" id="6715598">p</span><span class="op" id="6715599">.</span><span class="ident" id="6715600">Data</span><span class="op" id="6715604">,</span>&nbsp;<span class="ident" id="6715606">b</span><span class="op" id="6715607">[</span><span class="num" id="6715608">4</span><span class="op" id="6715609">:</span><span class="op" id="6715610">]</span><span class="op" id="6715611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6715614">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6715617">return</span>&nbsp;<span class="ident" id="6715624">p</span><span class="op" id="6715625">,</span>&nbsp;<span class="builtintype" id="6715627">nil</span><br>
<span class="lineno"></span><span class="op" id="6715631">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
