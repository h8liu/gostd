<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509/pkix</h2>
<ul>
<li><a href="/gostd/crypto/x509/pkix/pkix.go.html">pkix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4447383">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4447438">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4447492">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4447543">//&nbsp;Package&nbsp;pkix&nbsp;contains&nbsp;shared,&nbsp;low&nbsp;level&nbsp;structures&nbsp;used&nbsp;for&nbsp;ASN.1&nbsp;parsing</span><br>
<span class="lineno"></span><span class="comment" id="4447620">//&nbsp;and&nbsp;serialization&nbsp;of&nbsp;X.509&nbsp;certificates,&nbsp;CRL&nbsp;and&nbsp;OCSP.</span><br>
<span class="lineno"></span><span class="keyword" id="4447678">package</span>&nbsp;<span class="ident" id="4447686">pkix</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4447692">import</span>&nbsp;<span class="op" id="4447699">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4447702">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4447719">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4447731">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4447738">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4447741">//&nbsp;AlgorithmIdentifier&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4447821">//&nbsp;5280,&nbsp;section&nbsp;4.1.1.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4447847">type</span>&nbsp;<span class="ident" id="4447852">AlgorithmIdentifier</span>&nbsp;<span class="keyword" id="4447872">struct</span>&nbsp;<span class="op" id="4447879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447882">Algorithm</span>&nbsp;&nbsp;<span class="ident" id="4447893">asn1</span><span class="op" id="4447897">.</span><span class="ident" id="4447898">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447916">Parameters</span>&nbsp;<span class="ident" id="4447927">asn1</span><span class="op" id="4447931">.</span><span class="ident" id="4447932">RawValue</span>&nbsp;<span class="string" id="4447941">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">20</span><span class="op" id="4447959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4447962">type</span>&nbsp;<span class="ident" id="4447967">RDNSequence</span>&nbsp;<span class="op" id="4447979">[</span><span class="op" id="4447980">]</span><span class="ident" id="4447981">RelativeDistinguishedNameSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4448011">type</span>&nbsp;<span class="ident" id="4448016">RelativeDistinguishedNameSET</span>&nbsp;<span class="op" id="4448045">[</span><span class="op" id="4448046">]</span><span class="ident" id="4448047">AttributeTypeAndValue</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4448070">//&nbsp;AttributeTypeAndValue&nbsp;mirrors&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4448143">//&nbsp;http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span><br>
<span class="lineno"></span><span class="keyword" id="4448197">type</span>&nbsp;<span class="ident" id="4448202">AttributeTypeAndValue</span>&nbsp;<span class="keyword" id="4448224">struct</span>&nbsp;<span class="op" id="4448231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448234">Type</span>&nbsp;&nbsp;<span class="ident" id="4448240">asn1</span><span class="op" id="4448244">.</span><span class="ident" id="4448245">ObjectIdentifier</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448263">Value</span>&nbsp;<span class="keyword" id="4448269">interface</span><span class="op" id="4448278">{</span><span class="op" id="4448279">}</span><br>
<span class="lineno"></span><span class="op" id="4448281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4448284">//&nbsp;AttributeTypeAndValueSET&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;ASN.1&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4448351">//&nbsp;AttributeTypeAndValue&nbsp;sequences&nbsp;from&nbsp;RFC&nbsp;2986&nbsp;(PKCS&nbsp;#10).</span><br>
<span class="lineno">35</span><span class="keyword" id="4448412">type</span>&nbsp;<span class="ident" id="4448417">AttributeTypeAndValueSET</span>&nbsp;<span class="keyword" id="4448442">struct</span>&nbsp;<span class="op" id="4448449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448452">Type</span>&nbsp;&nbsp;<span class="ident" id="4448458">asn1</span><span class="op" id="4448462">.</span><span class="ident" id="4448463">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448481">Value</span>&nbsp;<span class="op" id="4448487">[</span><span class="op" id="4448488">]</span><span class="op" id="4448489">[</span><span class="op" id="4448490">]</span><span class="ident" id="4448491">AttributeTypeAndValue</span>&nbsp;<span class="string" id="4448513">`asn1:&#34;set&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4448526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4448529">//&nbsp;Extension&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4448599">//&nbsp;5280,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4448621">type</span>&nbsp;<span class="ident" id="4448626">Extension</span>&nbsp;<span class="keyword" id="4448636">struct</span>&nbsp;<span class="op" id="4448643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448646">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4448655">asn1</span><span class="op" id="4448659">.</span><span class="ident" id="4448660">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448678">Critical</span>&nbsp;<span class="builtintype" id="4448687">bool</span>&nbsp;<span class="string" id="4448692">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448711">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4448720">[</span><span class="op" id="4448721">]</span><span class="builtintype" id="4448722">byte</span><br>
<span class="lineno"></span><span class="op" id="4448727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4448730">//&nbsp;Name&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;distinguished&nbsp;name.&nbsp;This&nbsp;only&nbsp;includes&nbsp;the&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="4448808">//&nbsp;elements&nbsp;of&nbsp;a&nbsp;DN.&nbsp;&nbsp;Additional&nbsp;elements&nbsp;in&nbsp;the&nbsp;name&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">50</span><span class="keyword" id="4448875">type</span>&nbsp;<span class="ident" id="4448880">Name</span>&nbsp;<span class="keyword" id="4448885">struct</span>&nbsp;<span class="op" id="4448892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448895">Country</span><span class="op" id="4448902">,</span>&nbsp;<span class="ident" id="4448904">Organization</span><span class="op" id="4448916">,</span>&nbsp;<span class="ident" id="4448918">OrganizationalUnit</span>&nbsp;<span class="op" id="4448937">[</span><span class="op" id="4448938">]</span><span class="builtintype" id="4448939">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448947">Locality</span><span class="op" id="4448955">,</span>&nbsp;<span class="ident" id="4448957">Province</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4448989">[</span><span class="op" id="4448990">]</span><span class="builtintype" id="4448991">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448999">StreetAddress</span><span class="op" id="4449012">,</span>&nbsp;<span class="ident" id="4449014">PostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4449041">[</span><span class="op" id="4449042">]</span><span class="builtintype" id="4449043">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449051">SerialNumber</span><span class="op" id="4449063">,</span>&nbsp;<span class="ident" id="4449065">CommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4449093">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449102">Names</span>&nbsp;<span class="op" id="4449108">[</span><span class="op" id="4449109">]</span><span class="ident" id="4449110">AttributeTypeAndValue</span><br>
<span class="lineno"></span><span class="op" id="4449132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4449135">func</span>&nbsp;<span class="op" id="4449140">(</span><span class="ident" id="4449141">n</span>&nbsp;<span class="op" id="4449143">*</span><span class="ident" id="4449144">Name</span><span class="op" id="4449148">)</span>&nbsp;<span class="ident" id="4449150">FillFromRDNSequence</span><span class="op" id="4449169">(</span><span class="ident" id="4449170">rdns</span>&nbsp;<span class="op" id="4449175">*</span><span class="ident" id="4449176">RDNSequence</span><span class="op" id="4449187">)</span>&nbsp;<span class="op" id="4449189">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449192">for</span>&nbsp;<span class="ident" id="4449196">_</span><span class="op" id="4449197">,</span>&nbsp;<span class="ident" id="4449199">rdn</span>&nbsp;<span class="op" id="4449203">:=</span>&nbsp;<span class="keyword" id="4449206">range</span>&nbsp;<span class="op" id="4449212">*</span><span class="ident" id="4449213">rdns</span>&nbsp;<span class="op" id="4449218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449222">if</span>&nbsp;<span class="builtinfunc" id="4449225">len</span><span class="op" id="4449228">(</span><span class="ident" id="4449229">rdn</span><span class="op" id="4449232">)</span>&nbsp;<span class="op" id="4449234">==</span>&nbsp;<span class="num" id="4449237">0</span>&nbsp;<span class="op" id="4449239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449244">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4449255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449259">atv</span>&nbsp;<span class="op" id="4449263">:=</span>&nbsp;<span class="ident" id="4449266">rdn</span><span class="op" id="4449269">[</span><span class="num" id="4449270">0</span><span class="op" id="4449271">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449275">n</span><span class="op" id="4449276">.</span><span class="ident" id="4449277">Names</span>&nbsp;<span class="op" id="4449283">=</span>&nbsp;<span class="builtinfunc" id="4449285">append</span><span class="op" id="4449291">(</span><span class="ident" id="4449292">n</span><span class="op" id="4449293">.</span><span class="ident" id="4449294">Names</span><span class="op" id="4449299">,</span>&nbsp;<span class="ident" id="4449301">atv</span><span class="op" id="4449304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449308">value</span><span class="op" id="4449313">,</span>&nbsp;<span class="ident" id="4449315">ok</span>&nbsp;<span class="op" id="4449318">:=</span>&nbsp;<span class="ident" id="4449321">atv</span><span class="op" id="4449324">.</span><span class="ident" id="4449325">Value</span><span class="op" id="4449330">.</span><span class="op" id="4449331">(</span><span class="builtintype" id="4449332">string</span><span class="op" id="4449338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449342">if</span>&nbsp;<span class="op" id="4449345">!</span><span class="ident" id="4449346">ok</span>&nbsp;<span class="op" id="4449349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449354">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4449365">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449370">t</span>&nbsp;<span class="op" id="4449372">:=</span>&nbsp;<span class="ident" id="4449375">atv</span><span class="op" id="4449378">.</span><span class="ident" id="4449379">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449386">if</span>&nbsp;<span class="builtinfunc" id="4449389">len</span><span class="op" id="4449392">(</span><span class="ident" id="4449393">t</span><span class="op" id="4449394">)</span>&nbsp;<span class="op" id="4449396">==</span>&nbsp;<span class="num" id="4449399">4</span>&nbsp;<span class="op" id="4449401">&amp;&amp;</span>&nbsp;<span class="ident" id="4449404">t</span><span class="op" id="4449405">[</span><span class="num" id="4449406">0</span><span class="op" id="4449407">]</span>&nbsp;<span class="op" id="4449409">==</span>&nbsp;<span class="num" id="4449412">2</span>&nbsp;<span class="op" id="4449414">&amp;&amp;</span>&nbsp;<span class="ident" id="4449417">t</span><span class="op" id="4449418">[</span><span class="num" id="4449419">1</span><span class="op" id="4449420">]</span>&nbsp;<span class="op" id="4449422">==</span>&nbsp;<span class="num" id="4449425">5</span>&nbsp;<span class="op" id="4449427">&amp;&amp;</span>&nbsp;<span class="ident" id="4449430">t</span><span class="op" id="4449431">[</span><span class="num" id="4449432">2</span><span class="op" id="4449433">]</span>&nbsp;<span class="op" id="4449435">==</span>&nbsp;<span class="num" id="4449438">4</span>&nbsp;<span class="op" id="4449440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449445">switch</span>&nbsp;<span class="ident" id="4449452">t</span><span class="op" id="4449453">[</span><span class="num" id="4449454">3</span><span class="op" id="4449455">]</span>&nbsp;<span class="op" id="4449457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449462">case</span>&nbsp;<span class="num" id="4449467">3</span><span class="op" id="4449468">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449474">n</span><span class="op" id="4449475">.</span><span class="ident" id="4449476">CommonName</span>&nbsp;<span class="op" id="4449487">=</span>&nbsp;<span class="ident" id="4449489">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449498">case</span>&nbsp;<span class="num" id="4449503">5</span><span class="op" id="4449504">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449510">n</span><span class="op" id="4449511">.</span><span class="ident" id="4449512">SerialNumber</span>&nbsp;<span class="op" id="4449525">=</span>&nbsp;<span class="ident" id="4449527">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449536">case</span>&nbsp;<span class="num" id="4449541">6</span><span class="op" id="4449542">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449548">n</span><span class="op" id="4449549">.</span><span class="ident" id="4449550">Country</span>&nbsp;<span class="op" id="4449558">=</span>&nbsp;<span class="builtinfunc" id="4449560">append</span><span class="op" id="4449566">(</span><span class="ident" id="4449567">n</span><span class="op" id="4449568">.</span><span class="ident" id="4449569">Country</span><span class="op" id="4449576">,</span>&nbsp;<span class="ident" id="4449578">value</span><span class="op" id="4449583">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449588">case</span>&nbsp;<span class="num" id="4449593">7</span><span class="op" id="4449594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449600">n</span><span class="op" id="4449601">.</span><span class="ident" id="4449602">Locality</span>&nbsp;<span class="op" id="4449611">=</span>&nbsp;<span class="builtinfunc" id="4449613">append</span><span class="op" id="4449619">(</span><span class="ident" id="4449620">n</span><span class="op" id="4449621">.</span><span class="ident" id="4449622">Locality</span><span class="op" id="4449630">,</span>&nbsp;<span class="ident" id="4449632">value</span><span class="op" id="4449637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449642">case</span>&nbsp;<span class="num" id="4449647">8</span><span class="op" id="4449648">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449654">n</span><span class="op" id="4449655">.</span><span class="ident" id="4449656">Province</span>&nbsp;<span class="op" id="4449665">=</span>&nbsp;<span class="builtinfunc" id="4449667">append</span><span class="op" id="4449673">(</span><span class="ident" id="4449674">n</span><span class="op" id="4449675">.</span><span class="ident" id="4449676">Province</span><span class="op" id="4449684">,</span>&nbsp;<span class="ident" id="4449686">value</span><span class="op" id="4449691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449696">case</span>&nbsp;<span class="num" id="4449701">9</span><span class="op" id="4449702">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449708">n</span><span class="op" id="4449709">.</span><span class="ident" id="4449710">StreetAddress</span>&nbsp;<span class="op" id="4449724">=</span>&nbsp;<span class="builtinfunc" id="4449726">append</span><span class="op" id="4449732">(</span><span class="ident" id="4449733">n</span><span class="op" id="4449734">.</span><span class="ident" id="4449735">StreetAddress</span><span class="op" id="4449748">,</span>&nbsp;<span class="ident" id="4449750">value</span><span class="op" id="4449755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449760">case</span>&nbsp;<span class="num" id="4449765">10</span><span class="op" id="4449767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449773">n</span><span class="op" id="4449774">.</span><span class="ident" id="4449775">Organization</span>&nbsp;<span class="op" id="4449788">=</span>&nbsp;<span class="builtinfunc" id="4449790">append</span><span class="op" id="4449796">(</span><span class="ident" id="4449797">n</span><span class="op" id="4449798">.</span><span class="ident" id="4449799">Organization</span><span class="op" id="4449811">,</span>&nbsp;<span class="ident" id="4449813">value</span><span class="op" id="4449818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449823">case</span>&nbsp;<span class="num" id="4449828">11</span><span class="op" id="4449830">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449836">n</span><span class="op" id="4449837">.</span><span class="ident" id="4449838">OrganizationalUnit</span>&nbsp;<span class="op" id="4449857">=</span>&nbsp;<span class="builtinfunc" id="4449859">append</span><span class="op" id="4449865">(</span><span class="ident" id="4449866">n</span><span class="op" id="4449867">.</span><span class="ident" id="4449868">OrganizationalUnit</span><span class="op" id="4449886">,</span>&nbsp;<span class="ident" id="4449888">value</span><span class="op" id="4449893">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449898">case</span>&nbsp;<span class="num" id="4449903">17</span><span class="op" id="4449905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449911">n</span><span class="op" id="4449912">.</span><span class="ident" id="4449913">PostalCode</span>&nbsp;<span class="op" id="4449924">=</span>&nbsp;<span class="builtinfunc" id="4449926">append</span><span class="op" id="4449932">(</span><span class="ident" id="4449933">n</span><span class="op" id="4449934">.</span><span class="ident" id="4449935">PostalCode</span><span class="op" id="4449945">,</span>&nbsp;<span class="ident" id="4449947">value</span><span class="op" id="4449952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4449957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4449961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4449964">}</span><br>
<span class="lineno">95</span><span class="op" id="4449966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4449969">var</span>&nbsp;<span class="op" id="4449973">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449976">oidCountry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4449998">=</span>&nbsp;<span class="op" id="4450000">[</span><span class="op" id="4450001">]</span><span class="builtintype" id="4450002">int</span><span class="op" id="4450005">{</span><span class="num" id="4450006">2</span><span class="op" id="4450007">,</span>&nbsp;<span class="num" id="4450009">5</span><span class="op" id="4450010">,</span>&nbsp;<span class="num" id="4450012">4</span><span class="op" id="4450013">,</span>&nbsp;<span class="num" id="4450015">6</span><span class="op" id="4450016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450019">oidOrganization</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4450041">=</span>&nbsp;<span class="op" id="4450043">[</span><span class="op" id="4450044">]</span><span class="builtintype" id="4450045">int</span><span class="op" id="4450048">{</span><span class="num" id="4450049">2</span><span class="op" id="4450050">,</span>&nbsp;<span class="num" id="4450052">5</span><span class="op" id="4450053">,</span>&nbsp;<span class="num" id="4450055">4</span><span class="op" id="4450056">,</span>&nbsp;<span class="num" id="4450058">10</span><span class="op" id="4450060">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450063">oidOrganizationalUnit</span>&nbsp;<span class="op" id="4450085">=</span>&nbsp;<span class="op" id="4450087">[</span><span class="op" id="4450088">]</span><span class="builtintype" id="4450089">int</span><span class="op" id="4450092">{</span><span class="num" id="4450093">2</span><span class="op" id="4450094">,</span>&nbsp;<span class="num" id="4450096">5</span><span class="op" id="4450097">,</span>&nbsp;<span class="num" id="4450099">4</span><span class="op" id="4450100">,</span>&nbsp;<span class="num" id="4450102">11</span><span class="op" id="4450104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450107">oidCommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4450129">=</span>&nbsp;<span class="op" id="4450131">[</span><span class="op" id="4450132">]</span><span class="builtintype" id="4450133">int</span><span class="op" id="4450136">{</span><span class="num" id="4450137">2</span><span class="op" id="4450138">,</span>&nbsp;<span class="num" id="4450140">5</span><span class="op" id="4450141">,</span>&nbsp;<span class="num" id="4450143">4</span><span class="op" id="4450144">,</span>&nbsp;<span class="num" id="4450146">3</span><span class="op" id="4450147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450150">oidSerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4450172">=</span>&nbsp;<span class="op" id="4450174">[</span><span class="op" id="4450175">]</span><span class="builtintype" id="4450176">int</span><span class="op" id="4450179">{</span><span class="num" id="4450180">2</span><span class="op" id="4450181">,</span>&nbsp;<span class="num" id="4450183">5</span><span class="op" id="4450184">,</span>&nbsp;<span class="num" id="4450186">4</span><span class="op" id="4450187">,</span>&nbsp;<span class="num" id="4450189">5</span><span class="op" id="4450190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450193">oidLocality</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4450215">=</span>&nbsp;<span class="op" id="4450217">[</span><span class="op" id="4450218">]</span><span class="builtintype" id="4450219">int</span><span class="op" id="4450222">{</span><span class="num" id="4450223">2</span><span class="op" id="4450224">,</span>&nbsp;<span class="num" id="4450226">5</span><span class="op" id="4450227">,</span>&nbsp;<span class="num" id="4450229">4</span><span class="op" id="4450230">,</span>&nbsp;<span class="num" id="4450232">7</span><span class="op" id="4450233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450236">oidProvince</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4450258">=</span>&nbsp;<span class="op" id="4450260">[</span><span class="op" id="4450261">]</span><span class="builtintype" id="4450262">int</span><span class="op" id="4450265">{</span><span class="num" id="4450266">2</span><span class="op" id="4450267">,</span>&nbsp;<span class="num" id="4450269">5</span><span class="op" id="4450270">,</span>&nbsp;<span class="num" id="4450272">4</span><span class="op" id="4450273">,</span>&nbsp;<span class="num" id="4450275">8</span><span class="op" id="4450276">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450279">oidStreetAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4450301">=</span>&nbsp;<span class="op" id="4450303">[</span><span class="op" id="4450304">]</span><span class="builtintype" id="4450305">int</span><span class="op" id="4450308">{</span><span class="num" id="4450309">2</span><span class="op" id="4450310">,</span>&nbsp;<span class="num" id="4450312">5</span><span class="op" id="4450313">,</span>&nbsp;<span class="num" id="4450315">4</span><span class="op" id="4450316">,</span>&nbsp;<span class="num" id="4450318">9</span><span class="op" id="4450319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450322">oidPostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4450344">=</span>&nbsp;<span class="op" id="4450346">[</span><span class="op" id="4450347">]</span><span class="builtintype" id="4450348">int</span><span class="op" id="4450351">{</span><span class="num" id="4450352">2</span><span class="op" id="4450353">,</span>&nbsp;<span class="num" id="4450355">5</span><span class="op" id="4450356">,</span>&nbsp;<span class="num" id="4450358">4</span><span class="op" id="4450359">,</span>&nbsp;<span class="num" id="4450361">17</span><span class="op" id="4450363">}</span><br>
<span class="lineno"></span><span class="op" id="4450365">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4450368">//&nbsp;appendRDNs&nbsp;appends&nbsp;a&nbsp;relativeDistinguishedNameSET&nbsp;to&nbsp;the&nbsp;given&nbsp;RDNSequence</span><br>
<span class="lineno">110</span><span class="comment" id="4450446">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.&nbsp;The&nbsp;relativeDistinguishedNameSET&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4450521">//&nbsp;attributeTypeAndValue&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;given&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;5280,&nbsp;A.1,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4450599">//&nbsp;search&nbsp;for&nbsp;AttributeTypeAndValue.</span><br>
<span class="lineno"></span><span class="keyword" id="4450636">func</span>&nbsp;<span class="ident" id="4450641">appendRDNs</span><span class="op" id="4450651">(</span><span class="ident" id="4450652">in</span>&nbsp;<span class="ident" id="4450655">RDNSequence</span><span class="op" id="4450666">,</span>&nbsp;<span class="ident" id="4450668">values</span>&nbsp;<span class="op" id="4450675">[</span><span class="op" id="4450676">]</span><span class="builtintype" id="4450677">string</span><span class="op" id="4450683">,</span>&nbsp;<span class="ident" id="4450685">oid</span>&nbsp;<span class="ident" id="4450689">asn1</span><span class="op" id="4450693">.</span><span class="ident" id="4450694">ObjectIdentifier</span><span class="op" id="4450710">)</span>&nbsp;<span class="ident" id="4450712">RDNSequence</span>&nbsp;<span class="op" id="4450724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450727">if</span>&nbsp;<span class="builtinfunc" id="4450730">len</span><span class="op" id="4450733">(</span><span class="ident" id="4450734">values</span><span class="op" id="4450740">)</span>&nbsp;<span class="op" id="4450742">==</span>&nbsp;<span class="num" id="4450745">0</span>&nbsp;<span class="op" id="4450747">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450751">return</span>&nbsp;<span class="ident" id="4450758">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450766">s</span>&nbsp;<span class="op" id="4450768">:=</span>&nbsp;<span class="builtinfunc" id="4450771">make</span><span class="op" id="4450775">(</span><span class="op" id="4450776">[</span><span class="op" id="4450777">]</span><span class="ident" id="4450778">AttributeTypeAndValue</span><span class="op" id="4450799">,</span>&nbsp;<span class="builtinfunc" id="4450801">len</span><span class="op" id="4450804">(</span><span class="ident" id="4450805">values</span><span class="op" id="4450811">)</span><span class="op" id="4450812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450815">for</span>&nbsp;<span class="ident" id="4450819">i</span><span class="op" id="4450820">,</span>&nbsp;<span class="ident" id="4450822">value</span>&nbsp;<span class="op" id="4450828">:=</span>&nbsp;<span class="keyword" id="4450831">range</span>&nbsp;<span class="ident" id="4450837">values</span>&nbsp;<span class="op" id="4450844">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450848">s</span><span class="op" id="4450849">[</span><span class="ident" id="4450850">i</span><span class="op" id="4450851">]</span><span class="op" id="4450852">.</span><span class="ident" id="4450853">Type</span>&nbsp;<span class="op" id="4450858">=</span>&nbsp;<span class="ident" id="4450860">oid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450866">s</span><span class="op" id="4450867">[</span><span class="ident" id="4450868">i</span><span class="op" id="4450869">]</span><span class="op" id="4450870">.</span><span class="ident" id="4450871">Value</span>&nbsp;<span class="op" id="4450877">=</span>&nbsp;<span class="ident" id="4450879">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450890">return</span>&nbsp;<span class="builtinfunc" id="4450897">append</span><span class="op" id="4450903">(</span><span class="ident" id="4450904">in</span><span class="op" id="4450906">,</span>&nbsp;<span class="ident" id="4450908">s</span><span class="op" id="4450909">)</span><br>
<span class="lineno">125</span><span class="op" id="4450911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4450914">func</span>&nbsp;<span class="op" id="4450919">(</span><span class="ident" id="4450920">n</span>&nbsp;<span class="ident" id="4450922">Name</span><span class="op" id="4450926">)</span>&nbsp;<span class="ident" id="4450928">ToRDNSequence</span><span class="op" id="4450941">(</span><span class="op" id="4450942">)</span>&nbsp;<span class="op" id="4450944">(</span><span class="ident" id="4450945">ret</span>&nbsp;<span class="ident" id="4450949">RDNSequence</span><span class="op" id="4450960">)</span>&nbsp;<span class="op" id="4450962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450965">ret</span>&nbsp;<span class="op" id="4450969">=</span>&nbsp;<span class="ident" id="4450971">appendRDNs</span><span class="op" id="4450981">(</span><span class="ident" id="4450982">ret</span><span class="op" id="4450985">,</span>&nbsp;<span class="ident" id="4450987">n</span><span class="op" id="4450988">.</span><span class="ident" id="4450989">Country</span><span class="op" id="4450996">,</span>&nbsp;<span class="ident" id="4450998">oidCountry</span><span class="op" id="4451008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451011">ret</span>&nbsp;<span class="op" id="4451015">=</span>&nbsp;<span class="ident" id="4451017">appendRDNs</span><span class="op" id="4451027">(</span><span class="ident" id="4451028">ret</span><span class="op" id="4451031">,</span>&nbsp;<span class="ident" id="4451033">n</span><span class="op" id="4451034">.</span><span class="ident" id="4451035">Organization</span><span class="op" id="4451047">,</span>&nbsp;<span class="ident" id="4451049">oidOrganization</span><span class="op" id="4451064">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451067">ret</span>&nbsp;<span class="op" id="4451071">=</span>&nbsp;<span class="ident" id="4451073">appendRDNs</span><span class="op" id="4451083">(</span><span class="ident" id="4451084">ret</span><span class="op" id="4451087">,</span>&nbsp;<span class="ident" id="4451089">n</span><span class="op" id="4451090">.</span><span class="ident" id="4451091">OrganizationalUnit</span><span class="op" id="4451109">,</span>&nbsp;<span class="ident" id="4451111">oidOrganizationalUnit</span><span class="op" id="4451132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451135">ret</span>&nbsp;<span class="op" id="4451139">=</span>&nbsp;<span class="ident" id="4451141">appendRDNs</span><span class="op" id="4451151">(</span><span class="ident" id="4451152">ret</span><span class="op" id="4451155">,</span>&nbsp;<span class="ident" id="4451157">n</span><span class="op" id="4451158">.</span><span class="ident" id="4451159">Locality</span><span class="op" id="4451167">,</span>&nbsp;<span class="ident" id="4451169">oidLocality</span><span class="op" id="4451180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451183">ret</span>&nbsp;<span class="op" id="4451187">=</span>&nbsp;<span class="ident" id="4451189">appendRDNs</span><span class="op" id="4451199">(</span><span class="ident" id="4451200">ret</span><span class="op" id="4451203">,</span>&nbsp;<span class="ident" id="4451205">n</span><span class="op" id="4451206">.</span><span class="ident" id="4451207">Province</span><span class="op" id="4451215">,</span>&nbsp;<span class="ident" id="4451217">oidProvince</span><span class="op" id="4451228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451231">ret</span>&nbsp;<span class="op" id="4451235">=</span>&nbsp;<span class="ident" id="4451237">appendRDNs</span><span class="op" id="4451247">(</span><span class="ident" id="4451248">ret</span><span class="op" id="4451251">,</span>&nbsp;<span class="ident" id="4451253">n</span><span class="op" id="4451254">.</span><span class="ident" id="4451255">StreetAddress</span><span class="op" id="4451268">,</span>&nbsp;<span class="ident" id="4451270">oidStreetAddress</span><span class="op" id="4451286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451289">ret</span>&nbsp;<span class="op" id="4451293">=</span>&nbsp;<span class="ident" id="4451295">appendRDNs</span><span class="op" id="4451305">(</span><span class="ident" id="4451306">ret</span><span class="op" id="4451309">,</span>&nbsp;<span class="ident" id="4451311">n</span><span class="op" id="4451312">.</span><span class="ident" id="4451313">PostalCode</span><span class="op" id="4451323">,</span>&nbsp;<span class="ident" id="4451325">oidPostalCode</span><span class="op" id="4451338">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451341">if</span>&nbsp;<span class="builtinfunc" id="4451344">len</span><span class="op" id="4451347">(</span><span class="ident" id="4451348">n</span><span class="op" id="4451349">.</span><span class="ident" id="4451350">CommonName</span><span class="op" id="4451360">)</span>&nbsp;<span class="op" id="4451362">&gt;</span>&nbsp;<span class="num" id="4451364">0</span>&nbsp;<span class="op" id="4451366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451370">ret</span>&nbsp;<span class="op" id="4451374">=</span>&nbsp;<span class="ident" id="4451376">appendRDNs</span><span class="op" id="4451386">(</span><span class="ident" id="4451387">ret</span><span class="op" id="4451390">,</span>&nbsp;<span class="op" id="4451392">[</span><span class="op" id="4451393">]</span><span class="builtintype" id="4451394">string</span><span class="op" id="4451400">{</span><span class="ident" id="4451401">n</span><span class="op" id="4451402">.</span><span class="ident" id="4451403">CommonName</span><span class="op" id="4451413">}</span><span class="op" id="4451414">,</span>&nbsp;<span class="ident" id="4451416">oidCommonName</span><span class="op" id="4451429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4451432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451435">if</span>&nbsp;<span class="builtinfunc" id="4451438">len</span><span class="op" id="4451441">(</span><span class="ident" id="4451442">n</span><span class="op" id="4451443">.</span><span class="ident" id="4451444">SerialNumber</span><span class="op" id="4451456">)</span>&nbsp;<span class="op" id="4451458">&gt;</span>&nbsp;<span class="num" id="4451460">0</span>&nbsp;<span class="op" id="4451462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451466">ret</span>&nbsp;<span class="op" id="4451470">=</span>&nbsp;<span class="ident" id="4451472">appendRDNs</span><span class="op" id="4451482">(</span><span class="ident" id="4451483">ret</span><span class="op" id="4451486">,</span>&nbsp;<span class="op" id="4451488">[</span><span class="op" id="4451489">]</span><span class="builtintype" id="4451490">string</span><span class="op" id="4451496">{</span><span class="ident" id="4451497">n</span><span class="op" id="4451498">.</span><span class="ident" id="4451499">SerialNumber</span><span class="op" id="4451511">}</span><span class="op" id="4451512">,</span>&nbsp;<span class="ident" id="4451514">oidSerialNumber</span><span class="op" id="4451529">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4451532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451536">return</span>&nbsp;<span class="ident" id="4451543">ret</span><br>
<span class="lineno"></span><span class="op" id="4451547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4451550">//&nbsp;CertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4451626">//&nbsp;5280,&nbsp;section&nbsp;5.1.&nbsp;Use&nbsp;Certificate.CheckCRLSignature&nbsp;to&nbsp;verify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4451696">//&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4451710">type</span>&nbsp;<span class="ident" id="4451715">CertificateList</span>&nbsp;<span class="keyword" id="4451731">struct</span>&nbsp;<span class="op" id="4451738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451741">TBSCertList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4451760">TBSCertificateList</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451780">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4451799">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451820">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4451839">asn1</span><span class="op" id="4451843">.</span><span class="ident" id="4451844">BitString</span><br>
<span class="lineno"></span><span class="op" id="4451854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4451857">//&nbsp;HasExpired&nbsp;reports&nbsp;whether&nbsp;now&nbsp;is&nbsp;past&nbsp;the&nbsp;expiry&nbsp;time&nbsp;of&nbsp;certList.</span><br>
<span class="lineno">155</span><span class="keyword" id="4451928">func</span>&nbsp;<span class="op" id="4451933">(</span><span class="ident" id="4451934">certList</span>&nbsp;<span class="op" id="4451943">*</span><span class="ident" id="4451944">CertificateList</span><span class="op" id="4451959">)</span>&nbsp;<span class="ident" id="4451961">HasExpired</span><span class="op" id="4451971">(</span><span class="ident" id="4451972">now</span>&nbsp;<span class="ident" id="4451976">time</span><span class="op" id="4451980">.</span><span class="ident" id="4451981">Time</span><span class="op" id="4451985">)</span>&nbsp;<span class="builtintype" id="4451987">bool</span>&nbsp;<span class="op" id="4451992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451995">return</span>&nbsp;<span class="ident" id="4452002">now</span><span class="op" id="4452005">.</span><span class="ident" id="4452006">After</span><span class="op" id="4452011">(</span><span class="ident" id="4452012">certList</span><span class="op" id="4452020">.</span><span class="ident" id="4452021">TBSCertList</span><span class="op" id="4452032">.</span><span class="ident" id="4452033">NextUpdate</span><span class="op" id="4452043">)</span><br>
<span class="lineno"></span><span class="op" id="4452045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4452048">//&nbsp;TBSCertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno">160</span><span class="comment" id="4452127">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4452149">type</span>&nbsp;<span class="ident" id="4452154">TBSCertificateList</span>&nbsp;<span class="keyword" id="4452173">struct</span>&nbsp;<span class="op" id="4452180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452183">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4452203">asn1</span><span class="op" id="4452207">.</span><span class="ident" id="4452208">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452220">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4452240">int</span>&nbsp;<span class="string" id="4452244">`asn1:&#34;optional,default:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452273">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4452293">AlgorithmIdentifier</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452314">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4452334">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452347">ThisUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4452367">time</span><span class="op" id="4452371">.</span><span class="ident" id="4452372">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452378">NextUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4452398">time</span><span class="op" id="4452402">.</span><span class="ident" id="4452403">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4452419">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452438">RevokedCertificates</span>&nbsp;<span class="op" id="4452458">[</span><span class="op" id="4452459">]</span><span class="ident" id="4452460">RevokedCertificate</span>&nbsp;<span class="string" id="4452479">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452498">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4452518">[</span><span class="op" id="4452519">]</span><span class="ident" id="4452520">Extension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4452539">`asn1:&#34;tag:0,optional,explicit&#34;`</span><br>
<span class="lineno">170</span><span class="op" id="4452572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4452575">//&nbsp;RevokedCertificate&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4452654">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4452676">type</span>&nbsp;<span class="ident" id="4452681">RevokedCertificate</span>&nbsp;<span class="keyword" id="4452700">struct</span>&nbsp;<span class="op" id="4452707">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452710">SerialNumber</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4452725">*</span><span class="ident" id="4452726">big</span><span class="op" id="4452729">.</span><span class="ident" id="4452730">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452735">RevocationTime</span>&nbsp;<span class="ident" id="4452750">time</span><span class="op" id="4452754">.</span><span class="ident" id="4452755">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452761">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4452776">[</span><span class="op" id="4452777">]</span><span class="ident" id="4452778">Extension</span>&nbsp;<span class="string" id="4452788">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4452806">}</span>
</div>
</body>
</html>
