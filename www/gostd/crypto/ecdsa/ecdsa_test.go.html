<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6490473">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6490528">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6490582">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6490633">package</span>&nbsp;<span class="ident" id="6490641">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6490648">import</span>&nbsp;<span class="op" id="6490655">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490658">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490667">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490685">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490704">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490719">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490734">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490751">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490768">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490784">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490792">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490798">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490810">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490816">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490827">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6490837">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6490840">func</span>&nbsp;<span class="ident" id="6490845">testKeyGeneration</span><span class="op" id="6490862">(</span><span class="ident" id="6490863">t</span>&nbsp;<span class="op" id="6490865">*</span><span class="ident" id="6490866">testing</span><span class="op" id="6490873">.</span><span class="ident" id="6490874">T</span><span class="op" id="6490875">,</span>&nbsp;<span class="ident" id="6490877">c</span>&nbsp;<span class="ident" id="6490879">elliptic</span><span class="op" id="6490887">.</span><span class="ident" id="6490888">Curve</span><span class="op" id="6490893">,</span>&nbsp;<span class="ident" id="6490895">tag</span>&nbsp;<span class="builtintype" id="6490899">string</span><span class="op" id="6490905">)</span>&nbsp;<span class="op" id="6490907">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490910">priv</span><span class="op" id="6490914">,</span>&nbsp;<span class="ident" id="6490916">err</span>&nbsp;<span class="op" id="6490920">:=</span>&nbsp;<span class="ident" id="6490923">GenerateKey</span><span class="op" id="6490934">(</span><span class="ident" id="6490935">c</span><span class="op" id="6490936">,</span>&nbsp;<span class="ident" id="6490938">rand</span><span class="op" id="6490942">.</span><span class="ident" id="6490943">Reader</span><span class="op" id="6490949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490952">if</span>&nbsp;<span class="ident" id="6490955">err</span>&nbsp;<span class="op" id="6490959">!=</span>&nbsp;<span class="ident" id="6490962">nil</span>&nbsp;<span class="op" id="6490966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490970">t</span><span class="op" id="6490971">.</span><span class="ident" id="6490972">Errorf</span><span class="op" id="6490978">(</span><span class="string" id="6490979">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6490994">,</span>&nbsp;<span class="ident" id="6490996">tag</span><span class="op" id="6490999">,</span>&nbsp;<span class="ident" id="6491001">err</span><span class="op" id="6491004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491008">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491016">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491019">if</span>&nbsp;<span class="op" id="6491022">!</span><span class="ident" id="6491023">c</span><span class="op" id="6491024">.</span><span class="ident" id="6491025">IsOnCurve</span><span class="op" id="6491034">(</span><span class="ident" id="6491035">priv</span><span class="op" id="6491039">.</span><span class="ident" id="6491040">PublicKey</span><span class="op" id="6491049">.</span><span class="ident" id="6491050">X</span><span class="op" id="6491051">,</span>&nbsp;<span class="ident" id="6491053">priv</span><span class="op" id="6491057">.</span><span class="ident" id="6491058">PublicKey</span><span class="op" id="6491067">.</span><span class="ident" id="6491068">Y</span><span class="op" id="6491069">)</span>&nbsp;<span class="op" id="6491071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491075">t</span><span class="op" id="6491076">.</span><span class="ident" id="6491077">Errorf</span><span class="op" id="6491083">(</span><span class="string" id="6491084">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="6491112">,</span>&nbsp;<span class="ident" id="6491114">tag</span><span class="op" id="6491117">,</span>&nbsp;<span class="ident" id="6491119">err</span><span class="op" id="6491122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491125">}</span><br>
<span class="lineno"></span><span class="op" id="6491127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6491130">func</span>&nbsp;<span class="ident" id="6491135">TestKeyGeneration</span><span class="op" id="6491152">(</span><span class="ident" id="6491153">t</span>&nbsp;<span class="op" id="6491155">*</span><span class="ident" id="6491156">testing</span><span class="op" id="6491163">.</span><span class="ident" id="6491164">T</span><span class="op" id="6491165">)</span>&nbsp;<span class="op" id="6491167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491170">testKeyGeneration</span><span class="op" id="6491187">(</span><span class="ident" id="6491188">t</span><span class="op" id="6491189">,</span>&nbsp;<span class="ident" id="6491191">elliptic</span><span class="op" id="6491199">.</span><span class="ident" id="6491200">P224</span><span class="op" id="6491204">(</span><span class="op" id="6491205">)</span><span class="op" id="6491206">,</span>&nbsp;<span class="string" id="6491208">&#34;p224&#34;</span><span class="op" id="6491214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491217">if</span>&nbsp;<span class="ident" id="6491220">testing</span><span class="op" id="6491227">.</span><span class="ident" id="6491228">Short</span><span class="op" id="6491233">(</span><span class="op" id="6491234">)</span>&nbsp;<span class="op" id="6491236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491240">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491248">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491251">testKeyGeneration</span><span class="op" id="6491268">(</span><span class="ident" id="6491269">t</span><span class="op" id="6491270">,</span>&nbsp;<span class="ident" id="6491272">elliptic</span><span class="op" id="6491280">.</span><span class="ident" id="6491281">P256</span><span class="op" id="6491285">(</span><span class="op" id="6491286">)</span><span class="op" id="6491287">,</span>&nbsp;<span class="string" id="6491289">&#34;p256&#34;</span><span class="op" id="6491295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491298">testKeyGeneration</span><span class="op" id="6491315">(</span><span class="ident" id="6491316">t</span><span class="op" id="6491317">,</span>&nbsp;<span class="ident" id="6491319">elliptic</span><span class="op" id="6491327">.</span><span class="ident" id="6491328">P384</span><span class="op" id="6491332">(</span><span class="op" id="6491333">)</span><span class="op" id="6491334">,</span>&nbsp;<span class="string" id="6491336">&#34;p384&#34;</span><span class="op" id="6491342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491345">testKeyGeneration</span><span class="op" id="6491362">(</span><span class="ident" id="6491363">t</span><span class="op" id="6491364">,</span>&nbsp;<span class="ident" id="6491366">elliptic</span><span class="op" id="6491374">.</span><span class="ident" id="6491375">P521</span><span class="op" id="6491379">(</span><span class="op" id="6491380">)</span><span class="op" id="6491381">,</span>&nbsp;<span class="string" id="6491383">&#34;p521&#34;</span><span class="op" id="6491389">)</span><br>
<span class="lineno"></span><span class="op" id="6491391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="6491394">func</span>&nbsp;<span class="ident" id="6491399">testSignAndVerify</span><span class="op" id="6491416">(</span><span class="ident" id="6491417">t</span>&nbsp;<span class="op" id="6491419">*</span><span class="ident" id="6491420">testing</span><span class="op" id="6491427">.</span><span class="ident" id="6491428">T</span><span class="op" id="6491429">,</span>&nbsp;<span class="ident" id="6491431">c</span>&nbsp;<span class="ident" id="6491433">elliptic</span><span class="op" id="6491441">.</span><span class="ident" id="6491442">Curve</span><span class="op" id="6491447">,</span>&nbsp;<span class="ident" id="6491449">tag</span>&nbsp;<span class="builtintype" id="6491453">string</span><span class="op" id="6491459">)</span>&nbsp;<span class="op" id="6491461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491464">priv</span><span class="op" id="6491468">,</span>&nbsp;<span class="ident" id="6491470">_</span>&nbsp;<span class="op" id="6491472">:=</span>&nbsp;<span class="ident" id="6491475">GenerateKey</span><span class="op" id="6491486">(</span><span class="ident" id="6491487">c</span><span class="op" id="6491488">,</span>&nbsp;<span class="ident" id="6491490">rand</span><span class="op" id="6491494">.</span><span class="ident" id="6491495">Reader</span><span class="op" id="6491501">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491505">hashed</span>&nbsp;<span class="op" id="6491512">:=</span>&nbsp;<span class="op" id="6491515">[</span><span class="op" id="6491516">]</span><span class="builtintype" id="6491517">byte</span><span class="op" id="6491521">(</span><span class="string" id="6491522">&#34;testing&#34;</span><span class="op" id="6491531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491534">r</span><span class="op" id="6491535">,</span>&nbsp;<span class="ident" id="6491537">s</span><span class="op" id="6491538">,</span>&nbsp;<span class="ident" id="6491540">err</span>&nbsp;<span class="op" id="6491544">:=</span>&nbsp;<span class="ident" id="6491547">Sign</span><span class="op" id="6491551">(</span><span class="ident" id="6491552">rand</span><span class="op" id="6491556">.</span><span class="ident" id="6491557">Reader</span><span class="op" id="6491563">,</span>&nbsp;<span class="ident" id="6491565">priv</span><span class="op" id="6491569">,</span>&nbsp;<span class="ident" id="6491571">hashed</span><span class="op" id="6491577">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491580">if</span>&nbsp;<span class="ident" id="6491583">err</span>&nbsp;<span class="op" id="6491587">!=</span>&nbsp;<span class="ident" id="6491590">nil</span>&nbsp;<span class="op" id="6491594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491598">t</span><span class="op" id="6491599">.</span><span class="ident" id="6491600">Errorf</span><span class="op" id="6491606">(</span><span class="string" id="6491607">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="6491630">,</span>&nbsp;<span class="ident" id="6491632">tag</span><span class="op" id="6491635">,</span>&nbsp;<span class="ident" id="6491637">err</span><span class="op" id="6491640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491644">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491656">if</span>&nbsp;<span class="op" id="6491659">!</span><span class="ident" id="6491660">Verify</span><span class="op" id="6491666">(</span><span class="op" id="6491667">&amp;</span><span class="ident" id="6491668">priv</span><span class="op" id="6491672">.</span><span class="ident" id="6491673">PublicKey</span><span class="op" id="6491682">,</span>&nbsp;<span class="ident" id="6491684">hashed</span><span class="op" id="6491690">,</span>&nbsp;<span class="ident" id="6491692">r</span><span class="op" id="6491693">,</span>&nbsp;<span class="ident" id="6491695">s</span><span class="op" id="6491696">)</span>&nbsp;<span class="op" id="6491698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491702">t</span><span class="op" id="6491703">.</span><span class="ident" id="6491704">Errorf</span><span class="op" id="6491710">(</span><span class="string" id="6491711">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="6491730">,</span>&nbsp;<span class="ident" id="6491732">tag</span><span class="op" id="6491735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491742">hashed</span><span class="op" id="6491748">[</span><span class="num" id="6491749">0</span><span class="op" id="6491750">]</span>&nbsp;<span class="op" id="6491752">^=</span>&nbsp;<span class="num" id="6491755">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491761">if</span>&nbsp;<span class="ident" id="6491764">Verify</span><span class="op" id="6491770">(</span><span class="op" id="6491771">&amp;</span><span class="ident" id="6491772">priv</span><span class="op" id="6491776">.</span><span class="ident" id="6491777">PublicKey</span><span class="op" id="6491786">,</span>&nbsp;<span class="ident" id="6491788">hashed</span><span class="op" id="6491794">,</span>&nbsp;<span class="ident" id="6491796">r</span><span class="op" id="6491797">,</span>&nbsp;<span class="ident" id="6491799">s</span><span class="op" id="6491800">)</span>&nbsp;<span class="op" id="6491802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491806">t</span><span class="op" id="6491807">.</span><span class="ident" id="6491808">Errorf</span><span class="op" id="6491814">(</span><span class="string" id="6491815">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="6491841">,</span>&nbsp;<span class="ident" id="6491843">tag</span><span class="op" id="6491846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491849">}</span><br>
<span class="lineno"></span><span class="op" id="6491851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6491854">func</span>&nbsp;<span class="ident" id="6491859">TestSignAndVerify</span><span class="op" id="6491876">(</span><span class="ident" id="6491877">t</span>&nbsp;<span class="op" id="6491879">*</span><span class="ident" id="6491880">testing</span><span class="op" id="6491887">.</span><span class="ident" id="6491888">T</span><span class="op" id="6491889">)</span>&nbsp;<span class="op" id="6491891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491894">testSignAndVerify</span><span class="op" id="6491911">(</span><span class="ident" id="6491912">t</span><span class="op" id="6491913">,</span>&nbsp;<span class="ident" id="6491915">elliptic</span><span class="op" id="6491923">.</span><span class="ident" id="6491924">P224</span><span class="op" id="6491928">(</span><span class="op" id="6491929">)</span><span class="op" id="6491930">,</span>&nbsp;<span class="string" id="6491932">&#34;p224&#34;</span><span class="op" id="6491938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491941">if</span>&nbsp;<span class="ident" id="6491944">testing</span><span class="op" id="6491951">.</span><span class="ident" id="6491952">Short</span><span class="op" id="6491957">(</span><span class="op" id="6491958">)</span>&nbsp;<span class="op" id="6491960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491964">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491972">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491975">testSignAndVerify</span><span class="op" id="6491992">(</span><span class="ident" id="6491993">t</span><span class="op" id="6491994">,</span>&nbsp;<span class="ident" id="6491996">elliptic</span><span class="op" id="6492004">.</span><span class="ident" id="6492005">P256</span><span class="op" id="6492009">(</span><span class="op" id="6492010">)</span><span class="op" id="6492011">,</span>&nbsp;<span class="string" id="6492013">&#34;p256&#34;</span><span class="op" id="6492019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492022">testSignAndVerify</span><span class="op" id="6492039">(</span><span class="ident" id="6492040">t</span><span class="op" id="6492041">,</span>&nbsp;<span class="ident" id="6492043">elliptic</span><span class="op" id="6492051">.</span><span class="ident" id="6492052">P384</span><span class="op" id="6492056">(</span><span class="op" id="6492057">)</span><span class="op" id="6492058">,</span>&nbsp;<span class="string" id="6492060">&#34;p384&#34;</span><span class="op" id="6492066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492069">testSignAndVerify</span><span class="op" id="6492086">(</span><span class="ident" id="6492087">t</span><span class="op" id="6492088">,</span>&nbsp;<span class="ident" id="6492090">elliptic</span><span class="op" id="6492098">.</span><span class="ident" id="6492099">P521</span><span class="op" id="6492103">(</span><span class="op" id="6492104">)</span><span class="op" id="6492105">,</span>&nbsp;<span class="string" id="6492107">&#34;p521&#34;</span><span class="op" id="6492113">)</span><br>
<span class="lineno"></span><span class="op" id="6492115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="6492118">func</span>&nbsp;<span class="ident" id="6492123">fromHex</span><span class="op" id="6492130">(</span><span class="ident" id="6492131">s</span>&nbsp;<span class="builtintype" id="6492133">string</span><span class="op" id="6492139">)</span>&nbsp;<span class="op" id="6492141">*</span><span class="ident" id="6492142">big</span><span class="op" id="6492145">.</span><span class="ident" id="6492146">Int</span>&nbsp;<span class="op" id="6492150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492153">r</span><span class="op" id="6492154">,</span>&nbsp;<span class="ident" id="6492156">ok</span>&nbsp;<span class="op" id="6492159">:=</span>&nbsp;<span class="builtinfunc" id="6492162">new</span><span class="op" id="6492165">(</span><span class="ident" id="6492166">big</span><span class="op" id="6492169">.</span><span class="ident" id="6492170">Int</span><span class="op" id="6492173">)</span><span class="op" id="6492174">.</span><span class="ident" id="6492175">SetString</span><span class="op" id="6492184">(</span><span class="ident" id="6492185">s</span><span class="op" id="6492186">,</span>&nbsp;<span class="num" id="6492188">16</span><span class="op" id="6492190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492193">if</span>&nbsp;<span class="op" id="6492196">!</span><span class="ident" id="6492197">ok</span>&nbsp;<span class="op" id="6492200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6492204">panic</span><span class="op" id="6492209">(</span><span class="string" id="6492210">&#34;bad&nbsp;hex&#34;</span><span class="op" id="6492219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492222">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492225">return</span>&nbsp;<span class="ident" id="6492232">r</span><br>
<span class="lineno"></span><span class="op" id="6492234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6492237">func</span>&nbsp;<span class="ident" id="6492242">TestVectors</span><span class="op" id="6492253">(</span><span class="ident" id="6492254">t</span>&nbsp;<span class="op" id="6492256">*</span><span class="ident" id="6492257">testing</span><span class="op" id="6492264">.</span><span class="ident" id="6492265">T</span><span class="op" id="6492266">)</span>&nbsp;<span class="op" id="6492268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6492271">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6492329">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6492410">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6492414">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6492481">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492534">if</span>&nbsp;<span class="ident" id="6492537">testing</span><span class="op" id="6492544">.</span><span class="ident" id="6492545">Short</span><span class="op" id="6492550">(</span><span class="op" id="6492551">)</span>&nbsp;<span class="op" id="6492553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492557">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492569">f</span><span class="op" id="6492570">,</span>&nbsp;<span class="ident" id="6492572">err</span>&nbsp;<span class="op" id="6492576">:=</span>&nbsp;<span class="ident" id="6492579">os</span><span class="op" id="6492581">.</span><span class="ident" id="6492582">Open</span><span class="op" id="6492586">(</span><span class="string" id="6492587">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="6492612">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492615">if</span>&nbsp;<span class="ident" id="6492618">err</span>&nbsp;<span class="op" id="6492622">!=</span>&nbsp;<span class="ident" id="6492625">nil</span>&nbsp;<span class="op" id="6492629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492633">t</span><span class="op" id="6492634">.</span><span class="ident" id="6492635">Fatal</span><span class="op" id="6492640">(</span><span class="ident" id="6492641">err</span><span class="op" id="6492644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492651">buf</span>&nbsp;<span class="op" id="6492655">:=</span>&nbsp;<span class="ident" id="6492658">bufio</span><span class="op" id="6492663">.</span><span class="ident" id="6492664">NewReader</span><span class="op" id="6492673">(</span><span class="ident" id="6492674">bzip2</span><span class="op" id="6492679">.</span><span class="ident" id="6492680">NewReader</span><span class="op" id="6492689">(</span><span class="ident" id="6492690">f</span><span class="op" id="6492691">)</span><span class="op" id="6492692">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492696">lineNo</span>&nbsp;<span class="op" id="6492703">:=</span>&nbsp;<span class="num" id="6492706">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492709">var</span>&nbsp;<span class="ident" id="6492713">h</span>&nbsp;<span class="ident" id="6492715">hash</span><span class="op" id="6492719">.</span><span class="ident" id="6492720">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492726">var</span>&nbsp;<span class="ident" id="6492730">msg</span>&nbsp;<span class="op" id="6492734">[</span><span class="op" id="6492735">]</span><span class="builtintype" id="6492736">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492742">var</span>&nbsp;<span class="ident" id="6492746">hashed</span>&nbsp;<span class="op" id="6492753">[</span><span class="op" id="6492754">]</span><span class="builtintype" id="6492755">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492761">var</span>&nbsp;<span class="ident" id="6492765">r</span><span class="op" id="6492766">,</span>&nbsp;<span class="ident" id="6492768">s</span>&nbsp;<span class="op" id="6492770">*</span><span class="ident" id="6492771">big</span><span class="op" id="6492774">.</span><span class="ident" id="6492775">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492780">pub</span>&nbsp;<span class="op" id="6492784">:=</span>&nbsp;<span class="builtinfunc" id="6492787">new</span><span class="op" id="6492790">(</span><span class="ident" id="6492791">PublicKey</span><span class="op" id="6492800">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492804">for</span>&nbsp;<span class="op" id="6492808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492812">line</span><span class="op" id="6492816">,</span>&nbsp;<span class="ident" id="6492818">err</span>&nbsp;<span class="op" id="6492822">:=</span>&nbsp;<span class="ident" id="6492825">buf</span><span class="op" id="6492828">.</span><span class="ident" id="6492829">ReadString</span><span class="op" id="6492839">(</span><span class="string" id="6492840">&#39;\n&#39;</span><span class="op" id="6492844">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492848">if</span>&nbsp;<span class="builtinfunc" id="6492851">len</span><span class="op" id="6492854">(</span><span class="ident" id="6492855">line</span><span class="op" id="6492859">)</span>&nbsp;<span class="op" id="6492861">==</span>&nbsp;<span class="num" id="6492864">0</span>&nbsp;<span class="op" id="6492866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492871">if</span>&nbsp;<span class="ident" id="6492874">err</span>&nbsp;<span class="op" id="6492878">==</span>&nbsp;<span class="ident" id="6492881">io</span><span class="op" id="6492883">.</span><span class="ident" id="6492884">EOF</span>&nbsp;<span class="op" id="6492888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492894">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492908">t</span><span class="op" id="6492909">.</span><span class="ident" id="6492910">Fatalf</span><span class="op" id="6492916">(</span><span class="string" id="6492917">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="6492947">,</span>&nbsp;<span class="ident" id="6492949">err</span><span class="op" id="6492952">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492960">lineNo</span><span class="op" id="6492966">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6492971">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493022">if</span>&nbsp;<span class="op" id="6493025">!</span><span class="ident" id="6493026">strings</span><span class="op" id="6493033">.</span><span class="ident" id="6493034">HasSuffix</span><span class="op" id="6493043">(</span><span class="ident" id="6493044">line</span><span class="op" id="6493048">,</span>&nbsp;<span class="string" id="6493050">&#34;\r\n&#34;</span><span class="op" id="6493056">)</span>&nbsp;<span class="op" id="6493058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493063">t</span><span class="op" id="6493064">.</span><span class="ident" id="6493065">Fatalf</span><span class="op" id="6493071">(</span><span class="string" id="6493072">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="6493118">,</span>&nbsp;<span class="ident" id="6493120">lineNo</span><span class="op" id="6493126">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493134">line</span>&nbsp;<span class="op" id="6493139">=</span>&nbsp;<span class="ident" id="6493141">line</span><span class="op" id="6493145">[</span><span class="op" id="6493146">:</span><span class="builtinfunc" id="6493147">len</span><span class="op" id="6493150">(</span><span class="ident" id="6493151">line</span><span class="op" id="6493155">)</span><span class="op" id="6493156">-</span><span class="num" id="6493157">2</span><span class="op" id="6493158">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493163">if</span>&nbsp;<span class="builtinfunc" id="6493166">len</span><span class="op" id="6493169">(</span><span class="ident" id="6493170">line</span><span class="op" id="6493174">)</span>&nbsp;<span class="op" id="6493176">==</span>&nbsp;<span class="num" id="6493179">0</span>&nbsp;<span class="op" id="6493181">||</span>&nbsp;<span class="ident" id="6493184">line</span><span class="op" id="6493188">[</span><span class="num" id="6493189">0</span><span class="op" id="6493190">]</span>&nbsp;<span class="op" id="6493192">==</span>&nbsp;<span class="string" id="6493195">&#39;#&#39;</span>&nbsp;<span class="op" id="6493199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493204">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493220">if</span>&nbsp;<span class="ident" id="6493223">line</span><span class="op" id="6493227">[</span><span class="num" id="6493228">0</span><span class="op" id="6493229">]</span>&nbsp;<span class="op" id="6493231">==</span>&nbsp;<span class="string" id="6493234">&#39;[&#39;</span>&nbsp;<span class="op" id="6493238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493243">line</span>&nbsp;<span class="op" id="6493248">=</span>&nbsp;<span class="ident" id="6493250">line</span><span class="op" id="6493254">[</span><span class="num" id="6493255">1</span>&nbsp;<span class="op" id="6493257">:</span>&nbsp;<span class="builtinfunc" id="6493259">len</span><span class="op" id="6493262">(</span><span class="ident" id="6493263">line</span><span class="op" id="6493267">)</span><span class="op" id="6493268">-</span><span class="num" id="6493269">1</span><span class="op" id="6493270">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493275">parts</span>&nbsp;<span class="op" id="6493281">:=</span>&nbsp;<span class="ident" id="6493284">strings</span><span class="op" id="6493291">.</span><span class="ident" id="6493292">SplitN</span><span class="op" id="6493298">(</span><span class="ident" id="6493299">line</span><span class="op" id="6493303">,</span>&nbsp;<span class="string" id="6493305">&#34;,&#34;</span><span class="op" id="6493308">,</span>&nbsp;<span class="num" id="6493310">2</span><span class="op" id="6493311">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493317">switch</span>&nbsp;<span class="ident" id="6493324">parts</span><span class="op" id="6493329">[</span><span class="num" id="6493330">0</span><span class="op" id="6493331">]</span>&nbsp;<span class="op" id="6493333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493338">case</span>&nbsp;<span class="string" id="6493343">&#34;P-224&#34;</span><span class="op" id="6493350">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493356">pub</span><span class="op" id="6493359">.</span><span class="ident" id="6493360">Curve</span>&nbsp;<span class="op" id="6493366">=</span>&nbsp;<span class="ident" id="6493368">elliptic</span><span class="op" id="6493376">.</span><span class="ident" id="6493377">P224</span><span class="op" id="6493381">(</span><span class="op" id="6493382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493387">case</span>&nbsp;<span class="string" id="6493392">&#34;P-256&#34;</span><span class="op" id="6493399">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493405">pub</span><span class="op" id="6493408">.</span><span class="ident" id="6493409">Curve</span>&nbsp;<span class="op" id="6493415">=</span>&nbsp;<span class="ident" id="6493417">elliptic</span><span class="op" id="6493425">.</span><span class="ident" id="6493426">P256</span><span class="op" id="6493430">(</span><span class="op" id="6493431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493436">case</span>&nbsp;<span class="string" id="6493441">&#34;P-384&#34;</span><span class="op" id="6493448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493454">pub</span><span class="op" id="6493457">.</span><span class="ident" id="6493458">Curve</span>&nbsp;<span class="op" id="6493464">=</span>&nbsp;<span class="ident" id="6493466">elliptic</span><span class="op" id="6493474">.</span><span class="ident" id="6493475">P384</span><span class="op" id="6493479">(</span><span class="op" id="6493480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493485">case</span>&nbsp;<span class="string" id="6493490">&#34;P-521&#34;</span><span class="op" id="6493497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493503">pub</span><span class="op" id="6493506">.</span><span class="ident" id="6493507">Curve</span>&nbsp;<span class="op" id="6493513">=</span>&nbsp;<span class="ident" id="6493515">elliptic</span><span class="op" id="6493523">.</span><span class="ident" id="6493524">P521</span><span class="op" id="6493528">(</span><span class="op" id="6493529">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493534">default</span><span class="op" id="6493541">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493547">pub</span><span class="op" id="6493550">.</span><span class="ident" id="6493551">Curve</span>&nbsp;<span class="op" id="6493557">=</span>&nbsp;<span class="ident" id="6493559">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493572">switch</span>&nbsp;<span class="ident" id="6493579">parts</span><span class="op" id="6493584">[</span><span class="num" id="6493585">1</span><span class="op" id="6493586">]</span>&nbsp;<span class="op" id="6493588">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493593">case</span>&nbsp;<span class="string" id="6493598">&#34;SHA-1&#34;</span><span class="op" id="6493605">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493611">h</span>&nbsp;<span class="op" id="6493613">=</span>&nbsp;<span class="ident" id="6493615">sha1</span><span class="op" id="6493619">.</span><span class="ident" id="6493620">New</span><span class="op" id="6493623">(</span><span class="op" id="6493624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493629">case</span>&nbsp;<span class="string" id="6493634">&#34;SHA-224&#34;</span><span class="op" id="6493643">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493649">h</span>&nbsp;<span class="op" id="6493651">=</span>&nbsp;<span class="ident" id="6493653">sha256</span><span class="op" id="6493659">.</span><span class="ident" id="6493660">New224</span><span class="op" id="6493666">(</span><span class="op" id="6493667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493672">case</span>&nbsp;<span class="string" id="6493677">&#34;SHA-256&#34;</span><span class="op" id="6493686">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493692">h</span>&nbsp;<span class="op" id="6493694">=</span>&nbsp;<span class="ident" id="6493696">sha256</span><span class="op" id="6493702">.</span><span class="ident" id="6493703">New</span><span class="op" id="6493706">(</span><span class="op" id="6493707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493712">case</span>&nbsp;<span class="string" id="6493717">&#34;SHA-384&#34;</span><span class="op" id="6493726">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493732">h</span>&nbsp;<span class="op" id="6493734">=</span>&nbsp;<span class="ident" id="6493736">sha512</span><span class="op" id="6493742">.</span><span class="ident" id="6493743">New384</span><span class="op" id="6493749">(</span><span class="op" id="6493750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493755">case</span>&nbsp;<span class="string" id="6493760">&#34;SHA-512&#34;</span><span class="op" id="6493769">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493775">h</span>&nbsp;<span class="op" id="6493777">=</span>&nbsp;<span class="ident" id="6493779">sha512</span><span class="op" id="6493785">.</span><span class="ident" id="6493786">New</span><span class="op" id="6493789">(</span><span class="op" id="6493790">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493795">default</span><span class="op" id="6493802">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493808">h</span>&nbsp;<span class="op" id="6493810">=</span>&nbsp;<span class="ident" id="6493812">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493825">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493841">if</span>&nbsp;<span class="ident" id="6493844">h</span>&nbsp;<span class="op" id="6493846">==</span>&nbsp;<span class="ident" id="6493849">nil</span>&nbsp;<span class="op" id="6493853">||</span>&nbsp;<span class="ident" id="6493856">pub</span><span class="op" id="6493859">.</span><span class="ident" id="6493860">Curve</span>&nbsp;<span class="op" id="6493866">==</span>&nbsp;<span class="ident" id="6493869">nil</span>&nbsp;<span class="op" id="6493873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493878">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493889">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493894">switch</span>&nbsp;<span class="op" id="6493901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493905">case</span>&nbsp;<span class="ident" id="6493910">strings</span><span class="op" id="6493917">.</span><span class="ident" id="6493918">HasPrefix</span><span class="op" id="6493927">(</span><span class="ident" id="6493928">line</span><span class="op" id="6493932">,</span>&nbsp;<span class="string" id="6493934">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="6493942">)</span><span class="op" id="6493943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493948">if</span>&nbsp;<span class="ident" id="6493951">msg</span><span class="op" id="6493954">,</span>&nbsp;<span class="ident" id="6493956">err</span>&nbsp;<span class="op" id="6493960">=</span>&nbsp;<span class="ident" id="6493962">hex</span><span class="op" id="6493965">.</span><span class="ident" id="6493966">DecodeString</span><span class="op" id="6493978">(</span><span class="ident" id="6493979">line</span><span class="op" id="6493983">[</span><span class="num" id="6493984">6</span><span class="op" id="6493985">:</span><span class="op" id="6493986">]</span><span class="op" id="6493987">)</span><span class="op" id="6493988">;</span>&nbsp;<span class="ident" id="6493990">err</span>&nbsp;<span class="op" id="6493994">!=</span>&nbsp;<span class="ident" id="6493997">nil</span>&nbsp;<span class="op" id="6494001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494007">t</span><span class="op" id="6494008">.</span><span class="ident" id="6494009">Fatalf</span><span class="op" id="6494015">(</span><span class="string" id="6494016">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="6494057">,</span>&nbsp;<span class="ident" id="6494059">lineNo</span><span class="op" id="6494065">,</span>&nbsp;<span class="ident" id="6494067">err</span><span class="op" id="6494070">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494079">case</span>&nbsp;<span class="ident" id="6494084">strings</span><span class="op" id="6494091">.</span><span class="ident" id="6494092">HasPrefix</span><span class="op" id="6494101">(</span><span class="ident" id="6494102">line</span><span class="op" id="6494106">,</span>&nbsp;<span class="string" id="6494108">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="6494115">)</span><span class="op" id="6494116">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494121">pub</span><span class="op" id="6494124">.</span><span class="ident" id="6494125">X</span>&nbsp;<span class="op" id="6494127">=</span>&nbsp;<span class="ident" id="6494129">fromHex</span><span class="op" id="6494136">(</span><span class="ident" id="6494137">line</span><span class="op" id="6494141">[</span><span class="num" id="6494142">5</span><span class="op" id="6494143">:</span><span class="op" id="6494144">]</span><span class="op" id="6494145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494149">case</span>&nbsp;<span class="ident" id="6494154">strings</span><span class="op" id="6494161">.</span><span class="ident" id="6494162">HasPrefix</span><span class="op" id="6494171">(</span><span class="ident" id="6494172">line</span><span class="op" id="6494176">,</span>&nbsp;<span class="string" id="6494178">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="6494185">)</span><span class="op" id="6494186">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494191">pub</span><span class="op" id="6494194">.</span><span class="ident" id="6494195">Y</span>&nbsp;<span class="op" id="6494197">=</span>&nbsp;<span class="ident" id="6494199">fromHex</span><span class="op" id="6494206">(</span><span class="ident" id="6494207">line</span><span class="op" id="6494211">[</span><span class="num" id="6494212">5</span><span class="op" id="6494213">:</span><span class="op" id="6494214">]</span><span class="op" id="6494215">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494219">case</span>&nbsp;<span class="ident" id="6494224">strings</span><span class="op" id="6494231">.</span><span class="ident" id="6494232">HasPrefix</span><span class="op" id="6494241">(</span><span class="ident" id="6494242">line</span><span class="op" id="6494246">,</span>&nbsp;<span class="string" id="6494248">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="6494254">)</span><span class="op" id="6494255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494260">r</span>&nbsp;<span class="op" id="6494262">=</span>&nbsp;<span class="ident" id="6494264">fromHex</span><span class="op" id="6494271">(</span><span class="ident" id="6494272">line</span><span class="op" id="6494276">[</span><span class="num" id="6494277">4</span><span class="op" id="6494278">:</span><span class="op" id="6494279">]</span><span class="op" id="6494280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494284">case</span>&nbsp;<span class="ident" id="6494289">strings</span><span class="op" id="6494296">.</span><span class="ident" id="6494297">HasPrefix</span><span class="op" id="6494306">(</span><span class="ident" id="6494307">line</span><span class="op" id="6494311">,</span>&nbsp;<span class="string" id="6494313">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="6494319">)</span><span class="op" id="6494320">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494325">s</span>&nbsp;<span class="op" id="6494327">=</span>&nbsp;<span class="ident" id="6494329">fromHex</span><span class="op" id="6494336">(</span><span class="ident" id="6494337">line</span><span class="op" id="6494341">[</span><span class="num" id="6494342">4</span><span class="op" id="6494343">:</span><span class="op" id="6494344">]</span><span class="op" id="6494345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494349">case</span>&nbsp;<span class="ident" id="6494354">strings</span><span class="op" id="6494361">.</span><span class="ident" id="6494362">HasPrefix</span><span class="op" id="6494371">(</span><span class="ident" id="6494372">line</span><span class="op" id="6494376">,</span>&nbsp;<span class="string" id="6494378">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="6494389">)</span><span class="op" id="6494390">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494395">expected</span>&nbsp;<span class="op" id="6494404">:=</span>&nbsp;<span class="ident" id="6494407">line</span><span class="op" id="6494411">[</span><span class="num" id="6494412">9</span><span class="op" id="6494413">]</span>&nbsp;<span class="op" id="6494415">==</span>&nbsp;<span class="string" id="6494418">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494425">h</span><span class="op" id="6494426">.</span><span class="ident" id="6494427">Reset</span><span class="op" id="6494432">(</span><span class="op" id="6494433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494438">h</span><span class="op" id="6494439">.</span><span class="ident" id="6494440">Write</span><span class="op" id="6494445">(</span><span class="ident" id="6494446">msg</span><span class="op" id="6494449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494454">hashed</span>&nbsp;<span class="op" id="6494461">:=</span>&nbsp;<span class="ident" id="6494464">h</span><span class="op" id="6494465">.</span><span class="ident" id="6494466">Sum</span><span class="op" id="6494469">(</span><span class="ident" id="6494470">hashed</span><span class="op" id="6494476">[</span><span class="op" id="6494477">:</span><span class="num" id="6494478">0</span><span class="op" id="6494479">]</span><span class="op" id="6494480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494485">if</span>&nbsp;<span class="ident" id="6494488">Verify</span><span class="op" id="6494494">(</span><span class="ident" id="6494495">pub</span><span class="op" id="6494498">,</span>&nbsp;<span class="ident" id="6494500">hashed</span><span class="op" id="6494506">,</span>&nbsp;<span class="ident" id="6494508">r</span><span class="op" id="6494509">,</span>&nbsp;<span class="ident" id="6494511">s</span><span class="op" id="6494512">)</span>&nbsp;<span class="op" id="6494514">!=</span>&nbsp;<span class="ident" id="6494517">expected</span>&nbsp;<span class="op" id="6494526">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494532">t</span><span class="op" id="6494533">.</span><span class="ident" id="6494534">Fatalf</span><span class="op" id="6494540">(</span><span class="string" id="6494541">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="6494570">,</span>&nbsp;<span class="ident" id="6494572">lineNo</span><span class="op" id="6494578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494587">default</span><span class="op" id="6494594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494599">t</span><span class="op" id="6494600">.</span><span class="ident" id="6494601">Fatalf</span><span class="op" id="6494607">(</span><span class="string" id="6494608">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="6494641">,</span>&nbsp;<span class="ident" id="6494643">lineNo</span><span class="op" id="6494649">,</span>&nbsp;<span class="ident" id="6494651">line</span><span class="op" id="6494655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494659">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494662">}</span><br>
<span class="lineno"></span><span class="op" id="6494664">}</span>
</div>
</body>
</html>
