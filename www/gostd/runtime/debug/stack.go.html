<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html" class="current">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5845477">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5845532">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5845586">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5845637">//&nbsp;Package&nbsp;debug&nbsp;contains&nbsp;facilities&nbsp;for&nbsp;programs&nbsp;to&nbsp;debug&nbsp;themselves&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="5845713">//&nbsp;they&nbsp;are&nbsp;running.</span><br>
<span class="lineno"></span><span class="keyword" id="5845734">package</span>&nbsp;<span class="ident" id="5845742">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5845749">import</span>&nbsp;<span class="op" id="5845756">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5845759">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5845768">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5845775">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5845788">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5845794">&#34;runtime&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5845804">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5845807">var</span>&nbsp;<span class="op" id="5845811">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845814">dunno</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5845824">=</span>&nbsp;<span class="op" id="5845826">[</span><span class="op" id="5845827">]</span><span class="builtintype" id="5845828">byte</span><span class="op" id="5845832">(</span><span class="string" id="5845833">&#34;???&#34;</span><span class="op" id="5845838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845841">centerDot</span>&nbsp;<span class="op" id="5845851">=</span>&nbsp;<span class="op" id="5845853">[</span><span class="op" id="5845854">]</span><span class="builtintype" id="5845855">byte</span><span class="op" id="5845859">(</span><span class="string" id="5845860">&#34;·&#34;</span><span class="op" id="5845864">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845867">dot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5845877">=</span>&nbsp;<span class="op" id="5845879">[</span><span class="op" id="5845880">]</span><span class="builtintype" id="5845881">byte</span><span class="op" id="5845885">(</span><span class="string" id="5845886">&#34;.&#34;</span><span class="op" id="5845889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845892">slash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5845902">=</span>&nbsp;<span class="op" id="5845904">[</span><span class="op" id="5845905">]</span><span class="builtintype" id="5845906">byte</span><span class="op" id="5845910">(</span><span class="string" id="5845911">&#34;/&#34;</span><span class="op" id="5845914">)</span><br>
<span class="lineno"></span><span class="op" id="5845916">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5845919">//&nbsp;PrintStack&nbsp;prints&nbsp;to&nbsp;standard&nbsp;error&nbsp;the&nbsp;stack&nbsp;trace&nbsp;returned&nbsp;by&nbsp;Stack.</span><br>
<span class="lineno">25</span><span class="keyword" id="5845993">func</span>&nbsp;<span class="ident" id="5845998">PrintStack</span><span class="op" id="5846008">(</span><span class="op" id="5846009">)</span>&nbsp;<span class="op" id="5846011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846014">os</span><span class="op" id="5846016">.</span><span class="ident" id="5846017">Stderr</span><span class="op" id="5846023">.</span><span class="ident" id="5846024">Write</span><span class="op" id="5846029">(</span><span class="ident" id="5846030">stack</span><span class="op" id="5846035">(</span><span class="op" id="5846036">)</span><span class="op" id="5846037">)</span><br>
<span class="lineno"></span><span class="op" id="5846039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5846042">//&nbsp;Stack&nbsp;returns&nbsp;a&nbsp;formatted&nbsp;stack&nbsp;trace&nbsp;of&nbsp;the&nbsp;goroutine&nbsp;that&nbsp;calls&nbsp;it.</span><br>
<span class="lineno">30</span><span class="comment" id="5846115">//&nbsp;For&nbsp;each&nbsp;routine,&nbsp;it&nbsp;includes&nbsp;the&nbsp;source&nbsp;line&nbsp;information&nbsp;and&nbsp;PC&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="5846190">//&nbsp;then&nbsp;attempts&nbsp;to&nbsp;discover,&nbsp;for&nbsp;Go&nbsp;functions,&nbsp;the&nbsp;calling&nbsp;function&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5846262">//&nbsp;method&nbsp;and&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;line&nbsp;containing&nbsp;the&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="comment" id="5846324">//</span><br>
<span class="lineno"></span><span class="comment" id="5846327">//&nbsp;This&nbsp;function&nbsp;is&nbsp;deprecated.&nbsp;Use&nbsp;package&nbsp;runtime&#39;s&nbsp;Stack&nbsp;instead.</span><br>
<span class="lineno">35</span><span class="keyword" id="5846396">func</span>&nbsp;<span class="ident" id="5846401">Stack</span><span class="op" id="5846406">(</span><span class="op" id="5846407">)</span>&nbsp;<span class="op" id="5846409">[</span><span class="op" id="5846410">]</span><span class="builtintype" id="5846411">byte</span>&nbsp;<span class="op" id="5846416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846419">return</span>&nbsp;<span class="ident" id="5846426">stack</span><span class="op" id="5846431">(</span><span class="op" id="5846432">)</span><br>
<span class="lineno"></span><span class="op" id="5846434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5846437">//&nbsp;stack&nbsp;implements&nbsp;Stack,&nbsp;skipping&nbsp;2&nbsp;frames</span><br>
<span class="lineno">40</span><span class="keyword" id="5846482">func</span>&nbsp;<span class="ident" id="5846487">stack</span><span class="op" id="5846492">(</span><span class="op" id="5846493">)</span>&nbsp;<span class="op" id="5846495">[</span><span class="op" id="5846496">]</span><span class="builtintype" id="5846497">byte</span>&nbsp;<span class="op" id="5846502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846505">buf</span>&nbsp;<span class="op" id="5846509">:=</span>&nbsp;<span class="builtinfunc" id="5846512">new</span><span class="op" id="5846515">(</span><span class="ident" id="5846516">bytes</span><span class="op" id="5846521">.</span><span class="ident" id="5846522">Buffer</span><span class="op" id="5846528">)</span>&nbsp;<span class="comment" id="5846530">//&nbsp;the&nbsp;returned&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846552">//&nbsp;As&nbsp;we&nbsp;loop,&nbsp;we&nbsp;open&nbsp;files&nbsp;and&nbsp;read&nbsp;them.&nbsp;These&nbsp;variables&nbsp;record&nbsp;the&nbsp;currently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846634">//&nbsp;loaded&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846651">var</span>&nbsp;<span class="ident" id="5846655">lines</span>&nbsp;<span class="op" id="5846661">[</span><span class="op" id="5846662">]</span><span class="op" id="5846663">[</span><span class="op" id="5846664">]</span><span class="builtintype" id="5846665">byte</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846671">var</span>&nbsp;<span class="ident" id="5846675">lastFile</span>&nbsp;<span class="builtintype" id="5846684">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846692">for</span>&nbsp;<span class="ident" id="5846696">i</span>&nbsp;<span class="op" id="5846698">:=</span>&nbsp;<span class="num" id="5846701">2</span><span class="op" id="5846702">;</span>&nbsp;<span class="op" id="5846704">;</span>&nbsp;<span class="ident" id="5846706">i</span><span class="op" id="5846707">++</span>&nbsp;<span class="op" id="5846710">{</span>&nbsp;<span class="comment" id="5846712">//&nbsp;Caller&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;user,&nbsp;2&nbsp;frames&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846763">pc</span><span class="op" id="5846765">,</span>&nbsp;<span class="ident" id="5846767">file</span><span class="op" id="5846771">,</span>&nbsp;<span class="ident" id="5846773">line</span><span class="op" id="5846777">,</span>&nbsp;<span class="ident" id="5846779">ok</span>&nbsp;<span class="op" id="5846782">:=</span>&nbsp;<span class="ident" id="5846785">runtime</span><span class="op" id="5846792">.</span><span class="ident" id="5846793">Caller</span><span class="op" id="5846799">(</span><span class="ident" id="5846800">i</span><span class="op" id="5846801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846805">if</span>&nbsp;<span class="op" id="5846808">!</span><span class="ident" id="5846809">ok</span>&nbsp;<span class="op" id="5846812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846817">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5846825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846829">//&nbsp;Print&nbsp;this&nbsp;much&nbsp;at&nbsp;least.&nbsp;&nbsp;If&nbsp;we&nbsp;can&#39;t&nbsp;find&nbsp;the&nbsp;source,&nbsp;it&nbsp;won&#39;t&nbsp;show.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846905">fmt</span><span class="op" id="5846908">.</span><span class="ident" id="5846909">Fprintf</span><span class="op" id="5846916">(</span><span class="ident" id="5846917">buf</span><span class="op" id="5846920">,</span>&nbsp;<span class="string" id="5846922">&#34;%s:%d&nbsp;(0x%x)\n&#34;</span><span class="op" id="5846938">,</span>&nbsp;<span class="ident" id="5846940">file</span><span class="op" id="5846944">,</span>&nbsp;<span class="ident" id="5846946">line</span><span class="op" id="5846950">,</span>&nbsp;<span class="ident" id="5846952">pc</span><span class="op" id="5846954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846958">if</span>&nbsp;<span class="ident" id="5846961">file</span>&nbsp;<span class="op" id="5846966">!=</span>&nbsp;<span class="ident" id="5846969">lastFile</span>&nbsp;<span class="op" id="5846978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846983">data</span><span class="op" id="5846987">,</span>&nbsp;<span class="ident" id="5846989">err</span>&nbsp;<span class="op" id="5846993">:=</span>&nbsp;<span class="ident" id="5846996">ioutil</span><span class="op" id="5847002">.</span><span class="ident" id="5847003">ReadFile</span><span class="op" id="5847011">(</span><span class="ident" id="5847012">file</span><span class="op" id="5847016">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847021">if</span>&nbsp;<span class="ident" id="5847024">err</span>&nbsp;<span class="op" id="5847028">!=</span>&nbsp;<span class="ident" id="5847031">nil</span>&nbsp;<span class="op" id="5847035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847041">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847058">lines</span>&nbsp;<span class="op" id="5847064">=</span>&nbsp;<span class="ident" id="5847066">bytes</span><span class="op" id="5847071">.</span><span class="ident" id="5847072">Split</span><span class="op" id="5847077">(</span><span class="ident" id="5847078">data</span><span class="op" id="5847082">,</span>&nbsp;<span class="op" id="5847084">[</span><span class="op" id="5847085">]</span><span class="builtintype" id="5847086">byte</span><span class="op" id="5847090">{</span><span class="string" id="5847091">&#39;\n&#39;</span><span class="op" id="5847095">}</span><span class="op" id="5847096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847101">lastFile</span>&nbsp;<span class="op" id="5847110">=</span>&nbsp;<span class="ident" id="5847112">file</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847123">line</span><span class="op" id="5847127">--</span>&nbsp;<span class="comment" id="5847130">//&nbsp;in&nbsp;stack&nbsp;trace,&nbsp;lines&nbsp;are&nbsp;1-indexed&nbsp;but&nbsp;our&nbsp;array&nbsp;is&nbsp;0-indexed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847198">fmt</span><span class="op" id="5847201">.</span><span class="ident" id="5847202">Fprintf</span><span class="op" id="5847209">(</span><span class="ident" id="5847210">buf</span><span class="op" id="5847213">,</span>&nbsp;<span class="string" id="5847215">&#34;\t%s:&nbsp;%s\n&#34;</span><span class="op" id="5847227">,</span>&nbsp;<span class="ident" id="5847229">function</span><span class="op" id="5847237">(</span><span class="ident" id="5847238">pc</span><span class="op" id="5847240">)</span><span class="op" id="5847241">,</span>&nbsp;<span class="ident" id="5847243">source</span><span class="op" id="5847249">(</span><span class="ident" id="5847250">lines</span><span class="op" id="5847255">,</span>&nbsp;<span class="ident" id="5847257">line</span><span class="op" id="5847261">)</span><span class="op" id="5847262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847268">return</span>&nbsp;<span class="ident" id="5847275">buf</span><span class="op" id="5847278">.</span><span class="ident" id="5847279">Bytes</span><span class="op" id="5847284">(</span><span class="op" id="5847285">)</span><br>
<span class="lineno">65</span><span class="op" id="5847287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5847290">//&nbsp;source&nbsp;returns&nbsp;a&nbsp;space-trimmed&nbsp;slice&nbsp;of&nbsp;the&nbsp;n&#39;th&nbsp;line.</span><br>
<span class="lineno"></span><span class="keyword" id="5847348">func</span>&nbsp;<span class="ident" id="5847353">source</span><span class="op" id="5847359">(</span><span class="ident" id="5847360">lines</span>&nbsp;<span class="op" id="5847366">[</span><span class="op" id="5847367">]</span><span class="op" id="5847368">[</span><span class="op" id="5847369">]</span><span class="builtintype" id="5847370">byte</span><span class="op" id="5847374">,</span>&nbsp;<span class="ident" id="5847376">n</span>&nbsp;<span class="builtintype" id="5847378">int</span><span class="op" id="5847381">)</span>&nbsp;<span class="op" id="5847383">[</span><span class="op" id="5847384">]</span><span class="builtintype" id="5847385">byte</span>&nbsp;<span class="op" id="5847390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847393">if</span>&nbsp;<span class="ident" id="5847396">n</span>&nbsp;<span class="op" id="5847398">&lt;</span>&nbsp;<span class="num" id="5847400">0</span>&nbsp;<span class="op" id="5847402">||</span>&nbsp;<span class="ident" id="5847405">n</span>&nbsp;<span class="op" id="5847407">&gt;=</span>&nbsp;<span class="builtinfunc" id="5847410">len</span><span class="op" id="5847413">(</span><span class="ident" id="5847414">lines</span><span class="op" id="5847419">)</span>&nbsp;<span class="op" id="5847421">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847425">return</span>&nbsp;<span class="ident" id="5847432">dunno</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847442">return</span>&nbsp;<span class="ident" id="5847449">bytes</span><span class="op" id="5847454">.</span><span class="ident" id="5847455">Trim</span><span class="op" id="5847459">(</span><span class="ident" id="5847460">lines</span><span class="op" id="5847465">[</span><span class="ident" id="5847466">n</span><span class="op" id="5847467">]</span><span class="op" id="5847468">,</span>&nbsp;<span class="string" id="5847470">&#34;&nbsp;\t&#34;</span><span class="op" id="5847475">)</span><br>
<span class="lineno"></span><span class="op" id="5847477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5847480">//&nbsp;function&nbsp;returns,&nbsp;if&nbsp;possible,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;function&nbsp;containing&nbsp;the&nbsp;PC.</span><br>
<span class="lineno"></span><span class="keyword" id="5847558">func</span>&nbsp;<span class="ident" id="5847563">function</span><span class="op" id="5847571">(</span><span class="ident" id="5847572">pc</span>&nbsp;<span class="builtintype" id="5847575">uintptr</span><span class="op" id="5847582">)</span>&nbsp;<span class="op" id="5847584">[</span><span class="op" id="5847585">]</span><span class="builtintype" id="5847586">byte</span>&nbsp;<span class="op" id="5847591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847594">fn</span>&nbsp;<span class="op" id="5847597">:=</span>&nbsp;<span class="ident" id="5847600">runtime</span><span class="op" id="5847607">.</span><span class="ident" id="5847608">FuncForPC</span><span class="op" id="5847617">(</span><span class="ident" id="5847618">pc</span><span class="op" id="5847620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847623">if</span>&nbsp;<span class="ident" id="5847626">fn</span>&nbsp;<span class="op" id="5847629">==</span>&nbsp;<span class="ident" id="5847632">nil</span>&nbsp;<span class="op" id="5847636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847640">return</span>&nbsp;<span class="ident" id="5847647">dunno</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847657">name</span>&nbsp;<span class="op" id="5847662">:=</span>&nbsp;<span class="op" id="5847665">[</span><span class="op" id="5847666">]</span><span class="builtintype" id="5847667">byte</span><span class="op" id="5847671">(</span><span class="ident" id="5847672">fn</span><span class="op" id="5847674">.</span><span class="ident" id="5847675">Name</span><span class="op" id="5847679">(</span><span class="op" id="5847680">)</span><span class="op" id="5847681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847684">//&nbsp;The&nbsp;name&nbsp;includes&nbsp;the&nbsp;path&nbsp;name&nbsp;to&nbsp;the&nbsp;package,&nbsp;which&nbsp;is&nbsp;unnecessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847757">//&nbsp;since&nbsp;the&nbsp;file&nbsp;name&nbsp;is&nbsp;already&nbsp;included.&nbsp;&nbsp;Plus,&nbsp;it&nbsp;has&nbsp;center&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847829">//&nbsp;That&nbsp;is,&nbsp;we&nbsp;see</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847849">//&nbsp;&nbsp;&nbsp;&nbspruntime/debug.*T·ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847881">//&nbsp;and&nbsp;want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847894">//&nbsp;&nbsp;&nbsp;&nbsp*T.ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847911">//&nbsp;Since&nbsp;the&nbsp;package&nbsp;path&nbsp;might&nbsp;contains&nbsp;dots&nbsp;(e.g.&nbsp;code.google.com/...),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847986">//&nbsp;we&nbsp;first&nbsp;remove&nbsp;the&nbsp;path&nbsp;prefix&nbsp;if&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848039">if</span>&nbsp;<span class="ident" id="5848042">lastslash</span>&nbsp;<span class="op" id="5848052">:=</span>&nbsp;<span class="ident" id="5848055">bytes</span><span class="op" id="5848060">.</span><span class="ident" id="5848061">LastIndex</span><span class="op" id="5848070">(</span><span class="ident" id="5848071">name</span><span class="op" id="5848075">,</span>&nbsp;<span class="ident" id="5848077">slash</span><span class="op" id="5848082">)</span><span class="op" id="5848083">;</span>&nbsp;<span class="ident" id="5848085">lastslash</span>&nbsp;<span class="op" id="5848095">&gt;=</span>&nbsp;<span class="num" id="5848098">0</span>&nbsp;<span class="op" id="5848100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848104">name</span>&nbsp;<span class="op" id="5848109">=</span>&nbsp;<span class="ident" id="5848111">name</span><span class="op" id="5848115">[</span><span class="ident" id="5848116">lastslash</span><span class="op" id="5848125">+</span><span class="num" id="5848126">1</span><span class="op" id="5848127">:</span><span class="op" id="5848128">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5848131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848134">if</span>&nbsp;<span class="ident" id="5848137">period</span>&nbsp;<span class="op" id="5848144">:=</span>&nbsp;<span class="ident" id="5848147">bytes</span><span class="op" id="5848152">.</span><span class="ident" id="5848153">Index</span><span class="op" id="5848158">(</span><span class="ident" id="5848159">name</span><span class="op" id="5848163">,</span>&nbsp;<span class="ident" id="5848165">dot</span><span class="op" id="5848168">)</span><span class="op" id="5848169">;</span>&nbsp;<span class="ident" id="5848171">period</span>&nbsp;<span class="op" id="5848178">&gt;=</span>&nbsp;<span class="num" id="5848181">0</span>&nbsp;<span class="op" id="5848183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848187">name</span>&nbsp;<span class="op" id="5848192">=</span>&nbsp;<span class="ident" id="5848194">name</span><span class="op" id="5848198">[</span><span class="ident" id="5848199">period</span><span class="op" id="5848205">+</span><span class="num" id="5848206">1</span><span class="op" id="5848207">:</span><span class="op" id="5848208">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5848211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848214">name</span>&nbsp;<span class="op" id="5848219">=</span>&nbsp;<span class="ident" id="5848221">bytes</span><span class="op" id="5848226">.</span><span class="ident" id="5848227">Replace</span><span class="op" id="5848234">(</span><span class="ident" id="5848235">name</span><span class="op" id="5848239">,</span>&nbsp;<span class="ident" id="5848241">centerDot</span><span class="op" id="5848250">,</span>&nbsp;<span class="ident" id="5848252">dot</span><span class="op" id="5848255">,</span>&nbsp;<span class="op" id="5848257">-</span><span class="num" id="5848258">1</span><span class="op" id="5848259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848262">return</span>&nbsp;<span class="ident" id="5848269">name</span><br>
<span class="lineno"></span><span class="op" id="5848274">}</span>
</div>
</body>
</html>
