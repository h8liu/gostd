<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7233559">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7233614">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7233668">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7233719">package</span>&nbsp;<span class="ident" id="7233727">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7233732">import</span>&nbsp;<span class="op" id="7233739">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7233742">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7233752">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7233755">func</span>&nbsp;<span class="ident" id="7233760">TestRoundUp</span><span class="op" id="7233771">(</span><span class="ident" id="7233772">t</span>&nbsp;<span class="op" id="7233774">*</span><span class="ident" id="7233775">testing</span><span class="op" id="7233782">.</span><span class="ident" id="7233783">T</span><span class="op" id="7233784">)</span>&nbsp;<span class="op" id="7233786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7233789">if</span>&nbsp;<span class="ident" id="7233792">roundUp</span><span class="op" id="7233799">(</span><span class="num" id="7233800">0</span><span class="op" id="7233801">,</span>&nbsp;<span class="num" id="7233803">16</span><span class="op" id="7233805">)</span>&nbsp;<span class="op" id="7233807">!=</span>&nbsp;<span class="num" id="7233810">0</span>&nbsp;<span class="op" id="7233812">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7233817">roundUp</span><span class="op" id="7233824">(</span><span class="num" id="7233825">1</span><span class="op" id="7233826">,</span>&nbsp;<span class="num" id="7233828">16</span><span class="op" id="7233830">)</span>&nbsp;<span class="op" id="7233832">!=</span>&nbsp;<span class="num" id="7233835">16</span>&nbsp;<span class="op" id="7233838">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7233843">roundUp</span><span class="op" id="7233850">(</span><span class="num" id="7233851">15</span><span class="op" id="7233853">,</span>&nbsp;<span class="num" id="7233855">16</span><span class="op" id="7233857">)</span>&nbsp;<span class="op" id="7233859">!=</span>&nbsp;<span class="num" id="7233862">16</span>&nbsp;<span class="op" id="7233865">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7233870">roundUp</span><span class="op" id="7233877">(</span><span class="num" id="7233878">16</span><span class="op" id="7233880">,</span>&nbsp;<span class="num" id="7233882">16</span><span class="op" id="7233884">)</span>&nbsp;<span class="op" id="7233886">!=</span>&nbsp;<span class="num" id="7233889">16</span>&nbsp;<span class="op" id="7233892">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7233897">roundUp</span><span class="op" id="7233904">(</span><span class="num" id="7233905">17</span><span class="op" id="7233907">,</span>&nbsp;<span class="num" id="7233909">16</span><span class="op" id="7233911">)</span>&nbsp;<span class="op" id="7233913">!=</span>&nbsp;<span class="num" id="7233916">32</span>&nbsp;<span class="op" id="7233919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7233923">t</span><span class="op" id="7233924">.</span><span class="ident" id="7233925">Error</span><span class="op" id="7233930">(</span><span class="string" id="7233931">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="7233947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7233950">}</span><br>
<span class="lineno"></span><span class="op" id="7233952">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7233955">var</span>&nbsp;<span class="ident" id="7233959">paddingTests</span>&nbsp;<span class="op" id="7233972">=</span>&nbsp;<span class="op" id="7233974">[</span><span class="op" id="7233975">]</span><span class="keyword" id="7233976">struct</span>&nbsp;<span class="op" id="7233983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7233986">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7233998">[</span><span class="op" id="7233999">]</span><span class="builtintype" id="7234000">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234006">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7234018">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234024">expectedLen</span>&nbsp;<span class="builtintype" id="7234036">int</span><br>
<span class="lineno">25</span><span class="op" id="7234040">}</span><span class="op" id="7234041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234044">{</span><span class="op" id="7234045">[</span><span class="op" id="7234046">]</span><span class="builtintype" id="7234047">byte</span><span class="op" id="7234051">{</span><span class="num" id="7234052">1</span><span class="op" id="7234053">,</span>&nbsp;<span class="num" id="7234055">2</span><span class="op" id="7234056">,</span>&nbsp;<span class="num" id="7234058">3</span><span class="op" id="7234059">,</span>&nbsp;<span class="num" id="7234061">4</span><span class="op" id="7234062">,</span>&nbsp;<span class="num" id="7234064">0</span><span class="op" id="7234065">}</span><span class="op" id="7234066">,</span>&nbsp;<span class="builtintype" id="7234068">true</span><span class="op" id="7234072">,</span>&nbsp;<span class="num" id="7234074">4</span><span class="op" id="7234075">}</span><span class="op" id="7234076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234079">{</span><span class="op" id="7234080">[</span><span class="op" id="7234081">]</span><span class="builtintype" id="7234082">byte</span><span class="op" id="7234086">{</span><span class="num" id="7234087">1</span><span class="op" id="7234088">,</span>&nbsp;<span class="num" id="7234090">2</span><span class="op" id="7234091">,</span>&nbsp;<span class="num" id="7234093">3</span><span class="op" id="7234094">,</span>&nbsp;<span class="num" id="7234096">4</span><span class="op" id="7234097">,</span>&nbsp;<span class="num" id="7234099">0</span><span class="op" id="7234100">,</span>&nbsp;<span class="num" id="7234102">1</span><span class="op" id="7234103">}</span><span class="op" id="7234104">,</span>&nbsp;<span class="builtintype" id="7234106">false</span><span class="op" id="7234111">,</span>&nbsp;<span class="num" id="7234113">0</span><span class="op" id="7234114">}</span><span class="op" id="7234115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234118">{</span><span class="op" id="7234119">[</span><span class="op" id="7234120">]</span><span class="builtintype" id="7234121">byte</span><span class="op" id="7234125">{</span><span class="num" id="7234126">1</span><span class="op" id="7234127">,</span>&nbsp;<span class="num" id="7234129">2</span><span class="op" id="7234130">,</span>&nbsp;<span class="num" id="7234132">3</span><span class="op" id="7234133">,</span>&nbsp;<span class="num" id="7234135">4</span><span class="op" id="7234136">,</span>&nbsp;<span class="num" id="7234138">99</span><span class="op" id="7234140">,</span>&nbsp;<span class="num" id="7234142">99</span><span class="op" id="7234144">}</span><span class="op" id="7234145">,</span>&nbsp;<span class="builtintype" id="7234147">false</span><span class="op" id="7234152">,</span>&nbsp;<span class="num" id="7234154">0</span><span class="op" id="7234155">}</span><span class="op" id="7234156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234159">{</span><span class="op" id="7234160">[</span><span class="op" id="7234161">]</span><span class="builtintype" id="7234162">byte</span><span class="op" id="7234166">{</span><span class="num" id="7234167">1</span><span class="op" id="7234168">,</span>&nbsp;<span class="num" id="7234170">2</span><span class="op" id="7234171">,</span>&nbsp;<span class="num" id="7234173">3</span><span class="op" id="7234174">,</span>&nbsp;<span class="num" id="7234176">4</span><span class="op" id="7234177">,</span>&nbsp;<span class="num" id="7234179">1</span><span class="op" id="7234180">,</span>&nbsp;<span class="num" id="7234182">1</span><span class="op" id="7234183">}</span><span class="op" id="7234184">,</span>&nbsp;<span class="builtintype" id="7234186">true</span><span class="op" id="7234190">,</span>&nbsp;<span class="num" id="7234192">4</span><span class="op" id="7234193">}</span><span class="op" id="7234194">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234197">{</span><span class="op" id="7234198">[</span><span class="op" id="7234199">]</span><span class="builtintype" id="7234200">byte</span><span class="op" id="7234204">{</span><span class="num" id="7234205">1</span><span class="op" id="7234206">,</span>&nbsp;<span class="num" id="7234208">2</span><span class="op" id="7234209">,</span>&nbsp;<span class="num" id="7234211">3</span><span class="op" id="7234212">,</span>&nbsp;<span class="num" id="7234214">2</span><span class="op" id="7234215">,</span>&nbsp;<span class="num" id="7234217">2</span><span class="op" id="7234218">,</span>&nbsp;<span class="num" id="7234220">2</span><span class="op" id="7234221">}</span><span class="op" id="7234222">,</span>&nbsp;<span class="builtintype" id="7234224">true</span><span class="op" id="7234228">,</span>&nbsp;<span class="num" id="7234230">3</span><span class="op" id="7234231">}</span><span class="op" id="7234232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234235">{</span><span class="op" id="7234236">[</span><span class="op" id="7234237">]</span><span class="builtintype" id="7234238">byte</span><span class="op" id="7234242">{</span><span class="num" id="7234243">1</span><span class="op" id="7234244">,</span>&nbsp;<span class="num" id="7234246">2</span><span class="op" id="7234247">,</span>&nbsp;<span class="num" id="7234249">3</span><span class="op" id="7234250">,</span>&nbsp;<span class="num" id="7234252">3</span><span class="op" id="7234253">,</span>&nbsp;<span class="num" id="7234255">3</span><span class="op" id="7234256">,</span>&nbsp;<span class="num" id="7234258">3</span><span class="op" id="7234259">}</span><span class="op" id="7234260">,</span>&nbsp;<span class="builtintype" id="7234262">true</span><span class="op" id="7234266">,</span>&nbsp;<span class="num" id="7234268">2</span><span class="op" id="7234269">}</span><span class="op" id="7234270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234273">{</span><span class="op" id="7234274">[</span><span class="op" id="7234275">]</span><span class="builtintype" id="7234276">byte</span><span class="op" id="7234280">{</span><span class="num" id="7234281">1</span><span class="op" id="7234282">,</span>&nbsp;<span class="num" id="7234284">2</span><span class="op" id="7234285">,</span>&nbsp;<span class="num" id="7234287">3</span><span class="op" id="7234288">,</span>&nbsp;<span class="num" id="7234290">4</span><span class="op" id="7234291">,</span>&nbsp;<span class="num" id="7234293">3</span><span class="op" id="7234294">,</span>&nbsp;<span class="num" id="7234296">3</span><span class="op" id="7234297">}</span><span class="op" id="7234298">,</span>&nbsp;<span class="builtintype" id="7234300">false</span><span class="op" id="7234305">,</span>&nbsp;<span class="num" id="7234307">0</span><span class="op" id="7234308">}</span><span class="op" id="7234309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234312">{</span><span class="op" id="7234313">[</span><span class="op" id="7234314">]</span><span class="builtintype" id="7234315">byte</span><span class="op" id="7234319">{</span><span class="num" id="7234320">1</span><span class="op" id="7234321">,</span>&nbsp;<span class="num" id="7234323">4</span><span class="op" id="7234324">,</span>&nbsp;<span class="num" id="7234326">4</span><span class="op" id="7234327">,</span>&nbsp;<span class="num" id="7234329">4</span><span class="op" id="7234330">,</span>&nbsp;<span class="num" id="7234332">4</span><span class="op" id="7234333">,</span>&nbsp;<span class="num" id="7234335">4</span><span class="op" id="7234336">}</span><span class="op" id="7234337">,</span>&nbsp;<span class="builtintype" id="7234339">true</span><span class="op" id="7234343">,</span>&nbsp;<span class="num" id="7234345">1</span><span class="op" id="7234346">}</span><span class="op" id="7234347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234350">{</span><span class="op" id="7234351">[</span><span class="op" id="7234352">]</span><span class="builtintype" id="7234353">byte</span><span class="op" id="7234357">{</span><span class="num" id="7234358">5</span><span class="op" id="7234359">,</span>&nbsp;<span class="num" id="7234361">5</span><span class="op" id="7234362">,</span>&nbsp;<span class="num" id="7234364">5</span><span class="op" id="7234365">,</span>&nbsp;<span class="num" id="7234367">5</span><span class="op" id="7234368">,</span>&nbsp;<span class="num" id="7234370">5</span><span class="op" id="7234371">,</span>&nbsp;<span class="num" id="7234373">5</span><span class="op" id="7234374">}</span><span class="op" id="7234375">,</span>&nbsp;<span class="builtintype" id="7234377">true</span><span class="op" id="7234381">,</span>&nbsp;<span class="num" id="7234383">0</span><span class="op" id="7234384">}</span><span class="op" id="7234385">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234388">{</span><span class="op" id="7234389">[</span><span class="op" id="7234390">]</span><span class="builtintype" id="7234391">byte</span><span class="op" id="7234395">{</span><span class="num" id="7234396">6</span><span class="op" id="7234397">,</span>&nbsp;<span class="num" id="7234399">6</span><span class="op" id="7234400">,</span>&nbsp;<span class="num" id="7234402">6</span><span class="op" id="7234403">,</span>&nbsp;<span class="num" id="7234405">6</span><span class="op" id="7234406">,</span>&nbsp;<span class="num" id="7234408">6</span><span class="op" id="7234409">,</span>&nbsp;<span class="num" id="7234411">6</span><span class="op" id="7234412">}</span><span class="op" id="7234413">,</span>&nbsp;<span class="builtintype" id="7234415">false</span><span class="op" id="7234420">,</span>&nbsp;<span class="num" id="7234422">0</span><span class="op" id="7234423">}</span><span class="op" id="7234424">,</span><br>
<span class="lineno"></span><span class="op" id="7234426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7234429">func</span>&nbsp;<span class="ident" id="7234434">TestRemovePadding</span><span class="op" id="7234451">(</span><span class="ident" id="7234452">t</span>&nbsp;<span class="op" id="7234454">*</span><span class="ident" id="7234455">testing</span><span class="op" id="7234462">.</span><span class="ident" id="7234463">T</span><span class="op" id="7234464">)</span>&nbsp;<span class="op" id="7234466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7234469">for</span>&nbsp;<span class="ident" id="7234473">i</span><span class="op" id="7234474">,</span>&nbsp;<span class="ident" id="7234476">test</span>&nbsp;<span class="op" id="7234481">:=</span>&nbsp;<span class="keyword" id="7234484">range</span>&nbsp;<span class="ident" id="7234490">paddingTests</span>&nbsp;<span class="op" id="7234503">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234507">payload</span><span class="op" id="7234514">,</span>&nbsp;<span class="ident" id="7234516">good</span>&nbsp;<span class="op" id="7234521">:=</span>&nbsp;<span class="ident" id="7234524">removePadding</span><span class="op" id="7234537">(</span><span class="ident" id="7234538">test</span><span class="op" id="7234542">.</span><span class="ident" id="7234543">in</span><span class="op" id="7234545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234549">expectedGood</span>&nbsp;<span class="op" id="7234562">:=</span>&nbsp;<span class="builtintype" id="7234565">byte</span><span class="op" id="7234569">(</span><span class="num" id="7234570">255</span><span class="op" id="7234573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7234577">if</span>&nbsp;<span class="op" id="7234580">!</span><span class="ident" id="7234581">test</span><span class="op" id="7234585">.</span><span class="ident" id="7234586">good</span>&nbsp;<span class="op" id="7234591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234596">expectedGood</span>&nbsp;<span class="op" id="7234609">=</span>&nbsp;<span class="num" id="7234611">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234615">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7234619">if</span>&nbsp;<span class="ident" id="7234622">good</span>&nbsp;<span class="op" id="7234627">!=</span>&nbsp;<span class="ident" id="7234630">expectedGood</span>&nbsp;<span class="op" id="7234643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234648">t</span><span class="op" id="7234649">.</span><span class="ident" id="7234650">Errorf</span><span class="op" id="7234656">(</span><span class="string" id="7234657">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="7234694">,</span>&nbsp;<span class="ident" id="7234696">i</span><span class="op" id="7234697">,</span>&nbsp;<span class="ident" id="7234699">expectedGood</span><span class="op" id="7234711">,</span>&nbsp;<span class="ident" id="7234713">good</span><span class="op" id="7234717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7234725">if</span>&nbsp;<span class="ident" id="7234728">good</span>&nbsp;<span class="op" id="7234733">==</span>&nbsp;<span class="num" id="7234736">255</span>&nbsp;<span class="op" id="7234740">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7234743">len</span><span class="op" id="7234746">(</span><span class="ident" id="7234747">payload</span><span class="op" id="7234754">)</span>&nbsp;<span class="op" id="7234756">!=</span>&nbsp;<span class="ident" id="7234759">test</span><span class="op" id="7234763">.</span><span class="ident" id="7234764">expectedLen</span>&nbsp;<span class="op" id="7234776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234781">t</span><span class="op" id="7234782">.</span><span class="ident" id="7234783">Errorf</span><span class="op" id="7234789">(</span><span class="string" id="7234790">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7234812">,</span>&nbsp;<span class="ident" id="7234814">i</span><span class="op" id="7234815">,</span>&nbsp;<span class="builtinfunc" id="7234817">len</span><span class="op" id="7234820">(</span><span class="ident" id="7234821">payload</span><span class="op" id="7234828">)</span><span class="op" id="7234829">,</span>&nbsp;<span class="ident" id="7234831">test</span><span class="op" id="7234835">.</span><span class="ident" id="7234836">expectedLen</span><span class="op" id="7234847">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234854">}</span><br>
<span class="lineno"></span><span class="op" id="7234856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7234859">var</span>&nbsp;<span class="ident" id="7234863">certExampleCom</span>&nbsp;<span class="op" id="7234878">=</span>&nbsp;<span class="string" id="7234880">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="7235532">var</span>&nbsp;<span class="ident" id="7235536">certWildcardExampleCom</span>&nbsp;<span class="op" id="7235559">=</span>&nbsp;<span class="string" id="7235561">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7236217">var</span>&nbsp;<span class="ident" id="7236221">certFooExampleCom</span>&nbsp;<span class="op" id="7236239">=</span>&nbsp;<span class="string" id="7236241">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="7236901">var</span>&nbsp;<span class="ident" id="7236905">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="7236934">=</span>&nbsp;<span class="string" id="7236936">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7237596">func</span>&nbsp;<span class="ident" id="7237601">TestCertificateSelection</span><span class="op" id="7237625">(</span><span class="ident" id="7237626">t</span>&nbsp;<span class="op" id="7237628">*</span><span class="ident" id="7237629">testing</span><span class="op" id="7237636">.</span><span class="ident" id="7237637">T</span><span class="op" id="7237638">)</span>&nbsp;<span class="op" id="7237640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237643">config</span>&nbsp;<span class="op" id="7237650">:=</span>&nbsp;<span class="ident" id="7237653">Config</span><span class="op" id="7237659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237663">Certificates</span><span class="op" id="7237675">:</span>&nbsp;<span class="op" id="7237677">[</span><span class="op" id="7237678">]</span><span class="ident" id="7237679">Certificate</span><span class="op" id="7237690">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237701">Certificate</span><span class="op" id="7237712">:</span>&nbsp;<span class="op" id="7237714">[</span><span class="op" id="7237715">]</span><span class="op" id="7237716">[</span><span class="op" id="7237717">]</span><span class="builtintype" id="7237718">byte</span><span class="op" id="7237722">{</span><span class="ident" id="7237723">fromHex</span><span class="op" id="7237730">(</span><span class="ident" id="7237731">certExampleCom</span><span class="op" id="7237745">)</span><span class="op" id="7237746">}</span><span class="op" id="7237747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237752">}</span><span class="op" id="7237753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237764">Certificate</span><span class="op" id="7237775">:</span>&nbsp;<span class="op" id="7237777">[</span><span class="op" id="7237778">]</span><span class="op" id="7237779">[</span><span class="op" id="7237780">]</span><span class="builtintype" id="7237781">byte</span><span class="op" id="7237785">{</span><span class="ident" id="7237786">fromHex</span><span class="op" id="7237793">(</span><span class="ident" id="7237794">certWildcardExampleCom</span><span class="op" id="7237816">)</span><span class="op" id="7237817">}</span><span class="op" id="7237818">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237823">}</span><span class="op" id="7237824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237835">Certificate</span><span class="op" id="7237846">:</span>&nbsp;<span class="op" id="7237848">[</span><span class="op" id="7237849">]</span><span class="op" id="7237850">[</span><span class="op" id="7237851">]</span><span class="builtintype" id="7237852">byte</span><span class="op" id="7237856">{</span><span class="ident" id="7237857">fromHex</span><span class="op" id="7237864">(</span><span class="ident" id="7237865">certFooExampleCom</span><span class="op" id="7237882">)</span><span class="op" id="7237883">}</span><span class="op" id="7237884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237889">}</span><span class="op" id="7237890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237895">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237901">Certificate</span><span class="op" id="7237912">:</span>&nbsp;<span class="op" id="7237914">[</span><span class="op" id="7237915">]</span><span class="op" id="7237916">[</span><span class="op" id="7237917">]</span><span class="builtintype" id="7237918">byte</span><span class="op" id="7237922">{</span><span class="ident" id="7237923">fromHex</span><span class="op" id="7237930">(</span><span class="ident" id="7237931">certDoubleWildcardExampleCom</span><span class="op" id="7237959">)</span><span class="op" id="7237960">}</span><span class="op" id="7237961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237966">}</span><span class="op" id="7237967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237971">}</span><span class="op" id="7237972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237979">config</span><span class="op" id="7237985">.</span><span class="ident" id="7237986">BuildNameToCertificate</span><span class="op" id="7238008">(</span><span class="op" id="7238009">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238013">pointerToIndex</span>&nbsp;<span class="op" id="7238028">:=</span>&nbsp;<span class="keyword" id="7238031">func</span><span class="op" id="7238035">(</span><span class="ident" id="7238036">c</span>&nbsp;<span class="op" id="7238038">*</span><span class="ident" id="7238039">Certificate</span><span class="op" id="7238050">)</span>&nbsp;<span class="builtintype" id="7238052">int</span>&nbsp;<span class="op" id="7238056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238060">for</span>&nbsp;<span class="ident" id="7238064">i</span>&nbsp;<span class="op" id="7238066">:=</span>&nbsp;<span class="keyword" id="7238069">range</span>&nbsp;<span class="ident" id="7238075">config</span><span class="op" id="7238081">.</span><span class="ident" id="7238082">Certificates</span>&nbsp;<span class="op" id="7238095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238100">if</span>&nbsp;<span class="ident" id="7238103">c</span>&nbsp;<span class="op" id="7238105">==</span>&nbsp;<span class="op" id="7238108">&amp;</span><span class="ident" id="7238109">config</span><span class="op" id="7238115">.</span><span class="ident" id="7238116">Certificates</span><span class="op" id="7238128">[</span><span class="ident" id="7238129">i</span><span class="op" id="7238130">]</span>&nbsp;<span class="op" id="7238132">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238138">return</span>&nbsp;<span class="ident" id="7238145">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238158">return</span>&nbsp;<span class="op" id="7238165">-</span><span class="num" id="7238166">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238169">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238173">certificateForName</span>&nbsp;<span class="op" id="7238192">:=</span>&nbsp;<span class="keyword" id="7238195">func</span><span class="op" id="7238199">(</span><span class="ident" id="7238200">name</span>&nbsp;<span class="builtintype" id="7238205">string</span><span class="op" id="7238211">)</span>&nbsp;<span class="op" id="7238213">*</span><span class="ident" id="7238214">Certificate</span>&nbsp;<span class="op" id="7238226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238230">clientHello</span>&nbsp;<span class="op" id="7238242">:=</span>&nbsp;<span class="op" id="7238245">&amp;</span><span class="ident" id="7238246">ClientHelloInfo</span><span class="op" id="7238261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238266">ServerName</span><span class="op" id="7238276">:</span>&nbsp;<span class="ident" id="7238278">name</span><span class="op" id="7238282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238286">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238290">if</span>&nbsp;<span class="ident" id="7238293">cert</span><span class="op" id="7238297">,</span>&nbsp;<span class="ident" id="7238299">err</span>&nbsp;<span class="op" id="7238303">:=</span>&nbsp;<span class="ident" id="7238306">config</span><span class="op" id="7238312">.</span><span class="ident" id="7238313">getCertificate</span><span class="op" id="7238327">(</span><span class="ident" id="7238328">clientHello</span><span class="op" id="7238339">)</span><span class="op" id="7238340">;</span>&nbsp;<span class="ident" id="7238342">err</span>&nbsp;<span class="op" id="7238346">!=</span>&nbsp;<span class="ident" id="7238349">nil</span>&nbsp;<span class="op" id="7238353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238358">t</span><span class="op" id="7238359">.</span><span class="ident" id="7238360">Errorf</span><span class="op" id="7238366">(</span><span class="string" id="7238367">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="7238412">,</span>&nbsp;<span class="ident" id="7238414">name</span><span class="op" id="7238418">,</span>&nbsp;<span class="ident" id="7238420">err</span><span class="op" id="7238423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238428">return</span>&nbsp;<span class="ident" id="7238435">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238441">}</span>&nbsp;<span class="keyword" id="7238443">else</span>&nbsp;<span class="op" id="7238448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238453">return</span>&nbsp;<span class="ident" id="7238460">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238474">if</span>&nbsp;<span class="ident" id="7238477">n</span>&nbsp;<span class="op" id="7238479">:=</span>&nbsp;<span class="ident" id="7238482">pointerToIndex</span><span class="op" id="7238496">(</span><span class="ident" id="7238497">certificateForName</span><span class="op" id="7238515">(</span><span class="string" id="7238516">&#34;example.com&#34;</span><span class="op" id="7238529">)</span><span class="op" id="7238530">)</span><span class="op" id="7238531">;</span>&nbsp;<span class="ident" id="7238533">n</span>&nbsp;<span class="op" id="7238535">!=</span>&nbsp;<span class="num" id="7238538">0</span>&nbsp;<span class="op" id="7238540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238544">t</span><span class="op" id="7238545">.</span><span class="ident" id="7238546">Errorf</span><span class="op" id="7238552">(</span><span class="string" id="7238553">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7238597">,</span>&nbsp;<span class="ident" id="7238599">n</span><span class="op" id="7238600">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238606">if</span>&nbsp;<span class="ident" id="7238609">n</span>&nbsp;<span class="op" id="7238611">:=</span>&nbsp;<span class="ident" id="7238614">pointerToIndex</span><span class="op" id="7238628">(</span><span class="ident" id="7238629">certificateForName</span><span class="op" id="7238647">(</span><span class="string" id="7238648">&#34;bar.example.com&#34;</span><span class="op" id="7238665">)</span><span class="op" id="7238666">)</span><span class="op" id="7238667">;</span>&nbsp;<span class="ident" id="7238669">n</span>&nbsp;<span class="op" id="7238671">!=</span>&nbsp;<span class="num" id="7238674">1</span>&nbsp;<span class="op" id="7238676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238680">t</span><span class="op" id="7238681">.</span><span class="ident" id="7238682">Errorf</span><span class="op" id="7238688">(</span><span class="string" id="7238689">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="7238737">,</span>&nbsp;<span class="ident" id="7238739">n</span><span class="op" id="7238740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238746">if</span>&nbsp;<span class="ident" id="7238749">n</span>&nbsp;<span class="op" id="7238751">:=</span>&nbsp;<span class="ident" id="7238754">pointerToIndex</span><span class="op" id="7238768">(</span><span class="ident" id="7238769">certificateForName</span><span class="op" id="7238787">(</span><span class="string" id="7238788">&#34;foo.example.com&#34;</span><span class="op" id="7238805">)</span><span class="op" id="7238806">)</span><span class="op" id="7238807">;</span>&nbsp;<span class="ident" id="7238809">n</span>&nbsp;<span class="op" id="7238811">!=</span>&nbsp;<span class="num" id="7238814">2</span>&nbsp;<span class="op" id="7238816">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238820">t</span><span class="op" id="7238821">.</span><span class="ident" id="7238822">Errorf</span><span class="op" id="7238828">(</span><span class="string" id="7238829">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="7238877">,</span>&nbsp;<span class="ident" id="7238879">n</span><span class="op" id="7238880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238886">if</span>&nbsp;<span class="ident" id="7238889">n</span>&nbsp;<span class="op" id="7238891">:=</span>&nbsp;<span class="ident" id="7238894">pointerToIndex</span><span class="op" id="7238908">(</span><span class="ident" id="7238909">certificateForName</span><span class="op" id="7238927">(</span><span class="string" id="7238928">&#34;foo.bar.example.com&#34;</span><span class="op" id="7238949">)</span><span class="op" id="7238950">)</span><span class="op" id="7238951">;</span>&nbsp;<span class="ident" id="7238953">n</span>&nbsp;<span class="op" id="7238955">!=</span>&nbsp;<span class="num" id="7238958">3</span>&nbsp;<span class="op" id="7238960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238964">t</span><span class="op" id="7238965">.</span><span class="ident" id="7238966">Errorf</span><span class="op" id="7238972">(</span><span class="string" id="7238973">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="7239025">,</span>&nbsp;<span class="ident" id="7239027">n</span><span class="op" id="7239028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7239031">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7239034">if</span>&nbsp;<span class="ident" id="7239037">n</span>&nbsp;<span class="op" id="7239039">:=</span>&nbsp;<span class="ident" id="7239042">pointerToIndex</span><span class="op" id="7239056">(</span><span class="ident" id="7239057">certificateForName</span><span class="op" id="7239075">(</span><span class="string" id="7239076">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="7239101">)</span><span class="op" id="7239102">)</span><span class="op" id="7239103">;</span>&nbsp;<span class="ident" id="7239105">n</span>&nbsp;<span class="op" id="7239107">!=</span>&nbsp;<span class="num" id="7239110">0</span>&nbsp;<span class="op" id="7239112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7239116">t</span><span class="op" id="7239117">.</span><span class="ident" id="7239118">Errorf</span><span class="op" id="7239124">(</span><span class="string" id="7239125">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7239181">,</span>&nbsp;<span class="ident" id="7239183">n</span><span class="op" id="7239184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7239187">}</span><br>
<span class="lineno"></span><span class="op" id="7239189">}</span>
</div>
</body>
</html>
