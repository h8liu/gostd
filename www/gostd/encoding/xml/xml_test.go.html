<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html" class="current">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8132681">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8132737">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8132791">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8132842">package</span>&nbsp;<span class="ident" id="8132850">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8132855">import</span>&nbsp;<span class="op" id="8132862">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8132865">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8132874">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8132881">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8132887">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8132898">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8132909">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8132920">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="8132935">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8132938">const</span>&nbsp;<span class="ident" id="8132944">testInput</span>&nbsp;<span class="op" id="8132954">=</span>&nbsp;<span class="string" id="8132956">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="8133173">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8133176">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="8133185">+</span>&nbsp;<span class="string" id="8133187">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8133477">var</span>&nbsp;<span class="ident" id="8133481">testEntity</span>&nbsp;<span class="op" id="8133492">=</span>&nbsp;<span class="keyword" id="8133494">map</span><span class="op" id="8133497">[</span><span class="builtintype" id="8133498">string</span><span class="op" id="8133504">]</span><span class="builtintype" id="8133505">string</span><span class="op" id="8133511">{</span><span class="string" id="8133512">&#34;何&#34;</span><span class="op" id="8133517">:</span>&nbsp;<span class="string" id="8133519">&#34;What&#34;</span><span class="op" id="8133525">,</span>&nbsp;<span class="string" id="8133527">&#34;is-it&#34;</span><span class="op" id="8133534">:</span>&nbsp;<span class="string" id="8133536">&#34;is&nbsp;it?&#34;</span><span class="op" id="8133544">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="8133547">var</span>&nbsp;<span class="ident" id="8133551">rawTokens</span>&nbsp;<span class="op" id="8133561">=</span>&nbsp;<span class="op" id="8133563">[</span><span class="op" id="8133564">]</span><span class="ident" id="8133565">Token</span><span class="op" id="8133570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133573">CharData</span><span class="op" id="8133581">(</span><span class="string" id="8133582">&#34;\n&#34;</span><span class="op" id="8133586">)</span><span class="op" id="8133587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133590">ProcInst</span><span class="op" id="8133598">{</span><span class="string" id="8133599">&#34;xml&#34;</span><span class="op" id="8133604">,</span>&nbsp;<span class="op" id="8133606">[</span><span class="op" id="8133607">]</span><span class="builtintype" id="8133608">byte</span><span class="op" id="8133612">(</span><span class="string" id="8133613">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="8133645">)</span><span class="op" id="8133646">}</span><span class="op" id="8133647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133650">CharData</span><span class="op" id="8133658">(</span><span class="string" id="8133659">&#34;\n&#34;</span><span class="op" id="8133663">)</span><span class="op" id="8133664">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133667">Directive</span><span class="op" id="8133676">(</span><span class="string" id="8133677">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="8133799">)</span><span class="op" id="8133800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133803">CharData</span><span class="op" id="8133811">(</span><span class="string" id="8133812">&#34;\n&#34;</span><span class="op" id="8133816">)</span><span class="op" id="8133817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133820">StartElement</span><span class="op" id="8133832">{</span><span class="ident" id="8133833">Name</span><span class="op" id="8133837">{</span><span class="string" id="8133838">&#34;&#34;</span><span class="op" id="8133840">,</span>&nbsp;<span class="string" id="8133842">&#34;body&#34;</span><span class="op" id="8133848">}</span><span class="op" id="8133849">,</span>&nbsp;<span class="op" id="8133851">[</span><span class="op" id="8133852">]</span><span class="ident" id="8133853">Attr</span><span class="op" id="8133857">{</span><span class="op" id="8133858">{</span><span class="ident" id="8133859">Name</span><span class="op" id="8133863">{</span><span class="string" id="8133864">&#34;xmlns&#34;</span><span class="op" id="8133871">,</span>&nbsp;<span class="string" id="8133873">&#34;foo&#34;</span><span class="op" id="8133878">}</span><span class="op" id="8133879">,</span>&nbsp;<span class="string" id="8133881">&#34;ns1&#34;</span><span class="op" id="8133886">}</span><span class="op" id="8133887">,</span>&nbsp;<span class="op" id="8133889">{</span><span class="ident" id="8133890">Name</span><span class="op" id="8133894">{</span><span class="string" id="8133895">&#34;&#34;</span><span class="op" id="8133897">,</span>&nbsp;<span class="string" id="8133899">&#34;xmlns&#34;</span><span class="op" id="8133906">}</span><span class="op" id="8133907">,</span>&nbsp;<span class="string" id="8133909">&#34;ns2&#34;</span><span class="op" id="8133914">}</span><span class="op" id="8133915">,</span>&nbsp;<span class="op" id="8133917">{</span><span class="ident" id="8133918">Name</span><span class="op" id="8133922">{</span><span class="string" id="8133923">&#34;xmlns&#34;</span><span class="op" id="8133930">,</span>&nbsp;<span class="string" id="8133932">&#34;tag&#34;</span><span class="op" id="8133937">}</span><span class="op" id="8133938">,</span>&nbsp;<span class="string" id="8133940">&#34;ns3&#34;</span><span class="op" id="8133945">}</span><span class="op" id="8133946">}</span><span class="op" id="8133947">}</span><span class="op" id="8133948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133951">CharData</span><span class="op" id="8133959">(</span><span class="string" id="8133960">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8133966">)</span><span class="op" id="8133967">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133970">StartElement</span><span class="op" id="8133982">{</span><span class="ident" id="8133983">Name</span><span class="op" id="8133987">{</span><span class="string" id="8133988">&#34;&#34;</span><span class="op" id="8133990">,</span>&nbsp;<span class="string" id="8133992">&#34;hello&#34;</span><span class="op" id="8133999">}</span><span class="op" id="8134000">,</span>&nbsp;<span class="op" id="8134002">[</span><span class="op" id="8134003">]</span><span class="ident" id="8134004">Attr</span><span class="op" id="8134008">{</span><span class="op" id="8134009">{</span><span class="ident" id="8134010">Name</span><span class="op" id="8134014">{</span><span class="string" id="8134015">&#34;&#34;</span><span class="op" id="8134017">,</span>&nbsp;<span class="string" id="8134019">&#34;lang&#34;</span><span class="op" id="8134025">}</span><span class="op" id="8134026">,</span>&nbsp;<span class="string" id="8134028">&#34;en&#34;</span><span class="op" id="8134032">}</span><span class="op" id="8134033">}</span><span class="op" id="8134034">}</span><span class="op" id="8134035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134038">CharData</span><span class="op" id="8134046">(</span><span class="string" id="8134047">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="8134070">)</span><span class="op" id="8134071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134074">EndElement</span><span class="op" id="8134084">{</span><span class="ident" id="8134085">Name</span><span class="op" id="8134089">{</span><span class="string" id="8134090">&#34;&#34;</span><span class="op" id="8134092">,</span>&nbsp;<span class="string" id="8134094">&#34;hello&#34;</span><span class="op" id="8134101">}</span><span class="op" id="8134102">}</span><span class="op" id="8134103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134106">CharData</span><span class="op" id="8134114">(</span><span class="string" id="8134115">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8134121">)</span><span class="op" id="8134122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134125">StartElement</span><span class="op" id="8134137">{</span><span class="ident" id="8134138">Name</span><span class="op" id="8134142">{</span><span class="string" id="8134143">&#34;&#34;</span><span class="op" id="8134145">,</span>&nbsp;<span class="string" id="8134147">&#34;query&#34;</span><span class="op" id="8134154">}</span><span class="op" id="8134155">,</span>&nbsp;<span class="op" id="8134157">[</span><span class="op" id="8134158">]</span><span class="ident" id="8134159">Attr</span><span class="op" id="8134163">{</span><span class="op" id="8134164">}</span><span class="op" id="8134165">}</span><span class="op" id="8134166">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134169">CharData</span><span class="op" id="8134177">(</span><span class="string" id="8134178">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="8134191">)</span><span class="op" id="8134192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134195">EndElement</span><span class="op" id="8134205">{</span><span class="ident" id="8134206">Name</span><span class="op" id="8134210">{</span><span class="string" id="8134211">&#34;&#34;</span><span class="op" id="8134213">,</span>&nbsp;<span class="string" id="8134215">&#34;query&#34;</span><span class="op" id="8134222">}</span><span class="op" id="8134223">}</span><span class="op" id="8134224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134227">CharData</span><span class="op" id="8134235">(</span><span class="string" id="8134236">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8134242">)</span><span class="op" id="8134243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134246">StartElement</span><span class="op" id="8134258">{</span><span class="ident" id="8134259">Name</span><span class="op" id="8134263">{</span><span class="string" id="8134264">&#34;&#34;</span><span class="op" id="8134266">,</span>&nbsp;<span class="string" id="8134268">&#34;goodbye&#34;</span><span class="op" id="8134277">}</span><span class="op" id="8134278">,</span>&nbsp;<span class="op" id="8134280">[</span><span class="op" id="8134281">]</span><span class="ident" id="8134282">Attr</span><span class="op" id="8134286">{</span><span class="op" id="8134287">}</span><span class="op" id="8134288">}</span><span class="op" id="8134289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134292">EndElement</span><span class="op" id="8134302">{</span><span class="ident" id="8134303">Name</span><span class="op" id="8134307">{</span><span class="string" id="8134308">&#34;&#34;</span><span class="op" id="8134310">,</span>&nbsp;<span class="string" id="8134312">&#34;goodbye&#34;</span><span class="op" id="8134321">}</span><span class="op" id="8134322">}</span><span class="op" id="8134323">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134326">CharData</span><span class="op" id="8134334">(</span><span class="string" id="8134335">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8134341">)</span><span class="op" id="8134342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134345">StartElement</span><span class="op" id="8134357">{</span><span class="ident" id="8134358">Name</span><span class="op" id="8134362">{</span><span class="string" id="8134363">&#34;&#34;</span><span class="op" id="8134365">,</span>&nbsp;<span class="string" id="8134367">&#34;outer&#34;</span><span class="op" id="8134374">}</span><span class="op" id="8134375">,</span>&nbsp;<span class="op" id="8134377">[</span><span class="op" id="8134378">]</span><span class="ident" id="8134379">Attr</span><span class="op" id="8134383">{</span><span class="op" id="8134384">{</span><span class="ident" id="8134385">Name</span><span class="op" id="8134389">{</span><span class="string" id="8134390">&#34;foo&#34;</span><span class="op" id="8134395">,</span>&nbsp;<span class="string" id="8134397">&#34;attr&#34;</span><span class="op" id="8134403">}</span><span class="op" id="8134404">,</span>&nbsp;<span class="string" id="8134406">&#34;value&#34;</span><span class="op" id="8134413">}</span><span class="op" id="8134414">,</span>&nbsp;<span class="op" id="8134416">{</span><span class="ident" id="8134417">Name</span><span class="op" id="8134421">{</span><span class="string" id="8134422">&#34;xmlns&#34;</span><span class="op" id="8134429">,</span>&nbsp;<span class="string" id="8134431">&#34;tag&#34;</span><span class="op" id="8134436">}</span><span class="op" id="8134437">,</span>&nbsp;<span class="string" id="8134439">&#34;ns4&#34;</span><span class="op" id="8134444">}</span><span class="op" id="8134445">}</span><span class="op" id="8134446">}</span><span class="op" id="8134447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134450">CharData</span><span class="op" id="8134458">(</span><span class="string" id="8134459">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8134467">)</span><span class="op" id="8134468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134471">StartElement</span><span class="op" id="8134483">{</span><span class="ident" id="8134484">Name</span><span class="op" id="8134488">{</span><span class="string" id="8134489">&#34;&#34;</span><span class="op" id="8134491">,</span>&nbsp;<span class="string" id="8134493">&#34;inner&#34;</span><span class="op" id="8134500">}</span><span class="op" id="8134501">,</span>&nbsp;<span class="op" id="8134503">[</span><span class="op" id="8134504">]</span><span class="ident" id="8134505">Attr</span><span class="op" id="8134509">{</span><span class="op" id="8134510">}</span><span class="op" id="8134511">}</span><span class="op" id="8134512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134515">EndElement</span><span class="op" id="8134525">{</span><span class="ident" id="8134526">Name</span><span class="op" id="8134530">{</span><span class="string" id="8134531">&#34;&#34;</span><span class="op" id="8134533">,</span>&nbsp;<span class="string" id="8134535">&#34;inner&#34;</span><span class="op" id="8134542">}</span><span class="op" id="8134543">}</span><span class="op" id="8134544">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134547">CharData</span><span class="op" id="8134555">(</span><span class="string" id="8134556">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8134562">)</span><span class="op" id="8134563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134566">EndElement</span><span class="op" id="8134576">{</span><span class="ident" id="8134577">Name</span><span class="op" id="8134581">{</span><span class="string" id="8134582">&#34;&#34;</span><span class="op" id="8134584">,</span>&nbsp;<span class="string" id="8134586">&#34;outer&#34;</span><span class="op" id="8134593">}</span><span class="op" id="8134594">}</span><span class="op" id="8134595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134598">CharData</span><span class="op" id="8134606">(</span><span class="string" id="8134607">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8134613">)</span><span class="op" id="8134614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134617">StartElement</span><span class="op" id="8134629">{</span><span class="ident" id="8134630">Name</span><span class="op" id="8134634">{</span><span class="string" id="8134635">&#34;tag&#34;</span><span class="op" id="8134640">,</span>&nbsp;<span class="string" id="8134642">&#34;name&#34;</span><span class="op" id="8134648">}</span><span class="op" id="8134649">,</span>&nbsp;<span class="op" id="8134651">[</span><span class="op" id="8134652">]</span><span class="ident" id="8134653">Attr</span><span class="op" id="8134657">{</span><span class="op" id="8134658">}</span><span class="op" id="8134659">}</span><span class="op" id="8134660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134663">CharData</span><span class="op" id="8134671">(</span><span class="string" id="8134672">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8134680">)</span><span class="op" id="8134681">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134684">CharData</span><span class="op" id="8134692">(</span><span class="string" id="8134693">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="8134710">)</span><span class="op" id="8134711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134714">CharData</span><span class="op" id="8134722">(</span><span class="string" id="8134723">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8134729">)</span><span class="op" id="8134730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134733">EndElement</span><span class="op" id="8134743">{</span><span class="ident" id="8134744">Name</span><span class="op" id="8134748">{</span><span class="string" id="8134749">&#34;tag&#34;</span><span class="op" id="8134754">,</span>&nbsp;<span class="string" id="8134756">&#34;name&#34;</span><span class="op" id="8134762">}</span><span class="op" id="8134763">}</span><span class="op" id="8134764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134767">CharData</span><span class="op" id="8134775">(</span><span class="string" id="8134776">&#34;\n&#34;</span><span class="op" id="8134780">)</span><span class="op" id="8134781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134784">EndElement</span><span class="op" id="8134794">{</span><span class="ident" id="8134795">Name</span><span class="op" id="8134799">{</span><span class="string" id="8134800">&#34;&#34;</span><span class="op" id="8134802">,</span>&nbsp;<span class="string" id="8134804">&#34;body&#34;</span><span class="op" id="8134810">}</span><span class="op" id="8134811">}</span><span class="op" id="8134812">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134815">Comment</span><span class="op" id="8134822">(</span><span class="string" id="8134823">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="8134848">)</span><span class="op" id="8134849">,</span><br>
<span class="lineno"></span><span class="op" id="8134851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8134854">var</span>&nbsp;<span class="ident" id="8134858">cookedTokens</span>&nbsp;<span class="op" id="8134871">=</span>&nbsp;<span class="op" id="8134873">[</span><span class="op" id="8134874">]</span><span class="ident" id="8134875">Token</span><span class="op" id="8134880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134883">CharData</span><span class="op" id="8134891">(</span><span class="string" id="8134892">&#34;\n&#34;</span><span class="op" id="8134896">)</span><span class="op" id="8134897">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134900">ProcInst</span><span class="op" id="8134908">{</span><span class="string" id="8134909">&#34;xml&#34;</span><span class="op" id="8134914">,</span>&nbsp;<span class="op" id="8134916">[</span><span class="op" id="8134917">]</span><span class="builtintype" id="8134918">byte</span><span class="op" id="8134922">(</span><span class="string" id="8134923">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="8134955">)</span><span class="op" id="8134956">}</span><span class="op" id="8134957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134960">CharData</span><span class="op" id="8134968">(</span><span class="string" id="8134969">&#34;\n&#34;</span><span class="op" id="8134973">)</span><span class="op" id="8134974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134977">Directive</span><span class="op" id="8134986">(</span><span class="string" id="8134987">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="8135109">)</span><span class="op" id="8135110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135113">CharData</span><span class="op" id="8135121">(</span><span class="string" id="8135122">&#34;\n&#34;</span><span class="op" id="8135126">)</span><span class="op" id="8135127">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135130">StartElement</span><span class="op" id="8135142">{</span><span class="ident" id="8135143">Name</span><span class="op" id="8135147">{</span><span class="string" id="8135148">&#34;ns2&#34;</span><span class="op" id="8135153">,</span>&nbsp;<span class="string" id="8135155">&#34;body&#34;</span><span class="op" id="8135161">}</span><span class="op" id="8135162">,</span>&nbsp;<span class="op" id="8135164">[</span><span class="op" id="8135165">]</span><span class="ident" id="8135166">Attr</span><span class="op" id="8135170">{</span><span class="op" id="8135171">{</span><span class="ident" id="8135172">Name</span><span class="op" id="8135176">{</span><span class="string" id="8135177">&#34;xmlns&#34;</span><span class="op" id="8135184">,</span>&nbsp;<span class="string" id="8135186">&#34;foo&#34;</span><span class="op" id="8135191">}</span><span class="op" id="8135192">,</span>&nbsp;<span class="string" id="8135194">&#34;ns1&#34;</span><span class="op" id="8135199">}</span><span class="op" id="8135200">,</span>&nbsp;<span class="op" id="8135202">{</span><span class="ident" id="8135203">Name</span><span class="op" id="8135207">{</span><span class="string" id="8135208">&#34;&#34;</span><span class="op" id="8135210">,</span>&nbsp;<span class="string" id="8135212">&#34;xmlns&#34;</span><span class="op" id="8135219">}</span><span class="op" id="8135220">,</span>&nbsp;<span class="string" id="8135222">&#34;ns2&#34;</span><span class="op" id="8135227">}</span><span class="op" id="8135228">,</span>&nbsp;<span class="op" id="8135230">{</span><span class="ident" id="8135231">Name</span><span class="op" id="8135235">{</span><span class="string" id="8135236">&#34;xmlns&#34;</span><span class="op" id="8135243">,</span>&nbsp;<span class="string" id="8135245">&#34;tag&#34;</span><span class="op" id="8135250">}</span><span class="op" id="8135251">,</span>&nbsp;<span class="string" id="8135253">&#34;ns3&#34;</span><span class="op" id="8135258">}</span><span class="op" id="8135259">}</span><span class="op" id="8135260">}</span><span class="op" id="8135261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135264">CharData</span><span class="op" id="8135272">(</span><span class="string" id="8135273">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8135279">)</span><span class="op" id="8135280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135283">StartElement</span><span class="op" id="8135295">{</span><span class="ident" id="8135296">Name</span><span class="op" id="8135300">{</span><span class="string" id="8135301">&#34;ns2&#34;</span><span class="op" id="8135306">,</span>&nbsp;<span class="string" id="8135308">&#34;hello&#34;</span><span class="op" id="8135315">}</span><span class="op" id="8135316">,</span>&nbsp;<span class="op" id="8135318">[</span><span class="op" id="8135319">]</span><span class="ident" id="8135320">Attr</span><span class="op" id="8135324">{</span><span class="op" id="8135325">{</span><span class="ident" id="8135326">Name</span><span class="op" id="8135330">{</span><span class="string" id="8135331">&#34;&#34;</span><span class="op" id="8135333">,</span>&nbsp;<span class="string" id="8135335">&#34;lang&#34;</span><span class="op" id="8135341">}</span><span class="op" id="8135342">,</span>&nbsp;<span class="string" id="8135344">&#34;en&#34;</span><span class="op" id="8135348">}</span><span class="op" id="8135349">}</span><span class="op" id="8135350">}</span><span class="op" id="8135351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135354">CharData</span><span class="op" id="8135362">(</span><span class="string" id="8135363">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="8135386">)</span><span class="op" id="8135387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135390">EndElement</span><span class="op" id="8135400">{</span><span class="ident" id="8135401">Name</span><span class="op" id="8135405">{</span><span class="string" id="8135406">&#34;ns2&#34;</span><span class="op" id="8135411">,</span>&nbsp;<span class="string" id="8135413">&#34;hello&#34;</span><span class="op" id="8135420">}</span><span class="op" id="8135421">}</span><span class="op" id="8135422">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135425">CharData</span><span class="op" id="8135433">(</span><span class="string" id="8135434">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8135440">)</span><span class="op" id="8135441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135444">StartElement</span><span class="op" id="8135456">{</span><span class="ident" id="8135457">Name</span><span class="op" id="8135461">{</span><span class="string" id="8135462">&#34;ns2&#34;</span><span class="op" id="8135467">,</span>&nbsp;<span class="string" id="8135469">&#34;query&#34;</span><span class="op" id="8135476">}</span><span class="op" id="8135477">,</span>&nbsp;<span class="op" id="8135479">[</span><span class="op" id="8135480">]</span><span class="ident" id="8135481">Attr</span><span class="op" id="8135485">{</span><span class="op" id="8135486">}</span><span class="op" id="8135487">}</span><span class="op" id="8135488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135491">CharData</span><span class="op" id="8135499">(</span><span class="string" id="8135500">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="8135513">)</span><span class="op" id="8135514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135517">EndElement</span><span class="op" id="8135527">{</span><span class="ident" id="8135528">Name</span><span class="op" id="8135532">{</span><span class="string" id="8135533">&#34;ns2&#34;</span><span class="op" id="8135538">,</span>&nbsp;<span class="string" id="8135540">&#34;query&#34;</span><span class="op" id="8135547">}</span><span class="op" id="8135548">}</span><span class="op" id="8135549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135552">CharData</span><span class="op" id="8135560">(</span><span class="string" id="8135561">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8135567">)</span><span class="op" id="8135568">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135571">StartElement</span><span class="op" id="8135583">{</span><span class="ident" id="8135584">Name</span><span class="op" id="8135588">{</span><span class="string" id="8135589">&#34;ns2&#34;</span><span class="op" id="8135594">,</span>&nbsp;<span class="string" id="8135596">&#34;goodbye&#34;</span><span class="op" id="8135605">}</span><span class="op" id="8135606">,</span>&nbsp;<span class="op" id="8135608">[</span><span class="op" id="8135609">]</span><span class="ident" id="8135610">Attr</span><span class="op" id="8135614">{</span><span class="op" id="8135615">}</span><span class="op" id="8135616">}</span><span class="op" id="8135617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135620">EndElement</span><span class="op" id="8135630">{</span><span class="ident" id="8135631">Name</span><span class="op" id="8135635">{</span><span class="string" id="8135636">&#34;ns2&#34;</span><span class="op" id="8135641">,</span>&nbsp;<span class="string" id="8135643">&#34;goodbye&#34;</span><span class="op" id="8135652">}</span><span class="op" id="8135653">}</span><span class="op" id="8135654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135657">CharData</span><span class="op" id="8135665">(</span><span class="string" id="8135666">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8135672">)</span><span class="op" id="8135673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135676">StartElement</span><span class="op" id="8135688">{</span><span class="ident" id="8135689">Name</span><span class="op" id="8135693">{</span><span class="string" id="8135694">&#34;ns2&#34;</span><span class="op" id="8135699">,</span>&nbsp;<span class="string" id="8135701">&#34;outer&#34;</span><span class="op" id="8135708">}</span><span class="op" id="8135709">,</span>&nbsp;<span class="op" id="8135711">[</span><span class="op" id="8135712">]</span><span class="ident" id="8135713">Attr</span><span class="op" id="8135717">{</span><span class="op" id="8135718">{</span><span class="ident" id="8135719">Name</span><span class="op" id="8135723">{</span><span class="string" id="8135724">&#34;ns1&#34;</span><span class="op" id="8135729">,</span>&nbsp;<span class="string" id="8135731">&#34;attr&#34;</span><span class="op" id="8135737">}</span><span class="op" id="8135738">,</span>&nbsp;<span class="string" id="8135740">&#34;value&#34;</span><span class="op" id="8135747">}</span><span class="op" id="8135748">,</span>&nbsp;<span class="op" id="8135750">{</span><span class="ident" id="8135751">Name</span><span class="op" id="8135755">{</span><span class="string" id="8135756">&#34;xmlns&#34;</span><span class="op" id="8135763">,</span>&nbsp;<span class="string" id="8135765">&#34;tag&#34;</span><span class="op" id="8135770">}</span><span class="op" id="8135771">,</span>&nbsp;<span class="string" id="8135773">&#34;ns4&#34;</span><span class="op" id="8135778">}</span><span class="op" id="8135779">}</span><span class="op" id="8135780">}</span><span class="op" id="8135781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135784">CharData</span><span class="op" id="8135792">(</span><span class="string" id="8135793">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8135801">)</span><span class="op" id="8135802">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135805">StartElement</span><span class="op" id="8135817">{</span><span class="ident" id="8135818">Name</span><span class="op" id="8135822">{</span><span class="string" id="8135823">&#34;ns2&#34;</span><span class="op" id="8135828">,</span>&nbsp;<span class="string" id="8135830">&#34;inner&#34;</span><span class="op" id="8135837">}</span><span class="op" id="8135838">,</span>&nbsp;<span class="op" id="8135840">[</span><span class="op" id="8135841">]</span><span class="ident" id="8135842">Attr</span><span class="op" id="8135846">{</span><span class="op" id="8135847">}</span><span class="op" id="8135848">}</span><span class="op" id="8135849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135852">EndElement</span><span class="op" id="8135862">{</span><span class="ident" id="8135863">Name</span><span class="op" id="8135867">{</span><span class="string" id="8135868">&#34;ns2&#34;</span><span class="op" id="8135873">,</span>&nbsp;<span class="string" id="8135875">&#34;inner&#34;</span><span class="op" id="8135882">}</span><span class="op" id="8135883">}</span><span class="op" id="8135884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135887">CharData</span><span class="op" id="8135895">(</span><span class="string" id="8135896">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8135902">)</span><span class="op" id="8135903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135906">EndElement</span><span class="op" id="8135916">{</span><span class="ident" id="8135917">Name</span><span class="op" id="8135921">{</span><span class="string" id="8135922">&#34;ns2&#34;</span><span class="op" id="8135927">,</span>&nbsp;<span class="string" id="8135929">&#34;outer&#34;</span><span class="op" id="8135936">}</span><span class="op" id="8135937">}</span><span class="op" id="8135938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135941">CharData</span><span class="op" id="8135949">(</span><span class="string" id="8135950">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8135956">)</span><span class="op" id="8135957">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135960">StartElement</span><span class="op" id="8135972">{</span><span class="ident" id="8135973">Name</span><span class="op" id="8135977">{</span><span class="string" id="8135978">&#34;ns3&#34;</span><span class="op" id="8135983">,</span>&nbsp;<span class="string" id="8135985">&#34;name&#34;</span><span class="op" id="8135991">}</span><span class="op" id="8135992">,</span>&nbsp;<span class="op" id="8135994">[</span><span class="op" id="8135995">]</span><span class="ident" id="8135996">Attr</span><span class="op" id="8136000">{</span><span class="op" id="8136001">}</span><span class="op" id="8136002">}</span><span class="op" id="8136003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136006">CharData</span><span class="op" id="8136014">(</span><span class="string" id="8136015">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8136023">)</span><span class="op" id="8136024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136027">CharData</span><span class="op" id="8136035">(</span><span class="string" id="8136036">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="8136053">)</span><span class="op" id="8136054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136057">CharData</span><span class="op" id="8136065">(</span><span class="string" id="8136066">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8136072">)</span><span class="op" id="8136073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136076">EndElement</span><span class="op" id="8136086">{</span><span class="ident" id="8136087">Name</span><span class="op" id="8136091">{</span><span class="string" id="8136092">&#34;ns3&#34;</span><span class="op" id="8136097">,</span>&nbsp;<span class="string" id="8136099">&#34;name&#34;</span><span class="op" id="8136105">}</span><span class="op" id="8136106">}</span><span class="op" id="8136107">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136110">CharData</span><span class="op" id="8136118">(</span><span class="string" id="8136119">&#34;\n&#34;</span><span class="op" id="8136123">)</span><span class="op" id="8136124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136127">EndElement</span><span class="op" id="8136137">{</span><span class="ident" id="8136138">Name</span><span class="op" id="8136142">{</span><span class="string" id="8136143">&#34;ns2&#34;</span><span class="op" id="8136148">,</span>&nbsp;<span class="string" id="8136150">&#34;body&#34;</span><span class="op" id="8136156">}</span><span class="op" id="8136157">}</span><span class="op" id="8136158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136161">Comment</span><span class="op" id="8136168">(</span><span class="string" id="8136169">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="8136194">)</span><span class="op" id="8136195">,</span><br>
<span class="lineno"></span><span class="op" id="8136197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="8136200">const</span>&nbsp;<span class="ident" id="8136206">testInputAltEncoding</span>&nbsp;<span class="op" id="8136227">=</span>&nbsp;<span class="string" id="8136229">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8136303">var</span>&nbsp;<span class="ident" id="8136307">rawTokensAltEncoding</span>&nbsp;<span class="op" id="8136328">=</span>&nbsp;<span class="op" id="8136330">[</span><span class="op" id="8136331">]</span><span class="ident" id="8136332">Token</span><span class="op" id="8136337">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136340">CharData</span><span class="op" id="8136348">(</span><span class="string" id="8136349">&#34;\n&#34;</span><span class="op" id="8136353">)</span><span class="op" id="8136354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136357">ProcInst</span><span class="op" id="8136365">{</span><span class="string" id="8136366">&#34;xml&#34;</span><span class="op" id="8136371">,</span>&nbsp;<span class="op" id="8136373">[</span><span class="op" id="8136374">]</span><span class="builtintype" id="8136375">byte</span><span class="op" id="8136379">(</span><span class="string" id="8136380">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="8136426">)</span><span class="op" id="8136427">}</span><span class="op" id="8136428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136431">CharData</span><span class="op" id="8136439">(</span><span class="string" id="8136440">&#34;\n&#34;</span><span class="op" id="8136444">)</span><span class="op" id="8136445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136448">StartElement</span><span class="op" id="8136460">{</span><span class="ident" id="8136461">Name</span><span class="op" id="8136465">{</span><span class="string" id="8136466">&#34;&#34;</span><span class="op" id="8136468">,</span>&nbsp;<span class="string" id="8136470">&#34;tag&#34;</span><span class="op" id="8136475">}</span><span class="op" id="8136476">,</span>&nbsp;<span class="op" id="8136478">[</span><span class="op" id="8136479">]</span><span class="ident" id="8136480">Attr</span><span class="op" id="8136484">{</span><span class="op" id="8136485">}</span><span class="op" id="8136486">}</span><span class="op" id="8136487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136490">CharData</span><span class="op" id="8136498">(</span><span class="string" id="8136499">&#34;value&#34;</span><span class="op" id="8136506">)</span><span class="op" id="8136507">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136510">EndElement</span><span class="op" id="8136520">{</span><span class="ident" id="8136521">Name</span><span class="op" id="8136525">{</span><span class="string" id="8136526">&#34;&#34;</span><span class="op" id="8136528">,</span>&nbsp;<span class="string" id="8136530">&#34;tag&#34;</span><span class="op" id="8136535">}</span><span class="op" id="8136536">}</span><span class="op" id="8136537">,</span><br>
<span class="lineno"></span><span class="op" id="8136539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8136542">var</span>&nbsp;<span class="ident" id="8136546">xmlInput</span>&nbsp;<span class="op" id="8136555">=</span>&nbsp;<span class="op" id="8136557">[</span><span class="op" id="8136558">]</span><span class="builtintype" id="8136559">string</span><span class="op" id="8136565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8136568">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136593">&#34;&lt;&#34;</span><span class="op" id="8136596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136599">&#34;&lt;t&#34;</span><span class="op" id="8136603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136606">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="8136611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136614">&#34;&lt;t/&#34;</span><span class="op" id="8136619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136622">&#34;&lt;!&#34;</span><span class="op" id="8136626">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136629">&#34;&lt;!-&#34;</span><span class="op" id="8136634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136637">&#34;&lt;!--&#34;</span><span class="op" id="8136643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136646">&#34;&lt;!--c-&#34;</span><span class="op" id="8136654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136657">&#34;&lt;!--c--&#34;</span><span class="op" id="8136666">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136669">&#34;&lt;!d&#34;</span><span class="op" id="8136674">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136677">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="8136684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136687">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="8136695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136698">&#34;&lt;?&#34;</span><span class="op" id="8136702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136705">&#34;&lt;?p&#34;</span><span class="op" id="8136710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136713">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="8136719">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136722">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="8136729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136732">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="8136740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136743">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="8136752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136755">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="8136764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136767">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="8136777">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136780">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="8136796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136799">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="8136816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136819">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="8136837">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8136841">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136865">&#34;&lt;&gt;&#34;</span><span class="op" id="8136869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136872">&#34;&lt;t/a&#34;</span><span class="op" id="8136878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136881">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="8136888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136891">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="8136898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8136901">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136947">&#34;&lt;/0&gt;&#34;</span><span class="op" id="8136953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136956">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="8136966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136969">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="8136980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136983">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="8136994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8136997">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="8137013">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8137016">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="8137023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8137026">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="8137034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8137037">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="8137046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8137049">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8137103">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="8137112">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8137115">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="8137123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8137126">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="8137135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8137138">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="8137155">,</span><br>
<span class="lineno"></span><span class="op" id="8137157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="8137160">func</span>&nbsp;<span class="ident" id="8137165">TestRawToken</span><span class="op" id="8137177">(</span><span class="ident" id="8137178">t</span>&nbsp;<span class="op" id="8137180">*</span><span class="ident" id="8137181">testing</span><span class="op" id="8137188">.</span><span class="ident" id="8137189">T</span><span class="op" id="8137190">)</span>&nbsp;<span class="op" id="8137192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137195">d</span>&nbsp;<span class="op" id="8137197">:=</span>&nbsp;<span class="ident" id="8137200">NewDecoder</span><span class="op" id="8137210">(</span><span class="ident" id="8137211">strings</span><span class="op" id="8137218">.</span><span class="ident" id="8137219">NewReader</span><span class="op" id="8137228">(</span><span class="ident" id="8137229">testInput</span><span class="op" id="8137238">)</span><span class="op" id="8137239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137242">d</span><span class="op" id="8137243">.</span><span class="ident" id="8137244">Entity</span>&nbsp;<span class="op" id="8137251">=</span>&nbsp;<span class="ident" id="8137253">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137265">testRawToken</span><span class="op" id="8137277">(</span><span class="ident" id="8137278">t</span><span class="op" id="8137279">,</span>&nbsp;<span class="ident" id="8137281">d</span><span class="op" id="8137282">,</span>&nbsp;<span class="ident" id="8137284">testInput</span><span class="op" id="8137293">,</span>&nbsp;<span class="ident" id="8137295">rawTokens</span><span class="op" id="8137304">)</span><br>
<span class="lineno"></span><span class="op" id="8137306">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="8137309">const</span>&nbsp;<span class="ident" id="8137315">nonStrictInput</span>&nbsp;<span class="op" id="8137330">=</span>&nbsp;<span class="string" id="8137332">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8137494">var</span>&nbsp;<span class="ident" id="8137498">nonStringEntity</span>&nbsp;<span class="op" id="8137514">=</span>&nbsp;<span class="keyword" id="8137516">map</span><span class="op" id="8137519">[</span><span class="builtintype" id="8137520">string</span><span class="op" id="8137526">]</span><span class="builtintype" id="8137527">string</span><span class="op" id="8137533">{</span><span class="string" id="8137534">&#34;&#34;</span><span class="op" id="8137536">:</span>&nbsp;<span class="string" id="8137538">&#34;oops!&#34;</span><span class="op" id="8137545">,</span>&nbsp;<span class="string" id="8137547">&#34;0a&#34;</span><span class="op" id="8137551">:</span>&nbsp;<span class="string" id="8137553">&#34;oops!&#34;</span><span class="op" id="8137560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8137563">var</span>&nbsp;<span class="ident" id="8137567">nonStrictTokens</span>&nbsp;<span class="op" id="8137583">=</span>&nbsp;<span class="op" id="8137585">[</span><span class="op" id="8137586">]</span><span class="ident" id="8137587">Token</span><span class="op" id="8137592">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137595">CharData</span><span class="op" id="8137603">(</span><span class="string" id="8137604">&#34;\n&#34;</span><span class="op" id="8137608">)</span><span class="op" id="8137609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137612">StartElement</span><span class="op" id="8137624">{</span><span class="ident" id="8137625">Name</span><span class="op" id="8137629">{</span><span class="string" id="8137630">&#34;&#34;</span><span class="op" id="8137632">,</span>&nbsp;<span class="string" id="8137634">&#34;tag&#34;</span><span class="op" id="8137639">}</span><span class="op" id="8137640">,</span>&nbsp;<span class="op" id="8137642">[</span><span class="op" id="8137643">]</span><span class="ident" id="8137644">Attr</span><span class="op" id="8137648">{</span><span class="op" id="8137649">}</span><span class="op" id="8137650">}</span><span class="op" id="8137651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137654">CharData</span><span class="op" id="8137662">(</span><span class="string" id="8137663">&#34;non&amp;entity&#34;</span><span class="op" id="8137675">)</span><span class="op" id="8137676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137679">EndElement</span><span class="op" id="8137689">{</span><span class="ident" id="8137690">Name</span><span class="op" id="8137694">{</span><span class="string" id="8137695">&#34;&#34;</span><span class="op" id="8137697">,</span>&nbsp;<span class="string" id="8137699">&#34;tag&#34;</span><span class="op" id="8137704">}</span><span class="op" id="8137705">}</span><span class="op" id="8137706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137709">CharData</span><span class="op" id="8137717">(</span><span class="string" id="8137718">&#34;\n&#34;</span><span class="op" id="8137722">)</span><span class="op" id="8137723">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137726">StartElement</span><span class="op" id="8137738">{</span><span class="ident" id="8137739">Name</span><span class="op" id="8137743">{</span><span class="string" id="8137744">&#34;&#34;</span><span class="op" id="8137746">,</span>&nbsp;<span class="string" id="8137748">&#34;tag&#34;</span><span class="op" id="8137753">}</span><span class="op" id="8137754">,</span>&nbsp;<span class="op" id="8137756">[</span><span class="op" id="8137757">]</span><span class="ident" id="8137758">Attr</span><span class="op" id="8137762">{</span><span class="op" id="8137763">}</span><span class="op" id="8137764">}</span><span class="op" id="8137765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137768">CharData</span><span class="op" id="8137776">(</span><span class="string" id="8137777">&#34;&amp;unknown;entity&#34;</span><span class="op" id="8137794">)</span><span class="op" id="8137795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137798">EndElement</span><span class="op" id="8137808">{</span><span class="ident" id="8137809">Name</span><span class="op" id="8137813">{</span><span class="string" id="8137814">&#34;&#34;</span><span class="op" id="8137816">,</span>&nbsp;<span class="string" id="8137818">&#34;tag&#34;</span><span class="op" id="8137823">}</span><span class="op" id="8137824">}</span><span class="op" id="8137825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137828">CharData</span><span class="op" id="8137836">(</span><span class="string" id="8137837">&#34;\n&#34;</span><span class="op" id="8137841">)</span><span class="op" id="8137842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137845">StartElement</span><span class="op" id="8137857">{</span><span class="ident" id="8137858">Name</span><span class="op" id="8137862">{</span><span class="string" id="8137863">&#34;&#34;</span><span class="op" id="8137865">,</span>&nbsp;<span class="string" id="8137867">&#34;tag&#34;</span><span class="op" id="8137872">}</span><span class="op" id="8137873">,</span>&nbsp;<span class="op" id="8137875">[</span><span class="op" id="8137876">]</span><span class="ident" id="8137877">Attr</span><span class="op" id="8137881">{</span><span class="op" id="8137882">}</span><span class="op" id="8137883">}</span><span class="op" id="8137884">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137887">CharData</span><span class="op" id="8137895">(</span><span class="string" id="8137896">&#34;&amp;#123&#34;</span><span class="op" id="8137903">)</span><span class="op" id="8137904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137907">EndElement</span><span class="op" id="8137917">{</span><span class="ident" id="8137918">Name</span><span class="op" id="8137922">{</span><span class="string" id="8137923">&#34;&#34;</span><span class="op" id="8137925">,</span>&nbsp;<span class="string" id="8137927">&#34;tag&#34;</span><span class="op" id="8137932">}</span><span class="op" id="8137933">}</span><span class="op" id="8137934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137937">CharData</span><span class="op" id="8137945">(</span><span class="string" id="8137946">&#34;\n&#34;</span><span class="op" id="8137950">)</span><span class="op" id="8137951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137954">StartElement</span><span class="op" id="8137966">{</span><span class="ident" id="8137967">Name</span><span class="op" id="8137971">{</span><span class="string" id="8137972">&#34;&#34;</span><span class="op" id="8137974">,</span>&nbsp;<span class="string" id="8137976">&#34;tag&#34;</span><span class="op" id="8137981">}</span><span class="op" id="8137982">,</span>&nbsp;<span class="op" id="8137984">[</span><span class="op" id="8137985">]</span><span class="ident" id="8137986">Attr</span><span class="op" id="8137990">{</span><span class="op" id="8137991">}</span><span class="op" id="8137992">}</span><span class="op" id="8137993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137996">CharData</span><span class="op" id="8138004">(</span><span class="string" id="8138005">&#34;&amp;#zzz;&#34;</span><span class="op" id="8138013">)</span><span class="op" id="8138014">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138017">EndElement</span><span class="op" id="8138027">{</span><span class="ident" id="8138028">Name</span><span class="op" id="8138032">{</span><span class="string" id="8138033">&#34;&#34;</span><span class="op" id="8138035">,</span>&nbsp;<span class="string" id="8138037">&#34;tag&#34;</span><span class="op" id="8138042">}</span><span class="op" id="8138043">}</span><span class="op" id="8138044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138047">CharData</span><span class="op" id="8138055">(</span><span class="string" id="8138056">&#34;\n&#34;</span><span class="op" id="8138060">)</span><span class="op" id="8138061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138064">StartElement</span><span class="op" id="8138076">{</span><span class="ident" id="8138077">Name</span><span class="op" id="8138081">{</span><span class="string" id="8138082">&#34;&#34;</span><span class="op" id="8138084">,</span>&nbsp;<span class="string" id="8138086">&#34;tag&#34;</span><span class="op" id="8138091">}</span><span class="op" id="8138092">,</span>&nbsp;<span class="op" id="8138094">[</span><span class="op" id="8138095">]</span><span class="ident" id="8138096">Attr</span><span class="op" id="8138100">{</span><span class="op" id="8138101">}</span><span class="op" id="8138102">}</span><span class="op" id="8138103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138106">CharData</span><span class="op" id="8138114">(</span><span class="string" id="8138115">&#34;&amp;なまえ3;&#34;</span><span class="op" id="8138129">)</span><span class="op" id="8138130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138133">EndElement</span><span class="op" id="8138143">{</span><span class="ident" id="8138144">Name</span><span class="op" id="8138148">{</span><span class="string" id="8138149">&#34;&#34;</span><span class="op" id="8138151">,</span>&nbsp;<span class="string" id="8138153">&#34;tag&#34;</span><span class="op" id="8138158">}</span><span class="op" id="8138159">}</span><span class="op" id="8138160">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138163">CharData</span><span class="op" id="8138171">(</span><span class="string" id="8138172">&#34;\n&#34;</span><span class="op" id="8138176">)</span><span class="op" id="8138177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138180">StartElement</span><span class="op" id="8138192">{</span><span class="ident" id="8138193">Name</span><span class="op" id="8138197">{</span><span class="string" id="8138198">&#34;&#34;</span><span class="op" id="8138200">,</span>&nbsp;<span class="string" id="8138202">&#34;tag&#34;</span><span class="op" id="8138207">}</span><span class="op" id="8138208">,</span>&nbsp;<span class="op" id="8138210">[</span><span class="op" id="8138211">]</span><span class="ident" id="8138212">Attr</span><span class="op" id="8138216">{</span><span class="op" id="8138217">}</span><span class="op" id="8138218">}</span><span class="op" id="8138219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138222">CharData</span><span class="op" id="8138230">(</span><span class="string" id="8138231">&#34;&amp;lt-gt;&#34;</span><span class="op" id="8138240">)</span><span class="op" id="8138241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138244">EndElement</span><span class="op" id="8138254">{</span><span class="ident" id="8138255">Name</span><span class="op" id="8138259">{</span><span class="string" id="8138260">&#34;&#34;</span><span class="op" id="8138262">,</span>&nbsp;<span class="string" id="8138264">&#34;tag&#34;</span><span class="op" id="8138269">}</span><span class="op" id="8138270">}</span><span class="op" id="8138271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138274">CharData</span><span class="op" id="8138282">(</span><span class="string" id="8138283">&#34;\n&#34;</span><span class="op" id="8138287">)</span><span class="op" id="8138288">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138291">StartElement</span><span class="op" id="8138303">{</span><span class="ident" id="8138304">Name</span><span class="op" id="8138308">{</span><span class="string" id="8138309">&#34;&#34;</span><span class="op" id="8138311">,</span>&nbsp;<span class="string" id="8138313">&#34;tag&#34;</span><span class="op" id="8138318">}</span><span class="op" id="8138319">,</span>&nbsp;<span class="op" id="8138321">[</span><span class="op" id="8138322">]</span><span class="ident" id="8138323">Attr</span><span class="op" id="8138327">{</span><span class="op" id="8138328">}</span><span class="op" id="8138329">}</span><span class="op" id="8138330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138333">CharData</span><span class="op" id="8138341">(</span><span class="string" id="8138342">&#34;&amp;;&#34;</span><span class="op" id="8138346">)</span><span class="op" id="8138347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138350">EndElement</span><span class="op" id="8138360">{</span><span class="ident" id="8138361">Name</span><span class="op" id="8138365">{</span><span class="string" id="8138366">&#34;&#34;</span><span class="op" id="8138368">,</span>&nbsp;<span class="string" id="8138370">&#34;tag&#34;</span><span class="op" id="8138375">}</span><span class="op" id="8138376">}</span><span class="op" id="8138377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138380">CharData</span><span class="op" id="8138388">(</span><span class="string" id="8138389">&#34;\n&#34;</span><span class="op" id="8138393">)</span><span class="op" id="8138394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138397">StartElement</span><span class="op" id="8138409">{</span><span class="ident" id="8138410">Name</span><span class="op" id="8138414">{</span><span class="string" id="8138415">&#34;&#34;</span><span class="op" id="8138417">,</span>&nbsp;<span class="string" id="8138419">&#34;tag&#34;</span><span class="op" id="8138424">}</span><span class="op" id="8138425">,</span>&nbsp;<span class="op" id="8138427">[</span><span class="op" id="8138428">]</span><span class="ident" id="8138429">Attr</span><span class="op" id="8138433">{</span><span class="op" id="8138434">}</span><span class="op" id="8138435">}</span><span class="op" id="8138436">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138439">CharData</span><span class="op" id="8138447">(</span><span class="string" id="8138448">&#34;&amp;0a;&#34;</span><span class="op" id="8138454">)</span><span class="op" id="8138455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138458">EndElement</span><span class="op" id="8138468">{</span><span class="ident" id="8138469">Name</span><span class="op" id="8138473">{</span><span class="string" id="8138474">&#34;&#34;</span><span class="op" id="8138476">,</span>&nbsp;<span class="string" id="8138478">&#34;tag&#34;</span><span class="op" id="8138483">}</span><span class="op" id="8138484">}</span><span class="op" id="8138485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138488">CharData</span><span class="op" id="8138496">(</span><span class="string" id="8138497">&#34;\n&#34;</span><span class="op" id="8138501">)</span><span class="op" id="8138502">,</span><br>
<span class="lineno"></span><span class="op" id="8138504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="8138507">func</span>&nbsp;<span class="ident" id="8138512">TestNonStrictRawToken</span><span class="op" id="8138533">(</span><span class="ident" id="8138534">t</span>&nbsp;<span class="op" id="8138536">*</span><span class="ident" id="8138537">testing</span><span class="op" id="8138544">.</span><span class="ident" id="8138545">T</span><span class="op" id="8138546">)</span>&nbsp;<span class="op" id="8138548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138551">d</span>&nbsp;<span class="op" id="8138553">:=</span>&nbsp;<span class="ident" id="8138556">NewDecoder</span><span class="op" id="8138566">(</span><span class="ident" id="8138567">strings</span><span class="op" id="8138574">.</span><span class="ident" id="8138575">NewReader</span><span class="op" id="8138584">(</span><span class="ident" id="8138585">nonStrictInput</span><span class="op" id="8138599">)</span><span class="op" id="8138600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138603">d</span><span class="op" id="8138604">.</span><span class="ident" id="8138605">Strict</span>&nbsp;<span class="op" id="8138612">=</span>&nbsp;<span class="builtintype" id="8138614">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138621">testRawToken</span><span class="op" id="8138633">(</span><span class="ident" id="8138634">t</span><span class="op" id="8138635">,</span>&nbsp;<span class="ident" id="8138637">d</span><span class="op" id="8138638">,</span>&nbsp;<span class="ident" id="8138640">nonStrictInput</span><span class="op" id="8138654">,</span>&nbsp;<span class="ident" id="8138656">nonStrictTokens</span><span class="op" id="8138671">)</span><br>
<span class="lineno"></span><span class="op" id="8138673">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="8138676">type</span>&nbsp;<span class="ident" id="8138681">downCaser</span>&nbsp;<span class="keyword" id="8138691">struct</span>&nbsp;<span class="op" id="8138698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138701">t</span>&nbsp;<span class="op" id="8138703">*</span><span class="ident" id="8138704">testing</span><span class="op" id="8138711">.</span><span class="ident" id="8138712">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138715">r</span>&nbsp;<span class="ident" id="8138717">io</span><span class="op" id="8138719">.</span><span class="ident" id="8138720">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="8138731">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="8138734">func</span>&nbsp;<span class="op" id="8138739">(</span><span class="ident" id="8138740">d</span>&nbsp;<span class="op" id="8138742">*</span><span class="ident" id="8138743">downCaser</span><span class="op" id="8138752">)</span>&nbsp;<span class="ident" id="8138754">ReadByte</span><span class="op" id="8138762">(</span><span class="op" id="8138763">)</span>&nbsp;<span class="op" id="8138765">(</span><span class="ident" id="8138766">c</span>&nbsp;<span class="builtintype" id="8138768">byte</span><span class="op" id="8138772">,</span>&nbsp;<span class="ident" id="8138774">err</span>&nbsp;<span class="builtintype" id="8138778">error</span><span class="op" id="8138783">)</span>&nbsp;<span class="op" id="8138785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138788">c</span><span class="op" id="8138789">,</span>&nbsp;<span class="ident" id="8138791">err</span>&nbsp;<span class="op" id="8138795">=</span>&nbsp;<span class="ident" id="8138797">d</span><span class="op" id="8138798">.</span><span class="ident" id="8138799">r</span><span class="op" id="8138800">.</span><span class="ident" id="8138801">ReadByte</span><span class="op" id="8138809">(</span><span class="op" id="8138810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138813">if</span>&nbsp;<span class="ident" id="8138816">c</span>&nbsp;<span class="op" id="8138818">&gt;=</span>&nbsp;<span class="string" id="8138821">&#39;A&#39;</span>&nbsp;<span class="op" id="8138825">&amp;&amp;</span>&nbsp;<span class="ident" id="8138828">c</span>&nbsp;<span class="op" id="8138830">&lt;=</span>&nbsp;<span class="string" id="8138833">&#39;Z&#39;</span>&nbsp;<span class="op" id="8138837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138841">c</span>&nbsp;<span class="op" id="8138843">+=</span>&nbsp;<span class="string" id="8138846">&#39;a&#39;</span>&nbsp;<span class="op" id="8138850">-</span>&nbsp;<span class="string" id="8138852">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138860">return</span><br>
<span class="lineno"></span><span class="op" id="8138867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8138870">func</span>&nbsp;<span class="op" id="8138875">(</span><span class="ident" id="8138876">d</span>&nbsp;<span class="op" id="8138878">*</span><span class="ident" id="8138879">downCaser</span><span class="op" id="8138888">)</span>&nbsp;<span class="ident" id="8138890">Read</span><span class="op" id="8138894">(</span><span class="ident" id="8138895">p</span>&nbsp;<span class="op" id="8138897">[</span><span class="op" id="8138898">]</span><span class="builtintype" id="8138899">byte</span><span class="op" id="8138903">)</span>&nbsp;<span class="op" id="8138905">(</span><span class="builtintype" id="8138906">int</span><span class="op" id="8138909">,</span>&nbsp;<span class="builtintype" id="8138911">error</span><span class="op" id="8138916">)</span>&nbsp;<span class="op" id="8138918">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138921">d</span><span class="op" id="8138922">.</span><span class="ident" id="8138923">t</span><span class="op" id="8138924">.</span><span class="ident" id="8138925">Fatalf</span><span class="op" id="8138931">(</span><span class="string" id="8138932">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="8138974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8138977">panic</span><span class="op" id="8138982">(</span><span class="string" id="8138983">&#34;unreachable&#34;</span><span class="op" id="8138996">)</span><br>
<span class="lineno"></span><span class="op" id="8138998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8139001">func</span>&nbsp;<span class="ident" id="8139006">TestRawTokenAltEncoding</span><span class="op" id="8139029">(</span><span class="ident" id="8139030">t</span>&nbsp;<span class="op" id="8139032">*</span><span class="ident" id="8139033">testing</span><span class="op" id="8139040">.</span><span class="ident" id="8139041">T</span><span class="op" id="8139042">)</span>&nbsp;<span class="op" id="8139044">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139047">d</span>&nbsp;<span class="op" id="8139049">:=</span>&nbsp;<span class="ident" id="8139052">NewDecoder</span><span class="op" id="8139062">(</span><span class="ident" id="8139063">strings</span><span class="op" id="8139070">.</span><span class="ident" id="8139071">NewReader</span><span class="op" id="8139080">(</span><span class="ident" id="8139081">testInputAltEncoding</span><span class="op" id="8139101">)</span><span class="op" id="8139102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139105">d</span><span class="op" id="8139106">.</span><span class="ident" id="8139107">CharsetReader</span>&nbsp;<span class="op" id="8139121">=</span>&nbsp;<span class="keyword" id="8139123">func</span><span class="op" id="8139127">(</span><span class="ident" id="8139128">charset</span>&nbsp;<span class="builtintype" id="8139136">string</span><span class="op" id="8139142">,</span>&nbsp;<span class="ident" id="8139144">input</span>&nbsp;<span class="ident" id="8139150">io</span><span class="op" id="8139152">.</span><span class="ident" id="8139153">Reader</span><span class="op" id="8139159">)</span>&nbsp;<span class="op" id="8139161">(</span><span class="ident" id="8139162">io</span><span class="op" id="8139164">.</span><span class="ident" id="8139165">Reader</span><span class="op" id="8139171">,</span>&nbsp;<span class="builtintype" id="8139173">error</span><span class="op" id="8139178">)</span>&nbsp;<span class="op" id="8139180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139184">if</span>&nbsp;<span class="ident" id="8139187">charset</span>&nbsp;<span class="op" id="8139195">!=</span>&nbsp;<span class="string" id="8139198">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="8139220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139225">t</span><span class="op" id="8139226">.</span><span class="ident" id="8139227">Fatalf</span><span class="op" id="8139233">(</span><span class="string" id="8139234">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="8139257">,</span>&nbsp;<span class="ident" id="8139259">charset</span><span class="op" id="8139266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139270">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139274">return</span>&nbsp;<span class="op" id="8139281">&amp;</span><span class="ident" id="8139282">downCaser</span><span class="op" id="8139291">{</span><span class="ident" id="8139292">t</span><span class="op" id="8139293">,</span>&nbsp;<span class="ident" id="8139295">input</span><span class="op" id="8139300">.</span><span class="op" id="8139301">(</span><span class="ident" id="8139302">io</span><span class="op" id="8139304">.</span><span class="ident" id="8139305">ByteReader</span><span class="op" id="8139315">)</span><span class="op" id="8139316">}</span><span class="op" id="8139317">,</span>&nbsp;<span class="ident" id="8139319">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139327">testRawToken</span><span class="op" id="8139339">(</span><span class="ident" id="8139340">t</span><span class="op" id="8139341">,</span>&nbsp;<span class="ident" id="8139343">d</span><span class="op" id="8139344">,</span>&nbsp;<span class="ident" id="8139346">testInputAltEncoding</span><span class="op" id="8139366">,</span>&nbsp;<span class="ident" id="8139368">rawTokensAltEncoding</span><span class="op" id="8139388">)</span><br>
<span class="lineno"></span><span class="op" id="8139390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="8139393">func</span>&nbsp;<span class="ident" id="8139398">TestRawTokenAltEncodingNoConverter</span><span class="op" id="8139432">(</span><span class="ident" id="8139433">t</span>&nbsp;<span class="op" id="8139435">*</span><span class="ident" id="8139436">testing</span><span class="op" id="8139443">.</span><span class="ident" id="8139444">T</span><span class="op" id="8139445">)</span>&nbsp;<span class="op" id="8139447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139450">d</span>&nbsp;<span class="op" id="8139452">:=</span>&nbsp;<span class="ident" id="8139455">NewDecoder</span><span class="op" id="8139465">(</span><span class="ident" id="8139466">strings</span><span class="op" id="8139473">.</span><span class="ident" id="8139474">NewReader</span><span class="op" id="8139483">(</span><span class="ident" id="8139484">testInputAltEncoding</span><span class="op" id="8139504">)</span><span class="op" id="8139505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139508">token</span><span class="op" id="8139513">,</span>&nbsp;<span class="ident" id="8139515">err</span>&nbsp;<span class="op" id="8139519">:=</span>&nbsp;<span class="ident" id="8139522">d</span><span class="op" id="8139523">.</span><span class="ident" id="8139524">RawToken</span><span class="op" id="8139532">(</span><span class="op" id="8139533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139536">if</span>&nbsp;<span class="ident" id="8139539">token</span>&nbsp;<span class="op" id="8139545">==</span>&nbsp;<span class="ident" id="8139548">nil</span>&nbsp;<span class="op" id="8139552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139556">t</span><span class="op" id="8139557">.</span><span class="ident" id="8139558">Fatalf</span><span class="op" id="8139564">(</span><span class="string" id="8139565">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="8139606">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139612">if</span>&nbsp;<span class="ident" id="8139615">err</span>&nbsp;<span class="op" id="8139619">!=</span>&nbsp;<span class="ident" id="8139622">nil</span>&nbsp;<span class="op" id="8139626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139630">t</span><span class="op" id="8139631">.</span><span class="ident" id="8139632">Fatal</span><span class="op" id="8139637">(</span><span class="ident" id="8139638">err</span><span class="op" id="8139641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139647">token</span><span class="op" id="8139652">,</span>&nbsp;<span class="ident" id="8139654">err</span>&nbsp;<span class="op" id="8139658">=</span>&nbsp;<span class="ident" id="8139660">d</span><span class="op" id="8139661">.</span><span class="ident" id="8139662">RawToken</span><span class="op" id="8139670">(</span><span class="op" id="8139671">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139674">if</span>&nbsp;<span class="ident" id="8139677">token</span>&nbsp;<span class="op" id="8139683">!=</span>&nbsp;<span class="ident" id="8139686">nil</span>&nbsp;<span class="op" id="8139690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139694">t</span><span class="op" id="8139695">.</span><span class="ident" id="8139696">Errorf</span><span class="op" id="8139702">(</span><span class="string" id="8139703">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="8139734">,</span>&nbsp;<span class="ident" id="8139736">token</span><span class="op" id="8139741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139747">if</span>&nbsp;<span class="ident" id="8139750">err</span>&nbsp;<span class="op" id="8139754">==</span>&nbsp;<span class="ident" id="8139757">nil</span>&nbsp;<span class="op" id="8139761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139765">t</span><span class="op" id="8139766">.</span><span class="ident" id="8139767">Fatalf</span><span class="op" id="8139773">(</span><span class="string" id="8139774">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="8139817">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139823">const</span>&nbsp;<span class="ident" id="8139829">encoding</span>&nbsp;<span class="op" id="8139838">=</span>&nbsp;<span class="string" id="8139840">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139863">if</span>&nbsp;<span class="op" id="8139866">!</span><span class="ident" id="8139867">strings</span><span class="op" id="8139874">.</span><span class="ident" id="8139875">Contains</span><span class="op" id="8139883">(</span><span class="ident" id="8139884">err</span><span class="op" id="8139887">.</span><span class="ident" id="8139888">Error</span><span class="op" id="8139893">(</span><span class="op" id="8139894">)</span><span class="op" id="8139895">,</span>&nbsp;<span class="ident" id="8139897">encoding</span><span class="op" id="8139905">)</span>&nbsp;<span class="op" id="8139907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139911">t</span><span class="op" id="8139912">.</span><span class="ident" id="8139913">Errorf</span><span class="op" id="8139919">(</span><span class="string" id="8139920">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8139965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139970">encoding</span><span class="op" id="8139978">,</span>&nbsp;<span class="ident" id="8139980">err</span><span class="op" id="8139983">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139986">}</span><br>
<span class="lineno"></span><span class="op" id="8139988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8139991">func</span>&nbsp;<span class="ident" id="8139996">testRawToken</span><span class="op" id="8140008">(</span><span class="ident" id="8140009">t</span>&nbsp;<span class="op" id="8140011">*</span><span class="ident" id="8140012">testing</span><span class="op" id="8140019">.</span><span class="ident" id="8140020">T</span><span class="op" id="8140021">,</span>&nbsp;<span class="ident" id="8140023">d</span>&nbsp;<span class="op" id="8140025">*</span><span class="ident" id="8140026">Decoder</span><span class="op" id="8140033">,</span>&nbsp;<span class="ident" id="8140035">raw</span>&nbsp;<span class="builtintype" id="8140039">string</span><span class="op" id="8140045">,</span>&nbsp;<span class="ident" id="8140047">rawTokens</span>&nbsp;<span class="op" id="8140057">[</span><span class="op" id="8140058">]</span><span class="ident" id="8140059">Token</span><span class="op" id="8140064">)</span>&nbsp;<span class="op" id="8140066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140069">lastEnd</span>&nbsp;<span class="op" id="8140077">:=</span>&nbsp;<span class="ident" id="8140080">int64</span><span class="op" id="8140085">(</span><span class="num" id="8140086">0</span><span class="op" id="8140087">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140090">for</span>&nbsp;<span class="ident" id="8140094">i</span><span class="op" id="8140095">,</span>&nbsp;<span class="ident" id="8140097">want</span>&nbsp;<span class="op" id="8140102">:=</span>&nbsp;<span class="keyword" id="8140105">range</span>&nbsp;<span class="ident" id="8140111">rawTokens</span>&nbsp;<span class="op" id="8140121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140125">start</span>&nbsp;<span class="op" id="8140131">:=</span>&nbsp;<span class="ident" id="8140134">d</span><span class="op" id="8140135">.</span><span class="ident" id="8140136">InputOffset</span><span class="op" id="8140147">(</span><span class="op" id="8140148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140152">have</span><span class="op" id="8140156">,</span>&nbsp;<span class="ident" id="8140158">err</span>&nbsp;<span class="op" id="8140162">:=</span>&nbsp;<span class="ident" id="8140165">d</span><span class="op" id="8140166">.</span><span class="ident" id="8140167">RawToken</span><span class="op" id="8140175">(</span><span class="op" id="8140176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140180">end</span>&nbsp;<span class="op" id="8140184">:=</span>&nbsp;<span class="ident" id="8140187">d</span><span class="op" id="8140188">.</span><span class="ident" id="8140189">InputOffset</span><span class="op" id="8140200">(</span><span class="op" id="8140201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140205">if</span>&nbsp;<span class="ident" id="8140208">err</span>&nbsp;<span class="op" id="8140212">!=</span>&nbsp;<span class="ident" id="8140215">nil</span>&nbsp;<span class="op" id="8140219">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140224">t</span><span class="op" id="8140225">.</span><span class="ident" id="8140226">Fatalf</span><span class="op" id="8140232">(</span><span class="string" id="8140233">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8140265">,</span>&nbsp;<span class="ident" id="8140267">i</span><span class="op" id="8140268">,</span>&nbsp;<span class="ident" id="8140270">err</span><span class="op" id="8140273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8140277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140281">if</span>&nbsp;<span class="op" id="8140284">!</span><span class="ident" id="8140285">reflect</span><span class="op" id="8140292">.</span><span class="ident" id="8140293">DeepEqual</span><span class="op" id="8140302">(</span><span class="ident" id="8140303">have</span><span class="op" id="8140307">,</span>&nbsp;<span class="ident" id="8140309">want</span><span class="op" id="8140313">)</span>&nbsp;<span class="op" id="8140315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140320">var</span>&nbsp;<span class="ident" id="8140324">shave</span><span class="op" id="8140329">,</span>&nbsp;<span class="ident" id="8140331">swant</span>&nbsp;<span class="builtintype" id="8140337">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140347">if</span>&nbsp;<span class="ident" id="8140350">_</span><span class="op" id="8140351">,</span>&nbsp;<span class="ident" id="8140353">ok</span>&nbsp;<span class="op" id="8140356">:=</span>&nbsp;<span class="ident" id="8140359">have</span><span class="op" id="8140363">.</span><span class="op" id="8140364">(</span><span class="ident" id="8140365">CharData</span><span class="op" id="8140373">)</span><span class="op" id="8140374">;</span>&nbsp;<span class="ident" id="8140376">ok</span>&nbsp;<span class="op" id="8140379">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140385">shave</span>&nbsp;<span class="op" id="8140391">=</span>&nbsp;<span class="ident" id="8140393">fmt</span><span class="op" id="8140396">.</span><span class="ident" id="8140397">Sprintf</span><span class="op" id="8140404">(</span><span class="string" id="8140405">&#34;CharData(%q)&#34;</span><span class="op" id="8140419">,</span>&nbsp;<span class="ident" id="8140421">have</span><span class="op" id="8140425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8140430">}</span>&nbsp;<span class="keyword" id="8140432">else</span>&nbsp;<span class="op" id="8140437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140443">shave</span>&nbsp;<span class="op" id="8140449">=</span>&nbsp;<span class="ident" id="8140451">fmt</span><span class="op" id="8140454">.</span><span class="ident" id="8140455">Sprintf</span><span class="op" id="8140462">(</span><span class="string" id="8140463">&#34;%#v&#34;</span><span class="op" id="8140468">,</span>&nbsp;<span class="ident" id="8140470">have</span><span class="op" id="8140474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8140479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140484">if</span>&nbsp;<span class="ident" id="8140487">_</span><span class="op" id="8140488">,</span>&nbsp;<span class="ident" id="8140490">ok</span>&nbsp;<span class="op" id="8140493">:=</span>&nbsp;<span class="ident" id="8140496">want</span><span class="op" id="8140500">.</span><span class="op" id="8140501">(</span><span class="ident" id="8140502">CharData</span><span class="op" id="8140510">)</span><span class="op" id="8140511">;</span>&nbsp;<span class="ident" id="8140513">ok</span>&nbsp;<span class="op" id="8140516">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140522">swant</span>&nbsp;<span class="op" id="8140528">=</span>&nbsp;<span class="ident" id="8140530">fmt</span><span class="op" id="8140533">.</span><span class="ident" id="8140534">Sprintf</span><span class="op" id="8140541">(</span><span class="string" id="8140542">&#34;CharData(%q)&#34;</span><span class="op" id="8140556">,</span>&nbsp;<span class="ident" id="8140558">want</span><span class="op" id="8140562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8140567">}</span>&nbsp;<span class="keyword" id="8140569">else</span>&nbsp;<span class="op" id="8140574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140580">swant</span>&nbsp;<span class="op" id="8140586">=</span>&nbsp;<span class="ident" id="8140588">fmt</span><span class="op" id="8140591">.</span><span class="ident" id="8140592">Sprintf</span><span class="op" id="8140599">(</span><span class="string" id="8140600">&#34;%#v&#34;</span><span class="op" id="8140605">,</span>&nbsp;<span class="ident" id="8140607">want</span><span class="op" id="8140611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8140616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140621">t</span><span class="op" id="8140622">.</span><span class="ident" id="8140623">Errorf</span><span class="op" id="8140629">(</span><span class="string" id="8140630">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8140654">,</span>&nbsp;<span class="ident" id="8140656">i</span><span class="op" id="8140657">,</span>&nbsp;<span class="ident" id="8140659">shave</span><span class="op" id="8140664">,</span>&nbsp;<span class="ident" id="8140666">swant</span><span class="op" id="8140671">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8140675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8140680">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140731">switch</span>&nbsp;<span class="op" id="8140738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140742">case</span>&nbsp;<span class="ident" id="8140747">start</span>&nbsp;<span class="op" id="8140753">&lt;</span>&nbsp;<span class="ident" id="8140755">lastEnd</span><span class="op" id="8140762">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140767">t</span><span class="op" id="8140768">.</span><span class="ident" id="8140769">Errorf</span><span class="op" id="8140775">(</span><span class="string" id="8140776">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="8140836">,</span>&nbsp;<span class="ident" id="8140838">i</span><span class="op" id="8140839">,</span>&nbsp;<span class="ident" id="8140841">start</span><span class="op" id="8140846">,</span>&nbsp;<span class="ident" id="8140848">end</span><span class="op" id="8140851">,</span>&nbsp;<span class="ident" id="8140853">have</span><span class="op" id="8140857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140861">case</span>&nbsp;<span class="ident" id="8140866">start</span>&nbsp;<span class="op" id="8140872">&gt;=</span>&nbsp;<span class="ident" id="8140875">end</span><span class="op" id="8140878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8140883">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140934">if</span>&nbsp;<span class="ident" id="8140937">start</span>&nbsp;<span class="op" id="8140943">==</span>&nbsp;<span class="ident" id="8140946">end</span>&nbsp;<span class="op" id="8140950">&amp;&amp;</span>&nbsp;<span class="ident" id="8140953">end</span>&nbsp;<span class="op" id="8140957">==</span>&nbsp;<span class="ident" id="8140960">lastEnd</span>&nbsp;<span class="op" id="8140968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140974">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8140983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140988">t</span><span class="op" id="8140989">.</span><span class="ident" id="8140990">Errorf</span><span class="op" id="8140996">(</span><span class="string" id="8140997">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="8141041">,</span>&nbsp;<span class="ident" id="8141043">i</span><span class="op" id="8141044">,</span>&nbsp;<span class="ident" id="8141046">start</span><span class="op" id="8141051">,</span>&nbsp;<span class="ident" id="8141053">end</span><span class="op" id="8141056">,</span>&nbsp;<span class="ident" id="8141058">have</span><span class="op" id="8141062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8141066">case</span>&nbsp;<span class="ident" id="8141071">end</span>&nbsp;<span class="op" id="8141075">&gt;</span>&nbsp;<span class="ident" id="8141077">int64</span><span class="op" id="8141082">(</span><span class="builtinfunc" id="8141083">len</span><span class="op" id="8141086">(</span><span class="ident" id="8141087">raw</span><span class="op" id="8141090">)</span><span class="op" id="8141091">)</span><span class="op" id="8141092">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8141097">t</span><span class="op" id="8141098">.</span><span class="ident" id="8141099">Errorf</span><span class="op" id="8141105">(</span><span class="string" id="8141106">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="8141162">,</span>&nbsp;<span class="ident" id="8141164">i</span><span class="op" id="8141165">,</span>&nbsp;<span class="ident" id="8141167">start</span><span class="op" id="8141172">,</span>&nbsp;<span class="ident" id="8141174">end</span><span class="op" id="8141177">,</span>&nbsp;<span class="ident" id="8141179">have</span><span class="op" id="8141183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8141187">default</span><span class="op" id="8141194">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8141199">text</span>&nbsp;<span class="op" id="8141204">:=</span>&nbsp;<span class="ident" id="8141207">raw</span><span class="op" id="8141210">[</span><span class="ident" id="8141211">start</span><span class="op" id="8141216">:</span><span class="ident" id="8141217">end</span><span class="op" id="8141220">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8141225">if</span>&nbsp;<span class="ident" id="8141228">strings</span><span class="op" id="8141235">.</span><span class="ident" id="8141236">ContainsAny</span><span class="op" id="8141247">(</span><span class="ident" id="8141248">text</span><span class="op" id="8141252">,</span>&nbsp;<span class="string" id="8141254">&#34;&lt;&gt;&#34;</span><span class="op" id="8141258">)</span>&nbsp;<span class="op" id="8141260">&amp;&amp;</span>&nbsp;<span class="op" id="8141263">(</span><span class="op" id="8141264">!</span><span class="ident" id="8141265">strings</span><span class="op" id="8141272">.</span><span class="ident" id="8141273">HasPrefix</span><span class="op" id="8141282">(</span><span class="ident" id="8141283">text</span><span class="op" id="8141287">,</span>&nbsp;<span class="string" id="8141289">&#34;&lt;&#34;</span><span class="op" id="8141292">)</span>&nbsp;<span class="op" id="8141294">||</span>&nbsp;<span class="op" id="8141297">!</span><span class="ident" id="8141298">strings</span><span class="op" id="8141305">.</span><span class="ident" id="8141306">HasSuffix</span><span class="op" id="8141315">(</span><span class="ident" id="8141316">text</span><span class="op" id="8141320">,</span>&nbsp;<span class="string" id="8141322">&#34;&gt;&#34;</span><span class="op" id="8141325">)</span><span class="op" id="8141326">)</span>&nbsp;<span class="op" id="8141328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8141334">t</span><span class="op" id="8141335">.</span><span class="ident" id="8141336">Errorf</span><span class="op" id="8141342">(</span><span class="string" id="8141343">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="8141386">,</span>&nbsp;<span class="ident" id="8141388">i</span><span class="op" id="8141389">,</span>&nbsp;<span class="ident" id="8141391">text</span><span class="op" id="8141395">,</span>&nbsp;<span class="ident" id="8141397">have</span><span class="op" id="8141401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8141406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8141410">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8141414">lastEnd</span>&nbsp;<span class="op" id="8141422">=</span>&nbsp;<span class="ident" id="8141424">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8141429">}</span><br>
<span class="lineno"></span><span class="op" id="8141431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8141434">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="8141505">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="8141573">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8141631">var</span>&nbsp;<span class="ident" id="8141635">nestedDirectivesInput</span>&nbsp;<span class="op" id="8141657">=</span>&nbsp;<span class="string" id="8141659">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8141925">var</span>&nbsp;<span class="ident" id="8141929">nestedDirectivesTokens</span>&nbsp;<span class="op" id="8141952">=</span>&nbsp;<span class="op" id="8141954">[</span><span class="op" id="8141955">]</span><span class="ident" id="8141956">Token</span><span class="op" id="8141961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8141964">CharData</span><span class="op" id="8141972">(</span><span class="string" id="8141973">&#34;\n&#34;</span><span class="op" id="8141977">)</span><span class="op" id="8141978">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8141981">Directive</span><span class="op" id="8141990">(</span><span class="string" id="8141991">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="8142062">)</span><span class="op" id="8142063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142066">CharData</span><span class="op" id="8142074">(</span><span class="string" id="8142075">&#34;\n&#34;</span><span class="op" id="8142079">)</span><span class="op" id="8142080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142083">Directive</span><span class="op" id="8142092">(</span><span class="string" id="8142093">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="8142122">)</span><span class="op" id="8142123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142126">CharData</span><span class="op" id="8142134">(</span><span class="string" id="8142135">&#34;\n&#34;</span><span class="op" id="8142139">)</span><span class="op" id="8142140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142143">Directive</span><span class="op" id="8142152">(</span><span class="string" id="8142153">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="8142182">)</span><span class="op" id="8142183">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142186">CharData</span><span class="op" id="8142194">(</span><span class="string" id="8142195">&#34;\n&#34;</span><span class="op" id="8142199">)</span><span class="op" id="8142200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142203">Directive</span><span class="op" id="8142212">(</span><span class="string" id="8142213">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="8142242">)</span><span class="op" id="8142243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142246">CharData</span><span class="op" id="8142254">(</span><span class="string" id="8142255">&#34;\n&#34;</span><span class="op" id="8142259">)</span><span class="op" id="8142260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142263">Directive</span><span class="op" id="8142272">(</span><span class="string" id="8142273">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="8142302">)</span><span class="op" id="8142303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142306">CharData</span><span class="op" id="8142314">(</span><span class="string" id="8142315">&#34;\n&#34;</span><span class="op" id="8142319">)</span><span class="op" id="8142320">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142323">Directive</span><span class="op" id="8142332">(</span><span class="string" id="8142333">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="8142363">)</span><span class="op" id="8142364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142367">CharData</span><span class="op" id="8142375">(</span><span class="string" id="8142376">&#34;\n&#34;</span><span class="op" id="8142380">)</span><span class="op" id="8142381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142384">Directive</span><span class="op" id="8142393">(</span><span class="string" id="8142394">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="8142424">)</span><span class="op" id="8142425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142428">CharData</span><span class="op" id="8142436">(</span><span class="string" id="8142437">&#34;\n&#34;</span><span class="op" id="8142441">)</span><span class="op" id="8142442">,</span><br>
<span class="lineno"></span><span class="op" id="8142444">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="8142447">func</span>&nbsp;<span class="ident" id="8142452">TestNestedDirectives</span><span class="op" id="8142472">(</span><span class="ident" id="8142473">t</span>&nbsp;<span class="op" id="8142475">*</span><span class="ident" id="8142476">testing</span><span class="op" id="8142483">.</span><span class="ident" id="8142484">T</span><span class="op" id="8142485">)</span>&nbsp;<span class="op" id="8142487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142490">d</span>&nbsp;<span class="op" id="8142492">:=</span>&nbsp;<span class="ident" id="8142495">NewDecoder</span><span class="op" id="8142505">(</span><span class="ident" id="8142506">strings</span><span class="op" id="8142513">.</span><span class="ident" id="8142514">NewReader</span><span class="op" id="8142523">(</span><span class="ident" id="8142524">nestedDirectivesInput</span><span class="op" id="8142545">)</span><span class="op" id="8142546">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8142550">for</span>&nbsp;<span class="ident" id="8142554">i</span><span class="op" id="8142555">,</span>&nbsp;<span class="ident" id="8142557">want</span>&nbsp;<span class="op" id="8142562">:=</span>&nbsp;<span class="keyword" id="8142565">range</span>&nbsp;<span class="ident" id="8142571">nestedDirectivesTokens</span>&nbsp;<span class="op" id="8142594">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142598">have</span><span class="op" id="8142602">,</span>&nbsp;<span class="ident" id="8142604">err</span>&nbsp;<span class="op" id="8142608">:=</span>&nbsp;<span class="ident" id="8142611">d</span><span class="op" id="8142612">.</span><span class="ident" id="8142613">Token</span><span class="op" id="8142618">(</span><span class="op" id="8142619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8142623">if</span>&nbsp;<span class="ident" id="8142626">err</span>&nbsp;<span class="op" id="8142630">!=</span>&nbsp;<span class="ident" id="8142633">nil</span>&nbsp;<span class="op" id="8142637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142642">t</span><span class="op" id="8142643">.</span><span class="ident" id="8142644">Fatalf</span><span class="op" id="8142650">(</span><span class="string" id="8142651">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8142683">,</span>&nbsp;<span class="ident" id="8142685">i</span><span class="op" id="8142686">,</span>&nbsp;<span class="ident" id="8142688">err</span><span class="op" id="8142691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8142695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8142699">if</span>&nbsp;<span class="op" id="8142702">!</span><span class="ident" id="8142703">reflect</span><span class="op" id="8142710">.</span><span class="ident" id="8142711">DeepEqual</span><span class="op" id="8142720">(</span><span class="ident" id="8142721">have</span><span class="op" id="8142725">,</span>&nbsp;<span class="ident" id="8142727">want</span><span class="op" id="8142731">)</span>&nbsp;<span class="op" id="8142733">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142738">t</span><span class="op" id="8142739">.</span><span class="ident" id="8142740">Errorf</span><span class="op" id="8142746">(</span><span class="string" id="8142747">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8142772">,</span>&nbsp;<span class="ident" id="8142774">i</span><span class="op" id="8142775">,</span>&nbsp;<span class="ident" id="8142777">have</span><span class="op" id="8142781">,</span>&nbsp;<span class="ident" id="8142783">want</span><span class="op" id="8142787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8142791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8142794">}</span><br>
<span class="lineno"></span><span class="op" id="8142796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="8142799">func</span>&nbsp;<span class="ident" id="8142804">TestToken</span><span class="op" id="8142813">(</span><span class="ident" id="8142814">t</span>&nbsp;<span class="op" id="8142816">*</span><span class="ident" id="8142817">testing</span><span class="op" id="8142824">.</span><span class="ident" id="8142825">T</span><span class="op" id="8142826">)</span>&nbsp;<span class="op" id="8142828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142831">d</span>&nbsp;<span class="op" id="8142833">:=</span>&nbsp;<span class="ident" id="8142836">NewDecoder</span><span class="op" id="8142846">(</span><span class="ident" id="8142847">strings</span><span class="op" id="8142854">.</span><span class="ident" id="8142855">NewReader</span><span class="op" id="8142864">(</span><span class="ident" id="8142865">testInput</span><span class="op" id="8142874">)</span><span class="op" id="8142875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142878">d</span><span class="op" id="8142879">.</span><span class="ident" id="8142880">Entity</span>&nbsp;<span class="op" id="8142887">=</span>&nbsp;<span class="ident" id="8142889">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8142902">for</span>&nbsp;<span class="ident" id="8142906">i</span><span class="op" id="8142907">,</span>&nbsp;<span class="ident" id="8142909">want</span>&nbsp;<span class="op" id="8142914">:=</span>&nbsp;<span class="keyword" id="8142917">range</span>&nbsp;<span class="ident" id="8142923">cookedTokens</span>&nbsp;<span class="op" id="8142936">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142940">have</span><span class="op" id="8142944">,</span>&nbsp;<span class="ident" id="8142946">err</span>&nbsp;<span class="op" id="8142950">:=</span>&nbsp;<span class="ident" id="8142953">d</span><span class="op" id="8142954">.</span><span class="ident" id="8142955">Token</span><span class="op" id="8142960">(</span><span class="op" id="8142961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8142965">if</span>&nbsp;<span class="ident" id="8142968">err</span>&nbsp;<span class="op" id="8142972">!=</span>&nbsp;<span class="ident" id="8142975">nil</span>&nbsp;<span class="op" id="8142979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8142984">t</span><span class="op" id="8142985">.</span><span class="ident" id="8142986">Fatalf</span><span class="op" id="8142992">(</span><span class="string" id="8142993">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8143025">,</span>&nbsp;<span class="ident" id="8143027">i</span><span class="op" id="8143028">,</span>&nbsp;<span class="ident" id="8143030">err</span><span class="op" id="8143033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8143037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8143041">if</span>&nbsp;<span class="op" id="8143044">!</span><span class="ident" id="8143045">reflect</span><span class="op" id="8143052">.</span><span class="ident" id="8143053">DeepEqual</span><span class="op" id="8143062">(</span><span class="ident" id="8143063">have</span><span class="op" id="8143067">,</span>&nbsp;<span class="ident" id="8143069">want</span><span class="op" id="8143073">)</span>&nbsp;<span class="op" id="8143075">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143080">t</span><span class="op" id="8143081">.</span><span class="ident" id="8143082">Errorf</span><span class="op" id="8143088">(</span><span class="string" id="8143089">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8143114">,</span>&nbsp;<span class="ident" id="8143116">i</span><span class="op" id="8143117">,</span>&nbsp;<span class="ident" id="8143119">have</span><span class="op" id="8143123">,</span>&nbsp;<span class="ident" id="8143125">want</span><span class="op" id="8143129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8143133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8143136">}</span><br>
<span class="lineno"></span><span class="op" id="8143138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="8143141">func</span>&nbsp;<span class="ident" id="8143146">TestSyntax</span><span class="op" id="8143156">(</span><span class="ident" id="8143157">t</span>&nbsp;<span class="op" id="8143159">*</span><span class="ident" id="8143160">testing</span><span class="op" id="8143167">.</span><span class="ident" id="8143168">T</span><span class="op" id="8143169">)</span>&nbsp;<span class="op" id="8143171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8143174">for</span>&nbsp;<span class="ident" id="8143178">i</span>&nbsp;<span class="op" id="8143180">:=</span>&nbsp;<span class="keyword" id="8143183">range</span>&nbsp;<span class="ident" id="8143189">xmlInput</span>&nbsp;<span class="op" id="8143198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143202">d</span>&nbsp;<span class="op" id="8143204">:=</span>&nbsp;<span class="ident" id="8143207">NewDecoder</span><span class="op" id="8143217">(</span><span class="ident" id="8143218">strings</span><span class="op" id="8143225">.</span><span class="ident" id="8143226">NewReader</span><span class="op" id="8143235">(</span><span class="ident" id="8143236">xmlInput</span><span class="op" id="8143244">[</span><span class="ident" id="8143245">i</span><span class="op" id="8143246">]</span><span class="op" id="8143247">)</span><span class="op" id="8143248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8143252">var</span>&nbsp;<span class="ident" id="8143256">err</span>&nbsp;<span class="builtintype" id="8143260">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8143268">for</span>&nbsp;<span class="ident" id="8143272">_</span><span class="op" id="8143273">,</span>&nbsp;<span class="ident" id="8143275">err</span>&nbsp;<span class="op" id="8143279">=</span>&nbsp;<span class="ident" id="8143281">d</span><span class="op" id="8143282">.</span><span class="ident" id="8143283">Token</span><span class="op" id="8143288">(</span><span class="op" id="8143289">)</span><span class="op" id="8143290">;</span>&nbsp;<span class="ident" id="8143292">err</span>&nbsp;<span class="op" id="8143296">==</span>&nbsp;<span class="ident" id="8143299">nil</span><span class="op" id="8143302">;</span>&nbsp;<span class="ident" id="8143304">_</span><span class="op" id="8143305">,</span>&nbsp;<span class="ident" id="8143307">err</span>&nbsp;<span class="op" id="8143311">=</span>&nbsp;<span class="ident" id="8143313">d</span><span class="op" id="8143314">.</span><span class="ident" id="8143315">Token</span><span class="op" id="8143320">(</span><span class="op" id="8143321">)</span>&nbsp;<span class="op" id="8143323">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8143327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8143331">if</span>&nbsp;<span class="ident" id="8143334">_</span><span class="op" id="8143335">,</span>&nbsp;<span class="ident" id="8143337">ok</span>&nbsp;<span class="op" id="8143340">:=</span>&nbsp;<span class="ident" id="8143343">err</span><span class="op" id="8143346">.</span><span class="op" id="8143347">(</span><span class="op" id="8143348">*</span><span class="ident" id="8143349">SyntaxError</span><span class="op" id="8143360">)</span><span class="op" id="8143361">;</span>&nbsp;<span class="op" id="8143363">!</span><span class="ident" id="8143364">ok</span>&nbsp;<span class="op" id="8143367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143372">t</span><span class="op" id="8143373">.</span><span class="ident" id="8143374">Fatalf</span><span class="op" id="8143380">(</span><span class="string" id="8143381">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="8143431">,</span>&nbsp;<span class="ident" id="8143433">xmlInput</span><span class="op" id="8143441">[</span><span class="ident" id="8143442">i</span><span class="op" id="8143443">]</span><span class="op" id="8143444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8143448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8143451">}</span><br>
<span class="lineno">400</span><span class="op" id="8143453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8143456">type</span>&nbsp;<span class="ident" id="8143461">allScalars</span>&nbsp;<span class="keyword" id="8143472">struct</span>&nbsp;<span class="op" id="8143479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143482">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143492">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143498">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143508">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143514">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143524">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143530">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143540">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143546">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143556">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143561">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143571">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143577">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143587">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143594">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143604">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143611">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8143621">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143628">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143638">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143643">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143653">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143660">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143670">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143678">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143688">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143696">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8143706">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143714">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143724">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143733">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143743">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143752">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143762">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143771">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143781">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143789">PtrString</span>&nbsp;<span class="op" id="8143799">*</span><span class="builtintype" id="8143800">string</span><br>
<span class="lineno"></span><span class="op" id="8143807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8143810">var</span>&nbsp;<span class="ident" id="8143814">all</span>&nbsp;<span class="op" id="8143818">=</span>&nbsp;<span class="ident" id="8143820">allScalars</span><span class="op" id="8143830">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143833">True1</span><span class="op" id="8143838">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143844">true</span><span class="op" id="8143848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143851">True2</span><span class="op" id="8143856">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143862">true</span><span class="op" id="8143866">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143869">False1</span><span class="op" id="8143875">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143880">false</span><span class="op" id="8143885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143888">False2</span><span class="op" id="8143894">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8143899">false</span><span class="op" id="8143904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143907">Int</span><span class="op" id="8143910">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8143918">1</span><span class="op" id="8143919">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143922">Int8</span><span class="op" id="8143926">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143933">-</span><span class="num" id="8143934">2</span><span class="op" id="8143935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143938">Int16</span><span class="op" id="8143943">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8143949">3</span><span class="op" id="8143950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143953">Int32</span><span class="op" id="8143958">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143964">-</span><span class="num" id="8143965">4</span><span class="op" id="8143966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143969">Int64</span><span class="op" id="8143974">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8143980">5</span><span class="op" id="8143981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143984">Uint</span><span class="op" id="8143988">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8143995">6</span><span class="op" id="8143996">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8143999">Uint8</span><span class="op" id="8144004">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8144010">7</span><span class="op" id="8144011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144014">Uint16</span><span class="op" id="8144020">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8144025">8</span><span class="op" id="8144026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144029">Uint32</span><span class="op" id="8144035">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8144040">9</span><span class="op" id="8144041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144044">Uint64</span><span class="op" id="8144050">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8144055">10</span><span class="op" id="8144057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144060">Uintptr</span><span class="op" id="8144067">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8144071">11</span><span class="op" id="8144073">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144076">Float32</span><span class="op" id="8144083">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8144087">13.0</span><span class="op" id="8144091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144094">Float64</span><span class="op" id="8144101">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8144105">14.0</span><span class="op" id="8144109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144112">String</span><span class="op" id="8144118">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8144123">&#34;15&#34;</span><span class="op" id="8144127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144130">PtrString</span><span class="op" id="8144139">:</span>&nbsp;<span class="op" id="8144141">&amp;</span><span class="ident" id="8144142">sixteen</span><span class="op" id="8144149">,</span><br>
<span class="lineno"></span><span class="op" id="8144151">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="8144154">var</span>&nbsp;<span class="ident" id="8144158">sixteen</span>&nbsp;<span class="op" id="8144166">=</span>&nbsp;<span class="string" id="8144168">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8144174">const</span>&nbsp;<span class="ident" id="8144180">testScalarsInput</span>&nbsp;<span class="op" id="8144197">=</span>&nbsp;<span class="string" id="8144199">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="8144635">func</span>&nbsp;<span class="ident" id="8144640">TestAllScalars</span><span class="op" id="8144654">(</span><span class="ident" id="8144655">t</span>&nbsp;<span class="op" id="8144657">*</span><span class="ident" id="8144658">testing</span><span class="op" id="8144665">.</span><span class="ident" id="8144666">T</span><span class="op" id="8144667">)</span>&nbsp;<span class="op" id="8144669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8144672">var</span>&nbsp;<span class="ident" id="8144676">a</span>&nbsp;<span class="ident" id="8144678">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144690">err</span>&nbsp;<span class="op" id="8144694">:=</span>&nbsp;<span class="ident" id="8144697">Unmarshal</span><span class="op" id="8144706">(</span><span class="op" id="8144707">[</span><span class="op" id="8144708">]</span><span class="builtintype" id="8144709">byte</span><span class="op" id="8144713">(</span><span class="ident" id="8144714">testScalarsInput</span><span class="op" id="8144730">)</span><span class="op" id="8144731">,</span>&nbsp;<span class="op" id="8144733">&amp;</span><span class="ident" id="8144734">a</span><span class="op" id="8144735">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8144739">if</span>&nbsp;<span class="ident" id="8144742">err</span>&nbsp;<span class="op" id="8144746">!=</span>&nbsp;<span class="ident" id="8144749">nil</span>&nbsp;<span class="op" id="8144753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144757">t</span><span class="op" id="8144758">.</span><span class="ident" id="8144759">Fatal</span><span class="op" id="8144764">(</span><span class="ident" id="8144765">err</span><span class="op" id="8144768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8144771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8144774">if</span>&nbsp;<span class="op" id="8144777">!</span><span class="ident" id="8144778">reflect</span><span class="op" id="8144785">.</span><span class="ident" id="8144786">DeepEqual</span><span class="op" id="8144795">(</span><span class="ident" id="8144796">a</span><span class="op" id="8144797">,</span>&nbsp;<span class="ident" id="8144799">all</span><span class="op" id="8144802">)</span>&nbsp;<span class="op" id="8144804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144808">t</span><span class="op" id="8144809">.</span><span class="ident" id="8144810">Errorf</span><span class="op" id="8144816">(</span><span class="string" id="8144817">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="8144836">,</span>&nbsp;<span class="ident" id="8144838">a</span><span class="op" id="8144839">,</span>&nbsp;<span class="ident" id="8144841">all</span><span class="op" id="8144844">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8144847">}</span><br>
<span class="lineno"></span><span class="op" id="8144849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8144852">type</span>&nbsp;<span class="ident" id="8144857">item</span>&nbsp;<span class="keyword" id="8144862">struct</span>&nbsp;<span class="op" id="8144869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144872">Field_a</span>&nbsp;<span class="builtintype" id="8144880">string</span><br>
<span class="lineno">485</span><span class="op" id="8144887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8144890">func</span>&nbsp;<span class="ident" id="8144895">TestIssue569</span><span class="op" id="8144907">(</span><span class="ident" id="8144908">t</span>&nbsp;<span class="op" id="8144910">*</span><span class="ident" id="8144911">testing</span><span class="op" id="8144918">.</span><span class="ident" id="8144919">T</span><span class="op" id="8144920">)</span>&nbsp;<span class="op" id="8144922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144925">data</span>&nbsp;<span class="op" id="8144930">:=</span>&nbsp;<span class="string" id="8144933">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8144973">var</span>&nbsp;<span class="ident" id="8144977">i</span>&nbsp;<span class="ident" id="8144979">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8144985">err</span>&nbsp;<span class="op" id="8144989">:=</span>&nbsp;<span class="ident" id="8144992">Unmarshal</span><span class="op" id="8145001">(</span><span class="op" id="8145002">[</span><span class="op" id="8145003">]</span><span class="builtintype" id="8145004">byte</span><span class="op" id="8145008">(</span><span class="ident" id="8145009">data</span><span class="op" id="8145013">)</span><span class="op" id="8145014">,</span>&nbsp;<span class="op" id="8145016">&amp;</span><span class="ident" id="8145017">i</span><span class="op" id="8145018">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8145022">if</span>&nbsp;<span class="ident" id="8145025">err</span>&nbsp;<span class="op" id="8145029">!=</span>&nbsp;<span class="ident" id="8145032">nil</span>&nbsp;<span class="op" id="8145036">||</span>&nbsp;<span class="ident" id="8145039">i</span><span class="op" id="8145040">.</span><span class="ident" id="8145041">Field_a</span>&nbsp;<span class="op" id="8145049">!=</span>&nbsp;<span class="string" id="8145052">&#34;abcd&#34;</span>&nbsp;<span class="op" id="8145059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145063">t</span><span class="op" id="8145064">.</span><span class="ident" id="8145065">Fatal</span><span class="op" id="8145070">(</span><span class="string" id="8145071">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="8145087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8145090">}</span><br>
<span class="lineno">495</span><span class="op" id="8145092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8145095">func</span>&nbsp;<span class="ident" id="8145100">TestUnquotedAttrs</span><span class="op" id="8145117">(</span><span class="ident" id="8145118">t</span>&nbsp;<span class="op" id="8145120">*</span><span class="ident" id="8145121">testing</span><span class="op" id="8145128">.</span><span class="ident" id="8145129">T</span><span class="op" id="8145130">)</span>&nbsp;<span class="op" id="8145132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145135">data</span>&nbsp;<span class="op" id="8145140">:=</span>&nbsp;<span class="string" id="8145143">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145169">d</span>&nbsp;<span class="op" id="8145171">:=</span>&nbsp;<span class="ident" id="8145174">NewDecoder</span><span class="op" id="8145184">(</span><span class="ident" id="8145185">strings</span><span class="op" id="8145192">.</span><span class="ident" id="8145193">NewReader</span><span class="op" id="8145202">(</span><span class="ident" id="8145203">data</span><span class="op" id="8145207">)</span><span class="op" id="8145208">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145211">d</span><span class="op" id="8145212">.</span><span class="ident" id="8145213">Strict</span>&nbsp;<span class="op" id="8145220">=</span>&nbsp;<span class="builtintype" id="8145222">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145229">token</span><span class="op" id="8145234">,</span>&nbsp;<span class="ident" id="8145236">err</span>&nbsp;<span class="op" id="8145240">:=</span>&nbsp;<span class="ident" id="8145243">d</span><span class="op" id="8145244">.</span><span class="ident" id="8145245">Token</span><span class="op" id="8145250">(</span><span class="op" id="8145251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8145254">if</span>&nbsp;<span class="ident" id="8145257">_</span><span class="op" id="8145258">,</span>&nbsp;<span class="ident" id="8145260">ok</span>&nbsp;<span class="op" id="8145263">:=</span>&nbsp;<span class="ident" id="8145266">err</span><span class="op" id="8145269">.</span><span class="op" id="8145270">(</span><span class="op" id="8145271">*</span><span class="ident" id="8145272">SyntaxError</span><span class="op" id="8145283">)</span><span class="op" id="8145284">;</span>&nbsp;<span class="ident" id="8145286">ok</span>&nbsp;<span class="op" id="8145289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145293">t</span><span class="op" id="8145294">.</span><span class="ident" id="8145295">Errorf</span><span class="op" id="8145301">(</span><span class="string" id="8145302">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8145324">,</span>&nbsp;<span class="ident" id="8145326">err</span><span class="op" id="8145329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8145332">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8145335">if</span>&nbsp;<span class="ident" id="8145338">token</span><span class="op" id="8145343">.</span><span class="op" id="8145344">(</span><span class="ident" id="8145345">StartElement</span><span class="op" id="8145357">)</span><span class="op" id="8145358">.</span><span class="ident" id="8145359">Name</span><span class="op" id="8145363">.</span><span class="ident" id="8145364">Local</span>&nbsp;<span class="op" id="8145370">!=</span>&nbsp;<span class="string" id="8145373">&#34;tag&#34;</span>&nbsp;<span class="op" id="8145379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145383">t</span><span class="op" id="8145384">.</span><span class="ident" id="8145385">Errorf</span><span class="op" id="8145391">(</span><span class="string" id="8145392">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8145417">,</span>&nbsp;<span class="ident" id="8145419">token</span><span class="op" id="8145424">.</span><span class="op" id="8145425">(</span><span class="ident" id="8145426">StartElement</span><span class="op" id="8145438">)</span><span class="op" id="8145439">.</span><span class="ident" id="8145440">Name</span><span class="op" id="8145444">.</span><span class="ident" id="8145445">Local</span><span class="op" id="8145450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8145453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145456">attr</span>&nbsp;<span class="op" id="8145461">:=</span>&nbsp;<span class="ident" id="8145464">token</span><span class="op" id="8145469">.</span><span class="op" id="8145470">(</span><span class="ident" id="8145471">StartElement</span><span class="op" id="8145483">)</span><span class="op" id="8145484">.</span><span class="ident" id="8145485">Attr</span><span class="op" id="8145489">[</span><span class="num" id="8145490">0</span><span class="op" id="8145491">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8145494">if</span>&nbsp;<span class="ident" id="8145497">attr</span><span class="op" id="8145501">.</span><span class="ident" id="8145502">Value</span>&nbsp;<span class="op" id="8145508">!=</span>&nbsp;<span class="string" id="8145511">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="8145523">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145527">t</span><span class="op" id="8145528">.</span><span class="ident" id="8145529">Errorf</span><span class="op" id="8145535">(</span><span class="string" id="8145536">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="8145568">,</span>&nbsp;<span class="ident" id="8145570">attr</span><span class="op" id="8145574">.</span><span class="ident" id="8145575">Value</span><span class="op" id="8145580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8145583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8145586">if</span>&nbsp;<span class="ident" id="8145589">attr</span><span class="op" id="8145593">.</span><span class="ident" id="8145594">Name</span><span class="op" id="8145598">.</span><span class="ident" id="8145599">Local</span>&nbsp;<span class="op" id="8145605">!=</span>&nbsp;<span class="string" id="8145608">&#34;attr&#34;</span>&nbsp;<span class="op" id="8145615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145619">t</span><span class="op" id="8145620">.</span><span class="ident" id="8145621">Errorf</span><span class="op" id="8145627">(</span><span class="string" id="8145628">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8145659">,</span>&nbsp;<span class="ident" id="8145661">attr</span><span class="op" id="8145665">.</span><span class="ident" id="8145666">Name</span><span class="op" id="8145670">.</span><span class="ident" id="8145671">Local</span><span class="op" id="8145676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8145679">}</span><br>
<span class="lineno">515</span><span class="op" id="8145681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8145684">func</span>&nbsp;<span class="ident" id="8145689">TestValuelessAttrs</span><span class="op" id="8145707">(</span><span class="ident" id="8145708">t</span>&nbsp;<span class="op" id="8145710">*</span><span class="ident" id="8145711">testing</span><span class="op" id="8145718">.</span><span class="ident" id="8145719">T</span><span class="op" id="8145720">)</span>&nbsp;<span class="op" id="8145722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145725">tests</span>&nbsp;<span class="op" id="8145731">:=</span>&nbsp;<span class="op" id="8145734">[</span><span class="op" id="8145735">]</span><span class="op" id="8145736">[</span><span class="num" id="8145737">3</span><span class="op" id="8145738">]</span><span class="builtintype" id="8145739">string</span><span class="op" id="8145745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8145749">{</span><span class="string" id="8145750">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="8145762">,</span>&nbsp;<span class="string" id="8145764">&#34;p&#34;</span><span class="op" id="8145767">,</span>&nbsp;<span class="string" id="8145769">&#34;nowrap&#34;</span><span class="op" id="8145777">}</span><span class="op" id="8145778">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8145782">{</span><span class="string" id="8145783">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="8145796">,</span>&nbsp;<span class="string" id="8145798">&#34;p&#34;</span><span class="op" id="8145801">,</span>&nbsp;<span class="string" id="8145803">&#34;nowrap&#34;</span><span class="op" id="8145811">}</span><span class="op" id="8145812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8145816">{</span><span class="string" id="8145817">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="8145835">,</span>&nbsp;<span class="string" id="8145837">&#34;input&#34;</span><span class="op" id="8145844">,</span>&nbsp;<span class="string" id="8145846">&#34;checked&#34;</span><span class="op" id="8145855">}</span><span class="op" id="8145856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8145860">{</span><span class="string" id="8145861">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="8145880">,</span>&nbsp;<span class="string" id="8145882">&#34;input&#34;</span><span class="op" id="8145889">,</span>&nbsp;<span class="string" id="8145891">&#34;checked&#34;</span><span class="op" id="8145900">}</span><span class="op" id="8145901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8145904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8145907">for</span>&nbsp;<span class="ident" id="8145911">_</span><span class="op" id="8145912">,</span>&nbsp;<span class="ident" id="8145914">test</span>&nbsp;<span class="op" id="8145919">:=</span>&nbsp;<span class="keyword" id="8145922">range</span>&nbsp;<span class="ident" id="8145928">tests</span>&nbsp;<span class="op" id="8145934">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145938">d</span>&nbsp;<span class="op" id="8145940">:=</span>&nbsp;<span class="ident" id="8145943">NewDecoder</span><span class="op" id="8145953">(</span><span class="ident" id="8145954">strings</span><span class="op" id="8145961">.</span><span class="ident" id="8145962">NewReader</span><span class="op" id="8145971">(</span><span class="ident" id="8145972">test</span><span class="op" id="8145976">[</span><span class="num" id="8145977">0</span><span class="op" id="8145978">]</span><span class="op" id="8145979">)</span><span class="op" id="8145980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8145984">d</span><span class="op" id="8145985">.</span><span class="ident" id="8145986">Strict</span>&nbsp;<span class="op" id="8145993">=</span>&nbsp;<span class="builtintype" id="8145995">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146003">token</span><span class="op" id="8146008">,</span>&nbsp;<span class="ident" id="8146010">err</span>&nbsp;<span class="op" id="8146014">:=</span>&nbsp;<span class="ident" id="8146017">d</span><span class="op" id="8146018">.</span><span class="ident" id="8146019">Token</span><span class="op" id="8146024">(</span><span class="op" id="8146025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8146029">if</span>&nbsp;<span class="ident" id="8146032">_</span><span class="op" id="8146033">,</span>&nbsp;<span class="ident" id="8146035">ok</span>&nbsp;<span class="op" id="8146038">:=</span>&nbsp;<span class="ident" id="8146041">err</span><span class="op" id="8146044">.</span><span class="op" id="8146045">(</span><span class="op" id="8146046">*</span><span class="ident" id="8146047">SyntaxError</span><span class="op" id="8146058">)</span><span class="op" id="8146059">;</span>&nbsp;<span class="ident" id="8146061">ok</span>&nbsp;<span class="op" id="8146064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146069">t</span><span class="op" id="8146070">.</span><span class="ident" id="8146071">Errorf</span><span class="op" id="8146077">(</span><span class="string" id="8146078">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8146100">,</span>&nbsp;<span class="ident" id="8146102">err</span><span class="op" id="8146105">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8146109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8146113">if</span>&nbsp;<span class="ident" id="8146116">token</span><span class="op" id="8146121">.</span><span class="op" id="8146122">(</span><span class="ident" id="8146123">StartElement</span><span class="op" id="8146135">)</span><span class="op" id="8146136">.</span><span class="ident" id="8146137">Name</span><span class="op" id="8146141">.</span><span class="ident" id="8146142">Local</span>&nbsp;<span class="op" id="8146148">!=</span>&nbsp;<span class="ident" id="8146151">test</span><span class="op" id="8146155">[</span><span class="num" id="8146156">1</span><span class="op" id="8146157">]</span>&nbsp;<span class="op" id="8146159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146164">t</span><span class="op" id="8146165">.</span><span class="ident" id="8146166">Errorf</span><span class="op" id="8146172">(</span><span class="string" id="8146173">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8146198">,</span>&nbsp;<span class="ident" id="8146200">token</span><span class="op" id="8146205">.</span><span class="op" id="8146206">(</span><span class="ident" id="8146207">StartElement</span><span class="op" id="8146219">)</span><span class="op" id="8146220">.</span><span class="ident" id="8146221">Name</span><span class="op" id="8146225">.</span><span class="ident" id="8146226">Local</span><span class="op" id="8146231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8146235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146239">attr</span>&nbsp;<span class="op" id="8146244">:=</span>&nbsp;<span class="ident" id="8146247">token</span><span class="op" id="8146252">.</span><span class="op" id="8146253">(</span><span class="ident" id="8146254">StartElement</span><span class="op" id="8146266">)</span><span class="op" id="8146267">.</span><span class="ident" id="8146268">Attr</span><span class="op" id="8146272">[</span><span class="num" id="8146273">0</span><span class="op" id="8146274">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8146278">if</span>&nbsp;<span class="ident" id="8146281">attr</span><span class="op" id="8146285">.</span><span class="ident" id="8146286">Value</span>&nbsp;<span class="op" id="8146292">!=</span>&nbsp;<span class="ident" id="8146295">test</span><span class="op" id="8146299">[</span><span class="num" id="8146300">2</span><span class="op" id="8146301">]</span>&nbsp;<span class="op" id="8146303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146308">t</span><span class="op" id="8146309">.</span><span class="ident" id="8146310">Errorf</span><span class="op" id="8146316">(</span><span class="string" id="8146317">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="8146349">,</span>&nbsp;<span class="ident" id="8146351">attr</span><span class="op" id="8146355">.</span><span class="ident" id="8146356">Value</span><span class="op" id="8146361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8146365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8146369">if</span>&nbsp;<span class="ident" id="8146372">attr</span><span class="op" id="8146376">.</span><span class="ident" id="8146377">Name</span><span class="op" id="8146381">.</span><span class="ident" id="8146382">Local</span>&nbsp;<span class="op" id="8146388">!=</span>&nbsp;<span class="ident" id="8146391">test</span><span class="op" id="8146395">[</span><span class="num" id="8146396">2</span><span class="op" id="8146397">]</span>&nbsp;<span class="op" id="8146399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146404">t</span><span class="op" id="8146405">.</span><span class="ident" id="8146406">Errorf</span><span class="op" id="8146412">(</span><span class="string" id="8146413">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8146444">,</span>&nbsp;<span class="ident" id="8146446">attr</span><span class="op" id="8146450">.</span><span class="ident" id="8146451">Name</span><span class="op" id="8146455">.</span><span class="ident" id="8146456">Local</span><span class="op" id="8146461">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8146465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8146468">}</span><br>
<span class="lineno"></span><span class="op" id="8146470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8146473">func</span>&nbsp;<span class="ident" id="8146478">TestCopyTokenCharData</span><span class="op" id="8146499">(</span><span class="ident" id="8146500">t</span>&nbsp;<span class="op" id="8146502">*</span><span class="ident" id="8146503">testing</span><span class="op" id="8146510">.</span><span class="ident" id="8146511">T</span><span class="op" id="8146512">)</span>&nbsp;<span class="op" id="8146514">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146517">data</span>&nbsp;<span class="op" id="8146522">:=</span>&nbsp;<span class="op" id="8146525">[</span><span class="op" id="8146526">]</span><span class="builtintype" id="8146527">byte</span><span class="op" id="8146531">(</span><span class="string" id="8146532">&#34;same&nbsp;data&#34;</span><span class="op" id="8146543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8146546">var</span>&nbsp;<span class="ident" id="8146550">tok1</span>&nbsp;<span class="ident" id="8146555">Token</span>&nbsp;<span class="op" id="8146561">=</span>&nbsp;<span class="ident" id="8146563">CharData</span><span class="op" id="8146571">(</span><span class="ident" id="8146572">data</span><span class="op" id="8146576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146579">tok2</span>&nbsp;<span class="op" id="8146584">:=</span>&nbsp;<span class="ident" id="8146587">CopyToken</span><span class="op" id="8146596">(</span><span class="ident" id="8146597">tok1</span><span class="op" id="8146601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8146604">if</span>&nbsp;<span class="op" id="8146607">!</span><span class="ident" id="8146608">reflect</span><span class="op" id="8146615">.</span><span class="ident" id="8146616">DeepEqual</span><span class="op" id="8146625">(</span><span class="ident" id="8146626">tok1</span><span class="op" id="8146630">,</span>&nbsp;<span class="ident" id="8146632">tok2</span><span class="op" id="8146636">)</span>&nbsp;<span class="op" id="8146638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146642">t</span><span class="op" id="8146643">.</span><span class="ident" id="8146644">Error</span><span class="op" id="8146649">(</span><span class="string" id="8146650">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="8146683">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8146686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146689">data</span><span class="op" id="8146693">[</span><span class="num" id="8146694">1</span><span class="op" id="8146695">]</span>&nbsp;<span class="op" id="8146697">=</span>&nbsp;<span class="string" id="8146699">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8146704">if</span>&nbsp;<span class="ident" id="8146707">reflect</span><span class="op" id="8146714">.</span><span class="ident" id="8146715">DeepEqual</span><span class="op" id="8146724">(</span><span class="ident" id="8146725">tok1</span><span class="op" id="8146729">,</span>&nbsp;<span class="ident" id="8146731">tok2</span><span class="op" id="8146735">)</span>&nbsp;<span class="op" id="8146737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146741">t</span><span class="op" id="8146742">.</span><span class="ident" id="8146743">Error</span><span class="op" id="8146748">(</span><span class="string" id="8146749">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="8146788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8146791">}</span><br>
<span class="lineno">555</span><span class="op" id="8146793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8146796">func</span>&nbsp;<span class="ident" id="8146801">TestCopyTokenStartElement</span><span class="op" id="8146826">(</span><span class="ident" id="8146827">t</span>&nbsp;<span class="op" id="8146829">*</span><span class="ident" id="8146830">testing</span><span class="op" id="8146837">.</span><span class="ident" id="8146838">T</span><span class="op" id="8146839">)</span>&nbsp;<span class="op" id="8146841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146844">elt</span>&nbsp;<span class="op" id="8146848">:=</span>&nbsp;<span class="ident" id="8146851">StartElement</span><span class="op" id="8146863">{</span><span class="ident" id="8146864">Name</span><span class="op" id="8146868">{</span><span class="string" id="8146869">&#34;&#34;</span><span class="op" id="8146871">,</span>&nbsp;<span class="string" id="8146873">&#34;hello&#34;</span><span class="op" id="8146880">}</span><span class="op" id="8146881">,</span>&nbsp;<span class="op" id="8146883">[</span><span class="op" id="8146884">]</span><span class="ident" id="8146885">Attr</span><span class="op" id="8146889">{</span><span class="op" id="8146890">{</span><span class="ident" id="8146891">Name</span><span class="op" id="8146895">{</span><span class="string" id="8146896">&#34;&#34;</span><span class="op" id="8146898">,</span>&nbsp;<span class="string" id="8146900">&#34;lang&#34;</span><span class="op" id="8146906">}</span><span class="op" id="8146907">,</span>&nbsp;<span class="string" id="8146909">&#34;en&#34;</span><span class="op" id="8146913">}</span><span class="op" id="8146914">}</span><span class="op" id="8146915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8146918">var</span>&nbsp;<span class="ident" id="8146922">tok1</span>&nbsp;<span class="ident" id="8146927">Token</span>&nbsp;<span class="op" id="8146933">=</span>&nbsp;<span class="ident" id="8146935">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8146940">tok2</span>&nbsp;<span class="op" id="8146945">:=</span>&nbsp;<span class="ident" id="8146948">CopyToken</span><span class="op" id="8146957">(</span><span class="ident" id="8146958">tok1</span><span class="op" id="8146962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8146965">if</span>&nbsp;<span class="ident" id="8146968">tok1</span><span class="op" id="8146972">.</span><span class="op" id="8146973">(</span><span class="ident" id="8146974">StartElement</span><span class="op" id="8146986">)</span><span class="op" id="8146987">.</span><span class="ident" id="8146988">Attr</span><span class="op" id="8146992">[</span><span class="num" id="8146993">0</span><span class="op" id="8146994">]</span><span class="op" id="8146995">.</span><span class="ident" id="8146996">Value</span>&nbsp;<span class="op" id="8147002">!=</span>&nbsp;<span class="string" id="8147005">&#34;en&#34;</span>&nbsp;<span class="op" id="8147010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147014">t</span><span class="op" id="8147015">.</span><span class="ident" id="8147016">Error</span><span class="op" id="8147021">(</span><span class="string" id="8147022">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="8147051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8147054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8147057">if</span>&nbsp;<span class="op" id="8147060">!</span><span class="ident" id="8147061">reflect</span><span class="op" id="8147068">.</span><span class="ident" id="8147069">DeepEqual</span><span class="op" id="8147078">(</span><span class="ident" id="8147079">tok1</span><span class="op" id="8147083">,</span>&nbsp;<span class="ident" id="8147085">tok2</span><span class="op" id="8147089">)</span>&nbsp;<span class="op" id="8147091">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147095">t</span><span class="op" id="8147096">.</span><span class="ident" id="8147097">Error</span><span class="op" id="8147102">(</span><span class="string" id="8147103">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="8147144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8147147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147150">tok1</span><span class="op" id="8147154">.</span><span class="op" id="8147155">(</span><span class="ident" id="8147156">StartElement</span><span class="op" id="8147168">)</span><span class="op" id="8147169">.</span><span class="ident" id="8147170">Attr</span><span class="op" id="8147174">[</span><span class="num" id="8147175">0</span><span class="op" id="8147176">]</span>&nbsp;<span class="op" id="8147178">=</span>&nbsp;<span class="ident" id="8147180">Attr</span><span class="op" id="8147184">{</span><span class="ident" id="8147185">Name</span><span class="op" id="8147189">{</span><span class="string" id="8147190">&#34;&#34;</span><span class="op" id="8147192">,</span>&nbsp;<span class="string" id="8147194">&#34;lang&#34;</span><span class="op" id="8147200">}</span><span class="op" id="8147201">,</span>&nbsp;<span class="string" id="8147203">&#34;de&#34;</span><span class="op" id="8147207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8147210">if</span>&nbsp;<span class="ident" id="8147213">reflect</span><span class="op" id="8147220">.</span><span class="ident" id="8147221">DeepEqual</span><span class="op" id="8147230">(</span><span class="ident" id="8147231">tok1</span><span class="op" id="8147235">,</span>&nbsp;<span class="ident" id="8147237">tok2</span><span class="op" id="8147241">)</span>&nbsp;<span class="op" id="8147243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147247">t</span><span class="op" id="8147248">.</span><span class="ident" id="8147249">Error</span><span class="op" id="8147254">(</span><span class="string" id="8147255">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="8147294">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8147297">}</span><br>
<span class="lineno"></span><span class="op" id="8147299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8147302">func</span>&nbsp;<span class="ident" id="8147307">TestSyntaxErrorLineNum</span><span class="op" id="8147329">(</span><span class="ident" id="8147330">t</span>&nbsp;<span class="op" id="8147332">*</span><span class="ident" id="8147333">testing</span><span class="op" id="8147340">.</span><span class="ident" id="8147341">T</span><span class="op" id="8147342">)</span>&nbsp;<span class="op" id="8147344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147347">testInput</span>&nbsp;<span class="op" id="8147357">:=</span>&nbsp;<span class="string" id="8147360">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147388">d</span>&nbsp;<span class="op" id="8147390">:=</span>&nbsp;<span class="ident" id="8147393">NewDecoder</span><span class="op" id="8147403">(</span><span class="ident" id="8147404">strings</span><span class="op" id="8147411">.</span><span class="ident" id="8147412">NewReader</span><span class="op" id="8147421">(</span><span class="ident" id="8147422">testInput</span><span class="op" id="8147431">)</span><span class="op" id="8147432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8147435">var</span>&nbsp;<span class="ident" id="8147439">err</span>&nbsp;<span class="builtintype" id="8147443">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8147450">for</span>&nbsp;<span class="ident" id="8147454">_</span><span class="op" id="8147455">,</span>&nbsp;<span class="ident" id="8147457">err</span>&nbsp;<span class="op" id="8147461">=</span>&nbsp;<span class="ident" id="8147463">d</span><span class="op" id="8147464">.</span><span class="ident" id="8147465">Token</span><span class="op" id="8147470">(</span><span class="op" id="8147471">)</span><span class="op" id="8147472">;</span>&nbsp;<span class="ident" id="8147474">err</span>&nbsp;<span class="op" id="8147478">==</span>&nbsp;<span class="ident" id="8147481">nil</span><span class="op" id="8147484">;</span>&nbsp;<span class="ident" id="8147486">_</span><span class="op" id="8147487">,</span>&nbsp;<span class="ident" id="8147489">err</span>&nbsp;<span class="op" id="8147493">=</span>&nbsp;<span class="ident" id="8147495">d</span><span class="op" id="8147496">.</span><span class="ident" id="8147497">Token</span><span class="op" id="8147502">(</span><span class="op" id="8147503">)</span>&nbsp;<span class="op" id="8147505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8147508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147511">synerr</span><span class="op" id="8147517">,</span>&nbsp;<span class="ident" id="8147519">ok</span>&nbsp;<span class="op" id="8147522">:=</span>&nbsp;<span class="ident" id="8147525">err</span><span class="op" id="8147528">.</span><span class="op" id="8147529">(</span><span class="op" id="8147530">*</span><span class="ident" id="8147531">SyntaxError</span><span class="op" id="8147542">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8147545">if</span>&nbsp;<span class="op" id="8147548">!</span><span class="ident" id="8147549">ok</span>&nbsp;<span class="op" id="8147552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147556">t</span><span class="op" id="8147557">.</span><span class="ident" id="8147558">Error</span><span class="op" id="8147563">(</span><span class="string" id="8147564">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="8147587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8147590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8147593">if</span>&nbsp;<span class="ident" id="8147596">synerr</span><span class="op" id="8147602">.</span><span class="ident" id="8147603">Line</span>&nbsp;<span class="op" id="8147608">!=</span>&nbsp;<span class="num" id="8147611">3</span>&nbsp;<span class="op" id="8147613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147617">t</span><span class="op" id="8147618">.</span><span class="ident" id="8147619">Error</span><span class="op" id="8147624">(</span><span class="string" id="8147625">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="8147671">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8147674">}</span><br>
<span class="lineno"></span><span class="op" id="8147676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8147679">func</span>&nbsp;<span class="ident" id="8147684">TestTrailingRawToken</span><span class="op" id="8147704">(</span><span class="ident" id="8147705">t</span>&nbsp;<span class="op" id="8147707">*</span><span class="ident" id="8147708">testing</span><span class="op" id="8147715">.</span><span class="ident" id="8147716">T</span><span class="op" id="8147717">)</span>&nbsp;<span class="op" id="8147719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147722">input</span>&nbsp;<span class="op" id="8147728">:=</span>&nbsp;<span class="string" id="8147731">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147748">d</span>&nbsp;<span class="op" id="8147750">:=</span>&nbsp;<span class="ident" id="8147753">NewDecoder</span><span class="op" id="8147763">(</span><span class="ident" id="8147764">strings</span><span class="op" id="8147771">.</span><span class="ident" id="8147772">NewReader</span><span class="op" id="8147781">(</span><span class="ident" id="8147782">input</span><span class="op" id="8147787">)</span><span class="op" id="8147788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8147791">var</span>&nbsp;<span class="ident" id="8147795">err</span>&nbsp;<span class="builtintype" id="8147799">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8147806">for</span>&nbsp;<span class="ident" id="8147810">_</span><span class="op" id="8147811">,</span>&nbsp;<span class="ident" id="8147813">err</span>&nbsp;<span class="op" id="8147817">=</span>&nbsp;<span class="ident" id="8147819">d</span><span class="op" id="8147820">.</span><span class="ident" id="8147821">RawToken</span><span class="op" id="8147829">(</span><span class="op" id="8147830">)</span><span class="op" id="8147831">;</span>&nbsp;<span class="ident" id="8147833">err</span>&nbsp;<span class="op" id="8147837">==</span>&nbsp;<span class="ident" id="8147840">nil</span><span class="op" id="8147843">;</span>&nbsp;<span class="ident" id="8147845">_</span><span class="op" id="8147846">,</span>&nbsp;<span class="ident" id="8147848">err</span>&nbsp;<span class="op" id="8147852">=</span>&nbsp;<span class="ident" id="8147854">d</span><span class="op" id="8147855">.</span><span class="ident" id="8147856">RawToken</span><span class="op" id="8147864">(</span><span class="op" id="8147865">)</span>&nbsp;<span class="op" id="8147867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8147870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8147873">if</span>&nbsp;<span class="ident" id="8147876">err</span>&nbsp;<span class="op" id="8147880">!=</span>&nbsp;<span class="ident" id="8147883">io</span><span class="op" id="8147885">.</span><span class="ident" id="8147886">EOF</span>&nbsp;<span class="op" id="8147890">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147894">t</span><span class="op" id="8147895">.</span><span class="ident" id="8147896">Fatalf</span><span class="op" id="8147902">(</span><span class="string" id="8147903">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8147941">,</span>&nbsp;<span class="ident" id="8147943">err</span><span class="op" id="8147946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8147949">}</span><br>
<span class="lineno"></span><span class="op" id="8147951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8147954">func</span>&nbsp;<span class="ident" id="8147959">TestTrailingToken</span><span class="op" id="8147976">(</span><span class="ident" id="8147977">t</span>&nbsp;<span class="op" id="8147979">*</span><span class="ident" id="8147980">testing</span><span class="op" id="8147987">.</span><span class="ident" id="8147988">T</span><span class="op" id="8147989">)</span>&nbsp;<span class="op" id="8147991">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8147994">input</span>&nbsp;<span class="op" id="8148000">:=</span>&nbsp;<span class="string" id="8148003">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8148020">d</span>&nbsp;<span class="op" id="8148022">:=</span>&nbsp;<span class="ident" id="8148025">NewDecoder</span><span class="op" id="8148035">(</span><span class="ident" id="8148036">strings</span><span class="op" id="8148043">.</span><span class="ident" id="8148044">NewReader</span><span class="op" id="8148053">(</span><span class="ident" id="8148054">input</span><span class="op" id="8148059">)</span><span class="op" id="8148060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8148063">var</span>&nbsp;<span class="ident" id="8148067">err</span>&nbsp;<span class="builtintype" id="8148071">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8148078">for</span>&nbsp;<span class="ident" id="8148082">_</span><span class="op" id="8148083">,</span>&nbsp;<span class="ident" id="8148085">err</span>&nbsp;<span class="op" id="8148089">=</span>&nbsp;<span class="ident" id="8148091">d</span><span class="op" id="8148092">.</span><span class="ident" id="8148093">Token</span><span class="op" id="8148098">(</span><span class="op" id="8148099">)</span><span class="op" id="8148100">;</span>&nbsp;<span class="ident" id="8148102">err</span>&nbsp;<span class="op" id="8148106">==</span>&nbsp;<span class="ident" id="8148109">nil</span><span class="op" id="8148112">;</span>&nbsp;<span class="ident" id="8148114">_</span><span class="op" id="8148115">,</span>&nbsp;<span class="ident" id="8148117">err</span>&nbsp;<span class="op" id="8148121">=</span>&nbsp;<span class="ident" id="8148123">d</span><span class="op" id="8148124">.</span><span class="ident" id="8148125">Token</span><span class="op" id="8148130">(</span><span class="op" id="8148131">)</span>&nbsp;<span class="op" id="8148133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8148136">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8148139">if</span>&nbsp;<span class="ident" id="8148142">err</span>&nbsp;<span class="op" id="8148146">!=</span>&nbsp;<span class="ident" id="8148149">io</span><span class="op" id="8148151">.</span><span class="ident" id="8148152">EOF</span>&nbsp;<span class="op" id="8148156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8148160">t</span><span class="op" id="8148161">.</span><span class="ident" id="8148162">Fatalf</span><span class="op" id="8148168">(</span><span class="string" id="8148169">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8148204">,</span>&nbsp;<span class="ident" id="8148206">err</span><span class="op" id="8148209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8148212">}</span><br>
<span class="lineno"></span><span class="op" id="8148214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="8148217">func</span>&nbsp;<span class="ident" id="8148222">TestEntityInsideCDATA</span><span class="op" id="8148243">(</span><span class="ident" id="8148244">t</span>&nbsp;<span class="op" id="8148246">*</span><span class="ident" id="8148247">testing</span><span class="op" id="8148254">.</span><span class="ident" id="8148255">T</span><span class="op" id="8148256">)</span>&nbsp;<span class="op" id="8148258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8148261">input</span>&nbsp;<span class="op" id="8148267">:=</span>&nbsp;<span class="string" id="8148270">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8148309">d</span>&nbsp;<span class="op" id="8148311">:=</span>&nbsp;<span class="ident" id="8148314">NewDecoder</span><span class="op" id="8148324">(</span><span class="ident" id="8148325">strings</span><span class="op" id="8148332">.</span><span class="ident" id="8148333">NewReader</span><span class="op" id="8148342">(</span><span class="ident" id="8148343">input</span><span class="op" id="8148348">)</span><span class="op" id="8148349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8148352">var</span>&nbsp;<span class="ident" id="8148356">err</span>&nbsp;<span class="builtintype" id="8148360">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8148367">for</span>&nbsp;<span class="ident" id="8148371">_</span><span class="op" id="8148372">,</span>&nbsp;<span class="ident" id="8148374">err</span>&nbsp;<span class="op" id="8148378">=</span>&nbsp;<span class="ident" id="8148380">d</span><span class="op" id="8148381">.</span><span class="ident" id="8148382">Token</span><span class="op" id="8148387">(</span><span class="op" id="8148388">)</span><span class="op" id="8148389">;</span>&nbsp;<span class="ident" id="8148391">err</span>&nbsp;<span class="op" id="8148395">==</span>&nbsp;<span class="ident" id="8148398">nil</span><span class="op" id="8148401">;</span>&nbsp;<span class="ident" id="8148403">_</span><span class="op" id="8148404">,</span>&nbsp;<span class="ident" id="8148406">err</span>&nbsp;<span class="op" id="8148410">=</span>&nbsp;<span class="ident" id="8148412">d</span><span class="op" id="8148413">.</span><span class="ident" id="8148414">Token</span><span class="op" id="8148419">(</span><span class="op" id="8148420">)</span>&nbsp;<span class="op" id="8148422">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8148425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8148428">if</span>&nbsp;<span class="ident" id="8148431">err</span>&nbsp;<span class="op" id="8148435">!=</span>&nbsp;<span class="ident" id="8148438">io</span><span class="op" id="8148440">.</span><span class="ident" id="8148441">EOF</span>&nbsp;<span class="op" id="8148445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8148449">t</span><span class="op" id="8148450">.</span><span class="ident" id="8148451">Fatalf</span><span class="op" id="8148457">(</span><span class="string" id="8148458">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8148493">,</span>&nbsp;<span class="ident" id="8148495">err</span><span class="op" id="8148498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8148501">}</span><br>
<span class="lineno"></span><span class="op" id="8148503">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="8148506">var</span>&nbsp;<span class="ident" id="8148510">characterTests</span>&nbsp;<span class="op" id="8148525">=</span>&nbsp;<span class="op" id="8148527">[</span><span class="op" id="8148528">]</span><span class="keyword" id="8148529">struct</span>&nbsp;<span class="op" id="8148536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8148539">in</span>&nbsp;&nbsp;<span class="builtintype" id="8148543">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8148551">err</span>&nbsp;<span class="builtintype" id="8148555">string</span><br>
<span class="lineno"></span><span class="op" id="8148562">}</span><span class="op" id="8148563">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8148566">{</span><span class="string" id="8148567">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="8148579">,</span>&nbsp;<span class="string" id="8148581">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="8148612">}</span><span class="op" id="8148613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8148616">{</span><span class="string" id="8148617">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="8148652">,</span>&nbsp;<span class="string" id="8148654">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="8148685">}</span><span class="op" id="8148686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8148689">{</span><span class="string" id="8148690">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="8148710">,</span>&nbsp;<span class="string" id="8148712">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="8148743">}</span><span class="op" id="8148744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8148747">{</span><span class="string" id="8148748">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="8148807">,</span>&nbsp;<span class="string" id="8148809">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="8148840">}</span><span class="op" id="8148841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8148844">{</span><span class="string" id="8148845">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="8148903">,</span>&nbsp;<span class="string" id="8148905">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="8148941">}</span><span class="op" id="8148942">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8148945">{</span><span class="string" id="8148946">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="8148968">,</span>&nbsp;<span class="string" id="8148970">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="8149016">}</span><span class="op" id="8149017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8149020">{</span><span class="string" id="8149021">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="8149040">,</span>&nbsp;<span class="string" id="8149042">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="8149085">}</span><span class="op" id="8149086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8149089">{</span><span class="string" id="8149090">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="8149117">,</span>&nbsp;<span class="string" id="8149119">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="8149154">}</span><span class="op" id="8149155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8149158">{</span><span class="string" id="8149159">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="8149179">,</span>&nbsp;<span class="string" id="8149181">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="8149215">}</span><span class="op" id="8149216">,</span><br>
<span class="lineno"></span><span class="op" id="8149218">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="8149221">func</span>&nbsp;<span class="ident" id="8149226">TestDisallowedCharacters</span><span class="op" id="8149250">(</span><span class="ident" id="8149251">t</span>&nbsp;<span class="op" id="8149253">*</span><span class="ident" id="8149254">testing</span><span class="op" id="8149261">.</span><span class="ident" id="8149262">T</span><span class="op" id="8149263">)</span>&nbsp;<span class="op" id="8149265">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8149269">for</span>&nbsp;<span class="ident" id="8149273">i</span><span class="op" id="8149274">,</span>&nbsp;<span class="ident" id="8149276">tt</span>&nbsp;<span class="op" id="8149279">:=</span>&nbsp;<span class="keyword" id="8149282">range</span>&nbsp;<span class="ident" id="8149288">characterTests</span>&nbsp;<span class="op" id="8149303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8149307">d</span>&nbsp;<span class="op" id="8149309">:=</span>&nbsp;<span class="ident" id="8149312">NewDecoder</span><span class="op" id="8149322">(</span><span class="ident" id="8149323">strings</span><span class="op" id="8149330">.</span><span class="ident" id="8149331">NewReader</span><span class="op" id="8149340">(</span><span class="ident" id="8149341">tt</span><span class="op" id="8149343">.</span><span class="ident" id="8149344">in</span><span class="op" id="8149346">)</span><span class="op" id="8149347">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8149351">var</span>&nbsp;<span class="ident" id="8149355">err</span>&nbsp;<span class="builtintype" id="8149359">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8149368">for</span>&nbsp;<span class="ident" id="8149372">err</span>&nbsp;<span class="op" id="8149376">==</span>&nbsp;<span class="ident" id="8149379">nil</span>&nbsp;<span class="op" id="8149383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8149388">_</span><span class="op" id="8149389">,</span>&nbsp;<span class="ident" id="8149391">err</span>&nbsp;<span class="op" id="8149395">=</span>&nbsp;<span class="ident" id="8149397">d</span><span class="op" id="8149398">.</span><span class="ident" id="8149399">Token</span><span class="op" id="8149404">(</span><span class="op" id="8149405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8149409">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8149413">synerr</span><span class="op" id="8149419">,</span>&nbsp;<span class="ident" id="8149421">ok</span>&nbsp;<span class="op" id="8149424">:=</span>&nbsp;<span class="ident" id="8149427">err</span><span class="op" id="8149430">.</span><span class="op" id="8149431">(</span><span class="op" id="8149432">*</span><span class="ident" id="8149433">SyntaxError</span><span class="op" id="8149444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8149448">if</span>&nbsp;<span class="op" id="8149451">!</span><span class="ident" id="8149452">ok</span>&nbsp;<span class="op" id="8149455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8149460">t</span><span class="op" id="8149461">.</span><span class="ident" id="8149462">Fatalf</span><span class="op" id="8149468">(</span><span class="string" id="8149469">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="8149519">,</span>&nbsp;<span class="ident" id="8149521">i</span><span class="op" id="8149522">,</span>&nbsp;<span class="ident" id="8149524">err</span><span class="op" id="8149527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8149531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8149535">if</span>&nbsp;<span class="ident" id="8149538">synerr</span><span class="op" id="8149544">.</span><span class="ident" id="8149545">Msg</span>&nbsp;<span class="op" id="8149549">!=</span>&nbsp;<span class="ident" id="8149552">tt</span><span class="op" id="8149554">.</span><span class="ident" id="8149555">err</span>&nbsp;<span class="op" id="8149559">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8149564">t</span><span class="op" id="8149565">.</span><span class="ident" id="8149566">Fatalf</span><span class="op" id="8149572">(</span><span class="string" id="8149573">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8149617">,</span>&nbsp;<span class="ident" id="8149619">i</span><span class="op" id="8149620">,</span>&nbsp;<span class="ident" id="8149622">tt</span><span class="op" id="8149624">.</span><span class="ident" id="8149625">err</span><span class="op" id="8149628">,</span>&nbsp;<span class="ident" id="8149630">synerr</span><span class="op" id="8149636">.</span><span class="ident" id="8149637">Msg</span><span class="op" id="8149640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8149644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8149647">}</span><br>
<span class="lineno"></span><span class="op" id="8149649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="8149652">type</span>&nbsp;<span class="ident" id="8149657">procInstEncodingTest</span>&nbsp;<span class="keyword" id="8149678">struct</span>&nbsp;<span class="op" id="8149685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8149688">expect</span><span class="op" id="8149694">,</span>&nbsp;<span class="ident" id="8149696">got</span>&nbsp;<span class="builtintype" id="8149700">string</span><br>
<span class="lineno"></span><span class="op" id="8149707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8149710">var</span>&nbsp;<span class="ident" id="8149714">procInstTests</span>&nbsp;<span class="op" id="8149728">=</span>&nbsp;<span class="op" id="8149730">[</span><span class="op" id="8149731">]</span><span class="keyword" id="8149732">struct</span>&nbsp;<span class="op" id="8149739">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8149742">input</span><span class="op" id="8149747">,</span>&nbsp;<span class="ident" id="8149749">expect</span>&nbsp;<span class="builtintype" id="8149756">string</span><br>
<span class="lineno"></span><span class="op" id="8149763">}</span><span class="op" id="8149764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8149767">{</span><span class="string" id="8149768">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="8149800">,</span>&nbsp;<span class="string" id="8149802">&#34;utf-8&#34;</span><span class="op" id="8149809">}</span><span class="op" id="8149810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8149813">{</span><span class="string" id="8149814">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="8149846">,</span>&nbsp;<span class="string" id="8149848">&#34;utf-8&#34;</span><span class="op" id="8149855">}</span><span class="op" id="8149856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8149859">{</span><span class="string" id="8149860">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="8149893">,</span>&nbsp;<span class="string" id="8149895">&#34;utf-8&#34;</span><span class="op" id="8149902">}</span><span class="op" id="8149903">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8149906">{</span><span class="string" id="8149907">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="8149937">,</span>&nbsp;<span class="string" id="8149939">&#34;&#34;</span><span class="op" id="8149941">}</span><span class="op" id="8149942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8149945">{</span><span class="string" id="8149946">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="8149963">,</span>&nbsp;<span class="string" id="8149965">&#34;FOO&#34;</span><span class="op" id="8149970">}</span><span class="op" id="8149971">,</span><br>
<span class="lineno"></span><span class="op" id="8149973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8149976">func</span>&nbsp;<span class="ident" id="8149981">TestProcInstEncoding</span><span class="op" id="8150001">(</span><span class="ident" id="8150002">t</span>&nbsp;<span class="op" id="8150004">*</span><span class="ident" id="8150005">testing</span><span class="op" id="8150012">.</span><span class="ident" id="8150013">T</span><span class="op" id="8150014">)</span>&nbsp;<span class="op" id="8150016">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8150019">for</span>&nbsp;<span class="ident" id="8150023">_</span><span class="op" id="8150024">,</span>&nbsp;<span class="ident" id="8150026">test</span>&nbsp;<span class="op" id="8150031">:=</span>&nbsp;<span class="keyword" id="8150034">range</span>&nbsp;<span class="ident" id="8150040">procInstTests</span>&nbsp;<span class="op" id="8150054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8150058">got</span>&nbsp;<span class="op" id="8150062">:=</span>&nbsp;<span class="ident" id="8150065">procInstEncoding</span><span class="op" id="8150081">(</span><span class="ident" id="8150082">test</span><span class="op" id="8150086">.</span><span class="ident" id="8150087">input</span><span class="op" id="8150092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8150096">if</span>&nbsp;<span class="ident" id="8150099">got</span>&nbsp;<span class="op" id="8150103">!=</span>&nbsp;<span class="ident" id="8150106">test</span><span class="op" id="8150110">.</span><span class="ident" id="8150111">expect</span>&nbsp;<span class="op" id="8150118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8150123">t</span><span class="op" id="8150124">.</span><span class="ident" id="8150125">Errorf</span><span class="op" id="8150131">(</span><span class="string" id="8150132">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8150168">,</span>&nbsp;<span class="ident" id="8150170">test</span><span class="op" id="8150174">.</span><span class="ident" id="8150175">input</span><span class="op" id="8150180">,</span>&nbsp;<span class="ident" id="8150182">got</span><span class="op" id="8150185">,</span>&nbsp;<span class="ident" id="8150187">test</span><span class="op" id="8150191">.</span><span class="ident" id="8150192">expect</span><span class="op" id="8150198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8150202">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8150205">}</span><br>
<span class="lineno"></span><span class="op" id="8150207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8150210">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="8150271">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="8150306">var</span>&nbsp;<span class="ident" id="8150310">directivesWithCommentsInput</span>&nbsp;<span class="op" id="8150338">=</span>&nbsp;<span class="string" id="8150340">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8150576">var</span>&nbsp;<span class="ident" id="8150580">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="8150609">=</span>&nbsp;<span class="op" id="8150611">[</span><span class="op" id="8150612">]</span><span class="ident" id="8150613">Token</span><span class="op" id="8150618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8150621">CharData</span><span class="op" id="8150629">(</span><span class="string" id="8150630">&#34;\n&#34;</span><span class="op" id="8150634">)</span><span class="op" id="8150635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8150638">Directive</span><span class="op" id="8150647">(</span><span class="string" id="8150648">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="8150719">)</span><span class="op" id="8150720">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8150723">CharData</span><span class="op" id="8150731">(</span><span class="string" id="8150732">&#34;\n&#34;</span><span class="op" id="8150736">)</span><span class="op" id="8150737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8150740">Directive</span><span class="op" id="8150749">(</span><span class="string" id="8150750">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="8150783">)</span><span class="op" id="8150784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8150787">CharData</span><span class="op" id="8150795">(</span><span class="string" id="8150796">&#34;\n&#34;</span><span class="op" id="8150800">)</span><span class="op" id="8150801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8150804">Directive</span><span class="op" id="8150813">(</span><span class="string" id="8150814">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="8150859">)</span><span class="op" id="8150860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8150863">CharData</span><span class="op" id="8150871">(</span><span class="string" id="8150872">&#34;\n&#34;</span><span class="op" id="8150876">)</span><span class="op" id="8150877">,</span><br>
<span class="lineno">695</span><span class="op" id="8150879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8150882">func</span>&nbsp;<span class="ident" id="8150887">TestDirectivesWithComments</span><span class="op" id="8150913">(</span><span class="ident" id="8150914">t</span>&nbsp;<span class="op" id="8150916">*</span><span class="ident" id="8150917">testing</span><span class="op" id="8150924">.</span><span class="ident" id="8150925">T</span><span class="op" id="8150926">)</span>&nbsp;<span class="op" id="8150928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8150931">d</span>&nbsp;<span class="op" id="8150933">:=</span>&nbsp;<span class="ident" id="8150936">NewDecoder</span><span class="op" id="8150946">(</span><span class="ident" id="8150947">strings</span><span class="op" id="8150954">.</span><span class="ident" id="8150955">NewReader</span><span class="op" id="8150964">(</span><span class="ident" id="8150965">directivesWithCommentsInput</span><span class="op" id="8150992">)</span><span class="op" id="8150993">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8150997">for</span>&nbsp;<span class="ident" id="8151001">i</span><span class="op" id="8151002">,</span>&nbsp;<span class="ident" id="8151004">want</span>&nbsp;<span class="op" id="8151009">:=</span>&nbsp;<span class="keyword" id="8151012">range</span>&nbsp;<span class="ident" id="8151018">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="8151047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8151051">have</span><span class="op" id="8151055">,</span>&nbsp;<span class="ident" id="8151057">err</span>&nbsp;<span class="op" id="8151061">:=</span>&nbsp;<span class="ident" id="8151064">d</span><span class="op" id="8151065">.</span><span class="ident" id="8151066">Token</span><span class="op" id="8151071">(</span><span class="op" id="8151072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8151076">if</span>&nbsp;<span class="ident" id="8151079">err</span>&nbsp;<span class="op" id="8151083">!=</span>&nbsp;<span class="ident" id="8151086">nil</span>&nbsp;<span class="op" id="8151090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8151095">t</span><span class="op" id="8151096">.</span><span class="ident" id="8151097">Fatalf</span><span class="op" id="8151103">(</span><span class="string" id="8151104">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8151136">,</span>&nbsp;<span class="ident" id="8151138">i</span><span class="op" id="8151139">,</span>&nbsp;<span class="ident" id="8151141">err</span><span class="op" id="8151144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8151148">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8151152">if</span>&nbsp;<span class="op" id="8151155">!</span><span class="ident" id="8151156">reflect</span><span class="op" id="8151163">.</span><span class="ident" id="8151164">DeepEqual</span><span class="op" id="8151173">(</span><span class="ident" id="8151174">have</span><span class="op" id="8151178">,</span>&nbsp;<span class="ident" id="8151180">want</span><span class="op" id="8151184">)</span>&nbsp;<span class="op" id="8151186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8151191">t</span><span class="op" id="8151192">.</span><span class="ident" id="8151193">Errorf</span><span class="op" id="8151199">(</span><span class="string" id="8151200">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8151225">,</span>&nbsp;<span class="ident" id="8151227">i</span><span class="op" id="8151228">,</span>&nbsp;<span class="ident" id="8151230">have</span><span class="op" id="8151234">,</span>&nbsp;<span class="ident" id="8151236">want</span><span class="op" id="8151240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8151244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8151247">}</span><br>
<span class="lineno"></span><span class="op" id="8151249">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="8151252">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="8151306">type</span>&nbsp;<span class="ident" id="8151311">errWriter</span>&nbsp;<span class="keyword" id="8151321">struct</span><span class="op" id="8151327">{</span><span class="op" id="8151328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8151331">func</span>&nbsp;<span class="op" id="8151336">(</span><span class="ident" id="8151337">errWriter</span><span class="op" id="8151346">)</span>&nbsp;<span class="ident" id="8151348">Write</span><span class="op" id="8151353">(</span><span class="ident" id="8151354">p</span>&nbsp;<span class="op" id="8151356">[</span><span class="op" id="8151357">]</span><span class="builtintype" id="8151358">byte</span><span class="op" id="8151362">)</span>&nbsp;<span class="op" id="8151364">(</span><span class="ident" id="8151365">n</span>&nbsp;<span class="builtintype" id="8151367">int</span><span class="op" id="8151370">,</span>&nbsp;<span class="ident" id="8151372">err</span>&nbsp;<span class="builtintype" id="8151376">error</span><span class="op" id="8151381">)</span>&nbsp;<span class="op" id="8151383">{</span>&nbsp;<span class="keyword" id="8151385">return</span>&nbsp;<span class="num" id="8151392">0</span><span class="op" id="8151393">,</span>&nbsp;<span class="ident" id="8151395">fmt</span><span class="op" id="8151398">.</span><span class="ident" id="8151399">Errorf</span><span class="op" id="8151405">(</span><span class="string" id="8151406">&#34;unwritable&#34;</span><span class="op" id="8151418">)</span>&nbsp;<span class="op" id="8151420">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="8151423">func</span>&nbsp;<span class="ident" id="8151428">TestEscapeTextIOErrors</span><span class="op" id="8151450">(</span><span class="ident" id="8151451">t</span>&nbsp;<span class="op" id="8151453">*</span><span class="ident" id="8151454">testing</span><span class="op" id="8151461">.</span><span class="ident" id="8151462">T</span><span class="op" id="8151463">)</span>&nbsp;<span class="op" id="8151465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8151468">expectErr</span>&nbsp;<span class="op" id="8151478">:=</span>&nbsp;<span class="string" id="8151481">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8151495">err</span>&nbsp;<span class="op" id="8151499">:=</span>&nbsp;<span class="ident" id="8151502">EscapeText</span><span class="op" id="8151512">(</span><span class="ident" id="8151513">errWriter</span><span class="op" id="8151522">{</span><span class="op" id="8151523">}</span><span class="op" id="8151524">,</span>&nbsp;<span class="op" id="8151526">[</span><span class="op" id="8151527">]</span><span class="builtintype" id="8151528">byte</span><span class="op" id="8151532">{</span><span class="string" id="8151533">&#39;A&#39;</span><span class="op" id="8151536">}</span><span class="op" id="8151537">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8151541">if</span>&nbsp;<span class="ident" id="8151544">err</span>&nbsp;<span class="op" id="8151548">==</span>&nbsp;<span class="ident" id="8151551">nil</span>&nbsp;<span class="op" id="8151555">||</span>&nbsp;<span class="ident" id="8151558">err</span><span class="op" id="8151561">.</span><span class="ident" id="8151562">Error</span><span class="op" id="8151567">(</span><span class="op" id="8151568">)</span>&nbsp;<span class="op" id="8151570">!=</span>&nbsp;<span class="ident" id="8151573">expectErr</span>&nbsp;<span class="op" id="8151583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8151587">t</span><span class="op" id="8151588">.</span><span class="ident" id="8151589">Errorf</span><span class="op" id="8151595">(</span><span class="string" id="8151596">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8151614">,</span>&nbsp;<span class="ident" id="8151616">err</span><span class="op" id="8151619">,</span>&nbsp;<span class="ident" id="8151621">expectErr</span><span class="op" id="8151630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8151633">}</span><br>
<span class="lineno"></span><span class="op" id="8151635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="8151638">func</span>&nbsp;<span class="ident" id="8151643">TestEscapeTextInvalidChar</span><span class="op" id="8151668">(</span><span class="ident" id="8151669">t</span>&nbsp;<span class="op" id="8151671">*</span><span class="ident" id="8151672">testing</span><span class="op" id="8151679">.</span><span class="ident" id="8151680">T</span><span class="op" id="8151681">)</span>&nbsp;<span class="op" id="8151683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8151686">input</span>&nbsp;<span class="op" id="8151692">:=</span>&nbsp;<span class="op" id="8151695">[</span><span class="op" id="8151696">]</span><span class="builtintype" id="8151697">byte</span><span class="op" id="8151701">(</span><span class="string" id="8151702">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="8151729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8151732">expected</span>&nbsp;<span class="op" id="8151741">:=</span>&nbsp;<span class="string" id="8151744">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8151776">buff</span>&nbsp;<span class="op" id="8151781">:=</span>&nbsp;<span class="builtinfunc" id="8151784">new</span><span class="op" id="8151787">(</span><span class="ident" id="8151788">bytes</span><span class="op" id="8151793">.</span><span class="ident" id="8151794">Buffer</span><span class="op" id="8151800">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8151803">if</span>&nbsp;<span class="ident" id="8151806">err</span>&nbsp;<span class="op" id="8151810">:=</span>&nbsp;<span class="ident" id="8151813">EscapeText</span><span class="op" id="8151823">(</span><span class="ident" id="8151824">buff</span><span class="op" id="8151828">,</span>&nbsp;<span class="ident" id="8151830">input</span><span class="op" id="8151835">)</span><span class="op" id="8151836">;</span>&nbsp;<span class="ident" id="8151838">err</span>&nbsp;<span class="op" id="8151842">!=</span>&nbsp;<span class="ident" id="8151845">nil</span>&nbsp;<span class="op" id="8151849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8151853">t</span><span class="op" id="8151854">.</span><span class="ident" id="8151855">Fatalf</span><span class="op" id="8151861">(</span><span class="string" id="8151862">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="8151881">,</span>&nbsp;<span class="ident" id="8151883">err</span><span class="op" id="8151886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8151889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8151892">text</span>&nbsp;<span class="op" id="8151897">:=</span>&nbsp;<span class="ident" id="8151900">buff</span><span class="op" id="8151904">.</span><span class="ident" id="8151905">String</span><span class="op" id="8151911">(</span><span class="op" id="8151912">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8151916">if</span>&nbsp;<span class="ident" id="8151919">text</span>&nbsp;<span class="op" id="8151924">!=</span>&nbsp;<span class="ident" id="8151927">expected</span>&nbsp;<span class="op" id="8151936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8151940">t</span><span class="op" id="8151941">.</span><span class="ident" id="8151942">Errorf</span><span class="op" id="8151948">(</span><span class="string" id="8151949">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8151967">,</span>&nbsp;<span class="ident" id="8151969">text</span><span class="op" id="8151973">,</span>&nbsp;<span class="ident" id="8151975">expected</span><span class="op" id="8151983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8151986">}</span><br>
<span class="lineno"></span><span class="op" id="8151988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="8151991">func</span>&nbsp;<span class="ident" id="8151996">TestIssue5880</span><span class="op" id="8152009">(</span><span class="ident" id="8152010">t</span>&nbsp;<span class="op" id="8152012">*</span><span class="ident" id="8152013">testing</span><span class="op" id="8152020">.</span><span class="ident" id="8152021">T</span><span class="op" id="8152022">)</span>&nbsp;<span class="op" id="8152024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8152027">type</span>&nbsp;<span class="ident" id="8152032">T</span>&nbsp;<span class="op" id="8152034">[</span><span class="op" id="8152035">]</span><span class="builtintype" id="8152036">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8152042">data</span><span class="op" id="8152046">,</span>&nbsp;<span class="ident" id="8152048">err</span>&nbsp;<span class="op" id="8152052">:=</span>&nbsp;<span class="ident" id="8152055">Marshal</span><span class="op" id="8152062">(</span><span class="ident" id="8152063">T</span><span class="op" id="8152064">{</span><span class="num" id="8152065">192</span><span class="op" id="8152068">,</span>&nbsp;<span class="num" id="8152070">168</span><span class="op" id="8152073">,</span>&nbsp;<span class="num" id="8152075">0</span><span class="op" id="8152076">,</span>&nbsp;<span class="num" id="8152078">1</span><span class="op" id="8152079">}</span><span class="op" id="8152080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8152083">if</span>&nbsp;<span class="ident" id="8152086">err</span>&nbsp;<span class="op" id="8152090">!=</span>&nbsp;<span class="ident" id="8152093">nil</span>&nbsp;<span class="op" id="8152097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8152101">t</span><span class="op" id="8152102">.</span><span class="ident" id="8152103">Errorf</span><span class="op" id="8152109">(</span><span class="string" id="8152110">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8152129">,</span>&nbsp;<span class="ident" id="8152131">err</span><span class="op" id="8152134">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8152137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8152140">if</span>&nbsp;<span class="op" id="8152143">!</span><span class="ident" id="8152144">utf8</span><span class="op" id="8152148">.</span><span class="ident" id="8152149">Valid</span><span class="op" id="8152154">(</span><span class="ident" id="8152155">data</span><span class="op" id="8152159">)</span>&nbsp;<span class="op" id="8152161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8152165">t</span><span class="op" id="8152166">.</span><span class="ident" id="8152167">Errorf</span><span class="op" id="8152173">(</span><span class="string" id="8152174">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="8152211">,</span>&nbsp;<span class="ident" id="8152213">data</span><span class="op" id="8152217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8152220">}</span><br>
<span class="lineno"></span><span class="op" id="8152222">}</span>
</div>
</body>
</html>
