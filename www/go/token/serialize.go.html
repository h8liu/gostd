<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5186060">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5186115">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5186169">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5186220">package</span>&nbsp;<span class="ident" id="5186228">token</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5186235">type</span>&nbsp;<span class="ident" id="5186240">serializedFile</span>&nbsp;<span class="keyword" id="5186255">struct</span>&nbsp;<span class="op" id="5186262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186265">//&nbsp;fields&nbsp;correspond&nbsp;1:1&nbsp;to&nbsp;fields&nbsp;with&nbsp;same&nbsp;(lower-case)&nbsp;name&nbsp;in&nbsp;File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186337">Name</span>&nbsp;&nbsp;<span class="builtintype" id="5186343">string</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186351">Base</span>&nbsp;&nbsp;<span class="builtintype" id="5186357">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186362">Size</span>&nbsp;&nbsp;<span class="builtintype" id="5186368">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186373">Lines</span>&nbsp;<span class="op" id="5186379">[</span><span class="op" id="5186380">]</span><span class="builtintype" id="5186381">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186386">Infos</span>&nbsp;<span class="op" id="5186392">[</span><span class="op" id="5186393">]</span><span class="ident" id="5186394"><a href="/go/token/position.go.html#5178057">lineInfo</a></span><br>
<span class="lineno"></span><span class="op" id="5186403">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="5186406">type</span>&nbsp;<span class="ident" id="5186411">serializedFileSet</span>&nbsp;<span class="keyword" id="5186429">struct</span>&nbsp;<span class="op" id="5186436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186439">Base</span>&nbsp;&nbsp;<span class="builtintype" id="5186445">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186450">Files</span>&nbsp;<span class="op" id="5186456">[</span><span class="op" id="5186457">]</span><span class="ident" id="5186458"><a href="/go/token/serialize.go.html#5186240">serializedFile</a></span><br>
<span class="lineno"></span><span class="op" id="5186473">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="5186476">//&nbsp;Read&nbsp;calls&nbsp;decode&nbsp;to&nbsp;deserialize&nbsp;a&nbsp;file&nbsp;set&nbsp;into&nbsp;s;&nbsp;s&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="5186550">func</span>&nbsp;<span class="op" id="5186555">(</span><span class="ident" id="5186556">s</span>&nbsp;<span class="op" id="5186558">*</span><span class="ident" id="5186559"><a href="/go/token/position.go.html#5181511">FileSet</a></span><span class="op" id="5186566">)</span>&nbsp;<span class="ident" id="5186568">Read</span><span class="op" id="5186572">(</span><span class="ident" id="5186573">decode</span>&nbsp;<span class="keyword" id="5186580">func</span><span class="op" id="5186584">(</span><span class="keyword" id="5186585">interface</span><span class="op" id="5186594">{</span><span class="op" id="5186595">}</span><span class="op" id="5186596">)</span>&nbsp;<span class="builtintype" id="5186598">error</span><span class="op" id="5186603">)</span>&nbsp;<span class="builtintype" id="5186605">error</span>&nbsp;<span class="op" id="5186611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186614">var</span>&nbsp;<span class="ident" id="5186618">ss</span>&nbsp;<span class="ident" id="5186621"><a href="/go/token/serialize.go.html#5186411">serializedFileSet</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186640">if</span>&nbsp;<span class="ident" id="5186643">err</span>&nbsp;<span class="op" id="5186647">:=</span>&nbsp;<span class="ident" id="5186650"><a href="/go/token/serialize.go.html#5186573">decode</a></span><span class="op" id="5186656">(</span><span class="op" id="5186657">&amp;</span><span class="ident" id="5186658"><a href="/go/token/serialize.go.html#5186618">ss</a></span><span class="op" id="5186660">)</span><span class="op" id="5186661">;</span>&nbsp;<span class="ident" id="5186663"><a href="/go/token/serialize.go.html#5186643">err</a></span>&nbsp;<span class="op" id="5186667">!=</span>&nbsp;<span class="ident" id="5186670">nil</span>&nbsp;<span class="op" id="5186674">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186678">return</span>&nbsp;<span class="ident" id="5186685"><a href="/go/token/serialize.go.html#5186643">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5186690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186694"><a href="/go/token/serialize.go.html#5186556">s</a></span><span class="op" id="5186695">.</span><span class="ident" id="5186696">mutex</span><span class="op" id="5186701">.</span><span class="ident" id="5186702">Lock</span><span class="op" id="5186706">(</span><span class="op" id="5186707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186710"><a href="/go/token/serialize.go.html#5186556">s</a></span><span class="op" id="5186711">.</span><span class="ident" id="5186712">base</span>&nbsp;<span class="op" id="5186717">=</span>&nbsp;<span class="ident" id="5186719"><a href="/go/token/serialize.go.html#5186618">ss</a></span><span class="op" id="5186721">.</span><span class="ident" id="5186722">Base</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186728">files</span>&nbsp;<span class="op" id="5186734">:=</span>&nbsp;<span class="builtinfunc" id="5186737">make</span><span class="op" id="5186741">(</span><span class="op" id="5186742">[</span><span class="op" id="5186743">]</span><span class="op" id="5186744">*</span><span class="ident" id="5186745"><a href="/go/token/position.go.html#5174541">File</a></span><span class="op" id="5186749">,</span>&nbsp;<span class="builtinfunc" id="5186751">len</span><span class="op" id="5186754">(</span><span class="ident" id="5186755"><a href="/go/token/serialize.go.html#5186618">ss</a></span><span class="op" id="5186757">.</span><span class="ident" id="5186758">Files</span><span class="op" id="5186763">)</span><span class="op" id="5186764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186767">for</span>&nbsp;<span class="ident" id="5186771">i</span>&nbsp;<span class="op" id="5186773">:=</span>&nbsp;<span class="num" id="5186776">0</span><span class="op" id="5186777">;</span>&nbsp;<span class="ident" id="5186779"><a href="/go/token/serialize.go.html#5186771">i</a></span>&nbsp;<span class="op" id="5186781">&lt;</span>&nbsp;<span class="builtinfunc" id="5186783">len</span><span class="op" id="5186786">(</span><span class="ident" id="5186787"><a href="/go/token/serialize.go.html#5186618">ss</a></span><span class="op" id="5186789">.</span><span class="ident" id="5186790">Files</span><span class="op" id="5186795">)</span><span class="op" id="5186796">;</span>&nbsp;<span class="ident" id="5186798"><a href="/go/token/serialize.go.html#5186771">i</a></span><span class="op" id="5186799">++</span>&nbsp;<span class="op" id="5186802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186806">f</span>&nbsp;<span class="op" id="5186808">:=</span>&nbsp;<span class="op" id="5186811">&amp;</span><span class="ident" id="5186812"><a href="/go/token/serialize.go.html#5186618">ss</a></span><span class="op" id="5186814">.</span><span class="ident" id="5186815">Files</span><span class="op" id="5186820">[</span><span class="ident" id="5186821"><a href="/go/token/serialize.go.html#5186771">i</a></span><span class="op" id="5186822">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186826"><a href="/go/token/serialize.go.html#5186728">files</a></span><span class="op" id="5186831">[</span><span class="ident" id="5186832"><a href="/go/token/serialize.go.html#5186771">i</a></span><span class="op" id="5186833">]</span>&nbsp;<span class="op" id="5186835">=</span>&nbsp;<span class="op" id="5186837">&amp;</span><span class="ident" id="5186838"><a href="/go/token/position.go.html#5174541">File</a></span><span class="op" id="5186842">{</span><span class="ident" id="5186843"><a href="/go/token/serialize.go.html#5186556">s</a></span><span class="op" id="5186844">,</span>&nbsp;<span class="ident" id="5186846"><a href="/go/token/serialize.go.html#5186806">f</a></span><span class="op" id="5186847">.</span><span class="ident" id="5186848">Name</span><span class="op" id="5186852">,</span>&nbsp;<span class="ident" id="5186854"><a href="/go/token/serialize.go.html#5186806">f</a></span><span class="op" id="5186855">.</span><span class="ident" id="5186856">Base</span><span class="op" id="5186860">,</span>&nbsp;<span class="ident" id="5186862"><a href="/go/token/serialize.go.html#5186806">f</a></span><span class="op" id="5186863">.</span><span class="ident" id="5186864">Size</span><span class="op" id="5186868">,</span>&nbsp;<span class="ident" id="5186870"><a href="/go/token/serialize.go.html#5186806">f</a></span><span class="op" id="5186871">.</span><span class="ident" id="5186872">Lines</span><span class="op" id="5186877">,</span>&nbsp;<span class="ident" id="5186879"><a href="/go/token/serialize.go.html#5186806">f</a></span><span class="op" id="5186880">.</span><span class="ident" id="5186881">Infos</span><span class="op" id="5186886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5186889">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186892"><a href="/go/token/serialize.go.html#5186556">s</a></span><span class="op" id="5186893">.</span><span class="ident" id="5186894">files</span>&nbsp;<span class="op" id="5186900">=</span>&nbsp;<span class="ident" id="5186902"><a href="/go/token/serialize.go.html#5186728">files</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186909"><a href="/go/token/serialize.go.html#5186556">s</a></span><span class="op" id="5186910">.</span><span class="ident" id="5186911">last</span>&nbsp;<span class="op" id="5186916">=</span>&nbsp;<span class="ident" id="5186918">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186923"><a href="/go/token/serialize.go.html#5186556">s</a></span><span class="op" id="5186924">.</span><span class="ident" id="5186925">mutex</span><span class="op" id="5186930">.</span><span class="ident" id="5186931">Unlock</span><span class="op" id="5186937">(</span><span class="op" id="5186938">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186942">return</span>&nbsp;<span class="ident" id="5186949">nil</span><br>
<span class="lineno">40</span><span class="op" id="5186953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5186956">//&nbsp;Write&nbsp;calls&nbsp;encode&nbsp;to&nbsp;serialize&nbsp;the&nbsp;file&nbsp;set&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5187007">func</span>&nbsp;<span class="op" id="5187012">(</span><span class="ident" id="5187013">s</span>&nbsp;<span class="op" id="5187015">*</span><span class="ident" id="5187016"><a href="/go/token/position.go.html#5181511">FileSet</a></span><span class="op" id="5187023">)</span>&nbsp;<span class="ident" id="5187025">Write</span><span class="op" id="5187030">(</span><span class="ident" id="5187031">encode</span>&nbsp;<span class="keyword" id="5187038">func</span><span class="op" id="5187042">(</span><span class="keyword" id="5187043">interface</span><span class="op" id="5187052">{</span><span class="op" id="5187053">}</span><span class="op" id="5187054">)</span>&nbsp;<span class="builtintype" id="5187056">error</span><span class="op" id="5187061">)</span>&nbsp;<span class="builtintype" id="5187063">error</span>&nbsp;<span class="op" id="5187069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187072">var</span>&nbsp;<span class="ident" id="5187076">ss</span>&nbsp;<span class="ident" id="5187079"><a href="/go/token/serialize.go.html#5186411">serializedFileSet</a></span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187099"><a href="/go/token/serialize.go.html#5187013">s</a></span><span class="op" id="5187100">.</span><span class="ident" id="5187101">mutex</span><span class="op" id="5187106">.</span><span class="ident" id="5187107">Lock</span><span class="op" id="5187111">(</span><span class="op" id="5187112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187115"><a href="/go/token/serialize.go.html#5187076">ss</a></span><span class="op" id="5187117">.</span><span class="ident" id="5187118">Base</span>&nbsp;<span class="op" id="5187123">=</span>&nbsp;<span class="ident" id="5187125"><a href="/go/token/serialize.go.html#5187013">s</a></span><span class="op" id="5187126">.</span><span class="ident" id="5187127">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187133">files</span>&nbsp;<span class="op" id="5187139">:=</span>&nbsp;<span class="builtinfunc" id="5187142">make</span><span class="op" id="5187146">(</span><span class="op" id="5187147">[</span><span class="op" id="5187148">]</span><span class="ident" id="5187149"><a href="/go/token/serialize.go.html#5186240">serializedFile</a></span><span class="op" id="5187163">,</span>&nbsp;<span class="builtinfunc" id="5187165">len</span><span class="op" id="5187168">(</span><span class="ident" id="5187169"><a href="/go/token/serialize.go.html#5187013">s</a></span><span class="op" id="5187170">.</span><span class="ident" id="5187171">files</span><span class="op" id="5187176">)</span><span class="op" id="5187177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187180">for</span>&nbsp;<span class="ident" id="5187184">i</span><span class="op" id="5187185">,</span>&nbsp;<span class="ident" id="5187187">f</span>&nbsp;<span class="op" id="5187189">:=</span>&nbsp;<span class="keyword" id="5187192">range</span>&nbsp;<span class="ident" id="5187198"><a href="/go/token/serialize.go.html#5187013">s</a></span><span class="op" id="5187199">.</span><span class="ident" id="5187200">files</span>&nbsp;<span class="op" id="5187206">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187210"><a href="/go/token/serialize.go.html#5187133">files</a></span><span class="op" id="5187215">[</span><span class="ident" id="5187216"><a href="/go/token/serialize.go.html#5187184">i</a></span><span class="op" id="5187217">]</span>&nbsp;<span class="op" id="5187219">=</span>&nbsp;<span class="ident" id="5187221"><a href="/go/token/serialize.go.html#5186240">serializedFile</a></span><span class="op" id="5187235">{</span><span class="ident" id="5187236"><a href="/go/token/serialize.go.html#5187187">f</a></span><span class="op" id="5187237">.</span><span class="ident" id="5187238">name</span><span class="op" id="5187242">,</span>&nbsp;<span class="ident" id="5187244"><a href="/go/token/serialize.go.html#5187187">f</a></span><span class="op" id="5187245">.</span><span class="ident" id="5187246">base</span><span class="op" id="5187250">,</span>&nbsp;<span class="ident" id="5187252"><a href="/go/token/serialize.go.html#5187187">f</a></span><span class="op" id="5187253">.</span><span class="ident" id="5187254">size</span><span class="op" id="5187258">,</span>&nbsp;<span class="ident" id="5187260"><a href="/go/token/serialize.go.html#5187187">f</a></span><span class="op" id="5187261">.</span><span class="ident" id="5187262">lines</span><span class="op" id="5187267">,</span>&nbsp;<span class="ident" id="5187269"><a href="/go/token/serialize.go.html#5187187">f</a></span><span class="op" id="5187270">.</span><span class="ident" id="5187271">infos</span><span class="op" id="5187276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187282"><a href="/go/token/serialize.go.html#5187076">ss</a></span><span class="op" id="5187284">.</span><span class="ident" id="5187285">Files</span>&nbsp;<span class="op" id="5187291">=</span>&nbsp;<span class="ident" id="5187293"><a href="/go/token/serialize.go.html#5187133">files</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187300"><a href="/go/token/serialize.go.html#5187013">s</a></span><span class="op" id="5187301">.</span><span class="ident" id="5187302">mutex</span><span class="op" id="5187307">.</span><span class="ident" id="5187308">Unlock</span><span class="op" id="5187314">(</span><span class="op" id="5187315">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187319">return</span>&nbsp;<span class="ident" id="5187326"><a href="/go/token/serialize.go.html#5187031">encode</a></span><span class="op" id="5187332">(</span><span class="ident" id="5187333"><a href="/go/token/serialize.go.html#5187076">ss</a></span><span class="op" id="5187335">)</span><br>
<span class="lineno"></span><span class="op" id="5187337">}</span>
</div>
</body>
</html>
