<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4265062">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4265117">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4265171">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4265222">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4265300">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="4265318">package</span>&nbsp;<span class="ident" id="4265326">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4265334">import</span>&nbsp;<span class="op" id="4265341">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4265344">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4265354">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4265361">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4265364">func</span>&nbsp;<span class="ident" id="4265369">init</span><span class="op" id="4265373">(</span><span class="op" id="4265374">)</span>&nbsp;<span class="op" id="4265376">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265379">crypto</span><span class="op" id="4265385">.</span><span class="ident" id="4265386">RegisterHash</span><span class="op" id="4265398">(</span><span class="ident" id="4265399">crypto</span><span class="op" id="4265405">.</span><span class="ident" id="4265406">SHA224</span><span class="op" id="4265412">,</span>&nbsp;<span class="ident" id="4265414">New224</span><span class="op" id="4265420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265423">crypto</span><span class="op" id="4265429">.</span><span class="ident" id="4265430">RegisterHash</span><span class="op" id="4265442">(</span><span class="ident" id="4265443">crypto</span><span class="op" id="4265449">.</span><span class="ident" id="4265450">SHA256</span><span class="op" id="4265456">,</span>&nbsp;<span class="ident" id="4265458">New</span><span class="op" id="4265461">)</span><br>
<span class="lineno"></span><span class="op" id="4265463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4265466">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4265509">const</span>&nbsp;<span class="ident" id="4265515">Size</span>&nbsp;<span class="op" id="4265520">=</span>&nbsp;<span class="num" id="4265522">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4265526">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4265569">const</span>&nbsp;<span class="ident" id="4265575">Size224</span>&nbsp;<span class="op" id="4265583">=</span>&nbsp;<span class="num" id="4265585">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4265589">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4265637">const</span>&nbsp;<span class="ident" id="4265643">BlockSize</span>&nbsp;<span class="op" id="4265653">=</span>&nbsp;<span class="num" id="4265655">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4265659">const</span>&nbsp;<span class="op" id="4265665">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265668">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265678">=</span>&nbsp;<span class="num" id="4265680">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265684">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265694">=</span>&nbsp;<span class="num" id="4265696">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265708">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265718">=</span>&nbsp;<span class="num" id="4265720">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265732">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265742">=</span>&nbsp;<span class="num" id="4265744">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265756">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265766">=</span>&nbsp;<span class="num" id="4265768">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265780">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265790">=</span>&nbsp;<span class="num" id="4265792">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265804">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265814">=</span>&nbsp;<span class="num" id="4265816">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265828">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265838">=</span>&nbsp;<span class="num" id="4265840">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265852">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265862">=</span>&nbsp;<span class="num" id="4265864">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265876">init0_224</span>&nbsp;<span class="op" id="4265886">=</span>&nbsp;<span class="num" id="4265888">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265900">init1_224</span>&nbsp;<span class="op" id="4265910">=</span>&nbsp;<span class="num" id="4265912">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265924">init2_224</span>&nbsp;<span class="op" id="4265934">=</span>&nbsp;<span class="num" id="4265936">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265948">init3_224</span>&nbsp;<span class="op" id="4265958">=</span>&nbsp;<span class="num" id="4265960">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265972">init4_224</span>&nbsp;<span class="op" id="4265982">=</span>&nbsp;<span class="num" id="4265984">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265996">init5_224</span>&nbsp;<span class="op" id="4266006">=</span>&nbsp;<span class="num" id="4266008">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266020">init6_224</span>&nbsp;<span class="op" id="4266030">=</span>&nbsp;<span class="num" id="4266032">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266044">init7_224</span>&nbsp;<span class="op" id="4266054">=</span>&nbsp;<span class="num" id="4266056">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="4266067">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4266070">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4266129">type</span>&nbsp;<span class="ident" id="4266134">digest</span>&nbsp;<span class="keyword" id="4266141">struct</span>&nbsp;<span class="op" id="4266148">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266151">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266157">[</span><span class="num" id="4266158">8</span><span class="op" id="4266159">]</span><span class="builtintype" id="4266160">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266168">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266174">[</span><span class="ident" id="4266175">chunk</span><span class="op" id="4266180">]</span><span class="builtintype" id="4266181">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266187">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4266193">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4266198">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4266204">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266212">is224</span>&nbsp;<span class="builtintype" id="4266218">bool</span>&nbsp;<span class="comment" id="4266223">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="4266257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4266260">func</span>&nbsp;<span class="op" id="4266265">(</span><span class="ident" id="4266266">d</span>&nbsp;<span class="op" id="4266268">*</span><span class="ident" id="4266269">digest</span><span class="op" id="4266275">)</span>&nbsp;<span class="ident" id="4266277">Reset</span><span class="op" id="4266282">(</span><span class="op" id="4266283">)</span>&nbsp;<span class="op" id="4266285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266288">if</span>&nbsp;<span class="op" id="4266291">!</span><span class="ident" id="4266292">d</span><span class="op" id="4266293">.</span><span class="ident" id="4266294">is224</span>&nbsp;<span class="op" id="4266300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266304">d</span><span class="op" id="4266305">.</span><span class="ident" id="4266306">h</span><span class="op" id="4266307">[</span><span class="num" id="4266308">0</span><span class="op" id="4266309">]</span>&nbsp;<span class="op" id="4266311">=</span>&nbsp;<span class="ident" id="4266313">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266321">d</span><span class="op" id="4266322">.</span><span class="ident" id="4266323">h</span><span class="op" id="4266324">[</span><span class="num" id="4266325">1</span><span class="op" id="4266326">]</span>&nbsp;<span class="op" id="4266328">=</span>&nbsp;<span class="ident" id="4266330">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266338">d</span><span class="op" id="4266339">.</span><span class="ident" id="4266340">h</span><span class="op" id="4266341">[</span><span class="num" id="4266342">2</span><span class="op" id="4266343">]</span>&nbsp;<span class="op" id="4266345">=</span>&nbsp;<span class="ident" id="4266347">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266355">d</span><span class="op" id="4266356">.</span><span class="ident" id="4266357">h</span><span class="op" id="4266358">[</span><span class="num" id="4266359">3</span><span class="op" id="4266360">]</span>&nbsp;<span class="op" id="4266362">=</span>&nbsp;<span class="ident" id="4266364">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266372">d</span><span class="op" id="4266373">.</span><span class="ident" id="4266374">h</span><span class="op" id="4266375">[</span><span class="num" id="4266376">4</span><span class="op" id="4266377">]</span>&nbsp;<span class="op" id="4266379">=</span>&nbsp;<span class="ident" id="4266381">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266389">d</span><span class="op" id="4266390">.</span><span class="ident" id="4266391">h</span><span class="op" id="4266392">[</span><span class="num" id="4266393">5</span><span class="op" id="4266394">]</span>&nbsp;<span class="op" id="4266396">=</span>&nbsp;<span class="ident" id="4266398">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266406">d</span><span class="op" id="4266407">.</span><span class="ident" id="4266408">h</span><span class="op" id="4266409">[</span><span class="num" id="4266410">6</span><span class="op" id="4266411">]</span>&nbsp;<span class="op" id="4266413">=</span>&nbsp;<span class="ident" id="4266415">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266423">d</span><span class="op" id="4266424">.</span><span class="ident" id="4266425">h</span><span class="op" id="4266426">[</span><span class="num" id="4266427">7</span><span class="op" id="4266428">]</span>&nbsp;<span class="op" id="4266430">=</span>&nbsp;<span class="ident" id="4266432">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4266439">}</span>&nbsp;<span class="keyword" id="4266441">else</span>&nbsp;<span class="op" id="4266446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266450">d</span><span class="op" id="4266451">.</span><span class="ident" id="4266452">h</span><span class="op" id="4266453">[</span><span class="num" id="4266454">0</span><span class="op" id="4266455">]</span>&nbsp;<span class="op" id="4266457">=</span>&nbsp;<span class="ident" id="4266459">init0_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266471">d</span><span class="op" id="4266472">.</span><span class="ident" id="4266473">h</span><span class="op" id="4266474">[</span><span class="num" id="4266475">1</span><span class="op" id="4266476">]</span>&nbsp;<span class="op" id="4266478">=</span>&nbsp;<span class="ident" id="4266480">init1_224</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266492">d</span><span class="op" id="4266493">.</span><span class="ident" id="4266494">h</span><span class="op" id="4266495">[</span><span class="num" id="4266496">2</span><span class="op" id="4266497">]</span>&nbsp;<span class="op" id="4266499">=</span>&nbsp;<span class="ident" id="4266501">init2_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266513">d</span><span class="op" id="4266514">.</span><span class="ident" id="4266515">h</span><span class="op" id="4266516">[</span><span class="num" id="4266517">3</span><span class="op" id="4266518">]</span>&nbsp;<span class="op" id="4266520">=</span>&nbsp;<span class="ident" id="4266522">init3_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266534">d</span><span class="op" id="4266535">.</span><span class="ident" id="4266536">h</span><span class="op" id="4266537">[</span><span class="num" id="4266538">4</span><span class="op" id="4266539">]</span>&nbsp;<span class="op" id="4266541">=</span>&nbsp;<span class="ident" id="4266543">init4_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266555">d</span><span class="op" id="4266556">.</span><span class="ident" id="4266557">h</span><span class="op" id="4266558">[</span><span class="num" id="4266559">5</span><span class="op" id="4266560">]</span>&nbsp;<span class="op" id="4266562">=</span>&nbsp;<span class="ident" id="4266564">init5_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266576">d</span><span class="op" id="4266577">.</span><span class="ident" id="4266578">h</span><span class="op" id="4266579">[</span><span class="num" id="4266580">6</span><span class="op" id="4266581">]</span>&nbsp;<span class="op" id="4266583">=</span>&nbsp;<span class="ident" id="4266585">init6_224</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266597">d</span><span class="op" id="4266598">.</span><span class="ident" id="4266599">h</span><span class="op" id="4266600">[</span><span class="num" id="4266601">7</span><span class="op" id="4266602">]</span>&nbsp;<span class="op" id="4266604">=</span>&nbsp;<span class="ident" id="4266606">init7_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4266617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266620">d</span><span class="op" id="4266621">.</span><span class="ident" id="4266622">nx</span>&nbsp;<span class="op" id="4266625">=</span>&nbsp;<span class="num" id="4266627">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266630">d</span><span class="op" id="4266631">.</span><span class="builtinfunc" id="4266632">len</span>&nbsp;<span class="op" id="4266636">=</span>&nbsp;<span class="num" id="4266638">0</span><br>
<span class="lineno"></span><span class="op" id="4266640">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4266643">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4266705">func</span>&nbsp;<span class="ident" id="4266710">New</span><span class="op" id="4266713">(</span><span class="op" id="4266714">)</span>&nbsp;<span class="ident" id="4266716">hash</span><span class="op" id="4266720">.</span><span class="ident" id="4266721">Hash</span>&nbsp;<span class="op" id="4266726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266729">d</span>&nbsp;<span class="op" id="4266731">:=</span>&nbsp;<span class="builtinfunc" id="4266734">new</span><span class="op" id="4266737">(</span><span class="ident" id="4266738">digest</span><span class="op" id="4266744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266747">d</span><span class="op" id="4266748">.</span><span class="ident" id="4266749">Reset</span><span class="op" id="4266754">(</span><span class="op" id="4266755">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266758">return</span>&nbsp;<span class="ident" id="4266765">d</span><br>
<span class="lineno"></span><span class="op" id="4266767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4266770">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4266835">func</span>&nbsp;<span class="ident" id="4266840">New224</span><span class="op" id="4266846">(</span><span class="op" id="4266847">)</span>&nbsp;<span class="ident" id="4266849">hash</span><span class="op" id="4266853">.</span><span class="ident" id="4266854">Hash</span>&nbsp;<span class="op" id="4266859">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266862">d</span>&nbsp;<span class="op" id="4266864">:=</span>&nbsp;<span class="builtinfunc" id="4266867">new</span><span class="op" id="4266870">(</span><span class="ident" id="4266871">digest</span><span class="op" id="4266877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266880">d</span><span class="op" id="4266881">.</span><span class="ident" id="4266882">is224</span>&nbsp;<span class="op" id="4266888">=</span>&nbsp;<span class="ident" id="4266890">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266896">d</span><span class="op" id="4266897">.</span><span class="ident" id="4266898">Reset</span><span class="op" id="4266903">(</span><span class="op" id="4266904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266907">return</span>&nbsp;<span class="ident" id="4266914">d</span><br>
<span class="lineno"></span><span class="op" id="4266916">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4266919">func</span>&nbsp;<span class="op" id="4266924">(</span><span class="ident" id="4266925">d</span>&nbsp;<span class="op" id="4266927">*</span><span class="ident" id="4266928">digest</span><span class="op" id="4266934">)</span>&nbsp;<span class="ident" id="4266936">Size</span><span class="op" id="4266940">(</span><span class="op" id="4266941">)</span>&nbsp;<span class="builtintype" id="4266943">int</span>&nbsp;<span class="op" id="4266947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266950">if</span>&nbsp;<span class="op" id="4266953">!</span><span class="ident" id="4266954">d</span><span class="op" id="4266955">.</span><span class="ident" id="4266956">is224</span>&nbsp;<span class="op" id="4266962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266966">return</span>&nbsp;<span class="ident" id="4266973">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4266979">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266982">return</span>&nbsp;<span class="ident" id="4266989">Size224</span><br>
<span class="lineno"></span><span class="op" id="4266997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4267000">func</span>&nbsp;<span class="op" id="4267005">(</span><span class="ident" id="4267006">d</span>&nbsp;<span class="op" id="4267008">*</span><span class="ident" id="4267009">digest</span><span class="op" id="4267015">)</span>&nbsp;<span class="ident" id="4267017">BlockSize</span><span class="op" id="4267026">(</span><span class="op" id="4267027">)</span>&nbsp;<span class="builtintype" id="4267029">int</span>&nbsp;<span class="op" id="4267033">{</span>&nbsp;<span class="keyword" id="4267035">return</span>&nbsp;<span class="ident" id="4267042">BlockSize</span>&nbsp;<span class="op" id="4267052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4267055">func</span>&nbsp;<span class="op" id="4267060">(</span><span class="ident" id="4267061">d</span>&nbsp;<span class="op" id="4267063">*</span><span class="ident" id="4267064">digest</span><span class="op" id="4267070">)</span>&nbsp;<span class="ident" id="4267072">Write</span><span class="op" id="4267077">(</span><span class="ident" id="4267078">p</span>&nbsp;<span class="op" id="4267080">[</span><span class="op" id="4267081">]</span><span class="builtintype" id="4267082">byte</span><span class="op" id="4267086">)</span>&nbsp;<span class="op" id="4267088">(</span><span class="ident" id="4267089">nn</span>&nbsp;<span class="builtintype" id="4267092">int</span><span class="op" id="4267095">,</span>&nbsp;<span class="ident" id="4267097">err</span>&nbsp;<span class="builtintype" id="4267101">error</span><span class="op" id="4267106">)</span>&nbsp;<span class="op" id="4267108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267111">nn</span>&nbsp;<span class="op" id="4267114">=</span>&nbsp;<span class="builtinfunc" id="4267116">len</span><span class="op" id="4267119">(</span><span class="ident" id="4267120">p</span><span class="op" id="4267121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267124">d</span><span class="op" id="4267125">.</span><span class="builtinfunc" id="4267126">len</span>&nbsp;<span class="op" id="4267130">+=</span>&nbsp;<span class="ident" id="4267133">uint64</span><span class="op" id="4267139">(</span><span class="ident" id="4267140">nn</span><span class="op" id="4267142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267145">if</span>&nbsp;<span class="ident" id="4267148">d</span><span class="op" id="4267149">.</span><span class="ident" id="4267150">nx</span>&nbsp;<span class="op" id="4267153">&gt;</span>&nbsp;<span class="num" id="4267155">0</span>&nbsp;<span class="op" id="4267157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267161">n</span>&nbsp;<span class="op" id="4267163">:=</span>&nbsp;<span class="builtinfunc" id="4267166">copy</span><span class="op" id="4267170">(</span><span class="ident" id="4267171">d</span><span class="op" id="4267172">.</span><span class="ident" id="4267173">x</span><span class="op" id="4267174">[</span><span class="ident" id="4267175">d</span><span class="op" id="4267176">.</span><span class="ident" id="4267177">nx</span><span class="op" id="4267179">:</span><span class="op" id="4267180">]</span><span class="op" id="4267181">,</span>&nbsp;<span class="ident" id="4267183">p</span><span class="op" id="4267184">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267188">d</span><span class="op" id="4267189">.</span><span class="ident" id="4267190">nx</span>&nbsp;<span class="op" id="4267193">+=</span>&nbsp;<span class="ident" id="4267196">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267200">if</span>&nbsp;<span class="ident" id="4267203">d</span><span class="op" id="4267204">.</span><span class="ident" id="4267205">nx</span>&nbsp;<span class="op" id="4267208">==</span>&nbsp;<span class="ident" id="4267211">chunk</span>&nbsp;<span class="op" id="4267217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267222">block</span><span class="op" id="4267227">(</span><span class="ident" id="4267228">d</span><span class="op" id="4267229">,</span>&nbsp;<span class="ident" id="4267231">d</span><span class="op" id="4267232">.</span><span class="ident" id="4267233">x</span><span class="op" id="4267234">[</span><span class="op" id="4267235">:</span><span class="op" id="4267236">]</span><span class="op" id="4267237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267242">d</span><span class="op" id="4267243">.</span><span class="ident" id="4267244">nx</span>&nbsp;<span class="op" id="4267247">=</span>&nbsp;<span class="num" id="4267249">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267253">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267257">p</span>&nbsp;<span class="op" id="4267259">=</span>&nbsp;<span class="ident" id="4267261">p</span><span class="op" id="4267262">[</span><span class="ident" id="4267263">n</span><span class="op" id="4267264">:</span><span class="op" id="4267265">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267271">if</span>&nbsp;<span class="builtinfunc" id="4267274">len</span><span class="op" id="4267277">(</span><span class="ident" id="4267278">p</span><span class="op" id="4267279">)</span>&nbsp;<span class="op" id="4267281">&gt;=</span>&nbsp;<span class="ident" id="4267284">chunk</span>&nbsp;<span class="op" id="4267290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267294">n</span>&nbsp;<span class="op" id="4267296">:=</span>&nbsp;<span class="builtinfunc" id="4267299">len</span><span class="op" id="4267302">(</span><span class="ident" id="4267303">p</span><span class="op" id="4267304">)</span>&nbsp;<span class="op" id="4267306">&amp;^</span>&nbsp;<span class="op" id="4267309">(</span><span class="ident" id="4267310">chunk</span>&nbsp;<span class="op" id="4267316">-</span>&nbsp;<span class="num" id="4267318">1</span><span class="op" id="4267319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267323">block</span><span class="op" id="4267328">(</span><span class="ident" id="4267329">d</span><span class="op" id="4267330">,</span>&nbsp;<span class="ident" id="4267332">p</span><span class="op" id="4267333">[</span><span class="op" id="4267334">:</span><span class="ident" id="4267335">n</span><span class="op" id="4267336">]</span><span class="op" id="4267337">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267341">p</span>&nbsp;<span class="op" id="4267343">=</span>&nbsp;<span class="ident" id="4267345">p</span><span class="op" id="4267346">[</span><span class="ident" id="4267347">n</span><span class="op" id="4267348">:</span><span class="op" id="4267349">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267355">if</span>&nbsp;<span class="builtinfunc" id="4267358">len</span><span class="op" id="4267361">(</span><span class="ident" id="4267362">p</span><span class="op" id="4267363">)</span>&nbsp;<span class="op" id="4267365">&gt;</span>&nbsp;<span class="num" id="4267367">0</span>&nbsp;<span class="op" id="4267369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267373">d</span><span class="op" id="4267374">.</span><span class="ident" id="4267375">nx</span>&nbsp;<span class="op" id="4267378">=</span>&nbsp;<span class="builtinfunc" id="4267380">copy</span><span class="op" id="4267384">(</span><span class="ident" id="4267385">d</span><span class="op" id="4267386">.</span><span class="ident" id="4267387">x</span><span class="op" id="4267388">[</span><span class="op" id="4267389">:</span><span class="op" id="4267390">]</span><span class="op" id="4267391">,</span>&nbsp;<span class="ident" id="4267393">p</span><span class="op" id="4267394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267397">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267400">return</span><br>
<span class="lineno"></span><span class="op" id="4267407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4267410">func</span>&nbsp;<span class="op" id="4267415">(</span><span class="ident" id="4267416">d0</span>&nbsp;<span class="op" id="4267419">*</span><span class="ident" id="4267420">digest</span><span class="op" id="4267426">)</span>&nbsp;<span class="ident" id="4267428">Sum</span><span class="op" id="4267431">(</span><span class="ident" id="4267432">in</span>&nbsp;<span class="op" id="4267435">[</span><span class="op" id="4267436">]</span><span class="builtintype" id="4267437">byte</span><span class="op" id="4267441">)</span>&nbsp;<span class="op" id="4267443">[</span><span class="op" id="4267444">]</span><span class="builtintype" id="4267445">byte</span>&nbsp;<span class="op" id="4267450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4267453">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267520">d</span>&nbsp;<span class="op" id="4267522">:=</span>&nbsp;<span class="op" id="4267525">*</span><span class="ident" id="4267526">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267530">hash</span>&nbsp;<span class="op" id="4267535">:=</span>&nbsp;<span class="ident" id="4267538">d</span><span class="op" id="4267539">.</span><span class="ident" id="4267540">checkSum</span><span class="op" id="4267548">(</span><span class="op" id="4267549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267552">if</span>&nbsp;<span class="ident" id="4267555">d</span><span class="op" id="4267556">.</span><span class="ident" id="4267557">is224</span>&nbsp;<span class="op" id="4267563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267567">return</span>&nbsp;<span class="builtinfunc" id="4267574">append</span><span class="op" id="4267580">(</span><span class="ident" id="4267581">in</span><span class="op" id="4267583">,</span>&nbsp;<span class="ident" id="4267585">hash</span><span class="op" id="4267589">[</span><span class="op" id="4267590">:</span><span class="ident" id="4267591">Size224</span><span class="op" id="4267598">]</span><span class="op" id="4267599">...</span><span class="op" id="4267602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267605">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267608">return</span>&nbsp;<span class="builtinfunc" id="4267615">append</span><span class="op" id="4267621">(</span><span class="ident" id="4267622">in</span><span class="op" id="4267624">,</span>&nbsp;<span class="ident" id="4267626">hash</span><span class="op" id="4267630">[</span><span class="op" id="4267631">:</span><span class="op" id="4267632">]</span><span class="op" id="4267633">...</span><span class="op" id="4267636">)</span><br>
<span class="lineno"></span><span class="op" id="4267638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4267641">func</span>&nbsp;<span class="op" id="4267646">(</span><span class="ident" id="4267647">d</span>&nbsp;<span class="op" id="4267649">*</span><span class="ident" id="4267650">digest</span><span class="op" id="4267656">)</span>&nbsp;<span class="ident" id="4267658">checkSum</span><span class="op" id="4267666">(</span><span class="op" id="4267667">)</span>&nbsp;<span class="op" id="4267669">[</span><span class="ident" id="4267670">Size</span><span class="op" id="4267674">]</span><span class="builtintype" id="4267675">byte</span>&nbsp;<span class="op" id="4267680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4267683">len</span>&nbsp;<span class="op" id="4267687">:=</span>&nbsp;<span class="ident" id="4267690">d</span><span class="op" id="4267691">.</span><span class="builtinfunc" id="4267692">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4267697">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267757">var</span>&nbsp;<span class="ident" id="4267761">tmp</span>&nbsp;<span class="op" id="4267765">[</span><span class="num" id="4267766">64</span><span class="op" id="4267768">]</span><span class="builtintype" id="4267769">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267775">tmp</span><span class="op" id="4267778">[</span><span class="num" id="4267779">0</span><span class="op" id="4267780">]</span>&nbsp;<span class="op" id="4267782">=</span>&nbsp;<span class="num" id="4267784">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267790">if</span>&nbsp;<span class="builtinfunc" id="4267793">len</span><span class="op" id="4267796">%</span><span class="num" id="4267797">64</span>&nbsp;<span class="op" id="4267800">&lt;</span>&nbsp;<span class="num" id="4267802">56</span>&nbsp;<span class="op" id="4267805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267809">d</span><span class="op" id="4267810">.</span><span class="ident" id="4267811">Write</span><span class="op" id="4267816">(</span><span class="ident" id="4267817">tmp</span><span class="op" id="4267820">[</span><span class="num" id="4267821">0</span>&nbsp;<span class="op" id="4267823">:</span>&nbsp;<span class="num" id="4267825">56</span><span class="op" id="4267827">-</span><span class="builtinfunc" id="4267828">len</span><span class="op" id="4267831">%</span><span class="num" id="4267832">64</span><span class="op" id="4267834">]</span><span class="op" id="4267835">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267838">}</span>&nbsp;<span class="keyword" id="4267840">else</span>&nbsp;<span class="op" id="4267845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267849">d</span><span class="op" id="4267850">.</span><span class="ident" id="4267851">Write</span><span class="op" id="4267856">(</span><span class="ident" id="4267857">tmp</span><span class="op" id="4267860">[</span><span class="num" id="4267861">0</span>&nbsp;<span class="op" id="4267863">:</span>&nbsp;<span class="num" id="4267865">64</span><span class="op" id="4267867">+</span><span class="num" id="4267868">56</span><span class="op" id="4267870">-</span><span class="builtinfunc" id="4267871">len</span><span class="op" id="4267874">%</span><span class="num" id="4267875">64</span><span class="op" id="4267877">]</span><span class="op" id="4267878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4267885">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4267905">len</span>&nbsp;<span class="op" id="4267909">&lt;&lt;=</span>&nbsp;<span class="num" id="4267913">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267916">for</span>&nbsp;<span class="ident" id="4267920">i</span>&nbsp;<span class="op" id="4267922">:=</span>&nbsp;<span class="builtintype" id="4267925">uint</span><span class="op" id="4267929">(</span><span class="num" id="4267930">0</span><span class="op" id="4267931">)</span><span class="op" id="4267932">;</span>&nbsp;<span class="ident" id="4267934">i</span>&nbsp;<span class="op" id="4267936">&lt;</span>&nbsp;<span class="num" id="4267938">8</span><span class="op" id="4267939">;</span>&nbsp;<span class="ident" id="4267941">i</span><span class="op" id="4267942">++</span>&nbsp;<span class="op" id="4267945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267949">tmp</span><span class="op" id="4267952">[</span><span class="ident" id="4267953">i</span><span class="op" id="4267954">]</span>&nbsp;<span class="op" id="4267956">=</span>&nbsp;<span class="builtintype" id="4267958">byte</span><span class="op" id="4267962">(</span><span class="builtinfunc" id="4267963">len</span>&nbsp;<span class="op" id="4267967">&gt;&gt;</span>&nbsp;<span class="op" id="4267970">(</span><span class="num" id="4267971">56</span>&nbsp;<span class="op" id="4267974">-</span>&nbsp;<span class="num" id="4267976">8</span><span class="op" id="4267977">*</span><span class="ident" id="4267978">i</span><span class="op" id="4267979">)</span><span class="op" id="4267980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267986">d</span><span class="op" id="4267987">.</span><span class="ident" id="4267988">Write</span><span class="op" id="4267993">(</span><span class="ident" id="4267994">tmp</span><span class="op" id="4267997">[</span><span class="num" id="4267998">0</span><span class="op" id="4267999">:</span><span class="num" id="4268000">8</span><span class="op" id="4268001">]</span><span class="op" id="4268002">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268006">if</span>&nbsp;<span class="ident" id="4268009">d</span><span class="op" id="4268010">.</span><span class="ident" id="4268011">nx</span>&nbsp;<span class="op" id="4268014">!=</span>&nbsp;<span class="num" id="4268017">0</span>&nbsp;<span class="op" id="4268019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4268023">panic</span><span class="op" id="4268028">(</span><span class="string" id="4268029">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4268040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4268043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268047">h</span>&nbsp;<span class="op" id="4268049">:=</span>&nbsp;<span class="ident" id="4268052">d</span><span class="op" id="4268053">.</span><span class="ident" id="4268054">h</span><span class="op" id="4268055">[</span><span class="op" id="4268056">:</span><span class="op" id="4268057">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268060">if</span>&nbsp;<span class="ident" id="4268063">d</span><span class="op" id="4268064">.</span><span class="ident" id="4268065">is224</span>&nbsp;<span class="op" id="4268071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268075">h</span>&nbsp;<span class="op" id="4268077">=</span>&nbsp;<span class="ident" id="4268079">d</span><span class="op" id="4268080">.</span><span class="ident" id="4268081">h</span><span class="op" id="4268082">[</span><span class="op" id="4268083">:</span><span class="num" id="4268084">7</span><span class="op" id="4268085">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4268088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268092">var</span>&nbsp;<span class="ident" id="4268096">digest</span>&nbsp;<span class="op" id="4268103">[</span><span class="ident" id="4268104">Size</span><span class="op" id="4268108">]</span><span class="builtintype" id="4268109">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268115">for</span>&nbsp;<span class="ident" id="4268119">i</span><span class="op" id="4268120">,</span>&nbsp;<span class="ident" id="4268122">s</span>&nbsp;<span class="op" id="4268124">:=</span>&nbsp;<span class="keyword" id="4268127">range</span>&nbsp;<span class="ident" id="4268133">h</span>&nbsp;<span class="op" id="4268135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268139">digest</span><span class="op" id="4268145">[</span><span class="ident" id="4268146">i</span><span class="op" id="4268147">*</span><span class="num" id="4268148">4</span><span class="op" id="4268149">]</span>&nbsp;<span class="op" id="4268151">=</span>&nbsp;<span class="builtintype" id="4268153">byte</span><span class="op" id="4268157">(</span><span class="ident" id="4268158">s</span>&nbsp;<span class="op" id="4268160">&gt;&gt;</span>&nbsp;<span class="num" id="4268163">24</span><span class="op" id="4268165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268169">digest</span><span class="op" id="4268175">[</span><span class="ident" id="4268176">i</span><span class="op" id="4268177">*</span><span class="num" id="4268178">4</span><span class="op" id="4268179">+</span><span class="num" id="4268180">1</span><span class="op" id="4268181">]</span>&nbsp;<span class="op" id="4268183">=</span>&nbsp;<span class="builtintype" id="4268185">byte</span><span class="op" id="4268189">(</span><span class="ident" id="4268190">s</span>&nbsp;<span class="op" id="4268192">&gt;&gt;</span>&nbsp;<span class="num" id="4268195">16</span><span class="op" id="4268197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268201">digest</span><span class="op" id="4268207">[</span><span class="ident" id="4268208">i</span><span class="op" id="4268209">*</span><span class="num" id="4268210">4</span><span class="op" id="4268211">+</span><span class="num" id="4268212">2</span><span class="op" id="4268213">]</span>&nbsp;<span class="op" id="4268215">=</span>&nbsp;<span class="builtintype" id="4268217">byte</span><span class="op" id="4268221">(</span><span class="ident" id="4268222">s</span>&nbsp;<span class="op" id="4268224">&gt;&gt;</span>&nbsp;<span class="num" id="4268227">8</span><span class="op" id="4268228">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268232">digest</span><span class="op" id="4268238">[</span><span class="ident" id="4268239">i</span><span class="op" id="4268240">*</span><span class="num" id="4268241">4</span><span class="op" id="4268242">+</span><span class="num" id="4268243">3</span><span class="op" id="4268244">]</span>&nbsp;<span class="op" id="4268246">=</span>&nbsp;<span class="builtintype" id="4268248">byte</span><span class="op" id="4268252">(</span><span class="ident" id="4268253">s</span><span class="op" id="4268254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4268257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268261">return</span>&nbsp;<span class="ident" id="4268268">digest</span><br>
<span class="lineno"></span><span class="op" id="4268275">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4268278">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4268329">func</span>&nbsp;<span class="ident" id="4268334">Sum256</span><span class="op" id="4268340">(</span><span class="ident" id="4268341">data</span>&nbsp;<span class="op" id="4268346">[</span><span class="op" id="4268347">]</span><span class="builtintype" id="4268348">byte</span><span class="op" id="4268352">)</span>&nbsp;<span class="op" id="4268354">[</span><span class="ident" id="4268355">Size</span><span class="op" id="4268359">]</span><span class="builtintype" id="4268360">byte</span>&nbsp;<span class="op" id="4268365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268368">var</span>&nbsp;<span class="ident" id="4268372">d</span>&nbsp;<span class="ident" id="4268374">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268382">d</span><span class="op" id="4268383">.</span><span class="ident" id="4268384">Reset</span><span class="op" id="4268389">(</span><span class="op" id="4268390">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268393">d</span><span class="op" id="4268394">.</span><span class="ident" id="4268395">Write</span><span class="op" id="4268400">(</span><span class="ident" id="4268401">data</span><span class="op" id="4268405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268408">return</span>&nbsp;<span class="ident" id="4268415">d</span><span class="op" id="4268416">.</span><span class="ident" id="4268417">checkSum</span><span class="op" id="4268425">(</span><span class="op" id="4268426">)</span><br>
<span class="lineno"></span><span class="op" id="4268428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4268431">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="4268482">func</span>&nbsp;<span class="ident" id="4268487">Sum224</span><span class="op" id="4268493">(</span><span class="ident" id="4268494">data</span>&nbsp;<span class="op" id="4268499">[</span><span class="op" id="4268500">]</span><span class="builtintype" id="4268501">byte</span><span class="op" id="4268505">)</span>&nbsp;<span class="op" id="4268507">(</span><span class="ident" id="4268508">sum224</span>&nbsp;<span class="op" id="4268515">[</span><span class="ident" id="4268516">Size224</span><span class="op" id="4268523">]</span><span class="builtintype" id="4268524">byte</span><span class="op" id="4268528">)</span>&nbsp;<span class="op" id="4268530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268533">var</span>&nbsp;<span class="ident" id="4268537">d</span>&nbsp;<span class="ident" id="4268539">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268547">d</span><span class="op" id="4268548">.</span><span class="ident" id="4268549">is224</span>&nbsp;<span class="op" id="4268555">=</span>&nbsp;<span class="ident" id="4268557">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268563">d</span><span class="op" id="4268564">.</span><span class="ident" id="4268565">Reset</span><span class="op" id="4268570">(</span><span class="op" id="4268571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268574">d</span><span class="op" id="4268575">.</span><span class="ident" id="4268576">Write</span><span class="op" id="4268581">(</span><span class="ident" id="4268582">data</span><span class="op" id="4268586">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268589">sum</span>&nbsp;<span class="op" id="4268593">:=</span>&nbsp;<span class="ident" id="4268596">d</span><span class="op" id="4268597">.</span><span class="ident" id="4268598">checkSum</span><span class="op" id="4268606">(</span><span class="op" id="4268607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4268610">copy</span><span class="op" id="4268614">(</span><span class="ident" id="4268615">sum224</span><span class="op" id="4268621">[</span><span class="op" id="4268622">:</span><span class="op" id="4268623">]</span><span class="op" id="4268624">,</span>&nbsp;<span class="ident" id="4268626">sum</span><span class="op" id="4268629">[</span><span class="op" id="4268630">:</span><span class="ident" id="4268631">Size224</span><span class="op" id="4268638">]</span><span class="op" id="4268639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268642">return</span><br>
<span class="lineno"></span><span class="op" id="4268649">}</span>
</div>
</body>
</html>
