<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4572553">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4572608">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4572662">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4572713">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4572730">package</span>&nbsp;<span class="ident" id="4572738">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4572743">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="4572771">func</span>&nbsp;<span class="ident" id="4572776">hasAsm</span><span class="op" id="4572782">(</span><span class="op" id="4572783">)</span>&nbsp;<span class="builtintype" id="4572785">bool</span><br>
<span class="lineno"></span><span class="keyword" id="4572790">func</span>&nbsp;<span class="ident" id="4572795">encryptBlockAsm</span><span class="op" id="4572810">(</span><span class="ident" id="4572811">nr</span>&nbsp;<span class="builtintype" id="4572814">int</span><span class="op" id="4572817">,</span>&nbsp;<span class="ident" id="4572819">xk</span>&nbsp;<span class="op" id="4572822">*</span><span class="builtintype" id="4572823">uint32</span><span class="op" id="4572829">,</span>&nbsp;<span class="ident" id="4572831">dst</span><span class="op" id="4572834">,</span>&nbsp;<span class="ident" id="4572836">src</span>&nbsp;<span class="op" id="4572840">*</span><span class="builtintype" id="4572841">byte</span><span class="op" id="4572845">)</span><br>
<span class="lineno"></span><span class="keyword" id="4572847">func</span>&nbsp;<span class="ident" id="4572852">decryptBlockAsm</span><span class="op" id="4572867">(</span><span class="ident" id="4572868">nr</span>&nbsp;<span class="builtintype" id="4572871">int</span><span class="op" id="4572874">,</span>&nbsp;<span class="ident" id="4572876">xk</span>&nbsp;<span class="op" id="4572879">*</span><span class="builtintype" id="4572880">uint32</span><span class="op" id="4572886">,</span>&nbsp;<span class="ident" id="4572888">dst</span><span class="op" id="4572891">,</span>&nbsp;<span class="ident" id="4572893">src</span>&nbsp;<span class="op" id="4572897">*</span><span class="builtintype" id="4572898">byte</span><span class="op" id="4572902">)</span><br>
<span class="lineno"></span><span class="keyword" id="4572904">func</span>&nbsp;<span class="ident" id="4572909">expandKeyAsm</span><span class="op" id="4572921">(</span><span class="ident" id="4572922">nr</span>&nbsp;<span class="builtintype" id="4572925">int</span><span class="op" id="4572928">,</span>&nbsp;<span class="ident" id="4572930">key</span>&nbsp;<span class="op" id="4572934">*</span><span class="builtintype" id="4572935">byte</span><span class="op" id="4572939">,</span>&nbsp;<span class="ident" id="4572941">enc</span>&nbsp;<span class="op" id="4572945">*</span><span class="builtintype" id="4572946">uint32</span><span class="op" id="4572952">,</span>&nbsp;<span class="ident" id="4572954">dec</span>&nbsp;<span class="op" id="4572958">*</span><span class="builtintype" id="4572959">uint32</span><span class="op" id="4572965">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4572968">var</span>&nbsp;<span class="ident" id="4572972">useAsm</span>&nbsp;<span class="op" id="4572979">=</span>&nbsp;<span class="ident" id="4572981">hasAsm</span><span class="op" id="4572987">(</span><span class="op" id="4572988">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4572991">func</span>&nbsp;<span class="ident" id="4572996">encryptBlock</span><span class="op" id="4573008">(</span><span class="ident" id="4573009">xk</span>&nbsp;<span class="op" id="4573012">[</span><span class="op" id="4573013">]</span><span class="builtintype" id="4573014">uint32</span><span class="op" id="4573020">,</span>&nbsp;<span class="ident" id="4573022">dst</span><span class="op" id="4573025">,</span>&nbsp;<span class="ident" id="4573027">src</span>&nbsp;<span class="op" id="4573031">[</span><span class="op" id="4573032">]</span><span class="builtintype" id="4573033">byte</span><span class="op" id="4573037">)</span>&nbsp;<span class="op" id="4573039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573042">if</span>&nbsp;<span class="ident" id="4573045">useAsm</span>&nbsp;<span class="op" id="4573052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573056">encryptBlockAsm</span><span class="op" id="4573071">(</span><span class="builtinfunc" id="4573072">len</span><span class="op" id="4573075">(</span><span class="ident" id="4573076">xk</span><span class="op" id="4573078">)</span><span class="op" id="4573079">/</span><span class="num" id="4573080">4</span><span class="op" id="4573081">-</span><span class="num" id="4573082">1</span><span class="op" id="4573083">,</span>&nbsp;<span class="op" id="4573085">&amp;</span><span class="ident" id="4573086">xk</span><span class="op" id="4573088">[</span><span class="num" id="4573089">0</span><span class="op" id="4573090">]</span><span class="op" id="4573091">,</span>&nbsp;<span class="op" id="4573093">&amp;</span><span class="ident" id="4573094">dst</span><span class="op" id="4573097">[</span><span class="num" id="4573098">0</span><span class="op" id="4573099">]</span><span class="op" id="4573100">,</span>&nbsp;<span class="op" id="4573102">&amp;</span><span class="ident" id="4573103">src</span><span class="op" id="4573106">[</span><span class="num" id="4573107">0</span><span class="op" id="4573108">]</span><span class="op" id="4573109">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573112">}</span>&nbsp;<span class="keyword" id="4573114">else</span>&nbsp;<span class="op" id="4573119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573123">encryptBlockGo</span><span class="op" id="4573137">(</span><span class="ident" id="4573138">xk</span><span class="op" id="4573140">,</span>&nbsp;<span class="ident" id="4573142">dst</span><span class="op" id="4573145">,</span>&nbsp;<span class="ident" id="4573147">src</span><span class="op" id="4573150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573153">}</span><br>
<span class="lineno"></span><span class="op" id="4573155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4573158">func</span>&nbsp;<span class="ident" id="4573163">decryptBlock</span><span class="op" id="4573175">(</span><span class="ident" id="4573176">xk</span>&nbsp;<span class="op" id="4573179">[</span><span class="op" id="4573180">]</span><span class="builtintype" id="4573181">uint32</span><span class="op" id="4573187">,</span>&nbsp;<span class="ident" id="4573189">dst</span><span class="op" id="4573192">,</span>&nbsp;<span class="ident" id="4573194">src</span>&nbsp;<span class="op" id="4573198">[</span><span class="op" id="4573199">]</span><span class="builtintype" id="4573200">byte</span><span class="op" id="4573204">)</span>&nbsp;<span class="op" id="4573206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573209">if</span>&nbsp;<span class="ident" id="4573212">useAsm</span>&nbsp;<span class="op" id="4573219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573223">decryptBlockAsm</span><span class="op" id="4573238">(</span><span class="builtinfunc" id="4573239">len</span><span class="op" id="4573242">(</span><span class="ident" id="4573243">xk</span><span class="op" id="4573245">)</span><span class="op" id="4573246">/</span><span class="num" id="4573247">4</span><span class="op" id="4573248">-</span><span class="num" id="4573249">1</span><span class="op" id="4573250">,</span>&nbsp;<span class="op" id="4573252">&amp;</span><span class="ident" id="4573253">xk</span><span class="op" id="4573255">[</span><span class="num" id="4573256">0</span><span class="op" id="4573257">]</span><span class="op" id="4573258">,</span>&nbsp;<span class="op" id="4573260">&amp;</span><span class="ident" id="4573261">dst</span><span class="op" id="4573264">[</span><span class="num" id="4573265">0</span><span class="op" id="4573266">]</span><span class="op" id="4573267">,</span>&nbsp;<span class="op" id="4573269">&amp;</span><span class="ident" id="4573270">src</span><span class="op" id="4573273">[</span><span class="num" id="4573274">0</span><span class="op" id="4573275">]</span><span class="op" id="4573276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573279">}</span>&nbsp;<span class="keyword" id="4573281">else</span>&nbsp;<span class="op" id="4573286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573290">decryptBlockGo</span><span class="op" id="4573304">(</span><span class="ident" id="4573305">xk</span><span class="op" id="4573307">,</span>&nbsp;<span class="ident" id="4573309">dst</span><span class="op" id="4573312">,</span>&nbsp;<span class="ident" id="4573314">src</span><span class="op" id="4573317">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573320">}</span><br>
<span class="lineno"></span><span class="op" id="4573322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4573325">func</span>&nbsp;<span class="ident" id="4573330">expandKey</span><span class="op" id="4573339">(</span><span class="ident" id="4573340">key</span>&nbsp;<span class="op" id="4573344">[</span><span class="op" id="4573345">]</span><span class="builtintype" id="4573346">byte</span><span class="op" id="4573350">,</span>&nbsp;<span class="ident" id="4573352">enc</span><span class="op" id="4573355">,</span>&nbsp;<span class="ident" id="4573357">dec</span>&nbsp;<span class="op" id="4573361">[</span><span class="op" id="4573362">]</span><span class="builtintype" id="4573363">uint32</span><span class="op" id="4573369">)</span>&nbsp;<span class="op" id="4573371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573374">if</span>&nbsp;<span class="ident" id="4573377">useAsm</span>&nbsp;<span class="op" id="4573384">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573388">rounds</span>&nbsp;<span class="op" id="4573395">:=</span>&nbsp;<span class="num" id="4573398">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573403">switch</span>&nbsp;<span class="builtinfunc" id="4573410">len</span><span class="op" id="4573413">(</span><span class="ident" id="4573414">key</span><span class="op" id="4573417">)</span>&nbsp;<span class="op" id="4573419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573423">case</span>&nbsp;<span class="num" id="4573428">128</span>&nbsp;<span class="op" id="4573432">/</span>&nbsp;<span class="num" id="4573434">8</span><span class="op" id="4573435">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573440">rounds</span>&nbsp;<span class="op" id="4573447">=</span>&nbsp;<span class="num" id="4573449">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573454">case</span>&nbsp;<span class="num" id="4573459">192</span>&nbsp;<span class="op" id="4573463">/</span>&nbsp;<span class="num" id="4573465">8</span><span class="op" id="4573466">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573471">rounds</span>&nbsp;<span class="op" id="4573478">=</span>&nbsp;<span class="num" id="4573480">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573485">case</span>&nbsp;<span class="num" id="4573490">256</span>&nbsp;<span class="op" id="4573494">/</span>&nbsp;<span class="num" id="4573496">8</span><span class="op" id="4573497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573502">rounds</span>&nbsp;<span class="op" id="4573509">=</span>&nbsp;<span class="num" id="4573511">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573520">expandKeyAsm</span><span class="op" id="4573532">(</span><span class="ident" id="4573533">rounds</span><span class="op" id="4573539">,</span>&nbsp;<span class="op" id="4573541">&amp;</span><span class="ident" id="4573542">key</span><span class="op" id="4573545">[</span><span class="num" id="4573546">0</span><span class="op" id="4573547">]</span><span class="op" id="4573548">,</span>&nbsp;<span class="op" id="4573550">&amp;</span><span class="ident" id="4573551">enc</span><span class="op" id="4573554">[</span><span class="num" id="4573555">0</span><span class="op" id="4573556">]</span><span class="op" id="4573557">,</span>&nbsp;<span class="op" id="4573559">&amp;</span><span class="ident" id="4573560">dec</span><span class="op" id="4573563">[</span><span class="num" id="4573564">0</span><span class="op" id="4573565">]</span><span class="op" id="4573566">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573569">}</span>&nbsp;<span class="keyword" id="4573571">else</span>&nbsp;<span class="op" id="4573576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573580">expandKeyGo</span><span class="op" id="4573591">(</span><span class="ident" id="4573592">key</span><span class="op" id="4573595">,</span>&nbsp;<span class="ident" id="4573597">enc</span><span class="op" id="4573600">,</span>&nbsp;<span class="ident" id="4573602">dec</span><span class="op" id="4573605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573608">}</span><br>
<span class="lineno"></span><span class="op" id="4573610">}</span>
</div>
</body>
</html>
