<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html" class="current">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7378132">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7378187">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7378241">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7378292">package</span>&nbsp;<span class="ident" id="7378300">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7378307">import</span>&nbsp;<span class="op" id="7378314">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378317">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378326">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378344">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378363">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378378">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378393">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378410">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378427">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378443">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378451">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378457">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378469">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378475">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378486">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7378496">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7378499">func</span>&nbsp;<span class="ident" id="7378504">testKeyGeneration</span><span class="op" id="7378521">(</span><span class="ident" id="7378522">t</span>&nbsp;<span class="op" id="7378524">*</span><span class="ident" id="7378525">testing</span><span class="op" id="7378532">.</span><span class="ident" id="7378533">T</span><span class="op" id="7378534">,</span>&nbsp;<span class="ident" id="7378536">c</span>&nbsp;<span class="ident" id="7378538">elliptic</span><span class="op" id="7378546">.</span><span class="ident" id="7378547">Curve</span><span class="op" id="7378552">,</span>&nbsp;<span class="ident" id="7378554">tag</span>&nbsp;<span class="builtintype" id="7378558">string</span><span class="op" id="7378564">)</span>&nbsp;<span class="op" id="7378566">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378569">priv</span><span class="op" id="7378573">,</span>&nbsp;<span class="ident" id="7378575">err</span>&nbsp;<span class="op" id="7378579">:=</span>&nbsp;<span class="ident" id="7378582">GenerateKey</span><span class="op" id="7378593">(</span><span class="ident" id="7378594">c</span><span class="op" id="7378595">,</span>&nbsp;<span class="ident" id="7378597">rand</span><span class="op" id="7378601">.</span><span class="ident" id="7378602">Reader</span><span class="op" id="7378608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378611">if</span>&nbsp;<span class="ident" id="7378614">err</span>&nbsp;<span class="op" id="7378618">!=</span>&nbsp;<span class="ident" id="7378621">nil</span>&nbsp;<span class="op" id="7378625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378629">t</span><span class="op" id="7378630">.</span><span class="ident" id="7378631">Errorf</span><span class="op" id="7378637">(</span><span class="string" id="7378638">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7378653">,</span>&nbsp;<span class="ident" id="7378655">tag</span><span class="op" id="7378658">,</span>&nbsp;<span class="ident" id="7378660">err</span><span class="op" id="7378663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378667">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7378675">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378678">if</span>&nbsp;<span class="op" id="7378681">!</span><span class="ident" id="7378682">c</span><span class="op" id="7378683">.</span><span class="ident" id="7378684">IsOnCurve</span><span class="op" id="7378693">(</span><span class="ident" id="7378694">priv</span><span class="op" id="7378698">.</span><span class="ident" id="7378699">PublicKey</span><span class="op" id="7378708">.</span><span class="ident" id="7378709">X</span><span class="op" id="7378710">,</span>&nbsp;<span class="ident" id="7378712">priv</span><span class="op" id="7378716">.</span><span class="ident" id="7378717">PublicKey</span><span class="op" id="7378726">.</span><span class="ident" id="7378727">Y</span><span class="op" id="7378728">)</span>&nbsp;<span class="op" id="7378730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378734">t</span><span class="op" id="7378735">.</span><span class="ident" id="7378736">Errorf</span><span class="op" id="7378742">(</span><span class="string" id="7378743">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="7378771">,</span>&nbsp;<span class="ident" id="7378773">tag</span><span class="op" id="7378776">,</span>&nbsp;<span class="ident" id="7378778">err</span><span class="op" id="7378781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7378784">}</span><br>
<span class="lineno"></span><span class="op" id="7378786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7378789">func</span>&nbsp;<span class="ident" id="7378794">TestKeyGeneration</span><span class="op" id="7378811">(</span><span class="ident" id="7378812">t</span>&nbsp;<span class="op" id="7378814">*</span><span class="ident" id="7378815">testing</span><span class="op" id="7378822">.</span><span class="ident" id="7378823">T</span><span class="op" id="7378824">)</span>&nbsp;<span class="op" id="7378826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378829">testKeyGeneration</span><span class="op" id="7378846">(</span><span class="ident" id="7378847">t</span><span class="op" id="7378848">,</span>&nbsp;<span class="ident" id="7378850">elliptic</span><span class="op" id="7378858">.</span><span class="ident" id="7378859">P224</span><span class="op" id="7378863">(</span><span class="op" id="7378864">)</span><span class="op" id="7378865">,</span>&nbsp;<span class="string" id="7378867">&#34;p224&#34;</span><span class="op" id="7378873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378876">if</span>&nbsp;<span class="ident" id="7378879">testing</span><span class="op" id="7378886">.</span><span class="ident" id="7378887">Short</span><span class="op" id="7378892">(</span><span class="op" id="7378893">)</span>&nbsp;<span class="op" id="7378895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378899">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7378907">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378910">testKeyGeneration</span><span class="op" id="7378927">(</span><span class="ident" id="7378928">t</span><span class="op" id="7378929">,</span>&nbsp;<span class="ident" id="7378931">elliptic</span><span class="op" id="7378939">.</span><span class="ident" id="7378940">P256</span><span class="op" id="7378944">(</span><span class="op" id="7378945">)</span><span class="op" id="7378946">,</span>&nbsp;<span class="string" id="7378948">&#34;p256&#34;</span><span class="op" id="7378954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378957">testKeyGeneration</span><span class="op" id="7378974">(</span><span class="ident" id="7378975">t</span><span class="op" id="7378976">,</span>&nbsp;<span class="ident" id="7378978">elliptic</span><span class="op" id="7378986">.</span><span class="ident" id="7378987">P384</span><span class="op" id="7378991">(</span><span class="op" id="7378992">)</span><span class="op" id="7378993">,</span>&nbsp;<span class="string" id="7378995">&#34;p384&#34;</span><span class="op" id="7379001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379004">testKeyGeneration</span><span class="op" id="7379021">(</span><span class="ident" id="7379022">t</span><span class="op" id="7379023">,</span>&nbsp;<span class="ident" id="7379025">elliptic</span><span class="op" id="7379033">.</span><span class="ident" id="7379034">P521</span><span class="op" id="7379038">(</span><span class="op" id="7379039">)</span><span class="op" id="7379040">,</span>&nbsp;<span class="string" id="7379042">&#34;p521&#34;</span><span class="op" id="7379048">)</span><br>
<span class="lineno"></span><span class="op" id="7379050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7379053">func</span>&nbsp;<span class="ident" id="7379058">testSignAndVerify</span><span class="op" id="7379075">(</span><span class="ident" id="7379076">t</span>&nbsp;<span class="op" id="7379078">*</span><span class="ident" id="7379079">testing</span><span class="op" id="7379086">.</span><span class="ident" id="7379087">T</span><span class="op" id="7379088">,</span>&nbsp;<span class="ident" id="7379090">c</span>&nbsp;<span class="ident" id="7379092">elliptic</span><span class="op" id="7379100">.</span><span class="ident" id="7379101">Curve</span><span class="op" id="7379106">,</span>&nbsp;<span class="ident" id="7379108">tag</span>&nbsp;<span class="builtintype" id="7379112">string</span><span class="op" id="7379118">)</span>&nbsp;<span class="op" id="7379120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379123">priv</span><span class="op" id="7379127">,</span>&nbsp;<span class="ident" id="7379129">_</span>&nbsp;<span class="op" id="7379131">:=</span>&nbsp;<span class="ident" id="7379134">GenerateKey</span><span class="op" id="7379145">(</span><span class="ident" id="7379146">c</span><span class="op" id="7379147">,</span>&nbsp;<span class="ident" id="7379149">rand</span><span class="op" id="7379153">.</span><span class="ident" id="7379154">Reader</span><span class="op" id="7379160">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379164">hashed</span>&nbsp;<span class="op" id="7379171">:=</span>&nbsp;<span class="op" id="7379174">[</span><span class="op" id="7379175">]</span><span class="builtintype" id="7379176">byte</span><span class="op" id="7379180">(</span><span class="string" id="7379181">&#34;testing&#34;</span><span class="op" id="7379190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379193">r</span><span class="op" id="7379194">,</span>&nbsp;<span class="ident" id="7379196">s</span><span class="op" id="7379197">,</span>&nbsp;<span class="ident" id="7379199">err</span>&nbsp;<span class="op" id="7379203">:=</span>&nbsp;<span class="ident" id="7379206">Sign</span><span class="op" id="7379210">(</span><span class="ident" id="7379211">rand</span><span class="op" id="7379215">.</span><span class="ident" id="7379216">Reader</span><span class="op" id="7379222">,</span>&nbsp;<span class="ident" id="7379224">priv</span><span class="op" id="7379228">,</span>&nbsp;<span class="ident" id="7379230">hashed</span><span class="op" id="7379236">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379239">if</span>&nbsp;<span class="ident" id="7379242">err</span>&nbsp;<span class="op" id="7379246">!=</span>&nbsp;<span class="ident" id="7379249">nil</span>&nbsp;<span class="op" id="7379253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379257">t</span><span class="op" id="7379258">.</span><span class="ident" id="7379259">Errorf</span><span class="op" id="7379265">(</span><span class="string" id="7379266">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7379289">,</span>&nbsp;<span class="ident" id="7379291">tag</span><span class="op" id="7379294">,</span>&nbsp;<span class="ident" id="7379296">err</span><span class="op" id="7379299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379303">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7379311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379315">if</span>&nbsp;<span class="op" id="7379318">!</span><span class="ident" id="7379319">Verify</span><span class="op" id="7379325">(</span><span class="op" id="7379326">&amp;</span><span class="ident" id="7379327">priv</span><span class="op" id="7379331">.</span><span class="ident" id="7379332">PublicKey</span><span class="op" id="7379341">,</span>&nbsp;<span class="ident" id="7379343">hashed</span><span class="op" id="7379349">,</span>&nbsp;<span class="ident" id="7379351">r</span><span class="op" id="7379352">,</span>&nbsp;<span class="ident" id="7379354">s</span><span class="op" id="7379355">)</span>&nbsp;<span class="op" id="7379357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379361">t</span><span class="op" id="7379362">.</span><span class="ident" id="7379363">Errorf</span><span class="op" id="7379369">(</span><span class="string" id="7379370">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="7379389">,</span>&nbsp;<span class="ident" id="7379391">tag</span><span class="op" id="7379394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7379397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379401">hashed</span><span class="op" id="7379407">[</span><span class="num" id="7379408">0</span><span class="op" id="7379409">]</span>&nbsp;<span class="op" id="7379411">^=</span>&nbsp;<span class="num" id="7379414">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379420">if</span>&nbsp;<span class="ident" id="7379423">Verify</span><span class="op" id="7379429">(</span><span class="op" id="7379430">&amp;</span><span class="ident" id="7379431">priv</span><span class="op" id="7379435">.</span><span class="ident" id="7379436">PublicKey</span><span class="op" id="7379445">,</span>&nbsp;<span class="ident" id="7379447">hashed</span><span class="op" id="7379453">,</span>&nbsp;<span class="ident" id="7379455">r</span><span class="op" id="7379456">,</span>&nbsp;<span class="ident" id="7379458">s</span><span class="op" id="7379459">)</span>&nbsp;<span class="op" id="7379461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379465">t</span><span class="op" id="7379466">.</span><span class="ident" id="7379467">Errorf</span><span class="op" id="7379473">(</span><span class="string" id="7379474">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="7379500">,</span>&nbsp;<span class="ident" id="7379502">tag</span><span class="op" id="7379505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7379508">}</span><br>
<span class="lineno"></span><span class="op" id="7379510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7379513">func</span>&nbsp;<span class="ident" id="7379518">TestSignAndVerify</span><span class="op" id="7379535">(</span><span class="ident" id="7379536">t</span>&nbsp;<span class="op" id="7379538">*</span><span class="ident" id="7379539">testing</span><span class="op" id="7379546">.</span><span class="ident" id="7379547">T</span><span class="op" id="7379548">)</span>&nbsp;<span class="op" id="7379550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379553">testSignAndVerify</span><span class="op" id="7379570">(</span><span class="ident" id="7379571">t</span><span class="op" id="7379572">,</span>&nbsp;<span class="ident" id="7379574">elliptic</span><span class="op" id="7379582">.</span><span class="ident" id="7379583">P224</span><span class="op" id="7379587">(</span><span class="op" id="7379588">)</span><span class="op" id="7379589">,</span>&nbsp;<span class="string" id="7379591">&#34;p224&#34;</span><span class="op" id="7379597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379600">if</span>&nbsp;<span class="ident" id="7379603">testing</span><span class="op" id="7379610">.</span><span class="ident" id="7379611">Short</span><span class="op" id="7379616">(</span><span class="op" id="7379617">)</span>&nbsp;<span class="op" id="7379619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379623">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7379631">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379634">testSignAndVerify</span><span class="op" id="7379651">(</span><span class="ident" id="7379652">t</span><span class="op" id="7379653">,</span>&nbsp;<span class="ident" id="7379655">elliptic</span><span class="op" id="7379663">.</span><span class="ident" id="7379664">P256</span><span class="op" id="7379668">(</span><span class="op" id="7379669">)</span><span class="op" id="7379670">,</span>&nbsp;<span class="string" id="7379672">&#34;p256&#34;</span><span class="op" id="7379678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379681">testSignAndVerify</span><span class="op" id="7379698">(</span><span class="ident" id="7379699">t</span><span class="op" id="7379700">,</span>&nbsp;<span class="ident" id="7379702">elliptic</span><span class="op" id="7379710">.</span><span class="ident" id="7379711">P384</span><span class="op" id="7379715">(</span><span class="op" id="7379716">)</span><span class="op" id="7379717">,</span>&nbsp;<span class="string" id="7379719">&#34;p384&#34;</span><span class="op" id="7379725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379728">testSignAndVerify</span><span class="op" id="7379745">(</span><span class="ident" id="7379746">t</span><span class="op" id="7379747">,</span>&nbsp;<span class="ident" id="7379749">elliptic</span><span class="op" id="7379757">.</span><span class="ident" id="7379758">P521</span><span class="op" id="7379762">(</span><span class="op" id="7379763">)</span><span class="op" id="7379764">,</span>&nbsp;<span class="string" id="7379766">&#34;p521&#34;</span><span class="op" id="7379772">)</span><br>
<span class="lineno"></span><span class="op" id="7379774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7379777">func</span>&nbsp;<span class="ident" id="7379782">fromHex</span><span class="op" id="7379789">(</span><span class="ident" id="7379790">s</span>&nbsp;<span class="builtintype" id="7379792">string</span><span class="op" id="7379798">)</span>&nbsp;<span class="op" id="7379800">*</span><span class="ident" id="7379801">big</span><span class="op" id="7379804">.</span><span class="ident" id="7379805">Int</span>&nbsp;<span class="op" id="7379809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379812">r</span><span class="op" id="7379813">,</span>&nbsp;<span class="ident" id="7379815">ok</span>&nbsp;<span class="op" id="7379818">:=</span>&nbsp;<span class="builtinfunc" id="7379821">new</span><span class="op" id="7379824">(</span><span class="ident" id="7379825">big</span><span class="op" id="7379828">.</span><span class="ident" id="7379829">Int</span><span class="op" id="7379832">)</span><span class="op" id="7379833">.</span><span class="ident" id="7379834">SetString</span><span class="op" id="7379843">(</span><span class="ident" id="7379844">s</span><span class="op" id="7379845">,</span>&nbsp;<span class="num" id="7379847">16</span><span class="op" id="7379849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379852">if</span>&nbsp;<span class="op" id="7379855">!</span><span class="ident" id="7379856">ok</span>&nbsp;<span class="op" id="7379859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7379863">panic</span><span class="op" id="7379868">(</span><span class="string" id="7379869">&#34;bad&nbsp;hex&#34;</span><span class="op" id="7379878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7379881">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379884">return</span>&nbsp;<span class="ident" id="7379891">r</span><br>
<span class="lineno"></span><span class="op" id="7379893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7379896">func</span>&nbsp;<span class="ident" id="7379901">TestVectors</span><span class="op" id="7379912">(</span><span class="ident" id="7379913">t</span>&nbsp;<span class="op" id="7379915">*</span><span class="ident" id="7379916">testing</span><span class="op" id="7379923">.</span><span class="ident" id="7379924">T</span><span class="op" id="7379925">)</span>&nbsp;<span class="op" id="7379927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7379930">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7379988">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7380069">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7380073">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7380140">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380193">if</span>&nbsp;<span class="ident" id="7380196">testing</span><span class="op" id="7380203">.</span><span class="ident" id="7380204">Short</span><span class="op" id="7380209">(</span><span class="op" id="7380210">)</span>&nbsp;<span class="op" id="7380212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380216">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7380224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380228">f</span><span class="op" id="7380229">,</span>&nbsp;<span class="ident" id="7380231">err</span>&nbsp;<span class="op" id="7380235">:=</span>&nbsp;<span class="ident" id="7380238">os</span><span class="op" id="7380240">.</span><span class="ident" id="7380241">Open</span><span class="op" id="7380245">(</span><span class="string" id="7380246">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="7380271">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380274">if</span>&nbsp;<span class="ident" id="7380277">err</span>&nbsp;<span class="op" id="7380281">!=</span>&nbsp;<span class="ident" id="7380284">nil</span>&nbsp;<span class="op" id="7380288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380292">t</span><span class="op" id="7380293">.</span><span class="ident" id="7380294">Fatal</span><span class="op" id="7380299">(</span><span class="ident" id="7380300">err</span><span class="op" id="7380303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7380306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380310">buf</span>&nbsp;<span class="op" id="7380314">:=</span>&nbsp;<span class="ident" id="7380317">bufio</span><span class="op" id="7380322">.</span><span class="ident" id="7380323">NewReader</span><span class="op" id="7380332">(</span><span class="ident" id="7380333">bzip2</span><span class="op" id="7380338">.</span><span class="ident" id="7380339">NewReader</span><span class="op" id="7380348">(</span><span class="ident" id="7380349">f</span><span class="op" id="7380350">)</span><span class="op" id="7380351">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380355">lineNo</span>&nbsp;<span class="op" id="7380362">:=</span>&nbsp;<span class="num" id="7380365">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380368">var</span>&nbsp;<span class="ident" id="7380372">h</span>&nbsp;<span class="ident" id="7380374">hash</span><span class="op" id="7380378">.</span><span class="ident" id="7380379">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380385">var</span>&nbsp;<span class="ident" id="7380389">msg</span>&nbsp;<span class="op" id="7380393">[</span><span class="op" id="7380394">]</span><span class="builtintype" id="7380395">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380401">var</span>&nbsp;<span class="ident" id="7380405">hashed</span>&nbsp;<span class="op" id="7380412">[</span><span class="op" id="7380413">]</span><span class="builtintype" id="7380414">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380420">var</span>&nbsp;<span class="ident" id="7380424">r</span><span class="op" id="7380425">,</span>&nbsp;<span class="ident" id="7380427">s</span>&nbsp;<span class="op" id="7380429">*</span><span class="ident" id="7380430">big</span><span class="op" id="7380433">.</span><span class="ident" id="7380434">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380439">pub</span>&nbsp;<span class="op" id="7380443">:=</span>&nbsp;<span class="builtinfunc" id="7380446">new</span><span class="op" id="7380449">(</span><span class="ident" id="7380450">PublicKey</span><span class="op" id="7380459">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380463">for</span>&nbsp;<span class="op" id="7380467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380471">line</span><span class="op" id="7380475">,</span>&nbsp;<span class="ident" id="7380477">err</span>&nbsp;<span class="op" id="7380481">:=</span>&nbsp;<span class="ident" id="7380484">buf</span><span class="op" id="7380487">.</span><span class="ident" id="7380488">ReadString</span><span class="op" id="7380498">(</span><span class="string" id="7380499">&#39;\n&#39;</span><span class="op" id="7380503">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380507">if</span>&nbsp;<span class="builtinfunc" id="7380510">len</span><span class="op" id="7380513">(</span><span class="ident" id="7380514">line</span><span class="op" id="7380518">)</span>&nbsp;<span class="op" id="7380520">==</span>&nbsp;<span class="num" id="7380523">0</span>&nbsp;<span class="op" id="7380525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380530">if</span>&nbsp;<span class="ident" id="7380533">err</span>&nbsp;<span class="op" id="7380537">==</span>&nbsp;<span class="ident" id="7380540">io</span><span class="op" id="7380542">.</span><span class="ident" id="7380543">EOF</span>&nbsp;<span class="op" id="7380547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380553">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7380562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380567">t</span><span class="op" id="7380568">.</span><span class="ident" id="7380569">Fatalf</span><span class="op" id="7380575">(</span><span class="string" id="7380576">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="7380606">,</span>&nbsp;<span class="ident" id="7380608">err</span><span class="op" id="7380611">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7380615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380619">lineNo</span><span class="op" id="7380625">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7380630">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380681">if</span>&nbsp;<span class="op" id="7380684">!</span><span class="ident" id="7380685">strings</span><span class="op" id="7380692">.</span><span class="ident" id="7380693">HasSuffix</span><span class="op" id="7380702">(</span><span class="ident" id="7380703">line</span><span class="op" id="7380707">,</span>&nbsp;<span class="string" id="7380709">&#34;\r\n&#34;</span><span class="op" id="7380715">)</span>&nbsp;<span class="op" id="7380717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380722">t</span><span class="op" id="7380723">.</span><span class="ident" id="7380724">Fatalf</span><span class="op" id="7380730">(</span><span class="string" id="7380731">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7380777">,</span>&nbsp;<span class="ident" id="7380779">lineNo</span><span class="op" id="7380785">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7380789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380793">line</span>&nbsp;<span class="op" id="7380798">=</span>&nbsp;<span class="ident" id="7380800">line</span><span class="op" id="7380804">[</span><span class="op" id="7380805">:</span><span class="builtinfunc" id="7380806">len</span><span class="op" id="7380809">(</span><span class="ident" id="7380810">line</span><span class="op" id="7380814">)</span><span class="op" id="7380815">-</span><span class="num" id="7380816">2</span><span class="op" id="7380817">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380822">if</span>&nbsp;<span class="builtinfunc" id="7380825">len</span><span class="op" id="7380828">(</span><span class="ident" id="7380829">line</span><span class="op" id="7380833">)</span>&nbsp;<span class="op" id="7380835">==</span>&nbsp;<span class="num" id="7380838">0</span>&nbsp;<span class="op" id="7380840">||</span>&nbsp;<span class="ident" id="7380843">line</span><span class="op" id="7380847">[</span><span class="num" id="7380848">0</span><span class="op" id="7380849">]</span>&nbsp;<span class="op" id="7380851">==</span>&nbsp;<span class="string" id="7380854">&#39;#&#39;</span>&nbsp;<span class="op" id="7380858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380863">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7380874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380879">if</span>&nbsp;<span class="ident" id="7380882">line</span><span class="op" id="7380886">[</span><span class="num" id="7380887">0</span><span class="op" id="7380888">]</span>&nbsp;<span class="op" id="7380890">==</span>&nbsp;<span class="string" id="7380893">&#39;[&#39;</span>&nbsp;<span class="op" id="7380897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380902">line</span>&nbsp;<span class="op" id="7380907">=</span>&nbsp;<span class="ident" id="7380909">line</span><span class="op" id="7380913">[</span><span class="num" id="7380914">1</span>&nbsp;<span class="op" id="7380916">:</span>&nbsp;<span class="builtinfunc" id="7380918">len</span><span class="op" id="7380921">(</span><span class="ident" id="7380922">line</span><span class="op" id="7380926">)</span><span class="op" id="7380927">-</span><span class="num" id="7380928">1</span><span class="op" id="7380929">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380934">parts</span>&nbsp;<span class="op" id="7380940">:=</span>&nbsp;<span class="ident" id="7380943">strings</span><span class="op" id="7380950">.</span><span class="ident" id="7380951">SplitN</span><span class="op" id="7380957">(</span><span class="ident" id="7380958">line</span><span class="op" id="7380962">,</span>&nbsp;<span class="string" id="7380964">&#34;,&#34;</span><span class="op" id="7380967">,</span>&nbsp;<span class="num" id="7380969">2</span><span class="op" id="7380970">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380976">switch</span>&nbsp;<span class="ident" id="7380983">parts</span><span class="op" id="7380988">[</span><span class="num" id="7380989">0</span><span class="op" id="7380990">]</span>&nbsp;<span class="op" id="7380992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380997">case</span>&nbsp;<span class="string" id="7381002">&#34;P-224&#34;</span><span class="op" id="7381009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381015">pub</span><span class="op" id="7381018">.</span><span class="ident" id="7381019">Curve</span>&nbsp;<span class="op" id="7381025">=</span>&nbsp;<span class="ident" id="7381027">elliptic</span><span class="op" id="7381035">.</span><span class="ident" id="7381036">P224</span><span class="op" id="7381040">(</span><span class="op" id="7381041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381046">case</span>&nbsp;<span class="string" id="7381051">&#34;P-256&#34;</span><span class="op" id="7381058">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381064">pub</span><span class="op" id="7381067">.</span><span class="ident" id="7381068">Curve</span>&nbsp;<span class="op" id="7381074">=</span>&nbsp;<span class="ident" id="7381076">elliptic</span><span class="op" id="7381084">.</span><span class="ident" id="7381085">P256</span><span class="op" id="7381089">(</span><span class="op" id="7381090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381095">case</span>&nbsp;<span class="string" id="7381100">&#34;P-384&#34;</span><span class="op" id="7381107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381113">pub</span><span class="op" id="7381116">.</span><span class="ident" id="7381117">Curve</span>&nbsp;<span class="op" id="7381123">=</span>&nbsp;<span class="ident" id="7381125">elliptic</span><span class="op" id="7381133">.</span><span class="ident" id="7381134">P384</span><span class="op" id="7381138">(</span><span class="op" id="7381139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381144">case</span>&nbsp;<span class="string" id="7381149">&#34;P-521&#34;</span><span class="op" id="7381156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381162">pub</span><span class="op" id="7381165">.</span><span class="ident" id="7381166">Curve</span>&nbsp;<span class="op" id="7381172">=</span>&nbsp;<span class="ident" id="7381174">elliptic</span><span class="op" id="7381182">.</span><span class="ident" id="7381183">P521</span><span class="op" id="7381187">(</span><span class="op" id="7381188">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381193">default</span><span class="op" id="7381200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381206">pub</span><span class="op" id="7381209">.</span><span class="ident" id="7381210">Curve</span>&nbsp;<span class="op" id="7381216">=</span>&nbsp;<span class="ident" id="7381218">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7381225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381231">switch</span>&nbsp;<span class="ident" id="7381238">parts</span><span class="op" id="7381243">[</span><span class="num" id="7381244">1</span><span class="op" id="7381245">]</span>&nbsp;<span class="op" id="7381247">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381252">case</span>&nbsp;<span class="string" id="7381257">&#34;SHA-1&#34;</span><span class="op" id="7381264">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381270">h</span>&nbsp;<span class="op" id="7381272">=</span>&nbsp;<span class="ident" id="7381274">sha1</span><span class="op" id="7381278">.</span><span class="ident" id="7381279">New</span><span class="op" id="7381282">(</span><span class="op" id="7381283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381288">case</span>&nbsp;<span class="string" id="7381293">&#34;SHA-224&#34;</span><span class="op" id="7381302">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381308">h</span>&nbsp;<span class="op" id="7381310">=</span>&nbsp;<span class="ident" id="7381312">sha256</span><span class="op" id="7381318">.</span><span class="ident" id="7381319">New224</span><span class="op" id="7381325">(</span><span class="op" id="7381326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381331">case</span>&nbsp;<span class="string" id="7381336">&#34;SHA-256&#34;</span><span class="op" id="7381345">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381351">h</span>&nbsp;<span class="op" id="7381353">=</span>&nbsp;<span class="ident" id="7381355">sha256</span><span class="op" id="7381361">.</span><span class="ident" id="7381362">New</span><span class="op" id="7381365">(</span><span class="op" id="7381366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381371">case</span>&nbsp;<span class="string" id="7381376">&#34;SHA-384&#34;</span><span class="op" id="7381385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381391">h</span>&nbsp;<span class="op" id="7381393">=</span>&nbsp;<span class="ident" id="7381395">sha512</span><span class="op" id="7381401">.</span><span class="ident" id="7381402">New384</span><span class="op" id="7381408">(</span><span class="op" id="7381409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381414">case</span>&nbsp;<span class="string" id="7381419">&#34;SHA-512&#34;</span><span class="op" id="7381428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381434">h</span>&nbsp;<span class="op" id="7381436">=</span>&nbsp;<span class="ident" id="7381438">sha512</span><span class="op" id="7381444">.</span><span class="ident" id="7381445">New</span><span class="op" id="7381448">(</span><span class="op" id="7381449">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381454">default</span><span class="op" id="7381461">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381467">h</span>&nbsp;<span class="op" id="7381469">=</span>&nbsp;<span class="ident" id="7381471">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7381478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381484">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7381495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381500">if</span>&nbsp;<span class="ident" id="7381503">h</span>&nbsp;<span class="op" id="7381505">==</span>&nbsp;<span class="ident" id="7381508">nil</span>&nbsp;<span class="op" id="7381512">||</span>&nbsp;<span class="ident" id="7381515">pub</span><span class="op" id="7381518">.</span><span class="ident" id="7381519">Curve</span>&nbsp;<span class="op" id="7381525">==</span>&nbsp;<span class="ident" id="7381528">nil</span>&nbsp;<span class="op" id="7381532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381537">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7381548">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381553">switch</span>&nbsp;<span class="op" id="7381560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381564">case</span>&nbsp;<span class="ident" id="7381569">strings</span><span class="op" id="7381576">.</span><span class="ident" id="7381577">HasPrefix</span><span class="op" id="7381586">(</span><span class="ident" id="7381587">line</span><span class="op" id="7381591">,</span>&nbsp;<span class="string" id="7381593">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="7381601">)</span><span class="op" id="7381602">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381607">if</span>&nbsp;<span class="ident" id="7381610">msg</span><span class="op" id="7381613">,</span>&nbsp;<span class="ident" id="7381615">err</span>&nbsp;<span class="op" id="7381619">=</span>&nbsp;<span class="ident" id="7381621">hex</span><span class="op" id="7381624">.</span><span class="ident" id="7381625">DecodeString</span><span class="op" id="7381637">(</span><span class="ident" id="7381638">line</span><span class="op" id="7381642">[</span><span class="num" id="7381643">6</span><span class="op" id="7381644">:</span><span class="op" id="7381645">]</span><span class="op" id="7381646">)</span><span class="op" id="7381647">;</span>&nbsp;<span class="ident" id="7381649">err</span>&nbsp;<span class="op" id="7381653">!=</span>&nbsp;<span class="ident" id="7381656">nil</span>&nbsp;<span class="op" id="7381660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381666">t</span><span class="op" id="7381667">.</span><span class="ident" id="7381668">Fatalf</span><span class="op" id="7381674">(</span><span class="string" id="7381675">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7381716">,</span>&nbsp;<span class="ident" id="7381718">lineNo</span><span class="op" id="7381724">,</span>&nbsp;<span class="ident" id="7381726">err</span><span class="op" id="7381729">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7381734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381738">case</span>&nbsp;<span class="ident" id="7381743">strings</span><span class="op" id="7381750">.</span><span class="ident" id="7381751">HasPrefix</span><span class="op" id="7381760">(</span><span class="ident" id="7381761">line</span><span class="op" id="7381765">,</span>&nbsp;<span class="string" id="7381767">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="7381774">)</span><span class="op" id="7381775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381780">pub</span><span class="op" id="7381783">.</span><span class="ident" id="7381784">X</span>&nbsp;<span class="op" id="7381786">=</span>&nbsp;<span class="ident" id="7381788">fromHex</span><span class="op" id="7381795">(</span><span class="ident" id="7381796">line</span><span class="op" id="7381800">[</span><span class="num" id="7381801">5</span><span class="op" id="7381802">:</span><span class="op" id="7381803">]</span><span class="op" id="7381804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381808">case</span>&nbsp;<span class="ident" id="7381813">strings</span><span class="op" id="7381820">.</span><span class="ident" id="7381821">HasPrefix</span><span class="op" id="7381830">(</span><span class="ident" id="7381831">line</span><span class="op" id="7381835">,</span>&nbsp;<span class="string" id="7381837">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="7381844">)</span><span class="op" id="7381845">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381850">pub</span><span class="op" id="7381853">.</span><span class="ident" id="7381854">Y</span>&nbsp;<span class="op" id="7381856">=</span>&nbsp;<span class="ident" id="7381858">fromHex</span><span class="op" id="7381865">(</span><span class="ident" id="7381866">line</span><span class="op" id="7381870">[</span><span class="num" id="7381871">5</span><span class="op" id="7381872">:</span><span class="op" id="7381873">]</span><span class="op" id="7381874">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381878">case</span>&nbsp;<span class="ident" id="7381883">strings</span><span class="op" id="7381890">.</span><span class="ident" id="7381891">HasPrefix</span><span class="op" id="7381900">(</span><span class="ident" id="7381901">line</span><span class="op" id="7381905">,</span>&nbsp;<span class="string" id="7381907">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="7381913">)</span><span class="op" id="7381914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381919">r</span>&nbsp;<span class="op" id="7381921">=</span>&nbsp;<span class="ident" id="7381923">fromHex</span><span class="op" id="7381930">(</span><span class="ident" id="7381931">line</span><span class="op" id="7381935">[</span><span class="num" id="7381936">4</span><span class="op" id="7381937">:</span><span class="op" id="7381938">]</span><span class="op" id="7381939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381943">case</span>&nbsp;<span class="ident" id="7381948">strings</span><span class="op" id="7381955">.</span><span class="ident" id="7381956">HasPrefix</span><span class="op" id="7381965">(</span><span class="ident" id="7381966">line</span><span class="op" id="7381970">,</span>&nbsp;<span class="string" id="7381972">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="7381978">)</span><span class="op" id="7381979">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381984">s</span>&nbsp;<span class="op" id="7381986">=</span>&nbsp;<span class="ident" id="7381988">fromHex</span><span class="op" id="7381995">(</span><span class="ident" id="7381996">line</span><span class="op" id="7382000">[</span><span class="num" id="7382001">4</span><span class="op" id="7382002">:</span><span class="op" id="7382003">]</span><span class="op" id="7382004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7382008">case</span>&nbsp;<span class="ident" id="7382013">strings</span><span class="op" id="7382020">.</span><span class="ident" id="7382021">HasPrefix</span><span class="op" id="7382030">(</span><span class="ident" id="7382031">line</span><span class="op" id="7382035">,</span>&nbsp;<span class="string" id="7382037">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="7382048">)</span><span class="op" id="7382049">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7382054">expected</span>&nbsp;<span class="op" id="7382063">:=</span>&nbsp;<span class="ident" id="7382066">line</span><span class="op" id="7382070">[</span><span class="num" id="7382071">9</span><span class="op" id="7382072">]</span>&nbsp;<span class="op" id="7382074">==</span>&nbsp;<span class="string" id="7382077">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7382084">h</span><span class="op" id="7382085">.</span><span class="ident" id="7382086">Reset</span><span class="op" id="7382091">(</span><span class="op" id="7382092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7382097">h</span><span class="op" id="7382098">.</span><span class="ident" id="7382099">Write</span><span class="op" id="7382104">(</span><span class="ident" id="7382105">msg</span><span class="op" id="7382108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7382113">hashed</span>&nbsp;<span class="op" id="7382120">:=</span>&nbsp;<span class="ident" id="7382123">h</span><span class="op" id="7382124">.</span><span class="ident" id="7382125">Sum</span><span class="op" id="7382128">(</span><span class="ident" id="7382129">hashed</span><span class="op" id="7382135">[</span><span class="op" id="7382136">:</span><span class="num" id="7382137">0</span><span class="op" id="7382138">]</span><span class="op" id="7382139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7382144">if</span>&nbsp;<span class="ident" id="7382147">Verify</span><span class="op" id="7382153">(</span><span class="ident" id="7382154">pub</span><span class="op" id="7382157">,</span>&nbsp;<span class="ident" id="7382159">hashed</span><span class="op" id="7382165">,</span>&nbsp;<span class="ident" id="7382167">r</span><span class="op" id="7382168">,</span>&nbsp;<span class="ident" id="7382170">s</span><span class="op" id="7382171">)</span>&nbsp;<span class="op" id="7382173">!=</span>&nbsp;<span class="ident" id="7382176">expected</span>&nbsp;<span class="op" id="7382185">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7382191">t</span><span class="op" id="7382192">.</span><span class="ident" id="7382193">Fatalf</span><span class="op" id="7382199">(</span><span class="string" id="7382200">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7382229">,</span>&nbsp;<span class="ident" id="7382231">lineNo</span><span class="op" id="7382237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7382242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7382246">default</span><span class="op" id="7382253">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7382258">t</span><span class="op" id="7382259">.</span><span class="ident" id="7382260">Fatalf</span><span class="op" id="7382266">(</span><span class="string" id="7382267">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7382300">,</span>&nbsp;<span class="ident" id="7382302">lineNo</span><span class="op" id="7382308">,</span>&nbsp;<span class="ident" id="7382310">line</span><span class="op" id="7382314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7382318">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7382321">}</span><br>
<span class="lineno"></span><span class="op" id="7382323">}</span>
</div>
</body>
</html>
