<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/color</h2>
<ul>
<li><a href="/gostd/image/color/color.go.html">color.go</a></li>
<li><a href="/gostd/image/color/ycbcr.go.html" class="current">ycbcr.go</a></li>
<li><a href="/gostd/image/color/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5376972">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5377027">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5377081">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5377132">package</span>&nbsp;<span class="ident" id="5377140">color</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5377147">//&nbsp;RGBToYCbCr&nbsp;converts&nbsp;an&nbsp;RGB&nbsp;triple&nbsp;to&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="5377204">func</span>&nbsp;<span class="ident" id="5377209">RGBToYCbCr</span><span class="op" id="5377219">(</span><span class="ident" id="5377220">r</span><span class="op" id="5377221">,</span>&nbsp;<span class="ident" id="5377223">g</span><span class="op" id="5377224">,</span>&nbsp;<span class="ident" id="5377226">b</span>&nbsp;<span class="builtintype" id="5377228">uint8</span><span class="op" id="5377233">)</span>&nbsp;<span class="op" id="5377235">(</span><span class="builtintype" id="5377236">uint8</span><span class="op" id="5377241">,</span>&nbsp;<span class="builtintype" id="5377243">uint8</span><span class="op" id="5377248">,</span>&nbsp;<span class="builtintype" id="5377250">uint8</span><span class="op" id="5377255">)</span>&nbsp;<span class="op" id="5377257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5377260">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5377293">//&nbsp;&nbsp;&nbsp;&nbsp;Y&#39;&nbsp;=&nbsp;&nbsp;0.2990*R&nbsp;+&nbsp;0.5870*G&nbsp;+&nbsp;0.1140*B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5377334">//&nbsp;&nbsp;&nbsp;&nbsp;Cb&nbsp;=&nbsp;-0.1687*R&nbsp;-&nbsp;0.3313*G&nbsp;+&nbsp;0.5000*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5377381">//&nbsp;&nbsp;&nbsp;&nbsp;Cr&nbsp;=&nbsp;&nbsp;0.5000*R&nbsp;-&nbsp;0.4187*G&nbsp;-&nbsp;0.0813*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5377428">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5377495">r1</span>&nbsp;<span class="op" id="5377498">:=</span>&nbsp;<span class="builtintype" id="5377501">int</span><span class="op" id="5377504">(</span><span class="ident" id="5377505">r</span><span class="op" id="5377506">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5377509">g1</span>&nbsp;<span class="op" id="5377512">:=</span>&nbsp;<span class="builtintype" id="5377515">int</span><span class="op" id="5377518">(</span><span class="ident" id="5377519">g</span><span class="op" id="5377520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5377523">b1</span>&nbsp;<span class="op" id="5377526">:=</span>&nbsp;<span class="builtintype" id="5377529">int</span><span class="op" id="5377532">(</span><span class="ident" id="5377533">b</span><span class="op" id="5377534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5377537">yy</span>&nbsp;<span class="op" id="5377540">:=</span>&nbsp;<span class="op" id="5377543">(</span><span class="num" id="5377544">19595</span><span class="op" id="5377549">*</span><span class="ident" id="5377550">r1</span>&nbsp;<span class="op" id="5377553">+</span>&nbsp;<span class="num" id="5377555">38470</span><span class="op" id="5377560">*</span><span class="ident" id="5377561">g1</span>&nbsp;<span class="op" id="5377564">+</span>&nbsp;<span class="num" id="5377566">7471</span><span class="op" id="5377570">*</span><span class="ident" id="5377571">b1</span>&nbsp;<span class="op" id="5377574">+</span>&nbsp;<span class="num" id="5377576">1</span><span class="op" id="5377577">&lt;&lt;</span><span class="num" id="5377579">15</span><span class="op" id="5377581">)</span>&nbsp;<span class="op" id="5377583">&gt;&gt;</span>&nbsp;<span class="num" id="5377586">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5377590">cb</span>&nbsp;<span class="op" id="5377593">:=</span>&nbsp;<span class="op" id="5377596">(</span><span class="op" id="5377597">-</span><span class="num" id="5377598">11056</span><span class="op" id="5377603">*</span><span class="ident" id="5377604">r1</span>&nbsp;<span class="op" id="5377607">-</span>&nbsp;<span class="num" id="5377609">21712</span><span class="op" id="5377614">*</span><span class="ident" id="5377615">g1</span>&nbsp;<span class="op" id="5377618">+</span>&nbsp;<span class="num" id="5377620">32768</span><span class="op" id="5377625">*</span><span class="ident" id="5377626">b1</span>&nbsp;<span class="op" id="5377629">+</span>&nbsp;<span class="num" id="5377631">257</span><span class="op" id="5377634">&lt;&lt;</span><span class="num" id="5377636">15</span><span class="op" id="5377638">)</span>&nbsp;<span class="op" id="5377640">&gt;&gt;</span>&nbsp;<span class="num" id="5377643">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5377647">cr</span>&nbsp;<span class="op" id="5377650">:=</span>&nbsp;<span class="op" id="5377653">(</span><span class="num" id="5377654">32768</span><span class="op" id="5377659">*</span><span class="ident" id="5377660">r1</span>&nbsp;<span class="op" id="5377663">-</span>&nbsp;<span class="num" id="5377665">27440</span><span class="op" id="5377670">*</span><span class="ident" id="5377671">g1</span>&nbsp;<span class="op" id="5377674">-</span>&nbsp;<span class="num" id="5377676">5328</span><span class="op" id="5377680">*</span><span class="ident" id="5377681">b1</span>&nbsp;<span class="op" id="5377684">+</span>&nbsp;<span class="num" id="5377686">257</span><span class="op" id="5377689">&lt;&lt;</span><span class="num" id="5377691">15</span><span class="op" id="5377693">)</span>&nbsp;<span class="op" id="5377695">&gt;&gt;</span>&nbsp;<span class="num" id="5377698">16</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5377702">if</span>&nbsp;<span class="ident" id="5377705">yy</span>&nbsp;<span class="op" id="5377708">&lt;</span>&nbsp;<span class="num" id="5377710">0</span>&nbsp;<span class="op" id="5377712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5377716">yy</span>&nbsp;<span class="op" id="5377719">=</span>&nbsp;<span class="num" id="5377721">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5377724">}</span>&nbsp;<span class="keyword" id="5377726">else</span>&nbsp;<span class="keyword" id="5377731">if</span>&nbsp;<span class="ident" id="5377734">yy</span>&nbsp;<span class="op" id="5377737">&gt;</span>&nbsp;<span class="num" id="5377739">255</span>&nbsp;<span class="op" id="5377743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5377747">yy</span>&nbsp;<span class="op" id="5377750">=</span>&nbsp;<span class="num" id="5377752">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5377757">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5377760">if</span>&nbsp;<span class="ident" id="5377763">cb</span>&nbsp;<span class="op" id="5377766">&lt;</span>&nbsp;<span class="num" id="5377768">0</span>&nbsp;<span class="op" id="5377770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5377774">cb</span>&nbsp;<span class="op" id="5377777">=</span>&nbsp;<span class="num" id="5377779">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5377782">}</span>&nbsp;<span class="keyword" id="5377784">else</span>&nbsp;<span class="keyword" id="5377789">if</span>&nbsp;<span class="ident" id="5377792">cb</span>&nbsp;<span class="op" id="5377795">&gt;</span>&nbsp;<span class="num" id="5377797">255</span>&nbsp;<span class="op" id="5377801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5377805">cb</span>&nbsp;<span class="op" id="5377808">=</span>&nbsp;<span class="num" id="5377810">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5377815">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5377818">if</span>&nbsp;<span class="ident" id="5377821">cr</span>&nbsp;<span class="op" id="5377824">&lt;</span>&nbsp;<span class="num" id="5377826">0</span>&nbsp;<span class="op" id="5377828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5377832">cr</span>&nbsp;<span class="op" id="5377835">=</span>&nbsp;<span class="num" id="5377837">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5377840">}</span>&nbsp;<span class="keyword" id="5377842">else</span>&nbsp;<span class="keyword" id="5377847">if</span>&nbsp;<span class="ident" id="5377850">cr</span>&nbsp;<span class="op" id="5377853">&gt;</span>&nbsp;<span class="num" id="5377855">255</span>&nbsp;<span class="op" id="5377859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5377863">cr</span>&nbsp;<span class="op" id="5377866">=</span>&nbsp;<span class="num" id="5377868">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5377873">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5377876">return</span>&nbsp;<span class="builtintype" id="5377883">uint8</span><span class="op" id="5377888">(</span><span class="ident" id="5377889">yy</span><span class="op" id="5377891">)</span><span class="op" id="5377892">,</span>&nbsp;<span class="builtintype" id="5377894">uint8</span><span class="op" id="5377899">(</span><span class="ident" id="5377900">cb</span><span class="op" id="5377902">)</span><span class="op" id="5377903">,</span>&nbsp;<span class="builtintype" id="5377905">uint8</span><span class="op" id="5377910">(</span><span class="ident" id="5377911">cr</span><span class="op" id="5377913">)</span><br>
<span class="lineno"></span><span class="op" id="5377915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5377918">//&nbsp;YCbCrToRGB&nbsp;converts&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple&nbsp;to&nbsp;an&nbsp;RGB&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="5377975">func</span>&nbsp;<span class="ident" id="5377980">YCbCrToRGB</span><span class="op" id="5377990">(</span><span class="ident" id="5377991">y</span><span class="op" id="5377992">,</span>&nbsp;<span class="ident" id="5377994">cb</span><span class="op" id="5377996">,</span>&nbsp;<span class="ident" id="5377998">cr</span>&nbsp;<span class="builtintype" id="5378001">uint8</span><span class="op" id="5378006">)</span>&nbsp;<span class="op" id="5378008">(</span><span class="builtintype" id="5378009">uint8</span><span class="op" id="5378014">,</span>&nbsp;<span class="builtintype" id="5378016">uint8</span><span class="op" id="5378021">,</span>&nbsp;<span class="builtintype" id="5378023">uint8</span><span class="op" id="5378028">)</span>&nbsp;<span class="op" id="5378030">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5378033">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5378066">//&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.40200*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5378096">//&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;Y&#39;&nbsp;-&nbsp;0.34414*(Cb-128)&nbsp;-&nbsp;0.71414*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5378145">//&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.77200*(Cb-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5378175">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5378242">yy1</span>&nbsp;<span class="op" id="5378246">:=</span>&nbsp;<span class="builtintype" id="5378249">int</span><span class="op" id="5378252">(</span><span class="ident" id="5378253">y</span><span class="op" id="5378254">)</span><span class="op" id="5378255">&lt;&lt;</span><span class="num" id="5378257">16</span>&nbsp;<span class="op" id="5378260">+</span>&nbsp;<span class="num" id="5378262">1</span><span class="op" id="5378263">&lt;&lt;</span><span class="num" id="5378265">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5378269">cb1</span>&nbsp;<span class="op" id="5378273">:=</span>&nbsp;<span class="builtintype" id="5378276">int</span><span class="op" id="5378279">(</span><span class="ident" id="5378280">cb</span><span class="op" id="5378282">)</span>&nbsp;<span class="op" id="5378284">-</span>&nbsp;<span class="num" id="5378286">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5378291">cr1</span>&nbsp;<span class="op" id="5378295">:=</span>&nbsp;<span class="builtintype" id="5378298">int</span><span class="op" id="5378301">(</span><span class="ident" id="5378302">cr</span><span class="op" id="5378304">)</span>&nbsp;<span class="op" id="5378306">-</span>&nbsp;<span class="num" id="5378308">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5378313">r</span>&nbsp;<span class="op" id="5378315">:=</span>&nbsp;<span class="op" id="5378318">(</span><span class="ident" id="5378319">yy1</span>&nbsp;<span class="op" id="5378323">+</span>&nbsp;<span class="num" id="5378325">91881</span><span class="op" id="5378330">*</span><span class="ident" id="5378331">cr1</span><span class="op" id="5378334">)</span>&nbsp;<span class="op" id="5378336">&gt;&gt;</span>&nbsp;<span class="num" id="5378339">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5378343">g</span>&nbsp;<span class="op" id="5378345">:=</span>&nbsp;<span class="op" id="5378348">(</span><span class="ident" id="5378349">yy1</span>&nbsp;<span class="op" id="5378353">-</span>&nbsp;<span class="num" id="5378355">22554</span><span class="op" id="5378360">*</span><span class="ident" id="5378361">cb1</span>&nbsp;<span class="op" id="5378365">-</span>&nbsp;<span class="num" id="5378367">46802</span><span class="op" id="5378372">*</span><span class="ident" id="5378373">cr1</span><span class="op" id="5378376">)</span>&nbsp;<span class="op" id="5378378">&gt;&gt;</span>&nbsp;<span class="num" id="5378381">16</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5378385">b</span>&nbsp;<span class="op" id="5378387">:=</span>&nbsp;<span class="op" id="5378390">(</span><span class="ident" id="5378391">yy1</span>&nbsp;<span class="op" id="5378395">+</span>&nbsp;<span class="num" id="5378397">116130</span><span class="op" id="5378403">*</span><span class="ident" id="5378404">cb1</span><span class="op" id="5378407">)</span>&nbsp;<span class="op" id="5378409">&gt;&gt;</span>&nbsp;<span class="num" id="5378412">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5378416">if</span>&nbsp;<span class="ident" id="5378419">r</span>&nbsp;<span class="op" id="5378421">&lt;</span>&nbsp;<span class="num" id="5378423">0</span>&nbsp;<span class="op" id="5378425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5378429">r</span>&nbsp;<span class="op" id="5378431">=</span>&nbsp;<span class="num" id="5378433">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5378436">}</span>&nbsp;<span class="keyword" id="5378438">else</span>&nbsp;<span class="keyword" id="5378443">if</span>&nbsp;<span class="ident" id="5378446">r</span>&nbsp;<span class="op" id="5378448">&gt;</span>&nbsp;<span class="num" id="5378450">255</span>&nbsp;<span class="op" id="5378454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5378458">r</span>&nbsp;<span class="op" id="5378460">=</span>&nbsp;<span class="num" id="5378462">255</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5378467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5378470">if</span>&nbsp;<span class="ident" id="5378473">g</span>&nbsp;<span class="op" id="5378475">&lt;</span>&nbsp;<span class="num" id="5378477">0</span>&nbsp;<span class="op" id="5378479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5378483">g</span>&nbsp;<span class="op" id="5378485">=</span>&nbsp;<span class="num" id="5378487">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5378490">}</span>&nbsp;<span class="keyword" id="5378492">else</span>&nbsp;<span class="keyword" id="5378497">if</span>&nbsp;<span class="ident" id="5378500">g</span>&nbsp;<span class="op" id="5378502">&gt;</span>&nbsp;<span class="num" id="5378504">255</span>&nbsp;<span class="op" id="5378508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5378512">g</span>&nbsp;<span class="op" id="5378514">=</span>&nbsp;<span class="num" id="5378516">255</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5378521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5378524">if</span>&nbsp;<span class="ident" id="5378527">b</span>&nbsp;<span class="op" id="5378529">&lt;</span>&nbsp;<span class="num" id="5378531">0</span>&nbsp;<span class="op" id="5378533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5378537">b</span>&nbsp;<span class="op" id="5378539">=</span>&nbsp;<span class="num" id="5378541">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5378544">}</span>&nbsp;<span class="keyword" id="5378546">else</span>&nbsp;<span class="keyword" id="5378551">if</span>&nbsp;<span class="ident" id="5378554">b</span>&nbsp;<span class="op" id="5378556">&gt;</span>&nbsp;<span class="num" id="5378558">255</span>&nbsp;<span class="op" id="5378562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5378566">b</span>&nbsp;<span class="op" id="5378568">=</span>&nbsp;<span class="num" id="5378570">255</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5378575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5378578">return</span>&nbsp;<span class="builtintype" id="5378585">uint8</span><span class="op" id="5378590">(</span><span class="ident" id="5378591">r</span><span class="op" id="5378592">)</span><span class="op" id="5378593">,</span>&nbsp;<span class="builtintype" id="5378595">uint8</span><span class="op" id="5378600">(</span><span class="ident" id="5378601">g</span><span class="op" id="5378602">)</span><span class="op" id="5378603">,</span>&nbsp;<span class="builtintype" id="5378605">uint8</span><span class="op" id="5378610">(</span><span class="ident" id="5378611">b</span><span class="op" id="5378612">)</span><br>
<span class="lineno"></span><span class="op" id="5378614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5378617">//&nbsp;YCbCr&nbsp;represents&nbsp;a&nbsp;fully&nbsp;opaque&nbsp;24-bit&nbsp;Y&#39;CbCr&nbsp;color,&nbsp;having&nbsp;8&nbsp;bits&nbsp;each&nbsp;for</span><br>
<span class="lineno">70</span><span class="comment" id="5378696">//&nbsp;one&nbsp;luma&nbsp;and&nbsp;two&nbsp;chroma&nbsp;components.</span><br>
<span class="lineno"></span><span class="comment" id="5378735">//</span><br>
<span class="lineno"></span><span class="comment" id="5378738">//&nbsp;JPEG,&nbsp;VP8,&nbsp;the&nbsp;MPEG&nbsp;family&nbsp;and&nbsp;other&nbsp;codecs&nbsp;use&nbsp;this&nbsp;color&nbsp;model.&nbsp;Such</span><br>
<span class="lineno"></span><span class="comment" id="5378812">//&nbsp;codecs&nbsp;often&nbsp;use&nbsp;the&nbsp;terms&nbsp;YUV&nbsp;and&nbsp;Y&#39;CbCr&nbsp;interchangeably,&nbsp;but&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="5378887">//&nbsp;speaking,&nbsp;the&nbsp;term&nbsp;YUV&nbsp;applies&nbsp;only&nbsp;to&nbsp;analog&nbsp;video&nbsp;signals,&nbsp;and&nbsp;Y&#39;&nbsp;(luma)</span><br>
<span class="lineno">75</span><span class="comment" id="5378965">//&nbsp;is&nbsp;Y&nbsp;(luminance)&nbsp;after&nbsp;applying&nbsp;gamma&nbsp;correction.</span><br>
<span class="lineno"></span><span class="comment" id="5379018">//</span><br>
<span class="lineno"></span><span class="comment" id="5379021">//&nbsp;Conversion&nbsp;between&nbsp;RGB&nbsp;and&nbsp;Y&#39;CbCr&nbsp;is&nbsp;lossy&nbsp;and&nbsp;there&nbsp;are&nbsp;multiple,&nbsp;slightly</span><br>
<span class="lineno"></span><span class="comment" id="5379100">//&nbsp;different&nbsp;formulae&nbsp;for&nbsp;converting&nbsp;between&nbsp;the&nbsp;two.&nbsp;This&nbsp;package&nbsp;follows</span><br>
<span class="lineno"></span><span class="comment" id="5379175">//&nbsp;the&nbsp;JFIF&nbsp;specification&nbsp;at&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf.</span><br>
<span class="lineno">80</span><span class="keyword" id="5379247">type</span>&nbsp;<span class="ident" id="5379252">YCbCr</span>&nbsp;<span class="keyword" id="5379258">struct</span>&nbsp;<span class="op" id="5379265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5379268">Y</span><span class="op" id="5379269">,</span>&nbsp;<span class="ident" id="5379271">Cb</span><span class="op" id="5379273">,</span>&nbsp;<span class="ident" id="5379275">Cr</span>&nbsp;<span class="builtintype" id="5379278">uint8</span><br>
<span class="lineno"></span><span class="op" id="5379284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5379287">func</span>&nbsp;<span class="op" id="5379292">(</span><span class="ident" id="5379293">c</span>&nbsp;<span class="ident" id="5379295">YCbCr</span><span class="op" id="5379300">)</span>&nbsp;<span class="ident" id="5379302">RGBA</span><span class="op" id="5379306">(</span><span class="op" id="5379307">)</span>&nbsp;<span class="op" id="5379309">(</span><span class="builtintype" id="5379310">uint32</span><span class="op" id="5379316">,</span>&nbsp;<span class="builtintype" id="5379318">uint32</span><span class="op" id="5379324">,</span>&nbsp;<span class="builtintype" id="5379326">uint32</span><span class="op" id="5379332">,</span>&nbsp;<span class="builtintype" id="5379334">uint32</span><span class="op" id="5379340">)</span>&nbsp;<span class="op" id="5379342">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5379345">r</span><span class="op" id="5379346">,</span>&nbsp;<span class="ident" id="5379348">g</span><span class="op" id="5379349">,</span>&nbsp;<span class="ident" id="5379351">b</span>&nbsp;<span class="op" id="5379353">:=</span>&nbsp;<span class="ident" id="5379356">YCbCrToRGB</span><span class="op" id="5379366">(</span><span class="ident" id="5379367">c</span><span class="op" id="5379368">.</span><span class="ident" id="5379369">Y</span><span class="op" id="5379370">,</span>&nbsp;<span class="ident" id="5379372">c</span><span class="op" id="5379373">.</span><span class="ident" id="5379374">Cb</span><span class="op" id="5379376">,</span>&nbsp;<span class="ident" id="5379378">c</span><span class="op" id="5379379">.</span><span class="ident" id="5379380">Cr</span><span class="op" id="5379382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5379385">return</span>&nbsp;<span class="builtintype" id="5379392">uint32</span><span class="op" id="5379398">(</span><span class="ident" id="5379399">r</span><span class="op" id="5379400">)</span>&nbsp;<span class="op" id="5379402">*</span>&nbsp;<span class="num" id="5379404">0x101</span><span class="op" id="5379409">,</span>&nbsp;<span class="builtintype" id="5379411">uint32</span><span class="op" id="5379417">(</span><span class="ident" id="5379418">g</span><span class="op" id="5379419">)</span>&nbsp;<span class="op" id="5379421">*</span>&nbsp;<span class="num" id="5379423">0x101</span><span class="op" id="5379428">,</span>&nbsp;<span class="builtintype" id="5379430">uint32</span><span class="op" id="5379436">(</span><span class="ident" id="5379437">b</span><span class="op" id="5379438">)</span>&nbsp;<span class="op" id="5379440">*</span>&nbsp;<span class="num" id="5379442">0x101</span><span class="op" id="5379447">,</span>&nbsp;<span class="num" id="5379449">0xffff</span><br>
<span class="lineno"></span><span class="op" id="5379456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5379459">//&nbsp;YCbCrModel&nbsp;is&nbsp;the&nbsp;Model&nbsp;for&nbsp;Y&#39;CbCr&nbsp;colors.</span><br>
<span class="lineno">90</span><span class="keyword" id="5379505">var</span>&nbsp;<span class="ident" id="5379509">YCbCrModel</span>&nbsp;<span class="ident" id="5379520">Model</span>&nbsp;<span class="op" id="5379526">=</span>&nbsp;<span class="ident" id="5379528">ModelFunc</span><span class="op" id="5379537">(</span><span class="ident" id="5379538">yCbCrModel</span><span class="op" id="5379548">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5379551">func</span>&nbsp;<span class="ident" id="5379556">yCbCrModel</span><span class="op" id="5379566">(</span><span class="ident" id="5379567">c</span>&nbsp;<span class="ident" id="5379569">Color</span><span class="op" id="5379574">)</span>&nbsp;<span class="ident" id="5379576">Color</span>&nbsp;<span class="op" id="5379582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5379585">if</span>&nbsp;<span class="ident" id="5379588">_</span><span class="op" id="5379589">,</span>&nbsp;<span class="ident" id="5379591">ok</span>&nbsp;<span class="op" id="5379594">:=</span>&nbsp;<span class="ident" id="5379597">c</span><span class="op" id="5379598">.</span><span class="op" id="5379599">(</span><span class="ident" id="5379600">YCbCr</span><span class="op" id="5379605">)</span><span class="op" id="5379606">;</span>&nbsp;<span class="ident" id="5379608">ok</span>&nbsp;<span class="op" id="5379611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5379615">return</span>&nbsp;<span class="ident" id="5379622">c</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5379625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5379628">r</span><span class="op" id="5379629">,</span>&nbsp;<span class="ident" id="5379631">g</span><span class="op" id="5379632">,</span>&nbsp;<span class="ident" id="5379634">b</span><span class="op" id="5379635">,</span>&nbsp;<span class="ident" id="5379637">_</span>&nbsp;<span class="op" id="5379639">:=</span>&nbsp;<span class="ident" id="5379642">c</span><span class="op" id="5379643">.</span><span class="ident" id="5379644">RGBA</span><span class="op" id="5379648">(</span><span class="op" id="5379649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5379652">y</span><span class="op" id="5379653">,</span>&nbsp;<span class="ident" id="5379655">u</span><span class="op" id="5379656">,</span>&nbsp;<span class="ident" id="5379658">v</span>&nbsp;<span class="op" id="5379660">:=</span>&nbsp;<span class="ident" id="5379663">RGBToYCbCr</span><span class="op" id="5379673">(</span><span class="builtintype" id="5379674">uint8</span><span class="op" id="5379679">(</span><span class="ident" id="5379680">r</span><span class="op" id="5379681">&gt;&gt;</span><span class="num" id="5379683">8</span><span class="op" id="5379684">)</span><span class="op" id="5379685">,</span>&nbsp;<span class="builtintype" id="5379687">uint8</span><span class="op" id="5379692">(</span><span class="ident" id="5379693">g</span><span class="op" id="5379694">&gt;&gt;</span><span class="num" id="5379696">8</span><span class="op" id="5379697">)</span><span class="op" id="5379698">,</span>&nbsp;<span class="builtintype" id="5379700">uint8</span><span class="op" id="5379705">(</span><span class="ident" id="5379706">b</span><span class="op" id="5379707">&gt;&gt;</span><span class="num" id="5379709">8</span><span class="op" id="5379710">)</span><span class="op" id="5379711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5379714">return</span>&nbsp;<span class="ident" id="5379721">YCbCr</span><span class="op" id="5379726">{</span><span class="ident" id="5379727">y</span><span class="op" id="5379728">,</span>&nbsp;<span class="ident" id="5379730">u</span><span class="op" id="5379731">,</span>&nbsp;<span class="ident" id="5379733">v</span><span class="op" id="5379734">}</span><br>
<span class="lineno"></span><span class="op" id="5379736">}</span>
</div>
</body>
</html>
