<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html" class="current">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6667685">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6667740">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6667794">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6667845">package</span>&nbsp;<span class="ident" id="6667853">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6667858">import</span>&nbsp;<span class="op" id="6667865">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6667868">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6667875">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6667881">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6667892">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6667902">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6667905">var</span>&nbsp;<span class="ident" id="6667909">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="6667936">=</span>&nbsp;<span class="op" id="6667938">[</span><span class="op" id="6667939">]</span><span class="keyword" id="6667940">struct</span>&nbsp;<span class="op" id="6667947">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667950">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6667956">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667964">gaddr</span>&nbsp;<span class="op" id="6667970">*</span><span class="ident" id="6667971">UDPAddr</span>&nbsp;<span class="comment" id="6667979">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="6667995">}</span><span class="op" id="6667996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667999">{</span><span class="string" id="6668000">&#34;udp&#34;</span><span class="op" id="6668005">,</span>&nbsp;<span class="op" id="6668007">&amp;</span><span class="ident" id="6668008">UDPAddr</span><span class="op" id="6668015">{</span><span class="ident" id="6668016">IP</span><span class="op" id="6668018">:</span>&nbsp;<span class="ident" id="6668020">IPv4</span><span class="op" id="6668024">(</span><span class="num" id="6668025">224</span><span class="op" id="6668028">,</span>&nbsp;<span class="num" id="6668030">0</span><span class="op" id="6668031">,</span>&nbsp;<span class="num" id="6668033">0</span><span class="op" id="6668034">,</span>&nbsp;<span class="num" id="6668036">254</span><span class="op" id="6668039">)</span><span class="op" id="6668040">,</span>&nbsp;<span class="ident" id="6668042">Port</span><span class="op" id="6668046">:</span>&nbsp;<span class="num" id="6668048">12345</span><span class="op" id="6668053">}</span><span class="op" id="6668054">}</span><span class="op" id="6668055">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668059">{</span><span class="string" id="6668060">&#34;udp4&#34;</span><span class="op" id="6668066">,</span>&nbsp;<span class="op" id="6668068">&amp;</span><span class="ident" id="6668069">UDPAddr</span><span class="op" id="6668076">{</span><span class="ident" id="6668077">IP</span><span class="op" id="6668079">:</span>&nbsp;<span class="ident" id="6668081">IPv4</span><span class="op" id="6668085">(</span><span class="num" id="6668086">224</span><span class="op" id="6668089">,</span>&nbsp;<span class="num" id="6668091">0</span><span class="op" id="6668092">,</span>&nbsp;<span class="num" id="6668094">0</span><span class="op" id="6668095">,</span>&nbsp;<span class="num" id="6668097">254</span><span class="op" id="6668100">)</span><span class="op" id="6668101">,</span>&nbsp;<span class="ident" id="6668103">Port</span><span class="op" id="6668107">:</span>&nbsp;<span class="num" id="6668109">12345</span><span class="op" id="6668114">}</span><span class="op" id="6668115">}</span><span class="op" id="6668116">,</span><br>
<span class="lineno"></span><span class="op" id="6668118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6668121">//&nbsp;TestIPv4MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6668191">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">25</span><span class="comment" id="6668262">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="6668271">func</span>&nbsp;<span class="ident" id="6668276">TestIPv4MulticastListener</span><span class="op" id="6668301">(</span><span class="ident" id="6668302">t</span>&nbsp;<span class="op" id="6668304">*</span><span class="ident" id="6668305">testing</span><span class="op" id="6668312">.</span><span class="ident" id="6668313">T</span><span class="op" id="6668314">)</span>&nbsp;<span class="op" id="6668316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668319">switch</span>&nbsp;<span class="ident" id="6668326">runtime</span><span class="op" id="6668333">.</span><span class="ident" id="6668334">GOOS</span>&nbsp;<span class="op" id="6668339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668342">case</span>&nbsp;<span class="string" id="6668347">&#34;android&#34;</span><span class="op" id="6668356">,</span>&nbsp;<span class="string" id="6668358">&#34;nacl&#34;</span><span class="op" id="6668364">,</span>&nbsp;<span class="string" id="6668366">&#34;plan9&#34;</span><span class="op" id="6668373">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668377">t</span><span class="op" id="6668378">.</span><span class="ident" id="6668379">Skipf</span><span class="op" id="6668384">(</span><span class="string" id="6668385">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6668406">,</span>&nbsp;<span class="ident" id="6668408">runtime</span><span class="op" id="6668415">.</span><span class="ident" id="6668416">GOOS</span><span class="op" id="6668420">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668423">case</span>&nbsp;<span class="string" id="6668428">&#34;solaris&#34;</span><span class="op" id="6668437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668441">t</span><span class="op" id="6668442">.</span><span class="ident" id="6668443">Skipf</span><span class="op" id="6668448">(</span><span class="string" id="6668449">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="6668491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668498">closer</span>&nbsp;<span class="op" id="6668505">:=</span>&nbsp;<span class="keyword" id="6668508">func</span><span class="op" id="6668512">(</span><span class="ident" id="6668513">cs</span>&nbsp;<span class="op" id="6668516">[</span><span class="op" id="6668517">]</span><span class="op" id="6668518">*</span><span class="ident" id="6668519">UDPConn</span><span class="op" id="6668526">)</span>&nbsp;<span class="op" id="6668528">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668532">for</span>&nbsp;<span class="ident" id="6668536">_</span><span class="op" id="6668537">,</span>&nbsp;<span class="ident" id="6668539">c</span>&nbsp;<span class="op" id="6668541">:=</span>&nbsp;<span class="keyword" id="6668544">range</span>&nbsp;<span class="ident" id="6668550">cs</span>&nbsp;<span class="op" id="6668553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668558">if</span>&nbsp;<span class="ident" id="6668561">c</span>&nbsp;<span class="op" id="6668563">!=</span>&nbsp;<span class="ident" id="6668566">nil</span>&nbsp;<span class="op" id="6668570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668576">c</span><span class="op" id="6668577">.</span><span class="ident" id="6668578">Close</span><span class="op" id="6668583">(</span><span class="op" id="6668584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668593">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668600">for</span>&nbsp;<span class="ident" id="6668604">_</span><span class="op" id="6668605">,</span>&nbsp;<span class="ident" id="6668607">ifi</span>&nbsp;<span class="op" id="6668611">:=</span>&nbsp;<span class="keyword" id="6668614">range</span>&nbsp;<span class="op" id="6668620">[</span><span class="op" id="6668621">]</span><span class="op" id="6668622">*</span><span class="ident" id="6668623">Interface</span><span class="op" id="6668632">{</span><span class="ident" id="6668633">loopbackInterface</span><span class="op" id="6668650">(</span><span class="op" id="6668651">)</span><span class="op" id="6668652">,</span>&nbsp;<span class="ident" id="6668654">nil</span><span class="op" id="6668657">}</span>&nbsp;<span class="op" id="6668659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6668663">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6668719">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6668772">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6668822">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6668874">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668892">if</span>&nbsp;<span class="ident" id="6668895">ifi</span>&nbsp;<span class="op" id="6668899">==</span>&nbsp;<span class="ident" id="6668902">nil</span>&nbsp;<span class="op" id="6668906">&amp;&amp;</span>&nbsp;<span class="op" id="6668909">!</span><span class="op" id="6668910">*</span><span class="ident" id="6668911">testExternal</span>&nbsp;<span class="op" id="6668924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668929">continue</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668944">for</span>&nbsp;<span class="ident" id="6668948">_</span><span class="op" id="6668949">,</span>&nbsp;<span class="ident" id="6668951">tt</span>&nbsp;<span class="op" id="6668954">:=</span>&nbsp;<span class="keyword" id="6668957">range</span>&nbsp;<span class="ident" id="6668963">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="6668990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668995">var</span>&nbsp;<span class="ident" id="6668999">err</span>&nbsp;<span class="builtintype" id="6669003">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669012">cs</span>&nbsp;<span class="op" id="6669015">:=</span>&nbsp;<span class="builtinfunc" id="6669018">make</span><span class="op" id="6669022">(</span><span class="op" id="6669023">[</span><span class="op" id="6669024">]</span><span class="op" id="6669025">*</span><span class="ident" id="6669026">UDPConn</span><span class="op" id="6669033">,</span>&nbsp;<span class="num" id="6669035">2</span><span class="op" id="6669036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669041">if</span>&nbsp;<span class="ident" id="6669044">cs</span><span class="op" id="6669046">[</span><span class="num" id="6669047">0</span><span class="op" id="6669048">]</span><span class="op" id="6669049">,</span>&nbsp;<span class="ident" id="6669051">err</span>&nbsp;<span class="op" id="6669055">=</span>&nbsp;<span class="ident" id="6669057">ListenMulticastUDP</span><span class="op" id="6669075">(</span><span class="ident" id="6669076">tt</span><span class="op" id="6669078">.</span><span class="ident" id="6669079">net</span><span class="op" id="6669082">,</span>&nbsp;<span class="ident" id="6669084">ifi</span><span class="op" id="6669087">,</span>&nbsp;<span class="ident" id="6669089">tt</span><span class="op" id="6669091">.</span><span class="ident" id="6669092">gaddr</span><span class="op" id="6669097">)</span><span class="op" id="6669098">;</span>&nbsp;<span class="ident" id="6669100">err</span>&nbsp;<span class="op" id="6669104">!=</span>&nbsp;<span class="ident" id="6669107">nil</span>&nbsp;<span class="op" id="6669111">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669117">t</span><span class="op" id="6669118">.</span><span class="ident" id="6669119">Fatalf</span><span class="op" id="6669125">(</span><span class="string" id="6669126">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6669169">,</span>&nbsp;<span class="ident" id="6669171">ifi</span><span class="op" id="6669174">,</span>&nbsp;<span class="ident" id="6669176">err</span><span class="op" id="6669179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669189">if</span>&nbsp;<span class="ident" id="6669192">err</span>&nbsp;<span class="op" id="6669196">:=</span>&nbsp;<span class="ident" id="6669199">checkMulticastListener</span><span class="op" id="6669221">(</span><span class="ident" id="6669222">cs</span><span class="op" id="6669224">[</span><span class="num" id="6669225">0</span><span class="op" id="6669226">]</span><span class="op" id="6669227">,</span>&nbsp;<span class="ident" id="6669229">tt</span><span class="op" id="6669231">.</span><span class="ident" id="6669232">gaddr</span><span class="op" id="6669237">.</span><span class="ident" id="6669238">IP</span><span class="op" id="6669240">)</span><span class="op" id="6669241">;</span>&nbsp;<span class="ident" id="6669243">err</span>&nbsp;<span class="op" id="6669247">!=</span>&nbsp;<span class="ident" id="6669250">nil</span>&nbsp;<span class="op" id="6669254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669260">closer</span><span class="op" id="6669266">(</span><span class="ident" id="6669267">cs</span><span class="op" id="6669269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669275">t</span><span class="op" id="6669276">.</span><span class="ident" id="6669277">Fatal</span><span class="op" id="6669282">(</span><span class="ident" id="6669283">err</span><span class="op" id="6669286">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669296">if</span>&nbsp;<span class="ident" id="6669299">cs</span><span class="op" id="6669301">[</span><span class="num" id="6669302">1</span><span class="op" id="6669303">]</span><span class="op" id="6669304">,</span>&nbsp;<span class="ident" id="6669306">err</span>&nbsp;<span class="op" id="6669310">=</span>&nbsp;<span class="ident" id="6669312">ListenMulticastUDP</span><span class="op" id="6669330">(</span><span class="ident" id="6669331">tt</span><span class="op" id="6669333">.</span><span class="ident" id="6669334">net</span><span class="op" id="6669337">,</span>&nbsp;<span class="ident" id="6669339">ifi</span><span class="op" id="6669342">,</span>&nbsp;<span class="ident" id="6669344">tt</span><span class="op" id="6669346">.</span><span class="ident" id="6669347">gaddr</span><span class="op" id="6669352">)</span><span class="op" id="6669353">;</span>&nbsp;<span class="ident" id="6669355">err</span>&nbsp;<span class="op" id="6669359">!=</span>&nbsp;<span class="ident" id="6669362">nil</span>&nbsp;<span class="op" id="6669366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669372">closer</span><span class="op" id="6669378">(</span><span class="ident" id="6669379">cs</span><span class="op" id="6669381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669387">t</span><span class="op" id="6669388">.</span><span class="ident" id="6669389">Fatalf</span><span class="op" id="6669395">(</span><span class="string" id="6669396">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6669440">,</span>&nbsp;<span class="ident" id="6669442">ifi</span><span class="op" id="6669445">,</span>&nbsp;<span class="ident" id="6669447">err</span><span class="op" id="6669450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669455">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669460">if</span>&nbsp;<span class="ident" id="6669463">err</span>&nbsp;<span class="op" id="6669467">:=</span>&nbsp;<span class="ident" id="6669470">checkMulticastListener</span><span class="op" id="6669492">(</span><span class="ident" id="6669493">cs</span><span class="op" id="6669495">[</span><span class="num" id="6669496">1</span><span class="op" id="6669497">]</span><span class="op" id="6669498">,</span>&nbsp;<span class="ident" id="6669500">tt</span><span class="op" id="6669502">.</span><span class="ident" id="6669503">gaddr</span><span class="op" id="6669508">.</span><span class="ident" id="6669509">IP</span><span class="op" id="6669511">)</span><span class="op" id="6669512">;</span>&nbsp;<span class="ident" id="6669514">err</span>&nbsp;<span class="op" id="6669518">!=</span>&nbsp;<span class="ident" id="6669521">nil</span>&nbsp;<span class="op" id="6669525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669531">closer</span><span class="op" id="6669537">(</span><span class="ident" id="6669538">cs</span><span class="op" id="6669540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669546">t</span><span class="op" id="6669547">.</span><span class="ident" id="6669548">Fatal</span><span class="op" id="6669553">(</span><span class="ident" id="6669554">err</span><span class="op" id="6669557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669567">closer</span><span class="op" id="6669573">(</span><span class="ident" id="6669574">cs</span><span class="op" id="6669576">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669583">}</span><br>
<span class="lineno"></span><span class="op" id="6669585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6669588">var</span>&nbsp;<span class="ident" id="6669592">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="6669619">=</span>&nbsp;<span class="op" id="6669621">[</span><span class="op" id="6669622">]</span><span class="keyword" id="6669623">struct</span>&nbsp;<span class="op" id="6669630">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669633">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6669639">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669647">gaddr</span>&nbsp;<span class="op" id="6669653">*</span><span class="ident" id="6669654">UDPAddr</span>&nbsp;<span class="comment" id="6669662">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="6669678">}</span><span class="op" id="6669679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669682">{</span><span class="string" id="6669683">&#34;udp&#34;</span><span class="op" id="6669688">,</span>&nbsp;<span class="op" id="6669690">&amp;</span><span class="ident" id="6669691">UDPAddr</span><span class="op" id="6669698">{</span><span class="ident" id="6669699">IP</span><span class="op" id="6669701">:</span>&nbsp;<span class="ident" id="6669703">ParseIP</span><span class="op" id="6669710">(</span><span class="string" id="6669711">&#34;ff01::114&#34;</span><span class="op" id="6669722">)</span><span class="op" id="6669723">,</span>&nbsp;<span class="ident" id="6669725">Port</span><span class="op" id="6669729">:</span>&nbsp;<span class="num" id="6669731">12345</span><span class="op" id="6669736">}</span><span class="op" id="6669737">}</span><span class="op" id="6669738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669741">{</span><span class="string" id="6669742">&#34;udp&#34;</span><span class="op" id="6669747">,</span>&nbsp;<span class="op" id="6669749">&amp;</span><span class="ident" id="6669750">UDPAddr</span><span class="op" id="6669757">{</span><span class="ident" id="6669758">IP</span><span class="op" id="6669760">:</span>&nbsp;<span class="ident" id="6669762">ParseIP</span><span class="op" id="6669769">(</span><span class="string" id="6669770">&#34;ff02::114&#34;</span><span class="op" id="6669781">)</span><span class="op" id="6669782">,</span>&nbsp;<span class="ident" id="6669784">Port</span><span class="op" id="6669788">:</span>&nbsp;<span class="num" id="6669790">12345</span><span class="op" id="6669795">}</span><span class="op" id="6669796">}</span><span class="op" id="6669797">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669800">{</span><span class="string" id="6669801">&#34;udp&#34;</span><span class="op" id="6669806">,</span>&nbsp;<span class="op" id="6669808">&amp;</span><span class="ident" id="6669809">UDPAddr</span><span class="op" id="6669816">{</span><span class="ident" id="6669817">IP</span><span class="op" id="6669819">:</span>&nbsp;<span class="ident" id="6669821">ParseIP</span><span class="op" id="6669828">(</span><span class="string" id="6669829">&#34;ff04::114&#34;</span><span class="op" id="6669840">)</span><span class="op" id="6669841">,</span>&nbsp;<span class="ident" id="6669843">Port</span><span class="op" id="6669847">:</span>&nbsp;<span class="num" id="6669849">12345</span><span class="op" id="6669854">}</span><span class="op" id="6669855">}</span><span class="op" id="6669856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669859">{</span><span class="string" id="6669860">&#34;udp&#34;</span><span class="op" id="6669865">,</span>&nbsp;<span class="op" id="6669867">&amp;</span><span class="ident" id="6669868">UDPAddr</span><span class="op" id="6669875">{</span><span class="ident" id="6669876">IP</span><span class="op" id="6669878">:</span>&nbsp;<span class="ident" id="6669880">ParseIP</span><span class="op" id="6669887">(</span><span class="string" id="6669888">&#34;ff05::114&#34;</span><span class="op" id="6669899">)</span><span class="op" id="6669900">,</span>&nbsp;<span class="ident" id="6669902">Port</span><span class="op" id="6669906">:</span>&nbsp;<span class="num" id="6669908">12345</span><span class="op" id="6669913">}</span><span class="op" id="6669914">}</span><span class="op" id="6669915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669918">{</span><span class="string" id="6669919">&#34;udp&#34;</span><span class="op" id="6669924">,</span>&nbsp;<span class="op" id="6669926">&amp;</span><span class="ident" id="6669927">UDPAddr</span><span class="op" id="6669934">{</span><span class="ident" id="6669935">IP</span><span class="op" id="6669937">:</span>&nbsp;<span class="ident" id="6669939">ParseIP</span><span class="op" id="6669946">(</span><span class="string" id="6669947">&#34;ff08::114&#34;</span><span class="op" id="6669958">)</span><span class="op" id="6669959">,</span>&nbsp;<span class="ident" id="6669961">Port</span><span class="op" id="6669965">:</span>&nbsp;<span class="num" id="6669967">12345</span><span class="op" id="6669972">}</span><span class="op" id="6669973">}</span><span class="op" id="6669974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669977">{</span><span class="string" id="6669978">&#34;udp&#34;</span><span class="op" id="6669983">,</span>&nbsp;<span class="op" id="6669985">&amp;</span><span class="ident" id="6669986">UDPAddr</span><span class="op" id="6669993">{</span><span class="ident" id="6669994">IP</span><span class="op" id="6669996">:</span>&nbsp;<span class="ident" id="6669998">ParseIP</span><span class="op" id="6670005">(</span><span class="string" id="6670006">&#34;ff0e::114&#34;</span><span class="op" id="6670017">)</span><span class="op" id="6670018">,</span>&nbsp;<span class="ident" id="6670020">Port</span><span class="op" id="6670024">:</span>&nbsp;<span class="num" id="6670026">12345</span><span class="op" id="6670031">}</span><span class="op" id="6670032">}</span><span class="op" id="6670033">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6670037">{</span><span class="string" id="6670038">&#34;udp6&#34;</span><span class="op" id="6670044">,</span>&nbsp;<span class="op" id="6670046">&amp;</span><span class="ident" id="6670047">UDPAddr</span><span class="op" id="6670054">{</span><span class="ident" id="6670055">IP</span><span class="op" id="6670057">:</span>&nbsp;<span class="ident" id="6670059">ParseIP</span><span class="op" id="6670066">(</span><span class="string" id="6670067">&#34;ff01::114&#34;</span><span class="op" id="6670078">)</span><span class="op" id="6670079">,</span>&nbsp;<span class="ident" id="6670081">Port</span><span class="op" id="6670085">:</span>&nbsp;<span class="num" id="6670087">12345</span><span class="op" id="6670092">}</span><span class="op" id="6670093">}</span><span class="op" id="6670094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6670097">{</span><span class="string" id="6670098">&#34;udp6&#34;</span><span class="op" id="6670104">,</span>&nbsp;<span class="op" id="6670106">&amp;</span><span class="ident" id="6670107">UDPAddr</span><span class="op" id="6670114">{</span><span class="ident" id="6670115">IP</span><span class="op" id="6670117">:</span>&nbsp;<span class="ident" id="6670119">ParseIP</span><span class="op" id="6670126">(</span><span class="string" id="6670127">&#34;ff02::114&#34;</span><span class="op" id="6670138">)</span><span class="op" id="6670139">,</span>&nbsp;<span class="ident" id="6670141">Port</span><span class="op" id="6670145">:</span>&nbsp;<span class="num" id="6670147">12345</span><span class="op" id="6670152">}</span><span class="op" id="6670153">}</span><span class="op" id="6670154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6670157">{</span><span class="string" id="6670158">&#34;udp6&#34;</span><span class="op" id="6670164">,</span>&nbsp;<span class="op" id="6670166">&amp;</span><span class="ident" id="6670167">UDPAddr</span><span class="op" id="6670174">{</span><span class="ident" id="6670175">IP</span><span class="op" id="6670177">:</span>&nbsp;<span class="ident" id="6670179">ParseIP</span><span class="op" id="6670186">(</span><span class="string" id="6670187">&#34;ff04::114&#34;</span><span class="op" id="6670198">)</span><span class="op" id="6670199">,</span>&nbsp;<span class="ident" id="6670201">Port</span><span class="op" id="6670205">:</span>&nbsp;<span class="num" id="6670207">12345</span><span class="op" id="6670212">}</span><span class="op" id="6670213">}</span><span class="op" id="6670214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6670217">{</span><span class="string" id="6670218">&#34;udp6&#34;</span><span class="op" id="6670224">,</span>&nbsp;<span class="op" id="6670226">&amp;</span><span class="ident" id="6670227">UDPAddr</span><span class="op" id="6670234">{</span><span class="ident" id="6670235">IP</span><span class="op" id="6670237">:</span>&nbsp;<span class="ident" id="6670239">ParseIP</span><span class="op" id="6670246">(</span><span class="string" id="6670247">&#34;ff05::114&#34;</span><span class="op" id="6670258">)</span><span class="op" id="6670259">,</span>&nbsp;<span class="ident" id="6670261">Port</span><span class="op" id="6670265">:</span>&nbsp;<span class="num" id="6670267">12345</span><span class="op" id="6670272">}</span><span class="op" id="6670273">}</span><span class="op" id="6670274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6670277">{</span><span class="string" id="6670278">&#34;udp6&#34;</span><span class="op" id="6670284">,</span>&nbsp;<span class="op" id="6670286">&amp;</span><span class="ident" id="6670287">UDPAddr</span><span class="op" id="6670294">{</span><span class="ident" id="6670295">IP</span><span class="op" id="6670297">:</span>&nbsp;<span class="ident" id="6670299">ParseIP</span><span class="op" id="6670306">(</span><span class="string" id="6670307">&#34;ff08::114&#34;</span><span class="op" id="6670318">)</span><span class="op" id="6670319">,</span>&nbsp;<span class="ident" id="6670321">Port</span><span class="op" id="6670325">:</span>&nbsp;<span class="num" id="6670327">12345</span><span class="op" id="6670332">}</span><span class="op" id="6670333">}</span><span class="op" id="6670334">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6670337">{</span><span class="string" id="6670338">&#34;udp6&#34;</span><span class="op" id="6670344">,</span>&nbsp;<span class="op" id="6670346">&amp;</span><span class="ident" id="6670347">UDPAddr</span><span class="op" id="6670354">{</span><span class="ident" id="6670355">IP</span><span class="op" id="6670357">:</span>&nbsp;<span class="ident" id="6670359">ParseIP</span><span class="op" id="6670366">(</span><span class="string" id="6670367">&#34;ff0e::114&#34;</span><span class="op" id="6670378">)</span><span class="op" id="6670379">,</span>&nbsp;<span class="ident" id="6670381">Port</span><span class="op" id="6670385">:</span>&nbsp;<span class="num" id="6670387">12345</span><span class="op" id="6670392">}</span><span class="op" id="6670393">}</span><span class="op" id="6670394">,</span><br>
<span class="lineno"></span><span class="op" id="6670396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6670399">//&nbsp;TestIPv6MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6670469">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">95</span><span class="comment" id="6670540">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="6670549">func</span>&nbsp;<span class="ident" id="6670554">TestIPv6MulticastListener</span><span class="op" id="6670579">(</span><span class="ident" id="6670580">t</span>&nbsp;<span class="op" id="6670582">*</span><span class="ident" id="6670583">testing</span><span class="op" id="6670590">.</span><span class="ident" id="6670591">T</span><span class="op" id="6670592">)</span>&nbsp;<span class="op" id="6670594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6670597">switch</span>&nbsp;<span class="ident" id="6670604">runtime</span><span class="op" id="6670611">.</span><span class="ident" id="6670612">GOOS</span>&nbsp;<span class="op" id="6670617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6670620">case</span>&nbsp;<span class="string" id="6670625">&#34;plan9&#34;</span><span class="op" id="6670632">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6670636">t</span><span class="op" id="6670637">.</span><span class="ident" id="6670638">Skipf</span><span class="op" id="6670643">(</span><span class="string" id="6670644">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6670665">,</span>&nbsp;<span class="ident" id="6670667">runtime</span><span class="op" id="6670674">.</span><span class="ident" id="6670675">GOOS</span><span class="op" id="6670679">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6670682">case</span>&nbsp;<span class="string" id="6670687">&#34;solaris&#34;</span><span class="op" id="6670696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6670700">t</span><span class="op" id="6670701">.</span><span class="ident" id="6670702">Skipf</span><span class="op" id="6670707">(</span><span class="string" id="6670708">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="6670750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6670753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6670756">if</span>&nbsp;<span class="op" id="6670759">!</span><span class="ident" id="6670760">supportsIPv6</span>&nbsp;<span class="op" id="6670773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6670777">t</span><span class="op" id="6670778">.</span><span class="ident" id="6670779">Skip</span><span class="op" id="6670783">(</span><span class="string" id="6670784">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6670807">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6670810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6670813">if</span>&nbsp;<span class="ident" id="6670816">os</span><span class="op" id="6670818">.</span><span class="ident" id="6670819">Getuid</span><span class="op" id="6670825">(</span><span class="op" id="6670826">)</span>&nbsp;<span class="op" id="6670828">!=</span>&nbsp;<span class="num" id="6670831">0</span>&nbsp;<span class="op" id="6670833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6670837">t</span><span class="op" id="6670838">.</span><span class="ident" id="6670839">Skip</span><span class="op" id="6670843">(</span><span class="string" id="6670844">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="6670873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6670876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6670880">closer</span>&nbsp;<span class="op" id="6670887">:=</span>&nbsp;<span class="keyword" id="6670890">func</span><span class="op" id="6670894">(</span><span class="ident" id="6670895">cs</span>&nbsp;<span class="op" id="6670898">[</span><span class="op" id="6670899">]</span><span class="op" id="6670900">*</span><span class="ident" id="6670901">UDPConn</span><span class="op" id="6670908">)</span>&nbsp;<span class="op" id="6670910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6670914">for</span>&nbsp;<span class="ident" id="6670918">_</span><span class="op" id="6670919">,</span>&nbsp;<span class="ident" id="6670921">c</span>&nbsp;<span class="op" id="6670923">:=</span>&nbsp;<span class="keyword" id="6670926">range</span>&nbsp;<span class="ident" id="6670932">cs</span>&nbsp;<span class="op" id="6670935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6670940">if</span>&nbsp;<span class="ident" id="6670943">c</span>&nbsp;<span class="op" id="6670945">!=</span>&nbsp;<span class="ident" id="6670948">nil</span>&nbsp;<span class="op" id="6670952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6670958">c</span><span class="op" id="6670959">.</span><span class="ident" id="6670960">Close</span><span class="op" id="6670965">(</span><span class="op" id="6670966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6670971">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6670975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6670978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6670982">for</span>&nbsp;<span class="ident" id="6670986">_</span><span class="op" id="6670987">,</span>&nbsp;<span class="ident" id="6670989">ifi</span>&nbsp;<span class="op" id="6670993">:=</span>&nbsp;<span class="keyword" id="6670996">range</span>&nbsp;<span class="op" id="6671002">[</span><span class="op" id="6671003">]</span><span class="op" id="6671004">*</span><span class="ident" id="6671005">Interface</span><span class="op" id="6671014">{</span><span class="ident" id="6671015">loopbackInterface</span><span class="op" id="6671032">(</span><span class="op" id="6671033">)</span><span class="op" id="6671034">,</span>&nbsp;<span class="ident" id="6671036">nil</span><span class="op" id="6671039">}</span>&nbsp;<span class="op" id="6671041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6671045">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6671101">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6671154">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6671204">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6671256">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6671274">if</span>&nbsp;<span class="ident" id="6671277">ifi</span>&nbsp;<span class="op" id="6671281">==</span>&nbsp;<span class="ident" id="6671284">nil</span>&nbsp;<span class="op" id="6671288">&amp;&amp;</span>&nbsp;<span class="op" id="6671291">(</span><span class="op" id="6671292">!</span><span class="op" id="6671293">*</span><span class="ident" id="6671294">testExternal</span>&nbsp;<span class="op" id="6671307">||</span>&nbsp;<span class="op" id="6671310">!</span><span class="op" id="6671311">*</span><span class="ident" id="6671312">testIPv6</span><span class="op" id="6671320">)</span>&nbsp;<span class="op" id="6671322">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6671327">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6671338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6671342">for</span>&nbsp;<span class="ident" id="6671346">_</span><span class="op" id="6671347">,</span>&nbsp;<span class="ident" id="6671349">tt</span>&nbsp;<span class="op" id="6671352">:=</span>&nbsp;<span class="keyword" id="6671355">range</span>&nbsp;<span class="ident" id="6671361">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="6671388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6671393">var</span>&nbsp;<span class="ident" id="6671397">err</span>&nbsp;<span class="builtintype" id="6671401">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6671410">cs</span>&nbsp;<span class="op" id="6671413">:=</span>&nbsp;<span class="builtinfunc" id="6671416">make</span><span class="op" id="6671420">(</span><span class="op" id="6671421">[</span><span class="op" id="6671422">]</span><span class="op" id="6671423">*</span><span class="ident" id="6671424">UDPConn</span><span class="op" id="6671431">,</span>&nbsp;<span class="num" id="6671433">2</span><span class="op" id="6671434">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6671439">if</span>&nbsp;<span class="ident" id="6671442">cs</span><span class="op" id="6671444">[</span><span class="num" id="6671445">0</span><span class="op" id="6671446">]</span><span class="op" id="6671447">,</span>&nbsp;<span class="ident" id="6671449">err</span>&nbsp;<span class="op" id="6671453">=</span>&nbsp;<span class="ident" id="6671455">ListenMulticastUDP</span><span class="op" id="6671473">(</span><span class="ident" id="6671474">tt</span><span class="op" id="6671476">.</span><span class="ident" id="6671477">net</span><span class="op" id="6671480">,</span>&nbsp;<span class="ident" id="6671482">ifi</span><span class="op" id="6671485">,</span>&nbsp;<span class="ident" id="6671487">tt</span><span class="op" id="6671489">.</span><span class="ident" id="6671490">gaddr</span><span class="op" id="6671495">)</span><span class="op" id="6671496">;</span>&nbsp;<span class="ident" id="6671498">err</span>&nbsp;<span class="op" id="6671502">!=</span>&nbsp;<span class="ident" id="6671505">nil</span>&nbsp;<span class="op" id="6671509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6671515">t</span><span class="op" id="6671516">.</span><span class="ident" id="6671517">Fatalf</span><span class="op" id="6671523">(</span><span class="string" id="6671524">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6671567">,</span>&nbsp;<span class="ident" id="6671569">ifi</span><span class="op" id="6671572">,</span>&nbsp;<span class="ident" id="6671574">err</span><span class="op" id="6671577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6671582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6671587">if</span>&nbsp;<span class="ident" id="6671590">err</span>&nbsp;<span class="op" id="6671594">:=</span>&nbsp;<span class="ident" id="6671597">checkMulticastListener</span><span class="op" id="6671619">(</span><span class="ident" id="6671620">cs</span><span class="op" id="6671622">[</span><span class="num" id="6671623">0</span><span class="op" id="6671624">]</span><span class="op" id="6671625">,</span>&nbsp;<span class="ident" id="6671627">tt</span><span class="op" id="6671629">.</span><span class="ident" id="6671630">gaddr</span><span class="op" id="6671635">.</span><span class="ident" id="6671636">IP</span><span class="op" id="6671638">)</span><span class="op" id="6671639">;</span>&nbsp;<span class="ident" id="6671641">err</span>&nbsp;<span class="op" id="6671645">!=</span>&nbsp;<span class="ident" id="6671648">nil</span>&nbsp;<span class="op" id="6671652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6671658">closer</span><span class="op" id="6671664">(</span><span class="ident" id="6671665">cs</span><span class="op" id="6671667">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6671673">t</span><span class="op" id="6671674">.</span><span class="ident" id="6671675">Fatal</span><span class="op" id="6671680">(</span><span class="ident" id="6671681">err</span><span class="op" id="6671684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6671689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6671694">if</span>&nbsp;<span class="ident" id="6671697">cs</span><span class="op" id="6671699">[</span><span class="num" id="6671700">1</span><span class="op" id="6671701">]</span><span class="op" id="6671702">,</span>&nbsp;<span class="ident" id="6671704">err</span>&nbsp;<span class="op" id="6671708">=</span>&nbsp;<span class="ident" id="6671710">ListenMulticastUDP</span><span class="op" id="6671728">(</span><span class="ident" id="6671729">tt</span><span class="op" id="6671731">.</span><span class="ident" id="6671732">net</span><span class="op" id="6671735">,</span>&nbsp;<span class="ident" id="6671737">ifi</span><span class="op" id="6671740">,</span>&nbsp;<span class="ident" id="6671742">tt</span><span class="op" id="6671744">.</span><span class="ident" id="6671745">gaddr</span><span class="op" id="6671750">)</span><span class="op" id="6671751">;</span>&nbsp;<span class="ident" id="6671753">err</span>&nbsp;<span class="op" id="6671757">!=</span>&nbsp;<span class="ident" id="6671760">nil</span>&nbsp;<span class="op" id="6671764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6671770">closer</span><span class="op" id="6671776">(</span><span class="ident" id="6671777">cs</span><span class="op" id="6671779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6671785">t</span><span class="op" id="6671786">.</span><span class="ident" id="6671787">Fatalf</span><span class="op" id="6671793">(</span><span class="string" id="6671794">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6671838">,</span>&nbsp;<span class="ident" id="6671840">ifi</span><span class="op" id="6671843">,</span>&nbsp;<span class="ident" id="6671845">err</span><span class="op" id="6671848">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6671853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6671858">if</span>&nbsp;<span class="ident" id="6671861">err</span>&nbsp;<span class="op" id="6671865">:=</span>&nbsp;<span class="ident" id="6671868">checkMulticastListener</span><span class="op" id="6671890">(</span><span class="ident" id="6671891">cs</span><span class="op" id="6671893">[</span><span class="num" id="6671894">1</span><span class="op" id="6671895">]</span><span class="op" id="6671896">,</span>&nbsp;<span class="ident" id="6671898">tt</span><span class="op" id="6671900">.</span><span class="ident" id="6671901">gaddr</span><span class="op" id="6671906">.</span><span class="ident" id="6671907">IP</span><span class="op" id="6671909">)</span><span class="op" id="6671910">;</span>&nbsp;<span class="ident" id="6671912">err</span>&nbsp;<span class="op" id="6671916">!=</span>&nbsp;<span class="ident" id="6671919">nil</span>&nbsp;<span class="op" id="6671923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6671929">closer</span><span class="op" id="6671935">(</span><span class="ident" id="6671936">cs</span><span class="op" id="6671938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6671944">t</span><span class="op" id="6671945">.</span><span class="ident" id="6671946">Fatal</span><span class="op" id="6671951">(</span><span class="ident" id="6671952">err</span><span class="op" id="6671955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6671960">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6671965">closer</span><span class="op" id="6671971">(</span><span class="ident" id="6671972">cs</span><span class="op" id="6671974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6671978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6671981">}</span><br>
<span class="lineno"></span><span class="op" id="6671983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="6671986">func</span>&nbsp;<span class="ident" id="6671991">checkMulticastListener</span><span class="op" id="6672013">(</span><span class="ident" id="6672014">c</span>&nbsp;<span class="op" id="6672016">*</span><span class="ident" id="6672017">UDPConn</span><span class="op" id="6672024">,</span>&nbsp;<span class="ident" id="6672026">ip</span>&nbsp;<span class="ident" id="6672029">IP</span><span class="op" id="6672031">)</span>&nbsp;<span class="builtintype" id="6672033">error</span>&nbsp;<span class="op" id="6672039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672042">if</span>&nbsp;<span class="ident" id="6672045">ok</span><span class="op" id="6672047">,</span>&nbsp;<span class="ident" id="6672049">err</span>&nbsp;<span class="op" id="6672053">:=</span>&nbsp;<span class="ident" id="6672056">multicastRIBContains</span><span class="op" id="6672076">(</span><span class="ident" id="6672077">ip</span><span class="op" id="6672079">)</span><span class="op" id="6672080">;</span>&nbsp;<span class="ident" id="6672082">err</span>&nbsp;<span class="op" id="6672086">!=</span>&nbsp;<span class="ident" id="6672089">nil</span>&nbsp;<span class="op" id="6672093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672097">return</span>&nbsp;<span class="ident" id="6672104">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672109">}</span>&nbsp;<span class="keyword" id="6672111">else</span>&nbsp;<span class="keyword" id="6672116">if</span>&nbsp;<span class="op" id="6672119">!</span><span class="ident" id="6672120">ok</span>&nbsp;<span class="op" id="6672123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672127">return</span>&nbsp;<span class="ident" id="6672134">fmt</span><span class="op" id="6672137">.</span><span class="ident" id="6672138">Errorf</span><span class="op" id="6672144">(</span><span class="string" id="6672145">&#34;%q&nbsp;not&nbsp;found&nbsp;in&nbsp;multicast&nbsp;RIB&#34;</span><span class="op" id="6672176">,</span>&nbsp;<span class="ident" id="6672178">ip</span><span class="op" id="6672180">.</span><span class="ident" id="6672181">String</span><span class="op" id="6672187">(</span><span class="op" id="6672188">)</span><span class="op" id="6672189">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672195">la</span>&nbsp;<span class="op" id="6672198">:=</span>&nbsp;<span class="ident" id="6672201">c</span><span class="op" id="6672202">.</span><span class="ident" id="6672203">LocalAddr</span><span class="op" id="6672212">(</span><span class="op" id="6672213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672216">if</span>&nbsp;<span class="ident" id="6672219">la</span><span class="op" id="6672221">,</span>&nbsp;<span class="ident" id="6672223">ok</span>&nbsp;<span class="op" id="6672226">:=</span>&nbsp;<span class="ident" id="6672229">la</span><span class="op" id="6672231">.</span><span class="op" id="6672232">(</span><span class="op" id="6672233">*</span><span class="ident" id="6672234">UDPAddr</span><span class="op" id="6672241">)</span><span class="op" id="6672242">;</span>&nbsp;<span class="op" id="6672244">!</span><span class="ident" id="6672245">ok</span>&nbsp;<span class="op" id="6672248">||</span>&nbsp;<span class="ident" id="6672251">la</span><span class="op" id="6672253">.</span><span class="ident" id="6672254">Port</span>&nbsp;<span class="op" id="6672259">==</span>&nbsp;<span class="num" id="6672262">0</span>&nbsp;<span class="op" id="6672264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672268">return</span>&nbsp;<span class="ident" id="6672275">fmt</span><span class="op" id="6672278">.</span><span class="ident" id="6672279">Errorf</span><span class="op" id="6672285">(</span><span class="string" id="6672286">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6672347">,</span>&nbsp;<span class="ident" id="6672349">la</span><span class="op" id="6672351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672354">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672357">return</span>&nbsp;<span class="ident" id="6672364">nil</span><br>
<span class="lineno"></span><span class="op" id="6672368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6672371">func</span>&nbsp;<span class="ident" id="6672376">multicastRIBContains</span><span class="op" id="6672396">(</span><span class="ident" id="6672397">ip</span>&nbsp;<span class="ident" id="6672400">IP</span><span class="op" id="6672402">)</span>&nbsp;<span class="op" id="6672404">(</span><span class="builtintype" id="6672405">bool</span><span class="op" id="6672409">,</span>&nbsp;<span class="builtintype" id="6672411">error</span><span class="op" id="6672416">)</span>&nbsp;<span class="op" id="6672418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672421">switch</span>&nbsp;<span class="ident" id="6672428">runtime</span><span class="op" id="6672435">.</span><span class="ident" id="6672436">GOOS</span>&nbsp;<span class="op" id="6672441">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672444">case</span>&nbsp;<span class="string" id="6672449">&#34;dragonfly&#34;</span><span class="op" id="6672460">,</span>&nbsp;<span class="string" id="6672462">&#34;netbsd&#34;</span><span class="op" id="6672470">,</span>&nbsp;<span class="string" id="6672472">&#34;openbsd&#34;</span><span class="op" id="6672481">,</span>&nbsp;<span class="string" id="6672483">&#34;plan9&#34;</span><span class="op" id="6672490">,</span>&nbsp;<span class="string" id="6672492">&#34;solaris&#34;</span><span class="op" id="6672501">,</span>&nbsp;<span class="string" id="6672503">&#34;windows&#34;</span><span class="op" id="6672512">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672516">return</span>&nbsp;<span class="builtintype" id="6672523">true</span><span class="op" id="6672527">,</span>&nbsp;<span class="ident" id="6672529">nil</span>&nbsp;<span class="comment" id="6672533">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672557">case</span>&nbsp;<span class="string" id="6672562">&#34;linux&#34;</span><span class="op" id="6672569">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672573">if</span>&nbsp;<span class="ident" id="6672576">runtime</span><span class="op" id="6672583">.</span><span class="ident" id="6672584">GOARCH</span>&nbsp;<span class="op" id="6672591">==</span>&nbsp;<span class="string" id="6672594">&#34;arm&#34;</span>&nbsp;<span class="op" id="6672600">||</span>&nbsp;<span class="ident" id="6672603">runtime</span><span class="op" id="6672610">.</span><span class="ident" id="6672611">GOARCH</span>&nbsp;<span class="op" id="6672618">==</span>&nbsp;<span class="string" id="6672621">&#34;alpha&#34;</span>&nbsp;<span class="op" id="6672629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672634">return</span>&nbsp;<span class="builtintype" id="6672641">true</span><span class="op" id="6672645">,</span>&nbsp;<span class="ident" id="6672647">nil</span>&nbsp;<span class="comment" id="6672651">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672682">ift</span><span class="op" id="6672685">,</span>&nbsp;<span class="ident" id="6672687">err</span>&nbsp;<span class="op" id="6672691">:=</span>&nbsp;<span class="ident" id="6672694">Interfaces</span><span class="op" id="6672704">(</span><span class="op" id="6672705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672708">if</span>&nbsp;<span class="ident" id="6672711">err</span>&nbsp;<span class="op" id="6672715">!=</span>&nbsp;<span class="ident" id="6672718">nil</span>&nbsp;<span class="op" id="6672722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672726">return</span>&nbsp;<span class="builtintype" id="6672733">false</span><span class="op" id="6672738">,</span>&nbsp;<span class="ident" id="6672740">err</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672748">for</span>&nbsp;<span class="ident" id="6672752">_</span><span class="op" id="6672753">,</span>&nbsp;<span class="ident" id="6672755">ifi</span>&nbsp;<span class="op" id="6672759">:=</span>&nbsp;<span class="keyword" id="6672762">range</span>&nbsp;<span class="ident" id="6672768">ift</span>&nbsp;<span class="op" id="6672772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672776">ifmat</span><span class="op" id="6672781">,</span>&nbsp;<span class="ident" id="6672783">err</span>&nbsp;<span class="op" id="6672787">:=</span>&nbsp;<span class="ident" id="6672790">ifi</span><span class="op" id="6672793">.</span><span class="ident" id="6672794">MulticastAddrs</span><span class="op" id="6672808">(</span><span class="op" id="6672809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672813">if</span>&nbsp;<span class="ident" id="6672816">err</span>&nbsp;<span class="op" id="6672820">!=</span>&nbsp;<span class="ident" id="6672823">nil</span>&nbsp;<span class="op" id="6672827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672832">return</span>&nbsp;<span class="builtintype" id="6672839">false</span><span class="op" id="6672844">,</span>&nbsp;<span class="ident" id="6672846">err</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672856">for</span>&nbsp;<span class="ident" id="6672860">_</span><span class="op" id="6672861">,</span>&nbsp;<span class="ident" id="6672863">ifma</span>&nbsp;<span class="op" id="6672868">:=</span>&nbsp;<span class="keyword" id="6672871">range</span>&nbsp;<span class="ident" id="6672877">ifmat</span>&nbsp;<span class="op" id="6672883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672888">if</span>&nbsp;<span class="ident" id="6672891">ifma</span><span class="op" id="6672895">.</span><span class="op" id="6672896">(</span><span class="op" id="6672897">*</span><span class="ident" id="6672898">IPAddr</span><span class="op" id="6672904">)</span><span class="op" id="6672905">.</span><span class="ident" id="6672906">IP</span><span class="op" id="6672908">.</span><span class="ident" id="6672909">Equal</span><span class="op" id="6672914">(</span><span class="ident" id="6672915">ip</span><span class="op" id="6672917">)</span>&nbsp;<span class="op" id="6672919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672925">return</span>&nbsp;<span class="builtintype" id="6672932">true</span><span class="op" id="6672936">,</span>&nbsp;<span class="ident" id="6672938">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672945">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672955">return</span>&nbsp;<span class="builtintype" id="6672962">false</span><span class="op" id="6672967">,</span>&nbsp;<span class="ident" id="6672969">nil</span><br>
<span class="lineno"></span><span class="op" id="6672973">}</span>
</div>
</body>
</html>
