<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html" class="current">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5941970">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5942025">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5942079">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5942130">package</span>&nbsp;<span class="ident" id="5942138">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5942145">import</span>&nbsp;<span class="string" id="5942152">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5942160">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5942220">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5942290">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5942348">//</span><br>
<span class="lineno"></span><span class="comment" id="5942351">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5942399">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5942463">//</span><br>
<span class="lineno"></span><span class="comment" id="5942466">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5942527">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5942597">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5942672">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5942739">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5942812">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5942884">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5942898">//</span><br>
<span class="lineno"></span><span class="comment" id="5942901">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5942967">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5943033">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5943046">//</span><br>
<span class="lineno"></span><span class="comment" id="5943049">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5943073">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5943103">//&nbsp;Complex&nbsp;circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5943131">//</span><br>
<span class="lineno"></span><span class="comment" id="5943134">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5943150">//</span><br>
<span class="lineno">35</span><span class="comment" id="5943153">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5943159">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="5943178">//</span><br>
<span class="lineno"></span><span class="comment" id="5943181">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5943189">//</span><br>
<span class="lineno">40</span><span class="comment" id="5943192">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5943226">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno"></span><span class="comment" id="5943261">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;cosh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5943294">//</span><br>
<span class="lineno"></span><span class="comment" id="5943297">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis&nbsp;the&nbsp;denominator&nbsp;is&nbsp;zero&nbsp;at&nbsp;odd&nbsp;multiples</span><br>
<span class="lineno">45</span><span class="comment" id="5943358">//&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;The&nbsp;denominator&nbsp;is&nbsp;evaluated&nbsp;by&nbsp;its&nbsp;Taylor</span><br>
<span class="lineno"></span><span class="comment" id="5943414">//&nbsp;series&nbsp;near&nbsp;these&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="5943443">//</span><br>
<span class="lineno"></span><span class="comment" id="5943446">//&nbsp;ctan(z)&nbsp;=&nbsp;-i&nbsp;ctanh(iz).</span><br>
<span class="lineno"></span><span class="comment" id="5943473">//</span><br>
<span class="lineno">50</span><span class="comment" id="5943476">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5943489">//</span><br>
<span class="lineno"></span><span class="comment" id="5943492">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5943532">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5943590">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno">55</span><span class="comment" id="5943650">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="5943710">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;and&nbsp;catan(ctan(z))&nbsp;&nbsp;=&nbsp;&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5943771">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5943804">func</span>&nbsp;<span class="ident" id="5943809">Tan</span><span class="op" id="5943812">(</span><span class="ident" id="5943813">x</span>&nbsp;<span class="builtintype" id="5943815">complex128</span><span class="op" id="5943825">)</span>&nbsp;<span class="builtintype" id="5943827">complex128</span>&nbsp;<span class="op" id="5943838">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5943841">d</span>&nbsp;<span class="op" id="5943843">:=</span>&nbsp;<span class="ident" id="5943846">math</span><span class="op" id="5943850">.</span><span class="ident" id="5943851">Cos</span><span class="op" id="5943854">(</span><span class="num" id="5943855">2</span><span class="op" id="5943856">*</span><span class="builtinfunc" id="5943857">real</span><span class="op" id="5943861">(</span><span class="ident" id="5943862">x</span><span class="op" id="5943863">)</span><span class="op" id="5943864">)</span>&nbsp;<span class="op" id="5943866">+</span>&nbsp;<span class="ident" id="5943868">math</span><span class="op" id="5943872">.</span><span class="ident" id="5943873">Cosh</span><span class="op" id="5943877">(</span><span class="num" id="5943878">2</span><span class="op" id="5943879">*</span><span class="builtinfunc" id="5943880">imag</span><span class="op" id="5943884">(</span><span class="ident" id="5943885">x</span><span class="op" id="5943886">)</span><span class="op" id="5943887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5943890">if</span>&nbsp;<span class="ident" id="5943893">math</span><span class="op" id="5943897">.</span><span class="ident" id="5943898">Abs</span><span class="op" id="5943901">(</span><span class="ident" id="5943902">d</span><span class="op" id="5943903">)</span>&nbsp;<span class="op" id="5943905">&lt;</span>&nbsp;<span class="num" id="5943907">0.25</span>&nbsp;<span class="op" id="5943912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5943916">d</span>&nbsp;<span class="op" id="5943918">=</span>&nbsp;<span class="ident" id="5943920">tanSeries</span><span class="op" id="5943929">(</span><span class="ident" id="5943930">x</span><span class="op" id="5943931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5943934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5943937">if</span>&nbsp;<span class="ident" id="5943940">d</span>&nbsp;<span class="op" id="5943942">==</span>&nbsp;<span class="num" id="5943945">0</span>&nbsp;<span class="op" id="5943947">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5943951">return</span>&nbsp;<span class="ident" id="5943958">Inf</span><span class="op" id="5943961">(</span><span class="op" id="5943962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5943965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5943968">return</span>&nbsp;<span class="builtinfunc" id="5943975">complex</span><span class="op" id="5943982">(</span><span class="ident" id="5943983">math</span><span class="op" id="5943987">.</span><span class="ident" id="5943988">Sin</span><span class="op" id="5943991">(</span><span class="num" id="5943992">2</span><span class="op" id="5943993">*</span><span class="builtinfunc" id="5943994">real</span><span class="op" id="5943998">(</span><span class="ident" id="5943999">x</span><span class="op" id="5944000">)</span><span class="op" id="5944001">)</span><span class="op" id="5944002">/</span><span class="ident" id="5944003">d</span><span class="op" id="5944004">,</span>&nbsp;<span class="ident" id="5944006">math</span><span class="op" id="5944010">.</span><span class="ident" id="5944011">Sinh</span><span class="op" id="5944015">(</span><span class="num" id="5944016">2</span><span class="op" id="5944017">*</span><span class="builtinfunc" id="5944018">imag</span><span class="op" id="5944022">(</span><span class="ident" id="5944023">x</span><span class="op" id="5944024">)</span><span class="op" id="5944025">)</span><span class="op" id="5944026">/</span><span class="ident" id="5944027">d</span><span class="op" id="5944028">)</span><br>
<span class="lineno"></span><span class="op" id="5944030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="5944033">//&nbsp;Complex&nbsp;hyperbolic&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5944063">//</span><br>
<span class="lineno"></span><span class="comment" id="5944066">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5944082">//</span><br>
<span class="lineno"></span><span class="comment" id="5944085">//&nbsp;tanh&nbsp;z&nbsp;=&nbsp;(sinh&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sin&nbsp;2y)&nbsp;/&nbsp;(cosh&nbsp;2x&nbsp;+&nbsp;cos&nbsp;2y)&nbsp;.</span><br>
<span class="lineno">75</span><span class="comment" id="5944143">//</span><br>
<span class="lineno"></span><span class="comment" id="5944146">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5944159">//</span><br>
<span class="lineno"></span><span class="comment" id="5944162">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5944202">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">80</span><span class="comment" id="5944260">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.7e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4e-16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5944321">//&nbsp;Tanh&nbsp;returns&nbsp;the&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5944366">func</span>&nbsp;<span class="ident" id="5944371">Tanh</span><span class="op" id="5944375">(</span><span class="ident" id="5944376">x</span>&nbsp;<span class="builtintype" id="5944378">complex128</span><span class="op" id="5944388">)</span>&nbsp;<span class="builtintype" id="5944390">complex128</span>&nbsp;<span class="op" id="5944401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5944404">d</span>&nbsp;<span class="op" id="5944406">:=</span>&nbsp;<span class="ident" id="5944409">math</span><span class="op" id="5944413">.</span><span class="ident" id="5944414">Cosh</span><span class="op" id="5944418">(</span><span class="num" id="5944419">2</span><span class="op" id="5944420">*</span><span class="builtinfunc" id="5944421">real</span><span class="op" id="5944425">(</span><span class="ident" id="5944426">x</span><span class="op" id="5944427">)</span><span class="op" id="5944428">)</span>&nbsp;<span class="op" id="5944430">+</span>&nbsp;<span class="ident" id="5944432">math</span><span class="op" id="5944436">.</span><span class="ident" id="5944437">Cos</span><span class="op" id="5944440">(</span><span class="num" id="5944441">2</span><span class="op" id="5944442">*</span><span class="builtinfunc" id="5944443">imag</span><span class="op" id="5944447">(</span><span class="ident" id="5944448">x</span><span class="op" id="5944449">)</span><span class="op" id="5944450">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5944453">if</span>&nbsp;<span class="ident" id="5944456">d</span>&nbsp;<span class="op" id="5944458">==</span>&nbsp;<span class="num" id="5944461">0</span>&nbsp;<span class="op" id="5944463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5944467">return</span>&nbsp;<span class="ident" id="5944474">Inf</span><span class="op" id="5944477">(</span><span class="op" id="5944478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5944481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5944484">return</span>&nbsp;<span class="builtinfunc" id="5944491">complex</span><span class="op" id="5944498">(</span><span class="ident" id="5944499">math</span><span class="op" id="5944503">.</span><span class="ident" id="5944504">Sinh</span><span class="op" id="5944508">(</span><span class="num" id="5944509">2</span><span class="op" id="5944510">*</span><span class="builtinfunc" id="5944511">real</span><span class="op" id="5944515">(</span><span class="ident" id="5944516">x</span><span class="op" id="5944517">)</span><span class="op" id="5944518">)</span><span class="op" id="5944519">/</span><span class="ident" id="5944520">d</span><span class="op" id="5944521">,</span>&nbsp;<span class="ident" id="5944523">math</span><span class="op" id="5944527">.</span><span class="ident" id="5944528">Sin</span><span class="op" id="5944531">(</span><span class="num" id="5944532">2</span><span class="op" id="5944533">*</span><span class="builtinfunc" id="5944534">imag</span><span class="op" id="5944538">(</span><span class="ident" id="5944539">x</span><span class="op" id="5944540">)</span><span class="op" id="5944541">)</span><span class="op" id="5944542">/</span><span class="ident" id="5944543">d</span><span class="op" id="5944544">)</span><br>
<span class="lineno"></span><span class="op" id="5944546">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="5944549">//&nbsp;Program&nbsp;to&nbsp;subtract&nbsp;nearest&nbsp;integer&nbsp;multiple&nbsp;of&nbsp;PI</span><br>
<span class="lineno"></span><span class="keyword" id="5944603">func</span>&nbsp;<span class="ident" id="5944608">reducePi</span><span class="op" id="5944616">(</span><span class="ident" id="5944617">x</span>&nbsp;<span class="builtintype" id="5944619">float64</span><span class="op" id="5944626">)</span>&nbsp;<span class="builtintype" id="5944628">float64</span>&nbsp;<span class="op" id="5944636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5944639">const</span>&nbsp;<span class="op" id="5944645">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5944649">//&nbsp;extended&nbsp;precision&nbsp;value&nbsp;of&nbsp;PI:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5944686">DP1</span>&nbsp;<span class="op" id="5944690">=</span>&nbsp;<span class="num" id="5944692">3.14159265160560607910E0</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5944719">//&nbsp;??&nbsp;0x400921fb54000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5944746">DP2</span>&nbsp;<span class="op" id="5944750">=</span>&nbsp;<span class="num" id="5944752">1.98418714791870343106E-9</span>&nbsp;&nbsp;<span class="comment" id="5944779">//&nbsp;??&nbsp;0x3e210b4610000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5944806">DP3</span>&nbsp;<span class="op" id="5944810">=</span>&nbsp;<span class="num" id="5944812">1.14423774522196636802E-17</span>&nbsp;<span class="comment" id="5944839">//&nbsp;??&nbsp;0x3c6a62633145c06e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5944865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5944868">t</span>&nbsp;<span class="op" id="5944870">:=</span>&nbsp;<span class="ident" id="5944873">x</span>&nbsp;<span class="op" id="5944875">/</span>&nbsp;<span class="ident" id="5944877">math</span><span class="op" id="5944881">.</span><span class="ident" id="5944882">Pi</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5944886">if</span>&nbsp;<span class="ident" id="5944889">t</span>&nbsp;<span class="op" id="5944891">&gt;=</span>&nbsp;<span class="num" id="5944894">0</span>&nbsp;<span class="op" id="5944896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5944900">t</span>&nbsp;<span class="op" id="5944902">+=</span>&nbsp;<span class="num" id="5944905">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5944910">}</span>&nbsp;<span class="keyword" id="5944912">else</span>&nbsp;<span class="op" id="5944917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5944921">t</span>&nbsp;<span class="op" id="5944923">-=</span>&nbsp;<span class="num" id="5944926">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5944931">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5944934">t</span>&nbsp;<span class="op" id="5944936">=</span>&nbsp;<span class="builtintype" id="5944938">float64</span><span class="op" id="5944945">(</span><span class="builtintype" id="5944946">int64</span><span class="op" id="5944951">(</span><span class="ident" id="5944952">t</span><span class="op" id="5944953">)</span><span class="op" id="5944954">)</span>&nbsp;<span class="comment" id="5944956">//&nbsp;int64(t)&nbsp;=&nbsp;the&nbsp;multiple</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5944984">return</span>&nbsp;<span class="op" id="5944991">(</span><span class="op" id="5944992">(</span><span class="ident" id="5944993">x</span>&nbsp;<span class="op" id="5944995">-</span>&nbsp;<span class="ident" id="5944997">t</span><span class="op" id="5944998">*</span><span class="ident" id="5944999">DP1</span><span class="op" id="5945002">)</span>&nbsp;<span class="op" id="5945004">-</span>&nbsp;<span class="ident" id="5945006">t</span><span class="op" id="5945007">*</span><span class="ident" id="5945008">DP2</span><span class="op" id="5945011">)</span>&nbsp;<span class="op" id="5945013">-</span>&nbsp;<span class="ident" id="5945015">t</span><span class="op" id="5945016">*</span><span class="ident" id="5945017">DP3</span><br>
<span class="lineno"></span><span class="op" id="5945021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5945024">//&nbsp;Taylor&nbsp;series&nbsp;expansion&nbsp;for&nbsp;cosh(2y)&nbsp;-&nbsp;cos(2x)</span><br>
<span class="lineno">110</span><span class="keyword" id="5945074">func</span>&nbsp;<span class="ident" id="5945079">tanSeries</span><span class="op" id="5945088">(</span><span class="ident" id="5945089">z</span>&nbsp;<span class="builtintype" id="5945091">complex128</span><span class="op" id="5945101">)</span>&nbsp;<span class="builtintype" id="5945103">float64</span>&nbsp;<span class="op" id="5945111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5945114">const</span>&nbsp;<span class="ident" id="5945120">MACHEP</span>&nbsp;<span class="op" id="5945127">=</span>&nbsp;<span class="num" id="5945129">1.0</span>&nbsp;<span class="op" id="5945133">/</span>&nbsp;<span class="op" id="5945135">(</span><span class="num" id="5945136">1</span>&nbsp;<span class="op" id="5945138">&lt;&lt;</span>&nbsp;<span class="num" id="5945141">53</span><span class="op" id="5945143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945146">x</span>&nbsp;<span class="op" id="5945148">:=</span>&nbsp;<span class="ident" id="5945151">math</span><span class="op" id="5945155">.</span><span class="ident" id="5945156">Abs</span><span class="op" id="5945159">(</span><span class="num" id="5945160">2</span>&nbsp;<span class="op" id="5945162">*</span>&nbsp;<span class="builtinfunc" id="5945164">real</span><span class="op" id="5945168">(</span><span class="ident" id="5945169">z</span><span class="op" id="5945170">)</span><span class="op" id="5945171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945174">y</span>&nbsp;<span class="op" id="5945176">:=</span>&nbsp;<span class="ident" id="5945179">math</span><span class="op" id="5945183">.</span><span class="ident" id="5945184">Abs</span><span class="op" id="5945187">(</span><span class="num" id="5945188">2</span>&nbsp;<span class="op" id="5945190">*</span>&nbsp;<span class="builtinfunc" id="5945192">imag</span><span class="op" id="5945196">(</span><span class="ident" id="5945197">z</span><span class="op" id="5945198">)</span><span class="op" id="5945199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945202">x</span>&nbsp;<span class="op" id="5945204">=</span>&nbsp;<span class="ident" id="5945206">reducePi</span><span class="op" id="5945214">(</span><span class="ident" id="5945215">x</span><span class="op" id="5945216">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945219">x</span>&nbsp;<span class="op" id="5945221">=</span>&nbsp;<span class="ident" id="5945223">x</span>&nbsp;<span class="op" id="5945225">*</span>&nbsp;<span class="ident" id="5945227">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945230">y</span>&nbsp;<span class="op" id="5945232">=</span>&nbsp;<span class="ident" id="5945234">y</span>&nbsp;<span class="op" id="5945236">*</span>&nbsp;<span class="ident" id="5945238">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945241">x2</span>&nbsp;<span class="op" id="5945244">:=</span>&nbsp;<span class="num" id="5945247">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945252">y2</span>&nbsp;<span class="op" id="5945255">:=</span>&nbsp;<span class="num" id="5945258">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945263">f</span>&nbsp;<span class="op" id="5945265">:=</span>&nbsp;<span class="num" id="5945268">1.0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945273">rn</span>&nbsp;<span class="op" id="5945276">:=</span>&nbsp;<span class="num" id="5945279">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945284">d</span>&nbsp;<span class="op" id="5945286">:=</span>&nbsp;<span class="num" id="5945289">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5945294">for</span>&nbsp;<span class="op" id="5945298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945302">rn</span>&nbsp;<span class="op" id="5945305">+=</span>&nbsp;<span class="num" id="5945308">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945312">f</span>&nbsp;<span class="op" id="5945314">*=</span>&nbsp;<span class="ident" id="5945317">rn</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945322">rn</span>&nbsp;<span class="op" id="5945325">+=</span>&nbsp;<span class="num" id="5945328">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945332">f</span>&nbsp;<span class="op" id="5945334">*=</span>&nbsp;<span class="ident" id="5945337">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945342">x2</span>&nbsp;<span class="op" id="5945345">*=</span>&nbsp;<span class="ident" id="5945348">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945352">y2</span>&nbsp;<span class="op" id="5945355">*=</span>&nbsp;<span class="ident" id="5945358">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945362">t</span>&nbsp;<span class="op" id="5945364">:=</span>&nbsp;<span class="ident" id="5945367">y2</span>&nbsp;<span class="op" id="5945370">+</span>&nbsp;<span class="ident" id="5945372">x2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945377">t</span>&nbsp;<span class="op" id="5945379">/=</span>&nbsp;<span class="ident" id="5945382">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945386">d</span>&nbsp;<span class="op" id="5945388">+=</span>&nbsp;<span class="ident" id="5945391">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945396">rn</span>&nbsp;<span class="op" id="5945399">+=</span>&nbsp;<span class="num" id="5945402">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945406">f</span>&nbsp;<span class="op" id="5945408">*=</span>&nbsp;<span class="ident" id="5945411">rn</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945416">rn</span>&nbsp;<span class="op" id="5945419">+=</span>&nbsp;<span class="num" id="5945422">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945426">f</span>&nbsp;<span class="op" id="5945428">*=</span>&nbsp;<span class="ident" id="5945431">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945436">x2</span>&nbsp;<span class="op" id="5945439">*=</span>&nbsp;<span class="ident" id="5945442">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945446">y2</span>&nbsp;<span class="op" id="5945449">*=</span>&nbsp;<span class="ident" id="5945452">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945456">t</span>&nbsp;<span class="op" id="5945458">=</span>&nbsp;<span class="ident" id="5945460">y2</span>&nbsp;<span class="op" id="5945463">-</span>&nbsp;<span class="ident" id="5945465">x2</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945470">t</span>&nbsp;<span class="op" id="5945472">/=</span>&nbsp;<span class="ident" id="5945475">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5945479">d</span>&nbsp;<span class="op" id="5945481">+=</span>&nbsp;<span class="ident" id="5945484">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5945488">if</span>&nbsp;<span class="ident" id="5945491">math</span><span class="op" id="5945495">.</span><span class="ident" id="5945496">Abs</span><span class="op" id="5945499">(</span><span class="ident" id="5945500">t</span><span class="op" id="5945501">/</span><span class="ident" id="5945502">d</span><span class="op" id="5945503">)</span>&nbsp;<span class="op" id="5945505">&lt;=</span>&nbsp;<span class="ident" id="5945508">MACHEP</span>&nbsp;<span class="op" id="5945515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5945520">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5945528">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5945531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5945534">return</span>&nbsp;<span class="ident" id="5945541">d</span><br>
<span class="lineno"></span><span class="op" id="5945543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5945546">//&nbsp;Complex&nbsp;circular&nbsp;cotangent</span><br>
<span class="lineno">150</span><span class="comment" id="5945576">//</span><br>
<span class="lineno"></span><span class="comment" id="5945579">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5945595">//</span><br>
<span class="lineno"></span><span class="comment" id="5945598">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5945604">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno">155</span><span class="comment" id="5945623">//</span><br>
<span class="lineno"></span><span class="comment" id="5945626">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5945634">//</span><br>
<span class="lineno"></span><span class="comment" id="5945637">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;-&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5945671">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno">160</span><span class="comment" id="5945706">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosh&nbsp;2y&nbsp;&nbsp;-&nbsp;&nbsp;cos&nbsp;2x</span><br>
<span class="lineno"></span><span class="comment" id="5945739">//</span><br>
<span class="lineno"></span><span class="comment" id="5945742">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis,&nbsp;the&nbsp;denominator&nbsp;has&nbsp;zeros&nbsp;at&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="5945797">//&nbsp;multiples&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;Near&nbsp;these&nbsp;points&nbsp;it&nbsp;is&nbsp;evaluated</span><br>
<span class="lineno"></span><span class="comment" id="5945854">//&nbsp;by&nbsp;a&nbsp;Taylor&nbsp;series.</span><br>
<span class="lineno">165</span><span class="comment" id="5945877">//</span><br>
<span class="lineno"></span><span class="comment" id="5945880">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5945893">//</span><br>
<span class="lineno"></span><span class="comment" id="5945896">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5945936">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">170</span><span class="comment" id="5945994">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno"></span><span class="comment" id="5946054">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="5946114">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;+&nbsp;i0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5946155">//&nbsp;Cot&nbsp;returns&nbsp;the&nbsp;cotangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">175</span><span class="keyword" id="5946190">func</span>&nbsp;<span class="ident" id="5946195">Cot</span><span class="op" id="5946198">(</span><span class="ident" id="5946199">x</span>&nbsp;<span class="builtintype" id="5946201">complex128</span><span class="op" id="5946211">)</span>&nbsp;<span class="builtintype" id="5946213">complex128</span>&nbsp;<span class="op" id="5946224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5946227">d</span>&nbsp;<span class="op" id="5946229">:=</span>&nbsp;<span class="ident" id="5946232">math</span><span class="op" id="5946236">.</span><span class="ident" id="5946237">Cosh</span><span class="op" id="5946241">(</span><span class="num" id="5946242">2</span><span class="op" id="5946243">*</span><span class="builtinfunc" id="5946244">imag</span><span class="op" id="5946248">(</span><span class="ident" id="5946249">x</span><span class="op" id="5946250">)</span><span class="op" id="5946251">)</span>&nbsp;<span class="op" id="5946253">-</span>&nbsp;<span class="ident" id="5946255">math</span><span class="op" id="5946259">.</span><span class="ident" id="5946260">Cos</span><span class="op" id="5946263">(</span><span class="num" id="5946264">2</span><span class="op" id="5946265">*</span><span class="builtinfunc" id="5946266">real</span><span class="op" id="5946270">(</span><span class="ident" id="5946271">x</span><span class="op" id="5946272">)</span><span class="op" id="5946273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5946276">if</span>&nbsp;<span class="ident" id="5946279">math</span><span class="op" id="5946283">.</span><span class="ident" id="5946284">Abs</span><span class="op" id="5946287">(</span><span class="ident" id="5946288">d</span><span class="op" id="5946289">)</span>&nbsp;<span class="op" id="5946291">&lt;</span>&nbsp;<span class="num" id="5946293">0.25</span>&nbsp;<span class="op" id="5946298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5946302">d</span>&nbsp;<span class="op" id="5946304">=</span>&nbsp;<span class="ident" id="5946306">tanSeries</span><span class="op" id="5946315">(</span><span class="ident" id="5946316">x</span><span class="op" id="5946317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5946320">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5946323">if</span>&nbsp;<span class="ident" id="5946326">d</span>&nbsp;<span class="op" id="5946328">==</span>&nbsp;<span class="num" id="5946331">0</span>&nbsp;<span class="op" id="5946333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5946337">return</span>&nbsp;<span class="ident" id="5946344">Inf</span><span class="op" id="5946347">(</span><span class="op" id="5946348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5946351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5946354">return</span>&nbsp;<span class="builtinfunc" id="5946361">complex</span><span class="op" id="5946368">(</span><span class="ident" id="5946369">math</span><span class="op" id="5946373">.</span><span class="ident" id="5946374">Sin</span><span class="op" id="5946377">(</span><span class="num" id="5946378">2</span><span class="op" id="5946379">*</span><span class="builtinfunc" id="5946380">real</span><span class="op" id="5946384">(</span><span class="ident" id="5946385">x</span><span class="op" id="5946386">)</span><span class="op" id="5946387">)</span><span class="op" id="5946388">/</span><span class="ident" id="5946389">d</span><span class="op" id="5946390">,</span>&nbsp;<span class="op" id="5946392">-</span><span class="ident" id="5946393">math</span><span class="op" id="5946397">.</span><span class="ident" id="5946398">Sinh</span><span class="op" id="5946402">(</span><span class="num" id="5946403">2</span><span class="op" id="5946404">*</span><span class="builtinfunc" id="5946405">imag</span><span class="op" id="5946409">(</span><span class="ident" id="5946410">x</span><span class="op" id="5946411">)</span><span class="op" id="5946412">)</span><span class="op" id="5946413">/</span><span class="ident" id="5946414">d</span><span class="op" id="5946415">)</span><br>
<span class="lineno"></span><span class="op" id="5946417">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
