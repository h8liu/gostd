<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="6042847">package</span>&nbsp;<span class="ident" id="6042855">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6042861">import</span>&nbsp;<span class="op" id="6042868">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6042871">&#34;strconv&#34;</span><br>
<span class="lineno">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6042883">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno"></span><span class="op" id="6042905">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6042908">var</span>&nbsp;<span class="op" id="6042912">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6042915">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6042936">opShiftMap</span>&nbsp;<span class="op" id="6042947">=</span>&nbsp;<span class="keyword" id="6042949">map</span><span class="op" id="6042952">[</span><span class="builtintype" id="6042953">string</span><span class="op" id="6042959">]</span><span class="builtintype" id="6042960">uint32</span><span class="op" id="6042966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6042970">&#34;sll&#34;</span><span class="op" id="6042975">:</span>&nbsp;<span class="num" id="6042977">0</span><span class="op" id="6042978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6042982">&#34;srl&#34;</span><span class="op" id="6042987">:</span>&nbsp;<span class="num" id="6042989">1</span><span class="op" id="6042990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6042994">&#34;sra&#34;</span><span class="op" id="6042999">:</span>&nbsp;<span class="num" id="6043001">2</span><span class="op" id="6043002">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6043005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6043009">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043028">opReg3Map</span>&nbsp;<span class="op" id="6043038">=</span>&nbsp;<span class="keyword" id="6043040">map</span><span class="op" id="6043043">[</span><span class="builtintype" id="6043044">string</span><span class="op" id="6043050">]</span><span class="builtintype" id="6043051">uint32</span><span class="op" id="6043057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043061">&#34;sllv&#34;</span><span class="op" id="6043067">:</span>&nbsp;<span class="num" id="6043069">3</span><span class="op" id="6043070">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043074">&#34;srlv&#34;</span><span class="op" id="6043080">:</span>&nbsp;<span class="num" id="6043082">4</span><span class="op" id="6043083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043087">&#34;srla&#34;</span><span class="op" id="6043093">:</span>&nbsp;<span class="num" id="6043095">5</span><span class="op" id="6043096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043100">&#34;add&#34;</span><span class="op" id="6043105">:</span>&nbsp;&nbsp;<span class="num" id="6043108">6</span><span class="op" id="6043109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043113">&#34;sub&#34;</span><span class="op" id="6043118">:</span>&nbsp;&nbsp;<span class="num" id="6043121">7</span><span class="op" id="6043122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043126">&#34;and&#34;</span><span class="op" id="6043131">:</span>&nbsp;&nbsp;<span class="num" id="6043134">8</span><span class="op" id="6043135">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043139">&#34;or&#34;</span><span class="op" id="6043143">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6043147">9</span><span class="op" id="6043148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043152">&#34;xor&#34;</span><span class="op" id="6043157">:</span>&nbsp;&nbsp;<span class="num" id="6043160">10</span><span class="op" id="6043162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043166">&#34;nor&#34;</span><span class="op" id="6043171">:</span>&nbsp;&nbsp;<span class="num" id="6043174">11</span><span class="op" id="6043176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043180">&#34;slt&#34;</span><span class="op" id="6043185">:</span>&nbsp;&nbsp;<span class="num" id="6043188">12</span><span class="op" id="6043190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043194">&#34;sltu&#34;</span><span class="op" id="6043200">:</span>&nbsp;<span class="num" id="6043202">13</span><span class="op" id="6043204">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043208">&#34;mul&#34;</span><span class="op" id="6043213">:</span>&nbsp;&nbsp;<span class="num" id="6043216">14</span><span class="op" id="6043218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043222">&#34;mulu&#34;</span><span class="op" id="6043228">:</span>&nbsp;<span class="num" id="6043230">15</span><span class="op" id="6043232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043236">&#34;div&#34;</span><span class="op" id="6043241">:</span>&nbsp;&nbsp;<span class="num" id="6043244">16</span><span class="op" id="6043246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043250">&#34;divu&#34;</span><span class="op" id="6043256">:</span>&nbsp;<span class="num" id="6043258">17</span><span class="op" id="6043260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043264">&#34;mod&#34;</span><span class="op" id="6043269">:</span>&nbsp;&nbsp;<span class="num" id="6043272">18</span><span class="op" id="6043274">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043278">&#34;modu&#34;</span><span class="op" id="6043284">:</span>&nbsp;<span class="num" id="6043286">19</span><span class="op" id="6043288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6043291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6043295">//&nbsp;op&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043310">opReg2Map</span>&nbsp;<span class="op" id="6043320">=</span>&nbsp;<span class="keyword" id="6043322">map</span><span class="op" id="6043325">[</span><span class="builtintype" id="6043326">string</span><span class="op" id="6043332">]</span><span class="builtintype" id="6043333">uint32</span><span class="op" id="6043339">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043343">&#34;mov&#34;</span><span class="op" id="6043348">:</span>&nbsp;<span class="num" id="6043350">0</span><span class="op" id="6043351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6043354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6043358">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043377">opFloatMap</span>&nbsp;<span class="op" id="6043388">=</span>&nbsp;<span class="keyword" id="6043390">map</span><span class="op" id="6043393">[</span><span class="builtintype" id="6043394">string</span><span class="op" id="6043400">]</span><span class="builtintype" id="6043401">uint32</span><span class="op" id="6043407">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043411">&#34;fadd&#34;</span><span class="op" id="6043417">:</span>&nbsp;<span class="num" id="6043419">0</span><span class="op" id="6043420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043424">&#34;fsub&#34;</span><span class="op" id="6043430">:</span>&nbsp;<span class="num" id="6043432">1</span><span class="op" id="6043433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043437">&#34;fmul&#34;</span><span class="op" id="6043443">:</span>&nbsp;<span class="num" id="6043445">2</span><span class="op" id="6043446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043450">&#34;fdiv&#34;</span><span class="op" id="6043456">:</span>&nbsp;<span class="num" id="6043458">3</span><span class="op" id="6043459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6043463">&#34;fint&#34;</span><span class="op" id="6043469">:</span>&nbsp;<span class="num" id="6043471">4</span><span class="op" id="6043472">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6043475">}</span><br>
<span class="lineno"></span><span class="op" id="6043477">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6043480">func</span>&nbsp;<span class="ident" id="6043485">parseShift</span><span class="op" id="6043495">(</span><span class="ident" id="6043496">p</span>&nbsp;<span class="op" id="6043498">*</span><span class="ident" id="6043499"><a href="/lonnie.io/e8vm/asm8/parser.go.html#6059818">parser</a></span><span class="op" id="6043505">,</span>&nbsp;<span class="ident" id="6043507">op</span>&nbsp;<span class="op" id="6043510">*</span><span class="ident" id="6043511"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6042883">lex8</a></span><span class="op" id="6043515">.</span><span class="ident" id="6043516">Token</span><span class="op" id="6043521">)</span>&nbsp;<span class="builtintype" id="6043523">uint32</span>&nbsp;<span class="op" id="6043530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043533">ret</span><span class="op" id="6043536">,</span>&nbsp;<span class="ident" id="6043538">e</span>&nbsp;<span class="op" id="6043540">:=</span>&nbsp;<span class="ident" id="6043543"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6042871">strconv</a></span><span class="op" id="6043550">.</span><span class="ident" id="6043551">ParseUint</span><span class="op" id="6043560">(</span><span class="ident" id="6043561"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043507">op</a></span><span class="op" id="6043563">.</span><span class="ident" id="6043564">Lit</span><span class="op" id="6043567">,</span>&nbsp;<span class="num" id="6043569">0</span><span class="op" id="6043570">,</span>&nbsp;<span class="num" id="6043572">32</span><span class="op" id="6043574">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043577">if</span>&nbsp;<span class="ident" id="6043580"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043538">e</a></span>&nbsp;<span class="op" id="6043582">!=</span>&nbsp;<span class="ident" id="6043585">nil</span>&nbsp;<span class="op" id="6043589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043593"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043496">p</a></span><span class="op" id="6043594">.</span><span class="ident" id="6043595">err</span><span class="op" id="6043598">(</span><span class="ident" id="6043599"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043507">op</a></span><span class="op" id="6043601">.</span><span class="ident" id="6043602">Pos</span><span class="op" id="6043605">,</span>&nbsp;<span class="string" id="6043607">&#34;invalid&nbsp;shift&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="6043629">,</span>&nbsp;<span class="ident" id="6043631"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043507">op</a></span><span class="op" id="6043633">.</span><span class="ident" id="6043634">Lit</span><span class="op" id="6043637">,</span>&nbsp;<span class="ident" id="6043639"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043538">e</a></span><span class="op" id="6043640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043644">return</span>&nbsp;<span class="num" id="6043651">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6043654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043658">if</span>&nbsp;<span class="op" id="6043661">(</span><span class="ident" id="6043662"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043533">ret</a></span>&nbsp;<span class="op" id="6043666">&amp;</span>&nbsp;<span class="num" id="6043668">0x1f</span><span class="op" id="6043672">)</span>&nbsp;<span class="op" id="6043674">!=</span>&nbsp;<span class="ident" id="6043677"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043533">ret</a></span>&nbsp;<span class="op" id="6043681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043685"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043496">p</a></span><span class="op" id="6043686">.</span><span class="ident" id="6043687">err</span><span class="op" id="6043690">(</span><span class="ident" id="6043691"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043507">op</a></span><span class="op" id="6043693">.</span><span class="ident" id="6043694">Pos</span><span class="op" id="6043697">,</span>&nbsp;<span class="string" id="6043699">&#34;shift&nbsp;too&nbsp;large:&nbsp;%s&#34;</span><span class="op" id="6043720">,</span>&nbsp;<span class="ident" id="6043722"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043507">op</a></span><span class="op" id="6043724">.</span><span class="ident" id="6043725">Lit</span><span class="op" id="6043728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043732">return</span>&nbsp;<span class="num" id="6043739">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6043742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043746">return</span>&nbsp;<span class="builtintype" id="6043753">uint32</span><span class="op" id="6043759">(</span><span class="ident" id="6043760"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043533">ret</a></span><span class="op" id="6043763">)</span><br>
<span class="lineno"></span><span class="op" id="6043765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6043768">func</span>&nbsp;<span class="ident" id="6043773">makeInstReg</span><span class="op" id="6043784">(</span><span class="ident" id="6043785">fn</span><span class="op" id="6043787">,</span>&nbsp;<span class="ident" id="6043789">d</span><span class="op" id="6043790">,</span>&nbsp;<span class="ident" id="6043792">s1</span><span class="op" id="6043794">,</span>&nbsp;<span class="ident" id="6043796">s2</span><span class="op" id="6043798">,</span>&nbsp;<span class="ident" id="6043800">sh</span><span class="op" id="6043802">,</span>&nbsp;<span class="ident" id="6043804">isFloat</span>&nbsp;<span class="builtintype" id="6043812">uint32</span><span class="op" id="6043818">)</span>&nbsp;<span class="op" id="6043820">*</span><span class="ident" id="6043821"><a href="/lonnie.io/e8vm/asm8/inst.go.html#6037298">inst</a></span>&nbsp;<span class="op" id="6043826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043829">ret</span>&nbsp;<span class="op" id="6043833">:=</span>&nbsp;<span class="builtintype" id="6043836">uint32</span><span class="op" id="6043842">(</span><span class="num" id="6043843">0</span><span class="op" id="6043844">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043847"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043829">ret</a></span>&nbsp;<span class="op" id="6043851">|=</span>&nbsp;<span class="op" id="6043854">(</span><span class="ident" id="6043855"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043789">d</a></span>&nbsp;<span class="op" id="6043857">&amp;</span>&nbsp;<span class="num" id="6043859">0x7</span><span class="op" id="6043862">)</span>&nbsp;<span class="op" id="6043864">&lt;&lt;</span>&nbsp;<span class="num" id="6043867">21</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043871"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043829">ret</a></span>&nbsp;<span class="op" id="6043875">|=</span>&nbsp;<span class="op" id="6043878">(</span><span class="ident" id="6043879"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043792">s1</a></span>&nbsp;<span class="op" id="6043882">&amp;</span>&nbsp;<span class="num" id="6043884">0x7</span><span class="op" id="6043887">)</span>&nbsp;<span class="op" id="6043889">&lt;&lt;</span>&nbsp;<span class="num" id="6043892">18</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043896"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043829">ret</a></span>&nbsp;<span class="op" id="6043900">|=</span>&nbsp;<span class="op" id="6043903">(</span><span class="ident" id="6043904"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043796">s2</a></span>&nbsp;<span class="op" id="6043907">&amp;</span>&nbsp;<span class="num" id="6043909">0x7</span><span class="op" id="6043912">)</span>&nbsp;<span class="op" id="6043914">&lt;&lt;</span>&nbsp;<span class="num" id="6043917">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043921"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043829">ret</a></span>&nbsp;<span class="op" id="6043925">|=</span>&nbsp;<span class="op" id="6043928">(</span><span class="ident" id="6043929"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043800">sh</a></span>&nbsp;<span class="op" id="6043932">&amp;</span>&nbsp;<span class="num" id="6043934">0x1f</span><span class="op" id="6043938">)</span>&nbsp;<span class="op" id="6043940">&lt;&lt;</span>&nbsp;<span class="num" id="6043943">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043947"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043829">ret</a></span>&nbsp;<span class="op" id="6043951">|=</span>&nbsp;<span class="op" id="6043954">(</span><span class="ident" id="6043955"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043804">isFloat</a></span>&nbsp;<span class="op" id="6043963">&amp;</span>&nbsp;<span class="num" id="6043965">0x1</span><span class="op" id="6043968">)</span>&nbsp;<span class="op" id="6043970">&lt;&lt;</span>&nbsp;<span class="num" id="6043973">8</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043976"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043829">ret</a></span>&nbsp;<span class="op" id="6043980">|=</span>&nbsp;<span class="ident" id="6043983"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043785">fn</a></span>&nbsp;<span class="op" id="6043986">&amp;</span>&nbsp;<span class="num" id="6043988">0xff</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043995">return</span>&nbsp;<span class="op" id="6044002">&amp;</span><span class="ident" id="6044003"><a href="/lonnie.io/e8vm/asm8/inst.go.html#6037298">inst</a></span><span class="op" id="6044007">{</span><span class="ident" id="6044008">inst</span><span class="op" id="6044012">:</span>&nbsp;<span class="ident" id="6044014"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043829">ret</a></span><span class="op" id="6044017">}</span><br>
<span class="lineno"></span><span class="op" id="6044019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="6044022">func</span>&nbsp;<span class="ident" id="6044027">parseInstReg</span><span class="op" id="6044039">(</span><span class="ident" id="6044040">p</span>&nbsp;<span class="op" id="6044042">*</span><span class="ident" id="6044043"><a href="/lonnie.io/e8vm/asm8/parser.go.html#6059818">parser</a></span><span class="op" id="6044049">,</span>&nbsp;<span class="ident" id="6044051">ops</span>&nbsp;<span class="op" id="6044055">[</span><span class="op" id="6044056">]</span><span class="op" id="6044057">*</span><span class="ident" id="6044058"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6042883">lex8</a></span><span class="op" id="6044062">.</span><span class="ident" id="6044063">Token</span><span class="op" id="6044068">)</span>&nbsp;<span class="op" id="6044070">(</span><span class="op" id="6044071">*</span><span class="ident" id="6044072"><a href="/lonnie.io/e8vm/asm8/inst.go.html#6037298">inst</a></span><span class="op" id="6044076">,</span>&nbsp;<span class="builtintype" id="6044078">bool</span><span class="op" id="6044082">)</span>&nbsp;<span class="op" id="6044084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044087">op0</span>&nbsp;<span class="op" id="6044091">:=</span>&nbsp;<span class="ident" id="6044094"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044051">ops</a></span><span class="op" id="6044097">[</span><span class="num" id="6044098">0</span><span class="op" id="6044099">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044102">opName</span>&nbsp;<span class="op" id="6044109">:=</span>&nbsp;<span class="ident" id="6044112"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044087">op0</a></span><span class="op" id="6044115">.</span><span class="ident" id="6044116">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044121">args</span>&nbsp;<span class="op" id="6044126">:=</span>&nbsp;<span class="ident" id="6044129"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044051">ops</a></span><span class="op" id="6044132">[</span><span class="num" id="6044133">1</span><span class="op" id="6044134">:</span><span class="op" id="6044135">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6044139">//&nbsp;common&nbsp;args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044155">var</span>&nbsp;<span class="ident" id="6044159">fn</span><span class="op" id="6044161">,</span>&nbsp;<span class="ident" id="6044163">d</span><span class="op" id="6044164">,</span>&nbsp;<span class="ident" id="6044166">s1</span><span class="op" id="6044168">,</span>&nbsp;<span class="ident" id="6044170">s2</span><span class="op" id="6044172">,</span>&nbsp;<span class="ident" id="6044174">sh</span><span class="op" id="6044176">,</span>&nbsp;<span class="ident" id="6044178">isFloat</span>&nbsp;<span class="builtintype" id="6044186">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044195">argCount</span>&nbsp;<span class="op" id="6044204">:=</span>&nbsp;<span class="keyword" id="6044207">func</span><span class="op" id="6044211">(</span><span class="ident" id="6044212">n</span>&nbsp;<span class="builtintype" id="6044214">int</span><span class="op" id="6044217">)</span>&nbsp;<span class="builtintype" id="6044219">bool</span>&nbsp;<span class="op" id="6044224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044228">if</span>&nbsp;<span class="op" id="6044231">!</span><span class="ident" id="6044232"><a href="/lonnie.io/e8vm/asm8/parse_arg.go.html#6052672">argCount</a></span><span class="op" id="6044240">(</span><span class="ident" id="6044241"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044040">p</a></span><span class="op" id="6044242">,</span>&nbsp;<span class="ident" id="6044244"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044051">ops</a></span><span class="op" id="6044247">,</span>&nbsp;<span class="ident" id="6044249"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044212">n</a></span><span class="op" id="6044250">)</span>&nbsp;<span class="op" id="6044252">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044257">return</span>&nbsp;<span class="builtintype" id="6044264">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044276">if</span>&nbsp;<span class="ident" id="6044279"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044212">n</a></span>&nbsp;<span class="op" id="6044281">&gt;=</span>&nbsp;<span class="num" id="6044284">2</span>&nbsp;<span class="op" id="6044286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044291"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044163">d</a></span>&nbsp;<span class="op" id="6044293">=</span>&nbsp;<span class="ident" id="6044295"><a href="/lonnie.io/e8vm/asm8/parse_reg.go.html#6056310">parseReg</a></span><span class="op" id="6044303">(</span><span class="ident" id="6044304"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044040">p</a></span><span class="op" id="6044305">,</span>&nbsp;<span class="ident" id="6044307"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044121">args</a></span><span class="op" id="6044311">[</span><span class="num" id="6044312">0</span><span class="op" id="6044313">]</span><span class="op" id="6044314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044319"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044166">s1</a></span>&nbsp;<span class="op" id="6044322">=</span>&nbsp;<span class="ident" id="6044324"><a href="/lonnie.io/e8vm/asm8/parse_reg.go.html#6056310">parseReg</a></span><span class="op" id="6044332">(</span><span class="ident" id="6044333"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044040">p</a></span><span class="op" id="6044334">,</span>&nbsp;<span class="ident" id="6044336"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044121">args</a></span><span class="op" id="6044340">[</span><span class="num" id="6044341">1</span><span class="op" id="6044342">]</span><span class="op" id="6044343">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044351">return</span>&nbsp;<span class="builtintype" id="6044358">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044368">var</span>&nbsp;<span class="ident" id="6044372">found</span>&nbsp;<span class="builtintype" id="6044378">bool</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044384">if</span>&nbsp;<span class="ident" id="6044387"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044159">fn</a></span><span class="op" id="6044389">,</span>&nbsp;<span class="ident" id="6044391"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044372">found</a></span>&nbsp;<span class="op" id="6044397">=</span>&nbsp;<span class="ident" id="6044399"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6042936">opShiftMap</a></span><span class="op" id="6044409">[</span><span class="ident" id="6044410"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044102">opName</a></span><span class="op" id="6044416">]</span><span class="op" id="6044417">;</span>&nbsp;<span class="ident" id="6044419"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044372">found</a></span>&nbsp;<span class="op" id="6044425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6044429">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044451">if</span>&nbsp;<span class="ident" id="6044454"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044195">argCount</a></span><span class="op" id="6044462">(</span><span class="num" id="6044463">3</span><span class="op" id="6044464">)</span>&nbsp;<span class="op" id="6044466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044471"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044174">sh</a></span>&nbsp;<span class="op" id="6044474">=</span>&nbsp;<span class="ident" id="6044476"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043485">parseShift</a></span><span class="op" id="6044486">(</span><span class="ident" id="6044487"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044040">p</a></span><span class="op" id="6044488">,</span>&nbsp;<span class="ident" id="6044490"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044121">args</a></span><span class="op" id="6044494">[</span><span class="num" id="6044495">2</span><span class="op" id="6044496">]</span><span class="op" id="6044497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044501">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044504">}</span>&nbsp;<span class="keyword" id="6044506">else</span>&nbsp;<span class="keyword" id="6044511">if</span>&nbsp;<span class="ident" id="6044514"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044159">fn</a></span><span class="op" id="6044516">,</span>&nbsp;<span class="ident" id="6044518"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044372">found</a></span>&nbsp;<span class="op" id="6044524">=</span>&nbsp;<span class="ident" id="6044526"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043028">opReg3Map</a></span><span class="op" id="6044535">[</span><span class="ident" id="6044536"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044102">opName</a></span><span class="op" id="6044542">]</span><span class="op" id="6044543">;</span>&nbsp;<span class="ident" id="6044545"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044372">found</a></span>&nbsp;<span class="op" id="6044551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6044555">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044575">if</span>&nbsp;<span class="ident" id="6044578"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044195">argCount</a></span><span class="op" id="6044586">(</span><span class="num" id="6044587">3</span><span class="op" id="6044588">)</span>&nbsp;<span class="op" id="6044590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044595"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044170">s2</a></span>&nbsp;<span class="op" id="6044598">=</span>&nbsp;<span class="ident" id="6044600"><a href="/lonnie.io/e8vm/asm8/parse_reg.go.html#6056310">parseReg</a></span><span class="op" id="6044608">(</span><span class="ident" id="6044609"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044040">p</a></span><span class="op" id="6044610">,</span>&nbsp;<span class="ident" id="6044612"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044121">args</a></span><span class="op" id="6044616">[</span><span class="num" id="6044617">2</span><span class="op" id="6044618">]</span><span class="op" id="6044619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044623">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044626">}</span>&nbsp;<span class="keyword" id="6044628">else</span>&nbsp;<span class="keyword" id="6044633">if</span>&nbsp;<span class="ident" id="6044636"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044159">fn</a></span><span class="op" id="6044638">,</span>&nbsp;<span class="ident" id="6044640"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044372">found</a></span>&nbsp;<span class="op" id="6044646">=</span>&nbsp;<span class="ident" id="6044648"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043310">opReg2Map</a></span><span class="op" id="6044657">[</span><span class="ident" id="6044658"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044102">opName</a></span><span class="op" id="6044664">]</span><span class="op" id="6044665">;</span>&nbsp;<span class="ident" id="6044667"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044372">found</a></span>&nbsp;<span class="op" id="6044673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6044677">//&nbsp;op&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044693"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044195">argCount</a></span><span class="op" id="6044701">(</span><span class="num" id="6044702">2</span><span class="op" id="6044703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044706">}</span>&nbsp;<span class="keyword" id="6044708">else</span>&nbsp;<span class="keyword" id="6044713">if</span>&nbsp;<span class="ident" id="6044716"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044159">fn</a></span><span class="op" id="6044718">,</span>&nbsp;<span class="ident" id="6044720"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044372">found</a></span>&nbsp;<span class="op" id="6044726">=</span>&nbsp;<span class="ident" id="6044728"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043377">opFloatMap</a></span><span class="op" id="6044738">[</span><span class="ident" id="6044739"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044102">opName</a></span><span class="op" id="6044745">]</span><span class="op" id="6044746">;</span>&nbsp;<span class="ident" id="6044748"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044372">found</a></span>&nbsp;<span class="op" id="6044754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6044758">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044778">if</span>&nbsp;<span class="ident" id="6044781"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044195">argCount</a></span><span class="op" id="6044789">(</span><span class="num" id="6044790">3</span><span class="op" id="6044791">)</span>&nbsp;<span class="op" id="6044793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044798"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044170">s2</a></span>&nbsp;<span class="op" id="6044801">=</span>&nbsp;<span class="ident" id="6044803"><a href="/lonnie.io/e8vm/asm8/parse_reg.go.html#6056310">parseReg</a></span><span class="op" id="6044811">(</span><span class="ident" id="6044812"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044040">p</a></span><span class="op" id="6044813">,</span>&nbsp;<span class="ident" id="6044815"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044121">args</a></span><span class="op" id="6044819">[</span><span class="num" id="6044820">2</span><span class="op" id="6044821">]</span><span class="op" id="6044822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044830"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044178">isFloat</a></span>&nbsp;<span class="op" id="6044838">=</span>&nbsp;<span class="num" id="6044840">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044843">}</span>&nbsp;<span class="keyword" id="6044845">else</span>&nbsp;<span class="op" id="6044850">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044854">return</span>&nbsp;<span class="ident" id="6044861">nil</span><span class="op" id="6044864">,</span>&nbsp;<span class="builtintype" id="6044866">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044877">return</span>&nbsp;<span class="ident" id="6044884"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6043773">makeInstReg</a></span><span class="op" id="6044895">(</span><span class="ident" id="6044896"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044159">fn</a></span><span class="op" id="6044898">,</span>&nbsp;<span class="ident" id="6044900"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044163">d</a></span><span class="op" id="6044901">,</span>&nbsp;<span class="ident" id="6044903"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044166">s1</a></span><span class="op" id="6044905">,</span>&nbsp;<span class="ident" id="6044907"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044170">s2</a></span><span class="op" id="6044909">,</span>&nbsp;<span class="ident" id="6044911"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044174">sh</a></span><span class="op" id="6044913">,</span>&nbsp;<span class="ident" id="6044915"><a href="/lonnie.io/e8vm/asm8/inst_reg.go.html#6044178">isFloat</a></span><span class="op" id="6044922">)</span><span class="op" id="6044923">,</span>&nbsp;<span class="builtintype" id="6044925">true</span><br>
<span class="lineno"></span><span class="op" id="6044930">}</span>
</div>
</body>
</html>
