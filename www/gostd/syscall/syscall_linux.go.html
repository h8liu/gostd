<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2394999">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2395054">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2395108">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2395159">//&nbsp;Linux&nbsp;system&nbsp;calls.</span><br>
<span class="lineno"></span><span class="comment" id="2395182">//&nbsp;This&nbsp;file&nbsp;is&nbsp;compiled&nbsp;as&nbsp;ordinary&nbsp;Go&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment" id="2395228">//&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;input&nbsp;to&nbsp;mksyscall,</span><br>
<span class="lineno"></span><span class="comment" id="2395266">//&nbsp;which&nbsp;parses&nbsp;the&nbsp;//sys&nbsp;lines&nbsp;and&nbsp;generates&nbsp;system&nbsp;call&nbsp;stubs.</span><br>
<span class="lineno"></span><span class="comment" id="2395331">//&nbsp;Note&nbsp;that&nbsp;sometimes&nbsp;we&nbsp;use&nbsp;a&nbsp;lowercase&nbsp;//sys&nbsp;name&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2395388">//&nbsp;wrap&nbsp;it&nbsp;in&nbsp;our&nbsp;own&nbsp;nicer&nbsp;implementation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2395433">package</span>&nbsp;<span class="ident" id="2395441">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2395450">import</span>&nbsp;<span class="string" id="2395457">&#34;unsafe&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2395467">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Wrapped<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2395486">//sys&nbsp;&nbsp;&nbsp;&nbspopen(path&nbsp;string,&nbsp;mode&nbsp;int,&nbsp;perm&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2395554">func</span>&nbsp;<span class="ident" id="2395559">Open</span><span class="op" id="2395563">(</span><span class="ident" id="2395564">path</span>&nbsp;<span class="builtintype" id="2395569">string</span><span class="op" id="2395575">,</span>&nbsp;<span class="ident" id="2395577">mode</span>&nbsp;<span class="builtintype" id="2395582">int</span><span class="op" id="2395585">,</span>&nbsp;<span class="ident" id="2395587">perm</span>&nbsp;<span class="builtintype" id="2395592">uint32</span><span class="op" id="2395598">)</span>&nbsp;<span class="op" id="2395600">(</span><span class="ident" id="2395601">fd</span>&nbsp;<span class="builtintype" id="2395604">int</span><span class="op" id="2395607">,</span>&nbsp;<span class="ident" id="2395609">err</span>&nbsp;<span class="builtintype" id="2395613">error</span><span class="op" id="2395618">)</span>&nbsp;<span class="op" id="2395620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2395623">return</span>&nbsp;<span class="ident" id="2395630">open</span><span class="op" id="2395634">(</span><span class="ident" id="2395635">path</span><span class="op" id="2395639">,</span>&nbsp;<span class="ident" id="2395641">mode</span><span class="op" id="2395645">|</span><span class="ident" id="2395646">O_LARGEFILE</span><span class="op" id="2395657">,</span>&nbsp;<span class="ident" id="2395659">perm</span><span class="op" id="2395663">)</span><br>
<span class="lineno"></span><span class="op" id="2395665">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2395668">//sys&nbsp;&nbsp;&nbsp;&nbspopenat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;flags&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2395750">func</span>&nbsp;<span class="ident" id="2395755">Openat</span><span class="op" id="2395761">(</span><span class="ident" id="2395762">dirfd</span>&nbsp;<span class="builtintype" id="2395768">int</span><span class="op" id="2395771">,</span>&nbsp;<span class="ident" id="2395773">path</span>&nbsp;<span class="builtintype" id="2395778">string</span><span class="op" id="2395784">,</span>&nbsp;<span class="ident" id="2395786">flags</span>&nbsp;<span class="builtintype" id="2395792">int</span><span class="op" id="2395795">,</span>&nbsp;<span class="ident" id="2395797">mode</span>&nbsp;<span class="builtintype" id="2395802">uint32</span><span class="op" id="2395808">)</span>&nbsp;<span class="op" id="2395810">(</span><span class="ident" id="2395811">fd</span>&nbsp;<span class="builtintype" id="2395814">int</span><span class="op" id="2395817">,</span>&nbsp;<span class="ident" id="2395819">err</span>&nbsp;<span class="builtintype" id="2395823">error</span><span class="op" id="2395828">)</span>&nbsp;<span class="op" id="2395830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2395833">return</span>&nbsp;<span class="ident" id="2395840">openat</span><span class="op" id="2395846">(</span><span class="ident" id="2395847">dirfd</span><span class="op" id="2395852">,</span>&nbsp;<span class="ident" id="2395854">path</span><span class="op" id="2395858">,</span>&nbsp;<span class="ident" id="2395860">flags</span><span class="op" id="2395865">|</span><span class="ident" id="2395866">O_LARGEFILE</span><span class="op" id="2395877">,</span>&nbsp;<span class="ident" id="2395879">mode</span><span class="op" id="2395883">)</span><br>
<span class="lineno">30</span><span class="op" id="2395885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2395888">//sysnb&nbsp;&nbsp;&nbsp;&nbsppipe(p&nbsp;*[2]_C_int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2395928">func</span>&nbsp;<span class="ident" id="2395933">Pipe</span><span class="op" id="2395937">(</span><span class="ident" id="2395938">p</span>&nbsp;<span class="op" id="2395940">[</span><span class="op" id="2395941">]</span><span class="builtintype" id="2395942">int</span><span class="op" id="2395945">)</span>&nbsp;<span class="op" id="2395947">(</span><span class="ident" id="2395948">err</span>&nbsp;<span class="builtintype" id="2395952">error</span><span class="op" id="2395957">)</span>&nbsp;<span class="op" id="2395959">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2395962">if</span>&nbsp;<span class="builtinfunc" id="2395965">len</span><span class="op" id="2395968">(</span><span class="ident" id="2395969">p</span><span class="op" id="2395970">)</span>&nbsp;<span class="op" id="2395972">!=</span>&nbsp;<span class="num" id="2395975">2</span>&nbsp;<span class="op" id="2395977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2395981">return</span>&nbsp;<span class="ident" id="2395988">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2395996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2395999">var</span>&nbsp;<span class="ident" id="2396003">pp</span>&nbsp;<span class="op" id="2396006">[</span><span class="num" id="2396007">2</span><span class="op" id="2396008">]</span><span class="ident" id="2396009">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2396017">err</span>&nbsp;<span class="op" id="2396021">=</span>&nbsp;<span class="ident" id="2396023">pipe</span><span class="op" id="2396027">(</span><span class="op" id="2396028">&amp;</span><span class="ident" id="2396029">pp</span><span class="op" id="2396031">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2396034">p</span><span class="op" id="2396035">[</span><span class="num" id="2396036">0</span><span class="op" id="2396037">]</span>&nbsp;<span class="op" id="2396039">=</span>&nbsp;<span class="builtintype" id="2396041">int</span><span class="op" id="2396044">(</span><span class="ident" id="2396045">pp</span><span class="op" id="2396047">[</span><span class="num" id="2396048">0</span><span class="op" id="2396049">]</span><span class="op" id="2396050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2396053">p</span><span class="op" id="2396054">[</span><span class="num" id="2396055">1</span><span class="op" id="2396056">]</span>&nbsp;<span class="op" id="2396058">=</span>&nbsp;<span class="builtintype" id="2396060">int</span><span class="op" id="2396063">(</span><span class="ident" id="2396064">pp</span><span class="op" id="2396066">[</span><span class="num" id="2396067">1</span><span class="op" id="2396068">]</span><span class="op" id="2396069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396072">return</span><br>
<span class="lineno"></span><span class="op" id="2396079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2396082">//sysnb&nbsp;pipe2(p&nbsp;*[2]_C_int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2396134">func</span>&nbsp;<span class="ident" id="2396139">Pipe2</span><span class="op" id="2396144">(</span><span class="ident" id="2396145">p</span>&nbsp;<span class="op" id="2396147">[</span><span class="op" id="2396148">]</span><span class="builtintype" id="2396149">int</span><span class="op" id="2396152">,</span>&nbsp;<span class="ident" id="2396154">flags</span>&nbsp;<span class="builtintype" id="2396160">int</span><span class="op" id="2396163">)</span>&nbsp;<span class="op" id="2396165">(</span><span class="ident" id="2396166">err</span>&nbsp;<span class="builtintype" id="2396170">error</span><span class="op" id="2396175">)</span>&nbsp;<span class="op" id="2396177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396180">if</span>&nbsp;<span class="builtinfunc" id="2396183">len</span><span class="op" id="2396186">(</span><span class="ident" id="2396187">p</span><span class="op" id="2396188">)</span>&nbsp;<span class="op" id="2396190">!=</span>&nbsp;<span class="num" id="2396193">2</span>&nbsp;<span class="op" id="2396195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396199">return</span>&nbsp;<span class="ident" id="2396206">EINVAL</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2396214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396217">var</span>&nbsp;<span class="ident" id="2396221">pp</span>&nbsp;<span class="op" id="2396224">[</span><span class="num" id="2396225">2</span><span class="op" id="2396226">]</span><span class="ident" id="2396227">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2396235">err</span>&nbsp;<span class="op" id="2396239">=</span>&nbsp;<span class="ident" id="2396241">pipe2</span><span class="op" id="2396246">(</span><span class="op" id="2396247">&amp;</span><span class="ident" id="2396248">pp</span><span class="op" id="2396250">,</span>&nbsp;<span class="ident" id="2396252">flags</span><span class="op" id="2396257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2396260">p</span><span class="op" id="2396261">[</span><span class="num" id="2396262">0</span><span class="op" id="2396263">]</span>&nbsp;<span class="op" id="2396265">=</span>&nbsp;<span class="builtintype" id="2396267">int</span><span class="op" id="2396270">(</span><span class="ident" id="2396271">pp</span><span class="op" id="2396273">[</span><span class="num" id="2396274">0</span><span class="op" id="2396275">]</span><span class="op" id="2396276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2396279">p</span><span class="op" id="2396280">[</span><span class="num" id="2396281">1</span><span class="op" id="2396282">]</span>&nbsp;<span class="op" id="2396284">=</span>&nbsp;<span class="builtintype" id="2396286">int</span><span class="op" id="2396289">(</span><span class="ident" id="2396290">pp</span><span class="op" id="2396292">[</span><span class="num" id="2396293">1</span><span class="op" id="2396294">]</span><span class="op" id="2396295">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396298">return</span><br>
<span class="lineno"></span><span class="op" id="2396305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2396308">//sys&nbsp;&nbsp;&nbsp;&nbsputimes(path&nbsp;string,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2396366">func</span>&nbsp;<span class="ident" id="2396371">Utimes</span><span class="op" id="2396377">(</span><span class="ident" id="2396378">path</span>&nbsp;<span class="builtintype" id="2396383">string</span><span class="op" id="2396389">,</span>&nbsp;<span class="ident" id="2396391">tv</span>&nbsp;<span class="op" id="2396394">[</span><span class="op" id="2396395">]</span><span class="ident" id="2396396">Timeval</span><span class="op" id="2396403">)</span>&nbsp;<span class="op" id="2396405">(</span><span class="ident" id="2396406">err</span>&nbsp;<span class="builtintype" id="2396410">error</span><span class="op" id="2396415">)</span>&nbsp;<span class="op" id="2396417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396420">if</span>&nbsp;<span class="builtinfunc" id="2396423">len</span><span class="op" id="2396426">(</span><span class="ident" id="2396427">tv</span><span class="op" id="2396429">)</span>&nbsp;<span class="op" id="2396431">!=</span>&nbsp;<span class="num" id="2396434">2</span>&nbsp;<span class="op" id="2396436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396440">return</span>&nbsp;<span class="ident" id="2396447">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2396455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396458">return</span>&nbsp;<span class="ident" id="2396465">utimes</span><span class="op" id="2396471">(</span><span class="ident" id="2396472">path</span><span class="op" id="2396476">,</span>&nbsp;<span class="op" id="2396478">(</span><span class="op" id="2396479">*</span><span class="op" id="2396480">[</span><span class="num" id="2396481">2</span><span class="op" id="2396482">]</span><span class="ident" id="2396483">Timeval</span><span class="op" id="2396490">)</span><span class="op" id="2396491">(</span><span class="ident" id="2396492">unsafe</span><span class="op" id="2396498">.</span><span class="ident" id="2396499">Pointer</span><span class="op" id="2396506">(</span><span class="op" id="2396507">&amp;</span><span class="ident" id="2396508">tv</span><span class="op" id="2396510">[</span><span class="num" id="2396511">0</span><span class="op" id="2396512">]</span><span class="op" id="2396513">)</span><span class="op" id="2396514">)</span><span class="op" id="2396515">)</span><br>
<span class="lineno">65</span><span class="op" id="2396517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2396520">//sys&nbsp;&nbsp;&nbsp;&nbsputimensat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;times&nbsp;*[2]Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2396593">func</span>&nbsp;<span class="ident" id="2396598">UtimesNano</span><span class="op" id="2396608">(</span><span class="ident" id="2396609">path</span>&nbsp;<span class="builtintype" id="2396614">string</span><span class="op" id="2396620">,</span>&nbsp;<span class="ident" id="2396622">ts</span>&nbsp;<span class="op" id="2396625">[</span><span class="op" id="2396626">]</span><span class="ident" id="2396627">Timespec</span><span class="op" id="2396635">)</span>&nbsp;<span class="op" id="2396637">(</span><span class="ident" id="2396638">err</span>&nbsp;<span class="builtintype" id="2396642">error</span><span class="op" id="2396647">)</span>&nbsp;<span class="op" id="2396649">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396652">if</span>&nbsp;<span class="builtinfunc" id="2396655">len</span><span class="op" id="2396658">(</span><span class="ident" id="2396659">ts</span><span class="op" id="2396661">)</span>&nbsp;<span class="op" id="2396663">!=</span>&nbsp;<span class="num" id="2396666">2</span>&nbsp;<span class="op" id="2396668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396672">return</span>&nbsp;<span class="ident" id="2396679">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2396687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2396690">err</span>&nbsp;<span class="op" id="2396694">=</span>&nbsp;<span class="ident" id="2396696">utimensat</span><span class="op" id="2396705">(</span><span class="ident" id="2396706">_AT_FDCWD</span><span class="op" id="2396715">,</span>&nbsp;<span class="ident" id="2396717">path</span><span class="op" id="2396721">,</span>&nbsp;<span class="op" id="2396723">(</span><span class="op" id="2396724">*</span><span class="op" id="2396725">[</span><span class="num" id="2396726">2</span><span class="op" id="2396727">]</span><span class="ident" id="2396728">Timespec</span><span class="op" id="2396736">)</span><span class="op" id="2396737">(</span><span class="ident" id="2396738">unsafe</span><span class="op" id="2396744">.</span><span class="ident" id="2396745">Pointer</span><span class="op" id="2396752">(</span><span class="op" id="2396753">&amp;</span><span class="ident" id="2396754">ts</span><span class="op" id="2396756">[</span><span class="num" id="2396757">0</span><span class="op" id="2396758">]</span><span class="op" id="2396759">)</span><span class="op" id="2396760">)</span><span class="op" id="2396761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396764">if</span>&nbsp;<span class="ident" id="2396767">err</span>&nbsp;<span class="op" id="2396771">!=</span>&nbsp;<span class="ident" id="2396774">ENOSYS</span>&nbsp;<span class="op" id="2396781">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396785">return</span>&nbsp;<span class="ident" id="2396792">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2396797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2396800">//&nbsp;If&nbsp;the&nbsp;utimensat&nbsp;syscall&nbsp;isn&#39;t&nbsp;available&nbsp;(utimensat&nbsp;was&nbsp;added&nbsp;to&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2396875">//&nbsp;in&nbsp;2.6.22,&nbsp;Released,&nbsp;8&nbsp;July&nbsp;2007)&nbsp;then&nbsp;fall&nbsp;back&nbsp;to&nbsp;utimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396938">var</span>&nbsp;<span class="ident" id="2396942">tv</span>&nbsp;<span class="op" id="2396945">[</span><span class="num" id="2396946">2</span><span class="op" id="2396947">]</span><span class="ident" id="2396948">Timeval</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2396957">for</span>&nbsp;<span class="ident" id="2396961">i</span>&nbsp;<span class="op" id="2396963">:=</span>&nbsp;<span class="num" id="2396966">0</span><span class="op" id="2396967">;</span>&nbsp;<span class="ident" id="2396969">i</span>&nbsp;<span class="op" id="2396971">&lt;</span>&nbsp;<span class="num" id="2396973">2</span><span class="op" id="2396974">;</span>&nbsp;<span class="ident" id="2396976">i</span><span class="op" id="2396977">++</span>&nbsp;<span class="op" id="2396980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2396984">tv</span><span class="op" id="2396986">[</span><span class="ident" id="2396987">i</span><span class="op" id="2396988">]</span><span class="op" id="2396989">.</span><span class="ident" id="2396990">Sec</span>&nbsp;<span class="op" id="2396994">=</span>&nbsp;<span class="ident" id="2396996">ts</span><span class="op" id="2396998">[</span><span class="ident" id="2396999">i</span><span class="op" id="2397000">]</span><span class="op" id="2397001">.</span><span class="ident" id="2397002">Sec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2397008">tv</span><span class="op" id="2397010">[</span><span class="ident" id="2397011">i</span><span class="op" id="2397012">]</span><span class="op" id="2397013">.</span><span class="ident" id="2397014">Usec</span>&nbsp;<span class="op" id="2397019">=</span>&nbsp;<span class="ident" id="2397021">ts</span><span class="op" id="2397023">[</span><span class="ident" id="2397024">i</span><span class="op" id="2397025">]</span><span class="op" id="2397026">.</span><span class="ident" id="2397027">Nsec</span>&nbsp;<span class="op" id="2397032">/</span>&nbsp;<span class="num" id="2397034">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2397040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397043">return</span>&nbsp;<span class="ident" id="2397050">utimes</span><span class="op" id="2397056">(</span><span class="ident" id="2397057">path</span><span class="op" id="2397061">,</span>&nbsp;<span class="op" id="2397063">(</span><span class="op" id="2397064">*</span><span class="op" id="2397065">[</span><span class="num" id="2397066">2</span><span class="op" id="2397067">]</span><span class="ident" id="2397068">Timeval</span><span class="op" id="2397075">)</span><span class="op" id="2397076">(</span><span class="ident" id="2397077">unsafe</span><span class="op" id="2397083">.</span><span class="ident" id="2397084">Pointer</span><span class="op" id="2397091">(</span><span class="op" id="2397092">&amp;</span><span class="ident" id="2397093">tv</span><span class="op" id="2397095">[</span><span class="num" id="2397096">0</span><span class="op" id="2397097">]</span><span class="op" id="2397098">)</span><span class="op" id="2397099">)</span><span class="op" id="2397100">)</span><br>
<span class="lineno">85</span><span class="op" id="2397102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2397105">//sys&nbsp;&nbsp;&nbsp;&nbspfutimesat(dirfd&nbsp;int,&nbsp;path&nbsp;*byte,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2397176">func</span>&nbsp;<span class="ident" id="2397181">Futimesat</span><span class="op" id="2397190">(</span><span class="ident" id="2397191">dirfd</span>&nbsp;<span class="builtintype" id="2397197">int</span><span class="op" id="2397200">,</span>&nbsp;<span class="ident" id="2397202">path</span>&nbsp;<span class="builtintype" id="2397207">string</span><span class="op" id="2397213">,</span>&nbsp;<span class="ident" id="2397215">tv</span>&nbsp;<span class="op" id="2397218">[</span><span class="op" id="2397219">]</span><span class="ident" id="2397220">Timeval</span><span class="op" id="2397227">)</span>&nbsp;<span class="op" id="2397229">(</span><span class="ident" id="2397230">err</span>&nbsp;<span class="builtintype" id="2397234">error</span><span class="op" id="2397239">)</span>&nbsp;<span class="op" id="2397241">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397244">if</span>&nbsp;<span class="builtinfunc" id="2397247">len</span><span class="op" id="2397250">(</span><span class="ident" id="2397251">tv</span><span class="op" id="2397253">)</span>&nbsp;<span class="op" id="2397255">!=</span>&nbsp;<span class="num" id="2397258">2</span>&nbsp;<span class="op" id="2397260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397264">return</span>&nbsp;<span class="ident" id="2397271">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2397279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2397282">pathp</span><span class="op" id="2397287">,</span>&nbsp;<span class="ident" id="2397289">err</span>&nbsp;<span class="op" id="2397293">:=</span>&nbsp;<span class="ident" id="2397296">BytePtrFromString</span><span class="op" id="2397313">(</span><span class="ident" id="2397314">path</span><span class="op" id="2397318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397321">if</span>&nbsp;<span class="ident" id="2397324">err</span>&nbsp;<span class="op" id="2397328">!=</span>&nbsp;<span class="ident" id="2397331">nil</span>&nbsp;<span class="op" id="2397335">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397339">return</span>&nbsp;<span class="ident" id="2397346">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2397351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2397354">err</span>&nbsp;<span class="op" id="2397358">=</span>&nbsp;<span class="ident" id="2397360">futimesat</span><span class="op" id="2397369">(</span><span class="ident" id="2397370">dirfd</span><span class="op" id="2397375">,</span>&nbsp;<span class="ident" id="2397377">pathp</span><span class="op" id="2397382">,</span>&nbsp;<span class="op" id="2397384">(</span><span class="op" id="2397385">*</span><span class="op" id="2397386">[</span><span class="num" id="2397387">2</span><span class="op" id="2397388">]</span><span class="ident" id="2397389">Timeval</span><span class="op" id="2397396">)</span><span class="op" id="2397397">(</span><span class="ident" id="2397398">unsafe</span><span class="op" id="2397404">.</span><span class="ident" id="2397405">Pointer</span><span class="op" id="2397412">(</span><span class="op" id="2397413">&amp;</span><span class="ident" id="2397414">tv</span><span class="op" id="2397416">[</span><span class="num" id="2397417">0</span><span class="op" id="2397418">]</span><span class="op" id="2397419">)</span><span class="op" id="2397420">)</span><span class="op" id="2397421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2397424">use</span><span class="op" id="2397427">(</span><span class="ident" id="2397428">unsafe</span><span class="op" id="2397434">.</span><span class="ident" id="2397435">Pointer</span><span class="op" id="2397442">(</span><span class="ident" id="2397443">pathp</span><span class="op" id="2397448">)</span><span class="op" id="2397449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397452">return</span>&nbsp;<span class="ident" id="2397459">err</span><br>
<span class="lineno">100</span><span class="op" id="2397463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2397466">func</span>&nbsp;<span class="ident" id="2397471">Futimes</span><span class="op" id="2397478">(</span><span class="ident" id="2397479">fd</span>&nbsp;<span class="builtintype" id="2397482">int</span><span class="op" id="2397485">,</span>&nbsp;<span class="ident" id="2397487">tv</span>&nbsp;<span class="op" id="2397490">[</span><span class="op" id="2397491">]</span><span class="ident" id="2397492">Timeval</span><span class="op" id="2397499">)</span>&nbsp;<span class="op" id="2397501">(</span><span class="ident" id="2397502">err</span>&nbsp;<span class="builtintype" id="2397506">error</span><span class="op" id="2397511">)</span>&nbsp;<span class="op" id="2397513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2397516">//&nbsp;Believe&nbsp;it&nbsp;or&nbsp;not,&nbsp;this&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can&nbsp;do&nbsp;on&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2397575">//&nbsp;(and&nbsp;is&nbsp;what&nbsp;glibc&nbsp;does).</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397605">return</span>&nbsp;<span class="ident" id="2397612">Utimes</span><span class="op" id="2397618">(</span><span class="string" id="2397619">&#34;/proc/self/fd/&#34;</span><span class="op" id="2397635">+</span><span class="ident" id="2397636">itoa</span><span class="op" id="2397640">(</span><span class="ident" id="2397641">fd</span><span class="op" id="2397643">)</span><span class="op" id="2397644">,</span>&nbsp;<span class="ident" id="2397646">tv</span><span class="op" id="2397648">)</span><br>
<span class="lineno"></span><span class="op" id="2397650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2397653">const</span>&nbsp;<span class="ident" id="2397659">ImplementsGetwd</span>&nbsp;<span class="op" id="2397675">=</span>&nbsp;<span class="builtintype" id="2397677">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2397683">//sys&nbsp;&nbsp;&nbsp;&nbspGetcwd(buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2397728">func</span>&nbsp;<span class="ident" id="2397733">Getwd</span><span class="op" id="2397738">(</span><span class="op" id="2397739">)</span>&nbsp;<span class="op" id="2397741">(</span><span class="ident" id="2397742">wd</span>&nbsp;<span class="builtintype" id="2397745">string</span><span class="op" id="2397751">,</span>&nbsp;<span class="ident" id="2397753">err</span>&nbsp;<span class="builtintype" id="2397757">error</span><span class="op" id="2397762">)</span>&nbsp;<span class="op" id="2397764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397767">var</span>&nbsp;<span class="ident" id="2397771">buf</span>&nbsp;<span class="op" id="2397775">[</span><span class="ident" id="2397776">PathMax</span><span class="op" id="2397783">]</span><span class="builtintype" id="2397784">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2397790">n</span><span class="op" id="2397791">,</span>&nbsp;<span class="ident" id="2397793">err</span>&nbsp;<span class="op" id="2397797">:=</span>&nbsp;<span class="ident" id="2397800">Getcwd</span><span class="op" id="2397806">(</span><span class="ident" id="2397807">buf</span><span class="op" id="2397810">[</span><span class="num" id="2397811">0</span><span class="op" id="2397812">:</span><span class="op" id="2397813">]</span><span class="op" id="2397814">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397817">if</span>&nbsp;<span class="ident" id="2397820">err</span>&nbsp;<span class="op" id="2397824">!=</span>&nbsp;<span class="ident" id="2397827">nil</span>&nbsp;<span class="op" id="2397831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397835">return</span>&nbsp;<span class="string" id="2397842">&#34;&#34;</span><span class="op" id="2397844">,</span>&nbsp;<span class="ident" id="2397846">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2397851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2397854">//&nbsp;Getcwd&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;to&nbsp;buf,&nbsp;including&nbsp;the&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397928">if</span>&nbsp;<span class="ident" id="2397931">n</span>&nbsp;<span class="op" id="2397933">&lt;</span>&nbsp;<span class="num" id="2397935">1</span>&nbsp;<span class="op" id="2397937">||</span>&nbsp;<span class="ident" id="2397940">n</span>&nbsp;<span class="op" id="2397942">&gt;</span>&nbsp;<span class="builtinfunc" id="2397944">len</span><span class="op" id="2397947">(</span><span class="ident" id="2397948">buf</span><span class="op" id="2397951">)</span>&nbsp;<span class="op" id="2397953">||</span>&nbsp;<span class="ident" id="2397956">buf</span><span class="op" id="2397959">[</span><span class="ident" id="2397960">n</span><span class="op" id="2397961">-</span><span class="num" id="2397962">1</span><span class="op" id="2397963">]</span>&nbsp;<span class="op" id="2397965">!=</span>&nbsp;<span class="num" id="2397968">0</span>&nbsp;<span class="op" id="2397970">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397974">return</span>&nbsp;<span class="string" id="2397981">&#34;&#34;</span><span class="op" id="2397983">,</span>&nbsp;<span class="ident" id="2397985">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2397993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397996">return</span>&nbsp;<span class="builtintype" id="2398003">string</span><span class="op" id="2398009">(</span><span class="ident" id="2398010">buf</span><span class="op" id="2398013">[</span><span class="num" id="2398014">0</span>&nbsp;<span class="op" id="2398016">:</span>&nbsp;<span class="ident" id="2398018">n</span><span class="op" id="2398019">-</span><span class="num" id="2398020">1</span><span class="op" id="2398021">]</span><span class="op" id="2398022">)</span><span class="op" id="2398023">,</span>&nbsp;<span class="ident" id="2398025">nil</span><br>
<span class="lineno"></span><span class="op" id="2398029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2398032">func</span>&nbsp;<span class="ident" id="2398037">Getgroups</span><span class="op" id="2398046">(</span><span class="op" id="2398047">)</span>&nbsp;<span class="op" id="2398049">(</span><span class="ident" id="2398050">gids</span>&nbsp;<span class="op" id="2398055">[</span><span class="op" id="2398056">]</span><span class="builtintype" id="2398057">int</span><span class="op" id="2398060">,</span>&nbsp;<span class="ident" id="2398062">err</span>&nbsp;<span class="builtintype" id="2398066">error</span><span class="op" id="2398071">)</span>&nbsp;<span class="op" id="2398073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2398076">n</span><span class="op" id="2398077">,</span>&nbsp;<span class="ident" id="2398079">err</span>&nbsp;<span class="op" id="2398083">:=</span>&nbsp;<span class="ident" id="2398086">getgroups</span><span class="op" id="2398095">(</span><span class="num" id="2398096">0</span><span class="op" id="2398097">,</span>&nbsp;<span class="ident" id="2398099">nil</span><span class="op" id="2398102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398105">if</span>&nbsp;<span class="ident" id="2398108">err</span>&nbsp;<span class="op" id="2398112">!=</span>&nbsp;<span class="ident" id="2398115">nil</span>&nbsp;<span class="op" id="2398119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398123">return</span>&nbsp;<span class="ident" id="2398130">nil</span><span class="op" id="2398133">,</span>&nbsp;<span class="ident" id="2398135">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2398140">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398143">if</span>&nbsp;<span class="ident" id="2398146">n</span>&nbsp;<span class="op" id="2398148">==</span>&nbsp;<span class="num" id="2398151">0</span>&nbsp;<span class="op" id="2398153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398157">return</span>&nbsp;<span class="ident" id="2398164">nil</span><span class="op" id="2398167">,</span>&nbsp;<span class="ident" id="2398169">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2398174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2398178">//&nbsp;Sanity&nbsp;check&nbsp;group&nbsp;count.&nbsp;&nbsp;Max&nbsp;is&nbsp;1&lt;&lt;16&nbsp;on&nbsp;Linux.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398232">if</span>&nbsp;<span class="ident" id="2398235">n</span>&nbsp;<span class="op" id="2398237">&lt;</span>&nbsp;<span class="num" id="2398239">0</span>&nbsp;<span class="op" id="2398241">||</span>&nbsp;<span class="ident" id="2398244">n</span>&nbsp;<span class="op" id="2398246">&gt;</span>&nbsp;<span class="num" id="2398248">1</span><span class="op" id="2398249">&lt;&lt;</span><span class="num" id="2398251">20</span>&nbsp;<span class="op" id="2398254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398258">return</span>&nbsp;<span class="ident" id="2398265">nil</span><span class="op" id="2398268">,</span>&nbsp;<span class="ident" id="2398270">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2398278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2398282">a</span>&nbsp;<span class="op" id="2398284">:=</span>&nbsp;<span class="builtinfunc" id="2398287">make</span><span class="op" id="2398291">(</span><span class="op" id="2398292">[</span><span class="op" id="2398293">]</span><span class="ident" id="2398294">_Gid_t</span><span class="op" id="2398300">,</span>&nbsp;<span class="ident" id="2398302">n</span><span class="op" id="2398303">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2398306">n</span><span class="op" id="2398307">,</span>&nbsp;<span class="ident" id="2398309">err</span>&nbsp;<span class="op" id="2398313">=</span>&nbsp;<span class="ident" id="2398315">getgroups</span><span class="op" id="2398324">(</span><span class="ident" id="2398325">n</span><span class="op" id="2398326">,</span>&nbsp;<span class="op" id="2398328">&amp;</span><span class="ident" id="2398329">a</span><span class="op" id="2398330">[</span><span class="num" id="2398331">0</span><span class="op" id="2398332">]</span><span class="op" id="2398333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398336">if</span>&nbsp;<span class="ident" id="2398339">err</span>&nbsp;<span class="op" id="2398343">!=</span>&nbsp;<span class="ident" id="2398346">nil</span>&nbsp;<span class="op" id="2398350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398354">return</span>&nbsp;<span class="ident" id="2398361">nil</span><span class="op" id="2398364">,</span>&nbsp;<span class="ident" id="2398366">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2398371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2398374">gids</span>&nbsp;<span class="op" id="2398379">=</span>&nbsp;<span class="builtinfunc" id="2398381">make</span><span class="op" id="2398385">(</span><span class="op" id="2398386">[</span><span class="op" id="2398387">]</span><span class="builtintype" id="2398388">int</span><span class="op" id="2398391">,</span>&nbsp;<span class="ident" id="2398393">n</span><span class="op" id="2398394">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398397">for</span>&nbsp;<span class="ident" id="2398401">i</span><span class="op" id="2398402">,</span>&nbsp;<span class="ident" id="2398404">v</span>&nbsp;<span class="op" id="2398406">:=</span>&nbsp;<span class="keyword" id="2398409">range</span>&nbsp;<span class="ident" id="2398415">a</span><span class="op" id="2398416">[</span><span class="num" id="2398417">0</span><span class="op" id="2398418">:</span><span class="ident" id="2398419">n</span><span class="op" id="2398420">]</span>&nbsp;<span class="op" id="2398422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2398426">gids</span><span class="op" id="2398430">[</span><span class="ident" id="2398431">i</span><span class="op" id="2398432">]</span>&nbsp;<span class="op" id="2398434">=</span>&nbsp;<span class="builtintype" id="2398436">int</span><span class="op" id="2398439">(</span><span class="ident" id="2398440">v</span><span class="op" id="2398441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2398444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398447">return</span><br>
<span class="lineno"></span><span class="op" id="2398454">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="2398457">func</span>&nbsp;<span class="ident" id="2398462">Setgroups</span><span class="op" id="2398471">(</span><span class="ident" id="2398472">gids</span>&nbsp;<span class="op" id="2398477">[</span><span class="op" id="2398478">]</span><span class="builtintype" id="2398479">int</span><span class="op" id="2398482">)</span>&nbsp;<span class="op" id="2398484">(</span><span class="ident" id="2398485">err</span>&nbsp;<span class="builtintype" id="2398489">error</span><span class="op" id="2398494">)</span>&nbsp;<span class="op" id="2398496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398499">if</span>&nbsp;<span class="builtinfunc" id="2398502">len</span><span class="op" id="2398505">(</span><span class="ident" id="2398506">gids</span><span class="op" id="2398510">)</span>&nbsp;<span class="op" id="2398512">==</span>&nbsp;<span class="num" id="2398515">0</span>&nbsp;<span class="op" id="2398517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398521">return</span>&nbsp;<span class="ident" id="2398528">setgroups</span><span class="op" id="2398537">(</span><span class="num" id="2398538">0</span><span class="op" id="2398539">,</span>&nbsp;<span class="ident" id="2398541">nil</span><span class="op" id="2398544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2398547">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2398551">a</span>&nbsp;<span class="op" id="2398553">:=</span>&nbsp;<span class="builtinfunc" id="2398556">make</span><span class="op" id="2398560">(</span><span class="op" id="2398561">[</span><span class="op" id="2398562">]</span><span class="ident" id="2398563">_Gid_t</span><span class="op" id="2398569">,</span>&nbsp;<span class="builtinfunc" id="2398571">len</span><span class="op" id="2398574">(</span><span class="ident" id="2398575">gids</span><span class="op" id="2398579">)</span><span class="op" id="2398580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398583">for</span>&nbsp;<span class="ident" id="2398587">i</span><span class="op" id="2398588">,</span>&nbsp;<span class="ident" id="2398590">v</span>&nbsp;<span class="op" id="2398592">:=</span>&nbsp;<span class="keyword" id="2398595">range</span>&nbsp;<span class="ident" id="2398601">gids</span>&nbsp;<span class="op" id="2398606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2398610">a</span><span class="op" id="2398611">[</span><span class="ident" id="2398612">i</span><span class="op" id="2398613">]</span>&nbsp;<span class="op" id="2398615">=</span>&nbsp;<span class="ident" id="2398617">_Gid_t</span><span class="op" id="2398623">(</span><span class="ident" id="2398624">v</span><span class="op" id="2398625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2398628">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398631">return</span>&nbsp;<span class="ident" id="2398638">setgroups</span><span class="op" id="2398647">(</span><span class="builtinfunc" id="2398648">len</span><span class="op" id="2398651">(</span><span class="ident" id="2398652">a</span><span class="op" id="2398653">)</span><span class="op" id="2398654">,</span>&nbsp;<span class="op" id="2398656">&amp;</span><span class="ident" id="2398657">a</span><span class="op" id="2398658">[</span><span class="num" id="2398659">0</span><span class="op" id="2398660">]</span><span class="op" id="2398661">)</span><br>
<span class="lineno"></span><span class="op" id="2398663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2398666">type</span>&nbsp;<span class="ident" id="2398671">WaitStatus</span>&nbsp;<span class="builtintype" id="2398682">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2398690">//&nbsp;Wait&nbsp;status&nbsp;is&nbsp;7&nbsp;bits&nbsp;at&nbsp;bottom,&nbsp;either&nbsp;0&nbsp;(exited),</span><br>
<span class="lineno"></span><span class="comment" id="2398745">//&nbsp;0x7F&nbsp;(stopped),&nbsp;or&nbsp;a&nbsp;signal&nbsp;number&nbsp;that&nbsp;caused&nbsp;an&nbsp;exit.</span><br>
<span class="lineno"></span><span class="comment" id="2398804">//&nbsp;The&nbsp;0x80&nbsp;bit&nbsp;is&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;core&nbsp;dump.</span><br>
<span class="lineno"></span><span class="comment" id="2398854">//&nbsp;An&nbsp;extra&nbsp;number&nbsp;(exit&nbsp;code,&nbsp;signal&nbsp;causing&nbsp;a&nbsp;stop)</span><br>
<span class="lineno"></span><span class="comment" id="2398908">//&nbsp;is&nbsp;in&nbsp;the&nbsp;high&nbsp;bits.&nbsp;&nbsp;At&nbsp;least&nbsp;that&#39;s&nbsp;the&nbsp;idea.</span><br>
<span class="lineno">170</span><span class="comment" id="2398959">//&nbsp;There&nbsp;are&nbsp;various&nbsp;irregularities.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2399014">//&nbsp;&#34;continued&#34;&nbsp;status&nbsp;is&nbsp;0xFFFF,&nbsp;distinguishing&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="2399069">//&nbsp;from&nbsp;stopped&nbsp;via&nbsp;the&nbsp;core&nbsp;dump&nbsp;bit.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2399109">const</span>&nbsp;<span class="op" id="2399115">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2399118">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2399126">=</span>&nbsp;<span class="num" id="2399128">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2399134">core</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2399142">=</span>&nbsp;<span class="num" id="2399144">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2399150">exited</span>&nbsp;&nbsp;<span class="op" id="2399158">=</span>&nbsp;<span class="num" id="2399160">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2399166">stopped</span>&nbsp;<span class="op" id="2399174">=</span>&nbsp;<span class="num" id="2399176">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2399182">shift</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2399190">=</span>&nbsp;<span class="num" id="2399192">8</span><br>
<span class="lineno">180</span><span class="op" id="2399194">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2399197">func</span>&nbsp;<span class="op" id="2399202">(</span><span class="ident" id="2399203">w</span>&nbsp;<span class="ident" id="2399205">WaitStatus</span><span class="op" id="2399215">)</span>&nbsp;<span class="ident" id="2399217">Exited</span><span class="op" id="2399223">(</span><span class="op" id="2399224">)</span>&nbsp;<span class="builtintype" id="2399226">bool</span>&nbsp;<span class="op" id="2399231">{</span>&nbsp;<span class="keyword" id="2399233">return</span>&nbsp;<span class="ident" id="2399240">w</span><span class="op" id="2399241">&amp;</span><span class="ident" id="2399242">mask</span>&nbsp;<span class="op" id="2399247">==</span>&nbsp;<span class="ident" id="2399250">exited</span>&nbsp;<span class="op" id="2399257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2399260">func</span>&nbsp;<span class="op" id="2399265">(</span><span class="ident" id="2399266">w</span>&nbsp;<span class="ident" id="2399268">WaitStatus</span><span class="op" id="2399278">)</span>&nbsp;<span class="ident" id="2399280">Signaled</span><span class="op" id="2399288">(</span><span class="op" id="2399289">)</span>&nbsp;<span class="builtintype" id="2399291">bool</span>&nbsp;<span class="op" id="2399296">{</span>&nbsp;<span class="keyword" id="2399298">return</span>&nbsp;<span class="ident" id="2399305">w</span><span class="op" id="2399306">&amp;</span><span class="ident" id="2399307">mask</span>&nbsp;<span class="op" id="2399312">!=</span>&nbsp;<span class="ident" id="2399315">stopped</span>&nbsp;<span class="op" id="2399323">&amp;&amp;</span>&nbsp;<span class="ident" id="2399326">w</span><span class="op" id="2399327">&amp;</span><span class="ident" id="2399328">mask</span>&nbsp;<span class="op" id="2399333">!=</span>&nbsp;<span class="ident" id="2399336">exited</span>&nbsp;<span class="op" id="2399343">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="2399346">func</span>&nbsp;<span class="op" id="2399351">(</span><span class="ident" id="2399352">w</span>&nbsp;<span class="ident" id="2399354">WaitStatus</span><span class="op" id="2399364">)</span>&nbsp;<span class="ident" id="2399366">Stopped</span><span class="op" id="2399373">(</span><span class="op" id="2399374">)</span>&nbsp;<span class="builtintype" id="2399376">bool</span>&nbsp;<span class="op" id="2399381">{</span>&nbsp;<span class="keyword" id="2399383">return</span>&nbsp;<span class="ident" id="2399390">w</span><span class="op" id="2399391">&amp;</span><span class="num" id="2399392">0xFF</span>&nbsp;<span class="op" id="2399397">==</span>&nbsp;<span class="ident" id="2399400">stopped</span>&nbsp;<span class="op" id="2399408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2399411">func</span>&nbsp;<span class="op" id="2399416">(</span><span class="ident" id="2399417">w</span>&nbsp;<span class="ident" id="2399419">WaitStatus</span><span class="op" id="2399429">)</span>&nbsp;<span class="ident" id="2399431">Continued</span><span class="op" id="2399440">(</span><span class="op" id="2399441">)</span>&nbsp;<span class="builtintype" id="2399443">bool</span>&nbsp;<span class="op" id="2399448">{</span>&nbsp;<span class="keyword" id="2399450">return</span>&nbsp;<span class="ident" id="2399457">w</span>&nbsp;<span class="op" id="2399459">==</span>&nbsp;<span class="num" id="2399462">0xFFFF</span>&nbsp;<span class="op" id="2399469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2399472">func</span>&nbsp;<span class="op" id="2399477">(</span><span class="ident" id="2399478">w</span>&nbsp;<span class="ident" id="2399480">WaitStatus</span><span class="op" id="2399490">)</span>&nbsp;<span class="ident" id="2399492">CoreDump</span><span class="op" id="2399500">(</span><span class="op" id="2399501">)</span>&nbsp;<span class="builtintype" id="2399503">bool</span>&nbsp;<span class="op" id="2399508">{</span>&nbsp;<span class="keyword" id="2399510">return</span>&nbsp;<span class="ident" id="2399517">w</span><span class="op" id="2399518">.</span><span class="ident" id="2399519">Signaled</span><span class="op" id="2399527">(</span><span class="op" id="2399528">)</span>&nbsp;<span class="op" id="2399530">&amp;&amp;</span>&nbsp;<span class="ident" id="2399533">w</span><span class="op" id="2399534">&amp;</span><span class="ident" id="2399535">core</span>&nbsp;<span class="op" id="2399540">!=</span>&nbsp;<span class="num" id="2399543">0</span>&nbsp;<span class="op" id="2399545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2399548">func</span>&nbsp;<span class="op" id="2399553">(</span><span class="ident" id="2399554">w</span>&nbsp;<span class="ident" id="2399556">WaitStatus</span><span class="op" id="2399566">)</span>&nbsp;<span class="ident" id="2399568">ExitStatus</span><span class="op" id="2399578">(</span><span class="op" id="2399579">)</span>&nbsp;<span class="builtintype" id="2399581">int</span>&nbsp;<span class="op" id="2399585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399588">if</span>&nbsp;<span class="op" id="2399591">!</span><span class="ident" id="2399592">w</span><span class="op" id="2399593">.</span><span class="ident" id="2399594">Exited</span><span class="op" id="2399600">(</span><span class="op" id="2399601">)</span>&nbsp;<span class="op" id="2399603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399607">return</span>&nbsp;<span class="op" id="2399614">-</span><span class="num" id="2399615">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2399618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399621">return</span>&nbsp;<span class="builtintype" id="2399628">int</span><span class="op" id="2399631">(</span><span class="ident" id="2399632">w</span><span class="op" id="2399633">&gt;&gt;</span><span class="ident" id="2399635">shift</span><span class="op" id="2399640">)</span>&nbsp;<span class="op" id="2399642">&amp;</span>&nbsp;<span class="num" id="2399644">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2399649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2399652">func</span>&nbsp;<span class="op" id="2399657">(</span><span class="ident" id="2399658">w</span>&nbsp;<span class="ident" id="2399660">WaitStatus</span><span class="op" id="2399670">)</span>&nbsp;<span class="ident" id="2399672">Signal</span><span class="op" id="2399678">(</span><span class="op" id="2399679">)</span>&nbsp;<span class="ident" id="2399681">Signal</span>&nbsp;<span class="op" id="2399688">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399691">if</span>&nbsp;<span class="op" id="2399694">!</span><span class="ident" id="2399695">w</span><span class="op" id="2399696">.</span><span class="ident" id="2399697">Signaled</span><span class="op" id="2399705">(</span><span class="op" id="2399706">)</span>&nbsp;<span class="op" id="2399708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399712">return</span>&nbsp;<span class="op" id="2399719">-</span><span class="num" id="2399720">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2399723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399726">return</span>&nbsp;<span class="ident" id="2399733">Signal</span><span class="op" id="2399739">(</span><span class="ident" id="2399740">w</span>&nbsp;<span class="op" id="2399742">&amp;</span>&nbsp;<span class="ident" id="2399744">mask</span><span class="op" id="2399748">)</span><br>
<span class="lineno"></span><span class="op" id="2399750">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2399753">func</span>&nbsp;<span class="op" id="2399758">(</span><span class="ident" id="2399759">w</span>&nbsp;<span class="ident" id="2399761">WaitStatus</span><span class="op" id="2399771">)</span>&nbsp;<span class="ident" id="2399773">StopSignal</span><span class="op" id="2399783">(</span><span class="op" id="2399784">)</span>&nbsp;<span class="ident" id="2399786">Signal</span>&nbsp;<span class="op" id="2399793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399796">if</span>&nbsp;<span class="op" id="2399799">!</span><span class="ident" id="2399800">w</span><span class="op" id="2399801">.</span><span class="ident" id="2399802">Stopped</span><span class="op" id="2399809">(</span><span class="op" id="2399810">)</span>&nbsp;<span class="op" id="2399812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399816">return</span>&nbsp;<span class="op" id="2399823">-</span><span class="num" id="2399824">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2399827">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399830">return</span>&nbsp;<span class="ident" id="2399837">Signal</span><span class="op" id="2399843">(</span><span class="ident" id="2399844">w</span><span class="op" id="2399845">&gt;&gt;</span><span class="ident" id="2399847">shift</span><span class="op" id="2399852">)</span>&nbsp;<span class="op" id="2399854">&amp;</span>&nbsp;<span class="num" id="2399856">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2399861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2399864">func</span>&nbsp;<span class="op" id="2399869">(</span><span class="ident" id="2399870">w</span>&nbsp;<span class="ident" id="2399872">WaitStatus</span><span class="op" id="2399882">)</span>&nbsp;<span class="ident" id="2399884">TrapCause</span><span class="op" id="2399893">(</span><span class="op" id="2399894">)</span>&nbsp;<span class="builtintype" id="2399896">int</span>&nbsp;<span class="op" id="2399900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399903">if</span>&nbsp;<span class="ident" id="2399906">w</span><span class="op" id="2399907">.</span><span class="ident" id="2399908">StopSignal</span><span class="op" id="2399918">(</span><span class="op" id="2399919">)</span>&nbsp;<span class="op" id="2399921">!=</span>&nbsp;<span class="ident" id="2399924">SIGTRAP</span>&nbsp;<span class="op" id="2399932">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399936">return</span>&nbsp;<span class="op" id="2399943">-</span><span class="num" id="2399944">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2399947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399950">return</span>&nbsp;<span class="builtintype" id="2399957">int</span><span class="op" id="2399960">(</span><span class="ident" id="2399961">w</span><span class="op" id="2399962">&gt;&gt;</span><span class="ident" id="2399964">shift</span><span class="op" id="2399969">)</span>&nbsp;<span class="op" id="2399971">&gt;&gt;</span>&nbsp;<span class="num" id="2399974">8</span><br>
<span class="lineno"></span><span class="op" id="2399976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2399979">//sys&nbsp;&nbsp;&nbsp;&nbspwait4(pid&nbsp;int,&nbsp;wstatus&nbsp;*_C_int,&nbsp;options&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(wpid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2400069">func</span>&nbsp;<span class="ident" id="2400074">Wait4</span><span class="op" id="2400079">(</span><span class="ident" id="2400080">pid</span>&nbsp;<span class="builtintype" id="2400084">int</span><span class="op" id="2400087">,</span>&nbsp;<span class="ident" id="2400089">wstatus</span>&nbsp;<span class="op" id="2400097">*</span><span class="ident" id="2400098">WaitStatus</span><span class="op" id="2400108">,</span>&nbsp;<span class="ident" id="2400110">options</span>&nbsp;<span class="builtintype" id="2400118">int</span><span class="op" id="2400121">,</span>&nbsp;<span class="ident" id="2400123">rusage</span>&nbsp;<span class="op" id="2400130">*</span><span class="ident" id="2400131">Rusage</span><span class="op" id="2400137">)</span>&nbsp;<span class="op" id="2400139">(</span><span class="ident" id="2400140">wpid</span>&nbsp;<span class="builtintype" id="2400145">int</span><span class="op" id="2400148">,</span>&nbsp;<span class="ident" id="2400150">err</span>&nbsp;<span class="builtintype" id="2400154">error</span><span class="op" id="2400159">)</span>&nbsp;<span class="op" id="2400161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400164">var</span>&nbsp;<span class="ident" id="2400168">status</span>&nbsp;<span class="ident" id="2400175">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400183">wpid</span><span class="op" id="2400187">,</span>&nbsp;<span class="ident" id="2400189">err</span>&nbsp;<span class="op" id="2400193">=</span>&nbsp;<span class="ident" id="2400195">wait4</span><span class="op" id="2400200">(</span><span class="ident" id="2400201">pid</span><span class="op" id="2400204">,</span>&nbsp;<span class="op" id="2400206">&amp;</span><span class="ident" id="2400207">status</span><span class="op" id="2400213">,</span>&nbsp;<span class="ident" id="2400215">options</span><span class="op" id="2400222">,</span>&nbsp;<span class="ident" id="2400224">rusage</span><span class="op" id="2400230">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400233">if</span>&nbsp;<span class="ident" id="2400236">wstatus</span>&nbsp;<span class="op" id="2400244">!=</span>&nbsp;<span class="ident" id="2400247">nil</span>&nbsp;<span class="op" id="2400251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2400255">*</span><span class="ident" id="2400256">wstatus</span>&nbsp;<span class="op" id="2400264">=</span>&nbsp;<span class="ident" id="2400266">WaitStatus</span><span class="op" id="2400276">(</span><span class="ident" id="2400277">status</span><span class="op" id="2400283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2400286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400289">return</span><br>
<span class="lineno"></span><span class="op" id="2400296">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2400299">func</span>&nbsp;<span class="ident" id="2400304">Mkfifo</span><span class="op" id="2400310">(</span><span class="ident" id="2400311">path</span>&nbsp;<span class="builtintype" id="2400316">string</span><span class="op" id="2400322">,</span>&nbsp;<span class="ident" id="2400324">mode</span>&nbsp;<span class="builtintype" id="2400329">uint32</span><span class="op" id="2400335">)</span>&nbsp;<span class="op" id="2400337">(</span><span class="ident" id="2400338">err</span>&nbsp;<span class="builtintype" id="2400342">error</span><span class="op" id="2400347">)</span>&nbsp;<span class="op" id="2400349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400352">return</span>&nbsp;<span class="ident" id="2400359">Mknod</span><span class="op" id="2400364">(</span><span class="ident" id="2400365">path</span><span class="op" id="2400369">,</span>&nbsp;<span class="ident" id="2400371">mode</span><span class="op" id="2400375">|</span><span class="ident" id="2400376">S_IFIFO</span><span class="op" id="2400383">,</span>&nbsp;<span class="num" id="2400385">0</span><span class="op" id="2400386">)</span><br>
<span class="lineno"></span><span class="op" id="2400388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2400391">func</span>&nbsp;<span class="op" id="2400396">(</span><span class="ident" id="2400397">sa</span>&nbsp;<span class="op" id="2400400">*</span><span class="ident" id="2400401">SockaddrInet4</span><span class="op" id="2400414">)</span>&nbsp;<span class="ident" id="2400416">sockaddr</span><span class="op" id="2400424">(</span><span class="op" id="2400425">)</span>&nbsp;<span class="op" id="2400427">(</span><span class="ident" id="2400428">unsafe</span><span class="op" id="2400434">.</span><span class="ident" id="2400435">Pointer</span><span class="op" id="2400442">,</span>&nbsp;<span class="ident" id="2400444">_Socklen</span><span class="op" id="2400452">,</span>&nbsp;<span class="builtintype" id="2400454">error</span><span class="op" id="2400459">)</span>&nbsp;<span class="op" id="2400461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400464">if</span>&nbsp;<span class="ident" id="2400467">sa</span><span class="op" id="2400469">.</span><span class="ident" id="2400470">Port</span>&nbsp;<span class="op" id="2400475">&lt;</span>&nbsp;<span class="num" id="2400477">0</span>&nbsp;<span class="op" id="2400479">||</span>&nbsp;<span class="ident" id="2400482">sa</span><span class="op" id="2400484">.</span><span class="ident" id="2400485">Port</span>&nbsp;<span class="op" id="2400490">&gt;</span>&nbsp;<span class="num" id="2400492">0xFFFF</span>&nbsp;<span class="op" id="2400499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400503">return</span>&nbsp;<span class="ident" id="2400510">nil</span><span class="op" id="2400513">,</span>&nbsp;<span class="num" id="2400515">0</span><span class="op" id="2400516">,</span>&nbsp;<span class="ident" id="2400518">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2400526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400529">sa</span><span class="op" id="2400531">.</span><span class="ident" id="2400532">raw</span><span class="op" id="2400535">.</span><span class="ident" id="2400536">Family</span>&nbsp;<span class="op" id="2400543">=</span>&nbsp;<span class="ident" id="2400545">AF_INET</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400554">p</span>&nbsp;<span class="op" id="2400556">:=</span>&nbsp;<span class="op" id="2400559">(</span><span class="op" id="2400560">*</span><span class="op" id="2400561">[</span><span class="num" id="2400562">2</span><span class="op" id="2400563">]</span><span class="builtintype" id="2400564">byte</span><span class="op" id="2400568">)</span><span class="op" id="2400569">(</span><span class="ident" id="2400570">unsafe</span><span class="op" id="2400576">.</span><span class="ident" id="2400577">Pointer</span><span class="op" id="2400584">(</span><span class="op" id="2400585">&amp;</span><span class="ident" id="2400586">sa</span><span class="op" id="2400588">.</span><span class="ident" id="2400589">raw</span><span class="op" id="2400592">.</span><span class="ident" id="2400593">Port</span><span class="op" id="2400597">)</span><span class="op" id="2400598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400601">p</span><span class="op" id="2400602">[</span><span class="num" id="2400603">0</span><span class="op" id="2400604">]</span>&nbsp;<span class="op" id="2400606">=</span>&nbsp;<span class="builtintype" id="2400608">byte</span><span class="op" id="2400612">(</span><span class="ident" id="2400613">sa</span><span class="op" id="2400615">.</span><span class="ident" id="2400616">Port</span>&nbsp;<span class="op" id="2400621">&gt;&gt;</span>&nbsp;<span class="num" id="2400624">8</span><span class="op" id="2400625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400628">p</span><span class="op" id="2400629">[</span><span class="num" id="2400630">1</span><span class="op" id="2400631">]</span>&nbsp;<span class="op" id="2400633">=</span>&nbsp;<span class="builtintype" id="2400635">byte</span><span class="op" id="2400639">(</span><span class="ident" id="2400640">sa</span><span class="op" id="2400642">.</span><span class="ident" id="2400643">Port</span><span class="op" id="2400647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400650">for</span>&nbsp;<span class="ident" id="2400654">i</span>&nbsp;<span class="op" id="2400656">:=</span>&nbsp;<span class="num" id="2400659">0</span><span class="op" id="2400660">;</span>&nbsp;<span class="ident" id="2400662">i</span>&nbsp;<span class="op" id="2400664">&lt;</span>&nbsp;<span class="builtinfunc" id="2400666">len</span><span class="op" id="2400669">(</span><span class="ident" id="2400670">sa</span><span class="op" id="2400672">.</span><span class="ident" id="2400673">Addr</span><span class="op" id="2400677">)</span><span class="op" id="2400678">;</span>&nbsp;<span class="ident" id="2400680">i</span><span class="op" id="2400681">++</span>&nbsp;<span class="op" id="2400684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400688">sa</span><span class="op" id="2400690">.</span><span class="ident" id="2400691">raw</span><span class="op" id="2400694">.</span><span class="ident" id="2400695">Addr</span><span class="op" id="2400699">[</span><span class="ident" id="2400700">i</span><span class="op" id="2400701">]</span>&nbsp;<span class="op" id="2400703">=</span>&nbsp;<span class="ident" id="2400705">sa</span><span class="op" id="2400707">.</span><span class="ident" id="2400708">Addr</span><span class="op" id="2400712">[</span><span class="ident" id="2400713">i</span><span class="op" id="2400714">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2400717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400720">return</span>&nbsp;<span class="ident" id="2400727">unsafe</span><span class="op" id="2400733">.</span><span class="ident" id="2400734">Pointer</span><span class="op" id="2400741">(</span><span class="op" id="2400742">&amp;</span><span class="ident" id="2400743">sa</span><span class="op" id="2400745">.</span><span class="ident" id="2400746">raw</span><span class="op" id="2400749">)</span><span class="op" id="2400750">,</span>&nbsp;<span class="ident" id="2400752">SizeofSockaddrInet4</span><span class="op" id="2400771">,</span>&nbsp;<span class="ident" id="2400773">nil</span><br>
<span class="lineno"></span><span class="op" id="2400777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2400780">func</span>&nbsp;<span class="op" id="2400785">(</span><span class="ident" id="2400786">sa</span>&nbsp;<span class="op" id="2400789">*</span><span class="ident" id="2400790">SockaddrInet6</span><span class="op" id="2400803">)</span>&nbsp;<span class="ident" id="2400805">sockaddr</span><span class="op" id="2400813">(</span><span class="op" id="2400814">)</span>&nbsp;<span class="op" id="2400816">(</span><span class="ident" id="2400817">unsafe</span><span class="op" id="2400823">.</span><span class="ident" id="2400824">Pointer</span><span class="op" id="2400831">,</span>&nbsp;<span class="ident" id="2400833">_Socklen</span><span class="op" id="2400841">,</span>&nbsp;<span class="builtintype" id="2400843">error</span><span class="op" id="2400848">)</span>&nbsp;<span class="op" id="2400850">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400853">if</span>&nbsp;<span class="ident" id="2400856">sa</span><span class="op" id="2400858">.</span><span class="ident" id="2400859">Port</span>&nbsp;<span class="op" id="2400864">&lt;</span>&nbsp;<span class="num" id="2400866">0</span>&nbsp;<span class="op" id="2400868">||</span>&nbsp;<span class="ident" id="2400871">sa</span><span class="op" id="2400873">.</span><span class="ident" id="2400874">Port</span>&nbsp;<span class="op" id="2400879">&gt;</span>&nbsp;<span class="num" id="2400881">0xFFFF</span>&nbsp;<span class="op" id="2400888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400892">return</span>&nbsp;<span class="ident" id="2400899">nil</span><span class="op" id="2400902">,</span>&nbsp;<span class="num" id="2400904">0</span><span class="op" id="2400905">,</span>&nbsp;<span class="ident" id="2400907">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2400915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400918">sa</span><span class="op" id="2400920">.</span><span class="ident" id="2400921">raw</span><span class="op" id="2400924">.</span><span class="ident" id="2400925">Family</span>&nbsp;<span class="op" id="2400932">=</span>&nbsp;<span class="ident" id="2400934">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400944">p</span>&nbsp;<span class="op" id="2400946">:=</span>&nbsp;<span class="op" id="2400949">(</span><span class="op" id="2400950">*</span><span class="op" id="2400951">[</span><span class="num" id="2400952">2</span><span class="op" id="2400953">]</span><span class="builtintype" id="2400954">byte</span><span class="op" id="2400958">)</span><span class="op" id="2400959">(</span><span class="ident" id="2400960">unsafe</span><span class="op" id="2400966">.</span><span class="ident" id="2400967">Pointer</span><span class="op" id="2400974">(</span><span class="op" id="2400975">&amp;</span><span class="ident" id="2400976">sa</span><span class="op" id="2400978">.</span><span class="ident" id="2400979">raw</span><span class="op" id="2400982">.</span><span class="ident" id="2400983">Port</span><span class="op" id="2400987">)</span><span class="op" id="2400988">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400991">p</span><span class="op" id="2400992">[</span><span class="num" id="2400993">0</span><span class="op" id="2400994">]</span>&nbsp;<span class="op" id="2400996">=</span>&nbsp;<span class="builtintype" id="2400998">byte</span><span class="op" id="2401002">(</span><span class="ident" id="2401003">sa</span><span class="op" id="2401005">.</span><span class="ident" id="2401006">Port</span>&nbsp;<span class="op" id="2401011">&gt;&gt;</span>&nbsp;<span class="num" id="2401014">8</span><span class="op" id="2401015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401018">p</span><span class="op" id="2401019">[</span><span class="num" id="2401020">1</span><span class="op" id="2401021">]</span>&nbsp;<span class="op" id="2401023">=</span>&nbsp;<span class="builtintype" id="2401025">byte</span><span class="op" id="2401029">(</span><span class="ident" id="2401030">sa</span><span class="op" id="2401032">.</span><span class="ident" id="2401033">Port</span><span class="op" id="2401037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401040">sa</span><span class="op" id="2401042">.</span><span class="ident" id="2401043">raw</span><span class="op" id="2401046">.</span><span class="ident" id="2401047">Scope_id</span>&nbsp;<span class="op" id="2401056">=</span>&nbsp;<span class="ident" id="2401058">sa</span><span class="op" id="2401060">.</span><span class="ident" id="2401061">ZoneId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401069">for</span>&nbsp;<span class="ident" id="2401073">i</span>&nbsp;<span class="op" id="2401075">:=</span>&nbsp;<span class="num" id="2401078">0</span><span class="op" id="2401079">;</span>&nbsp;<span class="ident" id="2401081">i</span>&nbsp;<span class="op" id="2401083">&lt;</span>&nbsp;<span class="builtinfunc" id="2401085">len</span><span class="op" id="2401088">(</span><span class="ident" id="2401089">sa</span><span class="op" id="2401091">.</span><span class="ident" id="2401092">Addr</span><span class="op" id="2401096">)</span><span class="op" id="2401097">;</span>&nbsp;<span class="ident" id="2401099">i</span><span class="op" id="2401100">++</span>&nbsp;<span class="op" id="2401103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401107">sa</span><span class="op" id="2401109">.</span><span class="ident" id="2401110">raw</span><span class="op" id="2401113">.</span><span class="ident" id="2401114">Addr</span><span class="op" id="2401118">[</span><span class="ident" id="2401119">i</span><span class="op" id="2401120">]</span>&nbsp;<span class="op" id="2401122">=</span>&nbsp;<span class="ident" id="2401124">sa</span><span class="op" id="2401126">.</span><span class="ident" id="2401127">Addr</span><span class="op" id="2401131">[</span><span class="ident" id="2401132">i</span><span class="op" id="2401133">]</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2401136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401139">return</span>&nbsp;<span class="ident" id="2401146">unsafe</span><span class="op" id="2401152">.</span><span class="ident" id="2401153">Pointer</span><span class="op" id="2401160">(</span><span class="op" id="2401161">&amp;</span><span class="ident" id="2401162">sa</span><span class="op" id="2401164">.</span><span class="ident" id="2401165">raw</span><span class="op" id="2401168">)</span><span class="op" id="2401169">,</span>&nbsp;<span class="ident" id="2401171">SizeofSockaddrInet6</span><span class="op" id="2401190">,</span>&nbsp;<span class="ident" id="2401192">nil</span><br>
<span class="lineno"></span><span class="op" id="2401196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2401199">func</span>&nbsp;<span class="op" id="2401204">(</span><span class="ident" id="2401205">sa</span>&nbsp;<span class="op" id="2401208">*</span><span class="ident" id="2401209">SockaddrUnix</span><span class="op" id="2401221">)</span>&nbsp;<span class="ident" id="2401223">sockaddr</span><span class="op" id="2401231">(</span><span class="op" id="2401232">)</span>&nbsp;<span class="op" id="2401234">(</span><span class="ident" id="2401235">unsafe</span><span class="op" id="2401241">.</span><span class="ident" id="2401242">Pointer</span><span class="op" id="2401249">,</span>&nbsp;<span class="ident" id="2401251">_Socklen</span><span class="op" id="2401259">,</span>&nbsp;<span class="builtintype" id="2401261">error</span><span class="op" id="2401266">)</span>&nbsp;<span class="op" id="2401268">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401271">name</span>&nbsp;<span class="op" id="2401276">:=</span>&nbsp;<span class="ident" id="2401279">sa</span><span class="op" id="2401281">.</span><span class="ident" id="2401282">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401288">n</span>&nbsp;<span class="op" id="2401290">:=</span>&nbsp;<span class="builtinfunc" id="2401293">len</span><span class="op" id="2401296">(</span><span class="ident" id="2401297">name</span><span class="op" id="2401301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401304">if</span>&nbsp;<span class="ident" id="2401307">n</span>&nbsp;<span class="op" id="2401309">&gt;=</span>&nbsp;<span class="builtinfunc" id="2401312">len</span><span class="op" id="2401315">(</span><span class="ident" id="2401316">sa</span><span class="op" id="2401318">.</span><span class="ident" id="2401319">raw</span><span class="op" id="2401322">.</span><span class="ident" id="2401323">Path</span><span class="op" id="2401327">)</span>&nbsp;<span class="op" id="2401329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401333">return</span>&nbsp;<span class="ident" id="2401340">nil</span><span class="op" id="2401343">,</span>&nbsp;<span class="num" id="2401345">0</span><span class="op" id="2401346">,</span>&nbsp;<span class="ident" id="2401348">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2401356">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401359">sa</span><span class="op" id="2401361">.</span><span class="ident" id="2401362">raw</span><span class="op" id="2401365">.</span><span class="ident" id="2401366">Family</span>&nbsp;<span class="op" id="2401373">=</span>&nbsp;<span class="ident" id="2401375">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401384">for</span>&nbsp;<span class="ident" id="2401388">i</span>&nbsp;<span class="op" id="2401390">:=</span>&nbsp;<span class="num" id="2401393">0</span><span class="op" id="2401394">;</span>&nbsp;<span class="ident" id="2401396">i</span>&nbsp;<span class="op" id="2401398">&lt;</span>&nbsp;<span class="ident" id="2401400">n</span><span class="op" id="2401401">;</span>&nbsp;<span class="ident" id="2401403">i</span><span class="op" id="2401404">++</span>&nbsp;<span class="op" id="2401407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401411">sa</span><span class="op" id="2401413">.</span><span class="ident" id="2401414">raw</span><span class="op" id="2401417">.</span><span class="ident" id="2401418">Path</span><span class="op" id="2401422">[</span><span class="ident" id="2401423">i</span><span class="op" id="2401424">]</span>&nbsp;<span class="op" id="2401426">=</span>&nbsp;<span class="builtintype" id="2401428">int8</span><span class="op" id="2401432">(</span><span class="ident" id="2401433">name</span><span class="op" id="2401437">[</span><span class="ident" id="2401438">i</span><span class="op" id="2401439">]</span><span class="op" id="2401440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2401443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2401446">//&nbsp;length&nbsp;is&nbsp;family&nbsp;(uint16),&nbsp;name,&nbsp;NUL.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401488">sl</span>&nbsp;<span class="op" id="2401491">:=</span>&nbsp;<span class="ident" id="2401494">_Socklen</span><span class="op" id="2401502">(</span><span class="num" id="2401503">2</span><span class="op" id="2401504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401507">if</span>&nbsp;<span class="ident" id="2401510">n</span>&nbsp;<span class="op" id="2401512">&gt;</span>&nbsp;<span class="num" id="2401514">0</span>&nbsp;<span class="op" id="2401516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401520">sl</span>&nbsp;<span class="op" id="2401523">+=</span>&nbsp;<span class="ident" id="2401526">_Socklen</span><span class="op" id="2401534">(</span><span class="ident" id="2401535">n</span><span class="op" id="2401536">)</span>&nbsp;<span class="op" id="2401538">+</span>&nbsp;<span class="num" id="2401540">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2401543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401546">if</span>&nbsp;<span class="ident" id="2401549">sa</span><span class="op" id="2401551">.</span><span class="ident" id="2401552">raw</span><span class="op" id="2401555">.</span><span class="ident" id="2401556">Path</span><span class="op" id="2401560">[</span><span class="num" id="2401561">0</span><span class="op" id="2401562">]</span>&nbsp;<span class="op" id="2401564">==</span>&nbsp;<span class="string" id="2401567">&#39;@&#39;</span>&nbsp;<span class="op" id="2401571">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401575">sa</span><span class="op" id="2401577">.</span><span class="ident" id="2401578">raw</span><span class="op" id="2401581">.</span><span class="ident" id="2401582">Path</span><span class="op" id="2401586">[</span><span class="num" id="2401587">0</span><span class="op" id="2401588">]</span>&nbsp;<span class="op" id="2401590">=</span>&nbsp;<span class="num" id="2401592">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2401596">//&nbsp;Don&#39;t&nbsp;count&nbsp;trailing&nbsp;NUL&nbsp;for&nbsp;abstract&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401648">sl</span><span class="op" id="2401650">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2401654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401658">return</span>&nbsp;<span class="ident" id="2401665">unsafe</span><span class="op" id="2401671">.</span><span class="ident" id="2401672">Pointer</span><span class="op" id="2401679">(</span><span class="op" id="2401680">&amp;</span><span class="ident" id="2401681">sa</span><span class="op" id="2401683">.</span><span class="ident" id="2401684">raw</span><span class="op" id="2401687">)</span><span class="op" id="2401688">,</span>&nbsp;<span class="ident" id="2401690">sl</span><span class="op" id="2401692">,</span>&nbsp;<span class="ident" id="2401694">nil</span><br>
<span class="lineno"></span><span class="op" id="2401698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2401701">type</span>&nbsp;<span class="ident" id="2401706">SockaddrLinklayer</span>&nbsp;<span class="keyword" id="2401724">struct</span>&nbsp;<span class="op" id="2401731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401734">Protocol</span>&nbsp;<span class="builtintype" id="2401743">uint16</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401751">Ifindex</span>&nbsp;&nbsp;<span class="builtintype" id="2401760">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401765">Hatype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2401774">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401782">Pkttype</span>&nbsp;&nbsp;<span class="builtintype" id="2401791">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401798">Halen</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2401807">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401814">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2401823">[</span><span class="num" id="2401824">8</span><span class="op" id="2401825">]</span><span class="builtintype" id="2401826">byte</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401832">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2401841">RawSockaddrLinklayer</span><br>
<span class="lineno"></span><span class="op" id="2401862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2401865">func</span>&nbsp;<span class="op" id="2401870">(</span><span class="ident" id="2401871">sa</span>&nbsp;<span class="op" id="2401874">*</span><span class="ident" id="2401875">SockaddrLinklayer</span><span class="op" id="2401892">)</span>&nbsp;<span class="ident" id="2401894">sockaddr</span><span class="op" id="2401902">(</span><span class="op" id="2401903">)</span>&nbsp;<span class="op" id="2401905">(</span><span class="ident" id="2401906">unsafe</span><span class="op" id="2401912">.</span><span class="ident" id="2401913">Pointer</span><span class="op" id="2401920">,</span>&nbsp;<span class="ident" id="2401922">_Socklen</span><span class="op" id="2401930">,</span>&nbsp;<span class="builtintype" id="2401932">error</span><span class="op" id="2401937">)</span>&nbsp;<span class="op" id="2401939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401942">if</span>&nbsp;<span class="ident" id="2401945">sa</span><span class="op" id="2401947">.</span><span class="ident" id="2401948">Ifindex</span>&nbsp;<span class="op" id="2401956">&lt;</span>&nbsp;<span class="num" id="2401958">0</span>&nbsp;<span class="op" id="2401960">||</span>&nbsp;<span class="ident" id="2401963">sa</span><span class="op" id="2401965">.</span><span class="ident" id="2401966">Ifindex</span>&nbsp;<span class="op" id="2401974">&gt;</span>&nbsp;<span class="num" id="2401976">0x7fffffff</span>&nbsp;<span class="op" id="2401987">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401991">return</span>&nbsp;<span class="ident" id="2401998">nil</span><span class="op" id="2402001">,</span>&nbsp;<span class="num" id="2402003">0</span><span class="op" id="2402004">,</span>&nbsp;<span class="ident" id="2402006">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2402014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402017">sa</span><span class="op" id="2402019">.</span><span class="ident" id="2402020">raw</span><span class="op" id="2402023">.</span><span class="ident" id="2402024">Family</span>&nbsp;<span class="op" id="2402031">=</span>&nbsp;<span class="ident" id="2402033">AF_PACKET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402044">sa</span><span class="op" id="2402046">.</span><span class="ident" id="2402047">raw</span><span class="op" id="2402050">.</span><span class="ident" id="2402051">Protocol</span>&nbsp;<span class="op" id="2402060">=</span>&nbsp;<span class="ident" id="2402062">sa</span><span class="op" id="2402064">.</span><span class="ident" id="2402065">Protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402075">sa</span><span class="op" id="2402077">.</span><span class="ident" id="2402078">raw</span><span class="op" id="2402081">.</span><span class="ident" id="2402082">Ifindex</span>&nbsp;<span class="op" id="2402090">=</span>&nbsp;<span class="builtintype" id="2402092">int32</span><span class="op" id="2402097">(</span><span class="ident" id="2402098">sa</span><span class="op" id="2402100">.</span><span class="ident" id="2402101">Ifindex</span><span class="op" id="2402108">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402111">sa</span><span class="op" id="2402113">.</span><span class="ident" id="2402114">raw</span><span class="op" id="2402117">.</span><span class="ident" id="2402118">Hatype</span>&nbsp;<span class="op" id="2402125">=</span>&nbsp;<span class="ident" id="2402127">sa</span><span class="op" id="2402129">.</span><span class="ident" id="2402130">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402138">sa</span><span class="op" id="2402140">.</span><span class="ident" id="2402141">raw</span><span class="op" id="2402144">.</span><span class="ident" id="2402145">Pkttype</span>&nbsp;<span class="op" id="2402153">=</span>&nbsp;<span class="ident" id="2402155">sa</span><span class="op" id="2402157">.</span><span class="ident" id="2402158">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402167">sa</span><span class="op" id="2402169">.</span><span class="ident" id="2402170">raw</span><span class="op" id="2402173">.</span><span class="ident" id="2402174">Halen</span>&nbsp;<span class="op" id="2402180">=</span>&nbsp;<span class="ident" id="2402182">sa</span><span class="op" id="2402184">.</span><span class="ident" id="2402185">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402192">for</span>&nbsp;<span class="ident" id="2402196">i</span>&nbsp;<span class="op" id="2402198">:=</span>&nbsp;<span class="num" id="2402201">0</span><span class="op" id="2402202">;</span>&nbsp;<span class="ident" id="2402204">i</span>&nbsp;<span class="op" id="2402206">&lt;</span>&nbsp;<span class="builtinfunc" id="2402208">len</span><span class="op" id="2402211">(</span><span class="ident" id="2402212">sa</span><span class="op" id="2402214">.</span><span class="ident" id="2402215">Addr</span><span class="op" id="2402219">)</span><span class="op" id="2402220">;</span>&nbsp;<span class="ident" id="2402222">i</span><span class="op" id="2402223">++</span>&nbsp;<span class="op" id="2402226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402230">sa</span><span class="op" id="2402232">.</span><span class="ident" id="2402233">raw</span><span class="op" id="2402236">.</span><span class="ident" id="2402237">Addr</span><span class="op" id="2402241">[</span><span class="ident" id="2402242">i</span><span class="op" id="2402243">]</span>&nbsp;<span class="op" id="2402245">=</span>&nbsp;<span class="ident" id="2402247">sa</span><span class="op" id="2402249">.</span><span class="ident" id="2402250">Addr</span><span class="op" id="2402254">[</span><span class="ident" id="2402255">i</span><span class="op" id="2402256">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2402259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402262">return</span>&nbsp;<span class="ident" id="2402269">unsafe</span><span class="op" id="2402275">.</span><span class="ident" id="2402276">Pointer</span><span class="op" id="2402283">(</span><span class="op" id="2402284">&amp;</span><span class="ident" id="2402285">sa</span><span class="op" id="2402287">.</span><span class="ident" id="2402288">raw</span><span class="op" id="2402291">)</span><span class="op" id="2402292">,</span>&nbsp;<span class="ident" id="2402294">SizeofSockaddrLinklayer</span><span class="op" id="2402317">,</span>&nbsp;<span class="ident" id="2402319">nil</span><br>
<span class="lineno"></span><span class="op" id="2402323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2402326">type</span>&nbsp;<span class="ident" id="2402331">SockaddrNetlink</span>&nbsp;<span class="keyword" id="2402347">struct</span>&nbsp;<span class="op" id="2402354">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402357">Family</span>&nbsp;<span class="builtintype" id="2402364">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402372">Pad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2402379">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402387">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2402394">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402402">Groups</span>&nbsp;<span class="builtintype" id="2402409">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402417">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2402424">RawSockaddrNetlink</span><br>
<span class="lineno">320</span><span class="op" id="2402443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2402446">func</span>&nbsp;<span class="op" id="2402451">(</span><span class="ident" id="2402452">sa</span>&nbsp;<span class="op" id="2402455">*</span><span class="ident" id="2402456">SockaddrNetlink</span><span class="op" id="2402471">)</span>&nbsp;<span class="ident" id="2402473">sockaddr</span><span class="op" id="2402481">(</span><span class="op" id="2402482">)</span>&nbsp;<span class="op" id="2402484">(</span><span class="ident" id="2402485">unsafe</span><span class="op" id="2402491">.</span><span class="ident" id="2402492">Pointer</span><span class="op" id="2402499">,</span>&nbsp;<span class="ident" id="2402501">_Socklen</span><span class="op" id="2402509">,</span>&nbsp;<span class="builtintype" id="2402511">error</span><span class="op" id="2402516">)</span>&nbsp;<span class="op" id="2402518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402521">sa</span><span class="op" id="2402523">.</span><span class="ident" id="2402524">raw</span><span class="op" id="2402527">.</span><span class="ident" id="2402528">Family</span>&nbsp;<span class="op" id="2402535">=</span>&nbsp;<span class="ident" id="2402537">AF_NETLINK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402549">sa</span><span class="op" id="2402551">.</span><span class="ident" id="2402552">raw</span><span class="op" id="2402555">.</span><span class="ident" id="2402556">Pad</span>&nbsp;<span class="op" id="2402560">=</span>&nbsp;<span class="ident" id="2402562">sa</span><span class="op" id="2402564">.</span><span class="ident" id="2402565">Pad</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402570">sa</span><span class="op" id="2402572">.</span><span class="ident" id="2402573">raw</span><span class="op" id="2402576">.</span><span class="ident" id="2402577">Pid</span>&nbsp;<span class="op" id="2402581">=</span>&nbsp;<span class="ident" id="2402583">sa</span><span class="op" id="2402585">.</span><span class="ident" id="2402586">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402591">sa</span><span class="op" id="2402593">.</span><span class="ident" id="2402594">raw</span><span class="op" id="2402597">.</span><span class="ident" id="2402598">Groups</span>&nbsp;<span class="op" id="2402605">=</span>&nbsp;<span class="ident" id="2402607">sa</span><span class="op" id="2402609">.</span><span class="ident" id="2402610">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402618">return</span>&nbsp;<span class="ident" id="2402625">unsafe</span><span class="op" id="2402631">.</span><span class="ident" id="2402632">Pointer</span><span class="op" id="2402639">(</span><span class="op" id="2402640">&amp;</span><span class="ident" id="2402641">sa</span><span class="op" id="2402643">.</span><span class="ident" id="2402644">raw</span><span class="op" id="2402647">)</span><span class="op" id="2402648">,</span>&nbsp;<span class="ident" id="2402650">SizeofSockaddrNetlink</span><span class="op" id="2402671">,</span>&nbsp;<span class="ident" id="2402673">nil</span><br>
<span class="lineno"></span><span class="op" id="2402677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="2402680">func</span>&nbsp;<span class="ident" id="2402685">anyToSockaddr</span><span class="op" id="2402698">(</span><span class="ident" id="2402699">rsa</span>&nbsp;<span class="op" id="2402703">*</span><span class="ident" id="2402704">RawSockaddrAny</span><span class="op" id="2402718">)</span>&nbsp;<span class="op" id="2402720">(</span><span class="ident" id="2402721">Sockaddr</span><span class="op" id="2402729">,</span>&nbsp;<span class="builtintype" id="2402731">error</span><span class="op" id="2402736">)</span>&nbsp;<span class="op" id="2402738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402741">switch</span>&nbsp;<span class="ident" id="2402748">rsa</span><span class="op" id="2402751">.</span><span class="ident" id="2402752">Addr</span><span class="op" id="2402756">.</span><span class="ident" id="2402757">Family</span>&nbsp;<span class="op" id="2402764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402767">case</span>&nbsp;<span class="ident" id="2402772">AF_NETLINK</span><span class="op" id="2402782">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402786">pp</span>&nbsp;<span class="op" id="2402789">:=</span>&nbsp;<span class="op" id="2402792">(</span><span class="op" id="2402793">*</span><span class="ident" id="2402794">RawSockaddrNetlink</span><span class="op" id="2402812">)</span><span class="op" id="2402813">(</span><span class="ident" id="2402814">unsafe</span><span class="op" id="2402820">.</span><span class="ident" id="2402821">Pointer</span><span class="op" id="2402828">(</span><span class="ident" id="2402829">rsa</span><span class="op" id="2402832">)</span><span class="op" id="2402833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402837">sa</span>&nbsp;<span class="op" id="2402840">:=</span>&nbsp;<span class="builtinfunc" id="2402843">new</span><span class="op" id="2402846">(</span><span class="ident" id="2402847">SockaddrNetlink</span><span class="op" id="2402862">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402866">sa</span><span class="op" id="2402868">.</span><span class="ident" id="2402869">Family</span>&nbsp;<span class="op" id="2402876">=</span>&nbsp;<span class="ident" id="2402878">pp</span><span class="op" id="2402880">.</span><span class="ident" id="2402881">Family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402890">sa</span><span class="op" id="2402892">.</span><span class="ident" id="2402893">Pad</span>&nbsp;<span class="op" id="2402897">=</span>&nbsp;<span class="ident" id="2402899">pp</span><span class="op" id="2402901">.</span><span class="ident" id="2402902">Pad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402908">sa</span><span class="op" id="2402910">.</span><span class="ident" id="2402911">Pid</span>&nbsp;<span class="op" id="2402915">=</span>&nbsp;<span class="ident" id="2402917">pp</span><span class="op" id="2402919">.</span><span class="ident" id="2402920">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402926">sa</span><span class="op" id="2402928">.</span><span class="ident" id="2402929">Groups</span>&nbsp;<span class="op" id="2402936">=</span>&nbsp;<span class="ident" id="2402938">pp</span><span class="op" id="2402940">.</span><span class="ident" id="2402941">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402950">return</span>&nbsp;<span class="ident" id="2402957">sa</span><span class="op" id="2402959">,</span>&nbsp;<span class="ident" id="2402961">nil</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402967">case</span>&nbsp;<span class="ident" id="2402972">AF_PACKET</span><span class="op" id="2402981">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402985">pp</span>&nbsp;<span class="op" id="2402988">:=</span>&nbsp;<span class="op" id="2402991">(</span><span class="op" id="2402992">*</span><span class="ident" id="2402993">RawSockaddrLinklayer</span><span class="op" id="2403013">)</span><span class="op" id="2403014">(</span><span class="ident" id="2403015">unsafe</span><span class="op" id="2403021">.</span><span class="ident" id="2403022">Pointer</span><span class="op" id="2403029">(</span><span class="ident" id="2403030">rsa</span><span class="op" id="2403033">)</span><span class="op" id="2403034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403038">sa</span>&nbsp;<span class="op" id="2403041">:=</span>&nbsp;<span class="builtinfunc" id="2403044">new</span><span class="op" id="2403047">(</span><span class="ident" id="2403048">SockaddrLinklayer</span><span class="op" id="2403065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403069">sa</span><span class="op" id="2403071">.</span><span class="ident" id="2403072">Protocol</span>&nbsp;<span class="op" id="2403081">=</span>&nbsp;<span class="ident" id="2403083">pp</span><span class="op" id="2403085">.</span><span class="ident" id="2403086">Protocol</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403097">sa</span><span class="op" id="2403099">.</span><span class="ident" id="2403100">Ifindex</span>&nbsp;<span class="op" id="2403108">=</span>&nbsp;<span class="builtintype" id="2403110">int</span><span class="op" id="2403113">(</span><span class="ident" id="2403114">pp</span><span class="op" id="2403116">.</span><span class="ident" id="2403117">Ifindex</span><span class="op" id="2403124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403128">sa</span><span class="op" id="2403130">.</span><span class="ident" id="2403131">Hatype</span>&nbsp;<span class="op" id="2403138">=</span>&nbsp;<span class="ident" id="2403140">pp</span><span class="op" id="2403142">.</span><span class="ident" id="2403143">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403152">sa</span><span class="op" id="2403154">.</span><span class="ident" id="2403155">Pkttype</span>&nbsp;<span class="op" id="2403163">=</span>&nbsp;<span class="ident" id="2403165">pp</span><span class="op" id="2403167">.</span><span class="ident" id="2403168">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403178">sa</span><span class="op" id="2403180">.</span><span class="ident" id="2403181">Halen</span>&nbsp;<span class="op" id="2403187">=</span>&nbsp;<span class="ident" id="2403189">pp</span><span class="op" id="2403191">.</span><span class="ident" id="2403192">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403200">for</span>&nbsp;<span class="ident" id="2403204">i</span>&nbsp;<span class="op" id="2403206">:=</span>&nbsp;<span class="num" id="2403209">0</span><span class="op" id="2403210">;</span>&nbsp;<span class="ident" id="2403212">i</span>&nbsp;<span class="op" id="2403214">&lt;</span>&nbsp;<span class="builtinfunc" id="2403216">len</span><span class="op" id="2403219">(</span><span class="ident" id="2403220">sa</span><span class="op" id="2403222">.</span><span class="ident" id="2403223">Addr</span><span class="op" id="2403227">)</span><span class="op" id="2403228">;</span>&nbsp;<span class="ident" id="2403230">i</span><span class="op" id="2403231">++</span>&nbsp;<span class="op" id="2403234">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403239">sa</span><span class="op" id="2403241">.</span><span class="ident" id="2403242">Addr</span><span class="op" id="2403246">[</span><span class="ident" id="2403247">i</span><span class="op" id="2403248">]</span>&nbsp;<span class="op" id="2403250">=</span>&nbsp;<span class="ident" id="2403252">pp</span><span class="op" id="2403254">.</span><span class="ident" id="2403255">Addr</span><span class="op" id="2403259">[</span><span class="ident" id="2403260">i</span><span class="op" id="2403261">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403269">return</span>&nbsp;<span class="ident" id="2403276">sa</span><span class="op" id="2403278">,</span>&nbsp;<span class="ident" id="2403280">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403286">case</span>&nbsp;<span class="ident" id="2403291">AF_UNIX</span><span class="op" id="2403298">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403302">pp</span>&nbsp;<span class="op" id="2403305">:=</span>&nbsp;<span class="op" id="2403308">(</span><span class="op" id="2403309">*</span><span class="ident" id="2403310">RawSockaddrUnix</span><span class="op" id="2403325">)</span><span class="op" id="2403326">(</span><span class="ident" id="2403327">unsafe</span><span class="op" id="2403333">.</span><span class="ident" id="2403334">Pointer</span><span class="op" id="2403341">(</span><span class="ident" id="2403342">rsa</span><span class="op" id="2403345">)</span><span class="op" id="2403346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403350">sa</span>&nbsp;<span class="op" id="2403353">:=</span>&nbsp;<span class="builtinfunc" id="2403356">new</span><span class="op" id="2403359">(</span><span class="ident" id="2403360">SockaddrUnix</span><span class="op" id="2403372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403376">if</span>&nbsp;<span class="ident" id="2403379">pp</span><span class="op" id="2403381">.</span><span class="ident" id="2403382">Path</span><span class="op" id="2403386">[</span><span class="num" id="2403387">0</span><span class="op" id="2403388">]</span>&nbsp;<span class="op" id="2403390">==</span>&nbsp;<span class="num" id="2403393">0</span>&nbsp;<span class="op" id="2403395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403400">//&nbsp;&#34;Abstract&#34;&nbsp;Unix&nbsp;domain&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403437">//&nbsp;Rewrite&nbsp;leading&nbsp;NUL&nbsp;as&nbsp;@&nbsp;for&nbsp;textual&nbsp;display.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403489">//&nbsp;(This&nbsp;is&nbsp;the&nbsp;standard&nbsp;convention.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403530">//&nbsp;Not&nbsp;friendly&nbsp;to&nbsp;overwrite&nbsp;in&nbsp;place,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403572">//&nbsp;but&nbsp;the&nbsp;callers&nbsp;below&nbsp;don&#39;t&nbsp;care.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403612">pp</span><span class="op" id="2403614">.</span><span class="ident" id="2403615">Path</span><span class="op" id="2403619">[</span><span class="num" id="2403620">0</span><span class="op" id="2403621">]</span>&nbsp;<span class="op" id="2403623">=</span>&nbsp;<span class="string" id="2403625">&#39;@&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403631">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403636">//&nbsp;Assume&nbsp;path&nbsp;ends&nbsp;at&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403666">//&nbsp;This&nbsp;is&nbsp;not&nbsp;technically&nbsp;the&nbsp;Linux&nbsp;semantics&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403719">//&nbsp;abstract&nbsp;Unix&nbsp;domain&nbsp;sockets--they&nbsp;are&nbsp;supposed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403772">//&nbsp;to&nbsp;be&nbsp;uninterpreted&nbsp;fixed-size&nbsp;binary&nbsp;blobs--but</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403826">//&nbsp;everyone&nbsp;uses&nbsp;this&nbsp;convention.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403862">n</span>&nbsp;<span class="op" id="2403864">:=</span>&nbsp;<span class="num" id="2403867">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403871">for</span>&nbsp;<span class="ident" id="2403875">n</span>&nbsp;<span class="op" id="2403877">&lt;</span>&nbsp;<span class="builtinfunc" id="2403879">len</span><span class="op" id="2403882">(</span><span class="ident" id="2403883">pp</span><span class="op" id="2403885">.</span><span class="ident" id="2403886">Path</span><span class="op" id="2403890">)</span>&nbsp;<span class="op" id="2403892">&amp;&amp;</span>&nbsp;<span class="ident" id="2403895">pp</span><span class="op" id="2403897">.</span><span class="ident" id="2403898">Path</span><span class="op" id="2403902">[</span><span class="ident" id="2403903">n</span><span class="op" id="2403904">]</span>&nbsp;<span class="op" id="2403906">!=</span>&nbsp;<span class="num" id="2403909">0</span>&nbsp;<span class="op" id="2403911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403916">n</span><span class="op" id="2403917">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403922">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403926">bytes</span>&nbsp;<span class="op" id="2403932">:=</span>&nbsp;<span class="op" id="2403935">(</span><span class="op" id="2403936">*</span><span class="op" id="2403937">[</span><span class="num" id="2403938">10000</span><span class="op" id="2403943">]</span><span class="builtintype" id="2403944">byte</span><span class="op" id="2403948">)</span><span class="op" id="2403949">(</span><span class="ident" id="2403950">unsafe</span><span class="op" id="2403956">.</span><span class="ident" id="2403957">Pointer</span><span class="op" id="2403964">(</span><span class="op" id="2403965">&amp;</span><span class="ident" id="2403966">pp</span><span class="op" id="2403968">.</span><span class="ident" id="2403969">Path</span><span class="op" id="2403973">[</span><span class="num" id="2403974">0</span><span class="op" id="2403975">]</span><span class="op" id="2403976">)</span><span class="op" id="2403977">)</span><span class="op" id="2403978">[</span><span class="num" id="2403979">0</span><span class="op" id="2403980">:</span><span class="ident" id="2403981">n</span><span class="op" id="2403982">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403986">sa</span><span class="op" id="2403988">.</span><span class="ident" id="2403989">Name</span>&nbsp;<span class="op" id="2403994">=</span>&nbsp;<span class="builtintype" id="2403996">string</span><span class="op" id="2404002">(</span><span class="ident" id="2404003">bytes</span><span class="op" id="2404008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404012">return</span>&nbsp;<span class="ident" id="2404019">sa</span><span class="op" id="2404021">,</span>&nbsp;<span class="ident" id="2404023">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404029">case</span>&nbsp;<span class="ident" id="2404034">AF_INET</span><span class="op" id="2404041">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404045">pp</span>&nbsp;<span class="op" id="2404048">:=</span>&nbsp;<span class="op" id="2404051">(</span><span class="op" id="2404052">*</span><span class="ident" id="2404053">RawSockaddrInet4</span><span class="op" id="2404069">)</span><span class="op" id="2404070">(</span><span class="ident" id="2404071">unsafe</span><span class="op" id="2404077">.</span><span class="ident" id="2404078">Pointer</span><span class="op" id="2404085">(</span><span class="ident" id="2404086">rsa</span><span class="op" id="2404089">)</span><span class="op" id="2404090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404094">sa</span>&nbsp;<span class="op" id="2404097">:=</span>&nbsp;<span class="builtinfunc" id="2404100">new</span><span class="op" id="2404103">(</span><span class="ident" id="2404104">SockaddrInet4</span><span class="op" id="2404117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404121">p</span>&nbsp;<span class="op" id="2404123">:=</span>&nbsp;<span class="op" id="2404126">(</span><span class="op" id="2404127">*</span><span class="op" id="2404128">[</span><span class="num" id="2404129">2</span><span class="op" id="2404130">]</span><span class="builtintype" id="2404131">byte</span><span class="op" id="2404135">)</span><span class="op" id="2404136">(</span><span class="ident" id="2404137">unsafe</span><span class="op" id="2404143">.</span><span class="ident" id="2404144">Pointer</span><span class="op" id="2404151">(</span><span class="op" id="2404152">&amp;</span><span class="ident" id="2404153">pp</span><span class="op" id="2404155">.</span><span class="ident" id="2404156">Port</span><span class="op" id="2404160">)</span><span class="op" id="2404161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404165">sa</span><span class="op" id="2404167">.</span><span class="ident" id="2404168">Port</span>&nbsp;<span class="op" id="2404173">=</span>&nbsp;<span class="builtintype" id="2404175">int</span><span class="op" id="2404178">(</span><span class="ident" id="2404179">p</span><span class="op" id="2404180">[</span><span class="num" id="2404181">0</span><span class="op" id="2404182">]</span><span class="op" id="2404183">)</span><span class="op" id="2404184">&lt;&lt;</span><span class="num" id="2404186">8</span>&nbsp;<span class="op" id="2404188">+</span>&nbsp;<span class="builtintype" id="2404190">int</span><span class="op" id="2404193">(</span><span class="ident" id="2404194">p</span><span class="op" id="2404195">[</span><span class="num" id="2404196">1</span><span class="op" id="2404197">]</span><span class="op" id="2404198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404202">for</span>&nbsp;<span class="ident" id="2404206">i</span>&nbsp;<span class="op" id="2404208">:=</span>&nbsp;<span class="num" id="2404211">0</span><span class="op" id="2404212">;</span>&nbsp;<span class="ident" id="2404214">i</span>&nbsp;<span class="op" id="2404216">&lt;</span>&nbsp;<span class="builtinfunc" id="2404218">len</span><span class="op" id="2404221">(</span><span class="ident" id="2404222">sa</span><span class="op" id="2404224">.</span><span class="ident" id="2404225">Addr</span><span class="op" id="2404229">)</span><span class="op" id="2404230">;</span>&nbsp;<span class="ident" id="2404232">i</span><span class="op" id="2404233">++</span>&nbsp;<span class="op" id="2404236">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404241">sa</span><span class="op" id="2404243">.</span><span class="ident" id="2404244">Addr</span><span class="op" id="2404248">[</span><span class="ident" id="2404249">i</span><span class="op" id="2404250">]</span>&nbsp;<span class="op" id="2404252">=</span>&nbsp;<span class="ident" id="2404254">pp</span><span class="op" id="2404256">.</span><span class="ident" id="2404257">Addr</span><span class="op" id="2404261">[</span><span class="ident" id="2404262">i</span><span class="op" id="2404263">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2404267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404271">return</span>&nbsp;<span class="ident" id="2404278">sa</span><span class="op" id="2404280">,</span>&nbsp;<span class="ident" id="2404282">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404288">case</span>&nbsp;<span class="ident" id="2404293">AF_INET6</span><span class="op" id="2404301">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404305">pp</span>&nbsp;<span class="op" id="2404308">:=</span>&nbsp;<span class="op" id="2404311">(</span><span class="op" id="2404312">*</span><span class="ident" id="2404313">RawSockaddrInet6</span><span class="op" id="2404329">)</span><span class="op" id="2404330">(</span><span class="ident" id="2404331">unsafe</span><span class="op" id="2404337">.</span><span class="ident" id="2404338">Pointer</span><span class="op" id="2404345">(</span><span class="ident" id="2404346">rsa</span><span class="op" id="2404349">)</span><span class="op" id="2404350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404354">sa</span>&nbsp;<span class="op" id="2404357">:=</span>&nbsp;<span class="builtinfunc" id="2404360">new</span><span class="op" id="2404363">(</span><span class="ident" id="2404364">SockaddrInet6</span><span class="op" id="2404377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404381">p</span>&nbsp;<span class="op" id="2404383">:=</span>&nbsp;<span class="op" id="2404386">(</span><span class="op" id="2404387">*</span><span class="op" id="2404388">[</span><span class="num" id="2404389">2</span><span class="op" id="2404390">]</span><span class="builtintype" id="2404391">byte</span><span class="op" id="2404395">)</span><span class="op" id="2404396">(</span><span class="ident" id="2404397">unsafe</span><span class="op" id="2404403">.</span><span class="ident" id="2404404">Pointer</span><span class="op" id="2404411">(</span><span class="op" id="2404412">&amp;</span><span class="ident" id="2404413">pp</span><span class="op" id="2404415">.</span><span class="ident" id="2404416">Port</span><span class="op" id="2404420">)</span><span class="op" id="2404421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404425">sa</span><span class="op" id="2404427">.</span><span class="ident" id="2404428">Port</span>&nbsp;<span class="op" id="2404433">=</span>&nbsp;<span class="builtintype" id="2404435">int</span><span class="op" id="2404438">(</span><span class="ident" id="2404439">p</span><span class="op" id="2404440">[</span><span class="num" id="2404441">0</span><span class="op" id="2404442">]</span><span class="op" id="2404443">)</span><span class="op" id="2404444">&lt;&lt;</span><span class="num" id="2404446">8</span>&nbsp;<span class="op" id="2404448">+</span>&nbsp;<span class="builtintype" id="2404450">int</span><span class="op" id="2404453">(</span><span class="ident" id="2404454">p</span><span class="op" id="2404455">[</span><span class="num" id="2404456">1</span><span class="op" id="2404457">]</span><span class="op" id="2404458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404462">sa</span><span class="op" id="2404464">.</span><span class="ident" id="2404465">ZoneId</span>&nbsp;<span class="op" id="2404472">=</span>&nbsp;<span class="ident" id="2404474">pp</span><span class="op" id="2404476">.</span><span class="ident" id="2404477">Scope_id</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404488">for</span>&nbsp;<span class="ident" id="2404492">i</span>&nbsp;<span class="op" id="2404494">:=</span>&nbsp;<span class="num" id="2404497">0</span><span class="op" id="2404498">;</span>&nbsp;<span class="ident" id="2404500">i</span>&nbsp;<span class="op" id="2404502">&lt;</span>&nbsp;<span class="builtinfunc" id="2404504">len</span><span class="op" id="2404507">(</span><span class="ident" id="2404508">sa</span><span class="op" id="2404510">.</span><span class="ident" id="2404511">Addr</span><span class="op" id="2404515">)</span><span class="op" id="2404516">;</span>&nbsp;<span class="ident" id="2404518">i</span><span class="op" id="2404519">++</span>&nbsp;<span class="op" id="2404522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404527">sa</span><span class="op" id="2404529">.</span><span class="ident" id="2404530">Addr</span><span class="op" id="2404534">[</span><span class="ident" id="2404535">i</span><span class="op" id="2404536">]</span>&nbsp;<span class="op" id="2404538">=</span>&nbsp;<span class="ident" id="2404540">pp</span><span class="op" id="2404542">.</span><span class="ident" id="2404543">Addr</span><span class="op" id="2404547">[</span><span class="ident" id="2404548">i</span><span class="op" id="2404549">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2404553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404557">return</span>&nbsp;<span class="ident" id="2404564">sa</span><span class="op" id="2404566">,</span>&nbsp;<span class="ident" id="2404568">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2404573">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404576">return</span>&nbsp;<span class="ident" id="2404583">nil</span><span class="op" id="2404586">,</span>&nbsp;<span class="ident" id="2404588">EAFNOSUPPORT</span><br>
<span class="lineno"></span><span class="op" id="2404601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2404604">func</span>&nbsp;<span class="ident" id="2404609">Accept</span><span class="op" id="2404615">(</span><span class="ident" id="2404616">fd</span>&nbsp;<span class="builtintype" id="2404619">int</span><span class="op" id="2404622">)</span>&nbsp;<span class="op" id="2404624">(</span><span class="ident" id="2404625">nfd</span>&nbsp;<span class="builtintype" id="2404629">int</span><span class="op" id="2404632">,</span>&nbsp;<span class="ident" id="2404634">sa</span>&nbsp;<span class="ident" id="2404637">Sockaddr</span><span class="op" id="2404645">,</span>&nbsp;<span class="ident" id="2404647">err</span>&nbsp;<span class="builtintype" id="2404651">error</span><span class="op" id="2404656">)</span>&nbsp;<span class="op" id="2404658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404661">var</span>&nbsp;<span class="ident" id="2404665">rsa</span>&nbsp;<span class="ident" id="2404669">RawSockaddrAny</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404685">var</span>&nbsp;<span class="builtinfunc" id="2404689">len</span>&nbsp;<span class="ident" id="2404693">_Socklen</span>&nbsp;<span class="op" id="2404702">=</span>&nbsp;<span class="ident" id="2404704">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404723">nfd</span><span class="op" id="2404726">,</span>&nbsp;<span class="ident" id="2404728">err</span>&nbsp;<span class="op" id="2404732">=</span>&nbsp;<span class="ident" id="2404734">accept</span><span class="op" id="2404740">(</span><span class="ident" id="2404741">fd</span><span class="op" id="2404743">,</span>&nbsp;<span class="op" id="2404745">&amp;</span><span class="ident" id="2404746">rsa</span><span class="op" id="2404749">,</span>&nbsp;<span class="op" id="2404751">&amp;</span><span class="builtinfunc" id="2404752">len</span><span class="op" id="2404755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404758">if</span>&nbsp;<span class="ident" id="2404761">err</span>&nbsp;<span class="op" id="2404765">!=</span>&nbsp;<span class="ident" id="2404768">nil</span>&nbsp;<span class="op" id="2404772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404776">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2404784">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404787">sa</span><span class="op" id="2404789">,</span>&nbsp;<span class="ident" id="2404791">err</span>&nbsp;<span class="op" id="2404795">=</span>&nbsp;<span class="ident" id="2404797">anyToSockaddr</span><span class="op" id="2404810">(</span><span class="op" id="2404811">&amp;</span><span class="ident" id="2404812">rsa</span><span class="op" id="2404815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404818">if</span>&nbsp;<span class="ident" id="2404821">err</span>&nbsp;<span class="op" id="2404825">!=</span>&nbsp;<span class="ident" id="2404828">nil</span>&nbsp;<span class="op" id="2404832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404836">Close</span><span class="op" id="2404841">(</span><span class="ident" id="2404842">nfd</span><span class="op" id="2404845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404849">nfd</span>&nbsp;<span class="op" id="2404853">=</span>&nbsp;<span class="num" id="2404855">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2404858">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404861">return</span><br>
<span class="lineno"></span><span class="op" id="2404868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2404871">func</span>&nbsp;<span class="ident" id="2404876">Accept4</span><span class="op" id="2404883">(</span><span class="ident" id="2404884">fd</span>&nbsp;<span class="builtintype" id="2404887">int</span><span class="op" id="2404890">,</span>&nbsp;<span class="ident" id="2404892">flags</span>&nbsp;<span class="builtintype" id="2404898">int</span><span class="op" id="2404901">)</span>&nbsp;<span class="op" id="2404903">(</span><span class="ident" id="2404904">nfd</span>&nbsp;<span class="builtintype" id="2404908">int</span><span class="op" id="2404911">,</span>&nbsp;<span class="ident" id="2404913">sa</span>&nbsp;<span class="ident" id="2404916">Sockaddr</span><span class="op" id="2404924">,</span>&nbsp;<span class="ident" id="2404926">err</span>&nbsp;<span class="builtintype" id="2404930">error</span><span class="op" id="2404935">)</span>&nbsp;<span class="op" id="2404937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404940">var</span>&nbsp;<span class="ident" id="2404944">rsa</span>&nbsp;<span class="ident" id="2404948">RawSockaddrAny</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404964">var</span>&nbsp;<span class="builtinfunc" id="2404968">len</span>&nbsp;<span class="ident" id="2404972">_Socklen</span>&nbsp;<span class="op" id="2404981">=</span>&nbsp;<span class="ident" id="2404983">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405002">nfd</span><span class="op" id="2405005">,</span>&nbsp;<span class="ident" id="2405007">err</span>&nbsp;<span class="op" id="2405011">=</span>&nbsp;<span class="ident" id="2405013">accept4</span><span class="op" id="2405020">(</span><span class="ident" id="2405021">fd</span><span class="op" id="2405023">,</span>&nbsp;<span class="op" id="2405025">&amp;</span><span class="ident" id="2405026">rsa</span><span class="op" id="2405029">,</span>&nbsp;<span class="op" id="2405031">&amp;</span><span class="builtinfunc" id="2405032">len</span><span class="op" id="2405035">,</span>&nbsp;<span class="ident" id="2405037">flags</span><span class="op" id="2405042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405045">if</span>&nbsp;<span class="ident" id="2405048">err</span>&nbsp;<span class="op" id="2405052">!=</span>&nbsp;<span class="ident" id="2405055">nil</span>&nbsp;<span class="op" id="2405059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405063">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405071">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405074">if</span>&nbsp;<span class="builtinfunc" id="2405077">len</span>&nbsp;<span class="op" id="2405081">&gt;</span>&nbsp;<span class="ident" id="2405083">SizeofSockaddrAny</span>&nbsp;<span class="op" id="2405101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2405105">panic</span><span class="op" id="2405110">(</span><span class="string" id="2405111">&#34;RawSockaddrAny&nbsp;too&nbsp;small&#34;</span><span class="op" id="2405137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405143">sa</span><span class="op" id="2405145">,</span>&nbsp;<span class="ident" id="2405147">err</span>&nbsp;<span class="op" id="2405151">=</span>&nbsp;<span class="ident" id="2405153">anyToSockaddr</span><span class="op" id="2405166">(</span><span class="op" id="2405167">&amp;</span><span class="ident" id="2405168">rsa</span><span class="op" id="2405171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405174">if</span>&nbsp;<span class="ident" id="2405177">err</span>&nbsp;<span class="op" id="2405181">!=</span>&nbsp;<span class="ident" id="2405184">nil</span>&nbsp;<span class="op" id="2405188">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405192">Close</span><span class="op" id="2405197">(</span><span class="ident" id="2405198">nfd</span><span class="op" id="2405201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405205">nfd</span>&nbsp;<span class="op" id="2405209">=</span>&nbsp;<span class="num" id="2405211">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405217">return</span><br>
<span class="lineno"></span><span class="op" id="2405224">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2405227">func</span>&nbsp;<span class="ident" id="2405232">Getsockname</span><span class="op" id="2405243">(</span><span class="ident" id="2405244">fd</span>&nbsp;<span class="builtintype" id="2405247">int</span><span class="op" id="2405250">)</span>&nbsp;<span class="op" id="2405252">(</span><span class="ident" id="2405253">sa</span>&nbsp;<span class="ident" id="2405256">Sockaddr</span><span class="op" id="2405264">,</span>&nbsp;<span class="ident" id="2405266">err</span>&nbsp;<span class="builtintype" id="2405270">error</span><span class="op" id="2405275">)</span>&nbsp;<span class="op" id="2405277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405280">var</span>&nbsp;<span class="ident" id="2405284">rsa</span>&nbsp;<span class="ident" id="2405288">RawSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405304">var</span>&nbsp;<span class="builtinfunc" id="2405308">len</span>&nbsp;<span class="ident" id="2405312">_Socklen</span>&nbsp;<span class="op" id="2405321">=</span>&nbsp;<span class="ident" id="2405323">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405342">if</span>&nbsp;<span class="ident" id="2405345">err</span>&nbsp;<span class="op" id="2405349">=</span>&nbsp;<span class="ident" id="2405351">getsockname</span><span class="op" id="2405362">(</span><span class="ident" id="2405363">fd</span><span class="op" id="2405365">,</span>&nbsp;<span class="op" id="2405367">&amp;</span><span class="ident" id="2405368">rsa</span><span class="op" id="2405371">,</span>&nbsp;<span class="op" id="2405373">&amp;</span><span class="builtinfunc" id="2405374">len</span><span class="op" id="2405377">)</span><span class="op" id="2405378">;</span>&nbsp;<span class="ident" id="2405380">err</span>&nbsp;<span class="op" id="2405384">!=</span>&nbsp;<span class="ident" id="2405387">nil</span>&nbsp;<span class="op" id="2405391">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405395">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405406">return</span>&nbsp;<span class="ident" id="2405413">anyToSockaddr</span><span class="op" id="2405426">(</span><span class="op" id="2405427">&amp;</span><span class="ident" id="2405428">rsa</span><span class="op" id="2405431">)</span><br>
<span class="lineno"></span><span class="op" id="2405433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="2405436">func</span>&nbsp;<span class="ident" id="2405441">GetsockoptInet4Addr</span><span class="op" id="2405460">(</span><span class="ident" id="2405461">fd</span><span class="op" id="2405463">,</span>&nbsp;<span class="ident" id="2405465">level</span><span class="op" id="2405470">,</span>&nbsp;<span class="ident" id="2405472">opt</span>&nbsp;<span class="builtintype" id="2405476">int</span><span class="op" id="2405479">)</span>&nbsp;<span class="op" id="2405481">(</span><span class="ident" id="2405482">value</span>&nbsp;<span class="op" id="2405488">[</span><span class="num" id="2405489">4</span><span class="op" id="2405490">]</span><span class="builtintype" id="2405491">byte</span><span class="op" id="2405495">,</span>&nbsp;<span class="ident" id="2405497">err</span>&nbsp;<span class="builtintype" id="2405501">error</span><span class="op" id="2405506">)</span>&nbsp;<span class="op" id="2405508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405511">vallen</span>&nbsp;<span class="op" id="2405518">:=</span>&nbsp;<span class="ident" id="2405521">_Socklen</span><span class="op" id="2405529">(</span><span class="num" id="2405530">4</span><span class="op" id="2405531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405534">err</span>&nbsp;<span class="op" id="2405538">=</span>&nbsp;<span class="ident" id="2405540">getsockopt</span><span class="op" id="2405550">(</span><span class="ident" id="2405551">fd</span><span class="op" id="2405553">,</span>&nbsp;<span class="ident" id="2405555">level</span><span class="op" id="2405560">,</span>&nbsp;<span class="ident" id="2405562">opt</span><span class="op" id="2405565">,</span>&nbsp;<span class="ident" id="2405567">unsafe</span><span class="op" id="2405573">.</span><span class="ident" id="2405574">Pointer</span><span class="op" id="2405581">(</span><span class="op" id="2405582">&amp;</span><span class="ident" id="2405583">value</span><span class="op" id="2405588">[</span><span class="num" id="2405589">0</span><span class="op" id="2405590">]</span><span class="op" id="2405591">)</span><span class="op" id="2405592">,</span>&nbsp;<span class="op" id="2405594">&amp;</span><span class="ident" id="2405595">vallen</span><span class="op" id="2405601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405604">return</span>&nbsp;<span class="ident" id="2405611">value</span><span class="op" id="2405616">,</span>&nbsp;<span class="ident" id="2405618">err</span><br>
<span class="lineno"></span><span class="op" id="2405622">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2405625">func</span>&nbsp;<span class="ident" id="2405630">GetsockoptIPMreq</span><span class="op" id="2405646">(</span><span class="ident" id="2405647">fd</span><span class="op" id="2405649">,</span>&nbsp;<span class="ident" id="2405651">level</span><span class="op" id="2405656">,</span>&nbsp;<span class="ident" id="2405658">opt</span>&nbsp;<span class="builtintype" id="2405662">int</span><span class="op" id="2405665">)</span>&nbsp;<span class="op" id="2405667">(</span><span class="op" id="2405668">*</span><span class="ident" id="2405669">IPMreq</span><span class="op" id="2405675">,</span>&nbsp;<span class="builtintype" id="2405677">error</span><span class="op" id="2405682">)</span>&nbsp;<span class="op" id="2405684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405687">var</span>&nbsp;<span class="ident" id="2405691">value</span>&nbsp;<span class="ident" id="2405697">IPMreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405705">vallen</span>&nbsp;<span class="op" id="2405712">:=</span>&nbsp;<span class="ident" id="2405715">_Socklen</span><span class="op" id="2405723">(</span><span class="ident" id="2405724">SizeofIPMreq</span><span class="op" id="2405736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405739">err</span>&nbsp;<span class="op" id="2405743">:=</span>&nbsp;<span class="ident" id="2405746">getsockopt</span><span class="op" id="2405756">(</span><span class="ident" id="2405757">fd</span><span class="op" id="2405759">,</span>&nbsp;<span class="ident" id="2405761">level</span><span class="op" id="2405766">,</span>&nbsp;<span class="ident" id="2405768">opt</span><span class="op" id="2405771">,</span>&nbsp;<span class="ident" id="2405773">unsafe</span><span class="op" id="2405779">.</span><span class="ident" id="2405780">Pointer</span><span class="op" id="2405787">(</span><span class="op" id="2405788">&amp;</span><span class="ident" id="2405789">value</span><span class="op" id="2405794">)</span><span class="op" id="2405795">,</span>&nbsp;<span class="op" id="2405797">&amp;</span><span class="ident" id="2405798">vallen</span><span class="op" id="2405804">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405807">return</span>&nbsp;<span class="op" id="2405814">&amp;</span><span class="ident" id="2405815">value</span><span class="op" id="2405820">,</span>&nbsp;<span class="ident" id="2405822">err</span><br>
<span class="lineno"></span><span class="op" id="2405826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2405829">func</span>&nbsp;<span class="ident" id="2405834">GetsockoptIPMreqn</span><span class="op" id="2405851">(</span><span class="ident" id="2405852">fd</span><span class="op" id="2405854">,</span>&nbsp;<span class="ident" id="2405856">level</span><span class="op" id="2405861">,</span>&nbsp;<span class="ident" id="2405863">opt</span>&nbsp;<span class="builtintype" id="2405867">int</span><span class="op" id="2405870">)</span>&nbsp;<span class="op" id="2405872">(</span><span class="op" id="2405873">*</span><span class="ident" id="2405874">IPMreqn</span><span class="op" id="2405881">,</span>&nbsp;<span class="builtintype" id="2405883">error</span><span class="op" id="2405888">)</span>&nbsp;<span class="op" id="2405890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405893">var</span>&nbsp;<span class="ident" id="2405897">value</span>&nbsp;<span class="ident" id="2405903">IPMreqn</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405912">vallen</span>&nbsp;<span class="op" id="2405919">:=</span>&nbsp;<span class="ident" id="2405922">_Socklen</span><span class="op" id="2405930">(</span><span class="ident" id="2405931">SizeofIPMreqn</span><span class="op" id="2405944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405947">err</span>&nbsp;<span class="op" id="2405951">:=</span>&nbsp;<span class="ident" id="2405954">getsockopt</span><span class="op" id="2405964">(</span><span class="ident" id="2405965">fd</span><span class="op" id="2405967">,</span>&nbsp;<span class="ident" id="2405969">level</span><span class="op" id="2405974">,</span>&nbsp;<span class="ident" id="2405976">opt</span><span class="op" id="2405979">,</span>&nbsp;<span class="ident" id="2405981">unsafe</span><span class="op" id="2405987">.</span><span class="ident" id="2405988">Pointer</span><span class="op" id="2405995">(</span><span class="op" id="2405996">&amp;</span><span class="ident" id="2405997">value</span><span class="op" id="2406002">)</span><span class="op" id="2406003">,</span>&nbsp;<span class="op" id="2406005">&amp;</span><span class="ident" id="2406006">vallen</span><span class="op" id="2406012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406015">return</span>&nbsp;<span class="op" id="2406022">&amp;</span><span class="ident" id="2406023">value</span><span class="op" id="2406028">,</span>&nbsp;<span class="ident" id="2406030">err</span><br>
<span class="lineno"></span><span class="op" id="2406034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="2406037">func</span>&nbsp;<span class="ident" id="2406042">GetsockoptIPv6Mreq</span><span class="op" id="2406060">(</span><span class="ident" id="2406061">fd</span><span class="op" id="2406063">,</span>&nbsp;<span class="ident" id="2406065">level</span><span class="op" id="2406070">,</span>&nbsp;<span class="ident" id="2406072">opt</span>&nbsp;<span class="builtintype" id="2406076">int</span><span class="op" id="2406079">)</span>&nbsp;<span class="op" id="2406081">(</span><span class="op" id="2406082">*</span><span class="ident" id="2406083">IPv6Mreq</span><span class="op" id="2406091">,</span>&nbsp;<span class="builtintype" id="2406093">error</span><span class="op" id="2406098">)</span>&nbsp;<span class="op" id="2406100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406103">var</span>&nbsp;<span class="ident" id="2406107">value</span>&nbsp;<span class="ident" id="2406113">IPv6Mreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406123">vallen</span>&nbsp;<span class="op" id="2406130">:=</span>&nbsp;<span class="ident" id="2406133">_Socklen</span><span class="op" id="2406141">(</span><span class="ident" id="2406142">SizeofIPv6Mreq</span><span class="op" id="2406156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406159">err</span>&nbsp;<span class="op" id="2406163">:=</span>&nbsp;<span class="ident" id="2406166">getsockopt</span><span class="op" id="2406176">(</span><span class="ident" id="2406177">fd</span><span class="op" id="2406179">,</span>&nbsp;<span class="ident" id="2406181">level</span><span class="op" id="2406186">,</span>&nbsp;<span class="ident" id="2406188">opt</span><span class="op" id="2406191">,</span>&nbsp;<span class="ident" id="2406193">unsafe</span><span class="op" id="2406199">.</span><span class="ident" id="2406200">Pointer</span><span class="op" id="2406207">(</span><span class="op" id="2406208">&amp;</span><span class="ident" id="2406209">value</span><span class="op" id="2406214">)</span><span class="op" id="2406215">,</span>&nbsp;<span class="op" id="2406217">&amp;</span><span class="ident" id="2406218">vallen</span><span class="op" id="2406224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406227">return</span>&nbsp;<span class="op" id="2406234">&amp;</span><span class="ident" id="2406235">value</span><span class="op" id="2406240">,</span>&nbsp;<span class="ident" id="2406242">err</span><br>
<span class="lineno">470</span><span class="op" id="2406246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406249">func</span>&nbsp;<span class="ident" id="2406254">GetsockoptIPv6MTUInfo</span><span class="op" id="2406275">(</span><span class="ident" id="2406276">fd</span><span class="op" id="2406278">,</span>&nbsp;<span class="ident" id="2406280">level</span><span class="op" id="2406285">,</span>&nbsp;<span class="ident" id="2406287">opt</span>&nbsp;<span class="builtintype" id="2406291">int</span><span class="op" id="2406294">)</span>&nbsp;<span class="op" id="2406296">(</span><span class="op" id="2406297">*</span><span class="ident" id="2406298">IPv6MTUInfo</span><span class="op" id="2406309">,</span>&nbsp;<span class="builtintype" id="2406311">error</span><span class="op" id="2406316">)</span>&nbsp;<span class="op" id="2406318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406321">var</span>&nbsp;<span class="ident" id="2406325">value</span>&nbsp;<span class="ident" id="2406331">IPv6MTUInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406344">vallen</span>&nbsp;<span class="op" id="2406351">:=</span>&nbsp;<span class="ident" id="2406354">_Socklen</span><span class="op" id="2406362">(</span><span class="ident" id="2406363">SizeofIPv6MTUInfo</span><span class="op" id="2406380">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406383">err</span>&nbsp;<span class="op" id="2406387">:=</span>&nbsp;<span class="ident" id="2406390">getsockopt</span><span class="op" id="2406400">(</span><span class="ident" id="2406401">fd</span><span class="op" id="2406403">,</span>&nbsp;<span class="ident" id="2406405">level</span><span class="op" id="2406410">,</span>&nbsp;<span class="ident" id="2406412">opt</span><span class="op" id="2406415">,</span>&nbsp;<span class="ident" id="2406417">unsafe</span><span class="op" id="2406423">.</span><span class="ident" id="2406424">Pointer</span><span class="op" id="2406431">(</span><span class="op" id="2406432">&amp;</span><span class="ident" id="2406433">value</span><span class="op" id="2406438">)</span><span class="op" id="2406439">,</span>&nbsp;<span class="op" id="2406441">&amp;</span><span class="ident" id="2406442">vallen</span><span class="op" id="2406448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406451">return</span>&nbsp;<span class="op" id="2406458">&amp;</span><span class="ident" id="2406459">value</span><span class="op" id="2406464">,</span>&nbsp;<span class="ident" id="2406466">err</span><br>
<span class="lineno"></span><span class="op" id="2406470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406473">func</span>&nbsp;<span class="ident" id="2406478">GetsockoptICMPv6Filter</span><span class="op" id="2406500">(</span><span class="ident" id="2406501">fd</span><span class="op" id="2406503">,</span>&nbsp;<span class="ident" id="2406505">level</span><span class="op" id="2406510">,</span>&nbsp;<span class="ident" id="2406512">opt</span>&nbsp;<span class="builtintype" id="2406516">int</span><span class="op" id="2406519">)</span>&nbsp;<span class="op" id="2406521">(</span><span class="op" id="2406522">*</span><span class="ident" id="2406523">ICMPv6Filter</span><span class="op" id="2406535">,</span>&nbsp;<span class="builtintype" id="2406537">error</span><span class="op" id="2406542">)</span>&nbsp;<span class="op" id="2406544">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406547">var</span>&nbsp;<span class="ident" id="2406551">value</span>&nbsp;<span class="ident" id="2406557">ICMPv6Filter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406571">vallen</span>&nbsp;<span class="op" id="2406578">:=</span>&nbsp;<span class="ident" id="2406581">_Socklen</span><span class="op" id="2406589">(</span><span class="ident" id="2406590">SizeofICMPv6Filter</span><span class="op" id="2406608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406611">err</span>&nbsp;<span class="op" id="2406615">:=</span>&nbsp;<span class="ident" id="2406618">getsockopt</span><span class="op" id="2406628">(</span><span class="ident" id="2406629">fd</span><span class="op" id="2406631">,</span>&nbsp;<span class="ident" id="2406633">level</span><span class="op" id="2406638">,</span>&nbsp;<span class="ident" id="2406640">opt</span><span class="op" id="2406643">,</span>&nbsp;<span class="ident" id="2406645">unsafe</span><span class="op" id="2406651">.</span><span class="ident" id="2406652">Pointer</span><span class="op" id="2406659">(</span><span class="op" id="2406660">&amp;</span><span class="ident" id="2406661">value</span><span class="op" id="2406666">)</span><span class="op" id="2406667">,</span>&nbsp;<span class="op" id="2406669">&amp;</span><span class="ident" id="2406670">vallen</span><span class="op" id="2406676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406679">return</span>&nbsp;<span class="op" id="2406686">&amp;</span><span class="ident" id="2406687">value</span><span class="op" id="2406692">,</span>&nbsp;<span class="ident" id="2406694">err</span><br>
<span class="lineno"></span><span class="op" id="2406698">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="2406701">func</span>&nbsp;<span class="ident" id="2406706">GetsockoptUcred</span><span class="op" id="2406721">(</span><span class="ident" id="2406722">fd</span><span class="op" id="2406724">,</span>&nbsp;<span class="ident" id="2406726">level</span><span class="op" id="2406731">,</span>&nbsp;<span class="ident" id="2406733">opt</span>&nbsp;<span class="builtintype" id="2406737">int</span><span class="op" id="2406740">)</span>&nbsp;<span class="op" id="2406742">(</span><span class="op" id="2406743">*</span><span class="ident" id="2406744">Ucred</span><span class="op" id="2406749">,</span>&nbsp;<span class="builtintype" id="2406751">error</span><span class="op" id="2406756">)</span>&nbsp;<span class="op" id="2406758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406761">var</span>&nbsp;<span class="ident" id="2406765">value</span>&nbsp;<span class="ident" id="2406771">Ucred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406778">vallen</span>&nbsp;<span class="op" id="2406785">:=</span>&nbsp;<span class="ident" id="2406788">_Socklen</span><span class="op" id="2406796">(</span><span class="ident" id="2406797">SizeofUcred</span><span class="op" id="2406808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406811">err</span>&nbsp;<span class="op" id="2406815">:=</span>&nbsp;<span class="ident" id="2406818">getsockopt</span><span class="op" id="2406828">(</span><span class="ident" id="2406829">fd</span><span class="op" id="2406831">,</span>&nbsp;<span class="ident" id="2406833">level</span><span class="op" id="2406838">,</span>&nbsp;<span class="ident" id="2406840">opt</span><span class="op" id="2406843">,</span>&nbsp;<span class="ident" id="2406845">unsafe</span><span class="op" id="2406851">.</span><span class="ident" id="2406852">Pointer</span><span class="op" id="2406859">(</span><span class="op" id="2406860">&amp;</span><span class="ident" id="2406861">value</span><span class="op" id="2406866">)</span><span class="op" id="2406867">,</span>&nbsp;<span class="op" id="2406869">&amp;</span><span class="ident" id="2406870">vallen</span><span class="op" id="2406876">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406879">return</span>&nbsp;<span class="op" id="2406886">&amp;</span><span class="ident" id="2406887">value</span><span class="op" id="2406892">,</span>&nbsp;<span class="ident" id="2406894">err</span><br>
<span class="lineno"></span><span class="op" id="2406898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406901">func</span>&nbsp;<span class="ident" id="2406906">SetsockoptIPMreqn</span><span class="op" id="2406923">(</span><span class="ident" id="2406924">fd</span><span class="op" id="2406926">,</span>&nbsp;<span class="ident" id="2406928">level</span><span class="op" id="2406933">,</span>&nbsp;<span class="ident" id="2406935">opt</span>&nbsp;<span class="builtintype" id="2406939">int</span><span class="op" id="2406942">,</span>&nbsp;<span class="ident" id="2406944">mreq</span>&nbsp;<span class="op" id="2406949">*</span><span class="ident" id="2406950">IPMreqn</span><span class="op" id="2406957">)</span>&nbsp;<span class="op" id="2406959">(</span><span class="ident" id="2406960">err</span>&nbsp;<span class="builtintype" id="2406964">error</span><span class="op" id="2406969">)</span>&nbsp;<span class="op" id="2406971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406974">return</span>&nbsp;<span class="ident" id="2406981">setsockopt</span><span class="op" id="2406991">(</span><span class="ident" id="2406992">fd</span><span class="op" id="2406994">,</span>&nbsp;<span class="ident" id="2406996">level</span><span class="op" id="2407001">,</span>&nbsp;<span class="ident" id="2407003">opt</span><span class="op" id="2407006">,</span>&nbsp;<span class="ident" id="2407008">unsafe</span><span class="op" id="2407014">.</span><span class="ident" id="2407015">Pointer</span><span class="op" id="2407022">(</span><span class="ident" id="2407023">mreq</span><span class="op" id="2407027">)</span><span class="op" id="2407028">,</span>&nbsp;<span class="ident" id="2407030">unsafe</span><span class="op" id="2407036">.</span><span class="ident" id="2407037">Sizeof</span><span class="op" id="2407043">(</span><span class="op" id="2407044">*</span><span class="ident" id="2407045">mreq</span><span class="op" id="2407049">)</span><span class="op" id="2407050">)</span><br>
<span class="lineno">495</span><span class="op" id="2407052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2407055">func</span>&nbsp;<span class="ident" id="2407060">Recvmsg</span><span class="op" id="2407067">(</span><span class="ident" id="2407068">fd</span>&nbsp;<span class="builtintype" id="2407071">int</span><span class="op" id="2407074">,</span>&nbsp;<span class="ident" id="2407076">p</span><span class="op" id="2407077">,</span>&nbsp;<span class="ident" id="2407079">oob</span>&nbsp;<span class="op" id="2407083">[</span><span class="op" id="2407084">]</span><span class="builtintype" id="2407085">byte</span><span class="op" id="2407089">,</span>&nbsp;<span class="ident" id="2407091">flags</span>&nbsp;<span class="builtintype" id="2407097">int</span><span class="op" id="2407100">)</span>&nbsp;<span class="op" id="2407102">(</span><span class="ident" id="2407103">n</span><span class="op" id="2407104">,</span>&nbsp;<span class="ident" id="2407106">oobn</span>&nbsp;<span class="builtintype" id="2407111">int</span><span class="op" id="2407114">,</span>&nbsp;<span class="ident" id="2407116">recvflags</span>&nbsp;<span class="builtintype" id="2407126">int</span><span class="op" id="2407129">,</span>&nbsp;<span class="ident" id="2407131">from</span>&nbsp;<span class="ident" id="2407136">Sockaddr</span><span class="op" id="2407144">,</span>&nbsp;<span class="ident" id="2407146">err</span>&nbsp;<span class="builtintype" id="2407150">error</span><span class="op" id="2407155">)</span>&nbsp;<span class="op" id="2407157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407160">var</span>&nbsp;<span class="ident" id="2407164">msg</span>&nbsp;<span class="ident" id="2407168">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407176">var</span>&nbsp;<span class="ident" id="2407180">rsa</span>&nbsp;<span class="ident" id="2407184">RawSockaddrAny</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407200">msg</span><span class="op" id="2407203">.</span><span class="ident" id="2407204">Name</span>&nbsp;<span class="op" id="2407209">=</span>&nbsp;<span class="op" id="2407211">(</span><span class="op" id="2407212">*</span><span class="builtintype" id="2407213">byte</span><span class="op" id="2407217">)</span><span class="op" id="2407218">(</span><span class="ident" id="2407219">unsafe</span><span class="op" id="2407225">.</span><span class="ident" id="2407226">Pointer</span><span class="op" id="2407233">(</span><span class="op" id="2407234">&amp;</span><span class="ident" id="2407235">rsa</span><span class="op" id="2407238">)</span><span class="op" id="2407239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407242">msg</span><span class="op" id="2407245">.</span><span class="ident" id="2407246">Namelen</span>&nbsp;<span class="op" id="2407254">=</span>&nbsp;<span class="builtintype" id="2407256">uint32</span><span class="op" id="2407262">(</span><span class="ident" id="2407263">SizeofSockaddrAny</span><span class="op" id="2407280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407283">var</span>&nbsp;<span class="ident" id="2407287">iov</span>&nbsp;<span class="ident" id="2407291">Iovec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407298">if</span>&nbsp;<span class="builtinfunc" id="2407301">len</span><span class="op" id="2407304">(</span><span class="ident" id="2407305">p</span><span class="op" id="2407306">)</span>&nbsp;<span class="op" id="2407308">&gt;</span>&nbsp;<span class="num" id="2407310">0</span>&nbsp;<span class="op" id="2407312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407316">iov</span><span class="op" id="2407319">.</span><span class="ident" id="2407320">Base</span>&nbsp;<span class="op" id="2407325">=</span>&nbsp;<span class="op" id="2407327">(</span><span class="op" id="2407328">*</span><span class="builtintype" id="2407329">byte</span><span class="op" id="2407333">)</span><span class="op" id="2407334">(</span><span class="ident" id="2407335">unsafe</span><span class="op" id="2407341">.</span><span class="ident" id="2407342">Pointer</span><span class="op" id="2407349">(</span><span class="op" id="2407350">&amp;</span><span class="ident" id="2407351">p</span><span class="op" id="2407352">[</span><span class="num" id="2407353">0</span><span class="op" id="2407354">]</span><span class="op" id="2407355">)</span><span class="op" id="2407356">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407360">iov</span><span class="op" id="2407363">.</span><span class="ident" id="2407364">SetLen</span><span class="op" id="2407370">(</span><span class="builtinfunc" id="2407371">len</span><span class="op" id="2407374">(</span><span class="ident" id="2407375">p</span><span class="op" id="2407376">)</span><span class="op" id="2407377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2407380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407383">var</span>&nbsp;<span class="ident" id="2407387">dummy</span>&nbsp;<span class="builtintype" id="2407393">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407399">if</span>&nbsp;<span class="builtinfunc" id="2407402">len</span><span class="op" id="2407405">(</span><span class="ident" id="2407406">oob</span><span class="op" id="2407409">)</span>&nbsp;<span class="op" id="2407411">&gt;</span>&nbsp;<span class="num" id="2407413">0</span>&nbsp;<span class="op" id="2407415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2407419">//&nbsp;receive&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407457">if</span>&nbsp;<span class="builtinfunc" id="2407460">len</span><span class="op" id="2407463">(</span><span class="ident" id="2407464">p</span><span class="op" id="2407465">)</span>&nbsp;<span class="op" id="2407467">==</span>&nbsp;<span class="num" id="2407470">0</span>&nbsp;<span class="op" id="2407472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407477">iov</span><span class="op" id="2407480">.</span><span class="ident" id="2407481">Base</span>&nbsp;<span class="op" id="2407486">=</span>&nbsp;<span class="op" id="2407488">&amp;</span><span class="ident" id="2407489">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407498">iov</span><span class="op" id="2407501">.</span><span class="ident" id="2407502">SetLen</span><span class="op" id="2407508">(</span><span class="num" id="2407509">1</span><span class="op" id="2407510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2407514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407518">msg</span><span class="op" id="2407521">.</span><span class="ident" id="2407522">Control</span>&nbsp;<span class="op" id="2407530">=</span>&nbsp;<span class="op" id="2407532">(</span><span class="op" id="2407533">*</span><span class="builtintype" id="2407534">byte</span><span class="op" id="2407538">)</span><span class="op" id="2407539">(</span><span class="ident" id="2407540">unsafe</span><span class="op" id="2407546">.</span><span class="ident" id="2407547">Pointer</span><span class="op" id="2407554">(</span><span class="op" id="2407555">&amp;</span><span class="ident" id="2407556">oob</span><span class="op" id="2407559">[</span><span class="num" id="2407560">0</span><span class="op" id="2407561">]</span><span class="op" id="2407562">)</span><span class="op" id="2407563">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407567">msg</span><span class="op" id="2407570">.</span><span class="ident" id="2407571">SetControllen</span><span class="op" id="2407584">(</span><span class="builtinfunc" id="2407585">len</span><span class="op" id="2407588">(</span><span class="ident" id="2407589">oob</span><span class="op" id="2407592">)</span><span class="op" id="2407593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2407596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407599">msg</span><span class="op" id="2407602">.</span><span class="ident" id="2407603">Iov</span>&nbsp;<span class="op" id="2407607">=</span>&nbsp;<span class="op" id="2407609">&amp;</span><span class="ident" id="2407610">iov</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407615">msg</span><span class="op" id="2407618">.</span><span class="ident" id="2407619">Iovlen</span>&nbsp;<span class="op" id="2407626">=</span>&nbsp;<span class="num" id="2407628">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407631">if</span>&nbsp;<span class="ident" id="2407634">n</span><span class="op" id="2407635">,</span>&nbsp;<span class="ident" id="2407637">err</span>&nbsp;<span class="op" id="2407641">=</span>&nbsp;<span class="ident" id="2407643">recvmsg</span><span class="op" id="2407650">(</span><span class="ident" id="2407651">fd</span><span class="op" id="2407653">,</span>&nbsp;<span class="op" id="2407655">&amp;</span><span class="ident" id="2407656">msg</span><span class="op" id="2407659">,</span>&nbsp;<span class="ident" id="2407661">flags</span><span class="op" id="2407666">)</span><span class="op" id="2407667">;</span>&nbsp;<span class="ident" id="2407669">err</span>&nbsp;<span class="op" id="2407673">!=</span>&nbsp;<span class="ident" id="2407676">nil</span>&nbsp;<span class="op" id="2407680">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407684">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2407692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407695">oobn</span>&nbsp;<span class="op" id="2407700">=</span>&nbsp;<span class="builtintype" id="2407702">int</span><span class="op" id="2407705">(</span><span class="ident" id="2407706">msg</span><span class="op" id="2407709">.</span><span class="ident" id="2407710">Controllen</span><span class="op" id="2407720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407723">recvflags</span>&nbsp;<span class="op" id="2407733">=</span>&nbsp;<span class="builtintype" id="2407735">int</span><span class="op" id="2407738">(</span><span class="ident" id="2407739">msg</span><span class="op" id="2407742">.</span><span class="ident" id="2407743">Flags</span><span class="op" id="2407748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2407751">//&nbsp;source&nbsp;address&nbsp;is&nbsp;only&nbsp;specified&nbsp;if&nbsp;the&nbsp;socket&nbsp;is&nbsp;unconnected</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407817">if</span>&nbsp;<span class="ident" id="2407820">rsa</span><span class="op" id="2407823">.</span><span class="ident" id="2407824">Addr</span><span class="op" id="2407828">.</span><span class="ident" id="2407829">Family</span>&nbsp;<span class="op" id="2407836">!=</span>&nbsp;<span class="ident" id="2407839">AF_UNSPEC</span>&nbsp;<span class="op" id="2407849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407853">from</span><span class="op" id="2407857">,</span>&nbsp;<span class="ident" id="2407859">err</span>&nbsp;<span class="op" id="2407863">=</span>&nbsp;<span class="ident" id="2407865">anyToSockaddr</span><span class="op" id="2407878">(</span><span class="op" id="2407879">&amp;</span><span class="ident" id="2407880">rsa</span><span class="op" id="2407883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2407886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407889">return</span><br>
<span class="lineno"></span><span class="op" id="2407896">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="2407899">func</span>&nbsp;<span class="ident" id="2407904">Sendmsg</span><span class="op" id="2407911">(</span><span class="ident" id="2407912">fd</span>&nbsp;<span class="builtintype" id="2407915">int</span><span class="op" id="2407918">,</span>&nbsp;<span class="ident" id="2407920">p</span><span class="op" id="2407921">,</span>&nbsp;<span class="ident" id="2407923">oob</span>&nbsp;<span class="op" id="2407927">[</span><span class="op" id="2407928">]</span><span class="builtintype" id="2407929">byte</span><span class="op" id="2407933">,</span>&nbsp;<span class="ident" id="2407935">to</span>&nbsp;<span class="ident" id="2407938">Sockaddr</span><span class="op" id="2407946">,</span>&nbsp;<span class="ident" id="2407948">flags</span>&nbsp;<span class="builtintype" id="2407954">int</span><span class="op" id="2407957">)</span>&nbsp;<span class="op" id="2407959">(</span><span class="ident" id="2407960">err</span>&nbsp;<span class="builtintype" id="2407964">error</span><span class="op" id="2407969">)</span>&nbsp;<span class="op" id="2407971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407974">_</span><span class="op" id="2407975">,</span>&nbsp;<span class="ident" id="2407977">err</span>&nbsp;<span class="op" id="2407981">=</span>&nbsp;<span class="ident" id="2407983">SendmsgN</span><span class="op" id="2407991">(</span><span class="ident" id="2407992">fd</span><span class="op" id="2407994">,</span>&nbsp;<span class="ident" id="2407996">p</span><span class="op" id="2407997">,</span>&nbsp;<span class="ident" id="2407999">oob</span><span class="op" id="2408002">,</span>&nbsp;<span class="ident" id="2408004">to</span><span class="op" id="2408006">,</span>&nbsp;<span class="ident" id="2408008">flags</span><span class="op" id="2408013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408016">return</span><br>
<span class="lineno"></span><span class="op" id="2408023">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="2408026">func</span>&nbsp;<span class="ident" id="2408031">SendmsgN</span><span class="op" id="2408039">(</span><span class="ident" id="2408040">fd</span>&nbsp;<span class="builtintype" id="2408043">int</span><span class="op" id="2408046">,</span>&nbsp;<span class="ident" id="2408048">p</span><span class="op" id="2408049">,</span>&nbsp;<span class="ident" id="2408051">oob</span>&nbsp;<span class="op" id="2408055">[</span><span class="op" id="2408056">]</span><span class="builtintype" id="2408057">byte</span><span class="op" id="2408061">,</span>&nbsp;<span class="ident" id="2408063">to</span>&nbsp;<span class="ident" id="2408066">Sockaddr</span><span class="op" id="2408074">,</span>&nbsp;<span class="ident" id="2408076">flags</span>&nbsp;<span class="builtintype" id="2408082">int</span><span class="op" id="2408085">)</span>&nbsp;<span class="op" id="2408087">(</span><span class="ident" id="2408088">n</span>&nbsp;<span class="builtintype" id="2408090">int</span><span class="op" id="2408093">,</span>&nbsp;<span class="ident" id="2408095">err</span>&nbsp;<span class="builtintype" id="2408099">error</span><span class="op" id="2408104">)</span>&nbsp;<span class="op" id="2408106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408109">var</span>&nbsp;<span class="ident" id="2408113">ptr</span>&nbsp;<span class="ident" id="2408117">unsafe</span><span class="op" id="2408123">.</span><span class="ident" id="2408124">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408133">var</span>&nbsp;<span class="ident" id="2408137">salen</span>&nbsp;<span class="ident" id="2408143">_Socklen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408153">if</span>&nbsp;<span class="ident" id="2408156">to</span>&nbsp;<span class="op" id="2408159">!=</span>&nbsp;<span class="ident" id="2408162">nil</span>&nbsp;<span class="op" id="2408166">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408170">var</span>&nbsp;<span class="ident" id="2408174">err</span>&nbsp;<span class="builtintype" id="2408178">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408186">ptr</span><span class="op" id="2408189">,</span>&nbsp;<span class="ident" id="2408191">salen</span><span class="op" id="2408196">,</span>&nbsp;<span class="ident" id="2408198">err</span>&nbsp;<span class="op" id="2408202">=</span>&nbsp;<span class="ident" id="2408204">to</span><span class="op" id="2408206">.</span><span class="ident" id="2408207">sockaddr</span><span class="op" id="2408215">(</span><span class="op" id="2408216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408220">if</span>&nbsp;<span class="ident" id="2408223">err</span>&nbsp;<span class="op" id="2408227">!=</span>&nbsp;<span class="ident" id="2408230">nil</span>&nbsp;<span class="op" id="2408234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408239">return</span>&nbsp;<span class="num" id="2408246">0</span><span class="op" id="2408247">,</span>&nbsp;<span class="ident" id="2408249">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408255">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408261">var</span>&nbsp;<span class="ident" id="2408265">msg</span>&nbsp;<span class="ident" id="2408269">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408277">msg</span><span class="op" id="2408280">.</span><span class="ident" id="2408281">Name</span>&nbsp;<span class="op" id="2408286">=</span>&nbsp;<span class="op" id="2408288">(</span><span class="op" id="2408289">*</span><span class="builtintype" id="2408290">byte</span><span class="op" id="2408294">)</span><span class="op" id="2408295">(</span><span class="ident" id="2408296">unsafe</span><span class="op" id="2408302">.</span><span class="ident" id="2408303">Pointer</span><span class="op" id="2408310">(</span><span class="ident" id="2408311">ptr</span><span class="op" id="2408314">)</span><span class="op" id="2408315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408318">msg</span><span class="op" id="2408321">.</span><span class="ident" id="2408322">Namelen</span>&nbsp;<span class="op" id="2408330">=</span>&nbsp;<span class="builtintype" id="2408332">uint32</span><span class="op" id="2408338">(</span><span class="ident" id="2408339">salen</span><span class="op" id="2408344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408347">var</span>&nbsp;<span class="ident" id="2408351">iov</span>&nbsp;<span class="ident" id="2408355">Iovec</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408362">if</span>&nbsp;<span class="builtinfunc" id="2408365">len</span><span class="op" id="2408368">(</span><span class="ident" id="2408369">p</span><span class="op" id="2408370">)</span>&nbsp;<span class="op" id="2408372">&gt;</span>&nbsp;<span class="num" id="2408374">0</span>&nbsp;<span class="op" id="2408376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408380">iov</span><span class="op" id="2408383">.</span><span class="ident" id="2408384">Base</span>&nbsp;<span class="op" id="2408389">=</span>&nbsp;<span class="op" id="2408391">(</span><span class="op" id="2408392">*</span><span class="builtintype" id="2408393">byte</span><span class="op" id="2408397">)</span><span class="op" id="2408398">(</span><span class="ident" id="2408399">unsafe</span><span class="op" id="2408405">.</span><span class="ident" id="2408406">Pointer</span><span class="op" id="2408413">(</span><span class="op" id="2408414">&amp;</span><span class="ident" id="2408415">p</span><span class="op" id="2408416">[</span><span class="num" id="2408417">0</span><span class="op" id="2408418">]</span><span class="op" id="2408419">)</span><span class="op" id="2408420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408424">iov</span><span class="op" id="2408427">.</span><span class="ident" id="2408428">SetLen</span><span class="op" id="2408434">(</span><span class="builtinfunc" id="2408435">len</span><span class="op" id="2408438">(</span><span class="ident" id="2408439">p</span><span class="op" id="2408440">)</span><span class="op" id="2408441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408447">var</span>&nbsp;<span class="ident" id="2408451">dummy</span>&nbsp;<span class="builtintype" id="2408457">byte</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408463">if</span>&nbsp;<span class="builtinfunc" id="2408466">len</span><span class="op" id="2408469">(</span><span class="ident" id="2408470">oob</span><span class="op" id="2408473">)</span>&nbsp;<span class="op" id="2408475">&gt;</span>&nbsp;<span class="num" id="2408477">0</span>&nbsp;<span class="op" id="2408479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2408483">//&nbsp;send&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408518">if</span>&nbsp;<span class="builtinfunc" id="2408521">len</span><span class="op" id="2408524">(</span><span class="ident" id="2408525">p</span><span class="op" id="2408526">)</span>&nbsp;<span class="op" id="2408528">==</span>&nbsp;<span class="num" id="2408531">0</span>&nbsp;<span class="op" id="2408533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408538">iov</span><span class="op" id="2408541">.</span><span class="ident" id="2408542">Base</span>&nbsp;<span class="op" id="2408547">=</span>&nbsp;<span class="op" id="2408549">&amp;</span><span class="ident" id="2408550">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408559">iov</span><span class="op" id="2408562">.</span><span class="ident" id="2408563">SetLen</span><span class="op" id="2408569">(</span><span class="num" id="2408570">1</span><span class="op" id="2408571">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408579">msg</span><span class="op" id="2408582">.</span><span class="ident" id="2408583">Control</span>&nbsp;<span class="op" id="2408591">=</span>&nbsp;<span class="op" id="2408593">(</span><span class="op" id="2408594">*</span><span class="builtintype" id="2408595">byte</span><span class="op" id="2408599">)</span><span class="op" id="2408600">(</span><span class="ident" id="2408601">unsafe</span><span class="op" id="2408607">.</span><span class="ident" id="2408608">Pointer</span><span class="op" id="2408615">(</span><span class="op" id="2408616">&amp;</span><span class="ident" id="2408617">oob</span><span class="op" id="2408620">[</span><span class="num" id="2408621">0</span><span class="op" id="2408622">]</span><span class="op" id="2408623">)</span><span class="op" id="2408624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408628">msg</span><span class="op" id="2408631">.</span><span class="ident" id="2408632">SetControllen</span><span class="op" id="2408645">(</span><span class="builtinfunc" id="2408646">len</span><span class="op" id="2408649">(</span><span class="ident" id="2408650">oob</span><span class="op" id="2408653">)</span><span class="op" id="2408654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408660">msg</span><span class="op" id="2408663">.</span><span class="ident" id="2408664">Iov</span>&nbsp;<span class="op" id="2408668">=</span>&nbsp;<span class="op" id="2408670">&amp;</span><span class="ident" id="2408671">iov</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408676">msg</span><span class="op" id="2408679">.</span><span class="ident" id="2408680">Iovlen</span>&nbsp;<span class="op" id="2408687">=</span>&nbsp;<span class="num" id="2408689">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408692">if</span>&nbsp;<span class="ident" id="2408695">n</span><span class="op" id="2408696">,</span>&nbsp;<span class="ident" id="2408698">err</span>&nbsp;<span class="op" id="2408702">=</span>&nbsp;<span class="ident" id="2408704">sendmsg</span><span class="op" id="2408711">(</span><span class="ident" id="2408712">fd</span><span class="op" id="2408714">,</span>&nbsp;<span class="op" id="2408716">&amp;</span><span class="ident" id="2408717">msg</span><span class="op" id="2408720">,</span>&nbsp;<span class="ident" id="2408722">flags</span><span class="op" id="2408727">)</span><span class="op" id="2408728">;</span>&nbsp;<span class="ident" id="2408730">err</span>&nbsp;<span class="op" id="2408734">!=</span>&nbsp;<span class="ident" id="2408737">nil</span>&nbsp;<span class="op" id="2408741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408745">return</span>&nbsp;<span class="num" id="2408752">0</span><span class="op" id="2408753">,</span>&nbsp;<span class="ident" id="2408755">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408763">if</span>&nbsp;<span class="builtinfunc" id="2408766">len</span><span class="op" id="2408769">(</span><span class="ident" id="2408770">oob</span><span class="op" id="2408773">)</span>&nbsp;<span class="op" id="2408775">&gt;</span>&nbsp;<span class="num" id="2408777">0</span>&nbsp;<span class="op" id="2408779">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2408782">len</span><span class="op" id="2408785">(</span><span class="ident" id="2408786">p</span><span class="op" id="2408787">)</span>&nbsp;<span class="op" id="2408789">==</span>&nbsp;<span class="num" id="2408792">0</span>&nbsp;<span class="op" id="2408794">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408798">n</span>&nbsp;<span class="op" id="2408800">=</span>&nbsp;<span class="num" id="2408802">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408808">return</span>&nbsp;<span class="ident" id="2408815">n</span><span class="op" id="2408816">,</span>&nbsp;<span class="ident" id="2408818">nil</span><br>
<span class="lineno"></span><span class="op" id="2408822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="2408825">//&nbsp;BindToDevice&nbsp;binds&nbsp;the&nbsp;socket&nbsp;associated&nbsp;with&nbsp;fd&nbsp;to&nbsp;device.</span><br>
<span class="lineno"></span><span class="keyword" id="2408888">func</span>&nbsp;<span class="ident" id="2408893">BindToDevice</span><span class="op" id="2408905">(</span><span class="ident" id="2408906">fd</span>&nbsp;<span class="builtintype" id="2408909">int</span><span class="op" id="2408912">,</span>&nbsp;<span class="ident" id="2408914">device</span>&nbsp;<span class="builtintype" id="2408921">string</span><span class="op" id="2408927">)</span>&nbsp;<span class="op" id="2408929">(</span><span class="ident" id="2408930">err</span>&nbsp;<span class="builtintype" id="2408934">error</span><span class="op" id="2408939">)</span>&nbsp;<span class="op" id="2408941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408944">return</span>&nbsp;<span class="ident" id="2408951">SetsockoptString</span><span class="op" id="2408967">(</span><span class="ident" id="2408968">fd</span><span class="op" id="2408970">,</span>&nbsp;<span class="ident" id="2408972">SOL_SOCKET</span><span class="op" id="2408982">,</span>&nbsp;<span class="ident" id="2408984">SO_BINDTODEVICE</span><span class="op" id="2408999">,</span>&nbsp;<span class="ident" id="2409001">device</span><span class="op" id="2409007">)</span><br>
<span class="lineno"></span><span class="op" id="2409009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span><span class="comment" id="2409012">//sys&nbsp;&nbsp;&nbsp;&nbspptrace(request&nbsp;int,&nbsp;pid&nbsp;int,&nbsp;addr&nbsp;uintptr,&nbsp;data&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2409088">func</span>&nbsp;<span class="ident" id="2409093">ptracePeek</span><span class="op" id="2409103">(</span><span class="ident" id="2409104">req</span>&nbsp;<span class="builtintype" id="2409108">int</span><span class="op" id="2409111">,</span>&nbsp;<span class="ident" id="2409113">pid</span>&nbsp;<span class="builtintype" id="2409117">int</span><span class="op" id="2409120">,</span>&nbsp;<span class="ident" id="2409122">addr</span>&nbsp;<span class="builtintype" id="2409127">uintptr</span><span class="op" id="2409134">,</span>&nbsp;<span class="ident" id="2409136">out</span>&nbsp;<span class="op" id="2409140">[</span><span class="op" id="2409141">]</span><span class="builtintype" id="2409142">byte</span><span class="op" id="2409146">)</span>&nbsp;<span class="op" id="2409148">(</span><span class="ident" id="2409149">count</span>&nbsp;<span class="builtintype" id="2409155">int</span><span class="op" id="2409158">,</span>&nbsp;<span class="ident" id="2409160">err</span>&nbsp;<span class="builtintype" id="2409164">error</span><span class="op" id="2409169">)</span>&nbsp;<span class="op" id="2409171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409174">//&nbsp;The&nbsp;peek&nbsp;requests&nbsp;are&nbsp;machine-size&nbsp;oriented,&nbsp;so&nbsp;we&nbsp;wrap&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409237">//&nbsp;to&nbsp;retrieve&nbsp;arbitrary-length&nbsp;data.</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409277">//&nbsp;The&nbsp;ptrace&nbsp;syscall&nbsp;differs&nbsp;from&nbsp;glibc&#39;s&nbsp;ptrace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409329">//&nbsp;Peeks&nbsp;returns&nbsp;the&nbsp;word&nbsp;in&nbsp;*data,&nbsp;not&nbsp;as&nbsp;the&nbsp;return&nbsp;value.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409392">var</span>&nbsp;<span class="ident" id="2409396">buf</span>&nbsp;<span class="op" id="2409400">[</span><span class="ident" id="2409401">sizeofPtr</span><span class="op" id="2409410">]</span><span class="builtintype" id="2409411">byte</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409418">//&nbsp;Leading&nbsp;edge.&nbsp;&nbsp;PEEKTEXT/PEEKDATA&nbsp;don&#39;t&nbsp;require&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409477">//&nbsp;access&nbsp;(PEEKUSER&nbsp;warns&nbsp;that&nbsp;it&nbsp;might),&nbsp;but&nbsp;if&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409536">//&nbsp;align&nbsp;our&nbsp;reads,&nbsp;we&nbsp;might&nbsp;straddle&nbsp;an&nbsp;unmapped&nbsp;page</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409592">//&nbsp;boundary&nbsp;and&nbsp;not&nbsp;get&nbsp;the&nbsp;bytes&nbsp;leading&nbsp;up&nbsp;to&nbsp;the&nbsp;page</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409650">//&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409664">n</span>&nbsp;<span class="op" id="2409666">:=</span>&nbsp;<span class="num" id="2409669">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409672">if</span>&nbsp;<span class="ident" id="2409675">addr</span><span class="op" id="2409679">%</span><span class="ident" id="2409680">sizeofPtr</span>&nbsp;<span class="op" id="2409690">!=</span>&nbsp;<span class="num" id="2409693">0</span>&nbsp;<span class="op" id="2409695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409699">err</span>&nbsp;<span class="op" id="2409703">=</span>&nbsp;<span class="ident" id="2409705">ptrace</span><span class="op" id="2409711">(</span><span class="ident" id="2409712">req</span><span class="op" id="2409715">,</span>&nbsp;<span class="ident" id="2409717">pid</span><span class="op" id="2409720">,</span>&nbsp;<span class="ident" id="2409722">addr</span><span class="op" id="2409726">-</span><span class="ident" id="2409727">addr</span><span class="op" id="2409731">%</span><span class="ident" id="2409732">sizeofPtr</span><span class="op" id="2409741">,</span>&nbsp;<span class="builtintype" id="2409743">uintptr</span><span class="op" id="2409750">(</span><span class="ident" id="2409751">unsafe</span><span class="op" id="2409757">.</span><span class="ident" id="2409758">Pointer</span><span class="op" id="2409765">(</span><span class="op" id="2409766">&amp;</span><span class="ident" id="2409767">buf</span><span class="op" id="2409770">[</span><span class="num" id="2409771">0</span><span class="op" id="2409772">]</span><span class="op" id="2409773">)</span><span class="op" id="2409774">)</span><span class="op" id="2409775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409779">if</span>&nbsp;<span class="ident" id="2409782">err</span>&nbsp;<span class="op" id="2409786">!=</span>&nbsp;<span class="ident" id="2409789">nil</span>&nbsp;<span class="op" id="2409793">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409798">return</span>&nbsp;<span class="num" id="2409805">0</span><span class="op" id="2409806">,</span>&nbsp;<span class="ident" id="2409808">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2409814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409818">n</span>&nbsp;<span class="op" id="2409820">+=</span>&nbsp;<span class="builtinfunc" id="2409823">copy</span><span class="op" id="2409827">(</span><span class="ident" id="2409828">out</span><span class="op" id="2409831">,</span>&nbsp;<span class="ident" id="2409833">buf</span><span class="op" id="2409836">[</span><span class="ident" id="2409837">addr</span><span class="op" id="2409841">%</span><span class="ident" id="2409842">sizeofPtr</span><span class="op" id="2409851">:</span><span class="op" id="2409852">]</span><span class="op" id="2409853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409857">out</span>&nbsp;<span class="op" id="2409861">=</span>&nbsp;<span class="ident" id="2409863">out</span><span class="op" id="2409866">[</span><span class="ident" id="2409867">n</span><span class="op" id="2409868">:</span><span class="op" id="2409869">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2409872">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409876">//&nbsp;Remainder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409891">for</span>&nbsp;<span class="builtinfunc" id="2409895">len</span><span class="op" id="2409898">(</span><span class="ident" id="2409899">out</span><span class="op" id="2409902">)</span>&nbsp;<span class="op" id="2409904">&gt;</span>&nbsp;<span class="num" id="2409906">0</span>&nbsp;<span class="op" id="2409908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409912">//&nbsp;We&nbsp;use&nbsp;an&nbsp;internal&nbsp;buffer&nbsp;to&nbsp;guarantee&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409967">//&nbsp;It&#39;s&nbsp;not&nbsp;documented&nbsp;if&nbsp;this&nbsp;is&nbsp;necessary,&nbsp;but&nbsp;we&#39;re&nbsp;paranoid.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410034">err</span>&nbsp;<span class="op" id="2410038">=</span>&nbsp;<span class="ident" id="2410040">ptrace</span><span class="op" id="2410046">(</span><span class="ident" id="2410047">req</span><span class="op" id="2410050">,</span>&nbsp;<span class="ident" id="2410052">pid</span><span class="op" id="2410055">,</span>&nbsp;<span class="ident" id="2410057">addr</span><span class="op" id="2410061">+</span><span class="builtintype" id="2410062">uintptr</span><span class="op" id="2410069">(</span><span class="ident" id="2410070">n</span><span class="op" id="2410071">)</span><span class="op" id="2410072">,</span>&nbsp;<span class="builtintype" id="2410074">uintptr</span><span class="op" id="2410081">(</span><span class="ident" id="2410082">unsafe</span><span class="op" id="2410088">.</span><span class="ident" id="2410089">Pointer</span><span class="op" id="2410096">(</span><span class="op" id="2410097">&amp;</span><span class="ident" id="2410098">buf</span><span class="op" id="2410101">[</span><span class="num" id="2410102">0</span><span class="op" id="2410103">]</span><span class="op" id="2410104">)</span><span class="op" id="2410105">)</span><span class="op" id="2410106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410110">if</span>&nbsp;<span class="ident" id="2410113">err</span>&nbsp;<span class="op" id="2410117">!=</span>&nbsp;<span class="ident" id="2410120">nil</span>&nbsp;<span class="op" id="2410124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410129">return</span>&nbsp;<span class="ident" id="2410136">n</span><span class="op" id="2410137">,</span>&nbsp;<span class="ident" id="2410139">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2410145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410149">copied</span>&nbsp;<span class="op" id="2410156">:=</span>&nbsp;<span class="builtinfunc" id="2410159">copy</span><span class="op" id="2410163">(</span><span class="ident" id="2410164">out</span><span class="op" id="2410167">,</span>&nbsp;<span class="ident" id="2410169">buf</span><span class="op" id="2410172">[</span><span class="num" id="2410173">0</span><span class="op" id="2410174">:</span><span class="op" id="2410175">]</span><span class="op" id="2410176">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410180">n</span>&nbsp;<span class="op" id="2410182">+=</span>&nbsp;<span class="ident" id="2410185">copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410194">out</span>&nbsp;<span class="op" id="2410198">=</span>&nbsp;<span class="ident" id="2410200">out</span><span class="op" id="2410203">[</span><span class="ident" id="2410204">copied</span><span class="op" id="2410210">:</span><span class="op" id="2410211">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2410214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410218">return</span>&nbsp;<span class="ident" id="2410225">n</span><span class="op" id="2410226">,</span>&nbsp;<span class="ident" id="2410228">nil</span><br>
<span class="lineno">620</span><span class="op" id="2410232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2410235">func</span>&nbsp;<span class="ident" id="2410240">PtracePeekText</span><span class="op" id="2410254">(</span><span class="ident" id="2410255">pid</span>&nbsp;<span class="builtintype" id="2410259">int</span><span class="op" id="2410262">,</span>&nbsp;<span class="ident" id="2410264">addr</span>&nbsp;<span class="builtintype" id="2410269">uintptr</span><span class="op" id="2410276">,</span>&nbsp;<span class="ident" id="2410278">out</span>&nbsp;<span class="op" id="2410282">[</span><span class="op" id="2410283">]</span><span class="builtintype" id="2410284">byte</span><span class="op" id="2410288">)</span>&nbsp;<span class="op" id="2410290">(</span><span class="ident" id="2410291">count</span>&nbsp;<span class="builtintype" id="2410297">int</span><span class="op" id="2410300">,</span>&nbsp;<span class="ident" id="2410302">err</span>&nbsp;<span class="builtintype" id="2410306">error</span><span class="op" id="2410311">)</span>&nbsp;<span class="op" id="2410313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410316">return</span>&nbsp;<span class="ident" id="2410323">ptracePeek</span><span class="op" id="2410333">(</span><span class="ident" id="2410334">PTRACE_PEEKTEXT</span><span class="op" id="2410349">,</span>&nbsp;<span class="ident" id="2410351">pid</span><span class="op" id="2410354">,</span>&nbsp;<span class="ident" id="2410356">addr</span><span class="op" id="2410360">,</span>&nbsp;<span class="ident" id="2410362">out</span><span class="op" id="2410365">)</span><br>
<span class="lineno"></span><span class="op" id="2410367">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="2410370">func</span>&nbsp;<span class="ident" id="2410375">PtracePeekData</span><span class="op" id="2410389">(</span><span class="ident" id="2410390">pid</span>&nbsp;<span class="builtintype" id="2410394">int</span><span class="op" id="2410397">,</span>&nbsp;<span class="ident" id="2410399">addr</span>&nbsp;<span class="builtintype" id="2410404">uintptr</span><span class="op" id="2410411">,</span>&nbsp;<span class="ident" id="2410413">out</span>&nbsp;<span class="op" id="2410417">[</span><span class="op" id="2410418">]</span><span class="builtintype" id="2410419">byte</span><span class="op" id="2410423">)</span>&nbsp;<span class="op" id="2410425">(</span><span class="ident" id="2410426">count</span>&nbsp;<span class="builtintype" id="2410432">int</span><span class="op" id="2410435">,</span>&nbsp;<span class="ident" id="2410437">err</span>&nbsp;<span class="builtintype" id="2410441">error</span><span class="op" id="2410446">)</span>&nbsp;<span class="op" id="2410448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410451">return</span>&nbsp;<span class="ident" id="2410458">ptracePeek</span><span class="op" id="2410468">(</span><span class="ident" id="2410469">PTRACE_PEEKDATA</span><span class="op" id="2410484">,</span>&nbsp;<span class="ident" id="2410486">pid</span><span class="op" id="2410489">,</span>&nbsp;<span class="ident" id="2410491">addr</span><span class="op" id="2410495">,</span>&nbsp;<span class="ident" id="2410497">out</span><span class="op" id="2410500">)</span><br>
<span class="lineno"></span><span class="op" id="2410502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="keyword" id="2410505">func</span>&nbsp;<span class="ident" id="2410510">ptracePoke</span><span class="op" id="2410520">(</span><span class="ident" id="2410521">pokeReq</span>&nbsp;<span class="builtintype" id="2410529">int</span><span class="op" id="2410532">,</span>&nbsp;<span class="ident" id="2410534">peekReq</span>&nbsp;<span class="builtintype" id="2410542">int</span><span class="op" id="2410545">,</span>&nbsp;<span class="ident" id="2410547">pid</span>&nbsp;<span class="builtintype" id="2410551">int</span><span class="op" id="2410554">,</span>&nbsp;<span class="ident" id="2410556">addr</span>&nbsp;<span class="builtintype" id="2410561">uintptr</span><span class="op" id="2410568">,</span>&nbsp;<span class="ident" id="2410570">data</span>&nbsp;<span class="op" id="2410575">[</span><span class="op" id="2410576">]</span><span class="builtintype" id="2410577">byte</span><span class="op" id="2410581">)</span>&nbsp;<span class="op" id="2410583">(</span><span class="ident" id="2410584">count</span>&nbsp;<span class="builtintype" id="2410590">int</span><span class="op" id="2410593">,</span>&nbsp;<span class="ident" id="2410595">err</span>&nbsp;<span class="builtintype" id="2410599">error</span><span class="op" id="2410604">)</span>&nbsp;<span class="op" id="2410606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410609">//&nbsp;As&nbsp;for&nbsp;ptracePeek,&nbsp;we&nbsp;need&nbsp;to&nbsp;align&nbsp;our&nbsp;accesses&nbsp;to&nbsp;deal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410670">//&nbsp;with&nbsp;the&nbsp;possibility&nbsp;of&nbsp;straddling&nbsp;an&nbsp;invalid&nbsp;page.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410727">//&nbsp;Leading&nbsp;edge.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410745">n</span>&nbsp;<span class="op" id="2410747">:=</span>&nbsp;<span class="num" id="2410750">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410753">if</span>&nbsp;<span class="ident" id="2410756">addr</span><span class="op" id="2410760">%</span><span class="ident" id="2410761">sizeofPtr</span>&nbsp;<span class="op" id="2410771">!=</span>&nbsp;<span class="num" id="2410774">0</span>&nbsp;<span class="op" id="2410776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410780">var</span>&nbsp;<span class="ident" id="2410784">buf</span>&nbsp;<span class="op" id="2410788">[</span><span class="ident" id="2410789">sizeofPtr</span><span class="op" id="2410798">]</span><span class="builtintype" id="2410799">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410806">err</span>&nbsp;<span class="op" id="2410810">=</span>&nbsp;<span class="ident" id="2410812">ptrace</span><span class="op" id="2410818">(</span><span class="ident" id="2410819">peekReq</span><span class="op" id="2410826">,</span>&nbsp;<span class="ident" id="2410828">pid</span><span class="op" id="2410831">,</span>&nbsp;<span class="ident" id="2410833">addr</span><span class="op" id="2410837">-</span><span class="ident" id="2410838">addr</span><span class="op" id="2410842">%</span><span class="ident" id="2410843">sizeofPtr</span><span class="op" id="2410852">,</span>&nbsp;<span class="builtintype" id="2410854">uintptr</span><span class="op" id="2410861">(</span><span class="ident" id="2410862">unsafe</span><span class="op" id="2410868">.</span><span class="ident" id="2410869">Pointer</span><span class="op" id="2410876">(</span><span class="op" id="2410877">&amp;</span><span class="ident" id="2410878">buf</span><span class="op" id="2410881">[</span><span class="num" id="2410882">0</span><span class="op" id="2410883">]</span><span class="op" id="2410884">)</span><span class="op" id="2410885">)</span><span class="op" id="2410886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410890">if</span>&nbsp;<span class="ident" id="2410893">err</span>&nbsp;<span class="op" id="2410897">!=</span>&nbsp;<span class="ident" id="2410900">nil</span>&nbsp;<span class="op" id="2410904">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410909">return</span>&nbsp;<span class="num" id="2410916">0</span><span class="op" id="2410917">,</span>&nbsp;<span class="ident" id="2410919">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2410925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410929">n</span>&nbsp;<span class="op" id="2410931">+=</span>&nbsp;<span class="builtinfunc" id="2410934">copy</span><span class="op" id="2410938">(</span><span class="ident" id="2410939">buf</span><span class="op" id="2410942">[</span><span class="ident" id="2410943">addr</span><span class="op" id="2410947">%</span><span class="ident" id="2410948">sizeofPtr</span><span class="op" id="2410957">:</span><span class="op" id="2410958">]</span><span class="op" id="2410959">,</span>&nbsp;<span class="ident" id="2410961">data</span><span class="op" id="2410965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410969">word</span>&nbsp;<span class="op" id="2410974">:=</span>&nbsp;<span class="op" id="2410977">*</span><span class="op" id="2410978">(</span><span class="op" id="2410979">(</span><span class="op" id="2410980">*</span><span class="builtintype" id="2410981">uintptr</span><span class="op" id="2410988">)</span><span class="op" id="2410989">(</span><span class="ident" id="2410990">unsafe</span><span class="op" id="2410996">.</span><span class="ident" id="2410997">Pointer</span><span class="op" id="2411004">(</span><span class="op" id="2411005">&amp;</span><span class="ident" id="2411006">buf</span><span class="op" id="2411009">[</span><span class="num" id="2411010">0</span><span class="op" id="2411011">]</span><span class="op" id="2411012">)</span><span class="op" id="2411013">)</span><span class="op" id="2411014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411018">err</span>&nbsp;<span class="op" id="2411022">=</span>&nbsp;<span class="ident" id="2411024">ptrace</span><span class="op" id="2411030">(</span><span class="ident" id="2411031">pokeReq</span><span class="op" id="2411038">,</span>&nbsp;<span class="ident" id="2411040">pid</span><span class="op" id="2411043">,</span>&nbsp;<span class="ident" id="2411045">addr</span><span class="op" id="2411049">-</span><span class="ident" id="2411050">addr</span><span class="op" id="2411054">%</span><span class="ident" id="2411055">sizeofPtr</span><span class="op" id="2411064">,</span>&nbsp;<span class="ident" id="2411066">word</span><span class="op" id="2411070">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411074">if</span>&nbsp;<span class="ident" id="2411077">err</span>&nbsp;<span class="op" id="2411081">!=</span>&nbsp;<span class="ident" id="2411084">nil</span>&nbsp;<span class="op" id="2411088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411093">return</span>&nbsp;<span class="num" id="2411100">0</span><span class="op" id="2411101">,</span>&nbsp;<span class="ident" id="2411103">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411113">data</span>&nbsp;<span class="op" id="2411118">=</span>&nbsp;<span class="ident" id="2411120">data</span><span class="op" id="2411124">[</span><span class="ident" id="2411125">n</span><span class="op" id="2411126">:</span><span class="op" id="2411127">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411130">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2411134">//&nbsp;Interior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411148">for</span>&nbsp;<span class="builtinfunc" id="2411152">len</span><span class="op" id="2411155">(</span><span class="ident" id="2411156">data</span><span class="op" id="2411160">)</span>&nbsp;<span class="op" id="2411162">&gt;</span>&nbsp;<span class="ident" id="2411164">sizeofPtr</span>&nbsp;<span class="op" id="2411174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411178">word</span>&nbsp;<span class="op" id="2411183">:=</span>&nbsp;<span class="op" id="2411186">*</span><span class="op" id="2411187">(</span><span class="op" id="2411188">(</span><span class="op" id="2411189">*</span><span class="builtintype" id="2411190">uintptr</span><span class="op" id="2411197">)</span><span class="op" id="2411198">(</span><span class="ident" id="2411199">unsafe</span><span class="op" id="2411205">.</span><span class="ident" id="2411206">Pointer</span><span class="op" id="2411213">(</span><span class="op" id="2411214">&amp;</span><span class="ident" id="2411215">data</span><span class="op" id="2411219">[</span><span class="num" id="2411220">0</span><span class="op" id="2411221">]</span><span class="op" id="2411222">)</span><span class="op" id="2411223">)</span><span class="op" id="2411224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411228">err</span>&nbsp;<span class="op" id="2411232">=</span>&nbsp;<span class="ident" id="2411234">ptrace</span><span class="op" id="2411240">(</span><span class="ident" id="2411241">pokeReq</span><span class="op" id="2411248">,</span>&nbsp;<span class="ident" id="2411250">pid</span><span class="op" id="2411253">,</span>&nbsp;<span class="ident" id="2411255">addr</span><span class="op" id="2411259">+</span><span class="builtintype" id="2411260">uintptr</span><span class="op" id="2411267">(</span><span class="ident" id="2411268">n</span><span class="op" id="2411269">)</span><span class="op" id="2411270">,</span>&nbsp;<span class="ident" id="2411272">word</span><span class="op" id="2411276">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411280">if</span>&nbsp;<span class="ident" id="2411283">err</span>&nbsp;<span class="op" id="2411287">!=</span>&nbsp;<span class="ident" id="2411290">nil</span>&nbsp;<span class="op" id="2411294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411299">return</span>&nbsp;<span class="ident" id="2411306">n</span><span class="op" id="2411307">,</span>&nbsp;<span class="ident" id="2411309">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411319">n</span>&nbsp;<span class="op" id="2411321">+=</span>&nbsp;<span class="ident" id="2411324">sizeofPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411336">data</span>&nbsp;<span class="op" id="2411341">=</span>&nbsp;<span class="ident" id="2411343">data</span><span class="op" id="2411347">[</span><span class="ident" id="2411348">sizeofPtr</span><span class="op" id="2411357">:</span><span class="op" id="2411358">]</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2411365">//&nbsp;Trailing&nbsp;edge.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411384">if</span>&nbsp;<span class="builtinfunc" id="2411387">len</span><span class="op" id="2411390">(</span><span class="ident" id="2411391">data</span><span class="op" id="2411395">)</span>&nbsp;<span class="op" id="2411397">&gt;</span>&nbsp;<span class="num" id="2411399">0</span>&nbsp;<span class="op" id="2411401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411405">var</span>&nbsp;<span class="ident" id="2411409">buf</span>&nbsp;<span class="op" id="2411413">[</span><span class="ident" id="2411414">sizeofPtr</span><span class="op" id="2411423">]</span><span class="builtintype" id="2411424">byte</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411431">err</span>&nbsp;<span class="op" id="2411435">=</span>&nbsp;<span class="ident" id="2411437">ptrace</span><span class="op" id="2411443">(</span><span class="ident" id="2411444">peekReq</span><span class="op" id="2411451">,</span>&nbsp;<span class="ident" id="2411453">pid</span><span class="op" id="2411456">,</span>&nbsp;<span class="ident" id="2411458">addr</span><span class="op" id="2411462">+</span><span class="builtintype" id="2411463">uintptr</span><span class="op" id="2411470">(</span><span class="ident" id="2411471">n</span><span class="op" id="2411472">)</span><span class="op" id="2411473">,</span>&nbsp;<span class="builtintype" id="2411475">uintptr</span><span class="op" id="2411482">(</span><span class="ident" id="2411483">unsafe</span><span class="op" id="2411489">.</span><span class="ident" id="2411490">Pointer</span><span class="op" id="2411497">(</span><span class="op" id="2411498">&amp;</span><span class="ident" id="2411499">buf</span><span class="op" id="2411502">[</span><span class="num" id="2411503">0</span><span class="op" id="2411504">]</span><span class="op" id="2411505">)</span><span class="op" id="2411506">)</span><span class="op" id="2411507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411511">if</span>&nbsp;<span class="ident" id="2411514">err</span>&nbsp;<span class="op" id="2411518">!=</span>&nbsp;<span class="ident" id="2411521">nil</span>&nbsp;<span class="op" id="2411525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411530">return</span>&nbsp;<span class="ident" id="2411537">n</span><span class="op" id="2411538">,</span>&nbsp;<span class="ident" id="2411540">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2411550">copy</span><span class="op" id="2411554">(</span><span class="ident" id="2411555">buf</span><span class="op" id="2411558">[</span><span class="num" id="2411559">0</span><span class="op" id="2411560">:</span><span class="op" id="2411561">]</span><span class="op" id="2411562">,</span>&nbsp;<span class="ident" id="2411564">data</span><span class="op" id="2411568">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411572">word</span>&nbsp;<span class="op" id="2411577">:=</span>&nbsp;<span class="op" id="2411580">*</span><span class="op" id="2411581">(</span><span class="op" id="2411582">(</span><span class="op" id="2411583">*</span><span class="builtintype" id="2411584">uintptr</span><span class="op" id="2411591">)</span><span class="op" id="2411592">(</span><span class="ident" id="2411593">unsafe</span><span class="op" id="2411599">.</span><span class="ident" id="2411600">Pointer</span><span class="op" id="2411607">(</span><span class="op" id="2411608">&amp;</span><span class="ident" id="2411609">buf</span><span class="op" id="2411612">[</span><span class="num" id="2411613">0</span><span class="op" id="2411614">]</span><span class="op" id="2411615">)</span><span class="op" id="2411616">)</span><span class="op" id="2411617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411621">err</span>&nbsp;<span class="op" id="2411625">=</span>&nbsp;<span class="ident" id="2411627">ptrace</span><span class="op" id="2411633">(</span><span class="ident" id="2411634">pokeReq</span><span class="op" id="2411641">,</span>&nbsp;<span class="ident" id="2411643">pid</span><span class="op" id="2411646">,</span>&nbsp;<span class="ident" id="2411648">addr</span><span class="op" id="2411652">+</span><span class="builtintype" id="2411653">uintptr</span><span class="op" id="2411660">(</span><span class="ident" id="2411661">n</span><span class="op" id="2411662">)</span><span class="op" id="2411663">,</span>&nbsp;<span class="ident" id="2411665">word</span><span class="op" id="2411669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411673">if</span>&nbsp;<span class="ident" id="2411676">err</span>&nbsp;<span class="op" id="2411680">!=</span>&nbsp;<span class="ident" id="2411683">nil</span>&nbsp;<span class="op" id="2411687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411692">return</span>&nbsp;<span class="ident" id="2411699">n</span><span class="op" id="2411700">,</span>&nbsp;<span class="ident" id="2411702">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411708">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411712">n</span>&nbsp;<span class="op" id="2411714">+=</span>&nbsp;<span class="builtinfunc" id="2411717">len</span><span class="op" id="2411720">(</span><span class="ident" id="2411721">data</span><span class="op" id="2411725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411732">return</span>&nbsp;<span class="ident" id="2411739">n</span><span class="op" id="2411740">,</span>&nbsp;<span class="ident" id="2411742">nil</span><br>
<span class="lineno"></span><span class="op" id="2411746">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="2411749">func</span>&nbsp;<span class="ident" id="2411754">PtracePokeText</span><span class="op" id="2411768">(</span><span class="ident" id="2411769">pid</span>&nbsp;<span class="builtintype" id="2411773">int</span><span class="op" id="2411776">,</span>&nbsp;<span class="ident" id="2411778">addr</span>&nbsp;<span class="builtintype" id="2411783">uintptr</span><span class="op" id="2411790">,</span>&nbsp;<span class="ident" id="2411792">data</span>&nbsp;<span class="op" id="2411797">[</span><span class="op" id="2411798">]</span><span class="builtintype" id="2411799">byte</span><span class="op" id="2411803">)</span>&nbsp;<span class="op" id="2411805">(</span><span class="ident" id="2411806">count</span>&nbsp;<span class="builtintype" id="2411812">int</span><span class="op" id="2411815">,</span>&nbsp;<span class="ident" id="2411817">err</span>&nbsp;<span class="builtintype" id="2411821">error</span><span class="op" id="2411826">)</span>&nbsp;<span class="op" id="2411828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411831">return</span>&nbsp;<span class="ident" id="2411838">ptracePoke</span><span class="op" id="2411848">(</span><span class="ident" id="2411849">PTRACE_POKETEXT</span><span class="op" id="2411864">,</span>&nbsp;<span class="ident" id="2411866">PTRACE_PEEKTEXT</span><span class="op" id="2411881">,</span>&nbsp;<span class="ident" id="2411883">pid</span><span class="op" id="2411886">,</span>&nbsp;<span class="ident" id="2411888">addr</span><span class="op" id="2411892">,</span>&nbsp;<span class="ident" id="2411894">data</span><span class="op" id="2411898">)</span><br>
<span class="lineno"></span><span class="op" id="2411900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="keyword" id="2411903">func</span>&nbsp;<span class="ident" id="2411908">PtracePokeData</span><span class="op" id="2411922">(</span><span class="ident" id="2411923">pid</span>&nbsp;<span class="builtintype" id="2411927">int</span><span class="op" id="2411930">,</span>&nbsp;<span class="ident" id="2411932">addr</span>&nbsp;<span class="builtintype" id="2411937">uintptr</span><span class="op" id="2411944">,</span>&nbsp;<span class="ident" id="2411946">data</span>&nbsp;<span class="op" id="2411951">[</span><span class="op" id="2411952">]</span><span class="builtintype" id="2411953">byte</span><span class="op" id="2411957">)</span>&nbsp;<span class="op" id="2411959">(</span><span class="ident" id="2411960">count</span>&nbsp;<span class="builtintype" id="2411966">int</span><span class="op" id="2411969">,</span>&nbsp;<span class="ident" id="2411971">err</span>&nbsp;<span class="builtintype" id="2411975">error</span><span class="op" id="2411980">)</span>&nbsp;<span class="op" id="2411982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411985">return</span>&nbsp;<span class="ident" id="2411992">ptracePoke</span><span class="op" id="2412002">(</span><span class="ident" id="2412003">PTRACE_POKEDATA</span><span class="op" id="2412018">,</span>&nbsp;<span class="ident" id="2412020">PTRACE_PEEKDATA</span><span class="op" id="2412035">,</span>&nbsp;<span class="ident" id="2412037">pid</span><span class="op" id="2412040">,</span>&nbsp;<span class="ident" id="2412042">addr</span><span class="op" id="2412046">,</span>&nbsp;<span class="ident" id="2412048">data</span><span class="op" id="2412052">)</span><br>
<span class="lineno"></span><span class="op" id="2412054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2412057">func</span>&nbsp;<span class="ident" id="2412062">PtraceGetRegs</span><span class="op" id="2412075">(</span><span class="ident" id="2412076">pid</span>&nbsp;<span class="builtintype" id="2412080">int</span><span class="op" id="2412083">,</span>&nbsp;<span class="ident" id="2412085">regsout</span>&nbsp;<span class="op" id="2412093">*</span><span class="ident" id="2412094">PtraceRegs</span><span class="op" id="2412104">)</span>&nbsp;<span class="op" id="2412106">(</span><span class="ident" id="2412107">err</span>&nbsp;<span class="builtintype" id="2412111">error</span><span class="op" id="2412116">)</span>&nbsp;<span class="op" id="2412118">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412121">return</span>&nbsp;<span class="ident" id="2412128">ptrace</span><span class="op" id="2412134">(</span><span class="ident" id="2412135">PTRACE_GETREGS</span><span class="op" id="2412149">,</span>&nbsp;<span class="ident" id="2412151">pid</span><span class="op" id="2412154">,</span>&nbsp;<span class="num" id="2412156">0</span><span class="op" id="2412157">,</span>&nbsp;<span class="builtintype" id="2412159">uintptr</span><span class="op" id="2412166">(</span><span class="ident" id="2412167">unsafe</span><span class="op" id="2412173">.</span><span class="ident" id="2412174">Pointer</span><span class="op" id="2412181">(</span><span class="ident" id="2412182">regsout</span><span class="op" id="2412189">)</span><span class="op" id="2412190">)</span><span class="op" id="2412191">)</span><br>
<span class="lineno"></span><span class="op" id="2412193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2412196">func</span>&nbsp;<span class="ident" id="2412201">PtraceSetRegs</span><span class="op" id="2412214">(</span><span class="ident" id="2412215">pid</span>&nbsp;<span class="builtintype" id="2412219">int</span><span class="op" id="2412222">,</span>&nbsp;<span class="ident" id="2412224">regs</span>&nbsp;<span class="op" id="2412229">*</span><span class="ident" id="2412230">PtraceRegs</span><span class="op" id="2412240">)</span>&nbsp;<span class="op" id="2412242">(</span><span class="ident" id="2412243">err</span>&nbsp;<span class="builtintype" id="2412247">error</span><span class="op" id="2412252">)</span>&nbsp;<span class="op" id="2412254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412257">return</span>&nbsp;<span class="ident" id="2412264">ptrace</span><span class="op" id="2412270">(</span><span class="ident" id="2412271">PTRACE_SETREGS</span><span class="op" id="2412285">,</span>&nbsp;<span class="ident" id="2412287">pid</span><span class="op" id="2412290">,</span>&nbsp;<span class="num" id="2412292">0</span><span class="op" id="2412293">,</span>&nbsp;<span class="builtintype" id="2412295">uintptr</span><span class="op" id="2412302">(</span><span class="ident" id="2412303">unsafe</span><span class="op" id="2412309">.</span><span class="ident" id="2412310">Pointer</span><span class="op" id="2412317">(</span><span class="ident" id="2412318">regs</span><span class="op" id="2412322">)</span><span class="op" id="2412323">)</span><span class="op" id="2412324">)</span><br>
<span class="lineno">695</span><span class="op" id="2412326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2412329">func</span>&nbsp;<span class="ident" id="2412334">PtraceSetOptions</span><span class="op" id="2412350">(</span><span class="ident" id="2412351">pid</span>&nbsp;<span class="builtintype" id="2412355">int</span><span class="op" id="2412358">,</span>&nbsp;<span class="ident" id="2412360">options</span>&nbsp;<span class="builtintype" id="2412368">int</span><span class="op" id="2412371">)</span>&nbsp;<span class="op" id="2412373">(</span><span class="ident" id="2412374">err</span>&nbsp;<span class="builtintype" id="2412378">error</span><span class="op" id="2412383">)</span>&nbsp;<span class="op" id="2412385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412388">return</span>&nbsp;<span class="ident" id="2412395">ptrace</span><span class="op" id="2412401">(</span><span class="ident" id="2412402">PTRACE_SETOPTIONS</span><span class="op" id="2412419">,</span>&nbsp;<span class="ident" id="2412421">pid</span><span class="op" id="2412424">,</span>&nbsp;<span class="num" id="2412426">0</span><span class="op" id="2412427">,</span>&nbsp;<span class="builtintype" id="2412429">uintptr</span><span class="op" id="2412436">(</span><span class="ident" id="2412437">options</span><span class="op" id="2412444">)</span><span class="op" id="2412445">)</span><br>
<span class="lineno"></span><span class="op" id="2412447">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="2412450">func</span>&nbsp;<span class="ident" id="2412455">PtraceGetEventMsg</span><span class="op" id="2412472">(</span><span class="ident" id="2412473">pid</span>&nbsp;<span class="builtintype" id="2412477">int</span><span class="op" id="2412480">)</span>&nbsp;<span class="op" id="2412482">(</span><span class="ident" id="2412483">msg</span>&nbsp;<span class="builtintype" id="2412487">uint</span><span class="op" id="2412491">,</span>&nbsp;<span class="ident" id="2412493">err</span>&nbsp;<span class="builtintype" id="2412497">error</span><span class="op" id="2412502">)</span>&nbsp;<span class="op" id="2412504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412507">var</span>&nbsp;<span class="ident" id="2412511">data</span>&nbsp;<span class="ident" id="2412516">_C_long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412525">err</span>&nbsp;<span class="op" id="2412529">=</span>&nbsp;<span class="ident" id="2412531">ptrace</span><span class="op" id="2412537">(</span><span class="ident" id="2412538">PTRACE_GETEVENTMSG</span><span class="op" id="2412556">,</span>&nbsp;<span class="ident" id="2412558">pid</span><span class="op" id="2412561">,</span>&nbsp;<span class="num" id="2412563">0</span><span class="op" id="2412564">,</span>&nbsp;<span class="builtintype" id="2412566">uintptr</span><span class="op" id="2412573">(</span><span class="ident" id="2412574">unsafe</span><span class="op" id="2412580">.</span><span class="ident" id="2412581">Pointer</span><span class="op" id="2412588">(</span><span class="op" id="2412589">&amp;</span><span class="ident" id="2412590">data</span><span class="op" id="2412594">)</span><span class="op" id="2412595">)</span><span class="op" id="2412596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412599">msg</span>&nbsp;<span class="op" id="2412603">=</span>&nbsp;<span class="builtintype" id="2412605">uint</span><span class="op" id="2412609">(</span><span class="ident" id="2412610">data</span><span class="op" id="2412614">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412617">return</span><br>
<span class="lineno"></span><span class="op" id="2412624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2412627">func</span>&nbsp;<span class="ident" id="2412632">PtraceCont</span><span class="op" id="2412642">(</span><span class="ident" id="2412643">pid</span>&nbsp;<span class="builtintype" id="2412647">int</span><span class="op" id="2412650">,</span>&nbsp;<span class="ident" id="2412652">signal</span>&nbsp;<span class="builtintype" id="2412659">int</span><span class="op" id="2412662">)</span>&nbsp;<span class="op" id="2412664">(</span><span class="ident" id="2412665">err</span>&nbsp;<span class="builtintype" id="2412669">error</span><span class="op" id="2412674">)</span>&nbsp;<span class="op" id="2412676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412679">return</span>&nbsp;<span class="ident" id="2412686">ptrace</span><span class="op" id="2412692">(</span><span class="ident" id="2412693">PTRACE_CONT</span><span class="op" id="2412704">,</span>&nbsp;<span class="ident" id="2412706">pid</span><span class="op" id="2412709">,</span>&nbsp;<span class="num" id="2412711">0</span><span class="op" id="2412712">,</span>&nbsp;<span class="builtintype" id="2412714">uintptr</span><span class="op" id="2412721">(</span><span class="ident" id="2412722">signal</span><span class="op" id="2412728">)</span><span class="op" id="2412729">)</span><br>
<span class="lineno">710</span><span class="op" id="2412731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2412734">func</span>&nbsp;<span class="ident" id="2412739">PtraceSyscall</span><span class="op" id="2412752">(</span><span class="ident" id="2412753">pid</span>&nbsp;<span class="builtintype" id="2412757">int</span><span class="op" id="2412760">,</span>&nbsp;<span class="ident" id="2412762">signal</span>&nbsp;<span class="builtintype" id="2412769">int</span><span class="op" id="2412772">)</span>&nbsp;<span class="op" id="2412774">(</span><span class="ident" id="2412775">err</span>&nbsp;<span class="builtintype" id="2412779">error</span><span class="op" id="2412784">)</span>&nbsp;<span class="op" id="2412786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412789">return</span>&nbsp;<span class="ident" id="2412796">ptrace</span><span class="op" id="2412802">(</span><span class="ident" id="2412803">PTRACE_SYSCALL</span><span class="op" id="2412817">,</span>&nbsp;<span class="ident" id="2412819">pid</span><span class="op" id="2412822">,</span>&nbsp;<span class="num" id="2412824">0</span><span class="op" id="2412825">,</span>&nbsp;<span class="builtintype" id="2412827">uintptr</span><span class="op" id="2412834">(</span><span class="ident" id="2412835">signal</span><span class="op" id="2412841">)</span><span class="op" id="2412842">)</span><br>
<span class="lineno"></span><span class="op" id="2412844">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="2412847">func</span>&nbsp;<span class="ident" id="2412852">PtraceSingleStep</span><span class="op" id="2412868">(</span><span class="ident" id="2412869">pid</span>&nbsp;<span class="builtintype" id="2412873">int</span><span class="op" id="2412876">)</span>&nbsp;<span class="op" id="2412878">(</span><span class="ident" id="2412879">err</span>&nbsp;<span class="builtintype" id="2412883">error</span><span class="op" id="2412888">)</span>&nbsp;<span class="op" id="2412890">{</span>&nbsp;<span class="keyword" id="2412892">return</span>&nbsp;<span class="ident" id="2412899">ptrace</span><span class="op" id="2412905">(</span><span class="ident" id="2412906">PTRACE_SINGLESTEP</span><span class="op" id="2412923">,</span>&nbsp;<span class="ident" id="2412925">pid</span><span class="op" id="2412928">,</span>&nbsp;<span class="num" id="2412930">0</span><span class="op" id="2412931">,</span>&nbsp;<span class="num" id="2412933">0</span><span class="op" id="2412934">)</span>&nbsp;<span class="op" id="2412936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2412939">func</span>&nbsp;<span class="ident" id="2412944">PtraceAttach</span><span class="op" id="2412956">(</span><span class="ident" id="2412957">pid</span>&nbsp;<span class="builtintype" id="2412961">int</span><span class="op" id="2412964">)</span>&nbsp;<span class="op" id="2412966">(</span><span class="ident" id="2412967">err</span>&nbsp;<span class="builtintype" id="2412971">error</span><span class="op" id="2412976">)</span>&nbsp;<span class="op" id="2412978">{</span>&nbsp;<span class="keyword" id="2412980">return</span>&nbsp;<span class="ident" id="2412987">ptrace</span><span class="op" id="2412993">(</span><span class="ident" id="2412994">PTRACE_ATTACH</span><span class="op" id="2413007">,</span>&nbsp;<span class="ident" id="2413009">pid</span><span class="op" id="2413012">,</span>&nbsp;<span class="num" id="2413014">0</span><span class="op" id="2413015">,</span>&nbsp;<span class="num" id="2413017">0</span><span class="op" id="2413018">)</span>&nbsp;<span class="op" id="2413020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span><span class="keyword" id="2413023">func</span>&nbsp;<span class="ident" id="2413028">PtraceDetach</span><span class="op" id="2413040">(</span><span class="ident" id="2413041">pid</span>&nbsp;<span class="builtintype" id="2413045">int</span><span class="op" id="2413048">)</span>&nbsp;<span class="op" id="2413050">(</span><span class="ident" id="2413051">err</span>&nbsp;<span class="builtintype" id="2413055">error</span><span class="op" id="2413060">)</span>&nbsp;<span class="op" id="2413062">{</span>&nbsp;<span class="keyword" id="2413064">return</span>&nbsp;<span class="ident" id="2413071">ptrace</span><span class="op" id="2413077">(</span><span class="ident" id="2413078">PTRACE_DETACH</span><span class="op" id="2413091">,</span>&nbsp;<span class="ident" id="2413093">pid</span><span class="op" id="2413096">,</span>&nbsp;<span class="num" id="2413098">0</span><span class="op" id="2413099">,</span>&nbsp;<span class="num" id="2413101">0</span><span class="op" id="2413102">)</span>&nbsp;<span class="op" id="2413104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2413107">//sys&nbsp;&nbsp;&nbsp;&nbspreboot(magic1&nbsp;uint,&nbsp;magic2&nbsp;uint,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2413180">func</span>&nbsp;<span class="ident" id="2413185">Reboot</span><span class="op" id="2413191">(</span><span class="ident" id="2413192">cmd</span>&nbsp;<span class="builtintype" id="2413196">int</span><span class="op" id="2413199">)</span>&nbsp;<span class="op" id="2413201">(</span><span class="ident" id="2413202">err</span>&nbsp;<span class="builtintype" id="2413206">error</span><span class="op" id="2413211">)</span>&nbsp;<span class="op" id="2413213">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413216">return</span>&nbsp;<span class="ident" id="2413223">reboot</span><span class="op" id="2413229">(</span><span class="ident" id="2413230">LINUX_REBOOT_MAGIC1</span><span class="op" id="2413249">,</span>&nbsp;<span class="ident" id="2413251">LINUX_REBOOT_MAGIC2</span><span class="op" id="2413270">,</span>&nbsp;<span class="ident" id="2413272">cmd</span><span class="op" id="2413275">,</span>&nbsp;<span class="string" id="2413277">&#34;&#34;</span><span class="op" id="2413279">)</span><br>
<span class="lineno"></span><span class="op" id="2413281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2413284">func</span>&nbsp;<span class="ident" id="2413289">clen</span><span class="op" id="2413293">(</span><span class="ident" id="2413294">n</span>&nbsp;<span class="op" id="2413296">[</span><span class="op" id="2413297">]</span><span class="builtintype" id="2413298">byte</span><span class="op" id="2413302">)</span>&nbsp;<span class="builtintype" id="2413304">int</span>&nbsp;<span class="op" id="2413308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413311">for</span>&nbsp;<span class="ident" id="2413315">i</span>&nbsp;<span class="op" id="2413317">:=</span>&nbsp;<span class="num" id="2413320">0</span><span class="op" id="2413321">;</span>&nbsp;<span class="ident" id="2413323">i</span>&nbsp;<span class="op" id="2413325">&lt;</span>&nbsp;<span class="builtinfunc" id="2413327">len</span><span class="op" id="2413330">(</span><span class="ident" id="2413331">n</span><span class="op" id="2413332">)</span><span class="op" id="2413333">;</span>&nbsp;<span class="ident" id="2413335">i</span><span class="op" id="2413336">++</span>&nbsp;<span class="op" id="2413339">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413343">if</span>&nbsp;<span class="ident" id="2413346">n</span><span class="op" id="2413347">[</span><span class="ident" id="2413348">i</span><span class="op" id="2413349">]</span>&nbsp;<span class="op" id="2413351">==</span>&nbsp;<span class="num" id="2413354">0</span>&nbsp;<span class="op" id="2413356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413361">return</span>&nbsp;<span class="ident" id="2413368">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2413372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2413375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413378">return</span>&nbsp;<span class="builtinfunc" id="2413385">len</span><span class="op" id="2413388">(</span><span class="ident" id="2413389">n</span><span class="op" id="2413390">)</span><br>
<span class="lineno">735</span><span class="op" id="2413392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2413395">func</span>&nbsp;<span class="ident" id="2413400">ReadDirent</span><span class="op" id="2413410">(</span><span class="ident" id="2413411">fd</span>&nbsp;<span class="builtintype" id="2413414">int</span><span class="op" id="2413417">,</span>&nbsp;<span class="ident" id="2413419">buf</span>&nbsp;<span class="op" id="2413423">[</span><span class="op" id="2413424">]</span><span class="builtintype" id="2413425">byte</span><span class="op" id="2413429">)</span>&nbsp;<span class="op" id="2413431">(</span><span class="ident" id="2413432">n</span>&nbsp;<span class="builtintype" id="2413434">int</span><span class="op" id="2413437">,</span>&nbsp;<span class="ident" id="2413439">err</span>&nbsp;<span class="builtintype" id="2413443">error</span><span class="op" id="2413448">)</span>&nbsp;<span class="op" id="2413450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413453">return</span>&nbsp;<span class="ident" id="2413460">Getdents</span><span class="op" id="2413468">(</span><span class="ident" id="2413469">fd</span><span class="op" id="2413471">,</span>&nbsp;<span class="ident" id="2413473">buf</span><span class="op" id="2413476">)</span><br>
<span class="lineno"></span><span class="op" id="2413478">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="2413481">func</span>&nbsp;<span class="ident" id="2413486">ParseDirent</span><span class="op" id="2413497">(</span><span class="ident" id="2413498">buf</span>&nbsp;<span class="op" id="2413502">[</span><span class="op" id="2413503">]</span><span class="builtintype" id="2413504">byte</span><span class="op" id="2413508">,</span>&nbsp;<span class="ident" id="2413510">max</span>&nbsp;<span class="builtintype" id="2413514">int</span><span class="op" id="2413517">,</span>&nbsp;<span class="ident" id="2413519">names</span>&nbsp;<span class="op" id="2413525">[</span><span class="op" id="2413526">]</span><span class="builtintype" id="2413527">string</span><span class="op" id="2413533">)</span>&nbsp;<span class="op" id="2413535">(</span><span class="ident" id="2413536">consumed</span>&nbsp;<span class="builtintype" id="2413545">int</span><span class="op" id="2413548">,</span>&nbsp;<span class="ident" id="2413550">count</span>&nbsp;<span class="builtintype" id="2413556">int</span><span class="op" id="2413559">,</span>&nbsp;<span class="ident" id="2413561">newnames</span>&nbsp;<span class="op" id="2413570">[</span><span class="op" id="2413571">]</span><span class="builtintype" id="2413572">string</span><span class="op" id="2413578">)</span>&nbsp;<span class="op" id="2413580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413583">origlen</span>&nbsp;<span class="op" id="2413591">:=</span>&nbsp;<span class="builtinfunc" id="2413594">len</span><span class="op" id="2413597">(</span><span class="ident" id="2413598">buf</span><span class="op" id="2413601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413604">count</span>&nbsp;<span class="op" id="2413610">=</span>&nbsp;<span class="num" id="2413612">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413615">for</span>&nbsp;<span class="ident" id="2413619">max</span>&nbsp;<span class="op" id="2413623">!=</span>&nbsp;<span class="num" id="2413626">0</span>&nbsp;<span class="op" id="2413628">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2413631">len</span><span class="op" id="2413634">(</span><span class="ident" id="2413635">buf</span><span class="op" id="2413638">)</span>&nbsp;<span class="op" id="2413640">&gt;</span>&nbsp;<span class="num" id="2413642">0</span>&nbsp;<span class="op" id="2413644">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413648">dirent</span>&nbsp;<span class="op" id="2413655">:=</span>&nbsp;<span class="op" id="2413658">(</span><span class="op" id="2413659">*</span><span class="ident" id="2413660">Dirent</span><span class="op" id="2413666">)</span><span class="op" id="2413667">(</span><span class="ident" id="2413668">unsafe</span><span class="op" id="2413674">.</span><span class="ident" id="2413675">Pointer</span><span class="op" id="2413682">(</span><span class="op" id="2413683">&amp;</span><span class="ident" id="2413684">buf</span><span class="op" id="2413687">[</span><span class="num" id="2413688">0</span><span class="op" id="2413689">]</span><span class="op" id="2413690">)</span><span class="op" id="2413691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413695">buf</span>&nbsp;<span class="op" id="2413699">=</span>&nbsp;<span class="ident" id="2413701">buf</span><span class="op" id="2413704">[</span><span class="ident" id="2413705">dirent</span><span class="op" id="2413711">.</span><span class="ident" id="2413712">Reclen</span><span class="op" id="2413718">:</span><span class="op" id="2413719">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413723">if</span>&nbsp;<span class="ident" id="2413726">dirent</span><span class="op" id="2413732">.</span><span class="ident" id="2413733">Ino</span>&nbsp;<span class="op" id="2413737">==</span>&nbsp;<span class="num" id="2413740">0</span>&nbsp;<span class="op" id="2413742">{</span>&nbsp;<span class="comment" id="2413744">//&nbsp;File&nbsp;absent&nbsp;in&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413776">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2413787">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413791">bytes</span>&nbsp;<span class="op" id="2413797">:=</span>&nbsp;<span class="op" id="2413800">(</span><span class="op" id="2413801">*</span><span class="op" id="2413802">[</span><span class="num" id="2413803">10000</span><span class="op" id="2413808">]</span><span class="builtintype" id="2413809">byte</span><span class="op" id="2413813">)</span><span class="op" id="2413814">(</span><span class="ident" id="2413815">unsafe</span><span class="op" id="2413821">.</span><span class="ident" id="2413822">Pointer</span><span class="op" id="2413829">(</span><span class="op" id="2413830">&amp;</span><span class="ident" id="2413831">dirent</span><span class="op" id="2413837">.</span><span class="ident" id="2413838">Name</span><span class="op" id="2413842">[</span><span class="num" id="2413843">0</span><span class="op" id="2413844">]</span><span class="op" id="2413845">)</span><span class="op" id="2413846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413850">var</span>&nbsp;<span class="ident" id="2413854">name</span>&nbsp;<span class="op" id="2413859">=</span>&nbsp;<span class="builtintype" id="2413861">string</span><span class="op" id="2413867">(</span><span class="ident" id="2413868">bytes</span><span class="op" id="2413873">[</span><span class="num" id="2413874">0</span><span class="op" id="2413875">:</span><span class="ident" id="2413876">clen</span><span class="op" id="2413880">(</span><span class="ident" id="2413881">bytes</span><span class="op" id="2413886">[</span><span class="op" id="2413887">:</span><span class="op" id="2413888">]</span><span class="op" id="2413889">)</span><span class="op" id="2413890">]</span><span class="op" id="2413891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413895">if</span>&nbsp;<span class="ident" id="2413898">name</span>&nbsp;<span class="op" id="2413903">==</span>&nbsp;<span class="string" id="2413906">&#34;.&#34;</span>&nbsp;<span class="op" id="2413910">||</span>&nbsp;<span class="ident" id="2413913">name</span>&nbsp;<span class="op" id="2413918">==</span>&nbsp;<span class="string" id="2413921">&#34;..&#34;</span>&nbsp;<span class="op" id="2413926">{</span>&nbsp;<span class="comment" id="2413928">//&nbsp;Useless&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413948">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2413959">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413963">max</span><span class="op" id="2413966">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413971">count</span><span class="op" id="2413976">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413981">names</span>&nbsp;<span class="op" id="2413987">=</span>&nbsp;<span class="builtinfunc" id="2413989">append</span><span class="op" id="2413995">(</span><span class="ident" id="2413996">names</span><span class="op" id="2414001">,</span>&nbsp;<span class="ident" id="2414003">name</span><span class="op" id="2414007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2414010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414013">return</span>&nbsp;<span class="ident" id="2414020">origlen</span>&nbsp;<span class="op" id="2414028">-</span>&nbsp;<span class="builtinfunc" id="2414030">len</span><span class="op" id="2414033">(</span><span class="ident" id="2414034">buf</span><span class="op" id="2414037">)</span><span class="op" id="2414038">,</span>&nbsp;<span class="ident" id="2414040">count</span><span class="op" id="2414045">,</span>&nbsp;<span class="ident" id="2414047">names</span><br>
<span class="lineno">760</span><span class="op" id="2414053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2414056">//sys&nbsp;&nbsp;&nbsp;&nbspmount(source&nbsp;string,&nbsp;target&nbsp;string,&nbsp;fstype&nbsp;string,&nbsp;flags&nbsp;uintptr,&nbsp;data&nbsp;*byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2414153">func</span>&nbsp;<span class="ident" id="2414158">Mount</span><span class="op" id="2414163">(</span><span class="ident" id="2414164">source</span>&nbsp;<span class="builtintype" id="2414171">string</span><span class="op" id="2414177">,</span>&nbsp;<span class="ident" id="2414179">target</span>&nbsp;<span class="builtintype" id="2414186">string</span><span class="op" id="2414192">,</span>&nbsp;<span class="ident" id="2414194">fstype</span>&nbsp;<span class="builtintype" id="2414201">string</span><span class="op" id="2414207">,</span>&nbsp;<span class="ident" id="2414209">flags</span>&nbsp;<span class="builtintype" id="2414215">uintptr</span><span class="op" id="2414222">,</span>&nbsp;<span class="ident" id="2414224">data</span>&nbsp;<span class="builtintype" id="2414229">string</span><span class="op" id="2414235">)</span>&nbsp;<span class="op" id="2414237">(</span><span class="ident" id="2414238">err</span>&nbsp;<span class="builtintype" id="2414242">error</span><span class="op" id="2414247">)</span>&nbsp;<span class="op" id="2414249">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414252">//&nbsp;Certain&nbsp;file&nbsp;systems&nbsp;get&nbsp;rather&nbsp;angry&nbsp;and&nbsp;EINVAL&nbsp;if&nbsp;you&nbsp;give</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414317">//&nbsp;them&nbsp;an&nbsp;empty&nbsp;string&nbsp;of&nbsp;data,&nbsp;rather&nbsp;than&nbsp;NULL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414369">if</span>&nbsp;<span class="ident" id="2414372">data</span>&nbsp;<span class="op" id="2414377">==</span>&nbsp;<span class="string" id="2414380">&#34;&#34;</span>&nbsp;<span class="op" id="2414383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414387">return</span>&nbsp;<span class="ident" id="2414394">mount</span><span class="op" id="2414399">(</span><span class="ident" id="2414400">source</span><span class="op" id="2414406">,</span>&nbsp;<span class="ident" id="2414408">target</span><span class="op" id="2414414">,</span>&nbsp;<span class="ident" id="2414416">fstype</span><span class="op" id="2414422">,</span>&nbsp;<span class="ident" id="2414424">flags</span><span class="op" id="2414429">,</span>&nbsp;<span class="ident" id="2414431">nil</span><span class="op" id="2414434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2414437">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414440">datap</span><span class="op" id="2414445">,</span>&nbsp;<span class="ident" id="2414447">err</span>&nbsp;<span class="op" id="2414451">:=</span>&nbsp;<span class="ident" id="2414454">BytePtrFromString</span><span class="op" id="2414471">(</span><span class="ident" id="2414472">data</span><span class="op" id="2414476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414479">if</span>&nbsp;<span class="ident" id="2414482">err</span>&nbsp;<span class="op" id="2414486">!=</span>&nbsp;<span class="ident" id="2414489">nil</span>&nbsp;<span class="op" id="2414493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414497">return</span>&nbsp;<span class="ident" id="2414504">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2414509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414512">err</span>&nbsp;<span class="op" id="2414516">=</span>&nbsp;<span class="ident" id="2414518">mount</span><span class="op" id="2414523">(</span><span class="ident" id="2414524">source</span><span class="op" id="2414530">,</span>&nbsp;<span class="ident" id="2414532">target</span><span class="op" id="2414538">,</span>&nbsp;<span class="ident" id="2414540">fstype</span><span class="op" id="2414546">,</span>&nbsp;<span class="ident" id="2414548">flags</span><span class="op" id="2414553">,</span>&nbsp;<span class="ident" id="2414555">datap</span><span class="op" id="2414560">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414563">use</span><span class="op" id="2414566">(</span><span class="ident" id="2414567">unsafe</span><span class="op" id="2414573">.</span><span class="ident" id="2414574">Pointer</span><span class="op" id="2414581">(</span><span class="ident" id="2414582">datap</span><span class="op" id="2414587">)</span><span class="op" id="2414588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414591">return</span>&nbsp;<span class="ident" id="2414598">err</span><br>
<span class="lineno"></span><span class="op" id="2414602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2414605">//&nbsp;Sendto</span><br>
<span class="lineno">780</span><span class="comment" id="2414615">//&nbsp;Recvfrom</span><br>
<span class="lineno"></span><span class="comment" id="2414627">//&nbsp;Socketpair</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2414642">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Direct&nbsp;access<br>
<span class="lineno">785</span>&nbsp;*/</span><br>
<span class="lineno"></span><span class="comment" id="2414666">//sys&nbsp;&nbsp;&nbsp;&nbspAccess(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2414717">//sys&nbsp;&nbsp;&nbsp;&nbspAcct(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2414753">//sys&nbsp;&nbsp;&nbsp;&nbspAdjtimex(buf&nbsp;*Timex)&nbsp;(state&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2414803">//sys&nbsp;&nbsp;&nbsp;&nbspChdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">790</span><span class="comment" id="2414840">//sys&nbsp;&nbsp;&nbsp;&nbspChmod(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2414890">//sys&nbsp;&nbsp;&nbsp;&nbspChroot(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2414928">//sys&nbsp;&nbsp;&nbsp;&nbspClose(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2414960">//sys&nbsp;&nbsp;&nbsp;&nbspCreat(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415018">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup(oldfd&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">795</span><span class="comment" id="2415061">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup2(oldfd&nbsp;int,&nbsp;newfd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415108">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup3(oldfd&nbsp;int,&nbsp;newfd&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415166">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate(size&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415216">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate1(flag&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415267">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCtl(epfd&nbsp;int,&nbsp;op&nbsp;int,&nbsp;fd&nbsp;int,&nbsp;event&nbsp;*EpollEvent)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">800</span><span class="comment" id="2415341">//sys&nbsp;&nbsp;&nbsp;&nbspEpollWait(epfd&nbsp;int,&nbsp;events&nbsp;[]EpollEvent,&nbsp;msec&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415417">//sys&nbsp;&nbsp;&nbsp;&nbspExit(code&nbsp;int)&nbsp;=&nbsp;SYS_EXIT_GROUP</span><br>
<span class="lineno"></span><span class="comment" id="2415455">//sys&nbsp;&nbsp;&nbsp;&nbspFaccessat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415531">//sys&nbsp;&nbsp;&nbsp;&nbspFallocate(fd&nbsp;int,&nbsp;mode&nbsp;uint32,&nbsp;off&nbsp;int64,&nbsp;len&nbsp;int64)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415602">//sys&nbsp;&nbsp;&nbsp;&nbspFchdir(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">805</span><span class="comment" id="2415635">//sys&nbsp;&nbsp;&nbsp;&nbspFchmod(fd&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415681">//sys&nbsp;&nbsp;&nbsp;&nbspFchmodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415756">//sys&nbsp;&nbsp;&nbsp;&nbspFchownat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;uid&nbsp;int,&nbsp;gid&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415836">//sys&nbsp;&nbsp;&nbsp;&nbspfcntl(fd&nbsp;int,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;int)&nbsp;(val&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415895">//sys&nbsp;&nbsp;&nbsp;&nbspFdatasync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">810</span><span class="comment" id="2415931">//sys&nbsp;&nbsp;&nbsp;&nbspFlock(fd&nbsp;int,&nbsp;how&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2415972">//sys&nbsp;&nbsp;&nbsp;&nbspFsync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416004">//sys&nbsp;&nbsp;&nbsp;&nbspGetdents(fd&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_GETDENTS64</span><br>
<span class="lineno"></span><span class="comment" id="2416075">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgid(pid&nbsp;int)&nbsp;(pgid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416122">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgrp()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno">815</span><span class="comment" id="2416150">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpid()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2416177">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetppid()&nbsp;(ppid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2416206">//sys&nbsp;&nbsp;&nbsp;&nbspGetpriority(which&nbsp;int,&nbsp;who&nbsp;int)&nbsp;(prio&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416266">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetrusage(who&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416321">//sysnb&nbsp;&nbsp;&nbsp;&nbspGettid()&nbsp;(tid&nbsp;int)</span><br>
<span class="lineno">820</span><span class="comment" id="2416348">//sys&nbsp;&nbsp;&nbsp;&nbspGetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416422">//sys&nbsp;&nbsp;&nbsp;&nbspInotifyAddWatch(fd&nbsp;int,&nbsp;pathname&nbsp;string,&nbsp;mask&nbsp;uint32)&nbsp;(watchdesc&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416509">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit()&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416551">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit1(flags&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416603">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyRmWatch(fd&nbsp;int,&nbsp;watchdesc&nbsp;uint32)&nbsp;(success&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">825</span><span class="comment" id="2416677">//sysnb&nbsp;&nbsp;&nbsp;&nbspKill(pid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416723">//sys&nbsp;&nbsp;&nbsp;&nbspKlogctl(typ&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_SYSLOG</span><br>
<span class="lineno"></span><span class="comment" id="2416790">//sys&nbsp;&nbsp;&nbsp;&nbspLink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416845">//sys&nbsp;&nbsp;&nbsp;&nbspListxattr(path&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416907">//sys&nbsp;&nbsp;&nbsp;&nbspMkdir(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">830</span><span class="comment" id="2416957">//sys&nbsp;&nbsp;&nbsp;&nbspMkdirat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417020">//sys&nbsp;&nbsp;&nbsp;&nbspMknod(path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417079">//sys&nbsp;&nbsp;&nbsp;&nbspMknodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417151">//sys&nbsp;&nbsp;&nbsp;&nbspNanosleep(time&nbsp;*Timespec,&nbsp;leftover&nbsp;*Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417215">//sys&nbsp;&nbsp;&nbsp;&nbspPause()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">835</span><span class="comment" id="2417241">//sys&nbsp;&nbsp;&nbsp;&nbspPivotRoot(newroot&nbsp;string,&nbsp;putold&nbsp;string)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PIVOT_ROOT</span><br>
<span class="lineno"></span><span class="comment" id="2417317">//sysnb&nbsp;prlimit(pid&nbsp;int,&nbsp;resource&nbsp;int,&nbsp;old&nbsp;*Rlimit,&nbsp;newlimit&nbsp;*Rlimit)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PRLIMIT64</span><br>
<span class="lineno"></span><span class="comment" id="2417415">//sys&nbsp;&nbsp;&nbsp;&nbspread(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417463">//sys&nbsp;&nbsp;&nbsp;&nbspReadlink(path&nbsp;string,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417522">//sys&nbsp;&nbsp;&nbsp;&nbspRemovexattr(path&nbsp;string,&nbsp;attr&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">840</span><span class="comment" id="2417578">//sys&nbsp;&nbsp;&nbsp;&nbspRename(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417635">//sys&nbsp;&nbsp;&nbsp;&nbspRenameat(olddirfd&nbsp;int,&nbsp;oldpath&nbsp;string,&nbsp;newdirfd&nbsp;int,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417722">//sys&nbsp;&nbsp;&nbsp;&nbspRmdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417759">//sys&nbsp;&nbsp;&nbsp;&nbspSetdomainname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417801">//sys&nbsp;&nbsp;&nbsp;&nbspSethostname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">845</span><span class="comment" id="2417841">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetpgid(pid&nbsp;int,&nbsp;pgid&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417888">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetsid()&nbsp;(pid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417926">//sysnb&nbsp;&nbsp;&nbsp;&nbspSettimeofday(tv&nbsp;*Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2417973">//&nbsp;issue&nbsp;1435.</span><br>
<span class="lineno">850</span><span class="comment" id="2417988">//&nbsp;On&nbsp;linux&nbsp;Setuid&nbsp;and&nbsp;Setgid&nbsp;only&nbsp;affects&nbsp;the&nbsp;current&nbsp;thread,&nbsp;not&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="2418068">//&nbsp;This&nbsp;does&nbsp;not&nbsp;match&nbsp;what&nbsp;most&nbsp;callers&nbsp;expect&nbsp;so&nbsp;we&nbsp;must&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2418143">//&nbsp;here&nbsp;rather&nbsp;than&nbsp;letting&nbsp;the&nbsp;caller&nbsp;think&nbsp;that&nbsp;the&nbsp;call&nbsp;succeeded.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2418214">func</span>&nbsp;<span class="ident" id="2418219">Setuid</span><span class="op" id="2418225">(</span><span class="ident" id="2418226">uid</span>&nbsp;<span class="builtintype" id="2418230">int</span><span class="op" id="2418233">)</span>&nbsp;<span class="op" id="2418235">(</span><span class="ident" id="2418236">err</span>&nbsp;<span class="builtintype" id="2418240">error</span><span class="op" id="2418245">)</span>&nbsp;<span class="op" id="2418247">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418250">return</span>&nbsp;<span class="ident" id="2418257">EOPNOTSUPP</span><br>
<span class="lineno"></span><span class="op" id="2418268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2418271">func</span>&nbsp;<span class="ident" id="2418276">Setgid</span><span class="op" id="2418282">(</span><span class="ident" id="2418283">uid</span>&nbsp;<span class="builtintype" id="2418287">int</span><span class="op" id="2418290">)</span>&nbsp;<span class="op" id="2418292">(</span><span class="ident" id="2418293">err</span>&nbsp;<span class="builtintype" id="2418297">error</span><span class="op" id="2418302">)</span>&nbsp;<span class="op" id="2418304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418307">return</span>&nbsp;<span class="ident" id="2418314">EOPNOTSUPP</span><br>
<span class="lineno">860</span><span class="op" id="2418325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2418328">//sys&nbsp;&nbsp;&nbsp;&nbspSetpriority(which&nbsp;int,&nbsp;who&nbsp;int,&nbsp;prio&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418388">//sys&nbsp;&nbsp;&nbsp;&nbspSetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;data&nbsp;[]byte,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418465">//sys&nbsp;&nbsp;&nbsp;&nbspSymlink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">865</span><span class="comment" id="2418523">//sys&nbsp;&nbsp;&nbsp;&nbspSync()</span><br>
<span class="lineno"></span><span class="comment" id="2418536">//sysnb&nbsp;&nbsp;&nbsp;&nbspSysinfo(info&nbsp;*Sysinfo_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418581">//sys&nbsp;&nbsp;&nbsp;&nbspTee(rfd&nbsp;int,&nbsp;wfd&nbsp;int,&nbsp;len&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(n&nbsp;int64,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418650">//sysnb&nbsp;&nbsp;&nbsp;&nbspTgkill(tgid&nbsp;int,&nbsp;tid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418708">//sysnb&nbsp;&nbsp;&nbsp;&nbspTimes(tms&nbsp;*Tms)&nbsp;(ticks&nbsp;uintptr,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">870</span><span class="comment" id="2418759">//sysnb&nbsp;&nbsp;&nbsp;&nbspUmask(mask&nbsp;int)&nbsp;(oldmask&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2418797">//sysnb&nbsp;&nbsp;&nbsp;&nbspUname(buf&nbsp;*Utsname)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418837">//sys&nbsp;&nbsp;&nbsp;&nbspUnlink(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418875">//sys&nbsp;&nbsp;&nbsp;&nbspUnlinkat(dirfd&nbsp;int,&nbsp;path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418926">//sys&nbsp;&nbsp;&nbsp;&nbspUnmount(target&nbsp;string,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_UMOUNT2</span><br>
<span class="lineno">875</span><span class="comment" id="2418992">//sys&nbsp;&nbsp;&nbsp;&nbspUnshare(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419029">//sys&nbsp;&nbsp;&nbsp;&nbspUstat(dev&nbsp;int,&nbsp;ubuf&nbsp;*Ustat_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419077">//sys&nbsp;&nbsp;&nbsp;&nbspUtime(path&nbsp;string,&nbsp;buf&nbsp;*Utimbuf)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419128">//sys&nbsp;&nbsp;&nbsp;&nbspwrite(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419177">//sys&nbsp;&nbsp;&nbsp;&nbspexitThread(code&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_EXIT</span><br>
<span class="lineno">880</span><span class="comment" id="2419227">//sys&nbsp;&nbsp;&nbsp;&nbspreadlen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_READ</span><br>
<span class="lineno"></span><span class="comment" id="2419296">//sys&nbsp;&nbsp;&nbsp;&nbspwritelen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_WRITE</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2419368">//&nbsp;mmap&nbsp;varies&nbsp;by&nbsp;architecture;&nbsp;see&nbsp;syscall_linux_*.go.</span><br>
<span class="lineno"></span><span class="comment" id="2419424">//sys&nbsp;&nbsp;&nbsp;&nbspmunmap(addr&nbsp;uintptr,&nbsp;length&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span><span class="keyword" id="2419480">var</span>&nbsp;<span class="ident" id="2419484">mapper</span>&nbsp;<span class="op" id="2419491">=</span>&nbsp;<span class="op" id="2419493">&amp;</span><span class="ident" id="2419494">mmapper</span><span class="op" id="2419501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419504">active</span><span class="op" id="2419510">:</span>&nbsp;<span class="builtinfunc" id="2419512">make</span><span class="op" id="2419516">(</span><span class="keyword" id="2419517">map</span><span class="op" id="2419520">[</span><span class="op" id="2419521">*</span><span class="builtintype" id="2419522">byte</span><span class="op" id="2419526">]</span><span class="op" id="2419527">[</span><span class="op" id="2419528">]</span><span class="builtintype" id="2419529">byte</span><span class="op" id="2419533">)</span><span class="op" id="2419534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419537">mmap</span><span class="op" id="2419541">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2419545">mmap</span><span class="op" id="2419549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419552">munmap</span><span class="op" id="2419558">:</span>&nbsp;<span class="ident" id="2419560">munmap</span><span class="op" id="2419566">,</span><br>
<span class="lineno">890</span><span class="op" id="2419568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2419571">func</span>&nbsp;<span class="ident" id="2419576">Mmap</span><span class="op" id="2419580">(</span><span class="ident" id="2419581">fd</span>&nbsp;<span class="builtintype" id="2419584">int</span><span class="op" id="2419587">,</span>&nbsp;<span class="ident" id="2419589">offset</span>&nbsp;<span class="ident" id="2419596">int64</span><span class="op" id="2419601">,</span>&nbsp;<span class="ident" id="2419603">length</span>&nbsp;<span class="builtintype" id="2419610">int</span><span class="op" id="2419613">,</span>&nbsp;<span class="ident" id="2419615">prot</span>&nbsp;<span class="builtintype" id="2419620">int</span><span class="op" id="2419623">,</span>&nbsp;<span class="ident" id="2419625">flags</span>&nbsp;<span class="builtintype" id="2419631">int</span><span class="op" id="2419634">)</span>&nbsp;<span class="op" id="2419636">(</span><span class="ident" id="2419637">data</span>&nbsp;<span class="op" id="2419642">[</span><span class="op" id="2419643">]</span><span class="builtintype" id="2419644">byte</span><span class="op" id="2419648">,</span>&nbsp;<span class="ident" id="2419650">err</span>&nbsp;<span class="builtintype" id="2419654">error</span><span class="op" id="2419659">)</span>&nbsp;<span class="op" id="2419661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419664">return</span>&nbsp;<span class="ident" id="2419671">mapper</span><span class="op" id="2419677">.</span><span class="ident" id="2419678">Mmap</span><span class="op" id="2419682">(</span><span class="ident" id="2419683">fd</span><span class="op" id="2419685">,</span>&nbsp;<span class="ident" id="2419687">offset</span><span class="op" id="2419693">,</span>&nbsp;<span class="ident" id="2419695">length</span><span class="op" id="2419701">,</span>&nbsp;<span class="ident" id="2419703">prot</span><span class="op" id="2419707">,</span>&nbsp;<span class="ident" id="2419709">flags</span><span class="op" id="2419714">)</span><br>
<span class="lineno"></span><span class="op" id="2419716">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="keyword" id="2419719">func</span>&nbsp;<span class="ident" id="2419724">Munmap</span><span class="op" id="2419730">(</span><span class="ident" id="2419731">b</span>&nbsp;<span class="op" id="2419733">[</span><span class="op" id="2419734">]</span><span class="builtintype" id="2419735">byte</span><span class="op" id="2419739">)</span>&nbsp;<span class="op" id="2419741">(</span><span class="ident" id="2419742">err</span>&nbsp;<span class="builtintype" id="2419746">error</span><span class="op" id="2419751">)</span>&nbsp;<span class="op" id="2419753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419756">return</span>&nbsp;<span class="ident" id="2419763">mapper</span><span class="op" id="2419769">.</span><span class="ident" id="2419770">Munmap</span><span class="op" id="2419776">(</span><span class="ident" id="2419777">b</span><span class="op" id="2419778">)</span><br>
<span class="lineno"></span><span class="op" id="2419780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="2419783">//sys&nbsp;&nbsp;&nbsp;&nbspMadvise(b&nbsp;[]byte,&nbsp;advice&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419831">//sys&nbsp;&nbsp;&nbsp;&nbspMprotect(b&nbsp;[]byte,&nbsp;prot&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419878">//sys&nbsp;&nbsp;&nbsp;&nbspMlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419912">//sys&nbsp;&nbsp;&nbsp;&nbspMunlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419948">//sys&nbsp;&nbsp;&nbsp;&nbspMlockall(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">905</span><span class="comment" id="2419986">//sys&nbsp;&nbsp;&nbsp;&nbspMunlockall()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2420018">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Unimplemented<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno">910</span><span class="comment" id="2420042">//&nbsp;AddKey</span><br>
<span class="lineno"></span><span class="comment" id="2420052">//&nbsp;AfsSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2420066">//&nbsp;Alarm</span><br>
<span class="lineno"></span><span class="comment" id="2420075">//&nbsp;ArchPrctl</span><br>
<span class="lineno"></span><span class="comment" id="2420088">//&nbsp;Brk</span><br>
<span class="lineno">915</span><span class="comment" id="2420095">//&nbsp;Capget</span><br>
<span class="lineno"></span><span class="comment" id="2420105">//&nbsp;Capset</span><br>
<span class="lineno"></span><span class="comment" id="2420115">//&nbsp;ClockGetres</span><br>
<span class="lineno"></span><span class="comment" id="2420130">//&nbsp;ClockGettime</span><br>
<span class="lineno"></span><span class="comment" id="2420146">//&nbsp;ClockNanosleep</span><br>
<span class="lineno">920</span><span class="comment" id="2420164">//&nbsp;ClockSettime</span><br>
<span class="lineno"></span><span class="comment" id="2420180">//&nbsp;Clone</span><br>
<span class="lineno"></span><span class="comment" id="2420189">//&nbsp;CreateModule</span><br>
<span class="lineno"></span><span class="comment" id="2420205">//&nbsp;DeleteModule</span><br>
<span class="lineno"></span><span class="comment" id="2420221">//&nbsp;EpollCtlOld</span><br>
<span class="lineno">925</span><span class="comment" id="2420236">//&nbsp;EpollPwait</span><br>
<span class="lineno"></span><span class="comment" id="2420250">//&nbsp;EpollWaitOld</span><br>
<span class="lineno"></span><span class="comment" id="2420266">//&nbsp;Eventfd</span><br>
<span class="lineno"></span><span class="comment" id="2420277">//&nbsp;Execve</span><br>
<span class="lineno"></span><span class="comment" id="2420287">//&nbsp;Fadvise64</span><br>
<span class="lineno">930</span><span class="comment" id="2420300">//&nbsp;Fgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2420313">//&nbsp;Flistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2420327">//&nbsp;Fork</span><br>
<span class="lineno"></span><span class="comment" id="2420335">//&nbsp;Fremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2420351">//&nbsp;Fsetxattr</span><br>
<span class="lineno">935</span><span class="comment" id="2420364">//&nbsp;Futex</span><br>
<span class="lineno"></span><span class="comment" id="2420373">//&nbsp;GetKernelSyms</span><br>
<span class="lineno"></span><span class="comment" id="2420390">//&nbsp;GetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2420406">//&nbsp;GetRobustList</span><br>
<span class="lineno"></span><span class="comment" id="2420423">//&nbsp;GetThreadArea</span><br>
<span class="lineno">940</span><span class="comment" id="2420440">//&nbsp;Getitimer</span><br>
<span class="lineno"></span><span class="comment" id="2420453">//&nbsp;Getpmsg</span><br>
<span class="lineno"></span><span class="comment" id="2420464">//&nbsp;IoCancel</span><br>
<span class="lineno"></span><span class="comment" id="2420476">//&nbsp;IoDestroy</span><br>
<span class="lineno"></span><span class="comment" id="2420489">//&nbsp;IoGetevents</span><br>
<span class="lineno">945</span><span class="comment" id="2420504">//&nbsp;IoSetup</span><br>
<span class="lineno"></span><span class="comment" id="2420515">//&nbsp;IoSubmit</span><br>
<span class="lineno"></span><span class="comment" id="2420527">//&nbsp;Ioctl</span><br>
<span class="lineno"></span><span class="comment" id="2420536">//&nbsp;IoprioGet</span><br>
<span class="lineno"></span><span class="comment" id="2420549">//&nbsp;IoprioSet</span><br>
<span class="lineno">950</span><span class="comment" id="2420562">//&nbsp;KexecLoad</span><br>
<span class="lineno"></span><span class="comment" id="2420575">//&nbsp;Keyctl</span><br>
<span class="lineno"></span><span class="comment" id="2420585">//&nbsp;Lgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2420598">//&nbsp;Llistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2420612">//&nbsp;LookupDcookie</span><br>
<span class="lineno">955</span><span class="comment" id="2420629">//&nbsp;Lremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2420645">//&nbsp;Lsetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2420658">//&nbsp;Mbind</span><br>
<span class="lineno"></span><span class="comment" id="2420667">//&nbsp;MigratePages</span><br>
<span class="lineno"></span><span class="comment" id="2420683">//&nbsp;Mincore</span><br>
<span class="lineno">960</span><span class="comment" id="2420694">//&nbsp;ModifyLdt</span><br>
<span class="lineno"></span><span class="comment" id="2420707">//&nbsp;Mount</span><br>
<span class="lineno"></span><span class="comment" id="2420716">//&nbsp;MovePages</span><br>
<span class="lineno"></span><span class="comment" id="2420729">//&nbsp;Mprotect</span><br>
<span class="lineno"></span><span class="comment" id="2420741">//&nbsp;MqGetsetattr</span><br>
<span class="lineno">965</span><span class="comment" id="2420757">//&nbsp;MqNotify</span><br>
<span class="lineno"></span><span class="comment" id="2420769">//&nbsp;MqOpen</span><br>
<span class="lineno"></span><span class="comment" id="2420779">//&nbsp;MqTimedreceive</span><br>
<span class="lineno"></span><span class="comment" id="2420797">//&nbsp;MqTimedsend</span><br>
<span class="lineno"></span><span class="comment" id="2420812">//&nbsp;MqUnlink</span><br>
<span class="lineno">970</span><span class="comment" id="2420824">//&nbsp;Mremap</span><br>
<span class="lineno"></span><span class="comment" id="2420834">//&nbsp;Msgctl</span><br>
<span class="lineno"></span><span class="comment" id="2420844">//&nbsp;Msgget</span><br>
<span class="lineno"></span><span class="comment" id="2420854">//&nbsp;Msgrcv</span><br>
<span class="lineno"></span><span class="comment" id="2420864">//&nbsp;Msgsnd</span><br>
<span class="lineno">975</span><span class="comment" id="2420874">//&nbsp;Msync</span><br>
<span class="lineno"></span><span class="comment" id="2420883">//&nbsp;Newfstatat</span><br>
<span class="lineno"></span><span class="comment" id="2420897">//&nbsp;Nfsservctl</span><br>
<span class="lineno"></span><span class="comment" id="2420911">//&nbsp;Personality</span><br>
<span class="lineno"></span><span class="comment" id="2420926">//&nbsp;Poll</span><br>
<span class="lineno">980</span><span class="comment" id="2420934">//&nbsp;Ppoll</span><br>
<span class="lineno"></span><span class="comment" id="2420943">//&nbsp;Prctl</span><br>
<span class="lineno"></span><span class="comment" id="2420952">//&nbsp;Pselect6</span><br>
<span class="lineno"></span><span class="comment" id="2420964">//&nbsp;Ptrace</span><br>
<span class="lineno"></span><span class="comment" id="2420974">//&nbsp;Putpmsg</span><br>
<span class="lineno">985</span><span class="comment" id="2420985">//&nbsp;QueryModule</span><br>
<span class="lineno"></span><span class="comment" id="2421000">//&nbsp;Quotactl</span><br>
<span class="lineno"></span><span class="comment" id="2421012">//&nbsp;Readahead</span><br>
<span class="lineno"></span><span class="comment" id="2421025">//&nbsp;Readv</span><br>
<span class="lineno"></span><span class="comment" id="2421034">//&nbsp;RemapFilePages</span><br>
<span class="lineno">990</span><span class="comment" id="2421052">//&nbsp;RequestKey</span><br>
<span class="lineno"></span><span class="comment" id="2421066">//&nbsp;RestartSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2421084">//&nbsp;RtSigaction</span><br>
<span class="lineno"></span><span class="comment" id="2421099">//&nbsp;RtSigpending</span><br>
<span class="lineno"></span><span class="comment" id="2421115">//&nbsp;RtSigprocmask</span><br>
<span class="lineno">995</span><span class="comment" id="2421132">//&nbsp;RtSigqueueinfo</span><br>
<span class="lineno"></span><span class="comment" id="2421150">//&nbsp;RtSigreturn</span><br>
<span class="lineno"></span><span class="comment" id="2421165">//&nbsp;RtSigsuspend</span><br>
<span class="lineno"></span><span class="comment" id="2421181">//&nbsp;RtSigtimedwait</span><br>
<span class="lineno"></span><span class="comment" id="2421199">//&nbsp;SchedGetPriorityMax</span><br>
<span class="lineno">1000</span><span class="comment" id="2421222">//&nbsp;SchedGetPriorityMin</span><br>
<span class="lineno"></span><span class="comment" id="2421245">//&nbsp;SchedGetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2421265">//&nbsp;SchedGetparam</span><br>
<span class="lineno"></span><span class="comment" id="2421282">//&nbsp;SchedGetscheduler</span><br>
<span class="lineno"></span><span class="comment" id="2421303">//&nbsp;SchedRrGetInterval</span><br>
<span class="lineno">1005</span><span class="comment" id="2421325">//&nbsp;SchedSetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2421345">//&nbsp;SchedSetparam</span><br>
<span class="lineno"></span><span class="comment" id="2421362">//&nbsp;SchedYield</span><br>
<span class="lineno"></span><span class="comment" id="2421376">//&nbsp;Security</span><br>
<span class="lineno"></span><span class="comment" id="2421388">//&nbsp;Semctl</span><br>
<span class="lineno">1010</span><span class="comment" id="2421398">//&nbsp;Semget</span><br>
<span class="lineno"></span><span class="comment" id="2421408">//&nbsp;Semop</span><br>
<span class="lineno"></span><span class="comment" id="2421417">//&nbsp;Semtimedop</span><br>
<span class="lineno"></span><span class="comment" id="2421431">//&nbsp;SetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2421447">//&nbsp;SetRobustList</span><br>
<span class="lineno">1015</span><span class="comment" id="2421464">//&nbsp;SetThreadArea</span><br>
<span class="lineno"></span><span class="comment" id="2421481">//&nbsp;SetTidAddress</span><br>
<span class="lineno"></span><span class="comment" id="2421498">//&nbsp;Shmat</span><br>
<span class="lineno"></span><span class="comment" id="2421507">//&nbsp;Shmctl</span><br>
<span class="lineno"></span><span class="comment" id="2421517">//&nbsp;Shmdt</span><br>
<span class="lineno">1020</span><span class="comment" id="2421526">//&nbsp;Shmget</span><br>
<span class="lineno"></span><span class="comment" id="2421536">//&nbsp;Sigaltstack</span><br>
<span class="lineno"></span><span class="comment" id="2421551">//&nbsp;Signalfd</span><br>
<span class="lineno"></span><span class="comment" id="2421563">//&nbsp;Swapoff</span><br>
<span class="lineno"></span><span class="comment" id="2421574">//&nbsp;Swapon</span><br>
<span class="lineno">1025</span><span class="comment" id="2421584">//&nbsp;Sysfs</span><br>
<span class="lineno"></span><span class="comment" id="2421593">//&nbsp;TimerCreate</span><br>
<span class="lineno"></span><span class="comment" id="2421608">//&nbsp;TimerDelete</span><br>
<span class="lineno"></span><span class="comment" id="2421623">//&nbsp;TimerGetoverrun</span><br>
<span class="lineno"></span><span class="comment" id="2421642">//&nbsp;TimerGettime</span><br>
<span class="lineno">1030</span><span class="comment" id="2421658">//&nbsp;TimerSettime</span><br>
<span class="lineno"></span><span class="comment" id="2421674">//&nbsp;Timerfd</span><br>
<span class="lineno"></span><span class="comment" id="2421685">//&nbsp;Tkill&nbsp;(obsolete)</span><br>
<span class="lineno"></span><span class="comment" id="2421705">//&nbsp;Tuxcall</span><br>
<span class="lineno"></span><span class="comment" id="2421716">//&nbsp;Umount2</span><br>
<span class="lineno">1035</span><span class="comment" id="2421727">//&nbsp;Uselib</span><br>
<span class="lineno"></span><span class="comment" id="2421737">//&nbsp;Utimensat</span><br>
<span class="lineno"></span><span class="comment" id="2421750">//&nbsp;Vfork</span><br>
<span class="lineno"></span><span class="comment" id="2421759">//&nbsp;Vhangup</span><br>
<span class="lineno"></span><span class="comment" id="2421770">//&nbsp;Vmsplice</span><br>
<span class="lineno">1040</span><span class="comment" id="2421782">//&nbsp;Vserver</span><br>
<span class="lineno"></span><span class="comment" id="2421793">//&nbsp;Waitid</span><br>
<span class="lineno"></span><span class="comment" id="2421803">//&nbsp;_Sysctl</span>
</div>
</body>
</html>
