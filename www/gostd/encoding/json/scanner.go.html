<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5343436">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5343492">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5343546">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5343597">package</span>&nbsp;<span class="ident" id="5343605">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5343611">//&nbsp;JSON&nbsp;value&nbsp;parser&nbsp;state&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="5343647">//&nbsp;Just&nbsp;about&nbsp;at&nbsp;the&nbsp;limit&nbsp;of&nbsp;what&nbsp;is&nbsp;reasonable&nbsp;to&nbsp;write&nbsp;by&nbsp;hand.</span><br>
<span class="lineno"></span><span class="comment" id="5343714">//&nbsp;Some&nbsp;parts&nbsp;are&nbsp;a&nbsp;bit&nbsp;tedious,&nbsp;but&nbsp;overall&nbsp;it&nbsp;nicely&nbsp;factors&nbsp;out&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="5343785">//&nbsp;otherwise&nbsp;common&nbsp;code&nbsp;from&nbsp;the&nbsp;multiple&nbsp;scanning&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="5343847">//&nbsp;in&nbsp;this&nbsp;package&nbsp;(Compact,&nbsp;Indent,&nbsp;checkValid,&nbsp;nextValue,&nbsp;etc).</span><br>
<span class="lineno"></span><span class="comment" id="5343913">//</span><br>
<span class="lineno"></span><span class="comment" id="5343916">//&nbsp;This&nbsp;file&nbsp;starts&nbsp;with&nbsp;two&nbsp;simple&nbsp;examples&nbsp;using&nbsp;the&nbsp;scanner</span><br>
<span class="lineno"></span><span class="comment" id="5343979">//&nbsp;before&nbsp;diving&nbsp;into&nbsp;the&nbsp;scanner&nbsp;itself.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="5344022">import</span>&nbsp;<span class="string" id="5344029">&#34;strconv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5344040">//&nbsp;checkValid&nbsp;verifies&nbsp;that&nbsp;data&nbsp;is&nbsp;valid&nbsp;JSON-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="5344101">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;checkValid&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno">20</span><span class="keyword" id="5344168">func</span>&nbsp;<span class="ident" id="5344173">checkValid</span><span class="op" id="5344183">(</span><span class="ident" id="5344184">data</span>&nbsp;<span class="op" id="5344189">[</span><span class="op" id="5344190">]</span><span class="builtintype" id="5344191">byte</span><span class="op" id="5344195">,</span>&nbsp;<span class="ident" id="5344197">scan</span>&nbsp;<span class="op" id="5344202">*</span><span class="ident" id="5344203">scanner</span><span class="op" id="5344210">)</span>&nbsp;<span class="builtintype" id="5344212">error</span>&nbsp;<span class="op" id="5344218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5344221">scan</span><span class="op" id="5344225">.</span><span class="ident" id="5344226">reset</span><span class="op" id="5344231">(</span><span class="op" id="5344232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344235">for</span>&nbsp;<span class="ident" id="5344239">_</span><span class="op" id="5344240">,</span>&nbsp;<span class="ident" id="5344242">c</span>&nbsp;<span class="op" id="5344244">:=</span>&nbsp;<span class="keyword" id="5344247">range</span>&nbsp;<span class="ident" id="5344253">data</span>&nbsp;<span class="op" id="5344258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5344262">scan</span><span class="op" id="5344266">.</span><span class="ident" id="5344267">bytes</span><span class="op" id="5344272">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344277">if</span>&nbsp;<span class="ident" id="5344280">scan</span><span class="op" id="5344284">.</span><span class="ident" id="5344285">step</span><span class="op" id="5344289">(</span><span class="ident" id="5344290">scan</span><span class="op" id="5344294">,</span>&nbsp;<span class="builtintype" id="5344296">int</span><span class="op" id="5344299">(</span><span class="ident" id="5344300">c</span><span class="op" id="5344301">)</span><span class="op" id="5344302">)</span>&nbsp;<span class="op" id="5344304">==</span>&nbsp;<span class="ident" id="5344307">scanError</span>&nbsp;<span class="op" id="5344317">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344322">return</span>&nbsp;<span class="ident" id="5344329">scan</span><span class="op" id="5344333">.</span><span class="ident" id="5344334">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5344340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5344343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344346">if</span>&nbsp;<span class="ident" id="5344349">scan</span><span class="op" id="5344353">.</span><span class="ident" id="5344354">eof</span><span class="op" id="5344357">(</span><span class="op" id="5344358">)</span>&nbsp;<span class="op" id="5344360">==</span>&nbsp;<span class="ident" id="5344363">scanError</span>&nbsp;<span class="op" id="5344373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344377">return</span>&nbsp;<span class="ident" id="5344384">scan</span><span class="op" id="5344388">.</span><span class="ident" id="5344389">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5344394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344397">return</span>&nbsp;<span class="ident" id="5344404">nil</span><br>
<span class="lineno"></span><span class="op" id="5344408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5344411">//&nbsp;nextValue&nbsp;splits&nbsp;data&nbsp;after&nbsp;the&nbsp;next&nbsp;whole&nbsp;JSON&nbsp;value,</span><br>
<span class="lineno">35</span><span class="comment" id="5344469">//&nbsp;returning&nbsp;that&nbsp;value&nbsp;and&nbsp;the&nbsp;bytes&nbsp;that&nbsp;follow&nbsp;it&nbsp;as&nbsp;separate&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="5344542">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;nextValue&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="5344608">func</span>&nbsp;<span class="ident" id="5344613">nextValue</span><span class="op" id="5344622">(</span><span class="ident" id="5344623">data</span>&nbsp;<span class="op" id="5344628">[</span><span class="op" id="5344629">]</span><span class="builtintype" id="5344630">byte</span><span class="op" id="5344634">,</span>&nbsp;<span class="ident" id="5344636">scan</span>&nbsp;<span class="op" id="5344641">*</span><span class="ident" id="5344642">scanner</span><span class="op" id="5344649">)</span>&nbsp;<span class="op" id="5344651">(</span><span class="ident" id="5344652">value</span><span class="op" id="5344657">,</span>&nbsp;<span class="ident" id="5344659">rest</span>&nbsp;<span class="op" id="5344664">[</span><span class="op" id="5344665">]</span><span class="builtintype" id="5344666">byte</span><span class="op" id="5344670">,</span>&nbsp;<span class="ident" id="5344672">err</span>&nbsp;<span class="builtintype" id="5344676">error</span><span class="op" id="5344681">)</span>&nbsp;<span class="op" id="5344683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5344686">scan</span><span class="op" id="5344690">.</span><span class="ident" id="5344691">reset</span><span class="op" id="5344696">(</span><span class="op" id="5344697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344700">for</span>&nbsp;<span class="ident" id="5344704">i</span><span class="op" id="5344705">,</span>&nbsp;<span class="ident" id="5344707">c</span>&nbsp;<span class="op" id="5344709">:=</span>&nbsp;<span class="keyword" id="5344712">range</span>&nbsp;<span class="ident" id="5344718">data</span>&nbsp;<span class="op" id="5344723">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5344727">v</span>&nbsp;<span class="op" id="5344729">:=</span>&nbsp;<span class="ident" id="5344732">scan</span><span class="op" id="5344736">.</span><span class="ident" id="5344737">step</span><span class="op" id="5344741">(</span><span class="ident" id="5344742">scan</span><span class="op" id="5344746">,</span>&nbsp;<span class="builtintype" id="5344748">int</span><span class="op" id="5344751">(</span><span class="ident" id="5344752">c</span><span class="op" id="5344753">)</span><span class="op" id="5344754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344758">if</span>&nbsp;<span class="ident" id="5344761">v</span>&nbsp;<span class="op" id="5344763">&gt;=</span>&nbsp;<span class="ident" id="5344766">scanEnd</span>&nbsp;<span class="op" id="5344774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344779">switch</span>&nbsp;<span class="ident" id="5344786">v</span>&nbsp;<span class="op" id="5344788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344793">case</span>&nbsp;<span class="ident" id="5344798">scanError</span><span class="op" id="5344807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344813">return</span>&nbsp;<span class="ident" id="5344820">nil</span><span class="op" id="5344823">,</span>&nbsp;<span class="ident" id="5344825">nil</span><span class="op" id="5344828">,</span>&nbsp;<span class="ident" id="5344830">scan</span><span class="op" id="5344834">.</span><span class="ident" id="5344835">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344842">case</span>&nbsp;<span class="ident" id="5344847">scanEnd</span><span class="op" id="5344854">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344860">return</span>&nbsp;<span class="ident" id="5344867">data</span><span class="op" id="5344871">[</span><span class="num" id="5344872">0</span><span class="op" id="5344873">:</span><span class="ident" id="5344874">i</span><span class="op" id="5344875">]</span><span class="op" id="5344876">,</span>&nbsp;<span class="ident" id="5344878">data</span><span class="op" id="5344882">[</span><span class="ident" id="5344883">i</span><span class="op" id="5344884">:</span><span class="op" id="5344885">]</span><span class="op" id="5344886">,</span>&nbsp;<span class="ident" id="5344888">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5344895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5344899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5344902">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344905">if</span>&nbsp;<span class="ident" id="5344908">scan</span><span class="op" id="5344912">.</span><span class="ident" id="5344913">eof</span><span class="op" id="5344916">(</span><span class="op" id="5344917">)</span>&nbsp;<span class="op" id="5344919">==</span>&nbsp;<span class="ident" id="5344922">scanError</span>&nbsp;<span class="op" id="5344932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344936">return</span>&nbsp;<span class="ident" id="5344943">nil</span><span class="op" id="5344946">,</span>&nbsp;<span class="ident" id="5344948">nil</span><span class="op" id="5344951">,</span>&nbsp;<span class="ident" id="5344953">scan</span><span class="op" id="5344957">.</span><span class="ident" id="5344958">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5344963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5344966">return</span>&nbsp;<span class="ident" id="5344973">data</span><span class="op" id="5344977">,</span>&nbsp;<span class="ident" id="5344979">nil</span><span class="op" id="5344982">,</span>&nbsp;<span class="ident" id="5344984">nil</span><br>
<span class="lineno"></span><span class="op" id="5344988">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="5344991">//&nbsp;A&nbsp;SyntaxError&nbsp;is&nbsp;a&nbsp;description&nbsp;of&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5345049">type</span>&nbsp;<span class="ident" id="5345054">SyntaxError</span>&nbsp;<span class="keyword" id="5345066">struct</span>&nbsp;<span class="op" id="5345073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5345076">msg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5345083">string</span>&nbsp;<span class="comment" id="5345090">//&nbsp;description&nbsp;of&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5345115">Offset</span>&nbsp;<span class="ident" id="5345122">int64</span>&nbsp;&nbsp;<span class="comment" id="5345129">//&nbsp;error&nbsp;occurred&nbsp;after&nbsp;reading&nbsp;Offset&nbsp;bytes</span><br>
<span class="lineno">60</span><span class="op" id="5345174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5345177">func</span>&nbsp;<span class="op" id="5345182">(</span><span class="ident" id="5345183">e</span>&nbsp;<span class="op" id="5345185">*</span><span class="ident" id="5345186">SyntaxError</span><span class="op" id="5345197">)</span>&nbsp;<span class="ident" id="5345199">Error</span><span class="op" id="5345204">(</span><span class="op" id="5345205">)</span>&nbsp;<span class="builtintype" id="5345207">string</span>&nbsp;<span class="op" id="5345214">{</span>&nbsp;<span class="keyword" id="5345216">return</span>&nbsp;<span class="ident" id="5345223">e</span><span class="op" id="5345224">.</span><span class="ident" id="5345225">msg</span>&nbsp;<span class="op" id="5345229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5345232">//&nbsp;A&nbsp;scanner&nbsp;is&nbsp;a&nbsp;JSON&nbsp;scanning&nbsp;state&nbsp;machine.</span><br>
<span class="lineno">65</span><span class="comment" id="5345279">//&nbsp;Callers&nbsp;call&nbsp;scan.reset()&nbsp;and&nbsp;then&nbsp;pass&nbsp;bytes&nbsp;in&nbsp;one&nbsp;at&nbsp;a&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="5345345">//&nbsp;by&nbsp;calling&nbsp;scan.step(&amp;scan,&nbsp;c)&nbsp;for&nbsp;each&nbsp;byte.</span><br>
<span class="lineno"></span><span class="comment" id="5345394">//&nbsp;The&nbsp;return&nbsp;value,&nbsp;referred&nbsp;to&nbsp;as&nbsp;an&nbsp;opcode,&nbsp;tells&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5345451">//&nbsp;caller&nbsp;about&nbsp;significant&nbsp;parsing&nbsp;events&nbsp;like&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="5345509">//&nbsp;and&nbsp;ending&nbsp;literals,&nbsp;objects,&nbsp;and&nbsp;arrays,&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="5345566">//&nbsp;caller&nbsp;can&nbsp;follow&nbsp;along&nbsp;if&nbsp;it&nbsp;wishes.</span><br>
<span class="lineno"></span><span class="comment" id="5345607">//&nbsp;The&nbsp;return&nbsp;value&nbsp;scanEnd&nbsp;indicates&nbsp;that&nbsp;a&nbsp;single&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="5345669">//&nbsp;JSON&nbsp;value&nbsp;has&nbsp;been&nbsp;completed,&nbsp;*before*&nbsp;the&nbsp;byte&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5345726">//&nbsp;just&nbsp;got&nbsp;passed&nbsp;in.&nbsp;&nbsp;(The&nbsp;indication&nbsp;must&nbsp;be&nbsp;delayed&nbsp;in&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="5345791">//&nbsp;to&nbsp;recognize&nbsp;the&nbsp;end&nbsp;of&nbsp;numbers:&nbsp;is&nbsp;123&nbsp;a&nbsp;whole&nbsp;value&nbsp;or</span><br>
<span class="lineno">75</span><span class="comment" id="5345851">//&nbsp;the&nbsp;beginning&nbsp;of&nbsp;12345e+6?).</span><br>
<span class="lineno"></span><span class="keyword" id="5345883">type</span>&nbsp;<span class="ident" id="5345888">scanner</span>&nbsp;<span class="keyword" id="5345896">struct</span>&nbsp;<span class="op" id="5345903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5345906">//&nbsp;The&nbsp;step&nbsp;is&nbsp;a&nbsp;func&nbsp;to&nbsp;be&nbsp;called&nbsp;to&nbsp;execute&nbsp;the&nbsp;next&nbsp;transition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5345974">//&nbsp;Also&nbsp;tried&nbsp;using&nbsp;an&nbsp;integer&nbsp;constant&nbsp;and&nbsp;a&nbsp;single&nbsp;func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5346033">//&nbsp;with&nbsp;a&nbsp;switch,&nbsp;but&nbsp;using&nbsp;the&nbsp;func&nbsp;directly&nbsp;was&nbsp;10%&nbsp;faster</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5346095">//&nbsp;on&nbsp;a&nbsp;64-bit&nbsp;Mac&nbsp;Mini,&nbsp;and&nbsp;it&#39;s&nbsp;nicer&nbsp;to&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5346145">step</span>&nbsp;<span class="keyword" id="5346150">func</span><span class="op" id="5346154">(</span><span class="op" id="5346155">*</span><span class="ident" id="5346156">scanner</span><span class="op" id="5346163">,</span>&nbsp;<span class="builtintype" id="5346165">int</span><span class="op" id="5346168">)</span>&nbsp;<span class="builtintype" id="5346170">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5346176">//&nbsp;Reached&nbsp;end&nbsp;of&nbsp;top-level&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5346212">endTop</span>&nbsp;<span class="builtintype" id="5346219">bool</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5346226">//&nbsp;Stack&nbsp;of&nbsp;what&nbsp;we&#39;re&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;-&nbsp;array&nbsp;values,&nbsp;object&nbsp;keys,&nbsp;object&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5346311">parseState</span>&nbsp;<span class="op" id="5346322">[</span><span class="op" id="5346323">]</span><span class="builtintype" id="5346324">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5346330">//&nbsp;Error&nbsp;that&nbsp;happened,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5346363">err</span>&nbsp;<span class="builtintype" id="5346367">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5346375">//&nbsp;1-byte&nbsp;redo&nbsp;(see&nbsp;undo&nbsp;method)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5346409">redo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5346419">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5346425">redoCode</span>&nbsp;&nbsp;<span class="builtintype" id="5346435">int</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5346440">redoState</span>&nbsp;<span class="keyword" id="5346450">func</span><span class="op" id="5346454">(</span><span class="op" id="5346455">*</span><span class="ident" id="5346456">scanner</span><span class="op" id="5346463">,</span>&nbsp;<span class="builtintype" id="5346465">int</span><span class="op" id="5346468">)</span>&nbsp;<span class="builtintype" id="5346470">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5346476">//&nbsp;total&nbsp;bytes&nbsp;consumed,&nbsp;updated&nbsp;by&nbsp;decoder.Decode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5346528">bytes</span>&nbsp;<span class="ident" id="5346534">int64</span><br>
<span class="lineno"></span><span class="op" id="5346540">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5346543">//&nbsp;These&nbsp;values&nbsp;are&nbsp;returned&nbsp;by&nbsp;the&nbsp;state&nbsp;transition&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="5346606">//&nbsp;assigned&nbsp;to&nbsp;scanner.state&nbsp;and&nbsp;the&nbsp;method&nbsp;scanner.eof.</span><br>
<span class="lineno"></span><span class="comment" id="5346663">//&nbsp;They&nbsp;give&nbsp;details&nbsp;about&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;the&nbsp;scan&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5346725">//&nbsp;callers&nbsp;might&nbsp;be&nbsp;interested&nbsp;to&nbsp;know&nbsp;about.</span><br>
<span class="lineno">105</span><span class="comment" id="5346771">//&nbsp;It&nbsp;is&nbsp;okay&nbsp;to&nbsp;ignore&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;any&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="5346830">//&nbsp;call&nbsp;to&nbsp;scanner.state:&nbsp;if&nbsp;one&nbsp;call&nbsp;returns&nbsp;scanError,</span><br>
<span class="lineno"></span><span class="comment" id="5346887">//&nbsp;every&nbsp;subsequent&nbsp;call&nbsp;will&nbsp;return&nbsp;scanError&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="5346939">const</span>&nbsp;<span class="op" id="5346945">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5346948">//&nbsp;Continue.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5346962">scanContinue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5346979">=</span>&nbsp;<span class="ident" id="5346981">iota</span>&nbsp;<span class="comment" id="5346986">//&nbsp;uninteresting&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5347009">scanBeginLiteral</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347033">//&nbsp;end&nbsp;implied&nbsp;by&nbsp;next&nbsp;result&nbsp;!=&nbsp;scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5347080">scanBeginObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347104">//&nbsp;begin&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5347121">scanObjectKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347145">//&nbsp;just&nbsp;finished&nbsp;object&nbsp;key&nbsp;(string)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5347183">scanObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347207">//&nbsp;just&nbsp;finished&nbsp;non-last&nbsp;object&nbsp;value</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5347247">scanEndObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347271">//&nbsp;end&nbsp;object&nbsp;(implies&nbsp;scanObjectValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5347324">scanBeginArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347348">//&nbsp;begin&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5347364">scanArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347388">//&nbsp;just&nbsp;finished&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5347418">scanEndArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347442">//&nbsp;end&nbsp;array&nbsp;(implies&nbsp;scanArrayValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5347493">scanSkipSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347517">//&nbsp;space&nbsp;byte;&nbsp;can&nbsp;skip;&nbsp;known&nbsp;to&nbsp;be&nbsp;last&nbsp;&#34;continue&#34;&nbsp;result</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5347579">//&nbsp;Stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5347589">scanEnd</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5347599">//&nbsp;top-level&nbsp;value&nbsp;ended&nbsp;*before*&nbsp;this&nbsp;byte;&nbsp;known&nbsp;to&nbsp;be&nbsp;first&nbsp;&#34;stop&#34;&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5347677">scanError</span>&nbsp;<span class="comment" id="5347687">//&nbsp;hit&nbsp;an&nbsp;error,&nbsp;scanner.err.</span><br>
<span class="lineno"></span><span class="op" id="5347717">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5347720">//&nbsp;These&nbsp;values&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;parseState&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5347772">//&nbsp;They&nbsp;give&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;a&nbsp;composite&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="5347824">//&nbsp;being&nbsp;scanned.&nbsp;&nbsp;If&nbsp;the&nbsp;parser&nbsp;is&nbsp;inside&nbsp;a&nbsp;nested&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="5347882">//&nbsp;the&nbsp;parseState&nbsp;describes&nbsp;the&nbsp;nested&nbsp;state,&nbsp;outermost&nbsp;at&nbsp;entry&nbsp;0.</span><br>
<span class="lineno">130</span><span class="keyword" id="5347950">const</span>&nbsp;<span class="op" id="5347956">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5347959">parseObjectKey</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5347976">=</span>&nbsp;<span class="ident" id="5347978">iota</span>&nbsp;<span class="comment" id="5347983">//&nbsp;parsing&nbsp;object&nbsp;key&nbsp;(before&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5348021">parseObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5348045">//&nbsp;parsing&nbsp;object&nbsp;value&nbsp;(after&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5348084">parseArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5348108">//&nbsp;parsing&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span><span class="op" id="5348131">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="5348134">//&nbsp;reset&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;for&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="5348173">//&nbsp;It&nbsp;must&nbsp;be&nbsp;called&nbsp;before&nbsp;calling&nbsp;s.step.</span><br>
<span class="lineno"></span><span class="keyword" id="5348217">func</span>&nbsp;<span class="op" id="5348222">(</span><span class="ident" id="5348223">s</span>&nbsp;<span class="op" id="5348225">*</span><span class="ident" id="5348226">scanner</span><span class="op" id="5348233">)</span>&nbsp;<span class="ident" id="5348235">reset</span><span class="op" id="5348240">(</span><span class="op" id="5348241">)</span>&nbsp;<span class="op" id="5348243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5348246">s</span><span class="op" id="5348247">.</span><span class="ident" id="5348248">step</span>&nbsp;<span class="op" id="5348253">=</span>&nbsp;<span class="ident" id="5348255">stateBeginValue</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5348272">s</span><span class="op" id="5348273">.</span><span class="ident" id="5348274">parseState</span>&nbsp;<span class="op" id="5348285">=</span>&nbsp;<span class="ident" id="5348287">s</span><span class="op" id="5348288">.</span><span class="ident" id="5348289">parseState</span><span class="op" id="5348299">[</span><span class="num" id="5348300">0</span><span class="op" id="5348301">:</span><span class="num" id="5348302">0</span><span class="op" id="5348303">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5348306">s</span><span class="op" id="5348307">.</span><span class="ident" id="5348308">err</span>&nbsp;<span class="op" id="5348312">=</span>&nbsp;<span class="ident" id="5348314">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5348319">s</span><span class="op" id="5348320">.</span><span class="ident" id="5348321">redo</span>&nbsp;<span class="op" id="5348326">=</span>&nbsp;<span class="builtintype" id="5348328">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5348335">s</span><span class="op" id="5348336">.</span><span class="ident" id="5348337">endTop</span>&nbsp;<span class="op" id="5348344">=</span>&nbsp;<span class="builtintype" id="5348346">false</span><br>
<span class="lineno"></span><span class="op" id="5348352">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="5348355">//&nbsp;eof&nbsp;tells&nbsp;the&nbsp;scanner&nbsp;that&nbsp;the&nbsp;end&nbsp;of&nbsp;input&nbsp;has&nbsp;been&nbsp;reached.</span><br>
<span class="lineno"></span><span class="comment" id="5348420">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;scan&nbsp;status&nbsp;just&nbsp;as&nbsp;s.step&nbsp;does.</span><br>
<span class="lineno"></span><span class="keyword" id="5348469">func</span>&nbsp;<span class="op" id="5348474">(</span><span class="ident" id="5348475">s</span>&nbsp;<span class="op" id="5348477">*</span><span class="ident" id="5348478">scanner</span><span class="op" id="5348485">)</span>&nbsp;<span class="ident" id="5348487">eof</span><span class="op" id="5348490">(</span><span class="op" id="5348491">)</span>&nbsp;<span class="builtintype" id="5348493">int</span>&nbsp;<span class="op" id="5348497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5348500">if</span>&nbsp;<span class="ident" id="5348503">s</span><span class="op" id="5348504">.</span><span class="ident" id="5348505">err</span>&nbsp;<span class="op" id="5348509">!=</span>&nbsp;<span class="ident" id="5348512">nil</span>&nbsp;<span class="op" id="5348516">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5348520">return</span>&nbsp;<span class="ident" id="5348527">scanError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5348538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5348541">if</span>&nbsp;<span class="ident" id="5348544">s</span><span class="op" id="5348545">.</span><span class="ident" id="5348546">endTop</span>&nbsp;<span class="op" id="5348553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5348557">return</span>&nbsp;<span class="ident" id="5348564">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5348573">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5348576">s</span><span class="op" id="5348577">.</span><span class="ident" id="5348578">step</span><span class="op" id="5348582">(</span><span class="ident" id="5348583">s</span><span class="op" id="5348584">,</span>&nbsp;<span class="string" id="5348586">&#39;&nbsp;&#39;</span><span class="op" id="5348589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5348592">if</span>&nbsp;<span class="ident" id="5348595">s</span><span class="op" id="5348596">.</span><span class="ident" id="5348597">endTop</span>&nbsp;<span class="op" id="5348604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5348608">return</span>&nbsp;<span class="ident" id="5348615">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5348624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5348627">if</span>&nbsp;<span class="ident" id="5348630">s</span><span class="op" id="5348631">.</span><span class="ident" id="5348632">err</span>&nbsp;<span class="op" id="5348636">==</span>&nbsp;<span class="ident" id="5348639">nil</span>&nbsp;<span class="op" id="5348643">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5348647">s</span><span class="op" id="5348648">.</span><span class="ident" id="5348649">err</span>&nbsp;<span class="op" id="5348653">=</span>&nbsp;<span class="op" id="5348655">&amp;</span><span class="ident" id="5348656">SyntaxError</span><span class="op" id="5348667">{</span><span class="string" id="5348668">&#34;unexpected&nbsp;end&nbsp;of&nbsp;JSON&nbsp;input&#34;</span><span class="op" id="5348698">,</span>&nbsp;<span class="ident" id="5348700">s</span><span class="op" id="5348701">.</span><span class="ident" id="5348702">bytes</span><span class="op" id="5348707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5348710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5348713">return</span>&nbsp;<span class="ident" id="5348720">scanError</span><br>
<span class="lineno"></span><span class="op" id="5348730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="5348733">//&nbsp;pushParseState&nbsp;pushes&nbsp;a&nbsp;new&nbsp;parse&nbsp;state&nbsp;p&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="5348800">func</span>&nbsp;<span class="op" id="5348805">(</span><span class="ident" id="5348806">s</span>&nbsp;<span class="op" id="5348808">*</span><span class="ident" id="5348809">scanner</span><span class="op" id="5348816">)</span>&nbsp;<span class="ident" id="5348818">pushParseState</span><span class="op" id="5348832">(</span><span class="ident" id="5348833">p</span>&nbsp;<span class="builtintype" id="5348835">int</span><span class="op" id="5348838">)</span>&nbsp;<span class="op" id="5348840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5348843">s</span><span class="op" id="5348844">.</span><span class="ident" id="5348845">parseState</span>&nbsp;<span class="op" id="5348856">=</span>&nbsp;<span class="builtinfunc" id="5348858">append</span><span class="op" id="5348864">(</span><span class="ident" id="5348865">s</span><span class="op" id="5348866">.</span><span class="ident" id="5348867">parseState</span><span class="op" id="5348877">,</span>&nbsp;<span class="ident" id="5348879">p</span><span class="op" id="5348880">)</span><br>
<span class="lineno"></span><span class="op" id="5348882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="5348885">//&nbsp;popParseState&nbsp;pops&nbsp;a&nbsp;parse&nbsp;state&nbsp;(already&nbsp;obtained)&nbsp;off&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="5348954">//&nbsp;and&nbsp;updates&nbsp;s.step&nbsp;accordingly.</span><br>
<span class="lineno"></span><span class="keyword" id="5348989">func</span>&nbsp;<span class="op" id="5348994">(</span><span class="ident" id="5348995">s</span>&nbsp;<span class="op" id="5348997">*</span><span class="ident" id="5348998">scanner</span><span class="op" id="5349005">)</span>&nbsp;<span class="ident" id="5349007">popParseState</span><span class="op" id="5349020">(</span><span class="op" id="5349021">)</span>&nbsp;<span class="op" id="5349023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5349026">n</span>&nbsp;<span class="op" id="5349028">:=</span>&nbsp;<span class="builtinfunc" id="5349031">len</span><span class="op" id="5349034">(</span><span class="ident" id="5349035">s</span><span class="op" id="5349036">.</span><span class="ident" id="5349037">parseState</span><span class="op" id="5349047">)</span>&nbsp;<span class="op" id="5349049">-</span>&nbsp;<span class="num" id="5349051">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5349054">s</span><span class="op" id="5349055">.</span><span class="ident" id="5349056">parseState</span>&nbsp;<span class="op" id="5349067">=</span>&nbsp;<span class="ident" id="5349069">s</span><span class="op" id="5349070">.</span><span class="ident" id="5349071">parseState</span><span class="op" id="5349081">[</span><span class="num" id="5349082">0</span><span class="op" id="5349083">:</span><span class="ident" id="5349084">n</span><span class="op" id="5349085">]</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5349088">s</span><span class="op" id="5349089">.</span><span class="ident" id="5349090">redo</span>&nbsp;<span class="op" id="5349095">=</span>&nbsp;<span class="builtintype" id="5349097">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349104">if</span>&nbsp;<span class="ident" id="5349107">n</span>&nbsp;<span class="op" id="5349109">==</span>&nbsp;<span class="num" id="5349112">0</span>&nbsp;<span class="op" id="5349114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5349118">s</span><span class="op" id="5349119">.</span><span class="ident" id="5349120">step</span>&nbsp;<span class="op" id="5349125">=</span>&nbsp;<span class="ident" id="5349127">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5349141">s</span><span class="op" id="5349142">.</span><span class="ident" id="5349143">endTop</span>&nbsp;<span class="op" id="5349150">=</span>&nbsp;<span class="builtintype" id="5349152">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5349158">}</span>&nbsp;<span class="keyword" id="5349160">else</span>&nbsp;<span class="op" id="5349165">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5349169">s</span><span class="op" id="5349170">.</span><span class="ident" id="5349171">step</span>&nbsp;<span class="op" id="5349176">=</span>&nbsp;<span class="ident" id="5349178">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5349193">}</span><br>
<span class="lineno"></span><span class="op" id="5349195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5349198">func</span>&nbsp;<span class="ident" id="5349203">isSpace</span><span class="op" id="5349210">(</span><span class="ident" id="5349211">c</span>&nbsp;<span class="builtintype" id="5349213">rune</span><span class="op" id="5349217">)</span>&nbsp;<span class="builtintype" id="5349219">bool</span>&nbsp;<span class="op" id="5349224">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349227">return</span>&nbsp;<span class="ident" id="5349234">c</span>&nbsp;<span class="op" id="5349236">==</span>&nbsp;<span class="string" id="5349239">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5349243">||</span>&nbsp;<span class="ident" id="5349246">c</span>&nbsp;<span class="op" id="5349248">==</span>&nbsp;<span class="string" id="5349251">&#39;\t&#39;</span>&nbsp;<span class="op" id="5349256">||</span>&nbsp;<span class="ident" id="5349259">c</span>&nbsp;<span class="op" id="5349261">==</span>&nbsp;<span class="string" id="5349264">&#39;\r&#39;</span>&nbsp;<span class="op" id="5349269">||</span>&nbsp;<span class="ident" id="5349272">c</span>&nbsp;<span class="op" id="5349274">==</span>&nbsp;<span class="string" id="5349277">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="5349282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5349285">//&nbsp;stateBeginValueOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`[`.</span><br>
<span class="lineno"></span><span class="keyword" id="5349343">func</span>&nbsp;<span class="ident" id="5349348">stateBeginValueOrEmpty</span><span class="op" id="5349370">(</span><span class="ident" id="5349371">s</span>&nbsp;<span class="op" id="5349373">*</span><span class="ident" id="5349374">scanner</span><span class="op" id="5349381">,</span>&nbsp;<span class="ident" id="5349383">c</span>&nbsp;<span class="builtintype" id="5349385">int</span><span class="op" id="5349388">)</span>&nbsp;<span class="builtintype" id="5349390">int</span>&nbsp;<span class="op" id="5349394">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349397">if</span>&nbsp;<span class="ident" id="5349400">c</span>&nbsp;<span class="op" id="5349402">&lt;=</span>&nbsp;<span class="string" id="5349405">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5349409">&amp;&amp;</span>&nbsp;<span class="ident" id="5349412">isSpace</span><span class="op" id="5349419">(</span><span class="builtintype" id="5349420">rune</span><span class="op" id="5349424">(</span><span class="ident" id="5349425">c</span><span class="op" id="5349426">)</span><span class="op" id="5349427">)</span>&nbsp;<span class="op" id="5349429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349433">return</span>&nbsp;<span class="ident" id="5349440">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5349455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349458">if</span>&nbsp;<span class="ident" id="5349461">c</span>&nbsp;<span class="op" id="5349463">==</span>&nbsp;<span class="string" id="5349466">&#39;]&#39;</span>&nbsp;<span class="op" id="5349470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349474">return</span>&nbsp;<span class="ident" id="5349481">stateEndValue</span><span class="op" id="5349494">(</span><span class="ident" id="5349495">s</span><span class="op" id="5349496">,</span>&nbsp;<span class="ident" id="5349498">c</span><span class="op" id="5349499">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5349502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349505">return</span>&nbsp;<span class="ident" id="5349512">stateBeginValue</span><span class="op" id="5349527">(</span><span class="ident" id="5349528">s</span><span class="op" id="5349529">,</span>&nbsp;<span class="ident" id="5349531">c</span><span class="op" id="5349532">)</span><br>
<span class="lineno"></span><span class="op" id="5349534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5349537">//&nbsp;stateBeginValue&nbsp;is&nbsp;the&nbsp;state&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno">200</span><span class="keyword" id="5349600">func</span>&nbsp;<span class="ident" id="5349605">stateBeginValue</span><span class="op" id="5349620">(</span><span class="ident" id="5349621">s</span>&nbsp;<span class="op" id="5349623">*</span><span class="ident" id="5349624">scanner</span><span class="op" id="5349631">,</span>&nbsp;<span class="ident" id="5349633">c</span>&nbsp;<span class="builtintype" id="5349635">int</span><span class="op" id="5349638">)</span>&nbsp;<span class="builtintype" id="5349640">int</span>&nbsp;<span class="op" id="5349644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349647">if</span>&nbsp;<span class="ident" id="5349650">c</span>&nbsp;<span class="op" id="5349652">&lt;=</span>&nbsp;<span class="string" id="5349655">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5349659">&amp;&amp;</span>&nbsp;<span class="ident" id="5349662">isSpace</span><span class="op" id="5349669">(</span><span class="builtintype" id="5349670">rune</span><span class="op" id="5349674">(</span><span class="ident" id="5349675">c</span><span class="op" id="5349676">)</span><span class="op" id="5349677">)</span>&nbsp;<span class="op" id="5349679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349683">return</span>&nbsp;<span class="ident" id="5349690">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5349705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349708">switch</span>&nbsp;<span class="ident" id="5349715">c</span>&nbsp;<span class="op" id="5349717">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349720">case</span>&nbsp;<span class="string" id="5349725">&#39;{&#39;</span><span class="op" id="5349728">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5349732">s</span><span class="op" id="5349733">.</span><span class="ident" id="5349734">step</span>&nbsp;<span class="op" id="5349739">=</span>&nbsp;<span class="ident" id="5349741">stateBeginStringOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5349767">s</span><span class="op" id="5349768">.</span><span class="ident" id="5349769">pushParseState</span><span class="op" id="5349783">(</span><span class="ident" id="5349784">parseObjectKey</span><span class="op" id="5349798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349802">return</span>&nbsp;<span class="ident" id="5349809">scanBeginObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349826">case</span>&nbsp;<span class="string" id="5349831">&#39;[&#39;</span><span class="op" id="5349834">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5349838">s</span><span class="op" id="5349839">.</span><span class="ident" id="5349840">step</span>&nbsp;<span class="op" id="5349845">=</span>&nbsp;<span class="ident" id="5349847">stateBeginValueOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5349872">s</span><span class="op" id="5349873">.</span><span class="ident" id="5349874">pushParseState</span><span class="op" id="5349888">(</span><span class="ident" id="5349889">parseArrayValue</span><span class="op" id="5349904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349908">return</span>&nbsp;<span class="ident" id="5349915">scanBeginArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349931">case</span>&nbsp;<span class="string" id="5349936">&#39;&#34;&#39;</span><span class="op" id="5349939">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5349943">s</span><span class="op" id="5349944">.</span><span class="ident" id="5349945">step</span>&nbsp;<span class="op" id="5349950">=</span>&nbsp;<span class="ident" id="5349952">stateInString</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349968">return</span>&nbsp;<span class="ident" id="5349975">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5349993">case</span>&nbsp;<span class="string" id="5349998">&#39;-&#39;</span><span class="op" id="5350001">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350005">s</span><span class="op" id="5350006">.</span><span class="ident" id="5350007">step</span>&nbsp;<span class="op" id="5350012">=</span>&nbsp;<span class="ident" id="5350014">stateNeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350025">return</span>&nbsp;<span class="ident" id="5350032">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350050">case</span>&nbsp;<span class="string" id="5350055">&#39;0&#39;</span><span class="op" id="5350058">:</span>&nbsp;<span class="comment" id="5350060">//&nbsp;beginning&nbsp;of&nbsp;0.123</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350084">s</span><span class="op" id="5350085">.</span><span class="ident" id="5350086">step</span>&nbsp;<span class="op" id="5350091">=</span>&nbsp;<span class="ident" id="5350093">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350102">return</span>&nbsp;<span class="ident" id="5350109">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350127">case</span>&nbsp;<span class="string" id="5350132">&#39;t&#39;</span><span class="op" id="5350135">:</span>&nbsp;<span class="comment" id="5350137">//&nbsp;beginning&nbsp;of&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350160">s</span><span class="op" id="5350161">.</span><span class="ident" id="5350162">step</span>&nbsp;<span class="op" id="5350167">=</span>&nbsp;<span class="ident" id="5350169">stateT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350178">return</span>&nbsp;<span class="ident" id="5350185">scanBeginLiteral</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350203">case</span>&nbsp;<span class="string" id="5350208">&#39;f&#39;</span><span class="op" id="5350211">:</span>&nbsp;<span class="comment" id="5350213">//&nbsp;beginning&nbsp;of&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350237">s</span><span class="op" id="5350238">.</span><span class="ident" id="5350239">step</span>&nbsp;<span class="op" id="5350244">=</span>&nbsp;<span class="ident" id="5350246">stateF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350255">return</span>&nbsp;<span class="ident" id="5350262">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350280">case</span>&nbsp;<span class="string" id="5350285">&#39;n&#39;</span><span class="op" id="5350288">:</span>&nbsp;<span class="comment" id="5350290">//&nbsp;beginning&nbsp;of&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350313">s</span><span class="op" id="5350314">.</span><span class="ident" id="5350315">step</span>&nbsp;<span class="op" id="5350320">=</span>&nbsp;<span class="ident" id="5350322">stateN</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350331">return</span>&nbsp;<span class="ident" id="5350338">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5350356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350359">if</span>&nbsp;<span class="string" id="5350362">&#39;1&#39;</span>&nbsp;<span class="op" id="5350366">&lt;=</span>&nbsp;<span class="ident" id="5350369">c</span>&nbsp;<span class="op" id="5350371">&amp;&amp;</span>&nbsp;<span class="ident" id="5350374">c</span>&nbsp;<span class="op" id="5350376">&lt;=</span>&nbsp;<span class="string" id="5350379">&#39;9&#39;</span>&nbsp;<span class="op" id="5350383">{</span>&nbsp;<span class="comment" id="5350385">//&nbsp;beginning&nbsp;of&nbsp;1234.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350410">s</span><span class="op" id="5350411">.</span><span class="ident" id="5350412">step</span>&nbsp;<span class="op" id="5350417">=</span>&nbsp;<span class="ident" id="5350419">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350428">return</span>&nbsp;<span class="ident" id="5350435">scanBeginLiteral</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5350453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350456">return</span>&nbsp;<span class="ident" id="5350463">s</span><span class="op" id="5350464">.</span><span class="builtintype" id="5350465">error</span><span class="op" id="5350470">(</span><span class="ident" id="5350471">c</span><span class="op" id="5350472">,</span>&nbsp;<span class="string" id="5350474">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;value&#34;</span><span class="op" id="5350506">)</span><br>
<span class="lineno"></span><span class="op" id="5350508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5350511">//&nbsp;stateBeginStringOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{`.</span><br>
<span class="lineno">240</span><span class="keyword" id="5350570">func</span>&nbsp;<span class="ident" id="5350575">stateBeginStringOrEmpty</span><span class="op" id="5350598">(</span><span class="ident" id="5350599">s</span>&nbsp;<span class="op" id="5350601">*</span><span class="ident" id="5350602">scanner</span><span class="op" id="5350609">,</span>&nbsp;<span class="ident" id="5350611">c</span>&nbsp;<span class="builtintype" id="5350613">int</span><span class="op" id="5350616">)</span>&nbsp;<span class="builtintype" id="5350618">int</span>&nbsp;<span class="op" id="5350622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350625">if</span>&nbsp;<span class="ident" id="5350628">c</span>&nbsp;<span class="op" id="5350630">&lt;=</span>&nbsp;<span class="string" id="5350633">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5350637">&amp;&amp;</span>&nbsp;<span class="ident" id="5350640">isSpace</span><span class="op" id="5350647">(</span><span class="builtintype" id="5350648">rune</span><span class="op" id="5350652">(</span><span class="ident" id="5350653">c</span><span class="op" id="5350654">)</span><span class="op" id="5350655">)</span>&nbsp;<span class="op" id="5350657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350661">return</span>&nbsp;<span class="ident" id="5350668">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5350683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350686">if</span>&nbsp;<span class="ident" id="5350689">c</span>&nbsp;<span class="op" id="5350691">==</span>&nbsp;<span class="string" id="5350694">&#39;}&#39;</span>&nbsp;<span class="op" id="5350698">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350702">n</span>&nbsp;<span class="op" id="5350704">:=</span>&nbsp;<span class="builtinfunc" id="5350707">len</span><span class="op" id="5350710">(</span><span class="ident" id="5350711">s</span><span class="op" id="5350712">.</span><span class="ident" id="5350713">parseState</span><span class="op" id="5350723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350727">s</span><span class="op" id="5350728">.</span><span class="ident" id="5350729">parseState</span><span class="op" id="5350739">[</span><span class="ident" id="5350740">n</span><span class="op" id="5350741">-</span><span class="num" id="5350742">1</span><span class="op" id="5350743">]</span>&nbsp;<span class="op" id="5350745">=</span>&nbsp;<span class="ident" id="5350747">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350766">return</span>&nbsp;<span class="ident" id="5350773">stateEndValue</span><span class="op" id="5350786">(</span><span class="ident" id="5350787">s</span><span class="op" id="5350788">,</span>&nbsp;<span class="ident" id="5350790">c</span><span class="op" id="5350791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5350794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350797">return</span>&nbsp;<span class="ident" id="5350804">stateBeginString</span><span class="op" id="5350820">(</span><span class="ident" id="5350821">s</span><span class="op" id="5350822">,</span>&nbsp;<span class="ident" id="5350824">c</span><span class="op" id="5350825">)</span><br>
<span class="lineno">250</span><span class="op" id="5350827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5350830">//&nbsp;stateBeginString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{&#34;key&#34;:&nbsp;value,`.</span><br>
<span class="lineno"></span><span class="keyword" id="5350895">func</span>&nbsp;<span class="ident" id="5350900">stateBeginString</span><span class="op" id="5350916">(</span><span class="ident" id="5350917">s</span>&nbsp;<span class="op" id="5350919">*</span><span class="ident" id="5350920">scanner</span><span class="op" id="5350927">,</span>&nbsp;<span class="ident" id="5350929">c</span>&nbsp;<span class="builtintype" id="5350931">int</span><span class="op" id="5350934">)</span>&nbsp;<span class="builtintype" id="5350936">int</span>&nbsp;<span class="op" id="5350940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350943">if</span>&nbsp;<span class="ident" id="5350946">c</span>&nbsp;<span class="op" id="5350948">&lt;=</span>&nbsp;<span class="string" id="5350951">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5350955">&amp;&amp;</span>&nbsp;<span class="ident" id="5350958">isSpace</span><span class="op" id="5350965">(</span><span class="builtintype" id="5350966">rune</span><span class="op" id="5350970">(</span><span class="ident" id="5350971">c</span><span class="op" id="5350972">)</span><span class="op" id="5350973">)</span>&nbsp;<span class="op" id="5350975">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5350979">return</span>&nbsp;<span class="ident" id="5350986">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5351001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351004">if</span>&nbsp;<span class="ident" id="5351007">c</span>&nbsp;<span class="op" id="5351009">==</span>&nbsp;<span class="string" id="5351012">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5351016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351020">s</span><span class="op" id="5351021">.</span><span class="ident" id="5351022">step</span>&nbsp;<span class="op" id="5351027">=</span>&nbsp;<span class="ident" id="5351029">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351045">return</span>&nbsp;<span class="ident" id="5351052">scanBeginLiteral</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5351070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351073">return</span>&nbsp;<span class="ident" id="5351080">s</span><span class="op" id="5351081">.</span><span class="builtintype" id="5351082">error</span><span class="op" id="5351087">(</span><span class="ident" id="5351088">c</span><span class="op" id="5351089">,</span>&nbsp;<span class="string" id="5351091">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;object&nbsp;key&nbsp;string&#34;</span><span class="op" id="5351135">)</span><br>
<span class="lineno"></span><span class="op" id="5351137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5351140">//&nbsp;stateEndValue&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;completing&nbsp;a&nbsp;value,</span><br>
<span class="lineno">265</span><span class="comment" id="5351196">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`true`&nbsp;or&nbsp;`[&#34;x&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="5351247">func</span>&nbsp;<span class="ident" id="5351252">stateEndValue</span><span class="op" id="5351265">(</span><span class="ident" id="5351266">s</span>&nbsp;<span class="op" id="5351268">*</span><span class="ident" id="5351269">scanner</span><span class="op" id="5351276">,</span>&nbsp;<span class="ident" id="5351278">c</span>&nbsp;<span class="builtintype" id="5351280">int</span><span class="op" id="5351283">)</span>&nbsp;<span class="builtintype" id="5351285">int</span>&nbsp;<span class="op" id="5351289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351292">n</span>&nbsp;<span class="op" id="5351294">:=</span>&nbsp;<span class="builtinfunc" id="5351297">len</span><span class="op" id="5351300">(</span><span class="ident" id="5351301">s</span><span class="op" id="5351302">.</span><span class="ident" id="5351303">parseState</span><span class="op" id="5351313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351316">if</span>&nbsp;<span class="ident" id="5351319">n</span>&nbsp;<span class="op" id="5351321">==</span>&nbsp;<span class="num" id="5351324">0</span>&nbsp;<span class="op" id="5351326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5351330">//&nbsp;Completed&nbsp;top-level&nbsp;before&nbsp;the&nbsp;current&nbsp;byte.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351380">s</span><span class="op" id="5351381">.</span><span class="ident" id="5351382">step</span>&nbsp;<span class="op" id="5351387">=</span>&nbsp;<span class="ident" id="5351389">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351403">s</span><span class="op" id="5351404">.</span><span class="ident" id="5351405">endTop</span>&nbsp;<span class="op" id="5351412">=</span>&nbsp;<span class="builtintype" id="5351414">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351421">return</span>&nbsp;<span class="ident" id="5351428">stateEndTop</span><span class="op" id="5351439">(</span><span class="ident" id="5351440">s</span><span class="op" id="5351441">,</span>&nbsp;<span class="ident" id="5351443">c</span><span class="op" id="5351444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5351447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351450">if</span>&nbsp;<span class="ident" id="5351453">c</span>&nbsp;<span class="op" id="5351455">&lt;=</span>&nbsp;<span class="string" id="5351458">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5351462">&amp;&amp;</span>&nbsp;<span class="ident" id="5351465">isSpace</span><span class="op" id="5351472">(</span><span class="builtintype" id="5351473">rune</span><span class="op" id="5351477">(</span><span class="ident" id="5351478">c</span><span class="op" id="5351479">)</span><span class="op" id="5351480">)</span>&nbsp;<span class="op" id="5351482">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351486">s</span><span class="op" id="5351487">.</span><span class="ident" id="5351488">step</span>&nbsp;<span class="op" id="5351493">=</span>&nbsp;<span class="ident" id="5351495">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351511">return</span>&nbsp;<span class="ident" id="5351518">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5351533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351536">ps</span>&nbsp;<span class="op" id="5351539">:=</span>&nbsp;<span class="ident" id="5351542">s</span><span class="op" id="5351543">.</span><span class="ident" id="5351544">parseState</span><span class="op" id="5351554">[</span><span class="ident" id="5351555">n</span><span class="op" id="5351556">-</span><span class="num" id="5351557">1</span><span class="op" id="5351558">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351561">switch</span>&nbsp;<span class="ident" id="5351568">ps</span>&nbsp;<span class="op" id="5351571">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351574">case</span>&nbsp;<span class="ident" id="5351579">parseObjectKey</span><span class="op" id="5351593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351597">if</span>&nbsp;<span class="ident" id="5351600">c</span>&nbsp;<span class="op" id="5351602">==</span>&nbsp;<span class="string" id="5351605">&#39;:&#39;</span>&nbsp;<span class="op" id="5351609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351614">s</span><span class="op" id="5351615">.</span><span class="ident" id="5351616">parseState</span><span class="op" id="5351626">[</span><span class="ident" id="5351627">n</span><span class="op" id="5351628">-</span><span class="num" id="5351629">1</span><span class="op" id="5351630">]</span>&nbsp;<span class="op" id="5351632">=</span>&nbsp;<span class="ident" id="5351634">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351654">s</span><span class="op" id="5351655">.</span><span class="ident" id="5351656">step</span>&nbsp;<span class="op" id="5351661">=</span>&nbsp;<span class="ident" id="5351663">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351682">return</span>&nbsp;<span class="ident" id="5351689">scanObjectKey</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5351705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351709">return</span>&nbsp;<span class="ident" id="5351716">s</span><span class="op" id="5351717">.</span><span class="builtintype" id="5351718">error</span><span class="op" id="5351723">(</span><span class="ident" id="5351724">c</span><span class="op" id="5351725">,</span>&nbsp;<span class="string" id="5351727">&#34;after&nbsp;object&nbsp;key&#34;</span><span class="op" id="5351745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351748">case</span>&nbsp;<span class="ident" id="5351753">parseObjectValue</span><span class="op" id="5351769">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351773">if</span>&nbsp;<span class="ident" id="5351776">c</span>&nbsp;<span class="op" id="5351778">==</span>&nbsp;<span class="string" id="5351781">&#39;,&#39;</span>&nbsp;<span class="op" id="5351785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351790">s</span><span class="op" id="5351791">.</span><span class="ident" id="5351792">parseState</span><span class="op" id="5351802">[</span><span class="ident" id="5351803">n</span><span class="op" id="5351804">-</span><span class="num" id="5351805">1</span><span class="op" id="5351806">]</span>&nbsp;<span class="op" id="5351808">=</span>&nbsp;<span class="ident" id="5351810">parseObjectKey</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351828">s</span><span class="op" id="5351829">.</span><span class="ident" id="5351830">step</span>&nbsp;<span class="op" id="5351835">=</span>&nbsp;<span class="ident" id="5351837">stateBeginString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351857">return</span>&nbsp;<span class="ident" id="5351864">scanObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5351882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351886">if</span>&nbsp;<span class="ident" id="5351889">c</span>&nbsp;<span class="op" id="5351891">==</span>&nbsp;<span class="string" id="5351894">&#39;}&#39;</span>&nbsp;<span class="op" id="5351898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351903">s</span><span class="op" id="5351904">.</span><span class="ident" id="5351905">popParseState</span><span class="op" id="5351918">(</span><span class="op" id="5351919">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351924">return</span>&nbsp;<span class="ident" id="5351931">scanEndObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5351947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351951">return</span>&nbsp;<span class="ident" id="5351958">s</span><span class="op" id="5351959">.</span><span class="builtintype" id="5351960">error</span><span class="op" id="5351965">(</span><span class="ident" id="5351966">c</span><span class="op" id="5351967">,</span>&nbsp;<span class="string" id="5351969">&#34;after&nbsp;object&nbsp;key:value&nbsp;pair&#34;</span><span class="op" id="5351998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352001">case</span>&nbsp;<span class="ident" id="5352006">parseArrayValue</span><span class="op" id="5352021">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352025">if</span>&nbsp;<span class="ident" id="5352028">c</span>&nbsp;<span class="op" id="5352030">==</span>&nbsp;<span class="string" id="5352033">&#39;,&#39;</span>&nbsp;<span class="op" id="5352037">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352042">s</span><span class="op" id="5352043">.</span><span class="ident" id="5352044">step</span>&nbsp;<span class="op" id="5352049">=</span>&nbsp;<span class="ident" id="5352051">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352070">return</span>&nbsp;<span class="ident" id="5352077">scanArrayValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5352094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352098">if</span>&nbsp;<span class="ident" id="5352101">c</span>&nbsp;<span class="op" id="5352103">==</span>&nbsp;<span class="string" id="5352106">&#39;]&#39;</span>&nbsp;<span class="op" id="5352110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352115">s</span><span class="op" id="5352116">.</span><span class="ident" id="5352117">popParseState</span><span class="op" id="5352130">(</span><span class="op" id="5352131">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352136">return</span>&nbsp;<span class="ident" id="5352143">scanEndArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5352158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352162">return</span>&nbsp;<span class="ident" id="5352169">s</span><span class="op" id="5352170">.</span><span class="builtintype" id="5352171">error</span><span class="op" id="5352176">(</span><span class="ident" id="5352177">c</span><span class="op" id="5352178">,</span>&nbsp;<span class="string" id="5352180">&#34;after&nbsp;array&nbsp;element&#34;</span><span class="op" id="5352201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5352204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352207">return</span>&nbsp;<span class="ident" id="5352214">s</span><span class="op" id="5352215">.</span><span class="builtintype" id="5352216">error</span><span class="op" id="5352221">(</span><span class="ident" id="5352222">c</span><span class="op" id="5352223">,</span>&nbsp;<span class="string" id="5352225">&#34;&#34;</span><span class="op" id="5352227">)</span><br>
<span class="lineno">310</span><span class="op" id="5352229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5352232">//&nbsp;stateEndTop&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;finishing&nbsp;the&nbsp;top-level&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="5352297">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`[1,2,3]`.</span><br>
<span class="lineno"></span><span class="comment" id="5352341">//&nbsp;Only&nbsp;space&nbsp;characters&nbsp;should&nbsp;be&nbsp;seen&nbsp;now.</span><br>
<span class="lineno">315</span><span class="keyword" id="5352386">func</span>&nbsp;<span class="ident" id="5352391">stateEndTop</span><span class="op" id="5352402">(</span><span class="ident" id="5352403">s</span>&nbsp;<span class="op" id="5352405">*</span><span class="ident" id="5352406">scanner</span><span class="op" id="5352413">,</span>&nbsp;<span class="ident" id="5352415">c</span>&nbsp;<span class="builtintype" id="5352417">int</span><span class="op" id="5352420">)</span>&nbsp;<span class="builtintype" id="5352422">int</span>&nbsp;<span class="op" id="5352426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352429">if</span>&nbsp;<span class="ident" id="5352432">c</span>&nbsp;<span class="op" id="5352434">!=</span>&nbsp;<span class="string" id="5352437">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5352441">&amp;&amp;</span>&nbsp;<span class="ident" id="5352444">c</span>&nbsp;<span class="op" id="5352446">!=</span>&nbsp;<span class="string" id="5352449">&#39;\t&#39;</span>&nbsp;<span class="op" id="5352454">&amp;&amp;</span>&nbsp;<span class="ident" id="5352457">c</span>&nbsp;<span class="op" id="5352459">!=</span>&nbsp;<span class="string" id="5352462">&#39;\r&#39;</span>&nbsp;<span class="op" id="5352467">&amp;&amp;</span>&nbsp;<span class="ident" id="5352470">c</span>&nbsp;<span class="op" id="5352472">!=</span>&nbsp;<span class="string" id="5352475">&#39;\n&#39;</span>&nbsp;<span class="op" id="5352480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5352484">//&nbsp;Complain&nbsp;about&nbsp;non-space&nbsp;byte&nbsp;on&nbsp;next&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352533">s</span><span class="op" id="5352534">.</span><span class="builtintype" id="5352535">error</span><span class="op" id="5352540">(</span><span class="ident" id="5352541">c</span><span class="op" id="5352542">,</span>&nbsp;<span class="string" id="5352544">&#34;after&nbsp;top-level&nbsp;value&#34;</span><span class="op" id="5352567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5352570">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352573">return</span>&nbsp;<span class="ident" id="5352580">scanEnd</span><br>
<span class="lineno"></span><span class="op" id="5352588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5352591">//&nbsp;stateInString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="5352640">func</span>&nbsp;<span class="ident" id="5352645">stateInString</span><span class="op" id="5352658">(</span><span class="ident" id="5352659">s</span>&nbsp;<span class="op" id="5352661">*</span><span class="ident" id="5352662">scanner</span><span class="op" id="5352669">,</span>&nbsp;<span class="ident" id="5352671">c</span>&nbsp;<span class="builtintype" id="5352673">int</span><span class="op" id="5352676">)</span>&nbsp;<span class="builtintype" id="5352678">int</span>&nbsp;<span class="op" id="5352682">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352685">if</span>&nbsp;<span class="ident" id="5352688">c</span>&nbsp;<span class="op" id="5352690">==</span>&nbsp;<span class="string" id="5352693">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5352697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352701">s</span><span class="op" id="5352702">.</span><span class="ident" id="5352703">step</span>&nbsp;<span class="op" id="5352708">=</span>&nbsp;<span class="ident" id="5352710">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352726">return</span>&nbsp;<span class="ident" id="5352733">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5352747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352750">if</span>&nbsp;<span class="ident" id="5352753">c</span>&nbsp;<span class="op" id="5352755">==</span>&nbsp;<span class="string" id="5352758">&#39;\\&#39;</span>&nbsp;<span class="op" id="5352763">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352767">s</span><span class="op" id="5352768">.</span><span class="ident" id="5352769">step</span>&nbsp;<span class="op" id="5352774">=</span>&nbsp;<span class="ident" id="5352776">stateInStringEsc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352795">return</span>&nbsp;<span class="ident" id="5352802">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5352816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352819">if</span>&nbsp;<span class="ident" id="5352822">c</span>&nbsp;<span class="op" id="5352824">&lt;</span>&nbsp;<span class="num" id="5352826">0x20</span>&nbsp;<span class="op" id="5352831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352835">return</span>&nbsp;<span class="ident" id="5352842">s</span><span class="op" id="5352843">.</span><span class="builtintype" id="5352844">error</span><span class="op" id="5352849">(</span><span class="ident" id="5352850">c</span><span class="op" id="5352851">,</span>&nbsp;<span class="string" id="5352853">&#34;in&nbsp;string&nbsp;literal&#34;</span><span class="op" id="5352872">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5352875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352878">return</span>&nbsp;<span class="ident" id="5352885">scanContinue</span><br>
<span class="lineno"></span><span class="op" id="5352898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5352901">//&nbsp;stateInStringEsc&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">340</span><span class="keyword" id="5352977">func</span>&nbsp;<span class="ident" id="5352982">stateInStringEsc</span><span class="op" id="5352998">(</span><span class="ident" id="5352999">s</span>&nbsp;<span class="op" id="5353001">*</span><span class="ident" id="5353002">scanner</span><span class="op" id="5353009">,</span>&nbsp;<span class="ident" id="5353011">c</span>&nbsp;<span class="builtintype" id="5353013">int</span><span class="op" id="5353016">)</span>&nbsp;<span class="builtintype" id="5353018">int</span>&nbsp;<span class="op" id="5353022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353025">switch</span>&nbsp;<span class="ident" id="5353032">c</span>&nbsp;<span class="op" id="5353034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353037">case</span>&nbsp;<span class="string" id="5353042">&#39;b&#39;</span><span class="op" id="5353045">,</span>&nbsp;<span class="string" id="5353047">&#39;f&#39;</span><span class="op" id="5353050">,</span>&nbsp;<span class="string" id="5353052">&#39;n&#39;</span><span class="op" id="5353055">,</span>&nbsp;<span class="string" id="5353057">&#39;r&#39;</span><span class="op" id="5353060">,</span>&nbsp;<span class="string" id="5353062">&#39;t&#39;</span><span class="op" id="5353065">,</span>&nbsp;<span class="string" id="5353067">&#39;\\&#39;</span><span class="op" id="5353071">,</span>&nbsp;<span class="string" id="5353073">&#39;/&#39;</span><span class="op" id="5353076">,</span>&nbsp;<span class="string" id="5353078">&#39;&#34;&#39;</span><span class="op" id="5353081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353085">s</span><span class="op" id="5353086">.</span><span class="ident" id="5353087">step</span>&nbsp;<span class="op" id="5353092">=</span>&nbsp;<span class="ident" id="5353094">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353110">return</span>&nbsp;<span class="ident" id="5353117">scanContinue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5353131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353134">if</span>&nbsp;<span class="ident" id="5353137">c</span>&nbsp;<span class="op" id="5353139">==</span>&nbsp;<span class="string" id="5353142">&#39;u&#39;</span>&nbsp;<span class="op" id="5353146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353150">s</span><span class="op" id="5353151">.</span><span class="ident" id="5353152">step</span>&nbsp;<span class="op" id="5353157">=</span>&nbsp;<span class="ident" id="5353159">stateInStringEscU</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353179">return</span>&nbsp;<span class="ident" id="5353186">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5353200">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353203">return</span>&nbsp;<span class="ident" id="5353210">s</span><span class="op" id="5353211">.</span><span class="builtintype" id="5353212">error</span><span class="op" id="5353217">(</span><span class="ident" id="5353218">c</span><span class="op" id="5353219">,</span>&nbsp;<span class="string" id="5353221">&#34;in&nbsp;string&nbsp;escape&nbsp;code&#34;</span><span class="op" id="5353244">)</span><br>
<span class="lineno"></span><span class="op" id="5353246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5353249">//&nbsp;stateInStringEscU&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5353327">func</span>&nbsp;<span class="ident" id="5353332">stateInStringEscU</span><span class="op" id="5353349">(</span><span class="ident" id="5353350">s</span>&nbsp;<span class="op" id="5353352">*</span><span class="ident" id="5353353">scanner</span><span class="op" id="5353360">,</span>&nbsp;<span class="ident" id="5353362">c</span>&nbsp;<span class="builtintype" id="5353364">int</span><span class="op" id="5353367">)</span>&nbsp;<span class="builtintype" id="5353369">int</span>&nbsp;<span class="op" id="5353373">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353376">if</span>&nbsp;<span class="string" id="5353379">&#39;0&#39;</span>&nbsp;<span class="op" id="5353383">&lt;=</span>&nbsp;<span class="ident" id="5353386">c</span>&nbsp;<span class="op" id="5353388">&amp;&amp;</span>&nbsp;<span class="ident" id="5353391">c</span>&nbsp;<span class="op" id="5353393">&lt;=</span>&nbsp;<span class="string" id="5353396">&#39;9&#39;</span>&nbsp;<span class="op" id="5353400">||</span>&nbsp;<span class="string" id="5353403">&#39;a&#39;</span>&nbsp;<span class="op" id="5353407">&lt;=</span>&nbsp;<span class="ident" id="5353410">c</span>&nbsp;<span class="op" id="5353412">&amp;&amp;</span>&nbsp;<span class="ident" id="5353415">c</span>&nbsp;<span class="op" id="5353417">&lt;=</span>&nbsp;<span class="string" id="5353420">&#39;f&#39;</span>&nbsp;<span class="op" id="5353424">||</span>&nbsp;<span class="string" id="5353427">&#39;A&#39;</span>&nbsp;<span class="op" id="5353431">&lt;=</span>&nbsp;<span class="ident" id="5353434">c</span>&nbsp;<span class="op" id="5353436">&amp;&amp;</span>&nbsp;<span class="ident" id="5353439">c</span>&nbsp;<span class="op" id="5353441">&lt;=</span>&nbsp;<span class="string" id="5353444">&#39;F&#39;</span>&nbsp;<span class="op" id="5353448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353452">s</span><span class="op" id="5353453">.</span><span class="ident" id="5353454">step</span>&nbsp;<span class="op" id="5353459">=</span>&nbsp;<span class="ident" id="5353461">stateInStringEscU1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353482">return</span>&nbsp;<span class="ident" id="5353489">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5353503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5353506">//&nbsp;numbers</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353518">return</span>&nbsp;<span class="ident" id="5353525">s</span><span class="op" id="5353526">.</span><span class="builtintype" id="5353527">error</span><span class="op" id="5353532">(</span><span class="ident" id="5353533">c</span><span class="op" id="5353534">,</span>&nbsp;<span class="string" id="5353536">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5353573">)</span><br>
<span class="lineno"></span><span class="op" id="5353575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5353578">//&nbsp;stateInStringEscU1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u1`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5353658">func</span>&nbsp;<span class="ident" id="5353663">stateInStringEscU1</span><span class="op" id="5353681">(</span><span class="ident" id="5353682">s</span>&nbsp;<span class="op" id="5353684">*</span><span class="ident" id="5353685">scanner</span><span class="op" id="5353692">,</span>&nbsp;<span class="ident" id="5353694">c</span>&nbsp;<span class="builtintype" id="5353696">int</span><span class="op" id="5353699">)</span>&nbsp;<span class="builtintype" id="5353701">int</span>&nbsp;<span class="op" id="5353705">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353708">if</span>&nbsp;<span class="string" id="5353711">&#39;0&#39;</span>&nbsp;<span class="op" id="5353715">&lt;=</span>&nbsp;<span class="ident" id="5353718">c</span>&nbsp;<span class="op" id="5353720">&amp;&amp;</span>&nbsp;<span class="ident" id="5353723">c</span>&nbsp;<span class="op" id="5353725">&lt;=</span>&nbsp;<span class="string" id="5353728">&#39;9&#39;</span>&nbsp;<span class="op" id="5353732">||</span>&nbsp;<span class="string" id="5353735">&#39;a&#39;</span>&nbsp;<span class="op" id="5353739">&lt;=</span>&nbsp;<span class="ident" id="5353742">c</span>&nbsp;<span class="op" id="5353744">&amp;&amp;</span>&nbsp;<span class="ident" id="5353747">c</span>&nbsp;<span class="op" id="5353749">&lt;=</span>&nbsp;<span class="string" id="5353752">&#39;f&#39;</span>&nbsp;<span class="op" id="5353756">||</span>&nbsp;<span class="string" id="5353759">&#39;A&#39;</span>&nbsp;<span class="op" id="5353763">&lt;=</span>&nbsp;<span class="ident" id="5353766">c</span>&nbsp;<span class="op" id="5353768">&amp;&amp;</span>&nbsp;<span class="ident" id="5353771">c</span>&nbsp;<span class="op" id="5353773">&lt;=</span>&nbsp;<span class="string" id="5353776">&#39;F&#39;</span>&nbsp;<span class="op" id="5353780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353784">s</span><span class="op" id="5353785">.</span><span class="ident" id="5353786">step</span>&nbsp;<span class="op" id="5353791">=</span>&nbsp;<span class="ident" id="5353793">stateInStringEscU12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353815">return</span>&nbsp;<span class="ident" id="5353822">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5353836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5353839">//&nbsp;numbers</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353851">return</span>&nbsp;<span class="ident" id="5353858">s</span><span class="op" id="5353859">.</span><span class="builtintype" id="5353860">error</span><span class="op" id="5353865">(</span><span class="ident" id="5353866">c</span><span class="op" id="5353867">,</span>&nbsp;<span class="string" id="5353869">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5353906">)</span><br>
<span class="lineno"></span><span class="op" id="5353908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5353911">//&nbsp;stateInStringEscU12&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u12`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5353993">func</span>&nbsp;<span class="ident" id="5353998">stateInStringEscU12</span><span class="op" id="5354017">(</span><span class="ident" id="5354018">s</span>&nbsp;<span class="op" id="5354020">*</span><span class="ident" id="5354021">scanner</span><span class="op" id="5354028">,</span>&nbsp;<span class="ident" id="5354030">c</span>&nbsp;<span class="builtintype" id="5354032">int</span><span class="op" id="5354035">)</span>&nbsp;<span class="builtintype" id="5354037">int</span>&nbsp;<span class="op" id="5354041">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354044">if</span>&nbsp;<span class="string" id="5354047">&#39;0&#39;</span>&nbsp;<span class="op" id="5354051">&lt;=</span>&nbsp;<span class="ident" id="5354054">c</span>&nbsp;<span class="op" id="5354056">&amp;&amp;</span>&nbsp;<span class="ident" id="5354059">c</span>&nbsp;<span class="op" id="5354061">&lt;=</span>&nbsp;<span class="string" id="5354064">&#39;9&#39;</span>&nbsp;<span class="op" id="5354068">||</span>&nbsp;<span class="string" id="5354071">&#39;a&#39;</span>&nbsp;<span class="op" id="5354075">&lt;=</span>&nbsp;<span class="ident" id="5354078">c</span>&nbsp;<span class="op" id="5354080">&amp;&amp;</span>&nbsp;<span class="ident" id="5354083">c</span>&nbsp;<span class="op" id="5354085">&lt;=</span>&nbsp;<span class="string" id="5354088">&#39;f&#39;</span>&nbsp;<span class="op" id="5354092">||</span>&nbsp;<span class="string" id="5354095">&#39;A&#39;</span>&nbsp;<span class="op" id="5354099">&lt;=</span>&nbsp;<span class="ident" id="5354102">c</span>&nbsp;<span class="op" id="5354104">&amp;&amp;</span>&nbsp;<span class="ident" id="5354107">c</span>&nbsp;<span class="op" id="5354109">&lt;=</span>&nbsp;<span class="string" id="5354112">&#39;F&#39;</span>&nbsp;<span class="op" id="5354116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5354120">s</span><span class="op" id="5354121">.</span><span class="ident" id="5354122">step</span>&nbsp;<span class="op" id="5354127">=</span>&nbsp;<span class="ident" id="5354129">stateInStringEscU123</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354152">return</span>&nbsp;<span class="ident" id="5354159">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5354173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5354176">//&nbsp;numbers</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354188">return</span>&nbsp;<span class="ident" id="5354195">s</span><span class="op" id="5354196">.</span><span class="builtintype" id="5354197">error</span><span class="op" id="5354202">(</span><span class="ident" id="5354203">c</span><span class="op" id="5354204">,</span>&nbsp;<span class="string" id="5354206">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5354243">)</span><br>
<span class="lineno"></span><span class="op" id="5354245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5354248">//&nbsp;stateInStringEscU123&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u123`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5354332">func</span>&nbsp;<span class="ident" id="5354337">stateInStringEscU123</span><span class="op" id="5354357">(</span><span class="ident" id="5354358">s</span>&nbsp;<span class="op" id="5354360">*</span><span class="ident" id="5354361">scanner</span><span class="op" id="5354368">,</span>&nbsp;<span class="ident" id="5354370">c</span>&nbsp;<span class="builtintype" id="5354372">int</span><span class="op" id="5354375">)</span>&nbsp;<span class="builtintype" id="5354377">int</span>&nbsp;<span class="op" id="5354381">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354384">if</span>&nbsp;<span class="string" id="5354387">&#39;0&#39;</span>&nbsp;<span class="op" id="5354391">&lt;=</span>&nbsp;<span class="ident" id="5354394">c</span>&nbsp;<span class="op" id="5354396">&amp;&amp;</span>&nbsp;<span class="ident" id="5354399">c</span>&nbsp;<span class="op" id="5354401">&lt;=</span>&nbsp;<span class="string" id="5354404">&#39;9&#39;</span>&nbsp;<span class="op" id="5354408">||</span>&nbsp;<span class="string" id="5354411">&#39;a&#39;</span>&nbsp;<span class="op" id="5354415">&lt;=</span>&nbsp;<span class="ident" id="5354418">c</span>&nbsp;<span class="op" id="5354420">&amp;&amp;</span>&nbsp;<span class="ident" id="5354423">c</span>&nbsp;<span class="op" id="5354425">&lt;=</span>&nbsp;<span class="string" id="5354428">&#39;f&#39;</span>&nbsp;<span class="op" id="5354432">||</span>&nbsp;<span class="string" id="5354435">&#39;A&#39;</span>&nbsp;<span class="op" id="5354439">&lt;=</span>&nbsp;<span class="ident" id="5354442">c</span>&nbsp;<span class="op" id="5354444">&amp;&amp;</span>&nbsp;<span class="ident" id="5354447">c</span>&nbsp;<span class="op" id="5354449">&lt;=</span>&nbsp;<span class="string" id="5354452">&#39;F&#39;</span>&nbsp;<span class="op" id="5354456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5354460">s</span><span class="op" id="5354461">.</span><span class="ident" id="5354462">step</span>&nbsp;<span class="op" id="5354467">=</span>&nbsp;<span class="ident" id="5354469">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354485">return</span>&nbsp;<span class="ident" id="5354492">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5354506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5354509">//&nbsp;numbers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354521">return</span>&nbsp;<span class="ident" id="5354528">s</span><span class="op" id="5354529">.</span><span class="builtintype" id="5354530">error</span><span class="op" id="5354535">(</span><span class="ident" id="5354536">c</span><span class="op" id="5354537">,</span>&nbsp;<span class="string" id="5354539">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5354576">)</span><br>
<span class="lineno"></span><span class="op" id="5354578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5354581">//&nbsp;stateNeg&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`-`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="5354641">func</span>&nbsp;<span class="ident" id="5354646">stateNeg</span><span class="op" id="5354654">(</span><span class="ident" id="5354655">s</span>&nbsp;<span class="op" id="5354657">*</span><span class="ident" id="5354658">scanner</span><span class="op" id="5354665">,</span>&nbsp;<span class="ident" id="5354667">c</span>&nbsp;<span class="builtintype" id="5354669">int</span><span class="op" id="5354672">)</span>&nbsp;<span class="builtintype" id="5354674">int</span>&nbsp;<span class="op" id="5354678">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354681">if</span>&nbsp;<span class="ident" id="5354684">c</span>&nbsp;<span class="op" id="5354686">==</span>&nbsp;<span class="string" id="5354689">&#39;0&#39;</span>&nbsp;<span class="op" id="5354693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5354697">s</span><span class="op" id="5354698">.</span><span class="ident" id="5354699">step</span>&nbsp;<span class="op" id="5354704">=</span>&nbsp;<span class="ident" id="5354706">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354715">return</span>&nbsp;<span class="ident" id="5354722">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5354736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354739">if</span>&nbsp;<span class="string" id="5354742">&#39;1&#39;</span>&nbsp;<span class="op" id="5354746">&lt;=</span>&nbsp;<span class="ident" id="5354749">c</span>&nbsp;<span class="op" id="5354751">&amp;&amp;</span>&nbsp;<span class="ident" id="5354754">c</span>&nbsp;<span class="op" id="5354756">&lt;=</span>&nbsp;<span class="string" id="5354759">&#39;9&#39;</span>&nbsp;<span class="op" id="5354763">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5354767">s</span><span class="op" id="5354768">.</span><span class="ident" id="5354769">step</span>&nbsp;<span class="op" id="5354774">=</span>&nbsp;<span class="ident" id="5354776">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354785">return</span>&nbsp;<span class="ident" id="5354792">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5354806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354809">return</span>&nbsp;<span class="ident" id="5354816">s</span><span class="op" id="5354817">.</span><span class="builtintype" id="5354818">error</span><span class="op" id="5354823">(</span><span class="ident" id="5354824">c</span><span class="op" id="5354825">,</span>&nbsp;<span class="string" id="5354827">&#34;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="5354847">)</span><br>
<span class="lineno"></span><span class="op" id="5354849">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="5354852">//&nbsp;state1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;a&nbsp;non-zero&nbsp;integer&nbsp;during&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5354925">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1`&nbsp;or&nbsp;`100`&nbsp;but&nbsp;not&nbsp;`0`.</span><br>
<span class="lineno"></span><span class="keyword" id="5354976">func</span>&nbsp;<span class="ident" id="5354981">state1</span><span class="op" id="5354987">(</span><span class="ident" id="5354988">s</span>&nbsp;<span class="op" id="5354990">*</span><span class="ident" id="5354991">scanner</span><span class="op" id="5354998">,</span>&nbsp;<span class="ident" id="5355000">c</span>&nbsp;<span class="builtintype" id="5355002">int</span><span class="op" id="5355005">)</span>&nbsp;<span class="builtintype" id="5355007">int</span>&nbsp;<span class="op" id="5355011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355014">if</span>&nbsp;<span class="string" id="5355017">&#39;0&#39;</span>&nbsp;<span class="op" id="5355021">&lt;=</span>&nbsp;<span class="ident" id="5355024">c</span>&nbsp;<span class="op" id="5355026">&amp;&amp;</span>&nbsp;<span class="ident" id="5355029">c</span>&nbsp;<span class="op" id="5355031">&lt;=</span>&nbsp;<span class="string" id="5355034">&#39;9&#39;</span>&nbsp;<span class="op" id="5355038">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355042">s</span><span class="op" id="5355043">.</span><span class="ident" id="5355044">step</span>&nbsp;<span class="op" id="5355049">=</span>&nbsp;<span class="ident" id="5355051">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355060">return</span>&nbsp;<span class="ident" id="5355067">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5355081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355084">return</span>&nbsp;<span class="ident" id="5355091">state0</span><span class="op" id="5355097">(</span><span class="ident" id="5355098">s</span><span class="op" id="5355099">,</span>&nbsp;<span class="ident" id="5355101">c</span><span class="op" id="5355102">)</span><br>
<span class="lineno"></span><span class="op" id="5355104">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="5355107">//&nbsp;state0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`0`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="5355165">func</span>&nbsp;<span class="ident" id="5355170">state0</span><span class="op" id="5355176">(</span><span class="ident" id="5355177">s</span>&nbsp;<span class="op" id="5355179">*</span><span class="ident" id="5355180">scanner</span><span class="op" id="5355187">,</span>&nbsp;<span class="ident" id="5355189">c</span>&nbsp;<span class="builtintype" id="5355191">int</span><span class="op" id="5355194">)</span>&nbsp;<span class="builtintype" id="5355196">int</span>&nbsp;<span class="op" id="5355200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355203">if</span>&nbsp;<span class="ident" id="5355206">c</span>&nbsp;<span class="op" id="5355208">==</span>&nbsp;<span class="string" id="5355211">&#39;.&#39;</span>&nbsp;<span class="op" id="5355215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355219">s</span><span class="op" id="5355220">.</span><span class="ident" id="5355221">step</span>&nbsp;<span class="op" id="5355226">=</span>&nbsp;<span class="ident" id="5355228">stateDot</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355239">return</span>&nbsp;<span class="ident" id="5355246">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5355260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355263">if</span>&nbsp;<span class="ident" id="5355266">c</span>&nbsp;<span class="op" id="5355268">==</span>&nbsp;<span class="string" id="5355271">&#39;e&#39;</span>&nbsp;<span class="op" id="5355275">||</span>&nbsp;<span class="ident" id="5355278">c</span>&nbsp;<span class="op" id="5355280">==</span>&nbsp;<span class="string" id="5355283">&#39;E&#39;</span>&nbsp;<span class="op" id="5355287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355291">s</span><span class="op" id="5355292">.</span><span class="ident" id="5355293">step</span>&nbsp;<span class="op" id="5355298">=</span>&nbsp;<span class="ident" id="5355300">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355309">return</span>&nbsp;<span class="ident" id="5355316">scanContinue</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5355330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355333">return</span>&nbsp;<span class="ident" id="5355340">stateEndValue</span><span class="op" id="5355353">(</span><span class="ident" id="5355354">s</span><span class="op" id="5355355">,</span>&nbsp;<span class="ident" id="5355357">c</span><span class="op" id="5355358">)</span><br>
<span class="lineno"></span><span class="op" id="5355360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5355363">//&nbsp;stateDot&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer&nbsp;and&nbsp;decimal&nbsp;point&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno">430</span><span class="comment" id="5355445">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1.`.</span><br>
<span class="lineno"></span><span class="keyword" id="5355476">func</span>&nbsp;<span class="ident" id="5355481">stateDot</span><span class="op" id="5355489">(</span><span class="ident" id="5355490">s</span>&nbsp;<span class="op" id="5355492">*</span><span class="ident" id="5355493">scanner</span><span class="op" id="5355500">,</span>&nbsp;<span class="ident" id="5355502">c</span>&nbsp;<span class="builtintype" id="5355504">int</span><span class="op" id="5355507">)</span>&nbsp;<span class="builtintype" id="5355509">int</span>&nbsp;<span class="op" id="5355513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355516">if</span>&nbsp;<span class="string" id="5355519">&#39;0&#39;</span>&nbsp;<span class="op" id="5355523">&lt;=</span>&nbsp;<span class="ident" id="5355526">c</span>&nbsp;<span class="op" id="5355528">&amp;&amp;</span>&nbsp;<span class="ident" id="5355531">c</span>&nbsp;<span class="op" id="5355533">&lt;=</span>&nbsp;<span class="string" id="5355536">&#39;9&#39;</span>&nbsp;<span class="op" id="5355540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355544">s</span><span class="op" id="5355545">.</span><span class="ident" id="5355546">step</span>&nbsp;<span class="op" id="5355551">=</span>&nbsp;<span class="ident" id="5355553">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355565">return</span>&nbsp;<span class="ident" id="5355572">scanContinue</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5355586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355589">return</span>&nbsp;<span class="ident" id="5355596">s</span><span class="op" id="5355597">.</span><span class="builtintype" id="5355598">error</span><span class="op" id="5355603">(</span><span class="ident" id="5355604">c</span><span class="op" id="5355605">,</span>&nbsp;<span class="string" id="5355607">&#34;after&nbsp;decimal&nbsp;point&nbsp;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="5355647">)</span><br>
<span class="lineno"></span><span class="op" id="5355649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5355652">//&nbsp;stateDot0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer,&nbsp;decimal&nbsp;point,&nbsp;and&nbsp;subsequent</span><br>
<span class="lineno">440</span><span class="comment" id="5355735">//&nbsp;digits&nbsp;of&nbsp;a&nbsp;number,&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`3.14`.</span><br>
<span class="lineno"></span><span class="keyword" id="5355788">func</span>&nbsp;<span class="ident" id="5355793">stateDot0</span><span class="op" id="5355802">(</span><span class="ident" id="5355803">s</span>&nbsp;<span class="op" id="5355805">*</span><span class="ident" id="5355806">scanner</span><span class="op" id="5355813">,</span>&nbsp;<span class="ident" id="5355815">c</span>&nbsp;<span class="builtintype" id="5355817">int</span><span class="op" id="5355820">)</span>&nbsp;<span class="builtintype" id="5355822">int</span>&nbsp;<span class="op" id="5355826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355829">if</span>&nbsp;<span class="string" id="5355832">&#39;0&#39;</span>&nbsp;<span class="op" id="5355836">&lt;=</span>&nbsp;<span class="ident" id="5355839">c</span>&nbsp;<span class="op" id="5355841">&amp;&amp;</span>&nbsp;<span class="ident" id="5355844">c</span>&nbsp;<span class="op" id="5355846">&lt;=</span>&nbsp;<span class="string" id="5355849">&#39;9&#39;</span>&nbsp;<span class="op" id="5355853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355857">s</span><span class="op" id="5355858">.</span><span class="ident" id="5355859">step</span>&nbsp;<span class="op" id="5355864">=</span>&nbsp;<span class="ident" id="5355866">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355878">return</span>&nbsp;<span class="ident" id="5355885">scanContinue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5355899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355902">if</span>&nbsp;<span class="ident" id="5355905">c</span>&nbsp;<span class="op" id="5355907">==</span>&nbsp;<span class="string" id="5355910">&#39;e&#39;</span>&nbsp;<span class="op" id="5355914">||</span>&nbsp;<span class="ident" id="5355917">c</span>&nbsp;<span class="op" id="5355919">==</span>&nbsp;<span class="string" id="5355922">&#39;E&#39;</span>&nbsp;<span class="op" id="5355926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355930">s</span><span class="op" id="5355931">.</span><span class="ident" id="5355932">step</span>&nbsp;<span class="op" id="5355937">=</span>&nbsp;<span class="ident" id="5355939">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355948">return</span>&nbsp;<span class="ident" id="5355955">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5355969">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355972">return</span>&nbsp;<span class="ident" id="5355979">stateEndValue</span><span class="op" id="5355992">(</span><span class="ident" id="5355993">s</span><span class="op" id="5355994">,</span>&nbsp;<span class="ident" id="5355996">c</span><span class="op" id="5355997">)</span><br>
<span class="lineno"></span><span class="op" id="5355999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5356002">//&nbsp;stateE&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa&nbsp;and&nbsp;e&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5356071">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e`&nbsp;or&nbsp;`0.314e`.</span><br>
<span class="lineno">455</span><span class="keyword" id="5356116">func</span>&nbsp;<span class="ident" id="5356121">stateE</span><span class="op" id="5356127">(</span><span class="ident" id="5356128">s</span>&nbsp;<span class="op" id="5356130">*</span><span class="ident" id="5356131">scanner</span><span class="op" id="5356138">,</span>&nbsp;<span class="ident" id="5356140">c</span>&nbsp;<span class="builtintype" id="5356142">int</span><span class="op" id="5356145">)</span>&nbsp;<span class="builtintype" id="5356147">int</span>&nbsp;<span class="op" id="5356151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356154">if</span>&nbsp;<span class="ident" id="5356157">c</span>&nbsp;<span class="op" id="5356159">==</span>&nbsp;<span class="string" id="5356162">&#39;+&#39;</span>&nbsp;<span class="op" id="5356166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356170">s</span><span class="op" id="5356171">.</span><span class="ident" id="5356172">step</span>&nbsp;<span class="op" id="5356177">=</span>&nbsp;<span class="ident" id="5356179">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356192">return</span>&nbsp;<span class="ident" id="5356199">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5356213">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356216">if</span>&nbsp;<span class="ident" id="5356219">c</span>&nbsp;<span class="op" id="5356221">==</span>&nbsp;<span class="string" id="5356224">&#39;-&#39;</span>&nbsp;<span class="op" id="5356228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356232">s</span><span class="op" id="5356233">.</span><span class="ident" id="5356234">step</span>&nbsp;<span class="op" id="5356239">=</span>&nbsp;<span class="ident" id="5356241">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356254">return</span>&nbsp;<span class="ident" id="5356261">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5356275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356278">return</span>&nbsp;<span class="ident" id="5356285">stateESign</span><span class="op" id="5356295">(</span><span class="ident" id="5356296">s</span><span class="op" id="5356297">,</span>&nbsp;<span class="ident" id="5356299">c</span><span class="op" id="5356300">)</span><br>
<span class="lineno">465</span><span class="op" id="5356302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5356305">//&nbsp;stateESign&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;and&nbsp;sign&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5356385">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-`&nbsp;or&nbsp;`0.314e+`.</span><br>
<span class="lineno"></span><span class="keyword" id="5356432">func</span>&nbsp;<span class="ident" id="5356437">stateESign</span><span class="op" id="5356447">(</span><span class="ident" id="5356448">s</span>&nbsp;<span class="op" id="5356450">*</span><span class="ident" id="5356451">scanner</span><span class="op" id="5356458">,</span>&nbsp;<span class="ident" id="5356460">c</span>&nbsp;<span class="builtintype" id="5356462">int</span><span class="op" id="5356465">)</span>&nbsp;<span class="builtintype" id="5356467">int</span>&nbsp;<span class="op" id="5356471">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356474">if</span>&nbsp;<span class="string" id="5356477">&#39;0&#39;</span>&nbsp;<span class="op" id="5356481">&lt;=</span>&nbsp;<span class="ident" id="5356484">c</span>&nbsp;<span class="op" id="5356486">&amp;&amp;</span>&nbsp;<span class="ident" id="5356489">c</span>&nbsp;<span class="op" id="5356491">&lt;=</span>&nbsp;<span class="string" id="5356494">&#39;9&#39;</span>&nbsp;<span class="op" id="5356498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356502">s</span><span class="op" id="5356503">.</span><span class="ident" id="5356504">step</span>&nbsp;<span class="op" id="5356509">=</span>&nbsp;<span class="ident" id="5356511">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356521">return</span>&nbsp;<span class="ident" id="5356528">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5356542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356545">return</span>&nbsp;<span class="ident" id="5356552">s</span><span class="op" id="5356553">.</span><span class="builtintype" id="5356554">error</span><span class="op" id="5356559">(</span><span class="ident" id="5356560">c</span><span class="op" id="5356561">,</span>&nbsp;<span class="string" id="5356563">&#34;in&nbsp;exponent&nbsp;of&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="5356595">)</span><br>
<span class="lineno">475</span><span class="op" id="5356597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5356600">//&nbsp;stateE0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;optional&nbsp;sign,</span><br>
<span class="lineno"></span><span class="comment" id="5356670">//&nbsp;and&nbsp;at&nbsp;least&nbsp;one&nbsp;digit&nbsp;of&nbsp;the&nbsp;exponent&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5356725">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-2`&nbsp;or&nbsp;`0.314e+1`&nbsp;or&nbsp;`3.14e0`.</span><br>
<span class="lineno">480</span><span class="keyword" id="5356786">func</span>&nbsp;<span class="ident" id="5356791">stateE0</span><span class="op" id="5356798">(</span><span class="ident" id="5356799">s</span>&nbsp;<span class="op" id="5356801">*</span><span class="ident" id="5356802">scanner</span><span class="op" id="5356809">,</span>&nbsp;<span class="ident" id="5356811">c</span>&nbsp;<span class="builtintype" id="5356813">int</span><span class="op" id="5356816">)</span>&nbsp;<span class="builtintype" id="5356818">int</span>&nbsp;<span class="op" id="5356822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356825">if</span>&nbsp;<span class="string" id="5356828">&#39;0&#39;</span>&nbsp;<span class="op" id="5356832">&lt;=</span>&nbsp;<span class="ident" id="5356835">c</span>&nbsp;<span class="op" id="5356837">&amp;&amp;</span>&nbsp;<span class="ident" id="5356840">c</span>&nbsp;<span class="op" id="5356842">&lt;=</span>&nbsp;<span class="string" id="5356845">&#39;9&#39;</span>&nbsp;<span class="op" id="5356849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356853">s</span><span class="op" id="5356854">.</span><span class="ident" id="5356855">step</span>&nbsp;<span class="op" id="5356860">=</span>&nbsp;<span class="ident" id="5356862">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356872">return</span>&nbsp;<span class="ident" id="5356879">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5356893">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356896">return</span>&nbsp;<span class="ident" id="5356903">stateEndValue</span><span class="op" id="5356916">(</span><span class="ident" id="5356917">s</span><span class="op" id="5356918">,</span>&nbsp;<span class="ident" id="5356920">c</span><span class="op" id="5356921">)</span><br>
<span class="lineno"></span><span class="op" id="5356923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5356926">//&nbsp;stateT&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`t`.</span><br>
<span class="lineno"></span><span class="keyword" id="5356968">func</span>&nbsp;<span class="ident" id="5356973">stateT</span><span class="op" id="5356979">(</span><span class="ident" id="5356980">s</span>&nbsp;<span class="op" id="5356982">*</span><span class="ident" id="5356983">scanner</span><span class="op" id="5356990">,</span>&nbsp;<span class="ident" id="5356992">c</span>&nbsp;<span class="builtintype" id="5356994">int</span><span class="op" id="5356997">)</span>&nbsp;<span class="builtintype" id="5356999">int</span>&nbsp;<span class="op" id="5357003">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357006">if</span>&nbsp;<span class="ident" id="5357009">c</span>&nbsp;<span class="op" id="5357011">==</span>&nbsp;<span class="string" id="5357014">&#39;r&#39;</span>&nbsp;<span class="op" id="5357018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357022">s</span><span class="op" id="5357023">.</span><span class="ident" id="5357024">step</span>&nbsp;<span class="op" id="5357029">=</span>&nbsp;<span class="ident" id="5357031">stateTr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357041">return</span>&nbsp;<span class="ident" id="5357048">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5357062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357065">return</span>&nbsp;<span class="ident" id="5357072">s</span><span class="op" id="5357073">.</span><span class="builtintype" id="5357074">error</span><span class="op" id="5357079">(</span><span class="ident" id="5357080">c</span><span class="op" id="5357081">,</span>&nbsp;<span class="string" id="5357083">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;r&#39;)&#34;</span><span class="op" id="5357116">)</span><br>
<span class="lineno">495</span><span class="op" id="5357118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5357121">//&nbsp;stateTr&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tr`.</span><br>
<span class="lineno"></span><span class="keyword" id="5357165">func</span>&nbsp;<span class="ident" id="5357170">stateTr</span><span class="op" id="5357177">(</span><span class="ident" id="5357178">s</span>&nbsp;<span class="op" id="5357180">*</span><span class="ident" id="5357181">scanner</span><span class="op" id="5357188">,</span>&nbsp;<span class="ident" id="5357190">c</span>&nbsp;<span class="builtintype" id="5357192">int</span><span class="op" id="5357195">)</span>&nbsp;<span class="builtintype" id="5357197">int</span>&nbsp;<span class="op" id="5357201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357204">if</span>&nbsp;<span class="ident" id="5357207">c</span>&nbsp;<span class="op" id="5357209">==</span>&nbsp;<span class="string" id="5357212">&#39;u&#39;</span>&nbsp;<span class="op" id="5357216">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357220">s</span><span class="op" id="5357221">.</span><span class="ident" id="5357222">step</span>&nbsp;<span class="op" id="5357227">=</span>&nbsp;<span class="ident" id="5357229">stateTru</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357240">return</span>&nbsp;<span class="ident" id="5357247">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5357261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357264">return</span>&nbsp;<span class="ident" id="5357271">s</span><span class="op" id="5357272">.</span><span class="builtintype" id="5357273">error</span><span class="op" id="5357278">(</span><span class="ident" id="5357279">c</span><span class="op" id="5357280">,</span>&nbsp;<span class="string" id="5357282">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="5357315">)</span><br>
<span class="lineno"></span><span class="op" id="5357317">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="5357320">//&nbsp;stateTru&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tru`.</span><br>
<span class="lineno"></span><span class="keyword" id="5357366">func</span>&nbsp;<span class="ident" id="5357371">stateTru</span><span class="op" id="5357379">(</span><span class="ident" id="5357380">s</span>&nbsp;<span class="op" id="5357382">*</span><span class="ident" id="5357383">scanner</span><span class="op" id="5357390">,</span>&nbsp;<span class="ident" id="5357392">c</span>&nbsp;<span class="builtintype" id="5357394">int</span><span class="op" id="5357397">)</span>&nbsp;<span class="builtintype" id="5357399">int</span>&nbsp;<span class="op" id="5357403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357406">if</span>&nbsp;<span class="ident" id="5357409">c</span>&nbsp;<span class="op" id="5357411">==</span>&nbsp;<span class="string" id="5357414">&#39;e&#39;</span>&nbsp;<span class="op" id="5357418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357422">s</span><span class="op" id="5357423">.</span><span class="ident" id="5357424">step</span>&nbsp;<span class="op" id="5357429">=</span>&nbsp;<span class="ident" id="5357431">stateEndValue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357447">return</span>&nbsp;<span class="ident" id="5357454">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5357468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357471">return</span>&nbsp;<span class="ident" id="5357478">s</span><span class="op" id="5357479">.</span><span class="builtintype" id="5357480">error</span><span class="op" id="5357485">(</span><span class="ident" id="5357486">c</span><span class="op" id="5357487">,</span>&nbsp;<span class="string" id="5357489">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="5357522">)</span><br>
<span class="lineno"></span><span class="op" id="5357524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="5357527">//&nbsp;stateF&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`f`.</span><br>
<span class="lineno"></span><span class="keyword" id="5357569">func</span>&nbsp;<span class="ident" id="5357574">stateF</span><span class="op" id="5357580">(</span><span class="ident" id="5357581">s</span>&nbsp;<span class="op" id="5357583">*</span><span class="ident" id="5357584">scanner</span><span class="op" id="5357591">,</span>&nbsp;<span class="ident" id="5357593">c</span>&nbsp;<span class="builtintype" id="5357595">int</span><span class="op" id="5357598">)</span>&nbsp;<span class="builtintype" id="5357600">int</span>&nbsp;<span class="op" id="5357604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357607">if</span>&nbsp;<span class="ident" id="5357610">c</span>&nbsp;<span class="op" id="5357612">==</span>&nbsp;<span class="string" id="5357615">&#39;a&#39;</span>&nbsp;<span class="op" id="5357619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357623">s</span><span class="op" id="5357624">.</span><span class="ident" id="5357625">step</span>&nbsp;<span class="op" id="5357630">=</span>&nbsp;<span class="ident" id="5357632">stateFa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357642">return</span>&nbsp;<span class="ident" id="5357649">scanContinue</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5357663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357666">return</span>&nbsp;<span class="ident" id="5357673">s</span><span class="op" id="5357674">.</span><span class="builtintype" id="5357675">error</span><span class="op" id="5357680">(</span><span class="ident" id="5357681">c</span><span class="op" id="5357682">,</span>&nbsp;<span class="string" id="5357684">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;a&#39;)&#34;</span><span class="op" id="5357718">)</span><br>
<span class="lineno"></span><span class="op" id="5357720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5357723">//&nbsp;stateFa&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fa`.</span><br>
<span class="lineno">525</span><span class="keyword" id="5357767">func</span>&nbsp;<span class="ident" id="5357772">stateFa</span><span class="op" id="5357779">(</span><span class="ident" id="5357780">s</span>&nbsp;<span class="op" id="5357782">*</span><span class="ident" id="5357783">scanner</span><span class="op" id="5357790">,</span>&nbsp;<span class="ident" id="5357792">c</span>&nbsp;<span class="builtintype" id="5357794">int</span><span class="op" id="5357797">)</span>&nbsp;<span class="builtintype" id="5357799">int</span>&nbsp;<span class="op" id="5357803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357806">if</span>&nbsp;<span class="ident" id="5357809">c</span>&nbsp;<span class="op" id="5357811">==</span>&nbsp;<span class="string" id="5357814">&#39;l&#39;</span>&nbsp;<span class="op" id="5357818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357822">s</span><span class="op" id="5357823">.</span><span class="ident" id="5357824">step</span>&nbsp;<span class="op" id="5357829">=</span>&nbsp;<span class="ident" id="5357831">stateFal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357842">return</span>&nbsp;<span class="ident" id="5357849">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5357863">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357866">return</span>&nbsp;<span class="ident" id="5357873">s</span><span class="op" id="5357874">.</span><span class="builtintype" id="5357875">error</span><span class="op" id="5357880">(</span><span class="ident" id="5357881">c</span><span class="op" id="5357882">,</span>&nbsp;<span class="string" id="5357884">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="5357918">)</span><br>
<span class="lineno"></span><span class="op" id="5357920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5357923">//&nbsp;stateFal&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fal`.</span><br>
<span class="lineno"></span><span class="keyword" id="5357969">func</span>&nbsp;<span class="ident" id="5357974">stateFal</span><span class="op" id="5357982">(</span><span class="ident" id="5357983">s</span>&nbsp;<span class="op" id="5357985">*</span><span class="ident" id="5357986">scanner</span><span class="op" id="5357993">,</span>&nbsp;<span class="ident" id="5357995">c</span>&nbsp;<span class="builtintype" id="5357997">int</span><span class="op" id="5358000">)</span>&nbsp;<span class="builtintype" id="5358002">int</span>&nbsp;<span class="op" id="5358006">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358009">if</span>&nbsp;<span class="ident" id="5358012">c</span>&nbsp;<span class="op" id="5358014">==</span>&nbsp;<span class="string" id="5358017">&#39;s&#39;</span>&nbsp;<span class="op" id="5358021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358025">s</span><span class="op" id="5358026">.</span><span class="ident" id="5358027">step</span>&nbsp;<span class="op" id="5358032">=</span>&nbsp;<span class="ident" id="5358034">stateFals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358046">return</span>&nbsp;<span class="ident" id="5358053">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5358067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358070">return</span>&nbsp;<span class="ident" id="5358077">s</span><span class="op" id="5358078">.</span><span class="builtintype" id="5358079">error</span><span class="op" id="5358084">(</span><span class="ident" id="5358085">c</span><span class="op" id="5358086">,</span>&nbsp;<span class="string" id="5358088">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;s&#39;)&#34;</span><span class="op" id="5358122">)</span><br>
<span class="lineno">540</span><span class="op" id="5358124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5358127">//&nbsp;stateFals&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fals`.</span><br>
<span class="lineno"></span><span class="keyword" id="5358175">func</span>&nbsp;<span class="ident" id="5358180">stateFals</span><span class="op" id="5358189">(</span><span class="ident" id="5358190">s</span>&nbsp;<span class="op" id="5358192">*</span><span class="ident" id="5358193">scanner</span><span class="op" id="5358200">,</span>&nbsp;<span class="ident" id="5358202">c</span>&nbsp;<span class="builtintype" id="5358204">int</span><span class="op" id="5358207">)</span>&nbsp;<span class="builtintype" id="5358209">int</span>&nbsp;<span class="op" id="5358213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358216">if</span>&nbsp;<span class="ident" id="5358219">c</span>&nbsp;<span class="op" id="5358221">==</span>&nbsp;<span class="string" id="5358224">&#39;e&#39;</span>&nbsp;<span class="op" id="5358228">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358232">s</span><span class="op" id="5358233">.</span><span class="ident" id="5358234">step</span>&nbsp;<span class="op" id="5358239">=</span>&nbsp;<span class="ident" id="5358241">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358257">return</span>&nbsp;<span class="ident" id="5358264">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5358278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358281">return</span>&nbsp;<span class="ident" id="5358288">s</span><span class="op" id="5358289">.</span><span class="builtintype" id="5358290">error</span><span class="op" id="5358295">(</span><span class="ident" id="5358296">c</span><span class="op" id="5358297">,</span>&nbsp;<span class="string" id="5358299">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="5358333">)</span><br>
<span class="lineno"></span><span class="op" id="5358335">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="comment" id="5358338">//&nbsp;stateN&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`n`.</span><br>
<span class="lineno"></span><span class="keyword" id="5358380">func</span>&nbsp;<span class="ident" id="5358385">stateN</span><span class="op" id="5358391">(</span><span class="ident" id="5358392">s</span>&nbsp;<span class="op" id="5358394">*</span><span class="ident" id="5358395">scanner</span><span class="op" id="5358402">,</span>&nbsp;<span class="ident" id="5358404">c</span>&nbsp;<span class="builtintype" id="5358406">int</span><span class="op" id="5358409">)</span>&nbsp;<span class="builtintype" id="5358411">int</span>&nbsp;<span class="op" id="5358415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358418">if</span>&nbsp;<span class="ident" id="5358421">c</span>&nbsp;<span class="op" id="5358423">==</span>&nbsp;<span class="string" id="5358426">&#39;u&#39;</span>&nbsp;<span class="op" id="5358430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358434">s</span><span class="op" id="5358435">.</span><span class="ident" id="5358436">step</span>&nbsp;<span class="op" id="5358441">=</span>&nbsp;<span class="ident" id="5358443">stateNu</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358453">return</span>&nbsp;<span class="ident" id="5358460">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5358474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358477">return</span>&nbsp;<span class="ident" id="5358484">s</span><span class="op" id="5358485">.</span><span class="builtintype" id="5358486">error</span><span class="op" id="5358491">(</span><span class="ident" id="5358492">c</span><span class="op" id="5358493">,</span>&nbsp;<span class="string" id="5358495">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="5358528">)</span><br>
<span class="lineno"></span><span class="op" id="5358530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="comment" id="5358533">//&nbsp;stateNu&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nu`.</span><br>
<span class="lineno"></span><span class="keyword" id="5358577">func</span>&nbsp;<span class="ident" id="5358582">stateNu</span><span class="op" id="5358589">(</span><span class="ident" id="5358590">s</span>&nbsp;<span class="op" id="5358592">*</span><span class="ident" id="5358593">scanner</span><span class="op" id="5358600">,</span>&nbsp;<span class="ident" id="5358602">c</span>&nbsp;<span class="builtintype" id="5358604">int</span><span class="op" id="5358607">)</span>&nbsp;<span class="builtintype" id="5358609">int</span>&nbsp;<span class="op" id="5358613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358616">if</span>&nbsp;<span class="ident" id="5358619">c</span>&nbsp;<span class="op" id="5358621">==</span>&nbsp;<span class="string" id="5358624">&#39;l&#39;</span>&nbsp;<span class="op" id="5358628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358632">s</span><span class="op" id="5358633">.</span><span class="ident" id="5358634">step</span>&nbsp;<span class="op" id="5358639">=</span>&nbsp;<span class="ident" id="5358641">stateNul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358652">return</span>&nbsp;<span class="ident" id="5358659">scanContinue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5358673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358676">return</span>&nbsp;<span class="ident" id="5358683">s</span><span class="op" id="5358684">.</span><span class="builtintype" id="5358685">error</span><span class="op" id="5358690">(</span><span class="ident" id="5358691">c</span><span class="op" id="5358692">,</span>&nbsp;<span class="string" id="5358694">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="5358727">)</span><br>
<span class="lineno"></span><span class="op" id="5358729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5358732">//&nbsp;stateNul&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nul`.</span><br>
<span class="lineno">570</span><span class="keyword" id="5358778">func</span>&nbsp;<span class="ident" id="5358783">stateNul</span><span class="op" id="5358791">(</span><span class="ident" id="5358792">s</span>&nbsp;<span class="op" id="5358794">*</span><span class="ident" id="5358795">scanner</span><span class="op" id="5358802">,</span>&nbsp;<span class="ident" id="5358804">c</span>&nbsp;<span class="builtintype" id="5358806">int</span><span class="op" id="5358809">)</span>&nbsp;<span class="builtintype" id="5358811">int</span>&nbsp;<span class="op" id="5358815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358818">if</span>&nbsp;<span class="ident" id="5358821">c</span>&nbsp;<span class="op" id="5358823">==</span>&nbsp;<span class="string" id="5358826">&#39;l&#39;</span>&nbsp;<span class="op" id="5358830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358834">s</span><span class="op" id="5358835">.</span><span class="ident" id="5358836">step</span>&nbsp;<span class="op" id="5358841">=</span>&nbsp;<span class="ident" id="5358843">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358859">return</span>&nbsp;<span class="ident" id="5358866">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5358880">}</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358883">return</span>&nbsp;<span class="ident" id="5358890">s</span><span class="op" id="5358891">.</span><span class="builtintype" id="5358892">error</span><span class="op" id="5358897">(</span><span class="ident" id="5358898">c</span><span class="op" id="5358899">,</span>&nbsp;<span class="string" id="5358901">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="5358934">)</span><br>
<span class="lineno"></span><span class="op" id="5358936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5358939">//&nbsp;stateError&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reaching&nbsp;a&nbsp;syntax&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5358997">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`[1}`&nbsp;or&nbsp;`5.1.2`.</span><br>
<span class="lineno">580</span><span class="keyword" id="5359040">func</span>&nbsp;<span class="ident" id="5359045">stateError</span><span class="op" id="5359055">(</span><span class="ident" id="5359056">s</span>&nbsp;<span class="op" id="5359058">*</span><span class="ident" id="5359059">scanner</span><span class="op" id="5359066">,</span>&nbsp;<span class="ident" id="5359068">c</span>&nbsp;<span class="builtintype" id="5359070">int</span><span class="op" id="5359073">)</span>&nbsp;<span class="builtintype" id="5359075">int</span>&nbsp;<span class="op" id="5359079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359082">return</span>&nbsp;<span class="ident" id="5359089">scanError</span><br>
<span class="lineno"></span><span class="op" id="5359099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5359102">//&nbsp;error&nbsp;records&nbsp;an&nbsp;error&nbsp;and&nbsp;switches&nbsp;to&nbsp;the&nbsp;error&nbsp;state.</span><br>
<span class="lineno">585</span><span class="keyword" id="5359161">func</span>&nbsp;<span class="op" id="5359166">(</span><span class="ident" id="5359167">s</span>&nbsp;<span class="op" id="5359169">*</span><span class="ident" id="5359170">scanner</span><span class="op" id="5359177">)</span>&nbsp;<span class="builtintype" id="5359179">error</span><span class="op" id="5359184">(</span><span class="ident" id="5359185">c</span>&nbsp;<span class="builtintype" id="5359187">int</span><span class="op" id="5359190">,</span>&nbsp;<span class="ident" id="5359192">context</span>&nbsp;<span class="builtintype" id="5359200">string</span><span class="op" id="5359206">)</span>&nbsp;<span class="builtintype" id="5359208">int</span>&nbsp;<span class="op" id="5359212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359215">s</span><span class="op" id="5359216">.</span><span class="ident" id="5359217">step</span>&nbsp;<span class="op" id="5359222">=</span>&nbsp;<span class="ident" id="5359224">stateError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359236">s</span><span class="op" id="5359237">.</span><span class="ident" id="5359238">err</span>&nbsp;<span class="op" id="5359242">=</span>&nbsp;<span class="op" id="5359244">&amp;</span><span class="ident" id="5359245">SyntaxError</span><span class="op" id="5359256">{</span><span class="string" id="5359257">&#34;invalid&nbsp;character&nbsp;&#34;</span>&nbsp;<span class="op" id="5359278">+</span>&nbsp;<span class="ident" id="5359280">quoteChar</span><span class="op" id="5359289">(</span><span class="ident" id="5359290">c</span><span class="op" id="5359291">)</span>&nbsp;<span class="op" id="5359293">+</span>&nbsp;<span class="string" id="5359295">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="5359299">+</span>&nbsp;<span class="ident" id="5359301">context</span><span class="op" id="5359308">,</span>&nbsp;<span class="ident" id="5359310">s</span><span class="op" id="5359311">.</span><span class="ident" id="5359312">bytes</span><span class="op" id="5359317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359320">return</span>&nbsp;<span class="ident" id="5359327">scanError</span><br>
<span class="lineno"></span><span class="op" id="5359337">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="5359340">//&nbsp;quoteChar&nbsp;formats&nbsp;c&nbsp;as&nbsp;a&nbsp;quoted&nbsp;character&nbsp;literal</span><br>
<span class="lineno"></span><span class="keyword" id="5359393">func</span>&nbsp;<span class="ident" id="5359398">quoteChar</span><span class="op" id="5359407">(</span><span class="ident" id="5359408">c</span>&nbsp;<span class="builtintype" id="5359410">int</span><span class="op" id="5359413">)</span>&nbsp;<span class="builtintype" id="5359415">string</span>&nbsp;<span class="op" id="5359422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5359425">//&nbsp;special&nbsp;cases&nbsp;-&nbsp;different&nbsp;from&nbsp;quoted&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359475">if</span>&nbsp;<span class="ident" id="5359478">c</span>&nbsp;<span class="op" id="5359480">==</span>&nbsp;<span class="string" id="5359483">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="5359488">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359492">return</span>&nbsp;<span class="string" id="5359499">`&#39;\&#39;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5359507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359510">if</span>&nbsp;<span class="ident" id="5359513">c</span>&nbsp;<span class="op" id="5359515">==</span>&nbsp;<span class="string" id="5359518">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5359522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359526">return</span>&nbsp;<span class="string" id="5359533">`&#39;&#34;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5359540">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5359544">//&nbsp;use&nbsp;quoted&nbsp;string&nbsp;with&nbsp;different&nbsp;quotation&nbsp;marks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359597">s</span>&nbsp;<span class="op" id="5359599">:=</span>&nbsp;<span class="ident" id="5359602">strconv</span><span class="op" id="5359609">.</span><span class="ident" id="5359610">Quote</span><span class="op" id="5359615">(</span><span class="builtintype" id="5359616">string</span><span class="op" id="5359622">(</span><span class="ident" id="5359623">c</span><span class="op" id="5359624">)</span><span class="op" id="5359625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359628">return</span>&nbsp;<span class="string" id="5359635">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="5359639">+</span>&nbsp;<span class="ident" id="5359641">s</span><span class="op" id="5359642">[</span><span class="num" id="5359643">1</span><span class="op" id="5359644">:</span><span class="builtinfunc" id="5359645">len</span><span class="op" id="5359648">(</span><span class="ident" id="5359649">s</span><span class="op" id="5359650">)</span><span class="op" id="5359651">-</span><span class="num" id="5359652">1</span><span class="op" id="5359653">]</span>&nbsp;<span class="op" id="5359655">+</span>&nbsp;<span class="string" id="5359657">&#34;&#39;&#34;</span><br>
<span class="lineno"></span><span class="op" id="5359661">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span><span class="comment" id="5359664">//&nbsp;undo&nbsp;causes&nbsp;the&nbsp;scanner&nbsp;to&nbsp;return&nbsp;scanCode&nbsp;from&nbsp;the&nbsp;next&nbsp;state&nbsp;transition.</span><br>
<span class="lineno"></span><span class="comment" id="5359742">//&nbsp;This&nbsp;gives&nbsp;callers&nbsp;a&nbsp;simple&nbsp;1-byte&nbsp;undo&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="keyword" id="5359796">func</span>&nbsp;<span class="op" id="5359801">(</span><span class="ident" id="5359802">s</span>&nbsp;<span class="op" id="5359804">*</span><span class="ident" id="5359805">scanner</span><span class="op" id="5359812">)</span>&nbsp;<span class="ident" id="5359814">undo</span><span class="op" id="5359818">(</span><span class="ident" id="5359819">scanCode</span>&nbsp;<span class="builtintype" id="5359828">int</span><span class="op" id="5359831">)</span>&nbsp;<span class="op" id="5359833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359836">if</span>&nbsp;<span class="ident" id="5359839">s</span><span class="op" id="5359840">.</span><span class="ident" id="5359841">redo</span>&nbsp;<span class="op" id="5359846">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5359850">panic</span><span class="op" id="5359855">(</span><span class="string" id="5359856">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;scanner&#34;</span><span class="op" id="5359886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5359889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359892">s</span><span class="op" id="5359893">.</span><span class="ident" id="5359894">redoCode</span>&nbsp;<span class="op" id="5359903">=</span>&nbsp;<span class="ident" id="5359905">scanCode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359915">s</span><span class="op" id="5359916">.</span><span class="ident" id="5359917">redoState</span>&nbsp;<span class="op" id="5359927">=</span>&nbsp;<span class="ident" id="5359929">s</span><span class="op" id="5359930">.</span><span class="ident" id="5359931">step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359937">s</span><span class="op" id="5359938">.</span><span class="ident" id="5359939">step</span>&nbsp;<span class="op" id="5359944">=</span>&nbsp;<span class="ident" id="5359946">stateRedo</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359957">s</span><span class="op" id="5359958">.</span><span class="ident" id="5359959">redo</span>&nbsp;<span class="op" id="5359964">=</span>&nbsp;<span class="builtintype" id="5359966">true</span><br>
<span class="lineno"></span><span class="op" id="5359971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5359974">//&nbsp;stateRedo&nbsp;helps&nbsp;implement&nbsp;the&nbsp;scanner&#39;s&nbsp;1-byte&nbsp;undo.</span><br>
<span class="lineno"></span><span class="keyword" id="5360030">func</span>&nbsp;<span class="ident" id="5360035">stateRedo</span><span class="op" id="5360044">(</span><span class="ident" id="5360045">s</span>&nbsp;<span class="op" id="5360047">*</span><span class="ident" id="5360048">scanner</span><span class="op" id="5360055">,</span>&nbsp;<span class="ident" id="5360057">c</span>&nbsp;<span class="builtintype" id="5360059">int</span><span class="op" id="5360062">)</span>&nbsp;<span class="builtintype" id="5360064">int</span>&nbsp;<span class="op" id="5360068">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5360071">s</span><span class="op" id="5360072">.</span><span class="ident" id="5360073">redo</span>&nbsp;<span class="op" id="5360078">=</span>&nbsp;<span class="builtintype" id="5360080">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5360087">s</span><span class="op" id="5360088">.</span><span class="ident" id="5360089">step</span>&nbsp;<span class="op" id="5360094">=</span>&nbsp;<span class="ident" id="5360096">s</span><span class="op" id="5360097">.</span><span class="ident" id="5360098">redoState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360109">return</span>&nbsp;<span class="ident" id="5360116">s</span><span class="op" id="5360117">.</span><span class="ident" id="5360118">redoCode</span><br>
<span class="lineno"></span><span class="op" id="5360127">}</span>
</div>
</body>
</html>
