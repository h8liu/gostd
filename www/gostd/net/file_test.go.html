<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8208702">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8208757">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8208811">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8208862">package</span>&nbsp;<span class="ident" id="8208870">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8208875">import</span>&nbsp;<span class="op" id="8208882">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208885">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208891">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208902">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208913">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8208923">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8208926">type</span>&nbsp;<span class="ident" id="8208931">listenerFile</span>&nbsp;<span class="keyword" id="8208944">interface</span>&nbsp;<span class="op" id="8208954">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208957">Listener</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208967">File</span><span class="op" id="8208971">(</span><span class="op" id="8208972">)</span>&nbsp;<span class="op" id="8208974">(</span><span class="ident" id="8208975">f</span>&nbsp;<span class="op" id="8208977">*</span><span class="ident" id="8208978">os</span><span class="op" id="8208980">.</span><span class="ident" id="8208981">File</span><span class="op" id="8208985">,</span>&nbsp;<span class="ident" id="8208987">err</span>&nbsp;<span class="builtintype" id="8208991">error</span><span class="op" id="8208996">)</span><br>
<span class="lineno"></span><span class="op" id="8208998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8209001">type</span>&nbsp;<span class="ident" id="8209006">packetConnFile</span>&nbsp;<span class="keyword" id="8209021">interface</span>&nbsp;<span class="op" id="8209031">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209034">PacketConn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209046">File</span><span class="op" id="8209050">(</span><span class="op" id="8209051">)</span>&nbsp;<span class="op" id="8209053">(</span><span class="ident" id="8209054">f</span>&nbsp;<span class="op" id="8209056">*</span><span class="ident" id="8209057">os</span><span class="op" id="8209059">.</span><span class="ident" id="8209060">File</span><span class="op" id="8209064">,</span>&nbsp;<span class="ident" id="8209066">err</span>&nbsp;<span class="builtintype" id="8209070">error</span><span class="op" id="8209075">)</span><br>
<span class="lineno"></span><span class="op" id="8209077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8209080">type</span>&nbsp;<span class="ident" id="8209085">connFile</span>&nbsp;<span class="keyword" id="8209094">interface</span>&nbsp;<span class="op" id="8209104">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209107">Conn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209113">File</span><span class="op" id="8209117">(</span><span class="op" id="8209118">)</span>&nbsp;<span class="op" id="8209120">(</span><span class="ident" id="8209121">f</span>&nbsp;<span class="op" id="8209123">*</span><span class="ident" id="8209124">os</span><span class="op" id="8209126">.</span><span class="ident" id="8209127">File</span><span class="op" id="8209131">,</span>&nbsp;<span class="ident" id="8209133">err</span>&nbsp;<span class="builtintype" id="8209137">error</span><span class="op" id="8209142">)</span><br>
<span class="lineno"></span><span class="op" id="8209144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8209147">func</span>&nbsp;<span class="ident" id="8209152">testFileListener</span><span class="op" id="8209168">(</span><span class="ident" id="8209169">t</span>&nbsp;<span class="op" id="8209171">*</span><span class="ident" id="8209172">testing</span><span class="op" id="8209179">.</span><span class="ident" id="8209180">T</span><span class="op" id="8209181">,</span>&nbsp;<span class="ident" id="8209183">net</span><span class="op" id="8209186">,</span>&nbsp;<span class="ident" id="8209188">laddr</span>&nbsp;<span class="builtintype" id="8209194">string</span><span class="op" id="8209200">)</span>&nbsp;<span class="op" id="8209202">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209205">switch</span>&nbsp;<span class="ident" id="8209212">net</span>&nbsp;<span class="op" id="8209216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209219">case</span>&nbsp;<span class="string" id="8209224">&#34;tcp&#34;</span><span class="op" id="8209229">,</span>&nbsp;<span class="string" id="8209231">&#34;tcp4&#34;</span><span class="op" id="8209237">,</span>&nbsp;<span class="string" id="8209239">&#34;tcp6&#34;</span><span class="op" id="8209245">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209249">laddr</span>&nbsp;<span class="op" id="8209255">+=</span>&nbsp;<span class="string" id="8209258">&#34;:0&#34;</span>&nbsp;<span class="comment" id="8209263">//&nbsp;any&nbsp;available&nbsp;port</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209289">l</span><span class="op" id="8209290">,</span>&nbsp;<span class="ident" id="8209292">err</span>&nbsp;<span class="op" id="8209296">:=</span>&nbsp;<span class="ident" id="8209299">Listen</span><span class="op" id="8209305">(</span><span class="ident" id="8209306">net</span><span class="op" id="8209309">,</span>&nbsp;<span class="ident" id="8209311">laddr</span><span class="op" id="8209316">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209319">if</span>&nbsp;<span class="ident" id="8209322">err</span>&nbsp;<span class="op" id="8209326">!=</span>&nbsp;<span class="ident" id="8209329">nil</span>&nbsp;<span class="op" id="8209333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209337">t</span><span class="op" id="8209338">.</span><span class="ident" id="8209339">Fatalf</span><span class="op" id="8209345">(</span><span class="string" id="8209346">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8209365">,</span>&nbsp;<span class="ident" id="8209367">err</span><span class="op" id="8209370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209376">defer</span>&nbsp;<span class="ident" id="8209382">l</span><span class="op" id="8209383">.</span><span class="ident" id="8209384">Close</span><span class="op" id="8209389">(</span><span class="op" id="8209390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209393">lf</span>&nbsp;<span class="op" id="8209396">:=</span>&nbsp;<span class="ident" id="8209399">l</span><span class="op" id="8209400">.</span><span class="op" id="8209401">(</span><span class="ident" id="8209402">listenerFile</span><span class="op" id="8209414">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209417">f</span><span class="op" id="8209418">,</span>&nbsp;<span class="ident" id="8209420">err</span>&nbsp;<span class="op" id="8209424">:=</span>&nbsp;<span class="ident" id="8209427">lf</span><span class="op" id="8209429">.</span><span class="ident" id="8209430">File</span><span class="op" id="8209434">(</span><span class="op" id="8209435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209438">if</span>&nbsp;<span class="ident" id="8209441">err</span>&nbsp;<span class="op" id="8209445">!=</span>&nbsp;<span class="ident" id="8209448">nil</span>&nbsp;<span class="op" id="8209452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209456">t</span><span class="op" id="8209457">.</span><span class="ident" id="8209458">Fatalf</span><span class="op" id="8209464">(</span><span class="string" id="8209465">&#34;File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8209482">,</span>&nbsp;<span class="ident" id="8209484">err</span><span class="op" id="8209487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209493">c</span><span class="op" id="8209494">,</span>&nbsp;<span class="ident" id="8209496">err</span>&nbsp;<span class="op" id="8209500">:=</span>&nbsp;<span class="ident" id="8209503">FileListener</span><span class="op" id="8209515">(</span><span class="ident" id="8209516">f</span><span class="op" id="8209517">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209520">if</span>&nbsp;<span class="ident" id="8209523">err</span>&nbsp;<span class="op" id="8209527">!=</span>&nbsp;<span class="ident" id="8209530">nil</span>&nbsp;<span class="op" id="8209534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209538">t</span><span class="op" id="8209539">.</span><span class="ident" id="8209540">Fatalf</span><span class="op" id="8209546">(</span><span class="string" id="8209547">&#34;FileListener&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8209572">,</span>&nbsp;<span class="ident" id="8209574">err</span><span class="op" id="8209577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209583">if</span>&nbsp;<span class="op" id="8209586">!</span><span class="ident" id="8209587">reflect</span><span class="op" id="8209594">.</span><span class="ident" id="8209595">DeepEqual</span><span class="op" id="8209604">(</span><span class="ident" id="8209605">l</span><span class="op" id="8209606">.</span><span class="ident" id="8209607">Addr</span><span class="op" id="8209611">(</span><span class="op" id="8209612">)</span><span class="op" id="8209613">,</span>&nbsp;<span class="ident" id="8209615">c</span><span class="op" id="8209616">.</span><span class="ident" id="8209617">Addr</span><span class="op" id="8209621">(</span><span class="op" id="8209622">)</span><span class="op" id="8209623">)</span>&nbsp;<span class="op" id="8209625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209629">t</span><span class="op" id="8209630">.</span><span class="ident" id="8209631">Fatalf</span><span class="op" id="8209637">(</span><span class="string" id="8209638">&#34;Addrs&nbsp;not&nbsp;equal:&nbsp;%#v&nbsp;!=&nbsp;%#v&#34;</span><span class="op" id="8209667">,</span>&nbsp;<span class="ident" id="8209669">l</span><span class="op" id="8209670">.</span><span class="ident" id="8209671">Addr</span><span class="op" id="8209675">(</span><span class="op" id="8209676">)</span><span class="op" id="8209677">,</span>&nbsp;<span class="ident" id="8209679">c</span><span class="op" id="8209680">.</span><span class="ident" id="8209681">Addr</span><span class="op" id="8209685">(</span><span class="op" id="8209686">)</span><span class="op" id="8209687">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209693">if</span>&nbsp;<span class="ident" id="8209696">err</span>&nbsp;<span class="op" id="8209700">:=</span>&nbsp;<span class="ident" id="8209703">c</span><span class="op" id="8209704">.</span><span class="ident" id="8209705">Close</span><span class="op" id="8209710">(</span><span class="op" id="8209711">)</span><span class="op" id="8209712">;</span>&nbsp;<span class="ident" id="8209714">err</span>&nbsp;<span class="op" id="8209718">!=</span>&nbsp;<span class="ident" id="8209721">nil</span>&nbsp;<span class="op" id="8209725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209729">t</span><span class="op" id="8209730">.</span><span class="ident" id="8209731">Fatalf</span><span class="op" id="8209737">(</span><span class="string" id="8209738">&#34;Close&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8209756">,</span>&nbsp;<span class="ident" id="8209758">err</span><span class="op" id="8209761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209767">if</span>&nbsp;<span class="ident" id="8209770">err</span>&nbsp;<span class="op" id="8209774">:=</span>&nbsp;<span class="ident" id="8209777">f</span><span class="op" id="8209778">.</span><span class="ident" id="8209779">Close</span><span class="op" id="8209784">(</span><span class="op" id="8209785">)</span><span class="op" id="8209786">;</span>&nbsp;<span class="ident" id="8209788">err</span>&nbsp;<span class="op" id="8209792">!=</span>&nbsp;<span class="ident" id="8209795">nil</span>&nbsp;<span class="op" id="8209799">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209803">t</span><span class="op" id="8209804">.</span><span class="ident" id="8209805">Fatalf</span><span class="op" id="8209811">(</span><span class="string" id="8209812">&#34;Close&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8209830">,</span>&nbsp;<span class="ident" id="8209832">err</span><span class="op" id="8209835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209838">}</span><br>
<span class="lineno"></span><span class="op" id="8209840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8209843">var</span>&nbsp;<span class="ident" id="8209847">fileListenerTests</span>&nbsp;<span class="op" id="8209865">=</span>&nbsp;<span class="op" id="8209867">[</span><span class="op" id="8209868">]</span><span class="keyword" id="8209869">struct</span>&nbsp;<span class="op" id="8209876">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209879">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8209885">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209893">laddr</span>&nbsp;<span class="builtintype" id="8209899">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209907">ipv6</span>&nbsp;&nbsp;<span class="builtintype" id="8209913">bool</span>&nbsp;<span class="comment" id="8209918">//&nbsp;test&nbsp;with&nbsp;underlying&nbsp;AF_INET6&nbsp;socket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209959">linux</span>&nbsp;<span class="builtintype" id="8209965">bool</span>&nbsp;<span class="comment" id="8209970">//&nbsp;test&nbsp;with&nbsp;abstract&nbsp;unix&nbsp;domain&nbsp;socket,&nbsp;a&nbsp;Linux-ism</span><br>
<span class="lineno"></span><span class="op" id="8210024">}</span><span class="op" id="8210025">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210028">{</span><span class="ident" id="8210029">net</span><span class="op" id="8210032">:</span>&nbsp;<span class="string" id="8210034">&#34;tcp&#34;</span><span class="op" id="8210039">,</span>&nbsp;<span class="ident" id="8210041">laddr</span><span class="op" id="8210046">:</span>&nbsp;<span class="string" id="8210048">&#34;&#34;</span><span class="op" id="8210050">}</span><span class="op" id="8210051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210054">{</span><span class="ident" id="8210055">net</span><span class="op" id="8210058">:</span>&nbsp;<span class="string" id="8210060">&#34;tcp&#34;</span><span class="op" id="8210065">,</span>&nbsp;<span class="ident" id="8210067">laddr</span><span class="op" id="8210072">:</span>&nbsp;<span class="string" id="8210074">&#34;0.0.0.0&#34;</span><span class="op" id="8210083">}</span><span class="op" id="8210084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210087">{</span><span class="ident" id="8210088">net</span><span class="op" id="8210091">:</span>&nbsp;<span class="string" id="8210093">&#34;tcp&#34;</span><span class="op" id="8210098">,</span>&nbsp;<span class="ident" id="8210100">laddr</span><span class="op" id="8210105">:</span>&nbsp;<span class="string" id="8210107">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="8210125">}</span><span class="op" id="8210126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210129">{</span><span class="ident" id="8210130">net</span><span class="op" id="8210133">:</span>&nbsp;<span class="string" id="8210135">&#34;tcp&#34;</span><span class="op" id="8210140">,</span>&nbsp;<span class="ident" id="8210142">laddr</span><span class="op" id="8210147">:</span>&nbsp;<span class="string" id="8210149">&#34;[::]&#34;</span><span class="op" id="8210155">,</span>&nbsp;<span class="ident" id="8210157">ipv6</span><span class="op" id="8210161">:</span>&nbsp;<span class="builtintype" id="8210163">true</span><span class="op" id="8210167">}</span><span class="op" id="8210168">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210172">{</span><span class="ident" id="8210173">net</span><span class="op" id="8210176">:</span>&nbsp;<span class="string" id="8210178">&#34;tcp&#34;</span><span class="op" id="8210183">,</span>&nbsp;<span class="ident" id="8210185">laddr</span><span class="op" id="8210190">:</span>&nbsp;<span class="string" id="8210192">&#34;127.0.0.1&#34;</span><span class="op" id="8210203">}</span><span class="op" id="8210204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210207">{</span><span class="ident" id="8210208">net</span><span class="op" id="8210211">:</span>&nbsp;<span class="string" id="8210213">&#34;tcp&#34;</span><span class="op" id="8210218">,</span>&nbsp;<span class="ident" id="8210220">laddr</span><span class="op" id="8210225">:</span>&nbsp;<span class="string" id="8210227">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="8210247">}</span><span class="op" id="8210248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210251">{</span><span class="ident" id="8210252">net</span><span class="op" id="8210255">:</span>&nbsp;<span class="string" id="8210257">&#34;tcp&#34;</span><span class="op" id="8210262">,</span>&nbsp;<span class="ident" id="8210264">laddr</span><span class="op" id="8210269">:</span>&nbsp;<span class="string" id="8210271">&#34;[::1]&#34;</span><span class="op" id="8210278">,</span>&nbsp;<span class="ident" id="8210280">ipv6</span><span class="op" id="8210284">:</span>&nbsp;<span class="builtintype" id="8210286">true</span><span class="op" id="8210290">}</span><span class="op" id="8210291">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210295">{</span><span class="ident" id="8210296">net</span><span class="op" id="8210299">:</span>&nbsp;<span class="string" id="8210301">&#34;tcp4&#34;</span><span class="op" id="8210307">,</span>&nbsp;<span class="ident" id="8210309">laddr</span><span class="op" id="8210314">:</span>&nbsp;<span class="string" id="8210316">&#34;&#34;</span><span class="op" id="8210318">}</span><span class="op" id="8210319">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210322">{</span><span class="ident" id="8210323">net</span><span class="op" id="8210326">:</span>&nbsp;<span class="string" id="8210328">&#34;tcp4&#34;</span><span class="op" id="8210334">,</span>&nbsp;<span class="ident" id="8210336">laddr</span><span class="op" id="8210341">:</span>&nbsp;<span class="string" id="8210343">&#34;0.0.0.0&#34;</span><span class="op" id="8210352">}</span><span class="op" id="8210353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210356">{</span><span class="ident" id="8210357">net</span><span class="op" id="8210360">:</span>&nbsp;<span class="string" id="8210362">&#34;tcp4&#34;</span><span class="op" id="8210368">,</span>&nbsp;<span class="ident" id="8210370">laddr</span><span class="op" id="8210375">:</span>&nbsp;<span class="string" id="8210377">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="8210395">}</span><span class="op" id="8210396">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210400">{</span><span class="ident" id="8210401">net</span><span class="op" id="8210404">:</span>&nbsp;<span class="string" id="8210406">&#34;tcp4&#34;</span><span class="op" id="8210412">,</span>&nbsp;<span class="ident" id="8210414">laddr</span><span class="op" id="8210419">:</span>&nbsp;<span class="string" id="8210421">&#34;127.0.0.1&#34;</span><span class="op" id="8210432">}</span><span class="op" id="8210433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210436">{</span><span class="ident" id="8210437">net</span><span class="op" id="8210440">:</span>&nbsp;<span class="string" id="8210442">&#34;tcp4&#34;</span><span class="op" id="8210448">,</span>&nbsp;<span class="ident" id="8210450">laddr</span><span class="op" id="8210455">:</span>&nbsp;<span class="string" id="8210457">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="8210477">}</span><span class="op" id="8210478">,</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210482">{</span><span class="ident" id="8210483">net</span><span class="op" id="8210486">:</span>&nbsp;<span class="string" id="8210488">&#34;tcp6&#34;</span><span class="op" id="8210494">,</span>&nbsp;<span class="ident" id="8210496">laddr</span><span class="op" id="8210501">:</span>&nbsp;<span class="string" id="8210503">&#34;&#34;</span><span class="op" id="8210505">,</span>&nbsp;<span class="ident" id="8210507">ipv6</span><span class="op" id="8210511">:</span>&nbsp;<span class="builtintype" id="8210513">true</span><span class="op" id="8210517">}</span><span class="op" id="8210518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210521">{</span><span class="ident" id="8210522">net</span><span class="op" id="8210525">:</span>&nbsp;<span class="string" id="8210527">&#34;tcp6&#34;</span><span class="op" id="8210533">,</span>&nbsp;<span class="ident" id="8210535">laddr</span><span class="op" id="8210540">:</span>&nbsp;<span class="string" id="8210542">&#34;[::]&#34;</span><span class="op" id="8210548">,</span>&nbsp;<span class="ident" id="8210550">ipv6</span><span class="op" id="8210554">:</span>&nbsp;<span class="builtintype" id="8210556">true</span><span class="op" id="8210560">}</span><span class="op" id="8210561">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210565">{</span><span class="ident" id="8210566">net</span><span class="op" id="8210569">:</span>&nbsp;<span class="string" id="8210571">&#34;tcp6&#34;</span><span class="op" id="8210577">,</span>&nbsp;<span class="ident" id="8210579">laddr</span><span class="op" id="8210584">:</span>&nbsp;<span class="string" id="8210586">&#34;[::1]&#34;</span><span class="op" id="8210593">,</span>&nbsp;<span class="ident" id="8210595">ipv6</span><span class="op" id="8210599">:</span>&nbsp;<span class="builtintype" id="8210601">true</span><span class="op" id="8210605">}</span><span class="op" id="8210606">,</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210610">{</span><span class="ident" id="8210611">net</span><span class="op" id="8210614">:</span>&nbsp;<span class="string" id="8210616">&#34;unix&#34;</span><span class="op" id="8210622">,</span>&nbsp;<span class="ident" id="8210624">laddr</span><span class="op" id="8210629">:</span>&nbsp;<span class="string" id="8210631">&#34;@gotest/net&#34;</span><span class="op" id="8210644">,</span>&nbsp;<span class="ident" id="8210646">linux</span><span class="op" id="8210651">:</span>&nbsp;<span class="builtintype" id="8210653">true</span><span class="op" id="8210657">}</span><span class="op" id="8210658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210661">{</span><span class="ident" id="8210662">net</span><span class="op" id="8210665">:</span>&nbsp;<span class="string" id="8210667">&#34;unixpacket&#34;</span><span class="op" id="8210679">,</span>&nbsp;<span class="ident" id="8210681">laddr</span><span class="op" id="8210686">:</span>&nbsp;<span class="string" id="8210688">&#34;@gotest/net&#34;</span><span class="op" id="8210701">,</span>&nbsp;<span class="ident" id="8210703">linux</span><span class="op" id="8210708">:</span>&nbsp;<span class="builtintype" id="8210710">true</span><span class="op" id="8210714">}</span><span class="op" id="8210715">,</span><br>
<span class="lineno"></span><span class="op" id="8210717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8210720">func</span>&nbsp;<span class="ident" id="8210725">TestFileListener</span><span class="op" id="8210741">(</span><span class="ident" id="8210742">t</span>&nbsp;<span class="op" id="8210744">*</span><span class="ident" id="8210745">testing</span><span class="op" id="8210752">.</span><span class="ident" id="8210753">T</span><span class="op" id="8210754">)</span>&nbsp;<span class="op" id="8210756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210759">switch</span>&nbsp;<span class="ident" id="8210766">runtime</span><span class="op" id="8210773">.</span><span class="ident" id="8210774">GOOS</span>&nbsp;<span class="op" id="8210779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210782">case</span>&nbsp;<span class="string" id="8210787">&#34;nacl&#34;</span><span class="op" id="8210793">,</span>&nbsp;<span class="string" id="8210795">&#34;windows&#34;</span><span class="op" id="8210804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210808">t</span><span class="op" id="8210809">.</span><span class="ident" id="8210810">Skipf</span><span class="op" id="8210815">(</span><span class="string" id="8210816">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8210837">,</span>&nbsp;<span class="ident" id="8210839">runtime</span><span class="op" id="8210846">.</span><span class="ident" id="8210847">GOOS</span><span class="op" id="8210851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210854">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210858">for</span>&nbsp;<span class="ident" id="8210862">_</span><span class="op" id="8210863">,</span>&nbsp;<span class="ident" id="8210865">tt</span>&nbsp;<span class="op" id="8210868">:=</span>&nbsp;<span class="keyword" id="8210871">range</span>&nbsp;<span class="ident" id="8210877">fileListenerTests</span>&nbsp;<span class="op" id="8210895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210899">if</span>&nbsp;<span class="ident" id="8210902">skipServerTest</span><span class="op" id="8210916">(</span><span class="ident" id="8210917">tt</span><span class="op" id="8210919">.</span><span class="ident" id="8210920">net</span><span class="op" id="8210923">,</span>&nbsp;<span class="string" id="8210925">&#34;unix&#34;</span><span class="op" id="8210931">,</span>&nbsp;<span class="ident" id="8210933">tt</span><span class="op" id="8210935">.</span><span class="ident" id="8210936">laddr</span><span class="op" id="8210941">,</span>&nbsp;<span class="ident" id="8210943">tt</span><span class="op" id="8210945">.</span><span class="ident" id="8210946">ipv6</span><span class="op" id="8210950">,</span>&nbsp;<span class="builtintype" id="8210952">false</span><span class="op" id="8210957">,</span>&nbsp;<span class="ident" id="8210959">tt</span><span class="op" id="8210961">.</span><span class="ident" id="8210962">linux</span><span class="op" id="8210967">)</span>&nbsp;<span class="op" id="8210969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210974">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210985">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210989">if</span>&nbsp;<span class="ident" id="8210992">skipServerTest</span><span class="op" id="8211006">(</span><span class="ident" id="8211007">tt</span><span class="op" id="8211009">.</span><span class="ident" id="8211010">net</span><span class="op" id="8211013">,</span>&nbsp;<span class="string" id="8211015">&#34;unixpacket&#34;</span><span class="op" id="8211027">,</span>&nbsp;<span class="ident" id="8211029">tt</span><span class="op" id="8211031">.</span><span class="ident" id="8211032">laddr</span><span class="op" id="8211037">,</span>&nbsp;<span class="ident" id="8211039">tt</span><span class="op" id="8211041">.</span><span class="ident" id="8211042">ipv6</span><span class="op" id="8211046">,</span>&nbsp;<span class="builtintype" id="8211048">false</span><span class="op" id="8211053">,</span>&nbsp;<span class="ident" id="8211055">tt</span><span class="op" id="8211057">.</span><span class="ident" id="8211058">linux</span><span class="op" id="8211063">)</span>&nbsp;<span class="op" id="8211065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211070">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211085">testFileListener</span><span class="op" id="8211101">(</span><span class="ident" id="8211102">t</span><span class="op" id="8211103">,</span>&nbsp;<span class="ident" id="8211105">tt</span><span class="op" id="8211107">.</span><span class="ident" id="8211108">net</span><span class="op" id="8211111">,</span>&nbsp;<span class="ident" id="8211113">tt</span><span class="op" id="8211115">.</span><span class="ident" id="8211116">laddr</span><span class="op" id="8211121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211124">}</span><br>
<span class="lineno">105</span><span class="op" id="8211126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8211129">func</span>&nbsp;<span class="ident" id="8211134">testFilePacketConn</span><span class="op" id="8211152">(</span><span class="ident" id="8211153">t</span>&nbsp;<span class="op" id="8211155">*</span><span class="ident" id="8211156">testing</span><span class="op" id="8211163">.</span><span class="ident" id="8211164">T</span><span class="op" id="8211165">,</span>&nbsp;<span class="ident" id="8211167">pcf</span>&nbsp;<span class="ident" id="8211171">packetConnFile</span><span class="op" id="8211185">,</span>&nbsp;<span class="ident" id="8211187">listen</span>&nbsp;<span class="builtintype" id="8211194">bool</span><span class="op" id="8211198">)</span>&nbsp;<span class="op" id="8211200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211203">f</span><span class="op" id="8211204">,</span>&nbsp;<span class="ident" id="8211206">err</span>&nbsp;<span class="op" id="8211210">:=</span>&nbsp;<span class="ident" id="8211213">pcf</span><span class="op" id="8211216">.</span><span class="ident" id="8211217">File</span><span class="op" id="8211221">(</span><span class="op" id="8211222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211225">if</span>&nbsp;<span class="ident" id="8211228">err</span>&nbsp;<span class="op" id="8211232">!=</span>&nbsp;<span class="ident" id="8211235">nil</span>&nbsp;<span class="op" id="8211239">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211243">t</span><span class="op" id="8211244">.</span><span class="ident" id="8211245">Fatalf</span><span class="op" id="8211251">(</span><span class="string" id="8211252">&#34;File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8211269">,</span>&nbsp;<span class="ident" id="8211271">err</span><span class="op" id="8211274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211280">c</span><span class="op" id="8211281">,</span>&nbsp;<span class="ident" id="8211283">err</span>&nbsp;<span class="op" id="8211287">:=</span>&nbsp;<span class="ident" id="8211290">FilePacketConn</span><span class="op" id="8211304">(</span><span class="ident" id="8211305">f</span><span class="op" id="8211306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211309">if</span>&nbsp;<span class="ident" id="8211312">err</span>&nbsp;<span class="op" id="8211316">!=</span>&nbsp;<span class="ident" id="8211319">nil</span>&nbsp;<span class="op" id="8211323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211327">t</span><span class="op" id="8211328">.</span><span class="ident" id="8211329">Fatalf</span><span class="op" id="8211335">(</span><span class="string" id="8211336">&#34;FilePacketConn&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8211363">,</span>&nbsp;<span class="ident" id="8211365">err</span><span class="op" id="8211368">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211374">if</span>&nbsp;<span class="op" id="8211377">!</span><span class="ident" id="8211378">reflect</span><span class="op" id="8211385">.</span><span class="ident" id="8211386">DeepEqual</span><span class="op" id="8211395">(</span><span class="ident" id="8211396">pcf</span><span class="op" id="8211399">.</span><span class="ident" id="8211400">LocalAddr</span><span class="op" id="8211409">(</span><span class="op" id="8211410">)</span><span class="op" id="8211411">,</span>&nbsp;<span class="ident" id="8211413">c</span><span class="op" id="8211414">.</span><span class="ident" id="8211415">LocalAddr</span><span class="op" id="8211424">(</span><span class="op" id="8211425">)</span><span class="op" id="8211426">)</span>&nbsp;<span class="op" id="8211428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211432">t</span><span class="op" id="8211433">.</span><span class="ident" id="8211434">Fatalf</span><span class="op" id="8211440">(</span><span class="string" id="8211441">&#34;LocalAddrs&nbsp;not&nbsp;equal:&nbsp;%#v&nbsp;!=&nbsp;%#v&#34;</span><span class="op" id="8211475">,</span>&nbsp;<span class="ident" id="8211477">pcf</span><span class="op" id="8211480">.</span><span class="ident" id="8211481">LocalAddr</span><span class="op" id="8211490">(</span><span class="op" id="8211491">)</span><span class="op" id="8211492">,</span>&nbsp;<span class="ident" id="8211494">c</span><span class="op" id="8211495">.</span><span class="ident" id="8211496">LocalAddr</span><span class="op" id="8211505">(</span><span class="op" id="8211506">)</span><span class="op" id="8211507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211513">if</span>&nbsp;<span class="ident" id="8211516">listen</span>&nbsp;<span class="op" id="8211523">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211527">if</span>&nbsp;<span class="ident" id="8211530">_</span><span class="op" id="8211531">,</span>&nbsp;<span class="ident" id="8211533">err</span>&nbsp;<span class="op" id="8211537">:=</span>&nbsp;<span class="ident" id="8211540">c</span><span class="op" id="8211541">.</span><span class="ident" id="8211542">WriteTo</span><span class="op" id="8211549">(</span><span class="op" id="8211550">[</span><span class="op" id="8211551">]</span><span class="builtintype" id="8211552">byte</span><span class="op" id="8211556">{</span><span class="op" id="8211557">}</span><span class="op" id="8211558">,</span>&nbsp;<span class="ident" id="8211560">c</span><span class="op" id="8211561">.</span><span class="ident" id="8211562">LocalAddr</span><span class="op" id="8211571">(</span><span class="op" id="8211572">)</span><span class="op" id="8211573">)</span><span class="op" id="8211574">;</span>&nbsp;<span class="ident" id="8211576">err</span>&nbsp;<span class="op" id="8211580">!=</span>&nbsp;<span class="ident" id="8211583">nil</span>&nbsp;<span class="op" id="8211587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211592">t</span><span class="op" id="8211593">.</span><span class="ident" id="8211594">Fatalf</span><span class="op" id="8211600">(</span><span class="string" id="8211601">&#34;WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8211621">,</span>&nbsp;<span class="ident" id="8211623">err</span><span class="op" id="8211626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211636">if</span>&nbsp;<span class="ident" id="8211639">err</span>&nbsp;<span class="op" id="8211643">:=</span>&nbsp;<span class="ident" id="8211646">c</span><span class="op" id="8211647">.</span><span class="ident" id="8211648">Close</span><span class="op" id="8211653">(</span><span class="op" id="8211654">)</span><span class="op" id="8211655">;</span>&nbsp;<span class="ident" id="8211657">err</span>&nbsp;<span class="op" id="8211661">!=</span>&nbsp;<span class="ident" id="8211664">nil</span>&nbsp;<span class="op" id="8211668">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211672">t</span><span class="op" id="8211673">.</span><span class="ident" id="8211674">Fatalf</span><span class="op" id="8211680">(</span><span class="string" id="8211681">&#34;Close&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8211699">,</span>&nbsp;<span class="ident" id="8211701">err</span><span class="op" id="8211704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211710">if</span>&nbsp;<span class="ident" id="8211713">err</span>&nbsp;<span class="op" id="8211717">:=</span>&nbsp;<span class="ident" id="8211720">f</span><span class="op" id="8211721">.</span><span class="ident" id="8211722">Close</span><span class="op" id="8211727">(</span><span class="op" id="8211728">)</span><span class="op" id="8211729">;</span>&nbsp;<span class="ident" id="8211731">err</span>&nbsp;<span class="op" id="8211735">!=</span>&nbsp;<span class="ident" id="8211738">nil</span>&nbsp;<span class="op" id="8211742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211746">t</span><span class="op" id="8211747">.</span><span class="ident" id="8211748">Fatalf</span><span class="op" id="8211754">(</span><span class="string" id="8211755">&#34;Close&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8211773">,</span>&nbsp;<span class="ident" id="8211775">err</span><span class="op" id="8211778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211781">}</span><br>
<span class="lineno">130</span><span class="op" id="8211783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8211786">func</span>&nbsp;<span class="ident" id="8211791">testFilePacketConnListen</span><span class="op" id="8211815">(</span><span class="ident" id="8211816">t</span>&nbsp;<span class="op" id="8211818">*</span><span class="ident" id="8211819">testing</span><span class="op" id="8211826">.</span><span class="ident" id="8211827">T</span><span class="op" id="8211828">,</span>&nbsp;<span class="ident" id="8211830">net</span><span class="op" id="8211833">,</span>&nbsp;<span class="ident" id="8211835">laddr</span>&nbsp;<span class="builtintype" id="8211841">string</span><span class="op" id="8211847">)</span>&nbsp;<span class="op" id="8211849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211852">switch</span>&nbsp;<span class="ident" id="8211859">net</span>&nbsp;<span class="op" id="8211863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211866">case</span>&nbsp;<span class="string" id="8211871">&#34;udp&#34;</span><span class="op" id="8211876">,</span>&nbsp;<span class="string" id="8211878">&#34;udp4&#34;</span><span class="op" id="8211884">,</span>&nbsp;<span class="string" id="8211886">&#34;udp6&#34;</span><span class="op" id="8211892">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211896">laddr</span>&nbsp;<span class="op" id="8211902">+=</span>&nbsp;<span class="string" id="8211905">&#34;:0&#34;</span>&nbsp;<span class="comment" id="8211910">//&nbsp;any&nbsp;available&nbsp;port</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211936">l</span><span class="op" id="8211937">,</span>&nbsp;<span class="ident" id="8211939">err</span>&nbsp;<span class="op" id="8211943">:=</span>&nbsp;<span class="ident" id="8211946">ListenPacket</span><span class="op" id="8211958">(</span><span class="ident" id="8211959">net</span><span class="op" id="8211962">,</span>&nbsp;<span class="ident" id="8211964">laddr</span><span class="op" id="8211969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211972">if</span>&nbsp;<span class="ident" id="8211975">err</span>&nbsp;<span class="op" id="8211979">!=</span>&nbsp;<span class="ident" id="8211982">nil</span>&nbsp;<span class="op" id="8211986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211990">t</span><span class="op" id="8211991">.</span><span class="ident" id="8211992">Fatalf</span><span class="op" id="8211998">(</span><span class="string" id="8211999">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8212024">,</span>&nbsp;<span class="ident" id="8212026">err</span><span class="op" id="8212029">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212035">testFilePacketConn</span><span class="op" id="8212053">(</span><span class="ident" id="8212054">t</span><span class="op" id="8212055">,</span>&nbsp;<span class="ident" id="8212057">l</span><span class="op" id="8212058">.</span><span class="op" id="8212059">(</span><span class="ident" id="8212060">packetConnFile</span><span class="op" id="8212074">)</span><span class="op" id="8212075">,</span>&nbsp;<span class="builtintype" id="8212077">true</span><span class="op" id="8212081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212084">if</span>&nbsp;<span class="ident" id="8212087">err</span>&nbsp;<span class="op" id="8212091">:=</span>&nbsp;<span class="ident" id="8212094">l</span><span class="op" id="8212095">.</span><span class="ident" id="8212096">Close</span><span class="op" id="8212101">(</span><span class="op" id="8212102">)</span><span class="op" id="8212103">;</span>&nbsp;<span class="ident" id="8212105">err</span>&nbsp;<span class="op" id="8212109">!=</span>&nbsp;<span class="ident" id="8212112">nil</span>&nbsp;<span class="op" id="8212116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212120">t</span><span class="op" id="8212121">.</span><span class="ident" id="8212122">Fatalf</span><span class="op" id="8212128">(</span><span class="string" id="8212129">&#34;Close&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8212147">,</span>&nbsp;<span class="ident" id="8212149">err</span><span class="op" id="8212152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212155">}</span><br>
<span class="lineno">145</span><span class="op" id="8212157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8212160">func</span>&nbsp;<span class="ident" id="8212165">testFilePacketConnDial</span><span class="op" id="8212187">(</span><span class="ident" id="8212188">t</span>&nbsp;<span class="op" id="8212190">*</span><span class="ident" id="8212191">testing</span><span class="op" id="8212198">.</span><span class="ident" id="8212199">T</span><span class="op" id="8212200">,</span>&nbsp;<span class="ident" id="8212202">net</span><span class="op" id="8212205">,</span>&nbsp;<span class="ident" id="8212207">raddr</span>&nbsp;<span class="builtintype" id="8212213">string</span><span class="op" id="8212219">)</span>&nbsp;<span class="op" id="8212221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212224">switch</span>&nbsp;<span class="ident" id="8212231">net</span>&nbsp;<span class="op" id="8212235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212238">case</span>&nbsp;<span class="string" id="8212243">&#34;udp&#34;</span><span class="op" id="8212248">,</span>&nbsp;<span class="string" id="8212250">&#34;udp4&#34;</span><span class="op" id="8212256">,</span>&nbsp;<span class="string" id="8212258">&#34;udp6&#34;</span><span class="op" id="8212264">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212268">raddr</span>&nbsp;<span class="op" id="8212274">+=</span>&nbsp;<span class="string" id="8212277">&#34;:12345&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212290">c</span><span class="op" id="8212291">,</span>&nbsp;<span class="ident" id="8212293">err</span>&nbsp;<span class="op" id="8212297">:=</span>&nbsp;<span class="ident" id="8212300">Dial</span><span class="op" id="8212304">(</span><span class="ident" id="8212305">net</span><span class="op" id="8212308">,</span>&nbsp;<span class="ident" id="8212310">raddr</span><span class="op" id="8212315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212318">if</span>&nbsp;<span class="ident" id="8212321">err</span>&nbsp;<span class="op" id="8212325">!=</span>&nbsp;<span class="ident" id="8212328">nil</span>&nbsp;<span class="op" id="8212332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212336">t</span><span class="op" id="8212337">.</span><span class="ident" id="8212338">Fatalf</span><span class="op" id="8212344">(</span><span class="string" id="8212345">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8212362">,</span>&nbsp;<span class="ident" id="8212364">err</span><span class="op" id="8212367">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212373">testFilePacketConn</span><span class="op" id="8212391">(</span><span class="ident" id="8212392">t</span><span class="op" id="8212393">,</span>&nbsp;<span class="ident" id="8212395">c</span><span class="op" id="8212396">.</span><span class="op" id="8212397">(</span><span class="ident" id="8212398">packetConnFile</span><span class="op" id="8212412">)</span><span class="op" id="8212413">,</span>&nbsp;<span class="builtintype" id="8212415">false</span><span class="op" id="8212420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212423">if</span>&nbsp;<span class="ident" id="8212426">err</span>&nbsp;<span class="op" id="8212430">:=</span>&nbsp;<span class="ident" id="8212433">c</span><span class="op" id="8212434">.</span><span class="ident" id="8212435">Close</span><span class="op" id="8212440">(</span><span class="op" id="8212441">)</span><span class="op" id="8212442">;</span>&nbsp;<span class="ident" id="8212444">err</span>&nbsp;<span class="op" id="8212448">!=</span>&nbsp;<span class="ident" id="8212451">nil</span>&nbsp;<span class="op" id="8212455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212459">t</span><span class="op" id="8212460">.</span><span class="ident" id="8212461">Fatalf</span><span class="op" id="8212467">(</span><span class="string" id="8212468">&#34;Close&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8212486">,</span>&nbsp;<span class="ident" id="8212488">err</span><span class="op" id="8212491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212494">}</span><br>
<span class="lineno">160</span><span class="op" id="8212496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8212499">var</span>&nbsp;<span class="ident" id="8212503">filePacketConnTests</span>&nbsp;<span class="op" id="8212523">=</span>&nbsp;<span class="op" id="8212525">[</span><span class="op" id="8212526">]</span><span class="keyword" id="8212527">struct</span>&nbsp;<span class="op" id="8212534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212537">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8212543">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212551">addr</span>&nbsp;&nbsp;<span class="builtintype" id="8212557">string</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212565">ipv6</span>&nbsp;&nbsp;<span class="builtintype" id="8212571">bool</span>&nbsp;<span class="comment" id="8212576">//&nbsp;test&nbsp;with&nbsp;underlying&nbsp;AF_INET6&nbsp;socket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212617">linux</span>&nbsp;<span class="builtintype" id="8212623">bool</span>&nbsp;<span class="comment" id="8212628">//&nbsp;test&nbsp;with&nbsp;abstract&nbsp;unix&nbsp;domain&nbsp;socket,&nbsp;a&nbsp;Linux-ism</span><br>
<span class="lineno"></span><span class="op" id="8212682">}</span><span class="op" id="8212683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212686">{</span><span class="ident" id="8212687">net</span><span class="op" id="8212690">:</span>&nbsp;<span class="string" id="8212692">&#34;udp&#34;</span><span class="op" id="8212697">,</span>&nbsp;<span class="ident" id="8212699">addr</span><span class="op" id="8212703">:</span>&nbsp;<span class="string" id="8212705">&#34;127.0.0.1&#34;</span><span class="op" id="8212716">}</span><span class="op" id="8212717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212720">{</span><span class="ident" id="8212721">net</span><span class="op" id="8212724">:</span>&nbsp;<span class="string" id="8212726">&#34;udp&#34;</span><span class="op" id="8212731">,</span>&nbsp;<span class="ident" id="8212733">addr</span><span class="op" id="8212737">:</span>&nbsp;<span class="string" id="8212739">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="8212759">}</span><span class="op" id="8212760">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212763">{</span><span class="ident" id="8212764">net</span><span class="op" id="8212767">:</span>&nbsp;<span class="string" id="8212769">&#34;udp&#34;</span><span class="op" id="8212774">,</span>&nbsp;<span class="ident" id="8212776">addr</span><span class="op" id="8212780">:</span>&nbsp;<span class="string" id="8212782">&#34;[::1]&#34;</span><span class="op" id="8212789">,</span>&nbsp;<span class="ident" id="8212791">ipv6</span><span class="op" id="8212795">:</span>&nbsp;<span class="builtintype" id="8212797">true</span><span class="op" id="8212801">}</span><span class="op" id="8212802">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212806">{</span><span class="ident" id="8212807">net</span><span class="op" id="8212810">:</span>&nbsp;<span class="string" id="8212812">&#34;udp4&#34;</span><span class="op" id="8212818">,</span>&nbsp;<span class="ident" id="8212820">addr</span><span class="op" id="8212824">:</span>&nbsp;<span class="string" id="8212826">&#34;127.0.0.1&#34;</span><span class="op" id="8212837">}</span><span class="op" id="8212838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212841">{</span><span class="ident" id="8212842">net</span><span class="op" id="8212845">:</span>&nbsp;<span class="string" id="8212847">&#34;udp4&#34;</span><span class="op" id="8212853">,</span>&nbsp;<span class="ident" id="8212855">addr</span><span class="op" id="8212859">:</span>&nbsp;<span class="string" id="8212861">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="8212881">}</span><span class="op" id="8212882">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212886">{</span><span class="ident" id="8212887">net</span><span class="op" id="8212890">:</span>&nbsp;<span class="string" id="8212892">&#34;udp6&#34;</span><span class="op" id="8212898">,</span>&nbsp;<span class="ident" id="8212900">addr</span><span class="op" id="8212904">:</span>&nbsp;<span class="string" id="8212906">&#34;[::1]&#34;</span><span class="op" id="8212913">,</span>&nbsp;<span class="ident" id="8212915">ipv6</span><span class="op" id="8212919">:</span>&nbsp;<span class="builtintype" id="8212921">true</span><span class="op" id="8212925">}</span><span class="op" id="8212926">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212930">{</span><span class="ident" id="8212931">net</span><span class="op" id="8212934">:</span>&nbsp;<span class="string" id="8212936">&#34;ip4:icmp&#34;</span><span class="op" id="8212946">,</span>&nbsp;<span class="ident" id="8212948">addr</span><span class="op" id="8212952">:</span>&nbsp;<span class="string" id="8212954">&#34;127.0.0.1&#34;</span><span class="op" id="8212965">}</span><span class="op" id="8212966">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212970">{</span><span class="ident" id="8212971">net</span><span class="op" id="8212974">:</span>&nbsp;<span class="string" id="8212976">&#34;unixgram&#34;</span><span class="op" id="8212986">,</span>&nbsp;<span class="ident" id="8212988">addr</span><span class="op" id="8212992">:</span>&nbsp;<span class="string" id="8212994">&#34;@gotest3/net&#34;</span><span class="op" id="8213008">,</span>&nbsp;<span class="ident" id="8213010">linux</span><span class="op" id="8213015">:</span>&nbsp;<span class="builtintype" id="8213017">true</span><span class="op" id="8213021">}</span><span class="op" id="8213022">,</span><br>
<span class="lineno">180</span><span class="op" id="8213024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8213027">func</span>&nbsp;<span class="ident" id="8213032">TestFilePacketConn</span><span class="op" id="8213050">(</span><span class="ident" id="8213051">t</span>&nbsp;<span class="op" id="8213053">*</span><span class="ident" id="8213054">testing</span><span class="op" id="8213061">.</span><span class="ident" id="8213062">T</span><span class="op" id="8213063">)</span>&nbsp;<span class="op" id="8213065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213068">switch</span>&nbsp;<span class="ident" id="8213075">runtime</span><span class="op" id="8213082">.</span><span class="ident" id="8213083">GOOS</span>&nbsp;<span class="op" id="8213088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213091">case</span>&nbsp;<span class="string" id="8213096">&#34;nacl&#34;</span><span class="op" id="8213102">,</span>&nbsp;<span class="string" id="8213104">&#34;plan9&#34;</span><span class="op" id="8213111">,</span>&nbsp;<span class="string" id="8213113">&#34;windows&#34;</span><span class="op" id="8213122">:</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213126">t</span><span class="op" id="8213127">.</span><span class="ident" id="8213128">Skipf</span><span class="op" id="8213133">(</span><span class="string" id="8213134">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8213155">,</span>&nbsp;<span class="ident" id="8213157">runtime</span><span class="op" id="8213164">.</span><span class="ident" id="8213165">GOOS</span><span class="op" id="8213169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213176">for</span>&nbsp;<span class="ident" id="8213180">_</span><span class="op" id="8213181">,</span>&nbsp;<span class="ident" id="8213183">tt</span>&nbsp;<span class="op" id="8213186">:=</span>&nbsp;<span class="keyword" id="8213189">range</span>&nbsp;<span class="ident" id="8213195">filePacketConnTests</span>&nbsp;<span class="op" id="8213215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213219">if</span>&nbsp;<span class="ident" id="8213222">skipServerTest</span><span class="op" id="8213236">(</span><span class="ident" id="8213237">tt</span><span class="op" id="8213239">.</span><span class="ident" id="8213240">net</span><span class="op" id="8213243">,</span>&nbsp;<span class="string" id="8213245">&#34;unixgram&#34;</span><span class="op" id="8213255">,</span>&nbsp;<span class="ident" id="8213257">tt</span><span class="op" id="8213259">.</span><span class="ident" id="8213260">addr</span><span class="op" id="8213264">,</span>&nbsp;<span class="ident" id="8213266">tt</span><span class="op" id="8213268">.</span><span class="ident" id="8213269">ipv6</span><span class="op" id="8213273">,</span>&nbsp;<span class="builtintype" id="8213275">false</span><span class="op" id="8213280">,</span>&nbsp;<span class="ident" id="8213282">tt</span><span class="op" id="8213284">.</span><span class="ident" id="8213285">linux</span><span class="op" id="8213290">)</span>&nbsp;<span class="op" id="8213292">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213297">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213312">if</span>&nbsp;<span class="ident" id="8213315">os</span><span class="op" id="8213317">.</span><span class="ident" id="8213318">Getuid</span><span class="op" id="8213324">(</span><span class="op" id="8213325">)</span>&nbsp;<span class="op" id="8213327">!=</span>&nbsp;<span class="num" id="8213330">0</span>&nbsp;<span class="op" id="8213332">&amp;&amp;</span>&nbsp;<span class="ident" id="8213335">tt</span><span class="op" id="8213337">.</span><span class="ident" id="8213338">net</span>&nbsp;<span class="op" id="8213342">==</span>&nbsp;<span class="string" id="8213345">&#34;ip4:icmp&#34;</span>&nbsp;<span class="op" id="8213356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213361">t</span><span class="op" id="8213362">.</span><span class="ident" id="8213363">Log</span><span class="op" id="8213366">(</span><span class="string" id="8213367">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="8213396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213401">continue</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213416">testFilePacketConnListen</span><span class="op" id="8213440">(</span><span class="ident" id="8213441">t</span><span class="op" id="8213442">,</span>&nbsp;<span class="ident" id="8213444">tt</span><span class="op" id="8213446">.</span><span class="ident" id="8213447">net</span><span class="op" id="8213450">,</span>&nbsp;<span class="ident" id="8213452">tt</span><span class="op" id="8213454">.</span><span class="ident" id="8213455">addr</span><span class="op" id="8213459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213463">switch</span>&nbsp;<span class="ident" id="8213470">tt</span><span class="op" id="8213472">.</span><span class="ident" id="8213473">addr</span>&nbsp;<span class="op" id="8213478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213482">case</span>&nbsp;<span class="string" id="8213487">&#34;&#34;</span><span class="op" id="8213489">,</span>&nbsp;<span class="string" id="8213491">&#34;0.0.0.0&#34;</span><span class="op" id="8213500">,</span>&nbsp;<span class="string" id="8213502">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="8213520">,</span>&nbsp;<span class="string" id="8213522">&#34;[::]&#34;</span><span class="op" id="8213528">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213532">default</span><span class="op" id="8213539">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213544">if</span>&nbsp;<span class="ident" id="8213547">tt</span><span class="op" id="8213549">.</span><span class="ident" id="8213550">net</span>&nbsp;<span class="op" id="8213554">!=</span>&nbsp;<span class="string" id="8213557">&#34;unixgram&#34;</span>&nbsp;<span class="op" id="8213568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213574">testFilePacketConnDial</span><span class="op" id="8213596">(</span><span class="ident" id="8213597">t</span><span class="op" id="8213598">,</span>&nbsp;<span class="ident" id="8213600">tt</span><span class="op" id="8213602">.</span><span class="ident" id="8213603">net</span><span class="op" id="8213606">,</span>&nbsp;<span class="ident" id="8213608">tt</span><span class="op" id="8213610">.</span><span class="ident" id="8213611">addr</span><span class="op" id="8213615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213627">}</span><br>
<span class="lineno">205</span><span class="op" id="8213629">}</span>
</div>
</body>
</html>
