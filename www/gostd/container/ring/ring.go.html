<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>container/ring</h2>
<ul>
<li><a href="/gostd/container/ring/ring.go.html" class="current">ring.go</a></li>
<li><a href="/gostd/container/ring/ring_test.go.html">ring_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6218941">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6218996">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6219050">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6219101">//&nbsp;Package&nbsp;ring&nbsp;implements&nbsp;operations&nbsp;on&nbsp;circular&nbsp;lists.</span><br>
<span class="lineno"></span><span class="keyword" id="6219158">package</span>&nbsp;<span class="ident" id="6219166">ring</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6219172">//&nbsp;A&nbsp;Ring&nbsp;is&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;circular&nbsp;list,&nbsp;or&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="6219225">//&nbsp;Rings&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;beginning&nbsp;or&nbsp;end;&nbsp;a&nbsp;pointer&nbsp;to&nbsp;any&nbsp;ring&nbsp;element</span><br>
<span class="lineno">10</span><span class="comment" id="6219296">//&nbsp;serves&nbsp;as&nbsp;reference&nbsp;to&nbsp;the&nbsp;entire&nbsp;ring.&nbsp;Empty&nbsp;rings&nbsp;are&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="6219367">//&nbsp;as&nbsp;nil&nbsp;Ring&nbsp;pointers.&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Ring&nbsp;is&nbsp;a&nbsp;one-element</span><br>
<span class="lineno"></span><span class="comment" id="6219435">//&nbsp;ring&nbsp;with&nbsp;a&nbsp;nil&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment" id="6219461">//</span><br>
<span class="lineno"></span><span class="keyword" id="6219464">type</span>&nbsp;<span class="ident" id="6219469">Ring</span>&nbsp;<span class="keyword" id="6219474">struct</span>&nbsp;<span class="op" id="6219481">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6219484">next</span><span class="op" id="6219488">,</span>&nbsp;<span class="ident" id="6219490">prev</span>&nbsp;<span class="op" id="6219495">*</span><span class="ident" id="6219496">Ring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6219502">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6219513">interface</span><span class="op" id="6219522">{</span><span class="op" id="6219523">}</span>&nbsp;<span class="comment" id="6219525">//&nbsp;for&nbsp;use&nbsp;by&nbsp;client;&nbsp;untouched&nbsp;by&nbsp;this&nbsp;library</span><br>
<span class="lineno"></span><span class="op" id="6219573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6219576">func</span>&nbsp;<span class="op" id="6219581">(</span><span class="ident" id="6219582">r</span>&nbsp;<span class="op" id="6219584">*</span><span class="ident" id="6219585">Ring</span><span class="op" id="6219589">)</span>&nbsp;<span class="ident" id="6219591">init</span><span class="op" id="6219595">(</span><span class="op" id="6219596">)</span>&nbsp;<span class="op" id="6219598">*</span><span class="ident" id="6219599">Ring</span>&nbsp;<span class="op" id="6219604">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6219607">r</span><span class="op" id="6219608">.</span><span class="ident" id="6219609">next</span>&nbsp;<span class="op" id="6219614">=</span>&nbsp;<span class="ident" id="6219616">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6219619">r</span><span class="op" id="6219620">.</span><span class="ident" id="6219621">prev</span>&nbsp;<span class="op" id="6219626">=</span>&nbsp;<span class="ident" id="6219628">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6219631">return</span>&nbsp;<span class="ident" id="6219638">r</span><br>
<span class="lineno"></span><span class="op" id="6219640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6219643">//&nbsp;Next&nbsp;returns&nbsp;the&nbsp;next&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="6219703">func</span>&nbsp;<span class="op" id="6219708">(</span><span class="ident" id="6219709">r</span>&nbsp;<span class="op" id="6219711">*</span><span class="ident" id="6219712">Ring</span><span class="op" id="6219716">)</span>&nbsp;<span class="ident" id="6219718">Next</span><span class="op" id="6219722">(</span><span class="op" id="6219723">)</span>&nbsp;<span class="op" id="6219725">*</span><span class="ident" id="6219726">Ring</span>&nbsp;<span class="op" id="6219731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6219734">if</span>&nbsp;<span class="ident" id="6219737">r</span><span class="op" id="6219738">.</span><span class="ident" id="6219739">next</span>&nbsp;<span class="op" id="6219744">==</span>&nbsp;<span class="ident" id="6219747">nil</span>&nbsp;<span class="op" id="6219751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6219755">return</span>&nbsp;<span class="ident" id="6219762">r</span><span class="op" id="6219763">.</span><span class="ident" id="6219764">init</span><span class="op" id="6219768">(</span><span class="op" id="6219769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6219772">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6219775">return</span>&nbsp;<span class="ident" id="6219782">r</span><span class="op" id="6219783">.</span><span class="ident" id="6219784">next</span><br>
<span class="lineno"></span><span class="op" id="6219789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6219792">//&nbsp;Prev&nbsp;returns&nbsp;the&nbsp;previous&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="6219856">func</span>&nbsp;<span class="op" id="6219861">(</span><span class="ident" id="6219862">r</span>&nbsp;<span class="op" id="6219864">*</span><span class="ident" id="6219865">Ring</span><span class="op" id="6219869">)</span>&nbsp;<span class="ident" id="6219871">Prev</span><span class="op" id="6219875">(</span><span class="op" id="6219876">)</span>&nbsp;<span class="op" id="6219878">*</span><span class="ident" id="6219879">Ring</span>&nbsp;<span class="op" id="6219884">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6219887">if</span>&nbsp;<span class="ident" id="6219890">r</span><span class="op" id="6219891">.</span><span class="ident" id="6219892">next</span>&nbsp;<span class="op" id="6219897">==</span>&nbsp;<span class="ident" id="6219900">nil</span>&nbsp;<span class="op" id="6219904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6219908">return</span>&nbsp;<span class="ident" id="6219915">r</span><span class="op" id="6219916">.</span><span class="ident" id="6219917">init</span><span class="op" id="6219921">(</span><span class="op" id="6219922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6219925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6219928">return</span>&nbsp;<span class="ident" id="6219935">r</span><span class="op" id="6219936">.</span><span class="ident" id="6219937">prev</span><br>
<span class="lineno"></span><span class="op" id="6219942">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="6219945">//&nbsp;Move&nbsp;moves&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;backward&nbsp;(n&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;forward&nbsp;(n&nbsp;&gt;=&nbsp;0)</span><br>
<span class="lineno"></span><span class="comment" id="6220017">//&nbsp;in&nbsp;the&nbsp;ring&nbsp;and&nbsp;returns&nbsp;that&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="6220084">//</span><br>
<span class="lineno"></span><span class="keyword" id="6220087">func</span>&nbsp;<span class="op" id="6220092">(</span><span class="ident" id="6220093">r</span>&nbsp;<span class="op" id="6220095">*</span><span class="ident" id="6220096">Ring</span><span class="op" id="6220100">)</span>&nbsp;<span class="ident" id="6220102">Move</span><span class="op" id="6220106">(</span><span class="ident" id="6220107">n</span>&nbsp;<span class="builtintype" id="6220109">int</span><span class="op" id="6220112">)</span>&nbsp;<span class="op" id="6220114">*</span><span class="ident" id="6220115">Ring</span>&nbsp;<span class="op" id="6220120">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6220123">if</span>&nbsp;<span class="ident" id="6220126">r</span><span class="op" id="6220127">.</span><span class="ident" id="6220128">next</span>&nbsp;<span class="op" id="6220133">==</span>&nbsp;<span class="ident" id="6220136">nil</span>&nbsp;<span class="op" id="6220140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6220144">return</span>&nbsp;<span class="ident" id="6220151">r</span><span class="op" id="6220152">.</span><span class="ident" id="6220153">init</span><span class="op" id="6220157">(</span><span class="op" id="6220158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6220161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6220164">switch</span>&nbsp;<span class="op" id="6220171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6220174">case</span>&nbsp;<span class="ident" id="6220179">n</span>&nbsp;<span class="op" id="6220181">&lt;</span>&nbsp;<span class="num" id="6220183">0</span><span class="op" id="6220184">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6220188">for</span>&nbsp;<span class="op" id="6220192">;</span>&nbsp;<span class="ident" id="6220194">n</span>&nbsp;<span class="op" id="6220196">&lt;</span>&nbsp;<span class="num" id="6220198">0</span><span class="op" id="6220199">;</span>&nbsp;<span class="ident" id="6220201">n</span><span class="op" id="6220202">++</span>&nbsp;<span class="op" id="6220205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6220210">r</span>&nbsp;<span class="op" id="6220212">=</span>&nbsp;<span class="ident" id="6220214">r</span><span class="op" id="6220215">.</span><span class="ident" id="6220216">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6220223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6220226">case</span>&nbsp;<span class="ident" id="6220231">n</span>&nbsp;<span class="op" id="6220233">&gt;</span>&nbsp;<span class="num" id="6220235">0</span><span class="op" id="6220236">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6220240">for</span>&nbsp;<span class="op" id="6220244">;</span>&nbsp;<span class="ident" id="6220246">n</span>&nbsp;<span class="op" id="6220248">&gt;</span>&nbsp;<span class="num" id="6220250">0</span><span class="op" id="6220251">;</span>&nbsp;<span class="ident" id="6220253">n</span><span class="op" id="6220254">--</span>&nbsp;<span class="op" id="6220257">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6220262">r</span>&nbsp;<span class="op" id="6220264">=</span>&nbsp;<span class="ident" id="6220266">r</span><span class="op" id="6220267">.</span><span class="ident" id="6220268">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6220275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6220278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6220281">return</span>&nbsp;<span class="ident" id="6220288">r</span><br>
<span class="lineno"></span><span class="op" id="6220290">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6220293">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;ring&nbsp;of&nbsp;n&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="6220330">func</span>&nbsp;<span class="ident" id="6220335">New</span><span class="op" id="6220338">(</span><span class="ident" id="6220339">n</span>&nbsp;<span class="builtintype" id="6220341">int</span><span class="op" id="6220344">)</span>&nbsp;<span class="op" id="6220346">*</span><span class="ident" id="6220347">Ring</span>&nbsp;<span class="op" id="6220352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6220355">if</span>&nbsp;<span class="ident" id="6220358">n</span>&nbsp;<span class="op" id="6220360">&lt;=</span>&nbsp;<span class="num" id="6220363">0</span>&nbsp;<span class="op" id="6220365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6220369">return</span>&nbsp;<span class="ident" id="6220376">nil</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6220381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6220384">r</span>&nbsp;<span class="op" id="6220386">:=</span>&nbsp;<span class="builtinfunc" id="6220389">new</span><span class="op" id="6220392">(</span><span class="ident" id="6220393">Ring</span><span class="op" id="6220397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6220400">p</span>&nbsp;<span class="op" id="6220402">:=</span>&nbsp;<span class="ident" id="6220405">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6220408">for</span>&nbsp;<span class="ident" id="6220412">i</span>&nbsp;<span class="op" id="6220414">:=</span>&nbsp;<span class="num" id="6220417">1</span><span class="op" id="6220418">;</span>&nbsp;<span class="ident" id="6220420">i</span>&nbsp;<span class="op" id="6220422">&lt;</span>&nbsp;<span class="ident" id="6220424">n</span><span class="op" id="6220425">;</span>&nbsp;<span class="ident" id="6220427">i</span><span class="op" id="6220428">++</span>&nbsp;<span class="op" id="6220431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6220435">p</span><span class="op" id="6220436">.</span><span class="ident" id="6220437">next</span>&nbsp;<span class="op" id="6220442">=</span>&nbsp;<span class="op" id="6220444">&amp;</span><span class="ident" id="6220445">Ring</span><span class="op" id="6220449">{</span><span class="ident" id="6220450">prev</span><span class="op" id="6220454">:</span>&nbsp;<span class="ident" id="6220456">p</span><span class="op" id="6220457">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6220461">p</span>&nbsp;<span class="op" id="6220463">=</span>&nbsp;<span class="ident" id="6220465">p</span><span class="op" id="6220466">.</span><span class="ident" id="6220467">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6220473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6220476">p</span><span class="op" id="6220477">.</span><span class="ident" id="6220478">next</span>&nbsp;<span class="op" id="6220483">=</span>&nbsp;<span class="ident" id="6220485">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6220488">r</span><span class="op" id="6220489">.</span><span class="ident" id="6220490">prev</span>&nbsp;<span class="op" id="6220495">=</span>&nbsp;<span class="ident" id="6220497">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6220500">return</span>&nbsp;<span class="ident" id="6220507">r</span><br>
<span class="lineno">75</span><span class="op" id="6220509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6220512">//&nbsp;Link&nbsp;connects&nbsp;ring&nbsp;r&nbsp;with&nbsp;ring&nbsp;s&nbsp;such&nbsp;that&nbsp;r.Next()</span><br>
<span class="lineno"></span><span class="comment" id="6220567">//&nbsp;becomes&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next().</span><br>
<span class="lineno"></span><span class="comment" id="6220625">//&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">80</span><span class="comment" id="6220649">//</span><br>
<span class="lineno"></span><span class="comment" id="6220652">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;ring,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="6220698">//&nbsp;them&nbsp;removes&nbsp;the&nbsp;elements&nbsp;between&nbsp;r&nbsp;and&nbsp;s&nbsp;from&nbsp;the&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="6220758">//&nbsp;The&nbsp;removed&nbsp;elements&nbsp;form&nbsp;a&nbsp;subring&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6220817">//&nbsp;reference&nbsp;to&nbsp;that&nbsp;subring&nbsp;(if&nbsp;no&nbsp;elements&nbsp;were&nbsp;removed,</span><br>
<span class="lineno">85</span><span class="comment" id="6220876">//&nbsp;the&nbsp;result&nbsp;is&nbsp;still&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next(),</span><br>
<span class="lineno"></span><span class="comment" id="6220932">//&nbsp;and&nbsp;not&nbsp;nil).</span><br>
<span class="lineno"></span><span class="comment" id="6220949">//</span><br>
<span class="lineno"></span><span class="comment" id="6220952">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;different&nbsp;rings,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="6221000">//&nbsp;them&nbsp;creates&nbsp;a&nbsp;single&nbsp;ring&nbsp;with&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;inserted</span><br>
<span class="lineno">90</span><span class="comment" id="6221062">//&nbsp;after&nbsp;r.&nbsp;The&nbsp;result&nbsp;points&nbsp;to&nbsp;the&nbsp;element&nbsp;following&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6221121">//&nbsp;last&nbsp;element&nbsp;of&nbsp;s&nbsp;after&nbsp;insertion.</span><br>
<span class="lineno"></span><span class="comment" id="6221159">//</span><br>
<span class="lineno"></span><span class="keyword" id="6221162">func</span>&nbsp;<span class="op" id="6221167">(</span><span class="ident" id="6221168">r</span>&nbsp;<span class="op" id="6221170">*</span><span class="ident" id="6221171">Ring</span><span class="op" id="6221175">)</span>&nbsp;<span class="ident" id="6221177">Link</span><span class="op" id="6221181">(</span><span class="ident" id="6221182">s</span>&nbsp;<span class="op" id="6221184">*</span><span class="ident" id="6221185">Ring</span><span class="op" id="6221189">)</span>&nbsp;<span class="op" id="6221191">*</span><span class="ident" id="6221192">Ring</span>&nbsp;<span class="op" id="6221197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6221200">n</span>&nbsp;<span class="op" id="6221202">:=</span>&nbsp;<span class="ident" id="6221205">r</span><span class="op" id="6221206">.</span><span class="ident" id="6221207">Next</span><span class="op" id="6221211">(</span><span class="op" id="6221212">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6221215">if</span>&nbsp;<span class="ident" id="6221218">s</span>&nbsp;<span class="op" id="6221220">!=</span>&nbsp;<span class="ident" id="6221223">nil</span>&nbsp;<span class="op" id="6221227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6221231">p</span>&nbsp;<span class="op" id="6221233">:=</span>&nbsp;<span class="ident" id="6221236">s</span><span class="op" id="6221237">.</span><span class="ident" id="6221238">Prev</span><span class="op" id="6221242">(</span><span class="op" id="6221243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6221247">//&nbsp;Note:&nbsp;Cannot&nbsp;use&nbsp;multiple&nbsp;assignment&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6221297">//&nbsp;evaluation&nbsp;order&nbsp;of&nbsp;LHS&nbsp;is&nbsp;not&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6221344">r</span><span class="op" id="6221345">.</span><span class="ident" id="6221346">next</span>&nbsp;<span class="op" id="6221351">=</span>&nbsp;<span class="ident" id="6221353">s</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6221357">s</span><span class="op" id="6221358">.</span><span class="ident" id="6221359">prev</span>&nbsp;<span class="op" id="6221364">=</span>&nbsp;<span class="ident" id="6221366">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6221370">n</span><span class="op" id="6221371">.</span><span class="ident" id="6221372">prev</span>&nbsp;<span class="op" id="6221377">=</span>&nbsp;<span class="ident" id="6221379">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6221383">p</span><span class="op" id="6221384">.</span><span class="ident" id="6221385">next</span>&nbsp;<span class="op" id="6221390">=</span>&nbsp;<span class="ident" id="6221392">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6221395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6221398">return</span>&nbsp;<span class="ident" id="6221405">n</span><br>
<span class="lineno">105</span><span class="op" id="6221407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6221410">//&nbsp;Unlink&nbsp;removes&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;from&nbsp;the&nbsp;ring&nbsp;r,&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="6221475">//&nbsp;at&nbsp;r.Next().&nbsp;If&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;==&nbsp;0,&nbsp;r&nbsp;remains&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="comment" id="6221533">//&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;removed&nbsp;subring.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">110</span><span class="comment" id="6221592">//</span><br>
<span class="lineno"></span><span class="keyword" id="6221595">func</span>&nbsp;<span class="op" id="6221600">(</span><span class="ident" id="6221601">r</span>&nbsp;<span class="op" id="6221603">*</span><span class="ident" id="6221604">Ring</span><span class="op" id="6221608">)</span>&nbsp;<span class="ident" id="6221610">Unlink</span><span class="op" id="6221616">(</span><span class="ident" id="6221617">n</span>&nbsp;<span class="builtintype" id="6221619">int</span><span class="op" id="6221622">)</span>&nbsp;<span class="op" id="6221624">*</span><span class="ident" id="6221625">Ring</span>&nbsp;<span class="op" id="6221630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6221633">if</span>&nbsp;<span class="ident" id="6221636">n</span>&nbsp;<span class="op" id="6221638">&lt;=</span>&nbsp;<span class="num" id="6221641">0</span>&nbsp;<span class="op" id="6221643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6221647">return</span>&nbsp;<span class="ident" id="6221654">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6221659">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6221662">return</span>&nbsp;<span class="ident" id="6221669">r</span><span class="op" id="6221670">.</span><span class="ident" id="6221671">Link</span><span class="op" id="6221675">(</span><span class="ident" id="6221676">r</span><span class="op" id="6221677">.</span><span class="ident" id="6221678">Move</span><span class="op" id="6221682">(</span><span class="ident" id="6221683">n</span>&nbsp;<span class="op" id="6221685">+</span>&nbsp;<span class="num" id="6221687">1</span><span class="op" id="6221688">)</span><span class="op" id="6221689">)</span><br>
<span class="lineno"></span><span class="op" id="6221691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6221694">//&nbsp;Len&nbsp;computes&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;ring&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="6221744">//&nbsp;It&nbsp;executes&nbsp;in&nbsp;time&nbsp;proportional&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;elements.</span><br>
<span class="lineno">120</span><span class="comment" id="6221807">//</span><br>
<span class="lineno"></span><span class="keyword" id="6221810">func</span>&nbsp;<span class="op" id="6221815">(</span><span class="ident" id="6221816">r</span>&nbsp;<span class="op" id="6221818">*</span><span class="ident" id="6221819">Ring</span><span class="op" id="6221823">)</span>&nbsp;<span class="ident" id="6221825">Len</span><span class="op" id="6221828">(</span><span class="op" id="6221829">)</span>&nbsp;<span class="builtintype" id="6221831">int</span>&nbsp;<span class="op" id="6221835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6221838">n</span>&nbsp;<span class="op" id="6221840">:=</span>&nbsp;<span class="num" id="6221843">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6221846">if</span>&nbsp;<span class="ident" id="6221849">r</span>&nbsp;<span class="op" id="6221851">!=</span>&nbsp;<span class="ident" id="6221854">nil</span>&nbsp;<span class="op" id="6221858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6221862">n</span>&nbsp;<span class="op" id="6221864">=</span>&nbsp;<span class="num" id="6221866">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6221870">for</span>&nbsp;<span class="ident" id="6221874">p</span>&nbsp;<span class="op" id="6221876">:=</span>&nbsp;<span class="ident" id="6221879">r</span><span class="op" id="6221880">.</span><span class="ident" id="6221881">Next</span><span class="op" id="6221885">(</span><span class="op" id="6221886">)</span><span class="op" id="6221887">;</span>&nbsp;<span class="ident" id="6221889">p</span>&nbsp;<span class="op" id="6221891">!=</span>&nbsp;<span class="ident" id="6221894">r</span><span class="op" id="6221895">;</span>&nbsp;<span class="ident" id="6221897">p</span>&nbsp;<span class="op" id="6221899">=</span>&nbsp;<span class="ident" id="6221901">p</span><span class="op" id="6221902">.</span><span class="ident" id="6221903">next</span>&nbsp;<span class="op" id="6221908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6221913">n</span><span class="op" id="6221914">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6221919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6221922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6221925">return</span>&nbsp;<span class="ident" id="6221932">n</span><br>
<span class="lineno">130</span><span class="op" id="6221934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6221937">//&nbsp;Do&nbsp;calls&nbsp;function&nbsp;f&nbsp;on&nbsp;each&nbsp;element&nbsp;of&nbsp;the&nbsp;ring,&nbsp;in&nbsp;forward&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="6222007">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Do&nbsp;is&nbsp;undefined&nbsp;if&nbsp;f&nbsp;changes&nbsp;*r.</span><br>
<span class="lineno"></span><span class="keyword" id="6222059">func</span>&nbsp;<span class="op" id="6222064">(</span><span class="ident" id="6222065">r</span>&nbsp;<span class="op" id="6222067">*</span><span class="ident" id="6222068">Ring</span><span class="op" id="6222072">)</span>&nbsp;<span class="ident" id="6222074">Do</span><span class="op" id="6222076">(</span><span class="ident" id="6222077">f</span>&nbsp;<span class="keyword" id="6222079">func</span><span class="op" id="6222083">(</span><span class="keyword" id="6222084">interface</span><span class="op" id="6222093">{</span><span class="op" id="6222094">}</span><span class="op" id="6222095">)</span><span class="op" id="6222096">)</span>&nbsp;<span class="op" id="6222098">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6222101">if</span>&nbsp;<span class="ident" id="6222104">r</span>&nbsp;<span class="op" id="6222106">!=</span>&nbsp;<span class="ident" id="6222109">nil</span>&nbsp;<span class="op" id="6222113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6222117">f</span><span class="op" id="6222118">(</span><span class="ident" id="6222119">r</span><span class="op" id="6222120">.</span><span class="ident" id="6222121">Value</span><span class="op" id="6222126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6222130">for</span>&nbsp;<span class="ident" id="6222134">p</span>&nbsp;<span class="op" id="6222136">:=</span>&nbsp;<span class="ident" id="6222139">r</span><span class="op" id="6222140">.</span><span class="ident" id="6222141">Next</span><span class="op" id="6222145">(</span><span class="op" id="6222146">)</span><span class="op" id="6222147">;</span>&nbsp;<span class="ident" id="6222149">p</span>&nbsp;<span class="op" id="6222151">!=</span>&nbsp;<span class="ident" id="6222154">r</span><span class="op" id="6222155">;</span>&nbsp;<span class="ident" id="6222157">p</span>&nbsp;<span class="op" id="6222159">=</span>&nbsp;<span class="ident" id="6222161">p</span><span class="op" id="6222162">.</span><span class="ident" id="6222163">next</span>&nbsp;<span class="op" id="6222168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6222173">f</span><span class="op" id="6222174">(</span><span class="ident" id="6222175">p</span><span class="op" id="6222176">.</span><span class="ident" id="6222177">Value</span><span class="op" id="6222182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6222186">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6222189">}</span><br>
<span class="lineno"></span><span class="op" id="6222191">}</span>
</div>
</body>
</html>
