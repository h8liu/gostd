<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/ast</h2>
<ul>
<li><a href="/gostd/go/ast/ast.go.html">ast.go</a></li>
<li><a href="/gostd/go/ast/ast_test.go.html">ast_test.go</a></li>
<li><a href="/gostd/go/ast/commentmap.go.html" class="current">commentmap.go</a></li>
<li><a href="/gostd/go/ast/commentmap_test.go.html">commentmap_test.go</a></li>
<li><a href="/gostd/go/ast/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/ast/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/ast/filter_test.go.html">filter_test.go</a></li>
<li><a href="/gostd/go/ast/import.go.html">import.go</a></li>
<li><a href="/gostd/go/ast/print.go.html">print.go</a></li>
<li><a href="/gostd/go/ast/print_test.go.html">print_test.go</a></li>
<li><a href="/gostd/go/ast/resolve.go.html">resolve.go</a></li>
<li><a href="/gostd/go/ast/scope.go.html">scope.go</a></li>
<li><a href="/gostd/go/ast/walk.go.html">walk.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3825005">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3825060">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3825114">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3825165">package</span>&nbsp;<span class="ident" id="3825173">ast</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3825178">import</span>&nbsp;<span class="op" id="3825185">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3825188">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3825197">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3825204">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3825216">&#34;sort&#34;</span><br>
<span class="lineno"></span><span class="op" id="3825223">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3825226">type</span>&nbsp;<span class="ident" id="3825231">byPos</span>&nbsp;<span class="op" id="3825237">[</span><span class="op" id="3825238">]</span><span class="op" id="3825239">*</span><span class="ident" id="3825240"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3825254">func</span>&nbsp;<span class="op" id="3825259">(</span><span class="ident" id="3825260">a</span>&nbsp;<span class="ident" id="3825262"><a href="/gostd/go/ast/commentmap.go.html#3825231">byPos</a></span><span class="op" id="3825267">)</span>&nbsp;<span class="ident" id="3825269">Len</span><span class="op" id="3825272">(</span><span class="op" id="3825273">)</span>&nbsp;<span class="builtintype" id="3825275">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3825289">{</span>&nbsp;<span class="keyword" id="3825291">return</span>&nbsp;<span class="builtinfunc" id="3825298">len</span><span class="op" id="3825301">(</span><span class="ident" id="3825302"><a href="/gostd/go/ast/commentmap.go.html#3825260">a</a></span><span class="op" id="3825303">)</span>&nbsp;<span class="op" id="3825305">}</span><br>
<span class="lineno"></span><span class="keyword" id="3825307">func</span>&nbsp;<span class="op" id="3825312">(</span><span class="ident" id="3825313">a</span>&nbsp;<span class="ident" id="3825315"><a href="/gostd/go/ast/commentmap.go.html#3825231">byPos</a></span><span class="op" id="3825320">)</span>&nbsp;<span class="ident" id="3825322">Less</span><span class="op" id="3825326">(</span><span class="ident" id="3825327">i</span><span class="op" id="3825328">,</span>&nbsp;<span class="ident" id="3825330">j</span>&nbsp;<span class="builtintype" id="3825332">int</span><span class="op" id="3825335">)</span>&nbsp;<span class="builtintype" id="3825337">bool</span>&nbsp;<span class="op" id="3825342">{</span>&nbsp;<span class="keyword" id="3825344">return</span>&nbsp;<span class="ident" id="3825351"><a href="/gostd/go/ast/commentmap.go.html#3825313">a</a></span><span class="op" id="3825352">[</span><span class="ident" id="3825353"><a href="/gostd/go/ast/commentmap.go.html#3825327">i</a></span><span class="op" id="3825354">]</span><span class="op" id="3825355">.</span><span class="ident" id="3825356"><a href="/gostd/go/ast/ast.go.html#3796116">Pos</a></span><span class="op" id="3825359">(</span><span class="op" id="3825360">)</span>&nbsp;<span class="op" id="3825362">&lt;</span>&nbsp;<span class="ident" id="3825364"><a href="/gostd/go/ast/commentmap.go.html#3825313">a</a></span><span class="op" id="3825365">[</span><span class="ident" id="3825366"><a href="/gostd/go/ast/commentmap.go.html#3825330">j</a></span><span class="op" id="3825367">]</span><span class="op" id="3825368">.</span><span class="ident" id="3825369"><a href="/gostd/go/ast/ast.go.html#3796116">Pos</a></span><span class="op" id="3825372">(</span><span class="op" id="3825373">)</span>&nbsp;<span class="op" id="3825375">}</span><br>
<span class="lineno"></span><span class="keyword" id="3825377">func</span>&nbsp;<span class="op" id="3825382">(</span><span class="ident" id="3825383">a</span>&nbsp;<span class="ident" id="3825385"><a href="/gostd/go/ast/commentmap.go.html#3825231">byPos</a></span><span class="op" id="3825390">)</span>&nbsp;<span class="ident" id="3825392">Swap</span><span class="op" id="3825396">(</span><span class="ident" id="3825397">i</span><span class="op" id="3825398">,</span>&nbsp;<span class="ident" id="3825400">j</span>&nbsp;<span class="builtintype" id="3825402">int</span><span class="op" id="3825405">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3825412">{</span>&nbsp;<span class="ident" id="3825414"><a href="/gostd/go/ast/commentmap.go.html#3825383">a</a></span><span class="op" id="3825415">[</span><span class="ident" id="3825416"><a href="/gostd/go/ast/commentmap.go.html#3825397">i</a></span><span class="op" id="3825417">]</span><span class="op" id="3825418">,</span>&nbsp;<span class="ident" id="3825420"><a href="/gostd/go/ast/commentmap.go.html#3825383">a</a></span><span class="op" id="3825421">[</span><span class="ident" id="3825422"><a href="/gostd/go/ast/commentmap.go.html#3825400">j</a></span><span class="op" id="3825423">]</span>&nbsp;<span class="op" id="3825425">=</span>&nbsp;<span class="ident" id="3825427"><a href="/gostd/go/ast/commentmap.go.html#3825383">a</a></span><span class="op" id="3825428">[</span><span class="ident" id="3825429"><a href="/gostd/go/ast/commentmap.go.html#3825400">j</a></span><span class="op" id="3825430">]</span><span class="op" id="3825431">,</span>&nbsp;<span class="ident" id="3825433"><a href="/gostd/go/ast/commentmap.go.html#3825383">a</a></span><span class="op" id="3825434">[</span><span class="ident" id="3825435"><a href="/gostd/go/ast/commentmap.go.html#3825397">i</a></span><span class="op" id="3825436">]</span>&nbsp;<span class="op" id="3825438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3825441">//&nbsp;sortComments&nbsp;sorts&nbsp;the&nbsp;list&nbsp;of&nbsp;comment&nbsp;groups&nbsp;in&nbsp;source&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="3825507">//</span><br>
<span class="lineno"></span><span class="keyword" id="3825510">func</span>&nbsp;<span class="ident" id="3825515">sortComments</span><span class="op" id="3825527">(</span><span class="ident" id="3825528">list</span>&nbsp;<span class="op" id="3825533">[</span><span class="op" id="3825534">]</span><span class="op" id="3825535">*</span><span class="ident" id="3825536"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span><span class="op" id="3825548">)</span>&nbsp;<span class="op" id="3825550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3825553">//&nbsp;TODO(gri):&nbsp;Does&nbsp;it&nbsp;make&nbsp;sense&nbsp;to&nbsp;check&nbsp;for&nbsp;sorted-ness</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3825612">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first&nbsp;(because&nbsp;we&nbsp;know&nbsp;that&nbsp;sorted-ness&nbsp;is</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3825670">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;very&nbsp;likely)?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3825699">if</span>&nbsp;<span class="ident" id="3825702">orderedList</span>&nbsp;<span class="op" id="3825714">:=</span>&nbsp;<span class="ident" id="3825717"><a href="/gostd/go/ast/commentmap.go.html#3825231">byPos</a></span><span class="op" id="3825722">(</span><span class="ident" id="3825723"><a href="/gostd/go/ast/commentmap.go.html#3825528">list</a></span><span class="op" id="3825727">)</span><span class="op" id="3825728">;</span>&nbsp;<span class="op" id="3825730">!</span><span class="ident" id="3825731"><a href="/gostd/go/ast/commentmap.go.html#3825216">sort</a></span><span class="op" id="3825735">.</span><span class="ident" id="3825736"><a href="/gostd/sort/sort.go.html#2016046">IsSorted</a></span><span class="op" id="3825744">(</span><span class="ident" id="3825745"><a href="/gostd/go/ast/commentmap.go.html#3825702">orderedList</a></span><span class="op" id="3825756">)</span>&nbsp;<span class="op" id="3825758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3825762"><a href="/gostd/go/ast/commentmap.go.html#3825216">sort</a></span><span class="op" id="3825766">.</span><span class="ident" id="3825767"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="3825771">(</span><span class="ident" id="3825772"><a href="/gostd/go/ast/commentmap.go.html#3825702">orderedList</a></span><span class="op" id="3825783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3825786">}</span><br>
<span class="lineno"></span><span class="op" id="3825788">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3825791">//&nbsp;A&nbsp;CommentMap&nbsp;maps&nbsp;an&nbsp;AST&nbsp;node&nbsp;to&nbsp;a&nbsp;list&nbsp;of&nbsp;comment&nbsp;groups</span><br>
<span class="lineno"></span><span class="comment" id="3825852">//&nbsp;associated&nbsp;with&nbsp;it.&nbsp;See&nbsp;NewCommentMap&nbsp;for&nbsp;a&nbsp;description&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3825914">//&nbsp;the&nbsp;association.</span><br>
<span class="lineno"></span><span class="comment" id="3825934">//</span><br>
<span class="lineno">35</span><span class="keyword" id="3825937">type</span>&nbsp;<span class="ident" id="3825942">CommentMap</span>&nbsp;<span class="keyword" id="3825953">map</span><span class="op" id="3825956">[</span><span class="ident" id="3825957"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><span class="op" id="3825961">]</span><span class="op" id="3825962">[</span><span class="op" id="3825963">]</span><span class="op" id="3825964">*</span><span class="ident" id="3825965"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3825979">func</span>&nbsp;<span class="op" id="3825984">(</span><span class="ident" id="3825985">cmap</span>&nbsp;<span class="ident" id="3825990"><a href="/gostd/go/ast/commentmap.go.html#3825942">CommentMap</a></span><span class="op" id="3826000">)</span>&nbsp;<span class="ident" id="3826002">addComment</span><span class="op" id="3826012">(</span><span class="ident" id="3826013">n</span>&nbsp;<span class="ident" id="3826015"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><span class="op" id="3826019">,</span>&nbsp;<span class="ident" id="3826021">c</span>&nbsp;<span class="op" id="3826023">*</span><span class="ident" id="3826024"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span><span class="op" id="3826036">)</span>&nbsp;<span class="op" id="3826038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3826041">list</span>&nbsp;<span class="op" id="3826046">:=</span>&nbsp;<span class="ident" id="3826049"><a href="/gostd/go/ast/commentmap.go.html#3825985">cmap</a></span><span class="op" id="3826053">[</span><span class="ident" id="3826054"><a href="/gostd/go/ast/commentmap.go.html#3826013">n</a></span><span class="op" id="3826055">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3826058">if</span>&nbsp;<span class="builtinfunc" id="3826061">len</span><span class="op" id="3826064">(</span><span class="ident" id="3826065"><a href="/gostd/go/ast/commentmap.go.html#3826041">list</a></span><span class="op" id="3826069">)</span>&nbsp;<span class="op" id="3826071">==</span>&nbsp;<span class="num" id="3826074">0</span>&nbsp;<span class="op" id="3826076">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3826080"><a href="/gostd/go/ast/commentmap.go.html#3826041">list</a></span>&nbsp;<span class="op" id="3826085">=</span>&nbsp;<span class="op" id="3826087">[</span><span class="op" id="3826088">]</span><span class="op" id="3826089">*</span><span class="ident" id="3826090"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span><span class="op" id="3826102">{</span><span class="ident" id="3826103"><a href="/gostd/go/ast/commentmap.go.html#3826021">c</a></span><span class="op" id="3826104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3826107">}</span>&nbsp;<span class="keyword" id="3826109">else</span>&nbsp;<span class="op" id="3826114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3826118"><a href="/gostd/go/ast/commentmap.go.html#3826041">list</a></span>&nbsp;<span class="op" id="3826123">=</span>&nbsp;<span class="builtinfunc" id="3826125">append</span><span class="op" id="3826131">(</span><span class="ident" id="3826132"><a href="/gostd/go/ast/commentmap.go.html#3826041">list</a></span><span class="op" id="3826136">,</span>&nbsp;<span class="ident" id="3826138"><a href="/gostd/go/ast/commentmap.go.html#3826021">c</a></span><span class="op" id="3826139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3826142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3826145"><a href="/gostd/go/ast/commentmap.go.html#3825985">cmap</a></span><span class="op" id="3826149">[</span><span class="ident" id="3826150"><a href="/gostd/go/ast/commentmap.go.html#3826013">n</a></span><span class="op" id="3826151">]</span>&nbsp;<span class="op" id="3826153">=</span>&nbsp;<span class="ident" id="3826155"><a href="/gostd/go/ast/commentmap.go.html#3826041">list</a></span><br>
<span class="lineno">45</span><span class="op" id="3826160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3826163">type</span>&nbsp;<span class="ident" id="3826168">byInterval</span>&nbsp;<span class="op" id="3826179">[</span><span class="op" id="3826180">]</span><span class="ident" id="3826181"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3826187">func</span>&nbsp;<span class="op" id="3826192">(</span><span class="ident" id="3826193">a</span>&nbsp;<span class="ident" id="3826195"><a href="/gostd/go/ast/commentmap.go.html#3826168">byInterval</a></span><span class="op" id="3826205">)</span>&nbsp;<span class="ident" id="3826207">Len</span><span class="op" id="3826210">(</span><span class="op" id="3826211">)</span>&nbsp;<span class="builtintype" id="3826213">int</span>&nbsp;<span class="op" id="3826217">{</span>&nbsp;<span class="keyword" id="3826219">return</span>&nbsp;<span class="builtinfunc" id="3826226">len</span><span class="op" id="3826229">(</span><span class="ident" id="3826230"><a href="/gostd/go/ast/commentmap.go.html#3826193">a</a></span><span class="op" id="3826231">)</span>&nbsp;<span class="op" id="3826233">}</span><br>
<span class="lineno">50</span><span class="keyword" id="3826235">func</span>&nbsp;<span class="op" id="3826240">(</span><span class="ident" id="3826241">a</span>&nbsp;<span class="ident" id="3826243"><a href="/gostd/go/ast/commentmap.go.html#3826168">byInterval</a></span><span class="op" id="3826253">)</span>&nbsp;<span class="ident" id="3826255">Less</span><span class="op" id="3826259">(</span><span class="ident" id="3826260">i</span><span class="op" id="3826261">,</span>&nbsp;<span class="ident" id="3826263">j</span>&nbsp;<span class="builtintype" id="3826265">int</span><span class="op" id="3826268">)</span>&nbsp;<span class="builtintype" id="3826270">bool</span>&nbsp;<span class="op" id="3826275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3826278">pi</span><span class="op" id="3826280">,</span>&nbsp;<span class="ident" id="3826282">pj</span>&nbsp;<span class="op" id="3826285">:=</span>&nbsp;<span class="ident" id="3826288"><a href="/gostd/go/ast/commentmap.go.html#3826241">a</a></span><span class="op" id="3826289">[</span><span class="ident" id="3826290"><a href="/gostd/go/ast/commentmap.go.html#3826260">i</a></span><span class="op" id="3826291">]</span><span class="op" id="3826292">.</span><span class="ident" id="3826293"><a href="/gostd/go/ast/ast.go.html#3795032">Pos</a></span><span class="op" id="3826296">(</span><span class="op" id="3826297">)</span><span class="op" id="3826298">,</span>&nbsp;<span class="ident" id="3826300"><a href="/gostd/go/ast/commentmap.go.html#3826241">a</a></span><span class="op" id="3826301">[</span><span class="ident" id="3826302"><a href="/gostd/go/ast/commentmap.go.html#3826263">j</a></span><span class="op" id="3826303">]</span><span class="op" id="3826304">.</span><span class="ident" id="3826305"><a href="/gostd/go/ast/ast.go.html#3795032">Pos</a></span><span class="op" id="3826308">(</span><span class="op" id="3826309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3826312">return</span>&nbsp;<span class="ident" id="3826319"><a href="/gostd/go/ast/commentmap.go.html#3826278">pi</a></span>&nbsp;<span class="op" id="3826322">&lt;</span>&nbsp;<span class="ident" id="3826324"><a href="/gostd/go/ast/commentmap.go.html#3826282">pj</a></span>&nbsp;<span class="op" id="3826327">||</span>&nbsp;<span class="ident" id="3826330"><a href="/gostd/go/ast/commentmap.go.html#3826278">pi</a></span>&nbsp;<span class="op" id="3826333">==</span>&nbsp;<span class="ident" id="3826336"><a href="/gostd/go/ast/commentmap.go.html#3826282">pj</a></span>&nbsp;<span class="op" id="3826339">&amp;&amp;</span>&nbsp;<span class="ident" id="3826342"><a href="/gostd/go/ast/commentmap.go.html#3826241">a</a></span><span class="op" id="3826343">[</span><span class="ident" id="3826344"><a href="/gostd/go/ast/commentmap.go.html#3826260">i</a></span><span class="op" id="3826345">]</span><span class="op" id="3826346">.</span><span class="ident" id="3826347"><a href="/gostd/go/ast/ast.go.html#3795102">End</a></span><span class="op" id="3826350">(</span><span class="op" id="3826351">)</span>&nbsp;<span class="op" id="3826353">&gt;</span>&nbsp;<span class="ident" id="3826355"><a href="/gostd/go/ast/commentmap.go.html#3826241">a</a></span><span class="op" id="3826356">[</span><span class="ident" id="3826357"><a href="/gostd/go/ast/commentmap.go.html#3826263">j</a></span><span class="op" id="3826358">]</span><span class="op" id="3826359">.</span><span class="ident" id="3826360"><a href="/gostd/go/ast/ast.go.html#3795102">End</a></span><span class="op" id="3826363">(</span><span class="op" id="3826364">)</span><br>
<span class="lineno"></span><span class="op" id="3826366">}</span><br>
<span class="lineno"></span><span class="keyword" id="3826368">func</span>&nbsp;<span class="op" id="3826373">(</span><span class="ident" id="3826374">a</span>&nbsp;<span class="ident" id="3826376"><a href="/gostd/go/ast/commentmap.go.html#3826168">byInterval</a></span><span class="op" id="3826386">)</span>&nbsp;<span class="ident" id="3826388">Swap</span><span class="op" id="3826392">(</span><span class="ident" id="3826393">i</span><span class="op" id="3826394">,</span>&nbsp;<span class="ident" id="3826396">j</span>&nbsp;<span class="builtintype" id="3826398">int</span><span class="op" id="3826401">)</span>&nbsp;<span class="op" id="3826403">{</span>&nbsp;<span class="ident" id="3826405"><a href="/gostd/go/ast/commentmap.go.html#3826374">a</a></span><span class="op" id="3826406">[</span><span class="ident" id="3826407"><a href="/gostd/go/ast/commentmap.go.html#3826393">i</a></span><span class="op" id="3826408">]</span><span class="op" id="3826409">,</span>&nbsp;<span class="ident" id="3826411"><a href="/gostd/go/ast/commentmap.go.html#3826374">a</a></span><span class="op" id="3826412">[</span><span class="ident" id="3826413"><a href="/gostd/go/ast/commentmap.go.html#3826396">j</a></span><span class="op" id="3826414">]</span>&nbsp;<span class="op" id="3826416">=</span>&nbsp;<span class="ident" id="3826418"><a href="/gostd/go/ast/commentmap.go.html#3826374">a</a></span><span class="op" id="3826419">[</span><span class="ident" id="3826420"><a href="/gostd/go/ast/commentmap.go.html#3826396">j</a></span><span class="op" id="3826421">]</span><span class="op" id="3826422">,</span>&nbsp;<span class="ident" id="3826424"><a href="/gostd/go/ast/commentmap.go.html#3826374">a</a></span><span class="op" id="3826425">[</span><span class="ident" id="3826426"><a href="/gostd/go/ast/commentmap.go.html#3826393">i</a></span><span class="op" id="3826427">]</span>&nbsp;<span class="op" id="3826429">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="3826432">//&nbsp;nodeList&nbsp;returns&nbsp;the&nbsp;list&nbsp;of&nbsp;nodes&nbsp;of&nbsp;the&nbsp;AST&nbsp;n&nbsp;in&nbsp;source&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="3826500">//</span><br>
<span class="lineno"></span><span class="keyword" id="3826503">func</span>&nbsp;<span class="ident" id="3826508">nodeList</span><span class="op" id="3826516">(</span><span class="ident" id="3826517">n</span>&nbsp;<span class="ident" id="3826519"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><span class="op" id="3826523">)</span>&nbsp;<span class="op" id="3826525">[</span><span class="op" id="3826526">]</span><span class="ident" id="3826527"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span>&nbsp;<span class="op" id="3826532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3826535">var</span>&nbsp;<span class="ident" id="3826539">list</span>&nbsp;<span class="op" id="3826544">[</span><span class="op" id="3826545">]</span><span class="ident" id="3826546"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3826552"><a href="/gostd/go/ast/walk.go.html#3873431">Inspect</a></span><span class="op" id="3826559">(</span><span class="ident" id="3826560"><a href="/gostd/go/ast/commentmap.go.html#3826517">n</a></span><span class="op" id="3826561">,</span>&nbsp;<span class="keyword" id="3826563">func</span><span class="op" id="3826567">(</span><span class="ident" id="3826568">n</span>&nbsp;<span class="ident" id="3826570"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><span class="op" id="3826574">)</span>&nbsp;<span class="builtintype" id="3826576">bool</span>&nbsp;<span class="op" id="3826581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3826585">//&nbsp;don&#39;t&nbsp;collect&nbsp;comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3826613">switch</span>&nbsp;<span class="ident" id="3826620"><a href="/gostd/go/ast/commentmap.go.html#3826568">n</a></span><span class="op" id="3826621">.</span><span class="op" id="3826622">(</span><span class="keyword" id="3826623">type</span><span class="op" id="3826627">)</span>&nbsp;<span class="op" id="3826629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3826633">case</span>&nbsp;<span class="builtintype" id="3826638">nil</span><span class="op" id="3826641">,</span>&nbsp;<span class="op" id="3826643">*</span><span class="ident" id="3826644"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span><span class="op" id="3826656">,</span>&nbsp;<span class="op" id="3826658">*</span><span class="ident" id="3826659"><a href="/gostd/go/ast/ast.go.html#3795636">Comment</a></span><span class="op" id="3826666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3826671">return</span>&nbsp;<span class="builtintype" id="3826678">false</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3826686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3826690"><a href="/gostd/go/ast/commentmap.go.html#3826539">list</a></span>&nbsp;<span class="op" id="3826695">=</span>&nbsp;<span class="builtinfunc" id="3826697">append</span><span class="op" id="3826703">(</span><span class="ident" id="3826704"><a href="/gostd/go/ast/commentmap.go.html#3826539">list</a></span><span class="op" id="3826708">,</span>&nbsp;<span class="ident" id="3826710"><a href="/gostd/go/ast/commentmap.go.html#3826568">n</a></span><span class="op" id="3826711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3826715">return</span>&nbsp;<span class="builtintype" id="3826722">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3826728">}</span><span class="op" id="3826729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3826732">//&nbsp;Note:&nbsp;The&nbsp;current&nbsp;implementation&nbsp;assumes&nbsp;that&nbsp;Inspect&nbsp;traverses&nbsp;the</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3826804">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AST&nbsp;in&nbsp;depth-first&nbsp;and&nbsp;thus&nbsp;_source_&nbsp;order.&nbsp;If&nbsp;AST&nbsp;traversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3826875">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;does&nbsp;not&nbsp;follow&nbsp;source&nbsp;order,&nbsp;the&nbsp;sorting&nbsp;call&nbsp;below&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3826946">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3826966">//&nbsp;sort.Sort(byInterval(list))</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3826998">return</span>&nbsp;<span class="ident" id="3827005"><a href="/gostd/go/ast/commentmap.go.html#3826539">list</a></span><br>
<span class="lineno">75</span><span class="op" id="3827010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3827013">//&nbsp;A&nbsp;commentListReader&nbsp;helps&nbsp;iterating&nbsp;through&nbsp;a&nbsp;list&nbsp;of&nbsp;comment&nbsp;groups.</span><br>
<span class="lineno"></span><span class="comment" id="3827086">//</span><br>
<span class="lineno"></span><span class="keyword" id="3827089">type</span>&nbsp;<span class="ident" id="3827094">commentListReader</span>&nbsp;<span class="keyword" id="3827112">struct</span>&nbsp;<span class="op" id="3827119">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3827122">fset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3827131">*</span><span class="ident" id="3827132"><a href="/gostd/go/ast/commentmap.go.html#3825204">token</a></span><span class="op" id="3827137">.</span><span class="ident" id="3827138"><a href="/gostd/go/token/position.go.html#3883366">FileSet</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3827147">list</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3827156">[</span><span class="op" id="3827157">]</span><span class="op" id="3827158">*</span><span class="ident" id="3827159"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3827173">index</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3827182">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3827187">comment</span>&nbsp;&nbsp;<span class="op" id="3827196">*</span><span class="ident" id="3827197"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span>&nbsp;&nbsp;<span class="comment" id="3827211">//&nbsp;comment&nbsp;group&nbsp;at&nbsp;current&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3827246">pos</span><span class="op" id="3827249">,</span>&nbsp;<span class="ident" id="3827251">end</span>&nbsp;<span class="ident" id="3827255"><a href="/gostd/go/ast/commentmap.go.html#3825204">token</a></span><span class="op" id="3827260">.</span><span class="ident" id="3827261"><a href="/gostd/go/token/position.go.html#3873964">Position</a></span>&nbsp;<span class="comment" id="3827270">//&nbsp;source&nbsp;interval&nbsp;of&nbsp;comment&nbsp;group&nbsp;at&nbsp;current&nbsp;index</span><br>
<span class="lineno">85</span><span class="op" id="3827323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3827326">func</span>&nbsp;<span class="op" id="3827331">(</span><span class="ident" id="3827332">r</span>&nbsp;<span class="op" id="3827334">*</span><span class="ident" id="3827335"><a href="/gostd/go/ast/commentmap.go.html#3827094">commentListReader</a></span><span class="op" id="3827352">)</span>&nbsp;<span class="ident" id="3827354">eol</span><span class="op" id="3827357">(</span><span class="op" id="3827358">)</span>&nbsp;<span class="builtintype" id="3827360">bool</span>&nbsp;<span class="op" id="3827365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3827368">return</span>&nbsp;<span class="ident" id="3827375"><a href="/gostd/go/ast/commentmap.go.html#3827332">r</a></span><span class="op" id="3827376">.</span><span class="ident" id="3827377"><a href="/gostd/go/ast/commentmap.go.html#3827173">index</a></span>&nbsp;<span class="op" id="3827383">&gt;=</span>&nbsp;<span class="builtinfunc" id="3827386">len</span><span class="op" id="3827389">(</span><span class="ident" id="3827390"><a href="/gostd/go/ast/commentmap.go.html#3827332">r</a></span><span class="op" id="3827391">.</span><span class="ident" id="3827392"><a href="/gostd/go/ast/commentmap.go.html#3827147">list</a></span><span class="op" id="3827396">)</span><br>
<span class="lineno"></span><span class="op" id="3827398">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="3827401">func</span>&nbsp;<span class="op" id="3827406">(</span><span class="ident" id="3827407">r</span>&nbsp;<span class="op" id="3827409">*</span><span class="ident" id="3827410"><a href="/gostd/go/ast/commentmap.go.html#3827094">commentListReader</a></span><span class="op" id="3827427">)</span>&nbsp;<span class="ident" id="3827429">next</span><span class="op" id="3827433">(</span><span class="op" id="3827434">)</span>&nbsp;<span class="op" id="3827436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3827439">if</span>&nbsp;<span class="op" id="3827442">!</span><span class="ident" id="3827443"><a href="/gostd/go/ast/commentmap.go.html#3827407">r</a></span><span class="op" id="3827444">.</span><span class="ident" id="3827445"><a href="/gostd/go/ast/commentmap.go.html#3827354">eol</a></span><span class="op" id="3827448">(</span><span class="op" id="3827449">)</span>&nbsp;<span class="op" id="3827451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3827455"><a href="/gostd/go/ast/commentmap.go.html#3827407">r</a></span><span class="op" id="3827456">.</span><span class="ident" id="3827457"><a href="/gostd/go/ast/commentmap.go.html#3827187">comment</a></span>&nbsp;<span class="op" id="3827465">=</span>&nbsp;<span class="ident" id="3827467"><a href="/gostd/go/ast/commentmap.go.html#3827407">r</a></span><span class="op" id="3827468">.</span><span class="ident" id="3827469"><a href="/gostd/go/ast/commentmap.go.html#3827147">list</a></span><span class="op" id="3827473">[</span><span class="ident" id="3827474"><a href="/gostd/go/ast/commentmap.go.html#3827407">r</a></span><span class="op" id="3827475">.</span><span class="ident" id="3827476"><a href="/gostd/go/ast/commentmap.go.html#3827173">index</a></span><span class="op" id="3827481">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3827485"><a href="/gostd/go/ast/commentmap.go.html#3827407">r</a></span><span class="op" id="3827486">.</span><span class="ident" id="3827487"><a href="/gostd/go/ast/commentmap.go.html#3827246">pos</a></span>&nbsp;<span class="op" id="3827491">=</span>&nbsp;<span class="ident" id="3827493"><a href="/gostd/go/ast/commentmap.go.html#3827407">r</a></span><span class="op" id="3827494">.</span><span class="ident" id="3827495"><a href="/gostd/go/ast/commentmap.go.html#3827122">fset</a></span><span class="op" id="3827499">.</span><span class="ident" id="3827500"><a href="/gostd/go/token/position.go.html#3887071">Position</a></span><span class="op" id="3827508">(</span><span class="ident" id="3827509"><a href="/gostd/go/ast/commentmap.go.html#3827407">r</a></span><span class="op" id="3827510">.</span><span class="ident" id="3827511"><a href="/gostd/go/ast/commentmap.go.html#3827187">comment</a></span><span class="op" id="3827518">.</span><span class="ident" id="3827519"><a href="/gostd/go/ast/ast.go.html#3796116">Pos</a></span><span class="op" id="3827522">(</span><span class="op" id="3827523">)</span><span class="op" id="3827524">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3827528"><a href="/gostd/go/ast/commentmap.go.html#3827407">r</a></span><span class="op" id="3827529">.</span><span class="ident" id="3827530"><a href="/gostd/go/ast/commentmap.go.html#3827251">end</a></span>&nbsp;<span class="op" id="3827534">=</span>&nbsp;<span class="ident" id="3827536"><a href="/gostd/go/ast/commentmap.go.html#3827407">r</a></span><span class="op" id="3827537">.</span><span class="ident" id="3827538"><a href="/gostd/go/ast/commentmap.go.html#3827122">fset</a></span><span class="op" id="3827542">.</span><span class="ident" id="3827543"><a href="/gostd/go/token/position.go.html#3887071">Position</a></span><span class="op" id="3827551">(</span><span class="ident" id="3827552"><a href="/gostd/go/ast/commentmap.go.html#3827407">r</a></span><span class="op" id="3827553">.</span><span class="ident" id="3827554"><a href="/gostd/go/ast/commentmap.go.html#3827187">comment</a></span><span class="op" id="3827561">.</span><span class="ident" id="3827562"><a href="/gostd/go/ast/ast.go.html#3796182">End</a></span><span class="op" id="3827565">(</span><span class="op" id="3827566">)</span><span class="op" id="3827567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3827571"><a href="/gostd/go/ast/commentmap.go.html#3827407">r</a></span><span class="op" id="3827572">.</span><span class="ident" id="3827573"><a href="/gostd/go/ast/commentmap.go.html#3827173">index</a></span><span class="op" id="3827578">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3827582">}</span><br>
<span class="lineno"></span><span class="op" id="3827584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="3827587">//&nbsp;A&nbsp;nodeStack&nbsp;keeps&nbsp;track&nbsp;of&nbsp;nested&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="comment" id="3827631">//&nbsp;A&nbsp;node&nbsp;lower&nbsp;on&nbsp;the&nbsp;stack&nbsp;lexically&nbsp;contains&nbsp;the&nbsp;nodes&nbsp;higher&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="3827710">//</span><br>
<span class="lineno"></span><span class="keyword" id="3827713">type</span>&nbsp;<span class="ident" id="3827718">nodeStack</span>&nbsp;<span class="op" id="3827728">[</span><span class="op" id="3827729">]</span><span class="ident" id="3827730"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="3827736">//&nbsp;push&nbsp;pops&nbsp;all&nbsp;nodes&nbsp;that&nbsp;appear&nbsp;lexically&nbsp;before&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="3827790">//&nbsp;and&nbsp;then&nbsp;pushes&nbsp;n&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="3827825">//</span><br>
<span class="lineno"></span><span class="keyword" id="3827828">func</span>&nbsp;<span class="op" id="3827833">(</span><span class="ident" id="3827834">s</span>&nbsp;<span class="op" id="3827836">*</span><span class="ident" id="3827837"><a href="/gostd/go/ast/commentmap.go.html#3827718">nodeStack</a></span><span class="op" id="3827846">)</span>&nbsp;<span class="ident" id="3827848">push</span><span class="op" id="3827852">(</span><span class="ident" id="3827853">n</span>&nbsp;<span class="ident" id="3827855"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><span class="op" id="3827859">)</span>&nbsp;<span class="op" id="3827861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3827864"><a href="/gostd/go/ast/commentmap.go.html#3827834">s</a></span><span class="op" id="3827865">.</span><span class="ident" id="3827866"><a href="/gostd/go/ast/commentmap.go.html#3828078">pop</a></span><span class="op" id="3827869">(</span><span class="ident" id="3827870"><a href="/gostd/go/ast/commentmap.go.html#3827853">n</a></span><span class="op" id="3827871">.</span><span class="ident" id="3827872"><a href="/gostd/go/ast/ast.go.html#3795032">Pos</a></span><span class="op" id="3827875">(</span><span class="op" id="3827876">)</span><span class="op" id="3827877">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3827880">*</span><span class="ident" id="3827881"><a href="/gostd/go/ast/commentmap.go.html#3827834">s</a></span>&nbsp;<span class="op" id="3827883">=</span>&nbsp;<span class="builtinfunc" id="3827885">append</span><span class="op" id="3827891">(</span><span class="op" id="3827892">(</span><span class="op" id="3827893">*</span><span class="ident" id="3827894"><a href="/gostd/go/ast/commentmap.go.html#3827834">s</a></span><span class="op" id="3827895">)</span><span class="op" id="3827896">,</span>&nbsp;<span class="ident" id="3827898"><a href="/gostd/go/ast/commentmap.go.html#3827853">n</a></span><span class="op" id="3827899">)</span><br>
<span class="lineno"></span><span class="op" id="3827901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3827904">//&nbsp;pop&nbsp;pops&nbsp;all&nbsp;nodes&nbsp;that&nbsp;appear&nbsp;lexically&nbsp;before&nbsp;pos</span><br>
<span class="lineno"></span><span class="comment" id="3827959">//&nbsp;(i.e.,&nbsp;whose&nbsp;lexical&nbsp;extent&nbsp;has&nbsp;ended&nbsp;before&nbsp;or&nbsp;at&nbsp;pos).</span><br>
<span class="lineno">115</span><span class="comment" id="3828019">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;last&nbsp;node&nbsp;popped.</span><br>
<span class="lineno"></span><span class="comment" id="3828055">//</span><br>
<span class="lineno"></span><span class="keyword" id="3828058">func</span>&nbsp;<span class="op" id="3828063">(</span><span class="ident" id="3828064">s</span>&nbsp;<span class="op" id="3828066">*</span><span class="ident" id="3828067"><a href="/gostd/go/ast/commentmap.go.html#3827718">nodeStack</a></span><span class="op" id="3828076">)</span>&nbsp;<span class="ident" id="3828078">pop</span><span class="op" id="3828081">(</span><span class="ident" id="3828082">pos</span>&nbsp;<span class="ident" id="3828086"><a href="/gostd/go/ast/commentmap.go.html#3825204">token</a></span><span class="op" id="3828091">.</span><span class="ident" id="3828092"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span><span class="op" id="3828095">)</span>&nbsp;<span class="op" id="3828097">(</span><span class="ident" id="3828098">top</span>&nbsp;<span class="ident" id="3828102"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><span class="op" id="3828106">)</span>&nbsp;<span class="op" id="3828108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3828111">i</span>&nbsp;<span class="op" id="3828113">:=</span>&nbsp;<span class="builtinfunc" id="3828116">len</span><span class="op" id="3828119">(</span><span class="op" id="3828120">*</span><span class="ident" id="3828121"><a href="/gostd/go/ast/commentmap.go.html#3828064">s</a></span><span class="op" id="3828122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3828125">for</span>&nbsp;<span class="ident" id="3828129"><a href="/gostd/go/ast/commentmap.go.html#3828111">i</a></span>&nbsp;<span class="op" id="3828131">&gt;</span>&nbsp;<span class="num" id="3828133">0</span>&nbsp;<span class="op" id="3828135">&amp;&amp;</span>&nbsp;<span class="op" id="3828138">(</span><span class="op" id="3828139">*</span><span class="ident" id="3828140"><a href="/gostd/go/ast/commentmap.go.html#3828064">s</a></span><span class="op" id="3828141">)</span><span class="op" id="3828142">[</span><span class="ident" id="3828143"><a href="/gostd/go/ast/commentmap.go.html#3828111">i</a></span><span class="op" id="3828144">-</span><span class="num" id="3828145">1</span><span class="op" id="3828146">]</span><span class="op" id="3828147">.</span><span class="ident" id="3828148"><a href="/gostd/go/ast/ast.go.html#3795102">End</a></span><span class="op" id="3828151">(</span><span class="op" id="3828152">)</span>&nbsp;<span class="op" id="3828154">&lt;=</span>&nbsp;<span class="ident" id="3828157"><a href="/gostd/go/ast/commentmap.go.html#3828082">pos</a></span>&nbsp;<span class="op" id="3828161">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3828165"><a href="/gostd/go/ast/commentmap.go.html#3828098">top</a></span>&nbsp;<span class="op" id="3828169">=</span>&nbsp;<span class="op" id="3828171">(</span><span class="op" id="3828172">*</span><span class="ident" id="3828173"><a href="/gostd/go/ast/commentmap.go.html#3828064">s</a></span><span class="op" id="3828174">)</span><span class="op" id="3828175">[</span><span class="ident" id="3828176"><a href="/gostd/go/ast/commentmap.go.html#3828111">i</a></span><span class="op" id="3828177">-</span><span class="num" id="3828178">1</span><span class="op" id="3828179">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3828183"><a href="/gostd/go/ast/commentmap.go.html#3828111">i</a></span><span class="op" id="3828184">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3828188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3828191">*</span><span class="ident" id="3828192"><a href="/gostd/go/ast/commentmap.go.html#3828064">s</a></span>&nbsp;<span class="op" id="3828194">=</span>&nbsp;<span class="op" id="3828196">(</span><span class="op" id="3828197">*</span><span class="ident" id="3828198"><a href="/gostd/go/ast/commentmap.go.html#3828064">s</a></span><span class="op" id="3828199">)</span><span class="op" id="3828200">[</span><span class="num" id="3828201">0</span><span class="op" id="3828202">:</span><span class="ident" id="3828203"><a href="/gostd/go/ast/commentmap.go.html#3828111">i</a></span><span class="op" id="3828204">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3828207">return</span>&nbsp;<span class="ident" id="3828214"><a href="/gostd/go/ast/commentmap.go.html#3828098">top</a></span><br>
<span class="lineno">125</span><span class="op" id="3828218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3828221">//&nbsp;NewCommentMap&nbsp;creates&nbsp;a&nbsp;new&nbsp;comment&nbsp;map&nbsp;by&nbsp;associating&nbsp;comment&nbsp;groups</span><br>
<span class="lineno"></span><span class="comment" id="3828294">//&nbsp;of&nbsp;the&nbsp;comments&nbsp;list&nbsp;with&nbsp;the&nbsp;nodes&nbsp;of&nbsp;the&nbsp;AST&nbsp;specified&nbsp;by&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="3828363">//</span><br>
<span class="lineno">130</span><span class="comment" id="3828366">//&nbsp;A&nbsp;comment&nbsp;group&nbsp;g&nbsp;is&nbsp;associated&nbsp;with&nbsp;a&nbsp;node&nbsp;n&nbsp;if:</span><br>
<span class="lineno"></span><span class="comment" id="3828419">//</span><br>
<span class="lineno"></span><span class="comment" id="3828422">//&nbsp;&nbsp;&nbsp;-&nbsp;g&nbsp;starts&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;n&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="3828465">//&nbsp;&nbsp;&nbsp;-&nbsp;g&nbsp;starts&nbsp;on&nbsp;the&nbsp;line&nbsp;immediately&nbsp;following&nbsp;n,&nbsp;and&nbsp;there&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3828531">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at&nbsp;least&nbsp;one&nbsp;empty&nbsp;line&nbsp;after&nbsp;g&nbsp;and&nbsp;before&nbsp;the&nbsp;next&nbsp;node</span><br>
<span class="lineno">135</span><span class="comment" id="3828595">//&nbsp;&nbsp;&nbsp;-&nbsp;g&nbsp;starts&nbsp;before&nbsp;n&nbsp;and&nbsp;is&nbsp;not&nbsp;associated&nbsp;to&nbsp;the&nbsp;node&nbsp;before&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="3828663">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via&nbsp;the&nbsp;previous&nbsp;rules</span><br>
<span class="lineno"></span><span class="comment" id="3828693">//</span><br>
<span class="lineno"></span><span class="comment" id="3828696">//&nbsp;NewCommentMap&nbsp;tries&nbsp;to&nbsp;associate&nbsp;a&nbsp;comment&nbsp;group&nbsp;to&nbsp;the&nbsp;&#34;largest&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3828765">//&nbsp;node&nbsp;possible:&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;comment&nbsp;is&nbsp;a&nbsp;line&nbsp;comment</span><br>
<span class="lineno">140</span><span class="comment" id="3828830">//&nbsp;trailing&nbsp;an&nbsp;assignment,&nbsp;the&nbsp;comment&nbsp;is&nbsp;associated&nbsp;with&nbsp;the&nbsp;entire</span><br>
<span class="lineno"></span><span class="comment" id="3828899">//&nbsp;assignment&nbsp;rather&nbsp;than&nbsp;just&nbsp;the&nbsp;last&nbsp;operand&nbsp;in&nbsp;the&nbsp;assignment.</span><br>
<span class="lineno"></span><span class="comment" id="3828966">//</span><br>
<span class="lineno"></span><span class="keyword" id="3828969">func</span>&nbsp;<span class="ident" id="3828974">NewCommentMap</span><span class="op" id="3828987">(</span><span class="ident" id="3828988">fset</span>&nbsp;<span class="op" id="3828993">*</span><span class="ident" id="3828994"><a href="/gostd/go/ast/commentmap.go.html#3825204">token</a></span><span class="op" id="3828999">.</span><span class="ident" id="3829000"><a href="/gostd/go/token/position.go.html#3883366">FileSet</a></span><span class="op" id="3829007">,</span>&nbsp;<span class="ident" id="3829009">node</span>&nbsp;<span class="ident" id="3829014"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><span class="op" id="3829018">,</span>&nbsp;<span class="ident" id="3829020">comments</span>&nbsp;<span class="op" id="3829029">[</span><span class="op" id="3829030">]</span><span class="op" id="3829031">*</span><span class="ident" id="3829032"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span><span class="op" id="3829044">)</span>&nbsp;<span class="ident" id="3829046"><a href="/gostd/go/ast/commentmap.go.html#3825942">CommentMap</a></span>&nbsp;<span class="op" id="3829057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3829060">if</span>&nbsp;<span class="builtinfunc" id="3829063">len</span><span class="op" id="3829066">(</span><span class="ident" id="3829067"><a href="/gostd/go/ast/commentmap.go.html#3829020">comments</a></span><span class="op" id="3829075">)</span>&nbsp;<span class="op" id="3829077">==</span>&nbsp;<span class="num" id="3829080">0</span>&nbsp;<span class="op" id="3829082">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3829086">return</span>&nbsp;<span class="builtintype" id="3829093">nil</span>&nbsp;<span class="comment" id="3829097">//&nbsp;no&nbsp;comments&nbsp;to&nbsp;map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3829120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829124">cmap</span>&nbsp;<span class="op" id="3829129">:=</span>&nbsp;<span class="builtinfunc" id="3829132">make</span><span class="op" id="3829136">(</span><span class="ident" id="3829137"><a href="/gostd/go/ast/commentmap.go.html#3825942">CommentMap</a></span><span class="op" id="3829147">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3829151">//&nbsp;set&nbsp;up&nbsp;comment&nbsp;reader&nbsp;r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829179">tmp</span>&nbsp;<span class="op" id="3829183">:=</span>&nbsp;<span class="builtinfunc" id="3829186">make</span><span class="op" id="3829190">(</span><span class="op" id="3829191">[</span><span class="op" id="3829192">]</span><span class="op" id="3829193">*</span><span class="ident" id="3829194"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span><span class="op" id="3829206">,</span>&nbsp;<span class="builtinfunc" id="3829208">len</span><span class="op" id="3829211">(</span><span class="ident" id="3829212"><a href="/gostd/go/ast/commentmap.go.html#3829020">comments</a></span><span class="op" id="3829220">)</span><span class="op" id="3829221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3829224">copy</span><span class="op" id="3829228">(</span><span class="ident" id="3829229"><a href="/gostd/go/ast/commentmap.go.html#3829179">tmp</a></span><span class="op" id="3829232">,</span>&nbsp;<span class="ident" id="3829234"><a href="/gostd/go/ast/commentmap.go.html#3829020">comments</a></span><span class="op" id="3829242">)</span>&nbsp;<span class="comment" id="3829244">//&nbsp;don&#39;t&nbsp;change&nbsp;incoming&nbsp;comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829279"><a href="/gostd/go/ast/commentmap.go.html#3825515">sortComments</a></span><span class="op" id="3829291">(</span><span class="ident" id="3829292"><a href="/gostd/go/ast/commentmap.go.html#3829179">tmp</a></span><span class="op" id="3829295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829298">r</span>&nbsp;<span class="op" id="3829300">:=</span>&nbsp;<span class="ident" id="3829303"><a href="/gostd/go/ast/commentmap.go.html#3827094">commentListReader</a></span><span class="op" id="3829320">{</span><span class="ident" id="3829321"><a href="/gostd/go/ast/commentmap.go.html#3827122">fset</a></span><span class="op" id="3829325">:</span>&nbsp;<span class="ident" id="3829327"><a href="/gostd/go/ast/commentmap.go.html#3828988">fset</a></span><span class="op" id="3829331">,</span>&nbsp;<span class="ident" id="3829333"><a href="/gostd/go/ast/commentmap.go.html#3827147">list</a></span><span class="op" id="3829337">:</span>&nbsp;<span class="ident" id="3829339"><a href="/gostd/go/ast/commentmap.go.html#3829179">tmp</a></span><span class="op" id="3829342">}</span>&nbsp;<span class="comment" id="3829344">//&nbsp;!r.eol()&nbsp;because&nbsp;len(comments)&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829383"><a href="/gostd/go/ast/commentmap.go.html#3829298">r</a></span><span class="op" id="3829384">.</span><span class="ident" id="3829385"><a href="/gostd/go/ast/commentmap.go.html#3827429">next</a></span><span class="op" id="3829389">(</span><span class="op" id="3829390">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3829394">//&nbsp;create&nbsp;node&nbsp;list&nbsp;in&nbsp;lexical&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829432">nodes</span>&nbsp;<span class="op" id="3829438">:=</span>&nbsp;<span class="ident" id="3829441"><a href="/gostd/go/ast/commentmap.go.html#3826508">nodeList</a></span><span class="op" id="3829449">(</span><span class="ident" id="3829450"><a href="/gostd/go/ast/commentmap.go.html#3829009">node</a></span><span class="op" id="3829454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829457"><a href="/gostd/go/ast/commentmap.go.html#3829432">nodes</a></span>&nbsp;<span class="op" id="3829463">=</span>&nbsp;<span class="builtinfunc" id="3829465">append</span><span class="op" id="3829471">(</span><span class="ident" id="3829472"><a href="/gostd/go/ast/commentmap.go.html#3829432">nodes</a></span><span class="op" id="3829477">,</span>&nbsp;<span class="builtintype" id="3829479">nil</span><span class="op" id="3829482">)</span>&nbsp;<span class="comment" id="3829484">//&nbsp;append&nbsp;sentinel</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3829505">//&nbsp;set&nbsp;up&nbsp;iteration&nbsp;variables</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3829536">var</span>&nbsp;<span class="op" id="3829540">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829544">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829550"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3829565">//&nbsp;previous&nbsp;node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829584">pend</span>&nbsp;&nbsp;<span class="ident" id="3829590"><a href="/gostd/go/ast/commentmap.go.html#3825204">token</a></span><span class="op" id="3829595">.</span><span class="ident" id="3829596"><a href="/gostd/go/token/position.go.html#3873964">Position</a></span>&nbsp;<span class="comment" id="3829605">//&nbsp;end&nbsp;of&nbsp;p</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829619">pg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829625"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3829640">//&nbsp;previous&nbsp;node&nbsp;group&nbsp;(enclosing&nbsp;nodes&nbsp;of&nbsp;&#34;importance&#34;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829699">pgend</span>&nbsp;<span class="ident" id="3829705"><a href="/gostd/go/ast/commentmap.go.html#3825204">token</a></span><span class="op" id="3829710">.</span><span class="ident" id="3829711"><a href="/gostd/go/token/position.go.html#3873964">Position</a></span>&nbsp;<span class="comment" id="3829720">//&nbsp;end&nbsp;of&nbsp;pg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829735">stack</span>&nbsp;<span class="ident" id="3829741"><a href="/gostd/go/ast/commentmap.go.html#3827718">nodeStack</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3829756">//&nbsp;stack&nbsp;of&nbsp;node&nbsp;groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3829781">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3829785">for</span>&nbsp;<span class="ident" id="3829789">_</span><span class="op" id="3829790">,</span>&nbsp;<span class="ident" id="3829792">q</span>&nbsp;<span class="op" id="3829794">:=</span>&nbsp;<span class="keyword" id="3829797">range</span>&nbsp;<span class="ident" id="3829803"><a href="/gostd/go/ast/commentmap.go.html#3829432">nodes</a></span>&nbsp;<span class="op" id="3829809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3829813">var</span>&nbsp;<span class="ident" id="3829817">qpos</span>&nbsp;<span class="ident" id="3829822"><a href="/gostd/go/ast/commentmap.go.html#3825204">token</a></span><span class="op" id="3829827">.</span><span class="ident" id="3829828"><a href="/gostd/go/token/position.go.html#3873964">Position</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3829839">if</span>&nbsp;<span class="ident" id="3829842"><a href="/gostd/go/ast/commentmap.go.html#3829792">q</a></span>&nbsp;<span class="op" id="3829844">!=</span>&nbsp;<span class="builtintype" id="3829847">nil</span>&nbsp;<span class="op" id="3829851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3829856"><a href="/gostd/go/ast/commentmap.go.html#3829817">qpos</a></span>&nbsp;<span class="op" id="3829861">=</span>&nbsp;<span class="ident" id="3829863"><a href="/gostd/go/ast/commentmap.go.html#3828988">fset</a></span><span class="op" id="3829867">.</span><span class="ident" id="3829868"><a href="/gostd/go/token/position.go.html#3887071">Position</a></span><span class="op" id="3829876">(</span><span class="ident" id="3829877"><a href="/gostd/go/ast/commentmap.go.html#3829792">q</a></span><span class="op" id="3829878">.</span><span class="ident" id="3829879"><a href="/gostd/go/ast/ast.go.html#3795032">Pos</a></span><span class="op" id="3829882">(</span><span class="op" id="3829883">)</span><span class="op" id="3829884">)</span>&nbsp;<span class="comment" id="3829886">//&nbsp;current&nbsp;node&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3829913">}</span>&nbsp;<span class="keyword" id="3829915">else</span>&nbsp;<span class="op" id="3829920">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3829925">//&nbsp;set&nbsp;fake&nbsp;sentinel&nbsp;position&nbsp;to&nbsp;infinity&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3829978">//&nbsp;all&nbsp;comments&nbsp;get&nbsp;processed&nbsp;before&nbsp;the&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3830031">const</span>&nbsp;<span class="ident" id="3830037">infinity</span>&nbsp;<span class="op" id="3830046">=</span>&nbsp;<span class="num" id="3830048">1</span>&nbsp;<span class="op" id="3830050">&lt;&lt;</span>&nbsp;<span class="num" id="3830053">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3830059"><a href="/gostd/go/ast/commentmap.go.html#3829817">qpos</a></span><span class="op" id="3830063">.</span><span class="ident" id="3830064"><a href="/gostd/go/token/position.go.html#3874020">Offset</a></span>&nbsp;<span class="op" id="3830071">=</span>&nbsp;<span class="ident" id="3830073"><a href="/gostd/go/ast/commentmap.go.html#3830037">infinity</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3830085"><a href="/gostd/go/ast/commentmap.go.html#3829817">qpos</a></span><span class="op" id="3830089">.</span><span class="ident" id="3830090"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span>&nbsp;<span class="op" id="3830095">=</span>&nbsp;<span class="ident" id="3830097"><a href="/gostd/go/ast/commentmap.go.html#3830037">infinity</a></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3830108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3830113">//&nbsp;process&nbsp;comments&nbsp;before&nbsp;current&nbsp;node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3830155">for</span>&nbsp;<span class="ident" id="3830159"><a href="/gostd/go/ast/commentmap.go.html#3829298">r</a></span><span class="op" id="3830160">.</span><span class="ident" id="3830161"><a href="/gostd/go/ast/commentmap.go.html#3827251">end</a></span><span class="op" id="3830164">.</span><span class="ident" id="3830165"><a href="/gostd/go/token/position.go.html#3874020">Offset</a></span>&nbsp;<span class="op" id="3830172">&lt;=</span>&nbsp;<span class="ident" id="3830175"><a href="/gostd/go/ast/commentmap.go.html#3829817">qpos</a></span><span class="op" id="3830179">.</span><span class="ident" id="3830180"><a href="/gostd/go/token/position.go.html#3874020">Offset</a></span>&nbsp;<span class="op" id="3830187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3830192">//&nbsp;determine&nbsp;recent&nbsp;node&nbsp;group</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3830226">if</span>&nbsp;<span class="ident" id="3830229">top</span>&nbsp;<span class="op" id="3830233">:=</span>&nbsp;<span class="ident" id="3830236"><a href="/gostd/go/ast/commentmap.go.html#3829735">stack</a></span><span class="op" id="3830241">.</span><span class="ident" id="3830242"><a href="/gostd/go/ast/commentmap.go.html#3828078">pop</a></span><span class="op" id="3830245">(</span><span class="ident" id="3830246"><a href="/gostd/go/ast/commentmap.go.html#3829298">r</a></span><span class="op" id="3830247">.</span><span class="ident" id="3830248"><a href="/gostd/go/ast/commentmap.go.html#3827187">comment</a></span><span class="op" id="3830255">.</span><span class="ident" id="3830256"><a href="/gostd/go/ast/ast.go.html#3796116">Pos</a></span><span class="op" id="3830259">(</span><span class="op" id="3830260">)</span><span class="op" id="3830261">)</span><span class="op" id="3830262">;</span>&nbsp;<span class="ident" id="3830264"><a href="/gostd/go/ast/commentmap.go.html#3830229">top</a></span>&nbsp;<span class="op" id="3830268">!=</span>&nbsp;<span class="builtintype" id="3830271">nil</span>&nbsp;<span class="op" id="3830275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3830281"><a href="/gostd/go/ast/commentmap.go.html#3829619">pg</a></span>&nbsp;<span class="op" id="3830284">=</span>&nbsp;<span class="ident" id="3830286"><a href="/gostd/go/ast/commentmap.go.html#3830229">top</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3830294"><a href="/gostd/go/ast/commentmap.go.html#3829699">pgend</a></span>&nbsp;<span class="op" id="3830300">=</span>&nbsp;<span class="ident" id="3830302"><a href="/gostd/go/ast/commentmap.go.html#3828988">fset</a></span><span class="op" id="3830306">.</span><span class="ident" id="3830307"><a href="/gostd/go/token/position.go.html#3887071">Position</a></span><span class="op" id="3830315">(</span><span class="ident" id="3830316"><a href="/gostd/go/ast/commentmap.go.html#3829619">pg</a></span><span class="op" id="3830318">.</span><span class="ident" id="3830319"><a href="/gostd/go/ast/ast.go.html#3795102">End</a></span><span class="op" id="3830322">(</span><span class="op" id="3830323">)</span><span class="op" id="3830324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3830329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3830334">//&nbsp;Try&nbsp;to&nbsp;associate&nbsp;a&nbsp;comment&nbsp;first&nbsp;with&nbsp;a&nbsp;node&nbsp;group</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3830391">//&nbsp;(i.e.,&nbsp;a&nbsp;node&nbsp;of&nbsp;&#34;importance&#34;&nbsp;such&nbsp;as&nbsp;a&nbsp;declaration);</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3830451">//&nbsp;if&nbsp;that&nbsp;fails,&nbsp;try&nbsp;to&nbsp;associate&nbsp;it&nbsp;with&nbsp;the&nbsp;most&nbsp;recent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3830513">//&nbsp;node.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3830525">//&nbsp;TODO(gri)&nbsp;try&nbsp;to&nbsp;simplify&nbsp;the&nbsp;logic&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3830573">var</span>&nbsp;<span class="ident" id="3830577">assoc</span>&nbsp;<span class="ident" id="3830583"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3830591">switch</span>&nbsp;<span class="op" id="3830598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3830603">case</span>&nbsp;<span class="ident" id="3830608"><a href="/gostd/go/ast/commentmap.go.html#3829619">pg</a></span>&nbsp;<span class="op" id="3830611">!=</span>&nbsp;<span class="builtintype" id="3830614">nil</span>&nbsp;<span class="op" id="3830618">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3830625">(</span><span class="ident" id="3830626"><a href="/gostd/go/ast/commentmap.go.html#3829699">pgend</a></span><span class="op" id="3830631">.</span><span class="ident" id="3830632"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span>&nbsp;<span class="op" id="3830637">==</span>&nbsp;<span class="ident" id="3830640"><a href="/gostd/go/ast/commentmap.go.html#3829298">r</a></span><span class="op" id="3830641">.</span><span class="ident" id="3830642"><a href="/gostd/go/ast/commentmap.go.html#3827246">pos</a></span><span class="op" id="3830645">.</span><span class="ident" id="3830646"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span>&nbsp;<span class="op" id="3830651">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3830659"><a href="/gostd/go/ast/commentmap.go.html#3829699">pgend</a></span><span class="op" id="3830664">.</span><span class="ident" id="3830665"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span><span class="op" id="3830669">+</span><span class="num" id="3830670">1</span>&nbsp;<span class="op" id="3830672">==</span>&nbsp;<span class="ident" id="3830675"><a href="/gostd/go/ast/commentmap.go.html#3829298">r</a></span><span class="op" id="3830676">.</span><span class="ident" id="3830677"><a href="/gostd/go/ast/commentmap.go.html#3827246">pos</a></span><span class="op" id="3830680">.</span><span class="ident" id="3830681"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span>&nbsp;<span class="op" id="3830686">&amp;&amp;</span>&nbsp;<span class="ident" id="3830689"><a href="/gostd/go/ast/commentmap.go.html#3829298">r</a></span><span class="op" id="3830690">.</span><span class="ident" id="3830691"><a href="/gostd/go/ast/commentmap.go.html#3827251">end</a></span><span class="op" id="3830694">.</span><span class="ident" id="3830695"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span><span class="op" id="3830699">+</span><span class="num" id="3830700">1</span>&nbsp;<span class="op" id="3830702">&lt;</span>&nbsp;<span class="ident" id="3830704"><a href="/gostd/go/ast/commentmap.go.html#3829817">qpos</a></span><span class="op" id="3830708">.</span><span class="ident" id="3830709"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span><span class="op" id="3830713">)</span><span class="op" id="3830714">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3830720">//&nbsp;1)&nbsp;comment&nbsp;starts&nbsp;on&nbsp;same&nbsp;line&nbsp;as&nbsp;previous&nbsp;node&nbsp;group&nbsp;ends,&nbsp;or</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3830790">//&nbsp;2)&nbsp;comment&nbsp;starts&nbsp;on&nbsp;the&nbsp;line&nbsp;immediately&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3830849">//&nbsp;&nbsp;&nbsp;&nbsp;previous&nbsp;node&nbsp;group&nbsp;and&nbsp;there&nbsp;is&nbsp;an&nbsp;empty&nbsp;line&nbsp;before</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3830913">//&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;current&nbsp;node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3830940">//&nbsp;=&gt;&nbsp;associate&nbsp;comment&nbsp;with&nbsp;previous&nbsp;node&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3830993"><a href="/gostd/go/ast/commentmap.go.html#3830577">assoc</a></span>&nbsp;<span class="op" id="3830999">=</span>&nbsp;<span class="ident" id="3831001"><a href="/gostd/go/ast/commentmap.go.html#3829619">pg</a></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3831007">case</span>&nbsp;<span class="ident" id="3831012"><a href="/gostd/go/ast/commentmap.go.html#3829544">p</a></span>&nbsp;<span class="op" id="3831014">!=</span>&nbsp;<span class="builtintype" id="3831017">nil</span>&nbsp;<span class="op" id="3831021">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3831028">(</span><span class="ident" id="3831029"><a href="/gostd/go/ast/commentmap.go.html#3829584">pend</a></span><span class="op" id="3831033">.</span><span class="ident" id="3831034"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span>&nbsp;<span class="op" id="3831039">==</span>&nbsp;<span class="ident" id="3831042"><a href="/gostd/go/ast/commentmap.go.html#3829298">r</a></span><span class="op" id="3831043">.</span><span class="ident" id="3831044"><a href="/gostd/go/ast/commentmap.go.html#3827246">pos</a></span><span class="op" id="3831047">.</span><span class="ident" id="3831048"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span>&nbsp;<span class="op" id="3831053">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3831061"><a href="/gostd/go/ast/commentmap.go.html#3829584">pend</a></span><span class="op" id="3831065">.</span><span class="ident" id="3831066"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span><span class="op" id="3831070">+</span><span class="num" id="3831071">1</span>&nbsp;<span class="op" id="3831073">==</span>&nbsp;<span class="ident" id="3831076"><a href="/gostd/go/ast/commentmap.go.html#3829298">r</a></span><span class="op" id="3831077">.</span><span class="ident" id="3831078"><a href="/gostd/go/ast/commentmap.go.html#3827246">pos</a></span><span class="op" id="3831081">.</span><span class="ident" id="3831082"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span>&nbsp;<span class="op" id="3831087">&amp;&amp;</span>&nbsp;<span class="ident" id="3831090"><a href="/gostd/go/ast/commentmap.go.html#3829298">r</a></span><span class="op" id="3831091">.</span><span class="ident" id="3831092"><a href="/gostd/go/ast/commentmap.go.html#3827251">end</a></span><span class="op" id="3831095">.</span><span class="ident" id="3831096"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span><span class="op" id="3831100">+</span><span class="num" id="3831101">1</span>&nbsp;<span class="op" id="3831103">&lt;</span>&nbsp;<span class="ident" id="3831105"><a href="/gostd/go/ast/commentmap.go.html#3829817">qpos</a></span><span class="op" id="3831109">.</span><span class="ident" id="3831110"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span>&nbsp;<span class="op" id="3831115">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3831123"><a href="/gostd/go/ast/commentmap.go.html#3829792">q</a></span>&nbsp;<span class="op" id="3831125">==</span>&nbsp;<span class="builtintype" id="3831128">nil</span><span class="op" id="3831131">)</span><span class="op" id="3831132">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3831138">//&nbsp;same&nbsp;rules&nbsp;apply&nbsp;as&nbsp;above&nbsp;for&nbsp;p&nbsp;rather&nbsp;than&nbsp;pg,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3831193">//&nbsp;but&nbsp;also&nbsp;associate&nbsp;with&nbsp;p&nbsp;if&nbsp;we&nbsp;are&nbsp;at&nbsp;the&nbsp;end&nbsp;(q&nbsp;==&nbsp;nil)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3831258"><a href="/gostd/go/ast/commentmap.go.html#3830577">assoc</a></span>&nbsp;<span class="op" id="3831264">=</span>&nbsp;<span class="ident" id="3831266"><a href="/gostd/go/ast/commentmap.go.html#3829544">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3831271">default</span><span class="op" id="3831278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3831284">//&nbsp;otherwise,&nbsp;associate&nbsp;comment&nbsp;with&nbsp;current&nbsp;node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3831338">if</span>&nbsp;<span class="ident" id="3831341"><a href="/gostd/go/ast/commentmap.go.html#3829792">q</a></span>&nbsp;<span class="op" id="3831343">==</span>&nbsp;<span class="builtintype" id="3831346">nil</span>&nbsp;<span class="op" id="3831350">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3831357">//&nbsp;we&nbsp;can&nbsp;only&nbsp;reach&nbsp;here&nbsp;if&nbsp;there&nbsp;was&nbsp;no&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3831406">//&nbsp;which&nbsp;would&nbsp;imply&nbsp;that&nbsp;there&nbsp;were&nbsp;no&nbsp;nodes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3831457">panic</span><span class="op" id="3831462">(</span><span class="string" id="3831463">&#34;internal&nbsp;error:&nbsp;no&nbsp;comments&nbsp;should&nbsp;be&nbsp;associated&nbsp;with&nbsp;sentinel&#34;</span><span class="op" id="3831527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3831533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3831539"><a href="/gostd/go/ast/commentmap.go.html#3830577">assoc</a></span>&nbsp;<span class="op" id="3831545">=</span>&nbsp;<span class="ident" id="3831547"><a href="/gostd/go/ast/commentmap.go.html#3829792">q</a></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3831552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3831557"><a href="/gostd/go/ast/commentmap.go.html#3829124">cmap</a></span><span class="op" id="3831561">.</span><span class="ident" id="3831562"><a href="/gostd/go/ast/commentmap.go.html#3826002">addComment</a></span><span class="op" id="3831572">(</span><span class="ident" id="3831573"><a href="/gostd/go/ast/commentmap.go.html#3830577">assoc</a></span><span class="op" id="3831578">,</span>&nbsp;<span class="ident" id="3831580"><a href="/gostd/go/ast/commentmap.go.html#3829298">r</a></span><span class="op" id="3831581">.</span><span class="ident" id="3831582"><a href="/gostd/go/ast/commentmap.go.html#3827187">comment</a></span><span class="op" id="3831589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3831594">if</span>&nbsp;<span class="ident" id="3831597"><a href="/gostd/go/ast/commentmap.go.html#3829298">r</a></span><span class="op" id="3831598">.</span><span class="ident" id="3831599"><a href="/gostd/go/ast/commentmap.go.html#3827354">eol</a></span><span class="op" id="3831602">(</span><span class="op" id="3831603">)</span>&nbsp;<span class="op" id="3831605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3831611">return</span>&nbsp;<span class="ident" id="3831618"><a href="/gostd/go/ast/commentmap.go.html#3829124">cmap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3831626">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3831631"><a href="/gostd/go/ast/commentmap.go.html#3829298">r</a></span><span class="op" id="3831632">.</span><span class="ident" id="3831633"><a href="/gostd/go/ast/commentmap.go.html#3827429">next</a></span><span class="op" id="3831637">(</span><span class="op" id="3831638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3831642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3831647">//&nbsp;update&nbsp;previous&nbsp;node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3831673"><a href="/gostd/go/ast/commentmap.go.html#3829544">p</a></span>&nbsp;<span class="op" id="3831675">=</span>&nbsp;<span class="ident" id="3831677"><a href="/gostd/go/ast/commentmap.go.html#3829792">q</a></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3831681"><a href="/gostd/go/ast/commentmap.go.html#3829584">pend</a></span>&nbsp;<span class="op" id="3831686">=</span>&nbsp;<span class="ident" id="3831688"><a href="/gostd/go/ast/commentmap.go.html#3828988">fset</a></span><span class="op" id="3831692">.</span><span class="ident" id="3831693"><a href="/gostd/go/token/position.go.html#3887071">Position</a></span><span class="op" id="3831701">(</span><span class="ident" id="3831702"><a href="/gostd/go/ast/commentmap.go.html#3829544">p</a></span><span class="op" id="3831703">.</span><span class="ident" id="3831704"><a href="/gostd/go/ast/ast.go.html#3795102">End</a></span><span class="op" id="3831707">(</span><span class="op" id="3831708">)</span><span class="op" id="3831709">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3831714">//&nbsp;update&nbsp;previous&nbsp;node&nbsp;group&nbsp;if&nbsp;we&nbsp;see&nbsp;an&nbsp;&#34;important&#34;&nbsp;node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3831776">switch</span>&nbsp;<span class="ident" id="3831783"><a href="/gostd/go/ast/commentmap.go.html#3829792">q</a></span><span class="op" id="3831784">.</span><span class="op" id="3831785">(</span><span class="keyword" id="3831786">type</span><span class="op" id="3831790">)</span>&nbsp;<span class="op" id="3831792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3831796">case</span>&nbsp;<span class="op" id="3831801">*</span><span class="ident" id="3831802"><a href="/gostd/go/ast/ast.go.html#3823869">File</a></span><span class="op" id="3831806">,</span>&nbsp;<span class="op" id="3831808">*</span><span class="ident" id="3831809"><a href="/gostd/go/ast/ast.go.html#3798258">Field</a></span><span class="op" id="3831814">,</span>&nbsp;<span class="ident" id="3831816"><a href="/gostd/go/ast/ast.go.html#3795432">Decl</a></span><span class="op" id="3831820">,</span>&nbsp;<span class="ident" id="3831822"><a href="/gostd/go/ast/ast.go.html#3819508">Spec</a></span><span class="op" id="3831826">,</span>&nbsp;<span class="ident" id="3831828"><a href="/gostd/go/ast/ast.go.html#3795334">Stmt</a></span><span class="op" id="3831832">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3831837"><a href="/gostd/go/ast/commentmap.go.html#3829735">stack</a></span><span class="op" id="3831842">.</span><span class="ident" id="3831843"><a href="/gostd/go/ast/commentmap.go.html#3827848">push</a></span><span class="op" id="3831847">(</span><span class="ident" id="3831848"><a href="/gostd/go/ast/commentmap.go.html#3829792">q</a></span><span class="op" id="3831849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3831853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3831856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3831860">return</span>&nbsp;<span class="ident" id="3831867"><a href="/gostd/go/ast/commentmap.go.html#3829124">cmap</a></span><br>
<span class="lineno">240</span><span class="op" id="3831872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3831875">//&nbsp;Update&nbsp;replaces&nbsp;an&nbsp;old&nbsp;node&nbsp;in&nbsp;the&nbsp;comment&nbsp;map&nbsp;with&nbsp;the&nbsp;new&nbsp;node</span><br>
<span class="lineno"></span><span class="comment" id="3831943">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;node.&nbsp;Comments&nbsp;that&nbsp;were&nbsp;associated&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3832011">//&nbsp;old&nbsp;node&nbsp;are&nbsp;associated&nbsp;with&nbsp;the&nbsp;new&nbsp;node.</span><br>
<span class="lineno">245</span><span class="comment" id="3832057">//</span><br>
<span class="lineno"></span><span class="keyword" id="3832060">func</span>&nbsp;<span class="op" id="3832065">(</span><span class="ident" id="3832066">cmap</span>&nbsp;<span class="ident" id="3832071"><a href="/gostd/go/ast/commentmap.go.html#3825942">CommentMap</a></span><span class="op" id="3832081">)</span>&nbsp;<span class="ident" id="3832083">Update</span><span class="op" id="3832089">(</span><span class="ident" id="3832090">old</span><span class="op" id="3832093">,</span>&nbsp;<span class="builtinfunc" id="3832095">new</span>&nbsp;<span class="ident" id="3832099"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><span class="op" id="3832103">)</span>&nbsp;<span class="ident" id="3832105"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span>&nbsp;<span class="op" id="3832110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3832113">if</span>&nbsp;<span class="ident" id="3832116">list</span>&nbsp;<span class="op" id="3832121">:=</span>&nbsp;<span class="ident" id="3832124"><a href="/gostd/go/ast/commentmap.go.html#3832066">cmap</a></span><span class="op" id="3832128">[</span><span class="ident" id="3832129"><a href="/gostd/go/ast/commentmap.go.html#3832090">old</a></span><span class="op" id="3832132">]</span><span class="op" id="3832133">;</span>&nbsp;<span class="builtinfunc" id="3832135">len</span><span class="op" id="3832138">(</span><span class="ident" id="3832139"><a href="/gostd/go/ast/commentmap.go.html#3832116">list</a></span><span class="op" id="3832143">)</span>&nbsp;<span class="op" id="3832145">&gt;</span>&nbsp;<span class="num" id="3832147">0</span>&nbsp;<span class="op" id="3832149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3832153">delete</span><span class="op" id="3832159">(</span><span class="ident" id="3832160"><a href="/gostd/go/ast/commentmap.go.html#3832066">cmap</a></span><span class="op" id="3832164">,</span>&nbsp;<span class="ident" id="3832166"><a href="/gostd/go/ast/commentmap.go.html#3832090">old</a></span><span class="op" id="3832169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3832173"><a href="/gostd/go/ast/commentmap.go.html#3832066">cmap</a></span><span class="op" id="3832177">[</span><span class="builtinfunc" id="3832178"><a href="/gostd/go/ast/commentmap.go.html#3832095">new</a></span><span class="op" id="3832181">]</span>&nbsp;<span class="op" id="3832183">=</span>&nbsp;<span class="builtinfunc" id="3832185">append</span><span class="op" id="3832191">(</span><span class="ident" id="3832192"><a href="/gostd/go/ast/commentmap.go.html#3832066">cmap</a></span><span class="op" id="3832196">[</span><span class="builtinfunc" id="3832197"><a href="/gostd/go/ast/commentmap.go.html#3832095">new</a></span><span class="op" id="3832200">]</span><span class="op" id="3832201">,</span>&nbsp;<span class="ident" id="3832203"><a href="/gostd/go/ast/commentmap.go.html#3832116">list</a></span><span class="op" id="3832207">...</span><span class="op" id="3832210">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3832213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3832216">return</span>&nbsp;<span class="builtinfunc" id="3832223"><a href="/gostd/go/ast/commentmap.go.html#3832095">new</a></span><br>
<span class="lineno"></span><span class="op" id="3832227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3832230">//&nbsp;Filter&nbsp;returns&nbsp;a&nbsp;new&nbsp;comment&nbsp;map&nbsp;consisting&nbsp;of&nbsp;only&nbsp;those</span><br>
<span class="lineno">255</span><span class="comment" id="3832291">//&nbsp;entries&nbsp;of&nbsp;cmap&nbsp;for&nbsp;which&nbsp;a&nbsp;corresponding&nbsp;node&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3832351">//&nbsp;the&nbsp;AST&nbsp;specified&nbsp;by&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="3832381">//</span><br>
<span class="lineno"></span><span class="keyword" id="3832384">func</span>&nbsp;<span class="op" id="3832389">(</span><span class="ident" id="3832390">cmap</span>&nbsp;<span class="ident" id="3832395"><a href="/gostd/go/ast/commentmap.go.html#3825942">CommentMap</a></span><span class="op" id="3832405">)</span>&nbsp;<span class="ident" id="3832407">Filter</span><span class="op" id="3832413">(</span><span class="ident" id="3832414">node</span>&nbsp;<span class="ident" id="3832419"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><span class="op" id="3832423">)</span>&nbsp;<span class="ident" id="3832425"><a href="/gostd/go/ast/commentmap.go.html#3825942">CommentMap</a></span>&nbsp;<span class="op" id="3832436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3832439">umap</span>&nbsp;<span class="op" id="3832444">:=</span>&nbsp;<span class="builtinfunc" id="3832447">make</span><span class="op" id="3832451">(</span><span class="ident" id="3832452"><a href="/gostd/go/ast/commentmap.go.html#3825942">CommentMap</a></span><span class="op" id="3832462">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3832465"><a href="/gostd/go/ast/walk.go.html#3873431">Inspect</a></span><span class="op" id="3832472">(</span><span class="ident" id="3832473"><a href="/gostd/go/ast/commentmap.go.html#3832414">node</a></span><span class="op" id="3832477">,</span>&nbsp;<span class="keyword" id="3832479">func</span><span class="op" id="3832483">(</span><span class="ident" id="3832484">n</span>&nbsp;<span class="ident" id="3832486"><a href="/gostd/go/ast/ast.go.html#3795014">Node</a></span><span class="op" id="3832490">)</span>&nbsp;<span class="builtintype" id="3832492">bool</span>&nbsp;<span class="op" id="3832497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3832501">if</span>&nbsp;<span class="ident" id="3832504">g</span>&nbsp;<span class="op" id="3832506">:=</span>&nbsp;<span class="ident" id="3832509"><a href="/gostd/go/ast/commentmap.go.html#3832390">cmap</a></span><span class="op" id="3832513">[</span><span class="ident" id="3832514"><a href="/gostd/go/ast/commentmap.go.html#3832484">n</a></span><span class="op" id="3832515">]</span><span class="op" id="3832516">;</span>&nbsp;<span class="builtinfunc" id="3832518">len</span><span class="op" id="3832521">(</span><span class="ident" id="3832522"><a href="/gostd/go/ast/commentmap.go.html#3832504">g</a></span><span class="op" id="3832523">)</span>&nbsp;<span class="op" id="3832525">&gt;</span>&nbsp;<span class="num" id="3832527">0</span>&nbsp;<span class="op" id="3832529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3832534"><a href="/gostd/go/ast/commentmap.go.html#3832439">umap</a></span><span class="op" id="3832538">[</span><span class="ident" id="3832539"><a href="/gostd/go/ast/commentmap.go.html#3832484">n</a></span><span class="op" id="3832540">]</span>&nbsp;<span class="op" id="3832542">=</span>&nbsp;<span class="ident" id="3832544"><a href="/gostd/go/ast/commentmap.go.html#3832504">g</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3832548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3832552">return</span>&nbsp;<span class="builtintype" id="3832559">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3832565">}</span><span class="op" id="3832566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3832569">return</span>&nbsp;<span class="ident" id="3832576"><a href="/gostd/go/ast/commentmap.go.html#3832439">umap</a></span><br>
<span class="lineno"></span><span class="op" id="3832581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3832584">//&nbsp;Comments&nbsp;returns&nbsp;the&nbsp;list&nbsp;of&nbsp;comment&nbsp;groups&nbsp;in&nbsp;the&nbsp;comment&nbsp;map.</span><br>
<span class="lineno">270</span><span class="comment" id="3832651">//&nbsp;The&nbsp;result&nbsp;is&nbsp;sorted&nbsp;is&nbsp;source&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="3832692">//</span><br>
<span class="lineno"></span><span class="keyword" id="3832695">func</span>&nbsp;<span class="op" id="3832700">(</span><span class="ident" id="3832701">cmap</span>&nbsp;<span class="ident" id="3832706"><a href="/gostd/go/ast/commentmap.go.html#3825942">CommentMap</a></span><span class="op" id="3832716">)</span>&nbsp;<span class="ident" id="3832718">Comments</span><span class="op" id="3832726">(</span><span class="op" id="3832727">)</span>&nbsp;<span class="op" id="3832729">[</span><span class="op" id="3832730">]</span><span class="op" id="3832731">*</span><span class="ident" id="3832732"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span>&nbsp;<span class="op" id="3832745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3832748">list</span>&nbsp;<span class="op" id="3832753">:=</span>&nbsp;<span class="builtinfunc" id="3832756">make</span><span class="op" id="3832760">(</span><span class="op" id="3832761">[</span><span class="op" id="3832762">]</span><span class="op" id="3832763">*</span><span class="ident" id="3832764"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span><span class="op" id="3832776">,</span>&nbsp;<span class="num" id="3832778">0</span><span class="op" id="3832779">,</span>&nbsp;<span class="builtinfunc" id="3832781">len</span><span class="op" id="3832784">(</span><span class="ident" id="3832785"><a href="/gostd/go/ast/commentmap.go.html#3832701">cmap</a></span><span class="op" id="3832789">)</span><span class="op" id="3832790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3832793">for</span>&nbsp;<span class="ident" id="3832797">_</span><span class="op" id="3832798">,</span>&nbsp;<span class="ident" id="3832800">e</span>&nbsp;<span class="op" id="3832802">:=</span>&nbsp;<span class="keyword" id="3832805">range</span>&nbsp;<span class="ident" id="3832811"><a href="/gostd/go/ast/commentmap.go.html#3832701">cmap</a></span>&nbsp;<span class="op" id="3832816">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3832820"><a href="/gostd/go/ast/commentmap.go.html#3832748">list</a></span>&nbsp;<span class="op" id="3832825">=</span>&nbsp;<span class="builtinfunc" id="3832827">append</span><span class="op" id="3832833">(</span><span class="ident" id="3832834"><a href="/gostd/go/ast/commentmap.go.html#3832748">list</a></span><span class="op" id="3832838">,</span>&nbsp;<span class="ident" id="3832840"><a href="/gostd/go/ast/commentmap.go.html#3832800">e</a></span><span class="op" id="3832841">...</span><span class="op" id="3832844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3832847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3832850"><a href="/gostd/go/ast/commentmap.go.html#3825515">sortComments</a></span><span class="op" id="3832862">(</span><span class="ident" id="3832863"><a href="/gostd/go/ast/commentmap.go.html#3832748">list</a></span><span class="op" id="3832867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3832870">return</span>&nbsp;<span class="ident" id="3832877"><a href="/gostd/go/ast/commentmap.go.html#3832748">list</a></span><br>
<span class="lineno"></span><span class="op" id="3832882">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="3832885">func</span>&nbsp;<span class="ident" id="3832890">summary</span><span class="op" id="3832897">(</span><span class="ident" id="3832898">list</span>&nbsp;<span class="op" id="3832903">[</span><span class="op" id="3832904">]</span><span class="op" id="3832905">*</span><span class="ident" id="3832906"><a href="/gostd/go/ast/ast.go.html#3796034">CommentGroup</a></span><span class="op" id="3832918">)</span>&nbsp;<span class="builtintype" id="3832920">string</span>&nbsp;<span class="op" id="3832927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3832930">const</span>&nbsp;<span class="ident" id="3832936">maxLen</span>&nbsp;<span class="op" id="3832943">=</span>&nbsp;<span class="num" id="3832945">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3832949">var</span>&nbsp;<span class="ident" id="3832953">buf</span>&nbsp;<span class="ident" id="3832957"><a href="/gostd/go/ast/commentmap.go.html#3825188">bytes</a></span><span class="op" id="3832962">.</span><span class="ident" id="3832963"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3832972">//&nbsp;collect&nbsp;comments&nbsp;text</span><br>
<span class="lineno"></span><span class="ident" id="3832997">loop</span><span class="op" id="3833001">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833004">for</span>&nbsp;<span class="ident" id="3833008">_</span><span class="op" id="3833009">,</span>&nbsp;<span class="ident" id="3833011">group</span>&nbsp;<span class="op" id="3833017">:=</span>&nbsp;<span class="keyword" id="3833020">range</span>&nbsp;<span class="ident" id="3833026"><a href="/gostd/go/ast/commentmap.go.html#3832898">list</a></span>&nbsp;<span class="op" id="3833031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3833035">//&nbsp;Note:&nbsp;CommentGroup.Text()&nbsp;does&nbsp;too&nbsp;much&nbsp;work&nbsp;for&nbsp;what&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3833097">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;need&nbsp;and&nbsp;would&nbsp;only&nbsp;replace&nbsp;this&nbsp;innermost&nbsp;loop.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3833157">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Just&nbsp;do&nbsp;it&nbsp;explicitly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833191">for</span>&nbsp;<span class="ident" id="3833195">_</span><span class="op" id="3833196">,</span>&nbsp;<span class="ident" id="3833198">comment</span>&nbsp;<span class="op" id="3833206">:=</span>&nbsp;<span class="keyword" id="3833209">range</span>&nbsp;<span class="ident" id="3833215"><a href="/gostd/go/ast/commentmap.go.html#3833011">group</a></span><span class="op" id="3833220">.</span><span class="ident" id="3833221"><a href="/gostd/go/ast/ast.go.html#3796057">List</a></span>&nbsp;<span class="op" id="3833226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833231">if</span>&nbsp;<span class="ident" id="3833234"><a href="/gostd/go/ast/commentmap.go.html#3832953">buf</a></span><span class="op" id="3833237">.</span><span class="ident" id="3833238"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="3833241">(</span><span class="op" id="3833242">)</span>&nbsp;<span class="op" id="3833244">&gt;=</span>&nbsp;<span class="ident" id="3833247"><a href="/gostd/go/ast/commentmap.go.html#3832936">maxLen</a></span>&nbsp;<span class="op" id="3833254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833260">break</span>&nbsp;<span class="ident" id="3833266"><a href="/gostd/go/ast/commentmap.go.html#3832997">loop</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3833274">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833279"><a href="/gostd/go/ast/commentmap.go.html#3832953">buf</a></span><span class="op" id="3833282">.</span><span class="ident" id="3833283"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="3833294">(</span><span class="ident" id="3833295"><a href="/gostd/go/ast/commentmap.go.html#3833198">comment</a></span><span class="op" id="3833302">.</span><span class="ident" id="3833303"><a href="/gostd/go/ast/ast.go.html#3795711">Text</a></span><span class="op" id="3833307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3833311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3833314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3833318">//&nbsp;truncate&nbsp;if&nbsp;too&nbsp;long</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833343">if</span>&nbsp;<span class="ident" id="3833346"><a href="/gostd/go/ast/commentmap.go.html#3832953">buf</a></span><span class="op" id="3833349">.</span><span class="ident" id="3833350"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="3833353">(</span><span class="op" id="3833354">)</span>&nbsp;<span class="op" id="3833356">&gt;</span>&nbsp;<span class="ident" id="3833358"><a href="/gostd/go/ast/commentmap.go.html#3832936">maxLen</a></span>&nbsp;<span class="op" id="3833365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833369"><a href="/gostd/go/ast/commentmap.go.html#3832953">buf</a></span><span class="op" id="3833372">.</span><span class="ident" id="3833373"><a href="/gostd/bytes/buffer.go.html#1385094">Truncate</a></span><span class="op" id="3833381">(</span><span class="ident" id="3833382"><a href="/gostd/go/ast/commentmap.go.html#3832936">maxLen</a></span>&nbsp;<span class="op" id="3833389">-</span>&nbsp;<span class="num" id="3833391">3</span><span class="op" id="3833392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833396"><a href="/gostd/go/ast/commentmap.go.html#3832953">buf</a></span><span class="op" id="3833399">.</span><span class="ident" id="3833400"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="3833411">(</span><span class="string" id="3833412">&#34;...&#34;</span><span class="op" id="3833417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3833420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3833424">//&nbsp;replace&nbsp;any&nbsp;invisibles&nbsp;with&nbsp;blanks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833463">bytes</span>&nbsp;<span class="op" id="3833469">:=</span>&nbsp;<span class="ident" id="3833472"><a href="/gostd/go/ast/commentmap.go.html#3832953">buf</a></span><span class="op" id="3833475">.</span><span class="ident" id="3833476"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="3833481">(</span><span class="op" id="3833482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833485">for</span>&nbsp;<span class="ident" id="3833489">i</span><span class="op" id="3833490">,</span>&nbsp;<span class="ident" id="3833492">b</span>&nbsp;<span class="op" id="3833494">:=</span>&nbsp;<span class="keyword" id="3833497">range</span>&nbsp;<span class="ident" id="3833503"><a href="/gostd/go/ast/commentmap.go.html#3833463">bytes</a></span>&nbsp;<span class="op" id="3833509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833513">switch</span>&nbsp;<span class="ident" id="3833520"><a href="/gostd/go/ast/commentmap.go.html#3833492">b</a></span>&nbsp;<span class="op" id="3833522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833526">case</span>&nbsp;<span class="string" id="3833531">&#39;\t&#39;</span><span class="op" id="3833535">,</span>&nbsp;<span class="string" id="3833537">&#39;\n&#39;</span><span class="op" id="3833541">,</span>&nbsp;<span class="string" id="3833543">&#39;\r&#39;</span><span class="op" id="3833547">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833552"><a href="/gostd/go/ast/commentmap.go.html#3833463">bytes</a></span><span class="op" id="3833557">[</span><span class="ident" id="3833558"><a href="/gostd/go/ast/commentmap.go.html#3833489">i</a></span><span class="op" id="3833559">]</span>&nbsp;<span class="op" id="3833561">=</span>&nbsp;<span class="string" id="3833563">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3833569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3833572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833576">return</span>&nbsp;<span class="builtintype" id="3833583">string</span><span class="op" id="3833589">(</span><span class="ident" id="3833590"><a href="/gostd/go/ast/commentmap.go.html#3833463">bytes</a></span><span class="op" id="3833595">)</span><br>
<span class="lineno">315</span><span class="op" id="3833597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3833600">func</span>&nbsp;<span class="op" id="3833605">(</span><span class="ident" id="3833606">cmap</span>&nbsp;<span class="ident" id="3833611"><a href="/gostd/go/ast/commentmap.go.html#3825942">CommentMap</a></span><span class="op" id="3833621">)</span>&nbsp;<span class="ident" id="3833623">String</span><span class="op" id="3833629">(</span><span class="op" id="3833630">)</span>&nbsp;<span class="builtintype" id="3833632">string</span>&nbsp;<span class="op" id="3833639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833642">var</span>&nbsp;<span class="ident" id="3833646">buf</span>&nbsp;<span class="ident" id="3833650"><a href="/gostd/go/ast/commentmap.go.html#3825188">bytes</a></span><span class="op" id="3833655">.</span><span class="ident" id="3833656"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833664"><a href="/gostd/go/ast/commentmap.go.html#3825197">fmt</a></span><span class="op" id="3833667">.</span><span class="ident" id="3833668"><a href="/gostd/fmt/print.go.html#2145376">Fprintln</a></span><span class="op" id="3833676">(</span><span class="op" id="3833677">&amp;</span><span class="ident" id="3833678"><a href="/gostd/go/ast/commentmap.go.html#3833646">buf</a></span><span class="op" id="3833681">,</span>&nbsp;<span class="string" id="3833683">&#34;CommentMap&nbsp;{&#34;</span><span class="op" id="3833697">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833700">for</span>&nbsp;<span class="ident" id="3833704">node</span><span class="op" id="3833708">,</span>&nbsp;<span class="ident" id="3833710">comment</span>&nbsp;<span class="op" id="3833718">:=</span>&nbsp;<span class="keyword" id="3833721">range</span>&nbsp;<span class="ident" id="3833727"><a href="/gostd/go/ast/commentmap.go.html#3833606">cmap</a></span>&nbsp;<span class="op" id="3833732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3833736">//&nbsp;print&nbsp;name&nbsp;of&nbsp;identifiers;&nbsp;print&nbsp;node&nbsp;type&nbsp;for&nbsp;other&nbsp;nodes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833800">var</span>&nbsp;<span class="ident" id="3833804">s</span>&nbsp;<span class="builtintype" id="3833806">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3833815">if</span>&nbsp;<span class="ident" id="3833818">ident</span><span class="op" id="3833823">,</span>&nbsp;<span class="ident" id="3833825">ok</span>&nbsp;<span class="op" id="3833828">:=</span>&nbsp;<span class="ident" id="3833831"><a href="/gostd/go/ast/commentmap.go.html#3833704">node</a></span><span class="op" id="3833835">.</span><span class="op" id="3833836">(</span><span class="op" id="3833837">*</span><span class="ident" id="3833838"><a href="/gostd/go/ast/ast.go.html#3800239">Ident</a></span><span class="op" id="3833843">)</span><span class="op" id="3833844">;</span>&nbsp;<span class="ident" id="3833846"><a href="/gostd/go/ast/commentmap.go.html#3833825">ok</a></span>&nbsp;<span class="op" id="3833849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833854"><a href="/gostd/go/ast/commentmap.go.html#3833804">s</a></span>&nbsp;<span class="op" id="3833856">=</span>&nbsp;<span class="ident" id="3833858"><a href="/gostd/go/ast/commentmap.go.html#3833818">ident</a></span><span class="op" id="3833863">.</span><span class="ident" id="3833864"><a href="/gostd/go/ast/ast.go.html#3800299">Name</a></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3833871">}</span>&nbsp;<span class="keyword" id="3833873">else</span>&nbsp;<span class="op" id="3833878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833883"><a href="/gostd/go/ast/commentmap.go.html#3833804">s</a></span>&nbsp;<span class="op" id="3833885">=</span>&nbsp;<span class="ident" id="3833887"><a href="/gostd/go/ast/commentmap.go.html#3825197">fmt</a></span><span class="op" id="3833890">.</span><span class="ident" id="3833891"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="3833898">(</span><span class="string" id="3833899">&#34;%T&#34;</span><span class="op" id="3833903">,</span>&nbsp;<span class="ident" id="3833905"><a href="/gostd/go/ast/commentmap.go.html#3833704">node</a></span><span class="op" id="3833909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3833913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833917"><a href="/gostd/go/ast/commentmap.go.html#3825197">fmt</a></span><span class="op" id="3833920">.</span><span class="ident" id="3833921"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="3833928">(</span><span class="op" id="3833929">&amp;</span><span class="ident" id="3833930"><a href="/gostd/go/ast/commentmap.go.html#3833646">buf</a></span><span class="op" id="3833933">,</span>&nbsp;<span class="string" id="3833935">&#34;\t%p&nbsp;&nbsp;%20s:&nbsp;&nbsp;%s\n&#34;</span><span class="op" id="3833954">,</span>&nbsp;<span class="ident" id="3833956"><a href="/gostd/go/ast/commentmap.go.html#3833704">node</a></span><span class="op" id="3833960">,</span>&nbsp;<span class="ident" id="3833962"><a href="/gostd/go/ast/commentmap.go.html#3833804">s</a></span><span class="op" id="3833963">,</span>&nbsp;<span class="ident" id="3833965"><a href="/gostd/go/ast/commentmap.go.html#3832890">summary</a></span><span class="op" id="3833972">(</span><span class="ident" id="3833973"><a href="/gostd/go/ast/commentmap.go.html#3833710">comment</a></span><span class="op" id="3833980">)</span><span class="op" id="3833981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3833984">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833987"><a href="/gostd/go/ast/commentmap.go.html#3825197">fmt</a></span><span class="op" id="3833990">.</span><span class="ident" id="3833991"><a href="/gostd/fmt/print.go.html#2145376">Fprintln</a></span><span class="op" id="3833999">(</span><span class="op" id="3834000">&amp;</span><span class="ident" id="3834001"><a href="/gostd/go/ast/commentmap.go.html#3833646">buf</a></span><span class="op" id="3834004">,</span>&nbsp;<span class="string" id="3834006">&#34;}&#34;</span><span class="op" id="3834009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3834012">return</span>&nbsp;<span class="ident" id="3834019"><a href="/gostd/go/ast/commentmap.go.html#3833646">buf</a></span><span class="op" id="3834022">.</span><span class="ident" id="3834023"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="3834029">(</span><span class="op" id="3834030">)</span><br>
<span class="lineno"></span><span class="op" id="3834032">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
