<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html" class="current">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8223464">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8223520">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8223574">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8223625">package</span>&nbsp;<span class="ident" id="8223633">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8223639">import</span>&nbsp;<span class="op" id="8223646">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223649">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223658">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223667">&#34;compress/gzip&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223684">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223699">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223706">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223712">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223725">&#34;net/http/internal&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223746">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223757">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223768">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223778">&#34;strings&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8223789">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8223799">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8223802">type</span>&nbsp;<span class="ident" id="8223807">respTest</span>&nbsp;<span class="keyword" id="8223816">struct</span>&nbsp;<span class="op" id="8223823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223826">Raw</span>&nbsp;&nbsp;<span class="builtintype" id="8223831">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223839">Resp</span>&nbsp;<span class="ident" id="8223844">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223854">Body</span>&nbsp;<span class="builtintype" id="8223859">string</span><br>
<span class="lineno"></span><span class="op" id="8223866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8223869">func</span>&nbsp;<span class="ident" id="8223874">dummyReq</span><span class="op" id="8223882">(</span><span class="ident" id="8223883">method</span>&nbsp;<span class="builtintype" id="8223890">string</span><span class="op" id="8223896">)</span>&nbsp;<span class="op" id="8223898">*</span><span class="ident" id="8223899">Request</span>&nbsp;<span class="op" id="8223907">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223910">return</span>&nbsp;<span class="op" id="8223917">&amp;</span><span class="ident" id="8223918">Request</span><span class="op" id="8223925">{</span><span class="ident" id="8223926">Method</span><span class="op" id="8223932">:</span>&nbsp;<span class="ident" id="8223934">method</span><span class="op" id="8223940">}</span><br>
<span class="lineno"></span><span class="op" id="8223942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8223945">func</span>&nbsp;<span class="ident" id="8223950">dummyReq11</span><span class="op" id="8223960">(</span><span class="ident" id="8223961">method</span>&nbsp;<span class="builtintype" id="8223968">string</span><span class="op" id="8223974">)</span>&nbsp;<span class="op" id="8223976">*</span><span class="ident" id="8223977">Request</span>&nbsp;<span class="op" id="8223985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223988">return</span>&nbsp;<span class="op" id="8223995">&amp;</span><span class="ident" id="8223996">Request</span><span class="op" id="8224003">{</span><span class="ident" id="8224004">Method</span><span class="op" id="8224010">:</span>&nbsp;<span class="ident" id="8224012">method</span><span class="op" id="8224018">,</span>&nbsp;<span class="ident" id="8224020">Proto</span><span class="op" id="8224025">:</span>&nbsp;<span class="string" id="8224027">&#34;HTTP/1.1&#34;</span><span class="op" id="8224037">,</span>&nbsp;<span class="ident" id="8224039">ProtoMajor</span><span class="op" id="8224049">:</span>&nbsp;<span class="num" id="8224051">1</span><span class="op" id="8224052">,</span>&nbsp;<span class="ident" id="8224054">ProtoMinor</span><span class="op" id="8224064">:</span>&nbsp;<span class="num" id="8224066">1</span><span class="op" id="8224067">}</span><br>
<span class="lineno">35</span><span class="op" id="8224069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8224072">var</span>&nbsp;<span class="ident" id="8224076">respTests</span>&nbsp;<span class="op" id="8224086">=</span>&nbsp;<span class="op" id="8224088">[</span><span class="op" id="8224089">]</span><span class="ident" id="8224090">respTest</span><span class="op" id="8224098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8224101">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8224148">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224152">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8224174">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224179">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8224203">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224208">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8224215">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224220">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8224233">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224238">Response</span><span class="op" id="8224246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224251">Status</span><span class="op" id="8224257">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8224263">&#34;200&nbsp;OK&#34;</span><span class="op" id="8224271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224276">StatusCode</span><span class="op" id="8224286">:</span>&nbsp;<span class="num" id="8224288">200</span><span class="op" id="8224291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224296">Proto</span><span class="op" id="8224301">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8224308">&#34;HTTP/1.0&#34;</span><span class="op" id="8224318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224323">ProtoMajor</span><span class="op" id="8224333">:</span>&nbsp;<span class="num" id="8224335">1</span><span class="op" id="8224336">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224341">ProtoMinor</span><span class="op" id="8224351">:</span>&nbsp;<span class="num" id="8224353">0</span><span class="op" id="8224354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224359">Request</span><span class="op" id="8224366">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224371">dummyReq</span><span class="op" id="8224379">(</span><span class="string" id="8224380">&#34;GET&#34;</span><span class="op" id="8224385">)</span><span class="op" id="8224386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224391">Header</span><span class="op" id="8224397">:</span>&nbsp;<span class="ident" id="8224399">Header</span><span class="op" id="8224405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224411">&#34;Connection&#34;</span><span class="op" id="8224423">:</span>&nbsp;<span class="op" id="8224425">{</span><span class="string" id="8224426">&#34;close&#34;</span><span class="op" id="8224433">}</span><span class="op" id="8224434">,</span>&nbsp;<span class="comment" id="8224436">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8224461">}</span><span class="op" id="8224462">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224467">Close</span><span class="op" id="8224472">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8224482">true</span><span class="op" id="8224486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224491">ContentLength</span><span class="op" id="8224504">:</span>&nbsp;<span class="op" id="8224506">-</span><span class="num" id="8224507">1</span><span class="op" id="8224508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8224512">}</span><span class="op" id="8224513">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224518">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8224531">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8224534">}</span><span class="op" id="8224535">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8224539">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;response&nbsp;without&nbsp;Content-Length&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8224597">//&nbsp;Connection&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8224621">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224625">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8224647">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224652">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8224659">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224664">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8224677">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224682">Response</span><span class="op" id="8224690">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224695">Status</span><span class="op" id="8224701">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8224710">&#34;200&nbsp;OK&#34;</span><span class="op" id="8224718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224723">StatusCode</span><span class="op" id="8224733">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8224738">200</span><span class="op" id="8224741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224746">Proto</span><span class="op" id="8224751">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8224761">&#34;HTTP/1.1&#34;</span><span class="op" id="8224771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224776">ProtoMajor</span><span class="op" id="8224786">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8224791">1</span><span class="op" id="8224792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224797">ProtoMinor</span><span class="op" id="8224807">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8224812">1</span><span class="op" id="8224813">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224818">Header</span><span class="op" id="8224824">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224833">Header</span><span class="op" id="8224839">{</span><span class="op" id="8224840">}</span><span class="op" id="8224841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224846">Request</span><span class="op" id="8224853">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224861">dummyReq</span><span class="op" id="8224869">(</span><span class="string" id="8224870">&#34;GET&#34;</span><span class="op" id="8224875">)</span><span class="op" id="8224876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224881">Close</span><span class="op" id="8224886">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8224896">true</span><span class="op" id="8224900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8224905">ContentLength</span><span class="op" id="8224918">:</span>&nbsp;<span class="op" id="8224920">-</span><span class="num" id="8224921">1</span><span class="op" id="8224922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8224926">}</span><span class="op" id="8224927">,</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224932">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8224945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8224948">}</span><span class="op" id="8224949">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8224953">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;204&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8225013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225017">&#34;HTTP/1.1&nbsp;204&nbsp;No&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="8225047">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225052">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8225059">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225064">&#34;Body&nbsp;should&nbsp;not&nbsp;be&nbsp;read!\n&#34;</span><span class="op" id="8225092">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225097">Response</span><span class="op" id="8225105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225110">Status</span><span class="op" id="8225116">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225125">&#34;204&nbsp;No&nbsp;Content&#34;</span><span class="op" id="8225141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225146">StatusCode</span><span class="op" id="8225156">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8225161">204</span><span class="op" id="8225164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225169">Proto</span><span class="op" id="8225174">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225184">&#34;HTTP/1.1&#34;</span><span class="op" id="8225194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225199">ProtoMajor</span><span class="op" id="8225209">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8225214">1</span><span class="op" id="8225215">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225220">ProtoMinor</span><span class="op" id="8225230">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8225235">1</span><span class="op" id="8225236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225241">Header</span><span class="op" id="8225247">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225256">Header</span><span class="op" id="8225262">{</span><span class="op" id="8225263">}</span><span class="op" id="8225264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225269">Request</span><span class="op" id="8225276">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225284">dummyReq</span><span class="op" id="8225292">(</span><span class="string" id="8225293">&#34;GET&#34;</span><span class="op" id="8225298">)</span><span class="op" id="8225299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225304">Close</span><span class="op" id="8225309">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8225319">false</span><span class="op" id="8225324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225329">ContentLength</span><span class="op" id="8225342">:</span>&nbsp;<span class="num" id="8225344">0</span><span class="op" id="8225345">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8225349">}</span><span class="op" id="8225350">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225355">&#34;&#34;</span><span class="op" id="8225357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8225360">}</span><span class="op" id="8225361">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8225365">//&nbsp;Unchunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8225409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225413">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8225435">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225440">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="8225465">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225470">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8225494">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225499">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8225506">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225511">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8225524">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225529">Response</span><span class="op" id="8225537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225542">Status</span><span class="op" id="8225548">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225554">&#34;200&nbsp;OK&#34;</span><span class="op" id="8225562">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225567">StatusCode</span><span class="op" id="8225577">:</span>&nbsp;<span class="num" id="8225579">200</span><span class="op" id="8225582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225587">Proto</span><span class="op" id="8225592">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225599">&#34;HTTP/1.0&#34;</span><span class="op" id="8225609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225614">ProtoMajor</span><span class="op" id="8225624">:</span>&nbsp;<span class="num" id="8225626">1</span><span class="op" id="8225627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225632">ProtoMinor</span><span class="op" id="8225642">:</span>&nbsp;<span class="num" id="8225644">0</span><span class="op" id="8225645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225650">Request</span><span class="op" id="8225657">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225662">dummyReq</span><span class="op" id="8225670">(</span><span class="string" id="8225671">&#34;GET&#34;</span><span class="op" id="8225676">)</span><span class="op" id="8225677">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225682">Header</span><span class="op" id="8225688">:</span>&nbsp;<span class="ident" id="8225690">Header</span><span class="op" id="8225696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225702">&#34;Connection&#34;</span><span class="op" id="8225714">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225720">{</span><span class="string" id="8225721">&#34;close&#34;</span><span class="op" id="8225728">}</span><span class="op" id="8225729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225735">&#34;Content-Length&#34;</span><span class="op" id="8225751">:</span>&nbsp;<span class="op" id="8225753">{</span><span class="string" id="8225754">&#34;10&#34;</span><span class="op" id="8225758">}</span><span class="op" id="8225759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8225764">}</span><span class="op" id="8225765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225770">Close</span><span class="op" id="8225775">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8225785">true</span><span class="op" id="8225789">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225794">ContentLength</span><span class="op" id="8225807">:</span>&nbsp;<span class="num" id="8225809">10</span><span class="op" id="8225811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8225815">}</span><span class="op" id="8225816">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225821">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8225834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8225837">}</span><span class="op" id="8225838">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8225842">//&nbsp;Chunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8225887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225891">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8225913">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225918">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="8225951">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225956">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8225963">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225968">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="8225977">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8225982">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="8226000">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226005">&#34;09\r\n&#34;</span>&nbsp;<span class="op" id="8226014">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226019">&#34;continued\r\n&#34;</span>&nbsp;<span class="op" id="8226035">+</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226040">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="8226048">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226053">&#34;\r\n&#34;</span><span class="op" id="8226059">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226064">Response</span><span class="op" id="8226072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226077">Status</span><span class="op" id="8226083">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8226095">&#34;200&nbsp;OK&#34;</span><span class="op" id="8226103">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226108">StatusCode</span><span class="op" id="8226118">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8226126">200</span><span class="op" id="8226129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226134">Proto</span><span class="op" id="8226139">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8226152">&#34;HTTP/1.1&#34;</span><span class="op" id="8226162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226167">ProtoMajor</span><span class="op" id="8226177">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8226185">1</span><span class="op" id="8226186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226191">ProtoMinor</span><span class="op" id="8226201">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8226209">1</span><span class="op" id="8226210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226215">Request</span><span class="op" id="8226222">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226233">dummyReq</span><span class="op" id="8226241">(</span><span class="string" id="8226242">&#34;GET&#34;</span><span class="op" id="8226247">)</span><span class="op" id="8226248">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226253">Header</span><span class="op" id="8226259">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226271">Header</span><span class="op" id="8226277">{</span><span class="op" id="8226278">}</span><span class="op" id="8226279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226284">Close</span><span class="op" id="8226289">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8226302">false</span><span class="op" id="8226307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226312">ContentLength</span><span class="op" id="8226325">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226330">-</span><span class="num" id="8226331">1</span><span class="op" id="8226332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226337">TransferEncoding</span><span class="op" id="8226353">:</span>&nbsp;<span class="op" id="8226355">[</span><span class="op" id="8226356">]</span><span class="builtintype" id="8226357">string</span><span class="op" id="8226363">{</span><span class="string" id="8226364">&#34;chunked&#34;</span><span class="op" id="8226373">}</span><span class="op" id="8226374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226378">}</span><span class="op" id="8226379">,</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226384">&#34;Body&nbsp;here\ncontinued&#34;</span><span class="op" id="8226406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226409">}</span><span class="op" id="8226410">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8226414">//&nbsp;Chunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226460">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8226482">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226487">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="8226520">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226525">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="8226550">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226555">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8226562">+</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226567">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="8226576">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226581">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="8226599">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226604">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="8226612">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226617">&#34;\r\n&#34;</span><span class="op" id="8226623">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226628">Response</span><span class="op" id="8226636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226641">Status</span><span class="op" id="8226647">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8226659">&#34;200&nbsp;OK&#34;</span><span class="op" id="8226667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226672">StatusCode</span><span class="op" id="8226682">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8226690">200</span><span class="op" id="8226693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226698">Proto</span><span class="op" id="8226703">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8226716">&#34;HTTP/1.1&#34;</span><span class="op" id="8226726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226731">ProtoMajor</span><span class="op" id="8226741">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8226749">1</span><span class="op" id="8226750">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226755">ProtoMinor</span><span class="op" id="8226765">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8226773">1</span><span class="op" id="8226774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226779">Request</span><span class="op" id="8226786">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226797">dummyReq</span><span class="op" id="8226805">(</span><span class="string" id="8226806">&#34;GET&#34;</span><span class="op" id="8226811">)</span><span class="op" id="8226812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226817">Header</span><span class="op" id="8226823">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226835">Header</span><span class="op" id="8226841">{</span><span class="op" id="8226842">}</span><span class="op" id="8226843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226848">Close</span><span class="op" id="8226853">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8226866">false</span><span class="op" id="8226871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226876">ContentLength</span><span class="op" id="8226889">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226894">-</span><span class="num" id="8226895">1</span><span class="op" id="8226896">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226901">TransferEncoding</span><span class="op" id="8226917">:</span>&nbsp;<span class="op" id="8226919">[</span><span class="op" id="8226920">]</span><span class="builtintype" id="8226921">string</span><span class="op" id="8226927">{</span><span class="string" id="8226928">&#34;chunked&#34;</span><span class="op" id="8226937">}</span><span class="op" id="8226938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226942">}</span><span class="op" id="8226943">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8226948">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8226961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226964">}</span><span class="op" id="8226965">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8226969">//&nbsp;Chunked&nbsp;response&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8227024">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8227046">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8227051">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="8227084">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8227089">&#34;\r\n&#34;</span><span class="op" id="8227095">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227100">Response</span><span class="op" id="8227108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227113">Status</span><span class="op" id="8227119">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8227131">&#34;200&nbsp;OK&#34;</span><span class="op" id="8227139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227144">StatusCode</span><span class="op" id="8227154">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8227162">200</span><span class="op" id="8227165">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227170">Proto</span><span class="op" id="8227175">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8227188">&#34;HTTP/1.1&#34;</span><span class="op" id="8227198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227203">ProtoMajor</span><span class="op" id="8227213">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8227221">1</span><span class="op" id="8227222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227227">ProtoMinor</span><span class="op" id="8227237">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8227245">1</span><span class="op" id="8227246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227251">Request</span><span class="op" id="8227258">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8227269">dummyReq</span><span class="op" id="8227277">(</span><span class="string" id="8227278">&#34;HEAD&#34;</span><span class="op" id="8227284">)</span><span class="op" id="8227285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227290">Header</span><span class="op" id="8227296">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8227308">Header</span><span class="op" id="8227314">{</span><span class="op" id="8227315">}</span><span class="op" id="8227316">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227321">TransferEncoding</span><span class="op" id="8227337">:</span>&nbsp;<span class="op" id="8227339">[</span><span class="op" id="8227340">]</span><span class="builtintype" id="8227341">string</span><span class="op" id="8227347">{</span><span class="string" id="8227348">&#34;chunked&#34;</span><span class="op" id="8227357">}</span><span class="op" id="8227358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227363">Close</span><span class="op" id="8227368">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8227381">false</span><span class="op" id="8227386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227391">ContentLength</span><span class="op" id="8227404">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8227409">-</span><span class="num" id="8227410">1</span><span class="op" id="8227411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227415">}</span><span class="op" id="8227416">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8227421">&#34;&#34;</span><span class="op" id="8227423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227426">}</span><span class="op" id="8227427">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8227431">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227480">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8227484">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8227506">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8227511">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="8227537">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8227542">&#34;\r\n&#34;</span><span class="op" id="8227548">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227553">Response</span><span class="op" id="8227561">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227566">Status</span><span class="op" id="8227572">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8227584">&#34;200&nbsp;OK&#34;</span><span class="op" id="8227592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227597">StatusCode</span><span class="op" id="8227607">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8227615">200</span><span class="op" id="8227618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227623">Proto</span><span class="op" id="8227628">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8227641">&#34;HTTP/1.0&#34;</span><span class="op" id="8227651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227656">ProtoMajor</span><span class="op" id="8227666">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8227674">1</span><span class="op" id="8227675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227680">ProtoMinor</span><span class="op" id="8227690">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8227698">0</span><span class="op" id="8227699">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227704">Request</span><span class="op" id="8227711">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8227722">dummyReq</span><span class="op" id="8227730">(</span><span class="string" id="8227731">&#34;HEAD&#34;</span><span class="op" id="8227737">)</span><span class="op" id="8227738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227743">Header</span><span class="op" id="8227749">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8227761">Header</span><span class="op" id="8227767">{</span><span class="string" id="8227768">&#34;Content-Length&#34;</span><span class="op" id="8227784">:</span>&nbsp;<span class="op" id="8227786">{</span><span class="string" id="8227787">&#34;256&#34;</span><span class="op" id="8227792">}</span><span class="op" id="8227793">}</span><span class="op" id="8227794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227799">TransferEncoding</span><span class="op" id="8227815">:</span>&nbsp;<span class="ident" id="8227817">nil</span><span class="op" id="8227820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227825">Close</span><span class="op" id="8227830">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8227843">true</span><span class="op" id="8227847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227852">ContentLength</span><span class="op" id="8227865">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8227870">256</span><span class="op" id="8227873">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227877">}</span><span class="op" id="8227878">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8227883">&#34;&#34;</span><span class="op" id="8227885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227888">}</span><span class="op" id="8227889">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8227893">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request&nbsp;with&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8227960">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8227982">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8227987">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="8228013">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8228018">&#34;\r\n&#34;</span><span class="op" id="8228024">,</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228029">Response</span><span class="op" id="8228037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228042">Status</span><span class="op" id="8228048">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8228060">&#34;200&nbsp;OK&#34;</span><span class="op" id="8228068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228073">StatusCode</span><span class="op" id="8228083">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8228091">200</span><span class="op" id="8228094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228099">Proto</span><span class="op" id="8228104">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8228117">&#34;HTTP/1.1&#34;</span><span class="op" id="8228127">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228132">ProtoMajor</span><span class="op" id="8228142">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8228150">1</span><span class="op" id="8228151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228156">ProtoMinor</span><span class="op" id="8228166">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8228174">1</span><span class="op" id="8228175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228180">Request</span><span class="op" id="8228187">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8228198">dummyReq</span><span class="op" id="8228206">(</span><span class="string" id="8228207">&#34;HEAD&#34;</span><span class="op" id="8228213">)</span><span class="op" id="8228214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228219">Header</span><span class="op" id="8228225">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8228237">Header</span><span class="op" id="8228243">{</span><span class="string" id="8228244">&#34;Content-Length&#34;</span><span class="op" id="8228260">:</span>&nbsp;<span class="op" id="8228262">{</span><span class="string" id="8228263">&#34;256&#34;</span><span class="op" id="8228268">}</span><span class="op" id="8228269">}</span><span class="op" id="8228270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228275">TransferEncoding</span><span class="op" id="8228291">:</span>&nbsp;<span class="ident" id="8228293">nil</span><span class="op" id="8228296">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228301">Close</span><span class="op" id="8228306">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8228319">false</span><span class="op" id="8228324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228329">ContentLength</span><span class="op" id="8228342">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8228347">256</span><span class="op" id="8228350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8228354">}</span><span class="op" id="8228355">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8228360">&#34;&#34;</span><span class="op" id="8228362">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8228365">}</span><span class="op" id="8228366">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8228370">//&nbsp;No&nbsp;Content-Length&nbsp;or&nbsp;Chunked&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8228433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8228437">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8228459">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8228464">&#34;\r\n&#34;</span><span class="op" id="8228470">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228475">Response</span><span class="op" id="8228483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228488">Status</span><span class="op" id="8228494">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8228506">&#34;200&nbsp;OK&#34;</span><span class="op" id="8228514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228519">StatusCode</span><span class="op" id="8228529">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8228537">200</span><span class="op" id="8228540">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228545">Proto</span><span class="op" id="8228550">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8228563">&#34;HTTP/1.0&#34;</span><span class="op" id="8228573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228578">ProtoMajor</span><span class="op" id="8228588">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8228596">1</span><span class="op" id="8228597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228602">ProtoMinor</span><span class="op" id="8228612">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8228620">0</span><span class="op" id="8228621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228626">Request</span><span class="op" id="8228633">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8228644">dummyReq</span><span class="op" id="8228652">(</span><span class="string" id="8228653">&#34;HEAD&#34;</span><span class="op" id="8228659">)</span><span class="op" id="8228660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228665">Header</span><span class="op" id="8228671">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8228683">Header</span><span class="op" id="8228689">{</span><span class="op" id="8228690">}</span><span class="op" id="8228691">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228696">TransferEncoding</span><span class="op" id="8228712">:</span>&nbsp;<span class="ident" id="8228714">nil</span><span class="op" id="8228717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228722">Close</span><span class="op" id="8228727">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8228740">true</span><span class="op" id="8228744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228749">ContentLength</span><span class="op" id="8228762">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228767">-</span><span class="num" id="8228768">1</span><span class="op" id="8228769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8228773">}</span><span class="op" id="8228774">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8228779">&#34;&#34;</span><span class="op" id="8228781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8228784">}</span><span class="op" id="8228785">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8228789">//&nbsp;explicit&nbsp;Content-Length&nbsp;of&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8228823">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8228827">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8228849">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8228854">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="8228878">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8228883">&#34;\r\n&#34;</span><span class="op" id="8228889">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228894">Response</span><span class="op" id="8228902">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228907">Status</span><span class="op" id="8228913">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8228919">&#34;200&nbsp;OK&#34;</span><span class="op" id="8228927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228932">StatusCode</span><span class="op" id="8228942">:</span>&nbsp;<span class="num" id="8228944">200</span><span class="op" id="8228947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228952">Proto</span><span class="op" id="8228957">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8228964">&#34;HTTP/1.1&#34;</span><span class="op" id="8228974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228979">ProtoMajor</span><span class="op" id="8228989">:</span>&nbsp;<span class="num" id="8228991">1</span><span class="op" id="8228992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228997">ProtoMinor</span><span class="op" id="8229007">:</span>&nbsp;<span class="num" id="8229009">1</span><span class="op" id="8229010">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229015">Request</span><span class="op" id="8229022">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229027">dummyReq</span><span class="op" id="8229035">(</span><span class="string" id="8229036">&#34;GET&#34;</span><span class="op" id="8229041">)</span><span class="op" id="8229042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229047">Header</span><span class="op" id="8229053">:</span>&nbsp;<span class="ident" id="8229055">Header</span><span class="op" id="8229061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8229067">&#34;Content-Length&#34;</span><span class="op" id="8229083">:</span>&nbsp;<span class="op" id="8229085">{</span><span class="string" id="8229086">&#34;0&#34;</span><span class="op" id="8229089">}</span><span class="op" id="8229090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229095">}</span><span class="op" id="8229096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229101">Close</span><span class="op" id="8229106">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8229116">false</span><span class="op" id="8229121">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229126">ContentLength</span><span class="op" id="8229139">:</span>&nbsp;<span class="num" id="8229141">0</span><span class="op" id="8229142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229146">}</span><span class="op" id="8229147">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8229152">&#34;&#34;</span><span class="op" id="8229154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229157">}</span><span class="op" id="8229158">,</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8229162">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;but&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8229223">//&nbsp;(permitted&nbsp;by&nbsp;RFC&nbsp;2616)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8229255">&#34;HTTP/1.0&nbsp;303&nbsp;\r\n\r\n&#34;</span><span class="op" id="8229278">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229282">Response</span><span class="op" id="8229290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229295">Status</span><span class="op" id="8229301">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8229310">&#34;303&nbsp;&#34;</span><span class="op" id="8229316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229321">StatusCode</span><span class="op" id="8229331">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8229336">303</span><span class="op" id="8229339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229344">Proto</span><span class="op" id="8229349">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8229359">&#34;HTTP/1.0&#34;</span><span class="op" id="8229369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229374">ProtoMajor</span><span class="op" id="8229384">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8229389">1</span><span class="op" id="8229390">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229395">ProtoMinor</span><span class="op" id="8229405">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8229410">0</span><span class="op" id="8229411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229416">Request</span><span class="op" id="8229423">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229431">dummyReq</span><span class="op" id="8229439">(</span><span class="string" id="8229440">&#34;GET&#34;</span><span class="op" id="8229445">)</span><span class="op" id="8229446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229451">Header</span><span class="op" id="8229457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229466">Header</span><span class="op" id="8229472">{</span><span class="op" id="8229473">}</span><span class="op" id="8229474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229479">Close</span><span class="op" id="8229484">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8229494">true</span><span class="op" id="8229498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229503">ContentLength</span><span class="op" id="8229516">:</span>&nbsp;<span class="op" id="8229518">-</span><span class="num" id="8229519">1</span><span class="op" id="8229520">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229524">}</span><span class="op" id="8229525">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8229530">&#34;&#34;</span><span class="op" id="8229532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229535">}</span><span class="op" id="8229536">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8229540">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;and&nbsp;no&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8229604">//&nbsp;(not&nbsp;permitted&nbsp;by&nbsp;RFC&nbsp;2616,&nbsp;but&nbsp;we&#39;ll&nbsp;accept&nbsp;it&nbsp;anyway)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8229668">&#34;HTTP/1.0&nbsp;303\r\n\r\n&#34;</span><span class="op" id="8229690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229694">Response</span><span class="op" id="8229702">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229707">Status</span><span class="op" id="8229713">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8229722">&#34;303&nbsp;&#34;</span><span class="op" id="8229728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229733">StatusCode</span><span class="op" id="8229743">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8229748">303</span><span class="op" id="8229751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229756">Proto</span><span class="op" id="8229761">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8229771">&#34;HTTP/1.0&#34;</span><span class="op" id="8229781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229786">ProtoMajor</span><span class="op" id="8229796">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8229801">1</span><span class="op" id="8229802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229807">ProtoMinor</span><span class="op" id="8229817">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8229822">0</span><span class="op" id="8229823">,</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229828">Request</span><span class="op" id="8229835">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229843">dummyReq</span><span class="op" id="8229851">(</span><span class="string" id="8229852">&#34;GET&#34;</span><span class="op" id="8229857">)</span><span class="op" id="8229858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229863">Header</span><span class="op" id="8229869">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229878">Header</span><span class="op" id="8229884">{</span><span class="op" id="8229885">}</span><span class="op" id="8229886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229891">Close</span><span class="op" id="8229896">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8229906">true</span><span class="op" id="8229910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229915">ContentLength</span><span class="op" id="8229928">:</span>&nbsp;<span class="op" id="8229930">-</span><span class="num" id="8229931">1</span><span class="op" id="8229932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229936">}</span><span class="op" id="8229937">,</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8229942">&#34;&#34;</span><span class="op" id="8229944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229947">}</span><span class="op" id="8229948">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8229952">//&nbsp;golang.org/issue/4767:&nbsp;don&#39;t&nbsp;special-case&nbsp;multipart/byteranges&nbsp;responses</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230033">`HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content<br>
<span class="lineno"></span>Connection:&nbsp;close<br>
<span class="lineno"></span>Content-Type:&nbsp;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef<br>
<span class="lineno"></span><br>
<span class="lineno">340</span>some&nbsp;body`</span><span class="op" id="8230154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230158">Response</span><span class="op" id="8230166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230171">Status</span><span class="op" id="8230177">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8230183">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="8230204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230209">StatusCode</span><span class="op" id="8230219">:</span>&nbsp;<span class="num" id="8230221">206</span><span class="op" id="8230224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230229">Proto</span><span class="op" id="8230234">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8230241">&#34;HTTP/1.1&#34;</span><span class="op" id="8230251">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230256">ProtoMajor</span><span class="op" id="8230266">:</span>&nbsp;<span class="num" id="8230268">1</span><span class="op" id="8230269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230274">ProtoMinor</span><span class="op" id="8230284">:</span>&nbsp;<span class="num" id="8230286">1</span><span class="op" id="8230287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230292">Request</span><span class="op" id="8230299">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8230304">dummyReq</span><span class="op" id="8230312">(</span><span class="string" id="8230313">&#34;GET&#34;</span><span class="op" id="8230318">)</span><span class="op" id="8230319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230324">Header</span><span class="op" id="8230330">:</span>&nbsp;<span class="ident" id="8230332">Header</span><span class="op" id="8230338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230344">&#34;Content-Type&#34;</span><span class="op" id="8230358">:</span>&nbsp;<span class="op" id="8230360">[</span><span class="op" id="8230361">]</span><span class="builtintype" id="8230362">string</span><span class="op" id="8230368">{</span><span class="string" id="8230369">&#34;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef&#34;</span><span class="op" id="8230418">}</span><span class="op" id="8230419">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230424">}</span><span class="op" id="8230425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230430">Close</span><span class="op" id="8230435">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8230445">true</span><span class="op" id="8230449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230454">ContentLength</span><span class="op" id="8230467">:</span>&nbsp;<span class="op" id="8230469">-</span><span class="num" id="8230470">1</span><span class="op" id="8230471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230475">}</span><span class="op" id="8230476">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230481">&#34;some&nbsp;body&#34;</span><span class="op" id="8230492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230495">}</span><span class="op" id="8230496">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8230500">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length,&nbsp;Request&nbsp;is&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230562">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230566">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8230588">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230593">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8230617">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230622">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8230629">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230634">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8230647">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230652">Response</span><span class="op" id="8230660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230665">Status</span><span class="op" id="8230671">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8230677">&#34;200&nbsp;OK&#34;</span><span class="op" id="8230685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230690">StatusCode</span><span class="op" id="8230700">:</span>&nbsp;<span class="num" id="8230702">200</span><span class="op" id="8230705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230710">Proto</span><span class="op" id="8230715">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8230722">&#34;HTTP/1.0&#34;</span><span class="op" id="8230732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230737">ProtoMajor</span><span class="op" id="8230747">:</span>&nbsp;<span class="num" id="8230749">1</span><span class="op" id="8230750">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230755">ProtoMinor</span><span class="op" id="8230765">:</span>&nbsp;<span class="num" id="8230767">0</span><span class="op" id="8230768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230773">Header</span><span class="op" id="8230779">:</span>&nbsp;<span class="ident" id="8230781">Header</span><span class="op" id="8230787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230793">&#34;Connection&#34;</span><span class="op" id="8230805">:</span>&nbsp;<span class="op" id="8230807">{</span><span class="string" id="8230808">&#34;close&#34;</span><span class="op" id="8230815">}</span><span class="op" id="8230816">,</span>&nbsp;<span class="comment" id="8230818">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230843">}</span><span class="op" id="8230844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230849">Close</span><span class="op" id="8230854">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8230864">true</span><span class="op" id="8230868">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8230873">ContentLength</span><span class="op" id="8230886">:</span>&nbsp;<span class="op" id="8230888">-</span><span class="num" id="8230889">1</span><span class="op" id="8230890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230894">}</span><span class="op" id="8230895">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230900">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8230913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230916">}</span><span class="op" id="8230917">,</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8230921">//&nbsp;206&nbsp;Partial&nbsp;Content.&nbsp;golang.org/issue/8923</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8230968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8230972">&#34;HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="8231007">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231012">&#34;Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8\r\n&#34;</span>&nbsp;<span class="op" id="8231058">+</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231063">&#34;Accept-Ranges:&nbsp;bytes\r\n&#34;</span>&nbsp;<span class="op" id="8231090">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231095">&#34;Content-Range:&nbsp;bytes&nbsp;0-5/1862\r\n&#34;</span>&nbsp;<span class="op" id="8231131">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231136">&#34;Content-Length:&nbsp;6\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8231164">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231169">&#34;foobar&#34;</span><span class="op" id="8231177">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231182">Response</span><span class="op" id="8231190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231195">Status</span><span class="op" id="8231201">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8231207">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="8231228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231233">StatusCode</span><span class="op" id="8231243">:</span>&nbsp;<span class="num" id="8231245">206</span><span class="op" id="8231248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231253">Proto</span><span class="op" id="8231258">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8231265">&#34;HTTP/1.1&#34;</span><span class="op" id="8231275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231280">ProtoMajor</span><span class="op" id="8231290">:</span>&nbsp;<span class="num" id="8231292">1</span><span class="op" id="8231293">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231298">ProtoMinor</span><span class="op" id="8231308">:</span>&nbsp;<span class="num" id="8231310">1</span><span class="op" id="8231311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231316">Request</span><span class="op" id="8231323">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8231328">dummyReq</span><span class="op" id="8231336">(</span><span class="string" id="8231337">&#34;GET&#34;</span><span class="op" id="8231342">)</span><span class="op" id="8231343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231348">Header</span><span class="op" id="8231354">:</span>&nbsp;<span class="ident" id="8231356">Header</span><span class="op" id="8231362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231368">&#34;Accept-Ranges&#34;</span><span class="op" id="8231383">:</span>&nbsp;&nbsp;<span class="op" id="8231386">[</span><span class="op" id="8231387">]</span><span class="builtintype" id="8231388">string</span><span class="op" id="8231394">{</span><span class="string" id="8231395">&#34;bytes&#34;</span><span class="op" id="8231402">}</span><span class="op" id="8231403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231409">&#34;Content-Length&#34;</span><span class="op" id="8231425">:</span>&nbsp;<span class="op" id="8231427">[</span><span class="op" id="8231428">]</span><span class="builtintype" id="8231429">string</span><span class="op" id="8231435">{</span><span class="string" id="8231436">&#34;6&#34;</span><span class="op" id="8231439">}</span><span class="op" id="8231440">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231446">&#34;Content-Type&#34;</span><span class="op" id="8231460">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8231464">[</span><span class="op" id="8231465">]</span><span class="builtintype" id="8231466">string</span><span class="op" id="8231472">{</span><span class="string" id="8231473">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="8231500">}</span><span class="op" id="8231501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231507">&#34;Content-Range&#34;</span><span class="op" id="8231522">:</span>&nbsp;&nbsp;<span class="op" id="8231525">[</span><span class="op" id="8231526">]</span><span class="builtintype" id="8231527">string</span><span class="op" id="8231533">{</span><span class="string" id="8231534">&#34;bytes&nbsp;0-5/1862&#34;</span><span class="op" id="8231550">}</span><span class="op" id="8231551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8231556">}</span><span class="op" id="8231557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231562">ContentLength</span><span class="op" id="8231575">:</span>&nbsp;<span class="num" id="8231577">6</span><span class="op" id="8231578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8231582">}</span><span class="op" id="8231583">,</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231588">&#34;foobar&#34;</span><span class="op" id="8231596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8231599">}</span><span class="op" id="8231600">,</span><br>
<span class="lineno"></span><span class="op" id="8231602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="8231605">func</span>&nbsp;<span class="ident" id="8231610">TestReadResponse</span><span class="op" id="8231626">(</span><span class="ident" id="8231627">t</span>&nbsp;<span class="op" id="8231629">*</span><span class="ident" id="8231630">testing</span><span class="op" id="8231637">.</span><span class="ident" id="8231638">T</span><span class="op" id="8231639">)</span>&nbsp;<span class="op" id="8231641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8231644">for</span>&nbsp;<span class="ident" id="8231648">i</span><span class="op" id="8231649">,</span>&nbsp;<span class="ident" id="8231651">tt</span>&nbsp;<span class="op" id="8231654">:=</span>&nbsp;<span class="keyword" id="8231657">range</span>&nbsp;<span class="ident" id="8231663">respTests</span>&nbsp;<span class="op" id="8231673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231677">resp</span><span class="op" id="8231681">,</span>&nbsp;<span class="ident" id="8231683">err</span>&nbsp;<span class="op" id="8231687">:=</span>&nbsp;<span class="ident" id="8231690">ReadResponse</span><span class="op" id="8231702">(</span><span class="ident" id="8231703">bufio</span><span class="op" id="8231708">.</span><span class="ident" id="8231709">NewReader</span><span class="op" id="8231718">(</span><span class="ident" id="8231719">strings</span><span class="op" id="8231726">.</span><span class="ident" id="8231727">NewReader</span><span class="op" id="8231736">(</span><span class="ident" id="8231737">tt</span><span class="op" id="8231739">.</span><span class="ident" id="8231740">Raw</span><span class="op" id="8231743">)</span><span class="op" id="8231744">)</span><span class="op" id="8231745">,</span>&nbsp;<span class="ident" id="8231747">tt</span><span class="op" id="8231749">.</span><span class="ident" id="8231750">Resp</span><span class="op" id="8231754">.</span><span class="ident" id="8231755">Request</span><span class="op" id="8231762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8231766">if</span>&nbsp;<span class="ident" id="8231769">err</span>&nbsp;<span class="op" id="8231773">!=</span>&nbsp;<span class="ident" id="8231776">nil</span>&nbsp;<span class="op" id="8231780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231785">t</span><span class="op" id="8231786">.</span><span class="ident" id="8231787">Errorf</span><span class="op" id="8231793">(</span><span class="string" id="8231794">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8231803">,</span>&nbsp;<span class="ident" id="8231805">i</span><span class="op" id="8231806">,</span>&nbsp;<span class="ident" id="8231808">err</span><span class="op" id="8231811">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8231816">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8231827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231831">rbody</span>&nbsp;<span class="op" id="8231837">:=</span>&nbsp;<span class="ident" id="8231840">resp</span><span class="op" id="8231844">.</span><span class="ident" id="8231845">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231852">resp</span><span class="op" id="8231856">.</span><span class="ident" id="8231857">Body</span>&nbsp;<span class="op" id="8231862">=</span>&nbsp;<span class="ident" id="8231864">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231870">diff</span><span class="op" id="8231874">(</span><span class="ident" id="8231875">t</span><span class="op" id="8231876">,</span>&nbsp;<span class="ident" id="8231878">fmt</span><span class="op" id="8231881">.</span><span class="ident" id="8231882">Sprintf</span><span class="op" id="8231889">(</span><span class="string" id="8231890">&#34;#%d&nbsp;Response&#34;</span><span class="op" id="8231904">,</span>&nbsp;<span class="ident" id="8231906">i</span><span class="op" id="8231907">)</span><span class="op" id="8231908">,</span>&nbsp;<span class="ident" id="8231910">resp</span><span class="op" id="8231914">,</span>&nbsp;<span class="op" id="8231916">&amp;</span><span class="ident" id="8231917">tt</span><span class="op" id="8231919">.</span><span class="ident" id="8231920">Resp</span><span class="op" id="8231924">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8231928">var</span>&nbsp;<span class="ident" id="8231932">bout</span>&nbsp;<span class="ident" id="8231937">bytes</span><span class="op" id="8231942">.</span><span class="ident" id="8231943">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8231952">if</span>&nbsp;<span class="ident" id="8231955">rbody</span>&nbsp;<span class="op" id="8231961">!=</span>&nbsp;<span class="ident" id="8231964">nil</span>&nbsp;<span class="op" id="8231968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231973">_</span><span class="op" id="8231974">,</span>&nbsp;<span class="ident" id="8231976">err</span>&nbsp;<span class="op" id="8231980">=</span>&nbsp;<span class="ident" id="8231982">io</span><span class="op" id="8231984">.</span><span class="ident" id="8231985">Copy</span><span class="op" id="8231989">(</span><span class="op" id="8231990">&amp;</span><span class="ident" id="8231991">bout</span><span class="op" id="8231995">,</span>&nbsp;<span class="ident" id="8231997">rbody</span><span class="op" id="8232002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8232007">if</span>&nbsp;<span class="ident" id="8232010">err</span>&nbsp;<span class="op" id="8232014">!=</span>&nbsp;<span class="ident" id="8232017">nil</span>&nbsp;<span class="op" id="8232021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232027">t</span><span class="op" id="8232028">.</span><span class="ident" id="8232029">Errorf</span><span class="op" id="8232035">(</span><span class="string" id="8232036">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8232045">,</span>&nbsp;<span class="ident" id="8232047">i</span><span class="op" id="8232048">,</span>&nbsp;<span class="ident" id="8232050">err</span><span class="op" id="8232053">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8232059">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232076">rbody</span><span class="op" id="8232081">.</span><span class="ident" id="8232082">Close</span><span class="op" id="8232087">(</span><span class="op" id="8232088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232096">body</span>&nbsp;<span class="op" id="8232101">:=</span>&nbsp;<span class="ident" id="8232104">bout</span><span class="op" id="8232108">.</span><span class="ident" id="8232109">String</span><span class="op" id="8232115">(</span><span class="op" id="8232116">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8232120">if</span>&nbsp;<span class="ident" id="8232123">body</span>&nbsp;<span class="op" id="8232128">!=</span>&nbsp;<span class="ident" id="8232131">tt</span><span class="op" id="8232133">.</span><span class="ident" id="8232134">Body</span>&nbsp;<span class="op" id="8232139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232144">t</span><span class="op" id="8232145">.</span><span class="ident" id="8232146">Errorf</span><span class="op" id="8232152">(</span><span class="string" id="8232153">&#34;#%d:&nbsp;Body&nbsp;=&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8232177">,</span>&nbsp;<span class="ident" id="8232179">i</span><span class="op" id="8232180">,</span>&nbsp;<span class="ident" id="8232182">body</span><span class="op" id="8232186">,</span>&nbsp;<span class="ident" id="8232188">tt</span><span class="op" id="8232190">.</span><span class="ident" id="8232191">Body</span><span class="op" id="8232195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232202">}</span><br>
<span class="lineno"></span><span class="op" id="8232204">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="8232207">func</span>&nbsp;<span class="ident" id="8232212">TestWriteResponse</span><span class="op" id="8232229">(</span><span class="ident" id="8232230">t</span>&nbsp;<span class="op" id="8232232">*</span><span class="ident" id="8232233">testing</span><span class="op" id="8232240">.</span><span class="ident" id="8232241">T</span><span class="op" id="8232242">)</span>&nbsp;<span class="op" id="8232244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8232247">for</span>&nbsp;<span class="ident" id="8232251">i</span><span class="op" id="8232252">,</span>&nbsp;<span class="ident" id="8232254">tt</span>&nbsp;<span class="op" id="8232257">:=</span>&nbsp;<span class="keyword" id="8232260">range</span>&nbsp;<span class="ident" id="8232266">respTests</span>&nbsp;<span class="op" id="8232276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232280">resp</span><span class="op" id="8232284">,</span>&nbsp;<span class="ident" id="8232286">err</span>&nbsp;<span class="op" id="8232290">:=</span>&nbsp;<span class="ident" id="8232293">ReadResponse</span><span class="op" id="8232305">(</span><span class="ident" id="8232306">bufio</span><span class="op" id="8232311">.</span><span class="ident" id="8232312">NewReader</span><span class="op" id="8232321">(</span><span class="ident" id="8232322">strings</span><span class="op" id="8232329">.</span><span class="ident" id="8232330">NewReader</span><span class="op" id="8232339">(</span><span class="ident" id="8232340">tt</span><span class="op" id="8232342">.</span><span class="ident" id="8232343">Raw</span><span class="op" id="8232346">)</span><span class="op" id="8232347">)</span><span class="op" id="8232348">,</span>&nbsp;<span class="ident" id="8232350">tt</span><span class="op" id="8232352">.</span><span class="ident" id="8232353">Resp</span><span class="op" id="8232357">.</span><span class="ident" id="8232358">Request</span><span class="op" id="8232365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8232369">if</span>&nbsp;<span class="ident" id="8232372">err</span>&nbsp;<span class="op" id="8232376">!=</span>&nbsp;<span class="ident" id="8232379">nil</span>&nbsp;<span class="op" id="8232383">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232388">t</span><span class="op" id="8232389">.</span><span class="ident" id="8232390">Errorf</span><span class="op" id="8232396">(</span><span class="string" id="8232397">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8232406">,</span>&nbsp;<span class="ident" id="8232408">i</span><span class="op" id="8232409">,</span>&nbsp;<span class="ident" id="8232411">err</span><span class="op" id="8232414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8232419">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232434">err</span>&nbsp;<span class="op" id="8232438">=</span>&nbsp;<span class="ident" id="8232440">resp</span><span class="op" id="8232444">.</span><span class="ident" id="8232445">Write</span><span class="op" id="8232450">(</span><span class="ident" id="8232451">ioutil</span><span class="op" id="8232457">.</span><span class="ident" id="8232458">Discard</span><span class="op" id="8232465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8232469">if</span>&nbsp;<span class="ident" id="8232472">err</span>&nbsp;<span class="op" id="8232476">!=</span>&nbsp;<span class="ident" id="8232479">nil</span>&nbsp;<span class="op" id="8232483">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232488">t</span><span class="op" id="8232489">.</span><span class="ident" id="8232490">Errorf</span><span class="op" id="8232496">(</span><span class="string" id="8232497">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8232506">,</span>&nbsp;<span class="ident" id="8232508">i</span><span class="op" id="8232509">,</span>&nbsp;<span class="ident" id="8232511">err</span><span class="op" id="8232514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8232519">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232533">}</span><br>
<span class="lineno"></span><span class="op" id="8232535">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="8232538">var</span>&nbsp;<span class="ident" id="8232542">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="8232573">=</span>&nbsp;<span class="op" id="8232575">[</span><span class="op" id="8232576">]</span><span class="keyword" id="8232577">struct</span>&nbsp;<span class="op" id="8232584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232587">chunked</span><span class="op" id="8232594">,</span>&nbsp;<span class="ident" id="8232596">compressed</span>&nbsp;<span class="builtintype" id="8232607">bool</span><br>
<span class="lineno"></span><span class="op" id="8232612">}</span><span class="op" id="8232613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232616">{</span><span class="builtintype" id="8232617">false</span><span class="op" id="8232622">,</span>&nbsp;<span class="builtintype" id="8232624">false</span><span class="op" id="8232629">}</span><span class="op" id="8232630">,</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232633">{</span><span class="builtintype" id="8232634">true</span><span class="op" id="8232638">,</span>&nbsp;<span class="builtintype" id="8232640">false</span><span class="op" id="8232645">}</span><span class="op" id="8232646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232649">{</span><span class="builtintype" id="8232650">true</span><span class="op" id="8232654">,</span>&nbsp;<span class="builtintype" id="8232656">true</span><span class="op" id="8232660">}</span><span class="op" id="8232661">,</span><br>
<span class="lineno"></span><span class="op" id="8232663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8232666">//&nbsp;TestReadResponseCloseInMiddle&nbsp;tests&nbsp;that&nbsp;closing&nbsp;a&nbsp;body&nbsp;after</span><br>
<span class="lineno">460</span><span class="comment" id="8232731">//&nbsp;reading&nbsp;only&nbsp;part&nbsp;of&nbsp;its&nbsp;contents&nbsp;advances&nbsp;the&nbsp;read&nbsp;to&nbsp;the&nbsp;end&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="8232800">//&nbsp;the&nbsp;request,&nbsp;right&nbsp;up&nbsp;until&nbsp;the&nbsp;next&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="8232849">func</span>&nbsp;<span class="ident" id="8232854">TestReadResponseCloseInMiddle</span><span class="op" id="8232883">(</span><span class="ident" id="8232884">t</span>&nbsp;<span class="op" id="8232886">*</span><span class="ident" id="8232887">testing</span><span class="op" id="8232894">.</span><span class="ident" id="8232895">T</span><span class="op" id="8232896">)</span>&nbsp;<span class="op" id="8232898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8232901">for</span>&nbsp;<span class="ident" id="8232905">_</span><span class="op" id="8232906">,</span>&nbsp;<span class="ident" id="8232908">test</span>&nbsp;<span class="op" id="8232913">:=</span>&nbsp;<span class="keyword" id="8232916">range</span>&nbsp;<span class="ident" id="8232922">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="8232953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232957">fatalf</span>&nbsp;<span class="op" id="8232964">:=</span>&nbsp;<span class="keyword" id="8232967">func</span><span class="op" id="8232971">(</span><span class="ident" id="8232972">format</span>&nbsp;<span class="builtintype" id="8232979">string</span><span class="op" id="8232985">,</span>&nbsp;<span class="ident" id="8232987">args</span>&nbsp;<span class="op" id="8232992">...</span><span class="keyword" id="8232995">interface</span><span class="op" id="8233004">{</span><span class="op" id="8233005">}</span><span class="op" id="8233006">)</span>&nbsp;<span class="op" id="8233008">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233013">args</span>&nbsp;<span class="op" id="8233018">=</span>&nbsp;<span class="builtinfunc" id="8233020">append</span><span class="op" id="8233026">(</span><span class="op" id="8233027">[</span><span class="op" id="8233028">]</span><span class="keyword" id="8233029">interface</span><span class="op" id="8233038">{</span><span class="op" id="8233039">}</span><span class="op" id="8233040">{</span><span class="ident" id="8233041">test</span><span class="op" id="8233045">.</span><span class="ident" id="8233046">chunked</span><span class="op" id="8233053">,</span>&nbsp;<span class="ident" id="8233055">test</span><span class="op" id="8233059">.</span><span class="ident" id="8233060">compressed</span><span class="op" id="8233070">}</span><span class="op" id="8233071">,</span>&nbsp;<span class="ident" id="8233073">args</span><span class="op" id="8233077">...</span><span class="op" id="8233080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233085">t</span><span class="op" id="8233086">.</span><span class="ident" id="8233087">Fatalf</span><span class="op" id="8233093">(</span><span class="string" id="8233094">&#34;on&nbsp;test&nbsp;chunked=%v,&nbsp;compressed=%v:&nbsp;&#34;</span><span class="op" id="8233131">+</span><span class="ident" id="8233132">format</span><span class="op" id="8233138">,</span>&nbsp;<span class="ident" id="8233140">args</span><span class="op" id="8233144">...</span><span class="op" id="8233147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233155">checkErr</span>&nbsp;<span class="op" id="8233164">:=</span>&nbsp;<span class="keyword" id="8233167">func</span><span class="op" id="8233171">(</span><span class="ident" id="8233172">err</span>&nbsp;<span class="builtintype" id="8233176">error</span><span class="op" id="8233181">,</span>&nbsp;<span class="ident" id="8233183">msg</span>&nbsp;<span class="builtintype" id="8233187">string</span><span class="op" id="8233193">)</span>&nbsp;<span class="op" id="8233195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233200">if</span>&nbsp;<span class="ident" id="8233203">err</span>&nbsp;<span class="op" id="8233207">==</span>&nbsp;<span class="ident" id="8233210">nil</span>&nbsp;<span class="op" id="8233214">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233220">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233235">fatalf</span><span class="op" id="8233241">(</span><span class="ident" id="8233242">msg</span><span class="op" id="8233245">+</span><span class="string" id="8233246">&#34;:&nbsp;%v&#34;</span><span class="op" id="8233252">,</span>&nbsp;<span class="ident" id="8233254">err</span><span class="op" id="8233257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233265">var</span>&nbsp;<span class="ident" id="8233269">buf</span>&nbsp;<span class="ident" id="8233273">bytes</span><span class="op" id="8233278">.</span><span class="ident" id="8233279">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233288">buf</span><span class="op" id="8233291">.</span><span class="ident" id="8233292">WriteString</span><span class="op" id="8233303">(</span><span class="string" id="8233304">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span><span class="op" id="8233325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233329">if</span>&nbsp;<span class="ident" id="8233332">test</span><span class="op" id="8233336">.</span><span class="ident" id="8233337">chunked</span>&nbsp;<span class="op" id="8233345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233350">buf</span><span class="op" id="8233353">.</span><span class="ident" id="8233354">WriteString</span><span class="op" id="8233365">(</span><span class="string" id="8233366">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span><span class="op" id="8233398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233402">}</span>&nbsp;<span class="keyword" id="8233404">else</span>&nbsp;<span class="op" id="8233409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233414">buf</span><span class="op" id="8233417">.</span><span class="ident" id="8233418">WriteString</span><span class="op" id="8233429">(</span><span class="string" id="8233430">&#34;Content-Length:&nbsp;1000000\r\n&#34;</span><span class="op" id="8233459">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233467">var</span>&nbsp;<span class="ident" id="8233471">wr</span>&nbsp;<span class="ident" id="8233474">io</span><span class="op" id="8233476">.</span><span class="ident" id="8233477">Writer</span>&nbsp;<span class="op" id="8233484">=</span>&nbsp;<span class="op" id="8233486">&amp;</span><span class="ident" id="8233487">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233493">if</span>&nbsp;<span class="ident" id="8233496">test</span><span class="op" id="8233500">.</span><span class="ident" id="8233501">chunked</span>&nbsp;<span class="op" id="8233509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233514">wr</span>&nbsp;<span class="op" id="8233517">=</span>&nbsp;<span class="ident" id="8233519">internal</span><span class="op" id="8233527">.</span><span class="ident" id="8233528">NewChunkedWriter</span><span class="op" id="8233544">(</span><span class="ident" id="8233545">wr</span><span class="op" id="8233547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233551">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233555">if</span>&nbsp;<span class="ident" id="8233558">test</span><span class="op" id="8233562">.</span><span class="ident" id="8233563">compressed</span>&nbsp;<span class="op" id="8233574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233579">buf</span><span class="op" id="8233582">.</span><span class="ident" id="8233583">WriteString</span><span class="op" id="8233594">(</span><span class="string" id="8233595">&#34;Content-Encoding:&nbsp;gzip\r\n&#34;</span><span class="op" id="8233623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233628">wr</span>&nbsp;<span class="op" id="8233631">=</span>&nbsp;<span class="ident" id="8233633">gzip</span><span class="op" id="8233637">.</span><span class="ident" id="8233638">NewWriter</span><span class="op" id="8233647">(</span><span class="ident" id="8233648">wr</span><span class="op" id="8233650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233658">buf</span><span class="op" id="8233661">.</span><span class="ident" id="8233662">WriteString</span><span class="op" id="8233673">(</span><span class="string" id="8233674">&#34;\r\n&#34;</span><span class="op" id="8233680">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233685">chunk</span>&nbsp;<span class="op" id="8233691">:=</span>&nbsp;<span class="ident" id="8233694">bytes</span><span class="op" id="8233699">.</span><span class="ident" id="8233700">Repeat</span><span class="op" id="8233706">(</span><span class="op" id="8233707">[</span><span class="op" id="8233708">]</span><span class="builtintype" id="8233709">byte</span><span class="op" id="8233713">{</span><span class="string" id="8233714">&#39;x&#39;</span><span class="op" id="8233717">}</span><span class="op" id="8233718">,</span>&nbsp;<span class="num" id="8233720">1000</span><span class="op" id="8233724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233728">for</span>&nbsp;<span class="ident" id="8233732">i</span>&nbsp;<span class="op" id="8233734">:=</span>&nbsp;<span class="num" id="8233737">0</span><span class="op" id="8233738">;</span>&nbsp;<span class="ident" id="8233740">i</span>&nbsp;<span class="op" id="8233742">&lt;</span>&nbsp;<span class="num" id="8233744">1000</span><span class="op" id="8233748">;</span>&nbsp;<span class="ident" id="8233750">i</span><span class="op" id="8233751">++</span>&nbsp;<span class="op" id="8233754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233759">if</span>&nbsp;<span class="ident" id="8233762">test</span><span class="op" id="8233766">.</span><span class="ident" id="8233767">compressed</span>&nbsp;<span class="op" id="8233778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8233784">//&nbsp;Otherwise&nbsp;this&nbsp;compresses&nbsp;too&nbsp;well.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233827">_</span><span class="op" id="8233828">,</span>&nbsp;<span class="ident" id="8233830">err</span>&nbsp;<span class="op" id="8233834">:=</span>&nbsp;<span class="ident" id="8233837">io</span><span class="op" id="8233839">.</span><span class="ident" id="8233840">ReadFull</span><span class="op" id="8233848">(</span><span class="ident" id="8233849">rand</span><span class="op" id="8233853">.</span><span class="ident" id="8233854">Reader</span><span class="op" id="8233860">,</span>&nbsp;<span class="ident" id="8233862">chunk</span><span class="op" id="8233867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233873">checkErr</span><span class="op" id="8233881">(</span><span class="ident" id="8233882">err</span><span class="op" id="8233885">,</span>&nbsp;<span class="string" id="8233887">&#34;rand.Reader&nbsp;ReadFull&#34;</span><span class="op" id="8233909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233919">wr</span><span class="op" id="8233921">.</span><span class="ident" id="8233922">Write</span><span class="op" id="8233927">(</span><span class="ident" id="8233928">chunk</span><span class="op" id="8233933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233937">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233941">if</span>&nbsp;<span class="ident" id="8233944">test</span><span class="op" id="8233948">.</span><span class="ident" id="8233949">compressed</span>&nbsp;<span class="op" id="8233960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233965">err</span>&nbsp;<span class="op" id="8233969">:=</span>&nbsp;<span class="ident" id="8233972">wr</span><span class="op" id="8233974">.</span><span class="op" id="8233975">(</span><span class="op" id="8233976">*</span><span class="ident" id="8233977">gzip</span><span class="op" id="8233981">.</span><span class="ident" id="8233982">Writer</span><span class="op" id="8233988">)</span><span class="op" id="8233989">.</span><span class="ident" id="8233990">Close</span><span class="op" id="8233995">(</span><span class="op" id="8233996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234001">checkErr</span><span class="op" id="8234009">(</span><span class="ident" id="8234010">err</span><span class="op" id="8234013">,</span>&nbsp;<span class="string" id="8234015">&#34;compressor&nbsp;close&#34;</span><span class="op" id="8234033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234041">if</span>&nbsp;<span class="ident" id="8234044">test</span><span class="op" id="8234048">.</span><span class="ident" id="8234049">chunked</span>&nbsp;<span class="op" id="8234057">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234062">buf</span><span class="op" id="8234065">.</span><span class="ident" id="8234066">WriteString</span><span class="op" id="8234077">(</span><span class="string" id="8234078">&#34;0\r\n\r\n&#34;</span><span class="op" id="8234089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234097">buf</span><span class="op" id="8234100">.</span><span class="ident" id="8234101">WriteString</span><span class="op" id="8234112">(</span><span class="string" id="8234113">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="8234132">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234137">bufr</span>&nbsp;<span class="op" id="8234142">:=</span>&nbsp;<span class="ident" id="8234145">bufio</span><span class="op" id="8234150">.</span><span class="ident" id="8234151">NewReader</span><span class="op" id="8234160">(</span><span class="op" id="8234161">&amp;</span><span class="ident" id="8234162">buf</span><span class="op" id="8234165">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234169">resp</span><span class="op" id="8234173">,</span>&nbsp;<span class="ident" id="8234175">err</span>&nbsp;<span class="op" id="8234179">:=</span>&nbsp;<span class="ident" id="8234182">ReadResponse</span><span class="op" id="8234194">(</span><span class="ident" id="8234195">bufr</span><span class="op" id="8234199">,</span>&nbsp;<span class="ident" id="8234201">dummyReq</span><span class="op" id="8234209">(</span><span class="string" id="8234210">&#34;GET&#34;</span><span class="op" id="8234215">)</span><span class="op" id="8234216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234220">checkErr</span><span class="op" id="8234228">(</span><span class="ident" id="8234229">err</span><span class="op" id="8234232">,</span>&nbsp;<span class="string" id="8234234">&#34;ReadResponse&#34;</span><span class="op" id="8234248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234252">expectedLength</span>&nbsp;<span class="op" id="8234267">:=</span>&nbsp;<span class="ident" id="8234270">int64</span><span class="op" id="8234275">(</span><span class="op" id="8234276">-</span><span class="num" id="8234277">1</span><span class="op" id="8234278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234282">if</span>&nbsp;<span class="op" id="8234285">!</span><span class="ident" id="8234286">test</span><span class="op" id="8234290">.</span><span class="ident" id="8234291">chunked</span>&nbsp;<span class="op" id="8234299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234304">expectedLength</span>&nbsp;<span class="op" id="8234319">=</span>&nbsp;<span class="num" id="8234321">1000000</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234335">if</span>&nbsp;<span class="ident" id="8234338">resp</span><span class="op" id="8234342">.</span><span class="ident" id="8234343">ContentLength</span>&nbsp;<span class="op" id="8234357">!=</span>&nbsp;<span class="ident" id="8234360">expectedLength</span>&nbsp;<span class="op" id="8234375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234380">fatalf</span><span class="op" id="8234386">(</span><span class="string" id="8234387">&#34;expected&nbsp;response&nbsp;length&nbsp;%d,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8234424">,</span>&nbsp;<span class="ident" id="8234426">expectedLength</span><span class="op" id="8234440">,</span>&nbsp;<span class="ident" id="8234442">resp</span><span class="op" id="8234446">.</span><span class="ident" id="8234447">ContentLength</span><span class="op" id="8234460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234468">if</span>&nbsp;<span class="ident" id="8234471">resp</span><span class="op" id="8234475">.</span><span class="ident" id="8234476">Body</span>&nbsp;<span class="op" id="8234481">==</span>&nbsp;<span class="ident" id="8234484">nil</span>&nbsp;<span class="op" id="8234488">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234493">fatalf</span><span class="op" id="8234499">(</span><span class="string" id="8234500">&#34;nil&nbsp;body&#34;</span><span class="op" id="8234510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234518">if</span>&nbsp;<span class="ident" id="8234521">test</span><span class="op" id="8234525">.</span><span class="ident" id="8234526">compressed</span>&nbsp;<span class="op" id="8234537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234542">gzReader</span><span class="op" id="8234550">,</span>&nbsp;<span class="ident" id="8234552">err</span>&nbsp;<span class="op" id="8234556">:=</span>&nbsp;<span class="ident" id="8234559">gzip</span><span class="op" id="8234563">.</span><span class="ident" id="8234564">NewReader</span><span class="op" id="8234573">(</span><span class="ident" id="8234574">resp</span><span class="op" id="8234578">.</span><span class="ident" id="8234579">Body</span><span class="op" id="8234583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234588">checkErr</span><span class="op" id="8234596">(</span><span class="ident" id="8234597">err</span><span class="op" id="8234600">,</span>&nbsp;<span class="string" id="8234602">&#34;gzip.NewReader&#34;</span><span class="op" id="8234618">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234623">resp</span><span class="op" id="8234627">.</span><span class="ident" id="8234628">Body</span>&nbsp;<span class="op" id="8234633">=</span>&nbsp;<span class="op" id="8234635">&amp;</span><span class="ident" id="8234636">readerAndCloser</span><span class="op" id="8234651">{</span><span class="ident" id="8234652">gzReader</span><span class="op" id="8234660">,</span>&nbsp;<span class="ident" id="8234662">resp</span><span class="op" id="8234666">.</span><span class="ident" id="8234667">Body</span><span class="op" id="8234671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234680">rbuf</span>&nbsp;<span class="op" id="8234685">:=</span>&nbsp;<span class="builtinfunc" id="8234688">make</span><span class="op" id="8234692">(</span><span class="op" id="8234693">[</span><span class="op" id="8234694">]</span><span class="builtintype" id="8234695">byte</span><span class="op" id="8234699">,</span>&nbsp;<span class="num" id="8234701">2500</span><span class="op" id="8234705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234709">n</span><span class="op" id="8234710">,</span>&nbsp;<span class="ident" id="8234712">err</span>&nbsp;<span class="op" id="8234716">:=</span>&nbsp;<span class="ident" id="8234719">io</span><span class="op" id="8234721">.</span><span class="ident" id="8234722">ReadFull</span><span class="op" id="8234730">(</span><span class="ident" id="8234731">resp</span><span class="op" id="8234735">.</span><span class="ident" id="8234736">Body</span><span class="op" id="8234740">,</span>&nbsp;<span class="ident" id="8234742">rbuf</span><span class="op" id="8234746">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234750">checkErr</span><span class="op" id="8234758">(</span><span class="ident" id="8234759">err</span><span class="op" id="8234762">,</span>&nbsp;<span class="string" id="8234764">&#34;2500&nbsp;byte&nbsp;ReadFull&#34;</span><span class="op" id="8234784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234788">if</span>&nbsp;<span class="ident" id="8234791">n</span>&nbsp;<span class="op" id="8234793">!=</span>&nbsp;<span class="num" id="8234796">2500</span>&nbsp;<span class="op" id="8234801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234806">fatalf</span><span class="op" id="8234812">(</span><span class="string" id="8234813">&#34;ReadFull&nbsp;only&nbsp;read&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="8234842">,</span>&nbsp;<span class="ident" id="8234844">n</span><span class="op" id="8234845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234853">if</span>&nbsp;<span class="ident" id="8234856">test</span><span class="op" id="8234860">.</span><span class="ident" id="8234861">compressed</span>&nbsp;<span class="op" id="8234872">==</span>&nbsp;<span class="builtintype" id="8234875">false</span>&nbsp;<span class="op" id="8234881">&amp;&amp;</span>&nbsp;<span class="op" id="8234884">!</span><span class="ident" id="8234885">bytes</span><span class="op" id="8234890">.</span><span class="ident" id="8234891">Equal</span><span class="op" id="8234896">(</span><span class="ident" id="8234897">bytes</span><span class="op" id="8234902">.</span><span class="ident" id="8234903">Repeat</span><span class="op" id="8234909">(</span><span class="op" id="8234910">[</span><span class="op" id="8234911">]</span><span class="builtintype" id="8234912">byte</span><span class="op" id="8234916">{</span><span class="string" id="8234917">&#39;x&#39;</span><span class="op" id="8234920">}</span><span class="op" id="8234921">,</span>&nbsp;<span class="num" id="8234923">2500</span><span class="op" id="8234927">)</span><span class="op" id="8234928">,</span>&nbsp;<span class="ident" id="8234930">rbuf</span><span class="op" id="8234934">)</span>&nbsp;<span class="op" id="8234936">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234941">fatalf</span><span class="op" id="8234947">(</span><span class="string" id="8234948">&#34;ReadFull&nbsp;didn&#39;t&nbsp;read&nbsp;2500&nbsp;&#39;x&#39;;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8234987">,</span>&nbsp;<span class="builtintype" id="8234989">string</span><span class="op" id="8234995">(</span><span class="ident" id="8234996">rbuf</span><span class="op" id="8235000">)</span><span class="op" id="8235001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8235005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235009">resp</span><span class="op" id="8235013">.</span><span class="ident" id="8235014">Body</span><span class="op" id="8235018">.</span><span class="ident" id="8235019">Close</span><span class="op" id="8235024">(</span><span class="op" id="8235025">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235030">rest</span><span class="op" id="8235034">,</span>&nbsp;<span class="ident" id="8235036">err</span>&nbsp;<span class="op" id="8235040">:=</span>&nbsp;<span class="ident" id="8235043">ioutil</span><span class="op" id="8235049">.</span><span class="ident" id="8235050">ReadAll</span><span class="op" id="8235057">(</span><span class="ident" id="8235058">bufr</span><span class="op" id="8235062">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235066">checkErr</span><span class="op" id="8235074">(</span><span class="ident" id="8235075">err</span><span class="op" id="8235078">,</span>&nbsp;<span class="string" id="8235080">&#34;ReadAll&nbsp;on&nbsp;remainder&#34;</span><span class="op" id="8235102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8235106">if</span>&nbsp;<span class="ident" id="8235109">e</span><span class="op" id="8235110">,</span>&nbsp;<span class="ident" id="8235112">g</span>&nbsp;<span class="op" id="8235114">:=</span>&nbsp;<span class="string" id="8235117">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="8235136">,</span>&nbsp;<span class="builtintype" id="8235138">string</span><span class="op" id="8235144">(</span><span class="ident" id="8235145">rest</span><span class="op" id="8235149">)</span><span class="op" id="8235150">;</span>&nbsp;<span class="ident" id="8235152">e</span>&nbsp;<span class="op" id="8235154">!=</span>&nbsp;<span class="ident" id="8235157">g</span>&nbsp;<span class="op" id="8235159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235164">g</span>&nbsp;<span class="op" id="8235166">=</span>&nbsp;<span class="ident" id="8235168">regexp</span><span class="op" id="8235174">.</span><span class="ident" id="8235175">MustCompile</span><span class="op" id="8235186">(</span><span class="string" id="8235187">`(xx+)`</span><span class="op" id="8235194">)</span><span class="op" id="8235195">.</span><span class="ident" id="8235196">ReplaceAllStringFunc</span><span class="op" id="8235216">(</span><span class="ident" id="8235217">g</span><span class="op" id="8235218">,</span>&nbsp;<span class="keyword" id="8235220">func</span><span class="op" id="8235224">(</span><span class="ident" id="8235225">match</span>&nbsp;<span class="builtintype" id="8235231">string</span><span class="op" id="8235237">)</span>&nbsp;<span class="builtintype" id="8235239">string</span>&nbsp;<span class="op" id="8235246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8235252">return</span>&nbsp;<span class="ident" id="8235259">fmt</span><span class="op" id="8235262">.</span><span class="ident" id="8235263">Sprintf</span><span class="op" id="8235270">(</span><span class="string" id="8235271">&#34;x(repeated&nbsp;x%d)&#34;</span><span class="op" id="8235288">,</span>&nbsp;<span class="builtinfunc" id="8235290">len</span><span class="op" id="8235293">(</span><span class="ident" id="8235294">match</span><span class="op" id="8235299">)</span><span class="op" id="8235300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8235305">}</span><span class="op" id="8235306">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235311">fatalf</span><span class="op" id="8235317">(</span><span class="string" id="8235318">&#34;remainder&nbsp;=&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="8235347">,</span>&nbsp;<span class="ident" id="8235349">g</span><span class="op" id="8235350">,</span>&nbsp;<span class="ident" id="8235352">e</span><span class="op" id="8235353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8235357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8235360">}</span><br>
<span class="lineno"></span><span class="op" id="8235362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="keyword" id="8235365">func</span>&nbsp;<span class="ident" id="8235370">diff</span><span class="op" id="8235374">(</span><span class="ident" id="8235375">t</span>&nbsp;<span class="op" id="8235377">*</span><span class="ident" id="8235378">testing</span><span class="op" id="8235385">.</span><span class="ident" id="8235386">T</span><span class="op" id="8235387">,</span>&nbsp;<span class="ident" id="8235389">prefix</span>&nbsp;<span class="builtintype" id="8235396">string</span><span class="op" id="8235402">,</span>&nbsp;<span class="ident" id="8235404">have</span><span class="op" id="8235408">,</span>&nbsp;<span class="ident" id="8235410">want</span>&nbsp;<span class="keyword" id="8235415">interface</span><span class="op" id="8235424">{</span><span class="op" id="8235425">}</span><span class="op" id="8235426">)</span>&nbsp;<span class="op" id="8235428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235431">hv</span>&nbsp;<span class="op" id="8235434">:=</span>&nbsp;<span class="ident" id="8235437">reflect</span><span class="op" id="8235444">.</span><span class="ident" id="8235445">ValueOf</span><span class="op" id="8235452">(</span><span class="ident" id="8235453">have</span><span class="op" id="8235457">)</span><span class="op" id="8235458">.</span><span class="ident" id="8235459">Elem</span><span class="op" id="8235463">(</span><span class="op" id="8235464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235467">wv</span>&nbsp;<span class="op" id="8235470">:=</span>&nbsp;<span class="ident" id="8235473">reflect</span><span class="op" id="8235480">.</span><span class="ident" id="8235481">ValueOf</span><span class="op" id="8235488">(</span><span class="ident" id="8235489">want</span><span class="op" id="8235493">)</span><span class="op" id="8235494">.</span><span class="ident" id="8235495">Elem</span><span class="op" id="8235499">(</span><span class="op" id="8235500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8235503">if</span>&nbsp;<span class="ident" id="8235506">hv</span><span class="op" id="8235508">.</span><span class="ident" id="8235509">Type</span><span class="op" id="8235513">(</span><span class="op" id="8235514">)</span>&nbsp;<span class="op" id="8235516">!=</span>&nbsp;<span class="ident" id="8235519">wv</span><span class="op" id="8235521">.</span><span class="ident" id="8235522">Type</span><span class="op" id="8235526">(</span><span class="op" id="8235527">)</span>&nbsp;<span class="op" id="8235529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235533">t</span><span class="op" id="8235534">.</span><span class="ident" id="8235535">Errorf</span><span class="op" id="8235541">(</span><span class="string" id="8235542">&#34;%s:&nbsp;type&nbsp;mismatch&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8235572">,</span>&nbsp;<span class="ident" id="8235574">prefix</span><span class="op" id="8235580">,</span>&nbsp;<span class="ident" id="8235582">hv</span><span class="op" id="8235584">.</span><span class="ident" id="8235585">Type</span><span class="op" id="8235589">(</span><span class="op" id="8235590">)</span><span class="op" id="8235591">,</span>&nbsp;<span class="ident" id="8235593">wv</span><span class="op" id="8235595">.</span><span class="ident" id="8235596">Type</span><span class="op" id="8235600">(</span><span class="op" id="8235601">)</span><span class="op" id="8235602">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8235605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8235608">for</span>&nbsp;<span class="ident" id="8235612">i</span>&nbsp;<span class="op" id="8235614">:=</span>&nbsp;<span class="num" id="8235617">0</span><span class="op" id="8235618">;</span>&nbsp;<span class="ident" id="8235620">i</span>&nbsp;<span class="op" id="8235622">&lt;</span>&nbsp;<span class="ident" id="8235624">hv</span><span class="op" id="8235626">.</span><span class="ident" id="8235627">NumField</span><span class="op" id="8235635">(</span><span class="op" id="8235636">)</span><span class="op" id="8235637">;</span>&nbsp;<span class="ident" id="8235639">i</span><span class="op" id="8235640">++</span>&nbsp;<span class="op" id="8235643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235647">hf</span>&nbsp;<span class="op" id="8235650">:=</span>&nbsp;<span class="ident" id="8235653">hv</span><span class="op" id="8235655">.</span><span class="ident" id="8235656">Field</span><span class="op" id="8235661">(</span><span class="ident" id="8235662">i</span><span class="op" id="8235663">)</span><span class="op" id="8235664">.</span><span class="ident" id="8235665">Interface</span><span class="op" id="8235674">(</span><span class="op" id="8235675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235679">wf</span>&nbsp;<span class="op" id="8235682">:=</span>&nbsp;<span class="ident" id="8235685">wv</span><span class="op" id="8235687">.</span><span class="ident" id="8235688">Field</span><span class="op" id="8235693">(</span><span class="ident" id="8235694">i</span><span class="op" id="8235695">)</span><span class="op" id="8235696">.</span><span class="ident" id="8235697">Interface</span><span class="op" id="8235706">(</span><span class="op" id="8235707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8235711">if</span>&nbsp;<span class="op" id="8235714">!</span><span class="ident" id="8235715">reflect</span><span class="op" id="8235722">.</span><span class="ident" id="8235723">DeepEqual</span><span class="op" id="8235732">(</span><span class="ident" id="8235733">hf</span><span class="op" id="8235735">,</span>&nbsp;<span class="ident" id="8235737">wf</span><span class="op" id="8235739">)</span>&nbsp;<span class="op" id="8235741">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235746">t</span><span class="op" id="8235747">.</span><span class="ident" id="8235748">Errorf</span><span class="op" id="8235754">(</span><span class="string" id="8235755">&#34;%s:&nbsp;%s&nbsp;=&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8235776">,</span>&nbsp;<span class="ident" id="8235778">prefix</span><span class="op" id="8235784">,</span>&nbsp;<span class="ident" id="8235786">hv</span><span class="op" id="8235788">.</span><span class="ident" id="8235789">Type</span><span class="op" id="8235793">(</span><span class="op" id="8235794">)</span><span class="op" id="8235795">.</span><span class="ident" id="8235796">Field</span><span class="op" id="8235801">(</span><span class="ident" id="8235802">i</span><span class="op" id="8235803">)</span><span class="op" id="8235804">.</span><span class="ident" id="8235805">Name</span><span class="op" id="8235809">,</span>&nbsp;<span class="ident" id="8235811">hf</span><span class="op" id="8235813">,</span>&nbsp;<span class="ident" id="8235815">wf</span><span class="op" id="8235817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8235821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8235824">}</span><br>
<span class="lineno"></span><span class="op" id="8235826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">565</span><span class="keyword" id="8235829">type</span>&nbsp;<span class="ident" id="8235834">responseLocationTest</span>&nbsp;<span class="keyword" id="8235855">struct</span>&nbsp;<span class="op" id="8235862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235865">location</span>&nbsp;<span class="builtintype" id="8235874">string</span>&nbsp;<span class="comment" id="8235881">//&nbsp;Response&#39;s&nbsp;Location&nbsp;header&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235918">requrl</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8235927">string</span>&nbsp;<span class="comment" id="8235934">//&nbsp;Response.Request.URL&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235965">want</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8235974">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235982">wantErr</span>&nbsp;&nbsp;<span class="builtintype" id="8235991">error</span><br>
<span class="lineno">570</span><span class="op" id="8235997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8236000">var</span>&nbsp;<span class="ident" id="8236004">responseLocationTests</span>&nbsp;<span class="op" id="8236026">=</span>&nbsp;<span class="op" id="8236028">[</span><span class="op" id="8236029">]</span><span class="ident" id="8236030">responseLocationTest</span><span class="op" id="8236050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236053">{</span><span class="string" id="8236054">&#34;/foo&#34;</span><span class="op" id="8236060">,</span>&nbsp;<span class="string" id="8236062">&#34;http://bar.com/baz&#34;</span><span class="op" id="8236082">,</span>&nbsp;<span class="string" id="8236084">&#34;http://bar.com/foo&#34;</span><span class="op" id="8236104">,</span>&nbsp;<span class="ident" id="8236106">nil</span><span class="op" id="8236109">}</span><span class="op" id="8236110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236113">{</span><span class="string" id="8236114">&#34;http://foo.com/&#34;</span><span class="op" id="8236131">,</span>&nbsp;<span class="string" id="8236133">&#34;http://bar.com/baz&#34;</span><span class="op" id="8236153">,</span>&nbsp;<span class="string" id="8236155">&#34;http://foo.com/&#34;</span><span class="op" id="8236172">,</span>&nbsp;<span class="ident" id="8236174">nil</span><span class="op" id="8236177">}</span><span class="op" id="8236178">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236181">{</span><span class="string" id="8236182">&#34;&#34;</span><span class="op" id="8236184">,</span>&nbsp;<span class="string" id="8236186">&#34;http://bar.com/baz&#34;</span><span class="op" id="8236206">,</span>&nbsp;<span class="string" id="8236208">&#34;&#34;</span><span class="op" id="8236210">,</span>&nbsp;<span class="ident" id="8236212">ErrNoLocation</span><span class="op" id="8236225">}</span><span class="op" id="8236226">,</span><br>
<span class="lineno"></span><span class="op" id="8236228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8236231">func</span>&nbsp;<span class="ident" id="8236236">TestLocationResponse</span><span class="op" id="8236256">(</span><span class="ident" id="8236257">t</span>&nbsp;<span class="op" id="8236259">*</span><span class="ident" id="8236260">testing</span><span class="op" id="8236267">.</span><span class="ident" id="8236268">T</span><span class="op" id="8236269">)</span>&nbsp;<span class="op" id="8236271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236274">for</span>&nbsp;<span class="ident" id="8236278">i</span><span class="op" id="8236279">,</span>&nbsp;<span class="ident" id="8236281">tt</span>&nbsp;<span class="op" id="8236284">:=</span>&nbsp;<span class="keyword" id="8236287">range</span>&nbsp;<span class="ident" id="8236293">responseLocationTests</span>&nbsp;<span class="op" id="8236315">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236319">res</span>&nbsp;<span class="op" id="8236323">:=</span>&nbsp;<span class="builtinfunc" id="8236326">new</span><span class="op" id="8236329">(</span><span class="ident" id="8236330">Response</span><span class="op" id="8236338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236342">res</span><span class="op" id="8236345">.</span><span class="ident" id="8236346">Header</span>&nbsp;<span class="op" id="8236353">=</span>&nbsp;<span class="builtinfunc" id="8236355">make</span><span class="op" id="8236359">(</span><span class="ident" id="8236360">Header</span><span class="op" id="8236366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236370">res</span><span class="op" id="8236373">.</span><span class="ident" id="8236374">Header</span><span class="op" id="8236380">.</span><span class="ident" id="8236381">Set</span><span class="op" id="8236384">(</span><span class="string" id="8236385">&#34;Location&#34;</span><span class="op" id="8236395">,</span>&nbsp;<span class="ident" id="8236397">tt</span><span class="op" id="8236399">.</span><span class="ident" id="8236400">location</span><span class="op" id="8236408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236412">if</span>&nbsp;<span class="ident" id="8236415">tt</span><span class="op" id="8236417">.</span><span class="ident" id="8236418">requrl</span>&nbsp;<span class="op" id="8236425">!=</span>&nbsp;<span class="string" id="8236428">&#34;&#34;</span>&nbsp;<span class="op" id="8236431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236436">res</span><span class="op" id="8236439">.</span><span class="ident" id="8236440">Request</span>&nbsp;<span class="op" id="8236448">=</span>&nbsp;<span class="op" id="8236450">&amp;</span><span class="ident" id="8236451">Request</span><span class="op" id="8236458">{</span><span class="op" id="8236459">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236464">var</span>&nbsp;<span class="ident" id="8236468">err</span>&nbsp;<span class="builtintype" id="8236472">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236481">res</span><span class="op" id="8236484">.</span><span class="ident" id="8236485">Request</span><span class="op" id="8236492">.</span><span class="ident" id="8236493">URL</span><span class="op" id="8236496">,</span>&nbsp;<span class="ident" id="8236498">err</span>&nbsp;<span class="op" id="8236502">=</span>&nbsp;<span class="ident" id="8236504">url</span><span class="op" id="8236507">.</span><span class="ident" id="8236508">Parse</span><span class="op" id="8236513">(</span><span class="ident" id="8236514">tt</span><span class="op" id="8236516">.</span><span class="ident" id="8236517">requrl</span><span class="op" id="8236523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236528">if</span>&nbsp;<span class="ident" id="8236531">err</span>&nbsp;<span class="op" id="8236535">!=</span>&nbsp;<span class="ident" id="8236538">nil</span>&nbsp;<span class="op" id="8236542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236548">t</span><span class="op" id="8236549">.</span><span class="ident" id="8236550">Fatalf</span><span class="op" id="8236556">(</span><span class="string" id="8236557">&#34;bad&nbsp;test&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="8236578">,</span>&nbsp;<span class="ident" id="8236580">tt</span><span class="op" id="8236582">.</span><span class="ident" id="8236583">requrl</span><span class="op" id="8236589">,</span>&nbsp;<span class="ident" id="8236591">err</span><span class="op" id="8236594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236599">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236608">got</span><span class="op" id="8236611">,</span>&nbsp;<span class="ident" id="8236613">err</span>&nbsp;<span class="op" id="8236617">:=</span>&nbsp;<span class="ident" id="8236620">res</span><span class="op" id="8236623">.</span><span class="ident" id="8236624">Location</span><span class="op" id="8236632">(</span><span class="op" id="8236633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236637">if</span>&nbsp;<span class="ident" id="8236640">tt</span><span class="op" id="8236642">.</span><span class="ident" id="8236643">wantErr</span>&nbsp;<span class="op" id="8236651">!=</span>&nbsp;<span class="ident" id="8236654">nil</span>&nbsp;<span class="op" id="8236658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236663">if</span>&nbsp;<span class="ident" id="8236666">err</span>&nbsp;<span class="op" id="8236670">==</span>&nbsp;<span class="ident" id="8236673">nil</span>&nbsp;<span class="op" id="8236677">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236683">t</span><span class="op" id="8236684">.</span><span class="ident" id="8236685">Errorf</span><span class="op" id="8236691">(</span><span class="string" id="8236692">&#34;%d.&nbsp;err=nil;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8236714">,</span>&nbsp;<span class="ident" id="8236716">i</span><span class="op" id="8236717">,</span>&nbsp;<span class="ident" id="8236719">tt</span><span class="op" id="8236721">.</span><span class="ident" id="8236722">wantErr</span><span class="op" id="8236729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236735">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236752">if</span>&nbsp;<span class="ident" id="8236755">g</span><span class="op" id="8236756">,</span>&nbsp;<span class="ident" id="8236758">e</span>&nbsp;<span class="op" id="8236760">:=</span>&nbsp;<span class="ident" id="8236763">err</span><span class="op" id="8236766">.</span><span class="ident" id="8236767">Error</span><span class="op" id="8236772">(</span><span class="op" id="8236773">)</span><span class="op" id="8236774">,</span>&nbsp;<span class="ident" id="8236776">tt</span><span class="op" id="8236778">.</span><span class="ident" id="8236779">wantErr</span><span class="op" id="8236786">.</span><span class="ident" id="8236787">Error</span><span class="op" id="8236792">(</span><span class="op" id="8236793">)</span><span class="op" id="8236794">;</span>&nbsp;<span class="ident" id="8236796">g</span>&nbsp;<span class="op" id="8236798">!=</span>&nbsp;<span class="ident" id="8236801">e</span>&nbsp;<span class="op" id="8236803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236809">t</span><span class="op" id="8236810">.</span><span class="ident" id="8236811">Errorf</span><span class="op" id="8236817">(</span><span class="string" id="8236818">&#34;%d.&nbsp;err=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8236839">,</span>&nbsp;<span class="ident" id="8236841">i</span><span class="op" id="8236842">,</span>&nbsp;<span class="ident" id="8236844">g</span><span class="op" id="8236845">,</span>&nbsp;<span class="ident" id="8236847">e</span><span class="op" id="8236848">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236854">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236871">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236886">if</span>&nbsp;<span class="ident" id="8236889">err</span>&nbsp;<span class="op" id="8236893">!=</span>&nbsp;<span class="ident" id="8236896">nil</span>&nbsp;<span class="op" id="8236900">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236905">t</span><span class="op" id="8236906">.</span><span class="ident" id="8236907">Errorf</span><span class="op" id="8236913">(</span><span class="string" id="8236914">&#34;%d.&nbsp;err=%q&#34;</span><span class="op" id="8236926">,</span>&nbsp;<span class="ident" id="8236928">i</span><span class="op" id="8236929">,</span>&nbsp;<span class="ident" id="8236931">err</span><span class="op" id="8236934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236939">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236954">if</span>&nbsp;<span class="ident" id="8236957">g</span><span class="op" id="8236958">,</span>&nbsp;<span class="ident" id="8236960">e</span>&nbsp;<span class="op" id="8236962">:=</span>&nbsp;<span class="ident" id="8236965">got</span><span class="op" id="8236968">.</span><span class="ident" id="8236969">String</span><span class="op" id="8236975">(</span><span class="op" id="8236976">)</span><span class="op" id="8236977">,</span>&nbsp;<span class="ident" id="8236979">tt</span><span class="op" id="8236981">.</span><span class="ident" id="8236982">want</span><span class="op" id="8236986">;</span>&nbsp;<span class="ident" id="8236988">g</span>&nbsp;<span class="op" id="8236990">!=</span>&nbsp;<span class="ident" id="8236993">e</span>&nbsp;<span class="op" id="8236995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237000">t</span><span class="op" id="8237001">.</span><span class="ident" id="8237002">Errorf</span><span class="op" id="8237008">(</span><span class="string" id="8237009">&#34;%d.&nbsp;Location=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8237035">,</span>&nbsp;<span class="ident" id="8237037">i</span><span class="op" id="8237038">,</span>&nbsp;<span class="ident" id="8237040">g</span><span class="op" id="8237041">,</span>&nbsp;<span class="ident" id="8237043">e</span><span class="op" id="8237044">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8237048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8237051">}</span><br>
<span class="lineno"></span><span class="op" id="8237053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8237056">func</span>&nbsp;<span class="ident" id="8237061">TestResponseStatusStutter</span><span class="op" id="8237086">(</span><span class="ident" id="8237087">t</span>&nbsp;<span class="op" id="8237089">*</span><span class="ident" id="8237090">testing</span><span class="op" id="8237097">.</span><span class="ident" id="8237098">T</span><span class="op" id="8237099">)</span>&nbsp;<span class="op" id="8237101">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237104">r</span>&nbsp;<span class="op" id="8237106">:=</span>&nbsp;<span class="op" id="8237109">&amp;</span><span class="ident" id="8237110">Response</span><span class="op" id="8237118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237122">Status</span><span class="op" id="8237128">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8237134">&#34;123&nbsp;some&nbsp;status&#34;</span><span class="op" id="8237151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237155">StatusCode</span><span class="op" id="8237165">:</span>&nbsp;<span class="num" id="8237167">123</span><span class="op" id="8237170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237174">ProtoMajor</span><span class="op" id="8237184">:</span>&nbsp;<span class="num" id="8237186">1</span><span class="op" id="8237187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237191">ProtoMinor</span><span class="op" id="8237201">:</span>&nbsp;<span class="num" id="8237203">3</span><span class="op" id="8237204">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8237207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8237210">var</span>&nbsp;<span class="ident" id="8237214">buf</span>&nbsp;<span class="ident" id="8237218">bytes</span><span class="op" id="8237223">.</span><span class="ident" id="8237224">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237232">r</span><span class="op" id="8237233">.</span><span class="ident" id="8237234">Write</span><span class="op" id="8237239">(</span><span class="op" id="8237240">&amp;</span><span class="ident" id="8237241">buf</span><span class="op" id="8237244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8237247">if</span>&nbsp;<span class="ident" id="8237250">strings</span><span class="op" id="8237257">.</span><span class="ident" id="8237258">Contains</span><span class="op" id="8237266">(</span><span class="ident" id="8237267">buf</span><span class="op" id="8237270">.</span><span class="ident" id="8237271">String</span><span class="op" id="8237277">(</span><span class="op" id="8237278">)</span><span class="op" id="8237279">,</span>&nbsp;<span class="string" id="8237281">&#34;123&nbsp;123&#34;</span><span class="op" id="8237290">)</span>&nbsp;<span class="op" id="8237292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237296">t</span><span class="op" id="8237297">.</span><span class="ident" id="8237298">Errorf</span><span class="op" id="8237304">(</span><span class="string" id="8237305">&#34;stutter&nbsp;in&nbsp;status:&nbsp;%s&#34;</span><span class="op" id="8237328">,</span>&nbsp;<span class="ident" id="8237330">buf</span><span class="op" id="8237333">.</span><span class="ident" id="8237334">String</span><span class="op" id="8237340">(</span><span class="op" id="8237341">)</span><span class="op" id="8237342">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8237345">}</span><br>
<span class="lineno"></span><span class="op" id="8237347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8237350">func</span>&nbsp;<span class="ident" id="8237355">TestResponseContentLengthShortBody</span><span class="op" id="8237389">(</span><span class="ident" id="8237390">t</span>&nbsp;<span class="op" id="8237392">*</span><span class="ident" id="8237393">testing</span><span class="op" id="8237400">.</span><span class="ident" id="8237401">T</span><span class="op" id="8237402">)</span>&nbsp;<span class="op" id="8237404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8237407">const</span>&nbsp;<span class="ident" id="8237413">shortBody</span>&nbsp;<span class="op" id="8237423">=</span>&nbsp;<span class="string" id="8237425">&#34;Short&nbsp;body,&nbsp;not&nbsp;123&nbsp;bytes.&#34;</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237455">br</span>&nbsp;<span class="op" id="8237458">:=</span>&nbsp;<span class="ident" id="8237461">bufio</span><span class="op" id="8237466">.</span><span class="ident" id="8237467">NewReader</span><span class="op" id="8237476">(</span><span class="ident" id="8237477">strings</span><span class="op" id="8237484">.</span><span class="ident" id="8237485">NewReader</span><span class="op" id="8237494">(</span><span class="string" id="8237495">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8237517">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8237521">&#34;Content-Length:&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="8237547">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8237551">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8237558">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237562">shortBody</span><span class="op" id="8237571">)</span><span class="op" id="8237572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237575">res</span><span class="op" id="8237578">,</span>&nbsp;<span class="ident" id="8237580">err</span>&nbsp;<span class="op" id="8237584">:=</span>&nbsp;<span class="ident" id="8237587">ReadResponse</span><span class="op" id="8237599">(</span><span class="ident" id="8237600">br</span><span class="op" id="8237602">,</span>&nbsp;<span class="op" id="8237604">&amp;</span><span class="ident" id="8237605">Request</span><span class="op" id="8237612">{</span><span class="ident" id="8237613">Method</span><span class="op" id="8237619">:</span>&nbsp;<span class="string" id="8237621">&#34;GET&#34;</span><span class="op" id="8237626">}</span><span class="op" id="8237627">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8237630">if</span>&nbsp;<span class="ident" id="8237633">err</span>&nbsp;<span class="op" id="8237637">!=</span>&nbsp;<span class="ident" id="8237640">nil</span>&nbsp;<span class="op" id="8237644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237648">t</span><span class="op" id="8237649">.</span><span class="ident" id="8237650">Fatal</span><span class="op" id="8237655">(</span><span class="ident" id="8237656">err</span><span class="op" id="8237659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8237662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8237665">if</span>&nbsp;<span class="ident" id="8237668">res</span><span class="op" id="8237671">.</span><span class="ident" id="8237672">ContentLength</span>&nbsp;<span class="op" id="8237686">!=</span>&nbsp;<span class="num" id="8237689">123</span>&nbsp;<span class="op" id="8237693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237697">t</span><span class="op" id="8237698">.</span><span class="ident" id="8237699">Fatalf</span><span class="op" id="8237705">(</span><span class="string" id="8237706">&#34;Content-Length&nbsp;=&nbsp;%d;&nbsp;want&nbsp;123&#34;</span><span class="op" id="8237737">,</span>&nbsp;<span class="ident" id="8237739">res</span><span class="op" id="8237742">.</span><span class="ident" id="8237743">ContentLength</span><span class="op" id="8237756">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8237759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8237762">var</span>&nbsp;<span class="ident" id="8237766">buf</span>&nbsp;<span class="ident" id="8237770">bytes</span><span class="op" id="8237775">.</span><span class="ident" id="8237776">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237784">n</span><span class="op" id="8237785">,</span>&nbsp;<span class="ident" id="8237787">err</span>&nbsp;<span class="op" id="8237791">:=</span>&nbsp;<span class="ident" id="8237794">io</span><span class="op" id="8237796">.</span><span class="ident" id="8237797">Copy</span><span class="op" id="8237801">(</span><span class="op" id="8237802">&amp;</span><span class="ident" id="8237803">buf</span><span class="op" id="8237806">,</span>&nbsp;<span class="ident" id="8237808">res</span><span class="op" id="8237811">.</span><span class="ident" id="8237812">Body</span><span class="op" id="8237816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8237819">if</span>&nbsp;<span class="ident" id="8237822">n</span>&nbsp;<span class="op" id="8237824">!=</span>&nbsp;<span class="ident" id="8237827">int64</span><span class="op" id="8237832">(</span><span class="builtinfunc" id="8237833">len</span><span class="op" id="8237836">(</span><span class="ident" id="8237837">shortBody</span><span class="op" id="8237846">)</span><span class="op" id="8237847">)</span>&nbsp;<span class="op" id="8237849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237853">t</span><span class="op" id="8237854">.</span><span class="ident" id="8237855">Errorf</span><span class="op" id="8237861">(</span><span class="string" id="8237862">&#34;Copied&nbsp;%d&nbsp;bytes;&nbsp;want&nbsp;%d,&nbsp;len(%q)&#34;</span><span class="op" id="8237897">,</span>&nbsp;<span class="ident" id="8237899">n</span><span class="op" id="8237900">,</span>&nbsp;<span class="builtinfunc" id="8237902">len</span><span class="op" id="8237905">(</span><span class="ident" id="8237906">shortBody</span><span class="op" id="8237915">)</span><span class="op" id="8237916">,</span>&nbsp;<span class="ident" id="8237918">shortBody</span><span class="op" id="8237927">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8237930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8237933">if</span>&nbsp;<span class="ident" id="8237936">buf</span><span class="op" id="8237939">.</span><span class="ident" id="8237940">String</span><span class="op" id="8237946">(</span><span class="op" id="8237947">)</span>&nbsp;<span class="op" id="8237949">!=</span>&nbsp;<span class="ident" id="8237952">shortBody</span>&nbsp;<span class="op" id="8237962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237966">t</span><span class="op" id="8237967">.</span><span class="ident" id="8237968">Errorf</span><span class="op" id="8237974">(</span><span class="string" id="8237975">&#34;Read&nbsp;body&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8237998">,</span>&nbsp;<span class="ident" id="8238000">buf</span><span class="op" id="8238003">.</span><span class="ident" id="8238004">String</span><span class="op" id="8238010">(</span><span class="op" id="8238011">)</span><span class="op" id="8238012">,</span>&nbsp;<span class="ident" id="8238014">shortBody</span><span class="op" id="8238023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8238026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8238029">if</span>&nbsp;<span class="ident" id="8238032">err</span>&nbsp;<span class="op" id="8238036">!=</span>&nbsp;<span class="ident" id="8238039">io</span><span class="op" id="8238041">.</span><span class="ident" id="8238042">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="8238059">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8238063">t</span><span class="op" id="8238064">.</span><span class="ident" id="8238065">Errorf</span><span class="op" id="8238071">(</span><span class="string" id="8238072">&#34;io.Copy&nbsp;error&nbsp;=&nbsp;%#v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="8238119">,</span>&nbsp;<span class="ident" id="8238121">err</span><span class="op" id="8238124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8238127">}</span><br>
<span class="lineno"></span><span class="op" id="8238129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8238132">func</span>&nbsp;<span class="ident" id="8238137">TestReadResponseUnexpectedEOF</span><span class="op" id="8238166">(</span><span class="ident" id="8238167">t</span>&nbsp;<span class="op" id="8238169">*</span><span class="ident" id="8238170">testing</span><span class="op" id="8238177">.</span><span class="ident" id="8238178">T</span><span class="op" id="8238179">)</span>&nbsp;<span class="op" id="8238181">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8238184">br</span>&nbsp;<span class="op" id="8238187">:=</span>&nbsp;<span class="ident" id="8238190">bufio</span><span class="op" id="8238195">.</span><span class="ident" id="8238196">NewReader</span><span class="op" id="8238205">(</span><span class="ident" id="8238206">strings</span><span class="op" id="8238213">.</span><span class="ident" id="8238214">NewReader</span><span class="op" id="8238223">(</span><span class="string" id="8238224">&#34;HTTP/1.1&nbsp;301&nbsp;Moved&nbsp;Permanently\r\n&#34;</span>&nbsp;<span class="op" id="8238261">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8238265">&#34;Location:&nbsp;http://example.com&#34;</span><span class="op" id="8238295">)</span><span class="op" id="8238296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8238299">_</span><span class="op" id="8238300">,</span>&nbsp;<span class="ident" id="8238302">err</span>&nbsp;<span class="op" id="8238306">:=</span>&nbsp;<span class="ident" id="8238309">ReadResponse</span><span class="op" id="8238321">(</span><span class="ident" id="8238322">br</span><span class="op" id="8238324">,</span>&nbsp;<span class="ident" id="8238326">nil</span><span class="op" id="8238329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8238332">if</span>&nbsp;<span class="ident" id="8238335">err</span>&nbsp;<span class="op" id="8238339">!=</span>&nbsp;<span class="ident" id="8238342">io</span><span class="op" id="8238344">.</span><span class="ident" id="8238345">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="8238362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8238366">t</span><span class="op" id="8238367">.</span><span class="ident" id="8238368">Errorf</span><span class="op" id="8238374">(</span><span class="string" id="8238375">&#34;ReadResponse&nbsp;=&nbsp;%v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="8238420">,</span>&nbsp;<span class="ident" id="8238422">err</span><span class="op" id="8238425">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8238428">}</span><br>
<span class="lineno"></span><span class="op" id="8238430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8238433">func</span>&nbsp;<span class="ident" id="8238438">TestNeedsSniff</span><span class="op" id="8238452">(</span><span class="ident" id="8238453">t</span>&nbsp;<span class="op" id="8238455">*</span><span class="ident" id="8238456">testing</span><span class="op" id="8238463">.</span><span class="ident" id="8238464">T</span><span class="op" id="8238465">)</span>&nbsp;<span class="op" id="8238467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8238470">//&nbsp;needsSniff&nbsp;returns&nbsp;true&nbsp;with&nbsp;an&nbsp;empty&nbsp;response.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8238522">r</span>&nbsp;<span class="op" id="8238524">:=</span>&nbsp;<span class="op" id="8238527">&amp;</span><span class="ident" id="8238528">response</span><span class="op" id="8238536">{</span><span class="op" id="8238537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8238540">if</span>&nbsp;<span class="ident" id="8238543">got</span><span class="op" id="8238546">,</span>&nbsp;<span class="ident" id="8238548">want</span>&nbsp;<span class="op" id="8238553">:=</span>&nbsp;<span class="ident" id="8238556">r</span><span class="op" id="8238557">.</span><span class="ident" id="8238558">needsSniff</span><span class="op" id="8238568">(</span><span class="op" id="8238569">)</span><span class="op" id="8238570">,</span>&nbsp;<span class="builtintype" id="8238572">true</span><span class="op" id="8238576">;</span>&nbsp;<span class="ident" id="8238578">got</span>&nbsp;<span class="op" id="8238582">!=</span>&nbsp;<span class="ident" id="8238585">want</span>&nbsp;<span class="op" id="8238590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8238594">t</span><span class="op" id="8238595">.</span><span class="ident" id="8238596">Errorf</span><span class="op" id="8238602">(</span><span class="string" id="8238603">&#34;needsSniff&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="8238629">,</span>&nbsp;<span class="ident" id="8238631">got</span><span class="op" id="8238634">,</span>&nbsp;<span class="ident" id="8238636">want</span><span class="op" id="8238640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8238643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8238646">//&nbsp;needsSniff&nbsp;returns&nbsp;false&nbsp;when&nbsp;Content-Type&nbsp;=&nbsp;nil.</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8238700">r</span><span class="op" id="8238701">.</span><span class="ident" id="8238702">handlerHeader</span>&nbsp;<span class="op" id="8238716">=</span>&nbsp;<span class="ident" id="8238718">Header</span><span class="op" id="8238724">{</span><span class="string" id="8238725">&#34;Content-Type&#34;</span><span class="op" id="8238739">:</span>&nbsp;<span class="ident" id="8238741">nil</span><span class="op" id="8238744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8238747">if</span>&nbsp;<span class="ident" id="8238750">got</span><span class="op" id="8238753">,</span>&nbsp;<span class="ident" id="8238755">want</span>&nbsp;<span class="op" id="8238760">:=</span>&nbsp;<span class="ident" id="8238763">r</span><span class="op" id="8238764">.</span><span class="ident" id="8238765">needsSniff</span><span class="op" id="8238775">(</span><span class="op" id="8238776">)</span><span class="op" id="8238777">,</span>&nbsp;<span class="builtintype" id="8238779">false</span><span class="op" id="8238784">;</span>&nbsp;<span class="ident" id="8238786">got</span>&nbsp;<span class="op" id="8238790">!=</span>&nbsp;<span class="ident" id="8238793">want</span>&nbsp;<span class="op" id="8238798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8238802">t</span><span class="op" id="8238803">.</span><span class="ident" id="8238804">Errorf</span><span class="op" id="8238810">(</span><span class="string" id="8238811">&#34;needsSniff&nbsp;empty&nbsp;Content-Type&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="8238856">,</span>&nbsp;<span class="ident" id="8238858">got</span><span class="op" id="8238861">,</span>&nbsp;<span class="ident" id="8238863">want</span><span class="op" id="8238867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8238870">}</span><br>
<span class="lineno"></span><span class="op" id="8238872">}</span>
</div>
</body>
</html>
