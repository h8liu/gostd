<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/ascii85</h2>
<ul>
<li><a href="/gostd/encoding/ascii85/ascii85.go.html">ascii85.go</a></li>
<li><a href="/gostd/encoding/ascii85/ascii85_test.go.html" class="current">ascii85_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7223189">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7223244">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7223298">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7223349">package</span>&nbsp;<span class="ident" id="7223357">ascii85</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7223366">import</span>&nbsp;<span class="op" id="7223373">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223376">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223385">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223391">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223404">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223415">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7223425">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="7223428">type</span>&nbsp;<span class="ident" id="7223433">testpair</span>&nbsp;<span class="keyword" id="7223442">struct</span>&nbsp;<span class="op" id="7223449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7223452">decoded</span><span class="op" id="7223459">,</span>&nbsp;<span class="ident" id="7223461">encoded</span>&nbsp;<span class="builtintype" id="7223469">string</span><br>
<span class="lineno"></span><span class="op" id="7223476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7223479">var</span>&nbsp;<span class="ident" id="7223483">pairs</span>&nbsp;<span class="op" id="7223489">=</span>&nbsp;<span class="op" id="7223491">[</span><span class="op" id="7223492">]</span><span class="ident" id="7223493">testpair</span><span class="op" id="7223501">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7223504">//&nbsp;Encode&nbsp;returns&nbsp;0&nbsp;when&nbsp;len(src)&nbsp;is&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7223544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223548">&#34;&#34;</span><span class="op" id="7223550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223554">&#34;&#34;</span><span class="op" id="7223556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7223559">}</span><span class="op" id="7223560">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7223563">//&nbsp;Wikipedia&nbsp;example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7223585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223589">&#34;Man&nbsp;is&nbsp;distinguished,&nbsp;not&nbsp;only&nbsp;by&nbsp;his&nbsp;reason,&nbsp;but&nbsp;by&nbsp;this&nbsp;singular&nbsp;passion&nbsp;from&nbsp;&#34;</span>&nbsp;<span class="op" id="7223672">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223677">&#34;other&nbsp;animals,&nbsp;which&nbsp;is&nbsp;a&nbsp;lust&nbsp;of&nbsp;the&nbsp;mind,&nbsp;that&nbsp;by&nbsp;a&nbsp;perseverance&nbsp;of&nbsp;delight&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="7223761">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223766">&#34;the&nbsp;continued&nbsp;and&nbsp;indefatigable&nbsp;generation&nbsp;of&nbsp;knowledge,&nbsp;exceeds&nbsp;the&nbsp;short&nbsp;&#34;</span>&nbsp;<span class="op" id="7223844">+</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223849">&#34;vehemence&nbsp;of&nbsp;any&nbsp;carnal&nbsp;pleasure.&#34;</span><span class="op" id="7223884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223888">&#34;9jqo^BlbD-BleB1DJ+*+F(f,q/0JhKF&lt;GL&gt;Cj@.4Gp$d7F!,L7@&lt;6@)/0JDEF&lt;G%&lt;+EV:2F!,\n&#34;</span>&nbsp;<span class="op" id="7223966">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7223971">&#34;O&lt;DJ+*.@&lt;*K0@&lt;6L(Df-\\0Ec5e;DffZ(EZee.Bl.9pF\&#34;AGXBPCsi+DGm&gt;@3BB/F*&amp;OCAfu2/AKY\n&#34;</span>&nbsp;<span class="op" id="7224053">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7224058">&#34;i(DIb:@FD,*)+C]U=@3BN#EcYf8ATD3s@q?d$AftVqCh[NqF&lt;G:8+EV:.+Cf&gt;-FD5W8ARlolDIa\n&#34;</span>&nbsp;<span class="op" id="7224138">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7224143">&#34;l(DId&lt;j@&lt;?3r@:F%a+D58&#39;ATD4$Bl@l3De:,-DJs`8ARoFb/0JMK@qB4^F!,R&lt;AKZ&amp;-DfTqBG%G\n&#34;</span>&nbsp;<span class="op" id="7224223">+</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7224228">&#34;&gt;uD.RTpAKYo&#39;+CT/5+Cei#DII?(E,9)oF*2M7/c\n&#34;</span><span class="op" id="7224271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7224274">}</span><span class="op" id="7224275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7224278">//&nbsp;Special&nbsp;case&nbsp;when&nbsp;shortening&nbsp;!!!!!&nbsp;to&nbsp;z.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7224323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7224327">&#34;\000\000\000\000&#34;</span><span class="op" id="7224345">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7224349">&#34;z&#34;</span><span class="op" id="7224352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7224355">}</span><span class="op" id="7224356">,</span><br>
<span class="lineno"></span><span class="op" id="7224358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7224361">var</span>&nbsp;<span class="ident" id="7224365">bigtest</span>&nbsp;<span class="op" id="7224373">=</span>&nbsp;<span class="ident" id="7224375">pairs</span><span class="op" id="7224380">[</span><span class="builtinfunc" id="7224381">len</span><span class="op" id="7224384">(</span><span class="ident" id="7224385">pairs</span><span class="op" id="7224390">)</span><span class="op" id="7224391">-</span><span class="num" id="7224392">1</span><span class="op" id="7224393">]</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7224396">func</span>&nbsp;<span class="ident" id="7224401">testEqual</span><span class="op" id="7224410">(</span><span class="ident" id="7224411">t</span>&nbsp;<span class="op" id="7224413">*</span><span class="ident" id="7224414">testing</span><span class="op" id="7224421">.</span><span class="ident" id="7224422">T</span><span class="op" id="7224423">,</span>&nbsp;<span class="ident" id="7224425">msg</span>&nbsp;<span class="builtintype" id="7224429">string</span><span class="op" id="7224435">,</span>&nbsp;<span class="ident" id="7224437">args</span>&nbsp;<span class="op" id="7224442">...</span><span class="keyword" id="7224445">interface</span><span class="op" id="7224454">{</span><span class="op" id="7224455">}</span><span class="op" id="7224456">)</span>&nbsp;<span class="builtintype" id="7224458">bool</span>&nbsp;<span class="op" id="7224463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7224466">if</span>&nbsp;<span class="ident" id="7224469">args</span><span class="op" id="7224473">[</span><span class="builtinfunc" id="7224474">len</span><span class="op" id="7224477">(</span><span class="ident" id="7224478">args</span><span class="op" id="7224482">)</span><span class="op" id="7224483">-</span><span class="num" id="7224484">2</span><span class="op" id="7224485">]</span>&nbsp;<span class="op" id="7224487">!=</span>&nbsp;<span class="ident" id="7224490">args</span><span class="op" id="7224494">[</span><span class="builtinfunc" id="7224495">len</span><span class="op" id="7224498">(</span><span class="ident" id="7224499">args</span><span class="op" id="7224503">)</span><span class="op" id="7224504">-</span><span class="num" id="7224505">1</span><span class="op" id="7224506">]</span>&nbsp;<span class="op" id="7224508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7224512">t</span><span class="op" id="7224513">.</span><span class="ident" id="7224514">Errorf</span><span class="op" id="7224520">(</span><span class="ident" id="7224521">msg</span><span class="op" id="7224524">,</span>&nbsp;<span class="ident" id="7224526">args</span><span class="op" id="7224530">...</span><span class="op" id="7224533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7224537">return</span>&nbsp;<span class="builtintype" id="7224544">false</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7224551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7224554">return</span>&nbsp;<span class="builtintype" id="7224561">true</span><br>
<span class="lineno"></span><span class="op" id="7224566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7224569">func</span>&nbsp;<span class="ident" id="7224574">strip85</span><span class="op" id="7224581">(</span><span class="ident" id="7224582">s</span>&nbsp;<span class="builtintype" id="7224584">string</span><span class="op" id="7224590">)</span>&nbsp;<span class="builtintype" id="7224592">string</span>&nbsp;<span class="op" id="7224599">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7224602">t</span>&nbsp;<span class="op" id="7224604">:=</span>&nbsp;<span class="builtinfunc" id="7224607">make</span><span class="op" id="7224611">(</span><span class="op" id="7224612">[</span><span class="op" id="7224613">]</span><span class="builtintype" id="7224614">byte</span><span class="op" id="7224618">,</span>&nbsp;<span class="builtinfunc" id="7224620">len</span><span class="op" id="7224623">(</span><span class="ident" id="7224624">s</span><span class="op" id="7224625">)</span><span class="op" id="7224626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7224629">w</span>&nbsp;<span class="op" id="7224631">:=</span>&nbsp;<span class="num" id="7224634">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7224637">for</span>&nbsp;<span class="ident" id="7224641">r</span>&nbsp;<span class="op" id="7224643">:=</span>&nbsp;<span class="num" id="7224646">0</span><span class="op" id="7224647">;</span>&nbsp;<span class="ident" id="7224649">r</span>&nbsp;<span class="op" id="7224651">&lt;</span>&nbsp;<span class="builtinfunc" id="7224653">len</span><span class="op" id="7224656">(</span><span class="ident" id="7224657">s</span><span class="op" id="7224658">)</span><span class="op" id="7224659">;</span>&nbsp;<span class="ident" id="7224661">r</span><span class="op" id="7224662">++</span>&nbsp;<span class="op" id="7224665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7224669">c</span>&nbsp;<span class="op" id="7224671">:=</span>&nbsp;<span class="ident" id="7224674">s</span><span class="op" id="7224675">[</span><span class="ident" id="7224676">r</span><span class="op" id="7224677">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7224681">if</span>&nbsp;<span class="ident" id="7224684">c</span>&nbsp;<span class="op" id="7224686">&gt;</span>&nbsp;<span class="string" id="7224688">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="7224692">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7224697">t</span><span class="op" id="7224698">[</span><span class="ident" id="7224699">w</span><span class="op" id="7224700">]</span>&nbsp;<span class="op" id="7224702">=</span>&nbsp;<span class="ident" id="7224704">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7224709">w</span><span class="op" id="7224710">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7224715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7224718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7224721">return</span>&nbsp;<span class="builtintype" id="7224728">string</span><span class="op" id="7224734">(</span><span class="ident" id="7224735">t</span><span class="op" id="7224736">[</span><span class="num" id="7224737">0</span><span class="op" id="7224738">:</span><span class="ident" id="7224739">w</span><span class="op" id="7224740">]</span><span class="op" id="7224741">)</span><br>
<span class="lineno">65</span><span class="op" id="7224743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7224746">func</span>&nbsp;<span class="ident" id="7224751">TestEncode</span><span class="op" id="7224761">(</span><span class="ident" id="7224762">t</span>&nbsp;<span class="op" id="7224764">*</span><span class="ident" id="7224765">testing</span><span class="op" id="7224772">.</span><span class="ident" id="7224773">T</span><span class="op" id="7224774">)</span>&nbsp;<span class="op" id="7224776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7224779">for</span>&nbsp;<span class="ident" id="7224783">_</span><span class="op" id="7224784">,</span>&nbsp;<span class="ident" id="7224786">p</span>&nbsp;<span class="op" id="7224788">:=</span>&nbsp;<span class="keyword" id="7224791">range</span>&nbsp;<span class="ident" id="7224797">pairs</span>&nbsp;<span class="op" id="7224803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7224807">buf</span>&nbsp;<span class="op" id="7224811">:=</span>&nbsp;<span class="builtinfunc" id="7224814">make</span><span class="op" id="7224818">(</span><span class="op" id="7224819">[</span><span class="op" id="7224820">]</span><span class="builtintype" id="7224821">byte</span><span class="op" id="7224825">,</span>&nbsp;<span class="ident" id="7224827">MaxEncodedLen</span><span class="op" id="7224840">(</span><span class="builtinfunc" id="7224841">len</span><span class="op" id="7224844">(</span><span class="ident" id="7224845">p</span><span class="op" id="7224846">.</span><span class="ident" id="7224847">decoded</span><span class="op" id="7224854">)</span><span class="op" id="7224855">)</span><span class="op" id="7224856">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7224860">n</span>&nbsp;<span class="op" id="7224862">:=</span>&nbsp;<span class="ident" id="7224865">Encode</span><span class="op" id="7224871">(</span><span class="ident" id="7224872">buf</span><span class="op" id="7224875">,</span>&nbsp;<span class="op" id="7224877">[</span><span class="op" id="7224878">]</span><span class="builtintype" id="7224879">byte</span><span class="op" id="7224883">(</span><span class="ident" id="7224884">p</span><span class="op" id="7224885">.</span><span class="ident" id="7224886">decoded</span><span class="op" id="7224893">)</span><span class="op" id="7224894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7224898">buf</span>&nbsp;<span class="op" id="7224902">=</span>&nbsp;<span class="ident" id="7224904">buf</span><span class="op" id="7224907">[</span><span class="num" id="7224908">0</span><span class="op" id="7224909">:</span><span class="ident" id="7224910">n</span><span class="op" id="7224911">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7224915">testEqual</span><span class="op" id="7224924">(</span><span class="ident" id="7224925">t</span><span class="op" id="7224926">,</span>&nbsp;<span class="string" id="7224928">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7224954">,</span>&nbsp;<span class="ident" id="7224956">p</span><span class="op" id="7224957">.</span><span class="ident" id="7224958">decoded</span><span class="op" id="7224965">,</span>&nbsp;<span class="ident" id="7224967">strip85</span><span class="op" id="7224974">(</span><span class="builtintype" id="7224975">string</span><span class="op" id="7224981">(</span><span class="ident" id="7224982">buf</span><span class="op" id="7224985">)</span><span class="op" id="7224986">)</span><span class="op" id="7224987">,</span>&nbsp;<span class="ident" id="7224989">strip85</span><span class="op" id="7224996">(</span><span class="ident" id="7224997">p</span><span class="op" id="7224998">.</span><span class="ident" id="7224999">encoded</span><span class="op" id="7225006">)</span><span class="op" id="7225007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7225010">}</span><br>
<span class="lineno"></span><span class="op" id="7225012">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="7225015">func</span>&nbsp;<span class="ident" id="7225020">TestEncoder</span><span class="op" id="7225031">(</span><span class="ident" id="7225032">t</span>&nbsp;<span class="op" id="7225034">*</span><span class="ident" id="7225035">testing</span><span class="op" id="7225042">.</span><span class="ident" id="7225043">T</span><span class="op" id="7225044">)</span>&nbsp;<span class="op" id="7225046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7225049">for</span>&nbsp;<span class="ident" id="7225053">_</span><span class="op" id="7225054">,</span>&nbsp;<span class="ident" id="7225056">p</span>&nbsp;<span class="op" id="7225058">:=</span>&nbsp;<span class="keyword" id="7225061">range</span>&nbsp;<span class="ident" id="7225067">pairs</span>&nbsp;<span class="op" id="7225073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225077">bb</span>&nbsp;<span class="op" id="7225080">:=</span>&nbsp;<span class="op" id="7225083">&amp;</span><span class="ident" id="7225084">bytes</span><span class="op" id="7225089">.</span><span class="ident" id="7225090">Buffer</span><span class="op" id="7225096">{</span><span class="op" id="7225097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225101">encoder</span>&nbsp;<span class="op" id="7225109">:=</span>&nbsp;<span class="ident" id="7225112">NewEncoder</span><span class="op" id="7225122">(</span><span class="ident" id="7225123">bb</span><span class="op" id="7225125">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225129">encoder</span><span class="op" id="7225136">.</span><span class="ident" id="7225137">Write</span><span class="op" id="7225142">(</span><span class="op" id="7225143">[</span><span class="op" id="7225144">]</span><span class="builtintype" id="7225145">byte</span><span class="op" id="7225149">(</span><span class="ident" id="7225150">p</span><span class="op" id="7225151">.</span><span class="ident" id="7225152">decoded</span><span class="op" id="7225159">)</span><span class="op" id="7225160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225164">encoder</span><span class="op" id="7225171">.</span><span class="ident" id="7225172">Close</span><span class="op" id="7225177">(</span><span class="op" id="7225178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225182">testEqual</span><span class="op" id="7225191">(</span><span class="ident" id="7225192">t</span><span class="op" id="7225193">,</span>&nbsp;<span class="string" id="7225195">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7225221">,</span>&nbsp;<span class="ident" id="7225223">p</span><span class="op" id="7225224">.</span><span class="ident" id="7225225">decoded</span><span class="op" id="7225232">,</span>&nbsp;<span class="ident" id="7225234">strip85</span><span class="op" id="7225241">(</span><span class="ident" id="7225242">bb</span><span class="op" id="7225244">.</span><span class="ident" id="7225245">String</span><span class="op" id="7225251">(</span><span class="op" id="7225252">)</span><span class="op" id="7225253">)</span><span class="op" id="7225254">,</span>&nbsp;<span class="ident" id="7225256">strip85</span><span class="op" id="7225263">(</span><span class="ident" id="7225264">p</span><span class="op" id="7225265">.</span><span class="ident" id="7225266">encoded</span><span class="op" id="7225273">)</span><span class="op" id="7225274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7225277">}</span><br>
<span class="lineno"></span><span class="op" id="7225279">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="7225282">func</span>&nbsp;<span class="ident" id="7225287">TestEncoderBuffering</span><span class="op" id="7225307">(</span><span class="ident" id="7225308">t</span>&nbsp;<span class="op" id="7225310">*</span><span class="ident" id="7225311">testing</span><span class="op" id="7225318">.</span><span class="ident" id="7225319">T</span><span class="op" id="7225320">)</span>&nbsp;<span class="op" id="7225322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225325">input</span>&nbsp;<span class="op" id="7225331">:=</span>&nbsp;<span class="op" id="7225334">[</span><span class="op" id="7225335">]</span><span class="builtintype" id="7225336">byte</span><span class="op" id="7225340">(</span><span class="ident" id="7225341">bigtest</span><span class="op" id="7225348">.</span><span class="ident" id="7225349">decoded</span><span class="op" id="7225356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7225359">for</span>&nbsp;<span class="ident" id="7225363">bs</span>&nbsp;<span class="op" id="7225366">:=</span>&nbsp;<span class="num" id="7225369">1</span><span class="op" id="7225370">;</span>&nbsp;<span class="ident" id="7225372">bs</span>&nbsp;<span class="op" id="7225375">&lt;=</span>&nbsp;<span class="num" id="7225378">12</span><span class="op" id="7225380">;</span>&nbsp;<span class="ident" id="7225382">bs</span><span class="op" id="7225384">++</span>&nbsp;<span class="op" id="7225387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225391">bb</span>&nbsp;<span class="op" id="7225394">:=</span>&nbsp;<span class="op" id="7225397">&amp;</span><span class="ident" id="7225398">bytes</span><span class="op" id="7225403">.</span><span class="ident" id="7225404">Buffer</span><span class="op" id="7225410">{</span><span class="op" id="7225411">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225415">encoder</span>&nbsp;<span class="op" id="7225423">:=</span>&nbsp;<span class="ident" id="7225426">NewEncoder</span><span class="op" id="7225436">(</span><span class="ident" id="7225437">bb</span><span class="op" id="7225439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7225443">for</span>&nbsp;<span class="ident" id="7225447">pos</span>&nbsp;<span class="op" id="7225451">:=</span>&nbsp;<span class="num" id="7225454">0</span><span class="op" id="7225455">;</span>&nbsp;<span class="ident" id="7225457">pos</span>&nbsp;<span class="op" id="7225461">&lt;</span>&nbsp;<span class="builtinfunc" id="7225463">len</span><span class="op" id="7225466">(</span><span class="ident" id="7225467">input</span><span class="op" id="7225472">)</span><span class="op" id="7225473">;</span>&nbsp;<span class="ident" id="7225475">pos</span>&nbsp;<span class="op" id="7225479">+=</span>&nbsp;<span class="ident" id="7225482">bs</span>&nbsp;<span class="op" id="7225485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225490">end</span>&nbsp;<span class="op" id="7225494">:=</span>&nbsp;<span class="ident" id="7225497">pos</span>&nbsp;<span class="op" id="7225501">+</span>&nbsp;<span class="ident" id="7225503">bs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7225509">if</span>&nbsp;<span class="ident" id="7225512">end</span>&nbsp;<span class="op" id="7225516">&gt;</span>&nbsp;<span class="builtinfunc" id="7225518">len</span><span class="op" id="7225521">(</span><span class="ident" id="7225522">input</span><span class="op" id="7225527">)</span>&nbsp;<span class="op" id="7225529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225535">end</span>&nbsp;<span class="op" id="7225539">=</span>&nbsp;<span class="builtinfunc" id="7225541">len</span><span class="op" id="7225544">(</span><span class="ident" id="7225545">input</span><span class="op" id="7225550">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7225555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225560">n</span><span class="op" id="7225561">,</span>&nbsp;<span class="ident" id="7225563">err</span>&nbsp;<span class="op" id="7225567">:=</span>&nbsp;<span class="ident" id="7225570">encoder</span><span class="op" id="7225577">.</span><span class="ident" id="7225578">Write</span><span class="op" id="7225583">(</span><span class="ident" id="7225584">input</span><span class="op" id="7225589">[</span><span class="ident" id="7225590">pos</span><span class="op" id="7225593">:</span><span class="ident" id="7225594">end</span><span class="op" id="7225597">]</span><span class="op" id="7225598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225603">testEqual</span><span class="op" id="7225612">(</span><span class="ident" id="7225613">t</span><span class="op" id="7225614">,</span>&nbsp;<span class="string" id="7225616">&#34;Write(%q)&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7225650">,</span>&nbsp;<span class="ident" id="7225652">input</span><span class="op" id="7225657">[</span><span class="ident" id="7225658">pos</span><span class="op" id="7225661">:</span><span class="ident" id="7225662">end</span><span class="op" id="7225665">]</span><span class="op" id="7225666">,</span>&nbsp;<span class="ident" id="7225668">err</span><span class="op" id="7225671">,</span>&nbsp;<span class="builtintype" id="7225673">error</span><span class="op" id="7225678">(</span><span class="builtintype" id="7225679">nil</span><span class="op" id="7225682">)</span><span class="op" id="7225683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225688">testEqual</span><span class="op" id="7225697">(</span><span class="ident" id="7225698">t</span><span class="op" id="7225699">,</span>&nbsp;<span class="string" id="7225701">&#34;Write(%q)&nbsp;gave&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7225736">,</span>&nbsp;<span class="ident" id="7225738">input</span><span class="op" id="7225743">[</span><span class="ident" id="7225744">pos</span><span class="op" id="7225747">:</span><span class="ident" id="7225748">end</span><span class="op" id="7225751">]</span><span class="op" id="7225752">,</span>&nbsp;<span class="ident" id="7225754">n</span><span class="op" id="7225755">,</span>&nbsp;<span class="ident" id="7225757">end</span><span class="op" id="7225760">-</span><span class="ident" id="7225761">pos</span><span class="op" id="7225764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7225768">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225772">err</span>&nbsp;<span class="op" id="7225776">:=</span>&nbsp;<span class="ident" id="7225779">encoder</span><span class="op" id="7225786">.</span><span class="ident" id="7225787">Close</span><span class="op" id="7225792">(</span><span class="op" id="7225793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225797">testEqual</span><span class="op" id="7225806">(</span><span class="ident" id="7225807">t</span><span class="op" id="7225808">,</span>&nbsp;<span class="string" id="7225810">&#34;Close&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7225840">,</span>&nbsp;<span class="ident" id="7225842">err</span><span class="op" id="7225845">,</span>&nbsp;<span class="builtintype" id="7225847">error</span><span class="op" id="7225852">(</span><span class="builtintype" id="7225853">nil</span><span class="op" id="7225856">)</span><span class="op" id="7225857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225861">testEqual</span><span class="op" id="7225870">(</span><span class="ident" id="7225871">t</span><span class="op" id="7225872">,</span>&nbsp;<span class="string" id="7225874">&#34;Encoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7225907">,</span>&nbsp;<span class="ident" id="7225909">bs</span><span class="op" id="7225911">,</span>&nbsp;<span class="ident" id="7225913">bigtest</span><span class="op" id="7225920">.</span><span class="ident" id="7225921">decoded</span><span class="op" id="7225928">,</span>&nbsp;<span class="ident" id="7225930">strip85</span><span class="op" id="7225937">(</span><span class="ident" id="7225938">bb</span><span class="op" id="7225940">.</span><span class="ident" id="7225941">String</span><span class="op" id="7225947">(</span><span class="op" id="7225948">)</span><span class="op" id="7225949">)</span><span class="op" id="7225950">,</span>&nbsp;<span class="ident" id="7225952">strip85</span><span class="op" id="7225959">(</span><span class="ident" id="7225960">bigtest</span><span class="op" id="7225967">.</span><span class="ident" id="7225968">encoded</span><span class="op" id="7225975">)</span><span class="op" id="7225976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7225979">}</span><br>
<span class="lineno"></span><span class="op" id="7225981">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="7225984">func</span>&nbsp;<span class="ident" id="7225989">TestDecode</span><span class="op" id="7225999">(</span><span class="ident" id="7226000">t</span>&nbsp;<span class="op" id="7226002">*</span><span class="ident" id="7226003">testing</span><span class="op" id="7226010">.</span><span class="ident" id="7226011">T</span><span class="op" id="7226012">)</span>&nbsp;<span class="op" id="7226014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7226017">for</span>&nbsp;<span class="ident" id="7226021">_</span><span class="op" id="7226022">,</span>&nbsp;<span class="ident" id="7226024">p</span>&nbsp;<span class="op" id="7226026">:=</span>&nbsp;<span class="keyword" id="7226029">range</span>&nbsp;<span class="ident" id="7226035">pairs</span>&nbsp;<span class="op" id="7226041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226045">dbuf</span>&nbsp;<span class="op" id="7226050">:=</span>&nbsp;<span class="builtinfunc" id="7226053">make</span><span class="op" id="7226057">(</span><span class="op" id="7226058">[</span><span class="op" id="7226059">]</span><span class="builtintype" id="7226060">byte</span><span class="op" id="7226064">,</span>&nbsp;<span class="num" id="7226066">4</span><span class="op" id="7226067">*</span><span class="builtinfunc" id="7226068">len</span><span class="op" id="7226071">(</span><span class="ident" id="7226072">p</span><span class="op" id="7226073">.</span><span class="ident" id="7226074">encoded</span><span class="op" id="7226081">)</span><span class="op" id="7226082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226086">ndst</span><span class="op" id="7226090">,</span>&nbsp;<span class="ident" id="7226092">nsrc</span><span class="op" id="7226096">,</span>&nbsp;<span class="ident" id="7226098">err</span>&nbsp;<span class="op" id="7226102">:=</span>&nbsp;<span class="ident" id="7226105">Decode</span><span class="op" id="7226111">(</span><span class="ident" id="7226112">dbuf</span><span class="op" id="7226116">,</span>&nbsp;<span class="op" id="7226118">[</span><span class="op" id="7226119">]</span><span class="builtintype" id="7226120">byte</span><span class="op" id="7226124">(</span><span class="ident" id="7226125">p</span><span class="op" id="7226126">.</span><span class="ident" id="7226127">encoded</span><span class="op" id="7226134">)</span><span class="op" id="7226135">,</span>&nbsp;<span class="builtintype" id="7226137">true</span><span class="op" id="7226141">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226145">testEqual</span><span class="op" id="7226154">(</span><span class="ident" id="7226155">t</span><span class="op" id="7226156">,</span>&nbsp;<span class="string" id="7226158">&#34;Decode(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7226190">,</span>&nbsp;<span class="ident" id="7226192">p</span><span class="op" id="7226193">.</span><span class="ident" id="7226194">encoded</span><span class="op" id="7226201">,</span>&nbsp;<span class="ident" id="7226203">err</span><span class="op" id="7226206">,</span>&nbsp;<span class="builtintype" id="7226208">error</span><span class="op" id="7226213">(</span><span class="builtintype" id="7226214">nil</span><span class="op" id="7226217">)</span><span class="op" id="7226218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226222">testEqual</span><span class="op" id="7226231">(</span><span class="ident" id="7226232">t</span><span class="op" id="7226233">,</span>&nbsp;<span class="string" id="7226235">&#34;Decode(%q)&nbsp;=&nbsp;nsrc&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7226266">,</span>&nbsp;<span class="ident" id="7226268">p</span><span class="op" id="7226269">.</span><span class="ident" id="7226270">encoded</span><span class="op" id="7226277">,</span>&nbsp;<span class="ident" id="7226279">nsrc</span><span class="op" id="7226283">,</span>&nbsp;<span class="builtinfunc" id="7226285">len</span><span class="op" id="7226288">(</span><span class="ident" id="7226289">p</span><span class="op" id="7226290">.</span><span class="ident" id="7226291">encoded</span><span class="op" id="7226298">)</span><span class="op" id="7226299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226303">testEqual</span><span class="op" id="7226312">(</span><span class="ident" id="7226313">t</span><span class="op" id="7226314">,</span>&nbsp;<span class="string" id="7226316">&#34;Decode(%q)&nbsp;=&nbsp;ndst&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7226347">,</span>&nbsp;<span class="ident" id="7226349">p</span><span class="op" id="7226350">.</span><span class="ident" id="7226351">encoded</span><span class="op" id="7226358">,</span>&nbsp;<span class="ident" id="7226360">ndst</span><span class="op" id="7226364">,</span>&nbsp;<span class="builtinfunc" id="7226366">len</span><span class="op" id="7226369">(</span><span class="ident" id="7226370">p</span><span class="op" id="7226371">.</span><span class="ident" id="7226372">decoded</span><span class="op" id="7226379">)</span><span class="op" id="7226380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226384">testEqual</span><span class="op" id="7226393">(</span><span class="ident" id="7226394">t</span><span class="op" id="7226395">,</span>&nbsp;<span class="string" id="7226397">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7226423">,</span>&nbsp;<span class="ident" id="7226425">p</span><span class="op" id="7226426">.</span><span class="ident" id="7226427">encoded</span><span class="op" id="7226434">,</span>&nbsp;<span class="builtintype" id="7226436">string</span><span class="op" id="7226442">(</span><span class="ident" id="7226443">dbuf</span><span class="op" id="7226447">[</span><span class="num" id="7226448">0</span><span class="op" id="7226449">:</span><span class="ident" id="7226450">ndst</span><span class="op" id="7226454">]</span><span class="op" id="7226455">)</span><span class="op" id="7226456">,</span>&nbsp;<span class="ident" id="7226458">p</span><span class="op" id="7226459">.</span><span class="ident" id="7226460">decoded</span><span class="op" id="7226467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7226470">}</span><br>
<span class="lineno">115</span><span class="op" id="7226472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7226475">func</span>&nbsp;<span class="ident" id="7226480">TestDecoder</span><span class="op" id="7226491">(</span><span class="ident" id="7226492">t</span>&nbsp;<span class="op" id="7226494">*</span><span class="ident" id="7226495">testing</span><span class="op" id="7226502">.</span><span class="ident" id="7226503">T</span><span class="op" id="7226504">)</span>&nbsp;<span class="op" id="7226506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7226509">for</span>&nbsp;<span class="ident" id="7226513">_</span><span class="op" id="7226514">,</span>&nbsp;<span class="ident" id="7226516">p</span>&nbsp;<span class="op" id="7226518">:=</span>&nbsp;<span class="keyword" id="7226521">range</span>&nbsp;<span class="ident" id="7226527">pairs</span>&nbsp;<span class="op" id="7226533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226537">decoder</span>&nbsp;<span class="op" id="7226545">:=</span>&nbsp;<span class="ident" id="7226548">NewDecoder</span><span class="op" id="7226558">(</span><span class="ident" id="7226559">strings</span><span class="op" id="7226566">.</span><span class="ident" id="7226567">NewReader</span><span class="op" id="7226576">(</span><span class="ident" id="7226577">p</span><span class="op" id="7226578">.</span><span class="ident" id="7226579">encoded</span><span class="op" id="7226586">)</span><span class="op" id="7226587">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226591">dbuf</span><span class="op" id="7226595">,</span>&nbsp;<span class="ident" id="7226597">err</span>&nbsp;<span class="op" id="7226601">:=</span>&nbsp;<span class="ident" id="7226604">ioutil</span><span class="op" id="7226610">.</span><span class="ident" id="7226611">ReadAll</span><span class="op" id="7226618">(</span><span class="ident" id="7226619">decoder</span><span class="op" id="7226626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7226630">if</span>&nbsp;<span class="ident" id="7226633">err</span>&nbsp;<span class="op" id="7226637">!=</span>&nbsp;<span class="builtintype" id="7226640">nil</span>&nbsp;<span class="op" id="7226644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226649">t</span><span class="op" id="7226650">.</span><span class="ident" id="7226651">Fatal</span><span class="op" id="7226656">(</span><span class="string" id="7226657">&#34;Read&nbsp;failed&#34;</span><span class="op" id="7226670">,</span>&nbsp;<span class="ident" id="7226672">err</span><span class="op" id="7226675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7226679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226683">testEqual</span><span class="op" id="7226692">(</span><span class="ident" id="7226693">t</span><span class="op" id="7226694">,</span>&nbsp;<span class="string" id="7226696">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7226731">,</span>&nbsp;<span class="ident" id="7226733">p</span><span class="op" id="7226734">.</span><span class="ident" id="7226735">encoded</span><span class="op" id="7226742">,</span>&nbsp;<span class="builtinfunc" id="7226744">len</span><span class="op" id="7226747">(</span><span class="ident" id="7226748">dbuf</span><span class="op" id="7226752">)</span><span class="op" id="7226753">,</span>&nbsp;<span class="builtinfunc" id="7226755">len</span><span class="op" id="7226758">(</span><span class="ident" id="7226759">p</span><span class="op" id="7226760">.</span><span class="ident" id="7226761">decoded</span><span class="op" id="7226768">)</span><span class="op" id="7226769">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226773">testEqual</span><span class="op" id="7226782">(</span><span class="ident" id="7226783">t</span><span class="op" id="7226784">,</span>&nbsp;<span class="string" id="7226786">&#34;Decoding&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7226816">,</span>&nbsp;<span class="ident" id="7226818">p</span><span class="op" id="7226819">.</span><span class="ident" id="7226820">encoded</span><span class="op" id="7226827">,</span>&nbsp;<span class="builtintype" id="7226829">string</span><span class="op" id="7226835">(</span><span class="ident" id="7226836">dbuf</span><span class="op" id="7226840">)</span><span class="op" id="7226841">,</span>&nbsp;<span class="ident" id="7226843">p</span><span class="op" id="7226844">.</span><span class="ident" id="7226845">decoded</span><span class="op" id="7226852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7226856">if</span>&nbsp;<span class="ident" id="7226859">err</span>&nbsp;<span class="op" id="7226863">!=</span>&nbsp;<span class="builtintype" id="7226866">nil</span>&nbsp;<span class="op" id="7226870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226875">testEqual</span><span class="op" id="7226884">(</span><span class="ident" id="7226885">t</span><span class="op" id="7226886">,</span>&nbsp;<span class="string" id="7226888">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7226916">,</span>&nbsp;<span class="ident" id="7226918">p</span><span class="op" id="7226919">.</span><span class="ident" id="7226920">encoded</span><span class="op" id="7226927">,</span>&nbsp;<span class="ident" id="7226929">err</span><span class="op" id="7226932">,</span>&nbsp;<span class="ident" id="7226934">io</span><span class="op" id="7226936">.</span><span class="ident" id="7226937">EOF</span><span class="op" id="7226940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7226944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7226947">}</span><br>
<span class="lineno">130</span><span class="op" id="7226949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7226952">func</span>&nbsp;<span class="ident" id="7226957">TestDecoderBuffering</span><span class="op" id="7226977">(</span><span class="ident" id="7226978">t</span>&nbsp;<span class="op" id="7226980">*</span><span class="ident" id="7226981">testing</span><span class="op" id="7226988">.</span><span class="ident" id="7226989">T</span><span class="op" id="7226990">)</span>&nbsp;<span class="op" id="7226992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7226995">for</span>&nbsp;<span class="ident" id="7226999">bs</span>&nbsp;<span class="op" id="7227002">:=</span>&nbsp;<span class="num" id="7227005">1</span><span class="op" id="7227006">;</span>&nbsp;<span class="ident" id="7227008">bs</span>&nbsp;<span class="op" id="7227011">&lt;=</span>&nbsp;<span class="num" id="7227014">12</span><span class="op" id="7227016">;</span>&nbsp;<span class="ident" id="7227018">bs</span><span class="op" id="7227020">++</span>&nbsp;<span class="op" id="7227023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227027">decoder</span>&nbsp;<span class="op" id="7227035">:=</span>&nbsp;<span class="ident" id="7227038">NewDecoder</span><span class="op" id="7227048">(</span><span class="ident" id="7227049">strings</span><span class="op" id="7227056">.</span><span class="ident" id="7227057">NewReader</span><span class="op" id="7227066">(</span><span class="ident" id="7227067">bigtest</span><span class="op" id="7227074">.</span><span class="ident" id="7227075">encoded</span><span class="op" id="7227082">)</span><span class="op" id="7227083">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227087">buf</span>&nbsp;<span class="op" id="7227091">:=</span>&nbsp;<span class="builtinfunc" id="7227094">make</span><span class="op" id="7227098">(</span><span class="op" id="7227099">[</span><span class="op" id="7227100">]</span><span class="builtintype" id="7227101">byte</span><span class="op" id="7227105">,</span>&nbsp;<span class="builtinfunc" id="7227107">len</span><span class="op" id="7227110">(</span><span class="ident" id="7227111">bigtest</span><span class="op" id="7227118">.</span><span class="ident" id="7227119">decoded</span><span class="op" id="7227126">)</span><span class="op" id="7227127">+</span><span class="num" id="7227128">12</span><span class="op" id="7227130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7227134">var</span>&nbsp;<span class="ident" id="7227138">total</span>&nbsp;<span class="builtintype" id="7227144">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7227150">for</span>&nbsp;<span class="ident" id="7227154">total</span>&nbsp;<span class="op" id="7227160">=</span>&nbsp;<span class="num" id="7227162">0</span><span class="op" id="7227163">;</span>&nbsp;<span class="ident" id="7227165">total</span>&nbsp;<span class="op" id="7227171">&lt;</span>&nbsp;<span class="builtinfunc" id="7227173">len</span><span class="op" id="7227176">(</span><span class="ident" id="7227177">bigtest</span><span class="op" id="7227184">.</span><span class="ident" id="7227185">decoded</span><span class="op" id="7227192">)</span><span class="op" id="7227193">;</span>&nbsp;<span class="op" id="7227195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227200">n</span><span class="op" id="7227201">,</span>&nbsp;<span class="ident" id="7227203">err</span>&nbsp;<span class="op" id="7227207">:=</span>&nbsp;<span class="ident" id="7227210">decoder</span><span class="op" id="7227217">.</span><span class="ident" id="7227218">Read</span><span class="op" id="7227222">(</span><span class="ident" id="7227223">buf</span><span class="op" id="7227226">[</span><span class="ident" id="7227227">total</span>&nbsp;<span class="op" id="7227233">:</span>&nbsp;<span class="ident" id="7227235">total</span><span class="op" id="7227240">+</span><span class="ident" id="7227241">bs</span><span class="op" id="7227243">]</span><span class="op" id="7227244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227249">testEqual</span><span class="op" id="7227258">(</span><span class="ident" id="7227259">t</span><span class="op" id="7227260">,</span>&nbsp;<span class="string" id="7227262">&#34;Read&nbsp;from&nbsp;%q&nbsp;at&nbsp;pos&nbsp;%d&nbsp;=&nbsp;%d,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="7227307">,</span>&nbsp;<span class="ident" id="7227309">bigtest</span><span class="op" id="7227316">.</span><span class="ident" id="7227317">encoded</span><span class="op" id="7227324">,</span>&nbsp;<span class="ident" id="7227326">total</span><span class="op" id="7227331">,</span>&nbsp;<span class="ident" id="7227333">n</span><span class="op" id="7227334">,</span>&nbsp;<span class="ident" id="7227336">err</span><span class="op" id="7227339">,</span>&nbsp;<span class="builtintype" id="7227341">error</span><span class="op" id="7227346">(</span><span class="builtintype" id="7227347">nil</span><span class="op" id="7227350">)</span><span class="op" id="7227351">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227356">total</span>&nbsp;<span class="op" id="7227362">+=</span>&nbsp;<span class="ident" id="7227365">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7227369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227373">testEqual</span><span class="op" id="7227382">(</span><span class="ident" id="7227383">t</span><span class="op" id="7227384">,</span>&nbsp;<span class="string" id="7227386">&#34;Decoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7227419">,</span>&nbsp;<span class="ident" id="7227421">bs</span><span class="op" id="7227423">,</span>&nbsp;<span class="ident" id="7227425">bigtest</span><span class="op" id="7227432">.</span><span class="ident" id="7227433">encoded</span><span class="op" id="7227440">,</span>&nbsp;<span class="builtintype" id="7227442">string</span><span class="op" id="7227448">(</span><span class="ident" id="7227449">buf</span><span class="op" id="7227452">[</span><span class="num" id="7227453">0</span><span class="op" id="7227454">:</span><span class="ident" id="7227455">total</span><span class="op" id="7227460">]</span><span class="op" id="7227461">)</span><span class="op" id="7227462">,</span>&nbsp;<span class="ident" id="7227464">bigtest</span><span class="op" id="7227471">.</span><span class="ident" id="7227472">decoded</span><span class="op" id="7227479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7227482">}</span><br>
<span class="lineno"></span><span class="op" id="7227484">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="7227487">func</span>&nbsp;<span class="ident" id="7227492">TestDecodeCorrupt</span><span class="op" id="7227509">(</span><span class="ident" id="7227510">t</span>&nbsp;<span class="op" id="7227512">*</span><span class="ident" id="7227513">testing</span><span class="op" id="7227520">.</span><span class="ident" id="7227521">T</span><span class="op" id="7227522">)</span>&nbsp;<span class="op" id="7227524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7227527">type</span>&nbsp;<span class="ident" id="7227532">corrupt</span>&nbsp;<span class="keyword" id="7227540">struct</span>&nbsp;<span class="op" id="7227547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227551">e</span>&nbsp;<span class="builtintype" id="7227553">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227562">p</span>&nbsp;<span class="builtintype" id="7227564">int</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7227569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227572">examples</span>&nbsp;<span class="op" id="7227581">:=</span>&nbsp;<span class="op" id="7227584">[</span><span class="op" id="7227585">]</span><span class="ident" id="7227586">corrupt</span><span class="op" id="7227593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7227597">{</span><span class="string" id="7227598">&#34;v&#34;</span><span class="op" id="7227601">,</span>&nbsp;<span class="num" id="7227603">0</span><span class="op" id="7227604">}</span><span class="op" id="7227605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7227609">{</span><span class="string" id="7227610">&#34;!z!!!!!!!!!&#34;</span><span class="op" id="7227623">,</span>&nbsp;<span class="num" id="7227625">1</span><span class="op" id="7227626">}</span><span class="op" id="7227627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7227630">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7227634">for</span>&nbsp;<span class="ident" id="7227638">_</span><span class="op" id="7227639">,</span>&nbsp;<span class="ident" id="7227641">e</span>&nbsp;<span class="op" id="7227643">:=</span>&nbsp;<span class="keyword" id="7227646">range</span>&nbsp;<span class="ident" id="7227652">examples</span>&nbsp;<span class="op" id="7227661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227665">dbuf</span>&nbsp;<span class="op" id="7227670">:=</span>&nbsp;<span class="builtinfunc" id="7227673">make</span><span class="op" id="7227677">(</span><span class="op" id="7227678">[</span><span class="op" id="7227679">]</span><span class="builtintype" id="7227680">byte</span><span class="op" id="7227684">,</span>&nbsp;<span class="num" id="7227686">4</span><span class="op" id="7227687">*</span><span class="builtinfunc" id="7227688">len</span><span class="op" id="7227691">(</span><span class="ident" id="7227692">e</span><span class="op" id="7227693">.</span><span class="ident" id="7227694">e</span><span class="op" id="7227695">)</span><span class="op" id="7227696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227700">_</span><span class="op" id="7227701">,</span>&nbsp;<span class="ident" id="7227703">_</span><span class="op" id="7227704">,</span>&nbsp;<span class="ident" id="7227706">err</span>&nbsp;<span class="op" id="7227710">:=</span>&nbsp;<span class="ident" id="7227713">Decode</span><span class="op" id="7227719">(</span><span class="ident" id="7227720">dbuf</span><span class="op" id="7227724">,</span>&nbsp;<span class="op" id="7227726">[</span><span class="op" id="7227727">]</span><span class="builtintype" id="7227728">byte</span><span class="op" id="7227732">(</span><span class="ident" id="7227733">e</span><span class="op" id="7227734">.</span><span class="ident" id="7227735">e</span><span class="op" id="7227736">)</span><span class="op" id="7227737">,</span>&nbsp;<span class="builtintype" id="7227739">true</span><span class="op" id="7227743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7227747">switch</span>&nbsp;<span class="ident" id="7227754">err</span>&nbsp;<span class="op" id="7227758">:=</span>&nbsp;<span class="ident" id="7227761">err</span><span class="op" id="7227764">.</span><span class="op" id="7227765">(</span><span class="keyword" id="7227766">type</span><span class="op" id="7227770">)</span>&nbsp;<span class="op" id="7227772">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7227776">case</span>&nbsp;<span class="ident" id="7227781">CorruptInputError</span><span class="op" id="7227798">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227803">testEqual</span><span class="op" id="7227812">(</span><span class="ident" id="7227813">t</span><span class="op" id="7227814">,</span>&nbsp;<span class="string" id="7227816">&#34;Corruption&nbsp;in&nbsp;%q&nbsp;at&nbsp;offset&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7227856">,</span>&nbsp;<span class="ident" id="7227858">e</span><span class="op" id="7227859">.</span><span class="ident" id="7227860">e</span><span class="op" id="7227861">,</span>&nbsp;<span class="builtintype" id="7227863">int</span><span class="op" id="7227866">(</span><span class="ident" id="7227867">err</span><span class="op" id="7227870">)</span><span class="op" id="7227871">,</span>&nbsp;<span class="ident" id="7227873">e</span><span class="op" id="7227874">.</span><span class="ident" id="7227875">p</span><span class="op" id="7227876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7227880">default</span><span class="op" id="7227887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227892">t</span><span class="op" id="7227893">.</span><span class="ident" id="7227894">Error</span><span class="op" id="7227899">(</span><span class="string" id="7227900">&#34;Decoder&nbsp;failed&nbsp;to&nbsp;detect&nbsp;corruption&nbsp;in&#34;</span><span class="op" id="7227940">,</span>&nbsp;<span class="ident" id="7227942">e</span><span class="op" id="7227943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7227947">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7227950">}</span><br>
<span class="lineno"></span><span class="op" id="7227952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7227955">func</span>&nbsp;<span class="ident" id="7227960">TestBig</span><span class="op" id="7227967">(</span><span class="ident" id="7227968">t</span>&nbsp;<span class="op" id="7227970">*</span><span class="ident" id="7227971">testing</span><span class="op" id="7227978">.</span><span class="ident" id="7227979">T</span><span class="op" id="7227980">)</span>&nbsp;<span class="op" id="7227982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7227985">n</span>&nbsp;<span class="op" id="7227987">:=</span>&nbsp;<span class="num" id="7227990">3</span><span class="op" id="7227991">*</span><span class="num" id="7227992">1000</span>&nbsp;<span class="op" id="7227997">+</span>&nbsp;<span class="num" id="7227999">1</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228002">raw</span>&nbsp;<span class="op" id="7228006">:=</span>&nbsp;<span class="builtinfunc" id="7228009">make</span><span class="op" id="7228013">(</span><span class="op" id="7228014">[</span><span class="op" id="7228015">]</span><span class="builtintype" id="7228016">byte</span><span class="op" id="7228020">,</span>&nbsp;<span class="ident" id="7228022">n</span><span class="op" id="7228023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7228026">const</span>&nbsp;<span class="ident" id="7228032">alpha</span>&nbsp;<span class="op" id="7228038">=</span>&nbsp;<span class="string" id="7228040">&#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7228106">for</span>&nbsp;<span class="ident" id="7228110">i</span>&nbsp;<span class="op" id="7228112">:=</span>&nbsp;<span class="num" id="7228115">0</span><span class="op" id="7228116">;</span>&nbsp;<span class="ident" id="7228118">i</span>&nbsp;<span class="op" id="7228120">&lt;</span>&nbsp;<span class="ident" id="7228122">n</span><span class="op" id="7228123">;</span>&nbsp;<span class="ident" id="7228125">i</span><span class="op" id="7228126">++</span>&nbsp;<span class="op" id="7228129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228133">raw</span><span class="op" id="7228136">[</span><span class="ident" id="7228137">i</span><span class="op" id="7228138">]</span>&nbsp;<span class="op" id="7228140">=</span>&nbsp;<span class="ident" id="7228142">alpha</span><span class="op" id="7228147">[</span><span class="ident" id="7228148">i</span><span class="op" id="7228149">%</span><span class="builtinfunc" id="7228150">len</span><span class="op" id="7228153">(</span><span class="ident" id="7228154">alpha</span><span class="op" id="7228159">)</span><span class="op" id="7228160">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7228163">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228166">encoded</span>&nbsp;<span class="op" id="7228174">:=</span>&nbsp;<span class="builtinfunc" id="7228177">new</span><span class="op" id="7228180">(</span><span class="ident" id="7228181">bytes</span><span class="op" id="7228186">.</span><span class="ident" id="7228187">Buffer</span><span class="op" id="7228193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228196">w</span>&nbsp;<span class="op" id="7228198">:=</span>&nbsp;<span class="ident" id="7228201">NewEncoder</span><span class="op" id="7228211">(</span><span class="ident" id="7228212">encoded</span><span class="op" id="7228219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228222">nn</span><span class="op" id="7228224">,</span>&nbsp;<span class="ident" id="7228226">err</span>&nbsp;<span class="op" id="7228230">:=</span>&nbsp;<span class="ident" id="7228233">w</span><span class="op" id="7228234">.</span><span class="ident" id="7228235">Write</span><span class="op" id="7228240">(</span><span class="ident" id="7228241">raw</span><span class="op" id="7228244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7228247">if</span>&nbsp;<span class="ident" id="7228250">nn</span>&nbsp;<span class="op" id="7228253">!=</span>&nbsp;<span class="ident" id="7228256">n</span>&nbsp;<span class="op" id="7228258">||</span>&nbsp;<span class="ident" id="7228261">err</span>&nbsp;<span class="op" id="7228265">!=</span>&nbsp;<span class="builtintype" id="7228268">nil</span>&nbsp;<span class="op" id="7228272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228276">t</span><span class="op" id="7228277">.</span><span class="ident" id="7228278">Fatalf</span><span class="op" id="7228284">(</span><span class="string" id="7228285">&#34;Encoder.Write(raw)&nbsp;=&nbsp;%d,&nbsp;%v&nbsp;want&nbsp;%d,&nbsp;nil&#34;</span><span class="op" id="7228327">,</span>&nbsp;<span class="ident" id="7228329">nn</span><span class="op" id="7228331">,</span>&nbsp;<span class="ident" id="7228333">err</span><span class="op" id="7228336">,</span>&nbsp;<span class="ident" id="7228338">n</span><span class="op" id="7228339">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7228342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228345">err</span>&nbsp;<span class="op" id="7228349">=</span>&nbsp;<span class="ident" id="7228351">w</span><span class="op" id="7228352">.</span><span class="ident" id="7228353">Close</span><span class="op" id="7228358">(</span><span class="op" id="7228359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7228362">if</span>&nbsp;<span class="ident" id="7228365">err</span>&nbsp;<span class="op" id="7228369">!=</span>&nbsp;<span class="builtintype" id="7228372">nil</span>&nbsp;<span class="op" id="7228376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228380">t</span><span class="op" id="7228381">.</span><span class="ident" id="7228382">Fatalf</span><span class="op" id="7228388">(</span><span class="string" id="7228389">&#34;Encoder.Close()&nbsp;=&nbsp;%v&nbsp;want&nbsp;nil&#34;</span><span class="op" id="7228420">,</span>&nbsp;<span class="ident" id="7228422">err</span><span class="op" id="7228425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7228428">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228431">decoded</span><span class="op" id="7228438">,</span>&nbsp;<span class="ident" id="7228440">err</span>&nbsp;<span class="op" id="7228444">:=</span>&nbsp;<span class="ident" id="7228447">ioutil</span><span class="op" id="7228453">.</span><span class="ident" id="7228454">ReadAll</span><span class="op" id="7228461">(</span><span class="ident" id="7228462">NewDecoder</span><span class="op" id="7228472">(</span><span class="ident" id="7228473">encoded</span><span class="op" id="7228480">)</span><span class="op" id="7228481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7228484">if</span>&nbsp;<span class="ident" id="7228487">err</span>&nbsp;<span class="op" id="7228491">!=</span>&nbsp;<span class="builtintype" id="7228494">nil</span>&nbsp;<span class="op" id="7228498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228502">t</span><span class="op" id="7228503">.</span><span class="ident" id="7228504">Fatalf</span><span class="op" id="7228510">(</span><span class="string" id="7228511">&#34;io.ReadAll(NewDecoder(...)):&nbsp;%v&#34;</span><span class="op" id="7228544">,</span>&nbsp;<span class="ident" id="7228546">err</span><span class="op" id="7228549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7228552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7228556">if</span>&nbsp;<span class="op" id="7228559">!</span><span class="ident" id="7228560">bytes</span><span class="op" id="7228565">.</span><span class="ident" id="7228566">Equal</span><span class="op" id="7228571">(</span><span class="ident" id="7228572">raw</span><span class="op" id="7228575">,</span>&nbsp;<span class="ident" id="7228577">decoded</span><span class="op" id="7228584">)</span>&nbsp;<span class="op" id="7228586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7228590">var</span>&nbsp;<span class="ident" id="7228594">i</span>&nbsp;<span class="builtintype" id="7228596">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7228602">for</span>&nbsp;<span class="ident" id="7228606">i</span>&nbsp;<span class="op" id="7228608">=</span>&nbsp;<span class="num" id="7228610">0</span><span class="op" id="7228611">;</span>&nbsp;<span class="ident" id="7228613">i</span>&nbsp;<span class="op" id="7228615">&lt;</span>&nbsp;<span class="builtinfunc" id="7228617">len</span><span class="op" id="7228620">(</span><span class="ident" id="7228621">decoded</span><span class="op" id="7228628">)</span>&nbsp;<span class="op" id="7228630">&amp;&amp;</span>&nbsp;<span class="ident" id="7228633">i</span>&nbsp;<span class="op" id="7228635">&lt;</span>&nbsp;<span class="builtinfunc" id="7228637">len</span><span class="op" id="7228640">(</span><span class="ident" id="7228641">raw</span><span class="op" id="7228644">)</span><span class="op" id="7228645">;</span>&nbsp;<span class="ident" id="7228647">i</span><span class="op" id="7228648">++</span>&nbsp;<span class="op" id="7228651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7228656">if</span>&nbsp;<span class="ident" id="7228659">decoded</span><span class="op" id="7228666">[</span><span class="ident" id="7228667">i</span><span class="op" id="7228668">]</span>&nbsp;<span class="op" id="7228670">!=</span>&nbsp;<span class="ident" id="7228673">raw</span><span class="op" id="7228676">[</span><span class="ident" id="7228677">i</span><span class="op" id="7228678">]</span>&nbsp;<span class="op" id="7228680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7228686">break</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7228695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7228699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228703">t</span><span class="op" id="7228704">.</span><span class="ident" id="7228705">Errorf</span><span class="op" id="7228711">(</span><span class="string" id="7228712">&#34;Decode(Encode(%d-byte&nbsp;string))&nbsp;failed&nbsp;at&nbsp;offset&nbsp;%d&#34;</span><span class="op" id="7228764">,</span>&nbsp;<span class="ident" id="7228766">n</span><span class="op" id="7228767">,</span>&nbsp;<span class="ident" id="7228769">i</span><span class="op" id="7228770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7228773">}</span><br>
<span class="lineno"></span><span class="op" id="7228775">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="7228778">func</span>&nbsp;<span class="ident" id="7228783">TestDecoderInternalWhitespace</span><span class="op" id="7228812">(</span><span class="ident" id="7228813">t</span>&nbsp;<span class="op" id="7228815">*</span><span class="ident" id="7228816">testing</span><span class="op" id="7228823">.</span><span class="ident" id="7228824">T</span><span class="op" id="7228825">)</span>&nbsp;<span class="op" id="7228827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228830">s</span>&nbsp;<span class="op" id="7228832">:=</span>&nbsp;<span class="ident" id="7228835">strings</span><span class="op" id="7228842">.</span><span class="ident" id="7228843">Repeat</span><span class="op" id="7228849">(</span><span class="string" id="7228850">&#34;&nbsp;&#34;</span><span class="op" id="7228853">,</span>&nbsp;<span class="num" id="7228855">2048</span><span class="op" id="7228859">)</span>&nbsp;<span class="op" id="7228861">+</span>&nbsp;<span class="string" id="7228863">&#34;z&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228868">decoded</span><span class="op" id="7228875">,</span>&nbsp;<span class="ident" id="7228877">err</span>&nbsp;<span class="op" id="7228881">:=</span>&nbsp;<span class="ident" id="7228884">ioutil</span><span class="op" id="7228890">.</span><span class="ident" id="7228891">ReadAll</span><span class="op" id="7228898">(</span><span class="ident" id="7228899">NewDecoder</span><span class="op" id="7228909">(</span><span class="ident" id="7228910">strings</span><span class="op" id="7228917">.</span><span class="ident" id="7228918">NewReader</span><span class="op" id="7228927">(</span><span class="ident" id="7228928">s</span><span class="op" id="7228929">)</span><span class="op" id="7228930">)</span><span class="op" id="7228931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7228934">if</span>&nbsp;<span class="ident" id="7228937">err</span>&nbsp;<span class="op" id="7228941">!=</span>&nbsp;<span class="builtintype" id="7228944">nil</span>&nbsp;<span class="op" id="7228948">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7228952">t</span><span class="op" id="7228953">.</span><span class="ident" id="7228954">Errorf</span><span class="op" id="7228960">(</span><span class="string" id="7228961">&#34;Decode&nbsp;gave&nbsp;error&nbsp;%v&#34;</span><span class="op" id="7228983">,</span>&nbsp;<span class="ident" id="7228985">err</span><span class="op" id="7228988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7228991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7228994">if</span>&nbsp;<span class="ident" id="7228997">want</span>&nbsp;<span class="op" id="7229002">:=</span>&nbsp;<span class="op" id="7229005">[</span><span class="op" id="7229006">]</span><span class="builtintype" id="7229007">byte</span><span class="op" id="7229011">(</span><span class="string" id="7229012">&#34;\000\000\000\000&#34;</span><span class="op" id="7229030">)</span><span class="op" id="7229031">;</span>&nbsp;<span class="op" id="7229033">!</span><span class="ident" id="7229034">bytes</span><span class="op" id="7229039">.</span><span class="ident" id="7229040">Equal</span><span class="op" id="7229045">(</span><span class="ident" id="7229046">want</span><span class="op" id="7229050">,</span>&nbsp;<span class="ident" id="7229052">decoded</span><span class="op" id="7229059">)</span>&nbsp;<span class="op" id="7229061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7229065">t</span><span class="op" id="7229066">.</span><span class="ident" id="7229067">Errorf</span><span class="op" id="7229073">(</span><span class="string" id="7229074">&#34;Decode&nbsp;failed:&nbsp;got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7229106">,</span>&nbsp;<span class="ident" id="7229108">decoded</span><span class="op" id="7229115">,</span>&nbsp;<span class="ident" id="7229117">want</span><span class="op" id="7229121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7229124">}</span><br>
<span class="lineno">210</span><span class="op" id="7229126">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
