<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base32</h2>
<ul>
<li><a href="/gostd/encoding/base32/base32.go.html">base32.go</a></li>
<li><a href="/gostd/encoding/base32/base32_test.go.html">base32_test.go</a></li>
<li><a href="/gostd/encoding/base32/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6288111">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6288166">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6288220">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6288271">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="6288342">package</span>&nbsp;<span class="ident" id="6288350">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6288358">import</span>&nbsp;<span class="op" id="6288365">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6288368">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6288377">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6288383">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6288394">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="6288404">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6288407">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6288428">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6288496">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="6288564">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="6288624">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="6288681">type</span>&nbsp;<span class="ident" id="6288686">Encoding</span>&nbsp;<span class="keyword" id="6288695">struct</span>&nbsp;<span class="op" id="6288702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6288705">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6288715">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6288723">decodeMap</span>&nbsp;<span class="op" id="6288733">[</span><span class="num" id="6288734">256</span><span class="op" id="6288737">]</span><span class="builtintype" id="6288738">byte</span><br>
<span class="lineno"></span><span class="op" id="6288743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6288746">const</span>&nbsp;<span class="ident" id="6288752">encodeStd</span>&nbsp;<span class="op" id="6288762">=</span>&nbsp;<span class="string" id="6288764">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="6288799">const</span>&nbsp;<span class="ident" id="6288805">encodeHex</span>&nbsp;<span class="op" id="6288815">=</span>&nbsp;<span class="string" id="6288817">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6288853">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="6288922">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="6288957">func</span>&nbsp;<span class="ident" id="6288962">NewEncoding</span><span class="op" id="6288973">(</span><span class="ident" id="6288974">encoder</span>&nbsp;<span class="builtintype" id="6288982">string</span><span class="op" id="6288988">)</span>&nbsp;<span class="op" id="6288990">*</span><span class="ident" id="6288991">Encoding</span>&nbsp;<span class="op" id="6289000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6289003">e</span>&nbsp;<span class="op" id="6289005">:=</span>&nbsp;<span class="builtinfunc" id="6289008">new</span><span class="op" id="6289011">(</span><span class="ident" id="6289012">Encoding</span><span class="op" id="6289020">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6289023">e</span><span class="op" id="6289024">.</span><span class="ident" id="6289025">encode</span>&nbsp;<span class="op" id="6289032">=</span>&nbsp;<span class="ident" id="6289034">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6289043">for</span>&nbsp;<span class="ident" id="6289047">i</span>&nbsp;<span class="op" id="6289049">:=</span>&nbsp;<span class="num" id="6289052">0</span><span class="op" id="6289053">;</span>&nbsp;<span class="ident" id="6289055">i</span>&nbsp;<span class="op" id="6289057">&lt;</span>&nbsp;<span class="builtinfunc" id="6289059">len</span><span class="op" id="6289062">(</span><span class="ident" id="6289063">e</span><span class="op" id="6289064">.</span><span class="ident" id="6289065">decodeMap</span><span class="op" id="6289074">)</span><span class="op" id="6289075">;</span>&nbsp;<span class="ident" id="6289077">i</span><span class="op" id="6289078">++</span>&nbsp;<span class="op" id="6289081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6289085">e</span><span class="op" id="6289086">.</span><span class="ident" id="6289087">decodeMap</span><span class="op" id="6289096">[</span><span class="ident" id="6289097">i</span><span class="op" id="6289098">]</span>&nbsp;<span class="op" id="6289100">=</span>&nbsp;<span class="num" id="6289102">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6289108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6289111">for</span>&nbsp;<span class="ident" id="6289115">i</span>&nbsp;<span class="op" id="6289117">:=</span>&nbsp;<span class="num" id="6289120">0</span><span class="op" id="6289121">;</span>&nbsp;<span class="ident" id="6289123">i</span>&nbsp;<span class="op" id="6289125">&lt;</span>&nbsp;<span class="builtinfunc" id="6289127">len</span><span class="op" id="6289130">(</span><span class="ident" id="6289131">encoder</span><span class="op" id="6289138">)</span><span class="op" id="6289139">;</span>&nbsp;<span class="ident" id="6289141">i</span><span class="op" id="6289142">++</span>&nbsp;<span class="op" id="6289145">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6289149">e</span><span class="op" id="6289150">.</span><span class="ident" id="6289151">decodeMap</span><span class="op" id="6289160">[</span><span class="ident" id="6289161">encoder</span><span class="op" id="6289168">[</span><span class="ident" id="6289169">i</span><span class="op" id="6289170">]</span><span class="op" id="6289171">]</span>&nbsp;<span class="op" id="6289173">=</span>&nbsp;<span class="builtintype" id="6289175">byte</span><span class="op" id="6289179">(</span><span class="ident" id="6289180">i</span><span class="op" id="6289181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6289184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6289187">return</span>&nbsp;<span class="ident" id="6289194">e</span><br>
<span class="lineno"></span><span class="op" id="6289196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="6289199">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6289261">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="6289274">var</span>&nbsp;<span class="ident" id="6289278">StdEncoding</span>&nbsp;<span class="op" id="6289290">=</span>&nbsp;<span class="ident" id="6289292">NewEncoding</span><span class="op" id="6289303">(</span><span class="ident" id="6289304">encodeStd</span><span class="op" id="6289313">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6289316">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="6289385">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="6289417">var</span>&nbsp;<span class="ident" id="6289421">HexEncoding</span>&nbsp;<span class="op" id="6289433">=</span>&nbsp;<span class="ident" id="6289435">NewEncoding</span><span class="op" id="6289446">(</span><span class="ident" id="6289447">encodeHex</span><span class="op" id="6289456">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6289459">var</span>&nbsp;<span class="ident" id="6289463">removeNewlinesMapper</span>&nbsp;<span class="op" id="6289484">=</span>&nbsp;<span class="keyword" id="6289486">func</span><span class="op" id="6289490">(</span><span class="ident" id="6289491">r</span>&nbsp;<span class="builtintype" id="6289493">rune</span><span class="op" id="6289497">)</span>&nbsp;<span class="builtintype" id="6289499">rune</span>&nbsp;<span class="op" id="6289504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6289507">if</span>&nbsp;<span class="ident" id="6289510">r</span>&nbsp;<span class="op" id="6289512">==</span>&nbsp;<span class="string" id="6289515">&#39;\r&#39;</span>&nbsp;<span class="op" id="6289520">||</span>&nbsp;<span class="ident" id="6289523">r</span>&nbsp;<span class="op" id="6289525">==</span>&nbsp;<span class="string" id="6289528">&#39;\n&#39;</span>&nbsp;<span class="op" id="6289533">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6289537">return</span>&nbsp;<span class="op" id="6289544">-</span><span class="num" id="6289545">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6289548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6289551">return</span>&nbsp;<span class="ident" id="6289558">r</span><br>
<span class="lineno"></span><span class="op" id="6289560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="6289563">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6289582">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="6289636">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="6289674">//</span><br>
<span class="lineno"></span><span class="comment" id="6289677">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="6289735">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="6289796">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="6289850">func</span>&nbsp;<span class="op" id="6289855">(</span><span class="ident" id="6289856">enc</span>&nbsp;<span class="op" id="6289860">*</span><span class="ident" id="6289861">Encoding</span><span class="op" id="6289869">)</span>&nbsp;<span class="ident" id="6289871">Encode</span><span class="op" id="6289877">(</span><span class="ident" id="6289878">dst</span><span class="op" id="6289881">,</span>&nbsp;<span class="ident" id="6289883">src</span>&nbsp;<span class="op" id="6289887">[</span><span class="op" id="6289888">]</span><span class="builtintype" id="6289889">byte</span><span class="op" id="6289893">)</span>&nbsp;<span class="op" id="6289895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6289898">if</span>&nbsp;<span class="builtinfunc" id="6289901">len</span><span class="op" id="6289904">(</span><span class="ident" id="6289905">src</span><span class="op" id="6289908">)</span>&nbsp;<span class="op" id="6289910">==</span>&nbsp;<span class="num" id="6289913">0</span>&nbsp;<span class="op" id="6289915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6289919">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6289927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6289931">for</span>&nbsp;<span class="builtinfunc" id="6289935">len</span><span class="op" id="6289938">(</span><span class="ident" id="6289939">src</span><span class="op" id="6289942">)</span>&nbsp;<span class="op" id="6289944">&gt;</span>&nbsp;<span class="num" id="6289946">0</span>&nbsp;<span class="op" id="6289948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6289952">var</span>&nbsp;<span class="ident" id="6289956">b0</span><span class="op" id="6289958">,</span>&nbsp;<span class="ident" id="6289960">b1</span><span class="op" id="6289962">,</span>&nbsp;<span class="ident" id="6289964">b2</span><span class="op" id="6289966">,</span>&nbsp;<span class="ident" id="6289968">b3</span><span class="op" id="6289970">,</span>&nbsp;<span class="ident" id="6289972">b4</span><span class="op" id="6289974">,</span>&nbsp;<span class="ident" id="6289976">b5</span><span class="op" id="6289978">,</span>&nbsp;<span class="ident" id="6289980">b6</span><span class="op" id="6289982">,</span>&nbsp;<span class="ident" id="6289984">b7</span>&nbsp;<span class="builtintype" id="6289987">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6289995">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6290044">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290069">switch</span>&nbsp;<span class="builtinfunc" id="6290076">len</span><span class="op" id="6290079">(</span><span class="ident" id="6290080">src</span><span class="op" id="6290083">)</span>&nbsp;<span class="op" id="6290085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290089">default</span><span class="op" id="6290096">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290101">b7</span>&nbsp;<span class="op" id="6290104">=</span>&nbsp;<span class="ident" id="6290106">src</span><span class="op" id="6290109">[</span><span class="num" id="6290110">4</span><span class="op" id="6290111">]</span>&nbsp;<span class="op" id="6290113">&amp;</span>&nbsp;<span class="num" id="6290115">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290123">b6</span>&nbsp;<span class="op" id="6290126">=</span>&nbsp;<span class="ident" id="6290128">src</span><span class="op" id="6290131">[</span><span class="num" id="6290132">4</span><span class="op" id="6290133">]</span>&nbsp;<span class="op" id="6290135">&gt;&gt;</span>&nbsp;<span class="num" id="6290138">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290143">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290157">case</span>&nbsp;<span class="num" id="6290162">4</span><span class="op" id="6290163">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290168">b6</span>&nbsp;<span class="op" id="6290171">|=</span>&nbsp;<span class="op" id="6290174">(</span><span class="ident" id="6290175">src</span><span class="op" id="6290178">[</span><span class="num" id="6290179">3</span><span class="op" id="6290180">]</span>&nbsp;<span class="op" id="6290182">&lt;&lt;</span>&nbsp;<span class="num" id="6290185">3</span><span class="op" id="6290186">)</span>&nbsp;<span class="op" id="6290188">&amp;</span>&nbsp;<span class="num" id="6290190">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290198">b5</span>&nbsp;<span class="op" id="6290201">=</span>&nbsp;<span class="op" id="6290203">(</span><span class="ident" id="6290204">src</span><span class="op" id="6290207">[</span><span class="num" id="6290208">3</span><span class="op" id="6290209">]</span>&nbsp;<span class="op" id="6290211">&gt;&gt;</span>&nbsp;<span class="num" id="6290214">2</span><span class="op" id="6290215">)</span>&nbsp;<span class="op" id="6290217">&amp;</span>&nbsp;<span class="num" id="6290219">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290227">b4</span>&nbsp;<span class="op" id="6290230">=</span>&nbsp;<span class="ident" id="6290232">src</span><span class="op" id="6290235">[</span><span class="num" id="6290236">3</span><span class="op" id="6290237">]</span>&nbsp;<span class="op" id="6290239">&gt;&gt;</span>&nbsp;<span class="num" id="6290242">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290247">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290261">case</span>&nbsp;<span class="num" id="6290266">3</span><span class="op" id="6290267">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290272">b4</span>&nbsp;<span class="op" id="6290275">|=</span>&nbsp;<span class="op" id="6290278">(</span><span class="ident" id="6290279">src</span><span class="op" id="6290282">[</span><span class="num" id="6290283">2</span><span class="op" id="6290284">]</span>&nbsp;<span class="op" id="6290286">&lt;&lt;</span>&nbsp;<span class="num" id="6290289">1</span><span class="op" id="6290290">)</span>&nbsp;<span class="op" id="6290292">&amp;</span>&nbsp;<span class="num" id="6290294">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290302">b3</span>&nbsp;<span class="op" id="6290305">=</span>&nbsp;<span class="op" id="6290307">(</span><span class="ident" id="6290308">src</span><span class="op" id="6290311">[</span><span class="num" id="6290312">2</span><span class="op" id="6290313">]</span>&nbsp;<span class="op" id="6290315">&gt;&gt;</span>&nbsp;<span class="num" id="6290318">4</span><span class="op" id="6290319">)</span>&nbsp;<span class="op" id="6290321">&amp;</span>&nbsp;<span class="num" id="6290323">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290331">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290345">case</span>&nbsp;<span class="num" id="6290350">2</span><span class="op" id="6290351">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290356">b3</span>&nbsp;<span class="op" id="6290359">|=</span>&nbsp;<span class="op" id="6290362">(</span><span class="ident" id="6290363">src</span><span class="op" id="6290366">[</span><span class="num" id="6290367">1</span><span class="op" id="6290368">]</span>&nbsp;<span class="op" id="6290370">&lt;&lt;</span>&nbsp;<span class="num" id="6290373">4</span><span class="op" id="6290374">)</span>&nbsp;<span class="op" id="6290376">&amp;</span>&nbsp;<span class="num" id="6290378">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290386">b2</span>&nbsp;<span class="op" id="6290389">=</span>&nbsp;<span class="op" id="6290391">(</span><span class="ident" id="6290392">src</span><span class="op" id="6290395">[</span><span class="num" id="6290396">1</span><span class="op" id="6290397">]</span>&nbsp;<span class="op" id="6290399">&gt;&gt;</span>&nbsp;<span class="num" id="6290402">1</span><span class="op" id="6290403">)</span>&nbsp;<span class="op" id="6290405">&amp;</span>&nbsp;<span class="num" id="6290407">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290415">b1</span>&nbsp;<span class="op" id="6290418">=</span>&nbsp;<span class="op" id="6290420">(</span><span class="ident" id="6290421">src</span><span class="op" id="6290424">[</span><span class="num" id="6290425">1</span><span class="op" id="6290426">]</span>&nbsp;<span class="op" id="6290428">&gt;&gt;</span>&nbsp;<span class="num" id="6290431">6</span><span class="op" id="6290432">)</span>&nbsp;<span class="op" id="6290434">&amp;</span>&nbsp;<span class="num" id="6290436">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290444">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290458">case</span>&nbsp;<span class="num" id="6290463">1</span><span class="op" id="6290464">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290469">b1</span>&nbsp;<span class="op" id="6290472">|=</span>&nbsp;<span class="op" id="6290475">(</span><span class="ident" id="6290476">src</span><span class="op" id="6290479">[</span><span class="num" id="6290480">0</span><span class="op" id="6290481">]</span>&nbsp;<span class="op" id="6290483">&lt;&lt;</span>&nbsp;<span class="num" id="6290486">2</span><span class="op" id="6290487">)</span>&nbsp;<span class="op" id="6290489">&amp;</span>&nbsp;<span class="num" id="6290491">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290499">b0</span>&nbsp;<span class="op" id="6290502">=</span>&nbsp;<span class="ident" id="6290504">src</span><span class="op" id="6290507">[</span><span class="num" id="6290508">0</span><span class="op" id="6290509">]</span>&nbsp;<span class="op" id="6290511">&gt;&gt;</span>&nbsp;<span class="num" id="6290514">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6290518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6290523">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290574">dst</span><span class="op" id="6290577">[</span><span class="num" id="6290578">0</span><span class="op" id="6290579">]</span>&nbsp;<span class="op" id="6290581">=</span>&nbsp;<span class="ident" id="6290583">enc</span><span class="op" id="6290586">.</span><span class="ident" id="6290587">encode</span><span class="op" id="6290593">[</span><span class="ident" id="6290594">b0</span><span class="op" id="6290596">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290600">dst</span><span class="op" id="6290603">[</span><span class="num" id="6290604">1</span><span class="op" id="6290605">]</span>&nbsp;<span class="op" id="6290607">=</span>&nbsp;<span class="ident" id="6290609">enc</span><span class="op" id="6290612">.</span><span class="ident" id="6290613">encode</span><span class="op" id="6290619">[</span><span class="ident" id="6290620">b1</span><span class="op" id="6290622">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290626">dst</span><span class="op" id="6290629">[</span><span class="num" id="6290630">2</span><span class="op" id="6290631">]</span>&nbsp;<span class="op" id="6290633">=</span>&nbsp;<span class="ident" id="6290635">enc</span><span class="op" id="6290638">.</span><span class="ident" id="6290639">encode</span><span class="op" id="6290645">[</span><span class="ident" id="6290646">b2</span><span class="op" id="6290648">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290652">dst</span><span class="op" id="6290655">[</span><span class="num" id="6290656">3</span><span class="op" id="6290657">]</span>&nbsp;<span class="op" id="6290659">=</span>&nbsp;<span class="ident" id="6290661">enc</span><span class="op" id="6290664">.</span><span class="ident" id="6290665">encode</span><span class="op" id="6290671">[</span><span class="ident" id="6290672">b3</span><span class="op" id="6290674">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290678">dst</span><span class="op" id="6290681">[</span><span class="num" id="6290682">4</span><span class="op" id="6290683">]</span>&nbsp;<span class="op" id="6290685">=</span>&nbsp;<span class="ident" id="6290687">enc</span><span class="op" id="6290690">.</span><span class="ident" id="6290691">encode</span><span class="op" id="6290697">[</span><span class="ident" id="6290698">b4</span><span class="op" id="6290700">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290704">dst</span><span class="op" id="6290707">[</span><span class="num" id="6290708">5</span><span class="op" id="6290709">]</span>&nbsp;<span class="op" id="6290711">=</span>&nbsp;<span class="ident" id="6290713">enc</span><span class="op" id="6290716">.</span><span class="ident" id="6290717">encode</span><span class="op" id="6290723">[</span><span class="ident" id="6290724">b5</span><span class="op" id="6290726">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290730">dst</span><span class="op" id="6290733">[</span><span class="num" id="6290734">6</span><span class="op" id="6290735">]</span>&nbsp;<span class="op" id="6290737">=</span>&nbsp;<span class="ident" id="6290739">enc</span><span class="op" id="6290742">.</span><span class="ident" id="6290743">encode</span><span class="op" id="6290749">[</span><span class="ident" id="6290750">b6</span><span class="op" id="6290752">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290756">dst</span><span class="op" id="6290759">[</span><span class="num" id="6290760">7</span><span class="op" id="6290761">]</span>&nbsp;<span class="op" id="6290763">=</span>&nbsp;<span class="ident" id="6290765">enc</span><span class="op" id="6290768">.</span><span class="ident" id="6290769">encode</span><span class="op" id="6290775">[</span><span class="ident" id="6290776">b7</span><span class="op" id="6290778">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6290783">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290810">if</span>&nbsp;<span class="builtinfunc" id="6290813">len</span><span class="op" id="6290816">(</span><span class="ident" id="6290817">src</span><span class="op" id="6290820">)</span>&nbsp;<span class="op" id="6290822">&lt;</span>&nbsp;<span class="num" id="6290824">5</span>&nbsp;<span class="op" id="6290826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290831">dst</span><span class="op" id="6290834">[</span><span class="num" id="6290835">7</span><span class="op" id="6290836">]</span>&nbsp;<span class="op" id="6290838">=</span>&nbsp;<span class="string" id="6290840">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290847">if</span>&nbsp;<span class="builtinfunc" id="6290850">len</span><span class="op" id="6290853">(</span><span class="ident" id="6290854">src</span><span class="op" id="6290857">)</span>&nbsp;<span class="op" id="6290859">&lt;</span>&nbsp;<span class="num" id="6290861">4</span>&nbsp;<span class="op" id="6290863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290869">dst</span><span class="op" id="6290872">[</span><span class="num" id="6290873">6</span><span class="op" id="6290874">]</span>&nbsp;<span class="op" id="6290876">=</span>&nbsp;<span class="string" id="6290878">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290886">dst</span><span class="op" id="6290889">[</span><span class="num" id="6290890">5</span><span class="op" id="6290891">]</span>&nbsp;<span class="op" id="6290893">=</span>&nbsp;<span class="string" id="6290895">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290903">if</span>&nbsp;<span class="builtinfunc" id="6290906">len</span><span class="op" id="6290909">(</span><span class="ident" id="6290910">src</span><span class="op" id="6290913">)</span>&nbsp;<span class="op" id="6290915">&lt;</span>&nbsp;<span class="num" id="6290917">3</span>&nbsp;<span class="op" id="6290919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290926">dst</span><span class="op" id="6290929">[</span><span class="num" id="6290930">4</span><span class="op" id="6290931">]</span>&nbsp;<span class="op" id="6290933">=</span>&nbsp;<span class="string" id="6290935">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6290944">if</span>&nbsp;<span class="builtinfunc" id="6290947">len</span><span class="op" id="6290950">(</span><span class="ident" id="6290951">src</span><span class="op" id="6290954">)</span>&nbsp;<span class="op" id="6290956">&lt;</span>&nbsp;<span class="num" id="6290958">2</span>&nbsp;<span class="op" id="6290960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290968">dst</span><span class="op" id="6290971">[</span><span class="num" id="6290972">3</span><span class="op" id="6290973">]</span>&nbsp;<span class="op" id="6290975">=</span>&nbsp;<span class="string" id="6290977">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6290987">dst</span><span class="op" id="6290990">[</span><span class="num" id="6290991">2</span><span class="op" id="6290992">]</span>&nbsp;<span class="op" id="6290994">=</span>&nbsp;<span class="string" id="6290996">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6291005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6291011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6291016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291021">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6291029">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291033">src</span>&nbsp;<span class="op" id="6291037">=</span>&nbsp;<span class="ident" id="6291039">src</span><span class="op" id="6291042">[</span><span class="num" id="6291043">5</span><span class="op" id="6291044">:</span><span class="op" id="6291045">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291049">dst</span>&nbsp;<span class="op" id="6291053">=</span>&nbsp;<span class="ident" id="6291055">dst</span><span class="op" id="6291058">[</span><span class="num" id="6291059">8</span><span class="op" id="6291060">:</span><span class="op" id="6291061">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6291064">}</span><br>
<span class="lineno"></span><span class="op" id="6291066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="6291069">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="6291123">func</span>&nbsp;<span class="op" id="6291128">(</span><span class="ident" id="6291129">enc</span>&nbsp;<span class="op" id="6291133">*</span><span class="ident" id="6291134">Encoding</span><span class="op" id="6291142">)</span>&nbsp;<span class="ident" id="6291144">EncodeToString</span><span class="op" id="6291158">(</span><span class="ident" id="6291159">src</span>&nbsp;<span class="op" id="6291163">[</span><span class="op" id="6291164">]</span><span class="builtintype" id="6291165">byte</span><span class="op" id="6291169">)</span>&nbsp;<span class="builtintype" id="6291171">string</span>&nbsp;<span class="op" id="6291178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291181">buf</span>&nbsp;<span class="op" id="6291185">:=</span>&nbsp;<span class="builtinfunc" id="6291188">make</span><span class="op" id="6291192">(</span><span class="op" id="6291193">[</span><span class="op" id="6291194">]</span><span class="builtintype" id="6291195">byte</span><span class="op" id="6291199">,</span>&nbsp;<span class="ident" id="6291201">enc</span><span class="op" id="6291204">.</span><span class="ident" id="6291205">EncodedLen</span><span class="op" id="6291215">(</span><span class="builtinfunc" id="6291216">len</span><span class="op" id="6291219">(</span><span class="ident" id="6291220">src</span><span class="op" id="6291223">)</span><span class="op" id="6291224">)</span><span class="op" id="6291225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291228">enc</span><span class="op" id="6291231">.</span><span class="ident" id="6291232">Encode</span><span class="op" id="6291238">(</span><span class="ident" id="6291239">buf</span><span class="op" id="6291242">,</span>&nbsp;<span class="ident" id="6291244">src</span><span class="op" id="6291247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291250">return</span>&nbsp;<span class="builtintype" id="6291257">string</span><span class="op" id="6291263">(</span><span class="ident" id="6291264">buf</span><span class="op" id="6291267">)</span><br>
<span class="lineno">140</span><span class="op" id="6291269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6291272">type</span>&nbsp;<span class="ident" id="6291277">encoder</span>&nbsp;<span class="keyword" id="6291285">struct</span>&nbsp;<span class="op" id="6291292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291295">err</span>&nbsp;&nbsp;<span class="builtintype" id="6291300">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291307">enc</span>&nbsp;&nbsp;<span class="op" id="6291312">*</span><span class="ident" id="6291313">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291323">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6291328">io</span><span class="op" id="6291330">.</span><span class="ident" id="6291331">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291339">buf</span>&nbsp;&nbsp;<span class="op" id="6291344">[</span><span class="num" id="6291345">5</span><span class="op" id="6291346">]</span><span class="builtintype" id="6291347">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6291355">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291395">nbuf</span>&nbsp;<span class="builtintype" id="6291400">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6291411">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291438">out</span>&nbsp;&nbsp;<span class="op" id="6291443">[</span><span class="num" id="6291444">1024</span><span class="op" id="6291448">]</span><span class="builtintype" id="6291449">byte</span>&nbsp;<span class="comment" id="6291454">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="6291471">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="6291474">func</span>&nbsp;<span class="op" id="6291479">(</span><span class="ident" id="6291480">e</span>&nbsp;<span class="op" id="6291482">*</span><span class="ident" id="6291483">encoder</span><span class="op" id="6291490">)</span>&nbsp;<span class="ident" id="6291492">Write</span><span class="op" id="6291497">(</span><span class="ident" id="6291498">p</span>&nbsp;<span class="op" id="6291500">[</span><span class="op" id="6291501">]</span><span class="builtintype" id="6291502">byte</span><span class="op" id="6291506">)</span>&nbsp;<span class="op" id="6291508">(</span><span class="ident" id="6291509">n</span>&nbsp;<span class="builtintype" id="6291511">int</span><span class="op" id="6291514">,</span>&nbsp;<span class="ident" id="6291516">err</span>&nbsp;<span class="builtintype" id="6291520">error</span><span class="op" id="6291525">)</span>&nbsp;<span class="op" id="6291527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291530">if</span>&nbsp;<span class="ident" id="6291533">e</span><span class="op" id="6291534">.</span><span class="ident" id="6291535">err</span>&nbsp;<span class="op" id="6291539">!=</span>&nbsp;<span class="ident" id="6291542">nil</span>&nbsp;<span class="op" id="6291546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291550">return</span>&nbsp;<span class="num" id="6291557">0</span><span class="op" id="6291558">,</span>&nbsp;<span class="ident" id="6291560">e</span><span class="op" id="6291561">.</span><span class="ident" id="6291562">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6291567">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6291571">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291591">if</span>&nbsp;<span class="ident" id="6291594">e</span><span class="op" id="6291595">.</span><span class="ident" id="6291596">nbuf</span>&nbsp;<span class="op" id="6291601">&gt;</span>&nbsp;<span class="num" id="6291603">0</span>&nbsp;<span class="op" id="6291605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291609">var</span>&nbsp;<span class="ident" id="6291613">i</span>&nbsp;<span class="builtintype" id="6291615">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291621">for</span>&nbsp;<span class="ident" id="6291625">i</span>&nbsp;<span class="op" id="6291627">=</span>&nbsp;<span class="num" id="6291629">0</span><span class="op" id="6291630">;</span>&nbsp;<span class="ident" id="6291632">i</span>&nbsp;<span class="op" id="6291634">&lt;</span>&nbsp;<span class="builtinfunc" id="6291636">len</span><span class="op" id="6291639">(</span><span class="ident" id="6291640">p</span><span class="op" id="6291641">)</span>&nbsp;<span class="op" id="6291643">&amp;&amp;</span>&nbsp;<span class="ident" id="6291646">e</span><span class="op" id="6291647">.</span><span class="ident" id="6291648">nbuf</span>&nbsp;<span class="op" id="6291653">&lt;</span>&nbsp;<span class="num" id="6291655">5</span><span class="op" id="6291656">;</span>&nbsp;<span class="ident" id="6291658">i</span><span class="op" id="6291659">++</span>&nbsp;<span class="op" id="6291662">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291667">e</span><span class="op" id="6291668">.</span><span class="ident" id="6291669">buf</span><span class="op" id="6291672">[</span><span class="ident" id="6291673">e</span><span class="op" id="6291674">.</span><span class="ident" id="6291675">nbuf</span><span class="op" id="6291679">]</span>&nbsp;<span class="op" id="6291681">=</span>&nbsp;<span class="ident" id="6291683">p</span><span class="op" id="6291684">[</span><span class="ident" id="6291685">i</span><span class="op" id="6291686">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291691">e</span><span class="op" id="6291692">.</span><span class="ident" id="6291693">nbuf</span><span class="op" id="6291697">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6291702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291706">n</span>&nbsp;<span class="op" id="6291708">+=</span>&nbsp;<span class="ident" id="6291711">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291715">p</span>&nbsp;<span class="op" id="6291717">=</span>&nbsp;<span class="ident" id="6291719">p</span><span class="op" id="6291720">[</span><span class="ident" id="6291721">i</span><span class="op" id="6291722">:</span><span class="op" id="6291723">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291727">if</span>&nbsp;<span class="ident" id="6291730">e</span><span class="op" id="6291731">.</span><span class="ident" id="6291732">nbuf</span>&nbsp;<span class="op" id="6291737">&lt;</span>&nbsp;<span class="num" id="6291739">5</span>&nbsp;<span class="op" id="6291741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291746">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6291755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291759">e</span><span class="op" id="6291760">.</span><span class="ident" id="6291761">enc</span><span class="op" id="6291764">.</span><span class="ident" id="6291765">Encode</span><span class="op" id="6291771">(</span><span class="ident" id="6291772">e</span><span class="op" id="6291773">.</span><span class="ident" id="6291774">out</span><span class="op" id="6291777">[</span><span class="num" id="6291778">0</span><span class="op" id="6291779">:</span><span class="op" id="6291780">]</span><span class="op" id="6291781">,</span>&nbsp;<span class="ident" id="6291783">e</span><span class="op" id="6291784">.</span><span class="ident" id="6291785">buf</span><span class="op" id="6291788">[</span><span class="num" id="6291789">0</span><span class="op" id="6291790">:</span><span class="op" id="6291791">]</span><span class="op" id="6291792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291796">if</span>&nbsp;<span class="ident" id="6291799">_</span><span class="op" id="6291800">,</span>&nbsp;<span class="ident" id="6291802">e</span><span class="op" id="6291803">.</span><span class="ident" id="6291804">err</span>&nbsp;<span class="op" id="6291808">=</span>&nbsp;<span class="ident" id="6291810">e</span><span class="op" id="6291811">.</span><span class="ident" id="6291812">w</span><span class="op" id="6291813">.</span><span class="ident" id="6291814">Write</span><span class="op" id="6291819">(</span><span class="ident" id="6291820">e</span><span class="op" id="6291821">.</span><span class="ident" id="6291822">out</span><span class="op" id="6291825">[</span><span class="num" id="6291826">0</span><span class="op" id="6291827">:</span><span class="num" id="6291828">8</span><span class="op" id="6291829">]</span><span class="op" id="6291830">)</span><span class="op" id="6291831">;</span>&nbsp;<span class="ident" id="6291833">e</span><span class="op" id="6291834">.</span><span class="ident" id="6291835">err</span>&nbsp;<span class="op" id="6291839">!=</span>&nbsp;<span class="ident" id="6291842">nil</span>&nbsp;<span class="op" id="6291846">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291851">return</span>&nbsp;<span class="ident" id="6291858">n</span><span class="op" id="6291859">,</span>&nbsp;<span class="ident" id="6291861">e</span><span class="op" id="6291862">.</span><span class="ident" id="6291863">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6291869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291873">e</span><span class="op" id="6291874">.</span><span class="ident" id="6291875">nbuf</span>&nbsp;<span class="op" id="6291880">=</span>&nbsp;<span class="num" id="6291882">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6291885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6291889">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291916">for</span>&nbsp;<span class="builtinfunc" id="6291920">len</span><span class="op" id="6291923">(</span><span class="ident" id="6291924">p</span><span class="op" id="6291925">)</span>&nbsp;<span class="op" id="6291927">&gt;=</span>&nbsp;<span class="num" id="6291930">5</span>&nbsp;<span class="op" id="6291932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291936">nn</span>&nbsp;<span class="op" id="6291939">:=</span>&nbsp;<span class="builtinfunc" id="6291942">len</span><span class="op" id="6291945">(</span><span class="ident" id="6291946">e</span><span class="op" id="6291947">.</span><span class="ident" id="6291948">out</span><span class="op" id="6291951">)</span>&nbsp;<span class="op" id="6291953">/</span>&nbsp;<span class="num" id="6291955">8</span>&nbsp;<span class="op" id="6291957">*</span>&nbsp;<span class="num" id="6291959">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6291963">if</span>&nbsp;<span class="ident" id="6291966">nn</span>&nbsp;<span class="op" id="6291969">&gt;</span>&nbsp;<span class="builtinfunc" id="6291971">len</span><span class="op" id="6291974">(</span><span class="ident" id="6291975">p</span><span class="op" id="6291976">)</span>&nbsp;<span class="op" id="6291978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291983">nn</span>&nbsp;<span class="op" id="6291986">=</span>&nbsp;<span class="builtinfunc" id="6291988">len</span><span class="op" id="6291991">(</span><span class="ident" id="6291992">p</span><span class="op" id="6291993">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6291998">nn</span>&nbsp;<span class="op" id="6292001">-=</span>&nbsp;<span class="ident" id="6292004">nn</span>&nbsp;<span class="op" id="6292007">%</span>&nbsp;<span class="num" id="6292009">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6292013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6292017">e</span><span class="op" id="6292018">.</span><span class="ident" id="6292019">enc</span><span class="op" id="6292022">.</span><span class="ident" id="6292023">Encode</span><span class="op" id="6292029">(</span><span class="ident" id="6292030">e</span><span class="op" id="6292031">.</span><span class="ident" id="6292032">out</span><span class="op" id="6292035">[</span><span class="num" id="6292036">0</span><span class="op" id="6292037">:</span><span class="op" id="6292038">]</span><span class="op" id="6292039">,</span>&nbsp;<span class="ident" id="6292041">p</span><span class="op" id="6292042">[</span><span class="num" id="6292043">0</span><span class="op" id="6292044">:</span><span class="ident" id="6292045">nn</span><span class="op" id="6292047">]</span><span class="op" id="6292048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6292052">if</span>&nbsp;<span class="ident" id="6292055">_</span><span class="op" id="6292056">,</span>&nbsp;<span class="ident" id="6292058">e</span><span class="op" id="6292059">.</span><span class="ident" id="6292060">err</span>&nbsp;<span class="op" id="6292064">=</span>&nbsp;<span class="ident" id="6292066">e</span><span class="op" id="6292067">.</span><span class="ident" id="6292068">w</span><span class="op" id="6292069">.</span><span class="ident" id="6292070">Write</span><span class="op" id="6292075">(</span><span class="ident" id="6292076">e</span><span class="op" id="6292077">.</span><span class="ident" id="6292078">out</span><span class="op" id="6292081">[</span><span class="num" id="6292082">0</span>&nbsp;<span class="op" id="6292084">:</span>&nbsp;<span class="ident" id="6292086">nn</span><span class="op" id="6292088">/</span><span class="num" id="6292089">5</span><span class="op" id="6292090">*</span><span class="num" id="6292091">8</span><span class="op" id="6292092">]</span><span class="op" id="6292093">)</span><span class="op" id="6292094">;</span>&nbsp;<span class="ident" id="6292096">e</span><span class="op" id="6292097">.</span><span class="ident" id="6292098">err</span>&nbsp;<span class="op" id="6292102">!=</span>&nbsp;<span class="ident" id="6292105">nil</span>&nbsp;<span class="op" id="6292109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6292114">return</span>&nbsp;<span class="ident" id="6292121">n</span><span class="op" id="6292122">,</span>&nbsp;<span class="ident" id="6292124">e</span><span class="op" id="6292125">.</span><span class="ident" id="6292126">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6292132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6292136">n</span>&nbsp;<span class="op" id="6292138">+=</span>&nbsp;<span class="ident" id="6292141">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6292146">p</span>&nbsp;<span class="op" id="6292148">=</span>&nbsp;<span class="ident" id="6292150">p</span><span class="op" id="6292151">[</span><span class="ident" id="6292152">nn</span><span class="op" id="6292154">:</span><span class="op" id="6292155">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6292158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6292162">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6292183">for</span>&nbsp;<span class="ident" id="6292187">i</span>&nbsp;<span class="op" id="6292189">:=</span>&nbsp;<span class="num" id="6292192">0</span><span class="op" id="6292193">;</span>&nbsp;<span class="ident" id="6292195">i</span>&nbsp;<span class="op" id="6292197">&lt;</span>&nbsp;<span class="builtinfunc" id="6292199">len</span><span class="op" id="6292202">(</span><span class="ident" id="6292203">p</span><span class="op" id="6292204">)</span><span class="op" id="6292205">;</span>&nbsp;<span class="ident" id="6292207">i</span><span class="op" id="6292208">++</span>&nbsp;<span class="op" id="6292211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6292215">e</span><span class="op" id="6292216">.</span><span class="ident" id="6292217">buf</span><span class="op" id="6292220">[</span><span class="ident" id="6292221">i</span><span class="op" id="6292222">]</span>&nbsp;<span class="op" id="6292224">=</span>&nbsp;<span class="ident" id="6292226">p</span><span class="op" id="6292227">[</span><span class="ident" id="6292228">i</span><span class="op" id="6292229">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6292232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6292235">e</span><span class="op" id="6292236">.</span><span class="ident" id="6292237">nbuf</span>&nbsp;<span class="op" id="6292242">=</span>&nbsp;<span class="builtinfunc" id="6292244">len</span><span class="op" id="6292247">(</span><span class="ident" id="6292248">p</span><span class="op" id="6292249">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6292252">n</span>&nbsp;<span class="op" id="6292254">+=</span>&nbsp;<span class="builtinfunc" id="6292257">len</span><span class="op" id="6292260">(</span><span class="ident" id="6292261">p</span><span class="op" id="6292262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6292265">return</span><br>
<span class="lineno"></span><span class="op" id="6292272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6292275">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="6292329">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="6292382">func</span>&nbsp;<span class="op" id="6292387">(</span><span class="ident" id="6292388">e</span>&nbsp;<span class="op" id="6292390">*</span><span class="ident" id="6292391">encoder</span><span class="op" id="6292398">)</span>&nbsp;<span class="ident" id="6292400">Close</span><span class="op" id="6292405">(</span><span class="op" id="6292406">)</span>&nbsp;<span class="builtintype" id="6292408">error</span>&nbsp;<span class="op" id="6292414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6292417">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6292474">if</span>&nbsp;<span class="ident" id="6292477">e</span><span class="op" id="6292478">.</span><span class="ident" id="6292479">err</span>&nbsp;<span class="op" id="6292483">==</span>&nbsp;<span class="ident" id="6292486">nil</span>&nbsp;<span class="op" id="6292490">&amp;&amp;</span>&nbsp;<span class="ident" id="6292493">e</span><span class="op" id="6292494">.</span><span class="ident" id="6292495">nbuf</span>&nbsp;<span class="op" id="6292500">&gt;</span>&nbsp;<span class="num" id="6292502">0</span>&nbsp;<span class="op" id="6292504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6292508">e</span><span class="op" id="6292509">.</span><span class="ident" id="6292510">enc</span><span class="op" id="6292513">.</span><span class="ident" id="6292514">Encode</span><span class="op" id="6292520">(</span><span class="ident" id="6292521">e</span><span class="op" id="6292522">.</span><span class="ident" id="6292523">out</span><span class="op" id="6292526">[</span><span class="num" id="6292527">0</span><span class="op" id="6292528">:</span><span class="op" id="6292529">]</span><span class="op" id="6292530">,</span>&nbsp;<span class="ident" id="6292532">e</span><span class="op" id="6292533">.</span><span class="ident" id="6292534">buf</span><span class="op" id="6292537">[</span><span class="num" id="6292538">0</span><span class="op" id="6292539">:</span><span class="ident" id="6292540">e</span><span class="op" id="6292541">.</span><span class="ident" id="6292542">nbuf</span><span class="op" id="6292546">]</span><span class="op" id="6292547">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6292551">e</span><span class="op" id="6292552">.</span><span class="ident" id="6292553">nbuf</span>&nbsp;<span class="op" id="6292558">=</span>&nbsp;<span class="num" id="6292560">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6292564">_</span><span class="op" id="6292565">,</span>&nbsp;<span class="ident" id="6292567">e</span><span class="op" id="6292568">.</span><span class="ident" id="6292569">err</span>&nbsp;<span class="op" id="6292573">=</span>&nbsp;<span class="ident" id="6292575">e</span><span class="op" id="6292576">.</span><span class="ident" id="6292577">w</span><span class="op" id="6292578">.</span><span class="ident" id="6292579">Write</span><span class="op" id="6292584">(</span><span class="ident" id="6292585">e</span><span class="op" id="6292586">.</span><span class="ident" id="6292587">out</span><span class="op" id="6292590">[</span><span class="num" id="6292591">0</span><span class="op" id="6292592">:</span><span class="num" id="6292593">8</span><span class="op" id="6292594">]</span><span class="op" id="6292595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6292598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6292601">return</span>&nbsp;<span class="ident" id="6292608">e</span><span class="op" id="6292609">.</span><span class="ident" id="6292610">err</span><br>
<span class="lineno"></span><span class="op" id="6292614">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="6292617">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6292685">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="6292757">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="6292817">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="6292885">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="6292914">func</span>&nbsp;<span class="ident" id="6292919">NewEncoder</span><span class="op" id="6292929">(</span><span class="ident" id="6292930">enc</span>&nbsp;<span class="op" id="6292934">*</span><span class="ident" id="6292935">Encoding</span><span class="op" id="6292943">,</span>&nbsp;<span class="ident" id="6292945">w</span>&nbsp;<span class="ident" id="6292947">io</span><span class="op" id="6292949">.</span><span class="ident" id="6292950">Writer</span><span class="op" id="6292956">)</span>&nbsp;<span class="ident" id="6292958">io</span><span class="op" id="6292960">.</span><span class="ident" id="6292961">WriteCloser</span>&nbsp;<span class="op" id="6292973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6292976">return</span>&nbsp;<span class="op" id="6292983">&amp;</span><span class="ident" id="6292984">encoder</span><span class="op" id="6292991">{</span><span class="ident" id="6292992">enc</span><span class="op" id="6292995">:</span>&nbsp;<span class="ident" id="6292997">enc</span><span class="op" id="6293000">,</span>&nbsp;<span class="ident" id="6293002">w</span><span class="op" id="6293003">:</span>&nbsp;<span class="ident" id="6293005">w</span><span class="op" id="6293006">}</span><br>
<span class="lineno"></span><span class="op" id="6293008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="6293011">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="6293076">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="6293111">func</span>&nbsp;<span class="op" id="6293116">(</span><span class="ident" id="6293117">enc</span>&nbsp;<span class="op" id="6293121">*</span><span class="ident" id="6293122">Encoding</span><span class="op" id="6293130">)</span>&nbsp;<span class="ident" id="6293132">EncodedLen</span><span class="op" id="6293142">(</span><span class="ident" id="6293143">n</span>&nbsp;<span class="builtintype" id="6293145">int</span><span class="op" id="6293148">)</span>&nbsp;<span class="builtintype" id="6293150">int</span>&nbsp;<span class="op" id="6293154">{</span>&nbsp;<span class="keyword" id="6293156">return</span>&nbsp;<span class="op" id="6293163">(</span><span class="ident" id="6293164">n</span>&nbsp;<span class="op" id="6293166">+</span>&nbsp;<span class="num" id="6293168">4</span><span class="op" id="6293169">)</span>&nbsp;<span class="op" id="6293171">/</span>&nbsp;<span class="num" id="6293173">5</span>&nbsp;<span class="op" id="6293175">*</span>&nbsp;<span class="num" id="6293177">8</span>&nbsp;<span class="op" id="6293179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6293182">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6293201">type</span>&nbsp;<span class="ident" id="6293206">CorruptInputError</span>&nbsp;<span class="ident" id="6293224">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="6293231">func</span>&nbsp;<span class="op" id="6293236">(</span><span class="ident" id="6293237">e</span>&nbsp;<span class="ident" id="6293239">CorruptInputError</span><span class="op" id="6293256">)</span>&nbsp;<span class="ident" id="6293258">Error</span><span class="op" id="6293263">(</span><span class="op" id="6293264">)</span>&nbsp;<span class="builtintype" id="6293266">string</span>&nbsp;<span class="op" id="6293273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6293276">return</span>&nbsp;<span class="string" id="6293283">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="6293320">+</span>&nbsp;<span class="ident" id="6293322">strconv</span><span class="op" id="6293329">.</span><span class="ident" id="6293330">FormatInt</span><span class="op" id="6293339">(</span><span class="ident" id="6293340">int64</span><span class="op" id="6293345">(</span><span class="ident" id="6293346">e</span><span class="op" id="6293347">)</span><span class="op" id="6293348">,</span>&nbsp;<span class="num" id="6293350">10</span><span class="op" id="6293352">)</span><br>
<span class="lineno"></span><span class="op" id="6293354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6293357">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="6293427">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="6293495">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="6293565">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="6293622">func</span>&nbsp;<span class="op" id="6293627">(</span><span class="ident" id="6293628">enc</span>&nbsp;<span class="op" id="6293632">*</span><span class="ident" id="6293633">Encoding</span><span class="op" id="6293641">)</span>&nbsp;<span class="ident" id="6293643">decode</span><span class="op" id="6293649">(</span><span class="ident" id="6293650">dst</span><span class="op" id="6293653">,</span>&nbsp;<span class="ident" id="6293655">src</span>&nbsp;<span class="op" id="6293659">[</span><span class="op" id="6293660">]</span><span class="builtintype" id="6293661">byte</span><span class="op" id="6293665">)</span>&nbsp;<span class="op" id="6293667">(</span><span class="ident" id="6293668">n</span>&nbsp;<span class="builtintype" id="6293670">int</span><span class="op" id="6293673">,</span>&nbsp;<span class="ident" id="6293675">end</span>&nbsp;<span class="builtintype" id="6293679">bool</span><span class="op" id="6293683">,</span>&nbsp;<span class="ident" id="6293685">err</span>&nbsp;<span class="builtintype" id="6293689">error</span><span class="op" id="6293694">)</span>&nbsp;<span class="op" id="6293696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6293699">olen</span>&nbsp;<span class="op" id="6293704">:=</span>&nbsp;<span class="builtinfunc" id="6293707">len</span><span class="op" id="6293710">(</span><span class="ident" id="6293711">src</span><span class="op" id="6293714">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6293717">for</span>&nbsp;<span class="builtinfunc" id="6293721">len</span><span class="op" id="6293724">(</span><span class="ident" id="6293725">src</span><span class="op" id="6293728">)</span>&nbsp;<span class="op" id="6293730">&gt;</span>&nbsp;<span class="num" id="6293732">0</span>&nbsp;<span class="op" id="6293734">&amp;&amp;</span>&nbsp;<span class="op" id="6293737">!</span><span class="ident" id="6293738">end</span>&nbsp;<span class="op" id="6293742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6293746">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6293792">var</span>&nbsp;<span class="ident" id="6293796">dbuf</span>&nbsp;<span class="op" id="6293801">[</span><span class="num" id="6293802">8</span><span class="op" id="6293803">]</span><span class="builtintype" id="6293804">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6293811">dlen</span>&nbsp;<span class="op" id="6293816">:=</span>&nbsp;<span class="num" id="6293819">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6293824">for</span>&nbsp;<span class="ident" id="6293828">j</span>&nbsp;<span class="op" id="6293830">:=</span>&nbsp;<span class="num" id="6293833">0</span><span class="op" id="6293834">;</span>&nbsp;<span class="ident" id="6293836">j</span>&nbsp;<span class="op" id="6293838">&lt;</span>&nbsp;<span class="num" id="6293840">8</span><span class="op" id="6293841">;</span>&nbsp;<span class="op" id="6293843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6293848">if</span>&nbsp;<span class="builtinfunc" id="6293851">len</span><span class="op" id="6293854">(</span><span class="ident" id="6293855">src</span><span class="op" id="6293858">)</span>&nbsp;<span class="op" id="6293860">==</span>&nbsp;<span class="num" id="6293863">0</span>&nbsp;<span class="op" id="6293865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6293871">return</span>&nbsp;<span class="ident" id="6293878">n</span><span class="op" id="6293879">,</span>&nbsp;<span class="builtintype" id="6293881">false</span><span class="op" id="6293886">,</span>&nbsp;<span class="ident" id="6293888">CorruptInputError</span><span class="op" id="6293905">(</span><span class="ident" id="6293906">olen</span>&nbsp;<span class="op" id="6293911">-</span>&nbsp;<span class="builtinfunc" id="6293913">len</span><span class="op" id="6293916">(</span><span class="ident" id="6293917">src</span><span class="op" id="6293920">)</span>&nbsp;<span class="op" id="6293922">-</span>&nbsp;<span class="ident" id="6293924">j</span><span class="op" id="6293925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6293930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6293935">in</span>&nbsp;<span class="op" id="6293938">:=</span>&nbsp;<span class="ident" id="6293941">src</span><span class="op" id="6293944">[</span><span class="num" id="6293945">0</span><span class="op" id="6293946">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6293951">src</span>&nbsp;<span class="op" id="6293955">=</span>&nbsp;<span class="ident" id="6293957">src</span><span class="op" id="6293960">[</span><span class="num" id="6293961">1</span><span class="op" id="6293962">:</span><span class="op" id="6293963">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6293968">if</span>&nbsp;<span class="ident" id="6293971">in</span>&nbsp;<span class="op" id="6293974">==</span>&nbsp;<span class="string" id="6293977">&#39;=&#39;</span>&nbsp;<span class="op" id="6293981">&amp;&amp;</span>&nbsp;<span class="ident" id="6293984">j</span>&nbsp;<span class="op" id="6293986">&gt;=</span>&nbsp;<span class="num" id="6293989">2</span>&nbsp;<span class="op" id="6293991">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6293994">len</span><span class="op" id="6293997">(</span><span class="ident" id="6293998">src</span><span class="op" id="6294001">)</span>&nbsp;<span class="op" id="6294003">&lt;</span>&nbsp;<span class="num" id="6294005">8</span>&nbsp;<span class="op" id="6294007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6294013">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6294062">if</span>&nbsp;<span class="builtinfunc" id="6294065">len</span><span class="op" id="6294068">(</span><span class="ident" id="6294069">src</span><span class="op" id="6294072">)</span><span class="op" id="6294073">+</span><span class="ident" id="6294074">j</span>&nbsp;<span class="op" id="6294076">&lt;</span>&nbsp;<span class="num" id="6294078">8</span><span class="op" id="6294079">-</span><span class="num" id="6294080">1</span>&nbsp;<span class="op" id="6294082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6294089">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6294116">return</span>&nbsp;<span class="ident" id="6294123">n</span><span class="op" id="6294124">,</span>&nbsp;<span class="builtintype" id="6294126">false</span><span class="op" id="6294131">,</span>&nbsp;<span class="ident" id="6294133">CorruptInputError</span><span class="op" id="6294150">(</span><span class="ident" id="6294151">olen</span><span class="op" id="6294155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6294161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6294167">for</span>&nbsp;<span class="ident" id="6294171">k</span>&nbsp;<span class="op" id="6294173">:=</span>&nbsp;<span class="num" id="6294176">0</span><span class="op" id="6294177">;</span>&nbsp;<span class="ident" id="6294179">k</span>&nbsp;<span class="op" id="6294181">&lt;</span>&nbsp;<span class="num" id="6294183">8</span><span class="op" id="6294184">-</span><span class="num" id="6294185">1</span><span class="op" id="6294186">-</span><span class="ident" id="6294187">j</span><span class="op" id="6294188">;</span>&nbsp;<span class="ident" id="6294190">k</span><span class="op" id="6294191">++</span>&nbsp;<span class="op" id="6294194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6294201">if</span>&nbsp;<span class="builtinfunc" id="6294204">len</span><span class="op" id="6294207">(</span><span class="ident" id="6294208">src</span><span class="op" id="6294211">)</span>&nbsp;<span class="op" id="6294213">&gt;</span>&nbsp;<span class="ident" id="6294215">k</span>&nbsp;<span class="op" id="6294217">&amp;&amp;</span>&nbsp;<span class="ident" id="6294220">src</span><span class="op" id="6294223">[</span><span class="ident" id="6294224">k</span><span class="op" id="6294225">]</span>&nbsp;<span class="op" id="6294227">!=</span>&nbsp;<span class="string" id="6294230">&#39;=&#39;</span>&nbsp;<span class="op" id="6294234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6294242">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6294269">return</span>&nbsp;<span class="ident" id="6294276">n</span><span class="op" id="6294277">,</span>&nbsp;<span class="builtintype" id="6294279">false</span><span class="op" id="6294284">,</span>&nbsp;<span class="ident" id="6294286">CorruptInputError</span><span class="op" id="6294303">(</span><span class="ident" id="6294304">olen</span>&nbsp;<span class="op" id="6294309">-</span>&nbsp;<span class="builtinfunc" id="6294311">len</span><span class="op" id="6294314">(</span><span class="ident" id="6294315">src</span><span class="op" id="6294318">)</span>&nbsp;<span class="op" id="6294320">+</span>&nbsp;<span class="ident" id="6294322">k</span>&nbsp;<span class="op" id="6294324">-</span>&nbsp;<span class="num" id="6294326">1</span><span class="op" id="6294327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6294334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6294340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6294346">dlen</span><span class="op" id="6294350">,</span>&nbsp;<span class="ident" id="6294352">end</span>&nbsp;<span class="op" id="6294356">=</span>&nbsp;<span class="ident" id="6294358">j</span><span class="op" id="6294359">,</span>&nbsp;<span class="builtintype" id="6294361">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6294370">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6294445">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6294521">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6294593">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6294666">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6294737">if</span>&nbsp;<span class="ident" id="6294740">dlen</span>&nbsp;<span class="op" id="6294745">==</span>&nbsp;<span class="num" id="6294748">1</span>&nbsp;<span class="op" id="6294750">||</span>&nbsp;<span class="ident" id="6294753">dlen</span>&nbsp;<span class="op" id="6294758">==</span>&nbsp;<span class="num" id="6294761">3</span>&nbsp;<span class="op" id="6294763">||</span>&nbsp;<span class="ident" id="6294766">dlen</span>&nbsp;<span class="op" id="6294771">==</span>&nbsp;<span class="num" id="6294774">6</span>&nbsp;<span class="op" id="6294776">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6294783">return</span>&nbsp;<span class="ident" id="6294790">n</span><span class="op" id="6294791">,</span>&nbsp;<span class="builtintype" id="6294793">false</span><span class="op" id="6294798">,</span>&nbsp;<span class="ident" id="6294800">CorruptInputError</span><span class="op" id="6294817">(</span><span class="ident" id="6294818">olen</span>&nbsp;<span class="op" id="6294823">-</span>&nbsp;<span class="builtinfunc" id="6294825">len</span><span class="op" id="6294828">(</span><span class="ident" id="6294829">src</span><span class="op" id="6294832">)</span>&nbsp;<span class="op" id="6294834">-</span>&nbsp;<span class="num" id="6294836">1</span><span class="op" id="6294837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6294843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6294849">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6294858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6294863">dbuf</span><span class="op" id="6294867">[</span><span class="ident" id="6294868">j</span><span class="op" id="6294869">]</span>&nbsp;<span class="op" id="6294871">=</span>&nbsp;<span class="ident" id="6294873">enc</span><span class="op" id="6294876">.</span><span class="ident" id="6294877">decodeMap</span><span class="op" id="6294886">[</span><span class="ident" id="6294887">in</span><span class="op" id="6294889">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6294894">if</span>&nbsp;<span class="ident" id="6294897">dbuf</span><span class="op" id="6294901">[</span><span class="ident" id="6294902">j</span><span class="op" id="6294903">]</span>&nbsp;<span class="op" id="6294905">==</span>&nbsp;<span class="num" id="6294908">0xFF</span>&nbsp;<span class="op" id="6294913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6294919">return</span>&nbsp;<span class="ident" id="6294926">n</span><span class="op" id="6294927">,</span>&nbsp;<span class="builtintype" id="6294929">false</span><span class="op" id="6294934">,</span>&nbsp;<span class="ident" id="6294936">CorruptInputError</span><span class="op" id="6294953">(</span><span class="ident" id="6294954">olen</span>&nbsp;<span class="op" id="6294959">-</span>&nbsp;<span class="builtinfunc" id="6294961">len</span><span class="op" id="6294964">(</span><span class="ident" id="6294965">src</span><span class="op" id="6294968">)</span>&nbsp;<span class="op" id="6294970">-</span>&nbsp;<span class="num" id="6294972">1</span><span class="op" id="6294973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6294978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6294983">j</span><span class="op" id="6294984">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6294989">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6294994">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6295051">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295064">switch</span>&nbsp;<span class="ident" id="6295071">dlen</span>&nbsp;<span class="op" id="6295076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295080">case</span>&nbsp;<span class="num" id="6295085">8</span><span class="op" id="6295086">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295091">dst</span><span class="op" id="6295094">[</span><span class="num" id="6295095">4</span><span class="op" id="6295096">]</span>&nbsp;<span class="op" id="6295098">=</span>&nbsp;<span class="ident" id="6295100">dbuf</span><span class="op" id="6295104">[</span><span class="num" id="6295105">6</span><span class="op" id="6295106">]</span><span class="op" id="6295107">&lt;&lt;</span><span class="num" id="6295109">5</span>&nbsp;<span class="op" id="6295111">|</span>&nbsp;<span class="ident" id="6295113">dbuf</span><span class="op" id="6295117">[</span><span class="num" id="6295118">7</span><span class="op" id="6295119">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295124">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295138">case</span>&nbsp;<span class="num" id="6295143">7</span><span class="op" id="6295144">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295149">dst</span><span class="op" id="6295152">[</span><span class="num" id="6295153">3</span><span class="op" id="6295154">]</span>&nbsp;<span class="op" id="6295156">=</span>&nbsp;<span class="ident" id="6295158">dbuf</span><span class="op" id="6295162">[</span><span class="num" id="6295163">4</span><span class="op" id="6295164">]</span><span class="op" id="6295165">&lt;&lt;</span><span class="num" id="6295167">7</span>&nbsp;<span class="op" id="6295169">|</span>&nbsp;<span class="ident" id="6295171">dbuf</span><span class="op" id="6295175">[</span><span class="num" id="6295176">5</span><span class="op" id="6295177">]</span><span class="op" id="6295178">&lt;&lt;</span><span class="num" id="6295180">2</span>&nbsp;<span class="op" id="6295182">|</span>&nbsp;<span class="ident" id="6295184">dbuf</span><span class="op" id="6295188">[</span><span class="num" id="6295189">6</span><span class="op" id="6295190">]</span><span class="op" id="6295191">&gt;&gt;</span><span class="num" id="6295193">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295198">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295212">case</span>&nbsp;<span class="num" id="6295217">5</span><span class="op" id="6295218">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295223">dst</span><span class="op" id="6295226">[</span><span class="num" id="6295227">2</span><span class="op" id="6295228">]</span>&nbsp;<span class="op" id="6295230">=</span>&nbsp;<span class="ident" id="6295232">dbuf</span><span class="op" id="6295236">[</span><span class="num" id="6295237">3</span><span class="op" id="6295238">]</span><span class="op" id="6295239">&lt;&lt;</span><span class="num" id="6295241">4</span>&nbsp;<span class="op" id="6295243">|</span>&nbsp;<span class="ident" id="6295245">dbuf</span><span class="op" id="6295249">[</span><span class="num" id="6295250">4</span><span class="op" id="6295251">]</span><span class="op" id="6295252">&gt;&gt;</span><span class="num" id="6295254">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295259">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295273">case</span>&nbsp;<span class="num" id="6295278">4</span><span class="op" id="6295279">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295284">dst</span><span class="op" id="6295287">[</span><span class="num" id="6295288">1</span><span class="op" id="6295289">]</span>&nbsp;<span class="op" id="6295291">=</span>&nbsp;<span class="ident" id="6295293">dbuf</span><span class="op" id="6295297">[</span><span class="num" id="6295298">1</span><span class="op" id="6295299">]</span><span class="op" id="6295300">&lt;&lt;</span><span class="num" id="6295302">6</span>&nbsp;<span class="op" id="6295304">|</span>&nbsp;<span class="ident" id="6295306">dbuf</span><span class="op" id="6295310">[</span><span class="num" id="6295311">2</span><span class="op" id="6295312">]</span><span class="op" id="6295313">&lt;&lt;</span><span class="num" id="6295315">1</span>&nbsp;<span class="op" id="6295317">|</span>&nbsp;<span class="ident" id="6295319">dbuf</span><span class="op" id="6295323">[</span><span class="num" id="6295324">3</span><span class="op" id="6295325">]</span><span class="op" id="6295326">&gt;&gt;</span><span class="num" id="6295328">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295333">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295347">case</span>&nbsp;<span class="num" id="6295352">2</span><span class="op" id="6295353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295358">dst</span><span class="op" id="6295361">[</span><span class="num" id="6295362">0</span><span class="op" id="6295363">]</span>&nbsp;<span class="op" id="6295365">=</span>&nbsp;<span class="ident" id="6295367">dbuf</span><span class="op" id="6295371">[</span><span class="num" id="6295372">0</span><span class="op" id="6295373">]</span><span class="op" id="6295374">&lt;&lt;</span><span class="num" id="6295376">3</span>&nbsp;<span class="op" id="6295378">|</span>&nbsp;<span class="ident" id="6295380">dbuf</span><span class="op" id="6295384">[</span><span class="num" id="6295385">1</span><span class="op" id="6295386">]</span><span class="op" id="6295387">&gt;&gt;</span><span class="num" id="6295389">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6295393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295397">dst</span>&nbsp;<span class="op" id="6295401">=</span>&nbsp;<span class="ident" id="6295403">dst</span><span class="op" id="6295406">[</span><span class="num" id="6295407">5</span><span class="op" id="6295408">:</span><span class="op" id="6295409">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295413">switch</span>&nbsp;<span class="ident" id="6295420">dlen</span>&nbsp;<span class="op" id="6295425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295429">case</span>&nbsp;<span class="num" id="6295434">2</span><span class="op" id="6295435">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295440">n</span>&nbsp;<span class="op" id="6295442">+=</span>&nbsp;<span class="num" id="6295445">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295449">case</span>&nbsp;<span class="num" id="6295454">4</span><span class="op" id="6295455">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295460">n</span>&nbsp;<span class="op" id="6295462">+=</span>&nbsp;<span class="num" id="6295465">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295469">case</span>&nbsp;<span class="num" id="6295474">5</span><span class="op" id="6295475">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295480">n</span>&nbsp;<span class="op" id="6295482">+=</span>&nbsp;<span class="num" id="6295485">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295489">case</span>&nbsp;<span class="num" id="6295494">7</span><span class="op" id="6295495">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295500">n</span>&nbsp;<span class="op" id="6295502">+=</span>&nbsp;<span class="num" id="6295505">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295509">case</span>&nbsp;<span class="num" id="6295514">8</span><span class="op" id="6295515">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295520">n</span>&nbsp;<span class="op" id="6295522">+=</span>&nbsp;<span class="num" id="6295525">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6295529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6295532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6295535">return</span>&nbsp;<span class="ident" id="6295542">n</span><span class="op" id="6295543">,</span>&nbsp;<span class="ident" id="6295545">end</span><span class="op" id="6295548">,</span>&nbsp;<span class="ident" id="6295550">nil</span><br>
<span class="lineno"></span><span class="op" id="6295554">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="6295557">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="6295622">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="6295691">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6295760">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="6295823">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="6295871">func</span>&nbsp;<span class="op" id="6295876">(</span><span class="ident" id="6295877">enc</span>&nbsp;<span class="op" id="6295881">*</span><span class="ident" id="6295882">Encoding</span><span class="op" id="6295890">)</span>&nbsp;<span class="ident" id="6295892">Decode</span><span class="op" id="6295898">(</span><span class="ident" id="6295899">dst</span><span class="op" id="6295902">,</span>&nbsp;<span class="ident" id="6295904">src</span>&nbsp;<span class="op" id="6295908">[</span><span class="op" id="6295909">]</span><span class="builtintype" id="6295910">byte</span><span class="op" id="6295914">)</span>&nbsp;<span class="op" id="6295916">(</span><span class="ident" id="6295917">n</span>&nbsp;<span class="builtintype" id="6295919">int</span><span class="op" id="6295922">,</span>&nbsp;<span class="ident" id="6295924">err</span>&nbsp;<span class="builtintype" id="6295928">error</span><span class="op" id="6295933">)</span>&nbsp;<span class="op" id="6295935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295938">src</span>&nbsp;<span class="op" id="6295942">=</span>&nbsp;<span class="ident" id="6295944">bytes</span><span class="op" id="6295949">.</span><span class="ident" id="6295950">Map</span><span class="op" id="6295953">(</span><span class="ident" id="6295954">removeNewlinesMapper</span><span class="op" id="6295974">,</span>&nbsp;<span class="ident" id="6295976">src</span><span class="op" id="6295979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6295982">n</span><span class="op" id="6295983">,</span>&nbsp;<span class="ident" id="6295985">_</span><span class="op" id="6295986">,</span>&nbsp;<span class="ident" id="6295988">err</span>&nbsp;<span class="op" id="6295992">=</span>&nbsp;<span class="ident" id="6295994">enc</span><span class="op" id="6295997">.</span><span class="ident" id="6295998">decode</span><span class="op" id="6296004">(</span><span class="ident" id="6296005">dst</span><span class="op" id="6296008">,</span>&nbsp;<span class="ident" id="6296010">src</span><span class="op" id="6296013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6296016">return</span><br>
<span class="lineno">325</span><span class="op" id="6296023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6296026">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="6296096">func</span>&nbsp;<span class="op" id="6296101">(</span><span class="ident" id="6296102">enc</span>&nbsp;<span class="op" id="6296106">*</span><span class="ident" id="6296107">Encoding</span><span class="op" id="6296115">)</span>&nbsp;<span class="ident" id="6296117">DecodeString</span><span class="op" id="6296129">(</span><span class="ident" id="6296130">s</span>&nbsp;<span class="builtintype" id="6296132">string</span><span class="op" id="6296138">)</span>&nbsp;<span class="op" id="6296140">(</span><span class="op" id="6296141">[</span><span class="op" id="6296142">]</span><span class="builtintype" id="6296143">byte</span><span class="op" id="6296147">,</span>&nbsp;<span class="builtintype" id="6296149">error</span><span class="op" id="6296154">)</span>&nbsp;<span class="op" id="6296156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296159">s</span>&nbsp;<span class="op" id="6296161">=</span>&nbsp;<span class="ident" id="6296163">strings</span><span class="op" id="6296170">.</span><span class="ident" id="6296171">Map</span><span class="op" id="6296174">(</span><span class="ident" id="6296175">removeNewlinesMapper</span><span class="op" id="6296195">,</span>&nbsp;<span class="ident" id="6296197">s</span><span class="op" id="6296198">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296201">dbuf</span>&nbsp;<span class="op" id="6296206">:=</span>&nbsp;<span class="builtinfunc" id="6296209">make</span><span class="op" id="6296213">(</span><span class="op" id="6296214">[</span><span class="op" id="6296215">]</span><span class="builtintype" id="6296216">byte</span><span class="op" id="6296220">,</span>&nbsp;<span class="ident" id="6296222">enc</span><span class="op" id="6296225">.</span><span class="ident" id="6296226">DecodedLen</span><span class="op" id="6296236">(</span><span class="builtinfunc" id="6296237">len</span><span class="op" id="6296240">(</span><span class="ident" id="6296241">s</span><span class="op" id="6296242">)</span><span class="op" id="6296243">)</span><span class="op" id="6296244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296247">n</span><span class="op" id="6296248">,</span>&nbsp;<span class="ident" id="6296250">_</span><span class="op" id="6296251">,</span>&nbsp;<span class="ident" id="6296253">err</span>&nbsp;<span class="op" id="6296257">:=</span>&nbsp;<span class="ident" id="6296260">enc</span><span class="op" id="6296263">.</span><span class="ident" id="6296264">decode</span><span class="op" id="6296270">(</span><span class="ident" id="6296271">dbuf</span><span class="op" id="6296275">,</span>&nbsp;<span class="op" id="6296277">[</span><span class="op" id="6296278">]</span><span class="builtintype" id="6296279">byte</span><span class="op" id="6296283">(</span><span class="ident" id="6296284">s</span><span class="op" id="6296285">)</span><span class="op" id="6296286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6296289">return</span>&nbsp;<span class="ident" id="6296296">dbuf</span><span class="op" id="6296300">[</span><span class="op" id="6296301">:</span><span class="ident" id="6296302">n</span><span class="op" id="6296303">]</span><span class="op" id="6296304">,</span>&nbsp;<span class="ident" id="6296306">err</span><br>
<span class="lineno"></span><span class="op" id="6296310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="6296313">type</span>&nbsp;<span class="ident" id="6296318">decoder</span>&nbsp;<span class="keyword" id="6296326">struct</span>&nbsp;<span class="op" id="6296333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296336">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6296343">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296350">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6296357">*</span><span class="ident" id="6296358">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296368">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6296375">io</span><span class="op" id="6296377">.</span><span class="ident" id="6296378">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296386">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6296393">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6296404">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296427">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6296434">[</span><span class="num" id="6296435">1024</span><span class="op" id="6296439">]</span><span class="builtintype" id="6296440">byte</span>&nbsp;<span class="comment" id="6296445">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296464">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6296471">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296476">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6296483">[</span><span class="op" id="6296484">]</span><span class="builtintype" id="6296485">byte</span>&nbsp;<span class="comment" id="6296490">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296518">outbuf</span>&nbsp;<span class="op" id="6296525">[</span><span class="num" id="6296526">1024</span>&nbsp;<span class="op" id="6296531">/</span>&nbsp;<span class="num" id="6296533">8</span>&nbsp;<span class="op" id="6296535">*</span>&nbsp;<span class="num" id="6296537">5</span><span class="op" id="6296538">]</span><span class="builtintype" id="6296539">byte</span><br>
<span class="lineno"></span><span class="op" id="6296544">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="6296547">func</span>&nbsp;<span class="op" id="6296552">(</span><span class="ident" id="6296553">d</span>&nbsp;<span class="op" id="6296555">*</span><span class="ident" id="6296556">decoder</span><span class="op" id="6296563">)</span>&nbsp;<span class="ident" id="6296565">Read</span><span class="op" id="6296569">(</span><span class="ident" id="6296570">p</span>&nbsp;<span class="op" id="6296572">[</span><span class="op" id="6296573">]</span><span class="builtintype" id="6296574">byte</span><span class="op" id="6296578">)</span>&nbsp;<span class="op" id="6296580">(</span><span class="ident" id="6296581">n</span>&nbsp;<span class="builtintype" id="6296583">int</span><span class="op" id="6296586">,</span>&nbsp;<span class="ident" id="6296588">err</span>&nbsp;<span class="builtintype" id="6296592">error</span><span class="op" id="6296597">)</span>&nbsp;<span class="op" id="6296599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6296602">if</span>&nbsp;<span class="ident" id="6296605">d</span><span class="op" id="6296606">.</span><span class="ident" id="6296607">err</span>&nbsp;<span class="op" id="6296611">!=</span>&nbsp;<span class="ident" id="6296614">nil</span>&nbsp;<span class="op" id="6296618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6296622">return</span>&nbsp;<span class="num" id="6296629">0</span><span class="op" id="6296630">,</span>&nbsp;<span class="ident" id="6296632">d</span><span class="op" id="6296633">.</span><span class="ident" id="6296634">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6296639">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6296643">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6296691">if</span>&nbsp;<span class="builtinfunc" id="6296694">len</span><span class="op" id="6296697">(</span><span class="ident" id="6296698">d</span><span class="op" id="6296699">.</span><span class="ident" id="6296700">out</span><span class="op" id="6296703">)</span>&nbsp;<span class="op" id="6296705">&gt;</span>&nbsp;<span class="num" id="6296707">0</span>&nbsp;<span class="op" id="6296709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296713">n</span>&nbsp;<span class="op" id="6296715">=</span>&nbsp;<span class="builtinfunc" id="6296717">copy</span><span class="op" id="6296721">(</span><span class="ident" id="6296722">p</span><span class="op" id="6296723">,</span>&nbsp;<span class="ident" id="6296725">d</span><span class="op" id="6296726">.</span><span class="ident" id="6296727">out</span><span class="op" id="6296730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296734">d</span><span class="op" id="6296735">.</span><span class="ident" id="6296736">out</span>&nbsp;<span class="op" id="6296740">=</span>&nbsp;<span class="ident" id="6296742">d</span><span class="op" id="6296743">.</span><span class="ident" id="6296744">out</span><span class="op" id="6296747">[</span><span class="ident" id="6296748">n</span><span class="op" id="6296749">:</span><span class="op" id="6296750">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6296754">return</span>&nbsp;<span class="ident" id="6296761">n</span><span class="op" id="6296762">,</span>&nbsp;<span class="ident" id="6296764">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6296769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6296773">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296791">nn</span>&nbsp;<span class="op" id="6296794">:=</span>&nbsp;<span class="builtinfunc" id="6296797">len</span><span class="op" id="6296800">(</span><span class="ident" id="6296801">p</span><span class="op" id="6296802">)</span>&nbsp;<span class="op" id="6296804">/</span>&nbsp;<span class="num" id="6296806">5</span>&nbsp;<span class="op" id="6296808">*</span>&nbsp;<span class="num" id="6296810">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6296813">if</span>&nbsp;<span class="ident" id="6296816">nn</span>&nbsp;<span class="op" id="6296819">&lt;</span>&nbsp;<span class="num" id="6296821">8</span>&nbsp;<span class="op" id="6296823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296827">nn</span>&nbsp;<span class="op" id="6296830">=</span>&nbsp;<span class="num" id="6296832">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6296835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6296838">if</span>&nbsp;<span class="ident" id="6296841">nn</span>&nbsp;<span class="op" id="6296844">&gt;</span>&nbsp;<span class="builtinfunc" id="6296846">len</span><span class="op" id="6296849">(</span><span class="ident" id="6296850">d</span><span class="op" id="6296851">.</span><span class="ident" id="6296852">buf</span><span class="op" id="6296855">)</span>&nbsp;<span class="op" id="6296857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296861">nn</span>&nbsp;<span class="op" id="6296864">=</span>&nbsp;<span class="builtinfunc" id="6296866">len</span><span class="op" id="6296869">(</span><span class="ident" id="6296870">d</span><span class="op" id="6296871">.</span><span class="ident" id="6296872">buf</span><span class="op" id="6296875">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6296878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296881">nn</span><span class="op" id="6296883">,</span>&nbsp;<span class="ident" id="6296885">d</span><span class="op" id="6296886">.</span><span class="ident" id="6296887">err</span>&nbsp;<span class="op" id="6296891">=</span>&nbsp;<span class="ident" id="6296893">io</span><span class="op" id="6296895">.</span><span class="ident" id="6296896">ReadAtLeast</span><span class="op" id="6296907">(</span><span class="ident" id="6296908">d</span><span class="op" id="6296909">.</span><span class="ident" id="6296910">r</span><span class="op" id="6296911">,</span>&nbsp;<span class="ident" id="6296913">d</span><span class="op" id="6296914">.</span><span class="ident" id="6296915">buf</span><span class="op" id="6296918">[</span><span class="ident" id="6296919">d</span><span class="op" id="6296920">.</span><span class="ident" id="6296921">nbuf</span><span class="op" id="6296925">:</span><span class="ident" id="6296926">nn</span><span class="op" id="6296928">]</span><span class="op" id="6296929">,</span>&nbsp;<span class="num" id="6296931">8</span><span class="op" id="6296932">-</span><span class="ident" id="6296933">d</span><span class="op" id="6296934">.</span><span class="ident" id="6296935">nbuf</span><span class="op" id="6296939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6296942">d</span><span class="op" id="6296943">.</span><span class="ident" id="6296944">nbuf</span>&nbsp;<span class="op" id="6296949">+=</span>&nbsp;<span class="ident" id="6296952">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6296956">if</span>&nbsp;<span class="ident" id="6296959">d</span><span class="op" id="6296960">.</span><span class="ident" id="6296961">nbuf</span>&nbsp;<span class="op" id="6296966">&lt;</span>&nbsp;<span class="num" id="6296968">8</span>&nbsp;<span class="op" id="6296970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6296974">return</span>&nbsp;<span class="num" id="6296981">0</span><span class="op" id="6296982">,</span>&nbsp;<span class="ident" id="6296984">d</span><span class="op" id="6296985">.</span><span class="ident" id="6296986">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6296991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6296995">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297059">nr</span>&nbsp;<span class="op" id="6297062">:=</span>&nbsp;<span class="ident" id="6297065">d</span><span class="op" id="6297066">.</span><span class="ident" id="6297067">nbuf</span>&nbsp;<span class="op" id="6297072">/</span>&nbsp;<span class="num" id="6297074">8</span>&nbsp;<span class="op" id="6297076">*</span>&nbsp;<span class="num" id="6297078">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297081">nw</span>&nbsp;<span class="op" id="6297084">:=</span>&nbsp;<span class="ident" id="6297087">d</span><span class="op" id="6297088">.</span><span class="ident" id="6297089">nbuf</span>&nbsp;<span class="op" id="6297094">/</span>&nbsp;<span class="num" id="6297096">8</span>&nbsp;<span class="op" id="6297098">*</span>&nbsp;<span class="num" id="6297100">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6297103">if</span>&nbsp;<span class="ident" id="6297106">nw</span>&nbsp;<span class="op" id="6297109">&gt;</span>&nbsp;<span class="builtinfunc" id="6297111">len</span><span class="op" id="6297114">(</span><span class="ident" id="6297115">p</span><span class="op" id="6297116">)</span>&nbsp;<span class="op" id="6297118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297122">nw</span><span class="op" id="6297124">,</span>&nbsp;<span class="ident" id="6297126">d</span><span class="op" id="6297127">.</span><span class="ident" id="6297128">end</span><span class="op" id="6297131">,</span>&nbsp;<span class="ident" id="6297133">d</span><span class="op" id="6297134">.</span><span class="ident" id="6297135">err</span>&nbsp;<span class="op" id="6297139">=</span>&nbsp;<span class="ident" id="6297141">d</span><span class="op" id="6297142">.</span><span class="ident" id="6297143">enc</span><span class="op" id="6297146">.</span><span class="ident" id="6297147">decode</span><span class="op" id="6297153">(</span><span class="ident" id="6297154">d</span><span class="op" id="6297155">.</span><span class="ident" id="6297156">outbuf</span><span class="op" id="6297162">[</span><span class="num" id="6297163">0</span><span class="op" id="6297164">:</span><span class="op" id="6297165">]</span><span class="op" id="6297166">,</span>&nbsp;<span class="ident" id="6297168">d</span><span class="op" id="6297169">.</span><span class="ident" id="6297170">buf</span><span class="op" id="6297173">[</span><span class="num" id="6297174">0</span><span class="op" id="6297175">:</span><span class="ident" id="6297176">nr</span><span class="op" id="6297178">]</span><span class="op" id="6297179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297183">d</span><span class="op" id="6297184">.</span><span class="ident" id="6297185">out</span>&nbsp;<span class="op" id="6297189">=</span>&nbsp;<span class="ident" id="6297191">d</span><span class="op" id="6297192">.</span><span class="ident" id="6297193">outbuf</span><span class="op" id="6297199">[</span><span class="num" id="6297200">0</span><span class="op" id="6297201">:</span><span class="ident" id="6297202">nw</span><span class="op" id="6297204">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297208">n</span>&nbsp;<span class="op" id="6297210">=</span>&nbsp;<span class="builtinfunc" id="6297212">copy</span><span class="op" id="6297216">(</span><span class="ident" id="6297217">p</span><span class="op" id="6297218">,</span>&nbsp;<span class="ident" id="6297220">d</span><span class="op" id="6297221">.</span><span class="ident" id="6297222">out</span><span class="op" id="6297225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297229">d</span><span class="op" id="6297230">.</span><span class="ident" id="6297231">out</span>&nbsp;<span class="op" id="6297235">=</span>&nbsp;<span class="ident" id="6297237">d</span><span class="op" id="6297238">.</span><span class="ident" id="6297239">out</span><span class="op" id="6297242">[</span><span class="ident" id="6297243">n</span><span class="op" id="6297244">:</span><span class="op" id="6297245">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6297248">}</span>&nbsp;<span class="keyword" id="6297250">else</span>&nbsp;<span class="op" id="6297255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297259">n</span><span class="op" id="6297260">,</span>&nbsp;<span class="ident" id="6297262">d</span><span class="op" id="6297263">.</span><span class="ident" id="6297264">end</span><span class="op" id="6297267">,</span>&nbsp;<span class="ident" id="6297269">d</span><span class="op" id="6297270">.</span><span class="ident" id="6297271">err</span>&nbsp;<span class="op" id="6297275">=</span>&nbsp;<span class="ident" id="6297277">d</span><span class="op" id="6297278">.</span><span class="ident" id="6297279">enc</span><span class="op" id="6297282">.</span><span class="ident" id="6297283">decode</span><span class="op" id="6297289">(</span><span class="ident" id="6297290">p</span><span class="op" id="6297291">,</span>&nbsp;<span class="ident" id="6297293">d</span><span class="op" id="6297294">.</span><span class="ident" id="6297295">buf</span><span class="op" id="6297298">[</span><span class="num" id="6297299">0</span><span class="op" id="6297300">:</span><span class="ident" id="6297301">nr</span><span class="op" id="6297303">]</span><span class="op" id="6297304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6297307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297310">d</span><span class="op" id="6297311">.</span><span class="ident" id="6297312">nbuf</span>&nbsp;<span class="op" id="6297317">-=</span>&nbsp;<span class="ident" id="6297320">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6297324">for</span>&nbsp;<span class="ident" id="6297328">i</span>&nbsp;<span class="op" id="6297330">:=</span>&nbsp;<span class="num" id="6297333">0</span><span class="op" id="6297334">;</span>&nbsp;<span class="ident" id="6297336">i</span>&nbsp;<span class="op" id="6297338">&lt;</span>&nbsp;<span class="ident" id="6297340">d</span><span class="op" id="6297341">.</span><span class="ident" id="6297342">nbuf</span><span class="op" id="6297346">;</span>&nbsp;<span class="ident" id="6297348">i</span><span class="op" id="6297349">++</span>&nbsp;<span class="op" id="6297352">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297356">d</span><span class="op" id="6297357">.</span><span class="ident" id="6297358">buf</span><span class="op" id="6297361">[</span><span class="ident" id="6297362">i</span><span class="op" id="6297363">]</span>&nbsp;<span class="op" id="6297365">=</span>&nbsp;<span class="ident" id="6297367">d</span><span class="op" id="6297368">.</span><span class="ident" id="6297369">buf</span><span class="op" id="6297372">[</span><span class="ident" id="6297373">i</span><span class="op" id="6297374">+</span><span class="ident" id="6297375">nr</span><span class="op" id="6297377">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6297380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6297384">if</span>&nbsp;<span class="ident" id="6297387">d</span><span class="op" id="6297388">.</span><span class="ident" id="6297389">err</span>&nbsp;<span class="op" id="6297393">==</span>&nbsp;<span class="ident" id="6297396">nil</span>&nbsp;<span class="op" id="6297400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297404">d</span><span class="op" id="6297405">.</span><span class="ident" id="6297406">err</span>&nbsp;<span class="op" id="6297410">=</span>&nbsp;<span class="ident" id="6297412">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6297417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6297420">return</span>&nbsp;<span class="ident" id="6297427">n</span><span class="op" id="6297428">,</span>&nbsp;<span class="ident" id="6297430">d</span><span class="op" id="6297431">.</span><span class="ident" id="6297432">err</span><br>
<span class="lineno"></span><span class="op" id="6297436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6297439">type</span>&nbsp;<span class="ident" id="6297444">newlineFilteringReader</span>&nbsp;<span class="keyword" id="6297467">struct</span>&nbsp;<span class="op" id="6297474">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297477">wrapped</span>&nbsp;<span class="ident" id="6297485">io</span><span class="op" id="6297487">.</span><span class="ident" id="6297488">Reader</span><br>
<span class="lineno"></span><span class="op" id="6297495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6297498">func</span>&nbsp;<span class="op" id="6297503">(</span><span class="ident" id="6297504">r</span>&nbsp;<span class="op" id="6297506">*</span><span class="ident" id="6297507">newlineFilteringReader</span><span class="op" id="6297529">)</span>&nbsp;<span class="ident" id="6297531">Read</span><span class="op" id="6297535">(</span><span class="ident" id="6297536">p</span>&nbsp;<span class="op" id="6297538">[</span><span class="op" id="6297539">]</span><span class="builtintype" id="6297540">byte</span><span class="op" id="6297544">)</span>&nbsp;<span class="op" id="6297546">(</span><span class="builtintype" id="6297547">int</span><span class="op" id="6297550">,</span>&nbsp;<span class="builtintype" id="6297552">error</span><span class="op" id="6297557">)</span>&nbsp;<span class="op" id="6297559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297562">n</span><span class="op" id="6297563">,</span>&nbsp;<span class="ident" id="6297565">err</span>&nbsp;<span class="op" id="6297569">:=</span>&nbsp;<span class="ident" id="6297572">r</span><span class="op" id="6297573">.</span><span class="ident" id="6297574">wrapped</span><span class="op" id="6297581">.</span><span class="ident" id="6297582">Read</span><span class="op" id="6297586">(</span><span class="ident" id="6297587">p</span><span class="op" id="6297588">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6297591">for</span>&nbsp;<span class="ident" id="6297595">n</span>&nbsp;<span class="op" id="6297597">&gt;</span>&nbsp;<span class="num" id="6297599">0</span>&nbsp;<span class="op" id="6297601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297605">offset</span>&nbsp;<span class="op" id="6297612">:=</span>&nbsp;<span class="num" id="6297615">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6297619">for</span>&nbsp;<span class="ident" id="6297623">i</span><span class="op" id="6297624">,</span>&nbsp;<span class="ident" id="6297626">b</span>&nbsp;<span class="op" id="6297628">:=</span>&nbsp;<span class="keyword" id="6297631">range</span>&nbsp;<span class="ident" id="6297637">p</span><span class="op" id="6297638">[</span><span class="num" id="6297639">0</span><span class="op" id="6297640">:</span><span class="ident" id="6297641">n</span><span class="op" id="6297642">]</span>&nbsp;<span class="op" id="6297644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6297649">if</span>&nbsp;<span class="ident" id="6297652">b</span>&nbsp;<span class="op" id="6297654">!=</span>&nbsp;<span class="string" id="6297657">&#39;\r&#39;</span>&nbsp;<span class="op" id="6297662">&amp;&amp;</span>&nbsp;<span class="ident" id="6297665">b</span>&nbsp;<span class="op" id="6297667">!=</span>&nbsp;<span class="string" id="6297670">&#39;\n&#39;</span>&nbsp;<span class="op" id="6297675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6297681">if</span>&nbsp;<span class="ident" id="6297684">i</span>&nbsp;<span class="op" id="6297686">!=</span>&nbsp;<span class="ident" id="6297689">offset</span>&nbsp;<span class="op" id="6297696">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297703">p</span><span class="op" id="6297704">[</span><span class="ident" id="6297705">offset</span><span class="op" id="6297711">]</span>&nbsp;<span class="op" id="6297713">=</span>&nbsp;<span class="ident" id="6297715">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6297721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297727">offset</span><span class="op" id="6297733">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6297739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6297743">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6297747">if</span>&nbsp;<span class="ident" id="6297750">offset</span>&nbsp;<span class="op" id="6297757">&gt;</span>&nbsp;<span class="num" id="6297759">0</span>&nbsp;<span class="op" id="6297761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6297766">return</span>&nbsp;<span class="ident" id="6297773">offset</span><span class="op" id="6297779">,</span>&nbsp;<span class="ident" id="6297781">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6297787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6297791">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6297844">n</span><span class="op" id="6297845">,</span>&nbsp;<span class="ident" id="6297847">err</span>&nbsp;<span class="op" id="6297851">=</span>&nbsp;<span class="ident" id="6297853">r</span><span class="op" id="6297854">.</span><span class="ident" id="6297855">wrapped</span><span class="op" id="6297862">.</span><span class="ident" id="6297863">Read</span><span class="op" id="6297867">(</span><span class="ident" id="6297868">p</span><span class="op" id="6297869">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6297872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6297875">return</span>&nbsp;<span class="ident" id="6297882">n</span><span class="op" id="6297883">,</span>&nbsp;<span class="ident" id="6297885">err</span><br>
<span class="lineno"></span><span class="op" id="6297889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6297892">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="6297946">func</span>&nbsp;<span class="ident" id="6297951">NewDecoder</span><span class="op" id="6297961">(</span><span class="ident" id="6297962">enc</span>&nbsp;<span class="op" id="6297966">*</span><span class="ident" id="6297967">Encoding</span><span class="op" id="6297975">,</span>&nbsp;<span class="ident" id="6297977">r</span>&nbsp;<span class="ident" id="6297979">io</span><span class="op" id="6297981">.</span><span class="ident" id="6297982">Reader</span><span class="op" id="6297988">)</span>&nbsp;<span class="ident" id="6297990">io</span><span class="op" id="6297992">.</span><span class="ident" id="6297993">Reader</span>&nbsp;<span class="op" id="6298000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6298003">return</span>&nbsp;<span class="op" id="6298010">&amp;</span><span class="ident" id="6298011">decoder</span><span class="op" id="6298018">{</span><span class="ident" id="6298019">enc</span><span class="op" id="6298022">:</span>&nbsp;<span class="ident" id="6298024">enc</span><span class="op" id="6298027">,</span>&nbsp;<span class="ident" id="6298029">r</span><span class="op" id="6298030">:</span>&nbsp;<span class="op" id="6298032">&amp;</span><span class="ident" id="6298033">newlineFilteringReader</span><span class="op" id="6298055">{</span><span class="ident" id="6298056">r</span><span class="op" id="6298057">}</span><span class="op" id="6298058">}</span><br>
<span class="lineno"></span><span class="op" id="6298060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6298063">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="6298133">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="6298185">func</span>&nbsp;<span class="op" id="6298190">(</span><span class="ident" id="6298191">enc</span>&nbsp;<span class="op" id="6298195">*</span><span class="ident" id="6298196">Encoding</span><span class="op" id="6298204">)</span>&nbsp;<span class="ident" id="6298206">DecodedLen</span><span class="op" id="6298216">(</span><span class="ident" id="6298217">n</span>&nbsp;<span class="builtintype" id="6298219">int</span><span class="op" id="6298222">)</span>&nbsp;<span class="builtintype" id="6298224">int</span>&nbsp;<span class="op" id="6298228">{</span>&nbsp;<span class="keyword" id="6298230">return</span>&nbsp;<span class="ident" id="6298237">n</span>&nbsp;<span class="op" id="6298239">/</span>&nbsp;<span class="num" id="6298241">8</span>&nbsp;<span class="op" id="6298243">*</span>&nbsp;<span class="num" id="6298245">5</span>&nbsp;<span class="op" id="6298247">}</span>
</div>
</body>
</html>
