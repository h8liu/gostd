<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html" class="current">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7334733">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7334789">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7334843">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7334894">package</span>&nbsp;<span class="ident" id="7334902">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7334909">import</span>&nbsp;<span class="op" id="7334916">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7334919">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7334925">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7334931">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7334948">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7334959">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7334970">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7334981">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7334991">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7334994">func</span>&nbsp;<span class="ident" id="7334999">TestMatch</span><span class="op" id="7335008">(</span><span class="ident" id="7335009">t</span>&nbsp;<span class="op" id="7335011">*</span><span class="ident" id="7335012">testing</span><span class="op" id="7335019">.</span><span class="ident" id="7335020">T</span><span class="op" id="7335021">)</span>&nbsp;<span class="op" id="7335023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335026">ctxt</span>&nbsp;<span class="op" id="7335031">:=</span>&nbsp;<span class="ident" id="7335034">Default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335043">what</span>&nbsp;<span class="op" id="7335048">:=</span>&nbsp;<span class="string" id="7335051">&#34;default&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335062">match</span>&nbsp;<span class="op" id="7335068">:=</span>&nbsp;<span class="keyword" id="7335071">func</span><span class="op" id="7335075">(</span><span class="ident" id="7335076">tag</span>&nbsp;<span class="builtintype" id="7335080">string</span><span class="op" id="7335086">,</span>&nbsp;<span class="ident" id="7335088">want</span>&nbsp;<span class="keyword" id="7335093">map</span><span class="op" id="7335096">[</span><span class="builtintype" id="7335097">string</span><span class="op" id="7335103">]</span><span class="builtintype" id="7335104">bool</span><span class="op" id="7335108">)</span>&nbsp;<span class="op" id="7335110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335114">m</span>&nbsp;<span class="op" id="7335116">:=</span>&nbsp;<span class="builtinfunc" id="7335119">make</span><span class="op" id="7335123">(</span><span class="keyword" id="7335124">map</span><span class="op" id="7335127">[</span><span class="builtintype" id="7335128">string</span><span class="op" id="7335134">]</span><span class="builtintype" id="7335135">bool</span><span class="op" id="7335139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7335143">if</span>&nbsp;<span class="op" id="7335146">!</span><span class="ident" id="7335147">ctxt</span><span class="op" id="7335151">.</span><span class="ident" id="7335152">match</span><span class="op" id="7335157">(</span><span class="ident" id="7335158">tag</span><span class="op" id="7335161">,</span>&nbsp;<span class="ident" id="7335163">m</span><span class="op" id="7335164">)</span>&nbsp;<span class="op" id="7335166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335171">t</span><span class="op" id="7335172">.</span><span class="ident" id="7335173">Errorf</span><span class="op" id="7335179">(</span><span class="string" id="7335180">&#34;%s&nbsp;context&nbsp;should&nbsp;match&nbsp;%s,&nbsp;does&nbsp;not&#34;</span><span class="op" id="7335218">,</span>&nbsp;<span class="ident" id="7335220">what</span><span class="op" id="7335224">,</span>&nbsp;<span class="ident" id="7335226">tag</span><span class="op" id="7335229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335233">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7335237">if</span>&nbsp;<span class="op" id="7335240">!</span><span class="ident" id="7335241">reflect</span><span class="op" id="7335248">.</span><span class="ident" id="7335249">DeepEqual</span><span class="op" id="7335258">(</span><span class="ident" id="7335259">m</span><span class="op" id="7335260">,</span>&nbsp;<span class="ident" id="7335262">want</span><span class="op" id="7335266">)</span>&nbsp;<span class="op" id="7335268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335273">t</span><span class="op" id="7335274">.</span><span class="ident" id="7335275">Errorf</span><span class="op" id="7335281">(</span><span class="string" id="7335282">&#34;%s&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7335305">,</span>&nbsp;<span class="ident" id="7335307">tag</span><span class="op" id="7335310">,</span>&nbsp;<span class="ident" id="7335312">m</span><span class="op" id="7335313">,</span>&nbsp;<span class="ident" id="7335315">want</span><span class="op" id="7335319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335329">nomatch</span>&nbsp;<span class="op" id="7335337">:=</span>&nbsp;<span class="keyword" id="7335340">func</span><span class="op" id="7335344">(</span><span class="ident" id="7335345">tag</span>&nbsp;<span class="builtintype" id="7335349">string</span><span class="op" id="7335355">,</span>&nbsp;<span class="ident" id="7335357">want</span>&nbsp;<span class="keyword" id="7335362">map</span><span class="op" id="7335365">[</span><span class="builtintype" id="7335366">string</span><span class="op" id="7335372">]</span><span class="builtintype" id="7335373">bool</span><span class="op" id="7335377">)</span>&nbsp;<span class="op" id="7335379">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335383">m</span>&nbsp;<span class="op" id="7335385">:=</span>&nbsp;<span class="builtinfunc" id="7335388">make</span><span class="op" id="7335392">(</span><span class="keyword" id="7335393">map</span><span class="op" id="7335396">[</span><span class="builtintype" id="7335397">string</span><span class="op" id="7335403">]</span><span class="builtintype" id="7335404">bool</span><span class="op" id="7335408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7335412">if</span>&nbsp;<span class="ident" id="7335415">ctxt</span><span class="op" id="7335419">.</span><span class="ident" id="7335420">match</span><span class="op" id="7335425">(</span><span class="ident" id="7335426">tag</span><span class="op" id="7335429">,</span>&nbsp;<span class="ident" id="7335431">m</span><span class="op" id="7335432">)</span>&nbsp;<span class="op" id="7335434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335439">t</span><span class="op" id="7335440">.</span><span class="ident" id="7335441">Errorf</span><span class="op" id="7335447">(</span><span class="string" id="7335448">&#34;%s&nbsp;context&nbsp;should&nbsp;NOT&nbsp;match&nbsp;%s,&nbsp;does&#34;</span><span class="op" id="7335486">,</span>&nbsp;<span class="ident" id="7335488">what</span><span class="op" id="7335492">,</span>&nbsp;<span class="ident" id="7335494">tag</span><span class="op" id="7335497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7335505">if</span>&nbsp;<span class="op" id="7335508">!</span><span class="ident" id="7335509">reflect</span><span class="op" id="7335516">.</span><span class="ident" id="7335517">DeepEqual</span><span class="op" id="7335526">(</span><span class="ident" id="7335527">m</span><span class="op" id="7335528">,</span>&nbsp;<span class="ident" id="7335530">want</span><span class="op" id="7335534">)</span>&nbsp;<span class="op" id="7335536">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335541">t</span><span class="op" id="7335542">.</span><span class="ident" id="7335543">Errorf</span><span class="op" id="7335549">(</span><span class="string" id="7335550">&#34;%s&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7335573">,</span>&nbsp;<span class="ident" id="7335575">tag</span><span class="op" id="7335578">,</span>&nbsp;<span class="ident" id="7335580">m</span><span class="op" id="7335581">,</span>&nbsp;<span class="ident" id="7335583">want</span><span class="op" id="7335587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335598">match</span><span class="op" id="7335603">(</span><span class="ident" id="7335604">runtime</span><span class="op" id="7335611">.</span><span class="ident" id="7335612">GOOS</span><span class="op" id="7335616">+</span><span class="string" id="7335617">&#34;,&#34;</span><span class="op" id="7335620">+</span><span class="ident" id="7335621">runtime</span><span class="op" id="7335628">.</span><span class="ident" id="7335629">GOARCH</span><span class="op" id="7335635">,</span>&nbsp;<span class="keyword" id="7335637">map</span><span class="op" id="7335640">[</span><span class="builtintype" id="7335641">string</span><span class="op" id="7335647">]</span><span class="builtintype" id="7335648">bool</span><span class="op" id="7335652">{</span><span class="ident" id="7335653">runtime</span><span class="op" id="7335660">.</span><span class="ident" id="7335661">GOOS</span><span class="op" id="7335665">:</span>&nbsp;<span class="builtintype" id="7335667">true</span><span class="op" id="7335671">,</span>&nbsp;<span class="ident" id="7335673">runtime</span><span class="op" id="7335680">.</span><span class="ident" id="7335681">GOARCH</span><span class="op" id="7335687">:</span>&nbsp;<span class="builtintype" id="7335689">true</span><span class="op" id="7335693">}</span><span class="op" id="7335694">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335697">match</span><span class="op" id="7335702">(</span><span class="ident" id="7335703">runtime</span><span class="op" id="7335710">.</span><span class="ident" id="7335711">GOOS</span><span class="op" id="7335715">+</span><span class="string" id="7335716">&#34;,&#34;</span><span class="op" id="7335719">+</span><span class="ident" id="7335720">runtime</span><span class="op" id="7335727">.</span><span class="ident" id="7335728">GOARCH</span><span class="op" id="7335734">+</span><span class="string" id="7335735">&#34;,!foo&#34;</span><span class="op" id="7335742">,</span>&nbsp;<span class="keyword" id="7335744">map</span><span class="op" id="7335747">[</span><span class="builtintype" id="7335748">string</span><span class="op" id="7335754">]</span><span class="builtintype" id="7335755">bool</span><span class="op" id="7335759">{</span><span class="ident" id="7335760">runtime</span><span class="op" id="7335767">.</span><span class="ident" id="7335768">GOOS</span><span class="op" id="7335772">:</span>&nbsp;<span class="builtintype" id="7335774">true</span><span class="op" id="7335778">,</span>&nbsp;<span class="ident" id="7335780">runtime</span><span class="op" id="7335787">.</span><span class="ident" id="7335788">GOARCH</span><span class="op" id="7335794">:</span>&nbsp;<span class="builtintype" id="7335796">true</span><span class="op" id="7335800">,</span>&nbsp;<span class="string" id="7335802">&#34;foo&#34;</span><span class="op" id="7335807">:</span>&nbsp;<span class="builtintype" id="7335809">true</span><span class="op" id="7335813">}</span><span class="op" id="7335814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335817">nomatch</span><span class="op" id="7335824">(</span><span class="ident" id="7335825">runtime</span><span class="op" id="7335832">.</span><span class="ident" id="7335833">GOOS</span><span class="op" id="7335837">+</span><span class="string" id="7335838">&#34;,&#34;</span><span class="op" id="7335841">+</span><span class="ident" id="7335842">runtime</span><span class="op" id="7335849">.</span><span class="ident" id="7335850">GOARCH</span><span class="op" id="7335856">+</span><span class="string" id="7335857">&#34;,foo&#34;</span><span class="op" id="7335863">,</span>&nbsp;<span class="keyword" id="7335865">map</span><span class="op" id="7335868">[</span><span class="builtintype" id="7335869">string</span><span class="op" id="7335875">]</span><span class="builtintype" id="7335876">bool</span><span class="op" id="7335880">{</span><span class="ident" id="7335881">runtime</span><span class="op" id="7335888">.</span><span class="ident" id="7335889">GOOS</span><span class="op" id="7335893">:</span>&nbsp;<span class="builtintype" id="7335895">true</span><span class="op" id="7335899">,</span>&nbsp;<span class="ident" id="7335901">runtime</span><span class="op" id="7335908">.</span><span class="ident" id="7335909">GOARCH</span><span class="op" id="7335915">:</span>&nbsp;<span class="builtintype" id="7335917">true</span><span class="op" id="7335921">,</span>&nbsp;<span class="string" id="7335923">&#34;foo&#34;</span><span class="op" id="7335928">:</span>&nbsp;<span class="builtintype" id="7335930">true</span><span class="op" id="7335934">}</span><span class="op" id="7335935">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335939">what</span>&nbsp;<span class="op" id="7335944">=</span>&nbsp;<span class="string" id="7335946">&#34;modified&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335958">ctxt</span><span class="op" id="7335962">.</span><span class="ident" id="7335963">BuildTags</span>&nbsp;<span class="op" id="7335973">=</span>&nbsp;<span class="op" id="7335975">[</span><span class="op" id="7335976">]</span><span class="builtintype" id="7335977">string</span><span class="op" id="7335983">{</span><span class="string" id="7335984">&#34;foo&#34;</span><span class="op" id="7335989">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335992">match</span><span class="op" id="7335997">(</span><span class="ident" id="7335998">runtime</span><span class="op" id="7336005">.</span><span class="ident" id="7336006">GOOS</span><span class="op" id="7336010">+</span><span class="string" id="7336011">&#34;,&#34;</span><span class="op" id="7336014">+</span><span class="ident" id="7336015">runtime</span><span class="op" id="7336022">.</span><span class="ident" id="7336023">GOARCH</span><span class="op" id="7336029">,</span>&nbsp;<span class="keyword" id="7336031">map</span><span class="op" id="7336034">[</span><span class="builtintype" id="7336035">string</span><span class="op" id="7336041">]</span><span class="builtintype" id="7336042">bool</span><span class="op" id="7336046">{</span><span class="ident" id="7336047">runtime</span><span class="op" id="7336054">.</span><span class="ident" id="7336055">GOOS</span><span class="op" id="7336059">:</span>&nbsp;<span class="builtintype" id="7336061">true</span><span class="op" id="7336065">,</span>&nbsp;<span class="ident" id="7336067">runtime</span><span class="op" id="7336074">.</span><span class="ident" id="7336075">GOARCH</span><span class="op" id="7336081">:</span>&nbsp;<span class="builtintype" id="7336083">true</span><span class="op" id="7336087">}</span><span class="op" id="7336088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336091">match</span><span class="op" id="7336096">(</span><span class="ident" id="7336097">runtime</span><span class="op" id="7336104">.</span><span class="ident" id="7336105">GOOS</span><span class="op" id="7336109">+</span><span class="string" id="7336110">&#34;,&#34;</span><span class="op" id="7336113">+</span><span class="ident" id="7336114">runtime</span><span class="op" id="7336121">.</span><span class="ident" id="7336122">GOARCH</span><span class="op" id="7336128">+</span><span class="string" id="7336129">&#34;,foo&#34;</span><span class="op" id="7336135">,</span>&nbsp;<span class="keyword" id="7336137">map</span><span class="op" id="7336140">[</span><span class="builtintype" id="7336141">string</span><span class="op" id="7336147">]</span><span class="builtintype" id="7336148">bool</span><span class="op" id="7336152">{</span><span class="ident" id="7336153">runtime</span><span class="op" id="7336160">.</span><span class="ident" id="7336161">GOOS</span><span class="op" id="7336165">:</span>&nbsp;<span class="builtintype" id="7336167">true</span><span class="op" id="7336171">,</span>&nbsp;<span class="ident" id="7336173">runtime</span><span class="op" id="7336180">.</span><span class="ident" id="7336181">GOARCH</span><span class="op" id="7336187">:</span>&nbsp;<span class="builtintype" id="7336189">true</span><span class="op" id="7336193">,</span>&nbsp;<span class="string" id="7336195">&#34;foo&#34;</span><span class="op" id="7336200">:</span>&nbsp;<span class="builtintype" id="7336202">true</span><span class="op" id="7336206">}</span><span class="op" id="7336207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336210">nomatch</span><span class="op" id="7336217">(</span><span class="ident" id="7336218">runtime</span><span class="op" id="7336225">.</span><span class="ident" id="7336226">GOOS</span><span class="op" id="7336230">+</span><span class="string" id="7336231">&#34;,&#34;</span><span class="op" id="7336234">+</span><span class="ident" id="7336235">runtime</span><span class="op" id="7336242">.</span><span class="ident" id="7336243">GOARCH</span><span class="op" id="7336249">+</span><span class="string" id="7336250">&#34;,!foo&#34;</span><span class="op" id="7336257">,</span>&nbsp;<span class="keyword" id="7336259">map</span><span class="op" id="7336262">[</span><span class="builtintype" id="7336263">string</span><span class="op" id="7336269">]</span><span class="builtintype" id="7336270">bool</span><span class="op" id="7336274">{</span><span class="ident" id="7336275">runtime</span><span class="op" id="7336282">.</span><span class="ident" id="7336283">GOOS</span><span class="op" id="7336287">:</span>&nbsp;<span class="builtintype" id="7336289">true</span><span class="op" id="7336293">,</span>&nbsp;<span class="ident" id="7336295">runtime</span><span class="op" id="7336302">.</span><span class="ident" id="7336303">GOARCH</span><span class="op" id="7336309">:</span>&nbsp;<span class="builtintype" id="7336311">true</span><span class="op" id="7336315">,</span>&nbsp;<span class="string" id="7336317">&#34;foo&#34;</span><span class="op" id="7336322">:</span>&nbsp;<span class="builtintype" id="7336324">true</span><span class="op" id="7336328">}</span><span class="op" id="7336329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336332">match</span><span class="op" id="7336337">(</span><span class="ident" id="7336338">runtime</span><span class="op" id="7336345">.</span><span class="ident" id="7336346">GOOS</span><span class="op" id="7336350">+</span><span class="string" id="7336351">&#34;,&#34;</span><span class="op" id="7336354">+</span><span class="ident" id="7336355">runtime</span><span class="op" id="7336362">.</span><span class="ident" id="7336363">GOARCH</span><span class="op" id="7336369">+</span><span class="string" id="7336370">&#34;,!bar&#34;</span><span class="op" id="7336377">,</span>&nbsp;<span class="keyword" id="7336379">map</span><span class="op" id="7336382">[</span><span class="builtintype" id="7336383">string</span><span class="op" id="7336389">]</span><span class="builtintype" id="7336390">bool</span><span class="op" id="7336394">{</span><span class="ident" id="7336395">runtime</span><span class="op" id="7336402">.</span><span class="ident" id="7336403">GOOS</span><span class="op" id="7336407">:</span>&nbsp;<span class="builtintype" id="7336409">true</span><span class="op" id="7336413">,</span>&nbsp;<span class="ident" id="7336415">runtime</span><span class="op" id="7336422">.</span><span class="ident" id="7336423">GOARCH</span><span class="op" id="7336429">:</span>&nbsp;<span class="builtintype" id="7336431">true</span><span class="op" id="7336435">,</span>&nbsp;<span class="string" id="7336437">&#34;bar&#34;</span><span class="op" id="7336442">:</span>&nbsp;<span class="builtintype" id="7336444">true</span><span class="op" id="7336448">}</span><span class="op" id="7336449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336452">nomatch</span><span class="op" id="7336459">(</span><span class="ident" id="7336460">runtime</span><span class="op" id="7336467">.</span><span class="ident" id="7336468">GOOS</span><span class="op" id="7336472">+</span><span class="string" id="7336473">&#34;,&#34;</span><span class="op" id="7336476">+</span><span class="ident" id="7336477">runtime</span><span class="op" id="7336484">.</span><span class="ident" id="7336485">GOARCH</span><span class="op" id="7336491">+</span><span class="string" id="7336492">&#34;,bar&#34;</span><span class="op" id="7336498">,</span>&nbsp;<span class="keyword" id="7336500">map</span><span class="op" id="7336503">[</span><span class="builtintype" id="7336504">string</span><span class="op" id="7336510">]</span><span class="builtintype" id="7336511">bool</span><span class="op" id="7336515">{</span><span class="ident" id="7336516">runtime</span><span class="op" id="7336523">.</span><span class="ident" id="7336524">GOOS</span><span class="op" id="7336528">:</span>&nbsp;<span class="builtintype" id="7336530">true</span><span class="op" id="7336534">,</span>&nbsp;<span class="ident" id="7336536">runtime</span><span class="op" id="7336543">.</span><span class="ident" id="7336544">GOARCH</span><span class="op" id="7336550">:</span>&nbsp;<span class="builtintype" id="7336552">true</span><span class="op" id="7336556">,</span>&nbsp;<span class="string" id="7336558">&#34;bar&#34;</span><span class="op" id="7336563">:</span>&nbsp;<span class="builtintype" id="7336565">true</span><span class="op" id="7336569">}</span><span class="op" id="7336570">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336573">nomatch</span><span class="op" id="7336580">(</span><span class="string" id="7336581">&#34;!&#34;</span><span class="op" id="7336584">,</span>&nbsp;<span class="keyword" id="7336586">map</span><span class="op" id="7336589">[</span><span class="builtintype" id="7336590">string</span><span class="op" id="7336596">]</span><span class="builtintype" id="7336597">bool</span><span class="op" id="7336601">{</span><span class="op" id="7336602">}</span><span class="op" id="7336603">)</span><br>
<span class="lineno"></span><span class="op" id="7336605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7336608">func</span>&nbsp;<span class="ident" id="7336613">TestDotSlashImport</span><span class="op" id="7336631">(</span><span class="ident" id="7336632">t</span>&nbsp;<span class="op" id="7336634">*</span><span class="ident" id="7336635">testing</span><span class="op" id="7336642">.</span><span class="ident" id="7336643">T</span><span class="op" id="7336644">)</span>&nbsp;<span class="op" id="7336646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336649">p</span><span class="op" id="7336650">,</span>&nbsp;<span class="ident" id="7336652">err</span>&nbsp;<span class="op" id="7336656">:=</span>&nbsp;<span class="ident" id="7336659">ImportDir</span><span class="op" id="7336668">(</span><span class="string" id="7336669">&#34;testdata/other&#34;</span><span class="op" id="7336685">,</span>&nbsp;<span class="num" id="7336687">0</span><span class="op" id="7336688">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7336691">if</span>&nbsp;<span class="ident" id="7336694">err</span>&nbsp;<span class="op" id="7336698">!=</span>&nbsp;<span class="builtintype" id="7336701">nil</span>&nbsp;<span class="op" id="7336705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336709">t</span><span class="op" id="7336710">.</span><span class="ident" id="7336711">Fatal</span><span class="op" id="7336716">(</span><span class="ident" id="7336717">err</span><span class="op" id="7336720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7336723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7336726">if</span>&nbsp;<span class="builtinfunc" id="7336729">len</span><span class="op" id="7336732">(</span><span class="ident" id="7336733">p</span><span class="op" id="7336734">.</span><span class="ident" id="7336735">Imports</span><span class="op" id="7336742">)</span>&nbsp;<span class="op" id="7336744">!=</span>&nbsp;<span class="num" id="7336747">1</span>&nbsp;<span class="op" id="7336749">||</span>&nbsp;<span class="ident" id="7336752">p</span><span class="op" id="7336753">.</span><span class="ident" id="7336754">Imports</span><span class="op" id="7336761">[</span><span class="num" id="7336762">0</span><span class="op" id="7336763">]</span>&nbsp;<span class="op" id="7336765">!=</span>&nbsp;<span class="string" id="7336768">&#34;./file&#34;</span>&nbsp;<span class="op" id="7336777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336781">t</span><span class="op" id="7336782">.</span><span class="ident" id="7336783">Fatalf</span><span class="op" id="7336789">(</span><span class="string" id="7336790">&#34;testdata/other:&nbsp;Imports=%v,&nbsp;want&nbsp;[./file]&#34;</span><span class="op" id="7336833">,</span>&nbsp;<span class="ident" id="7336835">p</span><span class="op" id="7336836">.</span><span class="ident" id="7336837">Imports</span><span class="op" id="7336844">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7336847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336851">p1</span><span class="op" id="7336853">,</span>&nbsp;<span class="ident" id="7336855">err</span>&nbsp;<span class="op" id="7336859">:=</span>&nbsp;<span class="ident" id="7336862">Import</span><span class="op" id="7336868">(</span><span class="string" id="7336869">&#34;./file&#34;</span><span class="op" id="7336877">,</span>&nbsp;<span class="string" id="7336879">&#34;testdata/other&#34;</span><span class="op" id="7336895">,</span>&nbsp;<span class="num" id="7336897">0</span><span class="op" id="7336898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7336901">if</span>&nbsp;<span class="ident" id="7336904">err</span>&nbsp;<span class="op" id="7336908">!=</span>&nbsp;<span class="builtintype" id="7336911">nil</span>&nbsp;<span class="op" id="7336915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336919">t</span><span class="op" id="7336920">.</span><span class="ident" id="7336921">Fatal</span><span class="op" id="7336926">(</span><span class="ident" id="7336927">err</span><span class="op" id="7336930">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7336933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7336936">if</span>&nbsp;<span class="ident" id="7336939">p1</span><span class="op" id="7336941">.</span><span class="ident" id="7336942">Name</span>&nbsp;<span class="op" id="7336947">!=</span>&nbsp;<span class="string" id="7336950">&#34;file&#34;</span>&nbsp;<span class="op" id="7336957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336961">t</span><span class="op" id="7336962">.</span><span class="ident" id="7336963">Fatalf</span><span class="op" id="7336969">(</span><span class="string" id="7336970">&#34;./file:&nbsp;Name=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7336996">,</span>&nbsp;<span class="ident" id="7336998">p1</span><span class="op" id="7337000">.</span><span class="ident" id="7337001">Name</span><span class="op" id="7337005">,</span>&nbsp;<span class="string" id="7337007">&#34;file&#34;</span><span class="op" id="7337013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337019">dir</span>&nbsp;<span class="op" id="7337023">:=</span>&nbsp;<span class="ident" id="7337026">filepath</span><span class="op" id="7337034">.</span><span class="ident" id="7337035">Clean</span><span class="op" id="7337040">(</span><span class="string" id="7337041">&#34;testdata/other/file&#34;</span><span class="op" id="7337062">)</span>&nbsp;<span class="comment" id="7337064">//&nbsp;Clean&nbsp;to&nbsp;use&nbsp;\&nbsp;on&nbsp;Windows</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7337094">if</span>&nbsp;<span class="ident" id="7337097">p1</span><span class="op" id="7337099">.</span><span class="ident" id="7337100">Dir</span>&nbsp;<span class="op" id="7337104">!=</span>&nbsp;<span class="ident" id="7337107">dir</span>&nbsp;<span class="op" id="7337111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337115">t</span><span class="op" id="7337116">.</span><span class="ident" id="7337117">Fatalf</span><span class="op" id="7337123">(</span><span class="string" id="7337124">&#34;./file:&nbsp;Dir=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7337149">,</span>&nbsp;<span class="ident" id="7337151">p1</span><span class="op" id="7337153">.</span><span class="ident" id="7337154">Name</span><span class="op" id="7337158">,</span>&nbsp;<span class="ident" id="7337160">dir</span><span class="op" id="7337163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337166">}</span><br>
<span class="lineno"></span><span class="op" id="7337168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7337171">func</span>&nbsp;<span class="ident" id="7337176">TestEmptyImport</span><span class="op" id="7337191">(</span><span class="ident" id="7337192">t</span>&nbsp;<span class="op" id="7337194">*</span><span class="ident" id="7337195">testing</span><span class="op" id="7337202">.</span><span class="ident" id="7337203">T</span><span class="op" id="7337204">)</span>&nbsp;<span class="op" id="7337206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337209">p</span><span class="op" id="7337210">,</span>&nbsp;<span class="ident" id="7337212">err</span>&nbsp;<span class="op" id="7337216">:=</span>&nbsp;<span class="ident" id="7337219">Import</span><span class="op" id="7337225">(</span><span class="string" id="7337226">&#34;&#34;</span><span class="op" id="7337228">,</span>&nbsp;<span class="ident" id="7337230">Default</span><span class="op" id="7337237">.</span><span class="ident" id="7337238">GOROOT</span><span class="op" id="7337244">,</span>&nbsp;<span class="ident" id="7337246">FindOnly</span><span class="op" id="7337254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7337257">if</span>&nbsp;<span class="ident" id="7337260">err</span>&nbsp;<span class="op" id="7337264">==</span>&nbsp;<span class="builtintype" id="7337267">nil</span>&nbsp;<span class="op" id="7337271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337275">t</span><span class="op" id="7337276">.</span><span class="ident" id="7337277">Fatal</span><span class="op" id="7337282">(</span><span class="string" id="7337283">`Import(&#34;&#34;)&nbsp;returned&nbsp;nil&nbsp;error.`</span><span class="op" id="7337315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337318">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7337321">if</span>&nbsp;<span class="ident" id="7337324">p</span>&nbsp;<span class="op" id="7337326">==</span>&nbsp;<span class="builtintype" id="7337329">nil</span>&nbsp;<span class="op" id="7337333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337337">t</span><span class="op" id="7337338">.</span><span class="ident" id="7337339">Fatal</span><span class="op" id="7337344">(</span><span class="string" id="7337345">`Import(&#34;&#34;)&nbsp;returned&nbsp;nil&nbsp;package.`</span><span class="op" id="7337379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7337385">if</span>&nbsp;<span class="ident" id="7337388">p</span><span class="op" id="7337389">.</span><span class="ident" id="7337390">ImportPath</span>&nbsp;<span class="op" id="7337401">!=</span>&nbsp;<span class="string" id="7337404">&#34;&#34;</span>&nbsp;<span class="op" id="7337407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337411">t</span><span class="op" id="7337412">.</span><span class="ident" id="7337413">Fatalf</span><span class="op" id="7337419">(</span><span class="string" id="7337420">&#34;ImportPath=%q,&nbsp;want&nbsp;%q.&#34;</span><span class="op" id="7337445">,</span>&nbsp;<span class="ident" id="7337447">p</span><span class="op" id="7337448">.</span><span class="ident" id="7337449">ImportPath</span><span class="op" id="7337459">,</span>&nbsp;<span class="string" id="7337461">&#34;&#34;</span><span class="op" id="7337463">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337466">}</span><br>
<span class="lineno"></span><span class="op" id="7337468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7337471">func</span>&nbsp;<span class="ident" id="7337476">TestEmptyFolderImport</span><span class="op" id="7337497">(</span><span class="ident" id="7337498">t</span>&nbsp;<span class="op" id="7337500">*</span><span class="ident" id="7337501">testing</span><span class="op" id="7337508">.</span><span class="ident" id="7337509">T</span><span class="op" id="7337510">)</span>&nbsp;<span class="op" id="7337512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337515">_</span><span class="op" id="7337516">,</span>&nbsp;<span class="ident" id="7337518">err</span>&nbsp;<span class="op" id="7337522">:=</span>&nbsp;<span class="ident" id="7337525">Import</span><span class="op" id="7337531">(</span><span class="string" id="7337532">&#34;.&#34;</span><span class="op" id="7337535">,</span>&nbsp;<span class="string" id="7337537">&#34;testdata/empty&#34;</span><span class="op" id="7337553">,</span>&nbsp;<span class="num" id="7337555">0</span><span class="op" id="7337556">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7337559">if</span>&nbsp;<span class="ident" id="7337562">_</span><span class="op" id="7337563">,</span>&nbsp;<span class="ident" id="7337565">ok</span>&nbsp;<span class="op" id="7337568">:=</span>&nbsp;<span class="ident" id="7337571">err</span><span class="op" id="7337574">.</span><span class="op" id="7337575">(</span><span class="op" id="7337576">*</span><span class="ident" id="7337577">NoGoError</span><span class="op" id="7337586">)</span><span class="op" id="7337587">;</span>&nbsp;<span class="op" id="7337589">!</span><span class="ident" id="7337590">ok</span>&nbsp;<span class="op" id="7337593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337597">t</span><span class="op" id="7337598">.</span><span class="ident" id="7337599">Fatal</span><span class="op" id="7337604">(</span><span class="string" id="7337605">`Import(&#34;testdata/empty&#34;)&nbsp;did&nbsp;not&nbsp;return&nbsp;NoGoError.`</span><span class="op" id="7337657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337660">}</span><br>
<span class="lineno"></span><span class="op" id="7337662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7337665">func</span>&nbsp;<span class="ident" id="7337670">TestMultiplePackageImport</span><span class="op" id="7337695">(</span><span class="ident" id="7337696">t</span>&nbsp;<span class="op" id="7337698">*</span><span class="ident" id="7337699">testing</span><span class="op" id="7337706">.</span><span class="ident" id="7337707">T</span><span class="op" id="7337708">)</span>&nbsp;<span class="op" id="7337710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337713">_</span><span class="op" id="7337714">,</span>&nbsp;<span class="ident" id="7337716">err</span>&nbsp;<span class="op" id="7337720">:=</span>&nbsp;<span class="ident" id="7337723">Import</span><span class="op" id="7337729">(</span><span class="string" id="7337730">&#34;.&#34;</span><span class="op" id="7337733">,</span>&nbsp;<span class="string" id="7337735">&#34;testdata/multi&#34;</span><span class="op" id="7337751">,</span>&nbsp;<span class="num" id="7337753">0</span><span class="op" id="7337754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7337757">if</span>&nbsp;<span class="ident" id="7337760">_</span><span class="op" id="7337761">,</span>&nbsp;<span class="ident" id="7337763">ok</span>&nbsp;<span class="op" id="7337766">:=</span>&nbsp;<span class="ident" id="7337769">err</span><span class="op" id="7337772">.</span><span class="op" id="7337773">(</span><span class="op" id="7337774">*</span><span class="ident" id="7337775">MultiplePackageError</span><span class="op" id="7337795">)</span><span class="op" id="7337796">;</span>&nbsp;<span class="op" id="7337798">!</span><span class="ident" id="7337799">ok</span>&nbsp;<span class="op" id="7337802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337806">t</span><span class="op" id="7337807">.</span><span class="ident" id="7337808">Fatal</span><span class="op" id="7337813">(</span><span class="string" id="7337814">`Import(&#34;testdata/multi&#34;)&nbsp;did&nbsp;not&nbsp;return&nbsp;MultiplePackageError.`</span><span class="op" id="7337877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337880">}</span><br>
<span class="lineno">100</span><span class="op" id="7337882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7337885">func</span>&nbsp;<span class="ident" id="7337890">TestLocalDirectory</span><span class="op" id="7337908">(</span><span class="ident" id="7337909">t</span>&nbsp;<span class="op" id="7337911">*</span><span class="ident" id="7337912">testing</span><span class="op" id="7337919">.</span><span class="ident" id="7337920">T</span><span class="op" id="7337921">)</span>&nbsp;<span class="op" id="7337923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337926">cwd</span><span class="op" id="7337929">,</span>&nbsp;<span class="ident" id="7337931">err</span>&nbsp;<span class="op" id="7337935">:=</span>&nbsp;<span class="ident" id="7337938">os</span><span class="op" id="7337940">.</span><span class="ident" id="7337941">Getwd</span><span class="op" id="7337946">(</span><span class="op" id="7337947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7337950">if</span>&nbsp;<span class="ident" id="7337953">err</span>&nbsp;<span class="op" id="7337957">!=</span>&nbsp;<span class="builtintype" id="7337960">nil</span>&nbsp;<span class="op" id="7337964">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337968">t</span><span class="op" id="7337969">.</span><span class="ident" id="7337970">Fatal</span><span class="op" id="7337975">(</span><span class="ident" id="7337976">err</span><span class="op" id="7337979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337986">p</span><span class="op" id="7337987">,</span>&nbsp;<span class="ident" id="7337989">err</span>&nbsp;<span class="op" id="7337993">:=</span>&nbsp;<span class="ident" id="7337996">ImportDir</span><span class="op" id="7338005">(</span><span class="ident" id="7338006">cwd</span><span class="op" id="7338009">,</span>&nbsp;<span class="num" id="7338011">0</span><span class="op" id="7338012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7338015">if</span>&nbsp;<span class="ident" id="7338018">err</span>&nbsp;<span class="op" id="7338022">!=</span>&nbsp;<span class="builtintype" id="7338025">nil</span>&nbsp;<span class="op" id="7338029">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338033">t</span><span class="op" id="7338034">.</span><span class="ident" id="7338035">Fatal</span><span class="op" id="7338040">(</span><span class="ident" id="7338041">err</span><span class="op" id="7338044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7338050">if</span>&nbsp;<span class="ident" id="7338053">p</span><span class="op" id="7338054">.</span><span class="ident" id="7338055">ImportPath</span>&nbsp;<span class="op" id="7338066">!=</span>&nbsp;<span class="string" id="7338069">&#34;go/build&#34;</span>&nbsp;<span class="op" id="7338080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338084">t</span><span class="op" id="7338085">.</span><span class="ident" id="7338086">Fatalf</span><span class="op" id="7338092">(</span><span class="string" id="7338093">&#34;ImportPath=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7338117">,</span>&nbsp;<span class="ident" id="7338119">p</span><span class="op" id="7338120">.</span><span class="ident" id="7338121">ImportPath</span><span class="op" id="7338131">,</span>&nbsp;<span class="string" id="7338133">&#34;go/build&#34;</span><span class="op" id="7338143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338146">}</span><br>
<span class="lineno">115</span><span class="op" id="7338148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7338151">func</span>&nbsp;<span class="ident" id="7338156">TestShouldBuild</span><span class="op" id="7338171">(</span><span class="ident" id="7338172">t</span>&nbsp;<span class="op" id="7338174">*</span><span class="ident" id="7338175">testing</span><span class="op" id="7338182">.</span><span class="ident" id="7338183">T</span><span class="op" id="7338184">)</span>&nbsp;<span class="op" id="7338186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7338189">const</span>&nbsp;<span class="ident" id="7338195">file1</span>&nbsp;<span class="op" id="7338201">=</span>&nbsp;<span class="string" id="7338203">&#34;//&nbsp;+build&nbsp;tag1\n\n&#34;</span>&nbsp;<span class="op" id="7338224">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338228">&#34;package&nbsp;main\n&#34;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338246">want1</span>&nbsp;<span class="op" id="7338252">:=</span>&nbsp;<span class="keyword" id="7338255">map</span><span class="op" id="7338258">[</span><span class="builtintype" id="7338259">string</span><span class="op" id="7338265">]</span><span class="builtintype" id="7338266">bool</span><span class="op" id="7338270">{</span><span class="string" id="7338271">&#34;tag1&#34;</span><span class="op" id="7338277">:</span>&nbsp;<span class="builtintype" id="7338279">true</span><span class="op" id="7338283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7338287">const</span>&nbsp;<span class="ident" id="7338293">file2</span>&nbsp;<span class="op" id="7338299">=</span>&nbsp;<span class="string" id="7338301">&#34;//&nbsp;+build&nbsp;cgo\n\n&#34;</span>&nbsp;<span class="op" id="7338321">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338325">&#34;//&nbsp;This&nbsp;package&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;tags&nbsp;like\n&#34;</span>&nbsp;<span class="op" id="7338377">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338381">&#34;//&nbsp;+build&nbsp;tag1\n&#34;</span>&nbsp;<span class="op" id="7338400">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338404">&#34;package&nbsp;build&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338421">want2</span>&nbsp;<span class="op" id="7338427">:=</span>&nbsp;<span class="keyword" id="7338430">map</span><span class="op" id="7338433">[</span><span class="builtintype" id="7338434">string</span><span class="op" id="7338440">]</span><span class="builtintype" id="7338441">bool</span><span class="op" id="7338445">{</span><span class="string" id="7338446">&#34;cgo&#34;</span><span class="op" id="7338451">:</span>&nbsp;<span class="builtintype" id="7338453">true</span><span class="op" id="7338457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7338461">const</span>&nbsp;<span class="ident" id="7338467">file3</span>&nbsp;<span class="op" id="7338473">=</span>&nbsp;<span class="string" id="7338475">&#34;//&nbsp;Copyright&nbsp;The&nbsp;Go&nbsp;Authors.\n\n&#34;</span>&nbsp;<span class="op" id="7338510">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338514">&#34;package&nbsp;build\n\n&#34;</span>&nbsp;<span class="op" id="7338534">+</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338538">&#34;//&nbsp;shouldBuild&nbsp;checks&nbsp;tags&nbsp;given&nbsp;by&nbsp;lines&nbsp;of&nbsp;the&nbsp;form\n&#34;</span>&nbsp;<span class="op" id="7338596">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338600">&#34;//&nbsp;+build&nbsp;tag\n&#34;</span>&nbsp;<span class="op" id="7338618">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338622">&#34;func&nbsp;shouldBuild(content&nbsp;[]byte)\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338660">want3</span>&nbsp;<span class="op" id="7338666">:=</span>&nbsp;<span class="keyword" id="7338669">map</span><span class="op" id="7338672">[</span><span class="builtintype" id="7338673">string</span><span class="op" id="7338679">]</span><span class="builtintype" id="7338680">bool</span><span class="op" id="7338684">{</span><span class="op" id="7338685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338689">ctx</span>&nbsp;<span class="op" id="7338693">:=</span>&nbsp;<span class="op" id="7338696">&amp;</span><span class="ident" id="7338697">Context</span><span class="op" id="7338704">{</span><span class="ident" id="7338705">BuildTags</span><span class="op" id="7338714">:</span>&nbsp;<span class="op" id="7338716">[</span><span class="op" id="7338717">]</span><span class="builtintype" id="7338718">string</span><span class="op" id="7338724">{</span><span class="string" id="7338725">&#34;tag1&#34;</span><span class="op" id="7338731">}</span><span class="op" id="7338732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338735">m</span>&nbsp;<span class="op" id="7338737">:=</span>&nbsp;<span class="keyword" id="7338740">map</span><span class="op" id="7338743">[</span><span class="builtintype" id="7338744">string</span><span class="op" id="7338750">]</span><span class="builtintype" id="7338751">bool</span><span class="op" id="7338755">{</span><span class="op" id="7338756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7338759">if</span>&nbsp;<span class="op" id="7338762">!</span><span class="ident" id="7338763">ctx</span><span class="op" id="7338766">.</span><span class="ident" id="7338767">shouldBuild</span><span class="op" id="7338778">(</span><span class="op" id="7338779">[</span><span class="op" id="7338780">]</span><span class="builtintype" id="7338781">byte</span><span class="op" id="7338785">(</span><span class="ident" id="7338786">file1</span><span class="op" id="7338791">)</span><span class="op" id="7338792">,</span>&nbsp;<span class="ident" id="7338794">m</span><span class="op" id="7338795">)</span>&nbsp;<span class="op" id="7338797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338801">t</span><span class="op" id="7338802">.</span><span class="ident" id="7338803">Errorf</span><span class="op" id="7338809">(</span><span class="string" id="7338810">&#34;shouldBuild(file1)&nbsp;=&nbsp;false,&nbsp;want&nbsp;true&#34;</span><span class="op" id="7338849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338852">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7338855">if</span>&nbsp;<span class="op" id="7338858">!</span><span class="ident" id="7338859">reflect</span><span class="op" id="7338866">.</span><span class="ident" id="7338867">DeepEqual</span><span class="op" id="7338876">(</span><span class="ident" id="7338877">m</span><span class="op" id="7338878">,</span>&nbsp;<span class="ident" id="7338880">want1</span><span class="op" id="7338885">)</span>&nbsp;<span class="op" id="7338887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338891">t</span><span class="op" id="7338892">.</span><span class="ident" id="7338893">Errorf</span><span class="op" id="7338899">(</span><span class="string" id="7338900">&#34;shoudBuild(file1)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7338938">,</span>&nbsp;<span class="ident" id="7338940">m</span><span class="op" id="7338941">,</span>&nbsp;<span class="ident" id="7338943">want1</span><span class="op" id="7338948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338955">m</span>&nbsp;<span class="op" id="7338957">=</span>&nbsp;<span class="keyword" id="7338959">map</span><span class="op" id="7338962">[</span><span class="builtintype" id="7338963">string</span><span class="op" id="7338969">]</span><span class="builtintype" id="7338970">bool</span><span class="op" id="7338974">{</span><span class="op" id="7338975">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7338978">if</span>&nbsp;<span class="ident" id="7338981">ctx</span><span class="op" id="7338984">.</span><span class="ident" id="7338985">shouldBuild</span><span class="op" id="7338996">(</span><span class="op" id="7338997">[</span><span class="op" id="7338998">]</span><span class="builtintype" id="7338999">byte</span><span class="op" id="7339003">(</span><span class="ident" id="7339004">file2</span><span class="op" id="7339009">)</span><span class="op" id="7339010">,</span>&nbsp;<span class="ident" id="7339012">m</span><span class="op" id="7339013">)</span>&nbsp;<span class="op" id="7339015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339019">t</span><span class="op" id="7339020">.</span><span class="ident" id="7339021">Errorf</span><span class="op" id="7339027">(</span><span class="string" id="7339028">&#34;shouldBuild(file2)&nbsp;=&nbsp;true,&nbsp;want&nbsp;fakse&#34;</span><span class="op" id="7339067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7339073">if</span>&nbsp;<span class="op" id="7339076">!</span><span class="ident" id="7339077">reflect</span><span class="op" id="7339084">.</span><span class="ident" id="7339085">DeepEqual</span><span class="op" id="7339094">(</span><span class="ident" id="7339095">m</span><span class="op" id="7339096">,</span>&nbsp;<span class="ident" id="7339098">want2</span><span class="op" id="7339103">)</span>&nbsp;<span class="op" id="7339105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339109">t</span><span class="op" id="7339110">.</span><span class="ident" id="7339111">Errorf</span><span class="op" id="7339117">(</span><span class="string" id="7339118">&#34;shoudBuild(file2)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7339156">,</span>&nbsp;<span class="ident" id="7339158">m</span><span class="op" id="7339159">,</span>&nbsp;<span class="ident" id="7339161">want2</span><span class="op" id="7339166">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339173">m</span>&nbsp;<span class="op" id="7339175">=</span>&nbsp;<span class="keyword" id="7339177">map</span><span class="op" id="7339180">[</span><span class="builtintype" id="7339181">string</span><span class="op" id="7339187">]</span><span class="builtintype" id="7339188">bool</span><span class="op" id="7339192">{</span><span class="op" id="7339193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339196">ctx</span>&nbsp;<span class="op" id="7339200">=</span>&nbsp;<span class="op" id="7339202">&amp;</span><span class="ident" id="7339203">Context</span><span class="op" id="7339210">{</span><span class="ident" id="7339211">BuildTags</span><span class="op" id="7339220">:</span>&nbsp;<span class="builtintype" id="7339222">nil</span><span class="op" id="7339225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7339228">if</span>&nbsp;<span class="op" id="7339231">!</span><span class="ident" id="7339232">ctx</span><span class="op" id="7339235">.</span><span class="ident" id="7339236">shouldBuild</span><span class="op" id="7339247">(</span><span class="op" id="7339248">[</span><span class="op" id="7339249">]</span><span class="builtintype" id="7339250">byte</span><span class="op" id="7339254">(</span><span class="ident" id="7339255">file3</span><span class="op" id="7339260">)</span><span class="op" id="7339261">,</span>&nbsp;<span class="ident" id="7339263">m</span><span class="op" id="7339264">)</span>&nbsp;<span class="op" id="7339266">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339270">t</span><span class="op" id="7339271">.</span><span class="ident" id="7339272">Errorf</span><span class="op" id="7339278">(</span><span class="string" id="7339279">&#34;shouldBuild(file3)&nbsp;=&nbsp;false,&nbsp;want&nbsp;true&#34;</span><span class="op" id="7339318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7339324">if</span>&nbsp;<span class="op" id="7339327">!</span><span class="ident" id="7339328">reflect</span><span class="op" id="7339335">.</span><span class="ident" id="7339336">DeepEqual</span><span class="op" id="7339345">(</span><span class="ident" id="7339346">m</span><span class="op" id="7339347">,</span>&nbsp;<span class="ident" id="7339349">want3</span><span class="op" id="7339354">)</span>&nbsp;<span class="op" id="7339356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339360">t</span><span class="op" id="7339361">.</span><span class="ident" id="7339362">Errorf</span><span class="op" id="7339368">(</span><span class="string" id="7339369">&#34;shoudBuild(file3)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7339407">,</span>&nbsp;<span class="ident" id="7339409">m</span><span class="op" id="7339410">,</span>&nbsp;<span class="ident" id="7339412">want3</span><span class="op" id="7339417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339420">}</span><br>
<span class="lineno">160</span><span class="op" id="7339422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7339425">type</span>&nbsp;<span class="ident" id="7339430">readNopCloser</span>&nbsp;<span class="keyword" id="7339444">struct</span>&nbsp;<span class="op" id="7339451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339454">io</span><span class="op" id="7339456">.</span><span class="ident" id="7339457">Reader</span><br>
<span class="lineno"></span><span class="op" id="7339464">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="7339467">func</span>&nbsp;<span class="op" id="7339472">(</span><span class="ident" id="7339473">r</span>&nbsp;<span class="ident" id="7339475">readNopCloser</span><span class="op" id="7339488">)</span>&nbsp;<span class="ident" id="7339490">Close</span><span class="op" id="7339495">(</span><span class="op" id="7339496">)</span>&nbsp;<span class="builtintype" id="7339498">error</span>&nbsp;<span class="op" id="7339504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7339507">return</span>&nbsp;<span class="builtintype" id="7339514">nil</span><br>
<span class="lineno"></span><span class="op" id="7339518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="7339521">var</span>&nbsp;<span class="op" id="7339525">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339528">ctxtP9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339540">=</span>&nbsp;<span class="ident" id="7339542">Context</span><span class="op" id="7339549">{</span><span class="ident" id="7339550">GOARCH</span><span class="op" id="7339556">:</span>&nbsp;<span class="string" id="7339558">&#34;arm&#34;</span><span class="op" id="7339563">,</span>&nbsp;<span class="ident" id="7339565">GOOS</span><span class="op" id="7339569">:</span>&nbsp;<span class="string" id="7339571">&#34;plan9&#34;</span><span class="op" id="7339578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339581">ctxtAndroid</span>&nbsp;<span class="op" id="7339593">=</span>&nbsp;<span class="ident" id="7339595">Context</span><span class="op" id="7339602">{</span><span class="ident" id="7339603">GOARCH</span><span class="op" id="7339609">:</span>&nbsp;<span class="string" id="7339611">&#34;arm&#34;</span><span class="op" id="7339616">,</span>&nbsp;<span class="ident" id="7339618">GOOS</span><span class="op" id="7339622">:</span>&nbsp;<span class="string" id="7339624">&#34;android&#34;</span><span class="op" id="7339633">}</span><br>
<span class="lineno"></span><span class="op" id="7339635">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="7339638">var</span>&nbsp;<span class="ident" id="7339642">matchFileTests</span>&nbsp;<span class="op" id="7339657">=</span>&nbsp;<span class="op" id="7339659">[</span><span class="op" id="7339660">]</span><span class="keyword" id="7339661">struct</span>&nbsp;<span class="op" id="7339668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339671">ctxt</span>&nbsp;&nbsp;<span class="ident" id="7339677">Context</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339686">name</span>&nbsp;&nbsp;<span class="builtintype" id="7339692">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339700">data</span>&nbsp;&nbsp;<span class="builtintype" id="7339706">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339714">match</span>&nbsp;<span class="builtintype" id="7339720">bool</span><br>
<span class="lineno">180</span><span class="op" id="7339725">}</span><span class="op" id="7339726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339729">{</span><span class="ident" id="7339730">ctxtP9</span><span class="op" id="7339736">,</span>&nbsp;<span class="string" id="7339738">&#34;foo_arm.go&#34;</span><span class="op" id="7339750">,</span>&nbsp;<span class="string" id="7339752">&#34;&#34;</span><span class="op" id="7339754">,</span>&nbsp;<span class="builtintype" id="7339756">true</span><span class="op" id="7339760">}</span><span class="op" id="7339761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339764">{</span><span class="ident" id="7339765">ctxtP9</span><span class="op" id="7339771">,</span>&nbsp;<span class="string" id="7339773">&#34;foo1_arm.go&#34;</span><span class="op" id="7339786">,</span>&nbsp;<span class="string" id="7339788">&#34;//&nbsp;+build&nbsp;linux\n\npackage&nbsp;main\n&#34;</span><span class="op" id="7339823">,</span>&nbsp;<span class="builtintype" id="7339825">false</span><span class="op" id="7339830">}</span><span class="op" id="7339831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339834">{</span><span class="ident" id="7339835">ctxtP9</span><span class="op" id="7339841">,</span>&nbsp;<span class="string" id="7339843">&#34;foo_darwin.go&#34;</span><span class="op" id="7339858">,</span>&nbsp;<span class="string" id="7339860">&#34;&#34;</span><span class="op" id="7339862">,</span>&nbsp;<span class="builtintype" id="7339864">false</span><span class="op" id="7339869">}</span><span class="op" id="7339870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339873">{</span><span class="ident" id="7339874">ctxtP9</span><span class="op" id="7339880">,</span>&nbsp;<span class="string" id="7339882">&#34;foo.go&#34;</span><span class="op" id="7339890">,</span>&nbsp;<span class="string" id="7339892">&#34;&#34;</span><span class="op" id="7339894">,</span>&nbsp;<span class="builtintype" id="7339896">true</span><span class="op" id="7339900">}</span><span class="op" id="7339901">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339904">{</span><span class="ident" id="7339905">ctxtP9</span><span class="op" id="7339911">,</span>&nbsp;<span class="string" id="7339913">&#34;foo1.go&#34;</span><span class="op" id="7339922">,</span>&nbsp;<span class="string" id="7339924">&#34;//&nbsp;+build&nbsp;linux\n\npackage&nbsp;main\n&#34;</span><span class="op" id="7339959">,</span>&nbsp;<span class="builtintype" id="7339961">false</span><span class="op" id="7339966">}</span><span class="op" id="7339967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339970">{</span><span class="ident" id="7339971">ctxtP9</span><span class="op" id="7339977">,</span>&nbsp;<span class="string" id="7339979">&#34;foo.badsuffix&#34;</span><span class="op" id="7339994">,</span>&nbsp;<span class="string" id="7339996">&#34;&#34;</span><span class="op" id="7339998">,</span>&nbsp;<span class="builtintype" id="7340000">false</span><span class="op" id="7340005">}</span><span class="op" id="7340006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340009">{</span><span class="ident" id="7340010">ctxtAndroid</span><span class="op" id="7340021">,</span>&nbsp;<span class="string" id="7340023">&#34;foo_linux.go&#34;</span><span class="op" id="7340037">,</span>&nbsp;<span class="string" id="7340039">&#34;&#34;</span><span class="op" id="7340041">,</span>&nbsp;<span class="builtintype" id="7340043">true</span><span class="op" id="7340047">}</span><span class="op" id="7340048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340051">{</span><span class="ident" id="7340052">ctxtAndroid</span><span class="op" id="7340063">,</span>&nbsp;<span class="string" id="7340065">&#34;foo_android.go&#34;</span><span class="op" id="7340081">,</span>&nbsp;<span class="string" id="7340083">&#34;&#34;</span><span class="op" id="7340085">,</span>&nbsp;<span class="builtintype" id="7340087">true</span><span class="op" id="7340091">}</span><span class="op" id="7340092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340095">{</span><span class="ident" id="7340096">ctxtAndroid</span><span class="op" id="7340107">,</span>&nbsp;<span class="string" id="7340109">&#34;foo_plan9.go&#34;</span><span class="op" id="7340123">,</span>&nbsp;<span class="string" id="7340125">&#34;&#34;</span><span class="op" id="7340127">,</span>&nbsp;<span class="builtintype" id="7340129">false</span><span class="op" id="7340134">}</span><span class="op" id="7340135">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340138">{</span><span class="ident" id="7340139">ctxtAndroid</span><span class="op" id="7340150">,</span>&nbsp;<span class="string" id="7340152">&#34;android.go&#34;</span><span class="op" id="7340164">,</span>&nbsp;<span class="string" id="7340166">&#34;&#34;</span><span class="op" id="7340168">,</span>&nbsp;<span class="builtintype" id="7340170">true</span><span class="op" id="7340174">}</span><span class="op" id="7340175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340178">{</span><span class="ident" id="7340179">ctxtAndroid</span><span class="op" id="7340190">,</span>&nbsp;<span class="string" id="7340192">&#34;plan9.go&#34;</span><span class="op" id="7340202">,</span>&nbsp;<span class="string" id="7340204">&#34;&#34;</span><span class="op" id="7340206">,</span>&nbsp;<span class="builtintype" id="7340208">true</span><span class="op" id="7340212">}</span><span class="op" id="7340213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340216">{</span><span class="ident" id="7340217">ctxtAndroid</span><span class="op" id="7340228">,</span>&nbsp;<span class="string" id="7340230">&#34;plan9_test.go&#34;</span><span class="op" id="7340245">,</span>&nbsp;<span class="string" id="7340247">&#34;&#34;</span><span class="op" id="7340249">,</span>&nbsp;<span class="builtintype" id="7340251">true</span><span class="op" id="7340255">}</span><span class="op" id="7340256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340259">{</span><span class="ident" id="7340260">ctxtAndroid</span><span class="op" id="7340271">,</span>&nbsp;<span class="string" id="7340273">&#34;arm.s&#34;</span><span class="op" id="7340280">,</span>&nbsp;<span class="string" id="7340282">&#34;&#34;</span><span class="op" id="7340284">,</span>&nbsp;<span class="builtintype" id="7340286">true</span><span class="op" id="7340290">}</span><span class="op" id="7340291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340294">{</span><span class="ident" id="7340295">ctxtAndroid</span><span class="op" id="7340306">,</span>&nbsp;<span class="string" id="7340308">&#34;amd64.s&#34;</span><span class="op" id="7340317">,</span>&nbsp;<span class="string" id="7340319">&#34;&#34;</span><span class="op" id="7340321">,</span>&nbsp;<span class="builtintype" id="7340323">true</span><span class="op" id="7340327">}</span><span class="op" id="7340328">,</span><br>
<span class="lineno">195</span><span class="op" id="7340330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7340333">func</span>&nbsp;<span class="ident" id="7340338">TestMatchFile</span><span class="op" id="7340351">(</span><span class="ident" id="7340352">t</span>&nbsp;<span class="op" id="7340354">*</span><span class="ident" id="7340355">testing</span><span class="op" id="7340362">.</span><span class="ident" id="7340363">T</span><span class="op" id="7340364">)</span>&nbsp;<span class="op" id="7340366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7340369">for</span>&nbsp;<span class="ident" id="7340373">_</span><span class="op" id="7340374">,</span>&nbsp;<span class="ident" id="7340376">tt</span>&nbsp;<span class="op" id="7340379">:=</span>&nbsp;<span class="keyword" id="7340382">range</span>&nbsp;<span class="ident" id="7340388">matchFileTests</span>&nbsp;<span class="op" id="7340403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340407">ctxt</span>&nbsp;<span class="op" id="7340412">:=</span>&nbsp;<span class="ident" id="7340415">tt</span><span class="op" id="7340417">.</span><span class="ident" id="7340418">ctxt</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340425">ctxt</span><span class="op" id="7340429">.</span><span class="ident" id="7340430">OpenFile</span>&nbsp;<span class="op" id="7340439">=</span>&nbsp;<span class="keyword" id="7340441">func</span><span class="op" id="7340445">(</span><span class="ident" id="7340446">path</span>&nbsp;<span class="builtintype" id="7340451">string</span><span class="op" id="7340457">)</span>&nbsp;<span class="op" id="7340459">(</span><span class="ident" id="7340460">r</span>&nbsp;<span class="ident" id="7340462">io</span><span class="op" id="7340464">.</span><span class="ident" id="7340465">ReadCloser</span><span class="op" id="7340475">,</span>&nbsp;<span class="ident" id="7340477">err</span>&nbsp;<span class="builtintype" id="7340481">error</span><span class="op" id="7340486">)</span>&nbsp;<span class="op" id="7340488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7340493">if</span>&nbsp;<span class="ident" id="7340496">path</span>&nbsp;<span class="op" id="7340501">!=</span>&nbsp;<span class="string" id="7340504">&#34;x+&#34;</span><span class="op" id="7340508">+</span><span class="ident" id="7340509">tt</span><span class="op" id="7340511">.</span><span class="ident" id="7340512">name</span>&nbsp;<span class="op" id="7340517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340523">t</span><span class="op" id="7340524">.</span><span class="ident" id="7340525">Fatalf</span><span class="op" id="7340531">(</span><span class="string" id="7340532">&#34;OpenFile&nbsp;asked&nbsp;for&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7340568">,</span>&nbsp;<span class="ident" id="7340570">path</span><span class="op" id="7340574">,</span>&nbsp;<span class="string" id="7340576">&#34;x+&#34;</span><span class="op" id="7340580">+</span><span class="ident" id="7340581">tt</span><span class="op" id="7340583">.</span><span class="ident" id="7340584">name</span><span class="op" id="7340588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7340598">return</span>&nbsp;<span class="op" id="7340605">&amp;</span><span class="ident" id="7340606">readNopCloser</span><span class="op" id="7340619">{</span><span class="ident" id="7340620">strings</span><span class="op" id="7340627">.</span><span class="ident" id="7340628">NewReader</span><span class="op" id="7340637">(</span><span class="ident" id="7340638">tt</span><span class="op" id="7340640">.</span><span class="ident" id="7340641">data</span><span class="op" id="7340645">)</span><span class="op" id="7340646">}</span><span class="op" id="7340647">,</span>&nbsp;<span class="builtintype" id="7340649">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340659">ctxt</span><span class="op" id="7340663">.</span><span class="ident" id="7340664">JoinPath</span>&nbsp;<span class="op" id="7340673">=</span>&nbsp;<span class="keyword" id="7340675">func</span><span class="op" id="7340679">(</span><span class="ident" id="7340680">elem</span>&nbsp;<span class="op" id="7340685">...</span><span class="builtintype" id="7340688">string</span><span class="op" id="7340694">)</span>&nbsp;<span class="builtintype" id="7340696">string</span>&nbsp;<span class="op" id="7340703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7340708">return</span>&nbsp;<span class="ident" id="7340715">strings</span><span class="op" id="7340722">.</span><span class="ident" id="7340723">Join</span><span class="op" id="7340727">(</span><span class="ident" id="7340728">elem</span><span class="op" id="7340732">,</span>&nbsp;<span class="string" id="7340734">&#34;+&#34;</span><span class="op" id="7340737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340745">match</span><span class="op" id="7340750">,</span>&nbsp;<span class="ident" id="7340752">err</span>&nbsp;<span class="op" id="7340756">:=</span>&nbsp;<span class="ident" id="7340759">ctxt</span><span class="op" id="7340763">.</span><span class="ident" id="7340764">MatchFile</span><span class="op" id="7340773">(</span><span class="string" id="7340774">&#34;x&#34;</span><span class="op" id="7340777">,</span>&nbsp;<span class="ident" id="7340779">tt</span><span class="op" id="7340781">.</span><span class="ident" id="7340782">name</span><span class="op" id="7340786">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7340790">if</span>&nbsp;<span class="ident" id="7340793">match</span>&nbsp;<span class="op" id="7340799">!=</span>&nbsp;<span class="ident" id="7340802">tt</span><span class="op" id="7340804">.</span><span class="ident" id="7340805">match</span>&nbsp;<span class="op" id="7340811">||</span>&nbsp;<span class="ident" id="7340814">err</span>&nbsp;<span class="op" id="7340818">!=</span>&nbsp;<span class="builtintype" id="7340821">nil</span>&nbsp;<span class="op" id="7340825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340830">t</span><span class="op" id="7340831">.</span><span class="ident" id="7340832">Fatalf</span><span class="op" id="7340838">(</span><span class="string" id="7340839">&#34;MatchFile(%q)&nbsp;=&nbsp;%v,&nbsp;%v,&nbsp;want&nbsp;%v,&nbsp;nil&#34;</span><span class="op" id="7340877">,</span>&nbsp;<span class="ident" id="7340879">tt</span><span class="op" id="7340881">.</span><span class="ident" id="7340882">name</span><span class="op" id="7340886">,</span>&nbsp;<span class="ident" id="7340888">match</span><span class="op" id="7340893">,</span>&nbsp;<span class="ident" id="7340895">err</span><span class="op" id="7340898">,</span>&nbsp;<span class="ident" id="7340900">tt</span><span class="op" id="7340902">.</span><span class="ident" id="7340903">match</span><span class="op" id="7340908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340915">}</span><br>
<span class="lineno"></span><span class="op" id="7340917">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="7340920">func</span>&nbsp;<span class="ident" id="7340925">TestImportCmd</span><span class="op" id="7340938">(</span><span class="ident" id="7340939">t</span>&nbsp;<span class="op" id="7340941">*</span><span class="ident" id="7340942">testing</span><span class="op" id="7340949">.</span><span class="ident" id="7340950">T</span><span class="op" id="7340951">)</span>&nbsp;<span class="op" id="7340953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340956">p</span><span class="op" id="7340957">,</span>&nbsp;<span class="ident" id="7340959">err</span>&nbsp;<span class="op" id="7340963">:=</span>&nbsp;<span class="ident" id="7340966">Import</span><span class="op" id="7340972">(</span><span class="string" id="7340973">&#34;cmd/internal/objfile&#34;</span><span class="op" id="7340995">,</span>&nbsp;<span class="string" id="7340997">&#34;&#34;</span><span class="op" id="7340999">,</span>&nbsp;<span class="num" id="7341001">0</span><span class="op" id="7341002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341005">if</span>&nbsp;<span class="ident" id="7341008">err</span>&nbsp;<span class="op" id="7341012">!=</span>&nbsp;<span class="builtintype" id="7341015">nil</span>&nbsp;<span class="op" id="7341019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341023">t</span><span class="op" id="7341024">.</span><span class="ident" id="7341025">Fatal</span><span class="op" id="7341030">(</span><span class="ident" id="7341031">err</span><span class="op" id="7341034">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341040">if</span>&nbsp;<span class="op" id="7341043">!</span><span class="ident" id="7341044">strings</span><span class="op" id="7341051">.</span><span class="ident" id="7341052">HasSuffix</span><span class="op" id="7341061">(</span><span class="ident" id="7341062">filepath</span><span class="op" id="7341070">.</span><span class="ident" id="7341071">ToSlash</span><span class="op" id="7341078">(</span><span class="ident" id="7341079">p</span><span class="op" id="7341080">.</span><span class="ident" id="7341081">Dir</span><span class="op" id="7341084">)</span><span class="op" id="7341085">,</span>&nbsp;<span class="string" id="7341087">&#34;src/cmd/internal/objfile&#34;</span><span class="op" id="7341113">)</span>&nbsp;<span class="op" id="7341115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341119">t</span><span class="op" id="7341120">.</span><span class="ident" id="7341121">Fatalf</span><span class="op" id="7341127">(</span><span class="string" id="7341128">&#34;Import&nbsp;cmd/internal/objfile&nbsp;returned&nbsp;Dir=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7341182">,</span>&nbsp;<span class="ident" id="7341184">filepath</span><span class="op" id="7341192">.</span><span class="ident" id="7341193">ToSlash</span><span class="op" id="7341200">(</span><span class="ident" id="7341201">p</span><span class="op" id="7341202">.</span><span class="ident" id="7341203">Dir</span><span class="op" id="7341206">)</span><span class="op" id="7341207">,</span>&nbsp;<span class="string" id="7341209">&#34;.../src/cmd/internal/objfile&#34;</span><span class="op" id="7341239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341242">}</span><br>
<span class="lineno"></span><span class="op" id="7341244">}</span>
</div>
</body>
</html>
