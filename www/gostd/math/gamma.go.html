<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html" class="current">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2190913">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2190968">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2191022">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2191073">package</span>&nbsp;<span class="ident" id="2191081">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2191087">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2191147">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="2191212">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="2191270">//</span><br>
<span class="lineno"></span><span class="comment" id="2191273">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="2191290">//</span><br>
<span class="lineno"></span><span class="comment" id="2191293">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2191316">//</span><br>
<span class="lineno">15</span><span class="comment" id="2191319">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2191332">//</span><br>
<span class="lineno"></span><span class="comment" id="2191335">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="2191361">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="2191384">//</span><br>
<span class="lineno">20</span><span class="comment" id="2191387">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2191407">//</span><br>
<span class="lineno"></span><span class="comment" id="2191410">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2191426">//</span><br>
<span class="lineno"></span><span class="comment" id="2191429">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="2191487">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2191540">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="2191597">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="2191657">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="2191679">//</span><br>
<span class="lineno">30</span><span class="comment" id="2191682">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2191748">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2191808">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="2191870">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2191931">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="2191956">//</span><br>
<span class="lineno"></span><span class="comment" id="2191959">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2191972">//</span><br>
<span class="lineno"></span><span class="comment" id="2191975">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2192015">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2192073">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="2192133">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="2192193">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2192253">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2192313">//</span><br>
<span class="lineno">45</span><span class="comment" id="2192316">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2192377">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2192438">//</span><br>
<span class="lineno"></span><span class="comment" id="2192441">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="2192489">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="2192553">//</span><br>
<span class="lineno"></span><span class="comment" id="2192556">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2192617">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2192687">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="2192762">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="2192829">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2192902">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2192974">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2192988">//</span><br>
<span class="lineno"></span><span class="comment" id="2192991">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="2193057">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2193123">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2193136">//</span><br>
<span class="lineno"></span><span class="comment" id="2193139">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2193163">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2193193">var</span>&nbsp;<span class="ident" id="2193197">_gamP</span>&nbsp;<span class="op" id="2193203">=</span>&nbsp;<span class="op" id="2193205">[</span><span class="op" id="2193206">...</span><span class="op" id="2193209">]</span><span class="builtintype" id="2193210">float64</span><span class="op" id="2193217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193220">1.60119522476751861407e-04</span><span class="op" id="2193246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193249">1.19135147006586384913e-03</span><span class="op" id="2193275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193278">1.04213797561761569935e-02</span><span class="op" id="2193304">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193307">4.76367800457137231464e-02</span><span class="op" id="2193333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193336">2.07448227648435975150e-01</span><span class="op" id="2193362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193365">4.94214826801497100753e-01</span><span class="op" id="2193391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193394">9.99999999999999996796e-01</span><span class="op" id="2193420">,</span><br>
<span class="lineno"></span><span class="op" id="2193422">}</span><br>
<span class="lineno">75</span><span class="keyword" id="2193424">var</span>&nbsp;<span class="ident" id="2193428">_gamQ</span>&nbsp;<span class="op" id="2193434">=</span>&nbsp;<span class="op" id="2193436">[</span><span class="op" id="2193437">...</span><span class="op" id="2193440">]</span><span class="builtintype" id="2193441">float64</span><span class="op" id="2193448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2193451">-</span><span class="num" id="2193452">2.31581873324120129819e-05</span><span class="op" id="2193478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193481">5.39605580493303397842e-04</span><span class="op" id="2193507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2193510">-</span><span class="num" id="2193511">4.45641913851797240494e-03</span><span class="op" id="2193537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193540">1.18139785222060435552e-02</span><span class="op" id="2193566">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193569">3.58236398605498653373e-02</span><span class="op" id="2193595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2193598">-</span><span class="num" id="2193599">2.34591795718243348568e-01</span><span class="op" id="2193625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193628">7.14304917030273074085e-02</span><span class="op" id="2193654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193657">1.00000000000000000320e+00</span><span class="op" id="2193683">,</span><br>
<span class="lineno"></span><span class="op" id="2193685">}</span><br>
<span class="lineno">85</span><span class="keyword" id="2193687">var</span>&nbsp;<span class="ident" id="2193691">_gamS</span>&nbsp;<span class="op" id="2193697">=</span>&nbsp;<span class="op" id="2193699">[</span><span class="op" id="2193700">...</span><span class="op" id="2193703">]</span><span class="builtintype" id="2193704">float64</span><span class="op" id="2193711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193714">7.87311395793093628397e-04</span><span class="op" id="2193740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2193743">-</span><span class="num" id="2193744">2.29549961613378126380e-04</span><span class="op" id="2193770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2193773">-</span><span class="num" id="2193774">2.68132617805781232825e-03</span><span class="op" id="2193800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193803">3.47222221605458667310e-03</span><span class="op" id="2193829">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2193832">8.33333333333482257126e-02</span><span class="op" id="2193858">,</span><br>
<span class="lineno"></span><span class="op" id="2193860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2193863">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="2193913">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="2193960">func</span>&nbsp;<span class="ident" id="2193965">stirling</span><span class="op" id="2193973">(</span><span class="ident" id="2193974">x</span>&nbsp;<span class="builtintype" id="2193976">float64</span><span class="op" id="2193983">)</span>&nbsp;<span class="builtintype" id="2193985">float64</span>&nbsp;<span class="op" id="2193993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2193996">const</span>&nbsp;<span class="op" id="2194002">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194006">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2194018">=</span>&nbsp;<span class="num" id="2194020">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194046">MaxStirling</span>&nbsp;<span class="op" id="2194058">=</span>&nbsp;<span class="num" id="2194060">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194071">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194074">w</span>&nbsp;<span class="op" id="2194076">:=</span>&nbsp;<span class="num" id="2194079">1</span>&nbsp;<span class="op" id="2194081">/</span>&nbsp;<span class="ident" id="2194083">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194086">w</span>&nbsp;<span class="op" id="2194088">=</span>&nbsp;<span class="num" id="2194090">1</span>&nbsp;<span class="op" id="2194092">+</span>&nbsp;<span class="ident" id="2194094">w</span><span class="op" id="2194095">*</span><span class="op" id="2194096">(</span><span class="op" id="2194097">(</span><span class="op" id="2194098">(</span><span class="op" id="2194099">(</span><span class="ident" id="2194100">_gamS</span><span class="op" id="2194105">[</span><span class="num" id="2194106">0</span><span class="op" id="2194107">]</span><span class="op" id="2194108">*</span><span class="ident" id="2194109">w</span><span class="op" id="2194110">+</span><span class="ident" id="2194111">_gamS</span><span class="op" id="2194116">[</span><span class="num" id="2194117">1</span><span class="op" id="2194118">]</span><span class="op" id="2194119">)</span><span class="op" id="2194120">*</span><span class="ident" id="2194121">w</span><span class="op" id="2194122">+</span><span class="ident" id="2194123">_gamS</span><span class="op" id="2194128">[</span><span class="num" id="2194129">2</span><span class="op" id="2194130">]</span><span class="op" id="2194131">)</span><span class="op" id="2194132">*</span><span class="ident" id="2194133">w</span><span class="op" id="2194134">+</span><span class="ident" id="2194135">_gamS</span><span class="op" id="2194140">[</span><span class="num" id="2194141">3</span><span class="op" id="2194142">]</span><span class="op" id="2194143">)</span><span class="op" id="2194144">*</span><span class="ident" id="2194145">w</span><span class="op" id="2194146">+</span><span class="ident" id="2194147">_gamS</span><span class="op" id="2194152">[</span><span class="num" id="2194153">4</span><span class="op" id="2194154">]</span><span class="op" id="2194155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194158">y</span>&nbsp;<span class="op" id="2194160">:=</span>&nbsp;<span class="ident" id="2194163">Exp</span><span class="op" id="2194166">(</span><span class="ident" id="2194167">x</span><span class="op" id="2194168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194171">if</span>&nbsp;<span class="ident" id="2194174">x</span>&nbsp;<span class="op" id="2194176">&gt;</span>&nbsp;<span class="ident" id="2194178">MaxStirling</span>&nbsp;<span class="op" id="2194190">{</span>&nbsp;<span class="comment" id="2194192">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194218">v</span>&nbsp;<span class="op" id="2194220">:=</span>&nbsp;<span class="ident" id="2194223">Pow</span><span class="op" id="2194226">(</span><span class="ident" id="2194227">x</span><span class="op" id="2194228">,</span>&nbsp;<span class="num" id="2194230">0.5</span><span class="op" id="2194233">*</span><span class="ident" id="2194234">x</span><span class="op" id="2194235">-</span><span class="num" id="2194236">0.25</span><span class="op" id="2194240">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194244">y</span>&nbsp;<span class="op" id="2194246">=</span>&nbsp;<span class="ident" id="2194248">v</span>&nbsp;<span class="op" id="2194250">*</span>&nbsp;<span class="op" id="2194252">(</span><span class="ident" id="2194253">v</span>&nbsp;<span class="op" id="2194255">/</span>&nbsp;<span class="ident" id="2194257">y</span><span class="op" id="2194258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194261">}</span>&nbsp;<span class="keyword" id="2194263">else</span>&nbsp;<span class="op" id="2194268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194272">y</span>&nbsp;<span class="op" id="2194274">=</span>&nbsp;<span class="ident" id="2194276">Pow</span><span class="op" id="2194279">(</span><span class="ident" id="2194280">x</span><span class="op" id="2194281">,</span>&nbsp;<span class="ident" id="2194283">x</span><span class="op" id="2194284">-</span><span class="num" id="2194285">0.5</span><span class="op" id="2194288">)</span>&nbsp;<span class="op" id="2194290">/</span>&nbsp;<span class="ident" id="2194292">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194298">y</span>&nbsp;<span class="op" id="2194300">=</span>&nbsp;<span class="ident" id="2194302">SqrtTwoPi</span>&nbsp;<span class="op" id="2194312">*</span>&nbsp;<span class="ident" id="2194314">y</span>&nbsp;<span class="op" id="2194316">*</span>&nbsp;<span class="ident" id="2194318">w</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194321">return</span>&nbsp;<span class="ident" id="2194328">y</span><br>
<span class="lineno"></span><span class="op" id="2194330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2194333">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2194375">//</span><br>
<span class="lineno">115</span><span class="comment" id="2194378">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2194400">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2194422">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2194442">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2194462">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="2194498">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2194519">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2194539">func</span>&nbsp;<span class="ident" id="2194544">Gamma</span><span class="op" id="2194549">(</span><span class="ident" id="2194550">x</span>&nbsp;<span class="builtintype" id="2194552">float64</span><span class="op" id="2194559">)</span>&nbsp;<span class="builtintype" id="2194561">float64</span>&nbsp;<span class="op" id="2194569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194572">const</span>&nbsp;<span class="ident" id="2194578">Euler</span>&nbsp;<span class="op" id="2194584">=</span>&nbsp;<span class="num" id="2194586">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="2194639">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194651">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194669">switch</span>&nbsp;<span class="op" id="2194676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194679">case</span>&nbsp;<span class="ident" id="2194684">isNegInt</span><span class="op" id="2194692">(</span><span class="ident" id="2194693">x</span><span class="op" id="2194694">)</span>&nbsp;<span class="op" id="2194696">||</span>&nbsp;<span class="ident" id="2194699">IsInf</span><span class="op" id="2194704">(</span><span class="ident" id="2194705">x</span><span class="op" id="2194706">,</span>&nbsp;<span class="op" id="2194708">-</span><span class="num" id="2194709">1</span><span class="op" id="2194710">)</span>&nbsp;<span class="op" id="2194712">||</span>&nbsp;<span class="ident" id="2194715">IsNaN</span><span class="op" id="2194720">(</span><span class="ident" id="2194721">x</span><span class="op" id="2194722">)</span><span class="op" id="2194723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194727">return</span>&nbsp;<span class="ident" id="2194734">NaN</span><span class="op" id="2194737">(</span><span class="op" id="2194738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194741">case</span>&nbsp;<span class="ident" id="2194746">x</span>&nbsp;<span class="op" id="2194748">==</span>&nbsp;<span class="num" id="2194751">0</span><span class="op" id="2194752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194756">if</span>&nbsp;<span class="ident" id="2194759">Signbit</span><span class="op" id="2194766">(</span><span class="ident" id="2194767">x</span><span class="op" id="2194768">)</span>&nbsp;<span class="op" id="2194770">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194775">return</span>&nbsp;<span class="ident" id="2194782">Inf</span><span class="op" id="2194785">(</span><span class="op" id="2194786">-</span><span class="num" id="2194787">1</span><span class="op" id="2194788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194796">return</span>&nbsp;<span class="ident" id="2194803">Inf</span><span class="op" id="2194806">(</span><span class="num" id="2194807">1</span><span class="op" id="2194808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194811">case</span>&nbsp;<span class="ident" id="2194816">x</span>&nbsp;<span class="op" id="2194818">&lt;</span>&nbsp;<span class="op" id="2194820">-</span><span class="num" id="2194821">170.5674972726612</span>&nbsp;<span class="op" id="2194839">||</span>&nbsp;<span class="ident" id="2194842">x</span>&nbsp;<span class="op" id="2194844">&gt;</span>&nbsp;<span class="num" id="2194846">171.61447887182298</span><span class="op" id="2194864">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194868">return</span>&nbsp;<span class="ident" id="2194875">Inf</span><span class="op" id="2194878">(</span><span class="num" id="2194879">1</span><span class="op" id="2194880">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194886">q</span>&nbsp;<span class="op" id="2194888">:=</span>&nbsp;<span class="ident" id="2194891">Abs</span><span class="op" id="2194894">(</span><span class="ident" id="2194895">x</span><span class="op" id="2194896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194899">p</span>&nbsp;<span class="op" id="2194901">:=</span>&nbsp;<span class="ident" id="2194904">Floor</span><span class="op" id="2194909">(</span><span class="ident" id="2194910">q</span><span class="op" id="2194911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194914">if</span>&nbsp;<span class="ident" id="2194917">q</span>&nbsp;<span class="op" id="2194919">&gt;</span>&nbsp;<span class="num" id="2194921">33</span>&nbsp;<span class="op" id="2194924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194928">if</span>&nbsp;<span class="ident" id="2194931">x</span>&nbsp;<span class="op" id="2194933">&gt;=</span>&nbsp;<span class="num" id="2194936">0</span>&nbsp;<span class="op" id="2194938">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194943">return</span>&nbsp;<span class="ident" id="2194950">stirling</span><span class="op" id="2194958">(</span><span class="ident" id="2194959">x</span><span class="op" id="2194960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194968">signgam</span>&nbsp;<span class="op" id="2194976">:=</span>&nbsp;<span class="num" id="2194979">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194983">if</span>&nbsp;<span class="ident" id="2194986">ip</span>&nbsp;<span class="op" id="2194989">:=</span>&nbsp;<span class="builtintype" id="2194992">int</span><span class="op" id="2194995">(</span><span class="ident" id="2194996">p</span><span class="op" id="2194997">)</span><span class="op" id="2194998">;</span>&nbsp;<span class="ident" id="2195000">ip</span><span class="op" id="2195002">&amp;</span><span class="num" id="2195003">1</span>&nbsp;<span class="op" id="2195005">==</span>&nbsp;<span class="num" id="2195008">0</span>&nbsp;<span class="op" id="2195010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195015">signgam</span>&nbsp;<span class="op" id="2195023">=</span>&nbsp;<span class="op" id="2195025">-</span><span class="num" id="2195026">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195034">z</span>&nbsp;<span class="op" id="2195036">:=</span>&nbsp;<span class="ident" id="2195039">q</span>&nbsp;<span class="op" id="2195041">-</span>&nbsp;<span class="ident" id="2195043">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195047">if</span>&nbsp;<span class="ident" id="2195050">z</span>&nbsp;<span class="op" id="2195052">&gt;</span>&nbsp;<span class="num" id="2195054">0.5</span>&nbsp;<span class="op" id="2195058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195063">p</span>&nbsp;<span class="op" id="2195065">=</span>&nbsp;<span class="ident" id="2195067">p</span>&nbsp;<span class="op" id="2195069">+</span>&nbsp;<span class="num" id="2195071">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195076">z</span>&nbsp;<span class="op" id="2195078">=</span>&nbsp;<span class="ident" id="2195080">q</span>&nbsp;<span class="op" id="2195082">-</span>&nbsp;<span class="ident" id="2195084">p</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195092">z</span>&nbsp;<span class="op" id="2195094">=</span>&nbsp;<span class="ident" id="2195096">q</span>&nbsp;<span class="op" id="2195098">*</span>&nbsp;<span class="ident" id="2195100">Sin</span><span class="op" id="2195103">(</span><span class="ident" id="2195104">Pi</span><span class="op" id="2195106">*</span><span class="ident" id="2195107">z</span><span class="op" id="2195108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195112">if</span>&nbsp;<span class="ident" id="2195115">z</span>&nbsp;<span class="op" id="2195117">==</span>&nbsp;<span class="num" id="2195120">0</span>&nbsp;<span class="op" id="2195122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195127">return</span>&nbsp;<span class="ident" id="2195134">Inf</span><span class="op" id="2195137">(</span><span class="ident" id="2195138">signgam</span><span class="op" id="2195145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195149">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195153">z</span>&nbsp;<span class="op" id="2195155">=</span>&nbsp;<span class="ident" id="2195157">Pi</span>&nbsp;<span class="op" id="2195160">/</span>&nbsp;<span class="op" id="2195162">(</span><span class="ident" id="2195163">Abs</span><span class="op" id="2195166">(</span><span class="ident" id="2195167">z</span><span class="op" id="2195168">)</span>&nbsp;<span class="op" id="2195170">*</span>&nbsp;<span class="ident" id="2195172">stirling</span><span class="op" id="2195180">(</span><span class="ident" id="2195181">q</span><span class="op" id="2195182">)</span><span class="op" id="2195183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195187">return</span>&nbsp;<span class="builtintype" id="2195194">float64</span><span class="op" id="2195201">(</span><span class="ident" id="2195202">signgam</span><span class="op" id="2195209">)</span>&nbsp;<span class="op" id="2195211">*</span>&nbsp;<span class="ident" id="2195213">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2195220">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195240">z</span>&nbsp;<span class="op" id="2195242">:=</span>&nbsp;<span class="num" id="2195245">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195250">for</span>&nbsp;<span class="ident" id="2195254">x</span>&nbsp;<span class="op" id="2195256">&gt;=</span>&nbsp;<span class="num" id="2195259">3</span>&nbsp;<span class="op" id="2195261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195265">x</span>&nbsp;<span class="op" id="2195267">=</span>&nbsp;<span class="ident" id="2195269">x</span>&nbsp;<span class="op" id="2195271">-</span>&nbsp;<span class="num" id="2195273">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195277">z</span>&nbsp;<span class="op" id="2195279">=</span>&nbsp;<span class="ident" id="2195281">z</span>&nbsp;<span class="op" id="2195283">*</span>&nbsp;<span class="ident" id="2195285">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195288">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195291">for</span>&nbsp;<span class="ident" id="2195295">x</span>&nbsp;<span class="op" id="2195297">&lt;</span>&nbsp;<span class="num" id="2195299">0</span>&nbsp;<span class="op" id="2195301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195305">if</span>&nbsp;<span class="ident" id="2195308">x</span>&nbsp;<span class="op" id="2195310">&gt;</span>&nbsp;<span class="op" id="2195312">-</span><span class="num" id="2195313">1e-09</span>&nbsp;<span class="op" id="2195319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195324">goto</span>&nbsp;<span class="ident" id="2195329">small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195341">z</span>&nbsp;<span class="op" id="2195343">=</span>&nbsp;<span class="ident" id="2195345">z</span>&nbsp;<span class="op" id="2195347">/</span>&nbsp;<span class="ident" id="2195349">x</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195353">x</span>&nbsp;<span class="op" id="2195355">=</span>&nbsp;<span class="ident" id="2195357">x</span>&nbsp;<span class="op" id="2195359">+</span>&nbsp;<span class="num" id="2195361">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195367">for</span>&nbsp;<span class="ident" id="2195371">x</span>&nbsp;<span class="op" id="2195373">&lt;</span>&nbsp;<span class="num" id="2195375">2</span>&nbsp;<span class="op" id="2195377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195381">if</span>&nbsp;<span class="ident" id="2195384">x</span>&nbsp;<span class="op" id="2195386">&lt;</span>&nbsp;<span class="num" id="2195388">1e-09</span>&nbsp;<span class="op" id="2195394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195399">goto</span>&nbsp;<span class="ident" id="2195404">small</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195416">z</span>&nbsp;<span class="op" id="2195418">=</span>&nbsp;<span class="ident" id="2195420">z</span>&nbsp;<span class="op" id="2195422">/</span>&nbsp;<span class="ident" id="2195424">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195428">x</span>&nbsp;<span class="op" id="2195430">=</span>&nbsp;<span class="ident" id="2195432">x</span>&nbsp;<span class="op" id="2195434">+</span>&nbsp;<span class="num" id="2195436">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195443">if</span>&nbsp;<span class="ident" id="2195446">x</span>&nbsp;<span class="op" id="2195448">==</span>&nbsp;<span class="num" id="2195451">2</span>&nbsp;<span class="op" id="2195453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195457">return</span>&nbsp;<span class="ident" id="2195464">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195471">x</span>&nbsp;<span class="op" id="2195473">=</span>&nbsp;<span class="ident" id="2195475">x</span>&nbsp;<span class="op" id="2195477">-</span>&nbsp;<span class="num" id="2195479">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195482">p</span>&nbsp;<span class="op" id="2195484">=</span>&nbsp;<span class="op" id="2195486">(</span><span class="op" id="2195487">(</span><span class="op" id="2195488">(</span><span class="op" id="2195489">(</span><span class="op" id="2195490">(</span><span class="ident" id="2195491">x</span><span class="op" id="2195492">*</span><span class="ident" id="2195493">_gamP</span><span class="op" id="2195498">[</span><span class="num" id="2195499">0</span><span class="op" id="2195500">]</span><span class="op" id="2195501">+</span><span class="ident" id="2195502">_gamP</span><span class="op" id="2195507">[</span><span class="num" id="2195508">1</span><span class="op" id="2195509">]</span><span class="op" id="2195510">)</span><span class="op" id="2195511">*</span><span class="ident" id="2195512">x</span><span class="op" id="2195513">+</span><span class="ident" id="2195514">_gamP</span><span class="op" id="2195519">[</span><span class="num" id="2195520">2</span><span class="op" id="2195521">]</span><span class="op" id="2195522">)</span><span class="op" id="2195523">*</span><span class="ident" id="2195524">x</span><span class="op" id="2195525">+</span><span class="ident" id="2195526">_gamP</span><span class="op" id="2195531">[</span><span class="num" id="2195532">3</span><span class="op" id="2195533">]</span><span class="op" id="2195534">)</span><span class="op" id="2195535">*</span><span class="ident" id="2195536">x</span><span class="op" id="2195537">+</span><span class="ident" id="2195538">_gamP</span><span class="op" id="2195543">[</span><span class="num" id="2195544">4</span><span class="op" id="2195545">]</span><span class="op" id="2195546">)</span><span class="op" id="2195547">*</span><span class="ident" id="2195548">x</span><span class="op" id="2195549">+</span><span class="ident" id="2195550">_gamP</span><span class="op" id="2195555">[</span><span class="num" id="2195556">5</span><span class="op" id="2195557">]</span><span class="op" id="2195558">)</span><span class="op" id="2195559">*</span><span class="ident" id="2195560">x</span>&nbsp;<span class="op" id="2195562">+</span>&nbsp;<span class="ident" id="2195564">_gamP</span><span class="op" id="2195569">[</span><span class="num" id="2195570">6</span><span class="op" id="2195571">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195574">q</span>&nbsp;<span class="op" id="2195576">=</span>&nbsp;<span class="op" id="2195578">(</span><span class="op" id="2195579">(</span><span class="op" id="2195580">(</span><span class="op" id="2195581">(</span><span class="op" id="2195582">(</span><span class="op" id="2195583">(</span><span class="ident" id="2195584">x</span><span class="op" id="2195585">*</span><span class="ident" id="2195586">_gamQ</span><span class="op" id="2195591">[</span><span class="num" id="2195592">0</span><span class="op" id="2195593">]</span><span class="op" id="2195594">+</span><span class="ident" id="2195595">_gamQ</span><span class="op" id="2195600">[</span><span class="num" id="2195601">1</span><span class="op" id="2195602">]</span><span class="op" id="2195603">)</span><span class="op" id="2195604">*</span><span class="ident" id="2195605">x</span><span class="op" id="2195606">+</span><span class="ident" id="2195607">_gamQ</span><span class="op" id="2195612">[</span><span class="num" id="2195613">2</span><span class="op" id="2195614">]</span><span class="op" id="2195615">)</span><span class="op" id="2195616">*</span><span class="ident" id="2195617">x</span><span class="op" id="2195618">+</span><span class="ident" id="2195619">_gamQ</span><span class="op" id="2195624">[</span><span class="num" id="2195625">3</span><span class="op" id="2195626">]</span><span class="op" id="2195627">)</span><span class="op" id="2195628">*</span><span class="ident" id="2195629">x</span><span class="op" id="2195630">+</span><span class="ident" id="2195631">_gamQ</span><span class="op" id="2195636">[</span><span class="num" id="2195637">4</span><span class="op" id="2195638">]</span><span class="op" id="2195639">)</span><span class="op" id="2195640">*</span><span class="ident" id="2195641">x</span><span class="op" id="2195642">+</span><span class="ident" id="2195643">_gamQ</span><span class="op" id="2195648">[</span><span class="num" id="2195649">5</span><span class="op" id="2195650">]</span><span class="op" id="2195651">)</span><span class="op" id="2195652">*</span><span class="ident" id="2195653">x</span><span class="op" id="2195654">+</span><span class="ident" id="2195655">_gamQ</span><span class="op" id="2195660">[</span><span class="num" id="2195661">6</span><span class="op" id="2195662">]</span><span class="op" id="2195663">)</span><span class="op" id="2195664">*</span><span class="ident" id="2195665">x</span>&nbsp;<span class="op" id="2195667">+</span>&nbsp;<span class="ident" id="2195669">_gamQ</span><span class="op" id="2195674">[</span><span class="num" id="2195675">7</span><span class="op" id="2195676">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195679">return</span>&nbsp;<span class="ident" id="2195686">z</span>&nbsp;<span class="op" id="2195688">*</span>&nbsp;<span class="ident" id="2195690">p</span>&nbsp;<span class="op" id="2195692">/</span>&nbsp;<span class="ident" id="2195694">q</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="2195697">small</span><span class="op" id="2195702">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195705">if</span>&nbsp;<span class="ident" id="2195708">x</span>&nbsp;<span class="op" id="2195710">==</span>&nbsp;<span class="num" id="2195713">0</span>&nbsp;<span class="op" id="2195715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195719">return</span>&nbsp;<span class="ident" id="2195726">Inf</span><span class="op" id="2195729">(</span><span class="num" id="2195730">1</span><span class="op" id="2195731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195737">return</span>&nbsp;<span class="ident" id="2195744">z</span>&nbsp;<span class="op" id="2195746">/</span>&nbsp;<span class="op" id="2195748">(</span><span class="op" id="2195749">(</span><span class="num" id="2195750">1</span>&nbsp;<span class="op" id="2195752">+</span>&nbsp;<span class="ident" id="2195754">Euler</span><span class="op" id="2195759">*</span><span class="ident" id="2195760">x</span><span class="op" id="2195761">)</span>&nbsp;<span class="op" id="2195763">*</span>&nbsp;<span class="ident" id="2195765">x</span><span class="op" id="2195766">)</span><br>
<span class="lineno"></span><span class="op" id="2195768">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="2195771">func</span>&nbsp;<span class="ident" id="2195776">isNegInt</span><span class="op" id="2195784">(</span><span class="ident" id="2195785">x</span>&nbsp;<span class="builtintype" id="2195787">float64</span><span class="op" id="2195794">)</span>&nbsp;<span class="builtintype" id="2195796">bool</span>&nbsp;<span class="op" id="2195801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195804">if</span>&nbsp;<span class="ident" id="2195807">x</span>&nbsp;<span class="op" id="2195809">&lt;</span>&nbsp;<span class="num" id="2195811">0</span>&nbsp;<span class="op" id="2195813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195817">_</span><span class="op" id="2195818">,</span>&nbsp;<span class="ident" id="2195820">xf</span>&nbsp;<span class="op" id="2195823">:=</span>&nbsp;<span class="ident" id="2195826">Modf</span><span class="op" id="2195830">(</span><span class="ident" id="2195831">x</span><span class="op" id="2195832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195836">return</span>&nbsp;<span class="ident" id="2195843">xf</span>&nbsp;<span class="op" id="2195846">==</span>&nbsp;<span class="num" id="2195849">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195855">return</span>&nbsp;<span class="builtintype" id="2195862">false</span><br>
<span class="lineno"></span><span class="op" id="2195868">}</span>
</div>
</body>
</html>
