<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6364973">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6365028">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6365082">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6365133">package</span>&nbsp;<span class="ident" id="6365141">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6365148">import</span>&nbsp;<span class="string" id="6365155">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6365163">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="6365223">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="6365293">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="6365351">//</span><br>
<span class="lineno"></span><span class="comment" id="6365354">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="6365402">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="6365466">//</span><br>
<span class="lineno"></span><span class="comment" id="6365469">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="6365530">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6365600">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="6365675">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6365742">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="6365815">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6365887">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="6365901">//</span><br>
<span class="lineno"></span><span class="comment" id="6365904">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="6365970">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="6366036">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="6366049">//</span><br>
<span class="lineno"></span><span class="comment" id="6366052">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="6366076">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6366106">//&nbsp;Complex&nbsp;square&nbsp;root</span><br>
<span class="lineno"></span><span class="comment" id="6366129">//</span><br>
<span class="lineno"></span><span class="comment" id="6366132">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6366148">//</span><br>
<span class="lineno">35</span><span class="comment" id="6366151">//&nbsp;If&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,&nbsp;&nbsp;r&nbsp;=&nbsp;|z|,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6366184">//</span><br>
<span class="lineno"></span><span class="comment" id="6366187">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="6366216">//&nbsp;Re&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;+&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;,</span><br>
<span class="lineno"></span><span class="comment" id="6366246">//</span><br>
<span class="lineno">40</span><span class="comment" id="6366249">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="6366278">//&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;-&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="6366308">//</span><br>
<span class="lineno"></span><span class="comment" id="6366311">//&nbsp;Cancellation&nbsp;error&nbsp;in&nbsp;r-x&nbsp;or&nbsp;r+x&nbsp;is&nbsp;avoided&nbsp;by&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6366371">//&nbsp;identity&nbsp;&nbsp;2&nbsp;Re&nbsp;w&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;y.</span><br>
<span class="lineno">45</span><span class="comment" id="6366403">//</span><br>
<span class="lineno"></span><span class="comment" id="6366406">//&nbsp;Note&nbsp;that&nbsp;-w&nbsp;is&nbsp;also&nbsp;a&nbsp;square&nbsp;root&nbsp;of&nbsp;z.&nbsp;&nbsp;The&nbsp;root&nbsp;chosen</span><br>
<span class="lineno"></span><span class="comment" id="6366467">//&nbsp;is&nbsp;always&nbsp;in&nbsp;the&nbsp;right&nbsp;half&nbsp;plane&nbsp;and&nbsp;Im&nbsp;w&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;y.</span><br>
<span class="lineno"></span><span class="comment" id="6366537">//</span><br>
<span class="lineno"></span><span class="comment" id="6366540">//&nbsp;ACCURACY:</span><br>
<span class="lineno">50</span><span class="comment" id="6366553">//</span><br>
<span class="lineno"></span><span class="comment" id="6366556">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6366596">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="6366654">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.6e-18</span><br>
<span class="lineno"></span><span class="comment" id="6366714">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;1,000,000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.9e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.1e-17</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="6366775">//&nbsp;Sqrt&nbsp;returns&nbsp;the&nbsp;square&nbsp;root&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="6366813">//&nbsp;The&nbsp;result&nbsp;r&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;real(r)&nbsp;â‰¥&nbsp;0&nbsp;and&nbsp;imag(r)&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;imag(x).</span><br>
<span class="lineno"></span><span class="keyword" id="6366903">func</span>&nbsp;<span class="ident" id="6366908">Sqrt</span><span class="op" id="6366912">(</span><span class="ident" id="6366913">x</span>&nbsp;<span class="builtintype" id="6366915">complex128</span><span class="op" id="6366925">)</span>&nbsp;<span class="builtintype" id="6366927">complex128</span>&nbsp;<span class="op" id="6366938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6366941">if</span>&nbsp;<span class="builtinfunc" id="6366944">imag</span><span class="op" id="6366948">(</span><span class="ident" id="6366949">x</span><span class="op" id="6366950">)</span>&nbsp;<span class="op" id="6366952">==</span>&nbsp;<span class="num" id="6366955">0</span>&nbsp;<span class="op" id="6366957">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6366961">if</span>&nbsp;<span class="builtinfunc" id="6366964">real</span><span class="op" id="6366968">(</span><span class="ident" id="6366969">x</span><span class="op" id="6366970">)</span>&nbsp;<span class="op" id="6366972">==</span>&nbsp;<span class="num" id="6366975">0</span>&nbsp;<span class="op" id="6366977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6366982">return</span>&nbsp;<span class="builtinfunc" id="6366989">complex</span><span class="op" id="6366996">(</span><span class="num" id="6366997">0</span><span class="op" id="6366998">,</span>&nbsp;<span class="num" id="6367000">0</span><span class="op" id="6367001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6367005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367009">if</span>&nbsp;<span class="builtinfunc" id="6367012">real</span><span class="op" id="6367016">(</span><span class="ident" id="6367017">x</span><span class="op" id="6367018">)</span>&nbsp;<span class="op" id="6367020">&lt;</span>&nbsp;<span class="num" id="6367022">0</span>&nbsp;<span class="op" id="6367024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367029">return</span>&nbsp;<span class="builtinfunc" id="6367036">complex</span><span class="op" id="6367043">(</span><span class="num" id="6367044">0</span><span class="op" id="6367045">,</span>&nbsp;<span class="ident" id="6367047">math</span><span class="op" id="6367051">.</span><span class="ident" id="6367052">Sqrt</span><span class="op" id="6367056">(</span><span class="op" id="6367057">-</span><span class="builtinfunc" id="6367058">real</span><span class="op" id="6367062">(</span><span class="ident" id="6367063">x</span><span class="op" id="6367064">)</span><span class="op" id="6367065">)</span><span class="op" id="6367066">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6367070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367074">return</span>&nbsp;<span class="builtinfunc" id="6367081">complex</span><span class="op" id="6367088">(</span><span class="ident" id="6367089">math</span><span class="op" id="6367093">.</span><span class="ident" id="6367094">Sqrt</span><span class="op" id="6367098">(</span><span class="builtinfunc" id="6367099">real</span><span class="op" id="6367103">(</span><span class="ident" id="6367104">x</span><span class="op" id="6367105">)</span><span class="op" id="6367106">)</span><span class="op" id="6367107">,</span>&nbsp;<span class="num" id="6367109">0</span><span class="op" id="6367110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6367113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367116">if</span>&nbsp;<span class="builtinfunc" id="6367119">real</span><span class="op" id="6367123">(</span><span class="ident" id="6367124">x</span><span class="op" id="6367125">)</span>&nbsp;<span class="op" id="6367127">==</span>&nbsp;<span class="num" id="6367130">0</span>&nbsp;<span class="op" id="6367132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367136">if</span>&nbsp;<span class="builtinfunc" id="6367139">imag</span><span class="op" id="6367143">(</span><span class="ident" id="6367144">x</span><span class="op" id="6367145">)</span>&nbsp;<span class="op" id="6367147">&lt;</span>&nbsp;<span class="num" id="6367149">0</span>&nbsp;<span class="op" id="6367151">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367156">r</span>&nbsp;<span class="op" id="6367158">:=</span>&nbsp;<span class="ident" id="6367161">math</span><span class="op" id="6367165">.</span><span class="ident" id="6367166">Sqrt</span><span class="op" id="6367170">(</span><span class="op" id="6367171">-</span><span class="num" id="6367172">0.5</span>&nbsp;<span class="op" id="6367176">*</span>&nbsp;<span class="builtinfunc" id="6367178">imag</span><span class="op" id="6367182">(</span><span class="ident" id="6367183">x</span><span class="op" id="6367184">)</span><span class="op" id="6367185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367190">return</span>&nbsp;<span class="builtinfunc" id="6367197">complex</span><span class="op" id="6367204">(</span><span class="ident" id="6367205">r</span><span class="op" id="6367206">,</span>&nbsp;<span class="op" id="6367208">-</span><span class="ident" id="6367209">r</span><span class="op" id="6367210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6367214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367218">r</span>&nbsp;<span class="op" id="6367220">:=</span>&nbsp;<span class="ident" id="6367223">math</span><span class="op" id="6367227">.</span><span class="ident" id="6367228">Sqrt</span><span class="op" id="6367232">(</span><span class="num" id="6367233">0.5</span>&nbsp;<span class="op" id="6367237">*</span>&nbsp;<span class="builtinfunc" id="6367239">imag</span><span class="op" id="6367243">(</span><span class="ident" id="6367244">x</span><span class="op" id="6367245">)</span><span class="op" id="6367246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367250">return</span>&nbsp;<span class="builtinfunc" id="6367257">complex</span><span class="op" id="6367264">(</span><span class="ident" id="6367265">r</span><span class="op" id="6367266">,</span>&nbsp;<span class="ident" id="6367268">r</span><span class="op" id="6367269">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6367272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367275">a</span>&nbsp;<span class="op" id="6367277">:=</span>&nbsp;<span class="builtinfunc" id="6367280">real</span><span class="op" id="6367284">(</span><span class="ident" id="6367285">x</span><span class="op" id="6367286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367289">b</span>&nbsp;<span class="op" id="6367291">:=</span>&nbsp;<span class="builtinfunc" id="6367294">imag</span><span class="op" id="6367298">(</span><span class="ident" id="6367299">x</span><span class="op" id="6367300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367303">var</span>&nbsp;<span class="ident" id="6367307">scale</span>&nbsp;<span class="builtintype" id="6367313">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6367322">//&nbsp;Rescale&nbsp;to&nbsp;avoid&nbsp;internal&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367375">if</span>&nbsp;<span class="ident" id="6367378">math</span><span class="op" id="6367382">.</span><span class="ident" id="6367383">Abs</span><span class="op" id="6367386">(</span><span class="ident" id="6367387">a</span><span class="op" id="6367388">)</span>&nbsp;<span class="op" id="6367390">&gt;</span>&nbsp;<span class="num" id="6367392">4</span>&nbsp;<span class="op" id="6367394">||</span>&nbsp;<span class="ident" id="6367397">math</span><span class="op" id="6367401">.</span><span class="ident" id="6367402">Abs</span><span class="op" id="6367405">(</span><span class="ident" id="6367406">b</span><span class="op" id="6367407">)</span>&nbsp;<span class="op" id="6367409">&gt;</span>&nbsp;<span class="num" id="6367411">4</span>&nbsp;<span class="op" id="6367413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367417">a</span>&nbsp;<span class="op" id="6367419">*=</span>&nbsp;<span class="num" id="6367422">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367429">b</span>&nbsp;<span class="op" id="6367431">*=</span>&nbsp;<span class="num" id="6367434">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367441">scale</span>&nbsp;<span class="op" id="6367447">=</span>&nbsp;<span class="num" id="6367449">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6367452">}</span>&nbsp;<span class="keyword" id="6367454">else</span>&nbsp;<span class="op" id="6367459">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367463">a</span>&nbsp;<span class="op" id="6367465">*=</span>&nbsp;<span class="num" id="6367468">1.8014398509481984e16</span>&nbsp;<span class="comment" id="6367490">//&nbsp;2**54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367501">b</span>&nbsp;<span class="op" id="6367503">*=</span>&nbsp;<span class="num" id="6367506">1.8014398509481984e16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367530">scale</span>&nbsp;<span class="op" id="6367536">=</span>&nbsp;<span class="num" id="6367538">7.450580596923828125e-9</span>&nbsp;<span class="comment" id="6367562">//&nbsp;2**-27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6367573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367576">r</span>&nbsp;<span class="op" id="6367578">:=</span>&nbsp;<span class="ident" id="6367581">math</span><span class="op" id="6367585">.</span><span class="ident" id="6367586">Hypot</span><span class="op" id="6367591">(</span><span class="ident" id="6367592">a</span><span class="op" id="6367593">,</span>&nbsp;<span class="ident" id="6367595">b</span><span class="op" id="6367596">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367599">var</span>&nbsp;<span class="ident" id="6367603">t</span>&nbsp;<span class="builtintype" id="6367605">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367614">if</span>&nbsp;<span class="ident" id="6367617">a</span>&nbsp;<span class="op" id="6367619">&gt;</span>&nbsp;<span class="num" id="6367621">0</span>&nbsp;<span class="op" id="6367623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367627">t</span>&nbsp;<span class="op" id="6367629">=</span>&nbsp;<span class="ident" id="6367631">math</span><span class="op" id="6367635">.</span><span class="ident" id="6367636">Sqrt</span><span class="op" id="6367640">(</span><span class="num" id="6367641">0.5</span><span class="op" id="6367644">*</span><span class="ident" id="6367645">r</span>&nbsp;<span class="op" id="6367647">+</span>&nbsp;<span class="num" id="6367649">0.5</span><span class="op" id="6367652">*</span><span class="ident" id="6367653">a</span><span class="op" id="6367654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367658">r</span>&nbsp;<span class="op" id="6367660">=</span>&nbsp;<span class="ident" id="6367662">scale</span>&nbsp;<span class="op" id="6367668">*</span>&nbsp;<span class="ident" id="6367670">math</span><span class="op" id="6367674">.</span><span class="ident" id="6367675">Abs</span><span class="op" id="6367678">(</span><span class="op" id="6367679">(</span><span class="num" id="6367680">0.5</span><span class="op" id="6367683">*</span><span class="ident" id="6367684">b</span><span class="op" id="6367685">)</span><span class="op" id="6367686">/</span><span class="ident" id="6367687">t</span><span class="op" id="6367688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367692">t</span>&nbsp;<span class="op" id="6367694">*=</span>&nbsp;<span class="ident" id="6367697">scale</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6367704">}</span>&nbsp;<span class="keyword" id="6367706">else</span>&nbsp;<span class="op" id="6367711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367715">r</span>&nbsp;<span class="op" id="6367717">=</span>&nbsp;<span class="ident" id="6367719">math</span><span class="op" id="6367723">.</span><span class="ident" id="6367724">Sqrt</span><span class="op" id="6367728">(</span><span class="num" id="6367729">0.5</span><span class="op" id="6367732">*</span><span class="ident" id="6367733">r</span>&nbsp;<span class="op" id="6367735">-</span>&nbsp;<span class="num" id="6367737">0.5</span><span class="op" id="6367740">*</span><span class="ident" id="6367741">a</span><span class="op" id="6367742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367746">t</span>&nbsp;<span class="op" id="6367748">=</span>&nbsp;<span class="ident" id="6367750">scale</span>&nbsp;<span class="op" id="6367756">*</span>&nbsp;<span class="ident" id="6367758">math</span><span class="op" id="6367762">.</span><span class="ident" id="6367763">Abs</span><span class="op" id="6367766">(</span><span class="op" id="6367767">(</span><span class="num" id="6367768">0.5</span><span class="op" id="6367771">*</span><span class="ident" id="6367772">b</span><span class="op" id="6367773">)</span><span class="op" id="6367774">/</span><span class="ident" id="6367775">r</span><span class="op" id="6367776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6367780">r</span>&nbsp;<span class="op" id="6367782">*=</span>&nbsp;<span class="ident" id="6367785">scale</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6367792">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367795">if</span>&nbsp;<span class="ident" id="6367798">b</span>&nbsp;<span class="op" id="6367800">&lt;</span>&nbsp;<span class="num" id="6367802">0</span>&nbsp;<span class="op" id="6367804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367808">return</span>&nbsp;<span class="builtinfunc" id="6367815">complex</span><span class="op" id="6367822">(</span><span class="ident" id="6367823">t</span><span class="op" id="6367824">,</span>&nbsp;<span class="op" id="6367826">-</span><span class="ident" id="6367827">r</span><span class="op" id="6367828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6367831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6367834">return</span>&nbsp;<span class="builtinfunc" id="6367841">complex</span><span class="op" id="6367848">(</span><span class="ident" id="6367849">t</span><span class="op" id="6367850">,</span>&nbsp;<span class="ident" id="6367852">r</span><span class="op" id="6367853">)</span><br>
<span class="lineno"></span><span class="op" id="6367855">}</span>
</div>
</body>
</html>
