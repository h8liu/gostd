<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/rpc/jsonrpc</h2>
<ul>
<li><a href="/gostd/net/rpc/jsonrpc/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/net/rpc/jsonrpc/client.go.html">client.go</a></li>
<li><a href="/gostd/net/rpc/jsonrpc/server.go.html" class="current">server.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6143324">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6143380">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6143434">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6143485">package</span>&nbsp;<span class="ident" id="6143493">jsonrpc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6143502">import</span>&nbsp;<span class="op" id="6143509">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6143512">&#34;encoding/json&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6143529">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6143539">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6143545">&#34;net/rpc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6143556">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="6143563">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="6143566">var</span>&nbsp;<span class="ident" id="6143570">errMissingParams</span>&nbsp;<span class="op" id="6143587">=</span>&nbsp;<span class="ident" id="6143589"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143529">errors</a></span><span class="op" id="6143595">.</span><span class="ident" id="6143596"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6143599">(</span><span class="string" id="6143600">&#34;jsonrpc:&nbsp;request&nbsp;body&nbsp;missing&nbsp;params&#34;</span><span class="op" id="6143638">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6143641">type</span>&nbsp;<span class="ident" id="6143646">serverCodec</span>&nbsp;<span class="keyword" id="6143658">struct</span>&nbsp;<span class="op" id="6143665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6143668">dec</span>&nbsp;<span class="op" id="6143672">*</span><span class="ident" id="6143673"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143512">json</a></span><span class="op" id="6143677">.</span><span class="ident" id="6143678"><a href="/gostd/encoding/json/stream.go.html#4044186">Decoder</a></span>&nbsp;<span class="comment" id="6143686">//&nbsp;for&nbsp;reading&nbsp;JSON&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6143714">enc</span>&nbsp;<span class="op" id="6143718">*</span><span class="ident" id="6143719"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143512">json</a></span><span class="op" id="6143723">.</span><span class="ident" id="6143724"><a href="/gostd/encoding/json/stream.go.html#4047236">Encoder</a></span>&nbsp;<span class="comment" id="6143732">//&nbsp;for&nbsp;writing&nbsp;JSON&nbsp;values</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6143760">c</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6143764"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143539">io</a></span><span class="op" id="6143766">.</span><span class="ident" id="6143767"><a href="/gostd/io/io.go.html#1422563">Closer</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6143776">//&nbsp;temporary&nbsp;work&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6143801">req</span>&nbsp;<span class="ident" id="6143805"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144550">serverRequest</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6143821">//&nbsp;JSON-RPC&nbsp;clients&nbsp;can&nbsp;use&nbsp;arbitrary&nbsp;json&nbsp;values&nbsp;as&nbsp;request&nbsp;IDs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6143888">//&nbsp;Package&nbsp;rpc&nbsp;expects&nbsp;uint64&nbsp;request&nbsp;IDs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6143932">//&nbsp;We&nbsp;assign&nbsp;uint64&nbsp;sequence&nbsp;numbers&nbsp;to&nbsp;incoming&nbsp;requests</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6143991">//&nbsp;but&nbsp;save&nbsp;the&nbsp;original&nbsp;request&nbsp;ID&nbsp;in&nbsp;the&nbsp;pending&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6144048">//&nbsp;When&nbsp;rpc&nbsp;responds,&nbsp;we&nbsp;use&nbsp;the&nbsp;sequence&nbsp;number&nbsp;in</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6144101">//&nbsp;the&nbsp;response&nbsp;to&nbsp;find&nbsp;the&nbsp;original&nbsp;request&nbsp;ID.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144151">mutex</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6144159"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143556">sync</a></span><span class="op" id="6144163">.</span><span class="ident" id="6144164"><a href="/gostd/sync/mutex.go.html#1443974">Mutex</a></span>&nbsp;<span class="comment" id="6144170">//&nbsp;protects&nbsp;seq,&nbsp;pending</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144196">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6144204">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144212">pending</span>&nbsp;<span class="keyword" id="6144220">map</span><span class="op" id="6144223">[</span><span class="builtintype" id="6144224">uint64</span><span class="op" id="6144230">]</span><span class="op" id="6144231">*</span><span class="ident" id="6144232"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143512">json</a></span><span class="op" id="6144236">.</span><span class="ident" id="6144237"><a href="/gostd/encoding/json/stream.go.html#4048300">RawMessage</a></span><br>
<span class="lineno"></span><span class="op" id="6144248">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="6144251">//&nbsp;NewServerCodec&nbsp;returns&nbsp;a&nbsp;new&nbsp;rpc.ServerCodec&nbsp;using&nbsp;JSON-RPC&nbsp;on&nbsp;conn.</span><br>
<span class="lineno"></span><span class="keyword" id="6144323">func</span>&nbsp;<span class="ident" id="6144328">NewServerCodec</span><span class="op" id="6144342">(</span><span class="ident" id="6144343">conn</span>&nbsp;<span class="ident" id="6144348"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143539">io</a></span><span class="op" id="6144350">.</span><span class="ident" id="6144351"><a href="/gostd/io/io.go.html#1423677">ReadWriteCloser</a></span><span class="op" id="6144366">)</span>&nbsp;<span class="ident" id="6144368"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143545">rpc</a></span><span class="op" id="6144371">.</span><span class="ident" id="6144372"><a href="/gostd/net/rpc/server.go.html#5291284">ServerCodec</a></span>&nbsp;<span class="op" id="6144384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6144387">return</span>&nbsp;<span class="op" id="6144394">&amp;</span><span class="ident" id="6144395"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143646">serverCodec</a></span><span class="op" id="6144406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144410"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143668">dec</a></span><span class="op" id="6144413">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144419"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143512">json</a></span><span class="op" id="6144423">.</span><span class="ident" id="6144424"><a href="/gostd/encoding/json/stream.go.html#4044448">NewDecoder</a></span><span class="op" id="6144434">(</span><span class="ident" id="6144435"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144343">conn</a></span><span class="op" id="6144439">)</span><span class="op" id="6144440">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144444"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143714">enc</a></span><span class="op" id="6144447">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144453"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143512">json</a></span><span class="op" id="6144457">.</span><span class="ident" id="6144458"><a href="/gostd/encoding/json/stream.go.html#4047341">NewEncoder</a></span><span class="op" id="6144468">(</span><span class="ident" id="6144469"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144343">conn</a></span><span class="op" id="6144473">)</span><span class="op" id="6144474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144478"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143760">c</a></span><span class="op" id="6144479">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144487"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144343">conn</a></span><span class="op" id="6144491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144495"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144212">pending</a></span><span class="op" id="6144502">:</span>&nbsp;<span class="builtinfunc" id="6144504">make</span><span class="op" id="6144508">(</span><span class="keyword" id="6144509">map</span><span class="op" id="6144512">[</span><span class="builtintype" id="6144513">uint64</span><span class="op" id="6144519">]</span><span class="op" id="6144520">*</span><span class="ident" id="6144521"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143512">json</a></span><span class="op" id="6144525">.</span><span class="ident" id="6144526"><a href="/gostd/encoding/json/stream.go.html#4048300">RawMessage</a></span><span class="op" id="6144536">)</span><span class="op" id="6144537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6144540">}</span><br>
<span class="lineno"></span><span class="op" id="6144542">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6144545">type</span>&nbsp;<span class="ident" id="6144550">serverRequest</span>&nbsp;<span class="keyword" id="6144564">struct</span>&nbsp;<span class="op" id="6144571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144574">Method</span>&nbsp;<span class="builtintype" id="6144581">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6144598">`json:&#34;method&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144615">Params</span>&nbsp;<span class="op" id="6144622">*</span><span class="ident" id="6144623"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143512">json</a></span><span class="op" id="6144627">.</span><span class="ident" id="6144628"><a href="/gostd/encoding/json/stream.go.html#4048300">RawMessage</a></span>&nbsp;<span class="string" id="6144639">`json:&#34;params&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144656">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6144663">*</span><span class="ident" id="6144664"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143512">json</a></span><span class="op" id="6144668">.</span><span class="ident" id="6144669"><a href="/gostd/encoding/json/stream.go.html#4048300">RawMessage</a></span>&nbsp;<span class="string" id="6144680">`json:&#34;id&#34;`</span><br>
<span class="lineno">50</span><span class="op" id="6144692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6144695">func</span>&nbsp;<span class="op" id="6144700">(</span><span class="ident" id="6144701">r</span>&nbsp;<span class="op" id="6144703">*</span><span class="ident" id="6144704"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144550">serverRequest</a></span><span class="op" id="6144717">)</span>&nbsp;<span class="ident" id="6144719">reset</span><span class="op" id="6144724">(</span><span class="op" id="6144725">)</span>&nbsp;<span class="op" id="6144727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144730"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144701">r</a></span><span class="op" id="6144731">.</span><span class="ident" id="6144732"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144574">Method</a></span>&nbsp;<span class="op" id="6144739">=</span>&nbsp;<span class="string" id="6144741">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144745"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144701">r</a></span><span class="op" id="6144746">.</span><span class="ident" id="6144747"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144615">Params</a></span>&nbsp;<span class="op" id="6144754">=</span>&nbsp;<span class="builtintype" id="6144756">nil</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144761"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144701">r</a></span><span class="op" id="6144762">.</span><span class="ident" id="6144763"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144656">Id</a></span>&nbsp;<span class="op" id="6144766">=</span>&nbsp;<span class="builtintype" id="6144768">nil</span><br>
<span class="lineno"></span><span class="op" id="6144772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6144775">type</span>&nbsp;<span class="ident" id="6144780">serverResponse</span>&nbsp;<span class="keyword" id="6144795">struct</span>&nbsp;<span class="op" id="6144802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144805">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6144812">*</span><span class="ident" id="6144813"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143512">json</a></span><span class="op" id="6144817">.</span><span class="ident" id="6144818"><a href="/gostd/encoding/json/stream.go.html#4048300">RawMessage</a></span>&nbsp;<span class="string" id="6144829">`json:&#34;id&#34;`</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144842">Result</span>&nbsp;<span class="keyword" id="6144849">interface</span><span class="op" id="6144858">{</span><span class="op" id="6144859">}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6144866">`json:&#34;result&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144883">Error</span>&nbsp;&nbsp;<span class="keyword" id="6144890">interface</span><span class="op" id="6144899">{</span><span class="op" id="6144900">}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6144907">`json:&#34;error&#34;`</span><br>
<span class="lineno"></span><span class="op" id="6144922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6144925">func</span>&nbsp;<span class="op" id="6144930">(</span><span class="ident" id="6144931">c</span>&nbsp;<span class="op" id="6144933">*</span><span class="ident" id="6144934"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143646">serverCodec</a></span><span class="op" id="6144945">)</span>&nbsp;<span class="ident" id="6144947">ReadRequestHeader</span><span class="op" id="6144964">(</span><span class="ident" id="6144965">r</span>&nbsp;<span class="op" id="6144967">*</span><span class="ident" id="6144968"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143545">rpc</a></span><span class="op" id="6144971">.</span><span class="ident" id="6144972"><a href="/gostd/net/rpc/server.go.html#5277366">Request</a></span><span class="op" id="6144979">)</span>&nbsp;<span class="builtintype" id="6144981">error</span>&nbsp;<span class="op" id="6144987">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6144990"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144931">c</a></span><span class="op" id="6144991">.</span><span class="ident" id="6144992"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143801">req</a></span><span class="op" id="6144995">.</span><span class="ident" id="6144996"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144719">reset</a></span><span class="op" id="6145001">(</span><span class="op" id="6145002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6145005">if</span>&nbsp;<span class="ident" id="6145008">err</span>&nbsp;<span class="op" id="6145012">:=</span>&nbsp;<span class="ident" id="6145015"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144931">c</a></span><span class="op" id="6145016">.</span><span class="ident" id="6145017"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143668">dec</a></span><span class="op" id="6145020">.</span><span class="ident" id="6145021"><a href="/gostd/encoding/json/stream.go.html#4044912">Decode</a></span><span class="op" id="6145027">(</span><span class="op" id="6145028">&amp;</span><span class="ident" id="6145029"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144931">c</a></span><span class="op" id="6145030">.</span><span class="ident" id="6145031"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143801">req</a></span><span class="op" id="6145034">)</span><span class="op" id="6145035">;</span>&nbsp;<span class="ident" id="6145037"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145008">err</a></span>&nbsp;<span class="op" id="6145041">!=</span>&nbsp;<span class="builtintype" id="6145044">nil</span>&nbsp;<span class="op" id="6145048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6145052">return</span>&nbsp;<span class="ident" id="6145059"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145008">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6145064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6145067"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144965">r</a></span><span class="op" id="6145068">.</span><span class="ident" id="6145069"><a href="/gostd/net/rpc/server.go.html#5277384">ServiceMethod</a></span>&nbsp;<span class="op" id="6145083">=</span>&nbsp;<span class="ident" id="6145085"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144931">c</a></span><span class="op" id="6145086">.</span><span class="ident" id="6145087"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143801">req</a></span><span class="op" id="6145090">.</span><span class="ident" id="6145091"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144574">Method</a></span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6145100">//&nbsp;JSON&nbsp;request&nbsp;id&nbsp;can&nbsp;be&nbsp;any&nbsp;JSON&nbsp;value;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6145143">//&nbsp;RPC&nbsp;package&nbsp;expects&nbsp;uint64.&nbsp;&nbsp;Translate&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6145189">//&nbsp;internal&nbsp;uint64&nbsp;and&nbsp;save&nbsp;JSON&nbsp;on&nbsp;the&nbsp;side.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6145236"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144931">c</a></span><span class="op" id="6145237">.</span><span class="ident" id="6145238"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144151">mutex</a></span><span class="op" id="6145243">.</span><span class="ident" id="6145244"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="6145248">(</span><span class="op" id="6145249">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6145252"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144931">c</a></span><span class="op" id="6145253">.</span><span class="ident" id="6145254"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144196">seq</a></span><span class="op" id="6145257">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6145261"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144931">c</a></span><span class="op" id="6145262">.</span><span class="ident" id="6145263"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144212">pending</a></span><span class="op" id="6145270">[</span><span class="ident" id="6145271"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144931">c</a></span><span class="op" id="6145272">.</span><span class="ident" id="6145273"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144196">seq</a></span><span class="op" id="6145276">]</span>&nbsp;<span class="op" id="6145278">=</span>&nbsp;<span class="ident" id="6145280"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144931">c</a></span><span class="op" id="6145281">.</span><span class="ident" id="6145282"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143801">req</a></span><span class="op" id="6145285">.</span><span class="ident" id="6145286"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144656">Id</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6145290"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144931">c</a></span><span class="op" id="6145291">.</span><span class="ident" id="6145292"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143801">req</a></span><span class="op" id="6145295">.</span><span class="ident" id="6145296"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144656">Id</a></span>&nbsp;<span class="op" id="6145299">=</span>&nbsp;<span class="builtintype" id="6145301">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6145306"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144965">r</a></span><span class="op" id="6145307">.</span><span class="ident" id="6145308"><a href="/gostd/net/rpc/server.go.html#5277436">Seq</a></span>&nbsp;<span class="op" id="6145312">=</span>&nbsp;<span class="ident" id="6145314"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144931">c</a></span><span class="op" id="6145315">.</span><span class="ident" id="6145316"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144196">seq</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6145321"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144931">c</a></span><span class="op" id="6145322">.</span><span class="ident" id="6145323"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144151">mutex</a></span><span class="op" id="6145328">.</span><span class="ident" id="6145329"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="6145335">(</span><span class="op" id="6145336">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6145340">return</span>&nbsp;<span class="builtintype" id="6145347">nil</span><br>
<span class="lineno"></span><span class="op" id="6145351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6145354">func</span>&nbsp;<span class="op" id="6145359">(</span><span class="ident" id="6145360">c</span>&nbsp;<span class="op" id="6145362">*</span><span class="ident" id="6145363"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143646">serverCodec</a></span><span class="op" id="6145374">)</span>&nbsp;<span class="ident" id="6145376">ReadRequestBody</span><span class="op" id="6145391">(</span><span class="ident" id="6145392">x</span>&nbsp;<span class="keyword" id="6145394">interface</span><span class="op" id="6145403">{</span><span class="op" id="6145404">}</span><span class="op" id="6145405">)</span>&nbsp;<span class="builtintype" id="6145407">error</span>&nbsp;<span class="op" id="6145413">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6145416">if</span>&nbsp;<span class="ident" id="6145419"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145392">x</a></span>&nbsp;<span class="op" id="6145421">==</span>&nbsp;<span class="builtintype" id="6145424">nil</span>&nbsp;<span class="op" id="6145428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6145432">return</span>&nbsp;<span class="builtintype" id="6145439">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6145444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6145447">if</span>&nbsp;<span class="ident" id="6145450"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145360">c</a></span><span class="op" id="6145451">.</span><span class="ident" id="6145452"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143801">req</a></span><span class="op" id="6145455">.</span><span class="ident" id="6145456"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144615">Params</a></span>&nbsp;<span class="op" id="6145463">==</span>&nbsp;<span class="builtintype" id="6145466">nil</span>&nbsp;<span class="op" id="6145470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6145474">return</span>&nbsp;<span class="ident" id="6145481"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143570">errMissingParams</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6145499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6145502">//&nbsp;JSON&nbsp;params&nbsp;is&nbsp;array&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6145534">//&nbsp;RPC&nbsp;params&nbsp;is&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6145560">//&nbsp;Unmarshal&nbsp;into&nbsp;array&nbsp;containing&nbsp;struct&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6145612">//&nbsp;Should&nbsp;think&nbsp;about&nbsp;making&nbsp;RPC&nbsp;more&nbsp;general.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6145660">var</span>&nbsp;<span class="ident" id="6145664">params</span>&nbsp;<span class="op" id="6145671">[</span><span class="num" id="6145672">1</span><span class="op" id="6145673">]</span><span class="keyword" id="6145674">interface</span><span class="op" id="6145683">{</span><span class="op" id="6145684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6145687"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145664">params</a></span><span class="op" id="6145693">[</span><span class="num" id="6145694">0</span><span class="op" id="6145695">]</span>&nbsp;<span class="op" id="6145697">=</span>&nbsp;<span class="ident" id="6145699"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145392">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6145702">return</span>&nbsp;<span class="ident" id="6145709"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143512">json</a></span><span class="op" id="6145713">.</span><span class="ident" id="6145714"><a href="/gostd/encoding/json/decode.go.html#3965482">Unmarshal</a></span><span class="op" id="6145723">(</span><span class="op" id="6145724">*</span><span class="ident" id="6145725"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145360">c</a></span><span class="op" id="6145726">.</span><span class="ident" id="6145727"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143801">req</a></span><span class="op" id="6145730">.</span><span class="ident" id="6145731"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144615">Params</a></span><span class="op" id="6145737">,</span>&nbsp;<span class="op" id="6145739">&amp;</span><span class="ident" id="6145740"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145664">params</a></span><span class="op" id="6145746">)</span><br>
<span class="lineno"></span><span class="op" id="6145748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="6145751">var</span>&nbsp;<span class="ident" id="6145755">null</span>&nbsp;<span class="op" id="6145760">=</span>&nbsp;<span class="ident" id="6145762"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143512">json</a></span><span class="op" id="6145766">.</span><span class="ident" id="6145767"><a href="/gostd/encoding/json/stream.go.html#4048300">RawMessage</a></span><span class="op" id="6145777">(</span><span class="op" id="6145778">[</span><span class="op" id="6145779">]</span><span class="builtintype" id="6145780">byte</span><span class="op" id="6145784">(</span><span class="string" id="6145785">&#34;null&#34;</span><span class="op" id="6145791">)</span><span class="op" id="6145792">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6145795">func</span>&nbsp;<span class="op" id="6145800">(</span><span class="ident" id="6145801">c</span>&nbsp;<span class="op" id="6145803">*</span><span class="ident" id="6145804"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143646">serverCodec</a></span><span class="op" id="6145815">)</span>&nbsp;<span class="ident" id="6145817">WriteResponse</span><span class="op" id="6145830">(</span><span class="ident" id="6145831">r</span>&nbsp;<span class="op" id="6145833">*</span><span class="ident" id="6145834"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143545">rpc</a></span><span class="op" id="6145837">.</span><span class="ident" id="6145838"><a href="/gostd/net/rpc/server.go.html#5277724">Response</a></span><span class="op" id="6145846">,</span>&nbsp;<span class="ident" id="6145848">x</span>&nbsp;<span class="keyword" id="6145850">interface</span><span class="op" id="6145859">{</span><span class="op" id="6145860">}</span><span class="op" id="6145861">)</span>&nbsp;<span class="builtintype" id="6145863">error</span>&nbsp;<span class="op" id="6145869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6145872"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145801">c</a></span><span class="op" id="6145873">.</span><span class="ident" id="6145874"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144151">mutex</a></span><span class="op" id="6145879">.</span><span class="ident" id="6145880"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="6145884">(</span><span class="op" id="6145885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6145888">b</span><span class="op" id="6145889">,</span>&nbsp;<span class="ident" id="6145891">ok</span>&nbsp;<span class="op" id="6145894">:=</span>&nbsp;<span class="ident" id="6145897"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145801">c</a></span><span class="op" id="6145898">.</span><span class="ident" id="6145899"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144212">pending</a></span><span class="op" id="6145906">[</span><span class="ident" id="6145907"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145831">r</a></span><span class="op" id="6145908">.</span><span class="ident" id="6145909"><a href="/gostd/net/rpc/server.go.html#5277798">Seq</a></span><span class="op" id="6145912">]</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6145915">if</span>&nbsp;<span class="op" id="6145918">!</span><span class="ident" id="6145919"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145891">ok</a></span>&nbsp;<span class="op" id="6145922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6145926"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145801">c</a></span><span class="op" id="6145927">.</span><span class="ident" id="6145928"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144151">mutex</a></span><span class="op" id="6145933">.</span><span class="ident" id="6145934"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="6145940">(</span><span class="op" id="6145941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6145945">return</span>&nbsp;<span class="ident" id="6145952"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143529">errors</a></span><span class="op" id="6145958">.</span><span class="ident" id="6145959"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6145962">(</span><span class="string" id="6145963">&#34;invalid&nbsp;sequence&nbsp;number&nbsp;in&nbsp;response&#34;</span><span class="op" id="6146000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6146003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6146006">delete</span><span class="op" id="6146012">(</span><span class="ident" id="6146013"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145801">c</a></span><span class="op" id="6146014">.</span><span class="ident" id="6146015"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144212">pending</a></span><span class="op" id="6146022">,</span>&nbsp;<span class="ident" id="6146024"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145831">r</a></span><span class="op" id="6146025">.</span><span class="ident" id="6146026"><a href="/gostd/net/rpc/server.go.html#5277798">Seq</a></span><span class="op" id="6146029">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6146032"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145801">c</a></span><span class="op" id="6146033">.</span><span class="ident" id="6146034"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144151">mutex</a></span><span class="op" id="6146039">.</span><span class="ident" id="6146040"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="6146046">(</span><span class="op" id="6146047">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6146051">if</span>&nbsp;<span class="ident" id="6146054"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145888">b</a></span>&nbsp;<span class="op" id="6146056">==</span>&nbsp;<span class="builtintype" id="6146059">nil</span>&nbsp;<span class="op" id="6146063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6146067">//&nbsp;Invalid&nbsp;request&nbsp;so&nbsp;no&nbsp;id.&nbsp;&nbsp;Use&nbsp;JSON&nbsp;null.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6146114"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145888">b</a></span>&nbsp;<span class="op" id="6146116">=</span>&nbsp;<span class="op" id="6146118">&amp;</span><span class="ident" id="6146119"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145755">null</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6146125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6146128">resp</span>&nbsp;<span class="op" id="6146133">:=</span>&nbsp;<span class="ident" id="6146136"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144780">serverResponse</a></span><span class="op" id="6146150">{</span><span class="ident" id="6146151"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144805">Id</a></span><span class="op" id="6146153">:</span>&nbsp;<span class="ident" id="6146155"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145888">b</a></span><span class="op" id="6146156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6146159">if</span>&nbsp;<span class="ident" id="6146162"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145831">r</a></span><span class="op" id="6146163">.</span><span class="ident" id="6146164"><a href="/gostd/net/rpc/server.go.html#5277853">Error</a></span>&nbsp;<span class="op" id="6146170">==</span>&nbsp;<span class="string" id="6146173">&#34;&#34;</span>&nbsp;<span class="op" id="6146176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6146180"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6146128">resp</a></span><span class="op" id="6146184">.</span><span class="ident" id="6146185"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144842">Result</a></span>&nbsp;<span class="op" id="6146192">=</span>&nbsp;<span class="ident" id="6146194"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145848">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6146197">}</span>&nbsp;<span class="keyword" id="6146199">else</span>&nbsp;<span class="op" id="6146204">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6146208"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6146128">resp</a></span><span class="op" id="6146212">.</span><span class="ident" id="6146213"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144883">Error</a></span>&nbsp;<span class="op" id="6146219">=</span>&nbsp;<span class="ident" id="6146221"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145831">r</a></span><span class="op" id="6146222">.</span><span class="ident" id="6146223"><a href="/gostd/net/rpc/server.go.html#5277853">Error</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6146230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6146233">return</span>&nbsp;<span class="ident" id="6146240"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6145801">c</a></span><span class="op" id="6146241">.</span><span class="ident" id="6146242"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143714">enc</a></span><span class="op" id="6146245">.</span><span class="ident" id="6146246"><a href="/gostd/encoding/json/stream.go.html#4047611">Encode</a></span><span class="op" id="6146252">(</span><span class="ident" id="6146253"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6146128">resp</a></span><span class="op" id="6146257">)</span><br>
<span class="lineno"></span><span class="op" id="6146259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="6146262">func</span>&nbsp;<span class="op" id="6146267">(</span><span class="ident" id="6146268">c</span>&nbsp;<span class="op" id="6146270">*</span><span class="ident" id="6146271"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143646">serverCodec</a></span><span class="op" id="6146282">)</span>&nbsp;<span class="ident" id="6146284">Close</span><span class="op" id="6146289">(</span><span class="op" id="6146290">)</span>&nbsp;<span class="builtintype" id="6146292">error</span>&nbsp;<span class="op" id="6146298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6146301">return</span>&nbsp;<span class="ident" id="6146308"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6146268">c</a></span><span class="op" id="6146309">.</span><span class="ident" id="6146310"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143760">c</a></span><span class="op" id="6146311">.</span><span class="ident" id="6146312"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="6146317">(</span><span class="op" id="6146318">)</span><br>
<span class="lineno"></span><span class="op" id="6146320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6146323">//&nbsp;ServeConn&nbsp;runs&nbsp;the&nbsp;JSON-RPC&nbsp;server&nbsp;on&nbsp;a&nbsp;single&nbsp;connection.</span><br>
<span class="lineno">130</span><span class="comment" id="6146385">//&nbsp;ServeConn&nbsp;blocks,&nbsp;serving&nbsp;the&nbsp;connection&nbsp;until&nbsp;the&nbsp;client&nbsp;hangs&nbsp;up.</span><br>
<span class="lineno"></span><span class="comment" id="6146456">//&nbsp;The&nbsp;caller&nbsp;typically&nbsp;invokes&nbsp;ServeConn&nbsp;in&nbsp;a&nbsp;go&nbsp;statement.</span><br>
<span class="lineno"></span><span class="keyword" id="6146517">func</span>&nbsp;<span class="ident" id="6146522">ServeConn</span><span class="op" id="6146531">(</span><span class="ident" id="6146532">conn</span>&nbsp;<span class="ident" id="6146537"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143539">io</a></span><span class="op" id="6146539">.</span><span class="ident" id="6146540"><a href="/gostd/io/io.go.html#1423677">ReadWriteCloser</a></span><span class="op" id="6146555">)</span>&nbsp;<span class="op" id="6146557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6146560"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6143545">rpc</a></span><span class="op" id="6146563">.</span><span class="ident" id="6146564"><a href="/gostd/net/rpc/server.go.html#5292017">ServeCodec</a></span><span class="op" id="6146574">(</span><span class="ident" id="6146575"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144328">NewServerCodec</a></span><span class="op" id="6146589">(</span><span class="ident" id="6146590"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6146532">conn</a></span><span class="op" id="6146594">)</span><span class="op" id="6146595">)</span><br>
<span class="lineno"></span><span class="op" id="6146597">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
