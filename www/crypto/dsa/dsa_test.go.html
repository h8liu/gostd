<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6861744">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6861799">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6861853">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6861904">package</span>&nbsp;<span class="ident" id="6861912">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6861917">import</span>&nbsp;<span class="op" id="6861924">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861927">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861942">&#34;math/big&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861954">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6861964">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6861967">func</span>&nbsp;<span class="ident" id="6861972">testSignAndVerify</span><span class="op" id="6861989">(</span><span class="ident" id="6861990">t</span>&nbsp;<span class="op" id="6861992">*</span><span class="ident" id="6861993">testing</span><span class="op" id="6862000">.</span><span class="ident" id="6862001">T</span><span class="op" id="6862002">,</span>&nbsp;<span class="ident" id="6862004">i</span>&nbsp;<span class="builtintype" id="6862006">int</span><span class="op" id="6862009">,</span>&nbsp;<span class="ident" id="6862011">priv</span>&nbsp;<span class="op" id="6862016">*</span><span class="ident" id="6862017">PrivateKey</span><span class="op" id="6862027">)</span>&nbsp;<span class="op" id="6862029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862032">hashed</span>&nbsp;<span class="op" id="6862039">:=</span>&nbsp;<span class="op" id="6862042">[</span><span class="op" id="6862043">]</span><span class="builtintype" id="6862044">byte</span><span class="op" id="6862048">(</span><span class="string" id="6862049">&#34;testing&#34;</span><span class="op" id="6862058">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862061">r</span><span class="op" id="6862062">,</span>&nbsp;<span class="ident" id="6862064">s</span><span class="op" id="6862065">,</span>&nbsp;<span class="ident" id="6862067">err</span>&nbsp;<span class="op" id="6862071">:=</span>&nbsp;<span class="ident" id="6862074">Sign</span><span class="op" id="6862078">(</span><span class="ident" id="6862079">rand</span><span class="op" id="6862083">.</span><span class="ident" id="6862084">Reader</span><span class="op" id="6862090">,</span>&nbsp;<span class="ident" id="6862092">priv</span><span class="op" id="6862096">,</span>&nbsp;<span class="ident" id="6862098">hashed</span><span class="op" id="6862104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862107">if</span>&nbsp;<span class="ident" id="6862110">err</span>&nbsp;<span class="op" id="6862114">!=</span>&nbsp;<span class="ident" id="6862117">nil</span>&nbsp;<span class="op" id="6862121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862125">t</span><span class="op" id="6862126">.</span><span class="ident" id="6862127">Errorf</span><span class="op" id="6862133">(</span><span class="string" id="6862134">&#34;%d:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="6862157">,</span>&nbsp;<span class="ident" id="6862159">i</span><span class="op" id="6862160">,</span>&nbsp;<span class="ident" id="6862162">err</span><span class="op" id="6862165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862169">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862177">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862181">if</span>&nbsp;<span class="op" id="6862184">!</span><span class="ident" id="6862185">Verify</span><span class="op" id="6862191">(</span><span class="op" id="6862192">&amp;</span><span class="ident" id="6862193">priv</span><span class="op" id="6862197">.</span><span class="ident" id="6862198">PublicKey</span><span class="op" id="6862207">,</span>&nbsp;<span class="ident" id="6862209">hashed</span><span class="op" id="6862215">,</span>&nbsp;<span class="ident" id="6862217">r</span><span class="op" id="6862218">,</span>&nbsp;<span class="ident" id="6862220">s</span><span class="op" id="6862221">)</span>&nbsp;<span class="op" id="6862223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862227">t</span><span class="op" id="6862228">.</span><span class="ident" id="6862229">Errorf</span><span class="op" id="6862235">(</span><span class="string" id="6862236">&#34;%d:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="6862255">,</span>&nbsp;<span class="ident" id="6862257">i</span><span class="op" id="6862258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862261">}</span><br>
<span class="lineno"></span><span class="op" id="6862263">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6862266">func</span>&nbsp;<span class="ident" id="6862271">testParameterGeneration</span><span class="op" id="6862294">(</span><span class="ident" id="6862295">t</span>&nbsp;<span class="op" id="6862297">*</span><span class="ident" id="6862298">testing</span><span class="op" id="6862305">.</span><span class="ident" id="6862306">T</span><span class="op" id="6862307">,</span>&nbsp;<span class="ident" id="6862309">sizes</span>&nbsp;<span class="ident" id="6862315">ParameterSizes</span><span class="op" id="6862329">,</span>&nbsp;<span class="ident" id="6862331">L</span><span class="op" id="6862332">,</span>&nbsp;<span class="ident" id="6862334">N</span>&nbsp;<span class="builtintype" id="6862336">int</span><span class="op" id="6862339">)</span>&nbsp;<span class="op" id="6862341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862344">var</span>&nbsp;<span class="ident" id="6862348">priv</span>&nbsp;<span class="ident" id="6862353">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862365">params</span>&nbsp;<span class="op" id="6862372">:=</span>&nbsp;<span class="op" id="6862375">&amp;</span><span class="ident" id="6862376">priv</span><span class="op" id="6862380">.</span><span class="ident" id="6862381">Parameters</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862394">err</span>&nbsp;<span class="op" id="6862398">:=</span>&nbsp;<span class="ident" id="6862401">GenerateParameters</span><span class="op" id="6862419">(</span><span class="ident" id="6862420">params</span><span class="op" id="6862426">,</span>&nbsp;<span class="ident" id="6862428">rand</span><span class="op" id="6862432">.</span><span class="ident" id="6862433">Reader</span><span class="op" id="6862439">,</span>&nbsp;<span class="ident" id="6862441">sizes</span><span class="op" id="6862446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862449">if</span>&nbsp;<span class="ident" id="6862452">err</span>&nbsp;<span class="op" id="6862456">!=</span>&nbsp;<span class="ident" id="6862459">nil</span>&nbsp;<span class="op" id="6862463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862467">t</span><span class="op" id="6862468">.</span><span class="ident" id="6862469">Errorf</span><span class="op" id="6862475">(</span><span class="string" id="6862476">&#34;%d:&nbsp;%s&#34;</span><span class="op" id="6862484">,</span>&nbsp;<span class="builtintype" id="6862486">int</span><span class="op" id="6862489">(</span><span class="ident" id="6862490">sizes</span><span class="op" id="6862495">)</span><span class="op" id="6862496">,</span>&nbsp;<span class="ident" id="6862498">err</span><span class="op" id="6862501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862505">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862513">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862517">if</span>&nbsp;<span class="ident" id="6862520">params</span><span class="op" id="6862526">.</span><span class="ident" id="6862527">P</span><span class="op" id="6862528">.</span><span class="ident" id="6862529">BitLen</span><span class="op" id="6862535">(</span><span class="op" id="6862536">)</span>&nbsp;<span class="op" id="6862538">!=</span>&nbsp;<span class="ident" id="6862541">L</span>&nbsp;<span class="op" id="6862543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862547">t</span><span class="op" id="6862548">.</span><span class="ident" id="6862549">Errorf</span><span class="op" id="6862555">(</span><span class="string" id="6862556">&#34;%d:&nbsp;params.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="6862590">,</span>&nbsp;<span class="builtintype" id="6862592">int</span><span class="op" id="6862595">(</span><span class="ident" id="6862596">sizes</span><span class="op" id="6862601">)</span><span class="op" id="6862602">,</span>&nbsp;<span class="ident" id="6862604">params</span><span class="op" id="6862610">.</span><span class="ident" id="6862611">P</span><span class="op" id="6862612">.</span><span class="ident" id="6862613">BitLen</span><span class="op" id="6862619">(</span><span class="op" id="6862620">)</span><span class="op" id="6862621">,</span>&nbsp;<span class="ident" id="6862623">L</span><span class="op" id="6862624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862631">if</span>&nbsp;<span class="ident" id="6862634">params</span><span class="op" id="6862640">.</span><span class="ident" id="6862641">Q</span><span class="op" id="6862642">.</span><span class="ident" id="6862643">BitLen</span><span class="op" id="6862649">(</span><span class="op" id="6862650">)</span>&nbsp;<span class="op" id="6862652">!=</span>&nbsp;<span class="ident" id="6862655">N</span>&nbsp;<span class="op" id="6862657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862661">t</span><span class="op" id="6862662">.</span><span class="ident" id="6862663">Errorf</span><span class="op" id="6862669">(</span><span class="string" id="6862670">&#34;%d:&nbsp;q.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="6862699">,</span>&nbsp;<span class="builtintype" id="6862701">int</span><span class="op" id="6862704">(</span><span class="ident" id="6862705">sizes</span><span class="op" id="6862710">)</span><span class="op" id="6862711">,</span>&nbsp;<span class="ident" id="6862713">params</span><span class="op" id="6862719">.</span><span class="ident" id="6862720">Q</span><span class="op" id="6862721">.</span><span class="ident" id="6862722">BitLen</span><span class="op" id="6862728">(</span><span class="op" id="6862729">)</span><span class="op" id="6862730">,</span>&nbsp;<span class="ident" id="6862732">L</span><span class="op" id="6862733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862740">one</span>&nbsp;<span class="op" id="6862744">:=</span>&nbsp;<span class="builtinfunc" id="6862747">new</span><span class="op" id="6862750">(</span><span class="ident" id="6862751">big</span><span class="op" id="6862754">.</span><span class="ident" id="6862755">Int</span><span class="op" id="6862758">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862761">one</span><span class="op" id="6862764">.</span><span class="ident" id="6862765">SetInt64</span><span class="op" id="6862773">(</span><span class="num" id="6862774">1</span><span class="op" id="6862775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862778">pm1</span>&nbsp;<span class="op" id="6862782">:=</span>&nbsp;<span class="builtinfunc" id="6862785">new</span><span class="op" id="6862788">(</span><span class="ident" id="6862789">big</span><span class="op" id="6862792">.</span><span class="ident" id="6862793">Int</span><span class="op" id="6862796">)</span><span class="op" id="6862797">.</span><span class="ident" id="6862798">Sub</span><span class="op" id="6862801">(</span><span class="ident" id="6862802">params</span><span class="op" id="6862808">.</span><span class="ident" id="6862809">P</span><span class="op" id="6862810">,</span>&nbsp;<span class="ident" id="6862812">one</span><span class="op" id="6862815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862818">quo</span><span class="op" id="6862821">,</span>&nbsp;<span class="ident" id="6862823">rem</span>&nbsp;<span class="op" id="6862827">:=</span>&nbsp;<span class="builtinfunc" id="6862830">new</span><span class="op" id="6862833">(</span><span class="ident" id="6862834">big</span><span class="op" id="6862837">.</span><span class="ident" id="6862838">Int</span><span class="op" id="6862841">)</span><span class="op" id="6862842">.</span><span class="ident" id="6862843">DivMod</span><span class="op" id="6862849">(</span><span class="ident" id="6862850">pm1</span><span class="op" id="6862853">,</span>&nbsp;<span class="ident" id="6862855">params</span><span class="op" id="6862861">.</span><span class="ident" id="6862862">Q</span><span class="op" id="6862863">,</span>&nbsp;<span class="builtinfunc" id="6862865">new</span><span class="op" id="6862868">(</span><span class="ident" id="6862869">big</span><span class="op" id="6862872">.</span><span class="ident" id="6862873">Int</span><span class="op" id="6862876">)</span><span class="op" id="6862877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862880">if</span>&nbsp;<span class="ident" id="6862883">rem</span><span class="op" id="6862886">.</span><span class="ident" id="6862887">Sign</span><span class="op" id="6862891">(</span><span class="op" id="6862892">)</span>&nbsp;<span class="op" id="6862894">!=</span>&nbsp;<span class="num" id="6862897">0</span>&nbsp;<span class="op" id="6862899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862903">t</span><span class="op" id="6862904">.</span><span class="ident" id="6862905">Errorf</span><span class="op" id="6862911">(</span><span class="string" id="6862912">&#34;%d:&nbsp;p-1&nbsp;mod&nbsp;q&nbsp;!=&nbsp;0&#34;</span><span class="op" id="6862932">,</span>&nbsp;<span class="builtintype" id="6862934">int</span><span class="op" id="6862937">(</span><span class="ident" id="6862938">sizes</span><span class="op" id="6862943">)</span><span class="op" id="6862944">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862950">x</span>&nbsp;<span class="op" id="6862952">:=</span>&nbsp;<span class="builtinfunc" id="6862955">new</span><span class="op" id="6862958">(</span><span class="ident" id="6862959">big</span><span class="op" id="6862962">.</span><span class="ident" id="6862963">Int</span><span class="op" id="6862966">)</span><span class="op" id="6862967">.</span><span class="ident" id="6862968">Exp</span><span class="op" id="6862971">(</span><span class="ident" id="6862972">params</span><span class="op" id="6862978">.</span><span class="ident" id="6862979">G</span><span class="op" id="6862980">,</span>&nbsp;<span class="ident" id="6862982">quo</span><span class="op" id="6862985">,</span>&nbsp;<span class="ident" id="6862987">params</span><span class="op" id="6862993">.</span><span class="ident" id="6862994">P</span><span class="op" id="6862995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862998">if</span>&nbsp;<span class="ident" id="6863001">x</span><span class="op" id="6863002">.</span><span class="ident" id="6863003">Cmp</span><span class="op" id="6863006">(</span><span class="ident" id="6863007">one</span><span class="op" id="6863010">)</span>&nbsp;<span class="op" id="6863012">==</span>&nbsp;<span class="num" id="6863015">0</span>&nbsp;<span class="op" id="6863017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863021">t</span><span class="op" id="6863022">.</span><span class="ident" id="6863023">Errorf</span><span class="op" id="6863029">(</span><span class="string" id="6863030">&#34;%d:&nbsp;invalid&nbsp;generator&#34;</span><span class="op" id="6863053">,</span>&nbsp;<span class="builtintype" id="6863055">int</span><span class="op" id="6863058">(</span><span class="ident" id="6863059">sizes</span><span class="op" id="6863064">)</span><span class="op" id="6863065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863068">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863072">err</span>&nbsp;<span class="op" id="6863076">=</span>&nbsp;<span class="ident" id="6863078">GenerateKey</span><span class="op" id="6863089">(</span><span class="op" id="6863090">&amp;</span><span class="ident" id="6863091">priv</span><span class="op" id="6863095">,</span>&nbsp;<span class="ident" id="6863097">rand</span><span class="op" id="6863101">.</span><span class="ident" id="6863102">Reader</span><span class="op" id="6863108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863111">if</span>&nbsp;<span class="ident" id="6863114">err</span>&nbsp;<span class="op" id="6863118">!=</span>&nbsp;<span class="ident" id="6863121">nil</span>&nbsp;<span class="op" id="6863125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863129">t</span><span class="op" id="6863130">.</span><span class="ident" id="6863131">Errorf</span><span class="op" id="6863137">(</span><span class="string" id="6863138">&#34;error&nbsp;generating&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6863164">,</span>&nbsp;<span class="ident" id="6863166">err</span><span class="op" id="6863169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863173">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863185">testSignAndVerify</span><span class="op" id="6863202">(</span><span class="ident" id="6863203">t</span><span class="op" id="6863204">,</span>&nbsp;<span class="builtintype" id="6863206">int</span><span class="op" id="6863209">(</span><span class="ident" id="6863210">sizes</span><span class="op" id="6863215">)</span><span class="op" id="6863216">,</span>&nbsp;<span class="op" id="6863218">&amp;</span><span class="ident" id="6863219">priv</span><span class="op" id="6863223">)</span><br>
<span class="lineno"></span><span class="op" id="6863225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6863228">func</span>&nbsp;<span class="ident" id="6863233">TestParameterGeneration</span><span class="op" id="6863256">(</span><span class="ident" id="6863257">t</span>&nbsp;<span class="op" id="6863259">*</span><span class="ident" id="6863260">testing</span><span class="op" id="6863267">.</span><span class="ident" id="6863268">T</span><span class="op" id="6863269">)</span>&nbsp;<span class="op" id="6863271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863274">if</span>&nbsp;<span class="ident" id="6863277">testing</span><span class="op" id="6863284">.</span><span class="ident" id="6863285">Short</span><span class="op" id="6863290">(</span><span class="op" id="6863291">)</span>&nbsp;<span class="op" id="6863293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863297">t</span><span class="op" id="6863298">.</span><span class="ident" id="6863299">Skip</span><span class="op" id="6863303">(</span><span class="string" id="6863304">&#34;skipping&nbsp;parameter&nbsp;generation&nbsp;test&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="6863354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863361">testParameterGeneration</span><span class="op" id="6863384">(</span><span class="ident" id="6863385">t</span><span class="op" id="6863386">,</span>&nbsp;<span class="ident" id="6863388">L1024N160</span><span class="op" id="6863397">,</span>&nbsp;<span class="num" id="6863399">1024</span><span class="op" id="6863403">,</span>&nbsp;<span class="num" id="6863405">160</span><span class="op" id="6863408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863411">testParameterGeneration</span><span class="op" id="6863434">(</span><span class="ident" id="6863435">t</span><span class="op" id="6863436">,</span>&nbsp;<span class="ident" id="6863438">L2048N224</span><span class="op" id="6863447">,</span>&nbsp;<span class="num" id="6863449">2048</span><span class="op" id="6863453">,</span>&nbsp;<span class="num" id="6863455">224</span><span class="op" id="6863458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863461">testParameterGeneration</span><span class="op" id="6863484">(</span><span class="ident" id="6863485">t</span><span class="op" id="6863486">,</span>&nbsp;<span class="ident" id="6863488">L2048N256</span><span class="op" id="6863497">,</span>&nbsp;<span class="num" id="6863499">2048</span><span class="op" id="6863503">,</span>&nbsp;<span class="num" id="6863505">256</span><span class="op" id="6863508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863511">testParameterGeneration</span><span class="op" id="6863534">(</span><span class="ident" id="6863535">t</span><span class="op" id="6863536">,</span>&nbsp;<span class="ident" id="6863538">L3072N256</span><span class="op" id="6863547">,</span>&nbsp;<span class="num" id="6863549">3072</span><span class="op" id="6863553">,</span>&nbsp;<span class="num" id="6863555">256</span><span class="op" id="6863558">)</span><br>
<span class="lineno"></span><span class="op" id="6863560">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="6863563">func</span>&nbsp;<span class="ident" id="6863568">TestSignAndVerify</span><span class="op" id="6863585">(</span><span class="ident" id="6863586">t</span>&nbsp;<span class="op" id="6863588">*</span><span class="ident" id="6863589">testing</span><span class="op" id="6863596">.</span><span class="ident" id="6863597">T</span><span class="op" id="6863598">)</span>&nbsp;<span class="op" id="6863600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863603">var</span>&nbsp;<span class="ident" id="6863607">priv</span>&nbsp;<span class="ident" id="6863612">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863624">priv</span><span class="op" id="6863628">.</span><span class="ident" id="6863629">P</span><span class="op" id="6863630">,</span>&nbsp;<span class="ident" id="6863632">_</span>&nbsp;<span class="op" id="6863634">=</span>&nbsp;<span class="builtinfunc" id="6863636">new</span><span class="op" id="6863639">(</span><span class="ident" id="6863640">big</span><span class="op" id="6863643">.</span><span class="ident" id="6863644">Int</span><span class="op" id="6863647">)</span><span class="op" id="6863648">.</span><span class="ident" id="6863649">SetString</span><span class="op" id="6863658">(</span><span class="string" id="6863659">&#34;A9B5B793FB4785793D246BAE77E8FF63CA52F442DA763C440259919FE1BC1D6065A9350637A04F75A2F039401D49F08E066C4D275A5A65DA5684BC563C14289D7AB8A67163BFBF79D85972619AD2CFF55AB0EE77A9002B0EF96293BDD0F42685EBB2C66C327079F6C98000FBCB79AACDE1BC6F9D5C7B1A97E3D9D54ED7951FEF&#34;</span><span class="op" id="6863917">,</span>&nbsp;<span class="num" id="6863919">16</span><span class="op" id="6863921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863924">priv</span><span class="op" id="6863928">.</span><span class="ident" id="6863929">Q</span><span class="op" id="6863930">,</span>&nbsp;<span class="ident" id="6863932">_</span>&nbsp;<span class="op" id="6863934">=</span>&nbsp;<span class="builtinfunc" id="6863936">new</span><span class="op" id="6863939">(</span><span class="ident" id="6863940">big</span><span class="op" id="6863943">.</span><span class="ident" id="6863944">Int</span><span class="op" id="6863947">)</span><span class="op" id="6863948">.</span><span class="ident" id="6863949">SetString</span><span class="op" id="6863958">(</span><span class="string" id="6863959">&#34;E1D3391245933D68A0714ED34BBCB7A1F422B9C1&#34;</span><span class="op" id="6864001">,</span>&nbsp;<span class="num" id="6864003">16</span><span class="op" id="6864005">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864008">priv</span><span class="op" id="6864012">.</span><span class="ident" id="6864013">G</span><span class="op" id="6864014">,</span>&nbsp;<span class="ident" id="6864016">_</span>&nbsp;<span class="op" id="6864018">=</span>&nbsp;<span class="builtinfunc" id="6864020">new</span><span class="op" id="6864023">(</span><span class="ident" id="6864024">big</span><span class="op" id="6864027">.</span><span class="ident" id="6864028">Int</span><span class="op" id="6864031">)</span><span class="op" id="6864032">.</span><span class="ident" id="6864033">SetString</span><span class="op" id="6864042">(</span><span class="string" id="6864043">&#34;634364FC25248933D01D1993ECABD0657CC0CB2CEED7ED2E3E8AECDFCDC4A25C3B15E9E3B163ACA2984B5539181F3EFF1A5E8903D71D5B95DA4F27202B77D2C44B430BB53741A8D59A8F86887525C9F2A6A5980A195EAA7F2FF910064301DEF89D3AA213E1FAC7768D89365318E370AF54A112EFBA9246D9158386BA1B4EEFDA&#34;</span><span class="op" id="6864301">,</span>&nbsp;<span class="num" id="6864303">16</span><span class="op" id="6864305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864308">priv</span><span class="op" id="6864312">.</span><span class="ident" id="6864313">Y</span><span class="op" id="6864314">,</span>&nbsp;<span class="ident" id="6864316">_</span>&nbsp;<span class="op" id="6864318">=</span>&nbsp;<span class="builtinfunc" id="6864320">new</span><span class="op" id="6864323">(</span><span class="ident" id="6864324">big</span><span class="op" id="6864327">.</span><span class="ident" id="6864328">Int</span><span class="op" id="6864331">)</span><span class="op" id="6864332">.</span><span class="ident" id="6864333">SetString</span><span class="op" id="6864342">(</span><span class="string" id="6864343">&#34;32969E5780CFE1C849A1C276D7AEB4F38A23B591739AA2FE197349AEEBD31366AEE5EB7E6C6DDB7C57D02432B30DB5AA66D9884299FAA72568944E4EEDC92EA3FBC6F39F53412FBCC563208F7C15B737AC8910DBC2D9C9B8C001E72FDC40EB694AB1F06A5A2DBD18D9E36C66F31F566742F11EC0A52E9F7B89355C02FB5D32D2&#34;</span><span class="op" id="6864601">,</span>&nbsp;<span class="num" id="6864603">16</span><span class="op" id="6864605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864608">priv</span><span class="op" id="6864612">.</span><span class="ident" id="6864613">X</span><span class="op" id="6864614">,</span>&nbsp;<span class="ident" id="6864616">_</span>&nbsp;<span class="op" id="6864618">=</span>&nbsp;<span class="builtinfunc" id="6864620">new</span><span class="op" id="6864623">(</span><span class="ident" id="6864624">big</span><span class="op" id="6864627">.</span><span class="ident" id="6864628">Int</span><span class="op" id="6864631">)</span><span class="op" id="6864632">.</span><span class="ident" id="6864633">SetString</span><span class="op" id="6864642">(</span><span class="string" id="6864643">&#34;5078D4D29795CBE76D3AACFE48C9AF0BCDBEE91A&#34;</span><span class="op" id="6864685">,</span>&nbsp;<span class="num" id="6864687">16</span><span class="op" id="6864689">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864693">testSignAndVerify</span><span class="op" id="6864710">(</span><span class="ident" id="6864711">t</span><span class="op" id="6864712">,</span>&nbsp;<span class="num" id="6864714">0</span><span class="op" id="6864715">,</span>&nbsp;<span class="op" id="6864717">&amp;</span><span class="ident" id="6864718">priv</span><span class="op" id="6864722">)</span><br>
<span class="lineno">85</span><span class="op" id="6864724">}</span>
</div>
</body>
</html>
