<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4742706">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4742762">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4742816">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4742867">package</span>&nbsp;<span class="ident" id="4742875">syntax</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4742883">import</span>&nbsp;<span class="op" id="4742890">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4742893">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4742901">&#34;strings&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4742912">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4742923">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4742938">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4742941">//&nbsp;An&nbsp;Error&nbsp;describes&nbsp;a&nbsp;failure&nbsp;to&nbsp;parse&nbsp;a&nbsp;regular&nbsp;expression</span><br>
<span class="lineno">15</span><span class="comment" id="4743003">//&nbsp;and&nbsp;gives&nbsp;the&nbsp;offending&nbsp;expression.</span><br>
<span class="lineno"></span><span class="keyword" id="4743042">type</span>&nbsp;<span class="ident" id="4743047">Error</span>&nbsp;<span class="keyword" id="4743053">struct</span>&nbsp;<span class="op" id="4743060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743063">Code</span>&nbsp;<span class="ident" id="4743068"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743079">Expr</span>&nbsp;<span class="builtintype" id="4743084">string</span><br>
<span class="lineno"></span><span class="op" id="4743091">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="4743094">func</span>&nbsp;<span class="op" id="4743099">(</span><span class="ident" id="4743100">e</span>&nbsp;<span class="op" id="4743102">*</span><span class="ident" id="4743103"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4743108">)</span>&nbsp;<span class="ident" id="4743110">Error</span><span class="op" id="4743115">(</span><span class="op" id="4743116">)</span>&nbsp;<span class="builtintype" id="4743118">string</span>&nbsp;<span class="op" id="4743125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743128">return</span>&nbsp;<span class="string" id="4743135">&#34;error&nbsp;parsing&nbsp;regexp:&nbsp;&#34;</span>&nbsp;<span class="op" id="4743160">+</span>&nbsp;<span class="ident" id="4743162"><a href="/regexp/syntax/parse.go.html#4743100">e</a></span><span class="op" id="4743163">.</span><span class="ident" id="4743164">Code</span><span class="op" id="4743168">.</span><span class="ident" id="4743169">String</span><span class="op" id="4743175">(</span><span class="op" id="4743176">)</span>&nbsp;<span class="op" id="4743178">+</span>&nbsp;<span class="string" id="4743180">&#34;:&nbsp;`&#34;</span>&nbsp;<span class="op" id="4743186">+</span>&nbsp;<span class="ident" id="4743188"><a href="/regexp/syntax/parse.go.html#4743100">e</a></span><span class="op" id="4743189">.</span><span class="ident" id="4743190">Expr</span>&nbsp;<span class="op" id="4743195">+</span>&nbsp;<span class="string" id="4743197">&#34;`&#34;</span><br>
<span class="lineno"></span><span class="op" id="4743201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4743204">//&nbsp;An&nbsp;ErrorCode&nbsp;describes&nbsp;a&nbsp;failure&nbsp;to&nbsp;parse&nbsp;a&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="keyword" id="4743271">type</span>&nbsp;<span class="ident" id="4743276">ErrorCode</span>&nbsp;<span class="builtintype" id="4743286">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4743294">const</span>&nbsp;<span class="op" id="4743300">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4743303">//&nbsp;Unexpected&nbsp;error</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743324">ErrInternalError</span>&nbsp;<span class="ident" id="4743341"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4743351">=</span>&nbsp;<span class="string" id="4743353">&#34;regexp/syntax:&nbsp;internal&nbsp;error&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4743387">//&nbsp;Parse&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743404">ErrInvalidCharClass</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743429"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4743439">=</span>&nbsp;<span class="string" id="4743441">&#34;invalid&nbsp;character&nbsp;class&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743468">ErrInvalidCharRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743493"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4743503">=</span>&nbsp;<span class="string" id="4743505">&#34;invalid&nbsp;character&nbsp;class&nbsp;range&#34;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743538">ErrInvalidEscape</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743563"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4743573">=</span>&nbsp;<span class="string" id="4743575">&#34;invalid&nbsp;escape&nbsp;sequence&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743602">ErrInvalidNamedCapture</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4743627"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4743637">=</span>&nbsp;<span class="string" id="4743639">&#34;invalid&nbsp;named&nbsp;capture&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743664">ErrInvalidPerlOp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743689"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4743699">=</span>&nbsp;<span class="string" id="4743701">&#34;invalid&nbsp;or&nbsp;unsupported&nbsp;Perl&nbsp;syntax&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743739">ErrInvalidRepeatOp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743764"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4743774">=</span>&nbsp;<span class="string" id="4743776">&#34;invalid&nbsp;nested&nbsp;repetition&nbsp;operator&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743814">ErrInvalidRepeatSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743839"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4743849">=</span>&nbsp;<span class="string" id="4743851">&#34;invalid&nbsp;repeat&nbsp;count&#34;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743875">ErrInvalidUTF8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743900"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4743910">=</span>&nbsp;<span class="string" id="4743912">&#34;invalid&nbsp;UTF-8&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743929">ErrMissingBracket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743954"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4743964">=</span>&nbsp;<span class="string" id="4743966">&#34;missing&nbsp;closing&nbsp;]&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743987">ErrMissingParen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744012"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4744022">=</span>&nbsp;<span class="string" id="4744024">&#34;missing&nbsp;closing&nbsp;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744045">ErrMissingRepeatArgument</span>&nbsp;<span class="ident" id="4744070"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4744080">=</span>&nbsp;<span class="string" id="4744082">&#34;missing&nbsp;argument&nbsp;to&nbsp;repetition&nbsp;operator&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744125">ErrTrailingBackslash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744150"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4744160">=</span>&nbsp;<span class="string" id="4744162">&#34;trailing&nbsp;backslash&nbsp;at&nbsp;end&nbsp;of&nbsp;expression&#34;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744205">ErrUnexpectedParen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744230"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span>&nbsp;<span class="op" id="4744240">=</span>&nbsp;<span class="string" id="4744242">&#34;unexpected&nbsp;)&#34;</span><br>
<span class="lineno"></span><span class="op" id="4744257">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4744260">func</span>&nbsp;<span class="op" id="4744265">(</span><span class="ident" id="4744266">e</span>&nbsp;<span class="ident" id="4744268"><a href="/regexp/syntax/parse.go.html#4743276">ErrorCode</a></span><span class="op" id="4744277">)</span>&nbsp;<span class="ident" id="4744279">String</span><span class="op" id="4744285">(</span><span class="op" id="4744286">)</span>&nbsp;<span class="builtintype" id="4744288">string</span>&nbsp;<span class="op" id="4744295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744298">return</span>&nbsp;<span class="builtintype" id="4744305">string</span><span class="op" id="4744311">(</span><span class="ident" id="4744312"><a href="/regexp/syntax/parse.go.html#4744266">e</a></span><span class="op" id="4744313">)</span><br>
<span class="lineno">50</span><span class="op" id="4744315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4744318">//&nbsp;Flags&nbsp;control&nbsp;the&nbsp;behavior&nbsp;of&nbsp;the&nbsp;parser&nbsp;and&nbsp;record&nbsp;information&nbsp;about&nbsp;regexp&nbsp;context.</span><br>
<span class="lineno"></span><span class="keyword" id="4744407">type</span>&nbsp;<span class="ident" id="4744412">Flags</span>&nbsp;<span class="builtintype" id="4744418">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="4744426">const</span>&nbsp;<span class="op" id="4744432">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744435">FoldCase</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744449"><a href="/regexp/syntax/parse.go.html#4744412">Flags</a></span>&nbsp;<span class="op" id="4744455">=</span>&nbsp;<span class="num" id="4744457">1</span>&nbsp;<span class="op" id="4744459">&lt;&lt;</span>&nbsp;<span class="ident" id="4744462">iota</span>&nbsp;<span class="comment" id="4744467">//&nbsp;case-insensitive&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744494">Literal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4744526">//&nbsp;treat&nbsp;pattern&nbsp;as&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744562">ClassNL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4744594">//&nbsp;allow&nbsp;character&nbsp;classes&nbsp;like&nbsp;[^a-z]&nbsp;and&nbsp;[[:space:]]&nbsp;to&nbsp;match&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744667">DotNL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4744699">//&nbsp;allow&nbsp;.&nbsp;to&nbsp;match&nbsp;newline</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744728">OneLine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4744760">//&nbsp;treat&nbsp;^&nbsp;and&nbsp;$&nbsp;as&nbsp;only&nbsp;matching&nbsp;at&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744824">NonGreedy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4744856">//&nbsp;make&nbsp;repetition&nbsp;operators&nbsp;default&nbsp;to&nbsp;non-greedy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744908">PerlX</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4744940">//&nbsp;allow&nbsp;Perl&nbsp;extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744966">UnicodeGroups</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4744998">//&nbsp;allow&nbsp;\p{Han},&nbsp;\P{Han}&nbsp;for&nbsp;Unicode&nbsp;group&nbsp;and&nbsp;negation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745056">WasDollar</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4745088">//&nbsp;regexp&nbsp;OpEndText&nbsp;was&nbsp;$,&nbsp;not&nbsp;\z</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745123">Simple</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4745155">//&nbsp;regexp&nbsp;contains&nbsp;no&nbsp;counted&nbsp;repetition</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745198">MatchNL</span>&nbsp;<span class="op" id="4745206">=</span>&nbsp;<span class="ident" id="4745208"><a href="/regexp/syntax/parse.go.html#4744562">ClassNL</a></span>&nbsp;<span class="op" id="4745216">|</span>&nbsp;<span class="ident" id="4745218"><a href="/regexp/syntax/parse.go.html#4744667">DotNL</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745226">Perl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745238">=</span>&nbsp;<span class="ident" id="4745240"><a href="/regexp/syntax/parse.go.html#4744562">ClassNL</a></span>&nbsp;<span class="op" id="4745248">|</span>&nbsp;<span class="ident" id="4745250"><a href="/regexp/syntax/parse.go.html#4744728">OneLine</a></span>&nbsp;<span class="op" id="4745258">|</span>&nbsp;<span class="ident" id="4745260"><a href="/regexp/syntax/parse.go.html#4744908">PerlX</a></span>&nbsp;<span class="op" id="4745266">|</span>&nbsp;<span class="ident" id="4745268"><a href="/regexp/syntax/parse.go.html#4744966">UnicodeGroups</a></span>&nbsp;<span class="comment" id="4745282">//&nbsp;as&nbsp;close&nbsp;to&nbsp;Perl&nbsp;as&nbsp;possible</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745315">POSIX</span>&nbsp;<span class="ident" id="4745321"><a href="/regexp/syntax/parse.go.html#4744412">Flags</a></span>&nbsp;<span class="op" id="4745327">=</span>&nbsp;<span class="num" id="4745329">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4745371">//&nbsp;POSIX&nbsp;syntax</span><br>
<span class="lineno"></span><span class="op" id="4745387">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4745390">//&nbsp;Pseudo-ops&nbsp;for&nbsp;parsing&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="4745423">const</span>&nbsp;<span class="op" id="4745429">(</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745432">opLeftParen</span>&nbsp;<span class="op" id="4745444">=</span>&nbsp;<span class="ident" id="4745446"><a href="/regexp/syntax/regexp.go.html#4802167">opPseudo</a></span>&nbsp;<span class="op" id="4745455">+</span>&nbsp;<span class="ident" id="4745457">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745463">opVerticalBar</span><br>
<span class="lineno"></span><span class="op" id="4745477">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4745480">type</span>&nbsp;<span class="ident" id="4745485">parser</span>&nbsp;<span class="keyword" id="4745492">struct</span>&nbsp;<span class="op" id="4745499">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745502">flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745514"><a href="/regexp/syntax/parse.go.html#4744412">Flags</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4745524">//&nbsp;parse&nbsp;mode&nbsp;flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745545">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745557">[</span><span class="op" id="4745558">]</span><span class="op" id="4745559">*</span><span class="ident" id="4745560"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="comment" id="4745567">//&nbsp;stack&nbsp;of&nbsp;parsed&nbsp;expressions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745599">free</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745611">*</span><span class="ident" id="4745612"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745620">numCap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4745632">int</span>&nbsp;<span class="comment" id="4745636">//&nbsp;number&nbsp;of&nbsp;capturing&nbsp;groups&nbsp;seen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745672">wholeRegexp</span>&nbsp;<span class="builtintype" id="4745684">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745692">tmpClass</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745704">[</span><span class="op" id="4745705">]</span><span class="builtintype" id="4745706">rune</span>&nbsp;<span class="comment" id="4745711">//&nbsp;temporary&nbsp;char&nbsp;class&nbsp;work&nbsp;space</span><br>
<span class="lineno"></span><span class="op" id="4745746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4745749">func</span>&nbsp;<span class="op" id="4745754">(</span><span class="ident" id="4745755">p</span>&nbsp;<span class="op" id="4745757">*</span><span class="ident" id="4745758"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4745764">)</span>&nbsp;<span class="ident" id="4745766">newRegexp</span><span class="op" id="4745775">(</span><span class="ident" id="4745776">op</span>&nbsp;<span class="ident" id="4745779"><a href="/regexp/syntax/regexp.go.html#4800610">Op</a></span><span class="op" id="4745781">)</span>&nbsp;<span class="op" id="4745783">*</span><span class="ident" id="4745784"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="op" id="4745791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745794">re</span>&nbsp;<span class="op" id="4745797">:=</span>&nbsp;<span class="ident" id="4745800"><a href="/regexp/syntax/parse.go.html#4745755">p</a></span><span class="op" id="4745801">.</span><span class="ident" id="4745802">free</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745808">if</span>&nbsp;<span class="ident" id="4745811"><a href="/regexp/syntax/parse.go.html#4745794">re</a></span>&nbsp;<span class="op" id="4745814">!=</span>&nbsp;<span class="ident" id="4745817">nil</span>&nbsp;<span class="op" id="4745821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745825"><a href="/regexp/syntax/parse.go.html#4745755">p</a></span><span class="op" id="4745826">.</span><span class="ident" id="4745827">free</span>&nbsp;<span class="op" id="4745832">=</span>&nbsp;<span class="ident" id="4745834"><a href="/regexp/syntax/parse.go.html#4745794">re</a></span><span class="op" id="4745836">.</span><span class="ident" id="4745837">Sub0</span><span class="op" id="4745841">[</span><span class="num" id="4745842">0</span><span class="op" id="4745843">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4745847">*</span><span class="ident" id="4745848"><a href="/regexp/syntax/parse.go.html#4745794">re</a></span>&nbsp;<span class="op" id="4745851">=</span>&nbsp;<span class="ident" id="4745853"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4745859">{</span><span class="op" id="4745860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4745863">}</span>&nbsp;<span class="keyword" id="4745865">else</span>&nbsp;<span class="op" id="4745870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745874"><a href="/regexp/syntax/parse.go.html#4745794">re</a></span>&nbsp;<span class="op" id="4745877">=</span>&nbsp;<span class="builtinfunc" id="4745879">new</span><span class="op" id="4745882">(</span><span class="ident" id="4745883"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4745889">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4745892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745895"><a href="/regexp/syntax/parse.go.html#4745794">re</a></span><span class="op" id="4745897">.</span><span class="ident" id="4745898">Op</span>&nbsp;<span class="op" id="4745901">=</span>&nbsp;<span class="ident" id="4745903"><a href="/regexp/syntax/parse.go.html#4745776">op</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745907">return</span>&nbsp;<span class="ident" id="4745914"><a href="/regexp/syntax/parse.go.html#4745794">re</a></span><br>
<span class="lineno"></span><span class="op" id="4745917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4745920">func</span>&nbsp;<span class="op" id="4745925">(</span><span class="ident" id="4745926">p</span>&nbsp;<span class="op" id="4745928">*</span><span class="ident" id="4745929"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4745935">)</span>&nbsp;<span class="ident" id="4745937">reuse</span><span class="op" id="4745942">(</span><span class="ident" id="4745943">re</span>&nbsp;<span class="op" id="4745946">*</span><span class="ident" id="4745947"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4745953">)</span>&nbsp;<span class="op" id="4745955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745958"><a href="/regexp/syntax/parse.go.html#4745943">re</a></span><span class="op" id="4745960">.</span><span class="ident" id="4745961">Sub0</span><span class="op" id="4745965">[</span><span class="num" id="4745966">0</span><span class="op" id="4745967">]</span>&nbsp;<span class="op" id="4745969">=</span>&nbsp;<span class="ident" id="4745971"><a href="/regexp/syntax/parse.go.html#4745926">p</a></span><span class="op" id="4745972">.</span><span class="ident" id="4745973">free</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745979"><a href="/regexp/syntax/parse.go.html#4745926">p</a></span><span class="op" id="4745980">.</span><span class="ident" id="4745981">free</span>&nbsp;<span class="op" id="4745986">=</span>&nbsp;<span class="ident" id="4745988"><a href="/regexp/syntax/parse.go.html#4745943">re</a></span><br>
<span class="lineno"></span><span class="op" id="4745991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="4745994">//&nbsp;Parse&nbsp;stack&nbsp;manipulation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4746024">//&nbsp;push&nbsp;pushes&nbsp;the&nbsp;regexp&nbsp;re&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack&nbsp;and&nbsp;returns&nbsp;the&nbsp;regexp.</span><br>
<span class="lineno"></span><span class="keyword" id="4746098">func</span>&nbsp;<span class="op" id="4746103">(</span><span class="ident" id="4746104">p</span>&nbsp;<span class="op" id="4746106">*</span><span class="ident" id="4746107"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4746113">)</span>&nbsp;<span class="ident" id="4746115">push</span><span class="op" id="4746119">(</span><span class="ident" id="4746120">re</span>&nbsp;<span class="op" id="4746123">*</span><span class="ident" id="4746124"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4746130">)</span>&nbsp;<span class="op" id="4746132">*</span><span class="ident" id="4746133"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="op" id="4746140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4746143">if</span>&nbsp;<span class="ident" id="4746146"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746148">.</span><span class="ident" id="4746149">Op</span>&nbsp;<span class="op" id="4746152">==</span>&nbsp;<span class="ident" id="4746155"><a href="/regexp/syntax/regexp.go.html#4800993">OpCharClass</a></span>&nbsp;<span class="op" id="4746167">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4746170">len</span><span class="op" id="4746173">(</span><span class="ident" id="4746174"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746176">.</span><span class="ident" id="4746177">Rune</span><span class="op" id="4746181">)</span>&nbsp;<span class="op" id="4746183">==</span>&nbsp;<span class="num" id="4746186">2</span>&nbsp;<span class="op" id="4746188">&amp;&amp;</span>&nbsp;<span class="ident" id="4746191"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746193">.</span><span class="ident" id="4746194">Rune</span><span class="op" id="4746198">[</span><span class="num" id="4746199">0</span><span class="op" id="4746200">]</span>&nbsp;<span class="op" id="4746202">==</span>&nbsp;<span class="ident" id="4746205"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746207">.</span><span class="ident" id="4746208">Rune</span><span class="op" id="4746212">[</span><span class="num" id="4746213">1</span><span class="op" id="4746214">]</span>&nbsp;<span class="op" id="4746216">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4746220">//&nbsp;Single&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4746238">if</span>&nbsp;<span class="ident" id="4746241"><a href="/regexp/syntax/parse.go.html#4746104">p</a></span><span class="op" id="4746242">.</span><span class="ident" id="4746243">maybeConcat</span><span class="op" id="4746254">(</span><span class="ident" id="4746255"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746257">.</span><span class="ident" id="4746258">Rune</span><span class="op" id="4746262">[</span><span class="num" id="4746263">0</span><span class="op" id="4746264">]</span><span class="op" id="4746265">,</span>&nbsp;<span class="ident" id="4746267"><a href="/regexp/syntax/parse.go.html#4746104">p</a></span><span class="op" id="4746268">.</span><span class="ident" id="4746269">flags</span><span class="op" id="4746274">&amp;^</span><span class="ident" id="4746276"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span><span class="op" id="4746284">)</span>&nbsp;<span class="op" id="4746286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4746291">return</span>&nbsp;<span class="ident" id="4746298">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4746304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746308"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746310">.</span><span class="ident" id="4746311">Op</span>&nbsp;<span class="op" id="4746314">=</span>&nbsp;<span class="ident" id="4746316"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746328"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746330">.</span><span class="ident" id="4746331">Rune</span>&nbsp;<span class="op" id="4746336">=</span>&nbsp;<span class="ident" id="4746338"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746340">.</span><span class="ident" id="4746341">Rune</span><span class="op" id="4746345">[</span><span class="op" id="4746346">:</span><span class="num" id="4746347">1</span><span class="op" id="4746348">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746352"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746354">.</span><span class="ident" id="4746355">Flags</span>&nbsp;<span class="op" id="4746361">=</span>&nbsp;<span class="ident" id="4746363"><a href="/regexp/syntax/parse.go.html#4746104">p</a></span><span class="op" id="4746364">.</span><span class="ident" id="4746365">flags</span>&nbsp;<span class="op" id="4746371">&amp;^</span>&nbsp;<span class="ident" id="4746374"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4746384">}</span>&nbsp;<span class="keyword" id="4746386">else</span>&nbsp;<span class="keyword" id="4746391">if</span>&nbsp;<span class="ident" id="4746394"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746396">.</span><span class="ident" id="4746397">Op</span>&nbsp;<span class="op" id="4746400">==</span>&nbsp;<span class="ident" id="4746403"><a href="/regexp/syntax/regexp.go.html#4800993">OpCharClass</a></span>&nbsp;<span class="op" id="4746415">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4746418">len</span><span class="op" id="4746421">(</span><span class="ident" id="4746422"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746424">.</span><span class="ident" id="4746425">Rune</span><span class="op" id="4746429">)</span>&nbsp;<span class="op" id="4746431">==</span>&nbsp;<span class="num" id="4746434">4</span>&nbsp;<span class="op" id="4746436">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746441"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746443">.</span><span class="ident" id="4746444">Rune</span><span class="op" id="4746448">[</span><span class="num" id="4746449">0</span><span class="op" id="4746450">]</span>&nbsp;<span class="op" id="4746452">==</span>&nbsp;<span class="ident" id="4746455"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746457">.</span><span class="ident" id="4746458">Rune</span><span class="op" id="4746462">[</span><span class="num" id="4746463">1</span><span class="op" id="4746464">]</span>&nbsp;<span class="op" id="4746466">&amp;&amp;</span>&nbsp;<span class="ident" id="4746469"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746471">.</span><span class="ident" id="4746472">Rune</span><span class="op" id="4746476">[</span><span class="num" id="4746477">2</span><span class="op" id="4746478">]</span>&nbsp;<span class="op" id="4746480">==</span>&nbsp;<span class="ident" id="4746483"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746485">.</span><span class="ident" id="4746486">Rune</span><span class="op" id="4746490">[</span><span class="num" id="4746491">3</span><span class="op" id="4746492">]</span>&nbsp;<span class="op" id="4746494">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746499"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4746506">.</span><span class="ident" id="4746507">SimpleFold</span><span class="op" id="4746517">(</span><span class="ident" id="4746518"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746520">.</span><span class="ident" id="4746521">Rune</span><span class="op" id="4746525">[</span><span class="num" id="4746526">0</span><span class="op" id="4746527">]</span><span class="op" id="4746528">)</span>&nbsp;<span class="op" id="4746530">==</span>&nbsp;<span class="ident" id="4746533"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746535">.</span><span class="ident" id="4746536">Rune</span><span class="op" id="4746540">[</span><span class="num" id="4746541">2</span><span class="op" id="4746542">]</span>&nbsp;<span class="op" id="4746544">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746549"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4746556">.</span><span class="ident" id="4746557">SimpleFold</span><span class="op" id="4746567">(</span><span class="ident" id="4746568"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746570">.</span><span class="ident" id="4746571">Rune</span><span class="op" id="4746575">[</span><span class="num" id="4746576">2</span><span class="op" id="4746577">]</span><span class="op" id="4746578">)</span>&nbsp;<span class="op" id="4746580">==</span>&nbsp;<span class="ident" id="4746583"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746585">.</span><span class="ident" id="4746586">Rune</span><span class="op" id="4746590">[</span><span class="num" id="4746591">0</span><span class="op" id="4746592">]</span>&nbsp;<span class="op" id="4746594">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746599"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746601">.</span><span class="ident" id="4746602">Op</span>&nbsp;<span class="op" id="4746605">==</span>&nbsp;<span class="ident" id="4746608"><a href="/regexp/syntax/regexp.go.html#4800993">OpCharClass</a></span>&nbsp;<span class="op" id="4746620">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4746623">len</span><span class="op" id="4746626">(</span><span class="ident" id="4746627"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746629">.</span><span class="ident" id="4746630">Rune</span><span class="op" id="4746634">)</span>&nbsp;<span class="op" id="4746636">==</span>&nbsp;<span class="num" id="4746639">2</span>&nbsp;<span class="op" id="4746641">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746647"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746649">.</span><span class="ident" id="4746650">Rune</span><span class="op" id="4746654">[</span><span class="num" id="4746655">0</span><span class="op" id="4746656">]</span><span class="op" id="4746657">+</span><span class="num" id="4746658">1</span>&nbsp;<span class="op" id="4746660">==</span>&nbsp;<span class="ident" id="4746663"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746665">.</span><span class="ident" id="4746666">Rune</span><span class="op" id="4746670">[</span><span class="num" id="4746671">1</span><span class="op" id="4746672">]</span>&nbsp;<span class="op" id="4746674">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746680"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4746687">.</span><span class="ident" id="4746688">SimpleFold</span><span class="op" id="4746698">(</span><span class="ident" id="4746699"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746701">.</span><span class="ident" id="4746702">Rune</span><span class="op" id="4746706">[</span><span class="num" id="4746707">0</span><span class="op" id="4746708">]</span><span class="op" id="4746709">)</span>&nbsp;<span class="op" id="4746711">==</span>&nbsp;<span class="ident" id="4746714"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746716">.</span><span class="ident" id="4746717">Rune</span><span class="op" id="4746721">[</span><span class="num" id="4746722">1</span><span class="op" id="4746723">]</span>&nbsp;<span class="op" id="4746725">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746731"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4746738">.</span><span class="ident" id="4746739">SimpleFold</span><span class="op" id="4746749">(</span><span class="ident" id="4746750"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746752">.</span><span class="ident" id="4746753">Rune</span><span class="op" id="4746757">[</span><span class="num" id="4746758">1</span><span class="op" id="4746759">]</span><span class="op" id="4746760">)</span>&nbsp;<span class="op" id="4746762">==</span>&nbsp;<span class="ident" id="4746765"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746767">.</span><span class="ident" id="4746768">Rune</span><span class="op" id="4746772">[</span><span class="num" id="4746773">0</span><span class="op" id="4746774">]</span>&nbsp;<span class="op" id="4746776">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4746780">//&nbsp;Case-insensitive&nbsp;rune&nbsp;like&nbsp;[Aa]&nbsp;or&nbsp;[Δδ].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4746828">if</span>&nbsp;<span class="ident" id="4746831"><a href="/regexp/syntax/parse.go.html#4746104">p</a></span><span class="op" id="4746832">.</span><span class="ident" id="4746833">maybeConcat</span><span class="op" id="4746844">(</span><span class="ident" id="4746845"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746847">.</span><span class="ident" id="4746848">Rune</span><span class="op" id="4746852">[</span><span class="num" id="4746853">0</span><span class="op" id="4746854">]</span><span class="op" id="4746855">,</span>&nbsp;<span class="ident" id="4746857"><a href="/regexp/syntax/parse.go.html#4746104">p</a></span><span class="op" id="4746858">.</span><span class="ident" id="4746859">flags</span><span class="op" id="4746864">|</span><span class="ident" id="4746865"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span><span class="op" id="4746873">)</span>&nbsp;<span class="op" id="4746875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4746880">return</span>&nbsp;<span class="ident" id="4746887">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4746893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4746898">//&nbsp;Rewrite&nbsp;as&nbsp;(case-insensitive)&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746942"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746944">.</span><span class="ident" id="4746945">Op</span>&nbsp;<span class="op" id="4746948">=</span>&nbsp;<span class="ident" id="4746950"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746962"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746964">.</span><span class="ident" id="4746965">Rune</span>&nbsp;<span class="op" id="4746970">=</span>&nbsp;<span class="ident" id="4746972"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746974">.</span><span class="ident" id="4746975">Rune</span><span class="op" id="4746979">[</span><span class="op" id="4746980">:</span><span class="num" id="4746981">1</span><span class="op" id="4746982">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746986"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4746988">.</span><span class="ident" id="4746989">Flags</span>&nbsp;<span class="op" id="4746995">=</span>&nbsp;<span class="ident" id="4746997"><a href="/regexp/syntax/parse.go.html#4746104">p</a></span><span class="op" id="4746998">.</span><span class="ident" id="4746999">flags</span>&nbsp;<span class="op" id="4747005">|</span>&nbsp;<span class="ident" id="4747007"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747017">}</span>&nbsp;<span class="keyword" id="4747019">else</span>&nbsp;<span class="op" id="4747024">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4747028">//&nbsp;Incremental&nbsp;concatenation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747060"><a href="/regexp/syntax/parse.go.html#4746104">p</a></span><span class="op" id="4747061">.</span><span class="ident" id="4747062">maybeConcat</span><span class="op" id="4747073">(</span><span class="op" id="4747074">-</span><span class="num" id="4747075">1</span><span class="op" id="4747076">,</span>&nbsp;<span class="num" id="4747078">0</span><span class="op" id="4747079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747086"><a href="/regexp/syntax/parse.go.html#4746104">p</a></span><span class="op" id="4747087">.</span><span class="ident" id="4747088">stack</span>&nbsp;<span class="op" id="4747094">=</span>&nbsp;<span class="builtinfunc" id="4747096">append</span><span class="op" id="4747102">(</span><span class="ident" id="4747103"><a href="/regexp/syntax/parse.go.html#4746104">p</a></span><span class="op" id="4747104">.</span><span class="ident" id="4747105">stack</span><span class="op" id="4747110">,</span>&nbsp;<span class="ident" id="4747112"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><span class="op" id="4747114">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747117">return</span>&nbsp;<span class="ident" id="4747124"><a href="/regexp/syntax/parse.go.html#4746120">re</a></span><br>
<span class="lineno"></span><span class="op" id="4747127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4747130">//&nbsp;maybeConcat&nbsp;implements&nbsp;incremental&nbsp;concatenation</span><br>
<span class="lineno"></span><span class="comment" id="4747182">//&nbsp;of&nbsp;literal&nbsp;runes&nbsp;into&nbsp;string&nbsp;nodes.&nbsp;&nbsp;The&nbsp;parser&nbsp;calls&nbsp;this</span><br>
<span class="lineno">145</span><span class="comment" id="4747244">//&nbsp;before&nbsp;each&nbsp;push,&nbsp;so&nbsp;only&nbsp;the&nbsp;top&nbsp;fragment&nbsp;of&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="4747303">//&nbsp;might&nbsp;need&nbsp;processing.&nbsp;&nbsp;Since&nbsp;this&nbsp;is&nbsp;called&nbsp;before&nbsp;a&nbsp;push,</span><br>
<span class="lineno"></span><span class="comment" id="4747366">//&nbsp;the&nbsp;topmost&nbsp;literal&nbsp;is&nbsp;no&nbsp;longer&nbsp;subject&nbsp;to&nbsp;operators&nbsp;like&nbsp;*</span><br>
<span class="lineno"></span><span class="comment" id="4747430">//&nbsp;(Otherwise&nbsp;ab*&nbsp;would&nbsp;turn&nbsp;into&nbsp;(ab)*.)</span><br>
<span class="lineno"></span><span class="comment" id="4747472">//&nbsp;If&nbsp;r&nbsp;&gt;=&nbsp;0&nbsp;and&nbsp;there&#39;s&nbsp;a&nbsp;node&nbsp;left&nbsp;over,&nbsp;maybeConcat&nbsp;uses&nbsp;it</span><br>
<span class="lineno">150</span><span class="comment" id="4747535">//&nbsp;to&nbsp;push&nbsp;r&nbsp;with&nbsp;the&nbsp;given&nbsp;flags.</span><br>
<span class="lineno"></span><span class="comment" id="4747570">//&nbsp;maybeConcat&nbsp;reports&nbsp;whether&nbsp;r&nbsp;was&nbsp;pushed.</span><br>
<span class="lineno"></span><span class="keyword" id="4747615">func</span>&nbsp;<span class="op" id="4747620">(</span><span class="ident" id="4747621">p</span>&nbsp;<span class="op" id="4747623">*</span><span class="ident" id="4747624"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4747630">)</span>&nbsp;<span class="ident" id="4747632">maybeConcat</span><span class="op" id="4747643">(</span><span class="ident" id="4747644">r</span>&nbsp;<span class="builtintype" id="4747646">rune</span><span class="op" id="4747650">,</span>&nbsp;<span class="ident" id="4747652">flags</span>&nbsp;<span class="ident" id="4747658"><a href="/regexp/syntax/parse.go.html#4744412">Flags</a></span><span class="op" id="4747663">)</span>&nbsp;<span class="builtintype" id="4747665">bool</span>&nbsp;<span class="op" id="4747670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747673">n</span>&nbsp;<span class="op" id="4747675">:=</span>&nbsp;<span class="builtinfunc" id="4747678">len</span><span class="op" id="4747681">(</span><span class="ident" id="4747682"><a href="/regexp/syntax/parse.go.html#4747621">p</a></span><span class="op" id="4747683">.</span><span class="ident" id="4747684">stack</span><span class="op" id="4747689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747692">if</span>&nbsp;<span class="ident" id="4747695"><a href="/regexp/syntax/parse.go.html#4747673">n</a></span>&nbsp;<span class="op" id="4747697">&lt;</span>&nbsp;<span class="num" id="4747699">2</span>&nbsp;<span class="op" id="4747701">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747705">return</span>&nbsp;<span class="ident" id="4747712">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747723">re1</span>&nbsp;<span class="op" id="4747727">:=</span>&nbsp;<span class="ident" id="4747730"><a href="/regexp/syntax/parse.go.html#4747621">p</a></span><span class="op" id="4747731">.</span><span class="ident" id="4747732">stack</span><span class="op" id="4747737">[</span><span class="ident" id="4747738"><a href="/regexp/syntax/parse.go.html#4747673">n</a></span><span class="op" id="4747739">-</span><span class="num" id="4747740">1</span><span class="op" id="4747741">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747744">re2</span>&nbsp;<span class="op" id="4747748">:=</span>&nbsp;<span class="ident" id="4747751"><a href="/regexp/syntax/parse.go.html#4747621">p</a></span><span class="op" id="4747752">.</span><span class="ident" id="4747753">stack</span><span class="op" id="4747758">[</span><span class="ident" id="4747759"><a href="/regexp/syntax/parse.go.html#4747673">n</a></span><span class="op" id="4747760">-</span><span class="num" id="4747761">2</span><span class="op" id="4747762">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747765">if</span>&nbsp;<span class="ident" id="4747768"><a href="/regexp/syntax/parse.go.html#4747723">re1</a></span><span class="op" id="4747771">.</span><span class="ident" id="4747772">Op</span>&nbsp;<span class="op" id="4747775">!=</span>&nbsp;<span class="ident" id="4747778"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span>&nbsp;<span class="op" id="4747788">||</span>&nbsp;<span class="ident" id="4747791"><a href="/regexp/syntax/parse.go.html#4747744">re2</a></span><span class="op" id="4747794">.</span><span class="ident" id="4747795">Op</span>&nbsp;<span class="op" id="4747798">!=</span>&nbsp;<span class="ident" id="4747801"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span>&nbsp;<span class="op" id="4747811">||</span>&nbsp;<span class="ident" id="4747814"><a href="/regexp/syntax/parse.go.html#4747723">re1</a></span><span class="op" id="4747817">.</span><span class="ident" id="4747818">Flags</span><span class="op" id="4747823">&amp;</span><span class="ident" id="4747824"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span>&nbsp;<span class="op" id="4747833">!=</span>&nbsp;<span class="ident" id="4747836"><a href="/regexp/syntax/parse.go.html#4747744">re2</a></span><span class="op" id="4747839">.</span><span class="ident" id="4747840">Flags</span><span class="op" id="4747845">&amp;</span><span class="ident" id="4747846"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span>&nbsp;<span class="op" id="4747855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747859">return</span>&nbsp;<span class="ident" id="4747866">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4747877">//&nbsp;Push&nbsp;re1&nbsp;into&nbsp;re2.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747900"><a href="/regexp/syntax/parse.go.html#4747744">re2</a></span><span class="op" id="4747903">.</span><span class="ident" id="4747904">Rune</span>&nbsp;<span class="op" id="4747909">=</span>&nbsp;<span class="builtinfunc" id="4747911">append</span><span class="op" id="4747917">(</span><span class="ident" id="4747918"><a href="/regexp/syntax/parse.go.html#4747744">re2</a></span><span class="op" id="4747921">.</span><span class="ident" id="4747922">Rune</span><span class="op" id="4747926">,</span>&nbsp;<span class="ident" id="4747928"><a href="/regexp/syntax/parse.go.html#4747723">re1</a></span><span class="op" id="4747931">.</span><span class="ident" id="4747932">Rune</span><span class="op" id="4747936">...</span><span class="op" id="4747939">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4747943">//&nbsp;Reuse&nbsp;re1&nbsp;if&nbsp;possible.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747970">if</span>&nbsp;<span class="ident" id="4747973"><a href="/regexp/syntax/parse.go.html#4747644">r</a></span>&nbsp;<span class="op" id="4747975">&gt;=</span>&nbsp;<span class="num" id="4747978">0</span>&nbsp;<span class="op" id="4747980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747984"><a href="/regexp/syntax/parse.go.html#4747723">re1</a></span><span class="op" id="4747987">.</span><span class="ident" id="4747988">Rune</span>&nbsp;<span class="op" id="4747993">=</span>&nbsp;<span class="ident" id="4747995"><a href="/regexp/syntax/parse.go.html#4747723">re1</a></span><span class="op" id="4747998">.</span><span class="ident" id="4747999">Rune0</span><span class="op" id="4748004">[</span><span class="op" id="4748005">:</span><span class="num" id="4748006">1</span><span class="op" id="4748007">]</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748011"><a href="/regexp/syntax/parse.go.html#4747723">re1</a></span><span class="op" id="4748014">.</span><span class="ident" id="4748015">Rune</span><span class="op" id="4748019">[</span><span class="num" id="4748020">0</span><span class="op" id="4748021">]</span>&nbsp;<span class="op" id="4748023">=</span>&nbsp;<span class="ident" id="4748025"><a href="/regexp/syntax/parse.go.html#4747644">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748029"><a href="/regexp/syntax/parse.go.html#4747723">re1</a></span><span class="op" id="4748032">.</span><span class="ident" id="4748033">Flags</span>&nbsp;<span class="op" id="4748039">=</span>&nbsp;<span class="ident" id="4748041"><a href="/regexp/syntax/parse.go.html#4747652">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748049">return</span>&nbsp;<span class="ident" id="4748056">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748066"><a href="/regexp/syntax/parse.go.html#4747621">p</a></span><span class="op" id="4748067">.</span><span class="ident" id="4748068">stack</span>&nbsp;<span class="op" id="4748074">=</span>&nbsp;<span class="ident" id="4748076"><a href="/regexp/syntax/parse.go.html#4747621">p</a></span><span class="op" id="4748077">.</span><span class="ident" id="4748078">stack</span><span class="op" id="4748083">[</span><span class="op" id="4748084">:</span><span class="ident" id="4748085"><a href="/regexp/syntax/parse.go.html#4747673">n</a></span><span class="op" id="4748086">-</span><span class="num" id="4748087">1</span><span class="op" id="4748088">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748091"><a href="/regexp/syntax/parse.go.html#4747621">p</a></span><span class="op" id="4748092">.</span><span class="ident" id="4748093">reuse</span><span class="op" id="4748098">(</span><span class="ident" id="4748099"><a href="/regexp/syntax/parse.go.html#4747723">re1</a></span><span class="op" id="4748102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748105">return</span>&nbsp;<span class="ident" id="4748112">false</span>&nbsp;<span class="comment" id="4748118">//&nbsp;did&nbsp;not&nbsp;push&nbsp;r</span><br>
<span class="lineno"></span><span class="op" id="4748136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="4748139">//&nbsp;newLiteral&nbsp;returns&nbsp;a&nbsp;new&nbsp;OpLiteral&nbsp;Regexp&nbsp;with&nbsp;the&nbsp;given&nbsp;flags</span><br>
<span class="lineno"></span><span class="keyword" id="4748205">func</span>&nbsp;<span class="op" id="4748210">(</span><span class="ident" id="4748211">p</span>&nbsp;<span class="op" id="4748213">*</span><span class="ident" id="4748214"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4748220">)</span>&nbsp;<span class="ident" id="4748222">newLiteral</span><span class="op" id="4748232">(</span><span class="ident" id="4748233">r</span>&nbsp;<span class="builtintype" id="4748235">rune</span><span class="op" id="4748239">,</span>&nbsp;<span class="ident" id="4748241">flags</span>&nbsp;<span class="ident" id="4748247"><a href="/regexp/syntax/parse.go.html#4744412">Flags</a></span><span class="op" id="4748252">)</span>&nbsp;<span class="op" id="4748254">*</span><span class="ident" id="4748255"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="op" id="4748262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748265">re</span>&nbsp;<span class="op" id="4748268">:=</span>&nbsp;<span class="ident" id="4748271"><a href="/regexp/syntax/parse.go.html#4748211">p</a></span><span class="op" id="4748272">.</span><span class="ident" id="4748273">newRegexp</span><span class="op" id="4748282">(</span><span class="ident" id="4748283"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span><span class="op" id="4748292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748295"><a href="/regexp/syntax/parse.go.html#4748265">re</a></span><span class="op" id="4748297">.</span><span class="ident" id="4748298">Flags</span>&nbsp;<span class="op" id="4748304">=</span>&nbsp;<span class="ident" id="4748306"><a href="/regexp/syntax/parse.go.html#4748241">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748313">if</span>&nbsp;<span class="ident" id="4748316"><a href="/regexp/syntax/parse.go.html#4748241">flags</a></span><span class="op" id="4748321">&amp;</span><span class="ident" id="4748322"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span>&nbsp;<span class="op" id="4748331">!=</span>&nbsp;<span class="num" id="4748334">0</span>&nbsp;<span class="op" id="4748336">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748340"><a href="/regexp/syntax/parse.go.html#4748233">r</a></span>&nbsp;<span class="op" id="4748342">=</span>&nbsp;<span class="ident" id="4748344"><a href="/regexp/syntax/parse.go.html#4748484">minFoldRune</a></span><span class="op" id="4748355">(</span><span class="ident" id="4748356"><a href="/regexp/syntax/parse.go.html#4748233">r</a></span><span class="op" id="4748357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748363"><a href="/regexp/syntax/parse.go.html#4748265">re</a></span><span class="op" id="4748365">.</span><span class="ident" id="4748366">Rune0</span><span class="op" id="4748371">[</span><span class="num" id="4748372">0</span><span class="op" id="4748373">]</span>&nbsp;<span class="op" id="4748375">=</span>&nbsp;<span class="ident" id="4748377"><a href="/regexp/syntax/parse.go.html#4748233">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748380"><a href="/regexp/syntax/parse.go.html#4748265">re</a></span><span class="op" id="4748382">.</span><span class="ident" id="4748383">Rune</span>&nbsp;<span class="op" id="4748388">=</span>&nbsp;<span class="ident" id="4748390"><a href="/regexp/syntax/parse.go.html#4748265">re</a></span><span class="op" id="4748392">.</span><span class="ident" id="4748393">Rune0</span><span class="op" id="4748398">[</span><span class="op" id="4748399">:</span><span class="num" id="4748400">1</span><span class="op" id="4748401">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748404">return</span>&nbsp;<span class="ident" id="4748411"><a href="/regexp/syntax/parse.go.html#4748265">re</a></span><br>
<span class="lineno">190</span><span class="op" id="4748414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4748417">//&nbsp;minFoldRune&nbsp;returns&nbsp;the&nbsp;minimum&nbsp;rune&nbsp;fold-equivalent&nbsp;to&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="4748479">func</span>&nbsp;<span class="ident" id="4748484">minFoldRune</span><span class="op" id="4748495">(</span><span class="ident" id="4748496">r</span>&nbsp;<span class="builtintype" id="4748498">rune</span><span class="op" id="4748502">)</span>&nbsp;<span class="builtintype" id="4748504">rune</span>&nbsp;<span class="op" id="4748509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748512">if</span>&nbsp;<span class="ident" id="4748515"><a href="/regexp/syntax/parse.go.html#4748496">r</a></span>&nbsp;<span class="op" id="4748517">&lt;</span>&nbsp;<span class="ident" id="4748519"><a href="/regexp/syntax/parse.go.html#4784275">minFold</a></span>&nbsp;<span class="op" id="4748527">||</span>&nbsp;<span class="ident" id="4748530"><a href="/regexp/syntax/parse.go.html#4748496">r</a></span>&nbsp;<span class="op" id="4748532">&gt;</span>&nbsp;<span class="ident" id="4748534"><a href="/regexp/syntax/parse.go.html#4784293">maxFold</a></span>&nbsp;<span class="op" id="4748542">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748546">return</span>&nbsp;<span class="ident" id="4748553"><a href="/regexp/syntax/parse.go.html#4748496">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748559">min</span>&nbsp;<span class="op" id="4748563">:=</span>&nbsp;<span class="ident" id="4748566"><a href="/regexp/syntax/parse.go.html#4748496">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748569">r0</span>&nbsp;<span class="op" id="4748572">:=</span>&nbsp;<span class="ident" id="4748575"><a href="/regexp/syntax/parse.go.html#4748496">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748578">for</span>&nbsp;<span class="ident" id="4748582"><a href="/regexp/syntax/parse.go.html#4748496">r</a></span>&nbsp;<span class="op" id="4748584">=</span>&nbsp;<span class="ident" id="4748586"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4748593">.</span><span class="ident" id="4748594">SimpleFold</span><span class="op" id="4748604">(</span><span class="ident" id="4748605"><a href="/regexp/syntax/parse.go.html#4748496">r</a></span><span class="op" id="4748606">)</span><span class="op" id="4748607">;</span>&nbsp;<span class="ident" id="4748609"><a href="/regexp/syntax/parse.go.html#4748496">r</a></span>&nbsp;<span class="op" id="4748611">!=</span>&nbsp;<span class="ident" id="4748614"><a href="/regexp/syntax/parse.go.html#4748569">r0</a></span><span class="op" id="4748616">;</span>&nbsp;<span class="ident" id="4748618"><a href="/regexp/syntax/parse.go.html#4748496">r</a></span>&nbsp;<span class="op" id="4748620">=</span>&nbsp;<span class="ident" id="4748622"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4748629">.</span><span class="ident" id="4748630">SimpleFold</span><span class="op" id="4748640">(</span><span class="ident" id="4748641"><a href="/regexp/syntax/parse.go.html#4748496">r</a></span><span class="op" id="4748642">)</span>&nbsp;<span class="op" id="4748644">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748648">if</span>&nbsp;<span class="ident" id="4748651"><a href="/regexp/syntax/parse.go.html#4748559">min</a></span>&nbsp;<span class="op" id="4748655">&gt;</span>&nbsp;<span class="ident" id="4748657"><a href="/regexp/syntax/parse.go.html#4748496">r</a></span>&nbsp;<span class="op" id="4748659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748664"><a href="/regexp/syntax/parse.go.html#4748559">min</a></span>&nbsp;<span class="op" id="4748668">=</span>&nbsp;<span class="ident" id="4748670"><a href="/regexp/syntax/parse.go.html#4748496">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748680">return</span>&nbsp;<span class="ident" id="4748687"><a href="/regexp/syntax/parse.go.html#4748559">min</a></span><br>
<span class="lineno">205</span><span class="op" id="4748691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4748694">//&nbsp;literal&nbsp;pushes&nbsp;a&nbsp;literal&nbsp;regexp&nbsp;for&nbsp;the&nbsp;rune&nbsp;r&nbsp;on&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="4748757">//&nbsp;and&nbsp;returns&nbsp;that&nbsp;regexp.</span><br>
<span class="lineno"></span><span class="keyword" id="4748785">func</span>&nbsp;<span class="op" id="4748790">(</span><span class="ident" id="4748791">p</span>&nbsp;<span class="op" id="4748793">*</span><span class="ident" id="4748794"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4748800">)</span>&nbsp;<span class="ident" id="4748802">literal</span><span class="op" id="4748809">(</span><span class="ident" id="4748810">r</span>&nbsp;<span class="builtintype" id="4748812">rune</span><span class="op" id="4748816">)</span>&nbsp;<span class="op" id="4748818">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748821"><a href="/regexp/syntax/parse.go.html#4748791">p</a></span><span class="op" id="4748822">.</span><span class="ident" id="4748823">push</span><span class="op" id="4748827">(</span><span class="ident" id="4748828"><a href="/regexp/syntax/parse.go.html#4748791">p</a></span><span class="op" id="4748829">.</span><span class="ident" id="4748830">newLiteral</span><span class="op" id="4748840">(</span><span class="ident" id="4748841"><a href="/regexp/syntax/parse.go.html#4748810">r</a></span><span class="op" id="4748842">,</span>&nbsp;<span class="ident" id="4748844"><a href="/regexp/syntax/parse.go.html#4748791">p</a></span><span class="op" id="4748845">.</span><span class="ident" id="4748846">flags</span><span class="op" id="4748851">)</span><span class="op" id="4748852">)</span><br>
<span class="lineno"></span><span class="op" id="4748854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4748857">//&nbsp;op&nbsp;pushes&nbsp;a&nbsp;regexp&nbsp;with&nbsp;the&nbsp;given&nbsp;op&nbsp;onto&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="4748912">//&nbsp;and&nbsp;returns&nbsp;that&nbsp;regexp.</span><br>
<span class="lineno">215</span><span class="keyword" id="4748940">func</span>&nbsp;<span class="op" id="4748945">(</span><span class="ident" id="4748946">p</span>&nbsp;<span class="op" id="4748948">*</span><span class="ident" id="4748949"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4748955">)</span>&nbsp;<span class="ident" id="4748957">op</span><span class="op" id="4748959">(</span><span class="ident" id="4748960">op</span>&nbsp;<span class="ident" id="4748963"><a href="/regexp/syntax/regexp.go.html#4800610">Op</a></span><span class="op" id="4748965">)</span>&nbsp;<span class="op" id="4748967">*</span><span class="ident" id="4748968"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="op" id="4748975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748978">re</span>&nbsp;<span class="op" id="4748981">:=</span>&nbsp;<span class="ident" id="4748984"><a href="/regexp/syntax/parse.go.html#4748946">p</a></span><span class="op" id="4748985">.</span><span class="ident" id="4748986">newRegexp</span><span class="op" id="4748995">(</span><span class="ident" id="4748996"><a href="/regexp/syntax/parse.go.html#4748960">op</a></span><span class="op" id="4748998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749001"><a href="/regexp/syntax/parse.go.html#4748978">re</a></span><span class="op" id="4749003">.</span><span class="ident" id="4749004">Flags</span>&nbsp;<span class="op" id="4749010">=</span>&nbsp;<span class="ident" id="4749012"><a href="/regexp/syntax/parse.go.html#4748946">p</a></span><span class="op" id="4749013">.</span><span class="ident" id="4749014">flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749021">return</span>&nbsp;<span class="ident" id="4749028"><a href="/regexp/syntax/parse.go.html#4748946">p</a></span><span class="op" id="4749029">.</span><span class="ident" id="4749030">push</span><span class="op" id="4749034">(</span><span class="ident" id="4749035"><a href="/regexp/syntax/parse.go.html#4748978">re</a></span><span class="op" id="4749037">)</span><br>
<span class="lineno"></span><span class="op" id="4749039">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="4749042">//&nbsp;repeat&nbsp;replaces&nbsp;the&nbsp;top&nbsp;stack&nbsp;element&nbsp;with&nbsp;itself&nbsp;repeated&nbsp;according&nbsp;to&nbsp;op,&nbsp;min,&nbsp;max.</span><br>
<span class="lineno"></span><span class="comment" id="4749131">//&nbsp;before&nbsp;is&nbsp;the&nbsp;regexp&nbsp;suffix&nbsp;starting&nbsp;at&nbsp;the&nbsp;repetition&nbsp;operator.</span><br>
<span class="lineno"></span><span class="comment" id="4749199">//&nbsp;after&nbsp;is&nbsp;the&nbsp;regexp&nbsp;suffix&nbsp;following&nbsp;after&nbsp;the&nbsp;repetition&nbsp;operator.</span><br>
<span class="lineno"></span><span class="comment" id="4749270">//&nbsp;repeat&nbsp;returns&nbsp;an&nbsp;updated&nbsp;&#39;after&#39;&nbsp;and&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">225</span><span class="keyword" id="4749329">func</span>&nbsp;<span class="op" id="4749334">(</span><span class="ident" id="4749335">p</span>&nbsp;<span class="op" id="4749337">*</span><span class="ident" id="4749338"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4749344">)</span>&nbsp;<span class="ident" id="4749346">repeat</span><span class="op" id="4749352">(</span><span class="ident" id="4749353">op</span>&nbsp;<span class="ident" id="4749356"><a href="/regexp/syntax/regexp.go.html#4800610">Op</a></span><span class="op" id="4749358">,</span>&nbsp;<span class="ident" id="4749360">min</span><span class="op" id="4749363">,</span>&nbsp;<span class="ident" id="4749365">max</span>&nbsp;<span class="builtintype" id="4749369">int</span><span class="op" id="4749372">,</span>&nbsp;<span class="ident" id="4749374">before</span><span class="op" id="4749380">,</span>&nbsp;<span class="ident" id="4749382">after</span><span class="op" id="4749387">,</span>&nbsp;<span class="ident" id="4749389">lastRepeat</span>&nbsp;<span class="builtintype" id="4749400">string</span><span class="op" id="4749406">)</span>&nbsp;<span class="op" id="4749408">(</span><span class="builtintype" id="4749409">string</span><span class="op" id="4749415">,</span>&nbsp;<span class="builtintype" id="4749417">error</span><span class="op" id="4749422">)</span>&nbsp;<span class="op" id="4749424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749427">flags</span>&nbsp;<span class="op" id="4749433">:=</span>&nbsp;<span class="ident" id="4749436"><a href="/regexp/syntax/parse.go.html#4749335">p</a></span><span class="op" id="4749437">.</span><span class="ident" id="4749438">flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749445">if</span>&nbsp;<span class="ident" id="4749448"><a href="/regexp/syntax/parse.go.html#4749335">p</a></span><span class="op" id="4749449">.</span><span class="ident" id="4749450">flags</span><span class="op" id="4749455">&amp;</span><span class="ident" id="4749456"><a href="/regexp/syntax/parse.go.html#4744908">PerlX</a></span>&nbsp;<span class="op" id="4749462">!=</span>&nbsp;<span class="num" id="4749465">0</span>&nbsp;<span class="op" id="4749467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749471">if</span>&nbsp;<span class="builtinfunc" id="4749474">len</span><span class="op" id="4749477">(</span><span class="ident" id="4749478"><a href="/regexp/syntax/parse.go.html#4749382">after</a></span><span class="op" id="4749483">)</span>&nbsp;<span class="op" id="4749485">&gt;</span>&nbsp;<span class="num" id="4749487">0</span>&nbsp;<span class="op" id="4749489">&amp;&amp;</span>&nbsp;<span class="ident" id="4749492"><a href="/regexp/syntax/parse.go.html#4749382">after</a></span><span class="op" id="4749497">[</span><span class="num" id="4749498">0</span><span class="op" id="4749499">]</span>&nbsp;<span class="op" id="4749501">==</span>&nbsp;<span class="string" id="4749504">&#39;?&#39;</span>&nbsp;<span class="op" id="4749508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749513"><a href="/regexp/syntax/parse.go.html#4749382">after</a></span>&nbsp;<span class="op" id="4749519">=</span>&nbsp;<span class="ident" id="4749521"><a href="/regexp/syntax/parse.go.html#4749382">after</a></span><span class="op" id="4749526">[</span><span class="num" id="4749527">1</span><span class="op" id="4749528">:</span><span class="op" id="4749529">]</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749534"><a href="/regexp/syntax/parse.go.html#4749427">flags</a></span>&nbsp;<span class="op" id="4749540">^=</span>&nbsp;<span class="ident" id="4749543"><a href="/regexp/syntax/parse.go.html#4744824">NonGreedy</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749559">if</span>&nbsp;<span class="ident" id="4749562"><a href="/regexp/syntax/parse.go.html#4749389">lastRepeat</a></span>&nbsp;<span class="op" id="4749573">!=</span>&nbsp;<span class="string" id="4749576">&#34;&#34;</span>&nbsp;<span class="op" id="4749579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4749584">//&nbsp;In&nbsp;Perl&nbsp;it&nbsp;is&nbsp;not&nbsp;allowed&nbsp;to&nbsp;stack&nbsp;repetition&nbsp;operators:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4749647">//&nbsp;a**&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;not&nbsp;a&nbsp;doubled&nbsp;star,&nbsp;and&nbsp;a++&nbsp;means</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4749710">//&nbsp;something&nbsp;else&nbsp;entirely,&nbsp;which&nbsp;we&nbsp;don&#39;t&nbsp;support!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749765">return</span>&nbsp;<span class="string" id="4749772">&#34;&#34;</span><span class="op" id="4749774">,</span>&nbsp;<span class="op" id="4749776">&amp;</span><span class="ident" id="4749777"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4749782">{</span><span class="ident" id="4749783"><a href="/regexp/syntax/parse.go.html#4743739">ErrInvalidRepeatOp</a></span><span class="op" id="4749801">,</span>&nbsp;<span class="ident" id="4749803"><a href="/regexp/syntax/parse.go.html#4749389">lastRepeat</a></span><span class="op" id="4749813">[</span><span class="op" id="4749814">:</span><span class="builtinfunc" id="4749815">len</span><span class="op" id="4749818">(</span><span class="ident" id="4749819"><a href="/regexp/syntax/parse.go.html#4749389">lastRepeat</a></span><span class="op" id="4749829">)</span><span class="op" id="4749830">-</span><span class="builtinfunc" id="4749831">len</span><span class="op" id="4749834">(</span><span class="ident" id="4749835"><a href="/regexp/syntax/parse.go.html#4749382">after</a></span><span class="op" id="4749840">)</span><span class="op" id="4749841">]</span><span class="op" id="4749842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749852">n</span>&nbsp;<span class="op" id="4749854">:=</span>&nbsp;<span class="builtinfunc" id="4749857">len</span><span class="op" id="4749860">(</span><span class="ident" id="4749861"><a href="/regexp/syntax/parse.go.html#4749335">p</a></span><span class="op" id="4749862">.</span><span class="ident" id="4749863">stack</span><span class="op" id="4749868">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749871">if</span>&nbsp;<span class="ident" id="4749874"><a href="/regexp/syntax/parse.go.html#4749852">n</a></span>&nbsp;<span class="op" id="4749876">==</span>&nbsp;<span class="num" id="4749879">0</span>&nbsp;<span class="op" id="4749881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749885">return</span>&nbsp;<span class="string" id="4749892">&#34;&#34;</span><span class="op" id="4749894">,</span>&nbsp;<span class="op" id="4749896">&amp;</span><span class="ident" id="4749897"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4749902">{</span><span class="ident" id="4749903"><a href="/regexp/syntax/parse.go.html#4744045">ErrMissingRepeatArgument</a></span><span class="op" id="4749927">,</span>&nbsp;<span class="ident" id="4749929"><a href="/regexp/syntax/parse.go.html#4749374">before</a></span><span class="op" id="4749935">[</span><span class="op" id="4749936">:</span><span class="builtinfunc" id="4749937">len</span><span class="op" id="4749940">(</span><span class="ident" id="4749941"><a href="/regexp/syntax/parse.go.html#4749374">before</a></span><span class="op" id="4749947">)</span><span class="op" id="4749948">-</span><span class="builtinfunc" id="4749949">len</span><span class="op" id="4749952">(</span><span class="ident" id="4749953"><a href="/regexp/syntax/parse.go.html#4749382">after</a></span><span class="op" id="4749958">)</span><span class="op" id="4749959">]</span><span class="op" id="4749960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749966">sub</span>&nbsp;<span class="op" id="4749970">:=</span>&nbsp;<span class="ident" id="4749973"><a href="/regexp/syntax/parse.go.html#4749335">p</a></span><span class="op" id="4749974">.</span><span class="ident" id="4749975">stack</span><span class="op" id="4749980">[</span><span class="ident" id="4749981"><a href="/regexp/syntax/parse.go.html#4749852">n</a></span><span class="op" id="4749982">-</span><span class="num" id="4749983">1</span><span class="op" id="4749984">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749987">if</span>&nbsp;<span class="ident" id="4749990"><a href="/regexp/syntax/parse.go.html#4749966">sub</a></span><span class="op" id="4749993">.</span><span class="ident" id="4749994">Op</span>&nbsp;<span class="op" id="4749997">&gt;=</span>&nbsp;<span class="ident" id="4750000"><a href="/regexp/syntax/regexp.go.html#4802167">opPseudo</a></span>&nbsp;<span class="op" id="4750009">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750013">return</span>&nbsp;<span class="string" id="4750020">&#34;&#34;</span><span class="op" id="4750022">,</span>&nbsp;<span class="op" id="4750024">&amp;</span><span class="ident" id="4750025"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4750030">{</span><span class="ident" id="4750031"><a href="/regexp/syntax/parse.go.html#4744045">ErrMissingRepeatArgument</a></span><span class="op" id="4750055">,</span>&nbsp;<span class="ident" id="4750057"><a href="/regexp/syntax/parse.go.html#4749374">before</a></span><span class="op" id="4750063">[</span><span class="op" id="4750064">:</span><span class="builtinfunc" id="4750065">len</span><span class="op" id="4750068">(</span><span class="ident" id="4750069"><a href="/regexp/syntax/parse.go.html#4749374">before</a></span><span class="op" id="4750075">)</span><span class="op" id="4750076">-</span><span class="builtinfunc" id="4750077">len</span><span class="op" id="4750080">(</span><span class="ident" id="4750081"><a href="/regexp/syntax/parse.go.html#4749382">after</a></span><span class="op" id="4750086">)</span><span class="op" id="4750087">]</span><span class="op" id="4750088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750095">re</span>&nbsp;<span class="op" id="4750098">:=</span>&nbsp;<span class="ident" id="4750101"><a href="/regexp/syntax/parse.go.html#4749335">p</a></span><span class="op" id="4750102">.</span><span class="ident" id="4750103">newRegexp</span><span class="op" id="4750112">(</span><span class="ident" id="4750113"><a href="/regexp/syntax/parse.go.html#4749353">op</a></span><span class="op" id="4750115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750118"><a href="/regexp/syntax/parse.go.html#4750095">re</a></span><span class="op" id="4750120">.</span><span class="ident" id="4750121">Min</span>&nbsp;<span class="op" id="4750125">=</span>&nbsp;<span class="ident" id="4750127"><a href="/regexp/syntax/parse.go.html#4749360">min</a></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750132"><a href="/regexp/syntax/parse.go.html#4750095">re</a></span><span class="op" id="4750134">.</span><span class="ident" id="4750135">Max</span>&nbsp;<span class="op" id="4750139">=</span>&nbsp;<span class="ident" id="4750141"><a href="/regexp/syntax/parse.go.html#4749365">max</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750146"><a href="/regexp/syntax/parse.go.html#4750095">re</a></span><span class="op" id="4750148">.</span><span class="ident" id="4750149">Flags</span>&nbsp;<span class="op" id="4750155">=</span>&nbsp;<span class="ident" id="4750157"><a href="/regexp/syntax/parse.go.html#4749427">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750164"><a href="/regexp/syntax/parse.go.html#4750095">re</a></span><span class="op" id="4750166">.</span><span class="ident" id="4750167">Sub</span>&nbsp;<span class="op" id="4750171">=</span>&nbsp;<span class="ident" id="4750173"><a href="/regexp/syntax/parse.go.html#4750095">re</a></span><span class="op" id="4750175">.</span><span class="ident" id="4750176">Sub0</span><span class="op" id="4750180">[</span><span class="op" id="4750181">:</span><span class="num" id="4750182">1</span><span class="op" id="4750183">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750186"><a href="/regexp/syntax/parse.go.html#4750095">re</a></span><span class="op" id="4750188">.</span><span class="ident" id="4750189">Sub</span><span class="op" id="4750192">[</span><span class="num" id="4750193">0</span><span class="op" id="4750194">]</span>&nbsp;<span class="op" id="4750196">=</span>&nbsp;<span class="ident" id="4750198"><a href="/regexp/syntax/parse.go.html#4749966">sub</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750203"><a href="/regexp/syntax/parse.go.html#4749335">p</a></span><span class="op" id="4750204">.</span><span class="ident" id="4750205">stack</span><span class="op" id="4750210">[</span><span class="ident" id="4750211"><a href="/regexp/syntax/parse.go.html#4749852">n</a></span><span class="op" id="4750212">-</span><span class="num" id="4750213">1</span><span class="op" id="4750214">]</span>&nbsp;<span class="op" id="4750216">=</span>&nbsp;<span class="ident" id="4750218"><a href="/regexp/syntax/parse.go.html#4750095">re</a></span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750223">if</span>&nbsp;<span class="ident" id="4750226"><a href="/regexp/syntax/parse.go.html#4749353">op</a></span>&nbsp;<span class="op" id="4750229">==</span>&nbsp;<span class="ident" id="4750232"><a href="/regexp/syntax/regexp.go.html#4801925">OpRepeat</a></span>&nbsp;<span class="op" id="4750241">&amp;&amp;</span>&nbsp;<span class="op" id="4750244">(</span><span class="ident" id="4750245"><a href="/regexp/syntax/parse.go.html#4749360">min</a></span>&nbsp;<span class="op" id="4750249">&gt;=</span>&nbsp;<span class="num" id="4750252">2</span>&nbsp;<span class="op" id="4750254">||</span>&nbsp;<span class="ident" id="4750257"><a href="/regexp/syntax/parse.go.html#4749365">max</a></span>&nbsp;<span class="op" id="4750261">&gt;=</span>&nbsp;<span class="num" id="4750264">2</span><span class="op" id="4750265">)</span>&nbsp;<span class="op" id="4750267">&amp;&amp;</span>&nbsp;<span class="op" id="4750270">!</span><span class="ident" id="4750271"><a href="/regexp/syntax/parse.go.html#4750974">repeatIsValid</a></span><span class="op" id="4750284">(</span><span class="ident" id="4750285"><a href="/regexp/syntax/parse.go.html#4750095">re</a></span><span class="op" id="4750287">,</span>&nbsp;<span class="num" id="4750289">1000</span><span class="op" id="4750293">)</span>&nbsp;<span class="op" id="4750295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750299">return</span>&nbsp;<span class="string" id="4750306">&#34;&#34;</span><span class="op" id="4750308">,</span>&nbsp;<span class="op" id="4750310">&amp;</span><span class="ident" id="4750311"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4750316">{</span><span class="ident" id="4750317"><a href="/regexp/syntax/parse.go.html#4743814">ErrInvalidRepeatSize</a></span><span class="op" id="4750337">,</span>&nbsp;<span class="ident" id="4750339"><a href="/regexp/syntax/parse.go.html#4749374">before</a></span><span class="op" id="4750345">[</span><span class="op" id="4750346">:</span><span class="builtinfunc" id="4750347">len</span><span class="op" id="4750350">(</span><span class="ident" id="4750351"><a href="/regexp/syntax/parse.go.html#4749374">before</a></span><span class="op" id="4750357">)</span><span class="op" id="4750358">-</span><span class="builtinfunc" id="4750359">len</span><span class="op" id="4750362">(</span><span class="ident" id="4750363"><a href="/regexp/syntax/parse.go.html#4749382">after</a></span><span class="op" id="4750368">)</span><span class="op" id="4750369">]</span><span class="op" id="4750370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750377">return</span>&nbsp;<span class="ident" id="4750384"><a href="/regexp/syntax/parse.go.html#4749382">after</a></span><span class="op" id="4750389">,</span>&nbsp;<span class="ident" id="4750391">nil</span><br>
<span class="lineno"></span><span class="op" id="4750395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4750398">//&nbsp;repeatIsValid&nbsp;reports&nbsp;whether&nbsp;the&nbsp;repetition&nbsp;re&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="comment" id="4750459">//&nbsp;Valid&nbsp;means&nbsp;that&nbsp;the&nbsp;combination&nbsp;of&nbsp;the&nbsp;top-level&nbsp;repetition</span><br>
<span class="lineno">265</span><span class="comment" id="4750523">//&nbsp;and&nbsp;any&nbsp;inner&nbsp;repetitions&nbsp;does&nbsp;not&nbsp;exceed&nbsp;n&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4750584">//&nbsp;innermost&nbsp;thing.</span><br>
<span class="lineno"></span><span class="comment" id="4750604">//&nbsp;This&nbsp;function&nbsp;rewalks&nbsp;the&nbsp;regexp&nbsp;tree&nbsp;and&nbsp;is&nbsp;called&nbsp;for&nbsp;every&nbsp;repetition,</span><br>
<span class="lineno"></span><span class="comment" id="4750681">//&nbsp;so&nbsp;we&nbsp;have&nbsp;to&nbsp;worry&nbsp;about&nbsp;inducing&nbsp;quadratic&nbsp;behavior&nbsp;in&nbsp;the&nbsp;parser.</span><br>
<span class="lineno"></span><span class="comment" id="4750753">//&nbsp;We&nbsp;avoid&nbsp;this&nbsp;by&nbsp;only&nbsp;calling&nbsp;repeatIsValid&nbsp;when&nbsp;min&nbsp;or&nbsp;max&nbsp;&gt;=&nbsp;2.</span><br>
<span class="lineno">270</span><span class="comment" id="4750822">//&nbsp;In&nbsp;that&nbsp;case&nbsp;the&nbsp;depth&nbsp;of&nbsp;any&nbsp;&gt;=&nbsp;2&nbsp;nesting&nbsp;can&nbsp;only&nbsp;get&nbsp;to&nbsp;9&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="4750894">//&nbsp;triggering&nbsp;a&nbsp;parse&nbsp;error,&nbsp;so&nbsp;each&nbsp;subtree&nbsp;can&nbsp;only&nbsp;be&nbsp;rewalked&nbsp;9&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="4750969">func</span>&nbsp;<span class="ident" id="4750974">repeatIsValid</span><span class="op" id="4750987">(</span><span class="ident" id="4750988">re</span>&nbsp;<span class="op" id="4750991">*</span><span class="ident" id="4750992"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4750998">,</span>&nbsp;<span class="ident" id="4751000">n</span>&nbsp;<span class="builtintype" id="4751002">int</span><span class="op" id="4751005">)</span>&nbsp;<span class="builtintype" id="4751007">bool</span>&nbsp;<span class="op" id="4751012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751015">if</span>&nbsp;<span class="ident" id="4751018"><a href="/regexp/syntax/parse.go.html#4750988">re</a></span><span class="op" id="4751020">.</span><span class="ident" id="4751021">Op</span>&nbsp;<span class="op" id="4751024">==</span>&nbsp;<span class="ident" id="4751027"><a href="/regexp/syntax/regexp.go.html#4801925">OpRepeat</a></span>&nbsp;<span class="op" id="4751036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751040">m</span>&nbsp;<span class="op" id="4751042">:=</span>&nbsp;<span class="ident" id="4751045"><a href="/regexp/syntax/parse.go.html#4750988">re</a></span><span class="op" id="4751047">.</span><span class="ident" id="4751048">Max</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751054">if</span>&nbsp;<span class="ident" id="4751057"><a href="/regexp/syntax/parse.go.html#4751040">m</a></span>&nbsp;<span class="op" id="4751059">==</span>&nbsp;<span class="num" id="4751062">0</span>&nbsp;<span class="op" id="4751064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751069">return</span>&nbsp;<span class="ident" id="4751076">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751087">if</span>&nbsp;<span class="ident" id="4751090"><a href="/regexp/syntax/parse.go.html#4751040">m</a></span>&nbsp;<span class="op" id="4751092">&lt;</span>&nbsp;<span class="num" id="4751094">0</span>&nbsp;<span class="op" id="4751096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751101"><a href="/regexp/syntax/parse.go.html#4751040">m</a></span>&nbsp;<span class="op" id="4751103">=</span>&nbsp;<span class="ident" id="4751105"><a href="/regexp/syntax/parse.go.html#4750988">re</a></span><span class="op" id="4751107">.</span><span class="ident" id="4751108">Min</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751118">if</span>&nbsp;<span class="ident" id="4751121"><a href="/regexp/syntax/parse.go.html#4751040">m</a></span>&nbsp;<span class="op" id="4751123">&gt;</span>&nbsp;<span class="ident" id="4751125"><a href="/regexp/syntax/parse.go.html#4751000">n</a></span>&nbsp;<span class="op" id="4751127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751132">return</span>&nbsp;<span class="ident" id="4751139">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751151">if</span>&nbsp;<span class="ident" id="4751154"><a href="/regexp/syntax/parse.go.html#4751040">m</a></span>&nbsp;<span class="op" id="4751156">&gt;</span>&nbsp;<span class="num" id="4751158">0</span>&nbsp;<span class="op" id="4751160">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751165"><a href="/regexp/syntax/parse.go.html#4751000">n</a></span>&nbsp;<span class="op" id="4751167">/=</span>&nbsp;<span class="ident" id="4751170"><a href="/regexp/syntax/parse.go.html#4751040">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751180">for</span>&nbsp;<span class="ident" id="4751184">_</span><span class="op" id="4751185">,</span>&nbsp;<span class="ident" id="4751187">sub</span>&nbsp;<span class="op" id="4751191">:=</span>&nbsp;<span class="keyword" id="4751194">range</span>&nbsp;<span class="ident" id="4751200"><a href="/regexp/syntax/parse.go.html#4750988">re</a></span><span class="op" id="4751202">.</span><span class="ident" id="4751203">Sub</span>&nbsp;<span class="op" id="4751207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751211">if</span>&nbsp;<span class="op" id="4751214">!</span><span class="ident" id="4751215"><a href="/regexp/syntax/parse.go.html#4750974">repeatIsValid</a></span><span class="op" id="4751228">(</span><span class="ident" id="4751229"><a href="/regexp/syntax/parse.go.html#4751187">sub</a></span><span class="op" id="4751232">,</span>&nbsp;<span class="ident" id="4751234"><a href="/regexp/syntax/parse.go.html#4751000">n</a></span><span class="op" id="4751235">)</span>&nbsp;<span class="op" id="4751237">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751242">return</span>&nbsp;<span class="ident" id="4751249">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751263">return</span>&nbsp;<span class="ident" id="4751270">true</span><br>
<span class="lineno"></span><span class="op" id="4751275">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4751278">//&nbsp;concat&nbsp;replaces&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack&nbsp;(above&nbsp;the&nbsp;topmost&nbsp;&#39;|&#39;&nbsp;or&nbsp;&#39;(&#39;)&nbsp;with&nbsp;its&nbsp;concatenation.</span><br>
<span class="lineno"></span><span class="keyword" id="4751373">func</span>&nbsp;<span class="op" id="4751378">(</span><span class="ident" id="4751379">p</span>&nbsp;<span class="op" id="4751381">*</span><span class="ident" id="4751382"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4751388">)</span>&nbsp;<span class="ident" id="4751390">concat</span><span class="op" id="4751396">(</span><span class="op" id="4751397">)</span>&nbsp;<span class="op" id="4751399">*</span><span class="ident" id="4751400"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="op" id="4751407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751410"><a href="/regexp/syntax/parse.go.html#4751379">p</a></span><span class="op" id="4751411">.</span><span class="ident" id="4751412">maybeConcat</span><span class="op" id="4751423">(</span><span class="op" id="4751424">-</span><span class="num" id="4751425">1</span><span class="op" id="4751426">,</span>&nbsp;<span class="num" id="4751428">0</span><span class="op" id="4751429">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4751433">//&nbsp;Scan&nbsp;down&nbsp;to&nbsp;find&nbsp;pseudo-operator&nbsp;|&nbsp;or&nbsp;(.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751479">i</span>&nbsp;<span class="op" id="4751481">:=</span>&nbsp;<span class="builtinfunc" id="4751484">len</span><span class="op" id="4751487">(</span><span class="ident" id="4751488"><a href="/regexp/syntax/parse.go.html#4751379">p</a></span><span class="op" id="4751489">.</span><span class="ident" id="4751490">stack</span><span class="op" id="4751495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751498">for</span>&nbsp;<span class="ident" id="4751502"><a href="/regexp/syntax/parse.go.html#4751479">i</a></span>&nbsp;<span class="op" id="4751504">&gt;</span>&nbsp;<span class="num" id="4751506">0</span>&nbsp;<span class="op" id="4751508">&amp;&amp;</span>&nbsp;<span class="ident" id="4751511"><a href="/regexp/syntax/parse.go.html#4751379">p</a></span><span class="op" id="4751512">.</span><span class="ident" id="4751513">stack</span><span class="op" id="4751518">[</span><span class="ident" id="4751519"><a href="/regexp/syntax/parse.go.html#4751479">i</a></span><span class="op" id="4751520">-</span><span class="num" id="4751521">1</span><span class="op" id="4751522">]</span><span class="op" id="4751523">.</span><span class="ident" id="4751524">Op</span>&nbsp;<span class="op" id="4751527">&lt;</span>&nbsp;<span class="ident" id="4751529"><a href="/regexp/syntax/regexp.go.html#4802167">opPseudo</a></span>&nbsp;<span class="op" id="4751538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751542"><a href="/regexp/syntax/parse.go.html#4751479">i</a></span><span class="op" id="4751543">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751547">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751550">subs</span>&nbsp;<span class="op" id="4751555">:=</span>&nbsp;<span class="ident" id="4751558"><a href="/regexp/syntax/parse.go.html#4751379">p</a></span><span class="op" id="4751559">.</span><span class="ident" id="4751560">stack</span><span class="op" id="4751565">[</span><span class="ident" id="4751566"><a href="/regexp/syntax/parse.go.html#4751479">i</a></span><span class="op" id="4751567">:</span><span class="op" id="4751568">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751571"><a href="/regexp/syntax/parse.go.html#4751379">p</a></span><span class="op" id="4751572">.</span><span class="ident" id="4751573">stack</span>&nbsp;<span class="op" id="4751579">=</span>&nbsp;<span class="ident" id="4751581"><a href="/regexp/syntax/parse.go.html#4751379">p</a></span><span class="op" id="4751582">.</span><span class="ident" id="4751583">stack</span><span class="op" id="4751588">[</span><span class="op" id="4751589">:</span><span class="ident" id="4751590"><a href="/regexp/syntax/parse.go.html#4751479">i</a></span><span class="op" id="4751591">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4751595">//&nbsp;Empty&nbsp;concatenation&nbsp;is&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751636">if</span>&nbsp;<span class="builtinfunc" id="4751639">len</span><span class="op" id="4751642">(</span><span class="ident" id="4751643"><a href="/regexp/syntax/parse.go.html#4751550">subs</a></span><span class="op" id="4751647">)</span>&nbsp;<span class="op" id="4751649">==</span>&nbsp;<span class="num" id="4751652">0</span>&nbsp;<span class="op" id="4751654">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751658">return</span>&nbsp;<span class="ident" id="4751665"><a href="/regexp/syntax/parse.go.html#4751379">p</a></span><span class="op" id="4751666">.</span><span class="ident" id="4751667">push</span><span class="op" id="4751671">(</span><span class="ident" id="4751672"><a href="/regexp/syntax/parse.go.html#4751379">p</a></span><span class="op" id="4751673">.</span><span class="ident" id="4751674">newRegexp</span><span class="op" id="4751683">(</span><span class="ident" id="4751684"><a href="/regexp/syntax/regexp.go.html#4800879">OpEmptyMatch</a></span><span class="op" id="4751696">)</span><span class="op" id="4751697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751704">return</span>&nbsp;<span class="ident" id="4751711"><a href="/regexp/syntax/parse.go.html#4751379">p</a></span><span class="op" id="4751712">.</span><span class="ident" id="4751713">push</span><span class="op" id="4751717">(</span><span class="ident" id="4751718"><a href="/regexp/syntax/parse.go.html#4751379">p</a></span><span class="op" id="4751719">.</span><span class="ident" id="4751720">collapse</span><span class="op" id="4751728">(</span><span class="ident" id="4751729"><a href="/regexp/syntax/parse.go.html#4751550">subs</a></span><span class="op" id="4751733">,</span>&nbsp;<span class="ident" id="4751735"><a href="/regexp/syntax/regexp.go.html#4802031">OpConcat</a></span><span class="op" id="4751743">)</span><span class="op" id="4751744">)</span><br>
<span class="lineno"></span><span class="op" id="4751746">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="4751749">//&nbsp;alternate&nbsp;replaces&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack&nbsp;(above&nbsp;the&nbsp;topmost&nbsp;&#39;(&#39;)&nbsp;with&nbsp;its&nbsp;alternation.</span><br>
<span class="lineno"></span><span class="keyword" id="4751838">func</span>&nbsp;<span class="op" id="4751843">(</span><span class="ident" id="4751844">p</span>&nbsp;<span class="op" id="4751846">*</span><span class="ident" id="4751847"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4751853">)</span>&nbsp;<span class="ident" id="4751855">alternate</span><span class="op" id="4751864">(</span><span class="op" id="4751865">)</span>&nbsp;<span class="op" id="4751867">*</span><span class="ident" id="4751868"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="op" id="4751875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4751878">//&nbsp;Scan&nbsp;down&nbsp;to&nbsp;find&nbsp;pseudo-operator&nbsp;(.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4751919">//&nbsp;There&nbsp;are&nbsp;no&nbsp;|&nbsp;above&nbsp;(.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751947">i</span>&nbsp;<span class="op" id="4751949">:=</span>&nbsp;<span class="builtinfunc" id="4751952">len</span><span class="op" id="4751955">(</span><span class="ident" id="4751956"><a href="/regexp/syntax/parse.go.html#4751844">p</a></span><span class="op" id="4751957">.</span><span class="ident" id="4751958">stack</span><span class="op" id="4751963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751966">for</span>&nbsp;<span class="ident" id="4751970"><a href="/regexp/syntax/parse.go.html#4751947">i</a></span>&nbsp;<span class="op" id="4751972">&gt;</span>&nbsp;<span class="num" id="4751974">0</span>&nbsp;<span class="op" id="4751976">&amp;&amp;</span>&nbsp;<span class="ident" id="4751979"><a href="/regexp/syntax/parse.go.html#4751844">p</a></span><span class="op" id="4751980">.</span><span class="ident" id="4751981">stack</span><span class="op" id="4751986">[</span><span class="ident" id="4751987"><a href="/regexp/syntax/parse.go.html#4751947">i</a></span><span class="op" id="4751988">-</span><span class="num" id="4751989">1</span><span class="op" id="4751990">]</span><span class="op" id="4751991">.</span><span class="ident" id="4751992">Op</span>&nbsp;<span class="op" id="4751995">&lt;</span>&nbsp;<span class="ident" id="4751997"><a href="/regexp/syntax/regexp.go.html#4802167">opPseudo</a></span>&nbsp;<span class="op" id="4752006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752010"><a href="/regexp/syntax/parse.go.html#4751947">i</a></span><span class="op" id="4752011">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752018">subs</span>&nbsp;<span class="op" id="4752023">:=</span>&nbsp;<span class="ident" id="4752026"><a href="/regexp/syntax/parse.go.html#4751844">p</a></span><span class="op" id="4752027">.</span><span class="ident" id="4752028">stack</span><span class="op" id="4752033">[</span><span class="ident" id="4752034"><a href="/regexp/syntax/parse.go.html#4751947">i</a></span><span class="op" id="4752035">:</span><span class="op" id="4752036">]</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752039"><a href="/regexp/syntax/parse.go.html#4751844">p</a></span><span class="op" id="4752040">.</span><span class="ident" id="4752041">stack</span>&nbsp;<span class="op" id="4752047">=</span>&nbsp;<span class="ident" id="4752049"><a href="/regexp/syntax/parse.go.html#4751844">p</a></span><span class="op" id="4752050">.</span><span class="ident" id="4752051">stack</span><span class="op" id="4752056">[</span><span class="op" id="4752057">:</span><span class="ident" id="4752058"><a href="/regexp/syntax/parse.go.html#4751947">i</a></span><span class="op" id="4752059">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4752063">//&nbsp;Make&nbsp;sure&nbsp;top&nbsp;class&nbsp;is&nbsp;clean.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4752097">//&nbsp;All&nbsp;the&nbsp;others&nbsp;already&nbsp;are&nbsp;(see&nbsp;swapVerticalBar).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752151">if</span>&nbsp;<span class="builtinfunc" id="4752154">len</span><span class="op" id="4752157">(</span><span class="ident" id="4752158"><a href="/regexp/syntax/parse.go.html#4752018">subs</a></span><span class="op" id="4752162">)</span>&nbsp;<span class="op" id="4752164">&gt;</span>&nbsp;<span class="num" id="4752166">0</span>&nbsp;<span class="op" id="4752168">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752172"><a href="/regexp/syntax/parse.go.html#4752466">cleanAlt</a></span><span class="op" id="4752180">(</span><span class="ident" id="4752181"><a href="/regexp/syntax/parse.go.html#4752018">subs</a></span><span class="op" id="4752185">[</span><span class="builtinfunc" id="4752186">len</span><span class="op" id="4752189">(</span><span class="ident" id="4752190"><a href="/regexp/syntax/parse.go.html#4752018">subs</a></span><span class="op" id="4752194">)</span><span class="op" id="4752195">-</span><span class="num" id="4752196">1</span><span class="op" id="4752197">]</span><span class="op" id="4752198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4752205">//&nbsp;Empty&nbsp;alternate&nbsp;is&nbsp;special&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4752241">//&nbsp;(shouldn&#39;t&nbsp;happen&nbsp;but&nbsp;easy&nbsp;to&nbsp;handle).</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752284">if</span>&nbsp;<span class="builtinfunc" id="4752287">len</span><span class="op" id="4752290">(</span><span class="ident" id="4752291"><a href="/regexp/syntax/parse.go.html#4752018">subs</a></span><span class="op" id="4752295">)</span>&nbsp;<span class="op" id="4752297">==</span>&nbsp;<span class="num" id="4752300">0</span>&nbsp;<span class="op" id="4752302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752306">return</span>&nbsp;<span class="ident" id="4752313"><a href="/regexp/syntax/parse.go.html#4751844">p</a></span><span class="op" id="4752314">.</span><span class="ident" id="4752315">push</span><span class="op" id="4752319">(</span><span class="ident" id="4752320"><a href="/regexp/syntax/parse.go.html#4751844">p</a></span><span class="op" id="4752321">.</span><span class="ident" id="4752322">newRegexp</span><span class="op" id="4752331">(</span><span class="ident" id="4752332"><a href="/regexp/syntax/regexp.go.html#4800825">OpNoMatch</a></span><span class="op" id="4752341">)</span><span class="op" id="4752342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752349">return</span>&nbsp;<span class="ident" id="4752356"><a href="/regexp/syntax/parse.go.html#4751844">p</a></span><span class="op" id="4752357">.</span><span class="ident" id="4752358">push</span><span class="op" id="4752362">(</span><span class="ident" id="4752363"><a href="/regexp/syntax/parse.go.html#4751844">p</a></span><span class="op" id="4752364">.</span><span class="ident" id="4752365">collapse</span><span class="op" id="4752373">(</span><span class="ident" id="4752374"><a href="/regexp/syntax/parse.go.html#4752018">subs</a></span><span class="op" id="4752378">,</span>&nbsp;<span class="ident" id="4752380"><a href="/regexp/syntax/regexp.go.html#4802096">OpAlternate</a></span><span class="op" id="4752391">)</span><span class="op" id="4752392">)</span><br>
<span class="lineno">340</span><span class="op" id="4752394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4752397">//&nbsp;cleanAlt&nbsp;cleans&nbsp;re&nbsp;for&nbsp;eventual&nbsp;inclusion&nbsp;in&nbsp;an&nbsp;alternation.</span><br>
<span class="lineno"></span><span class="keyword" id="4752461">func</span>&nbsp;<span class="ident" id="4752466">cleanAlt</span><span class="op" id="4752474">(</span><span class="ident" id="4752475">re</span>&nbsp;<span class="op" id="4752478">*</span><span class="ident" id="4752479"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4752485">)</span>&nbsp;<span class="op" id="4752487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752490">switch</span>&nbsp;<span class="ident" id="4752497"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752499">.</span><span class="ident" id="4752500">Op</span>&nbsp;<span class="op" id="4752503">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752506">case</span>&nbsp;<span class="ident" id="4752511"><a href="/regexp/syntax/regexp.go.html#4800993">OpCharClass</a></span><span class="op" id="4752522">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752526"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752528">.</span><span class="ident" id="4752529">Rune</span>&nbsp;<span class="op" id="4752534">=</span>&nbsp;<span class="ident" id="4752536"><a href="/regexp/syntax/parse.go.html#4782865">cleanClass</a></span><span class="op" id="4752546">(</span><span class="op" id="4752547">&amp;</span><span class="ident" id="4752548"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752550">.</span><span class="ident" id="4752551">Rune</span><span class="op" id="4752555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752559">if</span>&nbsp;<span class="builtinfunc" id="4752562">len</span><span class="op" id="4752565">(</span><span class="ident" id="4752566"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752568">.</span><span class="ident" id="4752569">Rune</span><span class="op" id="4752573">)</span>&nbsp;<span class="op" id="4752575">==</span>&nbsp;<span class="num" id="4752578">2</span>&nbsp;<span class="op" id="4752580">&amp;&amp;</span>&nbsp;<span class="ident" id="4752583"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752585">.</span><span class="ident" id="4752586">Rune</span><span class="op" id="4752590">[</span><span class="num" id="4752591">0</span><span class="op" id="4752592">]</span>&nbsp;<span class="op" id="4752594">==</span>&nbsp;<span class="num" id="4752597">0</span>&nbsp;<span class="op" id="4752599">&amp;&amp;</span>&nbsp;<span class="ident" id="4752602"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752604">.</span><span class="ident" id="4752605">Rune</span><span class="op" id="4752609">[</span><span class="num" id="4752610">1</span><span class="op" id="4752611">]</span>&nbsp;<span class="op" id="4752613">==</span>&nbsp;<span class="ident" id="4752616"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4752623">.</span><span class="ident" id="4752624">MaxRune</span>&nbsp;<span class="op" id="4752632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752637"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752639">.</span><span class="ident" id="4752640">Rune</span>&nbsp;<span class="op" id="4752645">=</span>&nbsp;<span class="ident" id="4752647">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752654"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752656">.</span><span class="ident" id="4752657">Op</span>&nbsp;<span class="op" id="4752660">=</span>&nbsp;<span class="ident" id="4752662"><a href="/regexp/syntax/regexp.go.html#4801145">OpAnyChar</a></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752675">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752688">if</span>&nbsp;<span class="builtinfunc" id="4752691">len</span><span class="op" id="4752694">(</span><span class="ident" id="4752695"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752697">.</span><span class="ident" id="4752698">Rune</span><span class="op" id="4752702">)</span>&nbsp;<span class="op" id="4752704">==</span>&nbsp;<span class="num" id="4752707">4</span>&nbsp;<span class="op" id="4752709">&amp;&amp;</span>&nbsp;<span class="ident" id="4752712"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752714">.</span><span class="ident" id="4752715">Rune</span><span class="op" id="4752719">[</span><span class="num" id="4752720">0</span><span class="op" id="4752721">]</span>&nbsp;<span class="op" id="4752723">==</span>&nbsp;<span class="num" id="4752726">0</span>&nbsp;<span class="op" id="4752728">&amp;&amp;</span>&nbsp;<span class="ident" id="4752731"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752733">.</span><span class="ident" id="4752734">Rune</span><span class="op" id="4752738">[</span><span class="num" id="4752739">1</span><span class="op" id="4752740">]</span>&nbsp;<span class="op" id="4752742">==</span>&nbsp;<span class="string" id="4752745">&#39;\n&#39;</span><span class="op" id="4752749">-</span><span class="num" id="4752750">1</span>&nbsp;<span class="op" id="4752752">&amp;&amp;</span>&nbsp;<span class="ident" id="4752755"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752757">.</span><span class="ident" id="4752758">Rune</span><span class="op" id="4752762">[</span><span class="num" id="4752763">2</span><span class="op" id="4752764">]</span>&nbsp;<span class="op" id="4752766">==</span>&nbsp;<span class="string" id="4752769">&#39;\n&#39;</span><span class="op" id="4752773">+</span><span class="num" id="4752774">1</span>&nbsp;<span class="op" id="4752776">&amp;&amp;</span>&nbsp;<span class="ident" id="4752779"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752781">.</span><span class="ident" id="4752782">Rune</span><span class="op" id="4752786">[</span><span class="num" id="4752787">3</span><span class="op" id="4752788">]</span>&nbsp;<span class="op" id="4752790">==</span>&nbsp;<span class="ident" id="4752793"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4752800">.</span><span class="ident" id="4752801">MaxRune</span>&nbsp;<span class="op" id="4752809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752814"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752816">.</span><span class="ident" id="4752817">Rune</span>&nbsp;<span class="op" id="4752822">=</span>&nbsp;<span class="ident" id="4752824">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752831"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752833">.</span><span class="ident" id="4752834">Op</span>&nbsp;<span class="op" id="4752837">=</span>&nbsp;<span class="ident" id="4752839"><a href="/regexp/syntax/regexp.go.html#4801073">OpAnyCharNotNL</a></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752857">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752870">if</span>&nbsp;<span class="builtinfunc" id="4752873">cap</span><span class="op" id="4752876">(</span><span class="ident" id="4752877"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752879">.</span><span class="ident" id="4752880">Rune</span><span class="op" id="4752884">)</span><span class="op" id="4752885">-</span><span class="builtinfunc" id="4752886">len</span><span class="op" id="4752889">(</span><span class="ident" id="4752890"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752892">.</span><span class="ident" id="4752893">Rune</span><span class="op" id="4752897">)</span>&nbsp;<span class="op" id="4752899">&gt;</span>&nbsp;<span class="num" id="4752901">100</span>&nbsp;<span class="op" id="4752905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4752910">//&nbsp;re.Rune&nbsp;will&nbsp;not&nbsp;grow&nbsp;any&nbsp;more.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4752948">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;or&nbsp;inline&nbsp;to&nbsp;reclaim&nbsp;storage.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752996"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4752998">.</span><span class="ident" id="4752999">Rune</span>&nbsp;<span class="op" id="4753004">=</span>&nbsp;<span class="builtinfunc" id="4753006">append</span><span class="op" id="4753012">(</span><span class="ident" id="4753013"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4753015">.</span><span class="ident" id="4753016">Rune0</span><span class="op" id="4753021">[</span><span class="op" id="4753022">:</span><span class="num" id="4753023">0</span><span class="op" id="4753024">]</span><span class="op" id="4753025">,</span>&nbsp;<span class="ident" id="4753027"><a href="/regexp/syntax/parse.go.html#4752475">re</a></span><span class="op" id="4753029">.</span><span class="ident" id="4753030">Rune</span><span class="op" id="4753034">...</span><span class="op" id="4753037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753044">}</span><br>
<span class="lineno"></span><span class="op" id="4753046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4753049">//&nbsp;collapse&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;applying&nbsp;op&nbsp;to&nbsp;sub.</span><br>
<span class="lineno"></span><span class="comment" id="4753103">//&nbsp;If&nbsp;sub&nbsp;contains&nbsp;op&nbsp;nodes,&nbsp;they&nbsp;all&nbsp;get&nbsp;hoisted&nbsp;up</span><br>
<span class="lineno"></span><span class="comment" id="4753156">//&nbsp;so&nbsp;that&nbsp;there&nbsp;is&nbsp;never&nbsp;a&nbsp;concat&nbsp;of&nbsp;a&nbsp;concat&nbsp;or&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4753209">//&nbsp;alternate&nbsp;of&nbsp;an&nbsp;alternate.</span><br>
<span class="lineno"></span><span class="keyword" id="4753239">func</span>&nbsp;<span class="op" id="4753244">(</span><span class="ident" id="4753245">p</span>&nbsp;<span class="op" id="4753247">*</span><span class="ident" id="4753248"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4753254">)</span>&nbsp;<span class="ident" id="4753256">collapse</span><span class="op" id="4753264">(</span><span class="ident" id="4753265">subs</span>&nbsp;<span class="op" id="4753270">[</span><span class="op" id="4753271">]</span><span class="op" id="4753272">*</span><span class="ident" id="4753273"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4753279">,</span>&nbsp;<span class="ident" id="4753281">op</span>&nbsp;<span class="ident" id="4753284"><a href="/regexp/syntax/regexp.go.html#4800610">Op</a></span><span class="op" id="4753286">)</span>&nbsp;<span class="op" id="4753288">*</span><span class="ident" id="4753289"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="op" id="4753296">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753299">if</span>&nbsp;<span class="builtinfunc" id="4753302">len</span><span class="op" id="4753305">(</span><span class="ident" id="4753306"><a href="/regexp/syntax/parse.go.html#4753265">subs</a></span><span class="op" id="4753310">)</span>&nbsp;<span class="op" id="4753312">==</span>&nbsp;<span class="num" id="4753315">1</span>&nbsp;<span class="op" id="4753317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753321">return</span>&nbsp;<span class="ident" id="4753328"><a href="/regexp/syntax/parse.go.html#4753265">subs</a></span><span class="op" id="4753332">[</span><span class="num" id="4753333">0</span><span class="op" id="4753334">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753340">re</span>&nbsp;<span class="op" id="4753343">:=</span>&nbsp;<span class="ident" id="4753346"><a href="/regexp/syntax/parse.go.html#4753245">p</a></span><span class="op" id="4753347">.</span><span class="ident" id="4753348">newRegexp</span><span class="op" id="4753357">(</span><span class="ident" id="4753358"><a href="/regexp/syntax/parse.go.html#4753281">op</a></span><span class="op" id="4753360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753363"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><span class="op" id="4753365">.</span><span class="ident" id="4753366">Sub</span>&nbsp;<span class="op" id="4753370">=</span>&nbsp;<span class="ident" id="4753372"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><span class="op" id="4753374">.</span><span class="ident" id="4753375">Sub0</span><span class="op" id="4753379">[</span><span class="op" id="4753380">:</span><span class="num" id="4753381">0</span><span class="op" id="4753382">]</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753385">for</span>&nbsp;<span class="ident" id="4753389">_</span><span class="op" id="4753390">,</span>&nbsp;<span class="ident" id="4753392">sub</span>&nbsp;<span class="op" id="4753396">:=</span>&nbsp;<span class="keyword" id="4753399">range</span>&nbsp;<span class="ident" id="4753405"><a href="/regexp/syntax/parse.go.html#4753265">subs</a></span>&nbsp;<span class="op" id="4753410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753414">if</span>&nbsp;<span class="ident" id="4753417"><a href="/regexp/syntax/parse.go.html#4753392">sub</a></span><span class="op" id="4753420">.</span><span class="ident" id="4753421">Op</span>&nbsp;<span class="op" id="4753424">==</span>&nbsp;<span class="ident" id="4753427"><a href="/regexp/syntax/parse.go.html#4753281">op</a></span>&nbsp;<span class="op" id="4753430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753435"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><span class="op" id="4753437">.</span><span class="ident" id="4753438">Sub</span>&nbsp;<span class="op" id="4753442">=</span>&nbsp;<span class="builtinfunc" id="4753444">append</span><span class="op" id="4753450">(</span><span class="ident" id="4753451"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><span class="op" id="4753453">.</span><span class="ident" id="4753454">Sub</span><span class="op" id="4753457">,</span>&nbsp;<span class="ident" id="4753459"><a href="/regexp/syntax/parse.go.html#4753392">sub</a></span><span class="op" id="4753462">.</span><span class="ident" id="4753463">Sub</span><span class="op" id="4753466">...</span><span class="op" id="4753469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753474"><a href="/regexp/syntax/parse.go.html#4753245">p</a></span><span class="op" id="4753475">.</span><span class="ident" id="4753476">reuse</span><span class="op" id="4753481">(</span><span class="ident" id="4753482"><a href="/regexp/syntax/parse.go.html#4753392">sub</a></span><span class="op" id="4753485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753489">}</span>&nbsp;<span class="keyword" id="4753491">else</span>&nbsp;<span class="op" id="4753496">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753501"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><span class="op" id="4753503">.</span><span class="ident" id="4753504">Sub</span>&nbsp;<span class="op" id="4753508">=</span>&nbsp;<span class="builtinfunc" id="4753510">append</span><span class="op" id="4753516">(</span><span class="ident" id="4753517"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><span class="op" id="4753519">.</span><span class="ident" id="4753520">Sub</span><span class="op" id="4753523">,</span>&nbsp;<span class="ident" id="4753525"><a href="/regexp/syntax/parse.go.html#4753392">sub</a></span><span class="op" id="4753528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753538">if</span>&nbsp;<span class="ident" id="4753541"><a href="/regexp/syntax/parse.go.html#4753281">op</a></span>&nbsp;<span class="op" id="4753544">==</span>&nbsp;<span class="ident" id="4753547"><a href="/regexp/syntax/regexp.go.html#4802096">OpAlternate</a></span>&nbsp;<span class="op" id="4753559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753563"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><span class="op" id="4753565">.</span><span class="ident" id="4753566">Sub</span>&nbsp;<span class="op" id="4753570">=</span>&nbsp;<span class="ident" id="4753572"><a href="/regexp/syntax/parse.go.html#4753245">p</a></span><span class="op" id="4753573">.</span><span class="ident" id="4753574">factor</span><span class="op" id="4753580">(</span><span class="ident" id="4753581"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><span class="op" id="4753583">.</span><span class="ident" id="4753584">Sub</span><span class="op" id="4753587">,</span>&nbsp;<span class="ident" id="4753589"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><span class="op" id="4753591">.</span><span class="ident" id="4753592">Flags</span><span class="op" id="4753597">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753601">if</span>&nbsp;<span class="builtinfunc" id="4753604">len</span><span class="op" id="4753607">(</span><span class="ident" id="4753608"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><span class="op" id="4753610">.</span><span class="ident" id="4753611">Sub</span><span class="op" id="4753614">)</span>&nbsp;<span class="op" id="4753616">==</span>&nbsp;<span class="num" id="4753619">1</span>&nbsp;<span class="op" id="4753621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753626">old</span>&nbsp;<span class="op" id="4753630">:=</span>&nbsp;<span class="ident" id="4753633"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753639"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span>&nbsp;<span class="op" id="4753642">=</span>&nbsp;<span class="ident" id="4753644"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><span class="op" id="4753646">.</span><span class="ident" id="4753647">Sub</span><span class="op" id="4753650">[</span><span class="num" id="4753651">0</span><span class="op" id="4753652">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753657"><a href="/regexp/syntax/parse.go.html#4753245">p</a></span><span class="op" id="4753658">.</span><span class="ident" id="4753659">reuse</span><span class="op" id="4753664">(</span><span class="ident" id="4753665"><a href="/regexp/syntax/parse.go.html#4753626">old</a></span><span class="op" id="4753668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753672">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753678">return</span>&nbsp;<span class="ident" id="4753685"><a href="/regexp/syntax/parse.go.html#4753340">re</a></span><br>
<span class="lineno"></span><span class="op" id="4753688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4753691">//&nbsp;factor&nbsp;factors&nbsp;common&nbsp;prefixes&nbsp;from&nbsp;the&nbsp;alternation&nbsp;list&nbsp;sub.</span><br>
<span class="lineno">395</span><span class="comment" id="4753756">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;replacement&nbsp;list&nbsp;that&nbsp;reuses&nbsp;the&nbsp;same&nbsp;storage&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4753822">//&nbsp;frees&nbsp;(passes&nbsp;to&nbsp;p.reuse)&nbsp;any&nbsp;removed&nbsp;*Regexps.</span><br>
<span class="lineno"></span><span class="comment" id="4753873">//</span><br>
<span class="lineno"></span><span class="comment" id="4753876">//&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span><span class="comment" id="4753892">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABC|ABD|AEF|BCX|BCY</span><br>
<span class="lineno">400</span><span class="comment" id="4753919">//&nbsp;simplifies&nbsp;by&nbsp;literal&nbsp;prefix&nbsp;extraction&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4753965">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A(B(C|D)|EF)|BC(X|Y)</span><br>
<span class="lineno"></span><span class="comment" id="4753993">//&nbsp;which&nbsp;simplifies&nbsp;by&nbsp;character&nbsp;class&nbsp;introduction&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4754048">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A(B[CD]|EF)|BC[XY]</span><br>
<span class="lineno"></span><span class="comment" id="4754074">//</span><br>
<span class="lineno">405</span><span class="keyword" id="4754077">func</span>&nbsp;<span class="op" id="4754082">(</span><span class="ident" id="4754083">p</span>&nbsp;<span class="op" id="4754085">*</span><span class="ident" id="4754086"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4754092">)</span>&nbsp;<span class="ident" id="4754094">factor</span><span class="op" id="4754100">(</span><span class="ident" id="4754101">sub</span>&nbsp;<span class="op" id="4754105">[</span><span class="op" id="4754106">]</span><span class="op" id="4754107">*</span><span class="ident" id="4754108"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4754114">,</span>&nbsp;<span class="ident" id="4754116">flags</span>&nbsp;<span class="ident" id="4754122"><a href="/regexp/syntax/parse.go.html#4744412">Flags</a></span><span class="op" id="4754127">)</span>&nbsp;<span class="op" id="4754129">[</span><span class="op" id="4754130">]</span><span class="op" id="4754131">*</span><span class="ident" id="4754132"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="op" id="4754139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754142">if</span>&nbsp;<span class="builtinfunc" id="4754145">len</span><span class="op" id="4754148">(</span><span class="ident" id="4754149"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4754152">)</span>&nbsp;<span class="op" id="4754154">&lt;</span>&nbsp;<span class="num" id="4754156">2</span>&nbsp;<span class="op" id="4754158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754162">return</span>&nbsp;<span class="ident" id="4754169"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754178">//&nbsp;Round&nbsp;1:&nbsp;Factor&nbsp;out&nbsp;common&nbsp;literal&nbsp;prefixes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754227">var</span>&nbsp;<span class="ident" id="4754231">str</span>&nbsp;<span class="op" id="4754235">[</span><span class="op" id="4754236">]</span><span class="builtintype" id="4754237">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754243">var</span>&nbsp;<span class="ident" id="4754247">strflags</span>&nbsp;<span class="ident" id="4754256"><a href="/regexp/syntax/parse.go.html#4744412">Flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754263">start</span>&nbsp;<span class="op" id="4754269">:=</span>&nbsp;<span class="num" id="4754272">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754275">out</span>&nbsp;<span class="op" id="4754279">:=</span>&nbsp;<span class="ident" id="4754282"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4754285">[</span><span class="op" id="4754286">:</span><span class="num" id="4754287">0</span><span class="op" id="4754288">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754291">for</span>&nbsp;<span class="ident" id="4754295">i</span>&nbsp;<span class="op" id="4754297">:=</span>&nbsp;<span class="num" id="4754300">0</span><span class="op" id="4754301">;</span>&nbsp;<span class="ident" id="4754303"><a href="/regexp/syntax/parse.go.html#4754295">i</a></span>&nbsp;<span class="op" id="4754305">&lt;=</span>&nbsp;<span class="builtinfunc" id="4754308">len</span><span class="op" id="4754311">(</span><span class="ident" id="4754312"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4754315">)</span><span class="op" id="4754316">;</span>&nbsp;<span class="ident" id="4754318"><a href="/regexp/syntax/parse.go.html#4754295">i</a></span><span class="op" id="4754319">++</span>&nbsp;<span class="op" id="4754322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754326">//&nbsp;Invariant:&nbsp;the&nbsp;Regexps&nbsp;that&nbsp;were&nbsp;in&nbsp;sub[0:start]&nbsp;have&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754390">//&nbsp;used&nbsp;or&nbsp;marked&nbsp;for&nbsp;reuse,&nbsp;and&nbsp;the&nbsp;slice&nbsp;space&nbsp;has&nbsp;been&nbsp;reused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754457">//&nbsp;for&nbsp;out&nbsp;(len(out)&nbsp;&lt;=&nbsp;start).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754491">//</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754496">//&nbsp;Invariant:&nbsp;sub[start:i]&nbsp;consists&nbsp;of&nbsp;regexps&nbsp;that&nbsp;all&nbsp;begin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754560">//&nbsp;with&nbsp;str&nbsp;as&nbsp;modified&nbsp;by&nbsp;strflags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754599">var</span>&nbsp;<span class="ident" id="4754603">istr</span>&nbsp;<span class="op" id="4754608">[</span><span class="op" id="4754609">]</span><span class="builtintype" id="4754610">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754617">var</span>&nbsp;<span class="ident" id="4754621">iflags</span>&nbsp;<span class="ident" id="4754628"><a href="/regexp/syntax/parse.go.html#4744412">Flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754636">if</span>&nbsp;<span class="ident" id="4754639"><a href="/regexp/syntax/parse.go.html#4754295">i</a></span>&nbsp;<span class="op" id="4754641">&lt;</span>&nbsp;<span class="builtinfunc" id="4754643">len</span><span class="op" id="4754646">(</span><span class="ident" id="4754647"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4754650">)</span>&nbsp;<span class="op" id="4754652">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754657"><a href="/regexp/syntax/parse.go.html#4754603">istr</a></span><span class="op" id="4754661">,</span>&nbsp;<span class="ident" id="4754663"><a href="/regexp/syntax/parse.go.html#4754621">iflags</a></span>&nbsp;<span class="op" id="4754670">=</span>&nbsp;<span class="ident" id="4754672"><a href="/regexp/syntax/parse.go.html#4754083">p</a></span><span class="op" id="4754673">.</span><span class="ident" id="4754674">leadingString</span><span class="op" id="4754687">(</span><span class="ident" id="4754688"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4754691">[</span><span class="ident" id="4754692"><a href="/regexp/syntax/parse.go.html#4754295">i</a></span><span class="op" id="4754693">]</span><span class="op" id="4754694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754699">if</span>&nbsp;<span class="ident" id="4754702"><a href="/regexp/syntax/parse.go.html#4754621">iflags</a></span>&nbsp;<span class="op" id="4754709">==</span>&nbsp;<span class="ident" id="4754712"><a href="/regexp/syntax/parse.go.html#4754247">strflags</a></span>&nbsp;<span class="op" id="4754721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754727">same</span>&nbsp;<span class="op" id="4754732">:=</span>&nbsp;<span class="num" id="4754735">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754741">for</span>&nbsp;<span class="ident" id="4754745"><a href="/regexp/syntax/parse.go.html#4754727">same</a></span>&nbsp;<span class="op" id="4754750">&lt;</span>&nbsp;<span class="builtinfunc" id="4754752">len</span><span class="op" id="4754755">(</span><span class="ident" id="4754756"><a href="/regexp/syntax/parse.go.html#4754231">str</a></span><span class="op" id="4754759">)</span>&nbsp;<span class="op" id="4754761">&amp;&amp;</span>&nbsp;<span class="ident" id="4754764"><a href="/regexp/syntax/parse.go.html#4754727">same</a></span>&nbsp;<span class="op" id="4754769">&lt;</span>&nbsp;<span class="builtinfunc" id="4754771">len</span><span class="op" id="4754774">(</span><span class="ident" id="4754775"><a href="/regexp/syntax/parse.go.html#4754603">istr</a></span><span class="op" id="4754779">)</span>&nbsp;<span class="op" id="4754781">&amp;&amp;</span>&nbsp;<span class="ident" id="4754784"><a href="/regexp/syntax/parse.go.html#4754231">str</a></span><span class="op" id="4754787">[</span><span class="ident" id="4754788"><a href="/regexp/syntax/parse.go.html#4754727">same</a></span><span class="op" id="4754792">]</span>&nbsp;<span class="op" id="4754794">==</span>&nbsp;<span class="ident" id="4754797"><a href="/regexp/syntax/parse.go.html#4754603">istr</a></span><span class="op" id="4754801">[</span><span class="ident" id="4754802"><a href="/regexp/syntax/parse.go.html#4754727">same</a></span><span class="op" id="4754806">]</span>&nbsp;<span class="op" id="4754808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754815"><a href="/regexp/syntax/parse.go.html#4754727">same</a></span><span class="op" id="4754819">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754832">if</span>&nbsp;<span class="ident" id="4754835"><a href="/regexp/syntax/parse.go.html#4754727">same</a></span>&nbsp;<span class="op" id="4754840">&gt;</span>&nbsp;<span class="num" id="4754842">0</span>&nbsp;<span class="op" id="4754844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754851">//&nbsp;Matches&nbsp;at&nbsp;least&nbsp;one&nbsp;rune&nbsp;in&nbsp;current&nbsp;range.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754903">//&nbsp;Keep&nbsp;going&nbsp;around.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754930"><a href="/regexp/syntax/parse.go.html#4754231">str</a></span>&nbsp;<span class="op" id="4754934">=</span>&nbsp;<span class="ident" id="4754936"><a href="/regexp/syntax/parse.go.html#4754231">str</a></span><span class="op" id="4754939">[</span><span class="op" id="4754940">:</span><span class="ident" id="4754941"><a href="/regexp/syntax/parse.go.html#4754727">same</a></span><span class="op" id="4754945">]</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754952">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754979">//&nbsp;Found&nbsp;end&nbsp;of&nbsp;a&nbsp;run&nbsp;with&nbsp;common&nbsp;leading&nbsp;literal&nbsp;string:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4755039">//&nbsp;sub[start:i]&nbsp;all&nbsp;begin&nbsp;with&nbsp;str[0:len(str)],&nbsp;but&nbsp;sub[i]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4755100">//&nbsp;does&nbsp;not&nbsp;even&nbsp;begin&nbsp;with&nbsp;str[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4755138">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4755143">//&nbsp;Factor&nbsp;out&nbsp;common&nbsp;string&nbsp;and&nbsp;append&nbsp;factored&nbsp;expression&nbsp;to&nbsp;out.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4755212">if</span>&nbsp;<span class="ident" id="4755215"><a href="/regexp/syntax/parse.go.html#4754295">i</a></span>&nbsp;<span class="op" id="4755217">==</span>&nbsp;<span class="ident" id="4755220"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span>&nbsp;<span class="op" id="4755226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4755231">//&nbsp;Nothing&nbsp;to&nbsp;do&nbsp;-&nbsp;run&nbsp;of&nbsp;length&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4755269">}</span>&nbsp;<span class="keyword" id="4755271">else</span>&nbsp;<span class="keyword" id="4755276">if</span>&nbsp;<span class="ident" id="4755279"><a href="/regexp/syntax/parse.go.html#4754295">i</a></span>&nbsp;<span class="op" id="4755281">==</span>&nbsp;<span class="ident" id="4755284"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4755289">+</span><span class="num" id="4755290">1</span>&nbsp;<span class="op" id="4755292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4755297">//&nbsp;Just&nbsp;one:&nbsp;don&#39;t&nbsp;bother&nbsp;factoring.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755337"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span>&nbsp;<span class="op" id="4755341">=</span>&nbsp;<span class="builtinfunc" id="4755343">append</span><span class="op" id="4755349">(</span><span class="ident" id="4755350"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span><span class="op" id="4755353">,</span>&nbsp;<span class="ident" id="4755355"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4755358">[</span><span class="ident" id="4755359"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4755364">]</span><span class="op" id="4755365">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4755369">}</span>&nbsp;<span class="keyword" id="4755371">else</span>&nbsp;<span class="op" id="4755376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4755381">//&nbsp;Construct&nbsp;factored&nbsp;form:&nbsp;prefix(suffix1|suffix2|...)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755440">prefix</span>&nbsp;<span class="op" id="4755447">:=</span>&nbsp;<span class="ident" id="4755450"><a href="/regexp/syntax/parse.go.html#4754083">p</a></span><span class="op" id="4755451">.</span><span class="ident" id="4755452">newRegexp</span><span class="op" id="4755461">(</span><span class="ident" id="4755462"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span><span class="op" id="4755471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755476"><a href="/regexp/syntax/parse.go.html#4755440">prefix</a></span><span class="op" id="4755482">.</span><span class="ident" id="4755483">Flags</span>&nbsp;<span class="op" id="4755489">=</span>&nbsp;<span class="ident" id="4755491"><a href="/regexp/syntax/parse.go.html#4754247">strflags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755503"><a href="/regexp/syntax/parse.go.html#4755440">prefix</a></span><span class="op" id="4755509">.</span><span class="ident" id="4755510">Rune</span>&nbsp;<span class="op" id="4755515">=</span>&nbsp;<span class="builtinfunc" id="4755517">append</span><span class="op" id="4755523">(</span><span class="ident" id="4755524"><a href="/regexp/syntax/parse.go.html#4755440">prefix</a></span><span class="op" id="4755530">.</span><span class="ident" id="4755531">Rune</span><span class="op" id="4755535">[</span><span class="op" id="4755536">:</span><span class="num" id="4755537">0</span><span class="op" id="4755538">]</span><span class="op" id="4755539">,</span>&nbsp;<span class="ident" id="4755541"><a href="/regexp/syntax/parse.go.html#4754231">str</a></span><span class="op" id="4755544">...</span><span class="op" id="4755547">)</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4755553">for</span>&nbsp;<span class="ident" id="4755557">j</span>&nbsp;<span class="op" id="4755559">:=</span>&nbsp;<span class="ident" id="4755562"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4755567">;</span>&nbsp;<span class="ident" id="4755569"><a href="/regexp/syntax/parse.go.html#4755557">j</a></span>&nbsp;<span class="op" id="4755571">&lt;</span>&nbsp;<span class="ident" id="4755573"><a href="/regexp/syntax/parse.go.html#4754295">i</a></span><span class="op" id="4755574">;</span>&nbsp;<span class="ident" id="4755576"><a href="/regexp/syntax/parse.go.html#4755557">j</a></span><span class="op" id="4755577">++</span>&nbsp;<span class="op" id="4755580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755586"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4755589">[</span><span class="ident" id="4755590"><a href="/regexp/syntax/parse.go.html#4755557">j</a></span><span class="op" id="4755591">]</span>&nbsp;<span class="op" id="4755593">=</span>&nbsp;<span class="ident" id="4755595"><a href="/regexp/syntax/parse.go.html#4754083">p</a></span><span class="op" id="4755596">.</span><span class="ident" id="4755597">removeLeadingString</span><span class="op" id="4755616">(</span><span class="ident" id="4755617"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4755620">[</span><span class="ident" id="4755621"><a href="/regexp/syntax/parse.go.html#4755557">j</a></span><span class="op" id="4755622">]</span><span class="op" id="4755623">,</span>&nbsp;<span class="builtinfunc" id="4755625">len</span><span class="op" id="4755628">(</span><span class="ident" id="4755629"><a href="/regexp/syntax/parse.go.html#4754231">str</a></span><span class="op" id="4755632">)</span><span class="op" id="4755633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4755638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755643">suffix</span>&nbsp;<span class="op" id="4755650">:=</span>&nbsp;<span class="ident" id="4755653"><a href="/regexp/syntax/parse.go.html#4754083">p</a></span><span class="op" id="4755654">.</span><span class="ident" id="4755655">collapse</span><span class="op" id="4755663">(</span><span class="ident" id="4755664"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4755667">[</span><span class="ident" id="4755668"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4755673">:</span><span class="ident" id="4755674"><a href="/regexp/syntax/parse.go.html#4754295">i</a></span><span class="op" id="4755675">]</span><span class="op" id="4755676">,</span>&nbsp;<span class="ident" id="4755678"><a href="/regexp/syntax/regexp.go.html#4802096">OpAlternate</a></span><span class="op" id="4755689">)</span>&nbsp;<span class="comment" id="4755691">//&nbsp;recurse</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755706">re</span>&nbsp;<span class="op" id="4755709">:=</span>&nbsp;<span class="ident" id="4755712"><a href="/regexp/syntax/parse.go.html#4754083">p</a></span><span class="op" id="4755713">.</span><span class="ident" id="4755714">newRegexp</span><span class="op" id="4755723">(</span><span class="ident" id="4755724"><a href="/regexp/syntax/regexp.go.html#4802031">OpConcat</a></span><span class="op" id="4755732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755737"><a href="/regexp/syntax/parse.go.html#4755706">re</a></span><span class="op" id="4755739">.</span><span class="ident" id="4755740">Sub</span>&nbsp;<span class="op" id="4755744">=</span>&nbsp;<span class="builtinfunc" id="4755746">append</span><span class="op" id="4755752">(</span><span class="ident" id="4755753"><a href="/regexp/syntax/parse.go.html#4755706">re</a></span><span class="op" id="4755755">.</span><span class="ident" id="4755756">Sub</span><span class="op" id="4755759">[</span><span class="op" id="4755760">:</span><span class="num" id="4755761">0</span><span class="op" id="4755762">]</span><span class="op" id="4755763">,</span>&nbsp;<span class="ident" id="4755765"><a href="/regexp/syntax/parse.go.html#4755440">prefix</a></span><span class="op" id="4755771">,</span>&nbsp;<span class="ident" id="4755773"><a href="/regexp/syntax/parse.go.html#4755643">suffix</a></span><span class="op" id="4755779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755784"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span>&nbsp;<span class="op" id="4755788">=</span>&nbsp;<span class="builtinfunc" id="4755790">append</span><span class="op" id="4755796">(</span><span class="ident" id="4755797"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span><span class="op" id="4755800">,</span>&nbsp;<span class="ident" id="4755802"><a href="/regexp/syntax/parse.go.html#4755706">re</a></span><span class="op" id="4755804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4755808">}</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4755813">//&nbsp;Prepare&nbsp;for&nbsp;next&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755846"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span>&nbsp;<span class="op" id="4755852">=</span>&nbsp;<span class="ident" id="4755854"><a href="/regexp/syntax/parse.go.html#4754295">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755858"><a href="/regexp/syntax/parse.go.html#4754231">str</a></span>&nbsp;<span class="op" id="4755862">=</span>&nbsp;<span class="ident" id="4755864"><a href="/regexp/syntax/parse.go.html#4754603">istr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755871"><a href="/regexp/syntax/parse.go.html#4754247">strflags</a></span>&nbsp;<span class="op" id="4755880">=</span>&nbsp;<span class="ident" id="4755882"><a href="/regexp/syntax/parse.go.html#4754621">iflags</a></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4755890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755893"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span>&nbsp;<span class="op" id="4755897">=</span>&nbsp;<span class="ident" id="4755899"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4755905">//&nbsp;Round&nbsp;2:&nbsp;Factor&nbsp;out&nbsp;common&nbsp;complex&nbsp;prefixes,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4755954">//&nbsp;just&nbsp;the&nbsp;first&nbsp;piece&nbsp;of&nbsp;each&nbsp;concatenation,</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756002">//&nbsp;whatever&nbsp;it&nbsp;is.&nbsp;&nbsp;This&nbsp;is&nbsp;good&nbsp;enough&nbsp;a&nbsp;lot&nbsp;of&nbsp;the&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756062"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span>&nbsp;<span class="op" id="4756068">=</span>&nbsp;<span class="num" id="4756070">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756073"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span>&nbsp;<span class="op" id="4756077">=</span>&nbsp;<span class="ident" id="4756079"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4756082">[</span><span class="op" id="4756083">:</span><span class="num" id="4756084">0</span><span class="op" id="4756085">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756088">var</span>&nbsp;<span class="ident" id="4756092">first</span>&nbsp;<span class="op" id="4756098">*</span><span class="ident" id="4756099"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756107">for</span>&nbsp;<span class="ident" id="4756111">i</span>&nbsp;<span class="op" id="4756113">:=</span>&nbsp;<span class="num" id="4756116">0</span><span class="op" id="4756117">;</span>&nbsp;<span class="ident" id="4756119"><a href="/regexp/syntax/parse.go.html#4756111">i</a></span>&nbsp;<span class="op" id="4756121">&lt;=</span>&nbsp;<span class="builtinfunc" id="4756124">len</span><span class="op" id="4756127">(</span><span class="ident" id="4756128"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4756131">)</span><span class="op" id="4756132">;</span>&nbsp;<span class="ident" id="4756134"><a href="/regexp/syntax/parse.go.html#4756111">i</a></span><span class="op" id="4756135">++</span>&nbsp;<span class="op" id="4756138">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756142">//&nbsp;Invariant:&nbsp;the&nbsp;Regexps&nbsp;that&nbsp;were&nbsp;in&nbsp;sub[0:start]&nbsp;have&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756206">//&nbsp;used&nbsp;or&nbsp;marked&nbsp;for&nbsp;reuse,&nbsp;and&nbsp;the&nbsp;slice&nbsp;space&nbsp;has&nbsp;been&nbsp;reused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756273">//&nbsp;for&nbsp;out&nbsp;(len(out)&nbsp;&lt;=&nbsp;start).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756307">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756312">//&nbsp;Invariant:&nbsp;sub[start:i]&nbsp;consists&nbsp;of&nbsp;regexps&nbsp;that&nbsp;all&nbsp;begin&nbsp;with&nbsp;ifirst.</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756389">var</span>&nbsp;<span class="ident" id="4756393">ifirst</span>&nbsp;<span class="op" id="4756400">*</span><span class="ident" id="4756401"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756410">if</span>&nbsp;<span class="ident" id="4756413"><a href="/regexp/syntax/parse.go.html#4756111">i</a></span>&nbsp;<span class="op" id="4756415">&lt;</span>&nbsp;<span class="builtinfunc" id="4756417">len</span><span class="op" id="4756420">(</span><span class="ident" id="4756421"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4756424">)</span>&nbsp;<span class="op" id="4756426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756431"><a href="/regexp/syntax/parse.go.html#4756393">ifirst</a></span>&nbsp;<span class="op" id="4756438">=</span>&nbsp;<span class="ident" id="4756440"><a href="/regexp/syntax/parse.go.html#4754083">p</a></span><span class="op" id="4756441">.</span><span class="ident" id="4756442">leadingRegexp</span><span class="op" id="4756455">(</span><span class="ident" id="4756456"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4756459">[</span><span class="ident" id="4756460"><a href="/regexp/syntax/parse.go.html#4756111">i</a></span><span class="op" id="4756461">]</span><span class="op" id="4756462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756467">if</span>&nbsp;<span class="ident" id="4756470"><a href="/regexp/syntax/parse.go.html#4756092">first</a></span>&nbsp;<span class="op" id="4756476">!=</span>&nbsp;<span class="ident" id="4756479">nil</span>&nbsp;<span class="op" id="4756483">&amp;&amp;</span>&nbsp;<span class="ident" id="4756486"><a href="/regexp/syntax/parse.go.html#4756092">first</a></span><span class="op" id="4756491">.</span><span class="ident" id="4756492">Equal</span><span class="op" id="4756497">(</span><span class="ident" id="4756498"><a href="/regexp/syntax/parse.go.html#4756393">ifirst</a></span><span class="op" id="4756504">)</span>&nbsp;<span class="op" id="4756506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756512">continue</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4756524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4756528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756533">//&nbsp;Found&nbsp;end&nbsp;of&nbsp;a&nbsp;run&nbsp;with&nbsp;common&nbsp;leading&nbsp;regexp:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756585">//&nbsp;sub[start:i]&nbsp;all&nbsp;begin&nbsp;with&nbsp;first&nbsp;but&nbsp;sub[i]&nbsp;does&nbsp;not.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756645">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756650">//&nbsp;Factor&nbsp;out&nbsp;common&nbsp;regexp&nbsp;and&nbsp;append&nbsp;factored&nbsp;expression&nbsp;to&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756719">if</span>&nbsp;<span class="ident" id="4756722"><a href="/regexp/syntax/parse.go.html#4756111">i</a></span>&nbsp;<span class="op" id="4756724">==</span>&nbsp;<span class="ident" id="4756727"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span>&nbsp;<span class="op" id="4756733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756738">//&nbsp;Nothing&nbsp;to&nbsp;do&nbsp;-&nbsp;run&nbsp;of&nbsp;length&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4756776">}</span>&nbsp;<span class="keyword" id="4756778">else</span>&nbsp;<span class="keyword" id="4756783">if</span>&nbsp;<span class="ident" id="4756786"><a href="/regexp/syntax/parse.go.html#4756111">i</a></span>&nbsp;<span class="op" id="4756788">==</span>&nbsp;<span class="ident" id="4756791"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4756796">+</span><span class="num" id="4756797">1</span>&nbsp;<span class="op" id="4756799">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756804">//&nbsp;Just&nbsp;one:&nbsp;don&#39;t&nbsp;bother&nbsp;factoring.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756844"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span>&nbsp;<span class="op" id="4756848">=</span>&nbsp;<span class="builtinfunc" id="4756850">append</span><span class="op" id="4756856">(</span><span class="ident" id="4756857"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span><span class="op" id="4756860">,</span>&nbsp;<span class="ident" id="4756862"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4756865">[</span><span class="ident" id="4756866"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4756871">]</span><span class="op" id="4756872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4756876">}</span>&nbsp;<span class="keyword" id="4756878">else</span>&nbsp;<span class="op" id="4756883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4756888">//&nbsp;Construct&nbsp;factored&nbsp;form:&nbsp;prefix(suffix1|suffix2|...)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756947">prefix</span>&nbsp;<span class="op" id="4756954">:=</span>&nbsp;<span class="ident" id="4756957"><a href="/regexp/syntax/parse.go.html#4756092">first</a></span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756966">for</span>&nbsp;<span class="ident" id="4756970">j</span>&nbsp;<span class="op" id="4756972">:=</span>&nbsp;<span class="ident" id="4756975"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4756980">;</span>&nbsp;<span class="ident" id="4756982"><a href="/regexp/syntax/parse.go.html#4756970">j</a></span>&nbsp;<span class="op" id="4756984">&lt;</span>&nbsp;<span class="ident" id="4756986"><a href="/regexp/syntax/parse.go.html#4756111">i</a></span><span class="op" id="4756987">;</span>&nbsp;<span class="ident" id="4756989"><a href="/regexp/syntax/parse.go.html#4756970">j</a></span><span class="op" id="4756990">++</span>&nbsp;<span class="op" id="4756993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756999">reuse</span>&nbsp;<span class="op" id="4757005">:=</span>&nbsp;<span class="ident" id="4757008"><a href="/regexp/syntax/parse.go.html#4756970">j</a></span>&nbsp;<span class="op" id="4757010">!=</span>&nbsp;<span class="ident" id="4757013"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span>&nbsp;<span class="comment" id="4757019">//&nbsp;prefix&nbsp;came&nbsp;from&nbsp;sub[start]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757054"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4757057">[</span><span class="ident" id="4757058"><a href="/regexp/syntax/parse.go.html#4756970">j</a></span><span class="op" id="4757059">]</span>&nbsp;<span class="op" id="4757061">=</span>&nbsp;<span class="ident" id="4757063"><a href="/regexp/syntax/parse.go.html#4754083">p</a></span><span class="op" id="4757064">.</span><span class="ident" id="4757065">removeLeadingRegexp</span><span class="op" id="4757084">(</span><span class="ident" id="4757085"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4757088">[</span><span class="ident" id="4757089"><a href="/regexp/syntax/parse.go.html#4756970">j</a></span><span class="op" id="4757090">]</span><span class="op" id="4757091">,</span>&nbsp;<span class="ident" id="4757093"><a href="/regexp/syntax/parse.go.html#4756999">reuse</a></span><span class="op" id="4757098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757108">suffix</span>&nbsp;<span class="op" id="4757115">:=</span>&nbsp;<span class="ident" id="4757118"><a href="/regexp/syntax/parse.go.html#4754083">p</a></span><span class="op" id="4757119">.</span><span class="ident" id="4757120">collapse</span><span class="op" id="4757128">(</span><span class="ident" id="4757129"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4757132">[</span><span class="ident" id="4757133"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4757138">:</span><span class="ident" id="4757139"><a href="/regexp/syntax/parse.go.html#4756111">i</a></span><span class="op" id="4757140">]</span><span class="op" id="4757141">,</span>&nbsp;<span class="ident" id="4757143"><a href="/regexp/syntax/regexp.go.html#4802096">OpAlternate</a></span><span class="op" id="4757154">)</span>&nbsp;<span class="comment" id="4757156">//&nbsp;recurse</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757171">re</span>&nbsp;<span class="op" id="4757174">:=</span>&nbsp;<span class="ident" id="4757177"><a href="/regexp/syntax/parse.go.html#4754083">p</a></span><span class="op" id="4757178">.</span><span class="ident" id="4757179">newRegexp</span><span class="op" id="4757188">(</span><span class="ident" id="4757189"><a href="/regexp/syntax/regexp.go.html#4802031">OpConcat</a></span><span class="op" id="4757197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757202"><a href="/regexp/syntax/parse.go.html#4757171">re</a></span><span class="op" id="4757204">.</span><span class="ident" id="4757205">Sub</span>&nbsp;<span class="op" id="4757209">=</span>&nbsp;<span class="builtinfunc" id="4757211">append</span><span class="op" id="4757217">(</span><span class="ident" id="4757218"><a href="/regexp/syntax/parse.go.html#4757171">re</a></span><span class="op" id="4757220">.</span><span class="ident" id="4757221">Sub</span><span class="op" id="4757224">[</span><span class="op" id="4757225">:</span><span class="num" id="4757226">0</span><span class="op" id="4757227">]</span><span class="op" id="4757228">,</span>&nbsp;<span class="ident" id="4757230"><a href="/regexp/syntax/parse.go.html#4756947">prefix</a></span><span class="op" id="4757236">,</span>&nbsp;<span class="ident" id="4757238"><a href="/regexp/syntax/parse.go.html#4757108">suffix</a></span><span class="op" id="4757244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757249"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span>&nbsp;<span class="op" id="4757253">=</span>&nbsp;<span class="builtinfunc" id="4757255">append</span><span class="op" id="4757261">(</span><span class="ident" id="4757262"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span><span class="op" id="4757265">,</span>&nbsp;<span class="ident" id="4757267"><a href="/regexp/syntax/parse.go.html#4757171">re</a></span><span class="op" id="4757269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757273">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4757278">//&nbsp;Prepare&nbsp;for&nbsp;next&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757311"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span>&nbsp;<span class="op" id="4757317">=</span>&nbsp;<span class="ident" id="4757319"><a href="/regexp/syntax/parse.go.html#4756111">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757323"><a href="/regexp/syntax/parse.go.html#4756092">first</a></span>&nbsp;<span class="op" id="4757329">=</span>&nbsp;<span class="ident" id="4757331"><a href="/regexp/syntax/parse.go.html#4756393">ifirst</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757339">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757342"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span>&nbsp;<span class="op" id="4757346">=</span>&nbsp;<span class="ident" id="4757348"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4757354">//&nbsp;Round&nbsp;3:&nbsp;Collapse&nbsp;runs&nbsp;of&nbsp;single&nbsp;literals&nbsp;into&nbsp;character&nbsp;classes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757424"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span>&nbsp;<span class="op" id="4757430">=</span>&nbsp;<span class="num" id="4757432">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757435"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span>&nbsp;<span class="op" id="4757439">=</span>&nbsp;<span class="ident" id="4757441"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4757444">[</span><span class="op" id="4757445">:</span><span class="num" id="4757446">0</span><span class="op" id="4757447">]</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757450">for</span>&nbsp;<span class="ident" id="4757454">i</span>&nbsp;<span class="op" id="4757456">:=</span>&nbsp;<span class="num" id="4757459">0</span><span class="op" id="4757460">;</span>&nbsp;<span class="ident" id="4757462"><a href="/regexp/syntax/parse.go.html#4757454">i</a></span>&nbsp;<span class="op" id="4757464">&lt;=</span>&nbsp;<span class="builtinfunc" id="4757467">len</span><span class="op" id="4757470">(</span><span class="ident" id="4757471"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4757474">)</span><span class="op" id="4757475">;</span>&nbsp;<span class="ident" id="4757477"><a href="/regexp/syntax/parse.go.html#4757454">i</a></span><span class="op" id="4757478">++</span>&nbsp;<span class="op" id="4757481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4757485">//&nbsp;Invariant:&nbsp;the&nbsp;Regexps&nbsp;that&nbsp;were&nbsp;in&nbsp;sub[0:start]&nbsp;have&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4757549">//&nbsp;used&nbsp;or&nbsp;marked&nbsp;for&nbsp;reuse,&nbsp;and&nbsp;the&nbsp;slice&nbsp;space&nbsp;has&nbsp;been&nbsp;reused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4757616">//&nbsp;for&nbsp;out&nbsp;(len(out)&nbsp;&lt;=&nbsp;start).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4757650">//</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4757655">//&nbsp;Invariant:&nbsp;sub[start:i]&nbsp;consists&nbsp;of&nbsp;regexps&nbsp;that&nbsp;are&nbsp;either</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4757720">//&nbsp;literal&nbsp;runes&nbsp;or&nbsp;character&nbsp;classes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757761">if</span>&nbsp;<span class="ident" id="4757764"><a href="/regexp/syntax/parse.go.html#4757454">i</a></span>&nbsp;<span class="op" id="4757766">&lt;</span>&nbsp;<span class="builtinfunc" id="4757768">len</span><span class="op" id="4757771">(</span><span class="ident" id="4757772"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4757775">)</span>&nbsp;<span class="op" id="4757777">&amp;&amp;</span>&nbsp;<span class="ident" id="4757780"><a href="/regexp/syntax/parse.go.html#4770089">isCharClass</a></span><span class="op" id="4757791">(</span><span class="ident" id="4757792"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4757795">[</span><span class="ident" id="4757796"><a href="/regexp/syntax/parse.go.html#4757454">i</a></span><span class="op" id="4757797">]</span><span class="op" id="4757798">)</span>&nbsp;<span class="op" id="4757800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757805">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757816">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4757821">//&nbsp;sub[i]&nbsp;is&nbsp;not&nbsp;a&nbsp;char&nbsp;or&nbsp;char&nbsp;class;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4757862">//&nbsp;emit&nbsp;char&nbsp;class&nbsp;for&nbsp;sub[start:i]...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757903">if</span>&nbsp;<span class="ident" id="4757906"><a href="/regexp/syntax/parse.go.html#4757454">i</a></span>&nbsp;<span class="op" id="4757908">==</span>&nbsp;<span class="ident" id="4757911"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span>&nbsp;<span class="op" id="4757917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4757922">//&nbsp;Nothing&nbsp;to&nbsp;do&nbsp;-&nbsp;run&nbsp;of&nbsp;length&nbsp;0.</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757960">}</span>&nbsp;<span class="keyword" id="4757962">else</span>&nbsp;<span class="keyword" id="4757967">if</span>&nbsp;<span class="ident" id="4757970"><a href="/regexp/syntax/parse.go.html#4757454">i</a></span>&nbsp;<span class="op" id="4757972">==</span>&nbsp;<span class="ident" id="4757975"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4757980">+</span><span class="num" id="4757981">1</span>&nbsp;<span class="op" id="4757983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757988"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span>&nbsp;<span class="op" id="4757992">=</span>&nbsp;<span class="builtinfunc" id="4757994">append</span><span class="op" id="4758000">(</span><span class="ident" id="4758001"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span><span class="op" id="4758004">,</span>&nbsp;<span class="ident" id="4758006"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758009">[</span><span class="ident" id="4758010"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4758015">]</span><span class="op" id="4758016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758020">}</span>&nbsp;<span class="keyword" id="4758022">else</span>&nbsp;<span class="op" id="4758027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758032">//&nbsp;Make&nbsp;new&nbsp;char&nbsp;class.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758059">//&nbsp;Start&nbsp;with&nbsp;most&nbsp;complex&nbsp;regexp&nbsp;in&nbsp;sub[start].</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758111">max</span>&nbsp;<span class="op" id="4758115">:=</span>&nbsp;<span class="ident" id="4758118"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758127">for</span>&nbsp;<span class="ident" id="4758131">j</span>&nbsp;<span class="op" id="4758133">:=</span>&nbsp;<span class="ident" id="4758136"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span>&nbsp;<span class="op" id="4758142">+</span>&nbsp;<span class="num" id="4758144">1</span><span class="op" id="4758145">;</span>&nbsp;<span class="ident" id="4758147"><a href="/regexp/syntax/parse.go.html#4758131">j</a></span>&nbsp;<span class="op" id="4758149">&lt;</span>&nbsp;<span class="ident" id="4758151"><a href="/regexp/syntax/parse.go.html#4757454">i</a></span><span class="op" id="4758152">;</span>&nbsp;<span class="ident" id="4758154"><a href="/regexp/syntax/parse.go.html#4758131">j</a></span><span class="op" id="4758155">++</span>&nbsp;<span class="op" id="4758158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758164">if</span>&nbsp;<span class="ident" id="4758167"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758170">[</span><span class="ident" id="4758171"><a href="/regexp/syntax/parse.go.html#4758111">max</a></span><span class="op" id="4758174">]</span><span class="op" id="4758175">.</span><span class="ident" id="4758176">Op</span>&nbsp;<span class="op" id="4758179">&lt;</span>&nbsp;<span class="ident" id="4758181"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758184">[</span><span class="ident" id="4758185"><a href="/regexp/syntax/parse.go.html#4758131">j</a></span><span class="op" id="4758186">]</span><span class="op" id="4758187">.</span><span class="ident" id="4758188">Op</span>&nbsp;<span class="op" id="4758191">||</span>&nbsp;<span class="ident" id="4758194"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758197">[</span><span class="ident" id="4758198"><a href="/regexp/syntax/parse.go.html#4758111">max</a></span><span class="op" id="4758201">]</span><span class="op" id="4758202">.</span><span class="ident" id="4758203">Op</span>&nbsp;<span class="op" id="4758206">==</span>&nbsp;<span class="ident" id="4758209"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758212">[</span><span class="ident" id="4758213"><a href="/regexp/syntax/parse.go.html#4758131">j</a></span><span class="op" id="4758214">]</span><span class="op" id="4758215">.</span><span class="ident" id="4758216">Op</span>&nbsp;<span class="op" id="4758219">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4758222">len</span><span class="op" id="4758225">(</span><span class="ident" id="4758226"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758229">[</span><span class="ident" id="4758230"><a href="/regexp/syntax/parse.go.html#4758111">max</a></span><span class="op" id="4758233">]</span><span class="op" id="4758234">.</span><span class="ident" id="4758235">Rune</span><span class="op" id="4758239">)</span>&nbsp;<span class="op" id="4758241">&lt;</span>&nbsp;<span class="builtinfunc" id="4758243">len</span><span class="op" id="4758246">(</span><span class="ident" id="4758247"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758250">[</span><span class="ident" id="4758251"><a href="/regexp/syntax/parse.go.html#4758131">j</a></span><span class="op" id="4758252">]</span><span class="op" id="4758253">.</span><span class="ident" id="4758254">Rune</span><span class="op" id="4758258">)</span>&nbsp;<span class="op" id="4758260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758267"><a href="/regexp/syntax/parse.go.html#4758111">max</a></span>&nbsp;<span class="op" id="4758271">=</span>&nbsp;<span class="ident" id="4758273"><a href="/regexp/syntax/parse.go.html#4758131">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758279">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758289"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758292">[</span><span class="ident" id="4758293"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4758298">]</span><span class="op" id="4758299">,</span>&nbsp;<span class="ident" id="4758301"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758304">[</span><span class="ident" id="4758305"><a href="/regexp/syntax/parse.go.html#4758111">max</a></span><span class="op" id="4758308">]</span>&nbsp;<span class="op" id="4758310">=</span>&nbsp;<span class="ident" id="4758312"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758315">[</span><span class="ident" id="4758316"><a href="/regexp/syntax/parse.go.html#4758111">max</a></span><span class="op" id="4758319">]</span><span class="op" id="4758320">,</span>&nbsp;<span class="ident" id="4758322"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758325">[</span><span class="ident" id="4758326"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4758331">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758337">for</span>&nbsp;<span class="ident" id="4758341">j</span>&nbsp;<span class="op" id="4758343">:=</span>&nbsp;<span class="ident" id="4758346"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span>&nbsp;<span class="op" id="4758352">+</span>&nbsp;<span class="num" id="4758354">1</span><span class="op" id="4758355">;</span>&nbsp;<span class="ident" id="4758357"><a href="/regexp/syntax/parse.go.html#4758341">j</a></span>&nbsp;<span class="op" id="4758359">&lt;</span>&nbsp;<span class="ident" id="4758361"><a href="/regexp/syntax/parse.go.html#4757454">i</a></span><span class="op" id="4758362">;</span>&nbsp;<span class="ident" id="4758364"><a href="/regexp/syntax/parse.go.html#4758341">j</a></span><span class="op" id="4758365">++</span>&nbsp;<span class="op" id="4758368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758374"><a href="/regexp/syntax/parse.go.html#4771141">mergeCharClass</a></span><span class="op" id="4758388">(</span><span class="ident" id="4758389"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758392">[</span><span class="ident" id="4758393"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4758398">]</span><span class="op" id="4758399">,</span>&nbsp;<span class="ident" id="4758401"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758404">[</span><span class="ident" id="4758405"><a href="/regexp/syntax/parse.go.html#4758341">j</a></span><span class="op" id="4758406">]</span><span class="op" id="4758407">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758413"><a href="/regexp/syntax/parse.go.html#4754083">p</a></span><span class="op" id="4758414">.</span><span class="ident" id="4758415">reuse</span><span class="op" id="4758420">(</span><span class="ident" id="4758421"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758424">[</span><span class="ident" id="4758425"><a href="/regexp/syntax/parse.go.html#4758341">j</a></span><span class="op" id="4758426">]</span><span class="op" id="4758427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758437"><a href="/regexp/syntax/parse.go.html#4752466">cleanAlt</a></span><span class="op" id="4758445">(</span><span class="ident" id="4758446"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758449">[</span><span class="ident" id="4758450"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4758455">]</span><span class="op" id="4758456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758461"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span>&nbsp;<span class="op" id="4758465">=</span>&nbsp;<span class="builtinfunc" id="4758467">append</span><span class="op" id="4758473">(</span><span class="ident" id="4758474"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span><span class="op" id="4758477">,</span>&nbsp;<span class="ident" id="4758479"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758482">[</span><span class="ident" id="4758483"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span><span class="op" id="4758488">]</span><span class="op" id="4758489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758493">}</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758498">//&nbsp;...&nbsp;and&nbsp;then&nbsp;emit&nbsp;sub[i].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758529">if</span>&nbsp;<span class="ident" id="4758532"><a href="/regexp/syntax/parse.go.html#4757454">i</a></span>&nbsp;<span class="op" id="4758534">&lt;</span>&nbsp;<span class="builtinfunc" id="4758536">len</span><span class="op" id="4758539">(</span><span class="ident" id="4758540"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758543">)</span>&nbsp;<span class="op" id="4758545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758550"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span>&nbsp;<span class="op" id="4758554">=</span>&nbsp;<span class="builtinfunc" id="4758556">append</span><span class="op" id="4758562">(</span><span class="ident" id="4758563"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span><span class="op" id="4758566">,</span>&nbsp;<span class="ident" id="4758568"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758571">[</span><span class="ident" id="4758572"><a href="/regexp/syntax/parse.go.html#4757454">i</a></span><span class="op" id="4758573">]</span><span class="op" id="4758574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758578">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758582"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span>&nbsp;<span class="op" id="4758588">=</span>&nbsp;<span class="ident" id="4758590"><a href="/regexp/syntax/parse.go.html#4757454">i</a></span>&nbsp;<span class="op" id="4758592">+</span>&nbsp;<span class="num" id="4758594">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758600"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span>&nbsp;<span class="op" id="4758604">=</span>&nbsp;<span class="ident" id="4758606"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758612">//&nbsp;Round&nbsp;4:&nbsp;Collapse&nbsp;runs&nbsp;of&nbsp;empty&nbsp;matches&nbsp;into&nbsp;a&nbsp;single&nbsp;empty&nbsp;match.</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758683"><a href="/regexp/syntax/parse.go.html#4754263">start</a></span>&nbsp;<span class="op" id="4758689">=</span>&nbsp;<span class="num" id="4758691">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758694"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span>&nbsp;<span class="op" id="4758698">=</span>&nbsp;<span class="ident" id="4758700"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758703">[</span><span class="op" id="4758704">:</span><span class="num" id="4758705">0</span><span class="op" id="4758706">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758709">for</span>&nbsp;<span class="ident" id="4758713">i</span>&nbsp;<span class="op" id="4758715">:=</span>&nbsp;<span class="keyword" id="4758718">range</span>&nbsp;<span class="ident" id="4758724"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span>&nbsp;<span class="op" id="4758728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758732">if</span>&nbsp;<span class="ident" id="4758735"><a href="/regexp/syntax/parse.go.html#4758713">i</a></span><span class="op" id="4758736">+</span><span class="num" id="4758737">1</span>&nbsp;<span class="op" id="4758739">&lt;</span>&nbsp;<span class="builtinfunc" id="4758741">len</span><span class="op" id="4758744">(</span><span class="ident" id="4758745"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758748">)</span>&nbsp;<span class="op" id="4758750">&amp;&amp;</span>&nbsp;<span class="ident" id="4758753"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758756">[</span><span class="ident" id="4758757"><a href="/regexp/syntax/parse.go.html#4758713">i</a></span><span class="op" id="4758758">]</span><span class="op" id="4758759">.</span><span class="ident" id="4758760">Op</span>&nbsp;<span class="op" id="4758763">==</span>&nbsp;<span class="ident" id="4758766"><a href="/regexp/syntax/regexp.go.html#4800879">OpEmptyMatch</a></span>&nbsp;<span class="op" id="4758779">&amp;&amp;</span>&nbsp;<span class="ident" id="4758782"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758785">[</span><span class="ident" id="4758786"><a href="/regexp/syntax/parse.go.html#4758713">i</a></span><span class="op" id="4758787">+</span><span class="num" id="4758788">1</span><span class="op" id="4758789">]</span><span class="op" id="4758790">.</span><span class="ident" id="4758791">Op</span>&nbsp;<span class="op" id="4758794">==</span>&nbsp;<span class="ident" id="4758797"><a href="/regexp/syntax/regexp.go.html#4800879">OpEmptyMatch</a></span>&nbsp;<span class="op" id="4758810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758815">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758830"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span>&nbsp;<span class="op" id="4758834">=</span>&nbsp;<span class="builtinfunc" id="4758836">append</span><span class="op" id="4758842">(</span><span class="ident" id="4758843"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span><span class="op" id="4758846">,</span>&nbsp;<span class="ident" id="4758848"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><span class="op" id="4758851">[</span><span class="ident" id="4758852"><a href="/regexp/syntax/parse.go.html#4758713">i</a></span><span class="op" id="4758853">]</span><span class="op" id="4758854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758860"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span>&nbsp;<span class="op" id="4758864">=</span>&nbsp;<span class="ident" id="4758866"><a href="/regexp/syntax/parse.go.html#4754275">out</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758872">return</span>&nbsp;<span class="ident" id="4758879"><a href="/regexp/syntax/parse.go.html#4754101">sub</a></span><br>
<span class="lineno"></span><span class="op" id="4758883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4758886">//&nbsp;leadingString&nbsp;returns&nbsp;the&nbsp;leading&nbsp;literal&nbsp;string&nbsp;that&nbsp;re&nbsp;begins&nbsp;with.</span><br>
<span class="lineno"></span><span class="comment" id="4758959">//&nbsp;The&nbsp;string&nbsp;refers&nbsp;to&nbsp;storage&nbsp;in&nbsp;re&nbsp;or&nbsp;its&nbsp;children.</span><br>
<span class="lineno">585</span><span class="keyword" id="4759014">func</span>&nbsp;<span class="op" id="4759019">(</span><span class="ident" id="4759020">p</span>&nbsp;<span class="op" id="4759022">*</span><span class="ident" id="4759023"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4759029">)</span>&nbsp;<span class="ident" id="4759031">leadingString</span><span class="op" id="4759044">(</span><span class="ident" id="4759045">re</span>&nbsp;<span class="op" id="4759048">*</span><span class="ident" id="4759049"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4759055">)</span>&nbsp;<span class="op" id="4759057">(</span><span class="op" id="4759058">[</span><span class="op" id="4759059">]</span><span class="builtintype" id="4759060">rune</span><span class="op" id="4759064">,</span>&nbsp;<span class="ident" id="4759066"><a href="/regexp/syntax/parse.go.html#4744412">Flags</a></span><span class="op" id="4759071">)</span>&nbsp;<span class="op" id="4759073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759076">if</span>&nbsp;<span class="ident" id="4759079"><a href="/regexp/syntax/parse.go.html#4759045">re</a></span><span class="op" id="4759081">.</span><span class="ident" id="4759082">Op</span>&nbsp;<span class="op" id="4759085">==</span>&nbsp;<span class="ident" id="4759088"><a href="/regexp/syntax/regexp.go.html#4802031">OpConcat</a></span>&nbsp;<span class="op" id="4759097">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4759100">len</span><span class="op" id="4759103">(</span><span class="ident" id="4759104"><a href="/regexp/syntax/parse.go.html#4759045">re</a></span><span class="op" id="4759106">.</span><span class="ident" id="4759107">Sub</span><span class="op" id="4759110">)</span>&nbsp;<span class="op" id="4759112">&gt;</span>&nbsp;<span class="num" id="4759114">0</span>&nbsp;<span class="op" id="4759116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759120"><a href="/regexp/syntax/parse.go.html#4759045">re</a></span>&nbsp;<span class="op" id="4759123">=</span>&nbsp;<span class="ident" id="4759125"><a href="/regexp/syntax/parse.go.html#4759045">re</a></span><span class="op" id="4759127">.</span><span class="ident" id="4759128">Sub</span><span class="op" id="4759131">[</span><span class="num" id="4759132">0</span><span class="op" id="4759133">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759139">if</span>&nbsp;<span class="ident" id="4759142"><a href="/regexp/syntax/parse.go.html#4759045">re</a></span><span class="op" id="4759144">.</span><span class="ident" id="4759145">Op</span>&nbsp;<span class="op" id="4759148">!=</span>&nbsp;<span class="ident" id="4759151"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span>&nbsp;<span class="op" id="4759161">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759165">return</span>&nbsp;<span class="ident" id="4759172">nil</span><span class="op" id="4759175">,</span>&nbsp;<span class="num" id="4759177">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759183">return</span>&nbsp;<span class="ident" id="4759190"><a href="/regexp/syntax/parse.go.html#4759045">re</a></span><span class="op" id="4759192">.</span><span class="ident" id="4759193">Rune</span><span class="op" id="4759197">,</span>&nbsp;<span class="ident" id="4759199"><a href="/regexp/syntax/parse.go.html#4759045">re</a></span><span class="op" id="4759201">.</span><span class="ident" id="4759202">Flags</span>&nbsp;<span class="op" id="4759208">&amp;</span>&nbsp;<span class="ident" id="4759210"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span><br>
<span class="lineno"></span><span class="op" id="4759219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="4759222">//&nbsp;removeLeadingString&nbsp;removes&nbsp;the&nbsp;first&nbsp;n&nbsp;leading&nbsp;runes</span><br>
<span class="lineno"></span><span class="comment" id="4759279">//&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;re.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;replacement&nbsp;for&nbsp;re.</span><br>
<span class="lineno"></span><span class="keyword" id="4759344">func</span>&nbsp;<span class="op" id="4759349">(</span><span class="ident" id="4759350">p</span>&nbsp;<span class="op" id="4759352">*</span><span class="ident" id="4759353"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4759359">)</span>&nbsp;<span class="ident" id="4759361">removeLeadingString</span><span class="op" id="4759380">(</span><span class="ident" id="4759381">re</span>&nbsp;<span class="op" id="4759384">*</span><span class="ident" id="4759385"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4759391">,</span>&nbsp;<span class="ident" id="4759393">n</span>&nbsp;<span class="builtintype" id="4759395">int</span><span class="op" id="4759398">)</span>&nbsp;<span class="op" id="4759400">*</span><span class="ident" id="4759401"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="op" id="4759408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759411">if</span>&nbsp;<span class="ident" id="4759414"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759416">.</span><span class="ident" id="4759417">Op</span>&nbsp;<span class="op" id="4759420">==</span>&nbsp;<span class="ident" id="4759423"><a href="/regexp/syntax/regexp.go.html#4802031">OpConcat</a></span>&nbsp;<span class="op" id="4759432">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4759435">len</span><span class="op" id="4759438">(</span><span class="ident" id="4759439"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759441">.</span><span class="ident" id="4759442">Sub</span><span class="op" id="4759445">)</span>&nbsp;<span class="op" id="4759447">&gt;</span>&nbsp;<span class="num" id="4759449">0</span>&nbsp;<span class="op" id="4759451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4759455">//&nbsp;Removing&nbsp;a&nbsp;leading&nbsp;string&nbsp;in&nbsp;a&nbsp;concatenation</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4759505">//&nbsp;might&nbsp;simplify&nbsp;the&nbsp;concatenation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759544">sub</span>&nbsp;<span class="op" id="4759548">:=</span>&nbsp;<span class="ident" id="4759551"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759553">.</span><span class="ident" id="4759554">Sub</span><span class="op" id="4759557">[</span><span class="num" id="4759558">0</span><span class="op" id="4759559">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759563"><a href="/regexp/syntax/parse.go.html#4759544">sub</a></span>&nbsp;<span class="op" id="4759567">=</span>&nbsp;<span class="ident" id="4759569"><a href="/regexp/syntax/parse.go.html#4759350">p</a></span><span class="op" id="4759570">.</span><span class="ident" id="4759571">removeLeadingString</span><span class="op" id="4759590">(</span><span class="ident" id="4759591"><a href="/regexp/syntax/parse.go.html#4759544">sub</a></span><span class="op" id="4759594">,</span>&nbsp;<span class="ident" id="4759596"><a href="/regexp/syntax/parse.go.html#4759393">n</a></span><span class="op" id="4759597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759601"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759603">.</span><span class="ident" id="4759604">Sub</span><span class="op" id="4759607">[</span><span class="num" id="4759608">0</span><span class="op" id="4759609">]</span>&nbsp;<span class="op" id="4759611">=</span>&nbsp;<span class="ident" id="4759613"><a href="/regexp/syntax/parse.go.html#4759544">sub</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759619">if</span>&nbsp;<span class="ident" id="4759622"><a href="/regexp/syntax/parse.go.html#4759544">sub</a></span><span class="op" id="4759625">.</span><span class="ident" id="4759626">Op</span>&nbsp;<span class="op" id="4759629">==</span>&nbsp;<span class="ident" id="4759632"><a href="/regexp/syntax/regexp.go.html#4800879">OpEmptyMatch</a></span>&nbsp;<span class="op" id="4759645">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759650"><a href="/regexp/syntax/parse.go.html#4759350">p</a></span><span class="op" id="4759651">.</span><span class="ident" id="4759652">reuse</span><span class="op" id="4759657">(</span><span class="ident" id="4759658"><a href="/regexp/syntax/parse.go.html#4759544">sub</a></span><span class="op" id="4759661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759666">switch</span>&nbsp;<span class="builtinfunc" id="4759673">len</span><span class="op" id="4759676">(</span><span class="ident" id="4759677"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759679">.</span><span class="ident" id="4759680">Sub</span><span class="op" id="4759683">)</span>&nbsp;<span class="op" id="4759685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759690">case</span>&nbsp;<span class="num" id="4759695">0</span><span class="op" id="4759696">,</span>&nbsp;<span class="num" id="4759698">1</span><span class="op" id="4759699">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4759705">//&nbsp;Impossible&nbsp;but&nbsp;handle.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759735"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759737">.</span><span class="ident" id="4759738">Op</span>&nbsp;<span class="op" id="4759741">=</span>&nbsp;<span class="ident" id="4759743"><a href="/regexp/syntax/regexp.go.html#4800879">OpEmptyMatch</a></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759760"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759762">.</span><span class="ident" id="4759763">Sub</span>&nbsp;<span class="op" id="4759767">=</span>&nbsp;<span class="ident" id="4759769">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759776">case</span>&nbsp;<span class="num" id="4759781">2</span><span class="op" id="4759782">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759788">old</span>&nbsp;<span class="op" id="4759792">:=</span>&nbsp;<span class="ident" id="4759795"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759802"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span>&nbsp;<span class="op" id="4759805">=</span>&nbsp;<span class="ident" id="4759807"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759809">.</span><span class="ident" id="4759810">Sub</span><span class="op" id="4759813">[</span><span class="num" id="4759814">1</span><span class="op" id="4759815">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759821"><a href="/regexp/syntax/parse.go.html#4759350">p</a></span><span class="op" id="4759822">.</span><span class="ident" id="4759823">reuse</span><span class="op" id="4759828">(</span><span class="ident" id="4759829"><a href="/regexp/syntax/parse.go.html#4759788">old</a></span><span class="op" id="4759832">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759837">default</span><span class="op" id="4759844">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4759850">copy</span><span class="op" id="4759854">(</span><span class="ident" id="4759855"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759857">.</span><span class="ident" id="4759858">Sub</span><span class="op" id="4759861">,</span>&nbsp;<span class="ident" id="4759863"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759865">.</span><span class="ident" id="4759866">Sub</span><span class="op" id="4759869">[</span><span class="num" id="4759870">1</span><span class="op" id="4759871">:</span><span class="op" id="4759872">]</span><span class="op" id="4759873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759879"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759881">.</span><span class="ident" id="4759882">Sub</span>&nbsp;<span class="op" id="4759886">=</span>&nbsp;<span class="ident" id="4759888"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759890">.</span><span class="ident" id="4759891">Sub</span><span class="op" id="4759894">[</span><span class="op" id="4759895">:</span><span class="builtinfunc" id="4759896">len</span><span class="op" id="4759899">(</span><span class="ident" id="4759900"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759902">.</span><span class="ident" id="4759903">Sub</span><span class="op" id="4759906">)</span><span class="op" id="4759907">-</span><span class="num" id="4759908">1</span><span class="op" id="4759909">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759918">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759922">return</span>&nbsp;<span class="ident" id="4759929"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759937">if</span>&nbsp;<span class="ident" id="4759940"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759942">.</span><span class="ident" id="4759943">Op</span>&nbsp;<span class="op" id="4759946">==</span>&nbsp;<span class="ident" id="4759949"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span>&nbsp;<span class="op" id="4759959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759963"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759965">.</span><span class="ident" id="4759966">Rune</span>&nbsp;<span class="op" id="4759971">=</span>&nbsp;<span class="ident" id="4759973"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759975">.</span><span class="ident" id="4759976">Rune</span><span class="op" id="4759980">[</span><span class="op" id="4759981">:</span><span class="builtinfunc" id="4759982">copy</span><span class="op" id="4759986">(</span><span class="ident" id="4759987"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759989">.</span><span class="ident" id="4759990">Rune</span><span class="op" id="4759994">,</span>&nbsp;<span class="ident" id="4759996"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4759998">.</span><span class="ident" id="4759999">Rune</span><span class="op" id="4760003">[</span><span class="ident" id="4760004"><a href="/regexp/syntax/parse.go.html#4759393">n</a></span><span class="op" id="4760005">:</span><span class="op" id="4760006">]</span><span class="op" id="4760007">)</span><span class="op" id="4760008">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760012">if</span>&nbsp;<span class="builtinfunc" id="4760015">len</span><span class="op" id="4760018">(</span><span class="ident" id="4760019"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4760021">.</span><span class="ident" id="4760022">Rune</span><span class="op" id="4760026">)</span>&nbsp;<span class="op" id="4760028">==</span>&nbsp;<span class="num" id="4760031">0</span>&nbsp;<span class="op" id="4760033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760038"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><span class="op" id="4760040">.</span><span class="ident" id="4760041">Op</span>&nbsp;<span class="op" id="4760044">=</span>&nbsp;<span class="ident" id="4760046"><a href="/regexp/syntax/regexp.go.html#4800879">OpEmptyMatch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4760061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4760064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760067">return</span>&nbsp;<span class="ident" id="4760074"><a href="/regexp/syntax/parse.go.html#4759381">re</a></span><br>
<span class="lineno">630</span><span class="op" id="4760077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4760080">//&nbsp;leadingRegexp&nbsp;returns&nbsp;the&nbsp;leading&nbsp;regexp&nbsp;that&nbsp;re&nbsp;begins&nbsp;with.</span><br>
<span class="lineno"></span><span class="comment" id="4760145">//&nbsp;The&nbsp;regexp&nbsp;refers&nbsp;to&nbsp;storage&nbsp;in&nbsp;re&nbsp;or&nbsp;its&nbsp;children.</span><br>
<span class="lineno"></span><span class="keyword" id="4760200">func</span>&nbsp;<span class="op" id="4760205">(</span><span class="ident" id="4760206">p</span>&nbsp;<span class="op" id="4760208">*</span><span class="ident" id="4760209"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4760215">)</span>&nbsp;<span class="ident" id="4760217">leadingRegexp</span><span class="op" id="4760230">(</span><span class="ident" id="4760231">re</span>&nbsp;<span class="op" id="4760234">*</span><span class="ident" id="4760235"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4760241">)</span>&nbsp;<span class="op" id="4760243">*</span><span class="ident" id="4760244"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="op" id="4760251">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760254">if</span>&nbsp;<span class="ident" id="4760257"><a href="/regexp/syntax/parse.go.html#4760231">re</a></span><span class="op" id="4760259">.</span><span class="ident" id="4760260">Op</span>&nbsp;<span class="op" id="4760263">==</span>&nbsp;<span class="ident" id="4760266"><a href="/regexp/syntax/regexp.go.html#4800879">OpEmptyMatch</a></span>&nbsp;<span class="op" id="4760279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760283">return</span>&nbsp;<span class="ident" id="4760290">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4760295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760298">if</span>&nbsp;<span class="ident" id="4760301"><a href="/regexp/syntax/parse.go.html#4760231">re</a></span><span class="op" id="4760303">.</span><span class="ident" id="4760304">Op</span>&nbsp;<span class="op" id="4760307">==</span>&nbsp;<span class="ident" id="4760310"><a href="/regexp/syntax/regexp.go.html#4802031">OpConcat</a></span>&nbsp;<span class="op" id="4760319">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4760322">len</span><span class="op" id="4760325">(</span><span class="ident" id="4760326"><a href="/regexp/syntax/parse.go.html#4760231">re</a></span><span class="op" id="4760328">.</span><span class="ident" id="4760329">Sub</span><span class="op" id="4760332">)</span>&nbsp;<span class="op" id="4760334">&gt;</span>&nbsp;<span class="num" id="4760336">0</span>&nbsp;<span class="op" id="4760338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760342">sub</span>&nbsp;<span class="op" id="4760346">:=</span>&nbsp;<span class="ident" id="4760349"><a href="/regexp/syntax/parse.go.html#4760231">re</a></span><span class="op" id="4760351">.</span><span class="ident" id="4760352">Sub</span><span class="op" id="4760355">[</span><span class="num" id="4760356">0</span><span class="op" id="4760357">]</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760361">if</span>&nbsp;<span class="ident" id="4760364"><a href="/regexp/syntax/parse.go.html#4760342">sub</a></span><span class="op" id="4760367">.</span><span class="ident" id="4760368">Op</span>&nbsp;<span class="op" id="4760371">==</span>&nbsp;<span class="ident" id="4760374"><a href="/regexp/syntax/regexp.go.html#4800879">OpEmptyMatch</a></span>&nbsp;<span class="op" id="4760387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760392">return</span>&nbsp;<span class="ident" id="4760399">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4760405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760409">return</span>&nbsp;<span class="ident" id="4760416"><a href="/regexp/syntax/parse.go.html#4760342">sub</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4760421">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760424">return</span>&nbsp;<span class="ident" id="4760431"><a href="/regexp/syntax/parse.go.html#4760231">re</a></span><br>
<span class="lineno"></span><span class="op" id="4760434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4760437">//&nbsp;removeLeadingRegexp&nbsp;removes&nbsp;the&nbsp;leading&nbsp;regexp&nbsp;in&nbsp;re.</span><br>
<span class="lineno"></span><span class="comment" id="4760494">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;replacement&nbsp;for&nbsp;re.</span><br>
<span class="lineno">650</span><span class="comment" id="4760532">//&nbsp;If&nbsp;reuse&nbsp;is&nbsp;true,&nbsp;it&nbsp;passes&nbsp;the&nbsp;removed&nbsp;regexp&nbsp;(if&nbsp;no&nbsp;longer&nbsp;needed)&nbsp;to&nbsp;p.reuse.</span><br>
<span class="lineno"></span><span class="keyword" id="4760616">func</span>&nbsp;<span class="op" id="4760621">(</span><span class="ident" id="4760622">p</span>&nbsp;<span class="op" id="4760624">*</span><span class="ident" id="4760625"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4760631">)</span>&nbsp;<span class="ident" id="4760633">removeLeadingRegexp</span><span class="op" id="4760652">(</span><span class="ident" id="4760653">re</span>&nbsp;<span class="op" id="4760656">*</span><span class="ident" id="4760657"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4760663">,</span>&nbsp;<span class="ident" id="4760665">reuse</span>&nbsp;<span class="builtintype" id="4760671">bool</span><span class="op" id="4760675">)</span>&nbsp;<span class="op" id="4760677">*</span><span class="ident" id="4760678"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="op" id="4760685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760688">if</span>&nbsp;<span class="ident" id="4760691"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><span class="op" id="4760693">.</span><span class="ident" id="4760694">Op</span>&nbsp;<span class="op" id="4760697">==</span>&nbsp;<span class="ident" id="4760700"><a href="/regexp/syntax/regexp.go.html#4802031">OpConcat</a></span>&nbsp;<span class="op" id="4760709">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4760712">len</span><span class="op" id="4760715">(</span><span class="ident" id="4760716"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><span class="op" id="4760718">.</span><span class="ident" id="4760719">Sub</span><span class="op" id="4760722">)</span>&nbsp;<span class="op" id="4760724">&gt;</span>&nbsp;<span class="num" id="4760726">0</span>&nbsp;<span class="op" id="4760728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760732">if</span>&nbsp;<span class="ident" id="4760735"><a href="/regexp/syntax/parse.go.html#4760665">reuse</a></span>&nbsp;<span class="op" id="4760741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760746"><a href="/regexp/syntax/parse.go.html#4760622">p</a></span><span class="op" id="4760747">.</span><span class="ident" id="4760748">reuse</span><span class="op" id="4760753">(</span><span class="ident" id="4760754"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><span class="op" id="4760756">.</span><span class="ident" id="4760757">Sub</span><span class="op" id="4760760">[</span><span class="num" id="4760761">0</span><span class="op" id="4760762">]</span><span class="op" id="4760763">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4760767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760771"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><span class="op" id="4760773">.</span><span class="ident" id="4760774">Sub</span>&nbsp;<span class="op" id="4760778">=</span>&nbsp;<span class="ident" id="4760780"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><span class="op" id="4760782">.</span><span class="ident" id="4760783">Sub</span><span class="op" id="4760786">[</span><span class="op" id="4760787">:</span><span class="builtinfunc" id="4760788">copy</span><span class="op" id="4760792">(</span><span class="ident" id="4760793"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><span class="op" id="4760795">.</span><span class="ident" id="4760796">Sub</span><span class="op" id="4760799">,</span>&nbsp;<span class="ident" id="4760801"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><span class="op" id="4760803">.</span><span class="ident" id="4760804">Sub</span><span class="op" id="4760807">[</span><span class="num" id="4760808">1</span><span class="op" id="4760809">:</span><span class="op" id="4760810">]</span><span class="op" id="4760811">)</span><span class="op" id="4760812">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760816">switch</span>&nbsp;<span class="builtinfunc" id="4760823">len</span><span class="op" id="4760826">(</span><span class="ident" id="4760827"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><span class="op" id="4760829">.</span><span class="ident" id="4760830">Sub</span><span class="op" id="4760833">)</span>&nbsp;<span class="op" id="4760835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760839">case</span>&nbsp;<span class="num" id="4760844">0</span><span class="op" id="4760845">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760850"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><span class="op" id="4760852">.</span><span class="ident" id="4760853">Op</span>&nbsp;<span class="op" id="4760856">=</span>&nbsp;<span class="ident" id="4760858"><a href="/regexp/syntax/regexp.go.html#4800879">OpEmptyMatch</a></span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760874"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><span class="op" id="4760876">.</span><span class="ident" id="4760877">Sub</span>&nbsp;<span class="op" id="4760881">=</span>&nbsp;<span class="ident" id="4760883">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760889">case</span>&nbsp;<span class="num" id="4760894">1</span><span class="op" id="4760895">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760900">old</span>&nbsp;<span class="op" id="4760904">:=</span>&nbsp;<span class="ident" id="4760907"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760913"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span>&nbsp;<span class="op" id="4760916">=</span>&nbsp;<span class="ident" id="4760918"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><span class="op" id="4760920">.</span><span class="ident" id="4760921">Sub</span><span class="op" id="4760924">[</span><span class="num" id="4760925">0</span><span class="op" id="4760926">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760931"><a href="/regexp/syntax/parse.go.html#4760622">p</a></span><span class="op" id="4760932">.</span><span class="ident" id="4760933">reuse</span><span class="op" id="4760938">(</span><span class="ident" id="4760939"><a href="/regexp/syntax/parse.go.html#4760900">old</a></span><span class="op" id="4760942">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4760946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760950">return</span>&nbsp;<span class="ident" id="4760957"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4760961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760964">if</span>&nbsp;<span class="ident" id="4760967"><a href="/regexp/syntax/parse.go.html#4760665">reuse</a></span>&nbsp;<span class="op" id="4760973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760977"><a href="/regexp/syntax/parse.go.html#4760622">p</a></span><span class="op" id="4760978">.</span><span class="ident" id="4760979">reuse</span><span class="op" id="4760984">(</span><span class="ident" id="4760985"><a href="/regexp/syntax/parse.go.html#4760653">re</a></span><span class="op" id="4760987">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4760990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760993">return</span>&nbsp;<span class="ident" id="4761000"><a href="/regexp/syntax/parse.go.html#4760622">p</a></span><span class="op" id="4761001">.</span><span class="ident" id="4761002">newRegexp</span><span class="op" id="4761011">(</span><span class="ident" id="4761012"><a href="/regexp/syntax/regexp.go.html#4800879">OpEmptyMatch</a></span><span class="op" id="4761024">)</span><br>
<span class="lineno"></span><span class="op" id="4761026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4761029">func</span>&nbsp;<span class="ident" id="4761034">literalRegexp</span><span class="op" id="4761047">(</span><span class="ident" id="4761048">s</span>&nbsp;<span class="builtintype" id="4761050">string</span><span class="op" id="4761056">,</span>&nbsp;<span class="ident" id="4761058">flags</span>&nbsp;<span class="ident" id="4761064"><a href="/regexp/syntax/parse.go.html#4744412">Flags</a></span><span class="op" id="4761069">)</span>&nbsp;<span class="op" id="4761071">*</span><span class="ident" id="4761072"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span>&nbsp;<span class="op" id="4761079">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761082">re</span>&nbsp;<span class="op" id="4761085">:=</span>&nbsp;<span class="op" id="4761088">&amp;</span><span class="ident" id="4761089"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4761095">{</span><span class="ident" id="4761096">Op</span><span class="op" id="4761098">:</span>&nbsp;<span class="ident" id="4761100"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span><span class="op" id="4761109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761112"><a href="/regexp/syntax/parse.go.html#4761082">re</a></span><span class="op" id="4761114">.</span><span class="ident" id="4761115">Flags</span>&nbsp;<span class="op" id="4761121">=</span>&nbsp;<span class="ident" id="4761123"><a href="/regexp/syntax/parse.go.html#4761058">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761130"><a href="/regexp/syntax/parse.go.html#4761082">re</a></span><span class="op" id="4761132">.</span><span class="ident" id="4761133">Rune</span>&nbsp;<span class="op" id="4761138">=</span>&nbsp;<span class="ident" id="4761140"><a href="/regexp/syntax/parse.go.html#4761082">re</a></span><span class="op" id="4761142">.</span><span class="ident" id="4761143">Rune0</span><span class="op" id="4761148">[</span><span class="op" id="4761149">:</span><span class="num" id="4761150">0</span><span class="op" id="4761151">]</span>&nbsp;<span class="comment" id="4761153">//&nbsp;use&nbsp;local&nbsp;storage&nbsp;for&nbsp;small&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761193">for</span>&nbsp;<span class="ident" id="4761197">_</span><span class="op" id="4761198">,</span>&nbsp;<span class="ident" id="4761200">c</span>&nbsp;<span class="op" id="4761202">:=</span>&nbsp;<span class="keyword" id="4761205">range</span>&nbsp;<span class="ident" id="4761211"><a href="/regexp/syntax/parse.go.html#4761048">s</a></span>&nbsp;<span class="op" id="4761213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761217">if</span>&nbsp;<span class="builtinfunc" id="4761220">len</span><span class="op" id="4761223">(</span><span class="ident" id="4761224"><a href="/regexp/syntax/parse.go.html#4761082">re</a></span><span class="op" id="4761226">.</span><span class="ident" id="4761227">Rune</span><span class="op" id="4761231">)</span>&nbsp;<span class="op" id="4761233">&gt;=</span>&nbsp;<span class="builtinfunc" id="4761236">cap</span><span class="op" id="4761239">(</span><span class="ident" id="4761240"><a href="/regexp/syntax/parse.go.html#4761082">re</a></span><span class="op" id="4761242">.</span><span class="ident" id="4761243">Rune</span><span class="op" id="4761247">)</span>&nbsp;<span class="op" id="4761249">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4761254">//&nbsp;string&nbsp;is&nbsp;too&nbsp;long&nbsp;to&nbsp;fit&nbsp;in&nbsp;Rune0.&nbsp;&nbsp;let&nbsp;Go&nbsp;handle&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761314"><a href="/regexp/syntax/parse.go.html#4761082">re</a></span><span class="op" id="4761316">.</span><span class="ident" id="4761317">Rune</span>&nbsp;<span class="op" id="4761322">=</span>&nbsp;<span class="op" id="4761324">[</span><span class="op" id="4761325">]</span><span class="builtintype" id="4761326">rune</span><span class="op" id="4761330">(</span><span class="ident" id="4761331"><a href="/regexp/syntax/parse.go.html#4761048">s</a></span><span class="op" id="4761332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761337">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761349"><a href="/regexp/syntax/parse.go.html#4761082">re</a></span><span class="op" id="4761351">.</span><span class="ident" id="4761352">Rune</span>&nbsp;<span class="op" id="4761357">=</span>&nbsp;<span class="builtinfunc" id="4761359">append</span><span class="op" id="4761365">(</span><span class="ident" id="4761366"><a href="/regexp/syntax/parse.go.html#4761082">re</a></span><span class="op" id="4761368">.</span><span class="ident" id="4761369">Rune</span><span class="op" id="4761373">,</span>&nbsp;<span class="ident" id="4761375"><a href="/regexp/syntax/parse.go.html#4761200">c</a></span><span class="op" id="4761376">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761382">return</span>&nbsp;<span class="ident" id="4761389"><a href="/regexp/syntax/parse.go.html#4761082">re</a></span><br>
<span class="lineno"></span><span class="op" id="4761392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4761395">//&nbsp;Parsing.</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="4761408">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;regular&nbsp;expression&nbsp;string&nbsp;s,&nbsp;controlled&nbsp;by&nbsp;the&nbsp;specified</span><br>
<span class="lineno"></span><span class="comment" id="4761483">//&nbsp;Flags,&nbsp;and&nbsp;returns&nbsp;a&nbsp;regular&nbsp;expression&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;syntax&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4761552">//&nbsp;described&nbsp;in&nbsp;the&nbsp;top-level&nbsp;comment.</span><br>
<span class="lineno"></span><span class="keyword" id="4761591">func</span>&nbsp;<span class="ident" id="4761596">Parse</span><span class="op" id="4761601">(</span><span class="ident" id="4761602">s</span>&nbsp;<span class="builtintype" id="4761604">string</span><span class="op" id="4761610">,</span>&nbsp;<span class="ident" id="4761612">flags</span>&nbsp;<span class="ident" id="4761618"><a href="/regexp/syntax/parse.go.html#4744412">Flags</a></span><span class="op" id="4761623">)</span>&nbsp;<span class="op" id="4761625">(</span><span class="op" id="4761626">*</span><span class="ident" id="4761627"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4761633">,</span>&nbsp;<span class="builtintype" id="4761635">error</span><span class="op" id="4761640">)</span>&nbsp;<span class="op" id="4761642">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761645">if</span>&nbsp;<span class="ident" id="4761648"><a href="/regexp/syntax/parse.go.html#4761612">flags</a></span><span class="op" id="4761653">&amp;</span><span class="ident" id="4761654"><a href="/regexp/syntax/parse.go.html#4744494">Literal</a></span>&nbsp;<span class="op" id="4761662">!=</span>&nbsp;<span class="num" id="4761665">0</span>&nbsp;<span class="op" id="4761667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4761671">//&nbsp;Trivial&nbsp;parser&nbsp;for&nbsp;literal&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761711">if</span>&nbsp;<span class="ident" id="4761714">err</span>&nbsp;<span class="op" id="4761718">:=</span>&nbsp;<span class="ident" id="4761721"><a href="/regexp/syntax/parse.go.html#4788780">checkUTF8</a></span><span class="op" id="4761730">(</span><span class="ident" id="4761731"><a href="/regexp/syntax/parse.go.html#4761602">s</a></span><span class="op" id="4761732">)</span><span class="op" id="4761733">;</span>&nbsp;<span class="ident" id="4761735"><a href="/regexp/syntax/parse.go.html#4761714">err</a></span>&nbsp;<span class="op" id="4761739">!=</span>&nbsp;<span class="ident" id="4761742">nil</span>&nbsp;<span class="op" id="4761746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761751">return</span>&nbsp;<span class="ident" id="4761758">nil</span><span class="op" id="4761761">,</span>&nbsp;<span class="ident" id="4761763"><a href="/regexp/syntax/parse.go.html#4761714">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761769">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761773">return</span>&nbsp;<span class="ident" id="4761780"><a href="/regexp/syntax/parse.go.html#4761034">literalRegexp</a></span><span class="op" id="4761793">(</span><span class="ident" id="4761794"><a href="/regexp/syntax/parse.go.html#4761602">s</a></span><span class="op" id="4761795">,</span>&nbsp;<span class="ident" id="4761797"><a href="/regexp/syntax/parse.go.html#4761612">flags</a></span><span class="op" id="4761802">)</span><span class="op" id="4761803">,</span>&nbsp;<span class="ident" id="4761805">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4761814">//&nbsp;Otherwise,&nbsp;must&nbsp;do&nbsp;real&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761848">var</span>&nbsp;<span class="op" id="4761852">(</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761856">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761867"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761876">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4761887">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761895">c</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4761906">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761913">op</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761924"><a href="/regexp/syntax/regexp.go.html#4800610">Op</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761929">lastRepeat</span>&nbsp;<span class="builtintype" id="4761940">string</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761951"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4761952">.</span><span class="ident" id="4761953">flags</span>&nbsp;<span class="op" id="4761959">=</span>&nbsp;<span class="ident" id="4761961"><a href="/regexp/syntax/parse.go.html#4761612">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761968"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4761969">.</span><span class="ident" id="4761970">wholeRegexp</span>&nbsp;<span class="op" id="4761982">=</span>&nbsp;<span class="ident" id="4761984"><a href="/regexp/syntax/parse.go.html#4761602">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761987">t</span>&nbsp;<span class="op" id="4761989">:=</span>&nbsp;<span class="ident" id="4761992"><a href="/regexp/syntax/parse.go.html#4761602">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761995">for</span>&nbsp;<span class="ident" id="4761999"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4762001">!=</span>&nbsp;<span class="string" id="4762004">&#34;&#34;</span>&nbsp;<span class="op" id="4762007">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762011">repeat</span>&nbsp;<span class="op" id="4762018">:=</span>&nbsp;<span class="string" id="4762021">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762025">BigSwitch</span><span class="op" id="4762034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762038">switch</span>&nbsp;<span class="ident" id="4762045"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762046">[</span><span class="num" id="4762047">0</span><span class="op" id="4762048">]</span>&nbsp;<span class="op" id="4762050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762054">default</span><span class="op" id="4762061">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762066">if</span>&nbsp;<span class="ident" id="4762069"><a href="/regexp/syntax/parse.go.html#4761895">c</a></span><span class="op" id="4762070">,</span>&nbsp;<span class="ident" id="4762072"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762073">,</span>&nbsp;<span class="ident" id="4762075"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4762079">=</span>&nbsp;<span class="ident" id="4762081"><a href="/regexp/syntax/parse.go.html#4788999">nextRune</a></span><span class="op" id="4762089">(</span><span class="ident" id="4762090"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762091">)</span><span class="op" id="4762092">;</span>&nbsp;<span class="ident" id="4762094"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4762098">!=</span>&nbsp;<span class="ident" id="4762101">nil</span>&nbsp;<span class="op" id="4762105">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762111">return</span>&nbsp;<span class="ident" id="4762118">nil</span><span class="op" id="4762121">,</span>&nbsp;<span class="ident" id="4762123"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762135"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762136">.</span><span class="ident" id="4762137">literal</span><span class="op" id="4762144">(</span><span class="ident" id="4762145"><a href="/regexp/syntax/parse.go.html#4761895">c</a></span><span class="op" id="4762146">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762151">case</span>&nbsp;<span class="string" id="4762156">&#39;(&#39;</span><span class="op" id="4762159">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762164">if</span>&nbsp;<span class="ident" id="4762167"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762168">.</span><span class="ident" id="4762169">flags</span><span class="op" id="4762174">&amp;</span><span class="ident" id="4762175"><a href="/regexp/syntax/parse.go.html#4744908">PerlX</a></span>&nbsp;<span class="op" id="4762181">!=</span>&nbsp;<span class="num" id="4762184">0</span>&nbsp;<span class="op" id="4762186">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4762189">len</span><span class="op" id="4762192">(</span><span class="ident" id="4762193"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762194">)</span>&nbsp;<span class="op" id="4762196">&gt;=</span>&nbsp;<span class="num" id="4762199">2</span>&nbsp;<span class="op" id="4762201">&amp;&amp;</span>&nbsp;<span class="ident" id="4762204"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762205">[</span><span class="num" id="4762206">1</span><span class="op" id="4762207">]</span>&nbsp;<span class="op" id="4762209">==</span>&nbsp;<span class="string" id="4762212">&#39;?&#39;</span>&nbsp;<span class="op" id="4762216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4762222">//&nbsp;Flag&nbsp;changes&nbsp;and&nbsp;non-capturing&nbsp;groups.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762268">if</span>&nbsp;<span class="ident" id="4762271"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762272">,</span>&nbsp;<span class="ident" id="4762274"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4762278">=</span>&nbsp;<span class="ident" id="4762280"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762281">.</span><span class="ident" id="4762282">parsePerlFlags</span><span class="op" id="4762296">(</span><span class="ident" id="4762297"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762298">)</span><span class="op" id="4762299">;</span>&nbsp;<span class="ident" id="4762301"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4762305">!=</span>&nbsp;<span class="ident" id="4762308">nil</span>&nbsp;<span class="op" id="4762312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762319">return</span>&nbsp;<span class="ident" id="4762326">nil</span><span class="op" id="4762329">,</span>&nbsp;<span class="ident" id="4762331"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762339">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762345">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762359"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762360">.</span><span class="ident" id="4762361">numCap</span><span class="op" id="4762367">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762373"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762374">.</span><span class="ident" id="4762375">op</span><span class="op" id="4762377">(</span><span class="ident" id="4762378"><a href="/regexp/syntax/parse.go.html#4745432">opLeftParen</a></span><span class="op" id="4762389">)</span><span class="op" id="4762390">.</span><span class="ident" id="4762391">Cap</span>&nbsp;<span class="op" id="4762395">=</span>&nbsp;<span class="ident" id="4762397"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762398">.</span><span class="ident" id="4762399">numCap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762409"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4762411">=</span>&nbsp;<span class="ident" id="4762413"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762414">[</span><span class="num" id="4762415">1</span><span class="op" id="4762416">:</span><span class="op" id="4762417">]</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762421">case</span>&nbsp;<span class="string" id="4762426">&#39;|&#39;</span><span class="op" id="4762429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762434">if</span>&nbsp;<span class="ident" id="4762437"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4762441">=</span>&nbsp;<span class="ident" id="4762443"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762444">.</span><span class="ident" id="4762445">parseVerticalBar</span><span class="op" id="4762461">(</span><span class="op" id="4762462">)</span><span class="op" id="4762463">;</span>&nbsp;<span class="ident" id="4762465"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4762469">!=</span>&nbsp;<span class="ident" id="4762472">nil</span>&nbsp;<span class="op" id="4762476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762482">return</span>&nbsp;<span class="ident" id="4762489">nil</span><span class="op" id="4762492">,</span>&nbsp;<span class="ident" id="4762494"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762506"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4762508">=</span>&nbsp;<span class="ident" id="4762510"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762511">[</span><span class="num" id="4762512">1</span><span class="op" id="4762513">:</span><span class="op" id="4762514">]</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762518">case</span>&nbsp;<span class="string" id="4762523">&#39;)&#39;</span><span class="op" id="4762526">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762531">if</span>&nbsp;<span class="ident" id="4762534"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4762538">=</span>&nbsp;<span class="ident" id="4762540"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762541">.</span><span class="ident" id="4762542">parseRightParen</span><span class="op" id="4762557">(</span><span class="op" id="4762558">)</span><span class="op" id="4762559">;</span>&nbsp;<span class="ident" id="4762561"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4762565">!=</span>&nbsp;<span class="ident" id="4762568">nil</span>&nbsp;<span class="op" id="4762572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762578">return</span>&nbsp;<span class="ident" id="4762585">nil</span><span class="op" id="4762588">,</span>&nbsp;<span class="ident" id="4762590"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762602"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4762604">=</span>&nbsp;<span class="ident" id="4762606"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762607">[</span><span class="num" id="4762608">1</span><span class="op" id="4762609">:</span><span class="op" id="4762610">]</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762614">case</span>&nbsp;<span class="string" id="4762619">&#39;^&#39;</span><span class="op" id="4762622">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762627">if</span>&nbsp;<span class="ident" id="4762630"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762631">.</span><span class="ident" id="4762632">flags</span><span class="op" id="4762637">&amp;</span><span class="ident" id="4762638"><a href="/regexp/syntax/parse.go.html#4744728">OneLine</a></span>&nbsp;<span class="op" id="4762646">!=</span>&nbsp;<span class="num" id="4762649">0</span>&nbsp;<span class="op" id="4762651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762657"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762658">.</span><span class="ident" id="4762659">op</span><span class="op" id="4762661">(</span><span class="ident" id="4762662"><a href="/regexp/syntax/regexp.go.html#4801350">OpBeginText</a></span><span class="op" id="4762673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762678">}</span>&nbsp;<span class="keyword" id="4762680">else</span>&nbsp;<span class="op" id="4762685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762691"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762692">.</span><span class="ident" id="4762693">op</span><span class="op" id="4762695">(</span><span class="ident" id="4762696"><a href="/regexp/syntax/regexp.go.html#4801202">OpBeginLine</a></span><span class="op" id="4762707">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762717"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4762719">=</span>&nbsp;<span class="ident" id="4762721"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762722">[</span><span class="num" id="4762723">1</span><span class="op" id="4762724">:</span><span class="op" id="4762725">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762729">case</span>&nbsp;<span class="string" id="4762734">&#39;$&#39;</span><span class="op" id="4762737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762742">if</span>&nbsp;<span class="ident" id="4762745"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762746">.</span><span class="ident" id="4762747">flags</span><span class="op" id="4762752">&amp;</span><span class="ident" id="4762753"><a href="/regexp/syntax/parse.go.html#4744728">OneLine</a></span>&nbsp;<span class="op" id="4762761">!=</span>&nbsp;<span class="num" id="4762764">0</span>&nbsp;<span class="op" id="4762766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762772"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762773">.</span><span class="ident" id="4762774">op</span><span class="op" id="4762776">(</span><span class="ident" id="4762777"><a href="/regexp/syntax/regexp.go.html#4801427">OpEndText</a></span><span class="op" id="4762786">)</span><span class="op" id="4762787">.</span><span class="ident" id="4762788">Flags</span>&nbsp;<span class="op" id="4762794">|=</span>&nbsp;<span class="ident" id="4762797"><a href="/regexp/syntax/parse.go.html#4745056">WasDollar</a></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762810">}</span>&nbsp;<span class="keyword" id="4762812">else</span>&nbsp;<span class="op" id="4762817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762823"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762824">.</span><span class="ident" id="4762825">op</span><span class="op" id="4762827">(</span><span class="ident" id="4762828"><a href="/regexp/syntax/regexp.go.html#4801279">OpEndLine</a></span><span class="op" id="4762837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762847"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4762849">=</span>&nbsp;<span class="ident" id="4762851"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762852">[</span><span class="num" id="4762853">1</span><span class="op" id="4762854">:</span><span class="op" id="4762855">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762859">case</span>&nbsp;<span class="string" id="4762864">&#39;.&#39;</span><span class="op" id="4762867">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762872">if</span>&nbsp;<span class="ident" id="4762875"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762876">.</span><span class="ident" id="4762877">flags</span><span class="op" id="4762882">&amp;</span><span class="ident" id="4762883"><a href="/regexp/syntax/parse.go.html#4744667">DotNL</a></span>&nbsp;<span class="op" id="4762889">!=</span>&nbsp;<span class="num" id="4762892">0</span>&nbsp;<span class="op" id="4762894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762900"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762901">.</span><span class="ident" id="4762902">op</span><span class="op" id="4762904">(</span><span class="ident" id="4762905"><a href="/regexp/syntax/regexp.go.html#4801145">OpAnyChar</a></span><span class="op" id="4762914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762919">}</span>&nbsp;<span class="keyword" id="4762921">else</span>&nbsp;<span class="op" id="4762926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762932"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762933">.</span><span class="ident" id="4762934">op</span><span class="op" id="4762936">(</span><span class="ident" id="4762937"><a href="/regexp/syntax/regexp.go.html#4801073">OpAnyCharNotNL</a></span><span class="op" id="4762951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762956">}</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762961"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4762963">=</span>&nbsp;<span class="ident" id="4762965"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762966">[</span><span class="num" id="4762967">1</span><span class="op" id="4762968">:</span><span class="op" id="4762969">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762973">case</span>&nbsp;<span class="string" id="4762978">&#39;[&#39;</span><span class="op" id="4762981">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762986">if</span>&nbsp;<span class="ident" id="4762989"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4762990">,</span>&nbsp;<span class="ident" id="4762992"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4762996">=</span>&nbsp;<span class="ident" id="4762998"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4762999">.</span><span class="ident" id="4763000">parseClass</span><span class="op" id="4763010">(</span><span class="ident" id="4763011"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4763012">)</span><span class="op" id="4763013">;</span>&nbsp;<span class="ident" id="4763015"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4763019">!=</span>&nbsp;<span class="ident" id="4763022">nil</span>&nbsp;<span class="op" id="4763026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763032">return</span>&nbsp;<span class="ident" id="4763039">nil</span><span class="op" id="4763042">,</span>&nbsp;<span class="ident" id="4763044"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763051">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763055">case</span>&nbsp;<span class="string" id="4763060">&#39;*&#39;</span><span class="op" id="4763063">,</span>&nbsp;<span class="string" id="4763065">&#39;+&#39;</span><span class="op" id="4763068">,</span>&nbsp;<span class="string" id="4763070">&#39;?&#39;</span><span class="op" id="4763073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763078">before</span>&nbsp;<span class="op" id="4763085">:=</span>&nbsp;<span class="ident" id="4763088"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763093">switch</span>&nbsp;<span class="ident" id="4763100"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4763101">[</span><span class="num" id="4763102">0</span><span class="op" id="4763103">]</span>&nbsp;<span class="op" id="4763105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763110">case</span>&nbsp;<span class="string" id="4763115">&#39;*&#39;</span><span class="op" id="4763118">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763124"><a href="/regexp/syntax/parse.go.html#4761913">op</a></span>&nbsp;<span class="op" id="4763127">=</span>&nbsp;<span class="ident" id="4763129"><a href="/regexp/syntax/regexp.go.html#4801720">OpStar</a></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763139">case</span>&nbsp;<span class="string" id="4763144">&#39;+&#39;</span><span class="op" id="4763147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763153"><a href="/regexp/syntax/parse.go.html#4761913">op</a></span>&nbsp;<span class="op" id="4763156">=</span>&nbsp;<span class="ident" id="4763158"><a href="/regexp/syntax/regexp.go.html#4801789">OpPlus</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763168">case</span>&nbsp;<span class="string" id="4763173">&#39;?&#39;</span><span class="op" id="4763176">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763182"><a href="/regexp/syntax/parse.go.html#4761913">op</a></span>&nbsp;<span class="op" id="4763185">=</span>&nbsp;<span class="ident" id="4763187"><a href="/regexp/syntax/regexp.go.html#4801857">OpQuest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763198">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763203">after</span>&nbsp;<span class="op" id="4763209">:=</span>&nbsp;<span class="ident" id="4763212"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4763213">[</span><span class="num" id="4763214">1</span><span class="op" id="4763215">:</span><span class="op" id="4763216">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763221">if</span>&nbsp;<span class="ident" id="4763224"><a href="/regexp/syntax/parse.go.html#4763203">after</a></span><span class="op" id="4763229">,</span>&nbsp;<span class="ident" id="4763231"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4763235">=</span>&nbsp;<span class="ident" id="4763237"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4763238">.</span><span class="ident" id="4763239">repeat</span><span class="op" id="4763245">(</span><span class="ident" id="4763246"><a href="/regexp/syntax/parse.go.html#4761913">op</a></span><span class="op" id="4763248">,</span>&nbsp;<span class="num" id="4763250">0</span><span class="op" id="4763251">,</span>&nbsp;<span class="num" id="4763253">0</span><span class="op" id="4763254">,</span>&nbsp;<span class="ident" id="4763256"><a href="/regexp/syntax/parse.go.html#4763078">before</a></span><span class="op" id="4763262">,</span>&nbsp;<span class="ident" id="4763264"><a href="/regexp/syntax/parse.go.html#4763203">after</a></span><span class="op" id="4763269">,</span>&nbsp;<span class="ident" id="4763271"><a href="/regexp/syntax/parse.go.html#4761929">lastRepeat</a></span><span class="op" id="4763281">)</span><span class="op" id="4763282">;</span>&nbsp;<span class="ident" id="4763284"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4763288">!=</span>&nbsp;<span class="ident" id="4763291">nil</span>&nbsp;<span class="op" id="4763295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763301">return</span>&nbsp;<span class="ident" id="4763308">nil</span><span class="op" id="4763311">,</span>&nbsp;<span class="ident" id="4763313"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763325"><a href="/regexp/syntax/parse.go.html#4762011">repeat</a></span>&nbsp;<span class="op" id="4763332">=</span>&nbsp;<span class="ident" id="4763334"><a href="/regexp/syntax/parse.go.html#4763078">before</a></span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763344"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4763346">=</span>&nbsp;<span class="ident" id="4763348"><a href="/regexp/syntax/parse.go.html#4763203">after</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763356">case</span>&nbsp;<span class="string" id="4763361">&#39;{&#39;</span><span class="op" id="4763364">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763369"><a href="/regexp/syntax/parse.go.html#4761913">op</a></span>&nbsp;<span class="op" id="4763372">=</span>&nbsp;<span class="ident" id="4763374"><a href="/regexp/syntax/regexp.go.html#4801925">OpRepeat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763386">before</span>&nbsp;<span class="op" id="4763393">:=</span>&nbsp;<span class="ident" id="4763396"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763401">min</span><span class="op" id="4763404">,</span>&nbsp;<span class="ident" id="4763406">max</span><span class="op" id="4763409">,</span>&nbsp;<span class="ident" id="4763411">after</span><span class="op" id="4763416">,</span>&nbsp;<span class="ident" id="4763418">ok</span>&nbsp;<span class="op" id="4763421">:=</span>&nbsp;<span class="ident" id="4763424"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4763425">.</span><span class="ident" id="4763426">parseRepeat</span><span class="op" id="4763437">(</span><span class="ident" id="4763438"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4763439">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763444">if</span>&nbsp;<span class="op" id="4763447">!</span><span class="ident" id="4763448"><a href="/regexp/syntax/parse.go.html#4763418">ok</a></span>&nbsp;<span class="op" id="4763451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4763457">//&nbsp;If&nbsp;the&nbsp;repeat&nbsp;cannot&nbsp;be&nbsp;parsed,&nbsp;{&nbsp;is&nbsp;a&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763512"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4763513">.</span><span class="ident" id="4763514">literal</span><span class="op" id="4763521">(</span><span class="string" id="4763522">&#39;{&#39;</span><span class="op" id="4763525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763531"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4763533">=</span>&nbsp;<span class="ident" id="4763535"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4763536">[</span><span class="num" id="4763537">1</span><span class="op" id="4763538">:</span><span class="op" id="4763539">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763545">break</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763559">if</span>&nbsp;<span class="ident" id="4763562"><a href="/regexp/syntax/parse.go.html#4763401">min</a></span>&nbsp;<span class="op" id="4763566">&lt;</span>&nbsp;<span class="num" id="4763568">0</span>&nbsp;<span class="op" id="4763570">||</span>&nbsp;<span class="ident" id="4763573"><a href="/regexp/syntax/parse.go.html#4763401">min</a></span>&nbsp;<span class="op" id="4763577">&gt;</span>&nbsp;<span class="num" id="4763579">1000</span>&nbsp;<span class="op" id="4763584">||</span>&nbsp;<span class="ident" id="4763587"><a href="/regexp/syntax/parse.go.html#4763406">max</a></span>&nbsp;<span class="op" id="4763591">&gt;</span>&nbsp;<span class="num" id="4763593">1000</span>&nbsp;<span class="op" id="4763598">||</span>&nbsp;<span class="ident" id="4763601"><a href="/regexp/syntax/parse.go.html#4763406">max</a></span>&nbsp;<span class="op" id="4763605">&gt;=</span>&nbsp;<span class="num" id="4763608">0</span>&nbsp;<span class="op" id="4763610">&amp;&amp;</span>&nbsp;<span class="ident" id="4763613"><a href="/regexp/syntax/parse.go.html#4763401">min</a></span>&nbsp;<span class="op" id="4763617">&gt;</span>&nbsp;<span class="ident" id="4763619"><a href="/regexp/syntax/parse.go.html#4763406">max</a></span>&nbsp;<span class="op" id="4763623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4763629">//&nbsp;Numbers&nbsp;were&nbsp;too&nbsp;big,&nbsp;or&nbsp;max&nbsp;is&nbsp;present&nbsp;and&nbsp;min&nbsp;&gt;&nbsp;max.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763691">return</span>&nbsp;<span class="ident" id="4763698">nil</span><span class="op" id="4763701">,</span>&nbsp;<span class="op" id="4763703">&amp;</span><span class="ident" id="4763704"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4763709">{</span><span class="ident" id="4763710"><a href="/regexp/syntax/parse.go.html#4743814">ErrInvalidRepeatSize</a></span><span class="op" id="4763730">,</span>&nbsp;<span class="ident" id="4763732"><a href="/regexp/syntax/parse.go.html#4763386">before</a></span><span class="op" id="4763738">[</span><span class="op" id="4763739">:</span><span class="builtinfunc" id="4763740">len</span><span class="op" id="4763743">(</span><span class="ident" id="4763744"><a href="/regexp/syntax/parse.go.html#4763386">before</a></span><span class="op" id="4763750">)</span><span class="op" id="4763751">-</span><span class="builtinfunc" id="4763752">len</span><span class="op" id="4763755">(</span><span class="ident" id="4763756"><a href="/regexp/syntax/parse.go.html#4763411">after</a></span><span class="op" id="4763761">)</span><span class="op" id="4763762">]</span><span class="op" id="4763763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763768">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763773">if</span>&nbsp;<span class="ident" id="4763776"><a href="/regexp/syntax/parse.go.html#4763411">after</a></span><span class="op" id="4763781">,</span>&nbsp;<span class="ident" id="4763783"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4763787">=</span>&nbsp;<span class="ident" id="4763789"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4763790">.</span><span class="ident" id="4763791">repeat</span><span class="op" id="4763797">(</span><span class="ident" id="4763798"><a href="/regexp/syntax/parse.go.html#4761913">op</a></span><span class="op" id="4763800">,</span>&nbsp;<span class="ident" id="4763802"><a href="/regexp/syntax/parse.go.html#4763401">min</a></span><span class="op" id="4763805">,</span>&nbsp;<span class="ident" id="4763807"><a href="/regexp/syntax/parse.go.html#4763406">max</a></span><span class="op" id="4763810">,</span>&nbsp;<span class="ident" id="4763812"><a href="/regexp/syntax/parse.go.html#4763386">before</a></span><span class="op" id="4763818">,</span>&nbsp;<span class="ident" id="4763820"><a href="/regexp/syntax/parse.go.html#4763411">after</a></span><span class="op" id="4763825">,</span>&nbsp;<span class="ident" id="4763827"><a href="/regexp/syntax/parse.go.html#4761929">lastRepeat</a></span><span class="op" id="4763837">)</span><span class="op" id="4763838">;</span>&nbsp;<span class="ident" id="4763840"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4763844">!=</span>&nbsp;<span class="ident" id="4763847">nil</span>&nbsp;<span class="op" id="4763851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763857">return</span>&nbsp;<span class="ident" id="4763864">nil</span><span class="op" id="4763867">,</span>&nbsp;<span class="ident" id="4763869"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763881"><a href="/regexp/syntax/parse.go.html#4762011">repeat</a></span>&nbsp;<span class="op" id="4763888">=</span>&nbsp;<span class="ident" id="4763890"><a href="/regexp/syntax/parse.go.html#4763386">before</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763900"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4763902">=</span>&nbsp;<span class="ident" id="4763904"><a href="/regexp/syntax/parse.go.html#4763411">after</a></span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763912">case</span>&nbsp;<span class="string" id="4763917">&#39;\\&#39;</span><span class="op" id="4763921">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763926">if</span>&nbsp;<span class="ident" id="4763929"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4763930">.</span><span class="ident" id="4763931">flags</span><span class="op" id="4763936">&amp;</span><span class="ident" id="4763937"><a href="/regexp/syntax/parse.go.html#4744908">PerlX</a></span>&nbsp;<span class="op" id="4763943">!=</span>&nbsp;<span class="num" id="4763946">0</span>&nbsp;<span class="op" id="4763948">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4763951">len</span><span class="op" id="4763954">(</span><span class="ident" id="4763955"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4763956">)</span>&nbsp;<span class="op" id="4763958">&gt;=</span>&nbsp;<span class="num" id="4763961">2</span>&nbsp;<span class="op" id="4763963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763969">switch</span>&nbsp;<span class="ident" id="4763976"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4763977">[</span><span class="num" id="4763978">1</span><span class="op" id="4763979">]</span>&nbsp;<span class="op" id="4763981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763987">case</span>&nbsp;<span class="string" id="4763992">&#39;A&#39;</span><span class="op" id="4763995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764002"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4764003">.</span><span class="ident" id="4764004">op</span><span class="op" id="4764006">(</span><span class="ident" id="4764007"><a href="/regexp/syntax/regexp.go.html#4801350">OpBeginText</a></span><span class="op" id="4764018">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764025"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4764027">=</span>&nbsp;<span class="ident" id="4764029"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764030">[</span><span class="num" id="4764031">2</span><span class="op" id="4764032">:</span><span class="op" id="4764033">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764040">break</span>&nbsp;<span class="ident" id="4764046">BigSwitch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764060">case</span>&nbsp;<span class="string" id="4764065">&#39;b&#39;</span><span class="op" id="4764068">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764075"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4764076">.</span><span class="ident" id="4764077">op</span><span class="op" id="4764079">(</span><span class="ident" id="4764080"><a href="/regexp/syntax/regexp.go.html#4801498">OpWordBoundary</a></span><span class="op" id="4764094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764101"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4764103">=</span>&nbsp;<span class="ident" id="4764105"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764106">[</span><span class="num" id="4764107">2</span><span class="op" id="4764108">:</span><span class="op" id="4764109">]</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764116">break</span>&nbsp;<span class="ident" id="4764122">BigSwitch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764136">case</span>&nbsp;<span class="string" id="4764141">&#39;B&#39;</span><span class="op" id="4764144">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764151"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4764152">.</span><span class="ident" id="4764153">op</span><span class="op" id="4764155">(</span><span class="ident" id="4764156"><a href="/regexp/syntax/regexp.go.html#4801560">OpNoWordBoundary</a></span><span class="op" id="4764172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764179"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4764181">=</span>&nbsp;<span class="ident" id="4764183"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764184">[</span><span class="num" id="4764185">2</span><span class="op" id="4764186">:</span><span class="op" id="4764187">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764194">break</span>&nbsp;<span class="ident" id="4764200">BigSwitch</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764214">case</span>&nbsp;<span class="string" id="4764219">&#39;C&#39;</span><span class="op" id="4764222">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4764229">//&nbsp;any&nbsp;byte;&nbsp;not&nbsp;supported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764261">return</span>&nbsp;<span class="ident" id="4764268">nil</span><span class="op" id="4764271">,</span>&nbsp;<span class="op" id="4764273">&amp;</span><span class="ident" id="4764274"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4764279">{</span><span class="ident" id="4764280"><a href="/regexp/syntax/parse.go.html#4743538">ErrInvalidEscape</a></span><span class="op" id="4764296">,</span>&nbsp;<span class="ident" id="4764298"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764299">[</span><span class="op" id="4764300">:</span><span class="num" id="4764301">2</span><span class="op" id="4764302">]</span><span class="op" id="4764303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764309">case</span>&nbsp;<span class="string" id="4764314">&#39;Q&#39;</span><span class="op" id="4764317">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4764324">//&nbsp;\Q&nbsp;...&nbsp;\E:&nbsp;the&nbsp;...&nbsp;is&nbsp;always&nbsp;literals</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764370">var</span>&nbsp;<span class="ident" id="4764374">lit</span>&nbsp;<span class="builtintype" id="4764378">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764390">if</span>&nbsp;<span class="ident" id="4764393">i</span>&nbsp;<span class="op" id="4764395">:=</span>&nbsp;<span class="ident" id="4764398"><a href="/regexp/syntax/parse.go.html#4742901">strings</a></span><span class="op" id="4764405">.</span><span class="ident" id="4764406">Index</span><span class="op" id="4764411">(</span><span class="ident" id="4764412"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764413">,</span>&nbsp;<span class="string" id="4764415">`\E`</span><span class="op" id="4764419">)</span><span class="op" id="4764420">;</span>&nbsp;<span class="ident" id="4764422"><a href="/regexp/syntax/parse.go.html#4764393">i</a></span>&nbsp;<span class="op" id="4764424">&lt;</span>&nbsp;<span class="num" id="4764426">0</span>&nbsp;<span class="op" id="4764428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764436"><a href="/regexp/syntax/parse.go.html#4764374">lit</a></span>&nbsp;<span class="op" id="4764440">=</span>&nbsp;<span class="ident" id="4764442"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764443">[</span><span class="num" id="4764444">2</span><span class="op" id="4764445">:</span><span class="op" id="4764446">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764454"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4764456">=</span>&nbsp;<span class="string" id="4764458">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764466">}</span>&nbsp;<span class="keyword" id="4764468">else</span>&nbsp;<span class="op" id="4764473">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764481"><a href="/regexp/syntax/parse.go.html#4764374">lit</a></span>&nbsp;<span class="op" id="4764485">=</span>&nbsp;<span class="ident" id="4764487"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764488">[</span><span class="num" id="4764489">2</span><span class="op" id="4764490">:</span><span class="ident" id="4764491"><a href="/regexp/syntax/parse.go.html#4764393">i</a></span><span class="op" id="4764492">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764500"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4764502">=</span>&nbsp;<span class="ident" id="4764504"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764505">[</span><span class="ident" id="4764506"><a href="/regexp/syntax/parse.go.html#4764393">i</a></span><span class="op" id="4764507">+</span><span class="num" id="4764508">2</span><span class="op" id="4764509">:</span><span class="op" id="4764510">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764524"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4764525">.</span><span class="ident" id="4764526">push</span><span class="op" id="4764530">(</span><span class="ident" id="4764531"><a href="/regexp/syntax/parse.go.html#4761034">literalRegexp</a></span><span class="op" id="4764544">(</span><span class="ident" id="4764545"><a href="/regexp/syntax/parse.go.html#4764374">lit</a></span><span class="op" id="4764548">,</span>&nbsp;<span class="ident" id="4764550"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4764551">.</span><span class="ident" id="4764552">flags</span><span class="op" id="4764557">)</span><span class="op" id="4764558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764565">break</span>&nbsp;<span class="ident" id="4764571">BigSwitch</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764585">case</span>&nbsp;<span class="string" id="4764590">&#39;z&#39;</span><span class="op" id="4764593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764600"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4764601">.</span><span class="ident" id="4764602">op</span><span class="op" id="4764604">(</span><span class="ident" id="4764605"><a href="/regexp/syntax/regexp.go.html#4801427">OpEndText</a></span><span class="op" id="4764614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764621"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4764623">=</span>&nbsp;<span class="ident" id="4764625"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764626">[</span><span class="num" id="4764627">2</span><span class="op" id="4764628">:</span><span class="op" id="4764629">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764636">break</span>&nbsp;<span class="ident" id="4764642">BigSwitch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764656">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764667">re</span>&nbsp;<span class="op" id="4764670">:=</span>&nbsp;<span class="ident" id="4764673"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4764674">.</span><span class="ident" id="4764675">newRegexp</span><span class="op" id="4764684">(</span><span class="ident" id="4764685"><a href="/regexp/syntax/regexp.go.html#4800993">OpCharClass</a></span><span class="op" id="4764696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764701"><a href="/regexp/syntax/parse.go.html#4764667">re</a></span><span class="op" id="4764703">.</span><span class="ident" id="4764704">Flags</span>&nbsp;<span class="op" id="4764710">=</span>&nbsp;<span class="ident" id="4764712"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4764713">.</span><span class="ident" id="4764714">flags</span><br>
<span class="lineno"></span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4764724">//&nbsp;Look&nbsp;for&nbsp;Unicode&nbsp;character&nbsp;group&nbsp;like&nbsp;\p{Han}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764776">if</span>&nbsp;<span class="builtinfunc" id="4764779">len</span><span class="op" id="4764782">(</span><span class="ident" id="4764783"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764784">)</span>&nbsp;<span class="op" id="4764786">&gt;=</span>&nbsp;<span class="num" id="4764789">2</span>&nbsp;<span class="op" id="4764791">&amp;&amp;</span>&nbsp;<span class="op" id="4764794">(</span><span class="ident" id="4764795"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764796">[</span><span class="num" id="4764797">1</span><span class="op" id="4764798">]</span>&nbsp;<span class="op" id="4764800">==</span>&nbsp;<span class="string" id="4764803">&#39;p&#39;</span>&nbsp;<span class="op" id="4764807">||</span>&nbsp;<span class="ident" id="4764810"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764811">[</span><span class="num" id="4764812">1</span><span class="op" id="4764813">]</span>&nbsp;<span class="op" id="4764815">==</span>&nbsp;<span class="string" id="4764818">&#39;P&#39;</span><span class="op" id="4764821">)</span>&nbsp;<span class="op" id="4764823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764829">r</span><span class="op" id="4764830">,</span>&nbsp;<span class="ident" id="4764832">rest</span><span class="op" id="4764836">,</span>&nbsp;<span class="ident" id="4764838">err</span>&nbsp;<span class="op" id="4764842">:=</span>&nbsp;<span class="ident" id="4764845"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4764846">.</span><span class="ident" id="4764847">parseUnicodeClass</span><span class="op" id="4764864">(</span><span class="ident" id="4764865"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4764866">,</span>&nbsp;<span class="ident" id="4764868"><a href="/regexp/syntax/parse.go.html#4764667">re</a></span><span class="op" id="4764870">.</span><span class="ident" id="4764871">Rune0</span><span class="op" id="4764876">[</span><span class="op" id="4764877">:</span><span class="num" id="4764878">0</span><span class="op" id="4764879">]</span><span class="op" id="4764880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764886">if</span>&nbsp;<span class="ident" id="4764889"><a href="/regexp/syntax/parse.go.html#4764838">err</a></span>&nbsp;<span class="op" id="4764893">!=</span>&nbsp;<span class="ident" id="4764896">nil</span>&nbsp;<span class="op" id="4764900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764907">return</span>&nbsp;<span class="ident" id="4764914">nil</span><span class="op" id="4764917">,</span>&nbsp;<span class="ident" id="4764919"><a href="/regexp/syntax/parse.go.html#4764838">err</a></span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764933">if</span>&nbsp;<span class="ident" id="4764936"><a href="/regexp/syntax/parse.go.html#4764829">r</a></span>&nbsp;<span class="op" id="4764938">!=</span>&nbsp;<span class="ident" id="4764941">nil</span>&nbsp;<span class="op" id="4764945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764952"><a href="/regexp/syntax/parse.go.html#4764667">re</a></span><span class="op" id="4764954">.</span><span class="ident" id="4764955">Rune</span>&nbsp;<span class="op" id="4764960">=</span>&nbsp;<span class="ident" id="4764962"><a href="/regexp/syntax/parse.go.html#4764829">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764969"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4764971">=</span>&nbsp;<span class="ident" id="4764973"><a href="/regexp/syntax/parse.go.html#4764832">rest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764983"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4764984">.</span><span class="ident" id="4764985">push</span><span class="op" id="4764989">(</span><span class="ident" id="4764990"><a href="/regexp/syntax/parse.go.html#4764667">re</a></span><span class="op" id="4764992">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764999">break</span>&nbsp;<span class="ident" id="4765005">BigSwitch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4765030">//&nbsp;Perl&nbsp;character&nbsp;class&nbsp;escape.</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765065">if</span>&nbsp;<span class="ident" id="4765068">r</span><span class="op" id="4765069">,</span>&nbsp;<span class="ident" id="4765071">rest</span>&nbsp;<span class="op" id="4765076">:=</span>&nbsp;<span class="ident" id="4765079"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765080">.</span><span class="ident" id="4765081">parsePerlClassEscape</span><span class="op" id="4765101">(</span><span class="ident" id="4765102"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4765103">,</span>&nbsp;<span class="ident" id="4765105"><a href="/regexp/syntax/parse.go.html#4764667">re</a></span><span class="op" id="4765107">.</span><span class="ident" id="4765108">Rune0</span><span class="op" id="4765113">[</span><span class="op" id="4765114">:</span><span class="num" id="4765115">0</span><span class="op" id="4765116">]</span><span class="op" id="4765117">)</span><span class="op" id="4765118">;</span>&nbsp;<span class="ident" id="4765120"><a href="/regexp/syntax/parse.go.html#4765068">r</a></span>&nbsp;<span class="op" id="4765122">!=</span>&nbsp;<span class="ident" id="4765125">nil</span>&nbsp;<span class="op" id="4765129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765135"><a href="/regexp/syntax/parse.go.html#4764667">re</a></span><span class="op" id="4765137">.</span><span class="ident" id="4765138">Rune</span>&nbsp;<span class="op" id="4765143">=</span>&nbsp;<span class="ident" id="4765145"><a href="/regexp/syntax/parse.go.html#4765068">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765151"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span>&nbsp;<span class="op" id="4765153">=</span>&nbsp;<span class="ident" id="4765155"><a href="/regexp/syntax/parse.go.html#4765071">rest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765164"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765165">.</span><span class="ident" id="4765166">push</span><span class="op" id="4765170">(</span><span class="ident" id="4765171"><a href="/regexp/syntax/parse.go.html#4764667">re</a></span><span class="op" id="4765173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765179">break</span>&nbsp;<span class="ident" id="4765185">BigSwitch</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765203"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765204">.</span><span class="ident" id="4765205">reuse</span><span class="op" id="4765210">(</span><span class="ident" id="4765211"><a href="/regexp/syntax/parse.go.html#4764667">re</a></span><span class="op" id="4765213">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4765219">//&nbsp;Ordinary&nbsp;single-character&nbsp;escape.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765259">if</span>&nbsp;<span class="ident" id="4765262"><a href="/regexp/syntax/parse.go.html#4761895">c</a></span><span class="op" id="4765263">,</span>&nbsp;<span class="ident" id="4765265"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4765266">,</span>&nbsp;<span class="ident" id="4765268"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4765272">=</span>&nbsp;<span class="ident" id="4765274"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765275">.</span><span class="ident" id="4765276">parseEscape</span><span class="op" id="4765287">(</span><span class="ident" id="4765288"><a href="/regexp/syntax/parse.go.html#4761987">t</a></span><span class="op" id="4765289">)</span><span class="op" id="4765290">;</span>&nbsp;<span class="ident" id="4765292"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span>&nbsp;<span class="op" id="4765296">!=</span>&nbsp;<span class="ident" id="4765299">nil</span>&nbsp;<span class="op" id="4765303">{</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765309">return</span>&nbsp;<span class="ident" id="4765316">nil</span><span class="op" id="4765319">,</span>&nbsp;<span class="ident" id="4765321"><a href="/regexp/syntax/parse.go.html#4761876">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765333"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765334">.</span><span class="ident" id="4765335">literal</span><span class="op" id="4765342">(</span><span class="ident" id="4765343"><a href="/regexp/syntax/parse.go.html#4761895">c</a></span><span class="op" id="4765344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765352"><a href="/regexp/syntax/parse.go.html#4761929">lastRepeat</a></span>&nbsp;<span class="op" id="4765363">=</span>&nbsp;<span class="ident" id="4765365"><a href="/regexp/syntax/parse.go.html#4762011">repeat</a></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765377"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765378">.</span><span class="ident" id="4765379">concat</span><span class="op" id="4765385">(</span><span class="op" id="4765386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765389">if</span>&nbsp;<span class="ident" id="4765392"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765393">.</span><span class="ident" id="4765394">swapVerticalBar</span><span class="op" id="4765409">(</span><span class="op" id="4765410">)</span>&nbsp;<span class="op" id="4765412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4765416">//&nbsp;pop&nbsp;vertical&nbsp;bar</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765438"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765439">.</span><span class="ident" id="4765440">stack</span>&nbsp;<span class="op" id="4765446">=</span>&nbsp;<span class="ident" id="4765448"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765449">.</span><span class="ident" id="4765450">stack</span><span class="op" id="4765455">[</span><span class="op" id="4765456">:</span><span class="builtinfunc" id="4765457">len</span><span class="op" id="4765460">(</span><span class="ident" id="4765461"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765462">.</span><span class="ident" id="4765463">stack</span><span class="op" id="4765468">)</span><span class="op" id="4765469">-</span><span class="num" id="4765470">1</span><span class="op" id="4765471">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765477"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765478">.</span><span class="ident" id="4765479">alternate</span><span class="op" id="4765488">(</span><span class="op" id="4765489">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765493">n</span>&nbsp;<span class="op" id="4765495">:=</span>&nbsp;<span class="builtinfunc" id="4765498">len</span><span class="op" id="4765501">(</span><span class="ident" id="4765502"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765503">.</span><span class="ident" id="4765504">stack</span><span class="op" id="4765509">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765512">if</span>&nbsp;<span class="ident" id="4765515"><a href="/regexp/syntax/parse.go.html#4765493">n</a></span>&nbsp;<span class="op" id="4765517">!=</span>&nbsp;<span class="num" id="4765520">1</span>&nbsp;<span class="op" id="4765522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765526">return</span>&nbsp;<span class="ident" id="4765533">nil</span><span class="op" id="4765536">,</span>&nbsp;<span class="op" id="4765538">&amp;</span><span class="ident" id="4765539"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4765544">{</span><span class="ident" id="4765545"><a href="/regexp/syntax/parse.go.html#4743987">ErrMissingParen</a></span><span class="op" id="4765560">,</span>&nbsp;<span class="ident" id="4765562"><a href="/regexp/syntax/parse.go.html#4761602">s</a></span><span class="op" id="4765563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765569">return</span>&nbsp;<span class="ident" id="4765576"><a href="/regexp/syntax/parse.go.html#4761856">p</a></span><span class="op" id="4765577">.</span><span class="ident" id="4765578">stack</span><span class="op" id="4765583">[</span><span class="num" id="4765584">0</span><span class="op" id="4765585">]</span><span class="op" id="4765586">,</span>&nbsp;<span class="ident" id="4765588">nil</span><br>
<span class="lineno"></span><span class="op" id="4765592">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span><span class="comment" id="4765595">//&nbsp;parseRepeat&nbsp;parses&nbsp;{min}&nbsp;(max=min)&nbsp;or&nbsp;{min,}&nbsp;(max=-1)&nbsp;or&nbsp;{min,max}.</span><br>
<span class="lineno"></span><span class="comment" id="4765666">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;of&nbsp;that&nbsp;form,&nbsp;it&nbsp;returns&nbsp;ok&nbsp;==&nbsp;false.</span><br>
<span class="lineno"></span><span class="comment" id="4765719">//&nbsp;If&nbsp;s&nbsp;has&nbsp;the&nbsp;right&nbsp;form&nbsp;but&nbsp;the&nbsp;values&nbsp;are&nbsp;too&nbsp;big,&nbsp;it&nbsp;returns&nbsp;min&nbsp;==&nbsp;-1,&nbsp;ok&nbsp;==&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="4765808">func</span>&nbsp;<span class="op" id="4765813">(</span><span class="ident" id="4765814">p</span>&nbsp;<span class="op" id="4765816">*</span><span class="ident" id="4765817"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4765823">)</span>&nbsp;<span class="ident" id="4765825">parseRepeat</span><span class="op" id="4765836">(</span><span class="ident" id="4765837">s</span>&nbsp;<span class="builtintype" id="4765839">string</span><span class="op" id="4765845">)</span>&nbsp;<span class="op" id="4765847">(</span><span class="ident" id="4765848">min</span><span class="op" id="4765851">,</span>&nbsp;<span class="ident" id="4765853">max</span>&nbsp;<span class="builtintype" id="4765857">int</span><span class="op" id="4765860">,</span>&nbsp;<span class="ident" id="4765862">rest</span>&nbsp;<span class="builtintype" id="4765867">string</span><span class="op" id="4765873">,</span>&nbsp;<span class="ident" id="4765875">ok</span>&nbsp;<span class="builtintype" id="4765878">bool</span><span class="op" id="4765882">)</span>&nbsp;<span class="op" id="4765884">{</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765887">if</span>&nbsp;<span class="ident" id="4765890"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span>&nbsp;<span class="op" id="4765892">==</span>&nbsp;<span class="string" id="4765895">&#34;&#34;</span>&nbsp;<span class="op" id="4765898">||</span>&nbsp;<span class="ident" id="4765901"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span><span class="op" id="4765902">[</span><span class="num" id="4765903">0</span><span class="op" id="4765904">]</span>&nbsp;<span class="op" id="4765906">!=</span>&nbsp;<span class="string" id="4765909">&#39;{&#39;</span>&nbsp;<span class="op" id="4765913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765917">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765928"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span>&nbsp;<span class="op" id="4765930">=</span>&nbsp;<span class="ident" id="4765932"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span><span class="op" id="4765933">[</span><span class="num" id="4765934">1</span><span class="op" id="4765935">:</span><span class="op" id="4765936">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765939">var</span>&nbsp;<span class="ident" id="4765943">ok1</span>&nbsp;<span class="builtintype" id="4765947">bool</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765953">if</span>&nbsp;<span class="ident" id="4765956"><a href="/regexp/syntax/parse.go.html#4765848">min</a></span><span class="op" id="4765959">,</span>&nbsp;<span class="ident" id="4765961"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span><span class="op" id="4765962">,</span>&nbsp;<span class="ident" id="4765964"><a href="/regexp/syntax/parse.go.html#4765943">ok1</a></span>&nbsp;<span class="op" id="4765968">=</span>&nbsp;<span class="ident" id="4765970"><a href="/regexp/syntax/parse.go.html#4765814">p</a></span><span class="op" id="4765971">.</span><span class="ident" id="4765972">parseInt</span><span class="op" id="4765980">(</span><span class="ident" id="4765981"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span><span class="op" id="4765982">)</span><span class="op" id="4765983">;</span>&nbsp;<span class="op" id="4765985">!</span><span class="ident" id="4765986"><a href="/regexp/syntax/parse.go.html#4765943">ok1</a></span>&nbsp;<span class="op" id="4765990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765994">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766005">if</span>&nbsp;<span class="ident" id="4766008"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span>&nbsp;<span class="op" id="4766010">==</span>&nbsp;<span class="string" id="4766013">&#34;&#34;</span>&nbsp;<span class="op" id="4766016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766020">return</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766031">if</span>&nbsp;<span class="ident" id="4766034"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span><span class="op" id="4766035">[</span><span class="num" id="4766036">0</span><span class="op" id="4766037">]</span>&nbsp;<span class="op" id="4766039">!=</span>&nbsp;<span class="string" id="4766042">&#39;,&#39;</span>&nbsp;<span class="op" id="4766046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766050"><a href="/regexp/syntax/parse.go.html#4765853">max</a></span>&nbsp;<span class="op" id="4766054">=</span>&nbsp;<span class="ident" id="4766056"><a href="/regexp/syntax/parse.go.html#4765848">min</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766061">}</span>&nbsp;<span class="keyword" id="4766063">else</span>&nbsp;<span class="op" id="4766068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766072"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span>&nbsp;<span class="op" id="4766074">=</span>&nbsp;<span class="ident" id="4766076"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span><span class="op" id="4766077">[</span><span class="num" id="4766078">1</span><span class="op" id="4766079">:</span><span class="op" id="4766080">]</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766084">if</span>&nbsp;<span class="ident" id="4766087"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span>&nbsp;<span class="op" id="4766089">==</span>&nbsp;<span class="string" id="4766092">&#34;&#34;</span>&nbsp;<span class="op" id="4766095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766100">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766113">if</span>&nbsp;<span class="ident" id="4766116"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span><span class="op" id="4766117">[</span><span class="num" id="4766118">0</span><span class="op" id="4766119">]</span>&nbsp;<span class="op" id="4766121">==</span>&nbsp;<span class="string" id="4766124">&#39;}&#39;</span>&nbsp;<span class="op" id="4766128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766133"><a href="/regexp/syntax/parse.go.html#4765853">max</a></span>&nbsp;<span class="op" id="4766137">=</span>&nbsp;<span class="op" id="4766139">-</span><span class="num" id="4766140">1</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766144">}</span>&nbsp;<span class="keyword" id="4766146">else</span>&nbsp;<span class="keyword" id="4766151">if</span>&nbsp;<span class="ident" id="4766154"><a href="/regexp/syntax/parse.go.html#4765853">max</a></span><span class="op" id="4766157">,</span>&nbsp;<span class="ident" id="4766159"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span><span class="op" id="4766160">,</span>&nbsp;<span class="ident" id="4766162"><a href="/regexp/syntax/parse.go.html#4765943">ok1</a></span>&nbsp;<span class="op" id="4766166">=</span>&nbsp;<span class="ident" id="4766168"><a href="/regexp/syntax/parse.go.html#4765814">p</a></span><span class="op" id="4766169">.</span><span class="ident" id="4766170">parseInt</span><span class="op" id="4766178">(</span><span class="ident" id="4766179"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span><span class="op" id="4766180">)</span><span class="op" id="4766181">;</span>&nbsp;<span class="op" id="4766183">!</span><span class="ident" id="4766184"><a href="/regexp/syntax/parse.go.html#4765943">ok1</a></span>&nbsp;<span class="op" id="4766188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766193">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766202">}</span>&nbsp;<span class="keyword" id="4766204">else</span>&nbsp;<span class="keyword" id="4766209">if</span>&nbsp;<span class="ident" id="4766212"><a href="/regexp/syntax/parse.go.html#4765853">max</a></span>&nbsp;<span class="op" id="4766216">&lt;</span>&nbsp;<span class="num" id="4766218">0</span>&nbsp;<span class="op" id="4766220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4766225">//&nbsp;parseInt&nbsp;found&nbsp;too&nbsp;big&nbsp;a&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766263"><a href="/regexp/syntax/parse.go.html#4765848">min</a></span>&nbsp;<span class="op" id="4766267">=</span>&nbsp;<span class="op" id="4766269">-</span><span class="num" id="4766270">1</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766280">if</span>&nbsp;<span class="ident" id="4766283"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span>&nbsp;<span class="op" id="4766285">==</span>&nbsp;<span class="string" id="4766288">&#34;&#34;</span>&nbsp;<span class="op" id="4766291">||</span>&nbsp;<span class="ident" id="4766294"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span><span class="op" id="4766295">[</span><span class="num" id="4766296">0</span><span class="op" id="4766297">]</span>&nbsp;<span class="op" id="4766299">!=</span>&nbsp;<span class="string" id="4766302">&#39;}&#39;</span>&nbsp;<span class="op" id="4766306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766310">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766318">}</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766321"><a href="/regexp/syntax/parse.go.html#4765862">rest</a></span>&nbsp;<span class="op" id="4766326">=</span>&nbsp;<span class="ident" id="4766328"><a href="/regexp/syntax/parse.go.html#4765837">s</a></span><span class="op" id="4766329">[</span><span class="num" id="4766330">1</span><span class="op" id="4766331">:</span><span class="op" id="4766332">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766335"><a href="/regexp/syntax/parse.go.html#4765875">ok</a></span>&nbsp;<span class="op" id="4766338">=</span>&nbsp;<span class="ident" id="4766340">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766346">return</span><br>
<span class="lineno"></span><span class="op" id="4766353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span><span class="comment" id="4766356">//&nbsp;parsePerlFlags&nbsp;parses&nbsp;a&nbsp;Perl&nbsp;flag&nbsp;setting&nbsp;or&nbsp;non-capturing&nbsp;group&nbsp;or&nbsp;both,</span><br>
<span class="lineno"></span><span class="comment" id="4766433">//&nbsp;like&nbsp;(?i)&nbsp;or&nbsp;(?:&nbsp;or&nbsp;(?i:.&nbsp;&nbsp;It&nbsp;removes&nbsp;the&nbsp;prefix&nbsp;from&nbsp;s&nbsp;and&nbsp;updates&nbsp;the&nbsp;parse&nbsp;state.</span><br>
<span class="lineno"></span><span class="comment" id="4766521">//&nbsp;The&nbsp;caller&nbsp;must&nbsp;have&nbsp;ensured&nbsp;that&nbsp;s&nbsp;begins&nbsp;with&nbsp;&#34;(?&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4766578">func</span>&nbsp;<span class="op" id="4766583">(</span><span class="ident" id="4766584">p</span>&nbsp;<span class="op" id="4766586">*</span><span class="ident" id="4766587"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4766593">)</span>&nbsp;<span class="ident" id="4766595">parsePerlFlags</span><span class="op" id="4766609">(</span><span class="ident" id="4766610">s</span>&nbsp;<span class="builtintype" id="4766612">string</span><span class="op" id="4766618">)</span>&nbsp;<span class="op" id="4766620">(</span><span class="ident" id="4766621">rest</span>&nbsp;<span class="builtintype" id="4766626">string</span><span class="op" id="4766632">,</span>&nbsp;<span class="ident" id="4766634">err</span>&nbsp;<span class="builtintype" id="4766638">error</span><span class="op" id="4766643">)</span>&nbsp;<span class="op" id="4766645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766648">t</span>&nbsp;<span class="op" id="4766650">:=</span>&nbsp;<span class="ident" id="4766653"><a href="/regexp/syntax/parse.go.html#4766610">s</a></span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4766657">//&nbsp;Check&nbsp;for&nbsp;named&nbsp;captures,&nbsp;first&nbsp;introduced&nbsp;in&nbsp;Python&#39;s&nbsp;regexp&nbsp;library.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4766732">//&nbsp;As&nbsp;usual,&nbsp;there&nbsp;are&nbsp;three&nbsp;slightly&nbsp;different&nbsp;syntaxes:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4766791">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4766795">//&nbsp;&nbsp;&nbsp;(?P&lt;name&gt;expr)&nbsp;&nbsp;&nbsp;the&nbsp;original,&nbsp;introduced&nbsp;by&nbsp;Python</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4766853">//&nbsp;&nbsp;&nbsp;(?&lt;name&gt;expr)&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;.NET&nbsp;alteration,&nbsp;adopted&nbsp;by&nbsp;Perl&nbsp;5.10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4766918">//&nbsp;&nbsp;&nbsp;(?&#39;name&#39;expr)&nbsp;&nbsp;&nbsp;&nbsp;another&nbsp;.NET&nbsp;alteration,&nbsp;adopted&nbsp;by&nbsp;Perl&nbsp;5.10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4766987">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4766991">//&nbsp;Perl&nbsp;5.10&nbsp;gave&nbsp;in&nbsp;and&nbsp;implemented&nbsp;the&nbsp;Python&nbsp;version&nbsp;too,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4767053">//&nbsp;but&nbsp;they&nbsp;claim&nbsp;that&nbsp;the&nbsp;last&nbsp;two&nbsp;are&nbsp;the&nbsp;preferred&nbsp;forms.</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4767115">//&nbsp;PCRE&nbsp;and&nbsp;languages&nbsp;based&nbsp;on&nbsp;it&nbsp;(specifically,&nbsp;PHP&nbsp;and&nbsp;Ruby)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4767179">//&nbsp;support&nbsp;all&nbsp;three&nbsp;as&nbsp;well.&nbsp;&nbsp;EcmaScript&nbsp;4&nbsp;uses&nbsp;only&nbsp;the&nbsp;Python&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4767251">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4767255">//&nbsp;In&nbsp;both&nbsp;the&nbsp;open&nbsp;source&nbsp;world&nbsp;(via&nbsp;Code&nbsp;Search)&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4767315">//&nbsp;Google&nbsp;source&nbsp;tree,&nbsp;(?P&lt;expr&gt;name)&nbsp;is&nbsp;the&nbsp;dominant&nbsp;form,</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4767376">//&nbsp;so&nbsp;that&#39;s&nbsp;the&nbsp;one&nbsp;we&nbsp;implement.&nbsp;&nbsp;One&nbsp;is&nbsp;enough.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767428">if</span>&nbsp;<span class="builtinfunc" id="4767431">len</span><span class="op" id="4767434">(</span><span class="ident" id="4767435"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4767436">)</span>&nbsp;<span class="op" id="4767438">&gt;</span>&nbsp;<span class="num" id="4767440">4</span>&nbsp;<span class="op" id="4767442">&amp;&amp;</span>&nbsp;<span class="ident" id="4767445"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4767446">[</span><span class="num" id="4767447">2</span><span class="op" id="4767448">]</span>&nbsp;<span class="op" id="4767450">==</span>&nbsp;<span class="string" id="4767453">&#39;P&#39;</span>&nbsp;<span class="op" id="4767457">&amp;&amp;</span>&nbsp;<span class="ident" id="4767460"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4767461">[</span><span class="num" id="4767462">3</span><span class="op" id="4767463">]</span>&nbsp;<span class="op" id="4767465">==</span>&nbsp;<span class="string" id="4767468">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="4767472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4767476">//&nbsp;Pull&nbsp;out&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767496">end</span>&nbsp;<span class="op" id="4767500">:=</span>&nbsp;<span class="ident" id="4767503"><a href="/regexp/syntax/parse.go.html#4742901">strings</a></span><span class="op" id="4767510">.</span><span class="ident" id="4767511">IndexRune</span><span class="op" id="4767520">(</span><span class="ident" id="4767521"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4767522">,</span>&nbsp;<span class="string" id="4767524">&#39;&gt;&#39;</span><span class="op" id="4767527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767531">if</span>&nbsp;<span class="ident" id="4767534"><a href="/regexp/syntax/parse.go.html#4767496">end</a></span>&nbsp;<span class="op" id="4767538">&lt;</span>&nbsp;<span class="num" id="4767540">0</span>&nbsp;<span class="op" id="4767542">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767547">if</span>&nbsp;<span class="ident" id="4767550"><a href="/regexp/syntax/parse.go.html#4766634">err</a></span>&nbsp;<span class="op" id="4767554">=</span>&nbsp;<span class="ident" id="4767556"><a href="/regexp/syntax/parse.go.html#4788780">checkUTF8</a></span><span class="op" id="4767565">(</span><span class="ident" id="4767566"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4767567">)</span><span class="op" id="4767568">;</span>&nbsp;<span class="ident" id="4767570"><a href="/regexp/syntax/parse.go.html#4766634">err</a></span>&nbsp;<span class="op" id="4767574">!=</span>&nbsp;<span class="ident" id="4767577">nil</span>&nbsp;<span class="op" id="4767581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767587">return</span>&nbsp;<span class="string" id="4767594">&#34;&#34;</span><span class="op" id="4767596">,</span>&nbsp;<span class="ident" id="4767598"><a href="/regexp/syntax/parse.go.html#4766634">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767610">return</span>&nbsp;<span class="string" id="4767617">&#34;&#34;</span><span class="op" id="4767619">,</span>&nbsp;<span class="op" id="4767621">&amp;</span><span class="ident" id="4767622"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4767627">{</span><span class="ident" id="4767628"><a href="/regexp/syntax/parse.go.html#4743602">ErrInvalidNamedCapture</a></span><span class="op" id="4767650">,</span>&nbsp;<span class="ident" id="4767652"><a href="/regexp/syntax/parse.go.html#4766610">s</a></span><span class="op" id="4767653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767657">}</span><br>
<span class="lineno">960</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767662">capture</span>&nbsp;<span class="op" id="4767670">:=</span>&nbsp;<span class="ident" id="4767673"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4767674">[</span><span class="op" id="4767675">:</span><span class="ident" id="4767676"><a href="/regexp/syntax/parse.go.html#4767496">end</a></span><span class="op" id="4767679">+</span><span class="num" id="4767680">1</span><span class="op" id="4767681">]</span>&nbsp;<span class="comment" id="4767683">//&nbsp;&#34;(?P&lt;name&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767700">name</span>&nbsp;<span class="op" id="4767705">:=</span>&nbsp;<span class="ident" id="4767708"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4767709">[</span><span class="num" id="4767710">4</span><span class="op" id="4767711">:</span><span class="ident" id="4767712"><a href="/regexp/syntax/parse.go.html#4767496">end</a></span><span class="op" id="4767715">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4767721">//&nbsp;&#34;name&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767733">if</span>&nbsp;<span class="ident" id="4767736"><a href="/regexp/syntax/parse.go.html#4766634">err</a></span>&nbsp;<span class="op" id="4767740">=</span>&nbsp;<span class="ident" id="4767742"><a href="/regexp/syntax/parse.go.html#4788780">checkUTF8</a></span><span class="op" id="4767751">(</span><span class="ident" id="4767752"><a href="/regexp/syntax/parse.go.html#4767700">name</a></span><span class="op" id="4767756">)</span><span class="op" id="4767757">;</span>&nbsp;<span class="ident" id="4767759"><a href="/regexp/syntax/parse.go.html#4766634">err</a></span>&nbsp;<span class="op" id="4767763">!=</span>&nbsp;<span class="ident" id="4767766">nil</span>&nbsp;<span class="op" id="4767770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767775">return</span>&nbsp;<span class="string" id="4767782">&#34;&#34;</span><span class="op" id="4767784">,</span>&nbsp;<span class="ident" id="4767786"><a href="/regexp/syntax/parse.go.html#4766634">err</a></span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767796">if</span>&nbsp;<span class="op" id="4767799">!</span><span class="ident" id="4767800"><a href="/regexp/syntax/parse.go.html#4769268">isValidCaptureName</a></span><span class="op" id="4767818">(</span><span class="ident" id="4767819"><a href="/regexp/syntax/parse.go.html#4767700">name</a></span><span class="op" id="4767823">)</span>&nbsp;<span class="op" id="4767825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767830">return</span>&nbsp;<span class="string" id="4767837">&#34;&#34;</span><span class="op" id="4767839">,</span>&nbsp;<span class="op" id="4767841">&amp;</span><span class="ident" id="4767842"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4767847">{</span><span class="ident" id="4767848"><a href="/regexp/syntax/parse.go.html#4743602">ErrInvalidNamedCapture</a></span><span class="op" id="4767870">,</span>&nbsp;<span class="ident" id="4767872"><a href="/regexp/syntax/parse.go.html#4767662">capture</a></span><span class="op" id="4767879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4767888">//&nbsp;Like&nbsp;ordinary&nbsp;capture,&nbsp;but&nbsp;named.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767927"><a href="/regexp/syntax/parse.go.html#4766584">p</a></span><span class="op" id="4767928">.</span><span class="ident" id="4767929">numCap</span><span class="op" id="4767935">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767940">re</span>&nbsp;<span class="op" id="4767943">:=</span>&nbsp;<span class="ident" id="4767946"><a href="/regexp/syntax/parse.go.html#4766584">p</a></span><span class="op" id="4767947">.</span><span class="ident" id="4767948">op</span><span class="op" id="4767950">(</span><span class="ident" id="4767951"><a href="/regexp/syntax/parse.go.html#4745432">opLeftParen</a></span><span class="op" id="4767962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767966"><a href="/regexp/syntax/parse.go.html#4767940">re</a></span><span class="op" id="4767968">.</span><span class="ident" id="4767969">Cap</span>&nbsp;<span class="op" id="4767973">=</span>&nbsp;<span class="ident" id="4767975"><a href="/regexp/syntax/parse.go.html#4766584">p</a></span><span class="op" id="4767976">.</span><span class="ident" id="4767977">numCap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767986"><a href="/regexp/syntax/parse.go.html#4767940">re</a></span><span class="op" id="4767988">.</span><span class="ident" id="4767989">Name</span>&nbsp;<span class="op" id="4767994">=</span>&nbsp;<span class="ident" id="4767996"><a href="/regexp/syntax/parse.go.html#4767700">name</a></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768003">return</span>&nbsp;<span class="ident" id="4768010"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4768011">[</span><span class="ident" id="4768012"><a href="/regexp/syntax/parse.go.html#4767496">end</a></span><span class="op" id="4768015">+</span><span class="num" id="4768016">1</span><span class="op" id="4768017">:</span><span class="op" id="4768018">]</span><span class="op" id="4768019">,</span>&nbsp;<span class="ident" id="4768021">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4768030">//&nbsp;Non-capturing&nbsp;group.&nbsp;&nbsp;Might&nbsp;also&nbsp;twiddle&nbsp;Perl&nbsp;flags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768087">var</span>&nbsp;<span class="ident" id="4768091">c</span>&nbsp;<span class="builtintype" id="4768093">rune</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768099"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span>&nbsp;<span class="op" id="4768101">=</span>&nbsp;<span class="ident" id="4768103"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4768104">[</span><span class="num" id="4768105">2</span><span class="op" id="4768106">:</span><span class="op" id="4768107">]</span>&nbsp;<span class="comment" id="4768109">//&nbsp;skip&nbsp;(?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768121">flags</span>&nbsp;<span class="op" id="4768127">:=</span>&nbsp;<span class="ident" id="4768130"><a href="/regexp/syntax/parse.go.html#4766584">p</a></span><span class="op" id="4768131">.</span><span class="ident" id="4768132">flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768139">sign</span>&nbsp;<span class="op" id="4768144">:=</span>&nbsp;<span class="op" id="4768147">+</span><span class="num" id="4768148">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768151">sawFlag</span>&nbsp;<span class="op" id="4768159">:=</span>&nbsp;<span class="ident" id="4768162">false</span><br>
<span class="lineno"></span><span class="ident" id="4768168">Loop</span><span class="op" id="4768172">:</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768175">for</span>&nbsp;<span class="ident" id="4768179"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span>&nbsp;<span class="op" id="4768181">!=</span>&nbsp;<span class="string" id="4768184">&#34;&#34;</span>&nbsp;<span class="op" id="4768187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768191">if</span>&nbsp;<span class="ident" id="4768194"><a href="/regexp/syntax/parse.go.html#4768091">c</a></span><span class="op" id="4768195">,</span>&nbsp;<span class="ident" id="4768197"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4768198">,</span>&nbsp;<span class="ident" id="4768200"><a href="/regexp/syntax/parse.go.html#4766634">err</a></span>&nbsp;<span class="op" id="4768204">=</span>&nbsp;<span class="ident" id="4768206"><a href="/regexp/syntax/parse.go.html#4788999">nextRune</a></span><span class="op" id="4768214">(</span><span class="ident" id="4768215"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4768216">)</span><span class="op" id="4768217">;</span>&nbsp;<span class="ident" id="4768219"><a href="/regexp/syntax/parse.go.html#4766634">err</a></span>&nbsp;<span class="op" id="4768223">!=</span>&nbsp;<span class="ident" id="4768226">nil</span>&nbsp;<span class="op" id="4768230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768235">return</span>&nbsp;<span class="string" id="4768242">&#34;&#34;</span><span class="op" id="4768244">,</span>&nbsp;<span class="ident" id="4768246"><a href="/regexp/syntax/parse.go.html#4766634">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768256">switch</span>&nbsp;<span class="ident" id="4768263"><a href="/regexp/syntax/parse.go.html#4768091">c</a></span>&nbsp;<span class="op" id="4768265">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768269">default</span><span class="op" id="4768276">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768281">break</span>&nbsp;<span class="ident" id="4768287">Loop</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4768295">//&nbsp;Flags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768307">case</span>&nbsp;<span class="string" id="4768312">&#39;i&#39;</span><span class="op" id="4768315">:</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768320"><a href="/regexp/syntax/parse.go.html#4768121">flags</a></span>&nbsp;<span class="op" id="4768326">|=</span>&nbsp;<span class="ident" id="4768329"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768341"><a href="/regexp/syntax/parse.go.html#4768151">sawFlag</a></span>&nbsp;<span class="op" id="4768349">=</span>&nbsp;<span class="ident" id="4768351">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768358">case</span>&nbsp;<span class="string" id="4768363">&#39;m&#39;</span><span class="op" id="4768366">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768371"><a href="/regexp/syntax/parse.go.html#4768121">flags</a></span>&nbsp;<span class="op" id="4768377">&amp;^=</span>&nbsp;<span class="ident" id="4768381"><a href="/regexp/syntax/parse.go.html#4744728">OneLine</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768392"><a href="/regexp/syntax/parse.go.html#4768151">sawFlag</a></span>&nbsp;<span class="op" id="4768400">=</span>&nbsp;<span class="ident" id="4768402">true</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768409">case</span>&nbsp;<span class="string" id="4768414">&#39;s&#39;</span><span class="op" id="4768417">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768422"><a href="/regexp/syntax/parse.go.html#4768121">flags</a></span>&nbsp;<span class="op" id="4768428">|=</span>&nbsp;<span class="ident" id="4768431"><a href="/regexp/syntax/parse.go.html#4744667">DotNL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768440"><a href="/regexp/syntax/parse.go.html#4768151">sawFlag</a></span>&nbsp;<span class="op" id="4768448">=</span>&nbsp;<span class="ident" id="4768450">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768457">case</span>&nbsp;<span class="string" id="4768462">&#39;U&#39;</span><span class="op" id="4768465">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768470"><a href="/regexp/syntax/parse.go.html#4768121">flags</a></span>&nbsp;<span class="op" id="4768476">|=</span>&nbsp;<span class="ident" id="4768479"><a href="/regexp/syntax/parse.go.html#4744824">NonGreedy</a></span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768492"><a href="/regexp/syntax/parse.go.html#4768151">sawFlag</a></span>&nbsp;<span class="op" id="4768500">=</span>&nbsp;<span class="ident" id="4768502">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4768510">//&nbsp;Switch&nbsp;to&nbsp;negation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768535">case</span>&nbsp;<span class="string" id="4768540">&#39;-&#39;</span><span class="op" id="4768543">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768548">if</span>&nbsp;<span class="ident" id="4768551"><a href="/regexp/syntax/parse.go.html#4768139">sign</a></span>&nbsp;<span class="op" id="4768556">&lt;</span>&nbsp;<span class="num" id="4768558">0</span>&nbsp;<span class="op" id="4768560">{</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768566">break</span>&nbsp;<span class="ident" id="4768572">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768585"><a href="/regexp/syntax/parse.go.html#4768139">sign</a></span>&nbsp;<span class="op" id="4768590">=</span>&nbsp;<span class="op" id="4768592">-</span><span class="num" id="4768593">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4768598">//&nbsp;Invert&nbsp;flags&nbsp;so&nbsp;that&nbsp;|&nbsp;above&nbsp;turn&nbsp;into&nbsp;&amp;^&nbsp;and&nbsp;vice&nbsp;versa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4768662">//&nbsp;We&#39;ll&nbsp;invert&nbsp;flags&nbsp;again&nbsp;before&nbsp;using&nbsp;it&nbsp;below.</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768716"><a href="/regexp/syntax/parse.go.html#4768121">flags</a></span>&nbsp;<span class="op" id="4768722">=</span>&nbsp;<span class="op" id="4768724">^</span><span class="ident" id="4768725"><a href="/regexp/syntax/parse.go.html#4768121">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768734"><a href="/regexp/syntax/parse.go.html#4768151">sawFlag</a></span>&nbsp;<span class="op" id="4768742">=</span>&nbsp;<span class="ident" id="4768744">false</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4768753">//&nbsp;End&nbsp;of&nbsp;flags,&nbsp;starting&nbsp;group&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768795">case</span>&nbsp;<span class="string" id="4768800">&#39;:&#39;</span><span class="op" id="4768803">,</span>&nbsp;<span class="string" id="4768805">&#39;)&#39;</span><span class="op" id="4768808">:</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768813">if</span>&nbsp;<span class="ident" id="4768816"><a href="/regexp/syntax/parse.go.html#4768139">sign</a></span>&nbsp;<span class="op" id="4768821">&lt;</span>&nbsp;<span class="num" id="4768823">0</span>&nbsp;<span class="op" id="4768825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768831">if</span>&nbsp;<span class="op" id="4768834">!</span><span class="ident" id="4768835"><a href="/regexp/syntax/parse.go.html#4768151">sawFlag</a></span>&nbsp;<span class="op" id="4768843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768850">break</span>&nbsp;<span class="ident" id="4768856">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768871"><a href="/regexp/syntax/parse.go.html#4768121">flags</a></span>&nbsp;<span class="op" id="4768877">=</span>&nbsp;<span class="op" id="4768879">^</span><span class="ident" id="4768880"><a href="/regexp/syntax/parse.go.html#4768121">flags</a></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768894">if</span>&nbsp;<span class="ident" id="4768897"><a href="/regexp/syntax/parse.go.html#4768091">c</a></span>&nbsp;<span class="op" id="4768899">==</span>&nbsp;<span class="string" id="4768902">&#39;:&#39;</span>&nbsp;<span class="op" id="4768906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4768912">//&nbsp;Open&nbsp;new&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768934"><a href="/regexp/syntax/parse.go.html#4766584">p</a></span><span class="op" id="4768935">.</span><span class="ident" id="4768936">op</span><span class="op" id="4768938">(</span><span class="ident" id="4768939"><a href="/regexp/syntax/parse.go.html#4745432">opLeftParen</a></span><span class="op" id="4768950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768955">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768960"><a href="/regexp/syntax/parse.go.html#4766584">p</a></span><span class="op" id="4768961">.</span><span class="ident" id="4768962">flags</span>&nbsp;<span class="op" id="4768968">=</span>&nbsp;<span class="ident" id="4768970"><a href="/regexp/syntax/parse.go.html#4768121">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768979">return</span>&nbsp;<span class="ident" id="4768986"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4768987">,</span>&nbsp;<span class="ident" id="4768989">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769002">return</span>&nbsp;<span class="string" id="4769009">&#34;&#34;</span><span class="op" id="4769011">,</span>&nbsp;<span class="op" id="4769013">&amp;</span><span class="ident" id="4769014"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4769019">{</span><span class="ident" id="4769020"><a href="/regexp/syntax/parse.go.html#4743664">ErrInvalidPerlOp</a></span><span class="op" id="4769036">,</span>&nbsp;<span class="ident" id="4769038"><a href="/regexp/syntax/parse.go.html#4766610">s</a></span><span class="op" id="4769039">[</span><span class="op" id="4769040">:</span><span class="builtinfunc" id="4769041">len</span><span class="op" id="4769044">(</span><span class="ident" id="4769045"><a href="/regexp/syntax/parse.go.html#4766610">s</a></span><span class="op" id="4769046">)</span><span class="op" id="4769047">-</span><span class="builtinfunc" id="4769048">len</span><span class="op" id="4769051">(</span><span class="ident" id="4769052"><a href="/regexp/syntax/parse.go.html#4766648">t</a></span><span class="op" id="4769053">)</span><span class="op" id="4769054">]</span><span class="op" id="4769055">}</span><br>
<span class="lineno"></span><span class="op" id="4769057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4769060">//&nbsp;isValidCaptureName&nbsp;reports&nbsp;whether&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="4769103">//&nbsp;is&nbsp;a&nbsp;valid&nbsp;capture&nbsp;name:&nbsp;[A-Za-z0-9_]+.</span><br>
<span class="lineno">1040</span><span class="comment" id="4769146">//&nbsp;PCRE&nbsp;limits&nbsp;names&nbsp;to&nbsp;32&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="4769180">//&nbsp;Python&nbsp;rejects&nbsp;names&nbsp;starting&nbsp;with&nbsp;digits.</span><br>
<span class="lineno"></span><span class="comment" id="4769226">//&nbsp;We&nbsp;don&#39;t&nbsp;enforce&nbsp;either&nbsp;of&nbsp;those.</span><br>
<span class="lineno"></span><span class="keyword" id="4769263">func</span>&nbsp;<span class="ident" id="4769268">isValidCaptureName</span><span class="op" id="4769286">(</span><span class="ident" id="4769287">name</span>&nbsp;<span class="builtintype" id="4769292">string</span><span class="op" id="4769298">)</span>&nbsp;<span class="builtintype" id="4769300">bool</span>&nbsp;<span class="op" id="4769305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769308">if</span>&nbsp;<span class="ident" id="4769311"><a href="/regexp/syntax/parse.go.html#4769287">name</a></span>&nbsp;<span class="op" id="4769316">==</span>&nbsp;<span class="string" id="4769319">&#34;&#34;</span>&nbsp;<span class="op" id="4769322">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769326">return</span>&nbsp;<span class="ident" id="4769333">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769343">for</span>&nbsp;<span class="ident" id="4769347">_</span><span class="op" id="4769348">,</span>&nbsp;<span class="ident" id="4769350">c</span>&nbsp;<span class="op" id="4769352">:=</span>&nbsp;<span class="keyword" id="4769355">range</span>&nbsp;<span class="ident" id="4769361"><a href="/regexp/syntax/parse.go.html#4769287">name</a></span>&nbsp;<span class="op" id="4769366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769370">if</span>&nbsp;<span class="ident" id="4769373"><a href="/regexp/syntax/parse.go.html#4769350">c</a></span>&nbsp;<span class="op" id="4769375">!=</span>&nbsp;<span class="string" id="4769378">&#39;_&#39;</span>&nbsp;<span class="op" id="4769382">&amp;&amp;</span>&nbsp;<span class="op" id="4769385">!</span><span class="ident" id="4769386"><a href="/regexp/syntax/parse.go.html#4789218">isalnum</a></span><span class="op" id="4769393">(</span><span class="ident" id="4769394"><a href="/regexp/syntax/parse.go.html#4769350">c</a></span><span class="op" id="4769395">)</span>&nbsp;<span class="op" id="4769397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769402">return</span>&nbsp;<span class="ident" id="4769409">false</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769423">return</span>&nbsp;<span class="ident" id="4769430">true</span><br>
<span class="lineno"></span><span class="op" id="4769435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1055</span><span class="comment" id="4769438">//&nbsp;parseInt&nbsp;parses&nbsp;a&nbsp;decimal&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="4769476">func</span>&nbsp;<span class="op" id="4769481">(</span><span class="ident" id="4769482">p</span>&nbsp;<span class="op" id="4769484">*</span><span class="ident" id="4769485"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4769491">)</span>&nbsp;<span class="ident" id="4769493">parseInt</span><span class="op" id="4769501">(</span><span class="ident" id="4769502">s</span>&nbsp;<span class="builtintype" id="4769504">string</span><span class="op" id="4769510">)</span>&nbsp;<span class="op" id="4769512">(</span><span class="ident" id="4769513">n</span>&nbsp;<span class="builtintype" id="4769515">int</span><span class="op" id="4769518">,</span>&nbsp;<span class="ident" id="4769520">rest</span>&nbsp;<span class="builtintype" id="4769525">string</span><span class="op" id="4769531">,</span>&nbsp;<span class="ident" id="4769533">ok</span>&nbsp;<span class="builtintype" id="4769536">bool</span><span class="op" id="4769540">)</span>&nbsp;<span class="op" id="4769542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769545">if</span>&nbsp;<span class="ident" id="4769548"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span>&nbsp;<span class="op" id="4769550">==</span>&nbsp;<span class="string" id="4769553">&#34;&#34;</span>&nbsp;<span class="op" id="4769556">||</span>&nbsp;<span class="ident" id="4769559"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span><span class="op" id="4769560">[</span><span class="num" id="4769561">0</span><span class="op" id="4769562">]</span>&nbsp;<span class="op" id="4769564">&lt;</span>&nbsp;<span class="string" id="4769566">&#39;0&#39;</span>&nbsp;<span class="op" id="4769570">||</span>&nbsp;<span class="string" id="4769573">&#39;9&#39;</span>&nbsp;<span class="op" id="4769577">&lt;</span>&nbsp;<span class="ident" id="4769579"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span><span class="op" id="4769580">[</span><span class="num" id="4769581">0</span><span class="op" id="4769582">]</span>&nbsp;<span class="op" id="4769584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769588">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769596">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4769599">//&nbsp;Disallow&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769627">if</span>&nbsp;<span class="builtinfunc" id="4769630">len</span><span class="op" id="4769633">(</span><span class="ident" id="4769634"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span><span class="op" id="4769635">)</span>&nbsp;<span class="op" id="4769637">&gt;=</span>&nbsp;<span class="num" id="4769640">2</span>&nbsp;<span class="op" id="4769642">&amp;&amp;</span>&nbsp;<span class="ident" id="4769645"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span><span class="op" id="4769646">[</span><span class="num" id="4769647">0</span><span class="op" id="4769648">]</span>&nbsp;<span class="op" id="4769650">==</span>&nbsp;<span class="string" id="4769653">&#39;0&#39;</span>&nbsp;<span class="op" id="4769657">&amp;&amp;</span>&nbsp;<span class="string" id="4769660">&#39;0&#39;</span>&nbsp;<span class="op" id="4769664">&lt;=</span>&nbsp;<span class="ident" id="4769667"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span><span class="op" id="4769668">[</span><span class="num" id="4769669">1</span><span class="op" id="4769670">]</span>&nbsp;<span class="op" id="4769672">&amp;&amp;</span>&nbsp;<span class="ident" id="4769675"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span><span class="op" id="4769676">[</span><span class="num" id="4769677">1</span><span class="op" id="4769678">]</span>&nbsp;<span class="op" id="4769680">&lt;=</span>&nbsp;<span class="string" id="4769683">&#39;9&#39;</span>&nbsp;<span class="op" id="4769687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769691">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769702">t</span>&nbsp;<span class="op" id="4769704">:=</span>&nbsp;<span class="ident" id="4769707"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769710">for</span>&nbsp;<span class="ident" id="4769714"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span>&nbsp;<span class="op" id="4769716">!=</span>&nbsp;<span class="string" id="4769719">&#34;&#34;</span>&nbsp;<span class="op" id="4769722">&amp;&amp;</span>&nbsp;<span class="string" id="4769725">&#39;0&#39;</span>&nbsp;<span class="op" id="4769729">&lt;=</span>&nbsp;<span class="ident" id="4769732"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span><span class="op" id="4769733">[</span><span class="num" id="4769734">0</span><span class="op" id="4769735">]</span>&nbsp;<span class="op" id="4769737">&amp;&amp;</span>&nbsp;<span class="ident" id="4769740"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span><span class="op" id="4769741">[</span><span class="num" id="4769742">0</span><span class="op" id="4769743">]</span>&nbsp;<span class="op" id="4769745">&lt;=</span>&nbsp;<span class="string" id="4769748">&#39;9&#39;</span>&nbsp;<span class="op" id="4769752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769756"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span>&nbsp;<span class="op" id="4769758">=</span>&nbsp;<span class="ident" id="4769760"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span><span class="op" id="4769761">[</span><span class="num" id="4769762">1</span><span class="op" id="4769763">:</span><span class="op" id="4769764">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769770"><a href="/regexp/syntax/parse.go.html#4769520">rest</a></span>&nbsp;<span class="op" id="4769775">=</span>&nbsp;<span class="ident" id="4769777"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769780"><a href="/regexp/syntax/parse.go.html#4769533">ok</a></span>&nbsp;<span class="op" id="4769783">=</span>&nbsp;<span class="ident" id="4769785">true</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4769791">//&nbsp;Have&nbsp;digits,&nbsp;compute&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769823"><a href="/regexp/syntax/parse.go.html#4769702">t</a></span>&nbsp;<span class="op" id="4769825">=</span>&nbsp;<span class="ident" id="4769827"><a href="/regexp/syntax/parse.go.html#4769702">t</a></span><span class="op" id="4769828">[</span><span class="op" id="4769829">:</span><span class="builtinfunc" id="4769830">len</span><span class="op" id="4769833">(</span><span class="ident" id="4769834"><a href="/regexp/syntax/parse.go.html#4769702">t</a></span><span class="op" id="4769835">)</span><span class="op" id="4769836">-</span><span class="builtinfunc" id="4769837">len</span><span class="op" id="4769840">(</span><span class="ident" id="4769841"><a href="/regexp/syntax/parse.go.html#4769502">s</a></span><span class="op" id="4769842">)</span><span class="op" id="4769843">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769846">for</span>&nbsp;<span class="ident" id="4769850">i</span>&nbsp;<span class="op" id="4769852">:=</span>&nbsp;<span class="num" id="4769855">0</span><span class="op" id="4769856">;</span>&nbsp;<span class="ident" id="4769858"><a href="/regexp/syntax/parse.go.html#4769850">i</a></span>&nbsp;<span class="op" id="4769860">&lt;</span>&nbsp;<span class="builtinfunc" id="4769862">len</span><span class="op" id="4769865">(</span><span class="ident" id="4769866"><a href="/regexp/syntax/parse.go.html#4769702">t</a></span><span class="op" id="4769867">)</span><span class="op" id="4769868">;</span>&nbsp;<span class="ident" id="4769870"><a href="/regexp/syntax/parse.go.html#4769850">i</a></span><span class="op" id="4769871">++</span>&nbsp;<span class="op" id="4769874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4769878">//&nbsp;Avoid&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769899">if</span>&nbsp;<span class="ident" id="4769902"><a href="/regexp/syntax/parse.go.html#4769513">n</a></span>&nbsp;<span class="op" id="4769904">&gt;=</span>&nbsp;<span class="num" id="4769907">1e8</span>&nbsp;<span class="op" id="4769911">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769916"><a href="/regexp/syntax/parse.go.html#4769513">n</a></span>&nbsp;<span class="op" id="4769918">=</span>&nbsp;<span class="op" id="4769920">-</span><span class="num" id="4769921">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769926">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769938"><a href="/regexp/syntax/parse.go.html#4769513">n</a></span>&nbsp;<span class="op" id="4769940">=</span>&nbsp;<span class="ident" id="4769942"><a href="/regexp/syntax/parse.go.html#4769513">n</a></span><span class="op" id="4769943">*</span><span class="num" id="4769944">10</span>&nbsp;<span class="op" id="4769947">+</span>&nbsp;<span class="builtintype" id="4769949">int</span><span class="op" id="4769952">(</span><span class="ident" id="4769953"><a href="/regexp/syntax/parse.go.html#4769702">t</a></span><span class="op" id="4769954">[</span><span class="ident" id="4769955"><a href="/regexp/syntax/parse.go.html#4769850">i</a></span><span class="op" id="4769956">]</span><span class="op" id="4769957">)</span>&nbsp;<span class="op" id="4769959">-</span>&nbsp;<span class="string" id="4769961">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769966">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769969">return</span><br>
<span class="lineno"></span><span class="op" id="4769976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4769979">//&nbsp;can&nbsp;this&nbsp;be&nbsp;represented&nbsp;as&nbsp;a&nbsp;character&nbsp;class?</span><br>
<span class="lineno"></span><span class="comment" id="4770028">//&nbsp;single-rune&nbsp;literal&nbsp;string,&nbsp;char&nbsp;class,&nbsp;.,&nbsp;and&nbsp;.|\n.</span><br>
<span class="lineno">1085</span><span class="keyword" id="4770084">func</span>&nbsp;<span class="ident" id="4770089">isCharClass</span><span class="op" id="4770100">(</span><span class="ident" id="4770101">re</span>&nbsp;<span class="op" id="4770104">*</span><span class="ident" id="4770105"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4770111">)</span>&nbsp;<span class="builtintype" id="4770113">bool</span>&nbsp;<span class="op" id="4770118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770121">return</span>&nbsp;<span class="ident" id="4770128"><a href="/regexp/syntax/parse.go.html#4770101">re</a></span><span class="op" id="4770130">.</span><span class="ident" id="4770131">Op</span>&nbsp;<span class="op" id="4770134">==</span>&nbsp;<span class="ident" id="4770137"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span>&nbsp;<span class="op" id="4770147">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4770150">len</span><span class="op" id="4770153">(</span><span class="ident" id="4770154"><a href="/regexp/syntax/parse.go.html#4770101">re</a></span><span class="op" id="4770156">.</span><span class="ident" id="4770157">Rune</span><span class="op" id="4770161">)</span>&nbsp;<span class="op" id="4770163">==</span>&nbsp;<span class="num" id="4770166">1</span>&nbsp;<span class="op" id="4770168">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770173"><a href="/regexp/syntax/parse.go.html#4770101">re</a></span><span class="op" id="4770175">.</span><span class="ident" id="4770176">Op</span>&nbsp;<span class="op" id="4770179">==</span>&nbsp;<span class="ident" id="4770182"><a href="/regexp/syntax/regexp.go.html#4800993">OpCharClass</a></span>&nbsp;<span class="op" id="4770194">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770199"><a href="/regexp/syntax/parse.go.html#4770101">re</a></span><span class="op" id="4770201">.</span><span class="ident" id="4770202">Op</span>&nbsp;<span class="op" id="4770205">==</span>&nbsp;<span class="ident" id="4770208"><a href="/regexp/syntax/regexp.go.html#4801073">OpAnyCharNotNL</a></span>&nbsp;<span class="op" id="4770223">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770228"><a href="/regexp/syntax/parse.go.html#4770101">re</a></span><span class="op" id="4770230">.</span><span class="ident" id="4770231">Op</span>&nbsp;<span class="op" id="4770234">==</span>&nbsp;<span class="ident" id="4770237"><a href="/regexp/syntax/regexp.go.html#4801145">OpAnyChar</a></span><br>
<span class="lineno">1090</span><span class="op" id="4770247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4770250">//&nbsp;does&nbsp;re&nbsp;match&nbsp;r?</span><br>
<span class="lineno"></span><span class="keyword" id="4770270">func</span>&nbsp;<span class="ident" id="4770275">matchRune</span><span class="op" id="4770284">(</span><span class="ident" id="4770285">re</span>&nbsp;<span class="op" id="4770288">*</span><span class="ident" id="4770289"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4770295">,</span>&nbsp;<span class="ident" id="4770297">r</span>&nbsp;<span class="builtintype" id="4770299">rune</span><span class="op" id="4770303">)</span>&nbsp;<span class="builtintype" id="4770305">bool</span>&nbsp;<span class="op" id="4770310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770313">switch</span>&nbsp;<span class="ident" id="4770320"><a href="/regexp/syntax/parse.go.html#4770285">re</a></span><span class="op" id="4770322">.</span><span class="ident" id="4770323">Op</span>&nbsp;<span class="op" id="4770326">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770329">case</span>&nbsp;<span class="ident" id="4770334"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span><span class="op" id="4770343">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770347">return</span>&nbsp;<span class="builtinfunc" id="4770354">len</span><span class="op" id="4770357">(</span><span class="ident" id="4770358"><a href="/regexp/syntax/parse.go.html#4770285">re</a></span><span class="op" id="4770360">.</span><span class="ident" id="4770361">Rune</span><span class="op" id="4770365">)</span>&nbsp;<span class="op" id="4770367">==</span>&nbsp;<span class="num" id="4770370">1</span>&nbsp;<span class="op" id="4770372">&amp;&amp;</span>&nbsp;<span class="ident" id="4770375"><a href="/regexp/syntax/parse.go.html#4770285">re</a></span><span class="op" id="4770377">.</span><span class="ident" id="4770378">Rune</span><span class="op" id="4770382">[</span><span class="num" id="4770383">0</span><span class="op" id="4770384">]</span>&nbsp;<span class="op" id="4770386">==</span>&nbsp;<span class="ident" id="4770389"><a href="/regexp/syntax/parse.go.html#4770297">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770392">case</span>&nbsp;<span class="ident" id="4770397"><a href="/regexp/syntax/regexp.go.html#4800993">OpCharClass</a></span><span class="op" id="4770408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770412">for</span>&nbsp;<span class="ident" id="4770416">i</span>&nbsp;<span class="op" id="4770418">:=</span>&nbsp;<span class="num" id="4770421">0</span><span class="op" id="4770422">;</span>&nbsp;<span class="ident" id="4770424"><a href="/regexp/syntax/parse.go.html#4770416">i</a></span>&nbsp;<span class="op" id="4770426">&lt;</span>&nbsp;<span class="builtinfunc" id="4770428">len</span><span class="op" id="4770431">(</span><span class="ident" id="4770432"><a href="/regexp/syntax/parse.go.html#4770285">re</a></span><span class="op" id="4770434">.</span><span class="ident" id="4770435">Rune</span><span class="op" id="4770439">)</span><span class="op" id="4770440">;</span>&nbsp;<span class="ident" id="4770442"><a href="/regexp/syntax/parse.go.html#4770416">i</a></span>&nbsp;<span class="op" id="4770444">+=</span>&nbsp;<span class="num" id="4770447">2</span>&nbsp;<span class="op" id="4770449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770454">if</span>&nbsp;<span class="ident" id="4770457"><a href="/regexp/syntax/parse.go.html#4770285">re</a></span><span class="op" id="4770459">.</span><span class="ident" id="4770460">Rune</span><span class="op" id="4770464">[</span><span class="ident" id="4770465"><a href="/regexp/syntax/parse.go.html#4770416">i</a></span><span class="op" id="4770466">]</span>&nbsp;<span class="op" id="4770468">&lt;=</span>&nbsp;<span class="ident" id="4770471"><a href="/regexp/syntax/parse.go.html#4770297">r</a></span>&nbsp;<span class="op" id="4770473">&amp;&amp;</span>&nbsp;<span class="ident" id="4770476"><a href="/regexp/syntax/parse.go.html#4770297">r</a></span>&nbsp;<span class="op" id="4770478">&lt;=</span>&nbsp;<span class="ident" id="4770481"><a href="/regexp/syntax/parse.go.html#4770285">re</a></span><span class="op" id="4770483">.</span><span class="ident" id="4770484">Rune</span><span class="op" id="4770488">[</span><span class="ident" id="4770489"><a href="/regexp/syntax/parse.go.html#4770416">i</a></span><span class="op" id="4770490">+</span><span class="num" id="4770491">1</span><span class="op" id="4770492">]</span>&nbsp;<span class="op" id="4770494">{</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770500">return</span>&nbsp;<span class="ident" id="4770507">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4770515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4770519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770523">return</span>&nbsp;<span class="ident" id="4770530">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770537">case</span>&nbsp;<span class="ident" id="4770542"><a href="/regexp/syntax/regexp.go.html#4801073">OpAnyCharNotNL</a></span><span class="op" id="4770556">:</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770560">return</span>&nbsp;<span class="ident" id="4770567"><a href="/regexp/syntax/parse.go.html#4770297">r</a></span>&nbsp;<span class="op" id="4770569">!=</span>&nbsp;<span class="string" id="4770572">&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770578">case</span>&nbsp;<span class="ident" id="4770583"><a href="/regexp/syntax/regexp.go.html#4801145">OpAnyChar</a></span><span class="op" id="4770592">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770596">return</span>&nbsp;<span class="ident" id="4770603">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4770609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770612">return</span>&nbsp;<span class="ident" id="4770619">false</span><br>
<span class="lineno">1110</span><span class="op" id="4770625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4770628">//&nbsp;parseVerticalBar&nbsp;handles&nbsp;a&nbsp;|&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="4770674">func</span>&nbsp;<span class="op" id="4770679">(</span><span class="ident" id="4770680">p</span>&nbsp;<span class="op" id="4770682">*</span><span class="ident" id="4770683"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4770689">)</span>&nbsp;<span class="ident" id="4770691">parseVerticalBar</span><span class="op" id="4770707">(</span><span class="op" id="4770708">)</span>&nbsp;<span class="builtintype" id="4770710">error</span>&nbsp;<span class="op" id="4770716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770719"><a href="/regexp/syntax/parse.go.html#4770680">p</a></span><span class="op" id="4770720">.</span><span class="ident" id="4770721">concat</span><span class="op" id="4770727">(</span><span class="op" id="4770728">)</span><br>
<span class="lineno">1115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4770732">//&nbsp;The&nbsp;concatenation&nbsp;we&nbsp;just&nbsp;parsed&nbsp;is&nbsp;on&nbsp;top&nbsp;of&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4770793">//&nbsp;If&nbsp;it&nbsp;sits&nbsp;above&nbsp;an&nbsp;opVerticalBar,&nbsp;swap&nbsp;it&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4770846">//&nbsp;(things&nbsp;below&nbsp;an&nbsp;opVerticalBar&nbsp;become&nbsp;an&nbsp;alternation).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4770905">//&nbsp;Otherwise,&nbsp;push&nbsp;a&nbsp;new&nbsp;vertical&nbsp;bar.</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770945">if</span>&nbsp;<span class="op" id="4770948">!</span><span class="ident" id="4770949"><a href="/regexp/syntax/parse.go.html#4770680">p</a></span><span class="op" id="4770950">.</span><span class="ident" id="4770951">swapVerticalBar</span><span class="op" id="4770966">(</span><span class="op" id="4770967">)</span>&nbsp;<span class="op" id="4770969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770973"><a href="/regexp/syntax/parse.go.html#4770680">p</a></span><span class="op" id="4770974">.</span><span class="ident" id="4770975">op</span><span class="op" id="4770977">(</span><span class="ident" id="4770978"><a href="/regexp/syntax/parse.go.html#4745463">opVerticalBar</a></span><span class="op" id="4770991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4770994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770998">return</span>&nbsp;<span class="ident" id="4771005">nil</span><br>
<span class="lineno">1125</span><span class="op" id="4771009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4771012">//&nbsp;mergeCharClass&nbsp;makes&nbsp;dst&nbsp;=&nbsp;dst|src.</span><br>
<span class="lineno"></span><span class="comment" id="4771051">//&nbsp;The&nbsp;caller&nbsp;must&nbsp;ensure&nbsp;that&nbsp;dst.Op&nbsp;&gt;=&nbsp;src.Op,</span><br>
<span class="lineno"></span><span class="comment" id="4771100">//&nbsp;to&nbsp;reduce&nbsp;the&nbsp;amount&nbsp;of&nbsp;copying.</span><br>
<span class="lineno">1130</span><span class="keyword" id="4771136">func</span>&nbsp;<span class="ident" id="4771141">mergeCharClass</span><span class="op" id="4771155">(</span><span class="ident" id="4771156">dst</span><span class="op" id="4771159">,</span>&nbsp;<span class="ident" id="4771161">src</span>&nbsp;<span class="op" id="4771165">*</span><span class="ident" id="4771166"><a href="/regexp/syntax/regexp.go.html#4800134">Regexp</a></span><span class="op" id="4771172">)</span>&nbsp;<span class="op" id="4771174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771177">switch</span>&nbsp;<span class="ident" id="4771184"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771187">.</span><span class="ident" id="4771188">Op</span>&nbsp;<span class="op" id="4771191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771194">case</span>&nbsp;<span class="ident" id="4771199"><a href="/regexp/syntax/regexp.go.html#4801145">OpAnyChar</a></span><span class="op" id="4771208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4771212">//&nbsp;src&nbsp;doesn&#39;t&nbsp;add&nbsp;anything.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771242">case</span>&nbsp;<span class="ident" id="4771247"><a href="/regexp/syntax/regexp.go.html#4801073">OpAnyCharNotNL</a></span><span class="op" id="4771261">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4771265">//&nbsp;src&nbsp;might&nbsp;add&nbsp;\n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771287">if</span>&nbsp;<span class="ident" id="4771290"><a href="/regexp/syntax/parse.go.html#4770275">matchRune</a></span><span class="op" id="4771299">(</span><span class="ident" id="4771300"><a href="/regexp/syntax/parse.go.html#4771161">src</a></span><span class="op" id="4771303">,</span>&nbsp;<span class="string" id="4771305">&#39;\n&#39;</span><span class="op" id="4771309">)</span>&nbsp;<span class="op" id="4771311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771316"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771319">.</span><span class="ident" id="4771320">Op</span>&nbsp;<span class="op" id="4771323">=</span>&nbsp;<span class="ident" id="4771325"><a href="/regexp/syntax/regexp.go.html#4801145">OpAnyChar</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4771337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771340">case</span>&nbsp;<span class="ident" id="4771345"><a href="/regexp/syntax/regexp.go.html#4800993">OpCharClass</a></span><span class="op" id="4771356">:</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4771360">//&nbsp;src&nbsp;is&nbsp;simpler,&nbsp;so&nbsp;either&nbsp;literal&nbsp;or&nbsp;char&nbsp;class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771413">if</span>&nbsp;<span class="ident" id="4771416"><a href="/regexp/syntax/parse.go.html#4771161">src</a></span><span class="op" id="4771419">.</span><span class="ident" id="4771420">Op</span>&nbsp;<span class="op" id="4771423">==</span>&nbsp;<span class="ident" id="4771426"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span>&nbsp;<span class="op" id="4771436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771441"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771444">.</span><span class="ident" id="4771445">Rune</span>&nbsp;<span class="op" id="4771450">=</span>&nbsp;<span class="ident" id="4771452"><a href="/regexp/syntax/parse.go.html#4783410">appendLiteral</a></span><span class="op" id="4771465">(</span><span class="ident" id="4771466"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771469">.</span><span class="ident" id="4771470">Rune</span><span class="op" id="4771474">,</span>&nbsp;<span class="ident" id="4771476"><a href="/regexp/syntax/parse.go.html#4771161">src</a></span><span class="op" id="4771479">.</span><span class="ident" id="4771480">Rune</span><span class="op" id="4771484">[</span><span class="num" id="4771485">0</span><span class="op" id="4771486">]</span><span class="op" id="4771487">,</span>&nbsp;<span class="ident" id="4771489"><a href="/regexp/syntax/parse.go.html#4771161">src</a></span><span class="op" id="4771492">.</span><span class="ident" id="4771493">Flags</span><span class="op" id="4771498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4771502">}</span>&nbsp;<span class="keyword" id="4771504">else</span>&nbsp;<span class="op" id="4771509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771514"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771517">.</span><span class="ident" id="4771518">Rune</span>&nbsp;<span class="op" id="4771523">=</span>&nbsp;<span class="ident" id="4771525"><a href="/regexp/syntax/parse.go.html#4785323">appendClass</a></span><span class="op" id="4771536">(</span><span class="ident" id="4771537"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771540">.</span><span class="ident" id="4771541">Rune</span><span class="op" id="4771545">,</span>&nbsp;<span class="ident" id="4771547"><a href="/regexp/syntax/parse.go.html#4771161">src</a></span><span class="op" id="4771550">.</span><span class="ident" id="4771551">Rune</span><span class="op" id="4771555">)</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4771559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771562">case</span>&nbsp;<span class="ident" id="4771567"><a href="/regexp/syntax/regexp.go.html#4800935">OpLiteral</a></span><span class="op" id="4771576">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4771580">//&nbsp;both&nbsp;literal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771598">if</span>&nbsp;<span class="ident" id="4771601"><a href="/regexp/syntax/parse.go.html#4771161">src</a></span><span class="op" id="4771604">.</span><span class="ident" id="4771605">Rune</span><span class="op" id="4771609">[</span><span class="num" id="4771610">0</span><span class="op" id="4771611">]</span>&nbsp;<span class="op" id="4771613">==</span>&nbsp;<span class="ident" id="4771616"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771619">.</span><span class="ident" id="4771620">Rune</span><span class="op" id="4771624">[</span><span class="num" id="4771625">0</span><span class="op" id="4771626">]</span>&nbsp;<span class="op" id="4771628">&amp;&amp;</span>&nbsp;<span class="ident" id="4771631"><a href="/regexp/syntax/parse.go.html#4771161">src</a></span><span class="op" id="4771634">.</span><span class="ident" id="4771635">Flags</span>&nbsp;<span class="op" id="4771641">==</span>&nbsp;<span class="ident" id="4771644"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771647">.</span><span class="ident" id="4771648">Flags</span>&nbsp;<span class="op" id="4771654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771659">break</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4771667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771671"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771674">.</span><span class="ident" id="4771675">Op</span>&nbsp;<span class="op" id="4771678">=</span>&nbsp;<span class="ident" id="4771680"><a href="/regexp/syntax/regexp.go.html#4800993">OpCharClass</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771694"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771697">.</span><span class="ident" id="4771698">Rune</span>&nbsp;<span class="op" id="4771703">=</span>&nbsp;<span class="ident" id="4771705"><a href="/regexp/syntax/parse.go.html#4783410">appendLiteral</a></span><span class="op" id="4771718">(</span><span class="ident" id="4771719"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771722">.</span><span class="ident" id="4771723">Rune</span><span class="op" id="4771727">[</span><span class="op" id="4771728">:</span><span class="num" id="4771729">0</span><span class="op" id="4771730">]</span><span class="op" id="4771731">,</span>&nbsp;<span class="ident" id="4771733"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771736">.</span><span class="ident" id="4771737">Rune</span><span class="op" id="4771741">[</span><span class="num" id="4771742">0</span><span class="op" id="4771743">]</span><span class="op" id="4771744">,</span>&nbsp;<span class="ident" id="4771746"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771749">.</span><span class="ident" id="4771750">Flags</span><span class="op" id="4771755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771759"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771762">.</span><span class="ident" id="4771763">Rune</span>&nbsp;<span class="op" id="4771768">=</span>&nbsp;<span class="ident" id="4771770"><a href="/regexp/syntax/parse.go.html#4783410">appendLiteral</a></span><span class="op" id="4771783">(</span><span class="ident" id="4771784"><a href="/regexp/syntax/parse.go.html#4771156">dst</a></span><span class="op" id="4771787">.</span><span class="ident" id="4771788">Rune</span><span class="op" id="4771792">,</span>&nbsp;<span class="ident" id="4771794"><a href="/regexp/syntax/parse.go.html#4771161">src</a></span><span class="op" id="4771797">.</span><span class="ident" id="4771798">Rune</span><span class="op" id="4771802">[</span><span class="num" id="4771803">0</span><span class="op" id="4771804">]</span><span class="op" id="4771805">,</span>&nbsp;<span class="ident" id="4771807"><a href="/regexp/syntax/parse.go.html#4771161">src</a></span><span class="op" id="4771810">.</span><span class="ident" id="4771811">Flags</span><span class="op" id="4771816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4771819">}</span><br>
<span class="lineno">1155</span><span class="op" id="4771821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4771824">//&nbsp;If&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack&nbsp;is&nbsp;an&nbsp;element&nbsp;followed&nbsp;by&nbsp;an&nbsp;opVerticalBar</span><br>
<span class="lineno"></span><span class="comment" id="4771894">//&nbsp;swapVerticalBar&nbsp;swaps&nbsp;the&nbsp;two&nbsp;and&nbsp;returns&nbsp;true.</span><br>
<span class="lineno"></span><span class="comment" id="4771945">//&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;false.</span><br>
<span class="lineno">1160</span><span class="keyword" id="4771976">func</span>&nbsp;<span class="op" id="4771981">(</span><span class="ident" id="4771982">p</span>&nbsp;<span class="op" id="4771984">*</span><span class="ident" id="4771985"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4771991">)</span>&nbsp;<span class="ident" id="4771993">swapVerticalBar</span><span class="op" id="4772008">(</span><span class="op" id="4772009">)</span>&nbsp;<span class="builtintype" id="4772011">bool</span>&nbsp;<span class="op" id="4772016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4772019">//&nbsp;If&nbsp;above&nbsp;and&nbsp;below&nbsp;vertical&nbsp;bar&nbsp;are&nbsp;literal&nbsp;or&nbsp;char&nbsp;class,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4772082">//&nbsp;can&nbsp;merge&nbsp;into&nbsp;a&nbsp;single&nbsp;char&nbsp;class.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772122">n</span>&nbsp;<span class="op" id="4772124">:=</span>&nbsp;<span class="builtinfunc" id="4772127">len</span><span class="op" id="4772130">(</span><span class="ident" id="4772131"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772132">.</span><span class="ident" id="4772133">stack</span><span class="op" id="4772138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772141">if</span>&nbsp;<span class="ident" id="4772144"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span>&nbsp;<span class="op" id="4772146">&gt;=</span>&nbsp;<span class="num" id="4772149">3</span>&nbsp;<span class="op" id="4772151">&amp;&amp;</span>&nbsp;<span class="ident" id="4772154"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772155">.</span><span class="ident" id="4772156">stack</span><span class="op" id="4772161">[</span><span class="ident" id="4772162"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span><span class="op" id="4772163">-</span><span class="num" id="4772164">2</span><span class="op" id="4772165">]</span><span class="op" id="4772166">.</span><span class="ident" id="4772167">Op</span>&nbsp;<span class="op" id="4772170">==</span>&nbsp;<span class="ident" id="4772173"><a href="/regexp/syntax/parse.go.html#4745463">opVerticalBar</a></span>&nbsp;<span class="op" id="4772187">&amp;&amp;</span>&nbsp;<span class="ident" id="4772190"><a href="/regexp/syntax/parse.go.html#4770089">isCharClass</a></span><span class="op" id="4772201">(</span><span class="ident" id="4772202"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772203">.</span><span class="ident" id="4772204">stack</span><span class="op" id="4772209">[</span><span class="ident" id="4772210"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span><span class="op" id="4772211">-</span><span class="num" id="4772212">1</span><span class="op" id="4772213">]</span><span class="op" id="4772214">)</span>&nbsp;<span class="op" id="4772216">&amp;&amp;</span>&nbsp;<span class="ident" id="4772219"><a href="/regexp/syntax/parse.go.html#4770089">isCharClass</a></span><span class="op" id="4772230">(</span><span class="ident" id="4772231"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772232">.</span><span class="ident" id="4772233">stack</span><span class="op" id="4772238">[</span><span class="ident" id="4772239"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span><span class="op" id="4772240">-</span><span class="num" id="4772241">3</span><span class="op" id="4772242">]</span><span class="op" id="4772243">)</span>&nbsp;<span class="op" id="4772245">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772249">re1</span>&nbsp;<span class="op" id="4772253">:=</span>&nbsp;<span class="ident" id="4772256"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772257">.</span><span class="ident" id="4772258">stack</span><span class="op" id="4772263">[</span><span class="ident" id="4772264"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span><span class="op" id="4772265">-</span><span class="num" id="4772266">1</span><span class="op" id="4772267">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772271">re3</span>&nbsp;<span class="op" id="4772275">:=</span>&nbsp;<span class="ident" id="4772278"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772279">.</span><span class="ident" id="4772280">stack</span><span class="op" id="4772285">[</span><span class="ident" id="4772286"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span><span class="op" id="4772287">-</span><span class="num" id="4772288">3</span><span class="op" id="4772289">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4772293">//&nbsp;Make&nbsp;re3&nbsp;the&nbsp;more&nbsp;complex&nbsp;of&nbsp;the&nbsp;two.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772336">if</span>&nbsp;<span class="ident" id="4772339"><a href="/regexp/syntax/parse.go.html#4772249">re1</a></span><span class="op" id="4772342">.</span><span class="ident" id="4772343">Op</span>&nbsp;<span class="op" id="4772346">&gt;</span>&nbsp;<span class="ident" id="4772348"><a href="/regexp/syntax/parse.go.html#4772271">re3</a></span><span class="op" id="4772351">.</span><span class="ident" id="4772352">Op</span>&nbsp;<span class="op" id="4772355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772360"><a href="/regexp/syntax/parse.go.html#4772249">re1</a></span><span class="op" id="4772363">,</span>&nbsp;<span class="ident" id="4772365"><a href="/regexp/syntax/parse.go.html#4772271">re3</a></span>&nbsp;<span class="op" id="4772369">=</span>&nbsp;<span class="ident" id="4772371"><a href="/regexp/syntax/parse.go.html#4772271">re3</a></span><span class="op" id="4772374">,</span>&nbsp;<span class="ident" id="4772376"><a href="/regexp/syntax/parse.go.html#4772249">re1</a></span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772383"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772384">.</span><span class="ident" id="4772385">stack</span><span class="op" id="4772390">[</span><span class="ident" id="4772391"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span><span class="op" id="4772392">-</span><span class="num" id="4772393">3</span><span class="op" id="4772394">]</span>&nbsp;<span class="op" id="4772396">=</span>&nbsp;<span class="ident" id="4772398"><a href="/regexp/syntax/parse.go.html#4772271">re3</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4772404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772408"><a href="/regexp/syntax/parse.go.html#4771141">mergeCharClass</a></span><span class="op" id="4772422">(</span><span class="ident" id="4772423"><a href="/regexp/syntax/parse.go.html#4772271">re3</a></span><span class="op" id="4772426">,</span>&nbsp;<span class="ident" id="4772428"><a href="/regexp/syntax/parse.go.html#4772249">re1</a></span><span class="op" id="4772431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772435"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772436">.</span><span class="ident" id="4772437">reuse</span><span class="op" id="4772442">(</span><span class="ident" id="4772443"><a href="/regexp/syntax/parse.go.html#4772249">re1</a></span><span class="op" id="4772446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772450"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772451">.</span><span class="ident" id="4772452">stack</span>&nbsp;<span class="op" id="4772458">=</span>&nbsp;<span class="ident" id="4772460"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772461">.</span><span class="ident" id="4772462">stack</span><span class="op" id="4772467">[</span><span class="op" id="4772468">:</span><span class="ident" id="4772469"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span><span class="op" id="4772470">-</span><span class="num" id="4772471">1</span><span class="op" id="4772472">]</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772476">return</span>&nbsp;<span class="ident" id="4772483">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4772489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772493">if</span>&nbsp;<span class="ident" id="4772496"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span>&nbsp;<span class="op" id="4772498">&gt;=</span>&nbsp;<span class="num" id="4772501">2</span>&nbsp;<span class="op" id="4772503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772507">re1</span>&nbsp;<span class="op" id="4772511">:=</span>&nbsp;<span class="ident" id="4772514"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772515">.</span><span class="ident" id="4772516">stack</span><span class="op" id="4772521">[</span><span class="ident" id="4772522"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span><span class="op" id="4772523">-</span><span class="num" id="4772524">1</span><span class="op" id="4772525">]</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772529">re2</span>&nbsp;<span class="op" id="4772533">:=</span>&nbsp;<span class="ident" id="4772536"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772537">.</span><span class="ident" id="4772538">stack</span><span class="op" id="4772543">[</span><span class="ident" id="4772544"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span><span class="op" id="4772545">-</span><span class="num" id="4772546">2</span><span class="op" id="4772547">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772551">if</span>&nbsp;<span class="ident" id="4772554"><a href="/regexp/syntax/parse.go.html#4772529">re2</a></span><span class="op" id="4772557">.</span><span class="ident" id="4772558">Op</span>&nbsp;<span class="op" id="4772561">==</span>&nbsp;<span class="ident" id="4772564"><a href="/regexp/syntax/parse.go.html#4745463">opVerticalBar</a></span>&nbsp;<span class="op" id="4772578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772583">if</span>&nbsp;<span class="ident" id="4772586"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span>&nbsp;<span class="op" id="4772588">&gt;=</span>&nbsp;<span class="num" id="4772591">3</span>&nbsp;<span class="op" id="4772593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4772599">//&nbsp;Now&nbsp;out&nbsp;of&nbsp;reach.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4772624">//&nbsp;Clean&nbsp;opportunistically.</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772656"><a href="/regexp/syntax/parse.go.html#4752466">cleanAlt</a></span><span class="op" id="4772664">(</span><span class="ident" id="4772665"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772666">.</span><span class="ident" id="4772667">stack</span><span class="op" id="4772672">[</span><span class="ident" id="4772673"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span><span class="op" id="4772674">-</span><span class="num" id="4772675">3</span><span class="op" id="4772676">]</span><span class="op" id="4772677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4772682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772687"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772688">.</span><span class="ident" id="4772689">stack</span><span class="op" id="4772694">[</span><span class="ident" id="4772695"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span><span class="op" id="4772696">-</span><span class="num" id="4772697">2</span><span class="op" id="4772698">]</span>&nbsp;<span class="op" id="4772700">=</span>&nbsp;<span class="ident" id="4772702"><a href="/regexp/syntax/parse.go.html#4772507">re1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772709"><a href="/regexp/syntax/parse.go.html#4771982">p</a></span><span class="op" id="4772710">.</span><span class="ident" id="4772711">stack</span><span class="op" id="4772716">[</span><span class="ident" id="4772717"><a href="/regexp/syntax/parse.go.html#4772122">n</a></span><span class="op" id="4772718">-</span><span class="num" id="4772719">1</span><span class="op" id="4772720">]</span>&nbsp;<span class="op" id="4772722">=</span>&nbsp;<span class="ident" id="4772724"><a href="/regexp/syntax/parse.go.html#4772529">re2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772731">return</span>&nbsp;<span class="ident" id="4772738">true</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4772745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4772748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772751">return</span>&nbsp;<span class="ident" id="4772758">false</span><br>
<span class="lineno"></span><span class="op" id="4772764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span><span class="comment" id="4772767">//&nbsp;parseRightParen&nbsp;handles&nbsp;a&nbsp;)&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="4772812">func</span>&nbsp;<span class="op" id="4772817">(</span><span class="ident" id="4772818">p</span>&nbsp;<span class="op" id="4772820">*</span><span class="ident" id="4772821"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4772827">)</span>&nbsp;<span class="ident" id="4772829">parseRightParen</span><span class="op" id="4772844">(</span><span class="op" id="4772845">)</span>&nbsp;<span class="builtintype" id="4772847">error</span>&nbsp;<span class="op" id="4772853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772856"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4772857">.</span><span class="ident" id="4772858">concat</span><span class="op" id="4772864">(</span><span class="op" id="4772865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772868">if</span>&nbsp;<span class="ident" id="4772871"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4772872">.</span><span class="ident" id="4772873">swapVerticalBar</span><span class="op" id="4772888">(</span><span class="op" id="4772889">)</span>&nbsp;<span class="op" id="4772891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4772895">//&nbsp;pop&nbsp;vertical&nbsp;bar</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772917"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4772918">.</span><span class="ident" id="4772919">stack</span>&nbsp;<span class="op" id="4772925">=</span>&nbsp;<span class="ident" id="4772927"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4772928">.</span><span class="ident" id="4772929">stack</span><span class="op" id="4772934">[</span><span class="op" id="4772935">:</span><span class="builtinfunc" id="4772936">len</span><span class="op" id="4772939">(</span><span class="ident" id="4772940"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4772941">.</span><span class="ident" id="4772942">stack</span><span class="op" id="4772947">)</span><span class="op" id="4772948">-</span><span class="num" id="4772949">1</span><span class="op" id="4772950">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4772953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772956"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4772957">.</span><span class="ident" id="4772958">alternate</span><span class="op" id="4772967">(</span><span class="op" id="4772968">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772972">n</span>&nbsp;<span class="op" id="4772974">:=</span>&nbsp;<span class="builtinfunc" id="4772977">len</span><span class="op" id="4772980">(</span><span class="ident" id="4772981"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4772982">.</span><span class="ident" id="4772983">stack</span><span class="op" id="4772988">)</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772991">if</span>&nbsp;<span class="ident" id="4772994"><a href="/regexp/syntax/parse.go.html#4772972">n</a></span>&nbsp;<span class="op" id="4772996">&lt;</span>&nbsp;<span class="num" id="4772998">2</span>&nbsp;<span class="op" id="4773000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773004">return</span>&nbsp;<span class="op" id="4773011">&amp;</span><span class="ident" id="4773012"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4773017">{</span><span class="ident" id="4773018"><a href="/regexp/syntax/parse.go.html#4744205">ErrUnexpectedParen</a></span><span class="op" id="4773036">,</span>&nbsp;<span class="ident" id="4773038"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4773039">.</span><span class="ident" id="4773040">wholeRegexp</span><span class="op" id="4773051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4773054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4773057">re1</span>&nbsp;<span class="op" id="4773061">:=</span>&nbsp;<span class="ident" id="4773064"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4773065">.</span><span class="ident" id="4773066">stack</span><span class="op" id="4773071">[</span><span class="ident" id="4773072"><a href="/regexp/syntax/parse.go.html#4772972">n</a></span><span class="op" id="4773073">-</span><span class="num" id="4773074">1</span><span class="op" id="4773075">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4773078">re2</span>&nbsp;<span class="op" id="4773082">:=</span>&nbsp;<span class="ident" id="4773085"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4773086">.</span><span class="ident" id="4773087">stack</span><span class="op" id="4773092">[</span><span class="ident" id="4773093"><a href="/regexp/syntax/parse.go.html#4772972">n</a></span><span class="op" id="4773094">-</span><span class="num" id="4773095">2</span><span class="op" id="4773096">]</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4773099"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4773100">.</span><span class="ident" id="4773101">stack</span>&nbsp;<span class="op" id="4773107">=</span>&nbsp;<span class="ident" id="4773109"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4773110">.</span><span class="ident" id="4773111">stack</span><span class="op" id="4773116">[</span><span class="op" id="4773117">:</span><span class="ident" id="4773118"><a href="/regexp/syntax/parse.go.html#4772972">n</a></span><span class="op" id="4773119">-</span><span class="num" id="4773120">2</span><span class="op" id="4773121">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773124">if</span>&nbsp;<span class="ident" id="4773127"><a href="/regexp/syntax/parse.go.html#4773078">re2</a></span><span class="op" id="4773130">.</span><span class="ident" id="4773131">Op</span>&nbsp;<span class="op" id="4773134">!=</span>&nbsp;<span class="ident" id="4773137"><a href="/regexp/syntax/parse.go.html#4745432">opLeftParen</a></span>&nbsp;<span class="op" id="4773149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773153">return</span>&nbsp;<span class="op" id="4773160">&amp;</span><span class="ident" id="4773161"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4773166">{</span><span class="ident" id="4773167"><a href="/regexp/syntax/parse.go.html#4744205">ErrUnexpectedParen</a></span><span class="op" id="4773185">,</span>&nbsp;<span class="ident" id="4773187"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4773188">.</span><span class="ident" id="4773189">wholeRegexp</span><span class="op" id="4773200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4773203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4773206">//&nbsp;Restore&nbsp;flags&nbsp;at&nbsp;time&nbsp;of&nbsp;paren.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4773242"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4773243">.</span><span class="ident" id="4773244">flags</span>&nbsp;<span class="op" id="4773250">=</span>&nbsp;<span class="ident" id="4773252"><a href="/regexp/syntax/parse.go.html#4773078">re2</a></span><span class="op" id="4773255">.</span><span class="ident" id="4773256">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773263">if</span>&nbsp;<span class="ident" id="4773266"><a href="/regexp/syntax/parse.go.html#4773078">re2</a></span><span class="op" id="4773269">.</span><span class="ident" id="4773270">Cap</span>&nbsp;<span class="op" id="4773274">==</span>&nbsp;<span class="num" id="4773277">0</span>&nbsp;<span class="op" id="4773279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4773283">//&nbsp;Just&nbsp;for&nbsp;grouping.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4773307"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4773308">.</span><span class="ident" id="4773309">push</span><span class="op" id="4773313">(</span><span class="ident" id="4773314"><a href="/regexp/syntax/parse.go.html#4773057">re1</a></span><span class="op" id="4773317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4773320">}</span>&nbsp;<span class="keyword" id="4773322">else</span>&nbsp;<span class="op" id="4773327">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4773331"><a href="/regexp/syntax/parse.go.html#4773078">re2</a></span><span class="op" id="4773334">.</span><span class="ident" id="4773335">Op</span>&nbsp;<span class="op" id="4773338">=</span>&nbsp;<span class="ident" id="4773340"><a href="/regexp/syntax/regexp.go.html#4801626">OpCapture</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4773352"><a href="/regexp/syntax/parse.go.html#4773078">re2</a></span><span class="op" id="4773355">.</span><span class="ident" id="4773356">Sub</span>&nbsp;<span class="op" id="4773360">=</span>&nbsp;<span class="ident" id="4773362"><a href="/regexp/syntax/parse.go.html#4773078">re2</a></span><span class="op" id="4773365">.</span><span class="ident" id="4773366">Sub0</span><span class="op" id="4773370">[</span><span class="op" id="4773371">:</span><span class="num" id="4773372">1</span><span class="op" id="4773373">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4773377"><a href="/regexp/syntax/parse.go.html#4773078">re2</a></span><span class="op" id="4773380">.</span><span class="ident" id="4773381">Sub</span><span class="op" id="4773384">[</span><span class="num" id="4773385">0</span><span class="op" id="4773386">]</span>&nbsp;<span class="op" id="4773388">=</span>&nbsp;<span class="ident" id="4773390"><a href="/regexp/syntax/parse.go.html#4773057">re1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4773396"><a href="/regexp/syntax/parse.go.html#4772818">p</a></span><span class="op" id="4773397">.</span><span class="ident" id="4773398">push</span><span class="op" id="4773402">(</span><span class="ident" id="4773403"><a href="/regexp/syntax/parse.go.html#4773078">re2</a></span><span class="op" id="4773406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4773409">}</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773412">return</span>&nbsp;<span class="ident" id="4773419">nil</span><br>
<span class="lineno"></span><span class="op" id="4773423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4773426">//&nbsp;parseEscape&nbsp;parses&nbsp;an&nbsp;escape&nbsp;sequence&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="4773489">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune.</span><br>
<span class="lineno">1230</span><span class="keyword" id="4773514">func</span>&nbsp;<span class="op" id="4773519">(</span><span class="ident" id="4773520">p</span>&nbsp;<span class="op" id="4773522">*</span><span class="ident" id="4773523"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4773529">)</span>&nbsp;<span class="ident" id="4773531">parseEscape</span><span class="op" id="4773542">(</span><span class="ident" id="4773543">s</span>&nbsp;<span class="builtintype" id="4773545">string</span><span class="op" id="4773551">)</span>&nbsp;<span class="op" id="4773553">(</span><span class="ident" id="4773554">r</span>&nbsp;<span class="builtintype" id="4773556">rune</span><span class="op" id="4773560">,</span>&nbsp;<span class="ident" id="4773562">rest</span>&nbsp;<span class="builtintype" id="4773567">string</span><span class="op" id="4773573">,</span>&nbsp;<span class="ident" id="4773575">err</span>&nbsp;<span class="builtintype" id="4773579">error</span><span class="op" id="4773584">)</span>&nbsp;<span class="op" id="4773586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4773589">t</span>&nbsp;<span class="op" id="4773591">:=</span>&nbsp;<span class="ident" id="4773594"><a href="/regexp/syntax/parse.go.html#4773543">s</a></span><span class="op" id="4773595">[</span><span class="num" id="4773596">1</span><span class="op" id="4773597">:</span><span class="op" id="4773598">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773601">if</span>&nbsp;<span class="ident" id="4773604"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span>&nbsp;<span class="op" id="4773606">==</span>&nbsp;<span class="string" id="4773609">&#34;&#34;</span>&nbsp;<span class="op" id="4773612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773616">return</span>&nbsp;<span class="num" id="4773623">0</span><span class="op" id="4773624">,</span>&nbsp;<span class="string" id="4773626">&#34;&#34;</span><span class="op" id="4773628">,</span>&nbsp;<span class="op" id="4773630">&amp;</span><span class="ident" id="4773631"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4773636">{</span><span class="ident" id="4773637"><a href="/regexp/syntax/parse.go.html#4744125">ErrTrailingBackslash</a></span><span class="op" id="4773657">,</span>&nbsp;<span class="string" id="4773659">&#34;&#34;</span><span class="op" id="4773661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4773664">}</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4773667">c</span><span class="op" id="4773668">,</span>&nbsp;<span class="ident" id="4773670"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4773671">,</span>&nbsp;<span class="ident" id="4773673"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span>&nbsp;<span class="op" id="4773677">:=</span>&nbsp;<span class="ident" id="4773680"><a href="/regexp/syntax/parse.go.html#4788999">nextRune</a></span><span class="op" id="4773688">(</span><span class="ident" id="4773689"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4773690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773693">if</span>&nbsp;<span class="ident" id="4773696"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span>&nbsp;<span class="op" id="4773700">!=</span>&nbsp;<span class="ident" id="4773703">nil</span>&nbsp;<span class="op" id="4773707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773711">return</span>&nbsp;<span class="num" id="4773718">0</span><span class="op" id="4773719">,</span>&nbsp;<span class="string" id="4773721">&#34;&#34;</span><span class="op" id="4773723">,</span>&nbsp;<span class="ident" id="4773725"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4773730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span><span class="ident" id="4773733">Switch</span><span class="op" id="4773739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773742">switch</span>&nbsp;<span class="ident" id="4773749"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span>&nbsp;<span class="op" id="4773751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773754">default</span><span class="op" id="4773761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773765">if</span>&nbsp;<span class="ident" id="4773768"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span>&nbsp;<span class="op" id="4773770">&lt;</span>&nbsp;<span class="ident" id="4773772"><a href="/regexp/syntax/parse.go.html#4742923">utf8</a></span><span class="op" id="4773776">.</span><span class="ident" id="4773777">RuneSelf</span>&nbsp;<span class="op" id="4773786">&amp;&amp;</span>&nbsp;<span class="op" id="4773789">!</span><span class="ident" id="4773790"><a href="/regexp/syntax/parse.go.html#4789218">isalnum</a></span><span class="op" id="4773797">(</span><span class="ident" id="4773798"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span><span class="op" id="4773799">)</span>&nbsp;<span class="op" id="4773801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4773806">//&nbsp;Escaped&nbsp;non-word&nbsp;characters&nbsp;are&nbsp;always&nbsp;themselves.</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4773863">//&nbsp;PCRE&nbsp;is&nbsp;not&nbsp;quite&nbsp;so&nbsp;rigorous:&nbsp;it&nbsp;accepts&nbsp;things&nbsp;like</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4773923">//&nbsp;\q,&nbsp;but&nbsp;we&nbsp;don&#39;t.&nbsp;&nbsp;We&nbsp;once&nbsp;rejected&nbsp;\_,&nbsp;but&nbsp;too&nbsp;many</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4773982">//&nbsp;programs&nbsp;and&nbsp;people&nbsp;insist&nbsp;on&nbsp;using&nbsp;it,&nbsp;so&nbsp;allow&nbsp;\_.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774041">return</span>&nbsp;<span class="ident" id="4774048"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span><span class="op" id="4774049">,</span>&nbsp;<span class="ident" id="4774051"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4774052">,</span>&nbsp;<span class="ident" id="4774054">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4774060">}</span><br>
<span class="lineno">1250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774064">//&nbsp;Octal&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774083">case</span>&nbsp;<span class="string" id="4774088">&#39;1&#39;</span><span class="op" id="4774091">,</span>&nbsp;<span class="string" id="4774093">&#39;2&#39;</span><span class="op" id="4774096">,</span>&nbsp;<span class="string" id="4774098">&#39;3&#39;</span><span class="op" id="4774101">,</span>&nbsp;<span class="string" id="4774103">&#39;4&#39;</span><span class="op" id="4774106">,</span>&nbsp;<span class="string" id="4774108">&#39;5&#39;</span><span class="op" id="4774111">,</span>&nbsp;<span class="string" id="4774113">&#39;6&#39;</span><span class="op" id="4774116">,</span>&nbsp;<span class="string" id="4774118">&#39;7&#39;</span><span class="op" id="4774121">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774125">//&nbsp;Single&nbsp;non-zero&nbsp;digit&nbsp;is&nbsp;a&nbsp;backreference;&nbsp;not&nbsp;supported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774186">if</span>&nbsp;<span class="ident" id="4774189"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span>&nbsp;<span class="op" id="4774191">==</span>&nbsp;<span class="string" id="4774194">&#34;&#34;</span>&nbsp;<span class="op" id="4774197">||</span>&nbsp;<span class="ident" id="4774200"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4774201">[</span><span class="num" id="4774202">0</span><span class="op" id="4774203">]</span>&nbsp;<span class="op" id="4774205">&lt;</span>&nbsp;<span class="string" id="4774207">&#39;0&#39;</span>&nbsp;<span class="op" id="4774211">||</span>&nbsp;<span class="ident" id="4774214"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4774215">[</span><span class="num" id="4774216">0</span><span class="op" id="4774217">]</span>&nbsp;<span class="op" id="4774219">&gt;</span>&nbsp;<span class="string" id="4774221">&#39;7&#39;</span>&nbsp;<span class="op" id="4774225">{</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774230">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4774238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774242">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774255">case</span>&nbsp;<span class="string" id="4774260">&#39;0&#39;</span><span class="op" id="4774263">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774267">//&nbsp;Consume&nbsp;up&nbsp;to&nbsp;three&nbsp;octal&nbsp;digits;&nbsp;already&nbsp;have&nbsp;one.</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774324"><a href="/regexp/syntax/parse.go.html#4773554">r</a></span>&nbsp;<span class="op" id="4774326">=</span>&nbsp;<span class="ident" id="4774328"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span>&nbsp;<span class="op" id="4774330">-</span>&nbsp;<span class="string" id="4774332">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774338">for</span>&nbsp;<span class="ident" id="4774342">i</span>&nbsp;<span class="op" id="4774344">:=</span>&nbsp;<span class="num" id="4774347">1</span><span class="op" id="4774348">;</span>&nbsp;<span class="ident" id="4774350"><a href="/regexp/syntax/parse.go.html#4774342">i</a></span>&nbsp;<span class="op" id="4774352">&lt;</span>&nbsp;<span class="num" id="4774354">3</span><span class="op" id="4774355">;</span>&nbsp;<span class="ident" id="4774357"><a href="/regexp/syntax/parse.go.html#4774342">i</a></span><span class="op" id="4774358">++</span>&nbsp;<span class="op" id="4774361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774366">if</span>&nbsp;<span class="ident" id="4774369"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span>&nbsp;<span class="op" id="4774371">==</span>&nbsp;<span class="string" id="4774374">&#34;&#34;</span>&nbsp;<span class="op" id="4774377">||</span>&nbsp;<span class="ident" id="4774380"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4774381">[</span><span class="num" id="4774382">0</span><span class="op" id="4774383">]</span>&nbsp;<span class="op" id="4774385">&lt;</span>&nbsp;<span class="string" id="4774387">&#39;0&#39;</span>&nbsp;<span class="op" id="4774391">||</span>&nbsp;<span class="ident" id="4774394"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4774395">[</span><span class="num" id="4774396">0</span><span class="op" id="4774397">]</span>&nbsp;<span class="op" id="4774399">&gt;</span>&nbsp;<span class="string" id="4774401">&#39;7&#39;</span>&nbsp;<span class="op" id="4774405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774411">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4774420">}</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774425"><a href="/regexp/syntax/parse.go.html#4773554">r</a></span>&nbsp;<span class="op" id="4774427">=</span>&nbsp;<span class="ident" id="4774429"><a href="/regexp/syntax/parse.go.html#4773554">r</a></span><span class="op" id="4774430">*</span><span class="num" id="4774431">8</span>&nbsp;<span class="op" id="4774433">+</span>&nbsp;<span class="builtintype" id="4774435">rune</span><span class="op" id="4774439">(</span><span class="ident" id="4774440"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4774441">[</span><span class="num" id="4774442">0</span><span class="op" id="4774443">]</span><span class="op" id="4774444">)</span>&nbsp;<span class="op" id="4774446">-</span>&nbsp;<span class="string" id="4774448">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774455"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span>&nbsp;<span class="op" id="4774457">=</span>&nbsp;<span class="ident" id="4774459"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4774460">[</span><span class="num" id="4774461">1</span><span class="op" id="4774462">:</span><span class="op" id="4774463">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4774467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774471">return</span>&nbsp;<span class="ident" id="4774478"><a href="/regexp/syntax/parse.go.html#4773554">r</a></span><span class="op" id="4774479">,</span>&nbsp;<span class="ident" id="4774481"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4774482">,</span>&nbsp;<span class="ident" id="4774484">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774490">//&nbsp;Hexadecimal&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774515">case</span>&nbsp;<span class="string" id="4774520">&#39;x&#39;</span><span class="op" id="4774523">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774527">if</span>&nbsp;<span class="ident" id="4774530"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span>&nbsp;<span class="op" id="4774532">==</span>&nbsp;<span class="string" id="4774535">&#34;&#34;</span>&nbsp;<span class="op" id="4774538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774543">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4774551">}</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774555">if</span>&nbsp;<span class="ident" id="4774558"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span><span class="op" id="4774559">,</span>&nbsp;<span class="ident" id="4774561"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4774562">,</span>&nbsp;<span class="ident" id="4774564"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span>&nbsp;<span class="op" id="4774568">=</span>&nbsp;<span class="ident" id="4774570"><a href="/regexp/syntax/parse.go.html#4788999">nextRune</a></span><span class="op" id="4774578">(</span><span class="ident" id="4774579"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4774580">)</span><span class="op" id="4774581">;</span>&nbsp;<span class="ident" id="4774583"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span>&nbsp;<span class="op" id="4774587">!=</span>&nbsp;<span class="ident" id="4774590">nil</span>&nbsp;<span class="op" id="4774594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774599">return</span>&nbsp;<span class="num" id="4774606">0</span><span class="op" id="4774607">,</span>&nbsp;<span class="string" id="4774609">&#34;&#34;</span><span class="op" id="4774611">,</span>&nbsp;<span class="ident" id="4774613"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4774619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774623">if</span>&nbsp;<span class="ident" id="4774626"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span>&nbsp;<span class="op" id="4774628">==</span>&nbsp;<span class="string" id="4774631">&#39;{&#39;</span>&nbsp;<span class="op" id="4774635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774640">//&nbsp;Any&nbsp;number&nbsp;of&nbsp;digits&nbsp;in&nbsp;braces.</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774678">//&nbsp;Perl&nbsp;accepts&nbsp;any&nbsp;text&nbsp;at&nbsp;all;&nbsp;it&nbsp;ignores&nbsp;all&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774734">//&nbsp;after&nbsp;the&nbsp;first&nbsp;non-hex&nbsp;digit.&nbsp;&nbsp;We&nbsp;require&nbsp;only&nbsp;hex&nbsp;digits,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774800">//&nbsp;and&nbsp;at&nbsp;least&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774824">nhex</span>&nbsp;<span class="op" id="4774829">:=</span>&nbsp;<span class="num" id="4774832">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774837"><a href="/regexp/syntax/parse.go.html#4773554">r</a></span>&nbsp;<span class="op" id="4774839">=</span>&nbsp;<span class="num" id="4774841">0</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774846">for</span>&nbsp;<span class="op" id="4774850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774856">if</span>&nbsp;<span class="ident" id="4774859"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span>&nbsp;<span class="op" id="4774861">==</span>&nbsp;<span class="string" id="4774864">&#34;&#34;</span>&nbsp;<span class="op" id="4774867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774874">break</span>&nbsp;<span class="ident" id="4774880">Switch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4774891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774897">if</span>&nbsp;<span class="ident" id="4774900"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span><span class="op" id="4774901">,</span>&nbsp;<span class="ident" id="4774903"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4774904">,</span>&nbsp;<span class="ident" id="4774906"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span>&nbsp;<span class="op" id="4774910">=</span>&nbsp;<span class="ident" id="4774912"><a href="/regexp/syntax/parse.go.html#4788999">nextRune</a></span><span class="op" id="4774920">(</span><span class="ident" id="4774921"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4774922">)</span><span class="op" id="4774923">;</span>&nbsp;<span class="ident" id="4774925"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span>&nbsp;<span class="op" id="4774929">!=</span>&nbsp;<span class="ident" id="4774932">nil</span>&nbsp;<span class="op" id="4774936">{</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774943">return</span>&nbsp;<span class="num" id="4774950">0</span><span class="op" id="4774951">,</span>&nbsp;<span class="string" id="4774953">&#34;&#34;</span><span class="op" id="4774955">,</span>&nbsp;<span class="ident" id="4774957"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4774965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774971">if</span>&nbsp;<span class="ident" id="4774974"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span>&nbsp;<span class="op" id="4774976">==</span>&nbsp;<span class="string" id="4774979">&#39;}&#39;</span>&nbsp;<span class="op" id="4774983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774990">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775000">}</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775006">v</span>&nbsp;<span class="op" id="4775008">:=</span>&nbsp;<span class="ident" id="4775011"><a href="/regexp/syntax/parse.go.html#4789326">unhex</a></span><span class="op" id="4775016">(</span><span class="ident" id="4775017"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span><span class="op" id="4775018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775024">if</span>&nbsp;<span class="ident" id="4775027"><a href="/regexp/syntax/parse.go.html#4775006">v</a></span>&nbsp;<span class="op" id="4775029">&lt;</span>&nbsp;<span class="num" id="4775031">0</span>&nbsp;<span class="op" id="4775033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775040">break</span>&nbsp;<span class="ident" id="4775046">Switch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775063"><a href="/regexp/syntax/parse.go.html#4773554">r</a></span>&nbsp;<span class="op" id="4775065">=</span>&nbsp;<span class="ident" id="4775067"><a href="/regexp/syntax/parse.go.html#4773554">r</a></span><span class="op" id="4775068">*</span><span class="num" id="4775069">16</span>&nbsp;<span class="op" id="4775072">+</span>&nbsp;<span class="ident" id="4775074"><a href="/regexp/syntax/parse.go.html#4775006">v</a></span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775080">if</span>&nbsp;<span class="ident" id="4775083"><a href="/regexp/syntax/parse.go.html#4773554">r</a></span>&nbsp;<span class="op" id="4775085">&gt;</span>&nbsp;<span class="ident" id="4775087"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4775094">.</span><span class="ident" id="4775095">MaxRune</span>&nbsp;<span class="op" id="4775103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775110">break</span>&nbsp;<span class="ident" id="4775116">Switch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775133"><a href="/regexp/syntax/parse.go.html#4774824">nhex</a></span><span class="op" id="4775137">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775143">}</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775148">if</span>&nbsp;<span class="ident" id="4775151"><a href="/regexp/syntax/parse.go.html#4774824">nhex</a></span>&nbsp;<span class="op" id="4775156">==</span>&nbsp;<span class="num" id="4775159">0</span>&nbsp;<span class="op" id="4775161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775167">break</span>&nbsp;<span class="ident" id="4775173">Switch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775188">return</span>&nbsp;<span class="ident" id="4775195"><a href="/regexp/syntax/parse.go.html#4773554">r</a></span><span class="op" id="4775196">,</span>&nbsp;<span class="ident" id="4775198"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4775199">,</span>&nbsp;<span class="ident" id="4775201">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775207">}</span><br>
<span class="lineno">1310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775212">//&nbsp;Easy&nbsp;case:&nbsp;two&nbsp;hex&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775244">x</span>&nbsp;<span class="op" id="4775246">:=</span>&nbsp;<span class="ident" id="4775249"><a href="/regexp/syntax/parse.go.html#4789326">unhex</a></span><span class="op" id="4775254">(</span><span class="ident" id="4775255"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span><span class="op" id="4775256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775260">if</span>&nbsp;<span class="ident" id="4775263"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span><span class="op" id="4775264">,</span>&nbsp;<span class="ident" id="4775266"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4775267">,</span>&nbsp;<span class="ident" id="4775269"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span>&nbsp;<span class="op" id="4775273">=</span>&nbsp;<span class="ident" id="4775275"><a href="/regexp/syntax/parse.go.html#4788999">nextRune</a></span><span class="op" id="4775283">(</span><span class="ident" id="4775284"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4775285">)</span><span class="op" id="4775286">;</span>&nbsp;<span class="ident" id="4775288"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span>&nbsp;<span class="op" id="4775292">!=</span>&nbsp;<span class="ident" id="4775295">nil</span>&nbsp;<span class="op" id="4775299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775304">return</span>&nbsp;<span class="num" id="4775311">0</span><span class="op" id="4775312">,</span>&nbsp;<span class="string" id="4775314">&#34;&#34;</span><span class="op" id="4775316">,</span>&nbsp;<span class="ident" id="4775318"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775328">y</span>&nbsp;<span class="op" id="4775330">:=</span>&nbsp;<span class="ident" id="4775333"><a href="/regexp/syntax/parse.go.html#4789326">unhex</a></span><span class="op" id="4775338">(</span><span class="ident" id="4775339"><a href="/regexp/syntax/parse.go.html#4773667">c</a></span><span class="op" id="4775340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775344">if</span>&nbsp;<span class="ident" id="4775347"><a href="/regexp/syntax/parse.go.html#4775244">x</a></span>&nbsp;<span class="op" id="4775349">&lt;</span>&nbsp;<span class="num" id="4775351">0</span>&nbsp;<span class="op" id="4775353">||</span>&nbsp;<span class="ident" id="4775356"><a href="/regexp/syntax/parse.go.html#4775328">y</a></span>&nbsp;<span class="op" id="4775358">&lt;</span>&nbsp;<span class="num" id="4775360">0</span>&nbsp;<span class="op" id="4775362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775367">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775375">}</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775379">return</span>&nbsp;<span class="ident" id="4775386"><a href="/regexp/syntax/parse.go.html#4775244">x</a></span><span class="op" id="4775387">*</span><span class="num" id="4775388">16</span>&nbsp;<span class="op" id="4775391">+</span>&nbsp;<span class="ident" id="4775393"><a href="/regexp/syntax/parse.go.html#4775328">y</a></span><span class="op" id="4775394">,</span>&nbsp;<span class="ident" id="4775396"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4775397">,</span>&nbsp;<span class="ident" id="4775399">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775405">//&nbsp;C&nbsp;escapes.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;case&nbsp;&#39;b&#39;,&nbsp;to&nbsp;avoid&nbsp;misparsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775463">//&nbsp;the&nbsp;Perl&nbsp;word-boundary&nbsp;\b&nbsp;as&nbsp;the&nbsp;C&nbsp;backspace&nbsp;\b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775515">//&nbsp;when&nbsp;in&nbsp;POSIX&nbsp;mode.&nbsp;&nbsp;In&nbsp;Perl,&nbsp;/\b/&nbsp;means&nbsp;word-boundary</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775574">//&nbsp;but&nbsp;/[\b]/&nbsp;means&nbsp;backspace.&nbsp;&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;that.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775630">//&nbsp;If&nbsp;you&nbsp;want&nbsp;a&nbsp;backspace,&nbsp;embed&nbsp;a&nbsp;literal&nbsp;backspace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775685">//&nbsp;character&nbsp;or&nbsp;use&nbsp;\x08.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775712">case</span>&nbsp;<span class="string" id="4775717">&#39;a&#39;</span><span class="op" id="4775720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775724">return</span>&nbsp;<span class="string" id="4775731">&#39;\a&#39;</span><span class="op" id="4775735">,</span>&nbsp;<span class="ident" id="4775737"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4775738">,</span>&nbsp;<span class="ident" id="4775740"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775745">case</span>&nbsp;<span class="string" id="4775750">&#39;f&#39;</span><span class="op" id="4775753">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775757">return</span>&nbsp;<span class="string" id="4775764">&#39;\f&#39;</span><span class="op" id="4775768">,</span>&nbsp;<span class="ident" id="4775770"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4775771">,</span>&nbsp;<span class="ident" id="4775773"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775778">case</span>&nbsp;<span class="string" id="4775783">&#39;n&#39;</span><span class="op" id="4775786">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775790">return</span>&nbsp;<span class="string" id="4775797">&#39;\n&#39;</span><span class="op" id="4775801">,</span>&nbsp;<span class="ident" id="4775803"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4775804">,</span>&nbsp;<span class="ident" id="4775806"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775811">case</span>&nbsp;<span class="string" id="4775816">&#39;r&#39;</span><span class="op" id="4775819">:</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775823">return</span>&nbsp;<span class="string" id="4775830">&#39;\r&#39;</span><span class="op" id="4775834">,</span>&nbsp;<span class="ident" id="4775836"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4775837">,</span>&nbsp;<span class="ident" id="4775839"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775844">case</span>&nbsp;<span class="string" id="4775849">&#39;t&#39;</span><span class="op" id="4775852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775856">return</span>&nbsp;<span class="string" id="4775863">&#39;\t&#39;</span><span class="op" id="4775867">,</span>&nbsp;<span class="ident" id="4775869"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4775870">,</span>&nbsp;<span class="ident" id="4775872"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775877">case</span>&nbsp;<span class="string" id="4775882">&#39;v&#39;</span><span class="op" id="4775885">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775889">return</span>&nbsp;<span class="string" id="4775896">&#39;\v&#39;</span><span class="op" id="4775900">,</span>&nbsp;<span class="ident" id="4775902"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4775903">,</span>&nbsp;<span class="ident" id="4775905"><a href="/regexp/syntax/parse.go.html#4773575">err</a></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775913">return</span>&nbsp;<span class="num" id="4775920">0</span><span class="op" id="4775921">,</span>&nbsp;<span class="string" id="4775923">&#34;&#34;</span><span class="op" id="4775925">,</span>&nbsp;<span class="op" id="4775927">&amp;</span><span class="ident" id="4775928"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4775933">{</span><span class="ident" id="4775934"><a href="/regexp/syntax/parse.go.html#4743538">ErrInvalidEscape</a></span><span class="op" id="4775950">,</span>&nbsp;<span class="ident" id="4775952"><a href="/regexp/syntax/parse.go.html#4773543">s</a></span><span class="op" id="4775953">[</span><span class="op" id="4775954">:</span><span class="builtinfunc" id="4775955">len</span><span class="op" id="4775958">(</span><span class="ident" id="4775959"><a href="/regexp/syntax/parse.go.html#4773543">s</a></span><span class="op" id="4775960">)</span><span class="op" id="4775961">-</span><span class="builtinfunc" id="4775962">len</span><span class="op" id="4775965">(</span><span class="ident" id="4775966"><a href="/regexp/syntax/parse.go.html#4773589">t</a></span><span class="op" id="4775967">)</span><span class="op" id="4775968">]</span><span class="op" id="4775969">}</span><br>
<span class="lineno"></span><span class="op" id="4775971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4775974">//&nbsp;parseClassChar&nbsp;parses&nbsp;a&nbsp;character&nbsp;class&nbsp;character&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s</span><br>
<span class="lineno">1345</span><span class="comment" id="4776049">//&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4776068">func</span>&nbsp;<span class="op" id="4776073">(</span><span class="ident" id="4776074">p</span>&nbsp;<span class="op" id="4776076">*</span><span class="ident" id="4776077"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4776083">)</span>&nbsp;<span class="ident" id="4776085">parseClassChar</span><span class="op" id="4776099">(</span><span class="ident" id="4776100">s</span><span class="op" id="4776101">,</span>&nbsp;<span class="ident" id="4776103">wholeClass</span>&nbsp;<span class="builtintype" id="4776114">string</span><span class="op" id="4776120">)</span>&nbsp;<span class="op" id="4776122">(</span><span class="ident" id="4776123">r</span>&nbsp;<span class="builtintype" id="4776125">rune</span><span class="op" id="4776129">,</span>&nbsp;<span class="ident" id="4776131">rest</span>&nbsp;<span class="builtintype" id="4776136">string</span><span class="op" id="4776142">,</span>&nbsp;<span class="ident" id="4776144">err</span>&nbsp;<span class="builtintype" id="4776148">error</span><span class="op" id="4776153">)</span>&nbsp;<span class="op" id="4776155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776158">if</span>&nbsp;<span class="ident" id="4776161"><a href="/regexp/syntax/parse.go.html#4776100">s</a></span>&nbsp;<span class="op" id="4776163">==</span>&nbsp;<span class="string" id="4776166">&#34;&#34;</span>&nbsp;<span class="op" id="4776169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776173">return</span>&nbsp;<span class="num" id="4776180">0</span><span class="op" id="4776181">,</span>&nbsp;<span class="string" id="4776183">&#34;&#34;</span><span class="op" id="4776185">,</span>&nbsp;<span class="op" id="4776187">&amp;</span><span class="ident" id="4776188"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4776193">{</span><span class="ident" id="4776194">Code</span><span class="op" id="4776198">:</span>&nbsp;<span class="ident" id="4776200"><a href="/regexp/syntax/parse.go.html#4743929">ErrMissingBracket</a></span><span class="op" id="4776217">,</span>&nbsp;<span class="ident" id="4776219">Expr</span><span class="op" id="4776223">:</span>&nbsp;<span class="ident" id="4776225"><a href="/regexp/syntax/parse.go.html#4776103">wholeClass</a></span><span class="op" id="4776235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4776238">}</span><br>
<span class="lineno">1350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4776242">//&nbsp;Allow&nbsp;regular&nbsp;escape&nbsp;sequences&nbsp;even&nbsp;though</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4776289">//&nbsp;many&nbsp;need&nbsp;not&nbsp;be&nbsp;escaped&nbsp;in&nbsp;this&nbsp;context.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776335">if</span>&nbsp;<span class="ident" id="4776338"><a href="/regexp/syntax/parse.go.html#4776100">s</a></span><span class="op" id="4776339">[</span><span class="num" id="4776340">0</span><span class="op" id="4776341">]</span>&nbsp;<span class="op" id="4776343">==</span>&nbsp;<span class="string" id="4776346">&#39;\\&#39;</span>&nbsp;<span class="op" id="4776351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776355">return</span>&nbsp;<span class="ident" id="4776362"><a href="/regexp/syntax/parse.go.html#4776074">p</a></span><span class="op" id="4776363">.</span><span class="ident" id="4776364">parseEscape</span><span class="op" id="4776375">(</span><span class="ident" id="4776376"><a href="/regexp/syntax/parse.go.html#4776100">s</a></span><span class="op" id="4776377">)</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4776380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776384">return</span>&nbsp;<span class="ident" id="4776391"><a href="/regexp/syntax/parse.go.html#4788999">nextRune</a></span><span class="op" id="4776399">(</span><span class="ident" id="4776400"><a href="/regexp/syntax/parse.go.html#4776100">s</a></span><span class="op" id="4776401">)</span><br>
<span class="lineno"></span><span class="op" id="4776403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span><span class="keyword" id="4776406">type</span>&nbsp;<span class="ident" id="4776411">charGroup</span>&nbsp;<span class="keyword" id="4776421">struct</span>&nbsp;<span class="op" id="4776428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4776431">sign</span>&nbsp;&nbsp;<span class="builtintype" id="4776437">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4776442">class</span>&nbsp;<span class="op" id="4776448">[</span><span class="op" id="4776449">]</span><span class="builtintype" id="4776450">rune</span><br>
<span class="lineno"></span><span class="op" id="4776455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1365</span><span class="comment" id="4776458">//&nbsp;parsePerlClassEscape&nbsp;parses&nbsp;a&nbsp;leading&nbsp;Perl&nbsp;character&nbsp;class&nbsp;escape&nbsp;like&nbsp;\d</span><br>
<span class="lineno"></span><span class="comment" id="4776535">//&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;one&nbsp;is&nbsp;present,&nbsp;it&nbsp;appends&nbsp;the&nbsp;characters&nbsp;to&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="4776614">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;slice&nbsp;r&nbsp;and&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4776678">func</span>&nbsp;<span class="op" id="4776683">(</span><span class="ident" id="4776684">p</span>&nbsp;<span class="op" id="4776686">*</span><span class="ident" id="4776687"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4776693">)</span>&nbsp;<span class="ident" id="4776695">parsePerlClassEscape</span><span class="op" id="4776715">(</span><span class="ident" id="4776716">s</span>&nbsp;<span class="builtintype" id="4776718">string</span><span class="op" id="4776724">,</span>&nbsp;<span class="ident" id="4776726">r</span>&nbsp;<span class="op" id="4776728">[</span><span class="op" id="4776729">]</span><span class="builtintype" id="4776730">rune</span><span class="op" id="4776734">)</span>&nbsp;<span class="op" id="4776736">(</span><span class="ident" id="4776737">out</span>&nbsp;<span class="op" id="4776741">[</span><span class="op" id="4776742">]</span><span class="builtintype" id="4776743">rune</span><span class="op" id="4776747">,</span>&nbsp;<span class="ident" id="4776749">rest</span>&nbsp;<span class="builtintype" id="4776754">string</span><span class="op" id="4776760">)</span>&nbsp;<span class="op" id="4776762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776765">if</span>&nbsp;<span class="ident" id="4776768"><a href="/regexp/syntax/parse.go.html#4776684">p</a></span><span class="op" id="4776769">.</span><span class="ident" id="4776770">flags</span><span class="op" id="4776775">&amp;</span><span class="ident" id="4776776"><a href="/regexp/syntax/parse.go.html#4744908">PerlX</a></span>&nbsp;<span class="op" id="4776782">==</span>&nbsp;<span class="num" id="4776785">0</span>&nbsp;<span class="op" id="4776787">||</span>&nbsp;<span class="builtinfunc" id="4776790">len</span><span class="op" id="4776793">(</span><span class="ident" id="4776794"><a href="/regexp/syntax/parse.go.html#4776716">s</a></span><span class="op" id="4776795">)</span>&nbsp;<span class="op" id="4776797">&lt;</span>&nbsp;<span class="num" id="4776799">2</span>&nbsp;<span class="op" id="4776801">||</span>&nbsp;<span class="ident" id="4776804"><a href="/regexp/syntax/parse.go.html#4776716">s</a></span><span class="op" id="4776805">[</span><span class="num" id="4776806">0</span><span class="op" id="4776807">]</span>&nbsp;<span class="op" id="4776809">!=</span>&nbsp;<span class="string" id="4776812">&#39;\\&#39;</span>&nbsp;<span class="op" id="4776817">{</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776821">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4776829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4776832">g</span>&nbsp;<span class="op" id="4776834">:=</span>&nbsp;<span class="ident" id="4776837"><a href="/regexp/syntax/perl_groups.go.html#4789978">perlGroup</a></span><span class="op" id="4776846">[</span><span class="ident" id="4776847"><a href="/regexp/syntax/parse.go.html#4776716">s</a></span><span class="op" id="4776848">[</span><span class="num" id="4776849">0</span><span class="op" id="4776850">:</span><span class="num" id="4776851">2</span><span class="op" id="4776852">]</span><span class="op" id="4776853">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776856">if</span>&nbsp;<span class="ident" id="4776859"><a href="/regexp/syntax/parse.go.html#4776832">g</a></span><span class="op" id="4776860">.</span><span class="ident" id="4776861">sign</span>&nbsp;<span class="op" id="4776866">==</span>&nbsp;<span class="num" id="4776869">0</span>&nbsp;<span class="op" id="4776871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776875">return</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4776883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776886">return</span>&nbsp;<span class="ident" id="4776893"><a href="/regexp/syntax/parse.go.html#4776684">p</a></span><span class="op" id="4776894">.</span><span class="ident" id="4776895">appendGroup</span><span class="op" id="4776906">(</span><span class="ident" id="4776907"><a href="/regexp/syntax/parse.go.html#4776726">r</a></span><span class="op" id="4776908">,</span>&nbsp;<span class="ident" id="4776910"><a href="/regexp/syntax/parse.go.html#4776832">g</a></span><span class="op" id="4776911">)</span><span class="op" id="4776912">,</span>&nbsp;<span class="ident" id="4776914"><a href="/regexp/syntax/parse.go.html#4776716">s</a></span><span class="op" id="4776915">[</span><span class="num" id="4776916">2</span><span class="op" id="4776917">:</span><span class="op" id="4776918">]</span><br>
<span class="lineno"></span><span class="op" id="4776920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4776923">//&nbsp;parseNamedClass&nbsp;parses&nbsp;a&nbsp;leading&nbsp;POSIX&nbsp;named&nbsp;character&nbsp;class&nbsp;like&nbsp;[:alnum:]</span><br>
<span class="lineno">1380</span><span class="comment" id="4777002">//&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;one&nbsp;is&nbsp;present,&nbsp;it&nbsp;appends&nbsp;the&nbsp;characters&nbsp;to&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="4777081">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;slice&nbsp;r&nbsp;and&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4777145">func</span>&nbsp;<span class="op" id="4777150">(</span><span class="ident" id="4777151">p</span>&nbsp;<span class="op" id="4777153">*</span><span class="ident" id="4777154"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4777160">)</span>&nbsp;<span class="ident" id="4777162">parseNamedClass</span><span class="op" id="4777177">(</span><span class="ident" id="4777178">s</span>&nbsp;<span class="builtintype" id="4777180">string</span><span class="op" id="4777186">,</span>&nbsp;<span class="ident" id="4777188">r</span>&nbsp;<span class="op" id="4777190">[</span><span class="op" id="4777191">]</span><span class="builtintype" id="4777192">rune</span><span class="op" id="4777196">)</span>&nbsp;<span class="op" id="4777198">(</span><span class="ident" id="4777199">out</span>&nbsp;<span class="op" id="4777203">[</span><span class="op" id="4777204">]</span><span class="builtintype" id="4777205">rune</span><span class="op" id="4777209">,</span>&nbsp;<span class="ident" id="4777211">rest</span>&nbsp;<span class="builtintype" id="4777216">string</span><span class="op" id="4777222">,</span>&nbsp;<span class="ident" id="4777224">err</span>&nbsp;<span class="builtintype" id="4777228">error</span><span class="op" id="4777233">)</span>&nbsp;<span class="op" id="4777235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777238">if</span>&nbsp;<span class="builtinfunc" id="4777241">len</span><span class="op" id="4777244">(</span><span class="ident" id="4777245"><a href="/regexp/syntax/parse.go.html#4777178">s</a></span><span class="op" id="4777246">)</span>&nbsp;<span class="op" id="4777248">&lt;</span>&nbsp;<span class="num" id="4777250">2</span>&nbsp;<span class="op" id="4777252">||</span>&nbsp;<span class="ident" id="4777255"><a href="/regexp/syntax/parse.go.html#4777178">s</a></span><span class="op" id="4777256">[</span><span class="num" id="4777257">0</span><span class="op" id="4777258">]</span>&nbsp;<span class="op" id="4777260">!=</span>&nbsp;<span class="string" id="4777263">&#39;[&#39;</span>&nbsp;<span class="op" id="4777267">||</span>&nbsp;<span class="ident" id="4777270"><a href="/regexp/syntax/parse.go.html#4777178">s</a></span><span class="op" id="4777271">[</span><span class="num" id="4777272">1</span><span class="op" id="4777273">]</span>&nbsp;<span class="op" id="4777275">!=</span>&nbsp;<span class="string" id="4777278">&#39;:&#39;</span>&nbsp;<span class="op" id="4777282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777286">return</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777298">i</span>&nbsp;<span class="op" id="4777300">:=</span>&nbsp;<span class="ident" id="4777303"><a href="/regexp/syntax/parse.go.html#4742901">strings</a></span><span class="op" id="4777310">.</span><span class="ident" id="4777311">Index</span><span class="op" id="4777316">(</span><span class="ident" id="4777317"><a href="/regexp/syntax/parse.go.html#4777178">s</a></span><span class="op" id="4777318">[</span><span class="num" id="4777319">2</span><span class="op" id="4777320">:</span><span class="op" id="4777321">]</span><span class="op" id="4777322">,</span>&nbsp;<span class="string" id="4777324">&#34;:]&#34;</span><span class="op" id="4777328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777331">if</span>&nbsp;<span class="ident" id="4777334"><a href="/regexp/syntax/parse.go.html#4777298">i</a></span>&nbsp;<span class="op" id="4777336">&lt;</span>&nbsp;<span class="num" id="4777338">0</span>&nbsp;<span class="op" id="4777340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777344">return</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777355"><a href="/regexp/syntax/parse.go.html#4777298">i</a></span>&nbsp;<span class="op" id="4777357">+=</span>&nbsp;<span class="num" id="4777360">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777363">name</span><span class="op" id="4777367">,</span>&nbsp;<span class="ident" id="4777369"><a href="/regexp/syntax/parse.go.html#4777178">s</a></span>&nbsp;<span class="op" id="4777371">:=</span>&nbsp;<span class="ident" id="4777374"><a href="/regexp/syntax/parse.go.html#4777178">s</a></span><span class="op" id="4777375">[</span><span class="num" id="4777376">0</span><span class="op" id="4777377">:</span><span class="ident" id="4777378"><a href="/regexp/syntax/parse.go.html#4777298">i</a></span><span class="op" id="4777379">+</span><span class="num" id="4777380">2</span><span class="op" id="4777381">]</span><span class="op" id="4777382">,</span>&nbsp;<span class="ident" id="4777384"><a href="/regexp/syntax/parse.go.html#4777178">s</a></span><span class="op" id="4777385">[</span><span class="ident" id="4777386"><a href="/regexp/syntax/parse.go.html#4777298">i</a></span><span class="op" id="4777387">+</span><span class="num" id="4777388">2</span><span class="op" id="4777389">:</span><span class="op" id="4777390">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777393">g</span>&nbsp;<span class="op" id="4777395">:=</span>&nbsp;<span class="ident" id="4777398"><a href="/regexp/syntax/perl_groups.go.html#4791050">posixGroup</a></span><span class="op" id="4777408">[</span><span class="ident" id="4777409"><a href="/regexp/syntax/parse.go.html#4777363">name</a></span><span class="op" id="4777413">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777416">if</span>&nbsp;<span class="ident" id="4777419"><a href="/regexp/syntax/parse.go.html#4777393">g</a></span><span class="op" id="4777420">.</span><span class="ident" id="4777421">sign</span>&nbsp;<span class="op" id="4777426">==</span>&nbsp;<span class="num" id="4777429">0</span>&nbsp;<span class="op" id="4777431">{</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777435">return</span>&nbsp;<span class="ident" id="4777442">nil</span><span class="op" id="4777445">,</span>&nbsp;<span class="string" id="4777447">&#34;&#34;</span><span class="op" id="4777449">,</span>&nbsp;<span class="op" id="4777451">&amp;</span><span class="ident" id="4777452"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4777457">{</span><span class="ident" id="4777458"><a href="/regexp/syntax/parse.go.html#4743468">ErrInvalidCharRange</a></span><span class="op" id="4777477">,</span>&nbsp;<span class="ident" id="4777479"><a href="/regexp/syntax/parse.go.html#4777363">name</a></span><span class="op" id="4777483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777489">return</span>&nbsp;<span class="ident" id="4777496"><a href="/regexp/syntax/parse.go.html#4777151">p</a></span><span class="op" id="4777497">.</span><span class="ident" id="4777498">appendGroup</span><span class="op" id="4777509">(</span><span class="ident" id="4777510"><a href="/regexp/syntax/parse.go.html#4777188">r</a></span><span class="op" id="4777511">,</span>&nbsp;<span class="ident" id="4777513"><a href="/regexp/syntax/parse.go.html#4777393">g</a></span><span class="op" id="4777514">)</span><span class="op" id="4777515">,</span>&nbsp;<span class="ident" id="4777517"><a href="/regexp/syntax/parse.go.html#4777178">s</a></span><span class="op" id="4777518">,</span>&nbsp;<span class="ident" id="4777520">nil</span><br>
<span class="lineno"></span><span class="op" id="4777524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span><span class="keyword" id="4777527">func</span>&nbsp;<span class="op" id="4777532">(</span><span class="ident" id="4777533">p</span>&nbsp;<span class="op" id="4777535">*</span><span class="ident" id="4777536"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4777542">)</span>&nbsp;<span class="ident" id="4777544">appendGroup</span><span class="op" id="4777555">(</span><span class="ident" id="4777556">r</span>&nbsp;<span class="op" id="4777558">[</span><span class="op" id="4777559">]</span><span class="builtintype" id="4777560">rune</span><span class="op" id="4777564">,</span>&nbsp;<span class="ident" id="4777566">g</span>&nbsp;<span class="ident" id="4777568"><a href="/regexp/syntax/parse.go.html#4776411">charGroup</a></span><span class="op" id="4777577">)</span>&nbsp;<span class="op" id="4777579">[</span><span class="op" id="4777580">]</span><span class="builtintype" id="4777581">rune</span>&nbsp;<span class="op" id="4777586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777589">if</span>&nbsp;<span class="ident" id="4777592"><a href="/regexp/syntax/parse.go.html#4777533">p</a></span><span class="op" id="4777593">.</span><span class="ident" id="4777594">flags</span><span class="op" id="4777599">&amp;</span><span class="ident" id="4777600"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span>&nbsp;<span class="op" id="4777609">==</span>&nbsp;<span class="num" id="4777612">0</span>&nbsp;<span class="op" id="4777614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777618">if</span>&nbsp;<span class="ident" id="4777621"><a href="/regexp/syntax/parse.go.html#4777566">g</a></span><span class="op" id="4777622">.</span><span class="ident" id="4777623">sign</span>&nbsp;<span class="op" id="4777628">&lt;</span>&nbsp;<span class="num" id="4777630">0</span>&nbsp;<span class="op" id="4777632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777637"><a href="/regexp/syntax/parse.go.html#4777556">r</a></span>&nbsp;<span class="op" id="4777639">=</span>&nbsp;<span class="ident" id="4777641"><a href="/regexp/syntax/parse.go.html#4785817">appendNegatedClass</a></span><span class="op" id="4777659">(</span><span class="ident" id="4777660"><a href="/regexp/syntax/parse.go.html#4777556">r</a></span><span class="op" id="4777661">,</span>&nbsp;<span class="ident" id="4777663"><a href="/regexp/syntax/parse.go.html#4777566">g</a></span><span class="op" id="4777664">.</span><span class="ident" id="4777665">class</span><span class="op" id="4777670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777674">}</span>&nbsp;<span class="keyword" id="4777676">else</span>&nbsp;<span class="op" id="4777681">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777686"><a href="/regexp/syntax/parse.go.html#4777556">r</a></span>&nbsp;<span class="op" id="4777688">=</span>&nbsp;<span class="ident" id="4777690"><a href="/regexp/syntax/parse.go.html#4785323">appendClass</a></span><span class="op" id="4777701">(</span><span class="ident" id="4777702"><a href="/regexp/syntax/parse.go.html#4777556">r</a></span><span class="op" id="4777703">,</span>&nbsp;<span class="ident" id="4777705"><a href="/regexp/syntax/parse.go.html#4777566">g</a></span><span class="op" id="4777706">.</span><span class="ident" id="4777707">class</span><span class="op" id="4777712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777719">}</span>&nbsp;<span class="keyword" id="4777721">else</span>&nbsp;<span class="op" id="4777726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777730">tmp</span>&nbsp;<span class="op" id="4777734">:=</span>&nbsp;<span class="ident" id="4777737"><a href="/regexp/syntax/parse.go.html#4777533">p</a></span><span class="op" id="4777738">.</span><span class="ident" id="4777739">tmpClass</span><span class="op" id="4777747">[</span><span class="op" id="4777748">:</span><span class="num" id="4777749">0</span><span class="op" id="4777750">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777754"><a href="/regexp/syntax/parse.go.html#4777730">tmp</a></span>&nbsp;<span class="op" id="4777758">=</span>&nbsp;<span class="ident" id="4777760"><a href="/regexp/syntax/parse.go.html#4785550">appendFoldedClass</a></span><span class="op" id="4777777">(</span><span class="ident" id="4777778"><a href="/regexp/syntax/parse.go.html#4777730">tmp</a></span><span class="op" id="4777781">,</span>&nbsp;<span class="ident" id="4777783"><a href="/regexp/syntax/parse.go.html#4777566">g</a></span><span class="op" id="4777784">.</span><span class="ident" id="4777785">class</span><span class="op" id="4777790">)</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777794"><a href="/regexp/syntax/parse.go.html#4777533">p</a></span><span class="op" id="4777795">.</span><span class="ident" id="4777796">tmpClass</span>&nbsp;<span class="op" id="4777805">=</span>&nbsp;<span class="ident" id="4777807"><a href="/regexp/syntax/parse.go.html#4777730">tmp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777813"><a href="/regexp/syntax/parse.go.html#4777730">tmp</a></span>&nbsp;<span class="op" id="4777817">=</span>&nbsp;<span class="ident" id="4777819"><a href="/regexp/syntax/parse.go.html#4782865">cleanClass</a></span><span class="op" id="4777829">(</span><span class="op" id="4777830">&amp;</span><span class="ident" id="4777831"><a href="/regexp/syntax/parse.go.html#4777533">p</a></span><span class="op" id="4777832">.</span><span class="ident" id="4777833">tmpClass</span><span class="op" id="4777841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777845">if</span>&nbsp;<span class="ident" id="4777848"><a href="/regexp/syntax/parse.go.html#4777566">g</a></span><span class="op" id="4777849">.</span><span class="ident" id="4777850">sign</span>&nbsp;<span class="op" id="4777855">&lt;</span>&nbsp;<span class="num" id="4777857">0</span>&nbsp;<span class="op" id="4777859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777864"><a href="/regexp/syntax/parse.go.html#4777556">r</a></span>&nbsp;<span class="op" id="4777866">=</span>&nbsp;<span class="ident" id="4777868"><a href="/regexp/syntax/parse.go.html#4785817">appendNegatedClass</a></span><span class="op" id="4777886">(</span><span class="ident" id="4777887"><a href="/regexp/syntax/parse.go.html#4777556">r</a></span><span class="op" id="4777888">,</span>&nbsp;<span class="ident" id="4777890"><a href="/regexp/syntax/parse.go.html#4777730">tmp</a></span><span class="op" id="4777893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777897">}</span>&nbsp;<span class="keyword" id="4777899">else</span>&nbsp;<span class="op" id="4777904">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777909"><a href="/regexp/syntax/parse.go.html#4777556">r</a></span>&nbsp;<span class="op" id="4777911">=</span>&nbsp;<span class="ident" id="4777913"><a href="/regexp/syntax/parse.go.html#4785323">appendClass</a></span><span class="op" id="4777924">(</span><span class="ident" id="4777925"><a href="/regexp/syntax/parse.go.html#4777556">r</a></span><span class="op" id="4777926">,</span>&nbsp;<span class="ident" id="4777928"><a href="/regexp/syntax/parse.go.html#4777730">tmp</a></span><span class="op" id="4777931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777941">return</span>&nbsp;<span class="ident" id="4777948"><a href="/regexp/syntax/parse.go.html#4777556">r</a></span><br>
<span class="lineno"></span><span class="op" id="4777950">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span><span class="keyword" id="4777953">var</span>&nbsp;<span class="ident" id="4777957">anyTable</span>&nbsp;<span class="op" id="4777966">=</span>&nbsp;<span class="op" id="4777968">&amp;</span><span class="ident" id="4777969"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4777976">.</span><span class="ident" id="4777977">RangeTable</span><span class="op" id="4777987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777990">R16</span><span class="op" id="4777993">:</span>&nbsp;<span class="op" id="4777995">[</span><span class="op" id="4777996">]</span><span class="ident" id="4777997"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4778004">.</span><span class="ident" id="4778005">Range16</span><span class="op" id="4778012">{</span><span class="op" id="4778013">{</span><span class="ident" id="4778014">Lo</span><span class="op" id="4778016">:</span>&nbsp;<span class="num" id="4778018">0</span><span class="op" id="4778019">,</span>&nbsp;<span class="ident" id="4778021">Hi</span><span class="op" id="4778023">:</span>&nbsp;<span class="num" id="4778025">1</span><span class="op" id="4778026">&lt;&lt;</span><span class="num" id="4778028">16</span>&nbsp;<span class="op" id="4778031">-</span>&nbsp;<span class="num" id="4778033">1</span><span class="op" id="4778034">,</span>&nbsp;<span class="ident" id="4778036">Stride</span><span class="op" id="4778042">:</span>&nbsp;<span class="num" id="4778044">1</span><span class="op" id="4778045">}</span><span class="op" id="4778046">}</span><span class="op" id="4778047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778050">R32</span><span class="op" id="4778053">:</span>&nbsp;<span class="op" id="4778055">[</span><span class="op" id="4778056">]</span><span class="ident" id="4778057"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4778064">.</span><span class="ident" id="4778065">Range32</span><span class="op" id="4778072">{</span><span class="op" id="4778073">{</span><span class="ident" id="4778074">Lo</span><span class="op" id="4778076">:</span>&nbsp;<span class="num" id="4778078">1</span>&nbsp;<span class="op" id="4778080">&lt;&lt;</span>&nbsp;<span class="num" id="4778083">16</span><span class="op" id="4778085">,</span>&nbsp;<span class="ident" id="4778087">Hi</span><span class="op" id="4778089">:</span>&nbsp;<span class="ident" id="4778091"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4778098">.</span><span class="ident" id="4778099">MaxRune</span><span class="op" id="4778106">,</span>&nbsp;<span class="ident" id="4778108">Stride</span><span class="op" id="4778114">:</span>&nbsp;<span class="num" id="4778116">1</span><span class="op" id="4778117">}</span><span class="op" id="4778118">}</span><span class="op" id="4778119">,</span><br>
<span class="lineno"></span><span class="op" id="4778121">}</span><br>
<span class="lineno">1425</span><br>
<span class="lineno"></span><span class="comment" id="4778124">//&nbsp;unicodeTable&nbsp;returns&nbsp;the&nbsp;unicode.RangeTable&nbsp;identified&nbsp;by&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="4778190">//&nbsp;and&nbsp;the&nbsp;table&nbsp;of&nbsp;additional&nbsp;fold-equivalent&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="4778250">func</span>&nbsp;<span class="ident" id="4778255">unicodeTable</span><span class="op" id="4778267">(</span><span class="ident" id="4778268">name</span>&nbsp;<span class="builtintype" id="4778273">string</span><span class="op" id="4778279">)</span>&nbsp;<span class="op" id="4778281">(</span><span class="op" id="4778282">*</span><span class="ident" id="4778283"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4778290">.</span><span class="ident" id="4778291">RangeTable</span><span class="op" id="4778301">,</span>&nbsp;<span class="op" id="4778303">*</span><span class="ident" id="4778304"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4778311">.</span><span class="ident" id="4778312">RangeTable</span><span class="op" id="4778322">)</span>&nbsp;<span class="op" id="4778324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4778327">//&nbsp;Special&nbsp;case:&nbsp;&#34;Any&#34;&nbsp;means&nbsp;any.</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778362">if</span>&nbsp;<span class="ident" id="4778365"><a href="/regexp/syntax/parse.go.html#4778268">name</a></span>&nbsp;<span class="op" id="4778370">==</span>&nbsp;<span class="string" id="4778373">&#34;Any&#34;</span>&nbsp;<span class="op" id="4778379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778383">return</span>&nbsp;<span class="ident" id="4778390"><a href="/regexp/syntax/parse.go.html#4777957">anyTable</a></span><span class="op" id="4778398">,</span>&nbsp;<span class="ident" id="4778400"><a href="/regexp/syntax/parse.go.html#4777957">anyTable</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4778410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778413">if</span>&nbsp;<span class="ident" id="4778416">t</span>&nbsp;<span class="op" id="4778418">:=</span>&nbsp;<span class="ident" id="4778421"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4778428">.</span><span class="ident" id="4778429">Categories</span><span class="op" id="4778439">[</span><span class="ident" id="4778440"><a href="/regexp/syntax/parse.go.html#4778268">name</a></span><span class="op" id="4778444">]</span><span class="op" id="4778445">;</span>&nbsp;<span class="ident" id="4778447"><a href="/regexp/syntax/parse.go.html#4778416">t</a></span>&nbsp;<span class="op" id="4778449">!=</span>&nbsp;<span class="ident" id="4778452">nil</span>&nbsp;<span class="op" id="4778456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778460">return</span>&nbsp;<span class="ident" id="4778467"><a href="/regexp/syntax/parse.go.html#4778416">t</a></span><span class="op" id="4778468">,</span>&nbsp;<span class="ident" id="4778470"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4778477">.</span><span class="ident" id="4778478">FoldCategory</span><span class="op" id="4778490">[</span><span class="ident" id="4778491"><a href="/regexp/syntax/parse.go.html#4778268">name</a></span><span class="op" id="4778495">]</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4778498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778501">if</span>&nbsp;<span class="ident" id="4778504">t</span>&nbsp;<span class="op" id="4778506">:=</span>&nbsp;<span class="ident" id="4778509"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4778516">.</span><span class="ident" id="4778517">Scripts</span><span class="op" id="4778524">[</span><span class="ident" id="4778525"><a href="/regexp/syntax/parse.go.html#4778268">name</a></span><span class="op" id="4778529">]</span><span class="op" id="4778530">;</span>&nbsp;<span class="ident" id="4778532"><a href="/regexp/syntax/parse.go.html#4778504">t</a></span>&nbsp;<span class="op" id="4778534">!=</span>&nbsp;<span class="ident" id="4778537">nil</span>&nbsp;<span class="op" id="4778541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778545">return</span>&nbsp;<span class="ident" id="4778552"><a href="/regexp/syntax/parse.go.html#4778504">t</a></span><span class="op" id="4778553">,</span>&nbsp;<span class="ident" id="4778555"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4778562">.</span><span class="ident" id="4778563">FoldScript</span><span class="op" id="4778573">[</span><span class="ident" id="4778574"><a href="/regexp/syntax/parse.go.html#4778268">name</a></span><span class="op" id="4778578">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4778581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778584">return</span>&nbsp;<span class="ident" id="4778591">nil</span><span class="op" id="4778594">,</span>&nbsp;<span class="ident" id="4778596">nil</span><br>
<span class="lineno">1440</span><span class="op" id="4778600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4778603">//&nbsp;parseUnicodeClass&nbsp;parses&nbsp;a&nbsp;leading&nbsp;Unicode&nbsp;character&nbsp;class&nbsp;like&nbsp;\p{Han}</span><br>
<span class="lineno"></span><span class="comment" id="4778678">//&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;one&nbsp;is&nbsp;present,&nbsp;it&nbsp;appends&nbsp;the&nbsp;characters&nbsp;to&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="4778757">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;slice&nbsp;r&nbsp;and&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno">1445</span><span class="keyword" id="4778821">func</span>&nbsp;<span class="op" id="4778826">(</span><span class="ident" id="4778827">p</span>&nbsp;<span class="op" id="4778829">*</span><span class="ident" id="4778830"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4778836">)</span>&nbsp;<span class="ident" id="4778838">parseUnicodeClass</span><span class="op" id="4778855">(</span><span class="ident" id="4778856">s</span>&nbsp;<span class="builtintype" id="4778858">string</span><span class="op" id="4778864">,</span>&nbsp;<span class="ident" id="4778866">r</span>&nbsp;<span class="op" id="4778868">[</span><span class="op" id="4778869">]</span><span class="builtintype" id="4778870">rune</span><span class="op" id="4778874">)</span>&nbsp;<span class="op" id="4778876">(</span><span class="ident" id="4778877">out</span>&nbsp;<span class="op" id="4778881">[</span><span class="op" id="4778882">]</span><span class="builtintype" id="4778883">rune</span><span class="op" id="4778887">,</span>&nbsp;<span class="ident" id="4778889">rest</span>&nbsp;<span class="builtintype" id="4778894">string</span><span class="op" id="4778900">,</span>&nbsp;<span class="ident" id="4778902">err</span>&nbsp;<span class="builtintype" id="4778906">error</span><span class="op" id="4778911">)</span>&nbsp;<span class="op" id="4778913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778916">if</span>&nbsp;<span class="ident" id="4778919"><a href="/regexp/syntax/parse.go.html#4778827">p</a></span><span class="op" id="4778920">.</span><span class="ident" id="4778921">flags</span><span class="op" id="4778926">&amp;</span><span class="ident" id="4778927"><a href="/regexp/syntax/parse.go.html#4744966">UnicodeGroups</a></span>&nbsp;<span class="op" id="4778941">==</span>&nbsp;<span class="num" id="4778944">0</span>&nbsp;<span class="op" id="4778946">||</span>&nbsp;<span class="builtinfunc" id="4778949">len</span><span class="op" id="4778952">(</span><span class="ident" id="4778953"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4778954">)</span>&nbsp;<span class="op" id="4778956">&lt;</span>&nbsp;<span class="num" id="4778958">2</span>&nbsp;<span class="op" id="4778960">||</span>&nbsp;<span class="ident" id="4778963"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4778964">[</span><span class="num" id="4778965">0</span><span class="op" id="4778966">]</span>&nbsp;<span class="op" id="4778968">!=</span>&nbsp;<span class="string" id="4778971">&#39;\\&#39;</span>&nbsp;<span class="op" id="4778976">||</span>&nbsp;<span class="ident" id="4778979"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4778980">[</span><span class="num" id="4778981">1</span><span class="op" id="4778982">]</span>&nbsp;<span class="op" id="4778984">!=</span>&nbsp;<span class="string" id="4778987">&#39;p&#39;</span>&nbsp;<span class="op" id="4778991">&amp;&amp;</span>&nbsp;<span class="ident" id="4778994"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4778995">[</span><span class="num" id="4778996">1</span><span class="op" id="4778997">]</span>&nbsp;<span class="op" id="4778999">!=</span>&nbsp;<span class="string" id="4779002">&#39;P&#39;</span>&nbsp;<span class="op" id="4779006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779010">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4779022">//&nbsp;Committed&nbsp;to&nbsp;parse&nbsp;or&nbsp;return&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779062">sign</span>&nbsp;<span class="op" id="4779067">:=</span>&nbsp;<span class="op" id="4779070">+</span><span class="num" id="4779071">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779074">if</span>&nbsp;<span class="ident" id="4779077"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4779078">[</span><span class="num" id="4779079">1</span><span class="op" id="4779080">]</span>&nbsp;<span class="op" id="4779082">==</span>&nbsp;<span class="string" id="4779085">&#39;P&#39;</span>&nbsp;<span class="op" id="4779089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779093"><a href="/regexp/syntax/parse.go.html#4779062">sign</a></span>&nbsp;<span class="op" id="4779098">=</span>&nbsp;<span class="op" id="4779100">-</span><span class="num" id="4779101">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779104">}</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779107">t</span>&nbsp;<span class="op" id="4779109">:=</span>&nbsp;<span class="ident" id="4779112"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4779113">[</span><span class="num" id="4779114">2</span><span class="op" id="4779115">:</span><span class="op" id="4779116">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779119">c</span><span class="op" id="4779120">,</span>&nbsp;<span class="ident" id="4779122"><a href="/regexp/syntax/parse.go.html#4779107">t</a></span><span class="op" id="4779123">,</span>&nbsp;<span class="ident" id="4779125"><a href="/regexp/syntax/parse.go.html#4778902">err</a></span>&nbsp;<span class="op" id="4779129">:=</span>&nbsp;<span class="ident" id="4779132"><a href="/regexp/syntax/parse.go.html#4788999">nextRune</a></span><span class="op" id="4779140">(</span><span class="ident" id="4779141"><a href="/regexp/syntax/parse.go.html#4779107">t</a></span><span class="op" id="4779142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779145">if</span>&nbsp;<span class="ident" id="4779148"><a href="/regexp/syntax/parse.go.html#4778902">err</a></span>&nbsp;<span class="op" id="4779152">!=</span>&nbsp;<span class="ident" id="4779155">nil</span>&nbsp;<span class="op" id="4779159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779163">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779171">}</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779174">var</span>&nbsp;<span class="ident" id="4779178">seq</span><span class="op" id="4779181">,</span>&nbsp;<span class="ident" id="4779183">name</span>&nbsp;<span class="builtintype" id="4779188">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779196">if</span>&nbsp;<span class="ident" id="4779199"><a href="/regexp/syntax/parse.go.html#4779119">c</a></span>&nbsp;<span class="op" id="4779201">!=</span>&nbsp;<span class="string" id="4779204">&#39;{&#39;</span>&nbsp;<span class="op" id="4779208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4779212">//&nbsp;Single-letter&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779237"><a href="/regexp/syntax/parse.go.html#4779178">seq</a></span>&nbsp;<span class="op" id="4779241">=</span>&nbsp;<span class="ident" id="4779243"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4779244">[</span><span class="op" id="4779245">:</span><span class="builtinfunc" id="4779246">len</span><span class="op" id="4779249">(</span><span class="ident" id="4779250"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4779251">)</span><span class="op" id="4779252">-</span><span class="builtinfunc" id="4779253">len</span><span class="op" id="4779256">(</span><span class="ident" id="4779257"><a href="/regexp/syntax/parse.go.html#4779107">t</a></span><span class="op" id="4779258">)</span><span class="op" id="4779259">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779263"><a href="/regexp/syntax/parse.go.html#4779183">name</a></span>&nbsp;<span class="op" id="4779268">=</span>&nbsp;<span class="ident" id="4779270"><a href="/regexp/syntax/parse.go.html#4779178">seq</a></span><span class="op" id="4779273">[</span><span class="num" id="4779274">2</span><span class="op" id="4779275">:</span><span class="op" id="4779276">]</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779279">}</span>&nbsp;<span class="keyword" id="4779281">else</span>&nbsp;<span class="op" id="4779286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4779290">//&nbsp;Name&nbsp;is&nbsp;in&nbsp;braces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779314">end</span>&nbsp;<span class="op" id="4779318">:=</span>&nbsp;<span class="ident" id="4779321"><a href="/regexp/syntax/parse.go.html#4742901">strings</a></span><span class="op" id="4779328">.</span><span class="ident" id="4779329">IndexRune</span><span class="op" id="4779338">(</span><span class="ident" id="4779339"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4779340">,</span>&nbsp;<span class="string" id="4779342">&#39;}&#39;</span><span class="op" id="4779345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779349">if</span>&nbsp;<span class="ident" id="4779352"><a href="/regexp/syntax/parse.go.html#4779314">end</a></span>&nbsp;<span class="op" id="4779356">&lt;</span>&nbsp;<span class="num" id="4779358">0</span>&nbsp;<span class="op" id="4779360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779365">if</span>&nbsp;<span class="ident" id="4779368"><a href="/regexp/syntax/parse.go.html#4778902">err</a></span>&nbsp;<span class="op" id="4779372">=</span>&nbsp;<span class="ident" id="4779374"><a href="/regexp/syntax/parse.go.html#4788780">checkUTF8</a></span><span class="op" id="4779383">(</span><span class="ident" id="4779384"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4779385">)</span><span class="op" id="4779386">;</span>&nbsp;<span class="ident" id="4779388"><a href="/regexp/syntax/parse.go.html#4778902">err</a></span>&nbsp;<span class="op" id="4779392">!=</span>&nbsp;<span class="ident" id="4779395">nil</span>&nbsp;<span class="op" id="4779399">{</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779405">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779420">return</span>&nbsp;<span class="ident" id="4779427">nil</span><span class="op" id="4779430">,</span>&nbsp;<span class="string" id="4779432">&#34;&#34;</span><span class="op" id="4779434">,</span>&nbsp;<span class="op" id="4779436">&amp;</span><span class="ident" id="4779437"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4779442">{</span><span class="ident" id="4779443"><a href="/regexp/syntax/parse.go.html#4743468">ErrInvalidCharRange</a></span><span class="op" id="4779462">,</span>&nbsp;<span class="ident" id="4779464"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4779465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779473"><a href="/regexp/syntax/parse.go.html#4779178">seq</a></span><span class="op" id="4779476">,</span>&nbsp;<span class="ident" id="4779478"><a href="/regexp/syntax/parse.go.html#4779107">t</a></span>&nbsp;<span class="op" id="4779480">=</span>&nbsp;<span class="ident" id="4779482"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4779483">[</span><span class="op" id="4779484">:</span><span class="ident" id="4779485"><a href="/regexp/syntax/parse.go.html#4779314">end</a></span><span class="op" id="4779488">+</span><span class="num" id="4779489">1</span><span class="op" id="4779490">]</span><span class="op" id="4779491">,</span>&nbsp;<span class="ident" id="4779493"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4779494">[</span><span class="ident" id="4779495"><a href="/regexp/syntax/parse.go.html#4779314">end</a></span><span class="op" id="4779498">+</span><span class="num" id="4779499">1</span><span class="op" id="4779500">:</span><span class="op" id="4779501">]</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779505"><a href="/regexp/syntax/parse.go.html#4779183">name</a></span>&nbsp;<span class="op" id="4779510">=</span>&nbsp;<span class="ident" id="4779512"><a href="/regexp/syntax/parse.go.html#4778856">s</a></span><span class="op" id="4779513">[</span><span class="num" id="4779514">3</span><span class="op" id="4779515">:</span><span class="ident" id="4779516"><a href="/regexp/syntax/parse.go.html#4779314">end</a></span><span class="op" id="4779519">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779523">if</span>&nbsp;<span class="ident" id="4779526"><a href="/regexp/syntax/parse.go.html#4778902">err</a></span>&nbsp;<span class="op" id="4779530">=</span>&nbsp;<span class="ident" id="4779532"><a href="/regexp/syntax/parse.go.html#4788780">checkUTF8</a></span><span class="op" id="4779541">(</span><span class="ident" id="4779542"><a href="/regexp/syntax/parse.go.html#4779183">name</a></span><span class="op" id="4779546">)</span><span class="op" id="4779547">;</span>&nbsp;<span class="ident" id="4779549"><a href="/regexp/syntax/parse.go.html#4778902">err</a></span>&nbsp;<span class="op" id="4779553">!=</span>&nbsp;<span class="ident" id="4779556">nil</span>&nbsp;<span class="op" id="4779560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779565">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779577">}</span><br>
<span class="lineno">1480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4779581">//&nbsp;Group&nbsp;can&nbsp;have&nbsp;leading&nbsp;negation&nbsp;too.&nbsp;&nbsp;\p{^Han}&nbsp;==&nbsp;\P{Han},&nbsp;\P{^Han}&nbsp;==&nbsp;\p{Han}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779665">if</span>&nbsp;<span class="ident" id="4779668"><a href="/regexp/syntax/parse.go.html#4779183">name</a></span>&nbsp;<span class="op" id="4779673">!=</span>&nbsp;<span class="string" id="4779676">&#34;&#34;</span>&nbsp;<span class="op" id="4779679">&amp;&amp;</span>&nbsp;<span class="ident" id="4779682"><a href="/regexp/syntax/parse.go.html#4779183">name</a></span><span class="op" id="4779686">[</span><span class="num" id="4779687">0</span><span class="op" id="4779688">]</span>&nbsp;<span class="op" id="4779690">==</span>&nbsp;<span class="string" id="4779693">&#39;^&#39;</span>&nbsp;<span class="op" id="4779697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779701"><a href="/regexp/syntax/parse.go.html#4779062">sign</a></span>&nbsp;<span class="op" id="4779706">=</span>&nbsp;<span class="op" id="4779708">-</span><span class="ident" id="4779709"><a href="/regexp/syntax/parse.go.html#4779062">sign</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779716"><a href="/regexp/syntax/parse.go.html#4779183">name</a></span>&nbsp;<span class="op" id="4779721">=</span>&nbsp;<span class="ident" id="4779723"><a href="/regexp/syntax/parse.go.html#4779183">name</a></span><span class="op" id="4779727">[</span><span class="num" id="4779728">1</span><span class="op" id="4779729">:</span><span class="op" id="4779730">]</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779737">tab</span><span class="op" id="4779740">,</span>&nbsp;<span class="ident" id="4779742">fold</span>&nbsp;<span class="op" id="4779747">:=</span>&nbsp;<span class="ident" id="4779750"><a href="/regexp/syntax/parse.go.html#4778255">unicodeTable</a></span><span class="op" id="4779762">(</span><span class="ident" id="4779763"><a href="/regexp/syntax/parse.go.html#4779183">name</a></span><span class="op" id="4779767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779770">if</span>&nbsp;<span class="ident" id="4779773"><a href="/regexp/syntax/parse.go.html#4779737">tab</a></span>&nbsp;<span class="op" id="4779777">==</span>&nbsp;<span class="ident" id="4779780">nil</span>&nbsp;<span class="op" id="4779784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779788">return</span>&nbsp;<span class="ident" id="4779795">nil</span><span class="op" id="4779798">,</span>&nbsp;<span class="string" id="4779800">&#34;&#34;</span><span class="op" id="4779802">,</span>&nbsp;<span class="op" id="4779804">&amp;</span><span class="ident" id="4779805"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4779810">{</span><span class="ident" id="4779811"><a href="/regexp/syntax/parse.go.html#4743468">ErrInvalidCharRange</a></span><span class="op" id="4779830">,</span>&nbsp;<span class="ident" id="4779832"><a href="/regexp/syntax/parse.go.html#4779178">seq</a></span><span class="op" id="4779835">}</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779842">if</span>&nbsp;<span class="ident" id="4779845"><a href="/regexp/syntax/parse.go.html#4778827">p</a></span><span class="op" id="4779846">.</span><span class="ident" id="4779847">flags</span><span class="op" id="4779852">&amp;</span><span class="ident" id="4779853"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span>&nbsp;<span class="op" id="4779862">==</span>&nbsp;<span class="num" id="4779865">0</span>&nbsp;<span class="op" id="4779867">||</span>&nbsp;<span class="ident" id="4779870"><a href="/regexp/syntax/parse.go.html#4779742">fold</a></span>&nbsp;<span class="op" id="4779875">==</span>&nbsp;<span class="ident" id="4779878">nil</span>&nbsp;<span class="op" id="4779882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779886">if</span>&nbsp;<span class="ident" id="4779889"><a href="/regexp/syntax/parse.go.html#4779062">sign</a></span>&nbsp;<span class="op" id="4779894">&gt;</span>&nbsp;<span class="num" id="4779896">0</span>&nbsp;<span class="op" id="4779898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779903"><a href="/regexp/syntax/parse.go.html#4778866">r</a></span>&nbsp;<span class="op" id="4779905">=</span>&nbsp;<span class="ident" id="4779907"><a href="/regexp/syntax/parse.go.html#4786191">appendTable</a></span><span class="op" id="4779918">(</span><span class="ident" id="4779919"><a href="/regexp/syntax/parse.go.html#4778866">r</a></span><span class="op" id="4779920">,</span>&nbsp;<span class="ident" id="4779922"><a href="/regexp/syntax/parse.go.html#4779737">tab</a></span><span class="op" id="4779925">)</span><br>
<span class="lineno">1495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779929">}</span>&nbsp;<span class="keyword" id="4779931">else</span>&nbsp;<span class="op" id="4779936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4779941"><a href="/regexp/syntax/parse.go.html#4778866">r</a></span>&nbsp;<span class="op" id="4779943">=</span>&nbsp;<span class="ident" id="4779945"><a href="/regexp/syntax/parse.go.html#4786807">appendNegatedTable</a></span><span class="op" id="4779963">(</span><span class="ident" id="4779964"><a href="/regexp/syntax/parse.go.html#4778866">r</a></span><span class="op" id="4779965">,</span>&nbsp;<span class="ident" id="4779967"><a href="/regexp/syntax/parse.go.html#4779737">tab</a></span><span class="op" id="4779970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4779977">}</span>&nbsp;<span class="keyword" id="4779979">else</span>&nbsp;<span class="op" id="4779984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4779988">//&nbsp;Merge&nbsp;and&nbsp;clean&nbsp;tab&nbsp;and&nbsp;fold&nbsp;in&nbsp;a&nbsp;temporary&nbsp;buffer.</span><br>
<span class="lineno">1500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4780045">//&nbsp;This&nbsp;is&nbsp;necessary&nbsp;for&nbsp;the&nbsp;negative&nbsp;case&nbsp;and&nbsp;just&nbsp;tidy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4780104">//&nbsp;for&nbsp;the&nbsp;positive&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780132">tmp</span>&nbsp;<span class="op" id="4780136">:=</span>&nbsp;<span class="ident" id="4780139"><a href="/regexp/syntax/parse.go.html#4778827">p</a></span><span class="op" id="4780140">.</span><span class="ident" id="4780141">tmpClass</span><span class="op" id="4780149">[</span><span class="op" id="4780150">:</span><span class="num" id="4780151">0</span><span class="op" id="4780152">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780156"><a href="/regexp/syntax/parse.go.html#4780132">tmp</a></span>&nbsp;<span class="op" id="4780160">=</span>&nbsp;<span class="ident" id="4780162"><a href="/regexp/syntax/parse.go.html#4786191">appendTable</a></span><span class="op" id="4780173">(</span><span class="ident" id="4780174"><a href="/regexp/syntax/parse.go.html#4780132">tmp</a></span><span class="op" id="4780177">,</span>&nbsp;<span class="ident" id="4780179"><a href="/regexp/syntax/parse.go.html#4779737">tab</a></span><span class="op" id="4780182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780186"><a href="/regexp/syntax/parse.go.html#4780132">tmp</a></span>&nbsp;<span class="op" id="4780190">=</span>&nbsp;<span class="ident" id="4780192"><a href="/regexp/syntax/parse.go.html#4786191">appendTable</a></span><span class="op" id="4780203">(</span><span class="ident" id="4780204"><a href="/regexp/syntax/parse.go.html#4780132">tmp</a></span><span class="op" id="4780207">,</span>&nbsp;<span class="ident" id="4780209"><a href="/regexp/syntax/parse.go.html#4779742">fold</a></span><span class="op" id="4780213">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780217"><a href="/regexp/syntax/parse.go.html#4778827">p</a></span><span class="op" id="4780218">.</span><span class="ident" id="4780219">tmpClass</span>&nbsp;<span class="op" id="4780228">=</span>&nbsp;<span class="ident" id="4780230"><a href="/regexp/syntax/parse.go.html#4780132">tmp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780236"><a href="/regexp/syntax/parse.go.html#4780132">tmp</a></span>&nbsp;<span class="op" id="4780240">=</span>&nbsp;<span class="ident" id="4780242"><a href="/regexp/syntax/parse.go.html#4782865">cleanClass</a></span><span class="op" id="4780252">(</span><span class="op" id="4780253">&amp;</span><span class="ident" id="4780254"><a href="/regexp/syntax/parse.go.html#4778827">p</a></span><span class="op" id="4780255">.</span><span class="ident" id="4780256">tmpClass</span><span class="op" id="4780264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4780268">if</span>&nbsp;<span class="ident" id="4780271"><a href="/regexp/syntax/parse.go.html#4779062">sign</a></span>&nbsp;<span class="op" id="4780276">&gt;</span>&nbsp;<span class="num" id="4780278">0</span>&nbsp;<span class="op" id="4780280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780285"><a href="/regexp/syntax/parse.go.html#4778866">r</a></span>&nbsp;<span class="op" id="4780287">=</span>&nbsp;<span class="ident" id="4780289"><a href="/regexp/syntax/parse.go.html#4785323">appendClass</a></span><span class="op" id="4780300">(</span><span class="ident" id="4780301"><a href="/regexp/syntax/parse.go.html#4778866">r</a></span><span class="op" id="4780302">,</span>&nbsp;<span class="ident" id="4780304"><a href="/regexp/syntax/parse.go.html#4780132">tmp</a></span><span class="op" id="4780307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4780311">}</span>&nbsp;<span class="keyword" id="4780313">else</span>&nbsp;<span class="op" id="4780318">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780323"><a href="/regexp/syntax/parse.go.html#4778866">r</a></span>&nbsp;<span class="op" id="4780325">=</span>&nbsp;<span class="ident" id="4780327"><a href="/regexp/syntax/parse.go.html#4785817">appendNegatedClass</a></span><span class="op" id="4780345">(</span><span class="ident" id="4780346"><a href="/regexp/syntax/parse.go.html#4778866">r</a></span><span class="op" id="4780347">,</span>&nbsp;<span class="ident" id="4780349"><a href="/regexp/syntax/parse.go.html#4780132">tmp</a></span><span class="op" id="4780352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4780356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4780359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4780362">return</span>&nbsp;<span class="ident" id="4780369"><a href="/regexp/syntax/parse.go.html#4778866">r</a></span><span class="op" id="4780370">,</span>&nbsp;<span class="ident" id="4780372"><a href="/regexp/syntax/parse.go.html#4779107">t</a></span><span class="op" id="4780373">,</span>&nbsp;<span class="ident" id="4780375">nil</span><br>
<span class="lineno"></span><span class="op" id="4780379">}</span><br>
<span class="lineno">1515</span><br>
<span class="lineno"></span><span class="comment" id="4780382">//&nbsp;parseClass&nbsp;parses&nbsp;a&nbsp;character&nbsp;class&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="4780443">//&nbsp;and&nbsp;pushes&nbsp;it&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="4780482">func</span>&nbsp;<span class="op" id="4780487">(</span><span class="ident" id="4780488">p</span>&nbsp;<span class="op" id="4780490">*</span><span class="ident" id="4780491"><a href="/regexp/syntax/parse.go.html#4745485">parser</a></span><span class="op" id="4780497">)</span>&nbsp;<span class="ident" id="4780499">parseClass</span><span class="op" id="4780509">(</span><span class="ident" id="4780510">s</span>&nbsp;<span class="builtintype" id="4780512">string</span><span class="op" id="4780518">)</span>&nbsp;<span class="op" id="4780520">(</span><span class="ident" id="4780521">rest</span>&nbsp;<span class="builtintype" id="4780526">string</span><span class="op" id="4780532">,</span>&nbsp;<span class="ident" id="4780534">err</span>&nbsp;<span class="builtintype" id="4780538">error</span><span class="op" id="4780543">)</span>&nbsp;<span class="op" id="4780545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780548">t</span>&nbsp;<span class="op" id="4780550">:=</span>&nbsp;<span class="ident" id="4780553"><a href="/regexp/syntax/parse.go.html#4780510">s</a></span><span class="op" id="4780554">[</span><span class="num" id="4780555">1</span><span class="op" id="4780556">:</span><span class="op" id="4780557">]</span>&nbsp;<span class="comment" id="4780559">//&nbsp;chop&nbsp;[</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780570">re</span>&nbsp;<span class="op" id="4780573">:=</span>&nbsp;<span class="ident" id="4780576"><a href="/regexp/syntax/parse.go.html#4780488">p</a></span><span class="op" id="4780577">.</span><span class="ident" id="4780578">newRegexp</span><span class="op" id="4780587">(</span><span class="ident" id="4780588"><a href="/regexp/syntax/regexp.go.html#4800993">OpCharClass</a></span><span class="op" id="4780599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780602"><a href="/regexp/syntax/parse.go.html#4780570">re</a></span><span class="op" id="4780604">.</span><span class="ident" id="4780605">Flags</span>&nbsp;<span class="op" id="4780611">=</span>&nbsp;<span class="ident" id="4780613"><a href="/regexp/syntax/parse.go.html#4780488">p</a></span><span class="op" id="4780614">.</span><span class="ident" id="4780615">flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780622"><a href="/regexp/syntax/parse.go.html#4780570">re</a></span><span class="op" id="4780624">.</span><span class="ident" id="4780625">Rune</span>&nbsp;<span class="op" id="4780630">=</span>&nbsp;<span class="ident" id="4780632"><a href="/regexp/syntax/parse.go.html#4780570">re</a></span><span class="op" id="4780634">.</span><span class="ident" id="4780635">Rune0</span><span class="op" id="4780640">[</span><span class="op" id="4780641">:</span><span class="num" id="4780642">0</span><span class="op" id="4780643">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780647">sign</span>&nbsp;<span class="op" id="4780652">:=</span>&nbsp;<span class="op" id="4780655">+</span><span class="num" id="4780656">1</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4780659">if</span>&nbsp;<span class="ident" id="4780662"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span>&nbsp;<span class="op" id="4780664">!=</span>&nbsp;<span class="string" id="4780667">&#34;&#34;</span>&nbsp;<span class="op" id="4780670">&amp;&amp;</span>&nbsp;<span class="ident" id="4780673"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4780674">[</span><span class="num" id="4780675">0</span><span class="op" id="4780676">]</span>&nbsp;<span class="op" id="4780678">==</span>&nbsp;<span class="string" id="4780681">&#39;^&#39;</span>&nbsp;<span class="op" id="4780685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780689"><a href="/regexp/syntax/parse.go.html#4780647">sign</a></span>&nbsp;<span class="op" id="4780694">=</span>&nbsp;<span class="op" id="4780696">-</span><span class="num" id="4780697">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780701"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span>&nbsp;<span class="op" id="4780703">=</span>&nbsp;<span class="ident" id="4780705"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4780706">[</span><span class="num" id="4780707">1</span><span class="op" id="4780708">:</span><span class="op" id="4780709">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4780714">//&nbsp;If&nbsp;character&nbsp;class&nbsp;does&nbsp;not&nbsp;match&nbsp;\n,&nbsp;add&nbsp;it&nbsp;here,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4780770">//&nbsp;so&nbsp;that&nbsp;negation&nbsp;later&nbsp;will&nbsp;do&nbsp;the&nbsp;right&nbsp;thing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4780823">if</span>&nbsp;<span class="ident" id="4780826"><a href="/regexp/syntax/parse.go.html#4780488">p</a></span><span class="op" id="4780827">.</span><span class="ident" id="4780828">flags</span><span class="op" id="4780833">&amp;</span><span class="ident" id="4780834"><a href="/regexp/syntax/parse.go.html#4744562">ClassNL</a></span>&nbsp;<span class="op" id="4780842">==</span>&nbsp;<span class="num" id="4780845">0</span>&nbsp;<span class="op" id="4780847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780852"><a href="/regexp/syntax/parse.go.html#4780570">re</a></span><span class="op" id="4780854">.</span><span class="ident" id="4780855">Rune</span>&nbsp;<span class="op" id="4780860">=</span>&nbsp;<span class="builtinfunc" id="4780862">append</span><span class="op" id="4780868">(</span><span class="ident" id="4780869"><a href="/regexp/syntax/parse.go.html#4780570">re</a></span><span class="op" id="4780871">.</span><span class="ident" id="4780872">Rune</span><span class="op" id="4780876">,</span>&nbsp;<span class="string" id="4780878">&#39;\n&#39;</span><span class="op" id="4780882">,</span>&nbsp;<span class="string" id="4780884">&#39;\n&#39;</span><span class="op" id="4780888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4780892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4780895">}</span><br>
<span class="lineno">1535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780899">class</span>&nbsp;<span class="op" id="4780905">:=</span>&nbsp;<span class="ident" id="4780908"><a href="/regexp/syntax/parse.go.html#4780570">re</a></span><span class="op" id="4780910">.</span><span class="ident" id="4780911">Rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4780917">first</span>&nbsp;<span class="op" id="4780923">:=</span>&nbsp;<span class="ident" id="4780926">true</span>&nbsp;<span class="comment" id="4780931">//&nbsp;]&nbsp;and&nbsp;-&nbsp;are&nbsp;okay&nbsp;as&nbsp;first&nbsp;char&nbsp;in&nbsp;class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4780975">for</span>&nbsp;<span class="ident" id="4780979"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span>&nbsp;<span class="op" id="4780981">==</span>&nbsp;<span class="string" id="4780984">&#34;&#34;</span>&nbsp;<span class="op" id="4780987">||</span>&nbsp;<span class="ident" id="4780990"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4780991">[</span><span class="num" id="4780992">0</span><span class="op" id="4780993">]</span>&nbsp;<span class="op" id="4780995">!=</span>&nbsp;<span class="string" id="4780998">&#39;]&#39;</span>&nbsp;<span class="op" id="4781002">||</span>&nbsp;<span class="ident" id="4781005"><a href="/regexp/syntax/parse.go.html#4780917">first</a></span>&nbsp;<span class="op" id="4781011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4781015">//&nbsp;POSIX:&nbsp;-&nbsp;is&nbsp;only&nbsp;okay&nbsp;unescaped&nbsp;as&nbsp;first&nbsp;or&nbsp;last&nbsp;in&nbsp;class.</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4781079">//&nbsp;Perl:&nbsp;-&nbsp;is&nbsp;okay&nbsp;anywhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781110">if</span>&nbsp;<span class="ident" id="4781113"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span>&nbsp;<span class="op" id="4781115">!=</span>&nbsp;<span class="string" id="4781118">&#34;&#34;</span>&nbsp;<span class="op" id="4781121">&amp;&amp;</span>&nbsp;<span class="ident" id="4781124"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4781125">[</span><span class="num" id="4781126">0</span><span class="op" id="4781127">]</span>&nbsp;<span class="op" id="4781129">==</span>&nbsp;<span class="string" id="4781132">&#39;-&#39;</span>&nbsp;<span class="op" id="4781136">&amp;&amp;</span>&nbsp;<span class="ident" id="4781139"><a href="/regexp/syntax/parse.go.html#4780488">p</a></span><span class="op" id="4781140">.</span><span class="ident" id="4781141">flags</span><span class="op" id="4781146">&amp;</span><span class="ident" id="4781147"><a href="/regexp/syntax/parse.go.html#4744908">PerlX</a></span>&nbsp;<span class="op" id="4781153">==</span>&nbsp;<span class="num" id="4781156">0</span>&nbsp;<span class="op" id="4781158">&amp;&amp;</span>&nbsp;<span class="op" id="4781161">!</span><span class="ident" id="4781162"><a href="/regexp/syntax/parse.go.html#4780917">first</a></span>&nbsp;<span class="op" id="4781168">&amp;&amp;</span>&nbsp;<span class="op" id="4781171">(</span><span class="builtinfunc" id="4781172">len</span><span class="op" id="4781175">(</span><span class="ident" id="4781176"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4781177">)</span>&nbsp;<span class="op" id="4781179">==</span>&nbsp;<span class="num" id="4781182">1</span>&nbsp;<span class="op" id="4781184">||</span>&nbsp;<span class="ident" id="4781187"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4781188">[</span><span class="num" id="4781189">1</span><span class="op" id="4781190">]</span>&nbsp;<span class="op" id="4781192">!=</span>&nbsp;<span class="string" id="4781195">&#39;]&#39;</span><span class="op" id="4781198">)</span>&nbsp;<span class="op" id="4781200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4781205">_</span><span class="op" id="4781206">,</span>&nbsp;<span class="ident" id="4781208">size</span>&nbsp;<span class="op" id="4781213">:=</span>&nbsp;<span class="ident" id="4781216"><a href="/regexp/syntax/parse.go.html#4742923">utf8</a></span><span class="op" id="4781220">.</span><span class="ident" id="4781221">DecodeRuneInString</span><span class="op" id="4781239">(</span><span class="ident" id="4781240"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4781241">[</span><span class="num" id="4781242">1</span><span class="op" id="4781243">:</span><span class="op" id="4781244">]</span><span class="op" id="4781245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781250">return</span>&nbsp;<span class="string" id="4781257">&#34;&#34;</span><span class="op" id="4781259">,</span>&nbsp;<span class="op" id="4781261">&amp;</span><span class="ident" id="4781262"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4781267">{</span><span class="ident" id="4781268">Code</span><span class="op" id="4781272">:</span>&nbsp;<span class="ident" id="4781274"><a href="/regexp/syntax/parse.go.html#4743468">ErrInvalidCharRange</a></span><span class="op" id="4781293">,</span>&nbsp;<span class="ident" id="4781295">Expr</span><span class="op" id="4781299">:</span>&nbsp;<span class="ident" id="4781301"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4781302">[</span><span class="op" id="4781303">:</span><span class="num" id="4781304">1</span><span class="op" id="4781305">+</span><span class="ident" id="4781306"><a href="/regexp/syntax/parse.go.html#4781208">size</a></span><span class="op" id="4781310">]</span><span class="op" id="4781311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4781315">}</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4781319"><a href="/regexp/syntax/parse.go.html#4780917">first</a></span>&nbsp;<span class="op" id="4781325">=</span>&nbsp;<span class="ident" id="4781327">false</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4781336">//&nbsp;Look&nbsp;for&nbsp;POSIX&nbsp;[:alnum:]&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781371">if</span>&nbsp;<span class="builtinfunc" id="4781374">len</span><span class="op" id="4781377">(</span><span class="ident" id="4781378"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4781379">)</span>&nbsp;<span class="op" id="4781381">&gt;</span>&nbsp;<span class="num" id="4781383">2</span>&nbsp;<span class="op" id="4781385">&amp;&amp;</span>&nbsp;<span class="ident" id="4781388"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4781389">[</span><span class="num" id="4781390">0</span><span class="op" id="4781391">]</span>&nbsp;<span class="op" id="4781393">==</span>&nbsp;<span class="string" id="4781396">&#39;[&#39;</span>&nbsp;<span class="op" id="4781400">&amp;&amp;</span>&nbsp;<span class="ident" id="4781403"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4781404">[</span><span class="num" id="4781405">1</span><span class="op" id="4781406">]</span>&nbsp;<span class="op" id="4781408">==</span>&nbsp;<span class="string" id="4781411">&#39;:&#39;</span>&nbsp;<span class="op" id="4781415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4781420">nclass</span><span class="op" id="4781426">,</span>&nbsp;<span class="ident" id="4781428">nt</span><span class="op" id="4781430">,</span>&nbsp;<span class="ident" id="4781432">err</span>&nbsp;<span class="op" id="4781436">:=</span>&nbsp;<span class="ident" id="4781439"><a href="/regexp/syntax/parse.go.html#4780488">p</a></span><span class="op" id="4781440">.</span><span class="ident" id="4781441">parseNamedClass</span><span class="op" id="4781456">(</span><span class="ident" id="4781457"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4781458">,</span>&nbsp;<span class="ident" id="4781460"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span><span class="op" id="4781465">)</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781470">if</span>&nbsp;<span class="ident" id="4781473"><a href="/regexp/syntax/parse.go.html#4781432">err</a></span>&nbsp;<span class="op" id="4781477">!=</span>&nbsp;<span class="ident" id="4781480">nil</span>&nbsp;<span class="op" id="4781484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781490">return</span>&nbsp;<span class="string" id="4781497">&#34;&#34;</span><span class="op" id="4781499">,</span>&nbsp;<span class="ident" id="4781501"><a href="/regexp/syntax/parse.go.html#4781432">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4781508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781513">if</span>&nbsp;<span class="ident" id="4781516"><a href="/regexp/syntax/parse.go.html#4781420">nclass</a></span>&nbsp;<span class="op" id="4781523">!=</span>&nbsp;<span class="ident" id="4781526">nil</span>&nbsp;<span class="op" id="4781530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4781536"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span><span class="op" id="4781541">,</span>&nbsp;<span class="ident" id="4781543"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span>&nbsp;<span class="op" id="4781545">=</span>&nbsp;<span class="ident" id="4781547"><a href="/regexp/syntax/parse.go.html#4781420">nclass</a></span><span class="op" id="4781553">,</span>&nbsp;<span class="ident" id="4781555"><a href="/regexp/syntax/parse.go.html#4781428">nt</a></span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781562">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4781574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4781578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4781583">//&nbsp;Look&nbsp;for&nbsp;Unicode&nbsp;character&nbsp;group&nbsp;like&nbsp;\p{Han}.</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4781635">nclass</span><span class="op" id="4781641">,</span>&nbsp;<span class="ident" id="4781643">nt</span><span class="op" id="4781645">,</span>&nbsp;<span class="ident" id="4781647">err</span>&nbsp;<span class="op" id="4781651">:=</span>&nbsp;<span class="ident" id="4781654"><a href="/regexp/syntax/parse.go.html#4780488">p</a></span><span class="op" id="4781655">.</span><span class="ident" id="4781656">parseUnicodeClass</span><span class="op" id="4781673">(</span><span class="ident" id="4781674"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4781675">,</span>&nbsp;<span class="ident" id="4781677"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span><span class="op" id="4781682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781686">if</span>&nbsp;<span class="ident" id="4781689"><a href="/regexp/syntax/parse.go.html#4781647">err</a></span>&nbsp;<span class="op" id="4781693">!=</span>&nbsp;<span class="ident" id="4781696">nil</span>&nbsp;<span class="op" id="4781700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781705">return</span>&nbsp;<span class="string" id="4781712">&#34;&#34;</span><span class="op" id="4781714">,</span>&nbsp;<span class="ident" id="4781716"><a href="/regexp/syntax/parse.go.html#4781647">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4781722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781726">if</span>&nbsp;<span class="ident" id="4781729"><a href="/regexp/syntax/parse.go.html#4781635">nclass</a></span>&nbsp;<span class="op" id="4781736">!=</span>&nbsp;<span class="ident" id="4781739">nil</span>&nbsp;<span class="op" id="4781743">{</span><br>
<span class="lineno">1565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4781748"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span><span class="op" id="4781753">,</span>&nbsp;<span class="ident" id="4781755"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span>&nbsp;<span class="op" id="4781757">=</span>&nbsp;<span class="ident" id="4781759"><a href="/regexp/syntax/parse.go.html#4781635">nclass</a></span><span class="op" id="4781765">,</span>&nbsp;<span class="ident" id="4781767"><a href="/regexp/syntax/parse.go.html#4781643">nt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781773">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4781784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4781789">//&nbsp;Look&nbsp;for&nbsp;Perl&nbsp;character&nbsp;class&nbsp;symbols&nbsp;(extension).</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781845">if</span>&nbsp;<span class="ident" id="4781848">nclass</span><span class="op" id="4781854">,</span>&nbsp;<span class="ident" id="4781856">nt</span>&nbsp;<span class="op" id="4781859">:=</span>&nbsp;<span class="ident" id="4781862"><a href="/regexp/syntax/parse.go.html#4780488">p</a></span><span class="op" id="4781863">.</span><span class="ident" id="4781864">parsePerlClassEscape</span><span class="op" id="4781884">(</span><span class="ident" id="4781885"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4781886">,</span>&nbsp;<span class="ident" id="4781888"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span><span class="op" id="4781893">)</span><span class="op" id="4781894">;</span>&nbsp;<span class="ident" id="4781896"><a href="/regexp/syntax/parse.go.html#4781848">nclass</a></span>&nbsp;<span class="op" id="4781903">!=</span>&nbsp;<span class="ident" id="4781906">nil</span>&nbsp;<span class="op" id="4781910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4781915"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span><span class="op" id="4781920">,</span>&nbsp;<span class="ident" id="4781922"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span>&nbsp;<span class="op" id="4781924">=</span>&nbsp;<span class="ident" id="4781926"><a href="/regexp/syntax/parse.go.html#4781848">nclass</a></span><span class="op" id="4781932">,</span>&nbsp;<span class="ident" id="4781934"><a href="/regexp/syntax/parse.go.html#4781856">nt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4781940">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4781951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4781956">//&nbsp;Single&nbsp;character&nbsp;or&nbsp;simple&nbsp;range.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4781995">rng</span>&nbsp;<span class="op" id="4781999">:=</span>&nbsp;<span class="ident" id="4782002"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4782006">var</span>&nbsp;<span class="ident" id="4782010">lo</span><span class="op" id="4782012">,</span>&nbsp;<span class="ident" id="4782014">hi</span>&nbsp;<span class="builtintype" id="4782017">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4782024">if</span>&nbsp;<span class="ident" id="4782027"><a href="/regexp/syntax/parse.go.html#4782010">lo</a></span><span class="op" id="4782029">,</span>&nbsp;<span class="ident" id="4782031"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4782032">,</span>&nbsp;<span class="ident" id="4782034"><a href="/regexp/syntax/parse.go.html#4781647">err</a></span>&nbsp;<span class="op" id="4782038">=</span>&nbsp;<span class="ident" id="4782040"><a href="/regexp/syntax/parse.go.html#4780488">p</a></span><span class="op" id="4782041">.</span><span class="ident" id="4782042">parseClassChar</span><span class="op" id="4782056">(</span><span class="ident" id="4782057"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4782058">,</span>&nbsp;<span class="ident" id="4782060"><a href="/regexp/syntax/parse.go.html#4780510">s</a></span><span class="op" id="4782061">)</span><span class="op" id="4782062">;</span>&nbsp;<span class="ident" id="4782064"><a href="/regexp/syntax/parse.go.html#4781647">err</a></span>&nbsp;<span class="op" id="4782068">!=</span>&nbsp;<span class="ident" id="4782071">nil</span>&nbsp;<span class="op" id="4782075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4782080">return</span>&nbsp;<span class="string" id="4782087">&#34;&#34;</span><span class="op" id="4782089">,</span>&nbsp;<span class="ident" id="4782091"><a href="/regexp/syntax/parse.go.html#4781647">err</a></span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4782097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782101"><a href="/regexp/syntax/parse.go.html#4782014">hi</a></span>&nbsp;<span class="op" id="4782104">=</span>&nbsp;<span class="ident" id="4782106"><a href="/regexp/syntax/parse.go.html#4782010">lo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4782111">//&nbsp;[a-]&nbsp;means&nbsp;(a|-)&nbsp;so&nbsp;check&nbsp;for&nbsp;final&nbsp;].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4782155">if</span>&nbsp;<span class="builtinfunc" id="4782158">len</span><span class="op" id="4782161">(</span><span class="ident" id="4782162"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4782163">)</span>&nbsp;<span class="op" id="4782165">&gt;=</span>&nbsp;<span class="num" id="4782168">2</span>&nbsp;<span class="op" id="4782170">&amp;&amp;</span>&nbsp;<span class="ident" id="4782173"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4782174">[</span><span class="num" id="4782175">0</span><span class="op" id="4782176">]</span>&nbsp;<span class="op" id="4782178">==</span>&nbsp;<span class="string" id="4782181">&#39;-&#39;</span>&nbsp;<span class="op" id="4782185">&amp;&amp;</span>&nbsp;<span class="ident" id="4782188"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4782189">[</span><span class="num" id="4782190">1</span><span class="op" id="4782191">]</span>&nbsp;<span class="op" id="4782193">!=</span>&nbsp;<span class="string" id="4782196">&#39;]&#39;</span>&nbsp;<span class="op" id="4782200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782205"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span>&nbsp;<span class="op" id="4782207">=</span>&nbsp;<span class="ident" id="4782209"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4782210">[</span><span class="num" id="4782211">1</span><span class="op" id="4782212">:</span><span class="op" id="4782213">]</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4782218">if</span>&nbsp;<span class="ident" id="4782221"><a href="/regexp/syntax/parse.go.html#4782014">hi</a></span><span class="op" id="4782223">,</span>&nbsp;<span class="ident" id="4782225"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4782226">,</span>&nbsp;<span class="ident" id="4782228"><a href="/regexp/syntax/parse.go.html#4781647">err</a></span>&nbsp;<span class="op" id="4782232">=</span>&nbsp;<span class="ident" id="4782234"><a href="/regexp/syntax/parse.go.html#4780488">p</a></span><span class="op" id="4782235">.</span><span class="ident" id="4782236">parseClassChar</span><span class="op" id="4782250">(</span><span class="ident" id="4782251"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4782252">,</span>&nbsp;<span class="ident" id="4782254"><a href="/regexp/syntax/parse.go.html#4780510">s</a></span><span class="op" id="4782255">)</span><span class="op" id="4782256">;</span>&nbsp;<span class="ident" id="4782258"><a href="/regexp/syntax/parse.go.html#4781647">err</a></span>&nbsp;<span class="op" id="4782262">!=</span>&nbsp;<span class="ident" id="4782265">nil</span>&nbsp;<span class="op" id="4782269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4782275">return</span>&nbsp;<span class="string" id="4782282">&#34;&#34;</span><span class="op" id="4782284">,</span>&nbsp;<span class="ident" id="4782286"><a href="/regexp/syntax/parse.go.html#4781647">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4782293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4782298">if</span>&nbsp;<span class="ident" id="4782301"><a href="/regexp/syntax/parse.go.html#4782014">hi</a></span>&nbsp;<span class="op" id="4782304">&lt;</span>&nbsp;<span class="ident" id="4782306"><a href="/regexp/syntax/parse.go.html#4782010">lo</a></span>&nbsp;<span class="op" id="4782309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782315"><a href="/regexp/syntax/parse.go.html#4781995">rng</a></span>&nbsp;<span class="op" id="4782319">=</span>&nbsp;<span class="ident" id="4782321"><a href="/regexp/syntax/parse.go.html#4781995">rng</a></span><span class="op" id="4782324">[</span><span class="op" id="4782325">:</span><span class="builtinfunc" id="4782326">len</span><span class="op" id="4782329">(</span><span class="ident" id="4782330"><a href="/regexp/syntax/parse.go.html#4781995">rng</a></span><span class="op" id="4782333">)</span><span class="op" id="4782334">-</span><span class="builtinfunc" id="4782335">len</span><span class="op" id="4782338">(</span><span class="ident" id="4782339"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4782340">)</span><span class="op" id="4782341">]</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4782347">return</span>&nbsp;<span class="string" id="4782354">&#34;&#34;</span><span class="op" id="4782356">,</span>&nbsp;<span class="op" id="4782358">&amp;</span><span class="ident" id="4782359"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4782364">{</span><span class="ident" id="4782365">Code</span><span class="op" id="4782369">:</span>&nbsp;<span class="ident" id="4782371"><a href="/regexp/syntax/parse.go.html#4743468">ErrInvalidCharRange</a></span><span class="op" id="4782390">,</span>&nbsp;<span class="ident" id="4782392">Expr</span><span class="op" id="4782396">:</span>&nbsp;<span class="ident" id="4782398"><a href="/regexp/syntax/parse.go.html#4781995">rng</a></span><span class="op" id="4782401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4782406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4782410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4782414">if</span>&nbsp;<span class="ident" id="4782417"><a href="/regexp/syntax/parse.go.html#4780488">p</a></span><span class="op" id="4782418">.</span><span class="ident" id="4782419">flags</span><span class="op" id="4782424">&amp;</span><span class="ident" id="4782425"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span>&nbsp;<span class="op" id="4782434">==</span>&nbsp;<span class="num" id="4782437">0</span>&nbsp;<span class="op" id="4782439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782444"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span>&nbsp;<span class="op" id="4782450">=</span>&nbsp;<span class="ident" id="4782452"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4782463">(</span><span class="ident" id="4782464"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span><span class="op" id="4782469">,</span>&nbsp;<span class="ident" id="4782471"><a href="/regexp/syntax/parse.go.html#4782010">lo</a></span><span class="op" id="4782473">,</span>&nbsp;<span class="ident" id="4782475"><a href="/regexp/syntax/parse.go.html#4782014">hi</a></span><span class="op" id="4782477">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4782481">}</span>&nbsp;<span class="keyword" id="4782483">else</span>&nbsp;<span class="op" id="4782488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782493"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span>&nbsp;<span class="op" id="4782499">=</span>&nbsp;<span class="ident" id="4782501"><a href="/regexp/syntax/parse.go.html#4784445">appendFoldedRange</a></span><span class="op" id="4782518">(</span><span class="ident" id="4782519"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span><span class="op" id="4782524">,</span>&nbsp;<span class="ident" id="4782526"><a href="/regexp/syntax/parse.go.html#4782010">lo</a></span><span class="op" id="4782528">,</span>&nbsp;<span class="ident" id="4782530"><a href="/regexp/syntax/parse.go.html#4782014">hi</a></span><span class="op" id="4782532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4782536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4782539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782542"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span>&nbsp;<span class="op" id="4782544">=</span>&nbsp;<span class="ident" id="4782546"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4782547">[</span><span class="num" id="4782548">1</span><span class="op" id="4782549">:</span><span class="op" id="4782550">]</span>&nbsp;<span class="comment" id="4782552">//&nbsp;chop&nbsp;]</span><br>
<span class="lineno">1600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4782564">//&nbsp;Use&nbsp;&amp;re.Rune&nbsp;instead&nbsp;of&nbsp;&amp;class&nbsp;to&nbsp;avoid&nbsp;allocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782620"><a href="/regexp/syntax/parse.go.html#4780570">re</a></span><span class="op" id="4782622">.</span><span class="ident" id="4782623">Rune</span>&nbsp;<span class="op" id="4782628">=</span>&nbsp;<span class="ident" id="4782630"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782637"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span>&nbsp;<span class="op" id="4782643">=</span>&nbsp;<span class="ident" id="4782645"><a href="/regexp/syntax/parse.go.html#4782865">cleanClass</a></span><span class="op" id="4782655">(</span><span class="op" id="4782656">&amp;</span><span class="ident" id="4782657"><a href="/regexp/syntax/parse.go.html#4780570">re</a></span><span class="op" id="4782659">.</span><span class="ident" id="4782660">Rune</span><span class="op" id="4782664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4782667">if</span>&nbsp;<span class="ident" id="4782670"><a href="/regexp/syntax/parse.go.html#4780647">sign</a></span>&nbsp;<span class="op" id="4782675">&lt;</span>&nbsp;<span class="num" id="4782677">0</span>&nbsp;<span class="op" id="4782679">{</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782683"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span>&nbsp;<span class="op" id="4782689">=</span>&nbsp;<span class="ident" id="4782691"><a href="/regexp/syntax/parse.go.html#4787786">negateClass</a></span><span class="op" id="4782702">(</span><span class="ident" id="4782703"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span><span class="op" id="4782708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4782711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782714"><a href="/regexp/syntax/parse.go.html#4780570">re</a></span><span class="op" id="4782716">.</span><span class="ident" id="4782717">Rune</span>&nbsp;<span class="op" id="4782722">=</span>&nbsp;<span class="ident" id="4782724"><a href="/regexp/syntax/parse.go.html#4780899">class</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782731"><a href="/regexp/syntax/parse.go.html#4780488">p</a></span><span class="op" id="4782732">.</span><span class="ident" id="4782733">push</span><span class="op" id="4782737">(</span><span class="ident" id="4782738"><a href="/regexp/syntax/parse.go.html#4780570">re</a></span><span class="op" id="4782740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4782743">return</span>&nbsp;<span class="ident" id="4782750"><a href="/regexp/syntax/parse.go.html#4780548">t</a></span><span class="op" id="4782751">,</span>&nbsp;<span class="ident" id="4782753">nil</span><br>
<span class="lineno">1610</span><span class="op" id="4782757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4782760">//&nbsp;cleanClass&nbsp;sorts&nbsp;the&nbsp;ranges&nbsp;(pairs&nbsp;of&nbsp;elements&nbsp;of&nbsp;r),</span><br>
<span class="lineno"></span><span class="comment" id="4782817">//&nbsp;merges&nbsp;them,&nbsp;and&nbsp;eliminates&nbsp;duplicates.</span><br>
<span class="lineno"></span><span class="keyword" id="4782860">func</span>&nbsp;<span class="ident" id="4782865">cleanClass</span><span class="op" id="4782875">(</span><span class="ident" id="4782876">rp</span>&nbsp;<span class="op" id="4782879">*</span><span class="op" id="4782880">[</span><span class="op" id="4782881">]</span><span class="builtintype" id="4782882">rune</span><span class="op" id="4782886">)</span>&nbsp;<span class="op" id="4782888">[</span><span class="op" id="4782889">]</span><span class="builtintype" id="4782890">rune</span>&nbsp;<span class="op" id="4782895">{</span><br>
<span class="lineno">1615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4782899">//&nbsp;Sort&nbsp;by&nbsp;lo&nbsp;increasing,&nbsp;hi&nbsp;decreasing&nbsp;to&nbsp;break&nbsp;ties.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782955"><a href="/regexp/syntax/parse.go.html#4742893">sort</a></span><span class="op" id="4782959">.</span><span class="ident" id="4782960">Sort</span><span class="op" id="4782964">(</span><span class="ident" id="4782965"><a href="/regexp/syntax/parse.go.html#4788443">ranges</a></span><span class="op" id="4782971">{</span><span class="ident" id="4782972"><a href="/regexp/syntax/parse.go.html#4782876">rp</a></span><span class="op" id="4782974">}</span><span class="op" id="4782975">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4782979">r</span>&nbsp;<span class="op" id="4782981">:=</span>&nbsp;<span class="op" id="4782984">*</span><span class="ident" id="4782985"><a href="/regexp/syntax/parse.go.html#4782876">rp</a></span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4782989">if</span>&nbsp;<span class="builtinfunc" id="4782992">len</span><span class="op" id="4782995">(</span><span class="ident" id="4782996"><a href="/regexp/syntax/parse.go.html#4782979">r</a></span><span class="op" id="4782997">)</span>&nbsp;<span class="op" id="4782999">&lt;</span>&nbsp;<span class="num" id="4783001">2</span>&nbsp;<span class="op" id="4783003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783007">return</span>&nbsp;<span class="ident" id="4783014"><a href="/regexp/syntax/parse.go.html#4782979">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4783017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4783021">//&nbsp;Merge&nbsp;abutting,&nbsp;overlapping.</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783054">w</span>&nbsp;<span class="op" id="4783056">:=</span>&nbsp;<span class="num" id="4783059">2</span>&nbsp;<span class="comment" id="4783061">//&nbsp;write&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783077">for</span>&nbsp;<span class="ident" id="4783081">i</span>&nbsp;<span class="op" id="4783083">:=</span>&nbsp;<span class="num" id="4783086">2</span><span class="op" id="4783087">;</span>&nbsp;<span class="ident" id="4783089"><a href="/regexp/syntax/parse.go.html#4783081">i</a></span>&nbsp;<span class="op" id="4783091">&lt;</span>&nbsp;<span class="builtinfunc" id="4783093">len</span><span class="op" id="4783096">(</span><span class="ident" id="4783097"><a href="/regexp/syntax/parse.go.html#4782979">r</a></span><span class="op" id="4783098">)</span><span class="op" id="4783099">;</span>&nbsp;<span class="ident" id="4783101"><a href="/regexp/syntax/parse.go.html#4783081">i</a></span>&nbsp;<span class="op" id="4783103">+=</span>&nbsp;<span class="num" id="4783106">2</span>&nbsp;<span class="op" id="4783108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783112">lo</span><span class="op" id="4783114">,</span>&nbsp;<span class="ident" id="4783116">hi</span>&nbsp;<span class="op" id="4783119">:=</span>&nbsp;<span class="ident" id="4783122"><a href="/regexp/syntax/parse.go.html#4782979">r</a></span><span class="op" id="4783123">[</span><span class="ident" id="4783124"><a href="/regexp/syntax/parse.go.html#4783081">i</a></span><span class="op" id="4783125">]</span><span class="op" id="4783126">,</span>&nbsp;<span class="ident" id="4783128"><a href="/regexp/syntax/parse.go.html#4782979">r</a></span><span class="op" id="4783129">[</span><span class="ident" id="4783130"><a href="/regexp/syntax/parse.go.html#4783081">i</a></span><span class="op" id="4783131">+</span><span class="num" id="4783132">1</span><span class="op" id="4783133">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783137">if</span>&nbsp;<span class="ident" id="4783140"><a href="/regexp/syntax/parse.go.html#4783112">lo</a></span>&nbsp;<span class="op" id="4783143">&lt;=</span>&nbsp;<span class="ident" id="4783146"><a href="/regexp/syntax/parse.go.html#4782979">r</a></span><span class="op" id="4783147">[</span><span class="ident" id="4783148"><a href="/regexp/syntax/parse.go.html#4783054">w</a></span><span class="op" id="4783149">-</span><span class="num" id="4783150">1</span><span class="op" id="4783151">]</span><span class="op" id="4783152">+</span><span class="num" id="4783153">1</span>&nbsp;<span class="op" id="4783155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4783160">//&nbsp;merge&nbsp;with&nbsp;previous&nbsp;range</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783192">if</span>&nbsp;<span class="ident" id="4783195"><a href="/regexp/syntax/parse.go.html#4783116">hi</a></span>&nbsp;<span class="op" id="4783198">&gt;</span>&nbsp;<span class="ident" id="4783200"><a href="/regexp/syntax/parse.go.html#4782979">r</a></span><span class="op" id="4783201">[</span><span class="ident" id="4783202"><a href="/regexp/syntax/parse.go.html#4783054">w</a></span><span class="op" id="4783203">-</span><span class="num" id="4783204">1</span><span class="op" id="4783205">]</span>&nbsp;<span class="op" id="4783207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783213"><a href="/regexp/syntax/parse.go.html#4782979">r</a></span><span class="op" id="4783214">[</span><span class="ident" id="4783215"><a href="/regexp/syntax/parse.go.html#4783054">w</a></span><span class="op" id="4783216">-</span><span class="num" id="4783217">1</span><span class="op" id="4783218">]</span>&nbsp;<span class="op" id="4783220">=</span>&nbsp;<span class="ident" id="4783222"><a href="/regexp/syntax/parse.go.html#4783116">hi</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4783228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783233">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4783244">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4783248">//&nbsp;new&nbsp;disjoint&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783272"><a href="/regexp/syntax/parse.go.html#4782979">r</a></span><span class="op" id="4783273">[</span><span class="ident" id="4783274"><a href="/regexp/syntax/parse.go.html#4783054">w</a></span><span class="op" id="4783275">]</span>&nbsp;<span class="op" id="4783277">=</span>&nbsp;<span class="ident" id="4783279"><a href="/regexp/syntax/parse.go.html#4783112">lo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783284"><a href="/regexp/syntax/parse.go.html#4782979">r</a></span><span class="op" id="4783285">[</span><span class="ident" id="4783286"><a href="/regexp/syntax/parse.go.html#4783054">w</a></span><span class="op" id="4783287">+</span><span class="num" id="4783288">1</span><span class="op" id="4783289">]</span>&nbsp;<span class="op" id="4783291">=</span>&nbsp;<span class="ident" id="4783293"><a href="/regexp/syntax/parse.go.html#4783116">hi</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783298"><a href="/regexp/syntax/parse.go.html#4783054">w</a></span>&nbsp;<span class="op" id="4783300">+=</span>&nbsp;<span class="num" id="4783303">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4783306">}</span><br>
<span class="lineno">1640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783310">return</span>&nbsp;<span class="ident" id="4783317"><a href="/regexp/syntax/parse.go.html#4782979">r</a></span><span class="op" id="4783318">[</span><span class="op" id="4783319">:</span><span class="ident" id="4783320"><a href="/regexp/syntax/parse.go.html#4783054">w</a></span><span class="op" id="4783321">]</span><br>
<span class="lineno"></span><span class="op" id="4783323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4783326">//&nbsp;appendLiteral&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;literal&nbsp;x&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno">1645</span><span class="keyword" id="4783405">func</span>&nbsp;<span class="ident" id="4783410">appendLiteral</span><span class="op" id="4783423">(</span><span class="ident" id="4783424">r</span>&nbsp;<span class="op" id="4783426">[</span><span class="op" id="4783427">]</span><span class="builtintype" id="4783428">rune</span><span class="op" id="4783432">,</span>&nbsp;<span class="ident" id="4783434">x</span>&nbsp;<span class="builtintype" id="4783436">rune</span><span class="op" id="4783440">,</span>&nbsp;<span class="ident" id="4783442">flags</span>&nbsp;<span class="ident" id="4783448"><a href="/regexp/syntax/parse.go.html#4744412">Flags</a></span><span class="op" id="4783453">)</span>&nbsp;<span class="op" id="4783455">[</span><span class="op" id="4783456">]</span><span class="builtintype" id="4783457">rune</span>&nbsp;<span class="op" id="4783462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783465">if</span>&nbsp;<span class="ident" id="4783468"><a href="/regexp/syntax/parse.go.html#4783442">flags</a></span><span class="op" id="4783473">&amp;</span><span class="ident" id="4783474"><a href="/regexp/syntax/parse.go.html#4744435">FoldCase</a></span>&nbsp;<span class="op" id="4783483">!=</span>&nbsp;<span class="num" id="4783486">0</span>&nbsp;<span class="op" id="4783488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783492">return</span>&nbsp;<span class="ident" id="4783499"><a href="/regexp/syntax/parse.go.html#4784445">appendFoldedRange</a></span><span class="op" id="4783516">(</span><span class="ident" id="4783517"><a href="/regexp/syntax/parse.go.html#4783424">r</a></span><span class="op" id="4783518">,</span>&nbsp;<span class="ident" id="4783520"><a href="/regexp/syntax/parse.go.html#4783434">x</a></span><span class="op" id="4783521">,</span>&nbsp;<span class="ident" id="4783523"><a href="/regexp/syntax/parse.go.html#4783434">x</a></span><span class="op" id="4783524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4783527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783530">return</span>&nbsp;<span class="ident" id="4783537"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4783548">(</span><span class="ident" id="4783549"><a href="/regexp/syntax/parse.go.html#4783424">r</a></span><span class="op" id="4783550">,</span>&nbsp;<span class="ident" id="4783552"><a href="/regexp/syntax/parse.go.html#4783434">x</a></span><span class="op" id="4783553">,</span>&nbsp;<span class="ident" id="4783555"><a href="/regexp/syntax/parse.go.html#4783434">x</a></span><span class="op" id="4783556">)</span><br>
<span class="lineno">1650</span><span class="op" id="4783558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4783561">//&nbsp;appendRange&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;range&nbsp;lo-hi&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="4783640">func</span>&nbsp;<span class="ident" id="4783645">appendRange</span><span class="op" id="4783656">(</span><span class="ident" id="4783657">r</span>&nbsp;<span class="op" id="4783659">[</span><span class="op" id="4783660">]</span><span class="builtintype" id="4783661">rune</span><span class="op" id="4783665">,</span>&nbsp;<span class="ident" id="4783667">lo</span><span class="op" id="4783669">,</span>&nbsp;<span class="ident" id="4783671">hi</span>&nbsp;<span class="builtintype" id="4783674">rune</span><span class="op" id="4783678">)</span>&nbsp;<span class="op" id="4783680">[</span><span class="op" id="4783681">]</span><span class="builtintype" id="4783682">rune</span>&nbsp;<span class="op" id="4783687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4783690">//&nbsp;Expand&nbsp;last&nbsp;range&nbsp;or&nbsp;next&nbsp;to&nbsp;last&nbsp;range&nbsp;if&nbsp;it&nbsp;overlaps&nbsp;or&nbsp;abuts.</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4783759">//&nbsp;Checking&nbsp;two&nbsp;ranges&nbsp;helps&nbsp;when&nbsp;appending&nbsp;case-folded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4783816">//&nbsp;alphabets,&nbsp;so&nbsp;that&nbsp;one&nbsp;range&nbsp;can&nbsp;be&nbsp;expanding&nbsp;A-Z&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4783878">//&nbsp;other&nbsp;expanding&nbsp;a-z.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783903">n</span>&nbsp;<span class="op" id="4783905">:=</span>&nbsp;<span class="builtinfunc" id="4783908">len</span><span class="op" id="4783911">(</span><span class="ident" id="4783912"><a href="/regexp/syntax/parse.go.html#4783657">r</a></span><span class="op" id="4783913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783916">for</span>&nbsp;<span class="ident" id="4783920">i</span>&nbsp;<span class="op" id="4783922">:=</span>&nbsp;<span class="num" id="4783925">2</span><span class="op" id="4783926">;</span>&nbsp;<span class="ident" id="4783928"><a href="/regexp/syntax/parse.go.html#4783920">i</a></span>&nbsp;<span class="op" id="4783930">&lt;=</span>&nbsp;<span class="num" id="4783933">4</span><span class="op" id="4783934">;</span>&nbsp;<span class="ident" id="4783936"><a href="/regexp/syntax/parse.go.html#4783920">i</a></span>&nbsp;<span class="op" id="4783938">+=</span>&nbsp;<span class="num" id="4783941">2</span>&nbsp;<span class="op" id="4783943">{</span>&nbsp;<span class="comment" id="4783945">//&nbsp;twice,&nbsp;using&nbsp;i=2,&nbsp;i=4</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783972">if</span>&nbsp;<span class="ident" id="4783975"><a href="/regexp/syntax/parse.go.html#4783903">n</a></span>&nbsp;<span class="op" id="4783977">&gt;=</span>&nbsp;<span class="ident" id="4783980"><a href="/regexp/syntax/parse.go.html#4783920">i</a></span>&nbsp;<span class="op" id="4783982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783987">rlo</span><span class="op" id="4783990">,</span>&nbsp;<span class="ident" id="4783992">rhi</span>&nbsp;<span class="op" id="4783996">:=</span>&nbsp;<span class="ident" id="4783999"><a href="/regexp/syntax/parse.go.html#4783657">r</a></span><span class="op" id="4784000">[</span><span class="ident" id="4784001"><a href="/regexp/syntax/parse.go.html#4783903">n</a></span><span class="op" id="4784002">-</span><span class="ident" id="4784003"><a href="/regexp/syntax/parse.go.html#4783920">i</a></span><span class="op" id="4784004">]</span><span class="op" id="4784005">,</span>&nbsp;<span class="ident" id="4784007"><a href="/regexp/syntax/parse.go.html#4783657">r</a></span><span class="op" id="4784008">[</span><span class="ident" id="4784009"><a href="/regexp/syntax/parse.go.html#4783903">n</a></span><span class="op" id="4784010">-</span><span class="ident" id="4784011"><a href="/regexp/syntax/parse.go.html#4783920">i</a></span><span class="op" id="4784012">+</span><span class="num" id="4784013">1</span><span class="op" id="4784014">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784019">if</span>&nbsp;<span class="ident" id="4784022"><a href="/regexp/syntax/parse.go.html#4783667">lo</a></span>&nbsp;<span class="op" id="4784025">&lt;=</span>&nbsp;<span class="ident" id="4784028"><a href="/regexp/syntax/parse.go.html#4783992">rhi</a></span><span class="op" id="4784031">+</span><span class="num" id="4784032">1</span>&nbsp;<span class="op" id="4784034">&amp;&amp;</span>&nbsp;<span class="ident" id="4784037"><a href="/regexp/syntax/parse.go.html#4783987">rlo</a></span>&nbsp;<span class="op" id="4784041">&lt;=</span>&nbsp;<span class="ident" id="4784044"><a href="/regexp/syntax/parse.go.html#4783671">hi</a></span><span class="op" id="4784046">+</span><span class="num" id="4784047">1</span>&nbsp;<span class="op" id="4784049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784055">if</span>&nbsp;<span class="ident" id="4784058"><a href="/regexp/syntax/parse.go.html#4783667">lo</a></span>&nbsp;<span class="op" id="4784061">&lt;</span>&nbsp;<span class="ident" id="4784063"><a href="/regexp/syntax/parse.go.html#4783987">rlo</a></span>&nbsp;<span class="op" id="4784067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4784074"><a href="/regexp/syntax/parse.go.html#4783657">r</a></span><span class="op" id="4784075">[</span><span class="ident" id="4784076"><a href="/regexp/syntax/parse.go.html#4783903">n</a></span><span class="op" id="4784077">-</span><span class="ident" id="4784078"><a href="/regexp/syntax/parse.go.html#4783920">i</a></span><span class="op" id="4784079">]</span>&nbsp;<span class="op" id="4784081">=</span>&nbsp;<span class="ident" id="4784083"><a href="/regexp/syntax/parse.go.html#4783667">lo</a></span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4784090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784096">if</span>&nbsp;<span class="ident" id="4784099"><a href="/regexp/syntax/parse.go.html#4783671">hi</a></span>&nbsp;<span class="op" id="4784102">&gt;</span>&nbsp;<span class="ident" id="4784104"><a href="/regexp/syntax/parse.go.html#4783992">rhi</a></span>&nbsp;<span class="op" id="4784108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4784115"><a href="/regexp/syntax/parse.go.html#4783657">r</a></span><span class="op" id="4784116">[</span><span class="ident" id="4784117"><a href="/regexp/syntax/parse.go.html#4783903">n</a></span><span class="op" id="4784118">-</span><span class="ident" id="4784119"><a href="/regexp/syntax/parse.go.html#4783920">i</a></span><span class="op" id="4784120">+</span><span class="num" id="4784121">1</span><span class="op" id="4784122">]</span>&nbsp;<span class="op" id="4784124">=</span>&nbsp;<span class="ident" id="4784126"><a href="/regexp/syntax/parse.go.html#4783671">hi</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4784133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784139">return</span>&nbsp;<span class="ident" id="4784146"><a href="/regexp/syntax/parse.go.html#4783657">r</a></span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4784151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4784155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4784158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784162">return</span>&nbsp;<span class="builtinfunc" id="4784169">append</span><span class="op" id="4784175">(</span><span class="ident" id="4784176"><a href="/regexp/syntax/parse.go.html#4783657">r</a></span><span class="op" id="4784177">,</span>&nbsp;<span class="ident" id="4784179"><a href="/regexp/syntax/parse.go.html#4783667">lo</a></span><span class="op" id="4784181">,</span>&nbsp;<span class="ident" id="4784183"><a href="/regexp/syntax/parse.go.html#4783671">hi</a></span><span class="op" id="4784185">)</span><br>
<span class="lineno">1675</span><span class="op" id="4784187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4784190">const</span>&nbsp;<span class="op" id="4784196">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4784199">//&nbsp;minimum&nbsp;and&nbsp;maximum&nbsp;runes&nbsp;involved&nbsp;in&nbsp;folding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4784250">//&nbsp;checked&nbsp;during&nbsp;test.</span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4784275">minFold</span>&nbsp;<span class="op" id="4784283">=</span>&nbsp;<span class="num" id="4784285">0x0041</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4784293">maxFold</span>&nbsp;<span class="op" id="4784301">=</span>&nbsp;<span class="num" id="4784303">0x118df</span><br>
<span class="lineno"></span><span class="op" id="4784311">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4784314">//&nbsp;appendFoldedRange&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;range&nbsp;lo-hi</span><br>
<span class="lineno">1685</span><span class="comment" id="4784383">//&nbsp;and&nbsp;its&nbsp;case&nbsp;folding-equivalent&nbsp;runes&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="4784440">func</span>&nbsp;<span class="ident" id="4784445">appendFoldedRange</span><span class="op" id="4784462">(</span><span class="ident" id="4784463">r</span>&nbsp;<span class="op" id="4784465">[</span><span class="op" id="4784466">]</span><span class="builtintype" id="4784467">rune</span><span class="op" id="4784471">,</span>&nbsp;<span class="ident" id="4784473">lo</span><span class="op" id="4784475">,</span>&nbsp;<span class="ident" id="4784477">hi</span>&nbsp;<span class="builtintype" id="4784480">rune</span><span class="op" id="4784484">)</span>&nbsp;<span class="op" id="4784486">[</span><span class="op" id="4784487">]</span><span class="builtintype" id="4784488">rune</span>&nbsp;<span class="op" id="4784493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4784496">//&nbsp;Optimizations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784515">if</span>&nbsp;<span class="ident" id="4784518"><a href="/regexp/syntax/parse.go.html#4784473">lo</a></span>&nbsp;<span class="op" id="4784521">&lt;=</span>&nbsp;<span class="ident" id="4784524"><a href="/regexp/syntax/parse.go.html#4784275">minFold</a></span>&nbsp;<span class="op" id="4784532">&amp;&amp;</span>&nbsp;<span class="ident" id="4784535"><a href="/regexp/syntax/parse.go.html#4784477">hi</a></span>&nbsp;<span class="op" id="4784538">&gt;=</span>&nbsp;<span class="ident" id="4784541"><a href="/regexp/syntax/parse.go.html#4784293">maxFold</a></span>&nbsp;<span class="op" id="4784549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4784553">//&nbsp;Range&nbsp;is&nbsp;full:&nbsp;folding&nbsp;can&#39;t&nbsp;add&nbsp;more.</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784597">return</span>&nbsp;<span class="ident" id="4784604"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4784615">(</span><span class="ident" id="4784616"><a href="/regexp/syntax/parse.go.html#4784463">r</a></span><span class="op" id="4784617">,</span>&nbsp;<span class="ident" id="4784619"><a href="/regexp/syntax/parse.go.html#4784473">lo</a></span><span class="op" id="4784621">,</span>&nbsp;<span class="ident" id="4784623"><a href="/regexp/syntax/parse.go.html#4784477">hi</a></span><span class="op" id="4784625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4784628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784631">if</span>&nbsp;<span class="ident" id="4784634"><a href="/regexp/syntax/parse.go.html#4784477">hi</a></span>&nbsp;<span class="op" id="4784637">&lt;</span>&nbsp;<span class="ident" id="4784639"><a href="/regexp/syntax/parse.go.html#4784275">minFold</a></span>&nbsp;<span class="op" id="4784647">||</span>&nbsp;<span class="ident" id="4784650"><a href="/regexp/syntax/parse.go.html#4784473">lo</a></span>&nbsp;<span class="op" id="4784653">&gt;</span>&nbsp;<span class="ident" id="4784655"><a href="/regexp/syntax/parse.go.html#4784293">maxFold</a></span>&nbsp;<span class="op" id="4784663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4784667">//&nbsp;Range&nbsp;is&nbsp;outside&nbsp;folding&nbsp;possibilities.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784712">return</span>&nbsp;<span class="ident" id="4784719"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4784730">(</span><span class="ident" id="4784731"><a href="/regexp/syntax/parse.go.html#4784463">r</a></span><span class="op" id="4784732">,</span>&nbsp;<span class="ident" id="4784734"><a href="/regexp/syntax/parse.go.html#4784473">lo</a></span><span class="op" id="4784736">,</span>&nbsp;<span class="ident" id="4784738"><a href="/regexp/syntax/parse.go.html#4784477">hi</a></span><span class="op" id="4784740">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4784743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784746">if</span>&nbsp;<span class="ident" id="4784749"><a href="/regexp/syntax/parse.go.html#4784473">lo</a></span>&nbsp;<span class="op" id="4784752">&lt;</span>&nbsp;<span class="ident" id="4784754"><a href="/regexp/syntax/parse.go.html#4784275">minFold</a></span>&nbsp;<span class="op" id="4784762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4784766">//&nbsp;[lo,&nbsp;minFold-1]&nbsp;needs&nbsp;no&nbsp;folding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4784805"><a href="/regexp/syntax/parse.go.html#4784463">r</a></span>&nbsp;<span class="op" id="4784807">=</span>&nbsp;<span class="ident" id="4784809"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4784820">(</span><span class="ident" id="4784821"><a href="/regexp/syntax/parse.go.html#4784463">r</a></span><span class="op" id="4784822">,</span>&nbsp;<span class="ident" id="4784824"><a href="/regexp/syntax/parse.go.html#4784473">lo</a></span><span class="op" id="4784826">,</span>&nbsp;<span class="ident" id="4784828"><a href="/regexp/syntax/parse.go.html#4784275">minFold</a></span><span class="op" id="4784835">-</span><span class="num" id="4784836">1</span><span class="op" id="4784837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4784841"><a href="/regexp/syntax/parse.go.html#4784473">lo</a></span>&nbsp;<span class="op" id="4784844">=</span>&nbsp;<span class="ident" id="4784846"><a href="/regexp/syntax/parse.go.html#4784275">minFold</a></span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4784855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784858">if</span>&nbsp;<span class="ident" id="4784861"><a href="/regexp/syntax/parse.go.html#4784477">hi</a></span>&nbsp;<span class="op" id="4784864">&gt;</span>&nbsp;<span class="ident" id="4784866"><a href="/regexp/syntax/parse.go.html#4784293">maxFold</a></span>&nbsp;<span class="op" id="4784874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4784878">//&nbsp;[maxFold+1,&nbsp;hi]&nbsp;needs&nbsp;no&nbsp;folding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4784917"><a href="/regexp/syntax/parse.go.html#4784463">r</a></span>&nbsp;<span class="op" id="4784919">=</span>&nbsp;<span class="ident" id="4784921"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4784932">(</span><span class="ident" id="4784933"><a href="/regexp/syntax/parse.go.html#4784463">r</a></span><span class="op" id="4784934">,</span>&nbsp;<span class="ident" id="4784936"><a href="/regexp/syntax/parse.go.html#4784293">maxFold</a></span><span class="op" id="4784943">+</span><span class="num" id="4784944">1</span><span class="op" id="4784945">,</span>&nbsp;<span class="ident" id="4784947"><a href="/regexp/syntax/parse.go.html#4784477">hi</a></span><span class="op" id="4784949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4784953"><a href="/regexp/syntax/parse.go.html#4784477">hi</a></span>&nbsp;<span class="op" id="4784956">=</span>&nbsp;<span class="ident" id="4784958"><a href="/regexp/syntax/parse.go.html#4784293">maxFold</a></span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4784967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4784971">//&nbsp;Brute&nbsp;force.&nbsp;&nbsp;Depend&nbsp;on&nbsp;appendRange&nbsp;to&nbsp;coalesce&nbsp;ranges&nbsp;on&nbsp;the&nbsp;fly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4785042">for</span>&nbsp;<span class="ident" id="4785046">c</span>&nbsp;<span class="op" id="4785048">:=</span>&nbsp;<span class="ident" id="4785051"><a href="/regexp/syntax/parse.go.html#4784473">lo</a></span><span class="op" id="4785053">;</span>&nbsp;<span class="ident" id="4785055"><a href="/regexp/syntax/parse.go.html#4785046">c</a></span>&nbsp;<span class="op" id="4785057">&lt;=</span>&nbsp;<span class="ident" id="4785060"><a href="/regexp/syntax/parse.go.html#4784477">hi</a></span><span class="op" id="4785062">;</span>&nbsp;<span class="ident" id="4785064"><a href="/regexp/syntax/parse.go.html#4785046">c</a></span><span class="op" id="4785065">++</span>&nbsp;<span class="op" id="4785068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4785072"><a href="/regexp/syntax/parse.go.html#4784463">r</a></span>&nbsp;<span class="op" id="4785074">=</span>&nbsp;<span class="ident" id="4785076"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4785087">(</span><span class="ident" id="4785088"><a href="/regexp/syntax/parse.go.html#4784463">r</a></span><span class="op" id="4785089">,</span>&nbsp;<span class="ident" id="4785091"><a href="/regexp/syntax/parse.go.html#4785046">c</a></span><span class="op" id="4785092">,</span>&nbsp;<span class="ident" id="4785094"><a href="/regexp/syntax/parse.go.html#4785046">c</a></span><span class="op" id="4785095">)</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4785099">f</span>&nbsp;<span class="op" id="4785101">:=</span>&nbsp;<span class="ident" id="4785104"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4785111">.</span><span class="ident" id="4785112">SimpleFold</span><span class="op" id="4785122">(</span><span class="ident" id="4785123"><a href="/regexp/syntax/parse.go.html#4785046">c</a></span><span class="op" id="4785124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4785128">for</span>&nbsp;<span class="ident" id="4785132"><a href="/regexp/syntax/parse.go.html#4785099">f</a></span>&nbsp;<span class="op" id="4785134">!=</span>&nbsp;<span class="ident" id="4785137"><a href="/regexp/syntax/parse.go.html#4785046">c</a></span>&nbsp;<span class="op" id="4785139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4785144"><a href="/regexp/syntax/parse.go.html#4784463">r</a></span>&nbsp;<span class="op" id="4785146">=</span>&nbsp;<span class="ident" id="4785148"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4785159">(</span><span class="ident" id="4785160"><a href="/regexp/syntax/parse.go.html#4784463">r</a></span><span class="op" id="4785161">,</span>&nbsp;<span class="ident" id="4785163"><a href="/regexp/syntax/parse.go.html#4785099">f</a></span><span class="op" id="4785164">,</span>&nbsp;<span class="ident" id="4785166"><a href="/regexp/syntax/parse.go.html#4785099">f</a></span><span class="op" id="4785167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4785172"><a href="/regexp/syntax/parse.go.html#4785099">f</a></span>&nbsp;<span class="op" id="4785174">=</span>&nbsp;<span class="ident" id="4785176"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4785183">.</span><span class="ident" id="4785184">SimpleFold</span><span class="op" id="4785194">(</span><span class="ident" id="4785195"><a href="/regexp/syntax/parse.go.html#4785099">f</a></span><span class="op" id="4785196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4785200">}</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4785203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4785206">return</span>&nbsp;<span class="ident" id="4785213"><a href="/regexp/syntax/parse.go.html#4784463">r</a></span><br>
<span class="lineno"></span><span class="op" id="4785215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4785218">//&nbsp;appendClass&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;class&nbsp;x&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno">1720</span><span class="comment" id="4785293">//&nbsp;It&nbsp;assume&nbsp;x&nbsp;is&nbsp;clean.</span><br>
<span class="lineno"></span><span class="keyword" id="4785318">func</span>&nbsp;<span class="ident" id="4785323">appendClass</span><span class="op" id="4785334">(</span><span class="ident" id="4785335">r</span>&nbsp;<span class="op" id="4785337">[</span><span class="op" id="4785338">]</span><span class="builtintype" id="4785339">rune</span><span class="op" id="4785343">,</span>&nbsp;<span class="ident" id="4785345">x</span>&nbsp;<span class="op" id="4785347">[</span><span class="op" id="4785348">]</span><span class="builtintype" id="4785349">rune</span><span class="op" id="4785353">)</span>&nbsp;<span class="op" id="4785355">[</span><span class="op" id="4785356">]</span><span class="builtintype" id="4785357">rune</span>&nbsp;<span class="op" id="4785362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4785365">for</span>&nbsp;<span class="ident" id="4785369">i</span>&nbsp;<span class="op" id="4785371">:=</span>&nbsp;<span class="num" id="4785374">0</span><span class="op" id="4785375">;</span>&nbsp;<span class="ident" id="4785377"><a href="/regexp/syntax/parse.go.html#4785369">i</a></span>&nbsp;<span class="op" id="4785379">&lt;</span>&nbsp;<span class="builtinfunc" id="4785381">len</span><span class="op" id="4785384">(</span><span class="ident" id="4785385"><a href="/regexp/syntax/parse.go.html#4785345">x</a></span><span class="op" id="4785386">)</span><span class="op" id="4785387">;</span>&nbsp;<span class="ident" id="4785389"><a href="/regexp/syntax/parse.go.html#4785369">i</a></span>&nbsp;<span class="op" id="4785391">+=</span>&nbsp;<span class="num" id="4785394">2</span>&nbsp;<span class="op" id="4785396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4785400"><a href="/regexp/syntax/parse.go.html#4785335">r</a></span>&nbsp;<span class="op" id="4785402">=</span>&nbsp;<span class="ident" id="4785404"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4785415">(</span><span class="ident" id="4785416"><a href="/regexp/syntax/parse.go.html#4785335">r</a></span><span class="op" id="4785417">,</span>&nbsp;<span class="ident" id="4785419"><a href="/regexp/syntax/parse.go.html#4785345">x</a></span><span class="op" id="4785420">[</span><span class="ident" id="4785421"><a href="/regexp/syntax/parse.go.html#4785369">i</a></span><span class="op" id="4785422">]</span><span class="op" id="4785423">,</span>&nbsp;<span class="ident" id="4785425"><a href="/regexp/syntax/parse.go.html#4785345">x</a></span><span class="op" id="4785426">[</span><span class="ident" id="4785427"><a href="/regexp/syntax/parse.go.html#4785369">i</a></span><span class="op" id="4785428">+</span><span class="num" id="4785429">1</span><span class="op" id="4785430">]</span><span class="op" id="4785431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4785434">}</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4785437">return</span>&nbsp;<span class="ident" id="4785444"><a href="/regexp/syntax/parse.go.html#4785335">r</a></span><br>
<span class="lineno"></span><span class="op" id="4785446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4785449">//&nbsp;appendFolded&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;case&nbsp;folding&nbsp;of&nbsp;the&nbsp;class&nbsp;x&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="4785545">func</span>&nbsp;<span class="ident" id="4785550">appendFoldedClass</span><span class="op" id="4785567">(</span><span class="ident" id="4785568">r</span>&nbsp;<span class="op" id="4785570">[</span><span class="op" id="4785571">]</span><span class="builtintype" id="4785572">rune</span><span class="op" id="4785576">,</span>&nbsp;<span class="ident" id="4785578">x</span>&nbsp;<span class="op" id="4785580">[</span><span class="op" id="4785581">]</span><span class="builtintype" id="4785582">rune</span><span class="op" id="4785586">)</span>&nbsp;<span class="op" id="4785588">[</span><span class="op" id="4785589">]</span><span class="builtintype" id="4785590">rune</span>&nbsp;<span class="op" id="4785595">{</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4785598">for</span>&nbsp;<span class="ident" id="4785602">i</span>&nbsp;<span class="op" id="4785604">:=</span>&nbsp;<span class="num" id="4785607">0</span><span class="op" id="4785608">;</span>&nbsp;<span class="ident" id="4785610"><a href="/regexp/syntax/parse.go.html#4785602">i</a></span>&nbsp;<span class="op" id="4785612">&lt;</span>&nbsp;<span class="builtinfunc" id="4785614">len</span><span class="op" id="4785617">(</span><span class="ident" id="4785618"><a href="/regexp/syntax/parse.go.html#4785578">x</a></span><span class="op" id="4785619">)</span><span class="op" id="4785620">;</span>&nbsp;<span class="ident" id="4785622"><a href="/regexp/syntax/parse.go.html#4785602">i</a></span>&nbsp;<span class="op" id="4785624">+=</span>&nbsp;<span class="num" id="4785627">2</span>&nbsp;<span class="op" id="4785629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4785633"><a href="/regexp/syntax/parse.go.html#4785568">r</a></span>&nbsp;<span class="op" id="4785635">=</span>&nbsp;<span class="ident" id="4785637"><a href="/regexp/syntax/parse.go.html#4784445">appendFoldedRange</a></span><span class="op" id="4785654">(</span><span class="ident" id="4785655"><a href="/regexp/syntax/parse.go.html#4785568">r</a></span><span class="op" id="4785656">,</span>&nbsp;<span class="ident" id="4785658"><a href="/regexp/syntax/parse.go.html#4785578">x</a></span><span class="op" id="4785659">[</span><span class="ident" id="4785660"><a href="/regexp/syntax/parse.go.html#4785602">i</a></span><span class="op" id="4785661">]</span><span class="op" id="4785662">,</span>&nbsp;<span class="ident" id="4785664"><a href="/regexp/syntax/parse.go.html#4785578">x</a></span><span class="op" id="4785665">[</span><span class="ident" id="4785666"><a href="/regexp/syntax/parse.go.html#4785602">i</a></span><span class="op" id="4785667">+</span><span class="num" id="4785668">1</span><span class="op" id="4785669">]</span><span class="op" id="4785670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4785673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4785676">return</span>&nbsp;<span class="ident" id="4785683"><a href="/regexp/syntax/parse.go.html#4785568">r</a></span><br>
<span class="lineno"></span><span class="op" id="4785685">}</span><br>
<span class="lineno">1735</span><br>
<span class="lineno"></span><span class="comment" id="4785688">//&nbsp;appendNegatedClass&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;negation&nbsp;of&nbsp;the&nbsp;class&nbsp;x&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="4785786">//&nbsp;It&nbsp;assumes&nbsp;x&nbsp;is&nbsp;clean.</span><br>
<span class="lineno"></span><span class="keyword" id="4785812">func</span>&nbsp;<span class="ident" id="4785817">appendNegatedClass</span><span class="op" id="4785835">(</span><span class="ident" id="4785836">r</span>&nbsp;<span class="op" id="4785838">[</span><span class="op" id="4785839">]</span><span class="builtintype" id="4785840">rune</span><span class="op" id="4785844">,</span>&nbsp;<span class="ident" id="4785846">x</span>&nbsp;<span class="op" id="4785848">[</span><span class="op" id="4785849">]</span><span class="builtintype" id="4785850">rune</span><span class="op" id="4785854">)</span>&nbsp;<span class="op" id="4785856">[</span><span class="op" id="4785857">]</span><span class="builtintype" id="4785858">rune</span>&nbsp;<span class="op" id="4785863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4785866">nextLo</span>&nbsp;<span class="op" id="4785873">:=</span>&nbsp;<span class="string" id="4785876">&#39;\u0000&#39;</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4785886">for</span>&nbsp;<span class="ident" id="4785890">i</span>&nbsp;<span class="op" id="4785892">:=</span>&nbsp;<span class="num" id="4785895">0</span><span class="op" id="4785896">;</span>&nbsp;<span class="ident" id="4785898"><a href="/regexp/syntax/parse.go.html#4785890">i</a></span>&nbsp;<span class="op" id="4785900">&lt;</span>&nbsp;<span class="builtinfunc" id="4785902">len</span><span class="op" id="4785905">(</span><span class="ident" id="4785906"><a href="/regexp/syntax/parse.go.html#4785846">x</a></span><span class="op" id="4785907">)</span><span class="op" id="4785908">;</span>&nbsp;<span class="ident" id="4785910"><a href="/regexp/syntax/parse.go.html#4785890">i</a></span>&nbsp;<span class="op" id="4785912">+=</span>&nbsp;<span class="num" id="4785915">2</span>&nbsp;<span class="op" id="4785917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4785921">lo</span><span class="op" id="4785923">,</span>&nbsp;<span class="ident" id="4785925">hi</span>&nbsp;<span class="op" id="4785928">:=</span>&nbsp;<span class="ident" id="4785931"><a href="/regexp/syntax/parse.go.html#4785846">x</a></span><span class="op" id="4785932">[</span><span class="ident" id="4785933"><a href="/regexp/syntax/parse.go.html#4785890">i</a></span><span class="op" id="4785934">]</span><span class="op" id="4785935">,</span>&nbsp;<span class="ident" id="4785937"><a href="/regexp/syntax/parse.go.html#4785846">x</a></span><span class="op" id="4785938">[</span><span class="ident" id="4785939"><a href="/regexp/syntax/parse.go.html#4785890">i</a></span><span class="op" id="4785940">+</span><span class="num" id="4785941">1</span><span class="op" id="4785942">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4785946">if</span>&nbsp;<span class="ident" id="4785949"><a href="/regexp/syntax/parse.go.html#4785866">nextLo</a></span>&nbsp;<span class="op" id="4785956">&lt;=</span>&nbsp;<span class="ident" id="4785959"><a href="/regexp/syntax/parse.go.html#4785921">lo</a></span><span class="op" id="4785961">-</span><span class="num" id="4785962">1</span>&nbsp;<span class="op" id="4785964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4785969"><a href="/regexp/syntax/parse.go.html#4785836">r</a></span>&nbsp;<span class="op" id="4785971">=</span>&nbsp;<span class="ident" id="4785973"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4785984">(</span><span class="ident" id="4785985"><a href="/regexp/syntax/parse.go.html#4785836">r</a></span><span class="op" id="4785986">,</span>&nbsp;<span class="ident" id="4785988"><a href="/regexp/syntax/parse.go.html#4785866">nextLo</a></span><span class="op" id="4785994">,</span>&nbsp;<span class="ident" id="4785996"><a href="/regexp/syntax/parse.go.html#4785921">lo</a></span><span class="op" id="4785998">-</span><span class="num" id="4785999">1</span><span class="op" id="4786000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4786004">}</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4786008"><a href="/regexp/syntax/parse.go.html#4785866">nextLo</a></span>&nbsp;<span class="op" id="4786015">=</span>&nbsp;<span class="ident" id="4786017"><a href="/regexp/syntax/parse.go.html#4785925">hi</a></span>&nbsp;<span class="op" id="4786020">+</span>&nbsp;<span class="num" id="4786022">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4786025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4786028">if</span>&nbsp;<span class="ident" id="4786031"><a href="/regexp/syntax/parse.go.html#4785866">nextLo</a></span>&nbsp;<span class="op" id="4786038">&lt;=</span>&nbsp;<span class="ident" id="4786041"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4786048">.</span><span class="ident" id="4786049">MaxRune</span>&nbsp;<span class="op" id="4786057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4786061"><a href="/regexp/syntax/parse.go.html#4785836">r</a></span>&nbsp;<span class="op" id="4786063">=</span>&nbsp;<span class="ident" id="4786065"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4786076">(</span><span class="ident" id="4786077"><a href="/regexp/syntax/parse.go.html#4785836">r</a></span><span class="op" id="4786078">,</span>&nbsp;<span class="ident" id="4786080"><a href="/regexp/syntax/parse.go.html#4785866">nextLo</a></span><span class="op" id="4786086">,</span>&nbsp;<span class="ident" id="4786088"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4786095">.</span><span class="ident" id="4786096">MaxRune</span><span class="op" id="4786103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4786106">}</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4786109">return</span>&nbsp;<span class="ident" id="4786116"><a href="/regexp/syntax/parse.go.html#4785836">r</a></span><br>
<span class="lineno"></span><span class="op" id="4786118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4786121">//&nbsp;appendTable&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;x&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="4786186">func</span>&nbsp;<span class="ident" id="4786191">appendTable</span><span class="op" id="4786202">(</span><span class="ident" id="4786203">r</span>&nbsp;<span class="op" id="4786205">[</span><span class="op" id="4786206">]</span><span class="builtintype" id="4786207">rune</span><span class="op" id="4786211">,</span>&nbsp;<span class="ident" id="4786213">x</span>&nbsp;<span class="op" id="4786215">*</span><span class="ident" id="4786216"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4786223">.</span><span class="ident" id="4786224">RangeTable</span><span class="op" id="4786234">)</span>&nbsp;<span class="op" id="4786236">[</span><span class="op" id="4786237">]</span><span class="builtintype" id="4786238">rune</span>&nbsp;<span class="op" id="4786243">{</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4786246">for</span>&nbsp;<span class="ident" id="4786250">_</span><span class="op" id="4786251">,</span>&nbsp;<span class="ident" id="4786253">xr</span>&nbsp;<span class="op" id="4786256">:=</span>&nbsp;<span class="keyword" id="4786259">range</span>&nbsp;<span class="ident" id="4786265"><a href="/regexp/syntax/parse.go.html#4786213">x</a></span><span class="op" id="4786266">.</span><span class="ident" id="4786267">R16</span>&nbsp;<span class="op" id="4786271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4786275">lo</span><span class="op" id="4786277">,</span>&nbsp;<span class="ident" id="4786279">hi</span><span class="op" id="4786281">,</span>&nbsp;<span class="ident" id="4786283">stride</span>&nbsp;<span class="op" id="4786290">:=</span>&nbsp;<span class="builtintype" id="4786293">rune</span><span class="op" id="4786297">(</span><span class="ident" id="4786298"><a href="/regexp/syntax/parse.go.html#4786253">xr</a></span><span class="op" id="4786300">.</span><span class="ident" id="4786301">Lo</span><span class="op" id="4786303">)</span><span class="op" id="4786304">,</span>&nbsp;<span class="builtintype" id="4786306">rune</span><span class="op" id="4786310">(</span><span class="ident" id="4786311"><a href="/regexp/syntax/parse.go.html#4786253">xr</a></span><span class="op" id="4786313">.</span><span class="ident" id="4786314">Hi</span><span class="op" id="4786316">)</span><span class="op" id="4786317">,</span>&nbsp;<span class="builtintype" id="4786319">rune</span><span class="op" id="4786323">(</span><span class="ident" id="4786324"><a href="/regexp/syntax/parse.go.html#4786253">xr</a></span><span class="op" id="4786326">.</span><span class="ident" id="4786327">Stride</span><span class="op" id="4786333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4786337">if</span>&nbsp;<span class="ident" id="4786340"><a href="/regexp/syntax/parse.go.html#4786283">stride</a></span>&nbsp;<span class="op" id="4786347">==</span>&nbsp;<span class="num" id="4786350">1</span>&nbsp;<span class="op" id="4786352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4786357"><a href="/regexp/syntax/parse.go.html#4786203">r</a></span>&nbsp;<span class="op" id="4786359">=</span>&nbsp;<span class="ident" id="4786361"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4786372">(</span><span class="ident" id="4786373"><a href="/regexp/syntax/parse.go.html#4786203">r</a></span><span class="op" id="4786374">,</span>&nbsp;<span class="ident" id="4786376"><a href="/regexp/syntax/parse.go.html#4786275">lo</a></span><span class="op" id="4786378">,</span>&nbsp;<span class="ident" id="4786380"><a href="/regexp/syntax/parse.go.html#4786279">hi</a></span><span class="op" id="4786382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4786387">continue</span><br>
<span class="lineno">1760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4786398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4786402">for</span>&nbsp;<span class="ident" id="4786406">c</span>&nbsp;<span class="op" id="4786408">:=</span>&nbsp;<span class="ident" id="4786411"><a href="/regexp/syntax/parse.go.html#4786275">lo</a></span><span class="op" id="4786413">;</span>&nbsp;<span class="ident" id="4786415"><a href="/regexp/syntax/parse.go.html#4786406">c</a></span>&nbsp;<span class="op" id="4786417">&lt;=</span>&nbsp;<span class="ident" id="4786420"><a href="/regexp/syntax/parse.go.html#4786279">hi</a></span><span class="op" id="4786422">;</span>&nbsp;<span class="ident" id="4786424"><a href="/regexp/syntax/parse.go.html#4786406">c</a></span>&nbsp;<span class="op" id="4786426">+=</span>&nbsp;<span class="ident" id="4786429"><a href="/regexp/syntax/parse.go.html#4786283">stride</a></span>&nbsp;<span class="op" id="4786436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4786441"><a href="/regexp/syntax/parse.go.html#4786203">r</a></span>&nbsp;<span class="op" id="4786443">=</span>&nbsp;<span class="ident" id="4786445"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4786456">(</span><span class="ident" id="4786457"><a href="/regexp/syntax/parse.go.html#4786203">r</a></span><span class="op" id="4786458">,</span>&nbsp;<span class="ident" id="4786460"><a href="/regexp/syntax/parse.go.html#4786406">c</a></span><span class="op" id="4786461">,</span>&nbsp;<span class="ident" id="4786463"><a href="/regexp/syntax/parse.go.html#4786406">c</a></span><span class="op" id="4786464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4786468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4786471">}</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4786474">for</span>&nbsp;<span class="ident" id="4786478">_</span><span class="op" id="4786479">,</span>&nbsp;<span class="ident" id="4786481">xr</span>&nbsp;<span class="op" id="4786484">:=</span>&nbsp;<span class="keyword" id="4786487">range</span>&nbsp;<span class="ident" id="4786493"><a href="/regexp/syntax/parse.go.html#4786213">x</a></span><span class="op" id="4786494">.</span><span class="ident" id="4786495">R32</span>&nbsp;<span class="op" id="4786499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4786503">lo</span><span class="op" id="4786505">,</span>&nbsp;<span class="ident" id="4786507">hi</span><span class="op" id="4786509">,</span>&nbsp;<span class="ident" id="4786511">stride</span>&nbsp;<span class="op" id="4786518">:=</span>&nbsp;<span class="builtintype" id="4786521">rune</span><span class="op" id="4786525">(</span><span class="ident" id="4786526"><a href="/regexp/syntax/parse.go.html#4786481">xr</a></span><span class="op" id="4786528">.</span><span class="ident" id="4786529">Lo</span><span class="op" id="4786531">)</span><span class="op" id="4786532">,</span>&nbsp;<span class="builtintype" id="4786534">rune</span><span class="op" id="4786538">(</span><span class="ident" id="4786539"><a href="/regexp/syntax/parse.go.html#4786481">xr</a></span><span class="op" id="4786541">.</span><span class="ident" id="4786542">Hi</span><span class="op" id="4786544">)</span><span class="op" id="4786545">,</span>&nbsp;<span class="builtintype" id="4786547">rune</span><span class="op" id="4786551">(</span><span class="ident" id="4786552"><a href="/regexp/syntax/parse.go.html#4786481">xr</a></span><span class="op" id="4786554">.</span><span class="ident" id="4786555">Stride</span><span class="op" id="4786561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4786565">if</span>&nbsp;<span class="ident" id="4786568"><a href="/regexp/syntax/parse.go.html#4786511">stride</a></span>&nbsp;<span class="op" id="4786575">==</span>&nbsp;<span class="num" id="4786578">1</span>&nbsp;<span class="op" id="4786580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4786585"><a href="/regexp/syntax/parse.go.html#4786203">r</a></span>&nbsp;<span class="op" id="4786587">=</span>&nbsp;<span class="ident" id="4786589"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4786600">(</span><span class="ident" id="4786601"><a href="/regexp/syntax/parse.go.html#4786203">r</a></span><span class="op" id="4786602">,</span>&nbsp;<span class="ident" id="4786604"><a href="/regexp/syntax/parse.go.html#4786503">lo</a></span><span class="op" id="4786606">,</span>&nbsp;<span class="ident" id="4786608"><a href="/regexp/syntax/parse.go.html#4786507">hi</a></span><span class="op" id="4786610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4786615">continue</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4786626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4786630">for</span>&nbsp;<span class="ident" id="4786634">c</span>&nbsp;<span class="op" id="4786636">:=</span>&nbsp;<span class="ident" id="4786639"><a href="/regexp/syntax/parse.go.html#4786503">lo</a></span><span class="op" id="4786641">;</span>&nbsp;<span class="ident" id="4786643"><a href="/regexp/syntax/parse.go.html#4786634">c</a></span>&nbsp;<span class="op" id="4786645">&lt;=</span>&nbsp;<span class="ident" id="4786648"><a href="/regexp/syntax/parse.go.html#4786507">hi</a></span><span class="op" id="4786650">;</span>&nbsp;<span class="ident" id="4786652"><a href="/regexp/syntax/parse.go.html#4786634">c</a></span>&nbsp;<span class="op" id="4786654">+=</span>&nbsp;<span class="ident" id="4786657"><a href="/regexp/syntax/parse.go.html#4786511">stride</a></span>&nbsp;<span class="op" id="4786664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4786669"><a href="/regexp/syntax/parse.go.html#4786203">r</a></span>&nbsp;<span class="op" id="4786671">=</span>&nbsp;<span class="ident" id="4786673"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4786684">(</span><span class="ident" id="4786685"><a href="/regexp/syntax/parse.go.html#4786203">r</a></span><span class="op" id="4786686">,</span>&nbsp;<span class="ident" id="4786688"><a href="/regexp/syntax/parse.go.html#4786634">c</a></span><span class="op" id="4786689">,</span>&nbsp;<span class="ident" id="4786691"><a href="/regexp/syntax/parse.go.html#4786634">c</a></span><span class="op" id="4786692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4786696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4786699">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4786702">return</span>&nbsp;<span class="ident" id="4786709"><a href="/regexp/syntax/parse.go.html#4786203">r</a></span><br>
<span class="lineno"></span><span class="op" id="4786711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4786714">//&nbsp;appendNegatedTable&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;negation&nbsp;of&nbsp;x&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="4786802">func</span>&nbsp;<span class="ident" id="4786807">appendNegatedTable</span><span class="op" id="4786825">(</span><span class="ident" id="4786826">r</span>&nbsp;<span class="op" id="4786828">[</span><span class="op" id="4786829">]</span><span class="builtintype" id="4786830">rune</span><span class="op" id="4786834">,</span>&nbsp;<span class="ident" id="4786836">x</span>&nbsp;<span class="op" id="4786838">*</span><span class="ident" id="4786839"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4786846">.</span><span class="ident" id="4786847">RangeTable</span><span class="op" id="4786857">)</span>&nbsp;<span class="op" id="4786859">[</span><span class="op" id="4786860">]</span><span class="builtintype" id="4786861">rune</span>&nbsp;<span class="op" id="4786866">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4786869">nextLo</span>&nbsp;<span class="op" id="4786876">:=</span>&nbsp;<span class="string" id="4786879">&#39;\u0000&#39;</span>&nbsp;<span class="comment" id="4786888">//&nbsp;lo&nbsp;end&nbsp;of&nbsp;next&nbsp;class&nbsp;to&nbsp;add</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4786920">for</span>&nbsp;<span class="ident" id="4786924">_</span><span class="op" id="4786925">,</span>&nbsp;<span class="ident" id="4786927">xr</span>&nbsp;<span class="op" id="4786930">:=</span>&nbsp;<span class="keyword" id="4786933">range</span>&nbsp;<span class="ident" id="4786939"><a href="/regexp/syntax/parse.go.html#4786836">x</a></span><span class="op" id="4786940">.</span><span class="ident" id="4786941">R16</span>&nbsp;<span class="op" id="4786945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4786949">lo</span><span class="op" id="4786951">,</span>&nbsp;<span class="ident" id="4786953">hi</span><span class="op" id="4786955">,</span>&nbsp;<span class="ident" id="4786957">stride</span>&nbsp;<span class="op" id="4786964">:=</span>&nbsp;<span class="builtintype" id="4786967">rune</span><span class="op" id="4786971">(</span><span class="ident" id="4786972"><a href="/regexp/syntax/parse.go.html#4786927">xr</a></span><span class="op" id="4786974">.</span><span class="ident" id="4786975">Lo</span><span class="op" id="4786977">)</span><span class="op" id="4786978">,</span>&nbsp;<span class="builtintype" id="4786980">rune</span><span class="op" id="4786984">(</span><span class="ident" id="4786985"><a href="/regexp/syntax/parse.go.html#4786927">xr</a></span><span class="op" id="4786987">.</span><span class="ident" id="4786988">Hi</span><span class="op" id="4786990">)</span><span class="op" id="4786991">,</span>&nbsp;<span class="builtintype" id="4786993">rune</span><span class="op" id="4786997">(</span><span class="ident" id="4786998"><a href="/regexp/syntax/parse.go.html#4786927">xr</a></span><span class="op" id="4787000">.</span><span class="ident" id="4787001">Stride</span><span class="op" id="4787007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787011">if</span>&nbsp;<span class="ident" id="4787014"><a href="/regexp/syntax/parse.go.html#4786957">stride</a></span>&nbsp;<span class="op" id="4787021">==</span>&nbsp;<span class="num" id="4787024">1</span>&nbsp;<span class="op" id="4787026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787031">if</span>&nbsp;<span class="ident" id="4787034"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span>&nbsp;<span class="op" id="4787041">&lt;=</span>&nbsp;<span class="ident" id="4787044"><a href="/regexp/syntax/parse.go.html#4786949">lo</a></span><span class="op" id="4787046">-</span><span class="num" id="4787047">1</span>&nbsp;<span class="op" id="4787049">{</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787055"><a href="/regexp/syntax/parse.go.html#4786826">r</a></span>&nbsp;<span class="op" id="4787057">=</span>&nbsp;<span class="ident" id="4787059"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4787070">(</span><span class="ident" id="4787071"><a href="/regexp/syntax/parse.go.html#4786826">r</a></span><span class="op" id="4787072">,</span>&nbsp;<span class="ident" id="4787074"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span><span class="op" id="4787080">,</span>&nbsp;<span class="ident" id="4787082"><a href="/regexp/syntax/parse.go.html#4786949">lo</a></span><span class="op" id="4787084">-</span><span class="num" id="4787085">1</span><span class="op" id="4787086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4787091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787096"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span>&nbsp;<span class="op" id="4787103">=</span>&nbsp;<span class="ident" id="4787105"><a href="/regexp/syntax/parse.go.html#4786953">hi</a></span>&nbsp;<span class="op" id="4787108">+</span>&nbsp;<span class="num" id="4787110">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787115">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4787126">}</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787130">for</span>&nbsp;<span class="ident" id="4787134">c</span>&nbsp;<span class="op" id="4787136">:=</span>&nbsp;<span class="ident" id="4787139"><a href="/regexp/syntax/parse.go.html#4786949">lo</a></span><span class="op" id="4787141">;</span>&nbsp;<span class="ident" id="4787143"><a href="/regexp/syntax/parse.go.html#4787134">c</a></span>&nbsp;<span class="op" id="4787145">&lt;=</span>&nbsp;<span class="ident" id="4787148"><a href="/regexp/syntax/parse.go.html#4786953">hi</a></span><span class="op" id="4787150">;</span>&nbsp;<span class="ident" id="4787152"><a href="/regexp/syntax/parse.go.html#4787134">c</a></span>&nbsp;<span class="op" id="4787154">+=</span>&nbsp;<span class="ident" id="4787157"><a href="/regexp/syntax/parse.go.html#4786957">stride</a></span>&nbsp;<span class="op" id="4787164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787169">if</span>&nbsp;<span class="ident" id="4787172"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span>&nbsp;<span class="op" id="4787179">&lt;=</span>&nbsp;<span class="ident" id="4787182"><a href="/regexp/syntax/parse.go.html#4787134">c</a></span><span class="op" id="4787183">-</span><span class="num" id="4787184">1</span>&nbsp;<span class="op" id="4787186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787192"><a href="/regexp/syntax/parse.go.html#4786826">r</a></span>&nbsp;<span class="op" id="4787194">=</span>&nbsp;<span class="ident" id="4787196"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4787207">(</span><span class="ident" id="4787208"><a href="/regexp/syntax/parse.go.html#4786826">r</a></span><span class="op" id="4787209">,</span>&nbsp;<span class="ident" id="4787211"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span><span class="op" id="4787217">,</span>&nbsp;<span class="ident" id="4787219"><a href="/regexp/syntax/parse.go.html#4787134">c</a></span><span class="op" id="4787220">-</span><span class="num" id="4787221">1</span><span class="op" id="4787222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4787227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787232"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span>&nbsp;<span class="op" id="4787239">=</span>&nbsp;<span class="ident" id="4787241"><a href="/regexp/syntax/parse.go.html#4787134">c</a></span>&nbsp;<span class="op" id="4787243">+</span>&nbsp;<span class="num" id="4787245">1</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4787249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4787252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787255">for</span>&nbsp;<span class="ident" id="4787259">_</span><span class="op" id="4787260">,</span>&nbsp;<span class="ident" id="4787262">xr</span>&nbsp;<span class="op" id="4787265">:=</span>&nbsp;<span class="keyword" id="4787268">range</span>&nbsp;<span class="ident" id="4787274"><a href="/regexp/syntax/parse.go.html#4786836">x</a></span><span class="op" id="4787275">.</span><span class="ident" id="4787276">R32</span>&nbsp;<span class="op" id="4787280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787284">lo</span><span class="op" id="4787286">,</span>&nbsp;<span class="ident" id="4787288">hi</span><span class="op" id="4787290">,</span>&nbsp;<span class="ident" id="4787292">stride</span>&nbsp;<span class="op" id="4787299">:=</span>&nbsp;<span class="builtintype" id="4787302">rune</span><span class="op" id="4787306">(</span><span class="ident" id="4787307"><a href="/regexp/syntax/parse.go.html#4787262">xr</a></span><span class="op" id="4787309">.</span><span class="ident" id="4787310">Lo</span><span class="op" id="4787312">)</span><span class="op" id="4787313">,</span>&nbsp;<span class="builtintype" id="4787315">rune</span><span class="op" id="4787319">(</span><span class="ident" id="4787320"><a href="/regexp/syntax/parse.go.html#4787262">xr</a></span><span class="op" id="4787322">.</span><span class="ident" id="4787323">Hi</span><span class="op" id="4787325">)</span><span class="op" id="4787326">,</span>&nbsp;<span class="builtintype" id="4787328">rune</span><span class="op" id="4787332">(</span><span class="ident" id="4787333"><a href="/regexp/syntax/parse.go.html#4787262">xr</a></span><span class="op" id="4787335">.</span><span class="ident" id="4787336">Stride</span><span class="op" id="4787342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787346">if</span>&nbsp;<span class="ident" id="4787349"><a href="/regexp/syntax/parse.go.html#4787292">stride</a></span>&nbsp;<span class="op" id="4787356">==</span>&nbsp;<span class="num" id="4787359">1</span>&nbsp;<span class="op" id="4787361">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787366">if</span>&nbsp;<span class="ident" id="4787369"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span>&nbsp;<span class="op" id="4787376">&lt;=</span>&nbsp;<span class="ident" id="4787379"><a href="/regexp/syntax/parse.go.html#4787284">lo</a></span><span class="op" id="4787381">-</span><span class="num" id="4787382">1</span>&nbsp;<span class="op" id="4787384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787390"><a href="/regexp/syntax/parse.go.html#4786826">r</a></span>&nbsp;<span class="op" id="4787392">=</span>&nbsp;<span class="ident" id="4787394"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4787405">(</span><span class="ident" id="4787406"><a href="/regexp/syntax/parse.go.html#4786826">r</a></span><span class="op" id="4787407">,</span>&nbsp;<span class="ident" id="4787409"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span><span class="op" id="4787415">,</span>&nbsp;<span class="ident" id="4787417"><a href="/regexp/syntax/parse.go.html#4787284">lo</a></span><span class="op" id="4787419">-</span><span class="num" id="4787420">1</span><span class="op" id="4787421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4787426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787431"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span>&nbsp;<span class="op" id="4787438">=</span>&nbsp;<span class="ident" id="4787440"><a href="/regexp/syntax/parse.go.html#4787288">hi</a></span>&nbsp;<span class="op" id="4787443">+</span>&nbsp;<span class="num" id="4787445">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787450">continue</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4787461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787465">for</span>&nbsp;<span class="ident" id="4787469">c</span>&nbsp;<span class="op" id="4787471">:=</span>&nbsp;<span class="ident" id="4787474"><a href="/regexp/syntax/parse.go.html#4787284">lo</a></span><span class="op" id="4787476">;</span>&nbsp;<span class="ident" id="4787478"><a href="/regexp/syntax/parse.go.html#4787469">c</a></span>&nbsp;<span class="op" id="4787480">&lt;=</span>&nbsp;<span class="ident" id="4787483"><a href="/regexp/syntax/parse.go.html#4787288">hi</a></span><span class="op" id="4787485">;</span>&nbsp;<span class="ident" id="4787487"><a href="/regexp/syntax/parse.go.html#4787469">c</a></span>&nbsp;<span class="op" id="4787489">+=</span>&nbsp;<span class="ident" id="4787492"><a href="/regexp/syntax/parse.go.html#4787292">stride</a></span>&nbsp;<span class="op" id="4787499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787504">if</span>&nbsp;<span class="ident" id="4787507"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span>&nbsp;<span class="op" id="4787514">&lt;=</span>&nbsp;<span class="ident" id="4787517"><a href="/regexp/syntax/parse.go.html#4787469">c</a></span><span class="op" id="4787518">-</span><span class="num" id="4787519">1</span>&nbsp;<span class="op" id="4787521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787527"><a href="/regexp/syntax/parse.go.html#4786826">r</a></span>&nbsp;<span class="op" id="4787529">=</span>&nbsp;<span class="ident" id="4787531"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4787542">(</span><span class="ident" id="4787543"><a href="/regexp/syntax/parse.go.html#4786826">r</a></span><span class="op" id="4787544">,</span>&nbsp;<span class="ident" id="4787546"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span><span class="op" id="4787552">,</span>&nbsp;<span class="ident" id="4787554"><a href="/regexp/syntax/parse.go.html#4787469">c</a></span><span class="op" id="4787555">-</span><span class="num" id="4787556">1</span><span class="op" id="4787557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4787562">}</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787567"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span>&nbsp;<span class="op" id="4787574">=</span>&nbsp;<span class="ident" id="4787576"><a href="/regexp/syntax/parse.go.html#4787469">c</a></span>&nbsp;<span class="op" id="4787578">+</span>&nbsp;<span class="num" id="4787580">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4787584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4787587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787590">if</span>&nbsp;<span class="ident" id="4787593"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span>&nbsp;<span class="op" id="4787600">&lt;=</span>&nbsp;<span class="ident" id="4787603"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4787610">.</span><span class="ident" id="4787611">MaxRune</span>&nbsp;<span class="op" id="4787619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787623"><a href="/regexp/syntax/parse.go.html#4786826">r</a></span>&nbsp;<span class="op" id="4787625">=</span>&nbsp;<span class="ident" id="4787627"><a href="/regexp/syntax/parse.go.html#4783645">appendRange</a></span><span class="op" id="4787638">(</span><span class="ident" id="4787639"><a href="/regexp/syntax/parse.go.html#4786826">r</a></span><span class="op" id="4787640">,</span>&nbsp;<span class="ident" id="4787642"><a href="/regexp/syntax/parse.go.html#4786869">nextLo</a></span><span class="op" id="4787648">,</span>&nbsp;<span class="ident" id="4787650"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4787657">.</span><span class="ident" id="4787658">MaxRune</span><span class="op" id="4787665">)</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4787668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787671">return</span>&nbsp;<span class="ident" id="4787678"><a href="/regexp/syntax/parse.go.html#4786826">r</a></span><br>
<span class="lineno"></span><span class="op" id="4787680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4787683">//&nbsp;negateClass&nbsp;overwrites&nbsp;r&nbsp;and&nbsp;returns&nbsp;r&#39;s&nbsp;negation.</span><br>
<span class="lineno">1820</span><span class="comment" id="4787737">//&nbsp;It&nbsp;assumes&nbsp;the&nbsp;class&nbsp;r&nbsp;is&nbsp;already&nbsp;clean.</span><br>
<span class="lineno"></span><span class="keyword" id="4787781">func</span>&nbsp;<span class="ident" id="4787786">negateClass</span><span class="op" id="4787797">(</span><span class="ident" id="4787798">r</span>&nbsp;<span class="op" id="4787800">[</span><span class="op" id="4787801">]</span><span class="builtintype" id="4787802">rune</span><span class="op" id="4787806">)</span>&nbsp;<span class="op" id="4787808">[</span><span class="op" id="4787809">]</span><span class="builtintype" id="4787810">rune</span>&nbsp;<span class="op" id="4787815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787818">nextLo</span>&nbsp;<span class="op" id="4787825">:=</span>&nbsp;<span class="string" id="4787828">&#39;\u0000&#39;</span>&nbsp;<span class="comment" id="4787837">//&nbsp;lo&nbsp;end&nbsp;of&nbsp;next&nbsp;class&nbsp;to&nbsp;add</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787869">w</span>&nbsp;<span class="op" id="4787871">:=</span>&nbsp;<span class="num" id="4787874">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4787888">//&nbsp;write&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787904">for</span>&nbsp;<span class="ident" id="4787908">i</span>&nbsp;<span class="op" id="4787910">:=</span>&nbsp;<span class="num" id="4787913">0</span><span class="op" id="4787914">;</span>&nbsp;<span class="ident" id="4787916"><a href="/regexp/syntax/parse.go.html#4787908">i</a></span>&nbsp;<span class="op" id="4787918">&lt;</span>&nbsp;<span class="builtinfunc" id="4787920">len</span><span class="op" id="4787923">(</span><span class="ident" id="4787924"><a href="/regexp/syntax/parse.go.html#4787798">r</a></span><span class="op" id="4787925">)</span><span class="op" id="4787926">;</span>&nbsp;<span class="ident" id="4787928"><a href="/regexp/syntax/parse.go.html#4787908">i</a></span>&nbsp;<span class="op" id="4787930">+=</span>&nbsp;<span class="num" id="4787933">2</span>&nbsp;<span class="op" id="4787935">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787939">lo</span><span class="op" id="4787941">,</span>&nbsp;<span class="ident" id="4787943">hi</span>&nbsp;<span class="op" id="4787946">:=</span>&nbsp;<span class="ident" id="4787949"><a href="/regexp/syntax/parse.go.html#4787798">r</a></span><span class="op" id="4787950">[</span><span class="ident" id="4787951"><a href="/regexp/syntax/parse.go.html#4787908">i</a></span><span class="op" id="4787952">]</span><span class="op" id="4787953">,</span>&nbsp;<span class="ident" id="4787955"><a href="/regexp/syntax/parse.go.html#4787798">r</a></span><span class="op" id="4787956">[</span><span class="ident" id="4787957"><a href="/regexp/syntax/parse.go.html#4787908">i</a></span><span class="op" id="4787958">+</span><span class="num" id="4787959">1</span><span class="op" id="4787960">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4787964">if</span>&nbsp;<span class="ident" id="4787967"><a href="/regexp/syntax/parse.go.html#4787818">nextLo</a></span>&nbsp;<span class="op" id="4787974">&lt;=</span>&nbsp;<span class="ident" id="4787977"><a href="/regexp/syntax/parse.go.html#4787939">lo</a></span><span class="op" id="4787979">-</span><span class="num" id="4787980">1</span>&nbsp;<span class="op" id="4787982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4787987"><a href="/regexp/syntax/parse.go.html#4787798">r</a></span><span class="op" id="4787988">[</span><span class="ident" id="4787989"><a href="/regexp/syntax/parse.go.html#4787869">w</a></span><span class="op" id="4787990">]</span>&nbsp;<span class="op" id="4787992">=</span>&nbsp;<span class="ident" id="4787994"><a href="/regexp/syntax/parse.go.html#4787818">nextLo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788004"><a href="/regexp/syntax/parse.go.html#4787798">r</a></span><span class="op" id="4788005">[</span><span class="ident" id="4788006"><a href="/regexp/syntax/parse.go.html#4787869">w</a></span><span class="op" id="4788007">+</span><span class="num" id="4788008">1</span><span class="op" id="4788009">]</span>&nbsp;<span class="op" id="4788011">=</span>&nbsp;<span class="ident" id="4788013"><a href="/regexp/syntax/parse.go.html#4787939">lo</a></span>&nbsp;<span class="op" id="4788016">-</span>&nbsp;<span class="num" id="4788018">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788023"><a href="/regexp/syntax/parse.go.html#4787869">w</a></span>&nbsp;<span class="op" id="4788025">+=</span>&nbsp;<span class="num" id="4788028">2</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4788032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788036"><a href="/regexp/syntax/parse.go.html#4787818">nextLo</a></span>&nbsp;<span class="op" id="4788043">=</span>&nbsp;<span class="ident" id="4788045"><a href="/regexp/syntax/parse.go.html#4787943">hi</a></span>&nbsp;<span class="op" id="4788048">+</span>&nbsp;<span class="num" id="4788050">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4788053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788056"><a href="/regexp/syntax/parse.go.html#4787798">r</a></span>&nbsp;<span class="op" id="4788058">=</span>&nbsp;<span class="ident" id="4788060"><a href="/regexp/syntax/parse.go.html#4787798">r</a></span><span class="op" id="4788061">[</span><span class="op" id="4788062">:</span><span class="ident" id="4788063"><a href="/regexp/syntax/parse.go.html#4787869">w</a></span><span class="op" id="4788064">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4788067">if</span>&nbsp;<span class="ident" id="4788070"><a href="/regexp/syntax/parse.go.html#4787818">nextLo</a></span>&nbsp;<span class="op" id="4788077">&lt;=</span>&nbsp;<span class="ident" id="4788080"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4788087">.</span><span class="ident" id="4788088">MaxRune</span>&nbsp;<span class="op" id="4788096">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4788100">//&nbsp;It&#39;s&nbsp;possible&nbsp;for&nbsp;the&nbsp;negation&nbsp;to&nbsp;have&nbsp;one&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4788153">//&nbsp;range&nbsp;-&nbsp;this&nbsp;one&nbsp;-&nbsp;than&nbsp;the&nbsp;original&nbsp;class,&nbsp;so&nbsp;use&nbsp;append.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788217"><a href="/regexp/syntax/parse.go.html#4787798">r</a></span>&nbsp;<span class="op" id="4788219">=</span>&nbsp;<span class="builtinfunc" id="4788221">append</span><span class="op" id="4788227">(</span><span class="ident" id="4788228"><a href="/regexp/syntax/parse.go.html#4787798">r</a></span><span class="op" id="4788229">,</span>&nbsp;<span class="ident" id="4788231"><a href="/regexp/syntax/parse.go.html#4787818">nextLo</a></span><span class="op" id="4788237">,</span>&nbsp;<span class="ident" id="4788239"><a href="/regexp/syntax/parse.go.html#4742912">unicode</a></span><span class="op" id="4788246">.</span><span class="ident" id="4788247">MaxRune</span><span class="op" id="4788254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4788257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4788260">return</span>&nbsp;<span class="ident" id="4788267"><a href="/regexp/syntax/parse.go.html#4787798">r</a></span><br>
<span class="lineno">1840</span><span class="op" id="4788269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4788272">//&nbsp;ranges&nbsp;implements&nbsp;sort.Interface&nbsp;on&nbsp;a&nbsp;[]rune.</span><br>
<span class="lineno"></span><span class="comment" id="4788321">//&nbsp;The&nbsp;choice&nbsp;of&nbsp;receiver&nbsp;type&nbsp;definition&nbsp;is&nbsp;strange</span><br>
<span class="lineno"></span><span class="comment" id="4788374">//&nbsp;but&nbsp;avoids&nbsp;an&nbsp;allocation&nbsp;since&nbsp;we&nbsp;already&nbsp;have</span><br>
<span class="lineno">1845</span><span class="comment" id="4788424">//&nbsp;a&nbsp;*[]rune.</span><br>
<span class="lineno"></span><span class="keyword" id="4788438">type</span>&nbsp;<span class="ident" id="4788443">ranges</span>&nbsp;<span class="keyword" id="4788450">struct</span>&nbsp;<span class="op" id="4788457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788460">p</span>&nbsp;<span class="op" id="4788462">*</span><span class="op" id="4788463">[</span><span class="op" id="4788464">]</span><span class="builtintype" id="4788465">rune</span><br>
<span class="lineno"></span><span class="op" id="4788470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4788473">func</span>&nbsp;<span class="op" id="4788478">(</span><span class="ident" id="4788479">ra</span>&nbsp;<span class="ident" id="4788482"><a href="/regexp/syntax/parse.go.html#4788443">ranges</a></span><span class="op" id="4788488">)</span>&nbsp;<span class="ident" id="4788490">Less</span><span class="op" id="4788494">(</span><span class="ident" id="4788495">i</span><span class="op" id="4788496">,</span>&nbsp;<span class="ident" id="4788498">j</span>&nbsp;<span class="builtintype" id="4788500">int</span><span class="op" id="4788503">)</span>&nbsp;<span class="builtintype" id="4788505">bool</span>&nbsp;<span class="op" id="4788510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788513">p</span>&nbsp;<span class="op" id="4788515">:=</span>&nbsp;<span class="op" id="4788518">*</span><span class="ident" id="4788519"><a href="/regexp/syntax/parse.go.html#4788479">ra</a></span><span class="op" id="4788521">.</span><span class="ident" id="4788522">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788525"><a href="/regexp/syntax/parse.go.html#4788495">i</a></span>&nbsp;<span class="op" id="4788527">*=</span>&nbsp;<span class="num" id="4788530">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788533"><a href="/regexp/syntax/parse.go.html#4788498">j</a></span>&nbsp;<span class="op" id="4788535">*=</span>&nbsp;<span class="num" id="4788538">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4788541">return</span>&nbsp;<span class="ident" id="4788548"><a href="/regexp/syntax/parse.go.html#4788513">p</a></span><span class="op" id="4788549">[</span><span class="ident" id="4788550"><a href="/regexp/syntax/parse.go.html#4788495">i</a></span><span class="op" id="4788551">]</span>&nbsp;<span class="op" id="4788553">&lt;</span>&nbsp;<span class="ident" id="4788555"><a href="/regexp/syntax/parse.go.html#4788513">p</a></span><span class="op" id="4788556">[</span><span class="ident" id="4788557"><a href="/regexp/syntax/parse.go.html#4788498">j</a></span><span class="op" id="4788558">]</span>&nbsp;<span class="op" id="4788560">||</span>&nbsp;<span class="ident" id="4788563"><a href="/regexp/syntax/parse.go.html#4788513">p</a></span><span class="op" id="4788564">[</span><span class="ident" id="4788565"><a href="/regexp/syntax/parse.go.html#4788495">i</a></span><span class="op" id="4788566">]</span>&nbsp;<span class="op" id="4788568">==</span>&nbsp;<span class="ident" id="4788571"><a href="/regexp/syntax/parse.go.html#4788513">p</a></span><span class="op" id="4788572">[</span><span class="ident" id="4788573"><a href="/regexp/syntax/parse.go.html#4788498">j</a></span><span class="op" id="4788574">]</span>&nbsp;<span class="op" id="4788576">&amp;&amp;</span>&nbsp;<span class="ident" id="4788579"><a href="/regexp/syntax/parse.go.html#4788513">p</a></span><span class="op" id="4788580">[</span><span class="ident" id="4788581"><a href="/regexp/syntax/parse.go.html#4788495">i</a></span><span class="op" id="4788582">+</span><span class="num" id="4788583">1</span><span class="op" id="4788584">]</span>&nbsp;<span class="op" id="4788586">&gt;</span>&nbsp;<span class="ident" id="4788588"><a href="/regexp/syntax/parse.go.html#4788513">p</a></span><span class="op" id="4788589">[</span><span class="ident" id="4788590"><a href="/regexp/syntax/parse.go.html#4788498">j</a></span><span class="op" id="4788591">+</span><span class="num" id="4788592">1</span><span class="op" id="4788593">]</span><br>
<span class="lineno">1855</span><span class="op" id="4788595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4788598">func</span>&nbsp;<span class="op" id="4788603">(</span><span class="ident" id="4788604">ra</span>&nbsp;<span class="ident" id="4788607"><a href="/regexp/syntax/parse.go.html#4788443">ranges</a></span><span class="op" id="4788613">)</span>&nbsp;<span class="ident" id="4788615">Len</span><span class="op" id="4788618">(</span><span class="op" id="4788619">)</span>&nbsp;<span class="builtintype" id="4788621">int</span>&nbsp;<span class="op" id="4788625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4788628">return</span>&nbsp;<span class="builtinfunc" id="4788635">len</span><span class="op" id="4788638">(</span><span class="op" id="4788639">*</span><span class="ident" id="4788640"><a href="/regexp/syntax/parse.go.html#4788604">ra</a></span><span class="op" id="4788642">.</span><span class="ident" id="4788643">p</span><span class="op" id="4788644">)</span>&nbsp;<span class="op" id="4788646">/</span>&nbsp;<span class="num" id="4788648">2</span><br>
<span class="lineno"></span><span class="op" id="4788650">}</span><br>
<span class="lineno">1860</span><br>
<span class="lineno"></span><span class="keyword" id="4788653">func</span>&nbsp;<span class="op" id="4788658">(</span><span class="ident" id="4788659">ra</span>&nbsp;<span class="ident" id="4788662"><a href="/regexp/syntax/parse.go.html#4788443">ranges</a></span><span class="op" id="4788668">)</span>&nbsp;<span class="ident" id="4788670">Swap</span><span class="op" id="4788674">(</span><span class="ident" id="4788675">i</span><span class="op" id="4788676">,</span>&nbsp;<span class="ident" id="4788678">j</span>&nbsp;<span class="builtintype" id="4788680">int</span><span class="op" id="4788683">)</span>&nbsp;<span class="op" id="4788685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788688">p</span>&nbsp;<span class="op" id="4788690">:=</span>&nbsp;<span class="op" id="4788693">*</span><span class="ident" id="4788694"><a href="/regexp/syntax/parse.go.html#4788659">ra</a></span><span class="op" id="4788696">.</span><span class="ident" id="4788697">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788700"><a href="/regexp/syntax/parse.go.html#4788675">i</a></span>&nbsp;<span class="op" id="4788702">*=</span>&nbsp;<span class="num" id="4788705">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788708"><a href="/regexp/syntax/parse.go.html#4788678">j</a></span>&nbsp;<span class="op" id="4788710">*=</span>&nbsp;<span class="num" id="4788713">2</span><br>
<span class="lineno">1865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788716"><a href="/regexp/syntax/parse.go.html#4788688">p</a></span><span class="op" id="4788717">[</span><span class="ident" id="4788718"><a href="/regexp/syntax/parse.go.html#4788675">i</a></span><span class="op" id="4788719">]</span><span class="op" id="4788720">,</span>&nbsp;<span class="ident" id="4788722"><a href="/regexp/syntax/parse.go.html#4788688">p</a></span><span class="op" id="4788723">[</span><span class="ident" id="4788724"><a href="/regexp/syntax/parse.go.html#4788675">i</a></span><span class="op" id="4788725">+</span><span class="num" id="4788726">1</span><span class="op" id="4788727">]</span><span class="op" id="4788728">,</span>&nbsp;<span class="ident" id="4788730"><a href="/regexp/syntax/parse.go.html#4788688">p</a></span><span class="op" id="4788731">[</span><span class="ident" id="4788732"><a href="/regexp/syntax/parse.go.html#4788678">j</a></span><span class="op" id="4788733">]</span><span class="op" id="4788734">,</span>&nbsp;<span class="ident" id="4788736"><a href="/regexp/syntax/parse.go.html#4788688">p</a></span><span class="op" id="4788737">[</span><span class="ident" id="4788738"><a href="/regexp/syntax/parse.go.html#4788678">j</a></span><span class="op" id="4788739">+</span><span class="num" id="4788740">1</span><span class="op" id="4788741">]</span>&nbsp;<span class="op" id="4788743">=</span>&nbsp;<span class="ident" id="4788745"><a href="/regexp/syntax/parse.go.html#4788688">p</a></span><span class="op" id="4788746">[</span><span class="ident" id="4788747"><a href="/regexp/syntax/parse.go.html#4788678">j</a></span><span class="op" id="4788748">]</span><span class="op" id="4788749">,</span>&nbsp;<span class="ident" id="4788751"><a href="/regexp/syntax/parse.go.html#4788688">p</a></span><span class="op" id="4788752">[</span><span class="ident" id="4788753"><a href="/regexp/syntax/parse.go.html#4788678">j</a></span><span class="op" id="4788754">+</span><span class="num" id="4788755">1</span><span class="op" id="4788756">]</span><span class="op" id="4788757">,</span>&nbsp;<span class="ident" id="4788759"><a href="/regexp/syntax/parse.go.html#4788688">p</a></span><span class="op" id="4788760">[</span><span class="ident" id="4788761"><a href="/regexp/syntax/parse.go.html#4788675">i</a></span><span class="op" id="4788762">]</span><span class="op" id="4788763">,</span>&nbsp;<span class="ident" id="4788765"><a href="/regexp/syntax/parse.go.html#4788688">p</a></span><span class="op" id="4788766">[</span><span class="ident" id="4788767"><a href="/regexp/syntax/parse.go.html#4788675">i</a></span><span class="op" id="4788768">+</span><span class="num" id="4788769">1</span><span class="op" id="4788770">]</span><br>
<span class="lineno"></span><span class="op" id="4788772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4788775">func</span>&nbsp;<span class="ident" id="4788780">checkUTF8</span><span class="op" id="4788789">(</span><span class="ident" id="4788790">s</span>&nbsp;<span class="builtintype" id="4788792">string</span><span class="op" id="4788798">)</span>&nbsp;<span class="builtintype" id="4788800">error</span>&nbsp;<span class="op" id="4788806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4788809">for</span>&nbsp;<span class="ident" id="4788813"><a href="/regexp/syntax/parse.go.html#4788790">s</a></span>&nbsp;<span class="op" id="4788815">!=</span>&nbsp;<span class="string" id="4788818">&#34;&#34;</span>&nbsp;<span class="op" id="4788821">{</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4788825">rune</span><span class="op" id="4788829">,</span>&nbsp;<span class="ident" id="4788831">size</span>&nbsp;<span class="op" id="4788836">:=</span>&nbsp;<span class="ident" id="4788839"><a href="/regexp/syntax/parse.go.html#4742923">utf8</a></span><span class="op" id="4788843">.</span><span class="ident" id="4788844">DecodeRuneInString</span><span class="op" id="4788862">(</span><span class="ident" id="4788863"><a href="/regexp/syntax/parse.go.html#4788790">s</a></span><span class="op" id="4788864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4788868">if</span>&nbsp;<span class="builtintype" id="4788871"><a href="/regexp/syntax/parse.go.html#4788825">rune</a></span>&nbsp;<span class="op" id="4788876">==</span>&nbsp;<span class="ident" id="4788879"><a href="/regexp/syntax/parse.go.html#4742923">utf8</a></span><span class="op" id="4788883">.</span><span class="ident" id="4788884">RuneError</span>&nbsp;<span class="op" id="4788894">&amp;&amp;</span>&nbsp;<span class="ident" id="4788897"><a href="/regexp/syntax/parse.go.html#4788831">size</a></span>&nbsp;<span class="op" id="4788902">==</span>&nbsp;<span class="num" id="4788905">1</span>&nbsp;<span class="op" id="4788907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4788912">return</span>&nbsp;<span class="op" id="4788919">&amp;</span><span class="ident" id="4788920"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4788925">{</span><span class="ident" id="4788926">Code</span><span class="op" id="4788930">:</span>&nbsp;<span class="ident" id="4788932"><a href="/regexp/syntax/parse.go.html#4743875">ErrInvalidUTF8</a></span><span class="op" id="4788946">,</span>&nbsp;<span class="ident" id="4788948">Expr</span><span class="op" id="4788952">:</span>&nbsp;<span class="ident" id="4788954"><a href="/regexp/syntax/parse.go.html#4788790">s</a></span><span class="op" id="4788955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4788959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4788963"><a href="/regexp/syntax/parse.go.html#4788790">s</a></span>&nbsp;<span class="op" id="4788965">=</span>&nbsp;<span class="ident" id="4788967"><a href="/regexp/syntax/parse.go.html#4788790">s</a></span><span class="op" id="4788968">[</span><span class="ident" id="4788969"><a href="/regexp/syntax/parse.go.html#4788831">size</a></span><span class="op" id="4788973">:</span><span class="op" id="4788974">]</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4788977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4788980">return</span>&nbsp;<span class="ident" id="4788987">nil</span><br>
<span class="lineno"></span><span class="op" id="4788991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4788994">func</span>&nbsp;<span class="ident" id="4788999">nextRune</span><span class="op" id="4789007">(</span><span class="ident" id="4789008">s</span>&nbsp;<span class="builtintype" id="4789010">string</span><span class="op" id="4789016">)</span>&nbsp;<span class="op" id="4789018">(</span><span class="ident" id="4789019">c</span>&nbsp;<span class="builtintype" id="4789021">rune</span><span class="op" id="4789025">,</span>&nbsp;<span class="ident" id="4789027">t</span>&nbsp;<span class="builtintype" id="4789029">string</span><span class="op" id="4789035">,</span>&nbsp;<span class="ident" id="4789037">err</span>&nbsp;<span class="builtintype" id="4789041">error</span><span class="op" id="4789046">)</span>&nbsp;<span class="op" id="4789048">{</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4789051"><a href="/regexp/syntax/parse.go.html#4789019">c</a></span><span class="op" id="4789052">,</span>&nbsp;<span class="ident" id="4789054">size</span>&nbsp;<span class="op" id="4789059">:=</span>&nbsp;<span class="ident" id="4789062"><a href="/regexp/syntax/parse.go.html#4742923">utf8</a></span><span class="op" id="4789066">.</span><span class="ident" id="4789067">DecodeRuneInString</span><span class="op" id="4789085">(</span><span class="ident" id="4789086"><a href="/regexp/syntax/parse.go.html#4789008">s</a></span><span class="op" id="4789087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4789090">if</span>&nbsp;<span class="ident" id="4789093"><a href="/regexp/syntax/parse.go.html#4789019">c</a></span>&nbsp;<span class="op" id="4789095">==</span>&nbsp;<span class="ident" id="4789098"><a href="/regexp/syntax/parse.go.html#4742923">utf8</a></span><span class="op" id="4789102">.</span><span class="ident" id="4789103">RuneError</span>&nbsp;<span class="op" id="4789113">&amp;&amp;</span>&nbsp;<span class="ident" id="4789116"><a href="/regexp/syntax/parse.go.html#4789054">size</a></span>&nbsp;<span class="op" id="4789121">==</span>&nbsp;<span class="num" id="4789124">1</span>&nbsp;<span class="op" id="4789126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4789130">return</span>&nbsp;<span class="num" id="4789137">0</span><span class="op" id="4789138">,</span>&nbsp;<span class="string" id="4789140">&#34;&#34;</span><span class="op" id="4789142">,</span>&nbsp;<span class="op" id="4789144">&amp;</span><span class="ident" id="4789145"><a href="/regexp/syntax/parse.go.html#4743047">Error</a></span><span class="op" id="4789150">{</span><span class="ident" id="4789151">Code</span><span class="op" id="4789155">:</span>&nbsp;<span class="ident" id="4789157"><a href="/regexp/syntax/parse.go.html#4743875">ErrInvalidUTF8</a></span><span class="op" id="4789171">,</span>&nbsp;<span class="ident" id="4789173">Expr</span><span class="op" id="4789177">:</span>&nbsp;<span class="ident" id="4789179"><a href="/regexp/syntax/parse.go.html#4789008">s</a></span><span class="op" id="4789180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4789183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4789186">return</span>&nbsp;<span class="ident" id="4789193"><a href="/regexp/syntax/parse.go.html#4789019">c</a></span><span class="op" id="4789194">,</span>&nbsp;<span class="ident" id="4789196"><a href="/regexp/syntax/parse.go.html#4789008">s</a></span><span class="op" id="4789197">[</span><span class="ident" id="4789198"><a href="/regexp/syntax/parse.go.html#4789054">size</a></span><span class="op" id="4789202">:</span><span class="op" id="4789203">]</span><span class="op" id="4789204">,</span>&nbsp;<span class="ident" id="4789206">nil</span><br>
<span class="lineno">1885</span><span class="op" id="4789210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4789213">func</span>&nbsp;<span class="ident" id="4789218">isalnum</span><span class="op" id="4789225">(</span><span class="ident" id="4789226">c</span>&nbsp;<span class="builtintype" id="4789228">rune</span><span class="op" id="4789232">)</span>&nbsp;<span class="builtintype" id="4789234">bool</span>&nbsp;<span class="op" id="4789239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4789242">return</span>&nbsp;<span class="string" id="4789249">&#39;0&#39;</span>&nbsp;<span class="op" id="4789253">&lt;=</span>&nbsp;<span class="ident" id="4789256"><a href="/regexp/syntax/parse.go.html#4789226">c</a></span>&nbsp;<span class="op" id="4789258">&amp;&amp;</span>&nbsp;<span class="ident" id="4789261"><a href="/regexp/syntax/parse.go.html#4789226">c</a></span>&nbsp;<span class="op" id="4789263">&lt;=</span>&nbsp;<span class="string" id="4789266">&#39;9&#39;</span>&nbsp;<span class="op" id="4789270">||</span>&nbsp;<span class="string" id="4789273">&#39;A&#39;</span>&nbsp;<span class="op" id="4789277">&lt;=</span>&nbsp;<span class="ident" id="4789280"><a href="/regexp/syntax/parse.go.html#4789226">c</a></span>&nbsp;<span class="op" id="4789282">&amp;&amp;</span>&nbsp;<span class="ident" id="4789285"><a href="/regexp/syntax/parse.go.html#4789226">c</a></span>&nbsp;<span class="op" id="4789287">&lt;=</span>&nbsp;<span class="string" id="4789290">&#39;Z&#39;</span>&nbsp;<span class="op" id="4789294">||</span>&nbsp;<span class="string" id="4789297">&#39;a&#39;</span>&nbsp;<span class="op" id="4789301">&lt;=</span>&nbsp;<span class="ident" id="4789304"><a href="/regexp/syntax/parse.go.html#4789226">c</a></span>&nbsp;<span class="op" id="4789306">&amp;&amp;</span>&nbsp;<span class="ident" id="4789309"><a href="/regexp/syntax/parse.go.html#4789226">c</a></span>&nbsp;<span class="op" id="4789311">&lt;=</span>&nbsp;<span class="string" id="4789314">&#39;z&#39;</span><br>
<span class="lineno"></span><span class="op" id="4789318">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span><span class="keyword" id="4789321">func</span>&nbsp;<span class="ident" id="4789326">unhex</span><span class="op" id="4789331">(</span><span class="ident" id="4789332">c</span>&nbsp;<span class="builtintype" id="4789334">rune</span><span class="op" id="4789338">)</span>&nbsp;<span class="builtintype" id="4789340">rune</span>&nbsp;<span class="op" id="4789345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4789348">if</span>&nbsp;<span class="string" id="4789351">&#39;0&#39;</span>&nbsp;<span class="op" id="4789355">&lt;=</span>&nbsp;<span class="ident" id="4789358"><a href="/regexp/syntax/parse.go.html#4789332">c</a></span>&nbsp;<span class="op" id="4789360">&amp;&amp;</span>&nbsp;<span class="ident" id="4789363"><a href="/regexp/syntax/parse.go.html#4789332">c</a></span>&nbsp;<span class="op" id="4789365">&lt;=</span>&nbsp;<span class="string" id="4789368">&#39;9&#39;</span>&nbsp;<span class="op" id="4789372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4789376">return</span>&nbsp;<span class="ident" id="4789383"><a href="/regexp/syntax/parse.go.html#4789332">c</a></span>&nbsp;<span class="op" id="4789385">-</span>&nbsp;<span class="string" id="4789387">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4789392">}</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4789395">if</span>&nbsp;<span class="string" id="4789398">&#39;a&#39;</span>&nbsp;<span class="op" id="4789402">&lt;=</span>&nbsp;<span class="ident" id="4789405"><a href="/regexp/syntax/parse.go.html#4789332">c</a></span>&nbsp;<span class="op" id="4789407">&amp;&amp;</span>&nbsp;<span class="ident" id="4789410"><a href="/regexp/syntax/parse.go.html#4789332">c</a></span>&nbsp;<span class="op" id="4789412">&lt;=</span>&nbsp;<span class="string" id="4789415">&#39;f&#39;</span>&nbsp;<span class="op" id="4789419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4789423">return</span>&nbsp;<span class="ident" id="4789430"><a href="/regexp/syntax/parse.go.html#4789332">c</a></span>&nbsp;<span class="op" id="4789432">-</span>&nbsp;<span class="string" id="4789434">&#39;a&#39;</span>&nbsp;<span class="op" id="4789438">+</span>&nbsp;<span class="num" id="4789440">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4789444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4789447">if</span>&nbsp;<span class="string" id="4789450">&#39;A&#39;</span>&nbsp;<span class="op" id="4789454">&lt;=</span>&nbsp;<span class="ident" id="4789457"><a href="/regexp/syntax/parse.go.html#4789332">c</a></span>&nbsp;<span class="op" id="4789459">&amp;&amp;</span>&nbsp;<span class="ident" id="4789462"><a href="/regexp/syntax/parse.go.html#4789332">c</a></span>&nbsp;<span class="op" id="4789464">&lt;=</span>&nbsp;<span class="string" id="4789467">&#39;F&#39;</span>&nbsp;<span class="op" id="4789471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4789475">return</span>&nbsp;<span class="ident" id="4789482"><a href="/regexp/syntax/parse.go.html#4789332">c</a></span>&nbsp;<span class="op" id="4789484">-</span>&nbsp;<span class="string" id="4789486">&#39;A&#39;</span>&nbsp;<span class="op" id="4789490">+</span>&nbsp;<span class="num" id="4789492">10</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4789496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4789499">return</span>&nbsp;<span class="op" id="4789506">-</span><span class="num" id="4789507">1</span><br>
<span class="lineno"></span><span class="op" id="4789509">}</span>
</div>
</body>
</html>
