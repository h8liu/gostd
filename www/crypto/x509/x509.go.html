<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4316283">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4316338">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4316392">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4316443">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4316503">package</span>&nbsp;<span class="ident" id="4316511">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4316517">import</span>&nbsp;<span class="op" id="4316524">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316527">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316536">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316546">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316560">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316576">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316595">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316609">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316624">_</span>&nbsp;<span class="string" id="4316626">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316643">_</span>&nbsp;<span class="string" id="4316645">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316662">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316682">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316699">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316715">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316725">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316731">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316743">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316750">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4316761">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4316768">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4316771">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="4316851">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="4316867">type</span>&nbsp;<span class="ident" id="4316872">pkixPublicKey</span>&nbsp;<span class="keyword" id="4316886">struct</span>&nbsp;<span class="op" id="4316893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316896">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316906"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4316910">.</span><span class="ident" id="4316911">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316932">BitString</span>&nbsp;<span class="ident" id="4316942"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4316946">.</span><span class="ident" id="4316947">BitString</span><br>
<span class="lineno"></span><span class="op" id="4316957">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4316960">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4317032">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4317090">func</span>&nbsp;<span class="ident" id="4317095">ParsePKIXPublicKey</span><span class="op" id="4317113">(</span><span class="ident" id="4317114">derBytes</span>&nbsp;<span class="op" id="4317123">[</span><span class="op" id="4317124">]</span><span class="builtintype" id="4317125">byte</span><span class="op" id="4317129">)</span>&nbsp;<span class="op" id="4317131">(</span><span class="ident" id="4317132">pub</span>&nbsp;<span class="keyword" id="4317136">interface</span><span class="op" id="4317145">{</span><span class="op" id="4317146">}</span><span class="op" id="4317147">,</span>&nbsp;<span class="ident" id="4317149">err</span>&nbsp;<span class="builtintype" id="4317153">error</span><span class="op" id="4317158">)</span>&nbsp;<span class="op" id="4317160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317163">var</span>&nbsp;<span class="ident" id="4317167">pki</span>&nbsp;<span class="ident" id="4317171"><a href="/crypto/x509/x509.go.html#4320121">publicKeyInfo</a></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317186">if</span>&nbsp;<span class="ident" id="4317189">_</span><span class="op" id="4317190">,</span>&nbsp;<span class="ident" id="4317192"><a href="/crypto/x509/x509.go.html#4317149">err</a></span>&nbsp;<span class="op" id="4317196">=</span>&nbsp;<span class="ident" id="4317198"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4317202">.</span><span class="ident" id="4317203">Unmarshal</span><span class="op" id="4317212">(</span><span class="ident" id="4317213"><a href="/crypto/x509/x509.go.html#4317114">derBytes</a></span><span class="op" id="4317221">,</span>&nbsp;<span class="op" id="4317223">&amp;</span><span class="ident" id="4317224"><a href="/crypto/x509/x509.go.html#4317167">pki</a></span><span class="op" id="4317227">)</span><span class="op" id="4317228">;</span>&nbsp;<span class="ident" id="4317230"><a href="/crypto/x509/x509.go.html#4317149">err</a></span>&nbsp;<span class="op" id="4317234">!=</span>&nbsp;<span class="ident" id="4317237">nil</span>&nbsp;<span class="op" id="4317241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317245">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4317253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317256">algo</span>&nbsp;<span class="op" id="4317261">:=</span>&nbsp;<span class="ident" id="4317264"><a href="/crypto/x509/x509.go.html#4325144">getPublicKeyAlgorithmFromOID</a></span><span class="op" id="4317292">(</span><span class="ident" id="4317293"><a href="/crypto/x509/x509.go.html#4317167">pki</a></span><span class="op" id="4317296">.</span><span class="ident" id="4317297">Algorithm</span><span class="op" id="4317306">.</span><span class="ident" id="4317307">Algorithm</span><span class="op" id="4317316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317319">if</span>&nbsp;<span class="ident" id="4317322"><a href="/crypto/x509/x509.go.html#4317256">algo</a></span>&nbsp;<span class="op" id="4317327">==</span>&nbsp;<span class="ident" id="4317330"><a href="/crypto/x509/x509.go.html#4320627">UnknownPublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4317356">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317360">return</span>&nbsp;<span class="ident" id="4317367">nil</span><span class="op" id="4317370">,</span>&nbsp;<span class="ident" id="4317372"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4317378">.</span><span class="ident" id="4317379">New</span><span class="op" id="4317382">(</span><span class="string" id="4317383">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="4317419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4317422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317425">return</span>&nbsp;<span class="ident" id="4317432"><a href="/crypto/x509/x509.go.html#4340338">parsePublicKey</a></span><span class="op" id="4317446">(</span><span class="ident" id="4317447"><a href="/crypto/x509/x509.go.html#4317256">algo</a></span><span class="op" id="4317451">,</span>&nbsp;<span class="op" id="4317453">&amp;</span><span class="ident" id="4317454"><a href="/crypto/x509/x509.go.html#4317167">pki</a></span><span class="op" id="4317457">)</span><br>
<span class="lineno"></span><span class="op" id="4317459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4317462">func</span>&nbsp;<span class="ident" id="4317467">marshalPublicKey</span><span class="op" id="4317483">(</span><span class="ident" id="4317484">pub</span>&nbsp;<span class="keyword" id="4317488">interface</span><span class="op" id="4317497">{</span><span class="op" id="4317498">}</span><span class="op" id="4317499">)</span>&nbsp;<span class="op" id="4317501">(</span><span class="ident" id="4317502">publicKeyBytes</span>&nbsp;<span class="op" id="4317517">[</span><span class="op" id="4317518">]</span><span class="builtintype" id="4317519">byte</span><span class="op" id="4317523">,</span>&nbsp;<span class="ident" id="4317525">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4317544"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4317548">.</span><span class="ident" id="4317549">AlgorithmIdentifier</span><span class="op" id="4317568">,</span>&nbsp;<span class="ident" id="4317570">err</span>&nbsp;<span class="builtintype" id="4317574">error</span><span class="op" id="4317579">)</span>&nbsp;<span class="op" id="4317581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317584">switch</span>&nbsp;<span class="ident" id="4317591">pub</span>&nbsp;<span class="op" id="4317595">:=</span>&nbsp;<span class="ident" id="4317598"><a href="/crypto/x509/x509.go.html#4317484">pub</a></span><span class="op" id="4317601">.</span><span class="op" id="4317602">(</span><span class="keyword" id="4317603">type</span><span class="op" id="4317607">)</span>&nbsp;<span class="op" id="4317609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317612">case</span>&nbsp;<span class="op" id="4317617">*</span><span class="ident" id="4317618"><a href="/crypto/x509/x509.go.html#4316595">rsa</a></span><span class="op" id="4317621">.</span><span class="ident" id="4317622">PublicKey</span><span class="op" id="4317631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317635"><a href="/crypto/x509/x509.go.html#4317502">publicKeyBytes</a></span><span class="op" id="4317649">,</span>&nbsp;<span class="ident" id="4317651"><a href="/crypto/x509/x509.go.html#4317570">err</a></span>&nbsp;<span class="op" id="4317655">=</span>&nbsp;<span class="ident" id="4317657"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4317661">.</span><span class="ident" id="4317662">Marshal</span><span class="op" id="4317669">(</span><span class="ident" id="4317670"><a href="/crypto/x509/pkcs1.go.html#4296210">rsaPublicKey</a></span><span class="op" id="4317682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317687">N</span><span class="op" id="4317688">:</span>&nbsp;<span class="ident" id="4317690"><a href="/crypto/x509/x509.go.html#4317591">pub</a></span><span class="op" id="4317693">.</span><span class="ident" id="4317694">N</span><span class="op" id="4317695">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317700">E</span><span class="op" id="4317701">:</span>&nbsp;<span class="ident" id="4317703"><a href="/crypto/x509/x509.go.html#4317591">pub</a></span><span class="op" id="4317706">.</span><span class="ident" id="4317707">E</span><span class="op" id="4317708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4317712">}</span><span class="op" id="4317713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317717"><a href="/crypto/x509/x509.go.html#4317525">publicKeyAlgorithm</a></span><span class="op" id="4317735">.</span><span class="ident" id="4317736">Algorithm</span>&nbsp;<span class="op" id="4317746">=</span>&nbsp;<span class="ident" id="4317748"><a href="/crypto/x509/x509.go.html#4324932">oidPublicKeyRSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317766">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317824">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317882">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317933"><a href="/crypto/x509/x509.go.html#4317525">publicKeyAlgorithm</a></span><span class="op" id="4317951">.</span><span class="ident" id="4317952">Parameters</span>&nbsp;<span class="op" id="4317963">=</span>&nbsp;<span class="ident" id="4317965"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4317969">.</span><span class="ident" id="4317970">RawValue</span><span class="op" id="4317978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317983">Tag</span><span class="op" id="4317986">:</span>&nbsp;<span class="num" id="4317988">5</span><span class="op" id="4317989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4317993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317996">case</span>&nbsp;<span class="op" id="4318001">*</span><span class="ident" id="4318002"><a href="/crypto/x509/x509.go.html#4316560">ecdsa</a></span><span class="op" id="4318007">.</span><span class="ident" id="4318008">PublicKey</span><span class="op" id="4318017">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318021"><a href="/crypto/x509/x509.go.html#4317502">publicKeyBytes</a></span>&nbsp;<span class="op" id="4318036">=</span>&nbsp;<span class="ident" id="4318038"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4318046">.</span><span class="ident" id="4318047">Marshal</span><span class="op" id="4318054">(</span><span class="ident" id="4318055"><a href="/crypto/x509/x509.go.html#4317591">pub</a></span><span class="op" id="4318058">.</span><span class="ident" id="4318059">Curve</span><span class="op" id="4318064">,</span>&nbsp;<span class="ident" id="4318066"><a href="/crypto/x509/x509.go.html#4317591">pub</a></span><span class="op" id="4318069">.</span><span class="ident" id="4318070">X</span><span class="op" id="4318071">,</span>&nbsp;<span class="ident" id="4318073"><a href="/crypto/x509/x509.go.html#4317591">pub</a></span><span class="op" id="4318076">.</span><span class="ident" id="4318077">Y</span><span class="op" id="4318078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318082">oid</span><span class="op" id="4318085">,</span>&nbsp;<span class="ident" id="4318087">ok</span>&nbsp;<span class="op" id="4318090">:=</span>&nbsp;<span class="ident" id="4318093"><a href="/crypto/x509/x509.go.html#4326546">oidFromNamedCurve</a></span><span class="op" id="4318110">(</span><span class="ident" id="4318111"><a href="/crypto/x509/x509.go.html#4317591">pub</a></span><span class="op" id="4318114">.</span><span class="ident" id="4318115">Curve</span><span class="op" id="4318120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318124">if</span>&nbsp;<span class="op" id="4318127">!</span><span class="ident" id="4318128"><a href="/crypto/x509/x509.go.html#4318087">ok</a></span>&nbsp;<span class="op" id="4318131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318136">return</span>&nbsp;<span class="ident" id="4318143">nil</span><span class="op" id="4318146">,</span>&nbsp;<span class="ident" id="4318148"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4318152">.</span><span class="ident" id="4318153">AlgorithmIdentifier</span><span class="op" id="4318172">{</span><span class="op" id="4318173">}</span><span class="op" id="4318174">,</span>&nbsp;<span class="ident" id="4318176"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4318182">.</span><span class="ident" id="4318183">New</span><span class="op" id="4318186">(</span><span class="string" id="4318187">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4318221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4318225">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318229"><a href="/crypto/x509/x509.go.html#4317525">publicKeyAlgorithm</a></span><span class="op" id="4318247">.</span><span class="ident" id="4318248">Algorithm</span>&nbsp;<span class="op" id="4318258">=</span>&nbsp;<span class="ident" id="4318260"><a href="/crypto/x509/x509.go.html#4325070">oidPublicKeyECDSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318280">var</span>&nbsp;<span class="ident" id="4318284">paramBytes</span>&nbsp;<span class="op" id="4318295">[</span><span class="op" id="4318296">]</span><span class="builtintype" id="4318297">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318304"><a href="/crypto/x509/x509.go.html#4318284">paramBytes</a></span><span class="op" id="4318314">,</span>&nbsp;<span class="ident" id="4318316"><a href="/crypto/x509/x509.go.html#4317570">err</a></span>&nbsp;<span class="op" id="4318320">=</span>&nbsp;<span class="ident" id="4318322"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4318326">.</span><span class="ident" id="4318327">Marshal</span><span class="op" id="4318334">(</span><span class="ident" id="4318335"><a href="/crypto/x509/x509.go.html#4318082">oid</a></span><span class="op" id="4318338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318342">if</span>&nbsp;<span class="ident" id="4318345"><a href="/crypto/x509/x509.go.html#4317570">err</a></span>&nbsp;<span class="op" id="4318349">!=</span>&nbsp;<span class="ident" id="4318352">nil</span>&nbsp;<span class="op" id="4318356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318361">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4318370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318374"><a href="/crypto/x509/x509.go.html#4317525">publicKeyAlgorithm</a></span><span class="op" id="4318392">.</span><span class="ident" id="4318393">Parameters</span><span class="op" id="4318403">.</span><span class="ident" id="4318404">FullBytes</span>&nbsp;<span class="op" id="4318414">=</span>&nbsp;<span class="ident" id="4318416"><a href="/crypto/x509/x509.go.html#4318284">paramBytes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318428">default</span><span class="op" id="4318435">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318439">return</span>&nbsp;<span class="ident" id="4318446">nil</span><span class="op" id="4318449">,</span>&nbsp;<span class="ident" id="4318451"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4318455">.</span><span class="ident" id="4318456">AlgorithmIdentifier</span><span class="op" id="4318475">{</span><span class="op" id="4318476">}</span><span class="op" id="4318477">,</span>&nbsp;<span class="ident" id="4318479"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4318485">.</span><span class="ident" id="4318486">New</span><span class="op" id="4318489">(</span><span class="string" id="4318490">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4318538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4318541">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318545">return</span>&nbsp;<span class="ident" id="4318552"><a href="/crypto/x509/x509.go.html#4317502">publicKeyBytes</a></span><span class="op" id="4318566">,</span>&nbsp;<span class="ident" id="4318568"><a href="/crypto/x509/x509.go.html#4317525">publicKeyAlgorithm</a></span><span class="op" id="4318586">,</span>&nbsp;<span class="ident" id="4318588">nil</span><br>
<span class="lineno"></span><span class="op" id="4318592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4318595">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="4318671">func</span>&nbsp;<span class="ident" id="4318676">MarshalPKIXPublicKey</span><span class="op" id="4318696">(</span><span class="ident" id="4318697">pub</span>&nbsp;<span class="keyword" id="4318701">interface</span><span class="op" id="4318710">{</span><span class="op" id="4318711">}</span><span class="op" id="4318712">)</span>&nbsp;<span class="op" id="4318714">(</span><span class="op" id="4318715">[</span><span class="op" id="4318716">]</span><span class="builtintype" id="4318717">byte</span><span class="op" id="4318721">,</span>&nbsp;<span class="builtintype" id="4318723">error</span><span class="op" id="4318728">)</span>&nbsp;<span class="op" id="4318730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318733">var</span>&nbsp;<span class="ident" id="4318737">publicKeyBytes</span>&nbsp;<span class="op" id="4318752">[</span><span class="op" id="4318753">]</span><span class="builtintype" id="4318754">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318760">var</span>&nbsp;<span class="ident" id="4318764">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4318783"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4318787">.</span><span class="ident" id="4318788">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318809">var</span>&nbsp;<span class="ident" id="4318813">err</span>&nbsp;<span class="builtintype" id="4318817">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318825">if</span>&nbsp;<span class="ident" id="4318828"><a href="/crypto/x509/x509.go.html#4318737">publicKeyBytes</a></span><span class="op" id="4318842">,</span>&nbsp;<span class="ident" id="4318844"><a href="/crypto/x509/x509.go.html#4318764">publicKeyAlgorithm</a></span><span class="op" id="4318862">,</span>&nbsp;<span class="ident" id="4318864"><a href="/crypto/x509/x509.go.html#4318813">err</a></span>&nbsp;<span class="op" id="4318868">=</span>&nbsp;<span class="ident" id="4318870"><a href="/crypto/x509/x509.go.html#4317467">marshalPublicKey</a></span><span class="op" id="4318886">(</span><span class="ident" id="4318887"><a href="/crypto/x509/x509.go.html#4318697">pub</a></span><span class="op" id="4318890">)</span><span class="op" id="4318891">;</span>&nbsp;<span class="ident" id="4318893"><a href="/crypto/x509/x509.go.html#4318813">err</a></span>&nbsp;<span class="op" id="4318897">!=</span>&nbsp;<span class="ident" id="4318900">nil</span>&nbsp;<span class="op" id="4318904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318908">return</span>&nbsp;<span class="ident" id="4318915">nil</span><span class="op" id="4318918">,</span>&nbsp;<span class="ident" id="4318920"><a href="/crypto/x509/x509.go.html#4318813">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4318925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318929">pkix</span>&nbsp;<span class="op" id="4318934">:=</span>&nbsp;<span class="ident" id="4318937"><a href="/crypto/x509/x509.go.html#4316872">pkixPublicKey</a></span><span class="op" id="4318950">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318954">Algo</span><span class="op" id="4318958">:</span>&nbsp;<span class="ident" id="4318960"><a href="/crypto/x509/x509.go.html#4318764">publicKeyAlgorithm</a></span><span class="op" id="4318978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318982">BitString</span><span class="op" id="4318991">:</span>&nbsp;<span class="ident" id="4318993"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4318997">.</span><span class="ident" id="4318998">BitString</span><span class="op" id="4319007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319012">Bytes</span><span class="op" id="4319017">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319023"><a href="/crypto/x509/x509.go.html#4318737">publicKeyBytes</a></span><span class="op" id="4319037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319042">BitLength</span><span class="op" id="4319051">:</span>&nbsp;<span class="num" id="4319053">8</span>&nbsp;<span class="op" id="4319055">*</span>&nbsp;<span class="builtinfunc" id="4319057">len</span><span class="op" id="4319060">(</span><span class="ident" id="4319061"><a href="/crypto/x509/x509.go.html#4318737">publicKeyBytes</a></span><span class="op" id="4319075">)</span><span class="op" id="4319076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4319080">}</span><span class="op" id="4319081">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4319084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319088">ret</span><span class="op" id="4319091">,</span>&nbsp;<span class="ident" id="4319093">_</span>&nbsp;<span class="op" id="4319095">:=</span>&nbsp;<span class="ident" id="4319098"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4319102">.</span><span class="ident" id="4319103">Marshal</span><span class="op" id="4319110">(</span><span class="ident" id="4319111"><a href="/crypto/x509/x509.go.html#4318929">pkix</a></span><span class="op" id="4319115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319118">return</span>&nbsp;<span class="ident" id="4319125"><a href="/crypto/x509/x509.go.html#4319088">ret</a></span><span class="op" id="4319128">,</span>&nbsp;<span class="ident" id="4319130">nil</span><br>
<span class="lineno"></span><span class="op" id="4319134">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4319137">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4319210">type</span>&nbsp;<span class="ident" id="4319215">certificate</span>&nbsp;<span class="keyword" id="4319227">struct</span>&nbsp;<span class="op" id="4319234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319237">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319256"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4319260">.</span><span class="ident" id="4319261">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319273">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319292"><a href="/crypto/x509/x509.go.html#4319395">tbsCertificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319308">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4319327"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4319331">.</span><span class="ident" id="4319332">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319353">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319372"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4319376">.</span><span class="ident" id="4319377">BitString</span><br>
<span class="lineno"></span><span class="op" id="4319387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4319390">type</span>&nbsp;<span class="ident" id="4319395">tbsCertificate</span>&nbsp;<span class="keyword" id="4319410">struct</span>&nbsp;<span class="op" id="4319417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319420">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319439"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4319443">.</span><span class="ident" id="4319444">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319456">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4319475">int</span>&nbsp;<span class="string" id="4319479">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319523">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319542">*</span><span class="ident" id="4319543"><a href="/crypto/x509/x509.go.html#4316731">big</a></span><span class="op" id="4319546">.</span><span class="ident" id="4319547">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319552">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4319571"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4319575">.</span><span class="ident" id="4319576">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319597">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319616"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4319620">.</span><span class="ident" id="4319621">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319631">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319650"><a href="/crypto/x509/x509.go.html#4320064">validity</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319660">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319679"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4319683">.</span><span class="ident" id="4319684">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319694">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319713"><a href="/crypto/x509/x509.go.html#4320121">publicKeyInfo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319728">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319747"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4319751">.</span><span class="ident" id="4319752">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4319764">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319789">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319808"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4319812">.</span><span class="ident" id="4319813">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4319825">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319850">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319869">[</span><span class="op" id="4319870">]</span><span class="ident" id="4319871"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4319875">.</span><span class="ident" id="4319876">Extension</span>&nbsp;<span class="string" id="4319886">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4319919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4319922">type</span>&nbsp;<span class="ident" id="4319927">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="4319950">struct</span>&nbsp;<span class="op" id="4319957">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319960">P</span><span class="op" id="4319961">,</span>&nbsp;<span class="ident" id="4319963">Q</span><span class="op" id="4319964">,</span>&nbsp;<span class="ident" id="4319966">G</span>&nbsp;<span class="op" id="4319968">*</span><span class="ident" id="4319969"><a href="/crypto/x509/x509.go.html#4316731">big</a></span><span class="op" id="4319972">.</span><span class="ident" id="4319973">Int</span><br>
<span class="lineno"></span><span class="op" id="4319977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4319980">type</span>&nbsp;<span class="ident" id="4319985">dsaSignature</span>&nbsp;<span class="keyword" id="4319998">struct</span>&nbsp;<span class="op" id="4320005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320008">R</span><span class="op" id="4320009">,</span>&nbsp;<span class="ident" id="4320011">S</span>&nbsp;<span class="op" id="4320013">*</span><span class="ident" id="4320014"><a href="/crypto/x509/x509.go.html#4316731">big</a></span><span class="op" id="4320017">.</span><span class="ident" id="4320018">Int</span><br>
<span class="lineno">135</span><span class="op" id="4320022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4320025">type</span>&nbsp;<span class="ident" id="4320030">ecdsaSignature</span>&nbsp;<span class="ident" id="4320045"><a href="/crypto/x509/x509.go.html#4319985">dsaSignature</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4320059">type</span>&nbsp;<span class="ident" id="4320064">validity</span>&nbsp;<span class="keyword" id="4320073">struct</span>&nbsp;<span class="op" id="4320080">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320083">NotBefore</span><span class="op" id="4320092">,</span>&nbsp;<span class="ident" id="4320094">NotAfter</span>&nbsp;<span class="ident" id="4320103"><a href="/crypto/x509/x509.go.html#4316761">time</a></span><span class="op" id="4320107">.</span><span class="ident" id="4320108">Time</span><br>
<span class="lineno"></span><span class="op" id="4320113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4320116">type</span>&nbsp;<span class="ident" id="4320121">publicKeyInfo</span>&nbsp;<span class="keyword" id="4320135">struct</span>&nbsp;<span class="op" id="4320142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320145">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320155"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4320159">.</span><span class="ident" id="4320160">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320172">Algorithm</span>&nbsp;<span class="ident" id="4320182"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4320186">.</span><span class="ident" id="4320187">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320208">PublicKey</span>&nbsp;<span class="ident" id="4320218"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4320222">.</span><span class="ident" id="4320223">BitString</span><br>
<span class="lineno"></span><span class="op" id="4320233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4320236">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="4320258">type</span>&nbsp;<span class="ident" id="4320263">authKeyId</span>&nbsp;<span class="keyword" id="4320273">struct</span>&nbsp;<span class="op" id="4320280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320283">Id</span>&nbsp;<span class="op" id="4320286">[</span><span class="op" id="4320287">]</span><span class="builtintype" id="4320288">byte</span>&nbsp;<span class="string" id="4320293">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4320317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4320320">type</span>&nbsp;<span class="ident" id="4320325">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="4320344">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="4320349">const</span>&nbsp;<span class="op" id="4320355">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320358">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="4320384"><a href="/crypto/x509/x509.go.html#4320325">SignatureAlgorithm</a></span>&nbsp;<span class="op" id="4320403">=</span>&nbsp;<span class="ident" id="4320405">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320411">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320423">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320435">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320448">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320463">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320478">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320493">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320506">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320521">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320536">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320553">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320570">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="4320586">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4320589">type</span>&nbsp;<span class="ident" id="4320594">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="4320613">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4320618">const</span>&nbsp;<span class="op" id="4320624">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320627">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4320653"><a href="/crypto/x509/x509.go.html#4320594">PublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4320672">=</span>&nbsp;<span class="ident" id="4320674">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320680">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320685">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320690">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="4320696">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4320699">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4320732">//</span><br>
<span class="lineno"></span><span class="comment" id="4320735">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4320769">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="4320832">//</span><br>
<span class="lineno"></span><span class="comment" id="4320835">//</span><br>
<span class="lineno"></span><span class="comment" id="4320838">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4320881">//</span><br>
<span class="lineno"></span><span class="comment" id="4320884">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="4320943">//</span><br>
<span class="lineno"></span><span class="comment" id="4320946">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4321005">//</span><br>
<span class="lineno"></span><span class="comment" id="4321008">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4321069">//</span><br>
<span class="lineno">195</span><span class="comment" id="4321072">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4321111">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4321172">//</span><br>
<span class="lineno"></span><span class="comment" id="4321175">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4321219">//</span><br>
<span class="lineno">200</span><span class="comment" id="4321222">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4321265">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="4321318">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="4321358">//</span><br>
<span class="lineno"></span><span class="comment" id="4321361">//</span><br>
<span class="lineno">205</span><span class="comment" id="4321364">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="4321398">//</span><br>
<span class="lineno"></span><span class="comment" id="4321401">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4321464">//</span><br>
<span class="lineno"></span><span class="comment" id="4321467">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="4321530">//</span><br>
<span class="lineno"></span><span class="comment" id="4321533">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4321596">//</span><br>
<span class="lineno"></span><span class="comment" id="4321599">//</span><br>
<span class="lineno"></span><span class="comment" id="4321602">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="4321643">//</span><br>
<span class="lineno"></span><span class="comment" id="4321646">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4321687">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="4321757">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="4321808">//</span><br>
<span class="lineno">220</span><span class="comment" id="4321811">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4321853">//</span><br>
<span class="lineno"></span><span class="comment" id="4321856">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4321923">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4321992">//</span><br>
<span class="lineno">225</span><span class="comment" id="4321995">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4322062">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4322131">//</span><br>
<span class="lineno"></span><span class="comment" id="4322134">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4322201">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4322271">var</span>&nbsp;<span class="op" id="4322275">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322278">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4322306">=</span>&nbsp;<span class="ident" id="4322308"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4322312">.</span><span class="ident" id="4322313">ObjectIdentifier</span><span class="op" id="4322329">{</span><span class="num" id="4322330">1</span><span class="op" id="4322331">,</span>&nbsp;<span class="num" id="4322333">2</span><span class="op" id="4322334">,</span>&nbsp;<span class="num" id="4322336">840</span><span class="op" id="4322339">,</span>&nbsp;<span class="num" id="4322341">113549</span><span class="op" id="4322347">,</span>&nbsp;<span class="num" id="4322349">1</span><span class="op" id="4322350">,</span>&nbsp;<span class="num" id="4322352">1</span><span class="op" id="4322353">,</span>&nbsp;<span class="num" id="4322355">2</span><span class="op" id="4322356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322359">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4322387">=</span>&nbsp;<span class="ident" id="4322389"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4322393">.</span><span class="ident" id="4322394">ObjectIdentifier</span><span class="op" id="4322410">{</span><span class="num" id="4322411">1</span><span class="op" id="4322412">,</span>&nbsp;<span class="num" id="4322414">2</span><span class="op" id="4322415">,</span>&nbsp;<span class="num" id="4322417">840</span><span class="op" id="4322420">,</span>&nbsp;<span class="num" id="4322422">113549</span><span class="op" id="4322428">,</span>&nbsp;<span class="num" id="4322430">1</span><span class="op" id="4322431">,</span>&nbsp;<span class="num" id="4322433">1</span><span class="op" id="4322434">,</span>&nbsp;<span class="num" id="4322436">4</span><span class="op" id="4322437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322440">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4322468">=</span>&nbsp;<span class="ident" id="4322470"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4322474">.</span><span class="ident" id="4322475">ObjectIdentifier</span><span class="op" id="4322491">{</span><span class="num" id="4322492">1</span><span class="op" id="4322493">,</span>&nbsp;<span class="num" id="4322495">2</span><span class="op" id="4322496">,</span>&nbsp;<span class="num" id="4322498">840</span><span class="op" id="4322501">,</span>&nbsp;<span class="num" id="4322503">113549</span><span class="op" id="4322509">,</span>&nbsp;<span class="num" id="4322511">1</span><span class="op" id="4322512">,</span>&nbsp;<span class="num" id="4322514">1</span><span class="op" id="4322515">,</span>&nbsp;<span class="num" id="4322517">5</span><span class="op" id="4322518">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322521">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4322549">=</span>&nbsp;<span class="ident" id="4322551"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4322555">.</span><span class="ident" id="4322556">ObjectIdentifier</span><span class="op" id="4322572">{</span><span class="num" id="4322573">1</span><span class="op" id="4322574">,</span>&nbsp;<span class="num" id="4322576">2</span><span class="op" id="4322577">,</span>&nbsp;<span class="num" id="4322579">840</span><span class="op" id="4322582">,</span>&nbsp;<span class="num" id="4322584">113549</span><span class="op" id="4322590">,</span>&nbsp;<span class="num" id="4322592">1</span><span class="op" id="4322593">,</span>&nbsp;<span class="num" id="4322595">1</span><span class="op" id="4322596">,</span>&nbsp;<span class="num" id="4322598">11</span><span class="op" id="4322600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322603">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4322631">=</span>&nbsp;<span class="ident" id="4322633"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4322637">.</span><span class="ident" id="4322638">ObjectIdentifier</span><span class="op" id="4322654">{</span><span class="num" id="4322655">1</span><span class="op" id="4322656">,</span>&nbsp;<span class="num" id="4322658">2</span><span class="op" id="4322659">,</span>&nbsp;<span class="num" id="4322661">840</span><span class="op" id="4322664">,</span>&nbsp;<span class="num" id="4322666">113549</span><span class="op" id="4322672">,</span>&nbsp;<span class="num" id="4322674">1</span><span class="op" id="4322675">,</span>&nbsp;<span class="num" id="4322677">1</span><span class="op" id="4322678">,</span>&nbsp;<span class="num" id="4322680">12</span><span class="op" id="4322682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322685">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4322713">=</span>&nbsp;<span class="ident" id="4322715"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4322719">.</span><span class="ident" id="4322720">ObjectIdentifier</span><span class="op" id="4322736">{</span><span class="num" id="4322737">1</span><span class="op" id="4322738">,</span>&nbsp;<span class="num" id="4322740">2</span><span class="op" id="4322741">,</span>&nbsp;<span class="num" id="4322743">840</span><span class="op" id="4322746">,</span>&nbsp;<span class="num" id="4322748">113549</span><span class="op" id="4322754">,</span>&nbsp;<span class="num" id="4322756">1</span><span class="op" id="4322757">,</span>&nbsp;<span class="num" id="4322759">1</span><span class="op" id="4322760">,</span>&nbsp;<span class="num" id="4322762">13</span><span class="op" id="4322764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322767">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4322795">=</span>&nbsp;<span class="ident" id="4322797"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4322801">.</span><span class="ident" id="4322802">ObjectIdentifier</span><span class="op" id="4322818">{</span><span class="num" id="4322819">1</span><span class="op" id="4322820">,</span>&nbsp;<span class="num" id="4322822">2</span><span class="op" id="4322823">,</span>&nbsp;<span class="num" id="4322825">840</span><span class="op" id="4322828">,</span>&nbsp;<span class="num" id="4322830">10040</span><span class="op" id="4322835">,</span>&nbsp;<span class="num" id="4322837">4</span><span class="op" id="4322838">,</span>&nbsp;<span class="num" id="4322840">3</span><span class="op" id="4322841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322844">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4322872">=</span>&nbsp;<span class="ident" id="4322874"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4322878">.</span><span class="ident" id="4322879">ObjectIdentifier</span><span class="op" id="4322895">{</span><span class="num" id="4322896">2</span><span class="op" id="4322897">,</span>&nbsp;<span class="num" id="4322899">16</span><span class="op" id="4322901">,</span>&nbsp;<span class="num" id="4322903">840</span><span class="op" id="4322906">,</span>&nbsp;<span class="num" id="4322908">1</span><span class="op" id="4322909">,</span>&nbsp;<span class="num" id="4322911">101</span><span class="op" id="4322914">,</span>&nbsp;<span class="num" id="4322916">4</span><span class="op" id="4322917">,</span>&nbsp;<span class="num" id="4322919">3</span><span class="op" id="4322920">,</span>&nbsp;<span class="num" id="4322922">2</span><span class="op" id="4322923">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322926">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4322954">=</span>&nbsp;<span class="ident" id="4322956"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4322960">.</span><span class="ident" id="4322961">ObjectIdentifier</span><span class="op" id="4322977">{</span><span class="num" id="4322978">1</span><span class="op" id="4322979">,</span>&nbsp;<span class="num" id="4322981">2</span><span class="op" id="4322982">,</span>&nbsp;<span class="num" id="4322984">840</span><span class="op" id="4322987">,</span>&nbsp;<span class="num" id="4322989">10045</span><span class="op" id="4322994">,</span>&nbsp;<span class="num" id="4322996">4</span><span class="op" id="4322997">,</span>&nbsp;<span class="num" id="4322999">1</span><span class="op" id="4323000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323003">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="4323031">=</span>&nbsp;<span class="ident" id="4323033"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4323037">.</span><span class="ident" id="4323038">ObjectIdentifier</span><span class="op" id="4323054">{</span><span class="num" id="4323055">1</span><span class="op" id="4323056">,</span>&nbsp;<span class="num" id="4323058">2</span><span class="op" id="4323059">,</span>&nbsp;<span class="num" id="4323061">840</span><span class="op" id="4323064">,</span>&nbsp;<span class="num" id="4323066">10045</span><span class="op" id="4323071">,</span>&nbsp;<span class="num" id="4323073">4</span><span class="op" id="4323074">,</span>&nbsp;<span class="num" id="4323076">3</span><span class="op" id="4323077">,</span>&nbsp;<span class="num" id="4323079">2</span><span class="op" id="4323080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323083">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="4323111">=</span>&nbsp;<span class="ident" id="4323113"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4323117">.</span><span class="ident" id="4323118">ObjectIdentifier</span><span class="op" id="4323134">{</span><span class="num" id="4323135">1</span><span class="op" id="4323136">,</span>&nbsp;<span class="num" id="4323138">2</span><span class="op" id="4323139">,</span>&nbsp;<span class="num" id="4323141">840</span><span class="op" id="4323144">,</span>&nbsp;<span class="num" id="4323146">10045</span><span class="op" id="4323151">,</span>&nbsp;<span class="num" id="4323153">4</span><span class="op" id="4323154">,</span>&nbsp;<span class="num" id="4323156">3</span><span class="op" id="4323157">,</span>&nbsp;<span class="num" id="4323159">3</span><span class="op" id="4323160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323163">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="4323191">=</span>&nbsp;<span class="ident" id="4323193"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4323197">.</span><span class="ident" id="4323198">ObjectIdentifier</span><span class="op" id="4323214">{</span><span class="num" id="4323215">1</span><span class="op" id="4323216">,</span>&nbsp;<span class="num" id="4323218">2</span><span class="op" id="4323219">,</span>&nbsp;<span class="num" id="4323221">840</span><span class="op" id="4323224">,</span>&nbsp;<span class="num" id="4323226">10045</span><span class="op" id="4323231">,</span>&nbsp;<span class="num" id="4323233">4</span><span class="op" id="4323234">,</span>&nbsp;<span class="num" id="4323236">3</span><span class="op" id="4323237">,</span>&nbsp;<span class="num" id="4323239">4</span><span class="op" id="4323240">}</span><br>
<span class="lineno"></span><span class="op" id="4323242">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4323245">var</span>&nbsp;<span class="ident" id="4323249">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4323275">=</span>&nbsp;<span class="op" id="4323277">[</span><span class="op" id="4323278">]</span><span class="keyword" id="4323279">struct</span>&nbsp;<span class="op" id="4323286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323289">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323300"><a href="/crypto/x509/x509.go.html#4320325">SignatureAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323320">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323331"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4323335">.</span><span class="ident" id="4323336">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323354">pubKeyAlgo</span>&nbsp;<span class="ident" id="4323365"><a href="/crypto/x509/x509.go.html#4320594">PublicKeyAlgorithm</a></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323385">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323396"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4323402">.</span><span class="ident" id="4323403">Hash</span><br>
<span class="lineno"></span><span class="op" id="4323408">}</span><span class="op" id="4323409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323412">{</span><span class="ident" id="4323413"><a href="/crypto/x509/x509.go.html#4320411">MD2WithRSA</a></span><span class="op" id="4323423">,</span>&nbsp;<span class="ident" id="4323425"><a href="/crypto/x509/x509.go.html#4322278">oidSignatureMD2WithRSA</a></span><span class="op" id="4323447">,</span>&nbsp;<span class="ident" id="4323449"><a href="/crypto/x509/x509.go.html#4320680">RSA</a></span><span class="op" id="4323452">,</span>&nbsp;<span class="ident" id="4323454"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4323460">.</span><span class="ident" id="4323461">Hash</span><span class="op" id="4323465">(</span><span class="num" id="4323466">0</span><span class="op" id="4323467">)</span>&nbsp;<span class="comment" id="4323469">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="4323491">}</span><span class="op" id="4323492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323495">{</span><span class="ident" id="4323496"><a href="/crypto/x509/x509.go.html#4320423">MD5WithRSA</a></span><span class="op" id="4323506">,</span>&nbsp;<span class="ident" id="4323508"><a href="/crypto/x509/x509.go.html#4322359">oidSignatureMD5WithRSA</a></span><span class="op" id="4323530">,</span>&nbsp;<span class="ident" id="4323532"><a href="/crypto/x509/x509.go.html#4320680">RSA</a></span><span class="op" id="4323535">,</span>&nbsp;<span class="ident" id="4323537"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4323543">.</span><span class="ident" id="4323544">MD5</span><span class="op" id="4323547">}</span><span class="op" id="4323548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323551">{</span><span class="ident" id="4323552"><a href="/crypto/x509/x509.go.html#4320435">SHA1WithRSA</a></span><span class="op" id="4323563">,</span>&nbsp;<span class="ident" id="4323565"><a href="/crypto/x509/x509.go.html#4322440">oidSignatureSHA1WithRSA</a></span><span class="op" id="4323588">,</span>&nbsp;<span class="ident" id="4323590"><a href="/crypto/x509/x509.go.html#4320680">RSA</a></span><span class="op" id="4323593">,</span>&nbsp;<span class="ident" id="4323595"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4323601">.</span><span class="ident" id="4323602">SHA1</span><span class="op" id="4323606">}</span><span class="op" id="4323607">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323610">{</span><span class="ident" id="4323611"><a href="/crypto/x509/x509.go.html#4320448">SHA256WithRSA</a></span><span class="op" id="4323624">,</span>&nbsp;<span class="ident" id="4323626"><a href="/crypto/x509/x509.go.html#4322521">oidSignatureSHA256WithRSA</a></span><span class="op" id="4323651">,</span>&nbsp;<span class="ident" id="4323653"><a href="/crypto/x509/x509.go.html#4320680">RSA</a></span><span class="op" id="4323656">,</span>&nbsp;<span class="ident" id="4323658"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4323664">.</span><span class="ident" id="4323665">SHA256</span><span class="op" id="4323671">}</span><span class="op" id="4323672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323675">{</span><span class="ident" id="4323676"><a href="/crypto/x509/x509.go.html#4320463">SHA384WithRSA</a></span><span class="op" id="4323689">,</span>&nbsp;<span class="ident" id="4323691"><a href="/crypto/x509/x509.go.html#4322603">oidSignatureSHA384WithRSA</a></span><span class="op" id="4323716">,</span>&nbsp;<span class="ident" id="4323718"><a href="/crypto/x509/x509.go.html#4320680">RSA</a></span><span class="op" id="4323721">,</span>&nbsp;<span class="ident" id="4323723"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4323729">.</span><span class="ident" id="4323730">SHA384</span><span class="op" id="4323736">}</span><span class="op" id="4323737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323740">{</span><span class="ident" id="4323741"><a href="/crypto/x509/x509.go.html#4320478">SHA512WithRSA</a></span><span class="op" id="4323754">,</span>&nbsp;<span class="ident" id="4323756"><a href="/crypto/x509/x509.go.html#4322685">oidSignatureSHA512WithRSA</a></span><span class="op" id="4323781">,</span>&nbsp;<span class="ident" id="4323783"><a href="/crypto/x509/x509.go.html#4320680">RSA</a></span><span class="op" id="4323786">,</span>&nbsp;<span class="ident" id="4323788"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4323794">.</span><span class="ident" id="4323795">SHA512</span><span class="op" id="4323801">}</span><span class="op" id="4323802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323805">{</span><span class="ident" id="4323806"><a href="/crypto/x509/x509.go.html#4320493">DSAWithSHA1</a></span><span class="op" id="4323817">,</span>&nbsp;<span class="ident" id="4323819"><a href="/crypto/x509/x509.go.html#4322767">oidSignatureDSAWithSHA1</a></span><span class="op" id="4323842">,</span>&nbsp;<span class="ident" id="4323844"><a href="/crypto/x509/x509.go.html#4320685">DSA</a></span><span class="op" id="4323847">,</span>&nbsp;<span class="ident" id="4323849"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4323855">.</span><span class="ident" id="4323856">SHA1</span><span class="op" id="4323860">}</span><span class="op" id="4323861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323864">{</span><span class="ident" id="4323865"><a href="/crypto/x509/x509.go.html#4320506">DSAWithSHA256</a></span><span class="op" id="4323878">,</span>&nbsp;<span class="ident" id="4323880"><a href="/crypto/x509/x509.go.html#4322844">oidSignatureDSAWithSHA256</a></span><span class="op" id="4323905">,</span>&nbsp;<span class="ident" id="4323907"><a href="/crypto/x509/x509.go.html#4320685">DSA</a></span><span class="op" id="4323910">,</span>&nbsp;<span class="ident" id="4323912"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4323918">.</span><span class="ident" id="4323919">SHA256</span><span class="op" id="4323925">}</span><span class="op" id="4323926">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323929">{</span><span class="ident" id="4323930"><a href="/crypto/x509/x509.go.html#4320521">ECDSAWithSHA1</a></span><span class="op" id="4323943">,</span>&nbsp;<span class="ident" id="4323945"><a href="/crypto/x509/x509.go.html#4322926">oidSignatureECDSAWithSHA1</a></span><span class="op" id="4323970">,</span>&nbsp;<span class="ident" id="4323972"><a href="/crypto/x509/x509.go.html#4320690">ECDSA</a></span><span class="op" id="4323977">,</span>&nbsp;<span class="ident" id="4323979"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4323985">.</span><span class="ident" id="4323986">SHA1</span><span class="op" id="4323990">}</span><span class="op" id="4323991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323994">{</span><span class="ident" id="4323995"><a href="/crypto/x509/x509.go.html#4320536">ECDSAWithSHA256</a></span><span class="op" id="4324010">,</span>&nbsp;<span class="ident" id="4324012"><a href="/crypto/x509/x509.go.html#4323003">oidSignatureECDSAWithSHA256</a></span><span class="op" id="4324039">,</span>&nbsp;<span class="ident" id="4324041"><a href="/crypto/x509/x509.go.html#4320690">ECDSA</a></span><span class="op" id="4324046">,</span>&nbsp;<span class="ident" id="4324048"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4324054">.</span><span class="ident" id="4324055">SHA256</span><span class="op" id="4324061">}</span><span class="op" id="4324062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4324065">{</span><span class="ident" id="4324066"><a href="/crypto/x509/x509.go.html#4320553">ECDSAWithSHA384</a></span><span class="op" id="4324081">,</span>&nbsp;<span class="ident" id="4324083"><a href="/crypto/x509/x509.go.html#4323083">oidSignatureECDSAWithSHA384</a></span><span class="op" id="4324110">,</span>&nbsp;<span class="ident" id="4324112"><a href="/crypto/x509/x509.go.html#4320690">ECDSA</a></span><span class="op" id="4324117">,</span>&nbsp;<span class="ident" id="4324119"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4324125">.</span><span class="ident" id="4324126">SHA384</span><span class="op" id="4324132">}</span><span class="op" id="4324133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4324136">{</span><span class="ident" id="4324137"><a href="/crypto/x509/x509.go.html#4320570">ECDSAWithSHA512</a></span><span class="op" id="4324152">,</span>&nbsp;<span class="ident" id="4324154"><a href="/crypto/x509/x509.go.html#4323163">oidSignatureECDSAWithSHA512</a></span><span class="op" id="4324181">,</span>&nbsp;<span class="ident" id="4324183"><a href="/crypto/x509/x509.go.html#4320690">ECDSA</a></span><span class="op" id="4324188">,</span>&nbsp;<span class="ident" id="4324190"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4324196">.</span><span class="ident" id="4324197">SHA512</span><span class="op" id="4324203">}</span><span class="op" id="4324204">,</span><br>
<span class="lineno"></span><span class="op" id="4324206">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4324209">func</span>&nbsp;<span class="ident" id="4324214">getSignatureAlgorithmFromOID</span><span class="op" id="4324242">(</span><span class="ident" id="4324243">oid</span>&nbsp;<span class="ident" id="4324247"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4324251">.</span><span class="ident" id="4324252">ObjectIdentifier</span><span class="op" id="4324268">)</span>&nbsp;<span class="ident" id="4324270"><a href="/crypto/x509/x509.go.html#4320325">SignatureAlgorithm</a></span>&nbsp;<span class="op" id="4324289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324292">for</span>&nbsp;<span class="ident" id="4324296">_</span><span class="op" id="4324297">,</span>&nbsp;<span class="ident" id="4324299">details</span>&nbsp;<span class="op" id="4324307">:=</span>&nbsp;<span class="keyword" id="4324310">range</span>&nbsp;<span class="ident" id="4324316"><a href="/crypto/x509/x509.go.html#4323249">signatureAlgorithmDetails</a></span>&nbsp;<span class="op" id="4324342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324346">if</span>&nbsp;<span class="ident" id="4324349"><a href="/crypto/x509/x509.go.html#4324243">oid</a></span><span class="op" id="4324352">.</span><span class="ident" id="4324353">Equal</span><span class="op" id="4324358">(</span><span class="ident" id="4324359"><a href="/crypto/x509/x509.go.html#4324299">details</a></span><span class="op" id="4324366">.</span><span class="ident" id="4324367">oid</span><span class="op" id="4324370">)</span>&nbsp;<span class="op" id="4324372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324377">return</span>&nbsp;<span class="ident" id="4324384"><a href="/crypto/x509/x509.go.html#4324299">details</a></span><span class="op" id="4324391">.</span><span class="ident" id="4324392">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4324399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4324402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324405">return</span>&nbsp;<span class="ident" id="4324412"><a href="/crypto/x509/x509.go.html#4320358">UnknownSignatureAlgorithm</a></span><br>
<span class="lineno"></span><span class="op" id="4324438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4324441">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4324480">//</span><br>
<span class="lineno"></span><span class="comment" id="4324483">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4324548">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4324581">//</span><br>
<span class="lineno">280</span><span class="comment" id="4324584">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4324638">//</span><br>
<span class="lineno"></span><span class="comment" id="4324641">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4324706">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4324737">//</span><br>
<span class="lineno">285</span><span class="comment" id="4324740">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="4324808">//</span><br>
<span class="lineno"></span><span class="comment" id="4324811">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4324853">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4324925">var</span>&nbsp;<span class="op" id="4324929">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4324932">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4324950">=</span>&nbsp;<span class="ident" id="4324952"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4324956">.</span><span class="ident" id="4324957">ObjectIdentifier</span><span class="op" id="4324973">{</span><span class="num" id="4324974">1</span><span class="op" id="4324975">,</span>&nbsp;<span class="num" id="4324977">2</span><span class="op" id="4324978">,</span>&nbsp;<span class="num" id="4324980">840</span><span class="op" id="4324983">,</span>&nbsp;<span class="num" id="4324985">113549</span><span class="op" id="4324991">,</span>&nbsp;<span class="num" id="4324993">1</span><span class="op" id="4324994">,</span>&nbsp;<span class="num" id="4324996">1</span><span class="op" id="4324997">,</span>&nbsp;<span class="num" id="4324999">1</span><span class="op" id="4325000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325003">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4325021">=</span>&nbsp;<span class="ident" id="4325023"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4325027">.</span><span class="ident" id="4325028">ObjectIdentifier</span><span class="op" id="4325044">{</span><span class="num" id="4325045">1</span><span class="op" id="4325046">,</span>&nbsp;<span class="num" id="4325048">2</span><span class="op" id="4325049">,</span>&nbsp;<span class="num" id="4325051">840</span><span class="op" id="4325054">,</span>&nbsp;<span class="num" id="4325056">10040</span><span class="op" id="4325061">,</span>&nbsp;<span class="num" id="4325063">4</span><span class="op" id="4325064">,</span>&nbsp;<span class="num" id="4325066">1</span><span class="op" id="4325067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325070">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="4325088">=</span>&nbsp;<span class="ident" id="4325090"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4325094">.</span><span class="ident" id="4325095">ObjectIdentifier</span><span class="op" id="4325111">{</span><span class="num" id="4325112">1</span><span class="op" id="4325113">,</span>&nbsp;<span class="num" id="4325115">2</span><span class="op" id="4325116">,</span>&nbsp;<span class="num" id="4325118">840</span><span class="op" id="4325121">,</span>&nbsp;<span class="num" id="4325123">10045</span><span class="op" id="4325128">,</span>&nbsp;<span class="num" id="4325130">2</span><span class="op" id="4325131">,</span>&nbsp;<span class="num" id="4325133">1</span><span class="op" id="4325134">}</span><br>
<span class="lineno"></span><span class="op" id="4325136">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4325139">func</span>&nbsp;<span class="ident" id="4325144">getPublicKeyAlgorithmFromOID</span><span class="op" id="4325172">(</span><span class="ident" id="4325173">oid</span>&nbsp;<span class="ident" id="4325177"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4325181">.</span><span class="ident" id="4325182">ObjectIdentifier</span><span class="op" id="4325198">)</span>&nbsp;<span class="ident" id="4325200"><a href="/crypto/x509/x509.go.html#4320594">PublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4325219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325222">switch</span>&nbsp;<span class="op" id="4325229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325232">case</span>&nbsp;<span class="ident" id="4325237"><a href="/crypto/x509/x509.go.html#4325173">oid</a></span><span class="op" id="4325240">.</span><span class="ident" id="4325241">Equal</span><span class="op" id="4325246">(</span><span class="ident" id="4325247"><a href="/crypto/x509/x509.go.html#4324932">oidPublicKeyRSA</a></span><span class="op" id="4325262">)</span><span class="op" id="4325263">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325267">return</span>&nbsp;<span class="ident" id="4325274"><a href="/crypto/x509/x509.go.html#4320680">RSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325279">case</span>&nbsp;<span class="ident" id="4325284"><a href="/crypto/x509/x509.go.html#4325173">oid</a></span><span class="op" id="4325287">.</span><span class="ident" id="4325288">Equal</span><span class="op" id="4325293">(</span><span class="ident" id="4325294"><a href="/crypto/x509/x509.go.html#4325003">oidPublicKeyDSA</a></span><span class="op" id="4325309">)</span><span class="op" id="4325310">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325314">return</span>&nbsp;<span class="ident" id="4325321"><a href="/crypto/x509/x509.go.html#4320685">DSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325326">case</span>&nbsp;<span class="ident" id="4325331"><a href="/crypto/x509/x509.go.html#4325173">oid</a></span><span class="op" id="4325334">.</span><span class="ident" id="4325335">Equal</span><span class="op" id="4325340">(</span><span class="ident" id="4325341"><a href="/crypto/x509/x509.go.html#4325070">oidPublicKeyECDSA</a></span><span class="op" id="4325358">)</span><span class="op" id="4325359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325363">return</span>&nbsp;<span class="ident" id="4325370"><a href="/crypto/x509/x509.go.html#4320690">ECDSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4325377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325380">return</span>&nbsp;<span class="ident" id="4325387"><a href="/crypto/x509/x509.go.html#4320627">UnknownPublicKeyAlgorithm</a></span><br>
<span class="lineno">305</span><span class="op" id="4325413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4325416">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="4325450">//</span><br>
<span class="lineno"></span><span class="comment" id="4325453">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="4325490">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4325557">//</span><br>
<span class="lineno"></span><span class="comment" id="4325560">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4325597">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="4325660">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="4325678">//</span><br>
<span class="lineno"></span><span class="comment" id="4325681">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4325718">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4325785">//</span><br>
<span class="lineno"></span><span class="comment" id="4325788">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="4325825">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4325892">//</span><br>
<span class="lineno"></span><span class="comment" id="4325895">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="4325940">var</span>&nbsp;<span class="op" id="4325944">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325947">oidNamedCurveP224</span>&nbsp;<span class="op" id="4325965">=</span>&nbsp;<span class="ident" id="4325967"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4325971">.</span><span class="ident" id="4325972">ObjectIdentifier</span><span class="op" id="4325988">{</span><span class="num" id="4325989">1</span><span class="op" id="4325990">,</span>&nbsp;<span class="num" id="4325992">3</span><span class="op" id="4325993">,</span>&nbsp;<span class="num" id="4325995">132</span><span class="op" id="4325998">,</span>&nbsp;<span class="num" id="4326000">0</span><span class="op" id="4326001">,</span>&nbsp;<span class="num" id="4326003">33</span><span class="op" id="4326005">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326008">oidNamedCurveP256</span>&nbsp;<span class="op" id="4326026">=</span>&nbsp;<span class="ident" id="4326028"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4326032">.</span><span class="ident" id="4326033">ObjectIdentifier</span><span class="op" id="4326049">{</span><span class="num" id="4326050">1</span><span class="op" id="4326051">,</span>&nbsp;<span class="num" id="4326053">2</span><span class="op" id="4326054">,</span>&nbsp;<span class="num" id="4326056">840</span><span class="op" id="4326059">,</span>&nbsp;<span class="num" id="4326061">10045</span><span class="op" id="4326066">,</span>&nbsp;<span class="num" id="4326068">3</span><span class="op" id="4326069">,</span>&nbsp;<span class="num" id="4326071">1</span><span class="op" id="4326072">,</span>&nbsp;<span class="num" id="4326074">7</span><span class="op" id="4326075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326078">oidNamedCurveP384</span>&nbsp;<span class="op" id="4326096">=</span>&nbsp;<span class="ident" id="4326098"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4326102">.</span><span class="ident" id="4326103">ObjectIdentifier</span><span class="op" id="4326119">{</span><span class="num" id="4326120">1</span><span class="op" id="4326121">,</span>&nbsp;<span class="num" id="4326123">3</span><span class="op" id="4326124">,</span>&nbsp;<span class="num" id="4326126">132</span><span class="op" id="4326129">,</span>&nbsp;<span class="num" id="4326131">0</span><span class="op" id="4326132">,</span>&nbsp;<span class="num" id="4326134">34</span><span class="op" id="4326136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326139">oidNamedCurveP521</span>&nbsp;<span class="op" id="4326157">=</span>&nbsp;<span class="ident" id="4326159"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4326163">.</span><span class="ident" id="4326164">ObjectIdentifier</span><span class="op" id="4326180">{</span><span class="num" id="4326181">1</span><span class="op" id="4326182">,</span>&nbsp;<span class="num" id="4326184">3</span><span class="op" id="4326185">,</span>&nbsp;<span class="num" id="4326187">132</span><span class="op" id="4326190">,</span>&nbsp;<span class="num" id="4326192">0</span><span class="op" id="4326193">,</span>&nbsp;<span class="num" id="4326195">35</span><span class="op" id="4326197">}</span><br>
<span class="lineno"></span><span class="op" id="4326199">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="4326202">func</span>&nbsp;<span class="ident" id="4326207">namedCurveFromOID</span><span class="op" id="4326224">(</span><span class="ident" id="4326225">oid</span>&nbsp;<span class="ident" id="4326229"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4326233">.</span><span class="ident" id="4326234">ObjectIdentifier</span><span class="op" id="4326250">)</span>&nbsp;<span class="ident" id="4326252"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4326260">.</span><span class="ident" id="4326261">Curve</span>&nbsp;<span class="op" id="4326267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326270">switch</span>&nbsp;<span class="op" id="4326277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326280">case</span>&nbsp;<span class="ident" id="4326285"><a href="/crypto/x509/x509.go.html#4326225">oid</a></span><span class="op" id="4326288">.</span><span class="ident" id="4326289">Equal</span><span class="op" id="4326294">(</span><span class="ident" id="4326295"><a href="/crypto/x509/x509.go.html#4325947">oidNamedCurveP224</a></span><span class="op" id="4326312">)</span><span class="op" id="4326313">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326317">return</span>&nbsp;<span class="ident" id="4326324"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4326332">.</span><span class="ident" id="4326333">P224</span><span class="op" id="4326337">(</span><span class="op" id="4326338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326341">case</span>&nbsp;<span class="ident" id="4326346"><a href="/crypto/x509/x509.go.html#4326225">oid</a></span><span class="op" id="4326349">.</span><span class="ident" id="4326350">Equal</span><span class="op" id="4326355">(</span><span class="ident" id="4326356"><a href="/crypto/x509/x509.go.html#4326008">oidNamedCurveP256</a></span><span class="op" id="4326373">)</span><span class="op" id="4326374">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326378">return</span>&nbsp;<span class="ident" id="4326385"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4326393">.</span><span class="ident" id="4326394">P256</span><span class="op" id="4326398">(</span><span class="op" id="4326399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326402">case</span>&nbsp;<span class="ident" id="4326407"><a href="/crypto/x509/x509.go.html#4326225">oid</a></span><span class="op" id="4326410">.</span><span class="ident" id="4326411">Equal</span><span class="op" id="4326416">(</span><span class="ident" id="4326417"><a href="/crypto/x509/x509.go.html#4326078">oidNamedCurveP384</a></span><span class="op" id="4326434">)</span><span class="op" id="4326435">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326439">return</span>&nbsp;<span class="ident" id="4326446"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4326454">.</span><span class="ident" id="4326455">P384</span><span class="op" id="4326459">(</span><span class="op" id="4326460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326463">case</span>&nbsp;<span class="ident" id="4326468"><a href="/crypto/x509/x509.go.html#4326225">oid</a></span><span class="op" id="4326471">.</span><span class="ident" id="4326472">Equal</span><span class="op" id="4326477">(</span><span class="ident" id="4326478"><a href="/crypto/x509/x509.go.html#4326139">oidNamedCurveP521</a></span><span class="op" id="4326495">)</span><span class="op" id="4326496">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326500">return</span>&nbsp;<span class="ident" id="4326507"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4326515">.</span><span class="ident" id="4326516">P521</span><span class="op" id="4326520">(</span><span class="op" id="4326521">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4326524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326527">return</span>&nbsp;<span class="ident" id="4326534">nil</span><br>
<span class="lineno"></span><span class="op" id="4326538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4326541">func</span>&nbsp;<span class="ident" id="4326546">oidFromNamedCurve</span><span class="op" id="4326563">(</span><span class="ident" id="4326564">curve</span>&nbsp;<span class="ident" id="4326570"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4326578">.</span><span class="ident" id="4326579">Curve</span><span class="op" id="4326584">)</span>&nbsp;<span class="op" id="4326586">(</span><span class="ident" id="4326587"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4326591">.</span><span class="ident" id="4326592">ObjectIdentifier</span><span class="op" id="4326608">,</span>&nbsp;<span class="builtintype" id="4326610">bool</span><span class="op" id="4326614">)</span>&nbsp;<span class="op" id="4326616">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326619">switch</span>&nbsp;<span class="ident" id="4326626"><a href="/crypto/x509/x509.go.html#4326564">curve</a></span>&nbsp;<span class="op" id="4326632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326635">case</span>&nbsp;<span class="ident" id="4326640"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4326648">.</span><span class="ident" id="4326649">P224</span><span class="op" id="4326653">(</span><span class="op" id="4326654">)</span><span class="op" id="4326655">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326659">return</span>&nbsp;<span class="ident" id="4326666"><a href="/crypto/x509/x509.go.html#4325947">oidNamedCurveP224</a></span><span class="op" id="4326683">,</span>&nbsp;<span class="ident" id="4326685">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326691">case</span>&nbsp;<span class="ident" id="4326696"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4326704">.</span><span class="ident" id="4326705">P256</span><span class="op" id="4326709">(</span><span class="op" id="4326710">)</span><span class="op" id="4326711">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326715">return</span>&nbsp;<span class="ident" id="4326722"><a href="/crypto/x509/x509.go.html#4326008">oidNamedCurveP256</a></span><span class="op" id="4326739">,</span>&nbsp;<span class="ident" id="4326741">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326747">case</span>&nbsp;<span class="ident" id="4326752"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4326760">.</span><span class="ident" id="4326761">P384</span><span class="op" id="4326765">(</span><span class="op" id="4326766">)</span><span class="op" id="4326767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326771">return</span>&nbsp;<span class="ident" id="4326778"><a href="/crypto/x509/x509.go.html#4326078">oidNamedCurveP384</a></span><span class="op" id="4326795">,</span>&nbsp;<span class="ident" id="4326797">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326803">case</span>&nbsp;<span class="ident" id="4326808"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4326816">.</span><span class="ident" id="4326817">P521</span><span class="op" id="4326821">(</span><span class="op" id="4326822">)</span><span class="op" id="4326823">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326827">return</span>&nbsp;<span class="ident" id="4326834"><a href="/crypto/x509/x509.go.html#4326139">oidNamedCurveP521</a></span><span class="op" id="4326851">,</span>&nbsp;<span class="ident" id="4326853">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4326859">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4326863">return</span>&nbsp;<span class="ident" id="4326870">nil</span><span class="op" id="4326873">,</span>&nbsp;<span class="ident" id="4326875">false</span><br>
<span class="lineno"></span><span class="op" id="4326881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4326884">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="4326963">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4327003">type</span>&nbsp;<span class="ident" id="4327008">KeyUsage</span>&nbsp;<span class="builtintype" id="4327017">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4327022">const</span>&nbsp;<span class="op" id="4327028">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327031">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="4327056"><a href="/crypto/x509/x509.go.html#4327008">KeyUsage</a></span>&nbsp;<span class="op" id="4327065">=</span>&nbsp;<span class="num" id="4327067">1</span>&nbsp;<span class="op" id="4327069">&lt;&lt;</span>&nbsp;<span class="ident" id="4327072">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327078">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327105">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327130">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327156">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327178">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327196">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327213">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327235">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="4327256">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="4327259">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="4327301">//</span><br>
<span class="lineno"></span><span class="comment" id="4327304">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4327373">//</span><br>
<span class="lineno"></span><span class="comment" id="4327376">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="4327421">//</span><br>
<span class="lineno"></span><span class="comment" id="4327424">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4327490">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4327556">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4327622">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="4327688">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4327754">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4327820">var</span>&nbsp;<span class="op" id="4327824">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327827">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4327868">=</span>&nbsp;<span class="ident" id="4327870"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4327874">.</span><span class="ident" id="4327875">ObjectIdentifier</span><span class="op" id="4327891">{</span><span class="num" id="4327892">2</span><span class="op" id="4327893">,</span>&nbsp;<span class="num" id="4327895">5</span><span class="op" id="4327896">,</span>&nbsp;<span class="num" id="4327898">29</span><span class="op" id="4327900">,</span>&nbsp;<span class="num" id="4327902">37</span><span class="op" id="4327904">,</span>&nbsp;<span class="num" id="4327906">0</span><span class="op" id="4327907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327910">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4327951">=</span>&nbsp;<span class="ident" id="4327953"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4327957">.</span><span class="ident" id="4327958">ObjectIdentifier</span><span class="op" id="4327974">{</span><span class="num" id="4327975">1</span><span class="op" id="4327976">,</span>&nbsp;<span class="num" id="4327978">3</span><span class="op" id="4327979">,</span>&nbsp;<span class="num" id="4327981">6</span><span class="op" id="4327982">,</span>&nbsp;<span class="num" id="4327984">1</span><span class="op" id="4327985">,</span>&nbsp;<span class="num" id="4327987">5</span><span class="op" id="4327988">,</span>&nbsp;<span class="num" id="4327990">5</span><span class="op" id="4327991">,</span>&nbsp;<span class="num" id="4327993">7</span><span class="op" id="4327994">,</span>&nbsp;<span class="num" id="4327996">3</span><span class="op" id="4327997">,</span>&nbsp;<span class="num" id="4327999">1</span><span class="op" id="4328000">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328003">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328044">=</span>&nbsp;<span class="ident" id="4328046"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4328050">.</span><span class="ident" id="4328051">ObjectIdentifier</span><span class="op" id="4328067">{</span><span class="num" id="4328068">1</span><span class="op" id="4328069">,</span>&nbsp;<span class="num" id="4328071">3</span><span class="op" id="4328072">,</span>&nbsp;<span class="num" id="4328074">6</span><span class="op" id="4328075">,</span>&nbsp;<span class="num" id="4328077">1</span><span class="op" id="4328078">,</span>&nbsp;<span class="num" id="4328080">5</span><span class="op" id="4328081">,</span>&nbsp;<span class="num" id="4328083">5</span><span class="op" id="4328084">,</span>&nbsp;<span class="num" id="4328086">7</span><span class="op" id="4328087">,</span>&nbsp;<span class="num" id="4328089">3</span><span class="op" id="4328090">,</span>&nbsp;<span class="num" id="4328092">2</span><span class="op" id="4328093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328096">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328137">=</span>&nbsp;<span class="ident" id="4328139"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4328143">.</span><span class="ident" id="4328144">ObjectIdentifier</span><span class="op" id="4328160">{</span><span class="num" id="4328161">1</span><span class="op" id="4328162">,</span>&nbsp;<span class="num" id="4328164">3</span><span class="op" id="4328165">,</span>&nbsp;<span class="num" id="4328167">6</span><span class="op" id="4328168">,</span>&nbsp;<span class="num" id="4328170">1</span><span class="op" id="4328171">,</span>&nbsp;<span class="num" id="4328173">5</span><span class="op" id="4328174">,</span>&nbsp;<span class="num" id="4328176">5</span><span class="op" id="4328177">,</span>&nbsp;<span class="num" id="4328179">7</span><span class="op" id="4328180">,</span>&nbsp;<span class="num" id="4328182">3</span><span class="op" id="4328183">,</span>&nbsp;<span class="num" id="4328185">3</span><span class="op" id="4328186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328189">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328230">=</span>&nbsp;<span class="ident" id="4328232"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4328236">.</span><span class="ident" id="4328237">ObjectIdentifier</span><span class="op" id="4328253">{</span><span class="num" id="4328254">1</span><span class="op" id="4328255">,</span>&nbsp;<span class="num" id="4328257">3</span><span class="op" id="4328258">,</span>&nbsp;<span class="num" id="4328260">6</span><span class="op" id="4328261">,</span>&nbsp;<span class="num" id="4328263">1</span><span class="op" id="4328264">,</span>&nbsp;<span class="num" id="4328266">5</span><span class="op" id="4328267">,</span>&nbsp;<span class="num" id="4328269">5</span><span class="op" id="4328270">,</span>&nbsp;<span class="num" id="4328272">7</span><span class="op" id="4328273">,</span>&nbsp;<span class="num" id="4328275">3</span><span class="op" id="4328276">,</span>&nbsp;<span class="num" id="4328278">4</span><span class="op" id="4328279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328282">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328323">=</span>&nbsp;<span class="ident" id="4328325"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4328329">.</span><span class="ident" id="4328330">ObjectIdentifier</span><span class="op" id="4328346">{</span><span class="num" id="4328347">1</span><span class="op" id="4328348">,</span>&nbsp;<span class="num" id="4328350">3</span><span class="op" id="4328351">,</span>&nbsp;<span class="num" id="4328353">6</span><span class="op" id="4328354">,</span>&nbsp;<span class="num" id="4328356">1</span><span class="op" id="4328357">,</span>&nbsp;<span class="num" id="4328359">5</span><span class="op" id="4328360">,</span>&nbsp;<span class="num" id="4328362">5</span><span class="op" id="4328363">,</span>&nbsp;<span class="num" id="4328365">7</span><span class="op" id="4328366">,</span>&nbsp;<span class="num" id="4328368">3</span><span class="op" id="4328369">,</span>&nbsp;<span class="num" id="4328371">5</span><span class="op" id="4328372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328375">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328416">=</span>&nbsp;<span class="ident" id="4328418"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4328422">.</span><span class="ident" id="4328423">ObjectIdentifier</span><span class="op" id="4328439">{</span><span class="num" id="4328440">1</span><span class="op" id="4328441">,</span>&nbsp;<span class="num" id="4328443">3</span><span class="op" id="4328444">,</span>&nbsp;<span class="num" id="4328446">6</span><span class="op" id="4328447">,</span>&nbsp;<span class="num" id="4328449">1</span><span class="op" id="4328450">,</span>&nbsp;<span class="num" id="4328452">5</span><span class="op" id="4328453">,</span>&nbsp;<span class="num" id="4328455">5</span><span class="op" id="4328456">,</span>&nbsp;<span class="num" id="4328458">7</span><span class="op" id="4328459">,</span>&nbsp;<span class="num" id="4328461">3</span><span class="op" id="4328462">,</span>&nbsp;<span class="num" id="4328464">6</span><span class="op" id="4328465">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328468">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328509">=</span>&nbsp;<span class="ident" id="4328511"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4328515">.</span><span class="ident" id="4328516">ObjectIdentifier</span><span class="op" id="4328532">{</span><span class="num" id="4328533">1</span><span class="op" id="4328534">,</span>&nbsp;<span class="num" id="4328536">3</span><span class="op" id="4328537">,</span>&nbsp;<span class="num" id="4328539">6</span><span class="op" id="4328540">,</span>&nbsp;<span class="num" id="4328542">1</span><span class="op" id="4328543">,</span>&nbsp;<span class="num" id="4328545">5</span><span class="op" id="4328546">,</span>&nbsp;<span class="num" id="4328548">5</span><span class="op" id="4328549">,</span>&nbsp;<span class="num" id="4328551">7</span><span class="op" id="4328552">,</span>&nbsp;<span class="num" id="4328554">3</span><span class="op" id="4328555">,</span>&nbsp;<span class="num" id="4328557">7</span><span class="op" id="4328558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328561">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328602">=</span>&nbsp;<span class="ident" id="4328604"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4328608">.</span><span class="ident" id="4328609">ObjectIdentifier</span><span class="op" id="4328625">{</span><span class="num" id="4328626">1</span><span class="op" id="4328627">,</span>&nbsp;<span class="num" id="4328629">3</span><span class="op" id="4328630">,</span>&nbsp;<span class="num" id="4328632">6</span><span class="op" id="4328633">,</span>&nbsp;<span class="num" id="4328635">1</span><span class="op" id="4328636">,</span>&nbsp;<span class="num" id="4328638">5</span><span class="op" id="4328639">,</span>&nbsp;<span class="num" id="4328641">5</span><span class="op" id="4328642">,</span>&nbsp;<span class="num" id="4328644">7</span><span class="op" id="4328645">,</span>&nbsp;<span class="num" id="4328647">3</span><span class="op" id="4328648">,</span>&nbsp;<span class="num" id="4328650">8</span><span class="op" id="4328651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328654">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328695">=</span>&nbsp;<span class="ident" id="4328697"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4328701">.</span><span class="ident" id="4328702">ObjectIdentifier</span><span class="op" id="4328718">{</span><span class="num" id="4328719">1</span><span class="op" id="4328720">,</span>&nbsp;<span class="num" id="4328722">3</span><span class="op" id="4328723">,</span>&nbsp;<span class="num" id="4328725">6</span><span class="op" id="4328726">,</span>&nbsp;<span class="num" id="4328728">1</span><span class="op" id="4328729">,</span>&nbsp;<span class="num" id="4328731">5</span><span class="op" id="4328732">,</span>&nbsp;<span class="num" id="4328734">5</span><span class="op" id="4328735">,</span>&nbsp;<span class="num" id="4328737">7</span><span class="op" id="4328738">,</span>&nbsp;<span class="num" id="4328740">3</span><span class="op" id="4328741">,</span>&nbsp;<span class="num" id="4328743">9</span><span class="op" id="4328744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328747">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="4328788">=</span>&nbsp;<span class="ident" id="4328790"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4328794">.</span><span class="ident" id="4328795">ObjectIdentifier</span><span class="op" id="4328811">{</span><span class="num" id="4328812">1</span><span class="op" id="4328813">,</span>&nbsp;<span class="num" id="4328815">3</span><span class="op" id="4328816">,</span>&nbsp;<span class="num" id="4328818">6</span><span class="op" id="4328819">,</span>&nbsp;<span class="num" id="4328821">1</span><span class="op" id="4328822">,</span>&nbsp;<span class="num" id="4328824">4</span><span class="op" id="4328825">,</span>&nbsp;<span class="num" id="4328827">1</span><span class="op" id="4328828">,</span>&nbsp;<span class="num" id="4328830">311</span><span class="op" id="4328833">,</span>&nbsp;<span class="num" id="4328835">10</span><span class="op" id="4328837">,</span>&nbsp;<span class="num" id="4328839">3</span><span class="op" id="4328840">,</span>&nbsp;<span class="num" id="4328842">3</span><span class="op" id="4328843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328846">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="4328887">=</span>&nbsp;<span class="ident" id="4328889"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4328893">.</span><span class="ident" id="4328894">ObjectIdentifier</span><span class="op" id="4328910">{</span><span class="num" id="4328911">2</span><span class="op" id="4328912">,</span>&nbsp;<span class="num" id="4328914">16</span><span class="op" id="4328916">,</span>&nbsp;<span class="num" id="4328918">840</span><span class="op" id="4328921">,</span>&nbsp;<span class="num" id="4328923">1</span><span class="op" id="4328924">,</span>&nbsp;<span class="num" id="4328926">113730</span><span class="op" id="4328932">,</span>&nbsp;<span class="num" id="4328934">4</span><span class="op" id="4328935">,</span>&nbsp;<span class="num" id="4328937">1</span><span class="op" id="4328938">}</span><br>
<span class="lineno">400</span><span class="op" id="4328940">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4328943">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="4329028">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4329090">type</span>&nbsp;<span class="ident" id="4329095">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="4329107">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4329112">const</span>&nbsp;<span class="op" id="4329118">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329121">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="4329136"><a href="/crypto/x509/x509.go.html#4329095">ExtKeyUsage</a></span>&nbsp;<span class="op" id="4329148">=</span>&nbsp;<span class="ident" id="4329150">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329156">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329179">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329202">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329226">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329254">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329281">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329305">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329327">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329352">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329376">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329415">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="4329452">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="4329455">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="4329531">var</span>&nbsp;<span class="ident" id="4329535">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4329551">=</span>&nbsp;<span class="op" id="4329553">[</span><span class="op" id="4329554">]</span><span class="keyword" id="4329555">struct</span>&nbsp;<span class="op" id="4329562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329565">extKeyUsage</span>&nbsp;<span class="ident" id="4329577"><a href="/crypto/x509/x509.go.html#4329095">ExtKeyUsage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329590">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4329602"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4329606">.</span><span class="ident" id="4329607">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="4329624">}</span><span class="op" id="4329625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329628">{</span><span class="ident" id="4329629"><a href="/crypto/x509/x509.go.html#4329121">ExtKeyUsageAny</a></span><span class="op" id="4329643">,</span>&nbsp;<span class="ident" id="4329645"><a href="/crypto/x509/x509.go.html#4327827">oidExtKeyUsageAny</a></span><span class="op" id="4329662">}</span><span class="op" id="4329663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329666">{</span><span class="ident" id="4329667"><a href="/crypto/x509/x509.go.html#4329156">ExtKeyUsageServerAuth</a></span><span class="op" id="4329688">,</span>&nbsp;<span class="ident" id="4329690"><a href="/crypto/x509/x509.go.html#4327910">oidExtKeyUsageServerAuth</a></span><span class="op" id="4329714">}</span><span class="op" id="4329715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329718">{</span><span class="ident" id="4329719"><a href="/crypto/x509/x509.go.html#4329179">ExtKeyUsageClientAuth</a></span><span class="op" id="4329740">,</span>&nbsp;<span class="ident" id="4329742"><a href="/crypto/x509/x509.go.html#4328003">oidExtKeyUsageClientAuth</a></span><span class="op" id="4329766">}</span><span class="op" id="4329767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329770">{</span><span class="ident" id="4329771"><a href="/crypto/x509/x509.go.html#4329202">ExtKeyUsageCodeSigning</a></span><span class="op" id="4329793">,</span>&nbsp;<span class="ident" id="4329795"><a href="/crypto/x509/x509.go.html#4328096">oidExtKeyUsageCodeSigning</a></span><span class="op" id="4329820">}</span><span class="op" id="4329821">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329824">{</span><span class="ident" id="4329825"><a href="/crypto/x509/x509.go.html#4329226">ExtKeyUsageEmailProtection</a></span><span class="op" id="4329851">,</span>&nbsp;<span class="ident" id="4329853"><a href="/crypto/x509/x509.go.html#4328189">oidExtKeyUsageEmailProtection</a></span><span class="op" id="4329882">}</span><span class="op" id="4329883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329886">{</span><span class="ident" id="4329887"><a href="/crypto/x509/x509.go.html#4329254">ExtKeyUsageIPSECEndSystem</a></span><span class="op" id="4329912">,</span>&nbsp;<span class="ident" id="4329914"><a href="/crypto/x509/x509.go.html#4328282">oidExtKeyUsageIPSECEndSystem</a></span><span class="op" id="4329942">}</span><span class="op" id="4329943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329946">{</span><span class="ident" id="4329947"><a href="/crypto/x509/x509.go.html#4329281">ExtKeyUsageIPSECTunnel</a></span><span class="op" id="4329969">,</span>&nbsp;<span class="ident" id="4329971"><a href="/crypto/x509/x509.go.html#4328375">oidExtKeyUsageIPSECTunnel</a></span><span class="op" id="4329996">}</span><span class="op" id="4329997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330000">{</span><span class="ident" id="4330001"><a href="/crypto/x509/x509.go.html#4329305">ExtKeyUsageIPSECUser</a></span><span class="op" id="4330021">,</span>&nbsp;<span class="ident" id="4330023"><a href="/crypto/x509/x509.go.html#4328468">oidExtKeyUsageIPSECUser</a></span><span class="op" id="4330046">}</span><span class="op" id="4330047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330050">{</span><span class="ident" id="4330051"><a href="/crypto/x509/x509.go.html#4329327">ExtKeyUsageTimeStamping</a></span><span class="op" id="4330074">,</span>&nbsp;<span class="ident" id="4330076"><a href="/crypto/x509/x509.go.html#4328561">oidExtKeyUsageTimeStamping</a></span><span class="op" id="4330102">}</span><span class="op" id="4330103">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330106">{</span><span class="ident" id="4330107"><a href="/crypto/x509/x509.go.html#4329352">ExtKeyUsageOCSPSigning</a></span><span class="op" id="4330129">,</span>&nbsp;<span class="ident" id="4330131"><a href="/crypto/x509/x509.go.html#4328654">oidExtKeyUsageOCSPSigning</a></span><span class="op" id="4330156">}</span><span class="op" id="4330157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330160">{</span><span class="ident" id="4330161"><a href="/crypto/x509/x509.go.html#4329376">ExtKeyUsageMicrosoftServerGatedCrypto</a></span><span class="op" id="4330198">,</span>&nbsp;<span class="ident" id="4330200"><a href="/crypto/x509/x509.go.html#4328747">oidExtKeyUsageMicrosoftServerGatedCrypto</a></span><span class="op" id="4330240">}</span><span class="op" id="4330241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330244">{</span><span class="ident" id="4330245"><a href="/crypto/x509/x509.go.html#4329415">ExtKeyUsageNetscapeServerGatedCrypto</a></span><span class="op" id="4330281">,</span>&nbsp;<span class="ident" id="4330283"><a href="/crypto/x509/x509.go.html#4328846">oidExtKeyUsageNetscapeServerGatedCrypto</a></span><span class="op" id="4330322">}</span><span class="op" id="4330323">,</span><br>
<span class="lineno"></span><span class="op" id="4330325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="4330328">func</span>&nbsp;<span class="ident" id="4330333">extKeyUsageFromOID</span><span class="op" id="4330351">(</span><span class="ident" id="4330352">oid</span>&nbsp;<span class="ident" id="4330356"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4330360">.</span><span class="ident" id="4330361">ObjectIdentifier</span><span class="op" id="4330377">)</span>&nbsp;<span class="op" id="4330379">(</span><span class="ident" id="4330380">eku</span>&nbsp;<span class="ident" id="4330384"><a href="/crypto/x509/x509.go.html#4329095">ExtKeyUsage</a></span><span class="op" id="4330395">,</span>&nbsp;<span class="ident" id="4330397">ok</span>&nbsp;<span class="builtintype" id="4330400">bool</span><span class="op" id="4330404">)</span>&nbsp;<span class="op" id="4330406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330409">for</span>&nbsp;<span class="ident" id="4330413">_</span><span class="op" id="4330414">,</span>&nbsp;<span class="ident" id="4330416">pair</span>&nbsp;<span class="op" id="4330421">:=</span>&nbsp;<span class="keyword" id="4330424">range</span>&nbsp;<span class="ident" id="4330430"><a href="/crypto/x509/x509.go.html#4329535">extKeyUsageOIDs</a></span>&nbsp;<span class="op" id="4330446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330450">if</span>&nbsp;<span class="ident" id="4330453"><a href="/crypto/x509/x509.go.html#4330352">oid</a></span><span class="op" id="4330456">.</span><span class="ident" id="4330457">Equal</span><span class="op" id="4330462">(</span><span class="ident" id="4330463"><a href="/crypto/x509/x509.go.html#4330416">pair</a></span><span class="op" id="4330467">.</span><span class="ident" id="4330468">oid</span><span class="op" id="4330471">)</span>&nbsp;<span class="op" id="4330473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330478">return</span>&nbsp;<span class="ident" id="4330485"><a href="/crypto/x509/x509.go.html#4330416">pair</a></span><span class="op" id="4330489">.</span><span class="ident" id="4330490">extKeyUsage</span><span class="op" id="4330501">,</span>&nbsp;<span class="ident" id="4330503">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330510">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330516">return</span><br>
<span class="lineno"></span><span class="op" id="4330523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4330526">func</span>&nbsp;<span class="ident" id="4330531">oidFromExtKeyUsage</span><span class="op" id="4330549">(</span><span class="ident" id="4330550">eku</span>&nbsp;<span class="ident" id="4330554"><a href="/crypto/x509/x509.go.html#4329095">ExtKeyUsage</a></span><span class="op" id="4330565">)</span>&nbsp;<span class="op" id="4330567">(</span><span class="ident" id="4330568">oid</span>&nbsp;<span class="ident" id="4330572"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4330576">.</span><span class="ident" id="4330577">ObjectIdentifier</span><span class="op" id="4330593">,</span>&nbsp;<span class="ident" id="4330595">ok</span>&nbsp;<span class="builtintype" id="4330598">bool</span><span class="op" id="4330602">)</span>&nbsp;<span class="op" id="4330604">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330607">for</span>&nbsp;<span class="ident" id="4330611">_</span><span class="op" id="4330612">,</span>&nbsp;<span class="ident" id="4330614">pair</span>&nbsp;<span class="op" id="4330619">:=</span>&nbsp;<span class="keyword" id="4330622">range</span>&nbsp;<span class="ident" id="4330628"><a href="/crypto/x509/x509.go.html#4329535">extKeyUsageOIDs</a></span>&nbsp;<span class="op" id="4330644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330648">if</span>&nbsp;<span class="ident" id="4330651"><a href="/crypto/x509/x509.go.html#4330550">eku</a></span>&nbsp;<span class="op" id="4330655">==</span>&nbsp;<span class="ident" id="4330658"><a href="/crypto/x509/x509.go.html#4330614">pair</a></span><span class="op" id="4330662">.</span><span class="ident" id="4330663">extKeyUsage</span>&nbsp;<span class="op" id="4330675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330680">return</span>&nbsp;<span class="ident" id="4330687"><a href="/crypto/x509/x509.go.html#4330614">pair</a></span><span class="op" id="4330691">.</span><span class="ident" id="4330692">oid</span><span class="op" id="4330695">,</span>&nbsp;<span class="ident" id="4330697">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330707">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330710">return</span><br>
<span class="lineno"></span><span class="op" id="4330717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4330720">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4330770">type</span>&nbsp;<span class="ident" id="4330775">Certificate</span>&nbsp;<span class="keyword" id="4330787">struct</span>&nbsp;<span class="op" id="4330794">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4330797">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4330821">[</span><span class="op" id="4330822">]</span><span class="builtintype" id="4330823">byte</span>&nbsp;<span class="comment" id="4330828">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4330909">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4330933">[</span><span class="op" id="4330934">]</span><span class="builtintype" id="4330935">byte</span>&nbsp;<span class="comment" id="4330940">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4330987">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4331011">[</span><span class="op" id="4331012">]</span><span class="builtintype" id="4331013">byte</span>&nbsp;<span class="comment" id="4331018">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331056">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4331080">[</span><span class="op" id="4331081">]</span><span class="builtintype" id="4331082">byte</span>&nbsp;<span class="comment" id="4331087">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331111">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4331135">[</span><span class="op" id="4331136">]</span><span class="builtintype" id="4331137">byte</span>&nbsp;<span class="comment" id="4331142">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331166">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4331185">[</span><span class="op" id="4331186">]</span><span class="builtintype" id="4331187">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331193">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4331212"><a href="/crypto/x509/x509.go.html#4320325">SignatureAlgorithm</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331233">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4331252"><a href="/crypto/x509/x509.go.html#4320594">PublicKeyAlgorithm</a></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331272">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4331291">interface</span><span class="op" id="4331300">{</span><span class="op" id="4331301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331305">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4331325">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331330">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4331350">*</span><span class="ident" id="4331351"><a href="/crypto/x509/x509.go.html#4316731">big</a></span><span class="op" id="4331354">.</span><span class="ident" id="4331355">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331360">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4331380"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4331384">.</span><span class="ident" id="4331385">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331391">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4331411"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4331415">.</span><span class="ident" id="4331416">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331422">NotBefore</span><span class="op" id="4331431">,</span>&nbsp;<span class="ident" id="4331433">NotAfter</span>&nbsp;<span class="ident" id="4331442"><a href="/crypto/x509/x509.go.html#4316761">time</a></span><span class="op" id="4331446">.</span><span class="ident" id="4331447">Time</span>&nbsp;<span class="comment" id="4331452">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331473">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4331493"><a href="/crypto/x509/x509.go.html#4327008">KeyUsage</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4331504">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4331577">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4331646">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4331719">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4331762">Extensions</span>&nbsp;<span class="op" id="4331773">[</span><span class="op" id="4331774">]</span><span class="ident" id="4331775"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4331779">.</span><span class="ident" id="4331780">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4331792">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4331860">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4331930">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4332003">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332073">ExtraExtensions</span>&nbsp;<span class="op" id="4332089">[</span><span class="op" id="4332090">]</span><span class="ident" id="4332091"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4332095">.</span><span class="ident" id="4332096">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332108">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4332127">[</span><span class="op" id="4332128">]</span><span class="ident" id="4332129"><a href="/crypto/x509/x509.go.html#4329095">ExtKeyUsage</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4332151">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332188">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4332207">[</span><span class="op" id="4332208">]</span><span class="ident" id="4332209"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4332213">.</span><span class="ident" id="4332214">ObjectIdentifier</span>&nbsp;<span class="comment" id="4332231">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332293">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="4332315">bool</span>&nbsp;<span class="comment" id="4332320">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332368">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4332390">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332396">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4332418">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4332423">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4332489">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4332562">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4332632">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332651">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="4332666">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332673">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4332688">[</span><span class="op" id="4332689">]</span><span class="builtintype" id="4332690">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332696">AuthorityKeyId</span>&nbsp;<span class="op" id="4332711">[</span><span class="op" id="4332712">]</span><span class="builtintype" id="4332713">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4332720">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332773">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4332795">[</span><span class="op" id="4332796">]</span><span class="builtintype" id="4332797">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332805">IssuingCertificateURL</span>&nbsp;<span class="op" id="4332827">[</span><span class="op" id="4332828">]</span><span class="builtintype" id="4332829">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4332838">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332872">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4332887">[</span><span class="op" id="4332888">]</span><span class="builtintype" id="4332889">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332897">EmailAddresses</span>&nbsp;<span class="op" id="4332912">[</span><span class="op" id="4332913">]</span><span class="builtintype" id="4332914">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332922">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4332937">[</span><span class="op" id="4332938">]</span><span class="ident" id="4332939"><a href="/crypto/x509/x509.go.html#4316743">net</a></span><span class="op" id="4332942">.</span><span class="ident" id="4332943">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4332948">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332969">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="4332997">bool</span>&nbsp;<span class="comment" id="4333002">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333061">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4333089">[</span><span class="op" id="4333090">]</span><span class="builtintype" id="4333091">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4333100">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333128">CRLDistributionPoints</span>&nbsp;<span class="op" id="4333150">[</span><span class="op" id="4333151">]</span><span class="builtintype" id="4333152">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333161">PolicyIdentifiers</span>&nbsp;<span class="op" id="4333179">[</span><span class="op" id="4333180">]</span><span class="ident" id="4333181"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4333185">.</span><span class="ident" id="4333186">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="4333203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="4333206">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4333286">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="4333345">var</span>&nbsp;<span class="ident" id="4333349">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="4333373">=</span>&nbsp;<span class="ident" id="4333375"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4333381">.</span><span class="ident" id="4333382">New</span><span class="op" id="4333385">(</span><span class="string" id="4333386">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="4333442">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4333445">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="4333524">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4333604">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4333632">type</span>&nbsp;<span class="ident" id="4333637">ConstraintViolationError</span>&nbsp;<span class="keyword" id="4333662">struct</span><span class="op" id="4333668">{</span><span class="op" id="4333669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4333672">func</span>&nbsp;<span class="op" id="4333677">(</span><span class="ident" id="4333678"><a href="/crypto/x509/x509.go.html#4333637">ConstraintViolationError</a></span><span class="op" id="4333702">)</span>&nbsp;<span class="ident" id="4333704">Error</span><span class="op" id="4333709">(</span><span class="op" id="4333710">)</span>&nbsp;<span class="builtintype" id="4333712">string</span>&nbsp;<span class="op" id="4333719">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4333722">return</span>&nbsp;<span class="string" id="4333729">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="4333812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4333815">func</span>&nbsp;<span class="op" id="4333820">(</span><span class="ident" id="4333821">c</span>&nbsp;<span class="op" id="4333823">*</span><span class="ident" id="4333824"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4333835">)</span>&nbsp;<span class="ident" id="4333837">Equal</span><span class="op" id="4333842">(</span><span class="ident" id="4333843">other</span>&nbsp;<span class="op" id="4333849">*</span><span class="ident" id="4333850"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4333861">)</span>&nbsp;<span class="builtintype" id="4333863">bool</span>&nbsp;<span class="op" id="4333868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4333871">return</span>&nbsp;<span class="ident" id="4333878"><a href="/crypto/x509/x509.go.html#4316527">bytes</a></span><span class="op" id="4333883">.</span><span class="ident" id="4333884">Equal</span><span class="op" id="4333889">(</span><span class="ident" id="4333890"><a href="/crypto/x509/x509.go.html#4333821">c</a></span><span class="op" id="4333891">.</span><span class="ident" id="4333892">Raw</span><span class="op" id="4333895">,</span>&nbsp;<span class="ident" id="4333897"><a href="/crypto/x509/x509.go.html#4333843">other</a></span><span class="op" id="4333902">.</span><span class="ident" id="4333903">Raw</span><span class="op" id="4333906">)</span><br>
<span class="lineno">540</span><span class="op" id="4333908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4333911">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="4333983">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="4334063">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="4334085">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4334160">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="4334203">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="4334269">//</span><br>
<span class="lineno"></span><span class="comment" id="4334272">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="4334344">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="4334359">var</span>&nbsp;<span class="ident" id="4334363">entrustBrokenSPKI</span>&nbsp;<span class="op" id="4334381">=</span>&nbsp;<span class="op" id="4334383">[</span><span class="op" id="4334384">]</span><span class="builtintype" id="4334385">byte</span><span class="op" id="4334389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334392">0x30</span><span class="op" id="4334396">,</span>&nbsp;<span class="num" id="4334398">0x82</span><span class="op" id="4334402">,</span>&nbsp;<span class="num" id="4334404">0x01</span><span class="op" id="4334408">,</span>&nbsp;<span class="num" id="4334410">0x22</span><span class="op" id="4334414">,</span>&nbsp;<span class="num" id="4334416">0x30</span><span class="op" id="4334420">,</span>&nbsp;<span class="num" id="4334422">0x0d</span><span class="op" id="4334426">,</span>&nbsp;<span class="num" id="4334428">0x06</span><span class="op" id="4334432">,</span>&nbsp;<span class="num" id="4334434">0x09</span><span class="op" id="4334438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334441">0x2a</span><span class="op" id="4334445">,</span>&nbsp;<span class="num" id="4334447">0x86</span><span class="op" id="4334451">,</span>&nbsp;<span class="num" id="4334453">0x48</span><span class="op" id="4334457">,</span>&nbsp;<span class="num" id="4334459">0x86</span><span class="op" id="4334463">,</span>&nbsp;<span class="num" id="4334465">0xf7</span><span class="op" id="4334469">,</span>&nbsp;<span class="num" id="4334471">0x0d</span><span class="op" id="4334475">,</span>&nbsp;<span class="num" id="4334477">0x01</span><span class="op" id="4334481">,</span>&nbsp;<span class="num" id="4334483">0x01</span><span class="op" id="4334487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334490">0x01</span><span class="op" id="4334494">,</span>&nbsp;<span class="num" id="4334496">0x05</span><span class="op" id="4334500">,</span>&nbsp;<span class="num" id="4334502">0x00</span><span class="op" id="4334506">,</span>&nbsp;<span class="num" id="4334508">0x03</span><span class="op" id="4334512">,</span>&nbsp;<span class="num" id="4334514">0x82</span><span class="op" id="4334518">,</span>&nbsp;<span class="num" id="4334520">0x01</span><span class="op" id="4334524">,</span>&nbsp;<span class="num" id="4334526">0x0f</span><span class="op" id="4334530">,</span>&nbsp;<span class="num" id="4334532">0x00</span><span class="op" id="4334536">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334539">0x30</span><span class="op" id="4334543">,</span>&nbsp;<span class="num" id="4334545">0x82</span><span class="op" id="4334549">,</span>&nbsp;<span class="num" id="4334551">0x01</span><span class="op" id="4334555">,</span>&nbsp;<span class="num" id="4334557">0x0a</span><span class="op" id="4334561">,</span>&nbsp;<span class="num" id="4334563">0x02</span><span class="op" id="4334567">,</span>&nbsp;<span class="num" id="4334569">0x82</span><span class="op" id="4334573">,</span>&nbsp;<span class="num" id="4334575">0x01</span><span class="op" id="4334579">,</span>&nbsp;<span class="num" id="4334581">0x01</span><span class="op" id="4334585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334588">0x00</span><span class="op" id="4334592">,</span>&nbsp;<span class="num" id="4334594">0x97</span><span class="op" id="4334598">,</span>&nbsp;<span class="num" id="4334600">0xa3</span><span class="op" id="4334604">,</span>&nbsp;<span class="num" id="4334606">0x2d</span><span class="op" id="4334610">,</span>&nbsp;<span class="num" id="4334612">0x3c</span><span class="op" id="4334616">,</span>&nbsp;<span class="num" id="4334618">0x9e</span><span class="op" id="4334622">,</span>&nbsp;<span class="num" id="4334624">0xde</span><span class="op" id="4334628">,</span>&nbsp;<span class="num" id="4334630">0x05</span><span class="op" id="4334634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334637">0xda</span><span class="op" id="4334641">,</span>&nbsp;<span class="num" id="4334643">0x13</span><span class="op" id="4334647">,</span>&nbsp;<span class="num" id="4334649">0xc2</span><span class="op" id="4334653">,</span>&nbsp;<span class="num" id="4334655">0x11</span><span class="op" id="4334659">,</span>&nbsp;<span class="num" id="4334661">0x8d</span><span class="op" id="4334665">,</span>&nbsp;<span class="num" id="4334667">0x9d</span><span class="op" id="4334671">,</span>&nbsp;<span class="num" id="4334673">0x8e</span><span class="op" id="4334677">,</span>&nbsp;<span class="num" id="4334679">0xe3</span><span class="op" id="4334683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334686">0x7f</span><span class="op" id="4334690">,</span>&nbsp;<span class="num" id="4334692">0xc7</span><span class="op" id="4334696">,</span>&nbsp;<span class="num" id="4334698">0x4b</span><span class="op" id="4334702">,</span>&nbsp;<span class="num" id="4334704">0x7e</span><span class="op" id="4334708">,</span>&nbsp;<span class="num" id="4334710">0x5a</span><span class="op" id="4334714">,</span>&nbsp;<span class="num" id="4334716">0x9f</span><span class="op" id="4334720">,</span>&nbsp;<span class="num" id="4334722">0xb3</span><span class="op" id="4334726">,</span>&nbsp;<span class="num" id="4334728">0xff</span><span class="op" id="4334732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334735">0x62</span><span class="op" id="4334739">,</span>&nbsp;<span class="num" id="4334741">0xab</span><span class="op" id="4334745">,</span>&nbsp;<span class="num" id="4334747">0x73</span><span class="op" id="4334751">,</span>&nbsp;<span class="num" id="4334753">0xc8</span><span class="op" id="4334757">,</span>&nbsp;<span class="num" id="4334759">0x28</span><span class="op" id="4334763">,</span>&nbsp;<span class="num" id="4334765">0x6b</span><span class="op" id="4334769">,</span>&nbsp;<span class="num" id="4334771">0xba</span><span class="op" id="4334775">,</span>&nbsp;<span class="num" id="4334777">0x10</span><span class="op" id="4334781">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334784">0x64</span><span class="op" id="4334788">,</span>&nbsp;<span class="num" id="4334790">0x82</span><span class="op" id="4334794">,</span>&nbsp;<span class="num" id="4334796">0x87</span><span class="op" id="4334800">,</span>&nbsp;<span class="num" id="4334802">0x13</span><span class="op" id="4334806">,</span>&nbsp;<span class="num" id="4334808">0xcd</span><span class="op" id="4334812">,</span>&nbsp;<span class="num" id="4334814">0x57</span><span class="op" id="4334818">,</span>&nbsp;<span class="num" id="4334820">0x18</span><span class="op" id="4334824">,</span>&nbsp;<span class="num" id="4334826">0xff</span><span class="op" id="4334830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334833">0x28</span><span class="op" id="4334837">,</span>&nbsp;<span class="num" id="4334839">0xce</span><span class="op" id="4334843">,</span>&nbsp;<span class="num" id="4334845">0xc0</span><span class="op" id="4334849">,</span>&nbsp;<span class="num" id="4334851">0xe6</span><span class="op" id="4334855">,</span>&nbsp;<span class="num" id="4334857">0x0e</span><span class="op" id="4334861">,</span>&nbsp;<span class="num" id="4334863">0x06</span><span class="op" id="4334867">,</span>&nbsp;<span class="num" id="4334869">0x91</span><span class="op" id="4334873">,</span>&nbsp;<span class="num" id="4334875">0x50</span><span class="op" id="4334879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334882">0x29</span><span class="op" id="4334886">,</span>&nbsp;<span class="num" id="4334888">0x83</span><span class="op" id="4334892">,</span>&nbsp;<span class="num" id="4334894">0xd1</span><span class="op" id="4334898">,</span>&nbsp;<span class="num" id="4334900">0xf2</span><span class="op" id="4334904">,</span>&nbsp;<span class="num" id="4334906">0xc3</span><span class="op" id="4334910">,</span>&nbsp;<span class="num" id="4334912">0x2a</span><span class="op" id="4334916">,</span>&nbsp;<span class="num" id="4334918">0xdb</span><span class="op" id="4334922">,</span>&nbsp;<span class="num" id="4334924">0xd8</span><span class="op" id="4334928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334931">0xdb</span><span class="op" id="4334935">,</span>&nbsp;<span class="num" id="4334937">0x4e</span><span class="op" id="4334941">,</span>&nbsp;<span class="num" id="4334943">0x04</span><span class="op" id="4334947">,</span>&nbsp;<span class="num" id="4334949">0xcc</span><span class="op" id="4334953">,</span>&nbsp;<span class="num" id="4334955">0x00</span><span class="op" id="4334959">,</span>&nbsp;<span class="num" id="4334961">0xeb</span><span class="op" id="4334965">,</span>&nbsp;<span class="num" id="4334967">0x8b</span><span class="op" id="4334971">,</span>&nbsp;<span class="num" id="4334973">0xb6</span><span class="op" id="4334977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4334980">0x96</span><span class="op" id="4334984">,</span>&nbsp;<span class="num" id="4334986">0xdc</span><span class="op" id="4334990">,</span>&nbsp;<span class="num" id="4334992">0xbc</span><span class="op" id="4334996">,</span>&nbsp;<span class="num" id="4334998">0xaa</span><span class="op" id="4335002">,</span>&nbsp;<span class="num" id="4335004">0xfa</span><span class="op" id="4335008">,</span>&nbsp;<span class="num" id="4335010">0x52</span><span class="op" id="4335014">,</span>&nbsp;<span class="num" id="4335016">0x77</span><span class="op" id="4335020">,</span>&nbsp;<span class="num" id="4335022">0x04</span><span class="op" id="4335026">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335029">0xc1</span><span class="op" id="4335033">,</span>&nbsp;<span class="num" id="4335035">0xdb</span><span class="op" id="4335039">,</span>&nbsp;<span class="num" id="4335041">0x19</span><span class="op" id="4335045">,</span>&nbsp;<span class="num" id="4335047">0xe4</span><span class="op" id="4335051">,</span>&nbsp;<span class="num" id="4335053">0xae</span><span class="op" id="4335057">,</span>&nbsp;<span class="num" id="4335059">0x9c</span><span class="op" id="4335063">,</span>&nbsp;<span class="num" id="4335065">0xfd</span><span class="op" id="4335069">,</span>&nbsp;<span class="num" id="4335071">0x3c</span><span class="op" id="4335075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335078">0x8b</span><span class="op" id="4335082">,</span>&nbsp;<span class="num" id="4335084">0x03</span><span class="op" id="4335088">,</span>&nbsp;<span class="num" id="4335090">0xef</span><span class="op" id="4335094">,</span>&nbsp;<span class="num" id="4335096">0x4d</span><span class="op" id="4335100">,</span>&nbsp;<span class="num" id="4335102">0xbc</span><span class="op" id="4335106">,</span>&nbsp;<span class="num" id="4335108">0x1a</span><span class="op" id="4335112">,</span>&nbsp;<span class="num" id="4335114">0x03</span><span class="op" id="4335118">,</span>&nbsp;<span class="num" id="4335120">0x65</span><span class="op" id="4335124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335127">0xf9</span><span class="op" id="4335131">,</span>&nbsp;<span class="num" id="4335133">0xc1</span><span class="op" id="4335137">,</span>&nbsp;<span class="num" id="4335139">0xb1</span><span class="op" id="4335143">,</span>&nbsp;<span class="num" id="4335145">0x3f</span><span class="op" id="4335149">,</span>&nbsp;<span class="num" id="4335151">0x72</span><span class="op" id="4335155">,</span>&nbsp;<span class="num" id="4335157">0x86</span><span class="op" id="4335161">,</span>&nbsp;<span class="num" id="4335163">0xf2</span><span class="op" id="4335167">,</span>&nbsp;<span class="num" id="4335169">0x38</span><span class="op" id="4335173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335176">0xaa</span><span class="op" id="4335180">,</span>&nbsp;<span class="num" id="4335182">0x19</span><span class="op" id="4335186">,</span>&nbsp;<span class="num" id="4335188">0xae</span><span class="op" id="4335192">,</span>&nbsp;<span class="num" id="4335194">0x10</span><span class="op" id="4335198">,</span>&nbsp;<span class="num" id="4335200">0x88</span><span class="op" id="4335204">,</span>&nbsp;<span class="num" id="4335206">0x78</span><span class="op" id="4335210">,</span>&nbsp;<span class="num" id="4335212">0x28</span><span class="op" id="4335216">,</span>&nbsp;<span class="num" id="4335218">0xda</span><span class="op" id="4335222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335225">0x75</span><span class="op" id="4335229">,</span>&nbsp;<span class="num" id="4335231">0xc3</span><span class="op" id="4335235">,</span>&nbsp;<span class="num" id="4335237">0x3d</span><span class="op" id="4335241">,</span>&nbsp;<span class="num" id="4335243">0x02</span><span class="op" id="4335247">,</span>&nbsp;<span class="num" id="4335249">0x82</span><span class="op" id="4335253">,</span>&nbsp;<span class="num" id="4335255">0x02</span><span class="op" id="4335259">,</span>&nbsp;<span class="num" id="4335261">0x9c</span><span class="op" id="4335265">,</span>&nbsp;<span class="num" id="4335267">0xb9</span><span class="op" id="4335271">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335274">0xc1</span><span class="op" id="4335278">,</span>&nbsp;<span class="num" id="4335280">0x65</span><span class="op" id="4335284">,</span>&nbsp;<span class="num" id="4335286">0x77</span><span class="op" id="4335290">,</span>&nbsp;<span class="num" id="4335292">0x76</span><span class="op" id="4335296">,</span>&nbsp;<span class="num" id="4335298">0x24</span><span class="op" id="4335302">,</span>&nbsp;<span class="num" id="4335304">0x4c</span><span class="op" id="4335308">,</span>&nbsp;<span class="num" id="4335310">0x98</span><span class="op" id="4335314">,</span>&nbsp;<span class="num" id="4335316">0xf7</span><span class="op" id="4335320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335323">0x6d</span><span class="op" id="4335327">,</span>&nbsp;<span class="num" id="4335329">0x31</span><span class="op" id="4335333">,</span>&nbsp;<span class="num" id="4335335">0x38</span><span class="op" id="4335339">,</span>&nbsp;<span class="num" id="4335341">0xfb</span><span class="op" id="4335345">,</span>&nbsp;<span class="num" id="4335347">0xdb</span><span class="op" id="4335351">,</span>&nbsp;<span class="num" id="4335353">0xfe</span><span class="op" id="4335357">,</span>&nbsp;<span class="num" id="4335359">0xdb</span><span class="op" id="4335363">,</span>&nbsp;<span class="num" id="4335365">0x37</span><span class="op" id="4335369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335372">0x02</span><span class="op" id="4335376">,</span>&nbsp;<span class="num" id="4335378">0x76</span><span class="op" id="4335382">,</span>&nbsp;<span class="num" id="4335384">0xa1</span><span class="op" id="4335388">,</span>&nbsp;<span class="num" id="4335390">0x18</span><span class="op" id="4335394">,</span>&nbsp;<span class="num" id="4335396">0x97</span><span class="op" id="4335400">,</span>&nbsp;<span class="num" id="4335402">0xa6</span><span class="op" id="4335406">,</span>&nbsp;<span class="num" id="4335408">0xcc</span><span class="op" id="4335412">,</span>&nbsp;<span class="num" id="4335414">0xde</span><span class="op" id="4335418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335421">0x20</span><span class="op" id="4335425">,</span>&nbsp;<span class="num" id="4335427">0x09</span><span class="op" id="4335431">,</span>&nbsp;<span class="num" id="4335433">0x49</span><span class="op" id="4335437">,</span>&nbsp;<span class="num" id="4335439">0x36</span><span class="op" id="4335443">,</span>&nbsp;<span class="num" id="4335445">0x24</span><span class="op" id="4335449">,</span>&nbsp;<span class="num" id="4335451">0x69</span><span class="op" id="4335455">,</span>&nbsp;<span class="num" id="4335457">0x42</span><span class="op" id="4335461">,</span>&nbsp;<span class="num" id="4335463">0xf6</span><span class="op" id="4335467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335470">0xe4</span><span class="op" id="4335474">,</span>&nbsp;<span class="num" id="4335476">0x37</span><span class="op" id="4335480">,</span>&nbsp;<span class="num" id="4335482">0x62</span><span class="op" id="4335486">,</span>&nbsp;<span class="num" id="4335488">0xf1</span><span class="op" id="4335492">,</span>&nbsp;<span class="num" id="4335494">0x59</span><span class="op" id="4335498">,</span>&nbsp;<span class="num" id="4335500">0x6d</span><span class="op" id="4335504">,</span>&nbsp;<span class="num" id="4335506">0xa9</span><span class="op" id="4335510">,</span>&nbsp;<span class="num" id="4335512">0x3c</span><span class="op" id="4335516">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335519">0xed</span><span class="op" id="4335523">,</span>&nbsp;<span class="num" id="4335525">0x34</span><span class="op" id="4335529">,</span>&nbsp;<span class="num" id="4335531">0x9c</span><span class="op" id="4335535">,</span>&nbsp;<span class="num" id="4335537">0xa3</span><span class="op" id="4335541">,</span>&nbsp;<span class="num" id="4335543">0x8e</span><span class="op" id="4335547">,</span>&nbsp;<span class="num" id="4335549">0xdb</span><span class="op" id="4335553">,</span>&nbsp;<span class="num" id="4335555">0xdc</span><span class="op" id="4335559">,</span>&nbsp;<span class="num" id="4335561">0x3a</span><span class="op" id="4335565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335568">0xd7</span><span class="op" id="4335572">,</span>&nbsp;<span class="num" id="4335574">0xf7</span><span class="op" id="4335578">,</span>&nbsp;<span class="num" id="4335580">0x0a</span><span class="op" id="4335584">,</span>&nbsp;<span class="num" id="4335586">0x6f</span><span class="op" id="4335590">,</span>&nbsp;<span class="num" id="4335592">0xef</span><span class="op" id="4335596">,</span>&nbsp;<span class="num" id="4335598">0x2e</span><span class="op" id="4335602">,</span>&nbsp;<span class="num" id="4335604">0xd8</span><span class="op" id="4335608">,</span>&nbsp;<span class="num" id="4335610">0xd5</span><span class="op" id="4335614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335617">0x93</span><span class="op" id="4335621">,</span>&nbsp;<span class="num" id="4335623">0x5a</span><span class="op" id="4335627">,</span>&nbsp;<span class="num" id="4335629">0x7a</span><span class="op" id="4335633">,</span>&nbsp;<span class="num" id="4335635">0xed</span><span class="op" id="4335639">,</span>&nbsp;<span class="num" id="4335641">0x08</span><span class="op" id="4335645">,</span>&nbsp;<span class="num" id="4335647">0x49</span><span class="op" id="4335651">,</span>&nbsp;<span class="num" id="4335653">0x68</span><span class="op" id="4335657">,</span>&nbsp;<span class="num" id="4335659">0xe2</span><span class="op" id="4335663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335666">0x41</span><span class="op" id="4335670">,</span>&nbsp;<span class="num" id="4335672">0xe3</span><span class="op" id="4335676">,</span>&nbsp;<span class="num" id="4335678">0x5a</span><span class="op" id="4335682">,</span>&nbsp;<span class="num" id="4335684">0x90</span><span class="op" id="4335688">,</span>&nbsp;<span class="num" id="4335690">0xc1</span><span class="op" id="4335694">,</span>&nbsp;<span class="num" id="4335696">0x86</span><span class="op" id="4335700">,</span>&nbsp;<span class="num" id="4335702">0x55</span><span class="op" id="4335706">,</span>&nbsp;<span class="num" id="4335708">0xfc</span><span class="op" id="4335712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335715">0x51</span><span class="op" id="4335719">,</span>&nbsp;<span class="num" id="4335721">0x43</span><span class="op" id="4335725">,</span>&nbsp;<span class="num" id="4335727">0x9d</span><span class="op" id="4335731">,</span>&nbsp;<span class="num" id="4335733">0xe0</span><span class="op" id="4335737">,</span>&nbsp;<span class="num" id="4335739">0xb2</span><span class="op" id="4335743">,</span>&nbsp;<span class="num" id="4335745">0xc4</span><span class="op" id="4335749">,</span>&nbsp;<span class="num" id="4335751">0x67</span><span class="op" id="4335755">,</span>&nbsp;<span class="num" id="4335757">0xb4</span><span class="op" id="4335761">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335764">0xcb</span><span class="op" id="4335768">,</span>&nbsp;<span class="num" id="4335770">0x32</span><span class="op" id="4335774">,</span>&nbsp;<span class="num" id="4335776">0x31</span><span class="op" id="4335780">,</span>&nbsp;<span class="num" id="4335782">0x25</span><span class="op" id="4335786">,</span>&nbsp;<span class="num" id="4335788">0xf0</span><span class="op" id="4335792">,</span>&nbsp;<span class="num" id="4335794">0x54</span><span class="op" id="4335798">,</span>&nbsp;<span class="num" id="4335800">0x9f</span><span class="op" id="4335804">,</span>&nbsp;<span class="num" id="4335806">0x4b</span><span class="op" id="4335810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335813">0xd1</span><span class="op" id="4335817">,</span>&nbsp;<span class="num" id="4335819">0x6f</span><span class="op" id="4335823">,</span>&nbsp;<span class="num" id="4335825">0xdb</span><span class="op" id="4335829">,</span>&nbsp;<span class="num" id="4335831">0xd4</span><span class="op" id="4335835">,</span>&nbsp;<span class="num" id="4335837">0xdd</span><span class="op" id="4335841">,</span>&nbsp;<span class="num" id="4335843">0xfc</span><span class="op" id="4335847">,</span>&nbsp;<span class="num" id="4335849">0xaf</span><span class="op" id="4335853">,</span>&nbsp;<span class="num" id="4335855">0x5e</span><span class="op" id="4335859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335862">0x6c</span><span class="op" id="4335866">,</span>&nbsp;<span class="num" id="4335868">0x78</span><span class="op" id="4335872">,</span>&nbsp;<span class="num" id="4335874">0x90</span><span class="op" id="4335878">,</span>&nbsp;<span class="num" id="4335880">0x95</span><span class="op" id="4335884">,</span>&nbsp;<span class="num" id="4335886">0xde</span><span class="op" id="4335890">,</span>&nbsp;<span class="num" id="4335892">0xca</span><span class="op" id="4335896">,</span>&nbsp;<span class="num" id="4335898">0x3a</span><span class="op" id="4335902">,</span>&nbsp;<span class="num" id="4335904">0x48</span><span class="op" id="4335908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335911">0xb9</span><span class="op" id="4335915">,</span>&nbsp;<span class="num" id="4335917">0x79</span><span class="op" id="4335921">,</span>&nbsp;<span class="num" id="4335923">0x3c</span><span class="op" id="4335927">,</span>&nbsp;<span class="num" id="4335929">0x9b</span><span class="op" id="4335933">,</span>&nbsp;<span class="num" id="4335935">0x19</span><span class="op" id="4335939">,</span>&nbsp;<span class="num" id="4335941">0xd6</span><span class="op" id="4335945">,</span>&nbsp;<span class="num" id="4335947">0x75</span><span class="op" id="4335951">,</span>&nbsp;<span class="num" id="4335953">0x05</span><span class="op" id="4335957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4335960">0xa0</span><span class="op" id="4335964">,</span>&nbsp;<span class="num" id="4335966">0xf9</span><span class="op" id="4335970">,</span>&nbsp;<span class="num" id="4335972">0x88</span><span class="op" id="4335976">,</span>&nbsp;<span class="num" id="4335978">0xd7</span><span class="op" id="4335982">,</span>&nbsp;<span class="num" id="4335984">0xc1</span><span class="op" id="4335988">,</span>&nbsp;<span class="num" id="4335990">0xe8</span><span class="op" id="4335994">,</span>&nbsp;<span class="num" id="4335996">0xa5</span><span class="op" id="4336000">,</span>&nbsp;<span class="num" id="4336002">0x09</span><span class="op" id="4336006">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4336009">0xe4</span><span class="op" id="4336013">,</span>&nbsp;<span class="num" id="4336015">0x1a</span><span class="op" id="4336019">,</span>&nbsp;<span class="num" id="4336021">0x15</span><span class="op" id="4336025">,</span>&nbsp;<span class="num" id="4336027">0xdc</span><span class="op" id="4336031">,</span>&nbsp;<span class="num" id="4336033">0x87</span><span class="op" id="4336037">,</span>&nbsp;<span class="num" id="4336039">0x23</span><span class="op" id="4336043">,</span>&nbsp;<span class="num" id="4336045">0xaa</span><span class="op" id="4336049">,</span>&nbsp;<span class="num" id="4336051">0xb2</span><span class="op" id="4336055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4336058">0x75</span><span class="op" id="4336062">,</span>&nbsp;<span class="num" id="4336064">0x8c</span><span class="op" id="4336068">,</span>&nbsp;<span class="num" id="4336070">0x63</span><span class="op" id="4336074">,</span>&nbsp;<span class="num" id="4336076">0x25</span><span class="op" id="4336080">,</span>&nbsp;<span class="num" id="4336082">0x87</span><span class="op" id="4336086">,</span>&nbsp;<span class="num" id="4336088">0xd8</span><span class="op" id="4336092">,</span>&nbsp;<span class="num" id="4336094">0xf8</span><span class="op" id="4336098">,</span>&nbsp;<span class="num" id="4336100">0x3d</span><span class="op" id="4336104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4336107">0xa6</span><span class="op" id="4336111">,</span>&nbsp;<span class="num" id="4336113">0xc2</span><span class="op" id="4336117">,</span>&nbsp;<span class="num" id="4336119">0xcc</span><span class="op" id="4336123">,</span>&nbsp;<span class="num" id="4336125">0x66</span><span class="op" id="4336129">,</span>&nbsp;<span class="num" id="4336131">0xff</span><span class="op" id="4336135">,</span>&nbsp;<span class="num" id="4336137">0xa5</span><span class="op" id="4336141">,</span>&nbsp;<span class="num" id="4336143">0x66</span><span class="op" id="4336147">,</span>&nbsp;<span class="num" id="4336149">0x68</span><span class="op" id="4336153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4336156">0x55</span><span class="op" id="4336160">,</span>&nbsp;<span class="num" id="4336162">0x02</span><span class="op" id="4336166">,</span>&nbsp;<span class="num" id="4336168">0x03</span><span class="op" id="4336172">,</span>&nbsp;<span class="num" id="4336174">0x01</span><span class="op" id="4336178">,</span>&nbsp;<span class="num" id="4336180">0x00</span><span class="op" id="4336184">,</span>&nbsp;<span class="num" id="4336186">0x01</span><span class="op" id="4336190">,</span><br>
<span class="lineno"></span><span class="op" id="4336192">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4336195">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="4336271">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="4336287">func</span>&nbsp;<span class="op" id="4336292">(</span><span class="ident" id="4336293">c</span>&nbsp;<span class="op" id="4336295">*</span><span class="ident" id="4336296"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4336307">)</span>&nbsp;<span class="ident" id="4336309">CheckSignatureFrom</span><span class="op" id="4336327">(</span><span class="ident" id="4336328">parent</span>&nbsp;<span class="op" id="4336335">*</span><span class="ident" id="4336336"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4336347">)</span>&nbsp;<span class="op" id="4336349">(</span><span class="ident" id="4336350">err</span>&nbsp;<span class="builtintype" id="4336354">error</span><span class="op" id="4336359">)</span>&nbsp;<span class="op" id="4336361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4336364">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4336387">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4336457">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4336528">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4336599">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4336628">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4336690">if</span>&nbsp;<span class="op" id="4336693">(</span><span class="ident" id="4336694"><a href="/crypto/x509/x509.go.html#4336328">parent</a></span><span class="op" id="4336700">.</span><span class="ident" id="4336701">Version</span>&nbsp;<span class="op" id="4336709">==</span>&nbsp;<span class="num" id="4336712">3</span>&nbsp;<span class="op" id="4336714">&amp;&amp;</span>&nbsp;<span class="op" id="4336717">!</span><span class="ident" id="4336718"><a href="/crypto/x509/x509.go.html#4336328">parent</a></span><span class="op" id="4336724">.</span><span class="ident" id="4336725">BasicConstraintsValid</span>&nbsp;<span class="op" id="4336747">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336752"><a href="/crypto/x509/x509.go.html#4336328">parent</a></span><span class="op" id="4336758">.</span><span class="ident" id="4336759">BasicConstraintsValid</span>&nbsp;<span class="op" id="4336781">&amp;&amp;</span>&nbsp;<span class="op" id="4336784">!</span><span class="ident" id="4336785"><a href="/crypto/x509/x509.go.html#4336328">parent</a></span><span class="op" id="4336791">.</span><span class="ident" id="4336792">IsCA</span><span class="op" id="4336796">)</span>&nbsp;<span class="op" id="4336798">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4336803">!</span><span class="ident" id="4336804"><a href="/crypto/x509/x509.go.html#4316527">bytes</a></span><span class="op" id="4336809">.</span><span class="ident" id="4336810">Equal</span><span class="op" id="4336815">(</span><span class="ident" id="4336816"><a href="/crypto/x509/x509.go.html#4336293">c</a></span><span class="op" id="4336817">.</span><span class="ident" id="4336818">RawSubjectPublicKeyInfo</span><span class="op" id="4336841">,</span>&nbsp;<span class="ident" id="4336843"><a href="/crypto/x509/x509.go.html#4334363">entrustBrokenSPKI</a></span><span class="op" id="4336860">)</span>&nbsp;<span class="op" id="4336862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4336866">return</span>&nbsp;<span class="ident" id="4336873"><a href="/crypto/x509/x509.go.html#4333637">ConstraintViolationError</a></span><span class="op" id="4336897">{</span><span class="op" id="4336898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4336901">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4336905">if</span>&nbsp;<span class="ident" id="4336908"><a href="/crypto/x509/x509.go.html#4336328">parent</a></span><span class="op" id="4336914">.</span><span class="ident" id="4336915">KeyUsage</span>&nbsp;<span class="op" id="4336924">!=</span>&nbsp;<span class="num" id="4336927">0</span>&nbsp;<span class="op" id="4336929">&amp;&amp;</span>&nbsp;<span class="ident" id="4336932"><a href="/crypto/x509/x509.go.html#4336328">parent</a></span><span class="op" id="4336938">.</span><span class="ident" id="4336939">KeyUsage</span><span class="op" id="4336947">&amp;</span><span class="ident" id="4336948"><a href="/crypto/x509/x509.go.html#4327178">KeyUsageCertSign</a></span>&nbsp;<span class="op" id="4336965">==</span>&nbsp;<span class="num" id="4336968">0</span>&nbsp;<span class="op" id="4336970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4336974">return</span>&nbsp;<span class="ident" id="4336981"><a href="/crypto/x509/x509.go.html#4333637">ConstraintViolationError</a></span><span class="op" id="4337005">{</span><span class="op" id="4337006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4337009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337013">if</span>&nbsp;<span class="ident" id="4337016"><a href="/crypto/x509/x509.go.html#4336328">parent</a></span><span class="op" id="4337022">.</span><span class="ident" id="4337023">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4337042">==</span>&nbsp;<span class="ident" id="4337045"><a href="/crypto/x509/x509.go.html#4320627">UnknownPublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4337071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337075">return</span>&nbsp;<span class="ident" id="4337082"><a href="/crypto/x509/x509.go.html#4333349">ErrUnsupportedAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4337107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4337111">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337168">return</span>&nbsp;<span class="ident" id="4337175"><a href="/crypto/x509/x509.go.html#4336328">parent</a></span><span class="op" id="4337181">.</span><span class="ident" id="4337182">CheckSignature</span><span class="op" id="4337196">(</span><span class="ident" id="4337197"><a href="/crypto/x509/x509.go.html#4336293">c</a></span><span class="op" id="4337198">.</span><span class="ident" id="4337199">SignatureAlgorithm</span><span class="op" id="4337217">,</span>&nbsp;<span class="ident" id="4337219"><a href="/crypto/x509/x509.go.html#4336293">c</a></span><span class="op" id="4337220">.</span><span class="ident" id="4337221">RawTBSCertificate</span><span class="op" id="4337238">,</span>&nbsp;<span class="ident" id="4337240"><a href="/crypto/x509/x509.go.html#4336293">c</a></span><span class="op" id="4337241">.</span><span class="ident" id="4337242">Signature</span><span class="op" id="4337251">)</span><br>
<span class="lineno"></span><span class="op" id="4337253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4337256">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="4337336">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4337355">func</span>&nbsp;<span class="op" id="4337360">(</span><span class="ident" id="4337361">c</span>&nbsp;<span class="op" id="4337363">*</span><span class="ident" id="4337364"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4337375">)</span>&nbsp;<span class="ident" id="4337377">CheckSignature</span><span class="op" id="4337391">(</span><span class="ident" id="4337392">algo</span>&nbsp;<span class="ident" id="4337397"><a href="/crypto/x509/x509.go.html#4320325">SignatureAlgorithm</a></span><span class="op" id="4337415">,</span>&nbsp;<span class="ident" id="4337417">signed</span><span class="op" id="4337423">,</span>&nbsp;<span class="ident" id="4337425">signature</span>&nbsp;<span class="op" id="4337435">[</span><span class="op" id="4337436">]</span><span class="builtintype" id="4337437">byte</span><span class="op" id="4337441">)</span>&nbsp;<span class="op" id="4337443">(</span><span class="ident" id="4337444">err</span>&nbsp;<span class="builtintype" id="4337448">error</span><span class="op" id="4337453">)</span>&nbsp;<span class="op" id="4337455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337458">var</span>&nbsp;<span class="ident" id="4337462">hashType</span>&nbsp;<span class="ident" id="4337471"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4337477">.</span><span class="ident" id="4337478">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337485">switch</span>&nbsp;<span class="ident" id="4337492"><a href="/crypto/x509/x509.go.html#4337392">algo</a></span>&nbsp;<span class="op" id="4337497">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337500">case</span>&nbsp;<span class="ident" id="4337505"><a href="/crypto/x509/x509.go.html#4320435">SHA1WithRSA</a></span><span class="op" id="4337516">,</span>&nbsp;<span class="ident" id="4337518"><a href="/crypto/x509/x509.go.html#4320493">DSAWithSHA1</a></span><span class="op" id="4337529">,</span>&nbsp;<span class="ident" id="4337531"><a href="/crypto/x509/x509.go.html#4320521">ECDSAWithSHA1</a></span><span class="op" id="4337544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337548"><a href="/crypto/x509/x509.go.html#4337462">hashType</a></span>&nbsp;<span class="op" id="4337557">=</span>&nbsp;<span class="ident" id="4337559"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4337565">.</span><span class="ident" id="4337566">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337572">case</span>&nbsp;<span class="ident" id="4337577"><a href="/crypto/x509/x509.go.html#4320448">SHA256WithRSA</a></span><span class="op" id="4337590">,</span>&nbsp;<span class="ident" id="4337592"><a href="/crypto/x509/x509.go.html#4320506">DSAWithSHA256</a></span><span class="op" id="4337605">,</span>&nbsp;<span class="ident" id="4337607"><a href="/crypto/x509/x509.go.html#4320536">ECDSAWithSHA256</a></span><span class="op" id="4337622">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337626"><a href="/crypto/x509/x509.go.html#4337462">hashType</a></span>&nbsp;<span class="op" id="4337635">=</span>&nbsp;<span class="ident" id="4337637"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4337643">.</span><span class="ident" id="4337644">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337652">case</span>&nbsp;<span class="ident" id="4337657"><a href="/crypto/x509/x509.go.html#4320463">SHA384WithRSA</a></span><span class="op" id="4337670">,</span>&nbsp;<span class="ident" id="4337672"><a href="/crypto/x509/x509.go.html#4320553">ECDSAWithSHA384</a></span><span class="op" id="4337687">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337691"><a href="/crypto/x509/x509.go.html#4337462">hashType</a></span>&nbsp;<span class="op" id="4337700">=</span>&nbsp;<span class="ident" id="4337702"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4337708">.</span><span class="ident" id="4337709">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337717">case</span>&nbsp;<span class="ident" id="4337722"><a href="/crypto/x509/x509.go.html#4320478">SHA512WithRSA</a></span><span class="op" id="4337735">,</span>&nbsp;<span class="ident" id="4337737"><a href="/crypto/x509/x509.go.html#4320570">ECDSAWithSHA512</a></span><span class="op" id="4337752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337756"><a href="/crypto/x509/x509.go.html#4337462">hashType</a></span>&nbsp;<span class="op" id="4337765">=</span>&nbsp;<span class="ident" id="4337767"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4337773">.</span><span class="ident" id="4337774">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337782">default</span><span class="op" id="4337789">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337793">return</span>&nbsp;<span class="ident" id="4337800"><a href="/crypto/x509/x509.go.html#4333349">ErrUnsupportedAlgorithm</a></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4337825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337829">if</span>&nbsp;<span class="op" id="4337832">!</span><span class="ident" id="4337833"><a href="/crypto/x509/x509.go.html#4337462">hashType</a></span><span class="op" id="4337841">.</span><span class="ident" id="4337842">Available</span><span class="op" id="4337851">(</span><span class="op" id="4337852">)</span>&nbsp;<span class="op" id="4337854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337858">return</span>&nbsp;<span class="ident" id="4337865"><a href="/crypto/x509/x509.go.html#4333349">ErrUnsupportedAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4337890">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337893">h</span>&nbsp;<span class="op" id="4337895">:=</span>&nbsp;<span class="ident" id="4337898"><a href="/crypto/x509/x509.go.html#4337462">hashType</a></span><span class="op" id="4337906">.</span><span class="ident" id="4337907">New</span><span class="op" id="4337910">(</span><span class="op" id="4337911">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337915"><a href="/crypto/x509/x509.go.html#4337893">h</a></span><span class="op" id="4337916">.</span><span class="ident" id="4337917">Write</span><span class="op" id="4337922">(</span><span class="ident" id="4337923"><a href="/crypto/x509/x509.go.html#4337417">signed</a></span><span class="op" id="4337929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337932">digest</span>&nbsp;<span class="op" id="4337939">:=</span>&nbsp;<span class="ident" id="4337942"><a href="/crypto/x509/x509.go.html#4337893">h</a></span><span class="op" id="4337943">.</span><span class="ident" id="4337944">Sum</span><span class="op" id="4337947">(</span><span class="ident" id="4337948">nil</span><span class="op" id="4337951">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337955">switch</span>&nbsp;<span class="ident" id="4337962">pub</span>&nbsp;<span class="op" id="4337966">:=</span>&nbsp;<span class="ident" id="4337969"><a href="/crypto/x509/x509.go.html#4337361">c</a></span><span class="op" id="4337970">.</span><span class="ident" id="4337971">PublicKey</span><span class="op" id="4337980">.</span><span class="op" id="4337981">(</span><span class="keyword" id="4337982">type</span><span class="op" id="4337986">)</span>&nbsp;<span class="op" id="4337988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4337991">case</span>&nbsp;<span class="op" id="4337996">*</span><span class="ident" id="4337997"><a href="/crypto/x509/x509.go.html#4316595">rsa</a></span><span class="op" id="4338000">.</span><span class="ident" id="4338001">PublicKey</span><span class="op" id="4338010">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338014">return</span>&nbsp;<span class="ident" id="4338021"><a href="/crypto/x509/x509.go.html#4316595">rsa</a></span><span class="op" id="4338024">.</span><span class="ident" id="4338025">VerifyPKCS1v15</span><span class="op" id="4338039">(</span><span class="ident" id="4338040"><a href="/crypto/x509/x509.go.html#4337962">pub</a></span><span class="op" id="4338043">,</span>&nbsp;<span class="ident" id="4338045"><a href="/crypto/x509/x509.go.html#4337462">hashType</a></span><span class="op" id="4338053">,</span>&nbsp;<span class="ident" id="4338055"><a href="/crypto/x509/x509.go.html#4337932">digest</a></span><span class="op" id="4338061">,</span>&nbsp;<span class="ident" id="4338063"><a href="/crypto/x509/x509.go.html#4337425">signature</a></span><span class="op" id="4338072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338075">case</span>&nbsp;<span class="op" id="4338080">*</span><span class="ident" id="4338081"><a href="/crypto/x509/x509.go.html#4316546">dsa</a></span><span class="op" id="4338084">.</span><span class="ident" id="4338085">PublicKey</span><span class="op" id="4338094">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4338098">dsaSig</span>&nbsp;<span class="op" id="4338105">:=</span>&nbsp;<span class="builtinfunc" id="4338108">new</span><span class="op" id="4338111">(</span><span class="ident" id="4338112"><a href="/crypto/x509/x509.go.html#4319985">dsaSignature</a></span><span class="op" id="4338124">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338128">if</span>&nbsp;<span class="ident" id="4338131">_</span><span class="op" id="4338132">,</span>&nbsp;<span class="ident" id="4338134">err</span>&nbsp;<span class="op" id="4338138">:=</span>&nbsp;<span class="ident" id="4338141"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4338145">.</span><span class="ident" id="4338146">Unmarshal</span><span class="op" id="4338155">(</span><span class="ident" id="4338156"><a href="/crypto/x509/x509.go.html#4337425">signature</a></span><span class="op" id="4338165">,</span>&nbsp;<span class="ident" id="4338167"><a href="/crypto/x509/x509.go.html#4338098">dsaSig</a></span><span class="op" id="4338173">)</span><span class="op" id="4338174">;</span>&nbsp;<span class="ident" id="4338176"><a href="/crypto/x509/x509.go.html#4338134">err</a></span>&nbsp;<span class="op" id="4338180">!=</span>&nbsp;<span class="ident" id="4338183">nil</span>&nbsp;<span class="op" id="4338187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338192">return</span>&nbsp;<span class="ident" id="4338199"><a href="/crypto/x509/x509.go.html#4338134">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4338205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338209">if</span>&nbsp;<span class="ident" id="4338212"><a href="/crypto/x509/x509.go.html#4338098">dsaSig</a></span><span class="op" id="4338218">.</span><span class="ident" id="4338219">R</span><span class="op" id="4338220">.</span><span class="ident" id="4338221">Sign</span><span class="op" id="4338225">(</span><span class="op" id="4338226">)</span>&nbsp;<span class="op" id="4338228">&lt;=</span>&nbsp;<span class="num" id="4338231">0</span>&nbsp;<span class="op" id="4338233">||</span>&nbsp;<span class="ident" id="4338236"><a href="/crypto/x509/x509.go.html#4338098">dsaSig</a></span><span class="op" id="4338242">.</span><span class="ident" id="4338243">S</span><span class="op" id="4338244">.</span><span class="ident" id="4338245">Sign</span><span class="op" id="4338249">(</span><span class="op" id="4338250">)</span>&nbsp;<span class="op" id="4338252">&lt;=</span>&nbsp;<span class="num" id="4338255">0</span>&nbsp;<span class="op" id="4338257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338262">return</span>&nbsp;<span class="ident" id="4338269"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4338275">.</span><span class="ident" id="4338276">New</span><span class="op" id="4338279">(</span><span class="string" id="4338280">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4338335">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4338339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338343">if</span>&nbsp;<span class="op" id="4338346">!</span><span class="ident" id="4338347"><a href="/crypto/x509/x509.go.html#4316546">dsa</a></span><span class="op" id="4338350">.</span><span class="ident" id="4338351">Verify</span><span class="op" id="4338357">(</span><span class="ident" id="4338358"><a href="/crypto/x509/x509.go.html#4337962">pub</a></span><span class="op" id="4338361">,</span>&nbsp;<span class="ident" id="4338363"><a href="/crypto/x509/x509.go.html#4337932">digest</a></span><span class="op" id="4338369">,</span>&nbsp;<span class="ident" id="4338371"><a href="/crypto/x509/x509.go.html#4338098">dsaSig</a></span><span class="op" id="4338377">.</span><span class="ident" id="4338378">R</span><span class="op" id="4338379">,</span>&nbsp;<span class="ident" id="4338381"><a href="/crypto/x509/x509.go.html#4338098">dsaSig</a></span><span class="op" id="4338387">.</span><span class="ident" id="4338388">S</span><span class="op" id="4338389">)</span>&nbsp;<span class="op" id="4338391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338396">return</span>&nbsp;<span class="ident" id="4338403"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4338409">.</span><span class="ident" id="4338410">New</span><span class="op" id="4338413">(</span><span class="string" id="4338414">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4338446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4338450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338454">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338462">case</span>&nbsp;<span class="op" id="4338467">*</span><span class="ident" id="4338468"><a href="/crypto/x509/x509.go.html#4316560">ecdsa</a></span><span class="op" id="4338473">.</span><span class="ident" id="4338474">PublicKey</span><span class="op" id="4338483">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4338487">ecdsaSig</span>&nbsp;<span class="op" id="4338496">:=</span>&nbsp;<span class="builtinfunc" id="4338499">new</span><span class="op" id="4338502">(</span><span class="ident" id="4338503"><a href="/crypto/x509/x509.go.html#4320030">ecdsaSignature</a></span><span class="op" id="4338517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338521">if</span>&nbsp;<span class="ident" id="4338524">_</span><span class="op" id="4338525">,</span>&nbsp;<span class="ident" id="4338527">err</span>&nbsp;<span class="op" id="4338531">:=</span>&nbsp;<span class="ident" id="4338534"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4338538">.</span><span class="ident" id="4338539">Unmarshal</span><span class="op" id="4338548">(</span><span class="ident" id="4338549"><a href="/crypto/x509/x509.go.html#4337425">signature</a></span><span class="op" id="4338558">,</span>&nbsp;<span class="ident" id="4338560"><a href="/crypto/x509/x509.go.html#4338487">ecdsaSig</a></span><span class="op" id="4338568">)</span><span class="op" id="4338569">;</span>&nbsp;<span class="ident" id="4338571"><a href="/crypto/x509/x509.go.html#4338527">err</a></span>&nbsp;<span class="op" id="4338575">!=</span>&nbsp;<span class="ident" id="4338578">nil</span>&nbsp;<span class="op" id="4338582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338587">return</span>&nbsp;<span class="ident" id="4338594"><a href="/crypto/x509/x509.go.html#4338527">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4338600">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338604">if</span>&nbsp;<span class="ident" id="4338607"><a href="/crypto/x509/x509.go.html#4338487">ecdsaSig</a></span><span class="op" id="4338615">.</span><span class="ident" id="4338616">R</span><span class="op" id="4338617">.</span><span class="ident" id="4338618">Sign</span><span class="op" id="4338622">(</span><span class="op" id="4338623">)</span>&nbsp;<span class="op" id="4338625">&lt;=</span>&nbsp;<span class="num" id="4338628">0</span>&nbsp;<span class="op" id="4338630">||</span>&nbsp;<span class="ident" id="4338633"><a href="/crypto/x509/x509.go.html#4338487">ecdsaSig</a></span><span class="op" id="4338641">.</span><span class="ident" id="4338642">S</span><span class="op" id="4338643">.</span><span class="ident" id="4338644">Sign</span><span class="op" id="4338648">(</span><span class="op" id="4338649">)</span>&nbsp;<span class="op" id="4338651">&lt;=</span>&nbsp;<span class="num" id="4338654">0</span>&nbsp;<span class="op" id="4338656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338661">return</span>&nbsp;<span class="ident" id="4338668"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4338674">.</span><span class="ident" id="4338675">New</span><span class="op" id="4338678">(</span><span class="string" id="4338679">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4338736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4338740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338744">if</span>&nbsp;<span class="op" id="4338747">!</span><span class="ident" id="4338748"><a href="/crypto/x509/x509.go.html#4316560">ecdsa</a></span><span class="op" id="4338753">.</span><span class="ident" id="4338754">Verify</span><span class="op" id="4338760">(</span><span class="ident" id="4338761"><a href="/crypto/x509/x509.go.html#4337962">pub</a></span><span class="op" id="4338764">,</span>&nbsp;<span class="ident" id="4338766"><a href="/crypto/x509/x509.go.html#4337932">digest</a></span><span class="op" id="4338772">,</span>&nbsp;<span class="ident" id="4338774"><a href="/crypto/x509/x509.go.html#4338487">ecdsaSig</a></span><span class="op" id="4338782">.</span><span class="ident" id="4338783">R</span><span class="op" id="4338784">,</span>&nbsp;<span class="ident" id="4338786"><a href="/crypto/x509/x509.go.html#4338487">ecdsaSig</a></span><span class="op" id="4338794">.</span><span class="ident" id="4338795">S</span><span class="op" id="4338796">)</span>&nbsp;<span class="op" id="4338798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338803">return</span>&nbsp;<span class="ident" id="4338810"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4338816">.</span><span class="ident" id="4338817">New</span><span class="op" id="4338820">(</span><span class="string" id="4338821">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4338855">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4338859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338863">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4338871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4338874">return</span>&nbsp;<span class="ident" id="4338881"><a href="/crypto/x509/x509.go.html#4333349">ErrUnsupportedAlgorithm</a></span><br>
<span class="lineno"></span><span class="op" id="4338905">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="4338908">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4338973">func</span>&nbsp;<span class="op" id="4338978">(</span><span class="ident" id="4338979">c</span>&nbsp;<span class="op" id="4338981">*</span><span class="ident" id="4338982"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4338993">)</span>&nbsp;<span class="ident" id="4338995">CheckCRLSignature</span><span class="op" id="4339012">(</span><span class="ident" id="4339013">crl</span>&nbsp;<span class="op" id="4339017">*</span><span class="ident" id="4339018"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4339022">.</span><span class="ident" id="4339023">CertificateList</span><span class="op" id="4339038">)</span>&nbsp;<span class="op" id="4339040">(</span><span class="ident" id="4339041">err</span>&nbsp;<span class="builtintype" id="4339045">error</span><span class="op" id="4339050">)</span>&nbsp;<span class="op" id="4339052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339055">algo</span>&nbsp;<span class="op" id="4339060">:=</span>&nbsp;<span class="ident" id="4339063"><a href="/crypto/x509/x509.go.html#4324214">getSignatureAlgorithmFromOID</a></span><span class="op" id="4339091">(</span><span class="ident" id="4339092"><a href="/crypto/x509/x509.go.html#4339013">crl</a></span><span class="op" id="4339095">.</span><span class="ident" id="4339096">SignatureAlgorithm</span><span class="op" id="4339114">.</span><span class="ident" id="4339115">Algorithm</span><span class="op" id="4339124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4339127">return</span>&nbsp;<span class="ident" id="4339134"><a href="/crypto/x509/x509.go.html#4338979">c</a></span><span class="op" id="4339135">.</span><span class="ident" id="4339136">CheckSignature</span><span class="op" id="4339150">(</span><span class="ident" id="4339151"><a href="/crypto/x509/x509.go.html#4339055">algo</a></span><span class="op" id="4339155">,</span>&nbsp;<span class="ident" id="4339157"><a href="/crypto/x509/x509.go.html#4339013">crl</a></span><span class="op" id="4339160">.</span><span class="ident" id="4339161">TBSCertList</span><span class="op" id="4339172">.</span><span class="ident" id="4339173">Raw</span><span class="op" id="4339176">,</span>&nbsp;<span class="ident" id="4339178"><a href="/crypto/x509/x509.go.html#4339013">crl</a></span><span class="op" id="4339181">.</span><span class="ident" id="4339182">SignatureValue</span><span class="op" id="4339196">.</span><span class="ident" id="4339197">RightAlign</span><span class="op" id="4339207">(</span><span class="op" id="4339208">)</span><span class="op" id="4339209">)</span><br>
<span class="lineno">680</span><span class="op" id="4339211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4339214">type</span>&nbsp;<span class="ident" id="4339219">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="4339246">struct</span><span class="op" id="4339252">{</span><span class="op" id="4339253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4339256">func</span>&nbsp;<span class="op" id="4339261">(</span><span class="ident" id="4339262">h</span>&nbsp;<span class="ident" id="4339264"><a href="/crypto/x509/x509.go.html#4339219">UnhandledCriticalExtension</a></span><span class="op" id="4339290">)</span>&nbsp;<span class="ident" id="4339292">Error</span><span class="op" id="4339297">(</span><span class="op" id="4339298">)</span>&nbsp;<span class="builtintype" id="4339300">string</span>&nbsp;<span class="op" id="4339307">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4339310">return</span>&nbsp;<span class="string" id="4339317">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="4339354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4339357">type</span>&nbsp;<span class="ident" id="4339362">basicConstraints</span>&nbsp;<span class="keyword" id="4339379">struct</span>&nbsp;<span class="op" id="4339386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339389">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4339400">bool</span>&nbsp;<span class="string" id="4339405">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339424">MaxPathLen</span>&nbsp;<span class="builtintype" id="4339435">int</span>&nbsp;&nbsp;<span class="string" id="4339440">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4339469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4339472">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="4339492">type</span>&nbsp;<span class="ident" id="4339497">policyInformation</span>&nbsp;<span class="keyword" id="4339515">struct</span>&nbsp;<span class="op" id="4339522">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339525">Policy</span>&nbsp;<span class="ident" id="4339532"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4339536">.</span><span class="ident" id="4339537">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4339555">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="4339583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4339586">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="4339608">type</span>&nbsp;<span class="ident" id="4339613">nameConstraints</span>&nbsp;<span class="keyword" id="4339629">struct</span>&nbsp;<span class="op" id="4339636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339639">Permitted</span>&nbsp;<span class="op" id="4339649">[</span><span class="op" id="4339650">]</span><span class="ident" id="4339651"><a href="/crypto/x509/x509.go.html#4339750">generalSubtree</a></span>&nbsp;<span class="string" id="4339666">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339691">Excluded</span>&nbsp;&nbsp;<span class="op" id="4339701">[</span><span class="op" id="4339702">]</span><span class="ident" id="4339703"><a href="/crypto/x509/x509.go.html#4339750">generalSubtree</a></span>&nbsp;<span class="string" id="4339718">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4339742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="4339745">type</span>&nbsp;<span class="ident" id="4339750">generalSubtree</span>&nbsp;<span class="keyword" id="4339765">struct</span>&nbsp;<span class="op" id="4339772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339775">Name</span>&nbsp;<span class="builtintype" id="4339780">string</span>&nbsp;<span class="string" id="4339787">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4339815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4339818">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="4339839">type</span>&nbsp;<span class="ident" id="4339844">authorityInfoAccess</span>&nbsp;<span class="keyword" id="4339864">struct</span>&nbsp;<span class="op" id="4339871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339874">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4339883"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4339887">.</span><span class="ident" id="4339888">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339906">Location</span>&nbsp;<span class="ident" id="4339915"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4339919">.</span><span class="ident" id="4339920">RawValue</span><br>
<span class="lineno"></span><span class="op" id="4339929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="4339932">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="4339954">type</span>&nbsp;<span class="ident" id="4339959">distributionPoint</span>&nbsp;<span class="keyword" id="4339977">struct</span>&nbsp;<span class="op" id="4339984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339987">DistributionPoint</span>&nbsp;<span class="ident" id="4340005"><a href="/crypto/x509/x509.go.html#4340189">distributionPointName</a></span>&nbsp;<span class="string" id="4340027">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340052">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340070"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4340074">.</span><span class="ident" id="4340075">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4340092">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340117">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340135"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4340139">.</span><span class="ident" id="4340140">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4340157">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="4340181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4340184">type</span>&nbsp;<span class="ident" id="4340189">distributionPointName</span>&nbsp;<span class="keyword" id="4340211">struct</span>&nbsp;<span class="op" id="4340218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340221">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340234"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4340238">.</span><span class="ident" id="4340239">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4340251">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340276">RelativeName</span>&nbsp;<span class="ident" id="4340289"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4340293">.</span><span class="ident" id="4340294">RDNSequence</span>&nbsp;<span class="string" id="4340306">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="4340330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4340333">func</span>&nbsp;<span class="ident" id="4340338">parsePublicKey</span><span class="op" id="4340352">(</span><span class="ident" id="4340353">algo</span>&nbsp;<span class="ident" id="4340358"><a href="/crypto/x509/x509.go.html#4320594">PublicKeyAlgorithm</a></span><span class="op" id="4340376">,</span>&nbsp;<span class="ident" id="4340378">keyData</span>&nbsp;<span class="op" id="4340386">*</span><span class="ident" id="4340387"><a href="/crypto/x509/x509.go.html#4320121">publicKeyInfo</a></span><span class="op" id="4340400">)</span>&nbsp;<span class="op" id="4340402">(</span><span class="keyword" id="4340403">interface</span><span class="op" id="4340412">{</span><span class="op" id="4340413">}</span><span class="op" id="4340414">,</span>&nbsp;<span class="builtintype" id="4340416">error</span><span class="op" id="4340421">)</span>&nbsp;<span class="op" id="4340423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340426">asn1Data</span>&nbsp;<span class="op" id="4340435">:=</span>&nbsp;<span class="ident" id="4340438"><a href="/crypto/x509/x509.go.html#4340378">keyData</a></span><span class="op" id="4340445">.</span><span class="ident" id="4340446">PublicKey</span><span class="op" id="4340455">.</span><span class="ident" id="4340456">RightAlign</span><span class="op" id="4340466">(</span><span class="op" id="4340467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340470">switch</span>&nbsp;<span class="ident" id="4340477"><a href="/crypto/x509/x509.go.html#4340353">algo</a></span>&nbsp;<span class="op" id="4340482">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340485">case</span>&nbsp;<span class="ident" id="4340490"><a href="/crypto/x509/x509.go.html#4320680">RSA</a></span><span class="op" id="4340493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340497">p</span>&nbsp;<span class="op" id="4340499">:=</span>&nbsp;<span class="builtinfunc" id="4340502">new</span><span class="op" id="4340505">(</span><span class="ident" id="4340506"><a href="/crypto/x509/pkcs1.go.html#4296210">rsaPublicKey</a></span><span class="op" id="4340518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340522">_</span><span class="op" id="4340523">,</span>&nbsp;<span class="ident" id="4340525">err</span>&nbsp;<span class="op" id="4340529">:=</span>&nbsp;<span class="ident" id="4340532"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4340536">.</span><span class="ident" id="4340537">Unmarshal</span><span class="op" id="4340546">(</span><span class="ident" id="4340547"><a href="/crypto/x509/x509.go.html#4340426">asn1Data</a></span><span class="op" id="4340555">,</span>&nbsp;<span class="ident" id="4340557"><a href="/crypto/x509/x509.go.html#4340497">p</a></span><span class="op" id="4340558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340562">if</span>&nbsp;<span class="ident" id="4340565"><a href="/crypto/x509/x509.go.html#4340525">err</a></span>&nbsp;<span class="op" id="4340569">!=</span>&nbsp;<span class="ident" id="4340572">nil</span>&nbsp;<span class="op" id="4340576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340581">return</span>&nbsp;<span class="ident" id="4340588">nil</span><span class="op" id="4340591">,</span>&nbsp;<span class="ident" id="4340593"><a href="/crypto/x509/x509.go.html#4340525">err</a></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340604">if</span>&nbsp;<span class="ident" id="4340607"><a href="/crypto/x509/x509.go.html#4340497">p</a></span><span class="op" id="4340608">.</span><span class="ident" id="4340609">N</span><span class="op" id="4340610">.</span><span class="ident" id="4340611">Sign</span><span class="op" id="4340615">(</span><span class="op" id="4340616">)</span>&nbsp;<span class="op" id="4340618">&lt;=</span>&nbsp;<span class="num" id="4340621">0</span>&nbsp;<span class="op" id="4340623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340628">return</span>&nbsp;<span class="ident" id="4340635">nil</span><span class="op" id="4340638">,</span>&nbsp;<span class="ident" id="4340640"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4340646">.</span><span class="ident" id="4340647">New</span><span class="op" id="4340650">(</span><span class="string" id="4340651">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4340695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340699">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340703">if</span>&nbsp;<span class="ident" id="4340706"><a href="/crypto/x509/x509.go.html#4340497">p</a></span><span class="op" id="4340707">.</span><span class="ident" id="4340708">E</span>&nbsp;<span class="op" id="4340710">&lt;=</span>&nbsp;<span class="num" id="4340713">0</span>&nbsp;<span class="op" id="4340715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340720">return</span>&nbsp;<span class="ident" id="4340727">nil</span><span class="op" id="4340730">,</span>&nbsp;<span class="ident" id="4340732"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4340738">.</span><span class="ident" id="4340739">New</span><span class="op" id="4340742">(</span><span class="string" id="4340743">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4340795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340804">pub</span>&nbsp;<span class="op" id="4340808">:=</span>&nbsp;<span class="op" id="4340811">&amp;</span><span class="ident" id="4340812"><a href="/crypto/x509/x509.go.html#4316595">rsa</a></span><span class="op" id="4340815">.</span><span class="ident" id="4340816">PublicKey</span><span class="op" id="4340825">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340830">E</span><span class="op" id="4340831">:</span>&nbsp;<span class="ident" id="4340833"><a href="/crypto/x509/x509.go.html#4340497">p</a></span><span class="op" id="4340834">.</span><span class="ident" id="4340835">E</span><span class="op" id="4340836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340841">N</span><span class="op" id="4340842">:</span>&nbsp;<span class="ident" id="4340844"><a href="/crypto/x509/x509.go.html#4340497">p</a></span><span class="op" id="4340845">.</span><span class="ident" id="4340846">N</span><span class="op" id="4340847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340855">return</span>&nbsp;<span class="ident" id="4340862"><a href="/crypto/x509/x509.go.html#4340804">pub</a></span><span class="op" id="4340865">,</span>&nbsp;<span class="ident" id="4340867">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340872">case</span>&nbsp;<span class="ident" id="4340877"><a href="/crypto/x509/x509.go.html#4320685">DSA</a></span><span class="op" id="4340880">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340884">var</span>&nbsp;<span class="ident" id="4340888">p</span>&nbsp;<span class="op" id="4340890">*</span><span class="ident" id="4340891"><a href="/crypto/x509/x509.go.html#4316731">big</a></span><span class="op" id="4340894">.</span><span class="ident" id="4340895">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340901">_</span><span class="op" id="4340902">,</span>&nbsp;<span class="ident" id="4340904">err</span>&nbsp;<span class="op" id="4340908">:=</span>&nbsp;<span class="ident" id="4340911"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4340915">.</span><span class="ident" id="4340916">Unmarshal</span><span class="op" id="4340925">(</span><span class="ident" id="4340926"><a href="/crypto/x509/x509.go.html#4340426">asn1Data</a></span><span class="op" id="4340934">,</span>&nbsp;<span class="op" id="4340936">&amp;</span><span class="ident" id="4340937"><a href="/crypto/x509/x509.go.html#4340888">p</a></span><span class="op" id="4340938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340942">if</span>&nbsp;<span class="ident" id="4340945"><a href="/crypto/x509/x509.go.html#4340904">err</a></span>&nbsp;<span class="op" id="4340949">!=</span>&nbsp;<span class="ident" id="4340952">nil</span>&nbsp;<span class="op" id="4340956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4340961">return</span>&nbsp;<span class="ident" id="4340968">nil</span><span class="op" id="4340971">,</span>&nbsp;<span class="ident" id="4340973"><a href="/crypto/x509/x509.go.html#4340904">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340979">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340983">paramsData</span>&nbsp;<span class="op" id="4340994">:=</span>&nbsp;<span class="ident" id="4340997"><a href="/crypto/x509/x509.go.html#4340378">keyData</a></span><span class="op" id="4341004">.</span><span class="ident" id="4341005">Algorithm</span><span class="op" id="4341014">.</span><span class="ident" id="4341015">Parameters</span><span class="op" id="4341025">.</span><span class="ident" id="4341026">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341038">params</span>&nbsp;<span class="op" id="4341045">:=</span>&nbsp;<span class="builtinfunc" id="4341048">new</span><span class="op" id="4341051">(</span><span class="ident" id="4341052"><a href="/crypto/x509/x509.go.html#4319927">dsaAlgorithmParameters</a></span><span class="op" id="4341074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341078">_</span><span class="op" id="4341079">,</span>&nbsp;<span class="ident" id="4341081"><a href="/crypto/x509/x509.go.html#4340904">err</a></span>&nbsp;<span class="op" id="4341085">=</span>&nbsp;<span class="ident" id="4341087"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4341091">.</span><span class="ident" id="4341092">Unmarshal</span><span class="op" id="4341101">(</span><span class="ident" id="4341102"><a href="/crypto/x509/x509.go.html#4340983">paramsData</a></span><span class="op" id="4341112">,</span>&nbsp;<span class="ident" id="4341114"><a href="/crypto/x509/x509.go.html#4341038">params</a></span><span class="op" id="4341120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341124">if</span>&nbsp;<span class="ident" id="4341127"><a href="/crypto/x509/x509.go.html#4340904">err</a></span>&nbsp;<span class="op" id="4341131">!=</span>&nbsp;<span class="ident" id="4341134">nil</span>&nbsp;<span class="op" id="4341138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341143">return</span>&nbsp;<span class="ident" id="4341150">nil</span><span class="op" id="4341153">,</span>&nbsp;<span class="ident" id="4341155"><a href="/crypto/x509/x509.go.html#4340904">err</a></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4341161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341165">if</span>&nbsp;<span class="ident" id="4341168"><a href="/crypto/x509/x509.go.html#4340888">p</a></span><span class="op" id="4341169">.</span><span class="ident" id="4341170">Sign</span><span class="op" id="4341174">(</span><span class="op" id="4341175">)</span>&nbsp;<span class="op" id="4341177">&lt;=</span>&nbsp;<span class="num" id="4341180">0</span>&nbsp;<span class="op" id="4341182">||</span>&nbsp;<span class="ident" id="4341185"><a href="/crypto/x509/x509.go.html#4341038">params</a></span><span class="op" id="4341191">.</span><span class="ident" id="4341192">P</span><span class="op" id="4341193">.</span><span class="ident" id="4341194">Sign</span><span class="op" id="4341198">(</span><span class="op" id="4341199">)</span>&nbsp;<span class="op" id="4341201">&lt;=</span>&nbsp;<span class="num" id="4341204">0</span>&nbsp;<span class="op" id="4341206">||</span>&nbsp;<span class="ident" id="4341209"><a href="/crypto/x509/x509.go.html#4341038">params</a></span><span class="op" id="4341215">.</span><span class="ident" id="4341216">Q</span><span class="op" id="4341217">.</span><span class="ident" id="4341218">Sign</span><span class="op" id="4341222">(</span><span class="op" id="4341223">)</span>&nbsp;<span class="op" id="4341225">&lt;=</span>&nbsp;<span class="num" id="4341228">0</span>&nbsp;<span class="op" id="4341230">||</span>&nbsp;<span class="ident" id="4341233"><a href="/crypto/x509/x509.go.html#4341038">params</a></span><span class="op" id="4341239">.</span><span class="ident" id="4341240">G</span><span class="op" id="4341241">.</span><span class="ident" id="4341242">Sign</span><span class="op" id="4341246">(</span><span class="op" id="4341247">)</span>&nbsp;<span class="op" id="4341249">&lt;=</span>&nbsp;<span class="num" id="4341252">0</span>&nbsp;<span class="op" id="4341254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341259">return</span>&nbsp;<span class="ident" id="4341266">nil</span><span class="op" id="4341269">,</span>&nbsp;<span class="ident" id="4341271"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4341277">.</span><span class="ident" id="4341278">New</span><span class="op" id="4341281">(</span><span class="string" id="4341282">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="4341320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4341324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341328">pub</span>&nbsp;<span class="op" id="4341332">:=</span>&nbsp;<span class="op" id="4341335">&amp;</span><span class="ident" id="4341336"><a href="/crypto/x509/x509.go.html#4316546">dsa</a></span><span class="op" id="4341339">.</span><span class="ident" id="4341340">PublicKey</span><span class="op" id="4341349">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341354">Parameters</span><span class="op" id="4341364">:</span>&nbsp;<span class="ident" id="4341366"><a href="/crypto/x509/x509.go.html#4316546">dsa</a></span><span class="op" id="4341369">.</span><span class="ident" id="4341370">Parameters</span><span class="op" id="4341380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341386">P</span><span class="op" id="4341387">:</span>&nbsp;<span class="ident" id="4341389"><a href="/crypto/x509/x509.go.html#4341038">params</a></span><span class="op" id="4341395">.</span><span class="ident" id="4341396">P</span><span class="op" id="4341397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341403">Q</span><span class="op" id="4341404">:</span>&nbsp;<span class="ident" id="4341406"><a href="/crypto/x509/x509.go.html#4341038">params</a></span><span class="op" id="4341412">.</span><span class="ident" id="4341413">Q</span><span class="op" id="4341414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341420">G</span><span class="op" id="4341421">:</span>&nbsp;<span class="ident" id="4341423"><a href="/crypto/x509/x509.go.html#4341038">params</a></span><span class="op" id="4341429">.</span><span class="ident" id="4341430">G</span><span class="op" id="4341431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4341436">}</span><span class="op" id="4341437">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341442">Y</span><span class="op" id="4341443">:</span>&nbsp;<span class="ident" id="4341445"><a href="/crypto/x509/x509.go.html#4340888">p</a></span><span class="op" id="4341446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4341450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341454">return</span>&nbsp;<span class="ident" id="4341461"><a href="/crypto/x509/x509.go.html#4341328">pub</a></span><span class="op" id="4341464">,</span>&nbsp;<span class="ident" id="4341466">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341471">case</span>&nbsp;<span class="ident" id="4341476"><a href="/crypto/x509/x509.go.html#4320690">ECDSA</a></span><span class="op" id="4341481">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341485">paramsData</span>&nbsp;<span class="op" id="4341496">:=</span>&nbsp;<span class="ident" id="4341499"><a href="/crypto/x509/x509.go.html#4340378">keyData</a></span><span class="op" id="4341506">.</span><span class="ident" id="4341507">Algorithm</span><span class="op" id="4341516">.</span><span class="ident" id="4341517">Parameters</span><span class="op" id="4341527">.</span><span class="ident" id="4341528">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341540">namedCurveOID</span>&nbsp;<span class="op" id="4341554">:=</span>&nbsp;<span class="builtinfunc" id="4341557">new</span><span class="op" id="4341560">(</span><span class="ident" id="4341561"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4341565">.</span><span class="ident" id="4341566">ObjectIdentifier</span><span class="op" id="4341582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341586">_</span><span class="op" id="4341587">,</span>&nbsp;<span class="ident" id="4341589">err</span>&nbsp;<span class="op" id="4341593">:=</span>&nbsp;<span class="ident" id="4341596"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4341600">.</span><span class="ident" id="4341601">Unmarshal</span><span class="op" id="4341610">(</span><span class="ident" id="4341611"><a href="/crypto/x509/x509.go.html#4341485">paramsData</a></span><span class="op" id="4341621">,</span>&nbsp;<span class="ident" id="4341623"><a href="/crypto/x509/x509.go.html#4341540">namedCurveOID</a></span><span class="op" id="4341636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341640">if</span>&nbsp;<span class="ident" id="4341643"><a href="/crypto/x509/x509.go.html#4341589">err</a></span>&nbsp;<span class="op" id="4341647">!=</span>&nbsp;<span class="ident" id="4341650">nil</span>&nbsp;<span class="op" id="4341654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341659">return</span>&nbsp;<span class="ident" id="4341666">nil</span><span class="op" id="4341669">,</span>&nbsp;<span class="ident" id="4341671"><a href="/crypto/x509/x509.go.html#4341589">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4341677">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341681">namedCurve</span>&nbsp;<span class="op" id="4341692">:=</span>&nbsp;<span class="ident" id="4341695"><a href="/crypto/x509/x509.go.html#4326207">namedCurveFromOID</a></span><span class="op" id="4341712">(</span><span class="op" id="4341713">*</span><span class="ident" id="4341714"><a href="/crypto/x509/x509.go.html#4341540">namedCurveOID</a></span><span class="op" id="4341727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341731">if</span>&nbsp;<span class="ident" id="4341734"><a href="/crypto/x509/x509.go.html#4341681">namedCurve</a></span>&nbsp;<span class="op" id="4341745">==</span>&nbsp;<span class="ident" id="4341748">nil</span>&nbsp;<span class="op" id="4341752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341757">return</span>&nbsp;<span class="ident" id="4341764">nil</span><span class="op" id="4341767">,</span>&nbsp;<span class="ident" id="4341769"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4341775">.</span><span class="ident" id="4341776">New</span><span class="op" id="4341779">(</span><span class="string" id="4341780">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4341814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4341818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341822">x</span><span class="op" id="4341823">,</span>&nbsp;<span class="ident" id="4341825">y</span>&nbsp;<span class="op" id="4341827">:=</span>&nbsp;<span class="ident" id="4341830"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4341838">.</span><span class="ident" id="4341839">Unmarshal</span><span class="op" id="4341848">(</span><span class="ident" id="4341849"><a href="/crypto/x509/x509.go.html#4341681">namedCurve</a></span><span class="op" id="4341859">,</span>&nbsp;<span class="ident" id="4341861"><a href="/crypto/x509/x509.go.html#4340426">asn1Data</a></span><span class="op" id="4341869">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341873">if</span>&nbsp;<span class="ident" id="4341876"><a href="/crypto/x509/x509.go.html#4341822">x</a></span>&nbsp;<span class="op" id="4341878">==</span>&nbsp;<span class="ident" id="4341881">nil</span>&nbsp;<span class="op" id="4341885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341890">return</span>&nbsp;<span class="ident" id="4341897">nil</span><span class="op" id="4341900">,</span>&nbsp;<span class="ident" id="4341902"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4341908">.</span><span class="ident" id="4341909">New</span><span class="op" id="4341912">(</span><span class="string" id="4341913">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="4341961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4341965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341969">pub</span>&nbsp;<span class="op" id="4341973">:=</span>&nbsp;<span class="op" id="4341976">&amp;</span><span class="ident" id="4341977"><a href="/crypto/x509/x509.go.html#4316560">ecdsa</a></span><span class="op" id="4341982">.</span><span class="ident" id="4341983">PublicKey</span><span class="op" id="4341992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341997">Curve</span><span class="op" id="4342002">:</span>&nbsp;<span class="ident" id="4342004"><a href="/crypto/x509/x509.go.html#4341681">namedCurve</a></span><span class="op" id="4342014">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4342019">X</span><span class="op" id="4342020">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342026"><a href="/crypto/x509/x509.go.html#4341822">x</a></span><span class="op" id="4342027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4342032">Y</span><span class="op" id="4342033">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342039"><a href="/crypto/x509/x509.go.html#4341825">y</a></span><span class="op" id="4342040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4342044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342048">return</span>&nbsp;<span class="ident" id="4342055"><a href="/crypto/x509/x509.go.html#4341969">pub</a></span><span class="op" id="4342058">,</span>&nbsp;<span class="ident" id="4342060">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342065">default</span><span class="op" id="4342072">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342076">return</span>&nbsp;<span class="ident" id="4342083">nil</span><span class="op" id="4342086">,</span>&nbsp;<span class="ident" id="4342088">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4342093">}</span><br>
<span class="lineno"></span><span class="op" id="4342095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4342098">func</span>&nbsp;<span class="ident" id="4342103">parseSANExtension</span><span class="op" id="4342120">(</span><span class="ident" id="4342121">value</span>&nbsp;<span class="op" id="4342127">[</span><span class="op" id="4342128">]</span><span class="builtintype" id="4342129">byte</span><span class="op" id="4342133">)</span>&nbsp;<span class="op" id="4342135">(</span><span class="ident" id="4342136">dnsNames</span><span class="op" id="4342144">,</span>&nbsp;<span class="ident" id="4342146">emailAddresses</span>&nbsp;<span class="op" id="4342161">[</span><span class="op" id="4342162">]</span><span class="builtintype" id="4342163">string</span><span class="op" id="4342169">,</span>&nbsp;<span class="ident" id="4342171">ipAddresses</span>&nbsp;<span class="op" id="4342183">[</span><span class="op" id="4342184">]</span><span class="ident" id="4342185"><a href="/crypto/x509/x509.go.html#4316743">net</a></span><span class="op" id="4342188">.</span><span class="ident" id="4342189">IP</span><span class="op" id="4342191">,</span>&nbsp;<span class="ident" id="4342193">err</span>&nbsp;<span class="builtintype" id="4342197">error</span><span class="op" id="4342202">)</span>&nbsp;<span class="op" id="4342204">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342207">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342230">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342266">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342270">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342329">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342333">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342362">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342422">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342482">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342542">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342602">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342657">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342720">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342780">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4342843">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342912">var</span>&nbsp;<span class="ident" id="4342916">seq</span>&nbsp;<span class="ident" id="4342920"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4342924">.</span><span class="ident" id="4342925">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342935">if</span>&nbsp;<span class="ident" id="4342938">_</span><span class="op" id="4342939">,</span>&nbsp;<span class="ident" id="4342941"><a href="/crypto/x509/x509.go.html#4342193">err</a></span>&nbsp;<span class="op" id="4342945">=</span>&nbsp;<span class="ident" id="4342947"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4342951">.</span><span class="ident" id="4342952">Unmarshal</span><span class="op" id="4342961">(</span><span class="ident" id="4342962"><a href="/crypto/x509/x509.go.html#4342121">value</a></span><span class="op" id="4342967">,</span>&nbsp;<span class="op" id="4342969">&amp;</span><span class="ident" id="4342970"><a href="/crypto/x509/x509.go.html#4342916">seq</a></span><span class="op" id="4342973">)</span><span class="op" id="4342974">;</span>&nbsp;<span class="ident" id="4342976"><a href="/crypto/x509/x509.go.html#4342193">err</a></span>&nbsp;<span class="op" id="4342980">!=</span>&nbsp;<span class="ident" id="4342983">nil</span>&nbsp;<span class="op" id="4342987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342991">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4342999">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343002">if</span>&nbsp;<span class="op" id="4343005">!</span><span class="ident" id="4343006"><a href="/crypto/x509/x509.go.html#4342916">seq</a></span><span class="op" id="4343009">.</span><span class="ident" id="4343010">IsCompound</span>&nbsp;<span class="op" id="4343021">||</span>&nbsp;<span class="ident" id="4343024"><a href="/crypto/x509/x509.go.html#4342916">seq</a></span><span class="op" id="4343027">.</span><span class="ident" id="4343028">Tag</span>&nbsp;<span class="op" id="4343032">!=</span>&nbsp;<span class="num" id="4343035">16</span>&nbsp;<span class="op" id="4343038">||</span>&nbsp;<span class="ident" id="4343041"><a href="/crypto/x509/x509.go.html#4342916">seq</a></span><span class="op" id="4343044">.</span><span class="ident" id="4343045">Class</span>&nbsp;<span class="op" id="4343051">!=</span>&nbsp;<span class="num" id="4343054">0</span>&nbsp;<span class="op" id="4343056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343060"><a href="/crypto/x509/x509.go.html#4342193">err</a></span>&nbsp;<span class="op" id="4343064">=</span>&nbsp;<span class="ident" id="4343066"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4343070">.</span><span class="ident" id="4343071">StructuralError</span><span class="op" id="4343086">{</span><span class="ident" id="4343087">Msg</span><span class="op" id="4343090">:</span>&nbsp;<span class="string" id="4343092">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="4343110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343114">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4343122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343126">rest</span>&nbsp;<span class="op" id="4343131">:=</span>&nbsp;<span class="ident" id="4343134"><a href="/crypto/x509/x509.go.html#4342916">seq</a></span><span class="op" id="4343137">.</span><span class="ident" id="4343138">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343145">for</span>&nbsp;<span class="builtinfunc" id="4343149">len</span><span class="op" id="4343152">(</span><span class="ident" id="4343153"><a href="/crypto/x509/x509.go.html#4343126">rest</a></span><span class="op" id="4343157">)</span>&nbsp;<span class="op" id="4343159">&gt;</span>&nbsp;<span class="num" id="4343161">0</span>&nbsp;<span class="op" id="4343163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343167">var</span>&nbsp;<span class="ident" id="4343171">v</span>&nbsp;<span class="ident" id="4343173"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4343177">.</span><span class="ident" id="4343178">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343189"><a href="/crypto/x509/x509.go.html#4343126">rest</a></span><span class="op" id="4343193">,</span>&nbsp;<span class="ident" id="4343195"><a href="/crypto/x509/x509.go.html#4342193">err</a></span>&nbsp;<span class="op" id="4343199">=</span>&nbsp;<span class="ident" id="4343201"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4343205">.</span><span class="ident" id="4343206">Unmarshal</span><span class="op" id="4343215">(</span><span class="ident" id="4343216"><a href="/crypto/x509/x509.go.html#4343126">rest</a></span><span class="op" id="4343220">,</span>&nbsp;<span class="op" id="4343222">&amp;</span><span class="ident" id="4343223"><a href="/crypto/x509/x509.go.html#4343171">v</a></span><span class="op" id="4343224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343228">if</span>&nbsp;<span class="ident" id="4343231"><a href="/crypto/x509/x509.go.html#4342193">err</a></span>&nbsp;<span class="op" id="4343235">!=</span>&nbsp;<span class="ident" id="4343238">nil</span>&nbsp;<span class="op" id="4343242">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343247">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4343256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343260">switch</span>&nbsp;<span class="ident" id="4343267"><a href="/crypto/x509/x509.go.html#4343171">v</a></span><span class="op" id="4343268">.</span><span class="ident" id="4343269">Tag</span>&nbsp;<span class="op" id="4343273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343277">case</span>&nbsp;<span class="num" id="4343282">1</span><span class="op" id="4343283">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343288"><a href="/crypto/x509/x509.go.html#4342146">emailAddresses</a></span>&nbsp;<span class="op" id="4343303">=</span>&nbsp;<span class="builtinfunc" id="4343305">append</span><span class="op" id="4343311">(</span><span class="ident" id="4343312"><a href="/crypto/x509/x509.go.html#4342146">emailAddresses</a></span><span class="op" id="4343326">,</span>&nbsp;<span class="builtintype" id="4343328">string</span><span class="op" id="4343334">(</span><span class="ident" id="4343335"><a href="/crypto/x509/x509.go.html#4343171">v</a></span><span class="op" id="4343336">.</span><span class="ident" id="4343337">Bytes</span><span class="op" id="4343342">)</span><span class="op" id="4343343">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343347">case</span>&nbsp;<span class="num" id="4343352">2</span><span class="op" id="4343353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343358"><a href="/crypto/x509/x509.go.html#4342136">dnsNames</a></span>&nbsp;<span class="op" id="4343367">=</span>&nbsp;<span class="builtinfunc" id="4343369">append</span><span class="op" id="4343375">(</span><span class="ident" id="4343376"><a href="/crypto/x509/x509.go.html#4342136">dnsNames</a></span><span class="op" id="4343384">,</span>&nbsp;<span class="builtintype" id="4343386">string</span><span class="op" id="4343392">(</span><span class="ident" id="4343393"><a href="/crypto/x509/x509.go.html#4343171">v</a></span><span class="op" id="4343394">.</span><span class="ident" id="4343395">Bytes</span><span class="op" id="4343400">)</span><span class="op" id="4343401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343405">case</span>&nbsp;<span class="num" id="4343410">7</span><span class="op" id="4343411">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343416">switch</span>&nbsp;<span class="builtinfunc" id="4343423">len</span><span class="op" id="4343426">(</span><span class="ident" id="4343427"><a href="/crypto/x509/x509.go.html#4343171">v</a></span><span class="op" id="4343428">.</span><span class="ident" id="4343429">Bytes</span><span class="op" id="4343434">)</span>&nbsp;<span class="op" id="4343436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343441">case</span>&nbsp;<span class="ident" id="4343446"><a href="/crypto/x509/x509.go.html#4316743">net</a></span><span class="op" id="4343449">.</span><span class="ident" id="4343450">IPv4len</span><span class="op" id="4343457">,</span>&nbsp;<span class="ident" id="4343459"><a href="/crypto/x509/x509.go.html#4316743">net</a></span><span class="op" id="4343462">.</span><span class="ident" id="4343463">IPv6len</span><span class="op" id="4343470">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343476"><a href="/crypto/x509/x509.go.html#4342171">ipAddresses</a></span>&nbsp;<span class="op" id="4343488">=</span>&nbsp;<span class="builtinfunc" id="4343490">append</span><span class="op" id="4343496">(</span><span class="ident" id="4343497"><a href="/crypto/x509/x509.go.html#4342171">ipAddresses</a></span><span class="op" id="4343508">,</span>&nbsp;<span class="ident" id="4343510"><a href="/crypto/x509/x509.go.html#4343171">v</a></span><span class="op" id="4343511">.</span><span class="ident" id="4343512">Bytes</span><span class="op" id="4343517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343522">default</span><span class="op" id="4343529">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343535"><a href="/crypto/x509/x509.go.html#4342193">err</a></span>&nbsp;<span class="op" id="4343539">=</span>&nbsp;<span class="ident" id="4343541"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4343547">.</span><span class="ident" id="4343548">New</span><span class="op" id="4343551">(</span><span class="string" id="4343552">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="4343604">+</span>&nbsp;<span class="ident" id="4343606"><a href="/crypto/x509/x509.go.html#4316750">strconv</a></span><span class="op" id="4343613">.</span><span class="ident" id="4343614">Itoa</span><span class="op" id="4343618">(</span><span class="builtinfunc" id="4343619">len</span><span class="op" id="4343622">(</span><span class="ident" id="4343623"><a href="/crypto/x509/x509.go.html#4343171">v</a></span><span class="op" id="4343624">.</span><span class="ident" id="4343625">Bytes</span><span class="op" id="4343630">)</span><span class="op" id="4343631">)</span><span class="op" id="4343632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343638">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4343648">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4343652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4343655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343659">return</span><br>
<span class="lineno"></span><span class="op" id="4343666">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="4343669">func</span>&nbsp;<span class="ident" id="4343674">parseCertificate</span><span class="op" id="4343690">(</span><span class="ident" id="4343691">in</span>&nbsp;<span class="op" id="4343694">*</span><span class="ident" id="4343695"><a href="/crypto/x509/x509.go.html#4319215">certificate</a></span><span class="op" id="4343706">)</span>&nbsp;<span class="op" id="4343708">(</span><span class="op" id="4343709">*</span><span class="ident" id="4343710"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4343721">,</span>&nbsp;<span class="builtintype" id="4343723">error</span><span class="op" id="4343728">)</span>&nbsp;<span class="op" id="4343730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343733">out</span>&nbsp;<span class="op" id="4343737">:=</span>&nbsp;<span class="builtinfunc" id="4343740">new</span><span class="op" id="4343743">(</span><span class="ident" id="4343744"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4343755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343758"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4343761">.</span><span class="ident" id="4343762">Raw</span>&nbsp;<span class="op" id="4343766">=</span>&nbsp;<span class="ident" id="4343768"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4343770">.</span><span class="ident" id="4343771">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343776"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4343779">.</span><span class="ident" id="4343780">RawTBSCertificate</span>&nbsp;<span class="op" id="4343798">=</span>&nbsp;<span class="ident" id="4343800"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4343802">.</span><span class="ident" id="4343803">TBSCertificate</span><span class="op" id="4343817">.</span><span class="ident" id="4343818">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343823"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4343826">.</span><span class="ident" id="4343827">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4343851">=</span>&nbsp;<span class="ident" id="4343853"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4343855">.</span><span class="ident" id="4343856">TBSCertificate</span><span class="op" id="4343870">.</span><span class="ident" id="4343871">PublicKey</span><span class="op" id="4343880">.</span><span class="ident" id="4343881">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343886"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4343889">.</span><span class="ident" id="4343890">RawSubject</span>&nbsp;<span class="op" id="4343901">=</span>&nbsp;<span class="ident" id="4343903"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4343905">.</span><span class="ident" id="4343906">TBSCertificate</span><span class="op" id="4343920">.</span><span class="ident" id="4343921">Subject</span><span class="op" id="4343928">.</span><span class="ident" id="4343929">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343940"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4343943">.</span><span class="ident" id="4343944">RawIssuer</span>&nbsp;<span class="op" id="4343954">=</span>&nbsp;<span class="ident" id="4343956"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4343958">.</span><span class="ident" id="4343959">TBSCertificate</span><span class="op" id="4343973">.</span><span class="ident" id="4343974">Issuer</span><span class="op" id="4343980">.</span><span class="ident" id="4343981">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343993"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4343996">.</span><span class="ident" id="4343997">Signature</span>&nbsp;<span class="op" id="4344007">=</span>&nbsp;<span class="ident" id="4344009"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4344011">.</span><span class="ident" id="4344012">SignatureValue</span><span class="op" id="4344026">.</span><span class="ident" id="4344027">RightAlign</span><span class="op" id="4344037">(</span><span class="op" id="4344038">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344041"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4344044">.</span><span class="ident" id="4344045">SignatureAlgorithm</span>&nbsp;<span class="op" id="4344064">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344068"><a href="/crypto/x509/x509.go.html#4324214">getSignatureAlgorithmFromOID</a></span><span class="op" id="4344096">(</span><span class="ident" id="4344097"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4344099">.</span><span class="ident" id="4344100">TBSCertificate</span><span class="op" id="4344114">.</span><span class="ident" id="4344115">SignatureAlgorithm</span><span class="op" id="4344133">.</span><span class="ident" id="4344134">Algorithm</span><span class="op" id="4344143">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344147"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4344150">.</span><span class="ident" id="4344151">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4344170">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344174"><a href="/crypto/x509/x509.go.html#4325144">getPublicKeyAlgorithmFromOID</a></span><span class="op" id="4344202">(</span><span class="ident" id="4344203"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4344205">.</span><span class="ident" id="4344206">TBSCertificate</span><span class="op" id="4344220">.</span><span class="ident" id="4344221">PublicKey</span><span class="op" id="4344230">.</span><span class="ident" id="4344231">Algorithm</span><span class="op" id="4344240">.</span><span class="ident" id="4344241">Algorithm</span><span class="op" id="4344250">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344253">var</span>&nbsp;<span class="ident" id="4344257">err</span>&nbsp;<span class="builtintype" id="4344261">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344268"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4344271">.</span><span class="ident" id="4344272">PublicKey</span><span class="op" id="4344281">,</span>&nbsp;<span class="ident" id="4344283"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4344287">=</span>&nbsp;<span class="ident" id="4344289"><a href="/crypto/x509/x509.go.html#4340338">parsePublicKey</a></span><span class="op" id="4344303">(</span><span class="ident" id="4344304"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4344307">.</span><span class="ident" id="4344308">PublicKeyAlgorithm</span><span class="op" id="4344326">,</span>&nbsp;<span class="op" id="4344328">&amp;</span><span class="ident" id="4344329"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4344331">.</span><span class="ident" id="4344332">TBSCertificate</span><span class="op" id="4344346">.</span><span class="ident" id="4344347">PublicKey</span><span class="op" id="4344356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344359">if</span>&nbsp;<span class="ident" id="4344362"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4344366">!=</span>&nbsp;<span class="ident" id="4344369">nil</span>&nbsp;<span class="op" id="4344373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344377">return</span>&nbsp;<span class="ident" id="4344384">nil</span><span class="op" id="4344387">,</span>&nbsp;<span class="ident" id="4344389"><a href="/crypto/x509/x509.go.html#4344257">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4344394">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344398">if</span>&nbsp;<span class="ident" id="4344401"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4344403">.</span><span class="ident" id="4344404">TBSCertificate</span><span class="op" id="4344418">.</span><span class="ident" id="4344419">SerialNumber</span><span class="op" id="4344431">.</span><span class="ident" id="4344432">Sign</span><span class="op" id="4344436">(</span><span class="op" id="4344437">)</span>&nbsp;<span class="op" id="4344439">&lt;</span>&nbsp;<span class="num" id="4344441">0</span>&nbsp;<span class="op" id="4344443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344447">return</span>&nbsp;<span class="ident" id="4344454">nil</span><span class="op" id="4344457">,</span>&nbsp;<span class="ident" id="4344459"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4344465">.</span><span class="ident" id="4344466">New</span><span class="op" id="4344469">(</span><span class="string" id="4344470">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="4344500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4344503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344507"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4344510">.</span><span class="ident" id="4344511">Version</span>&nbsp;<span class="op" id="4344519">=</span>&nbsp;<span class="ident" id="4344521"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4344523">.</span><span class="ident" id="4344524">TBSCertificate</span><span class="op" id="4344538">.</span><span class="ident" id="4344539">Version</span>&nbsp;<span class="op" id="4344547">+</span>&nbsp;<span class="num" id="4344549">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344552"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4344555">.</span><span class="ident" id="4344556">SerialNumber</span>&nbsp;<span class="op" id="4344569">=</span>&nbsp;<span class="ident" id="4344571"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4344573">.</span><span class="ident" id="4344574">TBSCertificate</span><span class="op" id="4344588">.</span><span class="ident" id="4344589">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344604">var</span>&nbsp;<span class="ident" id="4344608">issuer</span><span class="op" id="4344614">,</span>&nbsp;<span class="ident" id="4344616">subject</span>&nbsp;<span class="ident" id="4344624"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4344628">.</span><span class="ident" id="4344629">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344642">if</span>&nbsp;<span class="ident" id="4344645">_</span><span class="op" id="4344646">,</span>&nbsp;<span class="ident" id="4344648">err</span>&nbsp;<span class="op" id="4344652">:=</span>&nbsp;<span class="ident" id="4344655"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4344659">.</span><span class="ident" id="4344660">Unmarshal</span><span class="op" id="4344669">(</span><span class="ident" id="4344670"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4344672">.</span><span class="ident" id="4344673">TBSCertificate</span><span class="op" id="4344687">.</span><span class="ident" id="4344688">Subject</span><span class="op" id="4344695">.</span><span class="ident" id="4344696">FullBytes</span><span class="op" id="4344705">,</span>&nbsp;<span class="op" id="4344707">&amp;</span><span class="ident" id="4344708"><a href="/crypto/x509/x509.go.html#4344616">subject</a></span><span class="op" id="4344715">)</span><span class="op" id="4344716">;</span>&nbsp;<span class="ident" id="4344718"><a href="/crypto/x509/x509.go.html#4344648">err</a></span>&nbsp;<span class="op" id="4344722">!=</span>&nbsp;<span class="ident" id="4344725">nil</span>&nbsp;<span class="op" id="4344729">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344733">return</span>&nbsp;<span class="ident" id="4344740">nil</span><span class="op" id="4344743">,</span>&nbsp;<span class="ident" id="4344745"><a href="/crypto/x509/x509.go.html#4344648">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4344750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344753">if</span>&nbsp;<span class="ident" id="4344756">_</span><span class="op" id="4344757">,</span>&nbsp;<span class="ident" id="4344759">err</span>&nbsp;<span class="op" id="4344763">:=</span>&nbsp;<span class="ident" id="4344766"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4344770">.</span><span class="ident" id="4344771">Unmarshal</span><span class="op" id="4344780">(</span><span class="ident" id="4344781"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4344783">.</span><span class="ident" id="4344784">TBSCertificate</span><span class="op" id="4344798">.</span><span class="ident" id="4344799">Issuer</span><span class="op" id="4344805">.</span><span class="ident" id="4344806">FullBytes</span><span class="op" id="4344815">,</span>&nbsp;<span class="op" id="4344817">&amp;</span><span class="ident" id="4344818"><a href="/crypto/x509/x509.go.html#4344608">issuer</a></span><span class="op" id="4344824">)</span><span class="op" id="4344825">;</span>&nbsp;<span class="ident" id="4344827"><a href="/crypto/x509/x509.go.html#4344759">err</a></span>&nbsp;<span class="op" id="4344831">!=</span>&nbsp;<span class="ident" id="4344834">nil</span>&nbsp;<span class="op" id="4344838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344842">return</span>&nbsp;<span class="ident" id="4344849">nil</span><span class="op" id="4344852">,</span>&nbsp;<span class="ident" id="4344854"><a href="/crypto/x509/x509.go.html#4344759">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4344859">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344863"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4344866">.</span><span class="ident" id="4344867">Issuer</span><span class="op" id="4344873">.</span><span class="ident" id="4344874">FillFromRDNSequence</span><span class="op" id="4344893">(</span><span class="op" id="4344894">&amp;</span><span class="ident" id="4344895"><a href="/crypto/x509/x509.go.html#4344608">issuer</a></span><span class="op" id="4344901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344904"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4344907">.</span><span class="ident" id="4344908">Subject</span><span class="op" id="4344915">.</span><span class="ident" id="4344916">FillFromRDNSequence</span><span class="op" id="4344935">(</span><span class="op" id="4344936">&amp;</span><span class="ident" id="4344937"><a href="/crypto/x509/x509.go.html#4344616">subject</a></span><span class="op" id="4344944">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344948"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4344951">.</span><span class="ident" id="4344952">NotBefore</span>&nbsp;<span class="op" id="4344962">=</span>&nbsp;<span class="ident" id="4344964"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4344966">.</span><span class="ident" id="4344967">TBSCertificate</span><span class="op" id="4344981">.</span><span class="ident" id="4344982">Validity</span><span class="op" id="4344990">.</span><span class="ident" id="4344991">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345002"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4345005">.</span><span class="ident" id="4345006">NotAfter</span>&nbsp;<span class="op" id="4345015">=</span>&nbsp;<span class="ident" id="4345017"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4345019">.</span><span class="ident" id="4345020">TBSCertificate</span><span class="op" id="4345034">.</span><span class="ident" id="4345035">Validity</span><span class="op" id="4345043">.</span><span class="ident" id="4345044">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345055">for</span>&nbsp;<span class="ident" id="4345059">_</span><span class="op" id="4345060">,</span>&nbsp;<span class="ident" id="4345062">e</span>&nbsp;<span class="op" id="4345064">:=</span>&nbsp;<span class="keyword" id="4345067">range</span>&nbsp;<span class="ident" id="4345073"><a href="/crypto/x509/x509.go.html#4343691">in</a></span><span class="op" id="4345075">.</span><span class="ident" id="4345076">TBSCertificate</span><span class="op" id="4345090">.</span><span class="ident" id="4345091">Extensions</span>&nbsp;<span class="op" id="4345102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345106"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4345109">.</span><span class="ident" id="4345110">Extensions</span>&nbsp;<span class="op" id="4345121">=</span>&nbsp;<span class="builtinfunc" id="4345123">append</span><span class="op" id="4345129">(</span><span class="ident" id="4345130"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4345133">.</span><span class="ident" id="4345134">Extensions</span><span class="op" id="4345144">,</span>&nbsp;<span class="ident" id="4345146"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4345147">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345152">if</span>&nbsp;<span class="builtinfunc" id="4345155">len</span><span class="op" id="4345158">(</span><span class="ident" id="4345159"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4345160">.</span><span class="ident" id="4345161">Id</span><span class="op" id="4345163">)</span>&nbsp;<span class="op" id="4345165">==</span>&nbsp;<span class="num" id="4345168">4</span>&nbsp;<span class="op" id="4345170">&amp;&amp;</span>&nbsp;<span class="ident" id="4345173"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4345174">.</span><span class="ident" id="4345175">Id</span><span class="op" id="4345177">[</span><span class="num" id="4345178">0</span><span class="op" id="4345179">]</span>&nbsp;<span class="op" id="4345181">==</span>&nbsp;<span class="num" id="4345184">2</span>&nbsp;<span class="op" id="4345186">&amp;&amp;</span>&nbsp;<span class="ident" id="4345189"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4345190">.</span><span class="ident" id="4345191">Id</span><span class="op" id="4345193">[</span><span class="num" id="4345194">1</span><span class="op" id="4345195">]</span>&nbsp;<span class="op" id="4345197">==</span>&nbsp;<span class="num" id="4345200">5</span>&nbsp;<span class="op" id="4345202">&amp;&amp;</span>&nbsp;<span class="ident" id="4345205"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4345206">.</span><span class="ident" id="4345207">Id</span><span class="op" id="4345209">[</span><span class="num" id="4345210">2</span><span class="op" id="4345211">]</span>&nbsp;<span class="op" id="4345213">==</span>&nbsp;<span class="num" id="4345216">29</span>&nbsp;<span class="op" id="4345219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345224">switch</span>&nbsp;<span class="ident" id="4345231"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4345232">.</span><span class="ident" id="4345233">Id</span><span class="op" id="4345235">[</span><span class="num" id="4345236">3</span><span class="op" id="4345237">]</span>&nbsp;<span class="op" id="4345239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345244">case</span>&nbsp;<span class="num" id="4345249">15</span><span class="op" id="4345251">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4345257">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345282">var</span>&nbsp;<span class="ident" id="4345286">usageBits</span>&nbsp;<span class="ident" id="4345296"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4345300">.</span><span class="ident" id="4345301">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345315">_</span><span class="op" id="4345316">,</span>&nbsp;<span class="ident" id="4345318">err</span>&nbsp;<span class="op" id="4345322">:=</span>&nbsp;<span class="ident" id="4345325"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4345329">.</span><span class="ident" id="4345330">Unmarshal</span><span class="op" id="4345339">(</span><span class="ident" id="4345340"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4345341">.</span><span class="ident" id="4345342">Value</span><span class="op" id="4345347">,</span>&nbsp;<span class="op" id="4345349">&amp;</span><span class="ident" id="4345350"><a href="/crypto/x509/x509.go.html#4345286">usageBits</a></span><span class="op" id="4345359">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345366">if</span>&nbsp;<span class="ident" id="4345369"><a href="/crypto/x509/x509.go.html#4345318">err</a></span>&nbsp;<span class="op" id="4345373">==</span>&nbsp;<span class="ident" id="4345376">nil</span>&nbsp;<span class="op" id="4345380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345387">var</span>&nbsp;<span class="ident" id="4345391">usage</span>&nbsp;<span class="builtintype" id="4345397">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345406">for</span>&nbsp;<span class="ident" id="4345410">i</span>&nbsp;<span class="op" id="4345412">:=</span>&nbsp;<span class="num" id="4345415">0</span><span class="op" id="4345416">;</span>&nbsp;<span class="ident" id="4345418"><a href="/crypto/x509/x509.go.html#4345410">i</a></span>&nbsp;<span class="op" id="4345420">&lt;</span>&nbsp;<span class="num" id="4345422">9</span><span class="op" id="4345423">;</span>&nbsp;<span class="ident" id="4345425"><a href="/crypto/x509/x509.go.html#4345410">i</a></span><span class="op" id="4345426">++</span>&nbsp;<span class="op" id="4345429">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345437">if</span>&nbsp;<span class="ident" id="4345440"><a href="/crypto/x509/x509.go.html#4345286">usageBits</a></span><span class="op" id="4345449">.</span><span class="ident" id="4345450">At</span><span class="op" id="4345452">(</span><span class="ident" id="4345453"><a href="/crypto/x509/x509.go.html#4345410">i</a></span><span class="op" id="4345454">)</span>&nbsp;<span class="op" id="4345456">!=</span>&nbsp;<span class="num" id="4345459">0</span>&nbsp;<span class="op" id="4345461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345470"><a href="/crypto/x509/x509.go.html#4345391">usage</a></span>&nbsp;<span class="op" id="4345476">|=</span>&nbsp;<span class="num" id="4345479">1</span>&nbsp;<span class="op" id="4345481">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4345484">uint</span><span class="op" id="4345488">(</span><span class="ident" id="4345489"><a href="/crypto/x509/x509.go.html#4345410">i</a></span><span class="op" id="4345490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4345498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4345505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345512"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4345515">.</span><span class="ident" id="4345516">KeyUsage</span>&nbsp;<span class="op" id="4345525">=</span>&nbsp;<span class="ident" id="4345527"><a href="/crypto/x509/x509.go.html#4327008">KeyUsage</a></span><span class="op" id="4345535">(</span><span class="ident" id="4345536"><a href="/crypto/x509/x509.go.html#4345391">usage</a></span><span class="op" id="4345541">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345548">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4345561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345566">case</span>&nbsp;<span class="num" id="4345571">19</span><span class="op" id="4345573">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4345579">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345604">var</span>&nbsp;<span class="ident" id="4345608">constraints</span>&nbsp;<span class="ident" id="4345620"><a href="/crypto/x509/x509.go.html#4339362">basicConstraints</a></span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345641">_</span><span class="op" id="4345642">,</span>&nbsp;<span class="ident" id="4345644">err</span>&nbsp;<span class="op" id="4345648">:=</span>&nbsp;<span class="ident" id="4345651"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4345655">.</span><span class="ident" id="4345656">Unmarshal</span><span class="op" id="4345665">(</span><span class="ident" id="4345666"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4345667">.</span><span class="ident" id="4345668">Value</span><span class="op" id="4345673">,</span>&nbsp;<span class="op" id="4345675">&amp;</span><span class="ident" id="4345676"><a href="/crypto/x509/x509.go.html#4345608">constraints</a></span><span class="op" id="4345687">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345694">if</span>&nbsp;<span class="ident" id="4345697"><a href="/crypto/x509/x509.go.html#4345644">err</a></span>&nbsp;<span class="op" id="4345701">==</span>&nbsp;<span class="ident" id="4345704">nil</span>&nbsp;<span class="op" id="4345708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345715"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4345718">.</span><span class="ident" id="4345719">BasicConstraintsValid</span>&nbsp;<span class="op" id="4345741">=</span>&nbsp;<span class="ident" id="4345743">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345753"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4345756">.</span><span class="ident" id="4345757">IsCA</span>&nbsp;<span class="op" id="4345762">=</span>&nbsp;<span class="ident" id="4345764"><a href="/crypto/x509/x509.go.html#4345608">constraints</a></span><span class="op" id="4345775">.</span><span class="ident" id="4345776">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345786"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4345789">.</span><span class="ident" id="4345790">MaxPathLen</span>&nbsp;<span class="op" id="4345801">=</span>&nbsp;<span class="ident" id="4345803"><a href="/crypto/x509/x509.go.html#4345608">constraints</a></span><span class="op" id="4345814">.</span><span class="ident" id="4345815">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345831"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4345834">.</span><span class="ident" id="4345835">MaxPathLenZero</span>&nbsp;<span class="op" id="4345850">=</span>&nbsp;<span class="ident" id="4345852"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4345855">.</span><span class="ident" id="4345856">MaxPathLen</span>&nbsp;<span class="op" id="4345867">==</span>&nbsp;<span class="num" id="4345870">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345877">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4345890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345895">case</span>&nbsp;<span class="num" id="4345900">17</span><span class="op" id="4345902">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345908"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4345911">.</span><span class="ident" id="4345912">DNSNames</span><span class="op" id="4345920">,</span>&nbsp;<span class="ident" id="4345922"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4345925">.</span><span class="ident" id="4345926">EmailAddresses</span><span class="op" id="4345940">,</span>&nbsp;<span class="ident" id="4345942"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4345945">.</span><span class="ident" id="4345946">IPAddresses</span><span class="op" id="4345957">,</span>&nbsp;<span class="ident" id="4345959"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4345963">=</span>&nbsp;<span class="ident" id="4345965"><a href="/crypto/x509/x509.go.html#4342103">parseSANExtension</a></span><span class="op" id="4345982">(</span><span class="ident" id="4345983"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4345984">.</span><span class="ident" id="4345985">Value</span><span class="op" id="4345990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345996">if</span>&nbsp;<span class="ident" id="4345999"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4346003">!=</span>&nbsp;<span class="ident" id="4346006">nil</span>&nbsp;<span class="op" id="4346010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4346017">return</span>&nbsp;<span class="ident" id="4346024">nil</span><span class="op" id="4346027">,</span>&nbsp;<span class="ident" id="4346029"><a href="/crypto/x509/x509.go.html#4344257">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4346037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4346044">if</span>&nbsp;<span class="builtinfunc" id="4346047">len</span><span class="op" id="4346050">(</span><span class="ident" id="4346051"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4346054">.</span><span class="ident" id="4346055">DNSNames</span><span class="op" id="4346063">)</span>&nbsp;<span class="op" id="4346065">&gt;</span>&nbsp;<span class="num" id="4346067">0</span>&nbsp;<span class="op" id="4346069">||</span>&nbsp;<span class="builtinfunc" id="4346072">len</span><span class="op" id="4346075">(</span><span class="ident" id="4346076"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4346079">.</span><span class="ident" id="4346080">EmailAddresses</span><span class="op" id="4346094">)</span>&nbsp;<span class="op" id="4346096">&gt;</span>&nbsp;<span class="num" id="4346098">0</span>&nbsp;<span class="op" id="4346100">||</span>&nbsp;<span class="builtinfunc" id="4346103">len</span><span class="op" id="4346106">(</span><span class="ident" id="4346107"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4346110">.</span><span class="ident" id="4346111">IPAddresses</span><span class="op" id="4346122">)</span>&nbsp;<span class="op" id="4346124">&gt;</span>&nbsp;<span class="num" id="4346126">0</span>&nbsp;<span class="op" id="4346128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4346135">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4346148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346154">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346205">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4346254">case</span>&nbsp;<span class="num" id="4346259">30</span><span class="op" id="4346261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346267">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346294">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346332">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346402">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346473">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346480">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346548">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346555">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346592">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346641">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346701">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346761">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346768">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4346810">var</span>&nbsp;<span class="ident" id="4346814">constraints</span>&nbsp;<span class="ident" id="4346826"><a href="/crypto/x509/x509.go.html#4339613">nameConstraints</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346846">_</span><span class="op" id="4346847">,</span>&nbsp;<span class="ident" id="4346849">err</span>&nbsp;<span class="op" id="4346853">:=</span>&nbsp;<span class="ident" id="4346856"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4346860">.</span><span class="ident" id="4346861">Unmarshal</span><span class="op" id="4346870">(</span><span class="ident" id="4346871"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4346872">.</span><span class="ident" id="4346873">Value</span><span class="op" id="4346878">,</span>&nbsp;<span class="op" id="4346880">&amp;</span><span class="ident" id="4346881"><a href="/crypto/x509/x509.go.html#4346814">constraints</a></span><span class="op" id="4346892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4346898">if</span>&nbsp;<span class="ident" id="4346901"><a href="/crypto/x509/x509.go.html#4346849">err</a></span>&nbsp;<span class="op" id="4346905">!=</span>&nbsp;<span class="ident" id="4346908">nil</span>&nbsp;<span class="op" id="4346912">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4346919">return</span>&nbsp;<span class="ident" id="4346926">nil</span><span class="op" id="4346929">,</span>&nbsp;<span class="ident" id="4346931"><a href="/crypto/x509/x509.go.html#4346849">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4346939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4346946">if</span>&nbsp;<span class="builtinfunc" id="4346949">len</span><span class="op" id="4346952">(</span><span class="ident" id="4346953"><a href="/crypto/x509/x509.go.html#4346814">constraints</a></span><span class="op" id="4346964">.</span><span class="ident" id="4346965">Excluded</span><span class="op" id="4346973">)</span>&nbsp;<span class="op" id="4346975">&gt;</span>&nbsp;<span class="num" id="4346977">0</span>&nbsp;<span class="op" id="4346979">&amp;&amp;</span>&nbsp;<span class="ident" id="4346982"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4346983">.</span><span class="ident" id="4346984">Critical</span>&nbsp;<span class="op" id="4346993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347000">return</span>&nbsp;<span class="ident" id="4347007"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4347010">,</span>&nbsp;<span class="ident" id="4347012"><a href="/crypto/x509/x509.go.html#4339219">UnhandledCriticalExtension</a></span><span class="op" id="4347038">{</span><span class="op" id="4347039">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347052">for</span>&nbsp;<span class="ident" id="4347056">_</span><span class="op" id="4347057">,</span>&nbsp;<span class="ident" id="4347059">subtree</span>&nbsp;<span class="op" id="4347067">:=</span>&nbsp;<span class="keyword" id="4347070">range</span>&nbsp;<span class="ident" id="4347076"><a href="/crypto/x509/x509.go.html#4346814">constraints</a></span><span class="op" id="4347087">.</span><span class="ident" id="4347088">Permitted</span>&nbsp;<span class="op" id="4347098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347105">if</span>&nbsp;<span class="builtinfunc" id="4347108">len</span><span class="op" id="4347111">(</span><span class="ident" id="4347112"><a href="/crypto/x509/x509.go.html#4347059">subtree</a></span><span class="op" id="4347119">.</span><span class="ident" id="4347120">Name</span><span class="op" id="4347124">)</span>&nbsp;<span class="op" id="4347126">==</span>&nbsp;<span class="num" id="4347129">0</span>&nbsp;<span class="op" id="4347131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347139">if</span>&nbsp;<span class="ident" id="4347142"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4347143">.</span><span class="ident" id="4347144">Critical</span>&nbsp;<span class="op" id="4347153">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347162">return</span>&nbsp;<span class="ident" id="4347169"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4347172">,</span>&nbsp;<span class="ident" id="4347174"><a href="/crypto/x509/x509.go.html#4339219">UnhandledCriticalExtension</a></span><span class="op" id="4347200">{</span><span class="op" id="4347201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347217">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347238"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4347241">.</span><span class="ident" id="4347242">PermittedDNSDomains</span>&nbsp;<span class="op" id="4347262">=</span>&nbsp;<span class="builtinfunc" id="4347264">append</span><span class="op" id="4347270">(</span><span class="ident" id="4347271"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4347274">.</span><span class="ident" id="4347275">PermittedDNSDomains</span><span class="op" id="4347294">,</span>&nbsp;<span class="ident" id="4347296"><a href="/crypto/x509/x509.go.html#4347059">subtree</a></span><span class="op" id="4347303">.</span><span class="ident" id="4347304">Name</span><span class="op" id="4347308">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347320">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347333">case</span>&nbsp;<span class="num" id="4347338">31</span><span class="op" id="4347340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347346">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347373">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347450">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347457">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347497">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347572">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347637">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347704">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347711">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347753">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347810">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347882">var</span>&nbsp;<span class="ident" id="4347886">cdp</span>&nbsp;<span class="op" id="4347890">[</span><span class="op" id="4347891">]</span><span class="ident" id="4347892"><a href="/crypto/x509/x509.go.html#4339959">distributionPoint</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347914">_</span><span class="op" id="4347915">,</span>&nbsp;<span class="ident" id="4347917">err</span>&nbsp;<span class="op" id="4347921">:=</span>&nbsp;<span class="ident" id="4347924"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4347928">.</span><span class="ident" id="4347929">Unmarshal</span><span class="op" id="4347938">(</span><span class="ident" id="4347939"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4347940">.</span><span class="ident" id="4347941">Value</span><span class="op" id="4347946">,</span>&nbsp;<span class="op" id="4347948">&amp;</span><span class="ident" id="4347949"><a href="/crypto/x509/x509.go.html#4347886">cdp</a></span><span class="op" id="4347952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347958">if</span>&nbsp;<span class="ident" id="4347961"><a href="/crypto/x509/x509.go.html#4347917">err</a></span>&nbsp;<span class="op" id="4347965">!=</span>&nbsp;<span class="ident" id="4347968">nil</span>&nbsp;<span class="op" id="4347972">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347979">return</span>&nbsp;<span class="ident" id="4347986">nil</span><span class="op" id="4347989">,</span>&nbsp;<span class="ident" id="4347991"><a href="/crypto/x509/x509.go.html#4347917">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348006">for</span>&nbsp;<span class="ident" id="4348010">_</span><span class="op" id="4348011">,</span>&nbsp;<span class="ident" id="4348013">dp</span>&nbsp;<span class="op" id="4348016">:=</span>&nbsp;<span class="keyword" id="4348019">range</span>&nbsp;<span class="ident" id="4348025"><a href="/crypto/x509/x509.go.html#4347886">cdp</a></span>&nbsp;<span class="op" id="4348029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348036">var</span>&nbsp;<span class="ident" id="4348040">n</span>&nbsp;<span class="ident" id="4348042"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4348046">.</span><span class="ident" id="4348047">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348061">_</span><span class="op" id="4348062">,</span>&nbsp;<span class="ident" id="4348064"><a href="/crypto/x509/x509.go.html#4347917">err</a></span>&nbsp;<span class="op" id="4348068">=</span>&nbsp;<span class="ident" id="4348070"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4348074">.</span><span class="ident" id="4348075">Unmarshal</span><span class="op" id="4348084">(</span><span class="ident" id="4348085"><a href="/crypto/x509/x509.go.html#4348013">dp</a></span><span class="op" id="4348087">.</span><span class="ident" id="4348088">DistributionPoint</span><span class="op" id="4348105">.</span><span class="ident" id="4348106">FullName</span><span class="op" id="4348114">.</span><span class="ident" id="4348115">Bytes</span><span class="op" id="4348120">,</span>&nbsp;<span class="op" id="4348122">&amp;</span><span class="ident" id="4348123"><a href="/crypto/x509/x509.go.html#4348040">n</a></span><span class="op" id="4348124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348131">if</span>&nbsp;<span class="ident" id="4348134"><a href="/crypto/x509/x509.go.html#4347917">err</a></span>&nbsp;<span class="op" id="4348138">!=</span>&nbsp;<span class="ident" id="4348141">nil</span>&nbsp;<span class="op" id="4348145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348153">return</span>&nbsp;<span class="ident" id="4348160">nil</span><span class="op" id="4348163">,</span>&nbsp;<span class="ident" id="4348165"><a href="/crypto/x509/x509.go.html#4347917">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4348174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348182">if</span>&nbsp;<span class="ident" id="4348185"><a href="/crypto/x509/x509.go.html#4348040">n</a></span><span class="op" id="4348186">.</span><span class="ident" id="4348187">Tag</span>&nbsp;<span class="op" id="4348191">==</span>&nbsp;<span class="num" id="4348194">6</span>&nbsp;<span class="op" id="4348196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348204"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4348207">.</span><span class="ident" id="4348208">CRLDistributionPoints</span>&nbsp;<span class="op" id="4348230">=</span>&nbsp;<span class="builtinfunc" id="4348232">append</span><span class="op" id="4348238">(</span><span class="ident" id="4348239"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4348242">.</span><span class="ident" id="4348243">CRLDistributionPoints</span><span class="op" id="4348264">,</span>&nbsp;<span class="builtintype" id="4348266">string</span><span class="op" id="4348272">(</span><span class="ident" id="4348273"><a href="/crypto/x509/x509.go.html#4348040">n</a></span><span class="op" id="4348274">.</span><span class="ident" id="4348275">Bytes</span><span class="op" id="4348280">)</span><span class="op" id="4348281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4348288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4348294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348300">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348313">case</span>&nbsp;<span class="num" id="4348318">35</span><span class="op" id="4348320">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348326">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348351">var</span>&nbsp;<span class="ident" id="4348355">a</span>&nbsp;<span class="ident" id="4348357"><a href="/crypto/x509/x509.go.html#4320263">authKeyId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348371">_</span><span class="op" id="4348372">,</span>&nbsp;<span class="ident" id="4348374"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4348378">=</span>&nbsp;<span class="ident" id="4348380"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4348384">.</span><span class="ident" id="4348385">Unmarshal</span><span class="op" id="4348394">(</span><span class="ident" id="4348395"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4348396">.</span><span class="ident" id="4348397">Value</span><span class="op" id="4348402">,</span>&nbsp;<span class="op" id="4348404">&amp;</span><span class="ident" id="4348405"><a href="/crypto/x509/x509.go.html#4348355">a</a></span><span class="op" id="4348406">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348412">if</span>&nbsp;<span class="ident" id="4348415"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4348419">!=</span>&nbsp;<span class="ident" id="4348422">nil</span>&nbsp;<span class="op" id="4348426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348433">return</span>&nbsp;<span class="ident" id="4348440">nil</span><span class="op" id="4348443">,</span>&nbsp;<span class="ident" id="4348445"><a href="/crypto/x509/x509.go.html#4344257">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4348453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348459"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4348462">.</span><span class="ident" id="4348463">AuthorityKeyId</span>&nbsp;<span class="op" id="4348478">=</span>&nbsp;<span class="ident" id="4348480"><a href="/crypto/x509/x509.go.html#4348355">a</a></span><span class="op" id="4348481">.</span><span class="ident" id="4348482">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348489">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348502">case</span>&nbsp;<span class="num" id="4348507">37</span><span class="op" id="4348509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348515">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348563">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348623">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348630">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348698">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348705">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348748">var</span>&nbsp;<span class="ident" id="4348752">keyUsage</span>&nbsp;<span class="op" id="4348761">[</span><span class="op" id="4348762">]</span><span class="ident" id="4348763"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4348767">.</span><span class="ident" id="4348768">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348789">_</span><span class="op" id="4348790">,</span>&nbsp;<span class="ident" id="4348792"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4348796">=</span>&nbsp;<span class="ident" id="4348798"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4348802">.</span><span class="ident" id="4348803">Unmarshal</span><span class="op" id="4348812">(</span><span class="ident" id="4348813"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4348814">.</span><span class="ident" id="4348815">Value</span><span class="op" id="4348820">,</span>&nbsp;<span class="op" id="4348822">&amp;</span><span class="ident" id="4348823"><a href="/crypto/x509/x509.go.html#4348752">keyUsage</a></span><span class="op" id="4348831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348837">if</span>&nbsp;<span class="ident" id="4348840"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4348844">!=</span>&nbsp;<span class="ident" id="4348847">nil</span>&nbsp;<span class="op" id="4348851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348858">return</span>&nbsp;<span class="ident" id="4348865">nil</span><span class="op" id="4348868">,</span>&nbsp;<span class="ident" id="4348870"><a href="/crypto/x509/x509.go.html#4344257">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4348878">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348885">for</span>&nbsp;<span class="ident" id="4348889">_</span><span class="op" id="4348890">,</span>&nbsp;<span class="ident" id="4348892">u</span>&nbsp;<span class="op" id="4348894">:=</span>&nbsp;<span class="keyword" id="4348897">range</span>&nbsp;<span class="ident" id="4348903"><a href="/crypto/x509/x509.go.html#4348752">keyUsage</a></span>&nbsp;<span class="op" id="4348912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348919">if</span>&nbsp;<span class="ident" id="4348922">extKeyUsage</span><span class="op" id="4348933">,</span>&nbsp;<span class="ident" id="4348935">ok</span>&nbsp;<span class="op" id="4348938">:=</span>&nbsp;<span class="ident" id="4348941"><a href="/crypto/x509/x509.go.html#4330333">extKeyUsageFromOID</a></span><span class="op" id="4348959">(</span><span class="ident" id="4348960"><a href="/crypto/x509/x509.go.html#4348892">u</a></span><span class="op" id="4348961">)</span><span class="op" id="4348962">;</span>&nbsp;<span class="ident" id="4348964"><a href="/crypto/x509/x509.go.html#4348935">ok</a></span>&nbsp;<span class="op" id="4348967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348975"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4348978">.</span><span class="ident" id="4348979">ExtKeyUsage</span>&nbsp;<span class="op" id="4348991">=</span>&nbsp;<span class="builtinfunc" id="4348993">append</span><span class="op" id="4348999">(</span><span class="ident" id="4349000"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4349003">.</span><span class="ident" id="4349004">ExtKeyUsage</span><span class="op" id="4349015">,</span>&nbsp;<span class="ident" id="4349017"><a href="/crypto/x509/x509.go.html#4348922">extKeyUsage</a></span><span class="op" id="4349028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349035">}</span>&nbsp;<span class="keyword" id="4349037">else</span>&nbsp;<span class="op" id="4349042">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349050"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4349053">.</span><span class="ident" id="4349054">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4349073">=</span>&nbsp;<span class="builtinfunc" id="4349075">append</span><span class="op" id="4349081">(</span><span class="ident" id="4349082"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4349085">.</span><span class="ident" id="4349086">UnknownExtKeyUsage</span><span class="op" id="4349104">,</span>&nbsp;<span class="ident" id="4349106"><a href="/crypto/x509/x509.go.html#4348892">u</a></span><span class="op" id="4349107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349127">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349140">case</span>&nbsp;<span class="num" id="4349145">14</span><span class="op" id="4349147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349153">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349178">var</span>&nbsp;<span class="ident" id="4349182">keyid</span>&nbsp;<span class="op" id="4349188">[</span><span class="op" id="4349189">]</span><span class="builtintype" id="4349190">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349199">_</span><span class="op" id="4349200">,</span>&nbsp;<span class="ident" id="4349202"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4349206">=</span>&nbsp;<span class="ident" id="4349208"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4349212">.</span><span class="ident" id="4349213">Unmarshal</span><span class="op" id="4349222">(</span><span class="ident" id="4349223"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4349224">.</span><span class="ident" id="4349225">Value</span><span class="op" id="4349230">,</span>&nbsp;<span class="op" id="4349232">&amp;</span><span class="ident" id="4349233"><a href="/crypto/x509/x509.go.html#4349182">keyid</a></span><span class="op" id="4349238">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349244">if</span>&nbsp;<span class="ident" id="4349247"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4349251">!=</span>&nbsp;<span class="ident" id="4349254">nil</span>&nbsp;<span class="op" id="4349258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349265">return</span>&nbsp;<span class="ident" id="4349272">nil</span><span class="op" id="4349275">,</span>&nbsp;<span class="ident" id="4349277"><a href="/crypto/x509/x509.go.html#4344257">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349291"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4349294">.</span><span class="ident" id="4349295">SubjectKeyId</span>&nbsp;<span class="op" id="4349308">=</span>&nbsp;<span class="ident" id="4349310"><a href="/crypto/x509/x509.go.html#4349182">keyid</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349320">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349333">case</span>&nbsp;<span class="num" id="4349338">32</span><span class="op" id="4349340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349346">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349392">var</span>&nbsp;<span class="ident" id="4349396">policies</span>&nbsp;<span class="op" id="4349405">[</span><span class="op" id="4349406">]</span><span class="ident" id="4349407"><a href="/crypto/x509/x509.go.html#4339497">policyInformation</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349429">if</span>&nbsp;<span class="ident" id="4349432">_</span><span class="op" id="4349433">,</span>&nbsp;<span class="ident" id="4349435"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4349439">=</span>&nbsp;<span class="ident" id="4349441"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4349445">.</span><span class="ident" id="4349446">Unmarshal</span><span class="op" id="4349455">(</span><span class="ident" id="4349456"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4349457">.</span><span class="ident" id="4349458">Value</span><span class="op" id="4349463">,</span>&nbsp;<span class="op" id="4349465">&amp;</span><span class="ident" id="4349466"><a href="/crypto/x509/x509.go.html#4349396">policies</a></span><span class="op" id="4349474">)</span><span class="op" id="4349475">;</span>&nbsp;<span class="ident" id="4349477"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4349481">!=</span>&nbsp;<span class="ident" id="4349484">nil</span>&nbsp;<span class="op" id="4349488">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349495">return</span>&nbsp;<span class="ident" id="4349502">nil</span><span class="op" id="4349505">,</span>&nbsp;<span class="ident" id="4349507"><a href="/crypto/x509/x509.go.html#4344257">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349521"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4349524">.</span><span class="ident" id="4349525">PolicyIdentifiers</span>&nbsp;<span class="op" id="4349543">=</span>&nbsp;<span class="builtinfunc" id="4349545">make</span><span class="op" id="4349549">(</span><span class="op" id="4349550">[</span><span class="op" id="4349551">]</span><span class="ident" id="4349552"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4349556">.</span><span class="ident" id="4349557">ObjectIdentifier</span><span class="op" id="4349573">,</span>&nbsp;<span class="builtinfunc" id="4349575">len</span><span class="op" id="4349578">(</span><span class="ident" id="4349579"><a href="/crypto/x509/x509.go.html#4349396">policies</a></span><span class="op" id="4349587">)</span><span class="op" id="4349588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349594">for</span>&nbsp;<span class="ident" id="4349598">i</span><span class="op" id="4349599">,</span>&nbsp;<span class="ident" id="4349601">policy</span>&nbsp;<span class="op" id="4349608">:=</span>&nbsp;<span class="keyword" id="4349611">range</span>&nbsp;<span class="ident" id="4349617"><a href="/crypto/x509/x509.go.html#4349396">policies</a></span>&nbsp;<span class="op" id="4349626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349633"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4349636">.</span><span class="ident" id="4349637">PolicyIdentifiers</span><span class="op" id="4349654">[</span><span class="ident" id="4349655"><a href="/crypto/x509/x509.go.html#4349598">i</a></span><span class="op" id="4349656">]</span>&nbsp;<span class="op" id="4349658">=</span>&nbsp;<span class="ident" id="4349660"><a href="/crypto/x509/x509.go.html#4349601">policy</a></span><span class="op" id="4349666">.</span><span class="ident" id="4349667">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349687">}</span>&nbsp;<span class="keyword" id="4349689">else</span>&nbsp;<span class="keyword" id="4349694">if</span>&nbsp;<span class="ident" id="4349697"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4349698">.</span><span class="ident" id="4349699">Id</span><span class="op" id="4349701">.</span><span class="ident" id="4349702">Equal</span><span class="op" id="4349707">(</span><span class="ident" id="4349708"><a href="/crypto/x509/x509.go.html#4352057">oidExtensionAuthorityInfoAccess</a></span><span class="op" id="4349739">)</span>&nbsp;<span class="op" id="4349741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349746">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349799">var</span>&nbsp;<span class="ident" id="4349803">aia</span>&nbsp;<span class="op" id="4349807">[</span><span class="op" id="4349808">]</span><span class="ident" id="4349809"><a href="/crypto/x509/x509.go.html#4339844">authorityInfoAccess</a></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349832">if</span>&nbsp;<span class="ident" id="4349835">_</span><span class="op" id="4349836">,</span>&nbsp;<span class="ident" id="4349838"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4349842">=</span>&nbsp;<span class="ident" id="4349844"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4349848">.</span><span class="ident" id="4349849">Unmarshal</span><span class="op" id="4349858">(</span><span class="ident" id="4349859"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4349860">.</span><span class="ident" id="4349861">Value</span><span class="op" id="4349866">,</span>&nbsp;<span class="op" id="4349868">&amp;</span><span class="ident" id="4349869"><a href="/crypto/x509/x509.go.html#4349803">aia</a></span><span class="op" id="4349872">)</span><span class="op" id="4349873">;</span>&nbsp;<span class="ident" id="4349875"><a href="/crypto/x509/x509.go.html#4344257">err</a></span>&nbsp;<span class="op" id="4349879">!=</span>&nbsp;<span class="ident" id="4349882">nil</span>&nbsp;<span class="op" id="4349886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349892">return</span>&nbsp;<span class="ident" id="4349899">nil</span><span class="op" id="4349902">,</span>&nbsp;<span class="ident" id="4349904"><a href="/crypto/x509/x509.go.html#4344257">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349917">for</span>&nbsp;<span class="ident" id="4349921">_</span><span class="op" id="4349922">,</span>&nbsp;<span class="ident" id="4349924">v</span>&nbsp;<span class="op" id="4349926">:=</span>&nbsp;<span class="keyword" id="4349929">range</span>&nbsp;<span class="ident" id="4349935"><a href="/crypto/x509/x509.go.html#4349803">aia</a></span>&nbsp;<span class="op" id="4349939">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349945">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350005">if</span>&nbsp;<span class="ident" id="4350008"><a href="/crypto/x509/x509.go.html#4349924">v</a></span><span class="op" id="4350009">.</span><span class="ident" id="4350010">Location</span><span class="op" id="4350018">.</span><span class="ident" id="4350019">Tag</span>&nbsp;<span class="op" id="4350023">!=</span>&nbsp;<span class="num" id="4350026">6</span>&nbsp;<span class="op" id="4350028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350035">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4350048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350054">if</span>&nbsp;<span class="ident" id="4350057"><a href="/crypto/x509/x509.go.html#4349924">v</a></span><span class="op" id="4350058">.</span><span class="ident" id="4350059">Method</span><span class="op" id="4350065">.</span><span class="ident" id="4350066">Equal</span><span class="op" id="4350071">(</span><span class="ident" id="4350072"><a href="/crypto/x509/x509.go.html#4352136">oidAuthorityInfoAccessOcsp</a></span><span class="op" id="4350098">)</span>&nbsp;<span class="op" id="4350100">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350107"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4350110">.</span><span class="ident" id="4350111">OCSPServer</span>&nbsp;<span class="op" id="4350122">=</span>&nbsp;<span class="builtinfunc" id="4350124">append</span><span class="op" id="4350130">(</span><span class="ident" id="4350131"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4350134">.</span><span class="ident" id="4350135">OCSPServer</span><span class="op" id="4350145">,</span>&nbsp;<span class="builtintype" id="4350147">string</span><span class="op" id="4350153">(</span><span class="ident" id="4350154"><a href="/crypto/x509/x509.go.html#4349924">v</a></span><span class="op" id="4350155">.</span><span class="ident" id="4350156">Location</span><span class="op" id="4350164">.</span><span class="ident" id="4350165">Bytes</span><span class="op" id="4350170">)</span><span class="op" id="4350171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4350177">}</span>&nbsp;<span class="keyword" id="4350179">else</span>&nbsp;<span class="keyword" id="4350184">if</span>&nbsp;<span class="ident" id="4350187"><a href="/crypto/x509/x509.go.html#4349924">v</a></span><span class="op" id="4350188">.</span><span class="ident" id="4350189">Method</span><span class="op" id="4350195">.</span><span class="ident" id="4350196">Equal</span><span class="op" id="4350201">(</span><span class="ident" id="4350202"><a href="/crypto/x509/x509.go.html#4352219">oidAuthorityInfoAccessIssuers</a></span><span class="op" id="4350231">)</span>&nbsp;<span class="op" id="4350233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350240"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4350243">.</span><span class="ident" id="4350244">IssuingCertificateURL</span>&nbsp;<span class="op" id="4350266">=</span>&nbsp;<span class="builtinfunc" id="4350268">append</span><span class="op" id="4350274">(</span><span class="ident" id="4350275"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4350278">.</span><span class="ident" id="4350279">IssuingCertificateURL</span><span class="op" id="4350300">,</span>&nbsp;<span class="builtintype" id="4350302">string</span><span class="op" id="4350308">(</span><span class="ident" id="4350309"><a href="/crypto/x509/x509.go.html#4349924">v</a></span><span class="op" id="4350310">.</span><span class="ident" id="4350311">Location</span><span class="op" id="4350319">.</span><span class="ident" id="4350320">Bytes</span><span class="op" id="4350325">)</span><span class="op" id="4350326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4350332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4350337">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4350341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350346">if</span>&nbsp;<span class="ident" id="4350349"><a href="/crypto/x509/x509.go.html#4345062">e</a></span><span class="op" id="4350350">.</span><span class="ident" id="4350351">Critical</span>&nbsp;<span class="op" id="4350360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350365">return</span>&nbsp;<span class="ident" id="4350372"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4350375">,</span>&nbsp;<span class="ident" id="4350377"><a href="/crypto/x509/x509.go.html#4339219">UnhandledCriticalExtension</a></span><span class="op" id="4350403">{</span><span class="op" id="4350404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4350408">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4350411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350415">return</span>&nbsp;<span class="ident" id="4350422"><a href="/crypto/x509/x509.go.html#4343733">out</a></span><span class="op" id="4350425">,</span>&nbsp;<span class="ident" id="4350427">nil</span><br>
<span class="lineno"></span><span class="op" id="4350431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="4350434">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4350513">func</span>&nbsp;<span class="ident" id="4350518">ParseCertificate</span><span class="op" id="4350534">(</span><span class="ident" id="4350535">asn1Data</span>&nbsp;<span class="op" id="4350544">[</span><span class="op" id="4350545">]</span><span class="builtintype" id="4350546">byte</span><span class="op" id="4350550">)</span>&nbsp;<span class="op" id="4350552">(</span><span class="op" id="4350553">*</span><span class="ident" id="4350554"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4350565">,</span>&nbsp;<span class="builtintype" id="4350567">error</span><span class="op" id="4350572">)</span>&nbsp;<span class="op" id="4350574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350577">var</span>&nbsp;<span class="ident" id="4350581">cert</span>&nbsp;<span class="ident" id="4350586"><a href="/crypto/x509/x509.go.html#4319215">certificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350599">rest</span><span class="op" id="4350603">,</span>&nbsp;<span class="ident" id="4350605">err</span>&nbsp;<span class="op" id="4350609">:=</span>&nbsp;<span class="ident" id="4350612"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4350616">.</span><span class="ident" id="4350617">Unmarshal</span><span class="op" id="4350626">(</span><span class="ident" id="4350627"><a href="/crypto/x509/x509.go.html#4350535">asn1Data</a></span><span class="op" id="4350635">,</span>&nbsp;<span class="op" id="4350637">&amp;</span><span class="ident" id="4350638"><a href="/crypto/x509/x509.go.html#4350581">cert</a></span><span class="op" id="4350642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350645">if</span>&nbsp;<span class="ident" id="4350648"><a href="/crypto/x509/x509.go.html#4350605">err</a></span>&nbsp;<span class="op" id="4350652">!=</span>&nbsp;<span class="ident" id="4350655">nil</span>&nbsp;<span class="op" id="4350659">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350663">return</span>&nbsp;<span class="ident" id="4350670">nil</span><span class="op" id="4350673">,</span>&nbsp;<span class="ident" id="4350675"><a href="/crypto/x509/x509.go.html#4350605">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4350680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350683">if</span>&nbsp;<span class="builtinfunc" id="4350686">len</span><span class="op" id="4350689">(</span><span class="ident" id="4350690"><a href="/crypto/x509/x509.go.html#4350599">rest</a></span><span class="op" id="4350694">)</span>&nbsp;<span class="op" id="4350696">&gt;</span>&nbsp;<span class="num" id="4350698">0</span>&nbsp;<span class="op" id="4350700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350704">return</span>&nbsp;<span class="ident" id="4350711">nil</span><span class="op" id="4350714">,</span>&nbsp;<span class="ident" id="4350716"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4350720">.</span><span class="ident" id="4350721">SyntaxError</span><span class="op" id="4350732">{</span><span class="ident" id="4350733">Msg</span><span class="op" id="4350736">:</span>&nbsp;<span class="string" id="4350738">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4350753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4350756">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350760">return</span>&nbsp;<span class="ident" id="4350767"><a href="/crypto/x509/x509.go.html#4343674">parseCertificate</a></span><span class="op" id="4350783">(</span><span class="op" id="4350784">&amp;</span><span class="ident" id="4350785"><a href="/crypto/x509/x509.go.html#4350581">cert</a></span><span class="op" id="4350789">)</span><br>
<span class="lineno"></span><span class="op" id="4350791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4350794">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="4350872">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="4350949">func</span>&nbsp;<span class="ident" id="4350954">ParseCertificates</span><span class="op" id="4350971">(</span><span class="ident" id="4350972">asn1Data</span>&nbsp;<span class="op" id="4350981">[</span><span class="op" id="4350982">]</span><span class="builtintype" id="4350983">byte</span><span class="op" id="4350987">)</span>&nbsp;<span class="op" id="4350989">(</span><span class="op" id="4350990">[</span><span class="op" id="4350991">]</span><span class="op" id="4350992">*</span><span class="ident" id="4350993"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4351004">,</span>&nbsp;<span class="builtintype" id="4351006">error</span><span class="op" id="4351011">)</span>&nbsp;<span class="op" id="4351013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351016">var</span>&nbsp;<span class="ident" id="4351020">v</span>&nbsp;<span class="op" id="4351022">[</span><span class="op" id="4351023">]</span><span class="op" id="4351024">*</span><span class="ident" id="4351025"><a href="/crypto/x509/x509.go.html#4319215">certificate</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351039">for</span>&nbsp;<span class="builtinfunc" id="4351043">len</span><span class="op" id="4351046">(</span><span class="ident" id="4351047"><a href="/crypto/x509/x509.go.html#4350972">asn1Data</a></span><span class="op" id="4351055">)</span>&nbsp;<span class="op" id="4351057">&gt;</span>&nbsp;<span class="num" id="4351059">0</span>&nbsp;<span class="op" id="4351061">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351065">cert</span>&nbsp;<span class="op" id="4351070">:=</span>&nbsp;<span class="builtinfunc" id="4351073">new</span><span class="op" id="4351076">(</span><span class="ident" id="4351077"><a href="/crypto/x509/x509.go.html#4319215">certificate</a></span><span class="op" id="4351088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351092">var</span>&nbsp;<span class="ident" id="4351096">err</span>&nbsp;<span class="builtintype" id="4351100">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351108"><a href="/crypto/x509/x509.go.html#4350972">asn1Data</a></span><span class="op" id="4351116">,</span>&nbsp;<span class="ident" id="4351118"><a href="/crypto/x509/x509.go.html#4351096">err</a></span>&nbsp;<span class="op" id="4351122">=</span>&nbsp;<span class="ident" id="4351124"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4351128">.</span><span class="ident" id="4351129">Unmarshal</span><span class="op" id="4351138">(</span><span class="ident" id="4351139"><a href="/crypto/x509/x509.go.html#4350972">asn1Data</a></span><span class="op" id="4351147">,</span>&nbsp;<span class="ident" id="4351149"><a href="/crypto/x509/x509.go.html#4351065">cert</a></span><span class="op" id="4351153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351157">if</span>&nbsp;<span class="ident" id="4351160"><a href="/crypto/x509/x509.go.html#4351096">err</a></span>&nbsp;<span class="op" id="4351164">!=</span>&nbsp;<span class="ident" id="4351167">nil</span>&nbsp;<span class="op" id="4351171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351176">return</span>&nbsp;<span class="ident" id="4351183">nil</span><span class="op" id="4351186">,</span>&nbsp;<span class="ident" id="4351188"><a href="/crypto/x509/x509.go.html#4351096">err</a></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4351194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351198"><a href="/crypto/x509/x509.go.html#4351020">v</a></span>&nbsp;<span class="op" id="4351200">=</span>&nbsp;<span class="builtinfunc" id="4351202">append</span><span class="op" id="4351208">(</span><span class="ident" id="4351209"><a href="/crypto/x509/x509.go.html#4351020">v</a></span><span class="op" id="4351210">,</span>&nbsp;<span class="ident" id="4351212"><a href="/crypto/x509/x509.go.html#4351065">cert</a></span><span class="op" id="4351216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4351219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351223">ret</span>&nbsp;<span class="op" id="4351227">:=</span>&nbsp;<span class="builtinfunc" id="4351230">make</span><span class="op" id="4351234">(</span><span class="op" id="4351235">[</span><span class="op" id="4351236">]</span><span class="op" id="4351237">*</span><span class="ident" id="4351238"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4351249">,</span>&nbsp;<span class="builtinfunc" id="4351251">len</span><span class="op" id="4351254">(</span><span class="ident" id="4351255"><a href="/crypto/x509/x509.go.html#4351020">v</a></span><span class="op" id="4351256">)</span><span class="op" id="4351257">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351260">for</span>&nbsp;<span class="ident" id="4351264">i</span><span class="op" id="4351265">,</span>&nbsp;<span class="ident" id="4351267">ci</span>&nbsp;<span class="op" id="4351270">:=</span>&nbsp;<span class="keyword" id="4351273">range</span>&nbsp;<span class="ident" id="4351279"><a href="/crypto/x509/x509.go.html#4351020">v</a></span>&nbsp;<span class="op" id="4351281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351285">cert</span><span class="op" id="4351289">,</span>&nbsp;<span class="ident" id="4351291">err</span>&nbsp;<span class="op" id="4351295">:=</span>&nbsp;<span class="ident" id="4351298"><a href="/crypto/x509/x509.go.html#4343674">parseCertificate</a></span><span class="op" id="4351314">(</span><span class="ident" id="4351315"><a href="/crypto/x509/x509.go.html#4351267">ci</a></span><span class="op" id="4351317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351321">if</span>&nbsp;<span class="ident" id="4351324"><a href="/crypto/x509/x509.go.html#4351291">err</a></span>&nbsp;<span class="op" id="4351328">!=</span>&nbsp;<span class="ident" id="4351331">nil</span>&nbsp;<span class="op" id="4351335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351340">return</span>&nbsp;<span class="ident" id="4351347">nil</span><span class="op" id="4351350">,</span>&nbsp;<span class="ident" id="4351352"><a href="/crypto/x509/x509.go.html#4351291">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4351358">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351362"><a href="/crypto/x509/x509.go.html#4351223">ret</a></span><span class="op" id="4351365">[</span><span class="ident" id="4351366"><a href="/crypto/x509/x509.go.html#4351264">i</a></span><span class="op" id="4351367">]</span>&nbsp;<span class="op" id="4351369">=</span>&nbsp;<span class="ident" id="4351371"><a href="/crypto/x509/x509.go.html#4351285">cert</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4351377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351381">return</span>&nbsp;<span class="ident" id="4351388"><a href="/crypto/x509/x509.go.html#4351223">ret</a></span><span class="op" id="4351391">,</span>&nbsp;<span class="ident" id="4351393">nil</span><br>
<span class="lineno"></span><span class="op" id="4351397">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="4351400">func</span>&nbsp;<span class="ident" id="4351405">reverseBitsInAByte</span><span class="op" id="4351423">(</span><span class="ident" id="4351424">in</span>&nbsp;<span class="builtintype" id="4351427">byte</span><span class="op" id="4351431">)</span>&nbsp;<span class="builtintype" id="4351433">byte</span>&nbsp;<span class="op" id="4351438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351441">b1</span>&nbsp;<span class="op" id="4351444">:=</span>&nbsp;<span class="ident" id="4351447"><a href="/crypto/x509/x509.go.html#4351424">in</a></span><span class="op" id="4351449">&gt;&gt;</span><span class="num" id="4351451">4</span>&nbsp;<span class="op" id="4351453">|</span>&nbsp;<span class="ident" id="4351455"><a href="/crypto/x509/x509.go.html#4351424">in</a></span><span class="op" id="4351457">&lt;&lt;</span><span class="num" id="4351459">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351462">b2</span>&nbsp;<span class="op" id="4351465">:=</span>&nbsp;<span class="ident" id="4351468"><a href="/crypto/x509/x509.go.html#4351441">b1</a></span><span class="op" id="4351470">&gt;&gt;</span><span class="num" id="4351472">2</span><span class="op" id="4351473">&amp;</span><span class="num" id="4351474">0x33</span>&nbsp;<span class="op" id="4351479">|</span>&nbsp;<span class="ident" id="4351481"><a href="/crypto/x509/x509.go.html#4351441">b1</a></span><span class="op" id="4351483">&lt;&lt;</span><span class="num" id="4351485">2</span><span class="op" id="4351486">&amp;</span><span class="num" id="4351487">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351493">b3</span>&nbsp;<span class="op" id="4351496">:=</span>&nbsp;<span class="ident" id="4351499"><a href="/crypto/x509/x509.go.html#4351462">b2</a></span><span class="op" id="4351501">&gt;&gt;</span><span class="num" id="4351503">1</span><span class="op" id="4351504">&amp;</span><span class="num" id="4351505">0x55</span>&nbsp;<span class="op" id="4351510">|</span>&nbsp;<span class="ident" id="4351512"><a href="/crypto/x509/x509.go.html#4351462">b2</a></span><span class="op" id="4351514">&lt;&lt;</span><span class="num" id="4351516">1</span><span class="op" id="4351517">&amp;</span><span class="num" id="4351518">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351524">return</span>&nbsp;<span class="ident" id="4351531"><a href="/crypto/x509/x509.go.html#4351493">b3</a></span><br>
<span class="lineno"></span><span class="op" id="4351534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4351537">var</span>&nbsp;<span class="op" id="4351541">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351544">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4351578">=</span>&nbsp;<span class="op" id="4351580">[</span><span class="op" id="4351581">]</span><span class="builtintype" id="4351582">int</span><span class="op" id="4351585">{</span><span class="num" id="4351586">2</span><span class="op" id="4351587">,</span>&nbsp;<span class="num" id="4351589">5</span><span class="op" id="4351590">,</span>&nbsp;<span class="num" id="4351592">29</span><span class="op" id="4351594">,</span>&nbsp;<span class="num" id="4351596">14</span><span class="op" id="4351598">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351601">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4351635">=</span>&nbsp;<span class="op" id="4351637">[</span><span class="op" id="4351638">]</span><span class="builtintype" id="4351639">int</span><span class="op" id="4351642">{</span><span class="num" id="4351643">2</span><span class="op" id="4351644">,</span>&nbsp;<span class="num" id="4351646">5</span><span class="op" id="4351647">,</span>&nbsp;<span class="num" id="4351649">29</span><span class="op" id="4351651">,</span>&nbsp;<span class="num" id="4351653">15</span><span class="op" id="4351655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351658">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4351692">=</span>&nbsp;<span class="op" id="4351694">[</span><span class="op" id="4351695">]</span><span class="builtintype" id="4351696">int</span><span class="op" id="4351699">{</span><span class="num" id="4351700">2</span><span class="op" id="4351701">,</span>&nbsp;<span class="num" id="4351703">5</span><span class="op" id="4351704">,</span>&nbsp;<span class="num" id="4351706">29</span><span class="op" id="4351708">,</span>&nbsp;<span class="num" id="4351710">37</span><span class="op" id="4351712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351715">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4351749">=</span>&nbsp;<span class="op" id="4351751">[</span><span class="op" id="4351752">]</span><span class="builtintype" id="4351753">int</span><span class="op" id="4351756">{</span><span class="num" id="4351757">2</span><span class="op" id="4351758">,</span>&nbsp;<span class="num" id="4351760">5</span><span class="op" id="4351761">,</span>&nbsp;<span class="num" id="4351763">29</span><span class="op" id="4351765">,</span>&nbsp;<span class="num" id="4351767">35</span><span class="op" id="4351769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351772">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4351806">=</span>&nbsp;<span class="op" id="4351808">[</span><span class="op" id="4351809">]</span><span class="builtintype" id="4351810">int</span><span class="op" id="4351813">{</span><span class="num" id="4351814">2</span><span class="op" id="4351815">,</span>&nbsp;<span class="num" id="4351817">5</span><span class="op" id="4351818">,</span>&nbsp;<span class="num" id="4351820">29</span><span class="op" id="4351822">,</span>&nbsp;<span class="num" id="4351824">19</span><span class="op" id="4351826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351829">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4351863">=</span>&nbsp;<span class="op" id="4351865">[</span><span class="op" id="4351866">]</span><span class="builtintype" id="4351867">int</span><span class="op" id="4351870">{</span><span class="num" id="4351871">2</span><span class="op" id="4351872">,</span>&nbsp;<span class="num" id="4351874">5</span><span class="op" id="4351875">,</span>&nbsp;<span class="num" id="4351877">29</span><span class="op" id="4351879">,</span>&nbsp;<span class="num" id="4351881">17</span><span class="op" id="4351883">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351886">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4351920">=</span>&nbsp;<span class="op" id="4351922">[</span><span class="op" id="4351923">]</span><span class="builtintype" id="4351924">int</span><span class="op" id="4351927">{</span><span class="num" id="4351928">2</span><span class="op" id="4351929">,</span>&nbsp;<span class="num" id="4351931">5</span><span class="op" id="4351932">,</span>&nbsp;<span class="num" id="4351934">29</span><span class="op" id="4351936">,</span>&nbsp;<span class="num" id="4351938">32</span><span class="op" id="4351940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351943">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4351977">=</span>&nbsp;<span class="op" id="4351979">[</span><span class="op" id="4351980">]</span><span class="builtintype" id="4351981">int</span><span class="op" id="4351984">{</span><span class="num" id="4351985">2</span><span class="op" id="4351986">,</span>&nbsp;<span class="num" id="4351988">5</span><span class="op" id="4351989">,</span>&nbsp;<span class="num" id="4351991">29</span><span class="op" id="4351993">,</span>&nbsp;<span class="num" id="4351995">30</span><span class="op" id="4351997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352000">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="4352034">=</span>&nbsp;<span class="op" id="4352036">[</span><span class="op" id="4352037">]</span><span class="builtintype" id="4352038">int</span><span class="op" id="4352041">{</span><span class="num" id="4352042">2</span><span class="op" id="4352043">,</span>&nbsp;<span class="num" id="4352045">5</span><span class="op" id="4352046">,</span>&nbsp;<span class="num" id="4352048">29</span><span class="op" id="4352050">,</span>&nbsp;<span class="num" id="4352052">31</span><span class="op" id="4352054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352057">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4352091">=</span>&nbsp;<span class="op" id="4352093">[</span><span class="op" id="4352094">]</span><span class="builtintype" id="4352095">int</span><span class="op" id="4352098">{</span><span class="num" id="4352099">1</span><span class="op" id="4352100">,</span>&nbsp;<span class="num" id="4352102">3</span><span class="op" id="4352103">,</span>&nbsp;<span class="num" id="4352105">6</span><span class="op" id="4352106">,</span>&nbsp;<span class="num" id="4352108">1</span><span class="op" id="4352109">,</span>&nbsp;<span class="num" id="4352111">5</span><span class="op" id="4352112">,</span>&nbsp;<span class="num" id="4352114">5</span><span class="op" id="4352115">,</span>&nbsp;<span class="num" id="4352117">7</span><span class="op" id="4352118">,</span>&nbsp;<span class="num" id="4352120">1</span><span class="op" id="4352121">,</span>&nbsp;<span class="num" id="4352123">1</span><span class="op" id="4352124">}</span><br>
<span class="lineno"></span><span class="op" id="4352126">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="4352129">var</span>&nbsp;<span class="op" id="4352133">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352136">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4352166">=</span>&nbsp;<span class="ident" id="4352168"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4352172">.</span><span class="ident" id="4352173">ObjectIdentifier</span><span class="op" id="4352189">{</span><span class="num" id="4352190">1</span><span class="op" id="4352191">,</span>&nbsp;<span class="num" id="4352193">3</span><span class="op" id="4352194">,</span>&nbsp;<span class="num" id="4352196">6</span><span class="op" id="4352197">,</span>&nbsp;<span class="num" id="4352199">1</span><span class="op" id="4352200">,</span>&nbsp;<span class="num" id="4352202">5</span><span class="op" id="4352203">,</span>&nbsp;<span class="num" id="4352205">5</span><span class="op" id="4352206">,</span>&nbsp;<span class="num" id="4352208">7</span><span class="op" id="4352209">,</span>&nbsp;<span class="num" id="4352211">48</span><span class="op" id="4352213">,</span>&nbsp;<span class="num" id="4352215">1</span><span class="op" id="4352216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352219">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="4352249">=</span>&nbsp;<span class="ident" id="4352251"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4352255">.</span><span class="ident" id="4352256">ObjectIdentifier</span><span class="op" id="4352272">{</span><span class="num" id="4352273">1</span><span class="op" id="4352274">,</span>&nbsp;<span class="num" id="4352276">3</span><span class="op" id="4352277">,</span>&nbsp;<span class="num" id="4352279">6</span><span class="op" id="4352280">,</span>&nbsp;<span class="num" id="4352282">1</span><span class="op" id="4352283">,</span>&nbsp;<span class="num" id="4352285">5</span><span class="op" id="4352286">,</span>&nbsp;<span class="num" id="4352288">5</span><span class="op" id="4352289">,</span>&nbsp;<span class="num" id="4352291">7</span><span class="op" id="4352292">,</span>&nbsp;<span class="num" id="4352294">48</span><span class="op" id="4352296">,</span>&nbsp;<span class="num" id="4352298">2</span><span class="op" id="4352299">}</span><br>
<span class="lineno"></span><span class="op" id="4352301">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="4352304">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4352384">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="4352399">func</span>&nbsp;<span class="ident" id="4352404">oidInExtensions</span><span class="op" id="4352419">(</span><span class="ident" id="4352420">oid</span>&nbsp;<span class="ident" id="4352424"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4352428">.</span><span class="ident" id="4352429">ObjectIdentifier</span><span class="op" id="4352445">,</span>&nbsp;<span class="ident" id="4352447">extensions</span>&nbsp;<span class="op" id="4352458">[</span><span class="op" id="4352459">]</span><span class="ident" id="4352460"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4352464">.</span><span class="ident" id="4352465">Extension</span><span class="op" id="4352474">)</span>&nbsp;<span class="builtintype" id="4352476">bool</span>&nbsp;<span class="op" id="4352481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352484">for</span>&nbsp;<span class="ident" id="4352488">_</span><span class="op" id="4352489">,</span>&nbsp;<span class="ident" id="4352491">e</span>&nbsp;<span class="op" id="4352493">:=</span>&nbsp;<span class="keyword" id="4352496">range</span>&nbsp;<span class="ident" id="4352502"><a href="/crypto/x509/x509.go.html#4352447">extensions</a></span>&nbsp;<span class="op" id="4352513">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352517">if</span>&nbsp;<span class="ident" id="4352520"><a href="/crypto/x509/x509.go.html#4352491">e</a></span><span class="op" id="4352521">.</span><span class="ident" id="4352522">Id</span><span class="op" id="4352524">.</span><span class="ident" id="4352525">Equal</span><span class="op" id="4352530">(</span><span class="ident" id="4352531"><a href="/crypto/x509/x509.go.html#4352420">oid</a></span><span class="op" id="4352534">)</span>&nbsp;<span class="op" id="4352536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352541">return</span>&nbsp;<span class="ident" id="4352548">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4352555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4352558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352561">return</span>&nbsp;<span class="ident" id="4352568">false</span><br>
<span class="lineno">1165</span><span class="op" id="4352574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4352577">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="4352653">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="4352690">func</span>&nbsp;<span class="ident" id="4352695">marshalSANs</span><span class="op" id="4352706">(</span><span class="ident" id="4352707">dnsNames</span><span class="op" id="4352715">,</span>&nbsp;<span class="ident" id="4352717">emailAddresses</span>&nbsp;<span class="op" id="4352732">[</span><span class="op" id="4352733">]</span><span class="builtintype" id="4352734">string</span><span class="op" id="4352740">,</span>&nbsp;<span class="ident" id="4352742">ipAddresses</span>&nbsp;<span class="op" id="4352754">[</span><span class="op" id="4352755">]</span><span class="ident" id="4352756"><a href="/crypto/x509/x509.go.html#4316743">net</a></span><span class="op" id="4352759">.</span><span class="ident" id="4352760">IP</span><span class="op" id="4352762">)</span>&nbsp;<span class="op" id="4352764">(</span><span class="ident" id="4352765">derBytes</span>&nbsp;<span class="op" id="4352774">[</span><span class="op" id="4352775">]</span><span class="builtintype" id="4352776">byte</span><span class="op" id="4352780">,</span>&nbsp;<span class="ident" id="4352782">err</span>&nbsp;<span class="builtintype" id="4352786">error</span><span class="op" id="4352791">)</span>&nbsp;<span class="op" id="4352793">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352796">var</span>&nbsp;<span class="ident" id="4352800">rawValues</span>&nbsp;<span class="op" id="4352810">[</span><span class="op" id="4352811">]</span><span class="ident" id="4352812"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4352816">.</span><span class="ident" id="4352817">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352827">for</span>&nbsp;<span class="ident" id="4352831">_</span><span class="op" id="4352832">,</span>&nbsp;<span class="ident" id="4352834">name</span>&nbsp;<span class="op" id="4352839">:=</span>&nbsp;<span class="keyword" id="4352842">range</span>&nbsp;<span class="ident" id="4352848"><a href="/crypto/x509/x509.go.html#4352707">dnsNames</a></span>&nbsp;<span class="op" id="4352857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352861"><a href="/crypto/x509/x509.go.html#4352800">rawValues</a></span>&nbsp;<span class="op" id="4352871">=</span>&nbsp;<span class="builtinfunc" id="4352873">append</span><span class="op" id="4352879">(</span><span class="ident" id="4352880"><a href="/crypto/x509/x509.go.html#4352800">rawValues</a></span><span class="op" id="4352889">,</span>&nbsp;<span class="ident" id="4352891"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4352895">.</span><span class="ident" id="4352896">RawValue</span><span class="op" id="4352904">{</span><span class="ident" id="4352905">Tag</span><span class="op" id="4352908">:</span>&nbsp;<span class="num" id="4352910">2</span><span class="op" id="4352911">,</span>&nbsp;<span class="ident" id="4352913">Class</span><span class="op" id="4352918">:</span>&nbsp;<span class="num" id="4352920">2</span><span class="op" id="4352921">,</span>&nbsp;<span class="ident" id="4352923">Bytes</span><span class="op" id="4352928">:</span>&nbsp;<span class="op" id="4352930">[</span><span class="op" id="4352931">]</span><span class="builtintype" id="4352932">byte</span><span class="op" id="4352936">(</span><span class="ident" id="4352937"><a href="/crypto/x509/x509.go.html#4352834">name</a></span><span class="op" id="4352941">)</span><span class="op" id="4352942">}</span><span class="op" id="4352943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4352946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352949">for</span>&nbsp;<span class="ident" id="4352953">_</span><span class="op" id="4352954">,</span>&nbsp;<span class="ident" id="4352956">email</span>&nbsp;<span class="op" id="4352962">:=</span>&nbsp;<span class="keyword" id="4352965">range</span>&nbsp;<span class="ident" id="4352971"><a href="/crypto/x509/x509.go.html#4352717">emailAddresses</a></span>&nbsp;<span class="op" id="4352986">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352990"><a href="/crypto/x509/x509.go.html#4352800">rawValues</a></span>&nbsp;<span class="op" id="4353000">=</span>&nbsp;<span class="builtinfunc" id="4353002">append</span><span class="op" id="4353008">(</span><span class="ident" id="4353009"><a href="/crypto/x509/x509.go.html#4352800">rawValues</a></span><span class="op" id="4353018">,</span>&nbsp;<span class="ident" id="4353020"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4353024">.</span><span class="ident" id="4353025">RawValue</span><span class="op" id="4353033">{</span><span class="ident" id="4353034">Tag</span><span class="op" id="4353037">:</span>&nbsp;<span class="num" id="4353039">1</span><span class="op" id="4353040">,</span>&nbsp;<span class="ident" id="4353042">Class</span><span class="op" id="4353047">:</span>&nbsp;<span class="num" id="4353049">2</span><span class="op" id="4353050">,</span>&nbsp;<span class="ident" id="4353052">Bytes</span><span class="op" id="4353057">:</span>&nbsp;<span class="op" id="4353059">[</span><span class="op" id="4353060">]</span><span class="builtintype" id="4353061">byte</span><span class="op" id="4353065">(</span><span class="ident" id="4353066"><a href="/crypto/x509/x509.go.html#4352956">email</a></span><span class="op" id="4353071">)</span><span class="op" id="4353072">}</span><span class="op" id="4353073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353079">for</span>&nbsp;<span class="ident" id="4353083">_</span><span class="op" id="4353084">,</span>&nbsp;<span class="ident" id="4353086">rawIP</span>&nbsp;<span class="op" id="4353092">:=</span>&nbsp;<span class="keyword" id="4353095">range</span>&nbsp;<span class="ident" id="4353101"><a href="/crypto/x509/x509.go.html#4352742">ipAddresses</a></span>&nbsp;<span class="op" id="4353113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4353117">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353187">ip</span>&nbsp;<span class="op" id="4353190">:=</span>&nbsp;<span class="ident" id="4353193"><a href="/crypto/x509/x509.go.html#4353086">rawIP</a></span><span class="op" id="4353198">.</span><span class="ident" id="4353199">To4</span><span class="op" id="4353202">(</span><span class="op" id="4353203">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353207">if</span>&nbsp;<span class="ident" id="4353210"><a href="/crypto/x509/x509.go.html#4353187">ip</a></span>&nbsp;<span class="op" id="4353213">==</span>&nbsp;<span class="ident" id="4353216">nil</span>&nbsp;<span class="op" id="4353220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353225"><a href="/crypto/x509/x509.go.html#4353187">ip</a></span>&nbsp;<span class="op" id="4353228">=</span>&nbsp;<span class="ident" id="4353230"><a href="/crypto/x509/x509.go.html#4353086">rawIP</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353242"><a href="/crypto/x509/x509.go.html#4352800">rawValues</a></span>&nbsp;<span class="op" id="4353252">=</span>&nbsp;<span class="builtinfunc" id="4353254">append</span><span class="op" id="4353260">(</span><span class="ident" id="4353261"><a href="/crypto/x509/x509.go.html#4352800">rawValues</a></span><span class="op" id="4353270">,</span>&nbsp;<span class="ident" id="4353272"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4353276">.</span><span class="ident" id="4353277">RawValue</span><span class="op" id="4353285">{</span><span class="ident" id="4353286">Tag</span><span class="op" id="4353289">:</span>&nbsp;<span class="num" id="4353291">7</span><span class="op" id="4353292">,</span>&nbsp;<span class="ident" id="4353294">Class</span><span class="op" id="4353299">:</span>&nbsp;<span class="num" id="4353301">2</span><span class="op" id="4353302">,</span>&nbsp;<span class="ident" id="4353304">Bytes</span><span class="op" id="4353309">:</span>&nbsp;<span class="ident" id="4353311"><a href="/crypto/x509/x509.go.html#4353187">ip</a></span><span class="op" id="4353313">}</span><span class="op" id="4353314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353317">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353320">return</span>&nbsp;<span class="ident" id="4353327"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4353331">.</span><span class="ident" id="4353332">Marshal</span><span class="op" id="4353339">(</span><span class="ident" id="4353340"><a href="/crypto/x509/x509.go.html#4352800">rawValues</a></span><span class="op" id="4353349">)</span><br>
<span class="lineno"></span><span class="op" id="4353351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4353354">func</span>&nbsp;<span class="ident" id="4353359">buildExtensions</span><span class="op" id="4353374">(</span><span class="ident" id="4353375">template</span>&nbsp;<span class="op" id="4353384">*</span><span class="ident" id="4353385"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4353396">)</span>&nbsp;<span class="op" id="4353398">(</span><span class="ident" id="4353399">ret</span>&nbsp;<span class="op" id="4353403">[</span><span class="op" id="4353404">]</span><span class="ident" id="4353405"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4353409">.</span><span class="ident" id="4353410">Extension</span><span class="op" id="4353419">,</span>&nbsp;<span class="ident" id="4353421">err</span>&nbsp;<span class="builtintype" id="4353425">error</span><span class="op" id="4353430">)</span>&nbsp;<span class="op" id="4353432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353435"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span>&nbsp;<span class="op" id="4353439">=</span>&nbsp;<span class="builtinfunc" id="4353441">make</span><span class="op" id="4353445">(</span><span class="op" id="4353446">[</span><span class="op" id="4353447">]</span><span class="ident" id="4353448"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4353452">.</span><span class="ident" id="4353453">Extension</span><span class="op" id="4353462">,</span>&nbsp;<span class="num" id="4353464">10</span>&nbsp;<span class="comment" id="4353467">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="4353500">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353503">n</span>&nbsp;<span class="op" id="4353505">:=</span>&nbsp;<span class="num" id="4353508">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353512">if</span>&nbsp;<span class="ident" id="4353515"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4353523">.</span><span class="ident" id="4353524">KeyUsage</span>&nbsp;<span class="op" id="4353533">!=</span>&nbsp;<span class="num" id="4353536">0</span>&nbsp;<span class="op" id="4353538">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353543">!</span><span class="ident" id="4353544"><a href="/crypto/x509/x509.go.html#4352404">oidInExtensions</a></span><span class="op" id="4353559">(</span><span class="ident" id="4353560"><a href="/crypto/x509/x509.go.html#4351601">oidExtensionKeyUsage</a></span><span class="op" id="4353580">,</span>&nbsp;<span class="ident" id="4353582"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4353590">.</span><span class="ident" id="4353591">ExtraExtensions</span><span class="op" id="4353606">)</span>&nbsp;<span class="op" id="4353608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353612"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4353615">[</span><span class="ident" id="4353616"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4353617">]</span><span class="op" id="4353618">.</span><span class="ident" id="4353619">Id</span>&nbsp;<span class="op" id="4353622">=</span>&nbsp;<span class="ident" id="4353624"><a href="/crypto/x509/x509.go.html#4351601">oidExtensionKeyUsage</a></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353647"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4353650">[</span><span class="ident" id="4353651"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4353652">]</span><span class="op" id="4353653">.</span><span class="ident" id="4353654">Critical</span>&nbsp;<span class="op" id="4353663">=</span>&nbsp;<span class="ident" id="4353665">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353673">var</span>&nbsp;<span class="ident" id="4353677">a</span>&nbsp;<span class="op" id="4353679">[</span><span class="num" id="4353680">2</span><span class="op" id="4353681">]</span><span class="builtintype" id="4353682">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353689"><a href="/crypto/x509/x509.go.html#4353677">a</a></span><span class="op" id="4353690">[</span><span class="num" id="4353691">0</span><span class="op" id="4353692">]</span>&nbsp;<span class="op" id="4353694">=</span>&nbsp;<span class="ident" id="4353696"><a href="/crypto/x509/x509.go.html#4351405">reverseBitsInAByte</a></span><span class="op" id="4353714">(</span><span class="builtintype" id="4353715">byte</span><span class="op" id="4353719">(</span><span class="ident" id="4353720"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4353728">.</span><span class="ident" id="4353729">KeyUsage</span><span class="op" id="4353737">)</span><span class="op" id="4353738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353742"><a href="/crypto/x509/x509.go.html#4353677">a</a></span><span class="op" id="4353743">[</span><span class="num" id="4353744">1</span><span class="op" id="4353745">]</span>&nbsp;<span class="op" id="4353747">=</span>&nbsp;<span class="ident" id="4353749"><a href="/crypto/x509/x509.go.html#4351405">reverseBitsInAByte</a></span><span class="op" id="4353767">(</span><span class="builtintype" id="4353768">byte</span><span class="op" id="4353772">(</span><span class="ident" id="4353773"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4353781">.</span><span class="ident" id="4353782">KeyUsage</span>&nbsp;<span class="op" id="4353791">&gt;&gt;</span>&nbsp;<span class="num" id="4353794">8</span><span class="op" id="4353795">)</span><span class="op" id="4353796">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353801">l</span>&nbsp;<span class="op" id="4353803">:=</span>&nbsp;<span class="num" id="4353806">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353810">if</span>&nbsp;<span class="ident" id="4353813"><a href="/crypto/x509/x509.go.html#4353677">a</a></span><span class="op" id="4353814">[</span><span class="num" id="4353815">1</span><span class="op" id="4353816">]</span>&nbsp;<span class="op" id="4353818">!=</span>&nbsp;<span class="num" id="4353821">0</span>&nbsp;<span class="op" id="4353823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353828"><a href="/crypto/x509/x509.go.html#4353801">l</a></span>&nbsp;<span class="op" id="4353830">=</span>&nbsp;<span class="num" id="4353832">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353836">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353841"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4353844">[</span><span class="ident" id="4353845"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4353846">]</span><span class="op" id="4353847">.</span><span class="ident" id="4353848">Value</span><span class="op" id="4353853">,</span>&nbsp;<span class="ident" id="4353855"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4353859">=</span>&nbsp;<span class="ident" id="4353861"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4353865">.</span><span class="ident" id="4353866">Marshal</span><span class="op" id="4353873">(</span><span class="ident" id="4353874"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4353878">.</span><span class="ident" id="4353879">BitString</span><span class="op" id="4353888">{</span><span class="ident" id="4353889">Bytes</span><span class="op" id="4353894">:</span>&nbsp;<span class="ident" id="4353896"><a href="/crypto/x509/x509.go.html#4353677">a</a></span><span class="op" id="4353897">[</span><span class="num" id="4353898">0</span><span class="op" id="4353899">:</span><span class="ident" id="4353900"><a href="/crypto/x509/x509.go.html#4353801">l</a></span><span class="op" id="4353901">]</span><span class="op" id="4353902">,</span>&nbsp;<span class="ident" id="4353904">BitLength</span><span class="op" id="4353913">:</span>&nbsp;<span class="ident" id="4353915"><a href="/crypto/x509/x509.go.html#4353801">l</a></span>&nbsp;<span class="op" id="4353917">*</span>&nbsp;<span class="num" id="4353919">8</span><span class="op" id="4353920">}</span><span class="op" id="4353921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353925">if</span>&nbsp;<span class="ident" id="4353928"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4353932">!=</span>&nbsp;<span class="ident" id="4353935">nil</span>&nbsp;<span class="op" id="4353939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353944">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353953">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353957"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4353958">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353966">if</span>&nbsp;<span class="op" id="4353969">(</span><span class="builtinfunc" id="4353970">len</span><span class="op" id="4353973">(</span><span class="ident" id="4353974"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4353982">.</span><span class="ident" id="4353983">ExtKeyUsage</span><span class="op" id="4353994">)</span>&nbsp;<span class="op" id="4353996">&gt;</span>&nbsp;<span class="num" id="4353998">0</span>&nbsp;<span class="op" id="4354000">||</span>&nbsp;<span class="builtinfunc" id="4354003">len</span><span class="op" id="4354006">(</span><span class="ident" id="4354007"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4354015">.</span><span class="ident" id="4354016">UnknownExtKeyUsage</span><span class="op" id="4354034">)</span>&nbsp;<span class="op" id="4354036">&gt;</span>&nbsp;<span class="num" id="4354038">0</span><span class="op" id="4354039">)</span>&nbsp;<span class="op" id="4354041">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354046">!</span><span class="ident" id="4354047"><a href="/crypto/x509/x509.go.html#4352404">oidInExtensions</a></span><span class="op" id="4354062">(</span><span class="ident" id="4354063"><a href="/crypto/x509/x509.go.html#4351658">oidExtensionExtendedKeyUsage</a></span><span class="op" id="4354091">,</span>&nbsp;<span class="ident" id="4354093"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4354101">.</span><span class="ident" id="4354102">ExtraExtensions</span><span class="op" id="4354117">)</span>&nbsp;<span class="op" id="4354119">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354123"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4354126">[</span><span class="ident" id="4354127"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4354128">]</span><span class="op" id="4354129">.</span><span class="ident" id="4354130">Id</span>&nbsp;<span class="op" id="4354133">=</span>&nbsp;<span class="ident" id="4354135"><a href="/crypto/x509/x509.go.html#4351658">oidExtensionExtendedKeyUsage</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354167">var</span>&nbsp;<span class="ident" id="4354171">oids</span>&nbsp;<span class="op" id="4354176">[</span><span class="op" id="4354177">]</span><span class="ident" id="4354178"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4354182">.</span><span class="ident" id="4354183">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354202">for</span>&nbsp;<span class="ident" id="4354206">_</span><span class="op" id="4354207">,</span>&nbsp;<span class="ident" id="4354209">u</span>&nbsp;<span class="op" id="4354211">:=</span>&nbsp;<span class="keyword" id="4354214">range</span>&nbsp;<span class="ident" id="4354220"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4354228">.</span><span class="ident" id="4354229">ExtKeyUsage</span>&nbsp;<span class="op" id="4354241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354246">if</span>&nbsp;<span class="ident" id="4354249">oid</span><span class="op" id="4354252">,</span>&nbsp;<span class="ident" id="4354254">ok</span>&nbsp;<span class="op" id="4354257">:=</span>&nbsp;<span class="ident" id="4354260"><a href="/crypto/x509/x509.go.html#4330531">oidFromExtKeyUsage</a></span><span class="op" id="4354278">(</span><span class="ident" id="4354279"><a href="/crypto/x509/x509.go.html#4354209">u</a></span><span class="op" id="4354280">)</span><span class="op" id="4354281">;</span>&nbsp;<span class="ident" id="4354283"><a href="/crypto/x509/x509.go.html#4354254">ok</a></span>&nbsp;<span class="op" id="4354286">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354292"><a href="/crypto/x509/x509.go.html#4354171">oids</a></span>&nbsp;<span class="op" id="4354297">=</span>&nbsp;<span class="builtinfunc" id="4354299">append</span><span class="op" id="4354305">(</span><span class="ident" id="4354306"><a href="/crypto/x509/x509.go.html#4354171">oids</a></span><span class="op" id="4354310">,</span>&nbsp;<span class="ident" id="4354312"><a href="/crypto/x509/x509.go.html#4354249">oid</a></span><span class="op" id="4354315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354320">}</span>&nbsp;<span class="keyword" id="4354322">else</span>&nbsp;<span class="op" id="4354327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4354333">panic</span><span class="op" id="4354338">(</span><span class="string" id="4354339">&#34;internal&nbsp;error&#34;</span><span class="op" id="4354355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354364">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354369"><a href="/crypto/x509/x509.go.html#4354171">oids</a></span>&nbsp;<span class="op" id="4354374">=</span>&nbsp;<span class="builtinfunc" id="4354376">append</span><span class="op" id="4354382">(</span><span class="ident" id="4354383"><a href="/crypto/x509/x509.go.html#4354171">oids</a></span><span class="op" id="4354387">,</span>&nbsp;<span class="ident" id="4354389"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4354397">.</span><span class="ident" id="4354398">UnknownExtKeyUsage</span><span class="op" id="4354416">...</span><span class="op" id="4354419">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354424"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4354427">[</span><span class="ident" id="4354428"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4354429">]</span><span class="op" id="4354430">.</span><span class="ident" id="4354431">Value</span><span class="op" id="4354436">,</span>&nbsp;<span class="ident" id="4354438"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4354442">=</span>&nbsp;<span class="ident" id="4354444"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4354448">.</span><span class="ident" id="4354449">Marshal</span><span class="op" id="4354456">(</span><span class="ident" id="4354457"><a href="/crypto/x509/x509.go.html#4354171">oids</a></span><span class="op" id="4354461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354465">if</span>&nbsp;<span class="ident" id="4354468"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4354472">!=</span>&nbsp;<span class="ident" id="4354475">nil</span>&nbsp;<span class="op" id="4354479">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354484">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354497"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4354498">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354506">if</span>&nbsp;<span class="ident" id="4354509"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4354517">.</span><span class="ident" id="4354518">BasicConstraintsValid</span>&nbsp;<span class="op" id="4354540">&amp;&amp;</span>&nbsp;<span class="op" id="4354543">!</span><span class="ident" id="4354544"><a href="/crypto/x509/x509.go.html#4352404">oidInExtensions</a></span><span class="op" id="4354559">(</span><span class="ident" id="4354560"><a href="/crypto/x509/x509.go.html#4351772">oidExtensionBasicConstraints</a></span><span class="op" id="4354588">,</span>&nbsp;<span class="ident" id="4354590"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4354598">.</span><span class="ident" id="4354599">ExtraExtensions</span><span class="op" id="4354614">)</span>&nbsp;<span class="op" id="4354616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4354620">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4354683">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4354748">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354807">maxPathLen</span>&nbsp;<span class="op" id="4354818">:=</span>&nbsp;<span class="ident" id="4354821"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4354829">.</span><span class="ident" id="4354830">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354843">if</span>&nbsp;<span class="ident" id="4354846"><a href="/crypto/x509/x509.go.html#4354807">maxPathLen</a></span>&nbsp;<span class="op" id="4354857">==</span>&nbsp;<span class="num" id="4354860">0</span>&nbsp;<span class="op" id="4354862">&amp;&amp;</span>&nbsp;<span class="op" id="4354865">!</span><span class="ident" id="4354866"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4354874">.</span><span class="ident" id="4354875">MaxPathLenZero</span>&nbsp;<span class="op" id="4354890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354895"><a href="/crypto/x509/x509.go.html#4354807">maxPathLen</a></span>&nbsp;<span class="op" id="4354906">=</span>&nbsp;<span class="op" id="4354908">-</span><span class="num" id="4354909">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354917"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4354920">[</span><span class="ident" id="4354921"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4354922">]</span><span class="op" id="4354923">.</span><span class="ident" id="4354924">Id</span>&nbsp;<span class="op" id="4354927">=</span>&nbsp;<span class="ident" id="4354929"><a href="/crypto/x509/x509.go.html#4351772">oidExtensionBasicConstraints</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354960"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4354963">[</span><span class="ident" id="4354964"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4354965">]</span><span class="op" id="4354966">.</span><span class="ident" id="4354967">Value</span><span class="op" id="4354972">,</span>&nbsp;<span class="ident" id="4354974"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4354978">=</span>&nbsp;<span class="ident" id="4354980"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4354984">.</span><span class="ident" id="4354985">Marshal</span><span class="op" id="4354992">(</span><span class="ident" id="4354993"><a href="/crypto/x509/x509.go.html#4339362">basicConstraints</a></span><span class="op" id="4355009">{</span><span class="ident" id="4355010"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4355018">.</span><span class="ident" id="4355019">IsCA</span><span class="op" id="4355023">,</span>&nbsp;<span class="ident" id="4355025"><a href="/crypto/x509/x509.go.html#4354807">maxPathLen</a></span><span class="op" id="4355035">}</span><span class="op" id="4355036">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355040"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4355043">[</span><span class="ident" id="4355044"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4355045">]</span><span class="op" id="4355046">.</span><span class="ident" id="4355047">Critical</span>&nbsp;<span class="op" id="4355056">=</span>&nbsp;<span class="ident" id="4355058">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355065">if</span>&nbsp;<span class="ident" id="4355068"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4355072">!=</span>&nbsp;<span class="ident" id="4355075">nil</span>&nbsp;<span class="op" id="4355079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355084">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355097"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4355098">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355106">if</span>&nbsp;<span class="builtinfunc" id="4355109">len</span><span class="op" id="4355112">(</span><span class="ident" id="4355113"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4355121">.</span><span class="ident" id="4355122">SubjectKeyId</span><span class="op" id="4355134">)</span>&nbsp;<span class="op" id="4355136">&gt;</span>&nbsp;<span class="num" id="4355138">0</span>&nbsp;<span class="op" id="4355140">&amp;&amp;</span>&nbsp;<span class="op" id="4355143">!</span><span class="ident" id="4355144"><a href="/crypto/x509/x509.go.html#4352404">oidInExtensions</a></span><span class="op" id="4355159">(</span><span class="ident" id="4355160"><a href="/crypto/x509/x509.go.html#4351544">oidExtensionSubjectKeyId</a></span><span class="op" id="4355184">,</span>&nbsp;<span class="ident" id="4355186"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4355194">.</span><span class="ident" id="4355195">ExtraExtensions</span><span class="op" id="4355210">)</span>&nbsp;<span class="op" id="4355212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355216"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4355219">[</span><span class="ident" id="4355220"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4355221">]</span><span class="op" id="4355222">.</span><span class="ident" id="4355223">Id</span>&nbsp;<span class="op" id="4355226">=</span>&nbsp;<span class="ident" id="4355228"><a href="/crypto/x509/x509.go.html#4351544">oidExtensionSubjectKeyId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355255"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4355258">[</span><span class="ident" id="4355259"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4355260">]</span><span class="op" id="4355261">.</span><span class="ident" id="4355262">Value</span><span class="op" id="4355267">,</span>&nbsp;<span class="ident" id="4355269"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4355273">=</span>&nbsp;<span class="ident" id="4355275"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4355279">.</span><span class="ident" id="4355280">Marshal</span><span class="op" id="4355287">(</span><span class="ident" id="4355288"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4355296">.</span><span class="ident" id="4355297">SubjectKeyId</span><span class="op" id="4355309">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355313">if</span>&nbsp;<span class="ident" id="4355316"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4355320">!=</span>&nbsp;<span class="ident" id="4355323">nil</span>&nbsp;<span class="op" id="4355327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355332">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355345"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4355346">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355350">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355354">if</span>&nbsp;<span class="builtinfunc" id="4355357">len</span><span class="op" id="4355360">(</span><span class="ident" id="4355361"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4355369">.</span><span class="ident" id="4355370">AuthorityKeyId</span><span class="op" id="4355384">)</span>&nbsp;<span class="op" id="4355386">&gt;</span>&nbsp;<span class="num" id="4355388">0</span>&nbsp;<span class="op" id="4355390">&amp;&amp;</span>&nbsp;<span class="op" id="4355393">!</span><span class="ident" id="4355394"><a href="/crypto/x509/x509.go.html#4352404">oidInExtensions</a></span><span class="op" id="4355409">(</span><span class="ident" id="4355410"><a href="/crypto/x509/x509.go.html#4351715">oidExtensionAuthorityKeyId</a></span><span class="op" id="4355436">,</span>&nbsp;<span class="ident" id="4355438"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4355446">.</span><span class="ident" id="4355447">ExtraExtensions</span><span class="op" id="4355462">)</span>&nbsp;<span class="op" id="4355464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355468"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4355471">[</span><span class="ident" id="4355472"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4355473">]</span><span class="op" id="4355474">.</span><span class="ident" id="4355475">Id</span>&nbsp;<span class="op" id="4355478">=</span>&nbsp;<span class="ident" id="4355480"><a href="/crypto/x509/x509.go.html#4351715">oidExtensionAuthorityKeyId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355509"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4355512">[</span><span class="ident" id="4355513"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4355514">]</span><span class="op" id="4355515">.</span><span class="ident" id="4355516">Value</span><span class="op" id="4355521">,</span>&nbsp;<span class="ident" id="4355523"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4355527">=</span>&nbsp;<span class="ident" id="4355529"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4355533">.</span><span class="ident" id="4355534">Marshal</span><span class="op" id="4355541">(</span><span class="ident" id="4355542"><a href="/crypto/x509/x509.go.html#4320263">authKeyId</a></span><span class="op" id="4355551">{</span><span class="ident" id="4355552"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4355560">.</span><span class="ident" id="4355561">AuthorityKeyId</span><span class="op" id="4355575">}</span><span class="op" id="4355576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355580">if</span>&nbsp;<span class="ident" id="4355583"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4355587">!=</span>&nbsp;<span class="ident" id="4355590">nil</span>&nbsp;<span class="op" id="4355594">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355599">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355612"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4355613">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355621">if</span>&nbsp;<span class="op" id="4355624">(</span><span class="builtinfunc" id="4355625">len</span><span class="op" id="4355628">(</span><span class="ident" id="4355629"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4355637">.</span><span class="ident" id="4355638">OCSPServer</span><span class="op" id="4355648">)</span>&nbsp;<span class="op" id="4355650">&gt;</span>&nbsp;<span class="num" id="4355652">0</span>&nbsp;<span class="op" id="4355654">||</span>&nbsp;<span class="builtinfunc" id="4355657">len</span><span class="op" id="4355660">(</span><span class="ident" id="4355661"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4355669">.</span><span class="ident" id="4355670">IssuingCertificateURL</span><span class="op" id="4355691">)</span>&nbsp;<span class="op" id="4355693">&gt;</span>&nbsp;<span class="num" id="4355695">0</span><span class="op" id="4355696">)</span>&nbsp;<span class="op" id="4355698">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355703">!</span><span class="ident" id="4355704"><a href="/crypto/x509/x509.go.html#4352404">oidInExtensions</a></span><span class="op" id="4355719">(</span><span class="ident" id="4355720"><a href="/crypto/x509/x509.go.html#4352057">oidExtensionAuthorityInfoAccess</a></span><span class="op" id="4355751">,</span>&nbsp;<span class="ident" id="4355753"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4355761">.</span><span class="ident" id="4355762">ExtraExtensions</span><span class="op" id="4355777">)</span>&nbsp;<span class="op" id="4355779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355783"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4355786">[</span><span class="ident" id="4355787"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4355788">]</span><span class="op" id="4355789">.</span><span class="ident" id="4355790">Id</span>&nbsp;<span class="op" id="4355793">=</span>&nbsp;<span class="ident" id="4355795"><a href="/crypto/x509/x509.go.html#4352057">oidExtensionAuthorityInfoAccess</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355829">var</span>&nbsp;<span class="ident" id="4355833">aiaValues</span>&nbsp;<span class="op" id="4355843">[</span><span class="op" id="4355844">]</span><span class="ident" id="4355845"><a href="/crypto/x509/x509.go.html#4339844">authorityInfoAccess</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355867">for</span>&nbsp;<span class="ident" id="4355871">_</span><span class="op" id="4355872">,</span>&nbsp;<span class="ident" id="4355874">name</span>&nbsp;<span class="op" id="4355879">:=</span>&nbsp;<span class="keyword" id="4355882">range</span>&nbsp;<span class="ident" id="4355888"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4355896">.</span><span class="ident" id="4355897">OCSPServer</span>&nbsp;<span class="op" id="4355908">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355913"><a href="/crypto/x509/x509.go.html#4355833">aiaValues</a></span>&nbsp;<span class="op" id="4355923">=</span>&nbsp;<span class="builtinfunc" id="4355925">append</span><span class="op" id="4355931">(</span><span class="ident" id="4355932"><a href="/crypto/x509/x509.go.html#4355833">aiaValues</a></span><span class="op" id="4355941">,</span>&nbsp;<span class="ident" id="4355943"><a href="/crypto/x509/x509.go.html#4339844">authorityInfoAccess</a></span><span class="op" id="4355962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355968">Method</span><span class="op" id="4355974">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4355978"><a href="/crypto/x509/x509.go.html#4352136">oidAuthorityInfoAccessOcsp</a></span><span class="op" id="4356004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356010">Location</span><span class="op" id="4356018">:</span>&nbsp;<span class="ident" id="4356020"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4356024">.</span><span class="ident" id="4356025">RawValue</span><span class="op" id="4356033">{</span><span class="ident" id="4356034">Tag</span><span class="op" id="4356037">:</span>&nbsp;<span class="num" id="4356039">6</span><span class="op" id="4356040">,</span>&nbsp;<span class="ident" id="4356042">Class</span><span class="op" id="4356047">:</span>&nbsp;<span class="num" id="4356049">2</span><span class="op" id="4356050">,</span>&nbsp;<span class="ident" id="4356052">Bytes</span><span class="op" id="4356057">:</span>&nbsp;<span class="op" id="4356059">[</span><span class="op" id="4356060">]</span><span class="builtintype" id="4356061">byte</span><span class="op" id="4356065">(</span><span class="ident" id="4356066"><a href="/crypto/x509/x509.go.html#4355874">name</a></span><span class="op" id="4356070">)</span><span class="op" id="4356071">}</span><span class="op" id="4356072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356077">}</span><span class="op" id="4356078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356082">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356086">for</span>&nbsp;<span class="ident" id="4356090">_</span><span class="op" id="4356091">,</span>&nbsp;<span class="ident" id="4356093">name</span>&nbsp;<span class="op" id="4356098">:=</span>&nbsp;<span class="keyword" id="4356101">range</span>&nbsp;<span class="ident" id="4356107"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4356115">.</span><span class="ident" id="4356116">IssuingCertificateURL</span>&nbsp;<span class="op" id="4356138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356143"><a href="/crypto/x509/x509.go.html#4355833">aiaValues</a></span>&nbsp;<span class="op" id="4356153">=</span>&nbsp;<span class="builtinfunc" id="4356155">append</span><span class="op" id="4356161">(</span><span class="ident" id="4356162"><a href="/crypto/x509/x509.go.html#4355833">aiaValues</a></span><span class="op" id="4356171">,</span>&nbsp;<span class="ident" id="4356173"><a href="/crypto/x509/x509.go.html#4339844">authorityInfoAccess</a></span><span class="op" id="4356192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356198">Method</span><span class="op" id="4356204">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4356208"><a href="/crypto/x509/x509.go.html#4352219">oidAuthorityInfoAccessIssuers</a></span><span class="op" id="4356237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356243">Location</span><span class="op" id="4356251">:</span>&nbsp;<span class="ident" id="4356253"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4356257">.</span><span class="ident" id="4356258">RawValue</span><span class="op" id="4356266">{</span><span class="ident" id="4356267">Tag</span><span class="op" id="4356270">:</span>&nbsp;<span class="num" id="4356272">6</span><span class="op" id="4356273">,</span>&nbsp;<span class="ident" id="4356275">Class</span><span class="op" id="4356280">:</span>&nbsp;<span class="num" id="4356282">2</span><span class="op" id="4356283">,</span>&nbsp;<span class="ident" id="4356285">Bytes</span><span class="op" id="4356290">:</span>&nbsp;<span class="op" id="4356292">[</span><span class="op" id="4356293">]</span><span class="builtintype" id="4356294">byte</span><span class="op" id="4356298">(</span><span class="ident" id="4356299"><a href="/crypto/x509/x509.go.html#4356093">name</a></span><span class="op" id="4356303">)</span><span class="op" id="4356304">}</span><span class="op" id="4356305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356310">}</span><span class="op" id="4356311">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356319"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4356322">[</span><span class="ident" id="4356323"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4356324">]</span><span class="op" id="4356325">.</span><span class="ident" id="4356326">Value</span><span class="op" id="4356331">,</span>&nbsp;<span class="ident" id="4356333"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4356337">=</span>&nbsp;<span class="ident" id="4356339"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4356343">.</span><span class="ident" id="4356344">Marshal</span><span class="op" id="4356351">(</span><span class="ident" id="4356352"><a href="/crypto/x509/x509.go.html#4355833">aiaValues</a></span><span class="op" id="4356361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356365">if</span>&nbsp;<span class="ident" id="4356368"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4356372">!=</span>&nbsp;<span class="ident" id="4356375">nil</span>&nbsp;<span class="op" id="4356379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356384">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356393">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356397"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4356398">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356406">if</span>&nbsp;<span class="op" id="4356409">(</span><span class="builtinfunc" id="4356410">len</span><span class="op" id="4356413">(</span><span class="ident" id="4356414"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4356422">.</span><span class="ident" id="4356423">DNSNames</span><span class="op" id="4356431">)</span>&nbsp;<span class="op" id="4356433">&gt;</span>&nbsp;<span class="num" id="4356435">0</span>&nbsp;<span class="op" id="4356437">||</span>&nbsp;<span class="builtinfunc" id="4356440">len</span><span class="op" id="4356443">(</span><span class="ident" id="4356444"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4356452">.</span><span class="ident" id="4356453">EmailAddresses</span><span class="op" id="4356467">)</span>&nbsp;<span class="op" id="4356469">&gt;</span>&nbsp;<span class="num" id="4356471">0</span>&nbsp;<span class="op" id="4356473">||</span>&nbsp;<span class="builtinfunc" id="4356476">len</span><span class="op" id="4356479">(</span><span class="ident" id="4356480"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4356488">.</span><span class="ident" id="4356489">IPAddresses</span><span class="op" id="4356500">)</span>&nbsp;<span class="op" id="4356502">&gt;</span>&nbsp;<span class="num" id="4356504">0</span><span class="op" id="4356505">)</span>&nbsp;<span class="op" id="4356507">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356512">!</span><span class="ident" id="4356513"><a href="/crypto/x509/x509.go.html#4352404">oidInExtensions</a></span><span class="op" id="4356528">(</span><span class="ident" id="4356529"><a href="/crypto/x509/x509.go.html#4351829">oidExtensionSubjectAltName</a></span><span class="op" id="4356555">,</span>&nbsp;<span class="ident" id="4356557"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4356565">.</span><span class="ident" id="4356566">ExtraExtensions</span><span class="op" id="4356581">)</span>&nbsp;<span class="op" id="4356583">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356587"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4356590">[</span><span class="ident" id="4356591"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4356592">]</span><span class="op" id="4356593">.</span><span class="ident" id="4356594">Id</span>&nbsp;<span class="op" id="4356597">=</span>&nbsp;<span class="ident" id="4356599"><a href="/crypto/x509/x509.go.html#4351829">oidExtensionSubjectAltName</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356628"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4356631">[</span><span class="ident" id="4356632"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4356633">]</span><span class="op" id="4356634">.</span><span class="ident" id="4356635">Value</span><span class="op" id="4356640">,</span>&nbsp;<span class="ident" id="4356642"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4356646">=</span>&nbsp;<span class="ident" id="4356648"><a href="/crypto/x509/x509.go.html#4352695">marshalSANs</a></span><span class="op" id="4356659">(</span><span class="ident" id="4356660"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4356668">.</span><span class="ident" id="4356669">DNSNames</span><span class="op" id="4356677">,</span>&nbsp;<span class="ident" id="4356679"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4356687">.</span><span class="ident" id="4356688">EmailAddresses</span><span class="op" id="4356702">,</span>&nbsp;<span class="ident" id="4356704"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4356712">.</span><span class="ident" id="4356713">IPAddresses</span><span class="op" id="4356724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356728">if</span>&nbsp;<span class="ident" id="4356731"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4356735">!=</span>&nbsp;<span class="ident" id="4356738">nil</span>&nbsp;<span class="op" id="4356742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356747">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356756">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356760"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4356761">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356769">if</span>&nbsp;<span class="builtinfunc" id="4356772">len</span><span class="op" id="4356775">(</span><span class="ident" id="4356776"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4356784">.</span><span class="ident" id="4356785">PolicyIdentifiers</span><span class="op" id="4356802">)</span>&nbsp;<span class="op" id="4356804">&gt;</span>&nbsp;<span class="num" id="4356806">0</span>&nbsp;<span class="op" id="4356808">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356813">!</span><span class="ident" id="4356814"><a href="/crypto/x509/x509.go.html#4352404">oidInExtensions</a></span><span class="op" id="4356829">(</span><span class="ident" id="4356830"><a href="/crypto/x509/x509.go.html#4351886">oidExtensionCertificatePolicies</a></span><span class="op" id="4356861">,</span>&nbsp;<span class="ident" id="4356863"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4356871">.</span><span class="ident" id="4356872">ExtraExtensions</span><span class="op" id="4356887">)</span>&nbsp;<span class="op" id="4356889">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356893"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4356896">[</span><span class="ident" id="4356897"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4356898">]</span><span class="op" id="4356899">.</span><span class="ident" id="4356900">Id</span>&nbsp;<span class="op" id="4356903">=</span>&nbsp;<span class="ident" id="4356905"><a href="/crypto/x509/x509.go.html#4351886">oidExtensionCertificatePolicies</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356939">policies</span>&nbsp;<span class="op" id="4356948">:=</span>&nbsp;<span class="builtinfunc" id="4356951">make</span><span class="op" id="4356955">(</span><span class="op" id="4356956">[</span><span class="op" id="4356957">]</span><span class="ident" id="4356958"><a href="/crypto/x509/x509.go.html#4339497">policyInformation</a></span><span class="op" id="4356975">,</span>&nbsp;<span class="builtinfunc" id="4356977">len</span><span class="op" id="4356980">(</span><span class="ident" id="4356981"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4356989">.</span><span class="ident" id="4356990">PolicyIdentifiers</span><span class="op" id="4357007">)</span><span class="op" id="4357008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357012">for</span>&nbsp;<span class="ident" id="4357016">i</span><span class="op" id="4357017">,</span>&nbsp;<span class="ident" id="4357019">policy</span>&nbsp;<span class="op" id="4357026">:=</span>&nbsp;<span class="keyword" id="4357029">range</span>&nbsp;<span class="ident" id="4357035"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4357043">.</span><span class="ident" id="4357044">PolicyIdentifiers</span>&nbsp;<span class="op" id="4357062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357067"><a href="/crypto/x509/x509.go.html#4356939">policies</a></span><span class="op" id="4357075">[</span><span class="ident" id="4357076"><a href="/crypto/x509/x509.go.html#4357016">i</a></span><span class="op" id="4357077">]</span><span class="op" id="4357078">.</span><span class="ident" id="4357079">Policy</span>&nbsp;<span class="op" id="4357086">=</span>&nbsp;<span class="ident" id="4357088"><a href="/crypto/x509/x509.go.html#4357019">policy</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357097">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357101"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4357104">[</span><span class="ident" id="4357105"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4357106">]</span><span class="op" id="4357107">.</span><span class="ident" id="4357108">Value</span><span class="op" id="4357113">,</span>&nbsp;<span class="ident" id="4357115"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4357119">=</span>&nbsp;<span class="ident" id="4357121"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4357125">.</span><span class="ident" id="4357126">Marshal</span><span class="op" id="4357133">(</span><span class="ident" id="4357134"><a href="/crypto/x509/x509.go.html#4356939">policies</a></span><span class="op" id="4357142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357146">if</span>&nbsp;<span class="ident" id="4357149"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4357153">!=</span>&nbsp;<span class="ident" id="4357156">nil</span>&nbsp;<span class="op" id="4357160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357165">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357178"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4357179">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357187">if</span>&nbsp;<span class="builtinfunc" id="4357190">len</span><span class="op" id="4357193">(</span><span class="ident" id="4357194"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4357202">.</span><span class="ident" id="4357203">PermittedDNSDomains</span><span class="op" id="4357222">)</span>&nbsp;<span class="op" id="4357224">&gt;</span>&nbsp;<span class="num" id="4357226">0</span>&nbsp;<span class="op" id="4357228">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357233">!</span><span class="ident" id="4357234"><a href="/crypto/x509/x509.go.html#4352404">oidInExtensions</a></span><span class="op" id="4357249">(</span><span class="ident" id="4357250"><a href="/crypto/x509/x509.go.html#4351943">oidExtensionNameConstraints</a></span><span class="op" id="4357277">,</span>&nbsp;<span class="ident" id="4357279"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4357287">.</span><span class="ident" id="4357288">ExtraExtensions</span><span class="op" id="4357303">)</span>&nbsp;<span class="op" id="4357305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357309"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4357312">[</span><span class="ident" id="4357313"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4357314">]</span><span class="op" id="4357315">.</span><span class="ident" id="4357316">Id</span>&nbsp;<span class="op" id="4357319">=</span>&nbsp;<span class="ident" id="4357321"><a href="/crypto/x509/x509.go.html#4351943">oidExtensionNameConstraints</a></span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357351"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4357354">[</span><span class="ident" id="4357355"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4357356">]</span><span class="op" id="4357357">.</span><span class="ident" id="4357358">Critical</span>&nbsp;<span class="op" id="4357367">=</span>&nbsp;<span class="ident" id="4357369"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4357377">.</span><span class="ident" id="4357378">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357409">var</span>&nbsp;<span class="ident" id="4357413">out</span>&nbsp;<span class="ident" id="4357417"><a href="/crypto/x509/x509.go.html#4339613">nameConstraints</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357435"><a href="/crypto/x509/x509.go.html#4357413">out</a></span><span class="op" id="4357438">.</span><span class="ident" id="4357439">Permitted</span>&nbsp;<span class="op" id="4357449">=</span>&nbsp;<span class="builtinfunc" id="4357451">make</span><span class="op" id="4357455">(</span><span class="op" id="4357456">[</span><span class="op" id="4357457">]</span><span class="ident" id="4357458"><a href="/crypto/x509/x509.go.html#4339750">generalSubtree</a></span><span class="op" id="4357472">,</span>&nbsp;<span class="builtinfunc" id="4357474">len</span><span class="op" id="4357477">(</span><span class="ident" id="4357478"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4357486">.</span><span class="ident" id="4357487">PermittedDNSDomains</span><span class="op" id="4357506">)</span><span class="op" id="4357507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357511">for</span>&nbsp;<span class="ident" id="4357515">i</span><span class="op" id="4357516">,</span>&nbsp;<span class="ident" id="4357518">permitted</span>&nbsp;<span class="op" id="4357528">:=</span>&nbsp;<span class="keyword" id="4357531">range</span>&nbsp;<span class="ident" id="4357537"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4357545">.</span><span class="ident" id="4357546">PermittedDNSDomains</span>&nbsp;<span class="op" id="4357566">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357571"><a href="/crypto/x509/x509.go.html#4357413">out</a></span><span class="op" id="4357574">.</span><span class="ident" id="4357575">Permitted</span><span class="op" id="4357584">[</span><span class="ident" id="4357585"><a href="/crypto/x509/x509.go.html#4357515">i</a></span><span class="op" id="4357586">]</span>&nbsp;<span class="op" id="4357588">=</span>&nbsp;<span class="ident" id="4357590"><a href="/crypto/x509/x509.go.html#4339750">generalSubtree</a></span><span class="op" id="4357604">{</span><span class="ident" id="4357605">Name</span><span class="op" id="4357609">:</span>&nbsp;<span class="ident" id="4357611"><a href="/crypto/x509/x509.go.html#4357518">permitted</a></span><span class="op" id="4357620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357628"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4357631">[</span><span class="ident" id="4357632"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4357633">]</span><span class="op" id="4357634">.</span><span class="ident" id="4357635">Value</span><span class="op" id="4357640">,</span>&nbsp;<span class="ident" id="4357642"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4357646">=</span>&nbsp;<span class="ident" id="4357648"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4357652">.</span><span class="ident" id="4357653">Marshal</span><span class="op" id="4357660">(</span><span class="ident" id="4357661"><a href="/crypto/x509/x509.go.html#4357413">out</a></span><span class="op" id="4357664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357668">if</span>&nbsp;<span class="ident" id="4357671"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4357675">!=</span>&nbsp;<span class="ident" id="4357678">nil</span>&nbsp;<span class="op" id="4357682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357687">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357700"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4357701">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357709">if</span>&nbsp;<span class="builtinfunc" id="4357712">len</span><span class="op" id="4357715">(</span><span class="ident" id="4357716"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4357724">.</span><span class="ident" id="4357725">CRLDistributionPoints</span><span class="op" id="4357746">)</span>&nbsp;<span class="op" id="4357748">&gt;</span>&nbsp;<span class="num" id="4357750">0</span>&nbsp;<span class="op" id="4357752">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357757">!</span><span class="ident" id="4357758"><a href="/crypto/x509/x509.go.html#4352404">oidInExtensions</a></span><span class="op" id="4357773">(</span><span class="ident" id="4357774"><a href="/crypto/x509/x509.go.html#4352000">oidExtensionCRLDistributionPoints</a></span><span class="op" id="4357807">,</span>&nbsp;<span class="ident" id="4357809"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4357817">.</span><span class="ident" id="4357818">ExtraExtensions</span><span class="op" id="4357833">)</span>&nbsp;<span class="op" id="4357835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357839"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4357842">[</span><span class="ident" id="4357843"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4357844">]</span><span class="op" id="4357845">.</span><span class="ident" id="4357846">Id</span>&nbsp;<span class="op" id="4357849">=</span>&nbsp;<span class="ident" id="4357851"><a href="/crypto/x509/x509.go.html#4352000">oidExtensionCRLDistributionPoints</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357888">var</span>&nbsp;<span class="ident" id="4357892">crlDp</span>&nbsp;<span class="op" id="4357898">[</span><span class="op" id="4357899">]</span><span class="ident" id="4357900"><a href="/crypto/x509/x509.go.html#4339959">distributionPoint</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357920">for</span>&nbsp;<span class="ident" id="4357924">_</span><span class="op" id="4357925">,</span>&nbsp;<span class="ident" id="4357927">name</span>&nbsp;<span class="op" id="4357932">:=</span>&nbsp;<span class="keyword" id="4357935">range</span>&nbsp;<span class="ident" id="4357941"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4357949">.</span><span class="ident" id="4357950">CRLDistributionPoints</span>&nbsp;<span class="op" id="4357972">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357977">rawFullName</span><span class="op" id="4357988">,</span>&nbsp;<span class="ident" id="4357990">_</span>&nbsp;<span class="op" id="4357992">:=</span>&nbsp;<span class="ident" id="4357995"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4357999">.</span><span class="ident" id="4358000">Marshal</span><span class="op" id="4358007">(</span><span class="ident" id="4358008"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4358012">.</span><span class="ident" id="4358013">RawValue</span><span class="op" id="4358021">{</span><span class="ident" id="4358022">Tag</span><span class="op" id="4358025">:</span>&nbsp;<span class="num" id="4358027">6</span><span class="op" id="4358028">,</span>&nbsp;<span class="ident" id="4358030">Class</span><span class="op" id="4358035">:</span>&nbsp;<span class="num" id="4358037">2</span><span class="op" id="4358038">,</span>&nbsp;<span class="ident" id="4358040">Bytes</span><span class="op" id="4358045">:</span>&nbsp;<span class="op" id="4358047">[</span><span class="op" id="4358048">]</span><span class="builtintype" id="4358049">byte</span><span class="op" id="4358053">(</span><span class="ident" id="4358054"><a href="/crypto/x509/x509.go.html#4357927">name</a></span><span class="op" id="4358058">)</span><span class="op" id="4358059">}</span><span class="op" id="4358060">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358066">dp</span>&nbsp;<span class="op" id="4358069">:=</span>&nbsp;<span class="ident" id="4358072"><a href="/crypto/x509/x509.go.html#4339959">distributionPoint</a></span><span class="op" id="4358089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358095">DistributionPoint</span><span class="op" id="4358112">:</span>&nbsp;<span class="ident" id="4358114"><a href="/crypto/x509/x509.go.html#4340189">distributionPointName</a></span><span class="op" id="4358135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358142">FullName</span><span class="op" id="4358150">:</span>&nbsp;<span class="ident" id="4358152"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4358156">.</span><span class="ident" id="4358157">RawValue</span><span class="op" id="4358165">{</span><span class="ident" id="4358166">Tag</span><span class="op" id="4358169">:</span>&nbsp;<span class="num" id="4358171">0</span><span class="op" id="4358172">,</span>&nbsp;<span class="ident" id="4358174">Class</span><span class="op" id="4358179">:</span>&nbsp;<span class="num" id="4358181">2</span><span class="op" id="4358182">,</span>&nbsp;<span class="ident" id="4358184">IsCompound</span><span class="op" id="4358194">:</span>&nbsp;<span class="ident" id="4358196">true</span><span class="op" id="4358200">,</span>&nbsp;<span class="ident" id="4358202">Bytes</span><span class="op" id="4358207">:</span>&nbsp;<span class="ident" id="4358209"><a href="/crypto/x509/x509.go.html#4357977">rawFullName</a></span><span class="op" id="4358220">}</span><span class="op" id="4358221">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358227">}</span><span class="op" id="4358228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358238"><a href="/crypto/x509/x509.go.html#4357892">crlDp</a></span>&nbsp;<span class="op" id="4358244">=</span>&nbsp;<span class="builtinfunc" id="4358246">append</span><span class="op" id="4358252">(</span><span class="ident" id="4358253"><a href="/crypto/x509/x509.go.html#4357892">crlDp</a></span><span class="op" id="4358258">,</span>&nbsp;<span class="ident" id="4358260"><a href="/crypto/x509/x509.go.html#4358066">dp</a></span><span class="op" id="4358262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358271"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4358274">[</span><span class="ident" id="4358275"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4358276">]</span><span class="op" id="4358277">.</span><span class="ident" id="4358278">Value</span><span class="op" id="4358283">,</span>&nbsp;<span class="ident" id="4358285"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4358289">=</span>&nbsp;<span class="ident" id="4358291"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4358295">.</span><span class="ident" id="4358296">Marshal</span><span class="op" id="4358303">(</span><span class="ident" id="4358304"><a href="/crypto/x509/x509.go.html#4357892">crlDp</a></span><span class="op" id="4358309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358313">if</span>&nbsp;<span class="ident" id="4358316"><a href="/crypto/x509/x509.go.html#4353421">err</a></span>&nbsp;<span class="op" id="4358320">!=</span>&nbsp;<span class="ident" id="4358323">nil</span>&nbsp;<span class="op" id="4358327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358332">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358345"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4358346">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4358354">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4358427">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358486">return</span>&nbsp;<span class="builtinfunc" id="4358493">append</span><span class="op" id="4358499">(</span><span class="ident" id="4358500"><a href="/crypto/x509/x509.go.html#4353399">ret</a></span><span class="op" id="4358503">[</span><span class="op" id="4358504">:</span><span class="ident" id="4358505"><a href="/crypto/x509/x509.go.html#4353503">n</a></span><span class="op" id="4358506">]</span><span class="op" id="4358507">,</span>&nbsp;<span class="ident" id="4358509"><a href="/crypto/x509/x509.go.html#4353375">template</a></span><span class="op" id="4358517">.</span><span class="ident" id="4358518">ExtraExtensions</span><span class="op" id="4358533">...</span><span class="op" id="4358536">)</span><span class="op" id="4358537">,</span>&nbsp;<span class="ident" id="4358539">nil</span><br>
<span class="lineno"></span><span class="op" id="4358543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4358546">func</span>&nbsp;<span class="ident" id="4358551">subjectBytes</span><span class="op" id="4358563">(</span><span class="ident" id="4358564">cert</span>&nbsp;<span class="op" id="4358569">*</span><span class="ident" id="4358570"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4358581">)</span>&nbsp;<span class="op" id="4358583">(</span><span class="op" id="4358584">[</span><span class="op" id="4358585">]</span><span class="builtintype" id="4358586">byte</span><span class="op" id="4358590">,</span>&nbsp;<span class="builtintype" id="4358592">error</span><span class="op" id="4358597">)</span>&nbsp;<span class="op" id="4358599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358602">if</span>&nbsp;<span class="builtinfunc" id="4358605">len</span><span class="op" id="4358608">(</span><span class="ident" id="4358609"><a href="/crypto/x509/x509.go.html#4358564">cert</a></span><span class="op" id="4358613">.</span><span class="ident" id="4358614">RawSubject</span><span class="op" id="4358624">)</span>&nbsp;<span class="op" id="4358626">&gt;</span>&nbsp;<span class="num" id="4358628">0</span>&nbsp;<span class="op" id="4358630">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358634">return</span>&nbsp;<span class="ident" id="4358641"><a href="/crypto/x509/x509.go.html#4358564">cert</a></span><span class="op" id="4358645">.</span><span class="ident" id="4358646">RawSubject</span><span class="op" id="4358656">,</span>&nbsp;<span class="ident" id="4358658">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358667">return</span>&nbsp;<span class="ident" id="4358674"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4358678">.</span><span class="ident" id="4358679">Marshal</span><span class="op" id="4358686">(</span><span class="ident" id="4358687"><a href="/crypto/x509/x509.go.html#4358564">cert</a></span><span class="op" id="4358691">.</span><span class="ident" id="4358692">Subject</span><span class="op" id="4358699">.</span><span class="ident" id="4358700">ToRDNSequence</span><span class="op" id="4358713">(</span><span class="op" id="4358714">)</span><span class="op" id="4358715">)</span><br>
<span class="lineno"></span><span class="op" id="4358717">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="4358720">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4358797">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4358868">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4358892">func</span>&nbsp;<span class="ident" id="4358897">signingParamsForPrivateKey</span><span class="op" id="4358923">(</span><span class="ident" id="4358924">priv</span>&nbsp;<span class="keyword" id="4358929">interface</span><span class="op" id="4358938">{</span><span class="op" id="4358939">}</span><span class="op" id="4358940">,</span>&nbsp;<span class="ident" id="4358942">requestedSigAlgo</span>&nbsp;<span class="ident" id="4358959"><a href="/crypto/x509/x509.go.html#4320325">SignatureAlgorithm</a></span><span class="op" id="4358977">)</span>&nbsp;<span class="op" id="4358979">(</span><span class="ident" id="4358980">hashFunc</span>&nbsp;<span class="ident" id="4358989"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4358995">.</span><span class="ident" id="4358996">Hash</span><span class="op" id="4359000">,</span>&nbsp;<span class="ident" id="4359002">sigAlgo</span>&nbsp;<span class="ident" id="4359010"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4359014">.</span><span class="ident" id="4359015">AlgorithmIdentifier</span><span class="op" id="4359034">,</span>&nbsp;<span class="ident" id="4359036">err</span>&nbsp;<span class="builtintype" id="4359040">error</span><span class="op" id="4359045">)</span>&nbsp;<span class="op" id="4359047">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359050">var</span>&nbsp;<span class="ident" id="4359054">pubType</span>&nbsp;<span class="ident" id="4359062"><a href="/crypto/x509/x509.go.html#4320594">PublicKeyAlgorithm</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359083">switch</span>&nbsp;<span class="ident" id="4359090">priv</span>&nbsp;<span class="op" id="4359095">:=</span>&nbsp;<span class="ident" id="4359098"><a href="/crypto/x509/x509.go.html#4358924">priv</a></span><span class="op" id="4359102">.</span><span class="op" id="4359103">(</span><span class="keyword" id="4359104">type</span><span class="op" id="4359108">)</span>&nbsp;<span class="op" id="4359110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359113">case</span>&nbsp;<span class="op" id="4359118">*</span><span class="ident" id="4359119"><a href="/crypto/x509/x509.go.html#4316595">rsa</a></span><span class="op" id="4359122">.</span><span class="ident" id="4359123">PrivateKey</span><span class="op" id="4359133">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359137"><a href="/crypto/x509/x509.go.html#4359054">pubType</a></span>&nbsp;<span class="op" id="4359145">=</span>&nbsp;<span class="ident" id="4359147"><a href="/crypto/x509/x509.go.html#4320680">RSA</a></span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359153"><a href="/crypto/x509/x509.go.html#4359002">sigAlgo</a></span><span class="op" id="4359160">.</span><span class="ident" id="4359161">Algorithm</span>&nbsp;<span class="op" id="4359171">=</span>&nbsp;<span class="ident" id="4359173"><a href="/crypto/x509/x509.go.html#4322521">oidSignatureSHA256WithRSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359201"><a href="/crypto/x509/x509.go.html#4358980">hashFunc</a></span>&nbsp;<span class="op" id="4359210">=</span>&nbsp;<span class="ident" id="4359212"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4359218">.</span><span class="ident" id="4359219">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359228">case</span>&nbsp;<span class="op" id="4359233">*</span><span class="ident" id="4359234"><a href="/crypto/x509/x509.go.html#4316560">ecdsa</a></span><span class="op" id="4359239">.</span><span class="ident" id="4359240">PrivateKey</span><span class="op" id="4359250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359254"><a href="/crypto/x509/x509.go.html#4359054">pubType</a></span>&nbsp;<span class="op" id="4359262">=</span>&nbsp;<span class="ident" id="4359264"><a href="/crypto/x509/x509.go.html#4320690">ECDSA</a></span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359273">switch</span>&nbsp;<span class="ident" id="4359280"><a href="/crypto/x509/x509.go.html#4359090">priv</a></span><span class="op" id="4359284">.</span><span class="ident" id="4359285">Curve</span>&nbsp;<span class="op" id="4359291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359295">case</span>&nbsp;<span class="ident" id="4359300"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4359308">.</span><span class="ident" id="4359309">P224</span><span class="op" id="4359313">(</span><span class="op" id="4359314">)</span><span class="op" id="4359315">,</span>&nbsp;<span class="ident" id="4359317"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4359325">.</span><span class="ident" id="4359326">P256</span><span class="op" id="4359330">(</span><span class="op" id="4359331">)</span><span class="op" id="4359332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359337"><a href="/crypto/x509/x509.go.html#4358980">hashFunc</a></span>&nbsp;<span class="op" id="4359346">=</span>&nbsp;<span class="ident" id="4359348"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4359354">.</span><span class="ident" id="4359355">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359365"><a href="/crypto/x509/x509.go.html#4359002">sigAlgo</a></span><span class="op" id="4359372">.</span><span class="ident" id="4359373">Algorithm</span>&nbsp;<span class="op" id="4359383">=</span>&nbsp;<span class="ident" id="4359385"><a href="/crypto/x509/x509.go.html#4323003">oidSignatureECDSAWithSHA256</a></span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359415">case</span>&nbsp;<span class="ident" id="4359420"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4359428">.</span><span class="ident" id="4359429">P384</span><span class="op" id="4359433">(</span><span class="op" id="4359434">)</span><span class="op" id="4359435">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359440"><a href="/crypto/x509/x509.go.html#4358980">hashFunc</a></span>&nbsp;<span class="op" id="4359449">=</span>&nbsp;<span class="ident" id="4359451"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4359457">.</span><span class="ident" id="4359458">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359468"><a href="/crypto/x509/x509.go.html#4359002">sigAlgo</a></span><span class="op" id="4359475">.</span><span class="ident" id="4359476">Algorithm</span>&nbsp;<span class="op" id="4359486">=</span>&nbsp;<span class="ident" id="4359488"><a href="/crypto/x509/x509.go.html#4323083">oidSignatureECDSAWithSHA384</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359518">case</span>&nbsp;<span class="ident" id="4359523"><a href="/crypto/x509/x509.go.html#4316576">elliptic</a></span><span class="op" id="4359531">.</span><span class="ident" id="4359532">P521</span><span class="op" id="4359536">(</span><span class="op" id="4359537">)</span><span class="op" id="4359538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359543"><a href="/crypto/x509/x509.go.html#4358980">hashFunc</a></span>&nbsp;<span class="op" id="4359552">=</span>&nbsp;<span class="ident" id="4359554"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4359560">.</span><span class="ident" id="4359561">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359571"><a href="/crypto/x509/x509.go.html#4359002">sigAlgo</a></span><span class="op" id="4359578">.</span><span class="ident" id="4359579">Algorithm</span>&nbsp;<span class="op" id="4359589">=</span>&nbsp;<span class="ident" id="4359591"><a href="/crypto/x509/x509.go.html#4323163">oidSignatureECDSAWithSHA512</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359621">default</span><span class="op" id="4359628">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359633"><a href="/crypto/x509/x509.go.html#4359036">err</a></span>&nbsp;<span class="op" id="4359637">=</span>&nbsp;<span class="ident" id="4359639"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4359645">.</span><span class="ident" id="4359646">New</span><span class="op" id="4359649">(</span><span class="string" id="4359650">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4359680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4359684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359688">default</span><span class="op" id="4359695">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359699"><a href="/crypto/x509/x509.go.html#4359036">err</a></span>&nbsp;<span class="op" id="4359703">=</span>&nbsp;<span class="ident" id="4359705"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4359711">.</span><span class="ident" id="4359712">New</span><span class="op" id="4359715">(</span><span class="string" id="4359716">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4359765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4359768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359772">if</span>&nbsp;<span class="ident" id="4359775"><a href="/crypto/x509/x509.go.html#4359036">err</a></span>&nbsp;<span class="op" id="4359779">!=</span>&nbsp;<span class="ident" id="4359782">nil</span>&nbsp;<span class="op" id="4359786">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359790">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4359798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359802">if</span>&nbsp;<span class="ident" id="4359805"><a href="/crypto/x509/x509.go.html#4358942">requestedSigAlgo</a></span>&nbsp;<span class="op" id="4359822">==</span>&nbsp;<span class="num" id="4359825">0</span>&nbsp;<span class="op" id="4359827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359831">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4359839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359843">found</span>&nbsp;<span class="op" id="4359849">:=</span>&nbsp;<span class="ident" id="4359852">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359859">for</span>&nbsp;<span class="ident" id="4359863">_</span><span class="op" id="4359864">,</span>&nbsp;<span class="ident" id="4359866">details</span>&nbsp;<span class="op" id="4359874">:=</span>&nbsp;<span class="keyword" id="4359877">range</span>&nbsp;<span class="ident" id="4359883"><a href="/crypto/x509/x509.go.html#4323249">signatureAlgorithmDetails</a></span>&nbsp;<span class="op" id="4359909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359913">if</span>&nbsp;<span class="ident" id="4359916"><a href="/crypto/x509/x509.go.html#4359866">details</a></span><span class="op" id="4359923">.</span><span class="ident" id="4359924">algo</span>&nbsp;<span class="op" id="4359929">==</span>&nbsp;<span class="ident" id="4359932"><a href="/crypto/x509/x509.go.html#4358942">requestedSigAlgo</a></span>&nbsp;<span class="op" id="4359949">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359954">if</span>&nbsp;<span class="ident" id="4359957"><a href="/crypto/x509/x509.go.html#4359866">details</a></span><span class="op" id="4359964">.</span><span class="ident" id="4359965">pubKeyAlgo</span>&nbsp;<span class="op" id="4359976">!=</span>&nbsp;<span class="ident" id="4359979"><a href="/crypto/x509/x509.go.html#4359054">pubType</a></span>&nbsp;<span class="op" id="4359987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359993"><a href="/crypto/x509/x509.go.html#4359036">err</a></span>&nbsp;<span class="op" id="4359997">=</span>&nbsp;<span class="ident" id="4359999"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4360005">.</span><span class="ident" id="4360006">New</span><span class="op" id="4360009">(</span><span class="string" id="4360010">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="4360078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360084">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360099"><a href="/crypto/x509/x509.go.html#4359002">sigAlgo</a></span><span class="op" id="4360106">.</span><span class="ident" id="4360107">Algorithm</span><span class="op" id="4360116">,</span>&nbsp;<span class="ident" id="4360118"><a href="/crypto/x509/x509.go.html#4358980">hashFunc</a></span>&nbsp;<span class="op" id="4360127">=</span>&nbsp;<span class="ident" id="4360129"><a href="/crypto/x509/x509.go.html#4359866">details</a></span><span class="op" id="4360136">.</span><span class="ident" id="4360137">oid</span><span class="op" id="4360140">,</span>&nbsp;<span class="ident" id="4360142"><a href="/crypto/x509/x509.go.html#4359866">details</a></span><span class="op" id="4360149">.</span><span class="ident" id="4360150">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360158">if</span>&nbsp;<span class="ident" id="4360161"><a href="/crypto/x509/x509.go.html#4358980">hashFunc</a></span>&nbsp;<span class="op" id="4360170">==</span>&nbsp;<span class="num" id="4360173">0</span>&nbsp;<span class="op" id="4360175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360181"><a href="/crypto/x509/x509.go.html#4359036">err</a></span>&nbsp;<span class="op" id="4360185">=</span>&nbsp;<span class="ident" id="4360187"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4360193">.</span><span class="ident" id="4360194">New</span><span class="op" id="4360197">(</span><span class="string" id="4360198">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="4360246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360252">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360267"><a href="/crypto/x509/x509.go.html#4359843">found</a></span>&nbsp;<span class="op" id="4360273">=</span>&nbsp;<span class="ident" id="4360275">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360283">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360298">if</span>&nbsp;<span class="op" id="4360301">!</span><span class="ident" id="4360302"><a href="/crypto/x509/x509.go.html#4359843">found</a></span>&nbsp;<span class="op" id="4360308">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360312"><a href="/crypto/x509/x509.go.html#4359036">err</a></span>&nbsp;<span class="op" id="4360316">=</span>&nbsp;<span class="ident" id="4360318"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4360324">.</span><span class="ident" id="4360325">New</span><span class="op" id="4360328">(</span><span class="string" id="4360329">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="4360363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360370">return</span><br>
<span class="lineno"></span><span class="op" id="4360377">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="4360380">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4360452">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="4360529">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="4360608">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="4360682">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="4360726">//</span><br>
<span class="lineno"></span><span class="comment" id="4360729">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4360809">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4360883">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="4360936">//</span><br>
<span class="lineno"></span><span class="comment" id="4360939">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4360997">//</span><br>
<span class="lineno"></span><span class="comment" id="4361000">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4361069">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="4361146">func</span>&nbsp;<span class="ident" id="4361151">CreateCertificate</span><span class="op" id="4361168">(</span><span class="ident" id="4361169">rand</span>&nbsp;<span class="ident" id="4361174"><a href="/crypto/x509/x509.go.html#4316725">io</a></span><span class="op" id="4361176">.</span><span class="ident" id="4361177">Reader</span><span class="op" id="4361183">,</span>&nbsp;<span class="ident" id="4361185">template</span><span class="op" id="4361193">,</span>&nbsp;<span class="ident" id="4361195">parent</span>&nbsp;<span class="op" id="4361202">*</span><span class="ident" id="4361203"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4361214">,</span>&nbsp;<span class="ident" id="4361216">pub</span>&nbsp;<span class="keyword" id="4361220">interface</span><span class="op" id="4361229">{</span><span class="op" id="4361230">}</span><span class="op" id="4361231">,</span>&nbsp;<span class="ident" id="4361233">priv</span>&nbsp;<span class="keyword" id="4361238">interface</span><span class="op" id="4361247">{</span><span class="op" id="4361248">}</span><span class="op" id="4361249">)</span>&nbsp;<span class="op" id="4361251">(</span><span class="ident" id="4361252">cert</span>&nbsp;<span class="op" id="4361257">[</span><span class="op" id="4361258">]</span><span class="builtintype" id="4361259">byte</span><span class="op" id="4361263">,</span>&nbsp;<span class="ident" id="4361265">err</span>&nbsp;<span class="builtintype" id="4361269">error</span><span class="op" id="4361274">)</span>&nbsp;<span class="op" id="4361276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361279">hashFunc</span><span class="op" id="4361287">,</span>&nbsp;<span class="ident" id="4361289">signatureAlgorithm</span><span class="op" id="4361307">,</span>&nbsp;<span class="ident" id="4361309"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4361313">:=</span>&nbsp;<span class="ident" id="4361316"><a href="/crypto/x509/x509.go.html#4358897">signingParamsForPrivateKey</a></span><span class="op" id="4361342">(</span><span class="ident" id="4361343"><a href="/crypto/x509/x509.go.html#4361233">priv</a></span><span class="op" id="4361347">,</span>&nbsp;<span class="ident" id="4361349"><a href="/crypto/x509/x509.go.html#4361185">template</a></span><span class="op" id="4361357">.</span><span class="ident" id="4361358">SignatureAlgorithm</span><span class="op" id="4361376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361379">if</span>&nbsp;<span class="ident" id="4361382"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4361386">!=</span>&nbsp;<span class="ident" id="4361389">nil</span>&nbsp;<span class="op" id="4361393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361397">return</span>&nbsp;<span class="ident" id="4361404">nil</span><span class="op" id="4361407">,</span>&nbsp;<span class="ident" id="4361409"><a href="/crypto/x509/x509.go.html#4361265">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361414">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361418">publicKeyBytes</span><span class="op" id="4361432">,</span>&nbsp;<span class="ident" id="4361434">publicKeyAlgorithm</span><span class="op" id="4361452">,</span>&nbsp;<span class="ident" id="4361454"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4361458">:=</span>&nbsp;<span class="ident" id="4361461"><a href="/crypto/x509/x509.go.html#4317467">marshalPublicKey</a></span><span class="op" id="4361477">(</span><span class="ident" id="4361478"><a href="/crypto/x509/x509.go.html#4361216">pub</a></span><span class="op" id="4361481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361484">if</span>&nbsp;<span class="ident" id="4361487"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4361491">!=</span>&nbsp;<span class="ident" id="4361494">nil</span>&nbsp;<span class="op" id="4361498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361502">return</span>&nbsp;<span class="ident" id="4361509">nil</span><span class="op" id="4361512">,</span>&nbsp;<span class="ident" id="4361514"><a href="/crypto/x509/x509.go.html#4361265">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361519">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361523">if</span>&nbsp;<span class="ident" id="4361526"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4361530">!=</span>&nbsp;<span class="ident" id="4361533">nil</span>&nbsp;<span class="op" id="4361537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361541">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361553">if</span>&nbsp;<span class="builtinfunc" id="4361556">len</span><span class="op" id="4361559">(</span><span class="ident" id="4361560"><a href="/crypto/x509/x509.go.html#4361195">parent</a></span><span class="op" id="4361566">.</span><span class="ident" id="4361567">SubjectKeyId</span><span class="op" id="4361579">)</span>&nbsp;<span class="op" id="4361581">&gt;</span>&nbsp;<span class="num" id="4361583">0</span>&nbsp;<span class="op" id="4361585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361589"><a href="/crypto/x509/x509.go.html#4361185">template</a></span><span class="op" id="4361597">.</span><span class="ident" id="4361598">AuthorityKeyId</span>&nbsp;<span class="op" id="4361613">=</span>&nbsp;<span class="ident" id="4361615"><a href="/crypto/x509/x509.go.html#4361195">parent</a></span><span class="op" id="4361621">.</span><span class="ident" id="4361622">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361640">extensions</span><span class="op" id="4361650">,</span>&nbsp;<span class="ident" id="4361652"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4361656">:=</span>&nbsp;<span class="ident" id="4361659"><a href="/crypto/x509/x509.go.html#4353359">buildExtensions</a></span><span class="op" id="4361674">(</span><span class="ident" id="4361675"><a href="/crypto/x509/x509.go.html#4361185">template</a></span><span class="op" id="4361683">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361686">if</span>&nbsp;<span class="ident" id="4361689"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4361693">!=</span>&nbsp;<span class="ident" id="4361696">nil</span>&nbsp;<span class="op" id="4361700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361704">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361716">asn1Issuer</span><span class="op" id="4361726">,</span>&nbsp;<span class="ident" id="4361728"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4361732">:=</span>&nbsp;<span class="ident" id="4361735"><a href="/crypto/x509/x509.go.html#4358551">subjectBytes</a></span><span class="op" id="4361747">(</span><span class="ident" id="4361748"><a href="/crypto/x509/x509.go.html#4361195">parent</a></span><span class="op" id="4361754">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361757">if</span>&nbsp;<span class="ident" id="4361760"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4361764">!=</span>&nbsp;<span class="ident" id="4361767">nil</span>&nbsp;<span class="op" id="4361771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361775">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361787">asn1Subject</span><span class="op" id="4361798">,</span>&nbsp;<span class="ident" id="4361800"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4361804">:=</span>&nbsp;<span class="ident" id="4361807"><a href="/crypto/x509/x509.go.html#4358551">subjectBytes</a></span><span class="op" id="4361819">(</span><span class="ident" id="4361820"><a href="/crypto/x509/x509.go.html#4361185">template</a></span><span class="op" id="4361828">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361831">if</span>&nbsp;<span class="ident" id="4361834"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4361838">!=</span>&nbsp;<span class="ident" id="4361841">nil</span>&nbsp;<span class="op" id="4361845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361849">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361861">encodedPublicKey</span>&nbsp;<span class="op" id="4361878">:=</span>&nbsp;<span class="ident" id="4361881"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4361885">.</span><span class="ident" id="4361886">BitString</span><span class="op" id="4361895">{</span><span class="ident" id="4361896">BitLength</span><span class="op" id="4361905">:</span>&nbsp;<span class="builtinfunc" id="4361907">len</span><span class="op" id="4361910">(</span><span class="ident" id="4361911"><a href="/crypto/x509/x509.go.html#4361418">publicKeyBytes</a></span><span class="op" id="4361925">)</span>&nbsp;<span class="op" id="4361927">*</span>&nbsp;<span class="num" id="4361929">8</span><span class="op" id="4361930">,</span>&nbsp;<span class="ident" id="4361932">Bytes</span><span class="op" id="4361937">:</span>&nbsp;<span class="ident" id="4361939"><a href="/crypto/x509/x509.go.html#4361418">publicKeyBytes</a></span><span class="op" id="4361953">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361956">c</span>&nbsp;<span class="op" id="4361958">:=</span>&nbsp;<span class="ident" id="4361961"><a href="/crypto/x509/x509.go.html#4319395">tbsCertificate</a></span><span class="op" id="4361975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361979">Version</span><span class="op" id="4361986">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4361999">2</span><span class="op" id="4362000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362004">SerialNumber</span><span class="op" id="4362016">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4362024"><a href="/crypto/x509/x509.go.html#4361185">template</a></span><span class="op" id="4362032">.</span><span class="ident" id="4362033">SerialNumber</span><span class="op" id="4362045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362049">SignatureAlgorithm</span><span class="op" id="4362067">:</span>&nbsp;<span class="ident" id="4362069"><a href="/crypto/x509/x509.go.html#4361289">signatureAlgorithm</a></span><span class="op" id="4362087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362091">Issuer</span><span class="op" id="4362097">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4362111"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4362115">.</span><span class="ident" id="4362116">RawValue</span><span class="op" id="4362124">{</span><span class="ident" id="4362125">FullBytes</span><span class="op" id="4362134">:</span>&nbsp;<span class="ident" id="4362136"><a href="/crypto/x509/x509.go.html#4361716">asn1Issuer</a></span><span class="op" id="4362146">}</span><span class="op" id="4362147">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362151">Validity</span><span class="op" id="4362159">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4362171"><a href="/crypto/x509/x509.go.html#4320064">validity</a></span><span class="op" id="4362179">{</span><span class="ident" id="4362180"><a href="/crypto/x509/x509.go.html#4361185">template</a></span><span class="op" id="4362188">.</span><span class="ident" id="4362189">NotBefore</span><span class="op" id="4362198">.</span><span class="ident" id="4362199">UTC</span><span class="op" id="4362202">(</span><span class="op" id="4362203">)</span><span class="op" id="4362204">,</span>&nbsp;<span class="ident" id="4362206"><a href="/crypto/x509/x509.go.html#4361185">template</a></span><span class="op" id="4362214">.</span><span class="ident" id="4362215">NotAfter</span><span class="op" id="4362223">.</span><span class="ident" id="4362224">UTC</span><span class="op" id="4362227">(</span><span class="op" id="4362228">)</span><span class="op" id="4362229">}</span><span class="op" id="4362230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362234">Subject</span><span class="op" id="4362241">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4362254"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4362258">.</span><span class="ident" id="4362259">RawValue</span><span class="op" id="4362267">{</span><span class="ident" id="4362268">FullBytes</span><span class="op" id="4362277">:</span>&nbsp;<span class="ident" id="4362279"><a href="/crypto/x509/x509.go.html#4361787">asn1Subject</a></span><span class="op" id="4362290">}</span><span class="op" id="4362291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362295">PublicKey</span><span class="op" id="4362304">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4362315"><a href="/crypto/x509/x509.go.html#4320121">publicKeyInfo</a></span><span class="op" id="4362328">{</span><span class="ident" id="4362329">nil</span><span class="op" id="4362332">,</span>&nbsp;<span class="ident" id="4362334"><a href="/crypto/x509/x509.go.html#4361434">publicKeyAlgorithm</a></span><span class="op" id="4362352">,</span>&nbsp;<span class="ident" id="4362354"><a href="/crypto/x509/x509.go.html#4361861">encodedPublicKey</a></span><span class="op" id="4362370">}</span><span class="op" id="4362371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362375">Extensions</span><span class="op" id="4362385">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4362395"><a href="/crypto/x509/x509.go.html#4361640">extensions</a></span><span class="op" id="4362405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362408">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362412">tbsCertContents</span><span class="op" id="4362427">,</span>&nbsp;<span class="ident" id="4362429"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4362433">:=</span>&nbsp;<span class="ident" id="4362436"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4362440">.</span><span class="ident" id="4362441">Marshal</span><span class="op" id="4362448">(</span><span class="ident" id="4362449"><a href="/crypto/x509/x509.go.html#4361956">c</a></span><span class="op" id="4362450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362453">if</span>&nbsp;<span class="ident" id="4362456"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4362460">!=</span>&nbsp;<span class="ident" id="4362463">nil</span>&nbsp;<span class="op" id="4362467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362471">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362479">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362483"><a href="/crypto/x509/x509.go.html#4361956">c</a></span><span class="op" id="4362484">.</span><span class="ident" id="4362485">Raw</span>&nbsp;<span class="op" id="4362489">=</span>&nbsp;<span class="ident" id="4362491"><a href="/crypto/x509/x509.go.html#4362412">tbsCertContents</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362509">h</span>&nbsp;<span class="op" id="4362511">:=</span>&nbsp;<span class="ident" id="4362514"><a href="/crypto/x509/x509.go.html#4361279">hashFunc</a></span><span class="op" id="4362522">.</span><span class="ident" id="4362523">New</span><span class="op" id="4362526">(</span><span class="op" id="4362527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362530"><a href="/crypto/x509/x509.go.html#4362509">h</a></span><span class="op" id="4362531">.</span><span class="ident" id="4362532">Write</span><span class="op" id="4362537">(</span><span class="ident" id="4362538"><a href="/crypto/x509/x509.go.html#4362412">tbsCertContents</a></span><span class="op" id="4362553">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362556">digest</span>&nbsp;<span class="op" id="4362563">:=</span>&nbsp;<span class="ident" id="4362566"><a href="/crypto/x509/x509.go.html#4362509">h</a></span><span class="op" id="4362567">.</span><span class="ident" id="4362568">Sum</span><span class="op" id="4362571">(</span><span class="ident" id="4362572">nil</span><span class="op" id="4362575">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362579">var</span>&nbsp;<span class="ident" id="4362583">signature</span>&nbsp;<span class="op" id="4362593">[</span><span class="op" id="4362594">]</span><span class="builtintype" id="4362595">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362602">switch</span>&nbsp;<span class="ident" id="4362609">priv</span>&nbsp;<span class="op" id="4362614">:=</span>&nbsp;<span class="ident" id="4362617"><a href="/crypto/x509/x509.go.html#4361233">priv</a></span><span class="op" id="4362621">.</span><span class="op" id="4362622">(</span><span class="keyword" id="4362623">type</span><span class="op" id="4362627">)</span>&nbsp;<span class="op" id="4362629">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362632">case</span>&nbsp;<span class="op" id="4362637">*</span><span class="ident" id="4362638"><a href="/crypto/x509/x509.go.html#4316595">rsa</a></span><span class="op" id="4362641">.</span><span class="ident" id="4362642">PrivateKey</span><span class="op" id="4362652">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362656"><a href="/crypto/x509/x509.go.html#4362583">signature</a></span><span class="op" id="4362665">,</span>&nbsp;<span class="ident" id="4362667"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4362671">=</span>&nbsp;<span class="ident" id="4362673"><a href="/crypto/x509/x509.go.html#4316595">rsa</a></span><span class="op" id="4362676">.</span><span class="ident" id="4362677">SignPKCS1v15</span><span class="op" id="4362689">(</span><span class="ident" id="4362690"><a href="/crypto/x509/x509.go.html#4361169">rand</a></span><span class="op" id="4362694">,</span>&nbsp;<span class="ident" id="4362696"><a href="/crypto/x509/x509.go.html#4362609">priv</a></span><span class="op" id="4362700">,</span>&nbsp;<span class="ident" id="4362702"><a href="/crypto/x509/x509.go.html#4361279">hashFunc</a></span><span class="op" id="4362710">,</span>&nbsp;<span class="ident" id="4362712"><a href="/crypto/x509/x509.go.html#4362556">digest</a></span><span class="op" id="4362718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362721">case</span>&nbsp;<span class="op" id="4362726">*</span><span class="ident" id="4362727"><a href="/crypto/x509/x509.go.html#4316560">ecdsa</a></span><span class="op" id="4362732">.</span><span class="ident" id="4362733">PrivateKey</span><span class="op" id="4362743">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362747">var</span>&nbsp;<span class="ident" id="4362751">r</span><span class="op" id="4362752">,</span>&nbsp;<span class="ident" id="4362754">s</span>&nbsp;<span class="op" id="4362756">*</span><span class="ident" id="4362757"><a href="/crypto/x509/x509.go.html#4316731">big</a></span><span class="op" id="4362760">.</span><span class="ident" id="4362761">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362767">if</span>&nbsp;<span class="ident" id="4362770"><a href="/crypto/x509/x509.go.html#4362751">r</a></span><span class="op" id="4362771">,</span>&nbsp;<span class="ident" id="4362773"><a href="/crypto/x509/x509.go.html#4362754">s</a></span><span class="op" id="4362774">,</span>&nbsp;<span class="ident" id="4362776"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4362780">=</span>&nbsp;<span class="ident" id="4362782"><a href="/crypto/x509/x509.go.html#4316560">ecdsa</a></span><span class="op" id="4362787">.</span><span class="ident" id="4362788">Sign</span><span class="op" id="4362792">(</span><span class="ident" id="4362793"><a href="/crypto/x509/x509.go.html#4361169">rand</a></span><span class="op" id="4362797">,</span>&nbsp;<span class="ident" id="4362799"><a href="/crypto/x509/x509.go.html#4362609">priv</a></span><span class="op" id="4362803">,</span>&nbsp;<span class="ident" id="4362805"><a href="/crypto/x509/x509.go.html#4362556">digest</a></span><span class="op" id="4362811">)</span><span class="op" id="4362812">;</span>&nbsp;<span class="ident" id="4362814"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4362818">==</span>&nbsp;<span class="ident" id="4362821">nil</span>&nbsp;<span class="op" id="4362825">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362830"><a href="/crypto/x509/x509.go.html#4362583">signature</a></span><span class="op" id="4362839">,</span>&nbsp;<span class="ident" id="4362841"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4362845">=</span>&nbsp;<span class="ident" id="4362847"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4362851">.</span><span class="ident" id="4362852">Marshal</span><span class="op" id="4362859">(</span><span class="ident" id="4362860"><a href="/crypto/x509/x509.go.html#4320030">ecdsaSignature</a></span><span class="op" id="4362874">{</span><span class="ident" id="4362875"><a href="/crypto/x509/x509.go.html#4362751">r</a></span><span class="op" id="4362876">,</span>&nbsp;<span class="ident" id="4362878"><a href="/crypto/x509/x509.go.html#4362754">s</a></span><span class="op" id="4362879">}</span><span class="op" id="4362880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362887">default</span><span class="op" id="4362894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4362898">panic</span><span class="op" id="4362903">(</span><span class="string" id="4362904">&#34;internal&nbsp;error&#34;</span><span class="op" id="4362920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362923">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362927">if</span>&nbsp;<span class="ident" id="4362930"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4362934">!=</span>&nbsp;<span class="ident" id="4362937">nil</span>&nbsp;<span class="op" id="4362941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362945">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362957"><a href="/crypto/x509/x509.go.html#4361252">cert</a></span><span class="op" id="4362961">,</span>&nbsp;<span class="ident" id="4362963"><a href="/crypto/x509/x509.go.html#4361265">err</a></span>&nbsp;<span class="op" id="4362967">=</span>&nbsp;<span class="ident" id="4362969"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4362973">.</span><span class="ident" id="4362974">Marshal</span><span class="op" id="4362981">(</span><span class="ident" id="4362982"><a href="/crypto/x509/x509.go.html#4319215">certificate</a></span><span class="op" id="4362993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362997">nil</span><span class="op" id="4363000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363004"><a href="/crypto/x509/x509.go.html#4361956">c</a></span><span class="op" id="4363005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363009"><a href="/crypto/x509/x509.go.html#4361289">signatureAlgorithm</a></span><span class="op" id="4363027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363031"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4363035">.</span><span class="ident" id="4363036">BitString</span><span class="op" id="4363045">{</span><span class="ident" id="4363046">Bytes</span><span class="op" id="4363051">:</span>&nbsp;<span class="ident" id="4363053"><a href="/crypto/x509/x509.go.html#4362583">signature</a></span><span class="op" id="4363062">,</span>&nbsp;<span class="ident" id="4363064">BitLength</span><span class="op" id="4363073">:</span>&nbsp;<span class="builtinfunc" id="4363075">len</span><span class="op" id="4363078">(</span><span class="ident" id="4363079"><a href="/crypto/x509/x509.go.html#4362583">signature</a></span><span class="op" id="4363088">)</span>&nbsp;<span class="op" id="4363090">*</span>&nbsp;<span class="num" id="4363092">8</span><span class="op" id="4363093">}</span><span class="op" id="4363094">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363097">}</span><span class="op" id="4363098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363101">return</span><br>
<span class="lineno"></span><span class="op" id="4363108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4363111">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="4363189">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4363197">var</span>&nbsp;<span class="ident" id="4363201">pemCRLPrefix</span>&nbsp;<span class="op" id="4363214">=</span>&nbsp;<span class="op" id="4363216">[</span><span class="op" id="4363217">]</span><span class="builtintype" id="4363218">byte</span><span class="op" id="4363222">(</span><span class="string" id="4363223">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="4363244">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4363247">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4363292">var</span>&nbsp;<span class="ident" id="4363296">pemType</span>&nbsp;<span class="op" id="4363304">=</span>&nbsp;<span class="string" id="4363306">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="4363318">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="4363394">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4363473">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="4363550">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="4363562">func</span>&nbsp;<span class="ident" id="4363567">ParseCRL</span><span class="op" id="4363575">(</span><span class="ident" id="4363576">crlBytes</span>&nbsp;<span class="op" id="4363585">[</span><span class="op" id="4363586">]</span><span class="builtintype" id="4363587">byte</span><span class="op" id="4363591">)</span>&nbsp;<span class="op" id="4363593">(</span><span class="ident" id="4363594">certList</span>&nbsp;<span class="op" id="4363603">*</span><span class="ident" id="4363604"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4363608">.</span><span class="ident" id="4363609">CertificateList</span><span class="op" id="4363624">,</span>&nbsp;<span class="ident" id="4363626">err</span>&nbsp;<span class="builtintype" id="4363630">error</span><span class="op" id="4363635">)</span>&nbsp;<span class="op" id="4363637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363640">if</span>&nbsp;<span class="ident" id="4363643"><a href="/crypto/x509/x509.go.html#4316527">bytes</a></span><span class="op" id="4363648">.</span><span class="ident" id="4363649">HasPrefix</span><span class="op" id="4363658">(</span><span class="ident" id="4363659"><a href="/crypto/x509/x509.go.html#4363576">crlBytes</a></span><span class="op" id="4363667">,</span>&nbsp;<span class="ident" id="4363669"><a href="/crypto/x509/x509.go.html#4363201">pemCRLPrefix</a></span><span class="op" id="4363681">)</span>&nbsp;<span class="op" id="4363683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363687">block</span><span class="op" id="4363692">,</span>&nbsp;<span class="ident" id="4363694">_</span>&nbsp;<span class="op" id="4363696">:=</span>&nbsp;<span class="ident" id="4363699"><a href="/crypto/x509/x509.go.html#4316699">pem</a></span><span class="op" id="4363702">.</span><span class="ident" id="4363703">Decode</span><span class="op" id="4363709">(</span><span class="ident" id="4363710"><a href="/crypto/x509/x509.go.html#4363576">crlBytes</a></span><span class="op" id="4363718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363722">if</span>&nbsp;<span class="ident" id="4363725"><a href="/crypto/x509/x509.go.html#4363687">block</a></span>&nbsp;<span class="op" id="4363731">!=</span>&nbsp;<span class="ident" id="4363734">nil</span>&nbsp;<span class="op" id="4363738">&amp;&amp;</span>&nbsp;<span class="ident" id="4363741"><a href="/crypto/x509/x509.go.html#4363687">block</a></span><span class="op" id="4363746">.</span><span class="ident" id="4363747">Type</span>&nbsp;<span class="op" id="4363752">==</span>&nbsp;<span class="ident" id="4363755"><a href="/crypto/x509/x509.go.html#4363296">pemType</a></span>&nbsp;<span class="op" id="4363763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363768"><a href="/crypto/x509/x509.go.html#4363576">crlBytes</a></span>&nbsp;<span class="op" id="4363777">=</span>&nbsp;<span class="ident" id="4363779"><a href="/crypto/x509/x509.go.html#4363687">block</a></span><span class="op" id="4363784">.</span><span class="ident" id="4363785">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363799">return</span>&nbsp;<span class="ident" id="4363806"><a href="/crypto/x509/x509.go.html#4363898">ParseDERCRL</a></span><span class="op" id="4363817">(</span><span class="ident" id="4363818"><a href="/crypto/x509/x509.go.html#4363576">crlBytes</a></span><span class="op" id="4363826">)</span><br>
<span class="lineno"></span><span class="op" id="4363828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="4363831">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4363893">func</span>&nbsp;<span class="ident" id="4363898">ParseDERCRL</span><span class="op" id="4363909">(</span><span class="ident" id="4363910">derBytes</span>&nbsp;<span class="op" id="4363919">[</span><span class="op" id="4363920">]</span><span class="builtintype" id="4363921">byte</span><span class="op" id="4363925">)</span>&nbsp;<span class="op" id="4363927">(</span><span class="ident" id="4363928">certList</span>&nbsp;<span class="op" id="4363937">*</span><span class="ident" id="4363938"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4363942">.</span><span class="ident" id="4363943">CertificateList</span><span class="op" id="4363958">,</span>&nbsp;<span class="ident" id="4363960">err</span>&nbsp;<span class="builtintype" id="4363964">error</span><span class="op" id="4363969">)</span>&nbsp;<span class="op" id="4363971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363974"><a href="/crypto/x509/x509.go.html#4363928">certList</a></span>&nbsp;<span class="op" id="4363983">=</span>&nbsp;<span class="builtinfunc" id="4363985">new</span><span class="op" id="4363988">(</span><span class="ident" id="4363989"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4363993">.</span><span class="ident" id="4363994">CertificateList</span><span class="op" id="4364009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364012">_</span><span class="op" id="4364013">,</span>&nbsp;<span class="ident" id="4364015"><a href="/crypto/x509/x509.go.html#4363960">err</a></span>&nbsp;<span class="op" id="4364019">=</span>&nbsp;<span class="ident" id="4364021"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4364025">.</span><span class="ident" id="4364026">Unmarshal</span><span class="op" id="4364035">(</span><span class="ident" id="4364036"><a href="/crypto/x509/x509.go.html#4363910">derBytes</a></span><span class="op" id="4364044">,</span>&nbsp;<span class="ident" id="4364046"><a href="/crypto/x509/x509.go.html#4363928">certList</a></span><span class="op" id="4364054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364057">if</span>&nbsp;<span class="ident" id="4364060"><a href="/crypto/x509/x509.go.html#4363960">err</a></span>&nbsp;<span class="op" id="4364064">!=</span>&nbsp;<span class="ident" id="4364067">nil</span>&nbsp;<span class="op" id="4364071">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364075"><a href="/crypto/x509/x509.go.html#4363928">certList</a></span>&nbsp;<span class="op" id="4364084">=</span>&nbsp;<span class="ident" id="4364086">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364094">return</span><br>
<span class="lineno"></span><span class="op" id="4364101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="4364104">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4364177">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="4364229">//</span><br>
<span class="lineno"></span><span class="comment" id="4364232">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="4364298">func</span>&nbsp;<span class="op" id="4364303">(</span><span class="ident" id="4364304">c</span>&nbsp;<span class="op" id="4364306">*</span><span class="ident" id="4364307"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4364318">)</span>&nbsp;<span class="ident" id="4364320">CreateCRL</span><span class="op" id="4364329">(</span><span class="ident" id="4364330">rand</span>&nbsp;<span class="ident" id="4364335"><a href="/crypto/x509/x509.go.html#4316725">io</a></span><span class="op" id="4364337">.</span><span class="ident" id="4364338">Reader</span><span class="op" id="4364344">,</span>&nbsp;<span class="ident" id="4364346">priv</span>&nbsp;<span class="keyword" id="4364351">interface</span><span class="op" id="4364360">{</span><span class="op" id="4364361">}</span><span class="op" id="4364362">,</span>&nbsp;<span class="ident" id="4364364">revokedCerts</span>&nbsp;<span class="op" id="4364377">[</span><span class="op" id="4364378">]</span><span class="ident" id="4364379"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4364383">.</span><span class="ident" id="4364384">RevokedCertificate</span><span class="op" id="4364402">,</span>&nbsp;<span class="ident" id="4364404">now</span><span class="op" id="4364407">,</span>&nbsp;<span class="ident" id="4364409">expiry</span>&nbsp;<span class="ident" id="4364416"><a href="/crypto/x509/x509.go.html#4316761">time</a></span><span class="op" id="4364420">.</span><span class="ident" id="4364421">Time</span><span class="op" id="4364425">)</span>&nbsp;<span class="op" id="4364427">(</span><span class="ident" id="4364428">crlBytes</span>&nbsp;<span class="op" id="4364437">[</span><span class="op" id="4364438">]</span><span class="builtintype" id="4364439">byte</span><span class="op" id="4364443">,</span>&nbsp;<span class="ident" id="4364445">err</span>&nbsp;<span class="builtintype" id="4364449">error</span><span class="op" id="4364454">)</span>&nbsp;<span class="op" id="4364456">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364459">rsaPriv</span><span class="op" id="4364466">,</span>&nbsp;<span class="ident" id="4364468">ok</span>&nbsp;<span class="op" id="4364471">:=</span>&nbsp;<span class="ident" id="4364474"><a href="/crypto/x509/x509.go.html#4364346">priv</a></span><span class="op" id="4364478">.</span><span class="op" id="4364479">(</span><span class="op" id="4364480">*</span><span class="ident" id="4364481"><a href="/crypto/x509/x509.go.html#4316595">rsa</a></span><span class="op" id="4364484">.</span><span class="ident" id="4364485">PrivateKey</span><span class="op" id="4364495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364498">if</span>&nbsp;<span class="op" id="4364501">!</span><span class="ident" id="4364502"><a href="/crypto/x509/x509.go.html#4364468">ok</a></span>&nbsp;<span class="op" id="4364505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364509">return</span>&nbsp;<span class="ident" id="4364516">nil</span><span class="op" id="4364519">,</span>&nbsp;<span class="ident" id="4364521"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4364527">.</span><span class="ident" id="4364528">New</span><span class="op" id="4364531">(</span><span class="string" id="4364532">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4364574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364580">tbsCertList</span>&nbsp;<span class="op" id="4364592">:=</span>&nbsp;<span class="ident" id="4364595"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4364599">.</span><span class="ident" id="4364600">TBSCertificateList</span><span class="op" id="4364618">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364622">Version</span><span class="op" id="4364629">:</span>&nbsp;<span class="num" id="4364631">2</span><span class="op" id="4364632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364636">Signature</span><span class="op" id="4364645">:</span>&nbsp;<span class="ident" id="4364647"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4364651">.</span><span class="ident" id="4364652">AlgorithmIdentifier</span><span class="op" id="4364671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364676">Algorithm</span><span class="op" id="4364685">:</span>&nbsp;<span class="ident" id="4364687"><a href="/crypto/x509/x509.go.html#4322440">oidSignatureSHA1WithRSA</a></span><span class="op" id="4364710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364714">}</span><span class="op" id="4364715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364719">Issuer</span><span class="op" id="4364725">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4364740"><a href="/crypto/x509/x509.go.html#4364304">c</a></span><span class="op" id="4364741">.</span><span class="ident" id="4364742">Subject</span><span class="op" id="4364749">.</span><span class="ident" id="4364750">ToRDNSequence</span><span class="op" id="4364763">(</span><span class="op" id="4364764">)</span><span class="op" id="4364765">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364769">ThisUpdate</span><span class="op" id="4364779">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4364790"><a href="/crypto/x509/x509.go.html#4364404">now</a></span><span class="op" id="4364793">.</span><span class="ident" id="4364794">UTC</span><span class="op" id="4364797">(</span><span class="op" id="4364798">)</span><span class="op" id="4364799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364803">NextUpdate</span><span class="op" id="4364813">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4364824"><a href="/crypto/x509/x509.go.html#4364409">expiry</a></span><span class="op" id="4364830">.</span><span class="ident" id="4364831">UTC</span><span class="op" id="4364834">(</span><span class="op" id="4364835">)</span><span class="op" id="4364836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364840">RevokedCertificates</span><span class="op" id="4364859">:</span>&nbsp;<span class="ident" id="4364861"><a href="/crypto/x509/x509.go.html#4364364">revokedCerts</a></span><span class="op" id="4364873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364880">tbsCertListContents</span><span class="op" id="4364899">,</span>&nbsp;<span class="ident" id="4364901"><a href="/crypto/x509/x509.go.html#4364445">err</a></span>&nbsp;<span class="op" id="4364905">:=</span>&nbsp;<span class="ident" id="4364908"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4364912">.</span><span class="ident" id="4364913">Marshal</span><span class="op" id="4364920">(</span><span class="ident" id="4364921"><a href="/crypto/x509/x509.go.html#4364580">tbsCertList</a></span><span class="op" id="4364932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364935">if</span>&nbsp;<span class="ident" id="4364938"><a href="/crypto/x509/x509.go.html#4364445">err</a></span>&nbsp;<span class="op" id="4364942">!=</span>&nbsp;<span class="ident" id="4364945">nil</span>&nbsp;<span class="op" id="4364949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364953">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364965">h</span>&nbsp;<span class="op" id="4364967">:=</span>&nbsp;<span class="ident" id="4364970"><a href="/crypto/x509/x509.go.html#4316609">sha1</a></span><span class="op" id="4364974">.</span><span class="ident" id="4364975">New</span><span class="op" id="4364978">(</span><span class="op" id="4364979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364982"><a href="/crypto/x509/x509.go.html#4364965">h</a></span><span class="op" id="4364983">.</span><span class="ident" id="4364984">Write</span><span class="op" id="4364989">(</span><span class="ident" id="4364990"><a href="/crypto/x509/x509.go.html#4364880">tbsCertListContents</a></span><span class="op" id="4365009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365012">digest</span>&nbsp;<span class="op" id="4365019">:=</span>&nbsp;<span class="ident" id="4365022"><a href="/crypto/x509/x509.go.html#4364965">h</a></span><span class="op" id="4365023">.</span><span class="ident" id="4365024">Sum</span><span class="op" id="4365027">(</span><span class="ident" id="4365028">nil</span><span class="op" id="4365031">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365035">signature</span><span class="op" id="4365044">,</span>&nbsp;<span class="ident" id="4365046"><a href="/crypto/x509/x509.go.html#4364445">err</a></span>&nbsp;<span class="op" id="4365050">:=</span>&nbsp;<span class="ident" id="4365053"><a href="/crypto/x509/x509.go.html#4316595">rsa</a></span><span class="op" id="4365056">.</span><span class="ident" id="4365057">SignPKCS1v15</span><span class="op" id="4365069">(</span><span class="ident" id="4365070"><a href="/crypto/x509/x509.go.html#4364330">rand</a></span><span class="op" id="4365074">,</span>&nbsp;<span class="ident" id="4365076"><a href="/crypto/x509/x509.go.html#4364459">rsaPriv</a></span><span class="op" id="4365083">,</span>&nbsp;<span class="ident" id="4365085"><a href="/crypto/x509/x509.go.html#4316536">crypto</a></span><span class="op" id="4365091">.</span><span class="ident" id="4365092">SHA1</span><span class="op" id="4365096">,</span>&nbsp;<span class="ident" id="4365098"><a href="/crypto/x509/x509.go.html#4365012">digest</a></span><span class="op" id="4365104">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365107">if</span>&nbsp;<span class="ident" id="4365110"><a href="/crypto/x509/x509.go.html#4364445">err</a></span>&nbsp;<span class="op" id="4365114">!=</span>&nbsp;<span class="ident" id="4365117">nil</span>&nbsp;<span class="op" id="4365121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365125">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365137">return</span>&nbsp;<span class="ident" id="4365144"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4365148">.</span><span class="ident" id="4365149">Marshal</span><span class="op" id="4365156">(</span><span class="ident" id="4365157"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4365161">.</span><span class="ident" id="4365162">CertificateList</span><span class="op" id="4365177">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365181">TBSCertList</span><span class="op" id="4365192">:</span>&nbsp;<span class="ident" id="4365194"><a href="/crypto/x509/x509.go.html#4364580">tbsCertList</a></span><span class="op" id="4365205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365209">SignatureAlgorithm</span><span class="op" id="4365227">:</span>&nbsp;<span class="ident" id="4365229"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4365233">.</span><span class="ident" id="4365234">AlgorithmIdentifier</span><span class="op" id="4365253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365258">Algorithm</span><span class="op" id="4365267">:</span>&nbsp;<span class="ident" id="4365269"><a href="/crypto/x509/x509.go.html#4322440">oidSignatureSHA1WithRSA</a></span><span class="op" id="4365292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365296">}</span><span class="op" id="4365297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365301">SignatureValue</span><span class="op" id="4365315">:</span>&nbsp;<span class="ident" id="4365317"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4365321">.</span><span class="ident" id="4365322">BitString</span><span class="op" id="4365331">{</span><span class="ident" id="4365332">Bytes</span><span class="op" id="4365337">:</span>&nbsp;<span class="ident" id="4365339"><a href="/crypto/x509/x509.go.html#4365035">signature</a></span><span class="op" id="4365348">,</span>&nbsp;<span class="ident" id="4365350">BitLength</span><span class="op" id="4365359">:</span>&nbsp;<span class="builtinfunc" id="4365361">len</span><span class="op" id="4365364">(</span><span class="ident" id="4365365"><a href="/crypto/x509/x509.go.html#4365035">signature</a></span><span class="op" id="4365374">)</span>&nbsp;<span class="op" id="4365376">*</span>&nbsp;<span class="num" id="4365378">8</span><span class="op" id="4365379">}</span><span class="op" id="4365380">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365383">}</span><span class="op" id="4365384">)</span><br>
<span class="lineno"></span><span class="op" id="4365386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4365389">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4365465">type</span>&nbsp;<span class="ident" id="4365470">CertificateRequest</span>&nbsp;<span class="keyword" id="4365489">struct</span>&nbsp;<span class="op" id="4365496">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365499">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4365524">[</span><span class="op" id="4365525">]</span><span class="builtintype" id="4365526">byte</span>&nbsp;<span class="comment" id="4365531">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365604">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="4365629">[</span><span class="op" id="4365630">]</span><span class="builtintype" id="4365631">byte</span>&nbsp;<span class="comment" id="4365636">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365696">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="4365721">[</span><span class="op" id="4365722">]</span><span class="builtintype" id="4365723">byte</span>&nbsp;<span class="comment" id="4365728">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365766">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4365791">[</span><span class="op" id="4365792">]</span><span class="builtintype" id="4365793">byte</span>&nbsp;<span class="comment" id="4365798">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365824">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4365843">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365848">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4365867">[</span><span class="op" id="4365868">]</span><span class="builtintype" id="4365869">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365875">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4365894"><a href="/crypto/x509/x509.go.html#4320325">SignatureAlgorithm</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365915">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4365934"><a href="/crypto/x509/x509.go.html#4320594">PublicKeyAlgorithm</a></span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365954">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365973">interface</span><span class="op" id="4365982">{</span><span class="op" id="4365983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365987">Subject</span>&nbsp;<span class="ident" id="4365995"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4365999">.</span><span class="ident" id="4366000">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366007">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366062">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366127">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366157">Attributes</span>&nbsp;<span class="op" id="4366168">[</span><span class="op" id="4366169">]</span><span class="ident" id="4366170"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4366174">.</span><span class="ident" id="4366175">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366202">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366272">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366338">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366351">Extensions</span>&nbsp;<span class="op" id="4366362">[</span><span class="op" id="4366363">]</span><span class="ident" id="4366364"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4366368">.</span><span class="ident" id="4366369">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366381">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366449">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366520">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366588">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366628">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366632">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366702">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366718">ExtraExtensions</span>&nbsp;<span class="op" id="4366734">[</span><span class="op" id="4366735">]</span><span class="ident" id="4366736"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4366740">.</span><span class="ident" id="4366741">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366753">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366788">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4366803">[</span><span class="op" id="4366804">]</span><span class="builtintype" id="4366805">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366813">EmailAddresses</span>&nbsp;<span class="op" id="4366828">[</span><span class="op" id="4366829">]</span><span class="builtintype" id="4366830">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366838">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4366853">[</span><span class="op" id="4366854">]</span><span class="ident" id="4366855"><a href="/crypto/x509/x509.go.html#4316743">net</a></span><span class="op" id="4366858">.</span><span class="ident" id="4366859">IP</span><br>
<span class="lineno"></span><span class="op" id="4366862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4366865">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="4366934">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4366973">type</span>&nbsp;<span class="ident" id="4366978">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="4367000">struct</span>&nbsp;<span class="op" id="4367007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4367010">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367021"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4367025">.</span><span class="ident" id="4367026">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4367038">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4367049">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4367054">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367065"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4367069">.</span><span class="ident" id="4367070">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4367080">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="4367091"><a href="/crypto/x509/x509.go.html#4320121">publicKeyInfo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4367106">Attributes</span>&nbsp;<span class="op" id="4367117">[</span><span class="op" id="4367118">]</span><span class="ident" id="4367119"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4367123">.</span><span class="ident" id="4367124">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="4367149">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4367164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="4367167">type</span>&nbsp;<span class="ident" id="4367172">certificateRequest</span>&nbsp;<span class="keyword" id="4367191">struct</span>&nbsp;<span class="op" id="4367198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4367201">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367220"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4367224">.</span><span class="ident" id="4367225">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4367237">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367256"><a href="/crypto/x509/x509.go.html#4366978">tbsCertificateRequest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4367279">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4367298"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4367302">.</span><span class="ident" id="4367303">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4367324">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367343"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4367347">.</span><span class="ident" id="4367348">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="4367358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4367361">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="4367439">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="4367463">var</span>&nbsp;<span class="ident" id="4367467">oidExtensionRequest</span>&nbsp;<span class="op" id="4367487">=</span>&nbsp;<span class="ident" id="4367489"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4367493">.</span><span class="ident" id="4367494">ObjectIdentifier</span><span class="op" id="4367510">{</span><span class="num" id="4367511">1</span><span class="op" id="4367512">,</span>&nbsp;<span class="num" id="4367514">2</span><span class="op" id="4367515">,</span>&nbsp;<span class="num" id="4367517">840</span><span class="op" id="4367520">,</span>&nbsp;<span class="num" id="4367522">113549</span><span class="op" id="4367528">,</span>&nbsp;<span class="num" id="4367530">1</span><span class="op" id="4367531">,</span>&nbsp;<span class="num" id="4367533">9</span><span class="op" id="4367534">,</span>&nbsp;<span class="num" id="4367536">14</span><span class="op" id="4367538">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="4367541">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4367620">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="4367684">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="4367762">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="4367815">//</span><br>
<span class="lineno"></span><span class="comment" id="4367818">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4367884">//</span><br>
<span class="lineno"></span><span class="comment" id="4367887">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="4367955">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="4367979">func</span>&nbsp;<span class="ident" id="4367984">CreateCertificateRequest</span><span class="op" id="4368008">(</span><span class="ident" id="4368009">rand</span>&nbsp;<span class="ident" id="4368014"><a href="/crypto/x509/x509.go.html#4316725">io</a></span><span class="op" id="4368016">.</span><span class="ident" id="4368017">Reader</span><span class="op" id="4368023">,</span>&nbsp;<span class="ident" id="4368025">template</span>&nbsp;<span class="op" id="4368034">*</span><span class="ident" id="4368035"><a href="/crypto/x509/x509.go.html#4365470">CertificateRequest</a></span><span class="op" id="4368053">,</span>&nbsp;<span class="ident" id="4368055">priv</span>&nbsp;<span class="keyword" id="4368060">interface</span><span class="op" id="4368069">{</span><span class="op" id="4368070">}</span><span class="op" id="4368071">)</span>&nbsp;<span class="op" id="4368073">(</span><span class="ident" id="4368074">csr</span>&nbsp;<span class="op" id="4368078">[</span><span class="op" id="4368079">]</span><span class="builtintype" id="4368080">byte</span><span class="op" id="4368084">,</span>&nbsp;<span class="ident" id="4368086">err</span>&nbsp;<span class="builtintype" id="4368090">error</span><span class="op" id="4368095">)</span>&nbsp;<span class="op" id="4368097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368100">hashFunc</span><span class="op" id="4368108">,</span>&nbsp;<span class="ident" id="4368110">sigAlgo</span><span class="op" id="4368117">,</span>&nbsp;<span class="ident" id="4368119"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4368123">:=</span>&nbsp;<span class="ident" id="4368126"><a href="/crypto/x509/x509.go.html#4358897">signingParamsForPrivateKey</a></span><span class="op" id="4368152">(</span><span class="ident" id="4368153"><a href="/crypto/x509/x509.go.html#4368055">priv</a></span><span class="op" id="4368157">,</span>&nbsp;<span class="ident" id="4368159"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4368167">.</span><span class="ident" id="4368168">SignatureAlgorithm</span><span class="op" id="4368186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368189">if</span>&nbsp;<span class="ident" id="4368192"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4368196">!=</span>&nbsp;<span class="ident" id="4368199">nil</span>&nbsp;<span class="op" id="4368203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368207">return</span>&nbsp;<span class="ident" id="4368214">nil</span><span class="op" id="4368217">,</span>&nbsp;<span class="ident" id="4368219"><a href="/crypto/x509/x509.go.html#4368086">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4368224">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368228">var</span>&nbsp;<span class="ident" id="4368232">publicKeyBytes</span>&nbsp;<span class="op" id="4368247">[</span><span class="op" id="4368248">]</span><span class="builtintype" id="4368249">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368255">var</span>&nbsp;<span class="ident" id="4368259">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4368278"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4368282">.</span><span class="ident" id="4368283">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368305">switch</span>&nbsp;<span class="ident" id="4368312">priv</span>&nbsp;<span class="op" id="4368317">:=</span>&nbsp;<span class="ident" id="4368320"><a href="/crypto/x509/x509.go.html#4368055">priv</a></span><span class="op" id="4368324">.</span><span class="op" id="4368325">(</span><span class="keyword" id="4368326">type</span><span class="op" id="4368330">)</span>&nbsp;<span class="op" id="4368332">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368335">case</span>&nbsp;<span class="op" id="4368340">*</span><span class="ident" id="4368341"><a href="/crypto/x509/x509.go.html#4316595">rsa</a></span><span class="op" id="4368344">.</span><span class="ident" id="4368345">PrivateKey</span><span class="op" id="4368355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368359"><a href="/crypto/x509/x509.go.html#4368232">publicKeyBytes</a></span><span class="op" id="4368373">,</span>&nbsp;<span class="ident" id="4368375"><a href="/crypto/x509/x509.go.html#4368259">publicKeyAlgorithm</a></span><span class="op" id="4368393">,</span>&nbsp;<span class="ident" id="4368395"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4368399">=</span>&nbsp;<span class="ident" id="4368401"><a href="/crypto/x509/x509.go.html#4317467">marshalPublicKey</a></span><span class="op" id="4368417">(</span><span class="op" id="4368418">&amp;</span><span class="ident" id="4368419"><a href="/crypto/x509/x509.go.html#4368312">priv</a></span><span class="op" id="4368423">.</span><span class="ident" id="4368424">PublicKey</span><span class="op" id="4368433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368436">case</span>&nbsp;<span class="op" id="4368441">*</span><span class="ident" id="4368442"><a href="/crypto/x509/x509.go.html#4316560">ecdsa</a></span><span class="op" id="4368447">.</span><span class="ident" id="4368448">PrivateKey</span><span class="op" id="4368458">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368462"><a href="/crypto/x509/x509.go.html#4368232">publicKeyBytes</a></span><span class="op" id="4368476">,</span>&nbsp;<span class="ident" id="4368478"><a href="/crypto/x509/x509.go.html#4368259">publicKeyAlgorithm</a></span><span class="op" id="4368496">,</span>&nbsp;<span class="ident" id="4368498"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4368502">=</span>&nbsp;<span class="ident" id="4368504"><a href="/crypto/x509/x509.go.html#4317467">marshalPublicKey</a></span><span class="op" id="4368520">(</span><span class="op" id="4368521">&amp;</span><span class="ident" id="4368522"><a href="/crypto/x509/x509.go.html#4368312">priv</a></span><span class="op" id="4368526">.</span><span class="ident" id="4368527">PublicKey</span><span class="op" id="4368536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368539">default</span><span class="op" id="4368546">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4368550">panic</span><span class="op" id="4368555">(</span><span class="string" id="4368556">&#34;internal&nbsp;error&#34;</span><span class="op" id="4368572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4368575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368579">if</span>&nbsp;<span class="ident" id="4368582"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4368586">!=</span>&nbsp;<span class="ident" id="4368589">nil</span>&nbsp;<span class="op" id="4368593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368597">return</span>&nbsp;<span class="ident" id="4368604">nil</span><span class="op" id="4368607">,</span>&nbsp;<span class="ident" id="4368609"><a href="/crypto/x509/x509.go.html#4368086">err</a></span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4368614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368618">var</span>&nbsp;<span class="ident" id="4368622">extensions</span>&nbsp;<span class="op" id="4368633">[</span><span class="op" id="4368634">]</span><span class="ident" id="4368635"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4368639">.</span><span class="ident" id="4368640">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368652">if</span>&nbsp;<span class="op" id="4368655">(</span><span class="builtinfunc" id="4368656">len</span><span class="op" id="4368659">(</span><span class="ident" id="4368660"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4368668">.</span><span class="ident" id="4368669">DNSNames</span><span class="op" id="4368677">)</span>&nbsp;<span class="op" id="4368679">&gt;</span>&nbsp;<span class="num" id="4368681">0</span>&nbsp;<span class="op" id="4368683">||</span>&nbsp;<span class="builtinfunc" id="4368686">len</span><span class="op" id="4368689">(</span><span class="ident" id="4368690"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4368698">.</span><span class="ident" id="4368699">EmailAddresses</span><span class="op" id="4368713">)</span>&nbsp;<span class="op" id="4368715">&gt;</span>&nbsp;<span class="num" id="4368717">0</span>&nbsp;<span class="op" id="4368719">||</span>&nbsp;<span class="builtinfunc" id="4368722">len</span><span class="op" id="4368725">(</span><span class="ident" id="4368726"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4368734">.</span><span class="ident" id="4368735">IPAddresses</span><span class="op" id="4368746">)</span>&nbsp;<span class="op" id="4368748">&gt;</span>&nbsp;<span class="num" id="4368750">0</span><span class="op" id="4368751">)</span>&nbsp;<span class="op" id="4368753">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4368758">!</span><span class="ident" id="4368759"><a href="/crypto/x509/x509.go.html#4352404">oidInExtensions</a></span><span class="op" id="4368774">(</span><span class="ident" id="4368775"><a href="/crypto/x509/x509.go.html#4351829">oidExtensionSubjectAltName</a></span><span class="op" id="4368801">,</span>&nbsp;<span class="ident" id="4368803"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4368811">.</span><span class="ident" id="4368812">ExtraExtensions</span><span class="op" id="4368827">)</span>&nbsp;<span class="op" id="4368829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368833">sanBytes</span><span class="op" id="4368841">,</span>&nbsp;<span class="ident" id="4368843">err</span>&nbsp;<span class="op" id="4368847">:=</span>&nbsp;<span class="ident" id="4368850"><a href="/crypto/x509/x509.go.html#4352695">marshalSANs</a></span><span class="op" id="4368861">(</span><span class="ident" id="4368862"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4368870">.</span><span class="ident" id="4368871">DNSNames</span><span class="op" id="4368879">,</span>&nbsp;<span class="ident" id="4368881"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4368889">.</span><span class="ident" id="4368890">EmailAddresses</span><span class="op" id="4368904">,</span>&nbsp;<span class="ident" id="4368906"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4368914">.</span><span class="ident" id="4368915">IPAddresses</span><span class="op" id="4368926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368930">if</span>&nbsp;<span class="ident" id="4368933"><a href="/crypto/x509/x509.go.html#4368843">err</a></span>&nbsp;<span class="op" id="4368937">!=</span>&nbsp;<span class="ident" id="4368940">nil</span>&nbsp;<span class="op" id="4368944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368949">return</span>&nbsp;<span class="ident" id="4368956">nil</span><span class="op" id="4368959">,</span>&nbsp;<span class="ident" id="4368961"><a href="/crypto/x509/x509.go.html#4368843">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4368967">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368972"><a href="/crypto/x509/x509.go.html#4368622">extensions</a></span>&nbsp;<span class="op" id="4368983">=</span>&nbsp;<span class="builtinfunc" id="4368985">append</span><span class="op" id="4368991">(</span><span class="ident" id="4368992"><a href="/crypto/x509/x509.go.html#4368622">extensions</a></span><span class="op" id="4369002">,</span>&nbsp;<span class="ident" id="4369004"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4369008">.</span><span class="ident" id="4369009">Extension</span><span class="op" id="4369018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369023">Id</span><span class="op" id="4369025">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369030"><a href="/crypto/x509/x509.go.html#4351829">oidExtensionSubjectAltName</a></span><span class="op" id="4369056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369061">Value</span><span class="op" id="4369066">:</span>&nbsp;<span class="ident" id="4369068"><a href="/crypto/x509/x509.go.html#4368833">sanBytes</a></span><span class="op" id="4369076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4369080">}</span><span class="op" id="4369081">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4369084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369088"><a href="/crypto/x509/x509.go.html#4368622">extensions</a></span>&nbsp;<span class="op" id="4369099">=</span>&nbsp;<span class="builtinfunc" id="4369101">append</span><span class="op" id="4369107">(</span><span class="ident" id="4369108"><a href="/crypto/x509/x509.go.html#4368622">extensions</a></span><span class="op" id="4369118">,</span>&nbsp;<span class="ident" id="4369120"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4369128">.</span><span class="ident" id="4369129">ExtraExtensions</span><span class="op" id="4369144">...</span><span class="op" id="4369147">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369151">var</span>&nbsp;<span class="ident" id="4369155">attributes</span>&nbsp;<span class="op" id="4369166">[</span><span class="op" id="4369167">]</span><span class="ident" id="4369168"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4369172">.</span><span class="ident" id="4369173">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369199"><a href="/crypto/x509/x509.go.html#4369155">attributes</a></span>&nbsp;<span class="op" id="4369210">=</span>&nbsp;<span class="builtinfunc" id="4369212">append</span><span class="op" id="4369218">(</span><span class="ident" id="4369219"><a href="/crypto/x509/x509.go.html#4369155">attributes</a></span><span class="op" id="4369229">,</span>&nbsp;<span class="ident" id="4369231"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4369239">.</span><span class="ident" id="4369240">Attributes</span><span class="op" id="4369250">...</span><span class="op" id="4369253">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369257">if</span>&nbsp;<span class="builtinfunc" id="4369260">len</span><span class="op" id="4369263">(</span><span class="ident" id="4369264"><a href="/crypto/x509/x509.go.html#4368622">extensions</a></span><span class="op" id="4369274">)</span>&nbsp;<span class="op" id="4369276">&gt;</span>&nbsp;<span class="num" id="4369278">0</span>&nbsp;<span class="op" id="4369280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4369284">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4369345">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369391">specifiedExtensions</span>&nbsp;<span class="op" id="4369411">:=</span>&nbsp;<span class="builtinfunc" id="4369414">make</span><span class="op" id="4369418">(</span><span class="keyword" id="4369419">map</span><span class="op" id="4369422">[</span><span class="builtintype" id="4369423">string</span><span class="op" id="4369429">]</span><span class="builtintype" id="4369430">bool</span><span class="op" id="4369434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369439">for</span>&nbsp;<span class="ident" id="4369443">_</span><span class="op" id="4369444">,</span>&nbsp;<span class="ident" id="4369446">atvSet</span>&nbsp;<span class="op" id="4369453">:=</span>&nbsp;<span class="keyword" id="4369456">range</span>&nbsp;<span class="ident" id="4369462"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4369470">.</span><span class="ident" id="4369471">Attributes</span>&nbsp;<span class="op" id="4369482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369487">if</span>&nbsp;<span class="op" id="4369490">!</span><span class="ident" id="4369491"><a href="/crypto/x509/x509.go.html#4369446">atvSet</a></span><span class="op" id="4369497">.</span><span class="ident" id="4369498">Type</span><span class="op" id="4369502">.</span><span class="ident" id="4369503">Equal</span><span class="op" id="4369508">(</span><span class="ident" id="4369509"><a href="/crypto/x509/x509.go.html#4367467">oidExtensionRequest</a></span><span class="op" id="4369528">)</span>&nbsp;<span class="op" id="4369530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369536">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4369548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369554">for</span>&nbsp;<span class="ident" id="4369558">_</span><span class="op" id="4369559">,</span>&nbsp;<span class="ident" id="4369561">atvs</span>&nbsp;<span class="op" id="4369566">:=</span>&nbsp;<span class="keyword" id="4369569">range</span>&nbsp;<span class="ident" id="4369575"><a href="/crypto/x509/x509.go.html#4369446">atvSet</a></span><span class="op" id="4369581">.</span><span class="ident" id="4369582">Value</span>&nbsp;<span class="op" id="4369588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369594">for</span>&nbsp;<span class="ident" id="4369598">_</span><span class="op" id="4369599">,</span>&nbsp;<span class="ident" id="4369601">atv</span>&nbsp;<span class="op" id="4369605">:=</span>&nbsp;<span class="keyword" id="4369608">range</span>&nbsp;<span class="ident" id="4369614"><a href="/crypto/x509/x509.go.html#4369561">atvs</a></span>&nbsp;<span class="op" id="4369619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369626"><a href="/crypto/x509/x509.go.html#4369391">specifiedExtensions</a></span><span class="op" id="4369645">[</span><span class="ident" id="4369646"><a href="/crypto/x509/x509.go.html#4369601">atv</a></span><span class="op" id="4369649">.</span><span class="ident" id="4369650">Type</span><span class="op" id="4369654">.</span><span class="ident" id="4369655">String</span><span class="op" id="4369661">(</span><span class="op" id="4369662">)</span><span class="op" id="4369663">]</span>&nbsp;<span class="op" id="4369665">=</span>&nbsp;<span class="ident" id="4369667">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4369676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4369681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4369685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369690">atvs</span>&nbsp;<span class="op" id="4369695">:=</span>&nbsp;<span class="builtinfunc" id="4369698">make</span><span class="op" id="4369702">(</span><span class="op" id="4369703">[</span><span class="op" id="4369704">]</span><span class="ident" id="4369705"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4369709">.</span><span class="ident" id="4369710">AttributeTypeAndValue</span><span class="op" id="4369731">,</span>&nbsp;<span class="num" id="4369733">0</span><span class="op" id="4369734">,</span>&nbsp;<span class="builtinfunc" id="4369736">len</span><span class="op" id="4369739">(</span><span class="ident" id="4369740"><a href="/crypto/x509/x509.go.html#4368622">extensions</a></span><span class="op" id="4369750">)</span><span class="op" id="4369751">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369755">for</span>&nbsp;<span class="ident" id="4369759">_</span><span class="op" id="4369760">,</span>&nbsp;<span class="ident" id="4369762">e</span>&nbsp;<span class="op" id="4369764">:=</span>&nbsp;<span class="keyword" id="4369767">range</span>&nbsp;<span class="ident" id="4369773"><a href="/crypto/x509/x509.go.html#4368622">extensions</a></span>&nbsp;<span class="op" id="4369784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369789">if</span>&nbsp;<span class="ident" id="4369792"><a href="/crypto/x509/x509.go.html#4369391">specifiedExtensions</a></span><span class="op" id="4369811">[</span><span class="ident" id="4369812"><a href="/crypto/x509/x509.go.html#4369762">e</a></span><span class="op" id="4369813">.</span><span class="ident" id="4369814">Id</span><span class="op" id="4369816">.</span><span class="ident" id="4369817">String</span><span class="op" id="4369823">(</span><span class="op" id="4369824">)</span><span class="op" id="4369825">]</span>&nbsp;<span class="op" id="4369827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4369833">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4369881">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369926">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4369938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369944"><a href="/crypto/x509/x509.go.html#4369690">atvs</a></span>&nbsp;<span class="op" id="4369949">=</span>&nbsp;<span class="builtinfunc" id="4369951">append</span><span class="op" id="4369957">(</span><span class="ident" id="4369958"><a href="/crypto/x509/x509.go.html#4369690">atvs</a></span><span class="op" id="4369962">,</span>&nbsp;<span class="ident" id="4369964"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4369968">.</span><span class="ident" id="4369969">AttributeTypeAndValue</span><span class="op" id="4369990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4369996">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370053">Type</span><span class="op" id="4370057">:</span>&nbsp;&nbsp;<span class="ident" id="4370060"><a href="/crypto/x509/x509.go.html#4369762">e</a></span><span class="op" id="4370061">.</span><span class="ident" id="4370062">Id</span><span class="op" id="4370064">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370070">Value</span><span class="op" id="4370075">:</span>&nbsp;<span class="ident" id="4370077"><a href="/crypto/x509/x509.go.html#4369762">e</a></span><span class="op" id="4370078">.</span><span class="ident" id="4370079">Value</span><span class="op" id="4370084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370089">}</span><span class="op" id="4370090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4370099">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370164">appended</span>&nbsp;<span class="op" id="4370173">:=</span>&nbsp;<span class="ident" id="4370176">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370184">for</span>&nbsp;<span class="ident" id="4370188">_</span><span class="op" id="4370189">,</span>&nbsp;<span class="ident" id="4370191">atvSet</span>&nbsp;<span class="op" id="4370198">:=</span>&nbsp;<span class="keyword" id="4370201">range</span>&nbsp;<span class="ident" id="4370207"><a href="/crypto/x509/x509.go.html#4369155">attributes</a></span>&nbsp;<span class="op" id="4370218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370223">if</span>&nbsp;<span class="op" id="4370226">!</span><span class="ident" id="4370227"><a href="/crypto/x509/x509.go.html#4370191">atvSet</a></span><span class="op" id="4370233">.</span><span class="ident" id="4370234">Type</span><span class="op" id="4370238">.</span><span class="ident" id="4370239">Equal</span><span class="op" id="4370244">(</span><span class="ident" id="4370245"><a href="/crypto/x509/x509.go.html#4367467">oidExtensionRequest</a></span><span class="op" id="4370264">)</span>&nbsp;<span class="op" id="4370266">||</span>&nbsp;<span class="builtinfunc" id="4370269">len</span><span class="op" id="4370272">(</span><span class="ident" id="4370273"><a href="/crypto/x509/x509.go.html#4370191">atvSet</a></span><span class="op" id="4370279">.</span><span class="ident" id="4370280">Value</span><span class="op" id="4370285">)</span>&nbsp;<span class="op" id="4370287">==</span>&nbsp;<span class="num" id="4370290">0</span>&nbsp;<span class="op" id="4370292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370298">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370310">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370316"><a href="/crypto/x509/x509.go.html#4370191">atvSet</a></span><span class="op" id="4370322">.</span><span class="ident" id="4370323">Value</span><span class="op" id="4370328">[</span><span class="num" id="4370329">0</span><span class="op" id="4370330">]</span>&nbsp;<span class="op" id="4370332">=</span>&nbsp;<span class="builtinfunc" id="4370334">append</span><span class="op" id="4370340">(</span><span class="ident" id="4370341"><a href="/crypto/x509/x509.go.html#4370191">atvSet</a></span><span class="op" id="4370347">.</span><span class="ident" id="4370348">Value</span><span class="op" id="4370353">[</span><span class="num" id="4370354">0</span><span class="op" id="4370355">]</span><span class="op" id="4370356">,</span>&nbsp;<span class="ident" id="4370358"><a href="/crypto/x509/x509.go.html#4369690">atvs</a></span><span class="op" id="4370362">...</span><span class="op" id="4370365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370370"><a href="/crypto/x509/x509.go.html#4370164">appended</a></span>&nbsp;<span class="op" id="4370379">=</span>&nbsp;<span class="ident" id="4370381">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370389">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370397">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4370402">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370458">if</span>&nbsp;<span class="op" id="4370461">!</span><span class="ident" id="4370462"><a href="/crypto/x509/x509.go.html#4370164">appended</a></span>&nbsp;<span class="op" id="4370471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370476"><a href="/crypto/x509/x509.go.html#4369155">attributes</a></span>&nbsp;<span class="op" id="4370487">=</span>&nbsp;<span class="builtinfunc" id="4370489">append</span><span class="op" id="4370495">(</span><span class="ident" id="4370496"><a href="/crypto/x509/x509.go.html#4369155">attributes</a></span><span class="op" id="4370506">,</span>&nbsp;<span class="ident" id="4370508"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4370512">.</span><span class="ident" id="4370513">AttributeTypeAndValueSET</span><span class="op" id="4370537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370543">Type</span><span class="op" id="4370547">:</span>&nbsp;<span class="ident" id="4370549"><a href="/crypto/x509/x509.go.html#4367467">oidExtensionRequest</a></span><span class="op" id="4370568">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370574">Value</span><span class="op" id="4370579">:</span>&nbsp;<span class="op" id="4370581">[</span><span class="op" id="4370582">]</span><span class="op" id="4370583">[</span><span class="op" id="4370584">]</span><span class="ident" id="4370585"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4370589">.</span><span class="ident" id="4370590">AttributeTypeAndValue</span><span class="op" id="4370611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370618"><a href="/crypto/x509/x509.go.html#4369690">atvs</a></span><span class="op" id="4370622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370628">}</span><span class="op" id="4370629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370634">}</span><span class="op" id="4370635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370639">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370646">asn1Subject</span>&nbsp;<span class="op" id="4370658">:=</span>&nbsp;<span class="ident" id="4370661"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4370669">.</span><span class="ident" id="4370670">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370682">if</span>&nbsp;<span class="builtinfunc" id="4370685">len</span><span class="op" id="4370688">(</span><span class="ident" id="4370689"><a href="/crypto/x509/x509.go.html#4370646">asn1Subject</a></span><span class="op" id="4370700">)</span>&nbsp;<span class="op" id="4370702">==</span>&nbsp;<span class="num" id="4370705">0</span>&nbsp;<span class="op" id="4370707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370711"><a href="/crypto/x509/x509.go.html#4370646">asn1Subject</a></span><span class="op" id="4370722">,</span>&nbsp;<span class="ident" id="4370724"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4370728">=</span>&nbsp;<span class="ident" id="4370730"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4370734">.</span><span class="ident" id="4370735">Marshal</span><span class="op" id="4370742">(</span><span class="ident" id="4370743"><a href="/crypto/x509/x509.go.html#4368025">template</a></span><span class="op" id="4370751">.</span><span class="ident" id="4370752">Subject</span><span class="op" id="4370759">.</span><span class="ident" id="4370760">ToRDNSequence</span><span class="op" id="4370773">(</span><span class="op" id="4370774">)</span><span class="op" id="4370775">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370779">if</span>&nbsp;<span class="ident" id="4370782"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4370786">!=</span>&nbsp;<span class="ident" id="4370789">nil</span>&nbsp;<span class="op" id="4370793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370798">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370814">tbsCSR</span>&nbsp;<span class="op" id="4370821">:=</span>&nbsp;<span class="ident" id="4370824"><a href="/crypto/x509/x509.go.html#4366978">tbsCertificateRequest</a></span><span class="op" id="4370845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370849">Version</span><span class="op" id="4370856">:</span>&nbsp;<span class="num" id="4370858">0</span><span class="op" id="4370859">,</span>&nbsp;<span class="comment" id="4370861">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370885">Subject</span><span class="op" id="4370892">:</span>&nbsp;<span class="ident" id="4370894"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4370898">.</span><span class="ident" id="4370899">RawValue</span><span class="op" id="4370907">{</span><span class="ident" id="4370908">FullBytes</span><span class="op" id="4370917">:</span>&nbsp;<span class="ident" id="4370919"><a href="/crypto/x509/x509.go.html#4370646">asn1Subject</a></span><span class="op" id="4370930">}</span><span class="op" id="4370931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370935">PublicKey</span><span class="op" id="4370944">:</span>&nbsp;<span class="ident" id="4370946"><a href="/crypto/x509/x509.go.html#4320121">publicKeyInfo</a></span><span class="op" id="4370959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370964">Algorithm</span><span class="op" id="4370973">:</span>&nbsp;<span class="ident" id="4370975"><a href="/crypto/x509/x509.go.html#4368259">publicKeyAlgorithm</a></span><span class="op" id="4370993">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370998">PublicKey</span><span class="op" id="4371007">:</span>&nbsp;<span class="ident" id="4371009"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4371013">.</span><span class="ident" id="4371014">BitString</span><span class="op" id="4371023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371029">Bytes</span><span class="op" id="4371034">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371040"><a href="/crypto/x509/x509.go.html#4368232">publicKeyBytes</a></span><span class="op" id="4371054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371060">BitLength</span><span class="op" id="4371069">:</span>&nbsp;<span class="builtinfunc" id="4371071">len</span><span class="op" id="4371074">(</span><span class="ident" id="4371075"><a href="/crypto/x509/x509.go.html#4368232">publicKeyBytes</a></span><span class="op" id="4371089">)</span>&nbsp;<span class="op" id="4371091">*</span>&nbsp;<span class="num" id="4371093">8</span><span class="op" id="4371094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371099">}</span><span class="op" id="4371100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371104">}</span><span class="op" id="4371105">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371109">Attributes</span><span class="op" id="4371119">:</span>&nbsp;<span class="ident" id="4371121"><a href="/crypto/x509/x509.go.html#4369155">attributes</a></span><span class="op" id="4371131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371138">tbsCSRContents</span><span class="op" id="4371152">,</span>&nbsp;<span class="ident" id="4371154"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4371158">:=</span>&nbsp;<span class="ident" id="4371161"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4371165">.</span><span class="ident" id="4371166">Marshal</span><span class="op" id="4371173">(</span><span class="ident" id="4371174"><a href="/crypto/x509/x509.go.html#4370814">tbsCSR</a></span><span class="op" id="4371180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371183">if</span>&nbsp;<span class="ident" id="4371186"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4371190">!=</span>&nbsp;<span class="ident" id="4371193">nil</span>&nbsp;<span class="op" id="4371197">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371201">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371212"><a href="/crypto/x509/x509.go.html#4370814">tbsCSR</a></span><span class="op" id="4371218">.</span><span class="ident" id="4371219">Raw</span>&nbsp;<span class="op" id="4371223">=</span>&nbsp;<span class="ident" id="4371225"><a href="/crypto/x509/x509.go.html#4371138">tbsCSRContents</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371242">h</span>&nbsp;<span class="op" id="4371244">:=</span>&nbsp;<span class="ident" id="4371247"><a href="/crypto/x509/x509.go.html#4368100">hashFunc</a></span><span class="op" id="4371255">.</span><span class="ident" id="4371256">New</span><span class="op" id="4371259">(</span><span class="op" id="4371260">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371263"><a href="/crypto/x509/x509.go.html#4371242">h</a></span><span class="op" id="4371264">.</span><span class="ident" id="4371265">Write</span><span class="op" id="4371270">(</span><span class="ident" id="4371271"><a href="/crypto/x509/x509.go.html#4371138">tbsCSRContents</a></span><span class="op" id="4371285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371288">digest</span>&nbsp;<span class="op" id="4371295">:=</span>&nbsp;<span class="ident" id="4371298"><a href="/crypto/x509/x509.go.html#4371242">h</a></span><span class="op" id="4371299">.</span><span class="ident" id="4371300">Sum</span><span class="op" id="4371303">(</span><span class="ident" id="4371304">nil</span><span class="op" id="4371307">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371311">var</span>&nbsp;<span class="ident" id="4371315">signature</span>&nbsp;<span class="op" id="4371325">[</span><span class="op" id="4371326">]</span><span class="builtintype" id="4371327">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371333">switch</span>&nbsp;<span class="ident" id="4371340">priv</span>&nbsp;<span class="op" id="4371345">:=</span>&nbsp;<span class="ident" id="4371348"><a href="/crypto/x509/x509.go.html#4368055">priv</a></span><span class="op" id="4371352">.</span><span class="op" id="4371353">(</span><span class="keyword" id="4371354">type</span><span class="op" id="4371358">)</span>&nbsp;<span class="op" id="4371360">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371363">case</span>&nbsp;<span class="op" id="4371368">*</span><span class="ident" id="4371369"><a href="/crypto/x509/x509.go.html#4316595">rsa</a></span><span class="op" id="4371372">.</span><span class="ident" id="4371373">PrivateKey</span><span class="op" id="4371383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371387"><a href="/crypto/x509/x509.go.html#4371315">signature</a></span><span class="op" id="4371396">,</span>&nbsp;<span class="ident" id="4371398"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4371402">=</span>&nbsp;<span class="ident" id="4371404"><a href="/crypto/x509/x509.go.html#4316595">rsa</a></span><span class="op" id="4371407">.</span><span class="ident" id="4371408">SignPKCS1v15</span><span class="op" id="4371420">(</span><span class="ident" id="4371421"><a href="/crypto/x509/x509.go.html#4368009">rand</a></span><span class="op" id="4371425">,</span>&nbsp;<span class="ident" id="4371427"><a href="/crypto/x509/x509.go.html#4371340">priv</a></span><span class="op" id="4371431">,</span>&nbsp;<span class="ident" id="4371433"><a href="/crypto/x509/x509.go.html#4368100">hashFunc</a></span><span class="op" id="4371441">,</span>&nbsp;<span class="ident" id="4371443"><a href="/crypto/x509/x509.go.html#4371288">digest</a></span><span class="op" id="4371449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371452">case</span>&nbsp;<span class="op" id="4371457">*</span><span class="ident" id="4371458"><a href="/crypto/x509/x509.go.html#4316560">ecdsa</a></span><span class="op" id="4371463">.</span><span class="ident" id="4371464">PrivateKey</span><span class="op" id="4371474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371478">var</span>&nbsp;<span class="ident" id="4371482">r</span><span class="op" id="4371483">,</span>&nbsp;<span class="ident" id="4371485">s</span>&nbsp;<span class="op" id="4371487">*</span><span class="ident" id="4371488"><a href="/crypto/x509/x509.go.html#4316731">big</a></span><span class="op" id="4371491">.</span><span class="ident" id="4371492">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371498">if</span>&nbsp;<span class="ident" id="4371501"><a href="/crypto/x509/x509.go.html#4371482">r</a></span><span class="op" id="4371502">,</span>&nbsp;<span class="ident" id="4371504"><a href="/crypto/x509/x509.go.html#4371485">s</a></span><span class="op" id="4371505">,</span>&nbsp;<span class="ident" id="4371507"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4371511">=</span>&nbsp;<span class="ident" id="4371513"><a href="/crypto/x509/x509.go.html#4316560">ecdsa</a></span><span class="op" id="4371518">.</span><span class="ident" id="4371519">Sign</span><span class="op" id="4371523">(</span><span class="ident" id="4371524"><a href="/crypto/x509/x509.go.html#4368009">rand</a></span><span class="op" id="4371528">,</span>&nbsp;<span class="ident" id="4371530"><a href="/crypto/x509/x509.go.html#4371340">priv</a></span><span class="op" id="4371534">,</span>&nbsp;<span class="ident" id="4371536"><a href="/crypto/x509/x509.go.html#4371288">digest</a></span><span class="op" id="4371542">)</span><span class="op" id="4371543">;</span>&nbsp;<span class="ident" id="4371545"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4371549">==</span>&nbsp;<span class="ident" id="4371552">nil</span>&nbsp;<span class="op" id="4371556">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371561"><a href="/crypto/x509/x509.go.html#4371315">signature</a></span><span class="op" id="4371570">,</span>&nbsp;<span class="ident" id="4371572"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4371576">=</span>&nbsp;<span class="ident" id="4371578"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4371582">.</span><span class="ident" id="4371583">Marshal</span><span class="op" id="4371590">(</span><span class="ident" id="4371591"><a href="/crypto/x509/x509.go.html#4320030">ecdsaSignature</a></span><span class="op" id="4371605">{</span><span class="ident" id="4371606"><a href="/crypto/x509/x509.go.html#4371482">r</a></span><span class="op" id="4371607">,</span>&nbsp;<span class="ident" id="4371609"><a href="/crypto/x509/x509.go.html#4371485">s</a></span><span class="op" id="4371610">}</span><span class="op" id="4371611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371618">default</span><span class="op" id="4371625">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4371629">panic</span><span class="op" id="4371634">(</span><span class="string" id="4371635">&#34;internal&nbsp;error&#34;</span><span class="op" id="4371651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371654">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371658">if</span>&nbsp;<span class="ident" id="4371661"><a href="/crypto/x509/x509.go.html#4368086">err</a></span>&nbsp;<span class="op" id="4371665">!=</span>&nbsp;<span class="ident" id="4371668">nil</span>&nbsp;<span class="op" id="4371672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371676">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371688">return</span>&nbsp;<span class="ident" id="4371695"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4371699">.</span><span class="ident" id="4371700">Marshal</span><span class="op" id="4371707">(</span><span class="ident" id="4371708"><a href="/crypto/x509/x509.go.html#4367172">certificateRequest</a></span><span class="op" id="4371726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371730">TBSCSR</span><span class="op" id="4371736">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371750"><a href="/crypto/x509/x509.go.html#4370814">tbsCSR</a></span><span class="op" id="4371756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371760">SignatureAlgorithm</span><span class="op" id="4371778">:</span>&nbsp;<span class="ident" id="4371780"><a href="/crypto/x509/x509.go.html#4368110">sigAlgo</a></span><span class="op" id="4371787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371791">SignatureValue</span><span class="op" id="4371805">:</span>&nbsp;<span class="ident" id="4371807"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4371811">.</span><span class="ident" id="4371812">BitString</span><span class="op" id="4371821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371826">Bytes</span><span class="op" id="4371831">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371837"><a href="/crypto/x509/x509.go.html#4371315">signature</a></span><span class="op" id="4371846">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371851">BitLength</span><span class="op" id="4371860">:</span>&nbsp;<span class="builtinfunc" id="4371862">len</span><span class="op" id="4371865">(</span><span class="ident" id="4371866"><a href="/crypto/x509/x509.go.html#4371315">signature</a></span><span class="op" id="4371875">)</span>&nbsp;<span class="op" id="4371877">*</span>&nbsp;<span class="num" id="4371879">8</span><span class="op" id="4371880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371884">}</span><span class="op" id="4371885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371888">}</span><span class="op" id="4371889">)</span><br>
<span class="lineno"></span><span class="op" id="4371891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="4371894">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4371966">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4371991">func</span>&nbsp;<span class="ident" id="4371996">ParseCertificateRequest</span><span class="op" id="4372019">(</span><span class="ident" id="4372020">asn1Data</span>&nbsp;<span class="op" id="4372029">[</span><span class="op" id="4372030">]</span><span class="builtintype" id="4372031">byte</span><span class="op" id="4372035">)</span>&nbsp;<span class="op" id="4372037">(</span><span class="op" id="4372038">*</span><span class="ident" id="4372039"><a href="/crypto/x509/x509.go.html#4365470">CertificateRequest</a></span><span class="op" id="4372057">,</span>&nbsp;<span class="builtintype" id="4372059">error</span><span class="op" id="4372064">)</span>&nbsp;<span class="op" id="4372066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372069">var</span>&nbsp;<span class="ident" id="4372073">csr</span>&nbsp;<span class="ident" id="4372077"><a href="/crypto/x509/x509.go.html#4367172">certificateRequest</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372098">rest</span><span class="op" id="4372102">,</span>&nbsp;<span class="ident" id="4372104">err</span>&nbsp;<span class="op" id="4372108">:=</span>&nbsp;<span class="ident" id="4372111"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4372115">.</span><span class="ident" id="4372116">Unmarshal</span><span class="op" id="4372125">(</span><span class="ident" id="4372126"><a href="/crypto/x509/x509.go.html#4372020">asn1Data</a></span><span class="op" id="4372134">,</span>&nbsp;<span class="op" id="4372136">&amp;</span><span class="ident" id="4372137"><a href="/crypto/x509/x509.go.html#4372073">csr</a></span><span class="op" id="4372140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372143">if</span>&nbsp;<span class="ident" id="4372146"><a href="/crypto/x509/x509.go.html#4372104">err</a></span>&nbsp;<span class="op" id="4372150">!=</span>&nbsp;<span class="ident" id="4372153">nil</span>&nbsp;<span class="op" id="4372157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372161">return</span>&nbsp;<span class="ident" id="4372168">nil</span><span class="op" id="4372171">,</span>&nbsp;<span class="ident" id="4372173"><a href="/crypto/x509/x509.go.html#4372104">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4372178">}</span>&nbsp;<span class="keyword" id="4372180">else</span>&nbsp;<span class="keyword" id="4372185">if</span>&nbsp;<span class="builtinfunc" id="4372188">len</span><span class="op" id="4372191">(</span><span class="ident" id="4372192"><a href="/crypto/x509/x509.go.html#4372098">rest</a></span><span class="op" id="4372196">)</span>&nbsp;<span class="op" id="4372198">!=</span>&nbsp;<span class="num" id="4372201">0</span>&nbsp;<span class="op" id="4372203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372207">return</span>&nbsp;<span class="ident" id="4372214">nil</span><span class="op" id="4372217">,</span>&nbsp;<span class="ident" id="4372219"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4372223">.</span><span class="ident" id="4372224">SyntaxError</span><span class="op" id="4372235">{</span><span class="ident" id="4372236">Msg</span><span class="op" id="4372239">:</span>&nbsp;<span class="string" id="4372241">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4372256">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4372259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372263">return</span>&nbsp;<span class="ident" id="4372270"><a href="/crypto/x509/x509.go.html#4372308">parseCertificateRequest</a></span><span class="op" id="4372293">(</span><span class="op" id="4372294">&amp;</span><span class="ident" id="4372295"><a href="/crypto/x509/x509.go.html#4372073">csr</a></span><span class="op" id="4372298">)</span><br>
<span class="lineno"></span><span class="op" id="4372300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4372303">func</span>&nbsp;<span class="ident" id="4372308">parseCertificateRequest</span><span class="op" id="4372331">(</span><span class="ident" id="4372332">in</span>&nbsp;<span class="op" id="4372335">*</span><span class="ident" id="4372336"><a href="/crypto/x509/x509.go.html#4367172">certificateRequest</a></span><span class="op" id="4372354">)</span>&nbsp;<span class="op" id="4372356">(</span><span class="op" id="4372357">*</span><span class="ident" id="4372358"><a href="/crypto/x509/x509.go.html#4365470">CertificateRequest</a></span><span class="op" id="4372376">,</span>&nbsp;<span class="builtintype" id="4372378">error</span><span class="op" id="4372383">)</span>&nbsp;<span class="op" id="4372385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372388">out</span>&nbsp;<span class="op" id="4372392">:=</span>&nbsp;<span class="op" id="4372395">&amp;</span><span class="ident" id="4372396"><a href="/crypto/x509/x509.go.html#4365470">CertificateRequest</a></span><span class="op" id="4372414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372418">Raw</span><span class="op" id="4372421">:</span>&nbsp;<span class="ident" id="4372423"><a href="/crypto/x509/x509.go.html#4372332">in</a></span><span class="op" id="4372425">.</span><span class="ident" id="4372426">Raw</span><span class="op" id="4372429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372433">RawTBSCertificateRequest</span><span class="op" id="4372457">:</span>&nbsp;<span class="ident" id="4372459"><a href="/crypto/x509/x509.go.html#4372332">in</a></span><span class="op" id="4372461">.</span><span class="ident" id="4372462">TBSCSR</span><span class="op" id="4372468">.</span><span class="ident" id="4372469">Raw</span><span class="op" id="4372472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372476">RawSubjectPublicKeyInfo</span><span class="op" id="4372499">:</span>&nbsp;&nbsp;<span class="ident" id="4372502"><a href="/crypto/x509/x509.go.html#4372332">in</a></span><span class="op" id="4372504">.</span><span class="ident" id="4372505">TBSCSR</span><span class="op" id="4372511">.</span><span class="ident" id="4372512">PublicKey</span><span class="op" id="4372521">.</span><span class="ident" id="4372522">Raw</span><span class="op" id="4372525">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372529">RawSubject</span><span class="op" id="4372539">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372555"><a href="/crypto/x509/x509.go.html#4372332">in</a></span><span class="op" id="4372557">.</span><span class="ident" id="4372558">TBSCSR</span><span class="op" id="4372564">.</span><span class="ident" id="4372565">Subject</span><span class="op" id="4372572">.</span><span class="ident" id="4372573">FullBytes</span><span class="op" id="4372582">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372587">Signature</span><span class="op" id="4372596">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372607"><a href="/crypto/x509/x509.go.html#4372332">in</a></span><span class="op" id="4372609">.</span><span class="ident" id="4372610">SignatureValue</span><span class="op" id="4372624">.</span><span class="ident" id="4372625">RightAlign</span><span class="op" id="4372635">(</span><span class="op" id="4372636">)</span><span class="op" id="4372637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372641">SignatureAlgorithm</span><span class="op" id="4372659">:</span>&nbsp;<span class="ident" id="4372661"><a href="/crypto/x509/x509.go.html#4324214">getSignatureAlgorithmFromOID</a></span><span class="op" id="4372689">(</span><span class="ident" id="4372690"><a href="/crypto/x509/x509.go.html#4372332">in</a></span><span class="op" id="4372692">.</span><span class="ident" id="4372693">SignatureAlgorithm</span><span class="op" id="4372711">.</span><span class="ident" id="4372712">Algorithm</span><span class="op" id="4372721">)</span><span class="op" id="4372722">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372727">PublicKeyAlgorithm</span><span class="op" id="4372745">:</span>&nbsp;<span class="ident" id="4372747"><a href="/crypto/x509/x509.go.html#4325144">getPublicKeyAlgorithmFromOID</a></span><span class="op" id="4372775">(</span><span class="ident" id="4372776"><a href="/crypto/x509/x509.go.html#4372332">in</a></span><span class="op" id="4372778">.</span><span class="ident" id="4372779">TBSCSR</span><span class="op" id="4372785">.</span><span class="ident" id="4372786">PublicKey</span><span class="op" id="4372795">.</span><span class="ident" id="4372796">Algorithm</span><span class="op" id="4372805">.</span><span class="ident" id="4372806">Algorithm</span><span class="op" id="4372815">)</span><span class="op" id="4372816">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372821">Version</span><span class="op" id="4372828">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372833"><a href="/crypto/x509/x509.go.html#4372332">in</a></span><span class="op" id="4372835">.</span><span class="ident" id="4372836">TBSCSR</span><span class="op" id="4372842">.</span><span class="ident" id="4372843">Version</span><span class="op" id="4372850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372854">Attributes</span><span class="op" id="4372864">:</span>&nbsp;<span class="ident" id="4372866"><a href="/crypto/x509/x509.go.html#4372332">in</a></span><span class="op" id="4372868">.</span><span class="ident" id="4372869">TBSCSR</span><span class="op" id="4372875">.</span><span class="ident" id="4372876">Attributes</span><span class="op" id="4372886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4372889">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372893">var</span>&nbsp;<span class="ident" id="4372897">err</span>&nbsp;<span class="builtintype" id="4372901">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372908"><a href="/crypto/x509/x509.go.html#4372388">out</a></span><span class="op" id="4372911">.</span><span class="ident" id="4372912">PublicKey</span><span class="op" id="4372921">,</span>&nbsp;<span class="ident" id="4372923"><a href="/crypto/x509/x509.go.html#4372897">err</a></span>&nbsp;<span class="op" id="4372927">=</span>&nbsp;<span class="ident" id="4372929"><a href="/crypto/x509/x509.go.html#4340338">parsePublicKey</a></span><span class="op" id="4372943">(</span><span class="ident" id="4372944"><a href="/crypto/x509/x509.go.html#4372388">out</a></span><span class="op" id="4372947">.</span><span class="ident" id="4372948">PublicKeyAlgorithm</span><span class="op" id="4372966">,</span>&nbsp;<span class="op" id="4372968">&amp;</span><span class="ident" id="4372969"><a href="/crypto/x509/x509.go.html#4372332">in</a></span><span class="op" id="4372971">.</span><span class="ident" id="4372972">TBSCSR</span><span class="op" id="4372978">.</span><span class="ident" id="4372979">PublicKey</span><span class="op" id="4372988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372991">if</span>&nbsp;<span class="ident" id="4372994"><a href="/crypto/x509/x509.go.html#4372897">err</a></span>&nbsp;<span class="op" id="4372998">!=</span>&nbsp;<span class="ident" id="4373001">nil</span>&nbsp;<span class="op" id="4373005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373009">return</span>&nbsp;<span class="ident" id="4373016">nil</span><span class="op" id="4373019">,</span>&nbsp;<span class="ident" id="4373021"><a href="/crypto/x509/x509.go.html#4372897">err</a></span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373030">var</span>&nbsp;<span class="ident" id="4373034">subject</span>&nbsp;<span class="ident" id="4373042"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4373046">.</span><span class="ident" id="4373047">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373060">if</span>&nbsp;<span class="ident" id="4373063">_</span><span class="op" id="4373064">,</span>&nbsp;<span class="ident" id="4373066">err</span>&nbsp;<span class="op" id="4373070">:=</span>&nbsp;<span class="ident" id="4373073"><a href="/crypto/x509/x509.go.html#4316682">asn1</a></span><span class="op" id="4373077">.</span><span class="ident" id="4373078">Unmarshal</span><span class="op" id="4373087">(</span><span class="ident" id="4373088"><a href="/crypto/x509/x509.go.html#4372332">in</a></span><span class="op" id="4373090">.</span><span class="ident" id="4373091">TBSCSR</span><span class="op" id="4373097">.</span><span class="ident" id="4373098">Subject</span><span class="op" id="4373105">.</span><span class="ident" id="4373106">FullBytes</span><span class="op" id="4373115">,</span>&nbsp;<span class="op" id="4373117">&amp;</span><span class="ident" id="4373118"><a href="/crypto/x509/x509.go.html#4373034">subject</a></span><span class="op" id="4373125">)</span><span class="op" id="4373126">;</span>&nbsp;<span class="ident" id="4373128"><a href="/crypto/x509/x509.go.html#4373066">err</a></span>&nbsp;<span class="op" id="4373132">!=</span>&nbsp;<span class="ident" id="4373135">nil</span>&nbsp;<span class="op" id="4373139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373143">return</span>&nbsp;<span class="ident" id="4373150">nil</span><span class="op" id="4373153">,</span>&nbsp;<span class="ident" id="4373155"><a href="/crypto/x509/x509.go.html#4373066">err</a></span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373164"><a href="/crypto/x509/x509.go.html#4372388">out</a></span><span class="op" id="4373167">.</span><span class="ident" id="4373168">Subject</span><span class="op" id="4373175">.</span><span class="ident" id="4373176">FillFromRDNSequence</span><span class="op" id="4373195">(</span><span class="op" id="4373196">&amp;</span><span class="ident" id="4373197"><a href="/crypto/x509/x509.go.html#4373034">subject</a></span><span class="op" id="4373204">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373208">var</span>&nbsp;<span class="ident" id="4373212">extensions</span>&nbsp;<span class="op" id="4373223">[</span><span class="op" id="4373224">]</span><span class="ident" id="4373225"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4373229">.</span><span class="ident" id="4373230">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373254">for</span>&nbsp;<span class="ident" id="4373258">_</span><span class="op" id="4373259">,</span>&nbsp;<span class="ident" id="4373261">atvSet</span>&nbsp;<span class="op" id="4373268">:=</span>&nbsp;<span class="keyword" id="4373271">range</span>&nbsp;<span class="ident" id="4373277"><a href="/crypto/x509/x509.go.html#4372332">in</a></span><span class="op" id="4373279">.</span><span class="ident" id="4373280">TBSCSR</span><span class="op" id="4373286">.</span><span class="ident" id="4373287">Attributes</span>&nbsp;<span class="op" id="4373298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373302">if</span>&nbsp;<span class="op" id="4373305">!</span><span class="ident" id="4373306"><a href="/crypto/x509/x509.go.html#4373261">atvSet</a></span><span class="op" id="4373312">.</span><span class="ident" id="4373313">Type</span><span class="op" id="4373317">.</span><span class="ident" id="4373318">Equal</span><span class="op" id="4373323">(</span><span class="ident" id="4373324"><a href="/crypto/x509/x509.go.html#4367467">oidExtensionRequest</a></span><span class="op" id="4373343">)</span>&nbsp;<span class="op" id="4373345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373350">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373361">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373366">for</span>&nbsp;<span class="ident" id="4373370">_</span><span class="op" id="4373371">,</span>&nbsp;<span class="ident" id="4373373">atvs</span>&nbsp;<span class="op" id="4373378">:=</span>&nbsp;<span class="keyword" id="4373381">range</span>&nbsp;<span class="ident" id="4373387"><a href="/crypto/x509/x509.go.html#4373261">atvSet</a></span><span class="op" id="4373393">.</span><span class="ident" id="4373394">Value</span>&nbsp;<span class="op" id="4373400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373405"><a href="/crypto/x509/x509.go.html#4373212">extensions</a></span>&nbsp;<span class="op" id="4373416">=</span>&nbsp;<span class="builtinfunc" id="4373418">append</span><span class="op" id="4373424">(</span><span class="ident" id="4373425"><a href="/crypto/x509/x509.go.html#4373212">extensions</a></span><span class="op" id="4373435">,</span>&nbsp;<span class="ident" id="4373437"><a href="/crypto/x509/x509.go.html#4373373">atvs</a></span><span class="op" id="4373441">...</span><span class="op" id="4373444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373451">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373455"><a href="/crypto/x509/x509.go.html#4372388">out</a></span><span class="op" id="4373458">.</span><span class="ident" id="4373459">Extensions</span>&nbsp;<span class="op" id="4373470">=</span>&nbsp;<span class="builtinfunc" id="4373472">make</span><span class="op" id="4373476">(</span><span class="op" id="4373477">[</span><span class="op" id="4373478">]</span><span class="ident" id="4373479"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4373483">.</span><span class="ident" id="4373484">Extension</span><span class="op" id="4373493">,</span>&nbsp;<span class="num" id="4373495">0</span><span class="op" id="4373496">,</span>&nbsp;<span class="builtinfunc" id="4373498">len</span><span class="op" id="4373501">(</span><span class="ident" id="4373502"><a href="/crypto/x509/x509.go.html#4373212">extensions</a></span><span class="op" id="4373512">)</span><span class="op" id="4373513">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373517">for</span>&nbsp;<span class="ident" id="4373521">_</span><span class="op" id="4373522">,</span>&nbsp;<span class="ident" id="4373524">e</span>&nbsp;<span class="op" id="4373526">:=</span>&nbsp;<span class="keyword" id="4373529">range</span>&nbsp;<span class="ident" id="4373535"><a href="/crypto/x509/x509.go.html#4373212">extensions</a></span>&nbsp;<span class="op" id="4373546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373550">value</span><span class="op" id="4373555">,</span>&nbsp;<span class="ident" id="4373557">ok</span>&nbsp;<span class="op" id="4373560">:=</span>&nbsp;<span class="ident" id="4373563"><a href="/crypto/x509/x509.go.html#4373524">e</a></span><span class="op" id="4373564">.</span><span class="ident" id="4373565">Value</span><span class="op" id="4373570">.</span><span class="op" id="4373571">(</span><span class="op" id="4373572">[</span><span class="op" id="4373573">]</span><span class="builtintype" id="4373574">byte</span><span class="op" id="4373578">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373582">if</span>&nbsp;<span class="op" id="4373585">!</span><span class="ident" id="4373586"><a href="/crypto/x509/x509.go.html#4373557">ok</a></span>&nbsp;<span class="op" id="4373589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373594">return</span>&nbsp;<span class="ident" id="4373601">nil</span><span class="op" id="4373604">,</span>&nbsp;<span class="ident" id="4373606"><a href="/crypto/x509/x509.go.html#4316715">errors</a></span><span class="op" id="4373612">.</span><span class="ident" id="4373613">New</span><span class="op" id="4373616">(</span><span class="string" id="4373617">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="4373676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373685"><a href="/crypto/x509/x509.go.html#4372388">out</a></span><span class="op" id="4373688">.</span><span class="ident" id="4373689">Extensions</span>&nbsp;<span class="op" id="4373700">=</span>&nbsp;<span class="builtinfunc" id="4373702">append</span><span class="op" id="4373708">(</span><span class="ident" id="4373709"><a href="/crypto/x509/x509.go.html#4372388">out</a></span><span class="op" id="4373712">.</span><span class="ident" id="4373713">Extensions</span><span class="op" id="4373723">,</span>&nbsp;<span class="ident" id="4373725"><a href="/crypto/x509/x509.go.html#4316662">pkix</a></span><span class="op" id="4373729">.</span><span class="ident" id="4373730">Extension</span><span class="op" id="4373739">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373744">Id</span><span class="op" id="4373746">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4373751"><a href="/crypto/x509/x509.go.html#4373524">e</a></span><span class="op" id="4373752">.</span><span class="ident" id="4373753">Type</span><span class="op" id="4373757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373762">Value</span><span class="op" id="4373767">:</span>&nbsp;<span class="ident" id="4373769"><a href="/crypto/x509/x509.go.html#4373550">value</a></span><span class="op" id="4373774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373778">}</span><span class="op" id="4373779">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373784">if</span>&nbsp;<span class="builtinfunc" id="4373787">len</span><span class="op" id="4373790">(</span><span class="ident" id="4373791"><a href="/crypto/x509/x509.go.html#4373524">e</a></span><span class="op" id="4373792">.</span><span class="ident" id="4373793">Type</span><span class="op" id="4373797">)</span>&nbsp;<span class="op" id="4373799">==</span>&nbsp;<span class="num" id="4373802">4</span>&nbsp;<span class="op" id="4373804">&amp;&amp;</span>&nbsp;<span class="ident" id="4373807"><a href="/crypto/x509/x509.go.html#4373524">e</a></span><span class="op" id="4373808">.</span><span class="ident" id="4373809">Type</span><span class="op" id="4373813">[</span><span class="num" id="4373814">0</span><span class="op" id="4373815">]</span>&nbsp;<span class="op" id="4373817">==</span>&nbsp;<span class="num" id="4373820">2</span>&nbsp;<span class="op" id="4373822">&amp;&amp;</span>&nbsp;<span class="ident" id="4373825"><a href="/crypto/x509/x509.go.html#4373524">e</a></span><span class="op" id="4373826">.</span><span class="ident" id="4373827">Type</span><span class="op" id="4373831">[</span><span class="num" id="4373832">1</span><span class="op" id="4373833">]</span>&nbsp;<span class="op" id="4373835">==</span>&nbsp;<span class="num" id="4373838">5</span>&nbsp;<span class="op" id="4373840">&amp;&amp;</span>&nbsp;<span class="ident" id="4373843"><a href="/crypto/x509/x509.go.html#4373524">e</a></span><span class="op" id="4373844">.</span><span class="ident" id="4373845">Type</span><span class="op" id="4373849">[</span><span class="num" id="4373850">2</span><span class="op" id="4373851">]</span>&nbsp;<span class="op" id="4373853">==</span>&nbsp;<span class="num" id="4373856">29</span>&nbsp;<span class="op" id="4373859">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373864">switch</span>&nbsp;<span class="ident" id="4373871"><a href="/crypto/x509/x509.go.html#4373524">e</a></span><span class="op" id="4373872">.</span><span class="ident" id="4373873">Type</span><span class="op" id="4373877">[</span><span class="num" id="4373878">3</span><span class="op" id="4373879">]</span>&nbsp;<span class="op" id="4373881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373886">case</span>&nbsp;<span class="num" id="4373891">17</span><span class="op" id="4373893">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373899"><a href="/crypto/x509/x509.go.html#4372388">out</a></span><span class="op" id="4373902">.</span><span class="ident" id="4373903">DNSNames</span><span class="op" id="4373911">,</span>&nbsp;<span class="ident" id="4373913"><a href="/crypto/x509/x509.go.html#4372388">out</a></span><span class="op" id="4373916">.</span><span class="ident" id="4373917">EmailAddresses</span><span class="op" id="4373931">,</span>&nbsp;<span class="ident" id="4373933"><a href="/crypto/x509/x509.go.html#4372388">out</a></span><span class="op" id="4373936">.</span><span class="ident" id="4373937">IPAddresses</span><span class="op" id="4373948">,</span>&nbsp;<span class="ident" id="4373950"><a href="/crypto/x509/x509.go.html#4372897">err</a></span>&nbsp;<span class="op" id="4373954">=</span>&nbsp;<span class="ident" id="4373956"><a href="/crypto/x509/x509.go.html#4342103">parseSANExtension</a></span><span class="op" id="4373973">(</span><span class="ident" id="4373974"><a href="/crypto/x509/x509.go.html#4373550">value</a></span><span class="op" id="4373979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373985">if</span>&nbsp;<span class="ident" id="4373988"><a href="/crypto/x509/x509.go.html#4372897">err</a></span>&nbsp;<span class="op" id="4373992">!=</span>&nbsp;<span class="ident" id="4373995">nil</span>&nbsp;<span class="op" id="4373999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374006">return</span>&nbsp;<span class="ident" id="4374013">nil</span><span class="op" id="4374016">,</span>&nbsp;<span class="ident" id="4374018"><a href="/crypto/x509/x509.go.html#4372897">err</a></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374042">return</span>&nbsp;<span class="ident" id="4374049"><a href="/crypto/x509/x509.go.html#4372388">out</a></span><span class="op" id="4374052">,</span>&nbsp;<span class="ident" id="4374054">nil</span><br>
<span class="lineno"></span><span class="op" id="4374058">}</span>
</div>
</body>
</html>
