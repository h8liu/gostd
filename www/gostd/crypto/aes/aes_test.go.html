<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html" class="current">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8042761">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8042816">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8042870">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8042921">package</span>&nbsp;<span class="ident" id="8042929">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8042934">import</span>&nbsp;<span class="op" id="8042941">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8042944">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8042954">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="8042957">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8043001">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="8043045">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="8043090">func</span>&nbsp;<span class="ident" id="8043095">TestPowx</span><span class="op" id="8043103">(</span><span class="ident" id="8043104">t</span>&nbsp;<span class="op" id="8043106">*</span><span class="ident" id="8043107">testing</span><span class="op" id="8043114">.</span><span class="ident" id="8043115">T</span><span class="op" id="8043116">)</span>&nbsp;<span class="op" id="8043118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8043121">p</span>&nbsp;<span class="op" id="8043123">:=</span>&nbsp;<span class="num" id="8043126">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8043129">for</span>&nbsp;<span class="ident" id="8043133">i</span>&nbsp;<span class="op" id="8043135">:=</span>&nbsp;<span class="num" id="8043138">0</span><span class="op" id="8043139">;</span>&nbsp;<span class="ident" id="8043141">i</span>&nbsp;<span class="op" id="8043143">&lt;</span>&nbsp;<span class="builtinfunc" id="8043145">len</span><span class="op" id="8043148">(</span><span class="ident" id="8043149">powx</span><span class="op" id="8043153">)</span><span class="op" id="8043154">;</span>&nbsp;<span class="ident" id="8043156">i</span><span class="op" id="8043157">++</span>&nbsp;<span class="op" id="8043160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8043164">if</span>&nbsp;<span class="ident" id="8043167">powx</span><span class="op" id="8043171">[</span><span class="ident" id="8043172">i</span><span class="op" id="8043173">]</span>&nbsp;<span class="op" id="8043175">!=</span>&nbsp;<span class="builtintype" id="8043178">byte</span><span class="op" id="8043182">(</span><span class="ident" id="8043183">p</span><span class="op" id="8043184">)</span>&nbsp;<span class="op" id="8043186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8043191">t</span><span class="op" id="8043192">.</span><span class="ident" id="8043193">Errorf</span><span class="op" id="8043199">(</span><span class="string" id="8043200">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8043226">,</span>&nbsp;<span class="ident" id="8043228">i</span><span class="op" id="8043229">,</span>&nbsp;<span class="ident" id="8043231">powx</span><span class="op" id="8043235">[</span><span class="ident" id="8043236">i</span><span class="op" id="8043237">]</span><span class="op" id="8043238">,</span>&nbsp;<span class="ident" id="8043240">p</span><span class="op" id="8043241">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8043245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8043249">p</span>&nbsp;<span class="op" id="8043251">&lt;&lt;=</span>&nbsp;<span class="num" id="8043255">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8043259">if</span>&nbsp;<span class="ident" id="8043262">p</span><span class="op" id="8043263">&amp;</span><span class="num" id="8043264">0x100</span>&nbsp;<span class="op" id="8043270">!=</span>&nbsp;<span class="num" id="8043273">0</span>&nbsp;<span class="op" id="8043275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8043280">p</span>&nbsp;<span class="op" id="8043282">^=</span>&nbsp;<span class="ident" id="8043285">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8043292">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8043295">}</span><br>
<span class="lineno"></span><span class="op" id="8043297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8043300">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="8043353">func</span>&nbsp;<span class="ident" id="8043358">mul</span><span class="op" id="8043361">(</span><span class="ident" id="8043362">b</span><span class="op" id="8043363">,</span>&nbsp;<span class="ident" id="8043365">c</span>&nbsp;<span class="builtintype" id="8043367">uint32</span><span class="op" id="8043373">)</span>&nbsp;<span class="builtintype" id="8043375">uint32</span>&nbsp;<span class="op" id="8043382">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8043385">i</span>&nbsp;<span class="op" id="8043387">:=</span>&nbsp;<span class="ident" id="8043390">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8043393">j</span>&nbsp;<span class="op" id="8043395">:=</span>&nbsp;<span class="ident" id="8043398">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8043401">s</span>&nbsp;<span class="op" id="8043403">:=</span>&nbsp;<span class="builtintype" id="8043406">uint32</span><span class="op" id="8043412">(</span><span class="num" id="8043413">0</span><span class="op" id="8043414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8043417">for</span>&nbsp;<span class="ident" id="8043421">k</span>&nbsp;<span class="op" id="8043423">:=</span>&nbsp;<span class="builtintype" id="8043426">uint32</span><span class="op" id="8043432">(</span><span class="num" id="8043433">1</span><span class="op" id="8043434">)</span><span class="op" id="8043435">;</span>&nbsp;<span class="ident" id="8043437">k</span>&nbsp;<span class="op" id="8043439">&lt;</span>&nbsp;<span class="num" id="8043441">0x100</span>&nbsp;<span class="op" id="8043447">&amp;&amp;</span>&nbsp;<span class="ident" id="8043450">j</span>&nbsp;<span class="op" id="8043452">!=</span>&nbsp;<span class="num" id="8043455">0</span><span class="op" id="8043456">;</span>&nbsp;<span class="ident" id="8043458">k</span>&nbsp;<span class="op" id="8043460">&lt;&lt;=</span>&nbsp;<span class="num" id="8043464">1</span>&nbsp;<span class="op" id="8043466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8043470">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;x‚Åø</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8043512">if</span>&nbsp;<span class="ident" id="8043515">j</span><span class="op" id="8043516">&amp;</span><span class="ident" id="8043517">k</span>&nbsp;<span class="op" id="8043519">!=</span>&nbsp;<span class="num" id="8043522">0</span>&nbsp;<span class="op" id="8043524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8043529">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8043566">s</span>&nbsp;<span class="op" id="8043568">^=</span>&nbsp;<span class="ident" id="8043571">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8043576">j</span>&nbsp;<span class="op" id="8043578">^=</span>&nbsp;<span class="ident" id="8043581">k</span>&nbsp;<span class="comment" id="8043583">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8043619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8043624">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8043667">i</span>&nbsp;<span class="op" id="8043669">&lt;&lt;=</span>&nbsp;<span class="num" id="8043673">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8043677">if</span>&nbsp;<span class="ident" id="8043680">i</span><span class="op" id="8043681">&amp;</span><span class="num" id="8043682">0x100</span>&nbsp;<span class="op" id="8043688">!=</span>&nbsp;<span class="num" id="8043691">0</span>&nbsp;<span class="op" id="8043693">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8043698">i</span>&nbsp;<span class="op" id="8043700">^=</span>&nbsp;<span class="ident" id="8043703">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8043710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8043713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8043716">return</span>&nbsp;<span class="ident" id="8043723">s</span><br>
<span class="lineno"></span><span class="op" id="8043725">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="8043728">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n¬≤&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="8043785">func</span>&nbsp;<span class="ident" id="8043790">TestMul</span><span class="op" id="8043797">(</span><span class="ident" id="8043798">t</span>&nbsp;<span class="op" id="8043800">*</span><span class="ident" id="8043801">testing</span><span class="op" id="8043808">.</span><span class="ident" id="8043809">T</span><span class="op" id="8043810">)</span>&nbsp;<span class="op" id="8043812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8043815">for</span>&nbsp;<span class="ident" id="8043819">i</span>&nbsp;<span class="op" id="8043821">:=</span>&nbsp;<span class="builtintype" id="8043824">uint32</span><span class="op" id="8043830">(</span><span class="num" id="8043831">0</span><span class="op" id="8043832">)</span><span class="op" id="8043833">;</span>&nbsp;<span class="ident" id="8043835">i</span>&nbsp;<span class="op" id="8043837">&lt;</span>&nbsp;<span class="num" id="8043839">256</span><span class="op" id="8043842">;</span>&nbsp;<span class="ident" id="8043844">i</span><span class="op" id="8043845">++</span>&nbsp;<span class="op" id="8043848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8043852">for</span>&nbsp;<span class="ident" id="8043856">j</span>&nbsp;<span class="op" id="8043858">:=</span>&nbsp;<span class="builtintype" id="8043861">uint32</span><span class="op" id="8043867">(</span><span class="num" id="8043868">0</span><span class="op" id="8043869">)</span><span class="op" id="8043870">;</span>&nbsp;<span class="ident" id="8043872">j</span>&nbsp;<span class="op" id="8043874">&lt;</span>&nbsp;<span class="num" id="8043876">256</span><span class="op" id="8043879">;</span>&nbsp;<span class="ident" id="8043881">j</span><span class="op" id="8043882">++</span>&nbsp;<span class="op" id="8043885">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8043890">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8043922">s</span>&nbsp;<span class="op" id="8043924">:=</span>&nbsp;<span class="builtintype" id="8043927">uint8</span><span class="op" id="8043932">(</span><span class="num" id="8043933">0</span><span class="op" id="8043934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8043939">for</span>&nbsp;<span class="ident" id="8043943">k</span>&nbsp;<span class="op" id="8043945">:=</span>&nbsp;<span class="builtintype" id="8043948">uint</span><span class="op" id="8043952">(</span><span class="num" id="8043953">0</span><span class="op" id="8043954">)</span><span class="op" id="8043955">;</span>&nbsp;<span class="ident" id="8043957">k</span>&nbsp;<span class="op" id="8043959">&lt;</span>&nbsp;<span class="num" id="8043961">8</span><span class="op" id="8043962">;</span>&nbsp;<span class="ident" id="8043964">k</span><span class="op" id="8043965">++</span>&nbsp;<span class="op" id="8043968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8043974">for</span>&nbsp;<span class="ident" id="8043978">l</span>&nbsp;<span class="op" id="8043980">:=</span>&nbsp;<span class="builtintype" id="8043983">uint</span><span class="op" id="8043987">(</span><span class="num" id="8043988">0</span><span class="op" id="8043989">)</span><span class="op" id="8043990">;</span>&nbsp;<span class="ident" id="8043992">l</span>&nbsp;<span class="op" id="8043994">&lt;</span>&nbsp;<span class="num" id="8043996">8</span><span class="op" id="8043997">;</span>&nbsp;<span class="ident" id="8043999">l</span><span class="op" id="8044000">++</span>&nbsp;<span class="op" id="8044003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8044010">if</span>&nbsp;<span class="ident" id="8044013">i</span><span class="op" id="8044014">&amp;</span><span class="op" id="8044015">(</span><span class="num" id="8044016">1</span><span class="op" id="8044017">&lt;&lt;</span><span class="ident" id="8044019">k</span><span class="op" id="8044020">)</span>&nbsp;<span class="op" id="8044022">!=</span>&nbsp;<span class="num" id="8044025">0</span>&nbsp;<span class="op" id="8044027">&amp;&amp;</span>&nbsp;<span class="ident" id="8044030">j</span><span class="op" id="8044031">&amp;</span><span class="op" id="8044032">(</span><span class="num" id="8044033">1</span><span class="op" id="8044034">&lt;&lt;</span><span class="ident" id="8044036">l</span><span class="op" id="8044037">)</span>&nbsp;<span class="op" id="8044039">!=</span>&nbsp;<span class="num" id="8044042">0</span>&nbsp;<span class="op" id="8044044">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8044052">s</span>&nbsp;<span class="op" id="8044054">^=</span>&nbsp;<span class="ident" id="8044057">powx</span><span class="op" id="8044061">[</span><span class="ident" id="8044062">k</span><span class="op" id="8044063">+</span><span class="ident" id="8044064">l</span><span class="op" id="8044065">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8044072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8044078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8044083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8044088">if</span>&nbsp;<span class="ident" id="8044091">x</span>&nbsp;<span class="op" id="8044093">:=</span>&nbsp;<span class="ident" id="8044096">mul</span><span class="op" id="8044099">(</span><span class="ident" id="8044100">i</span><span class="op" id="8044101">,</span>&nbsp;<span class="ident" id="8044103">j</span><span class="op" id="8044104">)</span><span class="op" id="8044105">;</span>&nbsp;<span class="ident" id="8044107">x</span>&nbsp;<span class="op" id="8044109">!=</span>&nbsp;<span class="builtintype" id="8044112">uint32</span><span class="op" id="8044118">(</span><span class="ident" id="8044119">s</span><span class="op" id="8044120">)</span>&nbsp;<span class="op" id="8044122">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8044128">t</span><span class="op" id="8044129">.</span><span class="ident" id="8044130">Fatalf</span><span class="op" id="8044136">(</span><span class="string" id="8044137">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8044168">,</span>&nbsp;<span class="ident" id="8044170">i</span><span class="op" id="8044171">,</span>&nbsp;<span class="ident" id="8044173">j</span><span class="op" id="8044174">,</span>&nbsp;<span class="ident" id="8044176">x</span><span class="op" id="8044177">,</span>&nbsp;<span class="ident" id="8044179">s</span><span class="op" id="8044180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8044185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8044189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8044192">}</span><br>
<span class="lineno"></span><span class="op" id="8044194">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="8044197">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="8044247">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="8044295">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="8044344">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="8044391">func</span>&nbsp;<span class="ident" id="8044396">TestSboxes</span><span class="op" id="8044406">(</span><span class="ident" id="8044407">t</span>&nbsp;<span class="op" id="8044409">*</span><span class="ident" id="8044410">testing</span><span class="op" id="8044417">.</span><span class="ident" id="8044418">T</span><span class="op" id="8044419">)</span>&nbsp;<span class="op" id="8044421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8044424">for</span>&nbsp;<span class="ident" id="8044428">i</span>&nbsp;<span class="op" id="8044430">:=</span>&nbsp;<span class="num" id="8044433">0</span><span class="op" id="8044434">;</span>&nbsp;<span class="ident" id="8044436">i</span>&nbsp;<span class="op" id="8044438">&lt;</span>&nbsp;<span class="num" id="8044440">256</span><span class="op" id="8044443">;</span>&nbsp;<span class="ident" id="8044445">i</span><span class="op" id="8044446">++</span>&nbsp;<span class="op" id="8044449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8044453">if</span>&nbsp;<span class="ident" id="8044456">j</span>&nbsp;<span class="op" id="8044458">:=</span>&nbsp;<span class="ident" id="8044461">sbox0</span><span class="op" id="8044466">[</span><span class="ident" id="8044467">sbox1</span><span class="op" id="8044472">[</span><span class="ident" id="8044473">i</span><span class="op" id="8044474">]</span><span class="op" id="8044475">]</span><span class="op" id="8044476">;</span>&nbsp;<span class="ident" id="8044478">j</span>&nbsp;<span class="op" id="8044480">!=</span>&nbsp;<span class="builtintype" id="8044483">byte</span><span class="op" id="8044487">(</span><span class="ident" id="8044488">i</span><span class="op" id="8044489">)</span>&nbsp;<span class="op" id="8044491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8044496">t</span><span class="op" id="8044497">.</span><span class="ident" id="8044498">Errorf</span><span class="op" id="8044504">(</span><span class="string" id="8044505">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="8044530">,</span>&nbsp;<span class="ident" id="8044532">i</span><span class="op" id="8044533">,</span>&nbsp;<span class="ident" id="8044535">j</span><span class="op" id="8044536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8044540">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8044544">if</span>&nbsp;<span class="ident" id="8044547">j</span>&nbsp;<span class="op" id="8044549">:=</span>&nbsp;<span class="ident" id="8044552">sbox1</span><span class="op" id="8044557">[</span><span class="ident" id="8044558">sbox0</span><span class="op" id="8044563">[</span><span class="ident" id="8044564">i</span><span class="op" id="8044565">]</span><span class="op" id="8044566">]</span><span class="op" id="8044567">;</span>&nbsp;<span class="ident" id="8044569">j</span>&nbsp;<span class="op" id="8044571">!=</span>&nbsp;<span class="builtintype" id="8044574">byte</span><span class="op" id="8044578">(</span><span class="ident" id="8044579">i</span><span class="op" id="8044580">)</span>&nbsp;<span class="op" id="8044582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8044587">t</span><span class="op" id="8044588">.</span><span class="ident" id="8044589">Errorf</span><span class="op" id="8044595">(</span><span class="string" id="8044596">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="8044621">,</span>&nbsp;<span class="ident" id="8044623">i</span><span class="op" id="8044624">,</span>&nbsp;<span class="ident" id="8044626">j</span><span class="op" id="8044627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8044631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8044634">}</span><br>
<span class="lineno"></span><span class="op" id="8044636">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="8044639">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="8044683">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="8044730">func</span>&nbsp;<span class="ident" id="8044735">TestTe</span><span class="op" id="8044741">(</span><span class="ident" id="8044742">t</span>&nbsp;<span class="op" id="8044744">*</span><span class="ident" id="8044745">testing</span><span class="op" id="8044752">.</span><span class="ident" id="8044753">T</span><span class="op" id="8044754">)</span>&nbsp;<span class="op" id="8044756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8044759">for</span>&nbsp;<span class="ident" id="8044763">i</span>&nbsp;<span class="op" id="8044765">:=</span>&nbsp;<span class="num" id="8044768">0</span><span class="op" id="8044769">;</span>&nbsp;<span class="ident" id="8044771">i</span>&nbsp;<span class="op" id="8044773">&lt;</span>&nbsp;<span class="num" id="8044775">256</span><span class="op" id="8044778">;</span>&nbsp;<span class="ident" id="8044780">i</span><span class="op" id="8044781">++</span>&nbsp;<span class="op" id="8044784">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8044788">s</span>&nbsp;<span class="op" id="8044790">:=</span>&nbsp;<span class="builtintype" id="8044793">uint32</span><span class="op" id="8044799">(</span><span class="ident" id="8044800">sbox0</span><span class="op" id="8044805">[</span><span class="ident" id="8044806">i</span><span class="op" id="8044807">]</span><span class="op" id="8044808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8044812">s2</span>&nbsp;<span class="op" id="8044815">:=</span>&nbsp;<span class="ident" id="8044818">mul</span><span class="op" id="8044821">(</span><span class="ident" id="8044822">s</span><span class="op" id="8044823">,</span>&nbsp;<span class="num" id="8044825">2</span><span class="op" id="8044826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8044830">s3</span>&nbsp;<span class="op" id="8044833">:=</span>&nbsp;<span class="ident" id="8044836">mul</span><span class="op" id="8044839">(</span><span class="ident" id="8044840">s</span><span class="op" id="8044841">,</span>&nbsp;<span class="num" id="8044843">3</span><span class="op" id="8044844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8044848">w</span>&nbsp;<span class="op" id="8044850">:=</span>&nbsp;<span class="ident" id="8044853">s2</span><span class="op" id="8044855">&lt;&lt;</span><span class="num" id="8044857">24</span>&nbsp;<span class="op" id="8044860">|</span>&nbsp;<span class="ident" id="8044862">s</span><span class="op" id="8044863">&lt;&lt;</span><span class="num" id="8044865">16</span>&nbsp;<span class="op" id="8044868">|</span>&nbsp;<span class="ident" id="8044870">s</span><span class="op" id="8044871">&lt;&lt;</span><span class="num" id="8044873">8</span>&nbsp;<span class="op" id="8044875">|</span>&nbsp;<span class="ident" id="8044877">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8044882">te</span>&nbsp;<span class="op" id="8044885">:=</span>&nbsp;<span class="op" id="8044888">[</span><span class="op" id="8044889">]</span><span class="op" id="8044890">[</span><span class="num" id="8044891">256</span><span class="op" id="8044894">]</span><span class="builtintype" id="8044895">uint32</span><span class="op" id="8044901">{</span><span class="ident" id="8044902">te0</span><span class="op" id="8044905">,</span>&nbsp;<span class="ident" id="8044907">te1</span><span class="op" id="8044910">,</span>&nbsp;<span class="ident" id="8044912">te2</span><span class="op" id="8044915">,</span>&nbsp;<span class="ident" id="8044917">te3</span><span class="op" id="8044920">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8044924">for</span>&nbsp;<span class="ident" id="8044928">j</span>&nbsp;<span class="op" id="8044930">:=</span>&nbsp;<span class="num" id="8044933">0</span><span class="op" id="8044934">;</span>&nbsp;<span class="ident" id="8044936">j</span>&nbsp;<span class="op" id="8044938">&lt;</span>&nbsp;<span class="num" id="8044940">4</span><span class="op" id="8044941">;</span>&nbsp;<span class="ident" id="8044943">j</span><span class="op" id="8044944">++</span>&nbsp;<span class="op" id="8044947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8044952">if</span>&nbsp;<span class="ident" id="8044955">x</span>&nbsp;<span class="op" id="8044957">:=</span>&nbsp;<span class="ident" id="8044960">te</span><span class="op" id="8044962">[</span><span class="ident" id="8044963">j</span><span class="op" id="8044964">]</span><span class="op" id="8044965">[</span><span class="ident" id="8044966">i</span><span class="op" id="8044967">]</span><span class="op" id="8044968">;</span>&nbsp;<span class="ident" id="8044970">x</span>&nbsp;<span class="op" id="8044972">!=</span>&nbsp;<span class="ident" id="8044975">w</span>&nbsp;<span class="op" id="8044977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8044983">t</span><span class="op" id="8044984">.</span><span class="ident" id="8044985">Fatalf</span><span class="op" id="8044991">(</span><span class="string" id="8044992">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8045020">,</span>&nbsp;<span class="ident" id="8045022">j</span><span class="op" id="8045023">,</span>&nbsp;<span class="ident" id="8045025">i</span><span class="op" id="8045026">,</span>&nbsp;<span class="ident" id="8045028">x</span><span class="op" id="8045029">,</span>&nbsp;<span class="ident" id="8045031">w</span><span class="op" id="8045032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8045037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045042">w</span>&nbsp;<span class="op" id="8045044">=</span>&nbsp;<span class="ident" id="8045046">w</span><span class="op" id="8045047">&lt;&lt;</span><span class="num" id="8045049">24</span>&nbsp;<span class="op" id="8045052">|</span>&nbsp;<span class="ident" id="8045054">w</span><span class="op" id="8045055">&gt;&gt;</span><span class="num" id="8045057">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8045061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8045064">}</span><br>
<span class="lineno"></span><span class="op" id="8045066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8045069">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="8045113">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="8045160">func</span>&nbsp;<span class="ident" id="8045165">TestTd</span><span class="op" id="8045171">(</span><span class="ident" id="8045172">t</span>&nbsp;<span class="op" id="8045174">*</span><span class="ident" id="8045175">testing</span><span class="op" id="8045182">.</span><span class="ident" id="8045183">T</span><span class="op" id="8045184">)</span>&nbsp;<span class="op" id="8045186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8045189">for</span>&nbsp;<span class="ident" id="8045193">i</span>&nbsp;<span class="op" id="8045195">:=</span>&nbsp;<span class="num" id="8045198">0</span><span class="op" id="8045199">;</span>&nbsp;<span class="ident" id="8045201">i</span>&nbsp;<span class="op" id="8045203">&lt;</span>&nbsp;<span class="num" id="8045205">256</span><span class="op" id="8045208">;</span>&nbsp;<span class="ident" id="8045210">i</span><span class="op" id="8045211">++</span>&nbsp;<span class="op" id="8045214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045218">s</span>&nbsp;<span class="op" id="8045220">:=</span>&nbsp;<span class="builtintype" id="8045223">uint32</span><span class="op" id="8045229">(</span><span class="ident" id="8045230">sbox1</span><span class="op" id="8045235">[</span><span class="ident" id="8045236">i</span><span class="op" id="8045237">]</span><span class="op" id="8045238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045242">s9</span>&nbsp;<span class="op" id="8045245">:=</span>&nbsp;<span class="ident" id="8045248">mul</span><span class="op" id="8045251">(</span><span class="ident" id="8045252">s</span><span class="op" id="8045253">,</span>&nbsp;<span class="num" id="8045255">0x9</span><span class="op" id="8045258">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045262">sb</span>&nbsp;<span class="op" id="8045265">:=</span>&nbsp;<span class="ident" id="8045268">mul</span><span class="op" id="8045271">(</span><span class="ident" id="8045272">s</span><span class="op" id="8045273">,</span>&nbsp;<span class="num" id="8045275">0xb</span><span class="op" id="8045278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045282">sd</span>&nbsp;<span class="op" id="8045285">:=</span>&nbsp;<span class="ident" id="8045288">mul</span><span class="op" id="8045291">(</span><span class="ident" id="8045292">s</span><span class="op" id="8045293">,</span>&nbsp;<span class="num" id="8045295">0xd</span><span class="op" id="8045298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045302">se</span>&nbsp;<span class="op" id="8045305">:=</span>&nbsp;<span class="ident" id="8045308">mul</span><span class="op" id="8045311">(</span><span class="ident" id="8045312">s</span><span class="op" id="8045313">,</span>&nbsp;<span class="num" id="8045315">0xe</span><span class="op" id="8045318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045322">w</span>&nbsp;<span class="op" id="8045324">:=</span>&nbsp;<span class="ident" id="8045327">se</span><span class="op" id="8045329">&lt;&lt;</span><span class="num" id="8045331">24</span>&nbsp;<span class="op" id="8045334">|</span>&nbsp;<span class="ident" id="8045336">s9</span><span class="op" id="8045338">&lt;&lt;</span><span class="num" id="8045340">16</span>&nbsp;<span class="op" id="8045343">|</span>&nbsp;<span class="ident" id="8045345">sd</span><span class="op" id="8045347">&lt;&lt;</span><span class="num" id="8045349">8</span>&nbsp;<span class="op" id="8045351">|</span>&nbsp;<span class="ident" id="8045353">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045358">td</span>&nbsp;<span class="op" id="8045361">:=</span>&nbsp;<span class="op" id="8045364">[</span><span class="op" id="8045365">]</span><span class="op" id="8045366">[</span><span class="num" id="8045367">256</span><span class="op" id="8045370">]</span><span class="builtintype" id="8045371">uint32</span><span class="op" id="8045377">{</span><span class="ident" id="8045378">td0</span><span class="op" id="8045381">,</span>&nbsp;<span class="ident" id="8045383">td1</span><span class="op" id="8045386">,</span>&nbsp;<span class="ident" id="8045388">td2</span><span class="op" id="8045391">,</span>&nbsp;<span class="ident" id="8045393">td3</span><span class="op" id="8045396">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8045400">for</span>&nbsp;<span class="ident" id="8045404">j</span>&nbsp;<span class="op" id="8045406">:=</span>&nbsp;<span class="num" id="8045409">0</span><span class="op" id="8045410">;</span>&nbsp;<span class="ident" id="8045412">j</span>&nbsp;<span class="op" id="8045414">&lt;</span>&nbsp;<span class="num" id="8045416">4</span><span class="op" id="8045417">;</span>&nbsp;<span class="ident" id="8045419">j</span><span class="op" id="8045420">++</span>&nbsp;<span class="op" id="8045423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8045428">if</span>&nbsp;<span class="ident" id="8045431">x</span>&nbsp;<span class="op" id="8045433">:=</span>&nbsp;<span class="ident" id="8045436">td</span><span class="op" id="8045438">[</span><span class="ident" id="8045439">j</span><span class="op" id="8045440">]</span><span class="op" id="8045441">[</span><span class="ident" id="8045442">i</span><span class="op" id="8045443">]</span><span class="op" id="8045444">;</span>&nbsp;<span class="ident" id="8045446">x</span>&nbsp;<span class="op" id="8045448">!=</span>&nbsp;<span class="ident" id="8045451">w</span>&nbsp;<span class="op" id="8045453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045459">t</span><span class="op" id="8045460">.</span><span class="ident" id="8045461">Fatalf</span><span class="op" id="8045467">(</span><span class="string" id="8045468">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8045496">,</span>&nbsp;<span class="ident" id="8045498">j</span><span class="op" id="8045499">,</span>&nbsp;<span class="ident" id="8045501">i</span><span class="op" id="8045502">,</span>&nbsp;<span class="ident" id="8045504">x</span><span class="op" id="8045505">,</span>&nbsp;<span class="ident" id="8045507">w</span><span class="op" id="8045508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8045513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045518">w</span>&nbsp;<span class="op" id="8045520">=</span>&nbsp;<span class="ident" id="8045522">w</span><span class="op" id="8045523">&lt;&lt;</span><span class="num" id="8045525">24</span>&nbsp;<span class="op" id="8045528">|</span>&nbsp;<span class="ident" id="8045530">w</span><span class="op" id="8045531">&gt;&gt;</span><span class="num" id="8045533">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8045537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8045540">}</span><br>
<span class="lineno"></span><span class="op" id="8045542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8045545">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="8045580">//&nbsp;&nbsp;&nbsp;&nbsphttp://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8045648">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="8045698">type</span>&nbsp;<span class="ident" id="8045703">KeyTest</span>&nbsp;<span class="keyword" id="8045711">struct</span>&nbsp;<span class="op" id="8045718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045721">key</span>&nbsp;<span class="op" id="8045725">[</span><span class="op" id="8045726">]</span><span class="builtintype" id="8045727">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045733">enc</span>&nbsp;<span class="op" id="8045737">[</span><span class="op" id="8045738">]</span><span class="builtintype" id="8045739">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8045747">dec</span>&nbsp;<span class="op" id="8045751">[</span><span class="op" id="8045752">]</span><span class="builtintype" id="8045753">uint32</span>&nbsp;<span class="comment" id="8045760">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="8045834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8045837">var</span>&nbsp;<span class="ident" id="8045841">keyTests</span>&nbsp;<span class="op" id="8045850">=</span>&nbsp;<span class="op" id="8045852">[</span><span class="op" id="8045853">]</span><span class="ident" id="8045854">KeyTest</span><span class="op" id="8045861">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8045864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8045868">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8045913">[</span><span class="op" id="8045914">]</span><span class="builtintype" id="8045915">byte</span><span class="op" id="8045919">{</span><span class="num" id="8045920">0x2b</span><span class="op" id="8045924">,</span>&nbsp;<span class="num" id="8045926">0x7e</span><span class="op" id="8045930">,</span>&nbsp;<span class="num" id="8045932">0x15</span><span class="op" id="8045936">,</span>&nbsp;<span class="num" id="8045938">0x16</span><span class="op" id="8045942">,</span>&nbsp;<span class="num" id="8045944">0x28</span><span class="op" id="8045948">,</span>&nbsp;<span class="num" id="8045950">0xae</span><span class="op" id="8045954">,</span>&nbsp;<span class="num" id="8045956">0xd2</span><span class="op" id="8045960">,</span>&nbsp;<span class="num" id="8045962">0xa6</span><span class="op" id="8045966">,</span>&nbsp;<span class="num" id="8045968">0xab</span><span class="op" id="8045972">,</span>&nbsp;<span class="num" id="8045974">0xf7</span><span class="op" id="8045978">,</span>&nbsp;<span class="num" id="8045980">0x15</span><span class="op" id="8045984">,</span>&nbsp;<span class="num" id="8045986">0x88</span><span class="op" id="8045990">,</span>&nbsp;<span class="num" id="8045992">0x09</span><span class="op" id="8045996">,</span>&nbsp;<span class="num" id="8045998">0xcf</span><span class="op" id="8046002">,</span>&nbsp;<span class="num" id="8046004">0x4f</span><span class="op" id="8046008">,</span>&nbsp;<span class="num" id="8046010">0x3c</span><span class="op" id="8046014">}</span><span class="op" id="8046015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8046019">[</span><span class="op" id="8046020">]</span><span class="builtintype" id="8046021">uint32</span><span class="op" id="8046027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046032">0x2b7e1516</span><span class="op" id="8046042">,</span>&nbsp;<span class="num" id="8046044">0x28aed2a6</span><span class="op" id="8046054">,</span>&nbsp;<span class="num" id="8046056">0xabf71588</span><span class="op" id="8046066">,</span>&nbsp;<span class="num" id="8046068">0x09cf4f3c</span><span class="op" id="8046078">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046083">0xa0fafe17</span><span class="op" id="8046093">,</span>&nbsp;<span class="num" id="8046095">0x88542cb1</span><span class="op" id="8046105">,</span>&nbsp;<span class="num" id="8046107">0x23a33939</span><span class="op" id="8046117">,</span>&nbsp;<span class="num" id="8046119">0x2a6c7605</span><span class="op" id="8046129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046134">0xf2c295f2</span><span class="op" id="8046144">,</span>&nbsp;<span class="num" id="8046146">0x7a96b943</span><span class="op" id="8046156">,</span>&nbsp;<span class="num" id="8046158">0x5935807a</span><span class="op" id="8046168">,</span>&nbsp;<span class="num" id="8046170">0x7359f67f</span><span class="op" id="8046180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046185">0x3d80477d</span><span class="op" id="8046195">,</span>&nbsp;<span class="num" id="8046197">0x4716fe3e</span><span class="op" id="8046207">,</span>&nbsp;<span class="num" id="8046209">0x1e237e44</span><span class="op" id="8046219">,</span>&nbsp;<span class="num" id="8046221">0x6d7a883b</span><span class="op" id="8046231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046236">0xef44a541</span><span class="op" id="8046246">,</span>&nbsp;<span class="num" id="8046248">0xa8525b7f</span><span class="op" id="8046258">,</span>&nbsp;<span class="num" id="8046260">0xb671253b</span><span class="op" id="8046270">,</span>&nbsp;<span class="num" id="8046272">0xdb0bad00</span><span class="op" id="8046282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046287">0xd4d1c6f8</span><span class="op" id="8046297">,</span>&nbsp;<span class="num" id="8046299">0x7c839d87</span><span class="op" id="8046309">,</span>&nbsp;<span class="num" id="8046311">0xcaf2b8bc</span><span class="op" id="8046321">,</span>&nbsp;<span class="num" id="8046323">0x11f915bc</span><span class="op" id="8046333">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046338">0x6d88a37a</span><span class="op" id="8046348">,</span>&nbsp;<span class="num" id="8046350">0x110b3efd</span><span class="op" id="8046360">,</span>&nbsp;<span class="num" id="8046362">0xdbf98641</span><span class="op" id="8046372">,</span>&nbsp;<span class="num" id="8046374">0xca0093fd</span><span class="op" id="8046384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046389">0x4e54f70e</span><span class="op" id="8046399">,</span>&nbsp;<span class="num" id="8046401">0x5f5fc9f3</span><span class="op" id="8046411">,</span>&nbsp;<span class="num" id="8046413">0x84a64fb2</span><span class="op" id="8046423">,</span>&nbsp;<span class="num" id="8046425">0x4ea6dc4f</span><span class="op" id="8046435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046440">0xead27321</span><span class="op" id="8046450">,</span>&nbsp;<span class="num" id="8046452">0xb58dbad2</span><span class="op" id="8046462">,</span>&nbsp;<span class="num" id="8046464">0x312bf560</span><span class="op" id="8046474">,</span>&nbsp;<span class="num" id="8046476">0x7f8d292f</span><span class="op" id="8046486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046491">0xac7766f3</span><span class="op" id="8046501">,</span>&nbsp;<span class="num" id="8046503">0x19fadc21</span><span class="op" id="8046513">,</span>&nbsp;<span class="num" id="8046515">0x28d12941</span><span class="op" id="8046525">,</span>&nbsp;<span class="num" id="8046527">0x575c006e</span><span class="op" id="8046537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046542">0xd014f9a8</span><span class="op" id="8046552">,</span>&nbsp;<span class="num" id="8046554">0xc9ee2589</span><span class="op" id="8046564">,</span>&nbsp;<span class="num" id="8046566">0xe13f0cc8</span><span class="op" id="8046576">,</span>&nbsp;<span class="num" id="8046578">0xb6630ca6</span><span class="op" id="8046588">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8046592">}</span><span class="op" id="8046593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8046597">[</span><span class="op" id="8046598">]</span><span class="builtintype" id="8046599">uint32</span><span class="op" id="8046605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046610">0xd014f9a8</span><span class="op" id="8046620">,</span>&nbsp;<span class="num" id="8046622">0xc9ee2589</span><span class="op" id="8046632">,</span>&nbsp;<span class="num" id="8046634">0xe13f0cc8</span><span class="op" id="8046644">,</span>&nbsp;<span class="num" id="8046646">0xb6630ca6</span><span class="op" id="8046656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046661">0xc7b5a63</span><span class="op" id="8046670">,</span>&nbsp;<span class="num" id="8046672">0x1319eafe</span><span class="op" id="8046682">,</span>&nbsp;<span class="num" id="8046684">0xb0398890</span><span class="op" id="8046694">,</span>&nbsp;<span class="num" id="8046696">0x664cfbb4</span><span class="op" id="8046706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046711">0xdf7d925a</span><span class="op" id="8046721">,</span>&nbsp;<span class="num" id="8046723">0x1f62b09d</span><span class="op" id="8046733">,</span>&nbsp;<span class="num" id="8046735">0xa320626e</span><span class="op" id="8046745">,</span>&nbsp;<span class="num" id="8046747">0xd6757324</span><span class="op" id="8046757">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046762">0x12c07647</span><span class="op" id="8046772">,</span>&nbsp;<span class="num" id="8046774">0xc01f22c7</span><span class="op" id="8046784">,</span>&nbsp;<span class="num" id="8046786">0xbc42d2f3</span><span class="op" id="8046796">,</span>&nbsp;<span class="num" id="8046798">0x7555114a</span><span class="op" id="8046808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046813">0x6efcd876</span><span class="op" id="8046823">,</span>&nbsp;<span class="num" id="8046825">0xd2df5480</span><span class="op" id="8046835">,</span>&nbsp;<span class="num" id="8046837">0x7c5df034</span><span class="op" id="8046847">,</span>&nbsp;<span class="num" id="8046849">0xc917c3b9</span><span class="op" id="8046859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046864">0x6ea30afc</span><span class="op" id="8046874">,</span>&nbsp;<span class="num" id="8046876">0xbc238cf6</span><span class="op" id="8046886">,</span>&nbsp;<span class="num" id="8046888">0xae82a4b4</span><span class="op" id="8046898">,</span>&nbsp;<span class="num" id="8046900">0xb54a338d</span><span class="op" id="8046910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046915">0x90884413</span><span class="op" id="8046925">,</span>&nbsp;<span class="num" id="8046927">0xd280860a</span><span class="op" id="8046937">,</span>&nbsp;<span class="num" id="8046939">0x12a12842</span><span class="op" id="8046949">,</span>&nbsp;<span class="num" id="8046951">0x1bc89739</span><span class="op" id="8046961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8046966">0x7c1f13f7</span><span class="op" id="8046976">,</span>&nbsp;<span class="num" id="8046978">0x4208c219</span><span class="op" id="8046988">,</span>&nbsp;<span class="num" id="8046990">0xc021ae48</span><span class="op" id="8047000">,</span>&nbsp;<span class="num" id="8047002">0x969bf7b</span><span class="op" id="8047011">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047016">0xcc7505eb</span><span class="op" id="8047026">,</span>&nbsp;<span class="num" id="8047028">0x3e17d1ee</span><span class="op" id="8047038">,</span>&nbsp;<span class="num" id="8047040">0x82296c51</span><span class="op" id="8047050">,</span>&nbsp;<span class="num" id="8047052">0xc9481133</span><span class="op" id="8047062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047067">0x2b3708a7</span><span class="op" id="8047077">,</span>&nbsp;<span class="num" id="8047079">0xf262d405</span><span class="op" id="8047089">,</span>&nbsp;<span class="num" id="8047091">0xbc3ebdbf</span><span class="op" id="8047101">,</span>&nbsp;<span class="num" id="8047103">0x4b617d62</span><span class="op" id="8047113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047118">0x2b7e1516</span><span class="op" id="8047128">,</span>&nbsp;<span class="num" id="8047130">0x28aed2a6</span><span class="op" id="8047140">,</span>&nbsp;<span class="num" id="8047142">0xabf71588</span><span class="op" id="8047152">,</span>&nbsp;<span class="num" id="8047154">0x9cf4f3c</span><span class="op" id="8047163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8047167">}</span><span class="op" id="8047168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8047171">}</span><span class="op" id="8047172">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8047175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8047179">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8047224">[</span><span class="op" id="8047225">]</span><span class="builtintype" id="8047226">byte</span><span class="op" id="8047230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047235">0x8e</span><span class="op" id="8047239">,</span>&nbsp;<span class="num" id="8047241">0x73</span><span class="op" id="8047245">,</span>&nbsp;<span class="num" id="8047247">0xb0</span><span class="op" id="8047251">,</span>&nbsp;<span class="num" id="8047253">0xf7</span><span class="op" id="8047257">,</span>&nbsp;<span class="num" id="8047259">0xda</span><span class="op" id="8047263">,</span>&nbsp;<span class="num" id="8047265">0x0e</span><span class="op" id="8047269">,</span>&nbsp;<span class="num" id="8047271">0x64</span><span class="op" id="8047275">,</span>&nbsp;<span class="num" id="8047277">0x52</span><span class="op" id="8047281">,</span>&nbsp;<span class="num" id="8047283">0xc8</span><span class="op" id="8047287">,</span>&nbsp;<span class="num" id="8047289">0x10</span><span class="op" id="8047293">,</span>&nbsp;<span class="num" id="8047295">0xf3</span><span class="op" id="8047299">,</span>&nbsp;<span class="num" id="8047301">0x2b</span><span class="op" id="8047305">,</span>&nbsp;<span class="num" id="8047307">0x80</span><span class="op" id="8047311">,</span>&nbsp;<span class="num" id="8047313">0x90</span><span class="op" id="8047317">,</span>&nbsp;<span class="num" id="8047319">0x79</span><span class="op" id="8047323">,</span>&nbsp;<span class="num" id="8047325">0xe5</span><span class="op" id="8047329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047334">0x62</span><span class="op" id="8047338">,</span>&nbsp;<span class="num" id="8047340">0xf8</span><span class="op" id="8047344">,</span>&nbsp;<span class="num" id="8047346">0xea</span><span class="op" id="8047350">,</span>&nbsp;<span class="num" id="8047352">0xd2</span><span class="op" id="8047356">,</span>&nbsp;<span class="num" id="8047358">0x52</span><span class="op" id="8047362">,</span>&nbsp;<span class="num" id="8047364">0x2c</span><span class="op" id="8047368">,</span>&nbsp;<span class="num" id="8047370">0x6b</span><span class="op" id="8047374">,</span>&nbsp;<span class="num" id="8047376">0x7b</span><span class="op" id="8047380">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8047384">}</span><span class="op" id="8047385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8047389">[</span><span class="op" id="8047390">]</span><span class="builtintype" id="8047391">uint32</span><span class="op" id="8047397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047402">0x8e73b0f7</span><span class="op" id="8047412">,</span>&nbsp;<span class="num" id="8047414">0xda0e6452</span><span class="op" id="8047424">,</span>&nbsp;<span class="num" id="8047426">0xc810f32b</span><span class="op" id="8047436">,</span>&nbsp;<span class="num" id="8047438">0x809079e5</span><span class="op" id="8047448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047453">0x62f8ead2</span><span class="op" id="8047463">,</span>&nbsp;<span class="num" id="8047465">0x522c6b7b</span><span class="op" id="8047475">,</span>&nbsp;<span class="num" id="8047477">0xfe0c91f7</span><span class="op" id="8047487">,</span>&nbsp;<span class="num" id="8047489">0x2402f5a5</span><span class="op" id="8047499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047504">0xec12068e</span><span class="op" id="8047514">,</span>&nbsp;<span class="num" id="8047516">0x6c827f6b</span><span class="op" id="8047526">,</span>&nbsp;<span class="num" id="8047528">0x0e7a95b9</span><span class="op" id="8047538">,</span>&nbsp;<span class="num" id="8047540">0x5c56fec2</span><span class="op" id="8047550">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047555">0x4db7b4bd</span><span class="op" id="8047565">,</span>&nbsp;<span class="num" id="8047567">0x69b54118</span><span class="op" id="8047577">,</span>&nbsp;<span class="num" id="8047579">0x85a74796</span><span class="op" id="8047589">,</span>&nbsp;<span class="num" id="8047591">0xe92538fd</span><span class="op" id="8047601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047606">0xe75fad44</span><span class="op" id="8047616">,</span>&nbsp;<span class="num" id="8047618">0xbb095386</span><span class="op" id="8047628">,</span>&nbsp;<span class="num" id="8047630">0x485af057</span><span class="op" id="8047640">,</span>&nbsp;<span class="num" id="8047642">0x21efb14f</span><span class="op" id="8047652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047657">0xa448f6d9</span><span class="op" id="8047667">,</span>&nbsp;<span class="num" id="8047669">0x4d6dce24</span><span class="op" id="8047679">,</span>&nbsp;<span class="num" id="8047681">0xaa326360</span><span class="op" id="8047691">,</span>&nbsp;<span class="num" id="8047693">0x113b30e6</span><span class="op" id="8047703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047708">0xa25e7ed5</span><span class="op" id="8047718">,</span>&nbsp;<span class="num" id="8047720">0x83b1cf9a</span><span class="op" id="8047730">,</span>&nbsp;<span class="num" id="8047732">0x27f93943</span><span class="op" id="8047742">,</span>&nbsp;<span class="num" id="8047744">0x6a94f767</span><span class="op" id="8047754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047759">0xc0a69407</span><span class="op" id="8047769">,</span>&nbsp;<span class="num" id="8047771">0xd19da4e1</span><span class="op" id="8047781">,</span>&nbsp;<span class="num" id="8047783">0xec1786eb</span><span class="op" id="8047793">,</span>&nbsp;<span class="num" id="8047795">0x6fa64971</span><span class="op" id="8047805">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047810">0x485f7032</span><span class="op" id="8047820">,</span>&nbsp;<span class="num" id="8047822">0x22cb8755</span><span class="op" id="8047832">,</span>&nbsp;<span class="num" id="8047834">0xe26d1352</span><span class="op" id="8047844">,</span>&nbsp;<span class="num" id="8047846">0x33f0b7b3</span><span class="op" id="8047856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047861">0x40beeb28</span><span class="op" id="8047871">,</span>&nbsp;<span class="num" id="8047873">0x2f18a259</span><span class="op" id="8047883">,</span>&nbsp;<span class="num" id="8047885">0x6747d26b</span><span class="op" id="8047895">,</span>&nbsp;<span class="num" id="8047897">0x458c553e</span><span class="op" id="8047907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047912">0xa7e1466c</span><span class="op" id="8047922">,</span>&nbsp;<span class="num" id="8047924">0x9411f1df</span><span class="op" id="8047934">,</span>&nbsp;<span class="num" id="8047936">0x821f750a</span><span class="op" id="8047946">,</span>&nbsp;<span class="num" id="8047948">0xad07d753</span><span class="op" id="8047958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8047963">0xca400538</span><span class="op" id="8047973">,</span>&nbsp;<span class="num" id="8047975">0x8fcc5006</span><span class="op" id="8047985">,</span>&nbsp;<span class="num" id="8047987">0x282d166a</span><span class="op" id="8047997">,</span>&nbsp;<span class="num" id="8047999">0xbc3ce7b5</span><span class="op" id="8048009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048014">0xe98ba06f</span><span class="op" id="8048024">,</span>&nbsp;<span class="num" id="8048026">0x448c773c</span><span class="op" id="8048036">,</span>&nbsp;<span class="num" id="8048038">0x8ecc7204</span><span class="op" id="8048048">,</span>&nbsp;<span class="num" id="8048050">0x01002202</span><span class="op" id="8048060">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8048064">}</span><span class="op" id="8048065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8048069">nil</span><span class="op" id="8048072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8048075">}</span><span class="op" id="8048076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8048079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8048083">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8048128">[</span><span class="op" id="8048129">]</span><span class="builtintype" id="8048130">byte</span><span class="op" id="8048134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048139">0x60</span><span class="op" id="8048143">,</span>&nbsp;<span class="num" id="8048145">0x3d</span><span class="op" id="8048149">,</span>&nbsp;<span class="num" id="8048151">0xeb</span><span class="op" id="8048155">,</span>&nbsp;<span class="num" id="8048157">0x10</span><span class="op" id="8048161">,</span>&nbsp;<span class="num" id="8048163">0x15</span><span class="op" id="8048167">,</span>&nbsp;<span class="num" id="8048169">0xca</span><span class="op" id="8048173">,</span>&nbsp;<span class="num" id="8048175">0x71</span><span class="op" id="8048179">,</span>&nbsp;<span class="num" id="8048181">0xbe</span><span class="op" id="8048185">,</span>&nbsp;<span class="num" id="8048187">0x2b</span><span class="op" id="8048191">,</span>&nbsp;<span class="num" id="8048193">0x73</span><span class="op" id="8048197">,</span>&nbsp;<span class="num" id="8048199">0xae</span><span class="op" id="8048203">,</span>&nbsp;<span class="num" id="8048205">0xf0</span><span class="op" id="8048209">,</span>&nbsp;<span class="num" id="8048211">0x85</span><span class="op" id="8048215">,</span>&nbsp;<span class="num" id="8048217">0x7d</span><span class="op" id="8048221">,</span>&nbsp;<span class="num" id="8048223">0x77</span><span class="op" id="8048227">,</span>&nbsp;<span class="num" id="8048229">0x81</span><span class="op" id="8048233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048238">0x1f</span><span class="op" id="8048242">,</span>&nbsp;<span class="num" id="8048244">0x35</span><span class="op" id="8048248">,</span>&nbsp;<span class="num" id="8048250">0x2c</span><span class="op" id="8048254">,</span>&nbsp;<span class="num" id="8048256">0x07</span><span class="op" id="8048260">,</span>&nbsp;<span class="num" id="8048262">0x3b</span><span class="op" id="8048266">,</span>&nbsp;<span class="num" id="8048268">0x61</span><span class="op" id="8048272">,</span>&nbsp;<span class="num" id="8048274">0x08</span><span class="op" id="8048278">,</span>&nbsp;<span class="num" id="8048280">0xd7</span><span class="op" id="8048284">,</span>&nbsp;<span class="num" id="8048286">0x2d</span><span class="op" id="8048290">,</span>&nbsp;<span class="num" id="8048292">0x98</span><span class="op" id="8048296">,</span>&nbsp;<span class="num" id="8048298">0x10</span><span class="op" id="8048302">,</span>&nbsp;<span class="num" id="8048304">0xa3</span><span class="op" id="8048308">,</span>&nbsp;<span class="num" id="8048310">0x09</span><span class="op" id="8048314">,</span>&nbsp;<span class="num" id="8048316">0x14</span><span class="op" id="8048320">,</span>&nbsp;<span class="num" id="8048322">0xdf</span><span class="op" id="8048326">,</span>&nbsp;<span class="num" id="8048328">0xf4</span><span class="op" id="8048332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8048336">}</span><span class="op" id="8048337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8048341">[</span><span class="op" id="8048342">]</span><span class="builtintype" id="8048343">uint32</span><span class="op" id="8048349">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048354">0x603deb10</span><span class="op" id="8048364">,</span>&nbsp;<span class="num" id="8048366">0x15ca71be</span><span class="op" id="8048376">,</span>&nbsp;<span class="num" id="8048378">0x2b73aef0</span><span class="op" id="8048388">,</span>&nbsp;<span class="num" id="8048390">0x857d7781</span><span class="op" id="8048400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048405">0x1f352c07</span><span class="op" id="8048415">,</span>&nbsp;<span class="num" id="8048417">0x3b6108d7</span><span class="op" id="8048427">,</span>&nbsp;<span class="num" id="8048429">0x2d9810a3</span><span class="op" id="8048439">,</span>&nbsp;<span class="num" id="8048441">0x0914dff4</span><span class="op" id="8048451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048456">0x9ba35411</span><span class="op" id="8048466">,</span>&nbsp;<span class="num" id="8048468">0x8e6925af</span><span class="op" id="8048478">,</span>&nbsp;<span class="num" id="8048480">0xa51a8b5f</span><span class="op" id="8048490">,</span>&nbsp;<span class="num" id="8048492">0x2067fcde</span><span class="op" id="8048502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048507">0xa8b09c1a</span><span class="op" id="8048517">,</span>&nbsp;<span class="num" id="8048519">0x93d194cd</span><span class="op" id="8048529">,</span>&nbsp;<span class="num" id="8048531">0xbe49846e</span><span class="op" id="8048541">,</span>&nbsp;<span class="num" id="8048543">0xb75d5b9a</span><span class="op" id="8048553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048558">0xd59aecb8</span><span class="op" id="8048568">,</span>&nbsp;<span class="num" id="8048570">0x5bf3c917</span><span class="op" id="8048580">,</span>&nbsp;<span class="num" id="8048582">0xfee94248</span><span class="op" id="8048592">,</span>&nbsp;<span class="num" id="8048594">0xde8ebe96</span><span class="op" id="8048604">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048609">0xb5a9328a</span><span class="op" id="8048619">,</span>&nbsp;<span class="num" id="8048621">0x2678a647</span><span class="op" id="8048631">,</span>&nbsp;<span class="num" id="8048633">0x98312229</span><span class="op" id="8048643">,</span>&nbsp;<span class="num" id="8048645">0x2f6c79b3</span><span class="op" id="8048655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048660">0x812c81ad</span><span class="op" id="8048670">,</span>&nbsp;<span class="num" id="8048672">0xdadf48ba</span><span class="op" id="8048682">,</span>&nbsp;<span class="num" id="8048684">0x24360af2</span><span class="op" id="8048694">,</span>&nbsp;<span class="num" id="8048696">0xfab8b464</span><span class="op" id="8048706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048711">0x98c5bfc9</span><span class="op" id="8048721">,</span>&nbsp;<span class="num" id="8048723">0xbebd198e</span><span class="op" id="8048733">,</span>&nbsp;<span class="num" id="8048735">0x268c3ba7</span><span class="op" id="8048745">,</span>&nbsp;<span class="num" id="8048747">0x09e04214</span><span class="op" id="8048757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048762">0x68007bac</span><span class="op" id="8048772">,</span>&nbsp;<span class="num" id="8048774">0xb2df3316</span><span class="op" id="8048784">,</span>&nbsp;<span class="num" id="8048786">0x96e939e4</span><span class="op" id="8048796">,</span>&nbsp;<span class="num" id="8048798">0x6c518d80</span><span class="op" id="8048808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048813">0xc814e204</span><span class="op" id="8048823">,</span>&nbsp;<span class="num" id="8048825">0x76a9fb8a</span><span class="op" id="8048835">,</span>&nbsp;<span class="num" id="8048837">0x5025c02d</span><span class="op" id="8048847">,</span>&nbsp;<span class="num" id="8048849">0x59c58239</span><span class="op" id="8048859">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048864">0xde136967</span><span class="op" id="8048874">,</span>&nbsp;<span class="num" id="8048876">0x6ccc5a71</span><span class="op" id="8048886">,</span>&nbsp;<span class="num" id="8048888">0xfa256395</span><span class="op" id="8048898">,</span>&nbsp;<span class="num" id="8048900">0x9674ee15</span><span class="op" id="8048910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048915">0x5886ca5d</span><span class="op" id="8048925">,</span>&nbsp;<span class="num" id="8048927">0x2e2f31d7</span><span class="op" id="8048937">,</span>&nbsp;<span class="num" id="8048939">0x7e0af1fa</span><span class="op" id="8048949">,</span>&nbsp;<span class="num" id="8048951">0x27cf73c3</span><span class="op" id="8048961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8048966">0x749c47ab</span><span class="op" id="8048976">,</span>&nbsp;<span class="num" id="8048978">0x18501dda</span><span class="op" id="8048988">,</span>&nbsp;<span class="num" id="8048990">0xe2757e4f</span><span class="op" id="8049000">,</span>&nbsp;<span class="num" id="8049002">0x7401905a</span><span class="op" id="8049012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8049017">0xcafaaae3</span><span class="op" id="8049027">,</span>&nbsp;<span class="num" id="8049029">0xe4d59b34</span><span class="op" id="8049039">,</span>&nbsp;<span class="num" id="8049041">0x9adf6ace</span><span class="op" id="8049051">,</span>&nbsp;<span class="num" id="8049053">0xbd10190d</span><span class="op" id="8049063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8049068">0xfe4890d1</span><span class="op" id="8049078">,</span>&nbsp;<span class="num" id="8049080">0xe6188d0b</span><span class="op" id="8049090">,</span>&nbsp;<span class="num" id="8049092">0x046df344</span><span class="op" id="8049102">,</span>&nbsp;<span class="num" id="8049104">0x706c631e</span><span class="op" id="8049114">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8049118">}</span><span class="op" id="8049119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8049123">nil</span><span class="op" id="8049126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8049129">}</span><span class="op" id="8049130">,</span><br>
<span class="lineno"></span><span class="op" id="8049132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="8049135">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8049184">func</span>&nbsp;<span class="ident" id="8049189">TestExpandKey</span><span class="op" id="8049202">(</span><span class="ident" id="8049203">t</span>&nbsp;<span class="op" id="8049205">*</span><span class="ident" id="8049206">testing</span><span class="op" id="8049213">.</span><span class="ident" id="8049214">T</span><span class="op" id="8049215">)</span>&nbsp;<span class="op" id="8049217">{</span><br>
<span class="lineno"></span><span class="ident" id="8049219">L</span><span class="op" id="8049220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8049223">for</span>&nbsp;<span class="ident" id="8049227">i</span><span class="op" id="8049228">,</span>&nbsp;<span class="ident" id="8049230">tt</span>&nbsp;<span class="op" id="8049233">:=</span>&nbsp;<span class="keyword" id="8049236">range</span>&nbsp;<span class="ident" id="8049242">keyTests</span>&nbsp;<span class="op" id="8049251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8049255">enc</span>&nbsp;<span class="op" id="8049259">:=</span>&nbsp;<span class="builtinfunc" id="8049262">make</span><span class="op" id="8049266">(</span><span class="op" id="8049267">[</span><span class="op" id="8049268">]</span><span class="builtintype" id="8049269">uint32</span><span class="op" id="8049275">,</span>&nbsp;<span class="builtinfunc" id="8049277">len</span><span class="op" id="8049280">(</span><span class="ident" id="8049281">tt</span><span class="op" id="8049283">.</span><span class="ident" id="8049284">enc</span><span class="op" id="8049287">)</span><span class="op" id="8049288">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8049292">var</span>&nbsp;<span class="ident" id="8049296">dec</span>&nbsp;<span class="op" id="8049300">[</span><span class="op" id="8049301">]</span><span class="builtintype" id="8049302">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8049311">if</span>&nbsp;<span class="ident" id="8049314">tt</span><span class="op" id="8049316">.</span><span class="ident" id="8049317">dec</span>&nbsp;<span class="op" id="8049321">!=</span>&nbsp;<span class="ident" id="8049324">nil</span>&nbsp;<span class="op" id="8049328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8049333">dec</span>&nbsp;<span class="op" id="8049337">=</span>&nbsp;<span class="builtinfunc" id="8049339">make</span><span class="op" id="8049343">(</span><span class="op" id="8049344">[</span><span class="op" id="8049345">]</span><span class="builtintype" id="8049346">uint32</span><span class="op" id="8049352">,</span>&nbsp;<span class="builtinfunc" id="8049354">len</span><span class="op" id="8049357">(</span><span class="ident" id="8049358">tt</span><span class="op" id="8049360">.</span><span class="ident" id="8049361">dec</span><span class="op" id="8049364">)</span><span class="op" id="8049365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8049369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8049373">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8049440">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8049505">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8049574">expandKeyGo</span><span class="op" id="8049585">(</span><span class="ident" id="8049586">tt</span><span class="op" id="8049588">.</span><span class="ident" id="8049589">key</span><span class="op" id="8049592">,</span>&nbsp;<span class="ident" id="8049594">enc</span><span class="op" id="8049597">,</span>&nbsp;<span class="ident" id="8049599">dec</span><span class="op" id="8049602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8049606">for</span>&nbsp;<span class="ident" id="8049610">j</span><span class="op" id="8049611">,</span>&nbsp;<span class="ident" id="8049613">v</span>&nbsp;<span class="op" id="8049615">:=</span>&nbsp;<span class="keyword" id="8049618">range</span>&nbsp;<span class="ident" id="8049624">enc</span>&nbsp;<span class="op" id="8049628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8049633">if</span>&nbsp;<span class="ident" id="8049636">v</span>&nbsp;<span class="op" id="8049638">!=</span>&nbsp;<span class="ident" id="8049641">tt</span><span class="op" id="8049643">.</span><span class="ident" id="8049644">enc</span><span class="op" id="8049647">[</span><span class="ident" id="8049648">j</span><span class="op" id="8049649">]</span>&nbsp;<span class="op" id="8049651">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8049657">t</span><span class="op" id="8049658">.</span><span class="ident" id="8049659">Errorf</span><span class="op" id="8049665">(</span><span class="string" id="8049666">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8049699">,</span>&nbsp;<span class="ident" id="8049701">i</span><span class="op" id="8049702">,</span>&nbsp;<span class="ident" id="8049704">j</span><span class="op" id="8049705">,</span>&nbsp;<span class="ident" id="8049707">v</span><span class="op" id="8049708">,</span>&nbsp;<span class="ident" id="8049710">tt</span><span class="op" id="8049712">.</span><span class="ident" id="8049713">enc</span><span class="op" id="8049716">[</span><span class="ident" id="8049717">j</span><span class="op" id="8049718">]</span><span class="op" id="8049719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8049725">continue</span>&nbsp;<span class="ident" id="8049734">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8049739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8049743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8049747">if</span>&nbsp;<span class="ident" id="8049750">dec</span>&nbsp;<span class="op" id="8049754">!=</span>&nbsp;<span class="ident" id="8049757">nil</span>&nbsp;<span class="op" id="8049761">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8049766">for</span>&nbsp;<span class="ident" id="8049770">j</span><span class="op" id="8049771">,</span>&nbsp;<span class="ident" id="8049773">v</span>&nbsp;<span class="op" id="8049775">:=</span>&nbsp;<span class="keyword" id="8049778">range</span>&nbsp;<span class="ident" id="8049784">dec</span>&nbsp;<span class="op" id="8049788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8049794">if</span>&nbsp;<span class="ident" id="8049797">v</span>&nbsp;<span class="op" id="8049799">!=</span>&nbsp;<span class="ident" id="8049802">tt</span><span class="op" id="8049804">.</span><span class="ident" id="8049805">dec</span><span class="op" id="8049808">[</span><span class="ident" id="8049809">j</span><span class="op" id="8049810">]</span>&nbsp;<span class="op" id="8049812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8049819">t</span><span class="op" id="8049820">.</span><span class="ident" id="8049821">Errorf</span><span class="op" id="8049827">(</span><span class="string" id="8049828">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8049861">,</span>&nbsp;<span class="ident" id="8049863">i</span><span class="op" id="8049864">,</span>&nbsp;<span class="ident" id="8049866">j</span><span class="op" id="8049867">,</span>&nbsp;<span class="ident" id="8049869">v</span><span class="op" id="8049870">,</span>&nbsp;<span class="ident" id="8049872">tt</span><span class="op" id="8049874">.</span><span class="ident" id="8049875">dec</span><span class="op" id="8049878">[</span><span class="ident" id="8049879">j</span><span class="op" id="8049880">]</span><span class="op" id="8049881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8049888">continue</span>&nbsp;<span class="ident" id="8049897">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8049903">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8049908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8049912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8049915">}</span><br>
<span class="lineno"></span><span class="op" id="8049917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="8049920">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="8049984">type</span>&nbsp;<span class="ident" id="8049989">CryptTest</span>&nbsp;<span class="keyword" id="8049999">struct</span>&nbsp;<span class="op" id="8050006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8050009">key</span>&nbsp;<span class="op" id="8050013">[</span><span class="op" id="8050014">]</span><span class="builtintype" id="8050015">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8050021">in</span>&nbsp;&nbsp;<span class="op" id="8050025">[</span><span class="op" id="8050026">]</span><span class="builtintype" id="8050027">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8050033">out</span>&nbsp;<span class="op" id="8050037">[</span><span class="op" id="8050038">]</span><span class="builtintype" id="8050039">byte</span><br>
<span class="lineno">250</span><span class="op" id="8050044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8050047">var</span>&nbsp;<span class="ident" id="8050051">encryptTests</span>&nbsp;<span class="op" id="8050064">=</span>&nbsp;<span class="op" id="8050066">[</span><span class="op" id="8050067">]</span><span class="ident" id="8050068">CryptTest</span><span class="op" id="8050077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8050084">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050101">[</span><span class="op" id="8050102">]</span><span class="builtintype" id="8050103">byte</span><span class="op" id="8050107">{</span><span class="num" id="8050108">0x2b</span><span class="op" id="8050112">,</span>&nbsp;<span class="num" id="8050114">0x7e</span><span class="op" id="8050118">,</span>&nbsp;<span class="num" id="8050120">0x15</span><span class="op" id="8050124">,</span>&nbsp;<span class="num" id="8050126">0x16</span><span class="op" id="8050130">,</span>&nbsp;<span class="num" id="8050132">0x28</span><span class="op" id="8050136">,</span>&nbsp;<span class="num" id="8050138">0xae</span><span class="op" id="8050142">,</span>&nbsp;<span class="num" id="8050144">0xd2</span><span class="op" id="8050148">,</span>&nbsp;<span class="num" id="8050150">0xa6</span><span class="op" id="8050154">,</span>&nbsp;<span class="num" id="8050156">0xab</span><span class="op" id="8050160">,</span>&nbsp;<span class="num" id="8050162">0xf7</span><span class="op" id="8050166">,</span>&nbsp;<span class="num" id="8050168">0x15</span><span class="op" id="8050172">,</span>&nbsp;<span class="num" id="8050174">0x88</span><span class="op" id="8050178">,</span>&nbsp;<span class="num" id="8050180">0x09</span><span class="op" id="8050184">,</span>&nbsp;<span class="num" id="8050186">0xcf</span><span class="op" id="8050190">,</span>&nbsp;<span class="num" id="8050192">0x4f</span><span class="op" id="8050196">,</span>&nbsp;<span class="num" id="8050198">0x3c</span><span class="op" id="8050202">}</span><span class="op" id="8050203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050207">[</span><span class="op" id="8050208">]</span><span class="builtintype" id="8050209">byte</span><span class="op" id="8050213">{</span><span class="num" id="8050214">0x32</span><span class="op" id="8050218">,</span>&nbsp;<span class="num" id="8050220">0x43</span><span class="op" id="8050224">,</span>&nbsp;<span class="num" id="8050226">0xf6</span><span class="op" id="8050230">,</span>&nbsp;<span class="num" id="8050232">0xa8</span><span class="op" id="8050236">,</span>&nbsp;<span class="num" id="8050238">0x88</span><span class="op" id="8050242">,</span>&nbsp;<span class="num" id="8050244">0x5a</span><span class="op" id="8050248">,</span>&nbsp;<span class="num" id="8050250">0x30</span><span class="op" id="8050254">,</span>&nbsp;<span class="num" id="8050256">0x8d</span><span class="op" id="8050260">,</span>&nbsp;<span class="num" id="8050262">0x31</span><span class="op" id="8050266">,</span>&nbsp;<span class="num" id="8050268">0x31</span><span class="op" id="8050272">,</span>&nbsp;<span class="num" id="8050274">0x98</span><span class="op" id="8050278">,</span>&nbsp;<span class="num" id="8050280">0xa2</span><span class="op" id="8050284">,</span>&nbsp;<span class="num" id="8050286">0xe0</span><span class="op" id="8050290">,</span>&nbsp;<span class="num" id="8050292">0x37</span><span class="op" id="8050296">,</span>&nbsp;<span class="num" id="8050298">0x07</span><span class="op" id="8050302">,</span>&nbsp;<span class="num" id="8050304">0x34</span><span class="op" id="8050308">}</span><span class="op" id="8050309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050313">[</span><span class="op" id="8050314">]</span><span class="builtintype" id="8050315">byte</span><span class="op" id="8050319">{</span><span class="num" id="8050320">0x39</span><span class="op" id="8050324">,</span>&nbsp;<span class="num" id="8050326">0x25</span><span class="op" id="8050330">,</span>&nbsp;<span class="num" id="8050332">0x84</span><span class="op" id="8050336">,</span>&nbsp;<span class="num" id="8050338">0x1d</span><span class="op" id="8050342">,</span>&nbsp;<span class="num" id="8050344">0x02</span><span class="op" id="8050348">,</span>&nbsp;<span class="num" id="8050350">0xdc</span><span class="op" id="8050354">,</span>&nbsp;<span class="num" id="8050356">0x09</span><span class="op" id="8050360">,</span>&nbsp;<span class="num" id="8050362">0xfb</span><span class="op" id="8050366">,</span>&nbsp;<span class="num" id="8050368">0xdc</span><span class="op" id="8050372">,</span>&nbsp;<span class="num" id="8050374">0x11</span><span class="op" id="8050378">,</span>&nbsp;<span class="num" id="8050380">0x85</span><span class="op" id="8050384">,</span>&nbsp;<span class="num" id="8050386">0x97</span><span class="op" id="8050390">,</span>&nbsp;<span class="num" id="8050392">0x19</span><span class="op" id="8050396">,</span>&nbsp;<span class="num" id="8050398">0x6a</span><span class="op" id="8050402">,</span>&nbsp;<span class="num" id="8050404">0x0b</span><span class="op" id="8050408">,</span>&nbsp;<span class="num" id="8050410">0x32</span><span class="op" id="8050414">}</span><span class="op" id="8050415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050418">}</span><span class="op" id="8050419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050422">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8050426">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050454">[</span><span class="op" id="8050455">]</span><span class="builtintype" id="8050456">byte</span><span class="op" id="8050460">{</span><span class="num" id="8050461">0x00</span><span class="op" id="8050465">,</span>&nbsp;<span class="num" id="8050467">0x01</span><span class="op" id="8050471">,</span>&nbsp;<span class="num" id="8050473">0x02</span><span class="op" id="8050477">,</span>&nbsp;<span class="num" id="8050479">0x03</span><span class="op" id="8050483">,</span>&nbsp;<span class="num" id="8050485">0x04</span><span class="op" id="8050489">,</span>&nbsp;<span class="num" id="8050491">0x05</span><span class="op" id="8050495">,</span>&nbsp;<span class="num" id="8050497">0x06</span><span class="op" id="8050501">,</span>&nbsp;<span class="num" id="8050503">0x07</span><span class="op" id="8050507">,</span>&nbsp;<span class="num" id="8050509">0x08</span><span class="op" id="8050513">,</span>&nbsp;<span class="num" id="8050515">0x09</span><span class="op" id="8050519">,</span>&nbsp;<span class="num" id="8050521">0x0a</span><span class="op" id="8050525">,</span>&nbsp;<span class="num" id="8050527">0x0b</span><span class="op" id="8050531">,</span>&nbsp;<span class="num" id="8050533">0x0c</span><span class="op" id="8050537">,</span>&nbsp;<span class="num" id="8050539">0x0d</span><span class="op" id="8050543">,</span>&nbsp;<span class="num" id="8050545">0x0e</span><span class="op" id="8050549">,</span>&nbsp;<span class="num" id="8050551">0x0f</span><span class="op" id="8050555">}</span><span class="op" id="8050556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050560">[</span><span class="op" id="8050561">]</span><span class="builtintype" id="8050562">byte</span><span class="op" id="8050566">{</span><span class="num" id="8050567">0x00</span><span class="op" id="8050571">,</span>&nbsp;<span class="num" id="8050573">0x11</span><span class="op" id="8050577">,</span>&nbsp;<span class="num" id="8050579">0x22</span><span class="op" id="8050583">,</span>&nbsp;<span class="num" id="8050585">0x33</span><span class="op" id="8050589">,</span>&nbsp;<span class="num" id="8050591">0x44</span><span class="op" id="8050595">,</span>&nbsp;<span class="num" id="8050597">0x55</span><span class="op" id="8050601">,</span>&nbsp;<span class="num" id="8050603">0x66</span><span class="op" id="8050607">,</span>&nbsp;<span class="num" id="8050609">0x77</span><span class="op" id="8050613">,</span>&nbsp;<span class="num" id="8050615">0x88</span><span class="op" id="8050619">,</span>&nbsp;<span class="num" id="8050621">0x99</span><span class="op" id="8050625">,</span>&nbsp;<span class="num" id="8050627">0xaa</span><span class="op" id="8050631">,</span>&nbsp;<span class="num" id="8050633">0xbb</span><span class="op" id="8050637">,</span>&nbsp;<span class="num" id="8050639">0xcc</span><span class="op" id="8050643">,</span>&nbsp;<span class="num" id="8050645">0xdd</span><span class="op" id="8050649">,</span>&nbsp;<span class="num" id="8050651">0xee</span><span class="op" id="8050655">,</span>&nbsp;<span class="num" id="8050657">0xff</span><span class="op" id="8050661">}</span><span class="op" id="8050662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050666">[</span><span class="op" id="8050667">]</span><span class="builtintype" id="8050668">byte</span><span class="op" id="8050672">{</span><span class="num" id="8050673">0x69</span><span class="op" id="8050677">,</span>&nbsp;<span class="num" id="8050679">0xc4</span><span class="op" id="8050683">,</span>&nbsp;<span class="num" id="8050685">0xe0</span><span class="op" id="8050689">,</span>&nbsp;<span class="num" id="8050691">0xd8</span><span class="op" id="8050695">,</span>&nbsp;<span class="num" id="8050697">0x6a</span><span class="op" id="8050701">,</span>&nbsp;<span class="num" id="8050703">0x7b</span><span class="op" id="8050707">,</span>&nbsp;<span class="num" id="8050709">0x04</span><span class="op" id="8050713">,</span>&nbsp;<span class="num" id="8050715">0x30</span><span class="op" id="8050719">,</span>&nbsp;<span class="num" id="8050721">0xd8</span><span class="op" id="8050725">,</span>&nbsp;<span class="num" id="8050727">0xcd</span><span class="op" id="8050731">,</span>&nbsp;<span class="num" id="8050733">0xb7</span><span class="op" id="8050737">,</span>&nbsp;<span class="num" id="8050739">0x80</span><span class="op" id="8050743">,</span>&nbsp;<span class="num" id="8050745">0x70</span><span class="op" id="8050749">,</span>&nbsp;<span class="num" id="8050751">0xb4</span><span class="op" id="8050755">,</span>&nbsp;<span class="num" id="8050757">0xc5</span><span class="op" id="8050761">,</span>&nbsp;<span class="num" id="8050763">0x5a</span><span class="op" id="8050767">}</span><span class="op" id="8050768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050771">}</span><span class="op" id="8050772">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8050779">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050807">[</span><span class="op" id="8050808">]</span><span class="builtintype" id="8050809">byte</span><span class="op" id="8050813">{</span><span class="num" id="8050814">0x00</span><span class="op" id="8050818">,</span>&nbsp;<span class="num" id="8050820">0x01</span><span class="op" id="8050824">,</span>&nbsp;<span class="num" id="8050826">0x02</span><span class="op" id="8050830">,</span>&nbsp;<span class="num" id="8050832">0x03</span><span class="op" id="8050836">,</span>&nbsp;<span class="num" id="8050838">0x04</span><span class="op" id="8050842">,</span>&nbsp;<span class="num" id="8050844">0x05</span><span class="op" id="8050848">,</span>&nbsp;<span class="num" id="8050850">0x06</span><span class="op" id="8050854">,</span>&nbsp;<span class="num" id="8050856">0x07</span><span class="op" id="8050860">,</span>&nbsp;<span class="num" id="8050862">0x08</span><span class="op" id="8050866">,</span>&nbsp;<span class="num" id="8050868">0x09</span><span class="op" id="8050872">,</span>&nbsp;<span class="num" id="8050874">0x0a</span><span class="op" id="8050878">,</span>&nbsp;<span class="num" id="8050880">0x0b</span><span class="op" id="8050884">,</span>&nbsp;<span class="num" id="8050886">0x0c</span><span class="op" id="8050890">,</span>&nbsp;<span class="num" id="8050892">0x0d</span><span class="op" id="8050896">,</span>&nbsp;<span class="num" id="8050898">0x0e</span><span class="op" id="8050902">,</span>&nbsp;<span class="num" id="8050904">0x0f</span><span class="op" id="8050908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8050913">0x10</span><span class="op" id="8050917">,</span>&nbsp;<span class="num" id="8050919">0x11</span><span class="op" id="8050923">,</span>&nbsp;<span class="num" id="8050925">0x12</span><span class="op" id="8050929">,</span>&nbsp;<span class="num" id="8050931">0x13</span><span class="op" id="8050935">,</span>&nbsp;<span class="num" id="8050937">0x14</span><span class="op" id="8050941">,</span>&nbsp;<span class="num" id="8050943">0x15</span><span class="op" id="8050947">,</span>&nbsp;<span class="num" id="8050949">0x16</span><span class="op" id="8050953">,</span>&nbsp;<span class="num" id="8050955">0x17</span><span class="op" id="8050959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050963">}</span><span class="op" id="8050964">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8050968">[</span><span class="op" id="8050969">]</span><span class="builtintype" id="8050970">byte</span><span class="op" id="8050974">{</span><span class="num" id="8050975">0x00</span><span class="op" id="8050979">,</span>&nbsp;<span class="num" id="8050981">0x11</span><span class="op" id="8050985">,</span>&nbsp;<span class="num" id="8050987">0x22</span><span class="op" id="8050991">,</span>&nbsp;<span class="num" id="8050993">0x33</span><span class="op" id="8050997">,</span>&nbsp;<span class="num" id="8050999">0x44</span><span class="op" id="8051003">,</span>&nbsp;<span class="num" id="8051005">0x55</span><span class="op" id="8051009">,</span>&nbsp;<span class="num" id="8051011">0x66</span><span class="op" id="8051015">,</span>&nbsp;<span class="num" id="8051017">0x77</span><span class="op" id="8051021">,</span>&nbsp;<span class="num" id="8051023">0x88</span><span class="op" id="8051027">,</span>&nbsp;<span class="num" id="8051029">0x99</span><span class="op" id="8051033">,</span>&nbsp;<span class="num" id="8051035">0xaa</span><span class="op" id="8051039">,</span>&nbsp;<span class="num" id="8051041">0xbb</span><span class="op" id="8051045">,</span>&nbsp;<span class="num" id="8051047">0xcc</span><span class="op" id="8051051">,</span>&nbsp;<span class="num" id="8051053">0xdd</span><span class="op" id="8051057">,</span>&nbsp;<span class="num" id="8051059">0xee</span><span class="op" id="8051063">,</span>&nbsp;<span class="num" id="8051065">0xff</span><span class="op" id="8051069">}</span><span class="op" id="8051070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051074">[</span><span class="op" id="8051075">]</span><span class="builtintype" id="8051076">byte</span><span class="op" id="8051080">{</span><span class="num" id="8051081">0xdd</span><span class="op" id="8051085">,</span>&nbsp;<span class="num" id="8051087">0xa9</span><span class="op" id="8051091">,</span>&nbsp;<span class="num" id="8051093">0x7c</span><span class="op" id="8051097">,</span>&nbsp;<span class="num" id="8051099">0xa4</span><span class="op" id="8051103">,</span>&nbsp;<span class="num" id="8051105">0x86</span><span class="op" id="8051109">,</span>&nbsp;<span class="num" id="8051111">0x4c</span><span class="op" id="8051115">,</span>&nbsp;<span class="num" id="8051117">0xdf</span><span class="op" id="8051121">,</span>&nbsp;<span class="num" id="8051123">0xe0</span><span class="op" id="8051127">,</span>&nbsp;<span class="num" id="8051129">0x6e</span><span class="op" id="8051133">,</span>&nbsp;<span class="num" id="8051135">0xaf</span><span class="op" id="8051139">,</span>&nbsp;<span class="num" id="8051141">0x70</span><span class="op" id="8051145">,</span>&nbsp;<span class="num" id="8051147">0xa0</span><span class="op" id="8051151">,</span>&nbsp;<span class="num" id="8051153">0xec</span><span class="op" id="8051157">,</span>&nbsp;<span class="num" id="8051159">0x0d</span><span class="op" id="8051163">,</span>&nbsp;<span class="num" id="8051165">0x71</span><span class="op" id="8051169">,</span>&nbsp;<span class="num" id="8051171">0x91</span><span class="op" id="8051175">}</span><span class="op" id="8051176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051179">}</span><span class="op" id="8051180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8051187">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051215">[</span><span class="op" id="8051216">]</span><span class="builtintype" id="8051217">byte</span><span class="op" id="8051221">{</span><span class="num" id="8051222">0x00</span><span class="op" id="8051226">,</span>&nbsp;<span class="num" id="8051228">0x01</span><span class="op" id="8051232">,</span>&nbsp;<span class="num" id="8051234">0x02</span><span class="op" id="8051238">,</span>&nbsp;<span class="num" id="8051240">0x03</span><span class="op" id="8051244">,</span>&nbsp;<span class="num" id="8051246">0x04</span><span class="op" id="8051250">,</span>&nbsp;<span class="num" id="8051252">0x05</span><span class="op" id="8051256">,</span>&nbsp;<span class="num" id="8051258">0x06</span><span class="op" id="8051262">,</span>&nbsp;<span class="num" id="8051264">0x07</span><span class="op" id="8051268">,</span>&nbsp;<span class="num" id="8051270">0x08</span><span class="op" id="8051274">,</span>&nbsp;<span class="num" id="8051276">0x09</span><span class="op" id="8051280">,</span>&nbsp;<span class="num" id="8051282">0x0a</span><span class="op" id="8051286">,</span>&nbsp;<span class="num" id="8051288">0x0b</span><span class="op" id="8051292">,</span>&nbsp;<span class="num" id="8051294">0x0c</span><span class="op" id="8051298">,</span>&nbsp;<span class="num" id="8051300">0x0d</span><span class="op" id="8051304">,</span>&nbsp;<span class="num" id="8051306">0x0e</span><span class="op" id="8051310">,</span>&nbsp;<span class="num" id="8051312">0x0f</span><span class="op" id="8051316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8051321">0x10</span><span class="op" id="8051325">,</span>&nbsp;<span class="num" id="8051327">0x11</span><span class="op" id="8051331">,</span>&nbsp;<span class="num" id="8051333">0x12</span><span class="op" id="8051337">,</span>&nbsp;<span class="num" id="8051339">0x13</span><span class="op" id="8051343">,</span>&nbsp;<span class="num" id="8051345">0x14</span><span class="op" id="8051349">,</span>&nbsp;<span class="num" id="8051351">0x15</span><span class="op" id="8051355">,</span>&nbsp;<span class="num" id="8051357">0x16</span><span class="op" id="8051361">,</span>&nbsp;<span class="num" id="8051363">0x17</span><span class="op" id="8051367">,</span>&nbsp;<span class="num" id="8051369">0x18</span><span class="op" id="8051373">,</span>&nbsp;<span class="num" id="8051375">0x19</span><span class="op" id="8051379">,</span>&nbsp;<span class="num" id="8051381">0x1a</span><span class="op" id="8051385">,</span>&nbsp;<span class="num" id="8051387">0x1b</span><span class="op" id="8051391">,</span>&nbsp;<span class="num" id="8051393">0x1c</span><span class="op" id="8051397">,</span>&nbsp;<span class="num" id="8051399">0x1d</span><span class="op" id="8051403">,</span>&nbsp;<span class="num" id="8051405">0x1e</span><span class="op" id="8051409">,</span>&nbsp;<span class="num" id="8051411">0x1f</span><span class="op" id="8051415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051419">}</span><span class="op" id="8051420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051424">[</span><span class="op" id="8051425">]</span><span class="builtintype" id="8051426">byte</span><span class="op" id="8051430">{</span><span class="num" id="8051431">0x00</span><span class="op" id="8051435">,</span>&nbsp;<span class="num" id="8051437">0x11</span><span class="op" id="8051441">,</span>&nbsp;<span class="num" id="8051443">0x22</span><span class="op" id="8051447">,</span>&nbsp;<span class="num" id="8051449">0x33</span><span class="op" id="8051453">,</span>&nbsp;<span class="num" id="8051455">0x44</span><span class="op" id="8051459">,</span>&nbsp;<span class="num" id="8051461">0x55</span><span class="op" id="8051465">,</span>&nbsp;<span class="num" id="8051467">0x66</span><span class="op" id="8051471">,</span>&nbsp;<span class="num" id="8051473">0x77</span><span class="op" id="8051477">,</span>&nbsp;<span class="num" id="8051479">0x88</span><span class="op" id="8051483">,</span>&nbsp;<span class="num" id="8051485">0x99</span><span class="op" id="8051489">,</span>&nbsp;<span class="num" id="8051491">0xaa</span><span class="op" id="8051495">,</span>&nbsp;<span class="num" id="8051497">0xbb</span><span class="op" id="8051501">,</span>&nbsp;<span class="num" id="8051503">0xcc</span><span class="op" id="8051507">,</span>&nbsp;<span class="num" id="8051509">0xdd</span><span class="op" id="8051513">,</span>&nbsp;<span class="num" id="8051515">0xee</span><span class="op" id="8051519">,</span>&nbsp;<span class="num" id="8051521">0xff</span><span class="op" id="8051525">}</span><span class="op" id="8051526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051530">[</span><span class="op" id="8051531">]</span><span class="builtintype" id="8051532">byte</span><span class="op" id="8051536">{</span><span class="num" id="8051537">0x8e</span><span class="op" id="8051541">,</span>&nbsp;<span class="num" id="8051543">0xa2</span><span class="op" id="8051547">,</span>&nbsp;<span class="num" id="8051549">0xb7</span><span class="op" id="8051553">,</span>&nbsp;<span class="num" id="8051555">0xca</span><span class="op" id="8051559">,</span>&nbsp;<span class="num" id="8051561">0x51</span><span class="op" id="8051565">,</span>&nbsp;<span class="num" id="8051567">0x67</span><span class="op" id="8051571">,</span>&nbsp;<span class="num" id="8051573">0x45</span><span class="op" id="8051577">,</span>&nbsp;<span class="num" id="8051579">0xbf</span><span class="op" id="8051583">,</span>&nbsp;<span class="num" id="8051585">0xea</span><span class="op" id="8051589">,</span>&nbsp;<span class="num" id="8051591">0xfc</span><span class="op" id="8051595">,</span>&nbsp;<span class="num" id="8051597">0x49</span><span class="op" id="8051601">,</span>&nbsp;<span class="num" id="8051603">0x90</span><span class="op" id="8051607">,</span>&nbsp;<span class="num" id="8051609">0x4b</span><span class="op" id="8051613">,</span>&nbsp;<span class="num" id="8051615">0x49</span><span class="op" id="8051619">,</span>&nbsp;<span class="num" id="8051621">0x60</span><span class="op" id="8051625">,</span>&nbsp;<span class="num" id="8051627">0x89</span><span class="op" id="8051631">}</span><span class="op" id="8051632">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051635">}</span><span class="op" id="8051636">,</span><br>
<span class="lineno"></span><span class="op" id="8051638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8051641">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8051689">func</span>&nbsp;<span class="ident" id="8051694">TestEncryptBlock</span><span class="op" id="8051710">(</span><span class="ident" id="8051711">t</span>&nbsp;<span class="op" id="8051713">*</span><span class="ident" id="8051714">testing</span><span class="op" id="8051721">.</span><span class="ident" id="8051722">T</span><span class="op" id="8051723">)</span>&nbsp;<span class="op" id="8051725">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8051728">for</span>&nbsp;<span class="ident" id="8051732">i</span><span class="op" id="8051733">,</span>&nbsp;<span class="ident" id="8051735">tt</span>&nbsp;<span class="op" id="8051738">:=</span>&nbsp;<span class="keyword" id="8051741">range</span>&nbsp;<span class="ident" id="8051747">encryptTests</span>&nbsp;<span class="op" id="8051760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8051764">n</span>&nbsp;<span class="op" id="8051766">:=</span>&nbsp;<span class="builtinfunc" id="8051769">len</span><span class="op" id="8051772">(</span><span class="ident" id="8051773">tt</span><span class="op" id="8051775">.</span><span class="ident" id="8051776">key</span><span class="op" id="8051779">)</span>&nbsp;<span class="op" id="8051781">+</span>&nbsp;<span class="num" id="8051783">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8051788">enc</span>&nbsp;<span class="op" id="8051792">:=</span>&nbsp;<span class="builtinfunc" id="8051795">make</span><span class="op" id="8051799">(</span><span class="op" id="8051800">[</span><span class="op" id="8051801">]</span><span class="builtintype" id="8051802">uint32</span><span class="op" id="8051808">,</span>&nbsp;<span class="ident" id="8051810">n</span><span class="op" id="8051811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8051815">dec</span>&nbsp;<span class="op" id="8051819">:=</span>&nbsp;<span class="builtinfunc" id="8051822">make</span><span class="op" id="8051826">(</span><span class="op" id="8051827">[</span><span class="op" id="8051828">]</span><span class="builtintype" id="8051829">uint32</span><span class="op" id="8051835">,</span>&nbsp;<span class="ident" id="8051837">n</span><span class="op" id="8051838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8051842">expandKey</span><span class="op" id="8051851">(</span><span class="ident" id="8051852">tt</span><span class="op" id="8051854">.</span><span class="ident" id="8051855">key</span><span class="op" id="8051858">,</span>&nbsp;<span class="ident" id="8051860">enc</span><span class="op" id="8051863">,</span>&nbsp;<span class="ident" id="8051865">dec</span><span class="op" id="8051868">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8051872">out</span>&nbsp;<span class="op" id="8051876">:=</span>&nbsp;<span class="builtinfunc" id="8051879">make</span><span class="op" id="8051883">(</span><span class="op" id="8051884">[</span><span class="op" id="8051885">]</span><span class="builtintype" id="8051886">byte</span><span class="op" id="8051890">,</span>&nbsp;<span class="builtinfunc" id="8051892">len</span><span class="op" id="8051895">(</span><span class="ident" id="8051896">tt</span><span class="op" id="8051898">.</span><span class="ident" id="8051899">in</span><span class="op" id="8051901">)</span><span class="op" id="8051902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8051906">encryptBlock</span><span class="op" id="8051918">(</span><span class="ident" id="8051919">enc</span><span class="op" id="8051922">,</span>&nbsp;<span class="ident" id="8051924">out</span><span class="op" id="8051927">,</span>&nbsp;<span class="ident" id="8051929">tt</span><span class="op" id="8051931">.</span><span class="ident" id="8051932">in</span><span class="op" id="8051934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8051938">for</span>&nbsp;<span class="ident" id="8051942">j</span><span class="op" id="8051943">,</span>&nbsp;<span class="ident" id="8051945">v</span>&nbsp;<span class="op" id="8051947">:=</span>&nbsp;<span class="keyword" id="8051950">range</span>&nbsp;<span class="ident" id="8051956">out</span>&nbsp;<span class="op" id="8051960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8051965">if</span>&nbsp;<span class="ident" id="8051968">v</span>&nbsp;<span class="op" id="8051970">!=</span>&nbsp;<span class="ident" id="8051973">tt</span><span class="op" id="8051975">.</span><span class="ident" id="8051976">out</span><span class="op" id="8051979">[</span><span class="ident" id="8051980">j</span><span class="op" id="8051981">]</span>&nbsp;<span class="op" id="8051983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8051989">t</span><span class="op" id="8051990">.</span><span class="ident" id="8051991">Errorf</span><span class="op" id="8051997">(</span><span class="string" id="8051998">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8052040">,</span>&nbsp;<span class="ident" id="8052042">i</span><span class="op" id="8052043">,</span>&nbsp;<span class="ident" id="8052045">j</span><span class="op" id="8052046">,</span>&nbsp;<span class="ident" id="8052048">v</span><span class="op" id="8052049">,</span>&nbsp;<span class="ident" id="8052051">tt</span><span class="op" id="8052053">.</span><span class="ident" id="8052054">out</span><span class="op" id="8052057">[</span><span class="ident" id="8052058">j</span><span class="op" id="8052059">]</span><span class="op" id="8052060">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052066">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052082">}</span><br>
<span class="lineno"></span><span class="op" id="8052084">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="8052087">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8052135">func</span>&nbsp;<span class="ident" id="8052140">TestDecryptBlock</span><span class="op" id="8052156">(</span><span class="ident" id="8052157">t</span>&nbsp;<span class="op" id="8052159">*</span><span class="ident" id="8052160">testing</span><span class="op" id="8052167">.</span><span class="ident" id="8052168">T</span><span class="op" id="8052169">)</span>&nbsp;<span class="op" id="8052171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052174">for</span>&nbsp;<span class="ident" id="8052178">i</span><span class="op" id="8052179">,</span>&nbsp;<span class="ident" id="8052181">tt</span>&nbsp;<span class="op" id="8052184">:=</span>&nbsp;<span class="keyword" id="8052187">range</span>&nbsp;<span class="ident" id="8052193">encryptTests</span>&nbsp;<span class="op" id="8052206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052210">n</span>&nbsp;<span class="op" id="8052212">:=</span>&nbsp;<span class="builtinfunc" id="8052215">len</span><span class="op" id="8052218">(</span><span class="ident" id="8052219">tt</span><span class="op" id="8052221">.</span><span class="ident" id="8052222">key</span><span class="op" id="8052225">)</span>&nbsp;<span class="op" id="8052227">+</span>&nbsp;<span class="num" id="8052229">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052234">enc</span>&nbsp;<span class="op" id="8052238">:=</span>&nbsp;<span class="builtinfunc" id="8052241">make</span><span class="op" id="8052245">(</span><span class="op" id="8052246">[</span><span class="op" id="8052247">]</span><span class="builtintype" id="8052248">uint32</span><span class="op" id="8052254">,</span>&nbsp;<span class="ident" id="8052256">n</span><span class="op" id="8052257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052261">dec</span>&nbsp;<span class="op" id="8052265">:=</span>&nbsp;<span class="builtinfunc" id="8052268">make</span><span class="op" id="8052272">(</span><span class="op" id="8052273">[</span><span class="op" id="8052274">]</span><span class="builtintype" id="8052275">uint32</span><span class="op" id="8052281">,</span>&nbsp;<span class="ident" id="8052283">n</span><span class="op" id="8052284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052288">expandKey</span><span class="op" id="8052297">(</span><span class="ident" id="8052298">tt</span><span class="op" id="8052300">.</span><span class="ident" id="8052301">key</span><span class="op" id="8052304">,</span>&nbsp;<span class="ident" id="8052306">enc</span><span class="op" id="8052309">,</span>&nbsp;<span class="ident" id="8052311">dec</span><span class="op" id="8052314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052318">plain</span>&nbsp;<span class="op" id="8052324">:=</span>&nbsp;<span class="builtinfunc" id="8052327">make</span><span class="op" id="8052331">(</span><span class="op" id="8052332">[</span><span class="op" id="8052333">]</span><span class="builtintype" id="8052334">byte</span><span class="op" id="8052338">,</span>&nbsp;<span class="builtinfunc" id="8052340">len</span><span class="op" id="8052343">(</span><span class="ident" id="8052344">tt</span><span class="op" id="8052346">.</span><span class="ident" id="8052347">in</span><span class="op" id="8052349">)</span><span class="op" id="8052350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052354">decryptBlock</span><span class="op" id="8052366">(</span><span class="ident" id="8052367">dec</span><span class="op" id="8052370">,</span>&nbsp;<span class="ident" id="8052372">plain</span><span class="op" id="8052377">,</span>&nbsp;<span class="ident" id="8052379">tt</span><span class="op" id="8052381">.</span><span class="ident" id="8052382">out</span><span class="op" id="8052385">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052389">for</span>&nbsp;<span class="ident" id="8052393">j</span><span class="op" id="8052394">,</span>&nbsp;<span class="ident" id="8052396">v</span>&nbsp;<span class="op" id="8052398">:=</span>&nbsp;<span class="keyword" id="8052401">range</span>&nbsp;<span class="ident" id="8052407">plain</span>&nbsp;<span class="op" id="8052413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052418">if</span>&nbsp;<span class="ident" id="8052421">v</span>&nbsp;<span class="op" id="8052423">!=</span>&nbsp;<span class="ident" id="8052426">tt</span><span class="op" id="8052428">.</span><span class="ident" id="8052429">in</span><span class="op" id="8052431">[</span><span class="ident" id="8052432">j</span><span class="op" id="8052433">]</span>&nbsp;<span class="op" id="8052435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052441">t</span><span class="op" id="8052442">.</span><span class="ident" id="8052443">Errorf</span><span class="op" id="8052449">(</span><span class="string" id="8052450">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8052494">,</span>&nbsp;<span class="ident" id="8052496">i</span><span class="op" id="8052497">,</span>&nbsp;<span class="ident" id="8052499">j</span><span class="op" id="8052500">,</span>&nbsp;<span class="ident" id="8052502">v</span><span class="op" id="8052503">,</span>&nbsp;<span class="ident" id="8052505">tt</span><span class="op" id="8052507">.</span><span class="ident" id="8052508">in</span><span class="op" id="8052510">[</span><span class="ident" id="8052511">j</span><span class="op" id="8052512">]</span><span class="op" id="8052513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052519">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052528">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052535">}</span><br>
<span class="lineno"></span><span class="op" id="8052537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8052540">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="8052597">func</span>&nbsp;<span class="ident" id="8052602">TestCipherEncrypt</span><span class="op" id="8052619">(</span><span class="ident" id="8052620">t</span>&nbsp;<span class="op" id="8052622">*</span><span class="ident" id="8052623">testing</span><span class="op" id="8052630">.</span><span class="ident" id="8052631">T</span><span class="op" id="8052632">)</span>&nbsp;<span class="op" id="8052634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052637">for</span>&nbsp;<span class="ident" id="8052641">i</span><span class="op" id="8052642">,</span>&nbsp;<span class="ident" id="8052644">tt</span>&nbsp;<span class="op" id="8052647">:=</span>&nbsp;<span class="keyword" id="8052650">range</span>&nbsp;<span class="ident" id="8052656">encryptTests</span>&nbsp;<span class="op" id="8052669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052673">c</span><span class="op" id="8052674">,</span>&nbsp;<span class="ident" id="8052676">err</span>&nbsp;<span class="op" id="8052680">:=</span>&nbsp;<span class="ident" id="8052683">NewCipher</span><span class="op" id="8052692">(</span><span class="ident" id="8052693">tt</span><span class="op" id="8052695">.</span><span class="ident" id="8052696">key</span><span class="op" id="8052699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052703">if</span>&nbsp;<span class="ident" id="8052706">err</span>&nbsp;<span class="op" id="8052710">!=</span>&nbsp;<span class="ident" id="8052713">nil</span>&nbsp;<span class="op" id="8052717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052722">t</span><span class="op" id="8052723">.</span><span class="ident" id="8052724">Errorf</span><span class="op" id="8052730">(</span><span class="string" id="8052731">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="8052757">,</span>&nbsp;<span class="builtinfunc" id="8052759">len</span><span class="op" id="8052762">(</span><span class="ident" id="8052763">tt</span><span class="op" id="8052765">.</span><span class="ident" id="8052766">key</span><span class="op" id="8052769">)</span><span class="op" id="8052770">,</span>&nbsp;<span class="ident" id="8052772">err</span><span class="op" id="8052775">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052780">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052795">out</span>&nbsp;<span class="op" id="8052799">:=</span>&nbsp;<span class="builtinfunc" id="8052802">make</span><span class="op" id="8052806">(</span><span class="op" id="8052807">[</span><span class="op" id="8052808">]</span><span class="builtintype" id="8052809">byte</span><span class="op" id="8052813">,</span>&nbsp;<span class="builtinfunc" id="8052815">len</span><span class="op" id="8052818">(</span><span class="ident" id="8052819">tt</span><span class="op" id="8052821">.</span><span class="ident" id="8052822">in</span><span class="op" id="8052824">)</span><span class="op" id="8052825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052829">c</span><span class="op" id="8052830">.</span><span class="ident" id="8052831">Encrypt</span><span class="op" id="8052838">(</span><span class="ident" id="8052839">out</span><span class="op" id="8052842">,</span>&nbsp;<span class="ident" id="8052844">tt</span><span class="op" id="8052846">.</span><span class="ident" id="8052847">in</span><span class="op" id="8052849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052853">for</span>&nbsp;<span class="ident" id="8052857">j</span><span class="op" id="8052858">,</span>&nbsp;<span class="ident" id="8052860">v</span>&nbsp;<span class="op" id="8052862">:=</span>&nbsp;<span class="keyword" id="8052865">range</span>&nbsp;<span class="ident" id="8052871">out</span>&nbsp;<span class="op" id="8052875">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052880">if</span>&nbsp;<span class="ident" id="8052883">v</span>&nbsp;<span class="op" id="8052885">!=</span>&nbsp;<span class="ident" id="8052888">tt</span><span class="op" id="8052890">.</span><span class="ident" id="8052891">out</span><span class="op" id="8052894">[</span><span class="ident" id="8052895">j</span><span class="op" id="8052896">]</span>&nbsp;<span class="op" id="8052898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052904">t</span><span class="op" id="8052905">.</span><span class="ident" id="8052906">Errorf</span><span class="op" id="8052912">(</span><span class="string" id="8052913">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8052957">,</span>&nbsp;<span class="ident" id="8052959">i</span><span class="op" id="8052960">,</span>&nbsp;<span class="ident" id="8052962">j</span><span class="op" id="8052963">,</span>&nbsp;<span class="ident" id="8052965">v</span><span class="op" id="8052966">,</span>&nbsp;<span class="ident" id="8052968">tt</span><span class="op" id="8052970">.</span><span class="ident" id="8052971">out</span><span class="op" id="8052974">[</span><span class="ident" id="8052975">j</span><span class="op" id="8052976">]</span><span class="op" id="8052977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052983">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052996">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052999">}</span><br>
<span class="lineno"></span><span class="op" id="8053001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8053004">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8053054">func</span>&nbsp;<span class="ident" id="8053059">TestCipherDecrypt</span><span class="op" id="8053076">(</span><span class="ident" id="8053077">t</span>&nbsp;<span class="op" id="8053079">*</span><span class="ident" id="8053080">testing</span><span class="op" id="8053087">.</span><span class="ident" id="8053088">T</span><span class="op" id="8053089">)</span>&nbsp;<span class="op" id="8053091">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8053094">for</span>&nbsp;<span class="ident" id="8053098">i</span><span class="op" id="8053099">,</span>&nbsp;<span class="ident" id="8053101">tt</span>&nbsp;<span class="op" id="8053104">:=</span>&nbsp;<span class="keyword" id="8053107">range</span>&nbsp;<span class="ident" id="8053113">encryptTests</span>&nbsp;<span class="op" id="8053126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053130">c</span><span class="op" id="8053131">,</span>&nbsp;<span class="ident" id="8053133">err</span>&nbsp;<span class="op" id="8053137">:=</span>&nbsp;<span class="ident" id="8053140">NewCipher</span><span class="op" id="8053149">(</span><span class="ident" id="8053150">tt</span><span class="op" id="8053152">.</span><span class="ident" id="8053153">key</span><span class="op" id="8053156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8053160">if</span>&nbsp;<span class="ident" id="8053163">err</span>&nbsp;<span class="op" id="8053167">!=</span>&nbsp;<span class="ident" id="8053170">nil</span>&nbsp;<span class="op" id="8053174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053179">t</span><span class="op" id="8053180">.</span><span class="ident" id="8053181">Errorf</span><span class="op" id="8053187">(</span><span class="string" id="8053188">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="8053214">,</span>&nbsp;<span class="builtinfunc" id="8053216">len</span><span class="op" id="8053219">(</span><span class="ident" id="8053220">tt</span><span class="op" id="8053222">.</span><span class="ident" id="8053223">key</span><span class="op" id="8053226">)</span><span class="op" id="8053227">,</span>&nbsp;<span class="ident" id="8053229">err</span><span class="op" id="8053232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8053237">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053252">plain</span>&nbsp;<span class="op" id="8053258">:=</span>&nbsp;<span class="builtinfunc" id="8053261">make</span><span class="op" id="8053265">(</span><span class="op" id="8053266">[</span><span class="op" id="8053267">]</span><span class="builtintype" id="8053268">byte</span><span class="op" id="8053272">,</span>&nbsp;<span class="builtinfunc" id="8053274">len</span><span class="op" id="8053277">(</span><span class="ident" id="8053278">tt</span><span class="op" id="8053280">.</span><span class="ident" id="8053281">in</span><span class="op" id="8053283">)</span><span class="op" id="8053284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053288">c</span><span class="op" id="8053289">.</span><span class="ident" id="8053290">Decrypt</span><span class="op" id="8053297">(</span><span class="ident" id="8053298">plain</span><span class="op" id="8053303">,</span>&nbsp;<span class="ident" id="8053305">tt</span><span class="op" id="8053307">.</span><span class="ident" id="8053308">out</span><span class="op" id="8053311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8053315">for</span>&nbsp;<span class="ident" id="8053319">j</span><span class="op" id="8053320">,</span>&nbsp;<span class="ident" id="8053322">v</span>&nbsp;<span class="op" id="8053324">:=</span>&nbsp;<span class="keyword" id="8053327">range</span>&nbsp;<span class="ident" id="8053333">plain</span>&nbsp;<span class="op" id="8053339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8053344">if</span>&nbsp;<span class="ident" id="8053347">v</span>&nbsp;<span class="op" id="8053349">!=</span>&nbsp;<span class="ident" id="8053352">tt</span><span class="op" id="8053354">.</span><span class="ident" id="8053355">in</span><span class="op" id="8053357">[</span><span class="ident" id="8053358">j</span><span class="op" id="8053359">]</span>&nbsp;<span class="op" id="8053361">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053367">t</span><span class="op" id="8053368">.</span><span class="ident" id="8053369">Errorf</span><span class="op" id="8053375">(</span><span class="string" id="8053376">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8053420">,</span>&nbsp;<span class="ident" id="8053422">i</span><span class="op" id="8053423">,</span>&nbsp;<span class="ident" id="8053425">j</span><span class="op" id="8053426">,</span>&nbsp;<span class="ident" id="8053428">v</span><span class="op" id="8053429">,</span>&nbsp;<span class="ident" id="8053431">tt</span><span class="op" id="8053433">.</span><span class="ident" id="8053434">in</span><span class="op" id="8053436">[</span><span class="ident" id="8053437">j</span><span class="op" id="8053438">]</span><span class="op" id="8053439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8053445">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053461">}</span><br>
<span class="lineno">355</span><span class="op" id="8053463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8053466">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="8053494">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="8053526">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="8053545">func</span>&nbsp;<span class="ident" id="8053550">TestShortBlocks</span><span class="op" id="8053565">(</span><span class="ident" id="8053566">t</span>&nbsp;<span class="op" id="8053568">*</span><span class="ident" id="8053569">testing</span><span class="op" id="8053576">.</span><span class="ident" id="8053577">T</span><span class="op" id="8053578">)</span>&nbsp;<span class="op" id="8053580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053583">bytes</span>&nbsp;<span class="op" id="8053589">:=</span>&nbsp;<span class="keyword" id="8053592">func</span><span class="op" id="8053596">(</span><span class="ident" id="8053597">n</span>&nbsp;<span class="builtintype" id="8053599">int</span><span class="op" id="8053602">)</span>&nbsp;<span class="op" id="8053604">[</span><span class="op" id="8053605">]</span><span class="builtintype" id="8053606">byte</span>&nbsp;<span class="op" id="8053611">{</span>&nbsp;<span class="keyword" id="8053613">return</span>&nbsp;<span class="builtinfunc" id="8053620">make</span><span class="op" id="8053624">(</span><span class="op" id="8053625">[</span><span class="op" id="8053626">]</span><span class="builtintype" id="8053627">byte</span><span class="op" id="8053631">,</span>&nbsp;<span class="ident" id="8053633">n</span><span class="op" id="8053634">)</span>&nbsp;<span class="op" id="8053636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053640">c</span><span class="op" id="8053641">,</span>&nbsp;<span class="ident" id="8053643">_</span>&nbsp;<span class="op" id="8053645">:=</span>&nbsp;<span class="ident" id="8053648">NewCipher</span><span class="op" id="8053657">(</span><span class="ident" id="8053658">bytes</span><span class="op" id="8053663">(</span><span class="num" id="8053664">16</span><span class="op" id="8053666">)</span><span class="op" id="8053667">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053671">mustPanic</span><span class="op" id="8053680">(</span><span class="ident" id="8053681">t</span><span class="op" id="8053682">,</span>&nbsp;<span class="string" id="8053684">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8053718">,</span>&nbsp;<span class="keyword" id="8053720">func</span><span class="op" id="8053724">(</span><span class="op" id="8053725">)</span>&nbsp;<span class="op" id="8053727">{</span>&nbsp;<span class="ident" id="8053729">c</span><span class="op" id="8053730">.</span><span class="ident" id="8053731">Encrypt</span><span class="op" id="8053738">(</span><span class="ident" id="8053739">bytes</span><span class="op" id="8053744">(</span><span class="num" id="8053745">1</span><span class="op" id="8053746">)</span><span class="op" id="8053747">,</span>&nbsp;<span class="ident" id="8053749">bytes</span><span class="op" id="8053754">(</span><span class="num" id="8053755">1</span><span class="op" id="8053756">)</span><span class="op" id="8053757">)</span>&nbsp;<span class="op" id="8053759">}</span><span class="op" id="8053760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053763">mustPanic</span><span class="op" id="8053772">(</span><span class="ident" id="8053773">t</span><span class="op" id="8053774">,</span>&nbsp;<span class="string" id="8053776">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8053810">,</span>&nbsp;<span class="keyword" id="8053812">func</span><span class="op" id="8053816">(</span><span class="op" id="8053817">)</span>&nbsp;<span class="op" id="8053819">{</span>&nbsp;<span class="ident" id="8053821">c</span><span class="op" id="8053822">.</span><span class="ident" id="8053823">Decrypt</span><span class="op" id="8053830">(</span><span class="ident" id="8053831">bytes</span><span class="op" id="8053836">(</span><span class="num" id="8053837">1</span><span class="op" id="8053838">)</span><span class="op" id="8053839">,</span>&nbsp;<span class="ident" id="8053841">bytes</span><span class="op" id="8053846">(</span><span class="num" id="8053847">1</span><span class="op" id="8053848">)</span><span class="op" id="8053849">)</span>&nbsp;<span class="op" id="8053851">}</span><span class="op" id="8053852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053855">mustPanic</span><span class="op" id="8053864">(</span><span class="ident" id="8053865">t</span><span class="op" id="8053866">,</span>&nbsp;<span class="string" id="8053868">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8053902">,</span>&nbsp;<span class="keyword" id="8053904">func</span><span class="op" id="8053908">(</span><span class="op" id="8053909">)</span>&nbsp;<span class="op" id="8053911">{</span>&nbsp;<span class="ident" id="8053913">c</span><span class="op" id="8053914">.</span><span class="ident" id="8053915">Encrypt</span><span class="op" id="8053922">(</span><span class="ident" id="8053923">bytes</span><span class="op" id="8053928">(</span><span class="num" id="8053929">100</span><span class="op" id="8053932">)</span><span class="op" id="8053933">,</span>&nbsp;<span class="ident" id="8053935">bytes</span><span class="op" id="8053940">(</span><span class="num" id="8053941">1</span><span class="op" id="8053942">)</span><span class="op" id="8053943">)</span>&nbsp;<span class="op" id="8053945">}</span><span class="op" id="8053946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053949">mustPanic</span><span class="op" id="8053958">(</span><span class="ident" id="8053959">t</span><span class="op" id="8053960">,</span>&nbsp;<span class="string" id="8053962">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8053996">,</span>&nbsp;<span class="keyword" id="8053998">func</span><span class="op" id="8054002">(</span><span class="op" id="8054003">)</span>&nbsp;<span class="op" id="8054005">{</span>&nbsp;<span class="ident" id="8054007">c</span><span class="op" id="8054008">.</span><span class="ident" id="8054009">Decrypt</span><span class="op" id="8054016">(</span><span class="ident" id="8054017">bytes</span><span class="op" id="8054022">(</span><span class="num" id="8054023">100</span><span class="op" id="8054026">)</span><span class="op" id="8054027">,</span>&nbsp;<span class="ident" id="8054029">bytes</span><span class="op" id="8054034">(</span><span class="num" id="8054035">1</span><span class="op" id="8054036">)</span><span class="op" id="8054037">)</span>&nbsp;<span class="op" id="8054039">}</span><span class="op" id="8054040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054043">mustPanic</span><span class="op" id="8054052">(</span><span class="ident" id="8054053">t</span><span class="op" id="8054054">,</span>&nbsp;<span class="string" id="8054056">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8054091">,</span>&nbsp;<span class="keyword" id="8054093">func</span><span class="op" id="8054097">(</span><span class="op" id="8054098">)</span>&nbsp;<span class="op" id="8054100">{</span>&nbsp;<span class="ident" id="8054102">c</span><span class="op" id="8054103">.</span><span class="ident" id="8054104">Encrypt</span><span class="op" id="8054111">(</span><span class="ident" id="8054112">bytes</span><span class="op" id="8054117">(</span><span class="num" id="8054118">1</span><span class="op" id="8054119">)</span><span class="op" id="8054120">,</span>&nbsp;<span class="ident" id="8054122">bytes</span><span class="op" id="8054127">(</span><span class="num" id="8054128">100</span><span class="op" id="8054131">)</span><span class="op" id="8054132">)</span>&nbsp;<span class="op" id="8054134">}</span><span class="op" id="8054135">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054138">mustPanic</span><span class="op" id="8054147">(</span><span class="ident" id="8054148">t</span><span class="op" id="8054149">,</span>&nbsp;<span class="string" id="8054151">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8054186">,</span>&nbsp;<span class="keyword" id="8054188">func</span><span class="op" id="8054192">(</span><span class="op" id="8054193">)</span>&nbsp;<span class="op" id="8054195">{</span>&nbsp;<span class="ident" id="8054197">c</span><span class="op" id="8054198">.</span><span class="ident" id="8054199">Decrypt</span><span class="op" id="8054206">(</span><span class="ident" id="8054207">bytes</span><span class="op" id="8054212">(</span><span class="num" id="8054213">1</span><span class="op" id="8054214">)</span><span class="op" id="8054215">,</span>&nbsp;<span class="ident" id="8054217">bytes</span><span class="op" id="8054222">(</span><span class="num" id="8054223">100</span><span class="op" id="8054226">)</span><span class="op" id="8054227">)</span>&nbsp;<span class="op" id="8054229">}</span><span class="op" id="8054230">)</span><br>
<span class="lineno"></span><span class="op" id="8054232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8054235">func</span>&nbsp;<span class="ident" id="8054240">mustPanic</span><span class="op" id="8054249">(</span><span class="ident" id="8054250">t</span>&nbsp;<span class="op" id="8054252">*</span><span class="ident" id="8054253">testing</span><span class="op" id="8054260">.</span><span class="ident" id="8054261">T</span><span class="op" id="8054262">,</span>&nbsp;<span class="ident" id="8054264">msg</span>&nbsp;<span class="builtintype" id="8054268">string</span><span class="op" id="8054274">,</span>&nbsp;<span class="ident" id="8054276">f</span>&nbsp;<span class="keyword" id="8054278">func</span><span class="op" id="8054282">(</span><span class="op" id="8054283">)</span><span class="op" id="8054284">)</span>&nbsp;<span class="op" id="8054286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8054289">defer</span>&nbsp;<span class="keyword" id="8054295">func</span><span class="op" id="8054299">(</span><span class="op" id="8054300">)</span>&nbsp;<span class="op" id="8054302">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054306">err</span>&nbsp;<span class="op" id="8054310">:=</span>&nbsp;<span class="builtinfunc" id="8054313">recover</span><span class="op" id="8054320">(</span><span class="op" id="8054321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8054325">if</span>&nbsp;<span class="ident" id="8054328">err</span>&nbsp;<span class="op" id="8054332">==</span>&nbsp;<span class="ident" id="8054335">nil</span>&nbsp;<span class="op" id="8054339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054344">t</span><span class="op" id="8054345">.</span><span class="ident" id="8054346">Errorf</span><span class="op" id="8054352">(</span><span class="string" id="8054353">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="8054388">,</span>&nbsp;<span class="ident" id="8054390">msg</span><span class="op" id="8054393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8054397">}</span>&nbsp;<span class="keyword" id="8054399">else</span>&nbsp;<span class="keyword" id="8054404">if</span>&nbsp;<span class="ident" id="8054407">err</span>&nbsp;<span class="op" id="8054411">!=</span>&nbsp;<span class="ident" id="8054414">msg</span>&nbsp;<span class="op" id="8054418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054423">t</span><span class="op" id="8054424">.</span><span class="ident" id="8054425">Errorf</span><span class="op" id="8054431">(</span><span class="string" id="8054432">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="8054457">,</span>&nbsp;<span class="ident" id="8054459">err</span><span class="op" id="8054462">,</span>&nbsp;<span class="ident" id="8054464">msg</span><span class="op" id="8054467">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8054471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8054474">}</span><span class="op" id="8054475">(</span><span class="op" id="8054476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054479">f</span><span class="op" id="8054480">(</span><span class="op" id="8054481">)</span><br>
<span class="lineno"></span><span class="op" id="8054483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="8054486">func</span>&nbsp;<span class="ident" id="8054491">BenchmarkEncrypt</span><span class="op" id="8054507">(</span><span class="ident" id="8054508">b</span>&nbsp;<span class="op" id="8054510">*</span><span class="ident" id="8054511">testing</span><span class="op" id="8054518">.</span><span class="ident" id="8054519">B</span><span class="op" id="8054520">)</span>&nbsp;<span class="op" id="8054522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054525">tt</span>&nbsp;<span class="op" id="8054528">:=</span>&nbsp;<span class="ident" id="8054531">encryptTests</span><span class="op" id="8054543">[</span><span class="num" id="8054544">0</span><span class="op" id="8054545">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054548">c</span><span class="op" id="8054549">,</span>&nbsp;<span class="ident" id="8054551">err</span>&nbsp;<span class="op" id="8054555">:=</span>&nbsp;<span class="ident" id="8054558">NewCipher</span><span class="op" id="8054567">(</span><span class="ident" id="8054568">tt</span><span class="op" id="8054570">.</span><span class="ident" id="8054571">key</span><span class="op" id="8054574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8054577">if</span>&nbsp;<span class="ident" id="8054580">err</span>&nbsp;<span class="op" id="8054584">!=</span>&nbsp;<span class="ident" id="8054587">nil</span>&nbsp;<span class="op" id="8054591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054595">b</span><span class="op" id="8054596">.</span><span class="ident" id="8054597">Fatal</span><span class="op" id="8054602">(</span><span class="string" id="8054603">&#34;NewCipher:&#34;</span><span class="op" id="8054615">,</span>&nbsp;<span class="ident" id="8054617">err</span><span class="op" id="8054620">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8054623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054626">out</span>&nbsp;<span class="op" id="8054630">:=</span>&nbsp;<span class="builtinfunc" id="8054633">make</span><span class="op" id="8054637">(</span><span class="op" id="8054638">[</span><span class="op" id="8054639">]</span><span class="builtintype" id="8054640">byte</span><span class="op" id="8054644">,</span>&nbsp;<span class="builtinfunc" id="8054646">len</span><span class="op" id="8054649">(</span><span class="ident" id="8054650">tt</span><span class="op" id="8054652">.</span><span class="ident" id="8054653">in</span><span class="op" id="8054655">)</span><span class="op" id="8054656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054659">b</span><span class="op" id="8054660">.</span><span class="ident" id="8054661">SetBytes</span><span class="op" id="8054669">(</span><span class="ident" id="8054670">int64</span><span class="op" id="8054675">(</span><span class="builtinfunc" id="8054676">len</span><span class="op" id="8054679">(</span><span class="ident" id="8054680">out</span><span class="op" id="8054683">)</span><span class="op" id="8054684">)</span><span class="op" id="8054685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054688">b</span><span class="op" id="8054689">.</span><span class="ident" id="8054690">ResetTimer</span><span class="op" id="8054700">(</span><span class="op" id="8054701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8054704">for</span>&nbsp;<span class="ident" id="8054708">i</span>&nbsp;<span class="op" id="8054710">:=</span>&nbsp;<span class="num" id="8054713">0</span><span class="op" id="8054714">;</span>&nbsp;<span class="ident" id="8054716">i</span>&nbsp;<span class="op" id="8054718">&lt;</span>&nbsp;<span class="ident" id="8054720">b</span><span class="op" id="8054721">.</span><span class="ident" id="8054722">N</span><span class="op" id="8054723">;</span>&nbsp;<span class="ident" id="8054725">i</span><span class="op" id="8054726">++</span>&nbsp;<span class="op" id="8054729">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054733">c</span><span class="op" id="8054734">.</span><span class="ident" id="8054735">Encrypt</span><span class="op" id="8054742">(</span><span class="ident" id="8054743">out</span><span class="op" id="8054746">,</span>&nbsp;<span class="ident" id="8054748">tt</span><span class="op" id="8054750">.</span><span class="ident" id="8054751">in</span><span class="op" id="8054753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8054756">}</span><br>
<span class="lineno"></span><span class="op" id="8054758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8054761">func</span>&nbsp;<span class="ident" id="8054766">BenchmarkDecrypt</span><span class="op" id="8054782">(</span><span class="ident" id="8054783">b</span>&nbsp;<span class="op" id="8054785">*</span><span class="ident" id="8054786">testing</span><span class="op" id="8054793">.</span><span class="ident" id="8054794">B</span><span class="op" id="8054795">)</span>&nbsp;<span class="op" id="8054797">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054800">tt</span>&nbsp;<span class="op" id="8054803">:=</span>&nbsp;<span class="ident" id="8054806">encryptTests</span><span class="op" id="8054818">[</span><span class="num" id="8054819">0</span><span class="op" id="8054820">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054823">c</span><span class="op" id="8054824">,</span>&nbsp;<span class="ident" id="8054826">err</span>&nbsp;<span class="op" id="8054830">:=</span>&nbsp;<span class="ident" id="8054833">NewCipher</span><span class="op" id="8054842">(</span><span class="ident" id="8054843">tt</span><span class="op" id="8054845">.</span><span class="ident" id="8054846">key</span><span class="op" id="8054849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8054852">if</span>&nbsp;<span class="ident" id="8054855">err</span>&nbsp;<span class="op" id="8054859">!=</span>&nbsp;<span class="ident" id="8054862">nil</span>&nbsp;<span class="op" id="8054866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054870">b</span><span class="op" id="8054871">.</span><span class="ident" id="8054872">Fatal</span><span class="op" id="8054877">(</span><span class="string" id="8054878">&#34;NewCipher:&#34;</span><span class="op" id="8054890">,</span>&nbsp;<span class="ident" id="8054892">err</span><span class="op" id="8054895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8054898">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054901">out</span>&nbsp;<span class="op" id="8054905">:=</span>&nbsp;<span class="builtinfunc" id="8054908">make</span><span class="op" id="8054912">(</span><span class="op" id="8054913">[</span><span class="op" id="8054914">]</span><span class="builtintype" id="8054915">byte</span><span class="op" id="8054919">,</span>&nbsp;<span class="builtinfunc" id="8054921">len</span><span class="op" id="8054924">(</span><span class="ident" id="8054925">tt</span><span class="op" id="8054927">.</span><span class="ident" id="8054928">out</span><span class="op" id="8054931">)</span><span class="op" id="8054932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054935">b</span><span class="op" id="8054936">.</span><span class="ident" id="8054937">SetBytes</span><span class="op" id="8054945">(</span><span class="ident" id="8054946">int64</span><span class="op" id="8054951">(</span><span class="builtinfunc" id="8054952">len</span><span class="op" id="8054955">(</span><span class="ident" id="8054956">out</span><span class="op" id="8054959">)</span><span class="op" id="8054960">)</span><span class="op" id="8054961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8054964">b</span><span class="op" id="8054965">.</span><span class="ident" id="8054966">ResetTimer</span><span class="op" id="8054976">(</span><span class="op" id="8054977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8054980">for</span>&nbsp;<span class="ident" id="8054984">i</span>&nbsp;<span class="op" id="8054986">:=</span>&nbsp;<span class="num" id="8054989">0</span><span class="op" id="8054990">;</span>&nbsp;<span class="ident" id="8054992">i</span>&nbsp;<span class="op" id="8054994">&lt;</span>&nbsp;<span class="ident" id="8054996">b</span><span class="op" id="8054997">.</span><span class="ident" id="8054998">N</span><span class="op" id="8054999">;</span>&nbsp;<span class="ident" id="8055001">i</span><span class="op" id="8055002">++</span>&nbsp;<span class="op" id="8055005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8055009">c</span><span class="op" id="8055010">.</span><span class="ident" id="8055011">Decrypt</span><span class="op" id="8055018">(</span><span class="ident" id="8055019">out</span><span class="op" id="8055022">,</span>&nbsp;<span class="ident" id="8055024">tt</span><span class="op" id="8055026">.</span><span class="ident" id="8055027">out</span><span class="op" id="8055030">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8055033">}</span><br>
<span class="lineno"></span><span class="op" id="8055035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8055038">func</span>&nbsp;<span class="ident" id="8055043">BenchmarkExpand</span><span class="op" id="8055058">(</span><span class="ident" id="8055059">b</span>&nbsp;<span class="op" id="8055061">*</span><span class="ident" id="8055062">testing</span><span class="op" id="8055069">.</span><span class="ident" id="8055070">B</span><span class="op" id="8055071">)</span>&nbsp;<span class="op" id="8055073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8055076">tt</span>&nbsp;<span class="op" id="8055079">:=</span>&nbsp;<span class="ident" id="8055082">encryptTests</span><span class="op" id="8055094">[</span><span class="num" id="8055095">0</span><span class="op" id="8055096">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8055099">n</span>&nbsp;<span class="op" id="8055101">:=</span>&nbsp;<span class="builtinfunc" id="8055104">len</span><span class="op" id="8055107">(</span><span class="ident" id="8055108">tt</span><span class="op" id="8055110">.</span><span class="ident" id="8055111">key</span><span class="op" id="8055114">)</span>&nbsp;<span class="op" id="8055116">+</span>&nbsp;<span class="num" id="8055118">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8055122">c</span>&nbsp;<span class="op" id="8055124">:=</span>&nbsp;<span class="op" id="8055127">&amp;</span><span class="ident" id="8055128">aesCipher</span><span class="op" id="8055137">{</span><span class="builtinfunc" id="8055138">make</span><span class="op" id="8055142">(</span><span class="op" id="8055143">[</span><span class="op" id="8055144">]</span><span class="builtintype" id="8055145">uint32</span><span class="op" id="8055151">,</span>&nbsp;<span class="ident" id="8055153">n</span><span class="op" id="8055154">)</span><span class="op" id="8055155">,</span>&nbsp;<span class="builtinfunc" id="8055157">make</span><span class="op" id="8055161">(</span><span class="op" id="8055162">[</span><span class="op" id="8055163">]</span><span class="builtintype" id="8055164">uint32</span><span class="op" id="8055170">,</span>&nbsp;<span class="ident" id="8055172">n</span><span class="op" id="8055173">)</span><span class="op" id="8055174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8055177">b</span><span class="op" id="8055178">.</span><span class="ident" id="8055179">ResetTimer</span><span class="op" id="8055189">(</span><span class="op" id="8055190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8055193">for</span>&nbsp;<span class="ident" id="8055197">i</span>&nbsp;<span class="op" id="8055199">:=</span>&nbsp;<span class="num" id="8055202">0</span><span class="op" id="8055203">;</span>&nbsp;<span class="ident" id="8055205">i</span>&nbsp;<span class="op" id="8055207">&lt;</span>&nbsp;<span class="ident" id="8055209">b</span><span class="op" id="8055210">.</span><span class="ident" id="8055211">N</span><span class="op" id="8055212">;</span>&nbsp;<span class="ident" id="8055214">i</span><span class="op" id="8055215">++</span>&nbsp;<span class="op" id="8055218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8055222">expandKey</span><span class="op" id="8055231">(</span><span class="ident" id="8055232">tt</span><span class="op" id="8055234">.</span><span class="ident" id="8055235">key</span><span class="op" id="8055238">,</span>&nbsp;<span class="ident" id="8055240">c</span><span class="op" id="8055241">.</span><span class="ident" id="8055242">enc</span><span class="op" id="8055245">,</span>&nbsp;<span class="ident" id="8055247">c</span><span class="op" id="8055248">.</span><span class="ident" id="8055249">dec</span><span class="op" id="8055252">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8055255">}</span><br>
<span class="lineno"></span><span class="op" id="8055257">}</span>
</div>
</body>
</html>
