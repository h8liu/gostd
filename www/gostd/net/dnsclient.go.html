<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3568649">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3568704">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3568758">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3568809">package</span>&nbsp;<span class="ident" id="3568817">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3568822">import</span>&nbsp;<span class="op" id="3568829">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3568832">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3568845">&#34;sort&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3568852">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3568855">//&nbsp;DNSError&nbsp;represents&nbsp;a&nbsp;DNS&nbsp;lookup&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3568898">type</span>&nbsp;<span class="ident" id="3568903">DNSError</span>&nbsp;<span class="keyword" id="3568912">struct</span>&nbsp;<span class="op" id="3568919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3568922">Err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3568932">string</span>&nbsp;<span class="comment" id="3568939">//&nbsp;description&nbsp;of&nbsp;the&nbsp;error</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3568968">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3568978">string</span>&nbsp;<span class="comment" id="3568985">//&nbsp;name&nbsp;looked&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569005">Server</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3569015">string</span>&nbsp;<span class="comment" id="3569022">//&nbsp;server&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569038">IsTimeout</span>&nbsp;<span class="builtintype" id="3569048">bool</span><br>
<span class="lineno"></span><span class="op" id="3569053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="3569056">func</span>&nbsp;<span class="op" id="3569061">(</span><span class="ident" id="3569062">e</span>&nbsp;<span class="op" id="3569064">*</span><span class="ident" id="3569065">DNSError</span><span class="op" id="3569073">)</span>&nbsp;<span class="ident" id="3569075">Error</span><span class="op" id="3569080">(</span><span class="op" id="3569081">)</span>&nbsp;<span class="builtintype" id="3569083">string</span>&nbsp;<span class="op" id="3569090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569093">if</span>&nbsp;<span class="ident" id="3569096">e</span>&nbsp;<span class="op" id="3569098">==</span>&nbsp;<span class="ident" id="3569101">nil</span>&nbsp;<span class="op" id="3569105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569109">return</span>&nbsp;<span class="string" id="3569116">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3569125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569128">s</span>&nbsp;<span class="op" id="3569130">:=</span>&nbsp;<span class="string" id="3569133">&#34;lookup&nbsp;&#34;</span>&nbsp;<span class="op" id="3569143">+</span>&nbsp;<span class="ident" id="3569145">e</span><span class="op" id="3569146">.</span><span class="ident" id="3569147">Name</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569153">if</span>&nbsp;<span class="ident" id="3569156">e</span><span class="op" id="3569157">.</span><span class="ident" id="3569158">Server</span>&nbsp;<span class="op" id="3569165">!=</span>&nbsp;<span class="string" id="3569168">&#34;&#34;</span>&nbsp;<span class="op" id="3569171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569175">s</span>&nbsp;<span class="op" id="3569177">+=</span>&nbsp;<span class="string" id="3569180">&#34;&nbsp;on&nbsp;&#34;</span>&nbsp;<span class="op" id="3569187">+</span>&nbsp;<span class="ident" id="3569189">e</span><span class="op" id="3569190">.</span><span class="ident" id="3569191">Server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3569199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569202">s</span>&nbsp;<span class="op" id="3569204">+=</span>&nbsp;<span class="string" id="3569207">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3569212">+</span>&nbsp;<span class="ident" id="3569214">e</span><span class="op" id="3569215">.</span><span class="ident" id="3569216">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569221">return</span>&nbsp;<span class="ident" id="3569228">s</span><br>
<span class="lineno">30</span><span class="op" id="3569230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3569233">func</span>&nbsp;<span class="op" id="3569238">(</span><span class="ident" id="3569239">e</span>&nbsp;<span class="op" id="3569241">*</span><span class="ident" id="3569242">DNSError</span><span class="op" id="3569250">)</span>&nbsp;<span class="ident" id="3569252">Timeout</span><span class="op" id="3569259">(</span><span class="op" id="3569260">)</span>&nbsp;<span class="builtintype" id="3569262">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3569269">{</span>&nbsp;<span class="keyword" id="3569271">return</span>&nbsp;<span class="ident" id="3569278">e</span><span class="op" id="3569279">.</span><span class="ident" id="3569280">IsTimeout</span>&nbsp;<span class="op" id="3569290">}</span><br>
<span class="lineno"></span><span class="keyword" id="3569292">func</span>&nbsp;<span class="op" id="3569297">(</span><span class="ident" id="3569298">e</span>&nbsp;<span class="op" id="3569300">*</span><span class="ident" id="3569301">DNSError</span><span class="op" id="3569309">)</span>&nbsp;<span class="ident" id="3569311">Temporary</span><span class="op" id="3569320">(</span><span class="op" id="3569321">)</span>&nbsp;<span class="builtintype" id="3569323">bool</span>&nbsp;<span class="op" id="3569328">{</span>&nbsp;<span class="keyword" id="3569330">return</span>&nbsp;<span class="ident" id="3569337">e</span><span class="op" id="3569338">.</span><span class="ident" id="3569339">IsTimeout</span>&nbsp;<span class="op" id="3569349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="3569352">const</span>&nbsp;<span class="ident" id="3569358">noSuchHost</span>&nbsp;<span class="op" id="3569369">=</span>&nbsp;<span class="string" id="3569371">&#34;no&nbsp;such&nbsp;host&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3569387">//&nbsp;reverseaddr&nbsp;returns&nbsp;the&nbsp;in-addr.arpa.&nbsp;or&nbsp;ip6.arpa.&nbsp;hostname&nbsp;of&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="3569460">//&nbsp;address&nbsp;addr&nbsp;suitable&nbsp;for&nbsp;rDNS&nbsp;(PTR)&nbsp;record&nbsp;lookup&nbsp;or&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;fails</span><br>
<span class="lineno"></span><span class="comment" id="3569538">//&nbsp;to&nbsp;parse&nbsp;the&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">40</span><span class="keyword" id="3569566">func</span>&nbsp;<span class="ident" id="3569571">reverseaddr</span><span class="op" id="3569582">(</span><span class="ident" id="3569583">addr</span>&nbsp;<span class="builtintype" id="3569588">string</span><span class="op" id="3569594">)</span>&nbsp;<span class="op" id="3569596">(</span><span class="ident" id="3569597">arpa</span>&nbsp;<span class="builtintype" id="3569602">string</span><span class="op" id="3569608">,</span>&nbsp;<span class="ident" id="3569610">err</span>&nbsp;<span class="builtintype" id="3569614">error</span><span class="op" id="3569619">)</span>&nbsp;<span class="op" id="3569621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569624">ip</span>&nbsp;<span class="op" id="3569627">:=</span>&nbsp;<span class="ident" id="3569630">ParseIP</span><span class="op" id="3569637">(</span><span class="ident" id="3569638">addr</span><span class="op" id="3569642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569645">if</span>&nbsp;<span class="ident" id="3569648">ip</span>&nbsp;<span class="op" id="3569651">==</span>&nbsp;<span class="ident" id="3569654">nil</span>&nbsp;<span class="op" id="3569658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569662">return</span>&nbsp;<span class="string" id="3569669">&#34;&#34;</span><span class="op" id="3569671">,</span>&nbsp;<span class="op" id="3569673">&amp;</span><span class="ident" id="3569674">DNSError</span><span class="op" id="3569682">{</span><span class="ident" id="3569683">Err</span><span class="op" id="3569686">:</span>&nbsp;<span class="string" id="3569688">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="3569710">,</span>&nbsp;<span class="ident" id="3569712">Name</span><span class="op" id="3569716">:</span>&nbsp;<span class="ident" id="3569718">addr</span><span class="op" id="3569722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3569725">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569728">if</span>&nbsp;<span class="ident" id="3569731">ip</span><span class="op" id="3569733">.</span><span class="ident" id="3569734">To4</span><span class="op" id="3569737">(</span><span class="op" id="3569738">)</span>&nbsp;<span class="op" id="3569740">!=</span>&nbsp;<span class="ident" id="3569743">nil</span>&nbsp;<span class="op" id="3569747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569751">return</span>&nbsp;<span class="ident" id="3569758">itoa</span><span class="op" id="3569762">(</span><span class="builtintype" id="3569763">int</span><span class="op" id="3569766">(</span><span class="ident" id="3569767">ip</span><span class="op" id="3569769">[</span><span class="num" id="3569770">15</span><span class="op" id="3569772">]</span><span class="op" id="3569773">)</span><span class="op" id="3569774">)</span>&nbsp;<span class="op" id="3569776">+</span>&nbsp;<span class="string" id="3569778">&#34;.&#34;</span>&nbsp;<span class="op" id="3569782">+</span>&nbsp;<span class="ident" id="3569784">itoa</span><span class="op" id="3569788">(</span><span class="builtintype" id="3569789">int</span><span class="op" id="3569792">(</span><span class="ident" id="3569793">ip</span><span class="op" id="3569795">[</span><span class="num" id="3569796">14</span><span class="op" id="3569798">]</span><span class="op" id="3569799">)</span><span class="op" id="3569800">)</span>&nbsp;<span class="op" id="3569802">+</span>&nbsp;<span class="string" id="3569804">&#34;.&#34;</span>&nbsp;<span class="op" id="3569808">+</span>&nbsp;<span class="ident" id="3569810">itoa</span><span class="op" id="3569814">(</span><span class="builtintype" id="3569815">int</span><span class="op" id="3569818">(</span><span class="ident" id="3569819">ip</span><span class="op" id="3569821">[</span><span class="num" id="3569822">13</span><span class="op" id="3569824">]</span><span class="op" id="3569825">)</span><span class="op" id="3569826">)</span>&nbsp;<span class="op" id="3569828">+</span>&nbsp;<span class="string" id="3569830">&#34;.&#34;</span>&nbsp;<span class="op" id="3569834">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569839">itoa</span><span class="op" id="3569843">(</span><span class="builtintype" id="3569844">int</span><span class="op" id="3569847">(</span><span class="ident" id="3569848">ip</span><span class="op" id="3569850">[</span><span class="num" id="3569851">12</span><span class="op" id="3569853">]</span><span class="op" id="3569854">)</span><span class="op" id="3569855">)</span>&nbsp;<span class="op" id="3569857">+</span>&nbsp;<span class="string" id="3569859">&#34;.in-addr.arpa.&#34;</span><span class="op" id="3569875">,</span>&nbsp;<span class="ident" id="3569877">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3569882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3569885">//&nbsp;Must&nbsp;be&nbsp;IPv6</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569902">buf</span>&nbsp;<span class="op" id="3569906">:=</span>&nbsp;<span class="builtinfunc" id="3569909">make</span><span class="op" id="3569913">(</span><span class="op" id="3569914">[</span><span class="op" id="3569915">]</span><span class="builtintype" id="3569916">byte</span><span class="op" id="3569920">,</span>&nbsp;<span class="num" id="3569922">0</span><span class="op" id="3569923">,</span>&nbsp;<span class="builtinfunc" id="3569925">len</span><span class="op" id="3569928">(</span><span class="ident" id="3569929">ip</span><span class="op" id="3569931">)</span><span class="op" id="3569932">*</span><span class="num" id="3569933">4</span><span class="op" id="3569934">+</span><span class="builtinfunc" id="3569935">len</span><span class="op" id="3569938">(</span><span class="string" id="3569939">&#34;ip6.arpa.&#34;</span><span class="op" id="3569950">)</span><span class="op" id="3569951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3569954">//&nbsp;Add&nbsp;it,&nbsp;in&nbsp;reverse,&nbsp;to&nbsp;the&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569992">for</span>&nbsp;<span class="ident" id="3569996">i</span>&nbsp;<span class="op" id="3569998">:=</span>&nbsp;<span class="builtinfunc" id="3570001">len</span><span class="op" id="3570004">(</span><span class="ident" id="3570005">ip</span><span class="op" id="3570007">)</span>&nbsp;<span class="op" id="3570009">-</span>&nbsp;<span class="num" id="3570011">1</span><span class="op" id="3570012">;</span>&nbsp;<span class="ident" id="3570014">i</span>&nbsp;<span class="op" id="3570016">&gt;=</span>&nbsp;<span class="num" id="3570019">0</span><span class="op" id="3570020">;</span>&nbsp;<span class="ident" id="3570022">i</span><span class="op" id="3570023">--</span>&nbsp;<span class="op" id="3570026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570030">v</span>&nbsp;<span class="op" id="3570032">:=</span>&nbsp;<span class="ident" id="3570035">ip</span><span class="op" id="3570037">[</span><span class="ident" id="3570038">i</span><span class="op" id="3570039">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570043">buf</span>&nbsp;<span class="op" id="3570047">=</span>&nbsp;<span class="builtinfunc" id="3570049">append</span><span class="op" id="3570055">(</span><span class="ident" id="3570056">buf</span><span class="op" id="3570059">,</span>&nbsp;<span class="ident" id="3570061">hexDigit</span><span class="op" id="3570069">[</span><span class="ident" id="3570070">v</span><span class="op" id="3570071">&amp;</span><span class="num" id="3570072">0xF</span><span class="op" id="3570075">]</span><span class="op" id="3570076">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570080">buf</span>&nbsp;<span class="op" id="3570084">=</span>&nbsp;<span class="builtinfunc" id="3570086">append</span><span class="op" id="3570092">(</span><span class="ident" id="3570093">buf</span><span class="op" id="3570096">,</span>&nbsp;<span class="string" id="3570098">&#39;.&#39;</span><span class="op" id="3570101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570105">buf</span>&nbsp;<span class="op" id="3570109">=</span>&nbsp;<span class="builtinfunc" id="3570111">append</span><span class="op" id="3570117">(</span><span class="ident" id="3570118">buf</span><span class="op" id="3570121">,</span>&nbsp;<span class="ident" id="3570123">hexDigit</span><span class="op" id="3570131">[</span><span class="ident" id="3570132">v</span><span class="op" id="3570133">&gt;&gt;</span><span class="num" id="3570135">4</span><span class="op" id="3570136">]</span><span class="op" id="3570137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570141">buf</span>&nbsp;<span class="op" id="3570145">=</span>&nbsp;<span class="builtinfunc" id="3570147">append</span><span class="op" id="3570153">(</span><span class="ident" id="3570154">buf</span><span class="op" id="3570157">,</span>&nbsp;<span class="string" id="3570159">&#39;.&#39;</span><span class="op" id="3570162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3570165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3570168">//&nbsp;Append&nbsp;&#34;ip6.arpa.&#34;&nbsp;and&nbsp;return&nbsp;(buf&nbsp;already&nbsp;has&nbsp;the&nbsp;final&nbsp;.)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570232">buf</span>&nbsp;<span class="op" id="3570236">=</span>&nbsp;<span class="builtinfunc" id="3570238">append</span><span class="op" id="3570244">(</span><span class="ident" id="3570245">buf</span><span class="op" id="3570248">,</span>&nbsp;<span class="string" id="3570250">&#34;ip6.arpa.&#34;</span><span class="op" id="3570261">...</span><span class="op" id="3570264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3570267">return</span>&nbsp;<span class="builtintype" id="3570274">string</span><span class="op" id="3570280">(</span><span class="ident" id="3570281">buf</span><span class="op" id="3570284">)</span><span class="op" id="3570285">,</span>&nbsp;<span class="ident" id="3570287">nil</span><br>
<span class="lineno"></span><span class="op" id="3570291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3570294">//&nbsp;Find&nbsp;answer&nbsp;for&nbsp;name&nbsp;in&nbsp;dns&nbsp;message.</span><br>
<span class="lineno">65</span><span class="comment" id="3570334">//&nbsp;On&nbsp;return,&nbsp;if&nbsp;err&nbsp;==&nbsp;nil,&nbsp;addrs&nbsp;!=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3570377">func</span>&nbsp;<span class="ident" id="3570382">answer</span><span class="op" id="3570388">(</span><span class="ident" id="3570389">name</span><span class="op" id="3570393">,</span>&nbsp;<span class="ident" id="3570395">server</span>&nbsp;<span class="builtintype" id="3570402">string</span><span class="op" id="3570408">,</span>&nbsp;<span class="ident" id="3570410">dns</span>&nbsp;<span class="op" id="3570414">*</span><span class="ident" id="3570415">dnsMsg</span><span class="op" id="3570421">,</span>&nbsp;<span class="ident" id="3570423">qtype</span>&nbsp;<span class="builtintype" id="3570429">uint16</span><span class="op" id="3570435">)</span>&nbsp;<span class="op" id="3570437">(</span><span class="ident" id="3570438">cname</span>&nbsp;<span class="builtintype" id="3570444">string</span><span class="op" id="3570450">,</span>&nbsp;<span class="ident" id="3570452">addrs</span>&nbsp;<span class="op" id="3570458">[</span><span class="op" id="3570459">]</span><span class="ident" id="3570460">dnsRR</span><span class="op" id="3570465">,</span>&nbsp;<span class="ident" id="3570467">err</span>&nbsp;<span class="builtintype" id="3570471">error</span><span class="op" id="3570476">)</span>&nbsp;<span class="op" id="3570478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570481">addrs</span>&nbsp;<span class="op" id="3570487">=</span>&nbsp;<span class="builtinfunc" id="3570489">make</span><span class="op" id="3570493">(</span><span class="op" id="3570494">[</span><span class="op" id="3570495">]</span><span class="ident" id="3570496">dnsRR</span><span class="op" id="3570501">,</span>&nbsp;<span class="num" id="3570503">0</span><span class="op" id="3570504">,</span>&nbsp;<span class="builtinfunc" id="3570506">len</span><span class="op" id="3570509">(</span><span class="ident" id="3570510">dns</span><span class="op" id="3570513">.</span><span class="ident" id="3570514">answer</span><span class="op" id="3570520">)</span><span class="op" id="3570521">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3570525">if</span>&nbsp;<span class="ident" id="3570528">dns</span><span class="op" id="3570531">.</span><span class="ident" id="3570532">rcode</span>&nbsp;<span class="op" id="3570538">==</span>&nbsp;<span class="ident" id="3570541">dnsRcodeNameError</span>&nbsp;<span class="op" id="3570559">&amp;&amp;</span>&nbsp;<span class="ident" id="3570562">dns</span><span class="op" id="3570565">.</span><span class="ident" id="3570566">recursion_available</span>&nbsp;<span class="op" id="3570586">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3570590">return</span>&nbsp;<span class="string" id="3570597">&#34;&#34;</span><span class="op" id="3570599">,</span>&nbsp;<span class="ident" id="3570601">nil</span><span class="op" id="3570604">,</span>&nbsp;<span class="op" id="3570606">&amp;</span><span class="ident" id="3570607">DNSError</span><span class="op" id="3570615">{</span><span class="ident" id="3570616">Err</span><span class="op" id="3570619">:</span>&nbsp;<span class="ident" id="3570621">noSuchHost</span><span class="op" id="3570631">,</span>&nbsp;<span class="ident" id="3570633">Name</span><span class="op" id="3570637">:</span>&nbsp;<span class="ident" id="3570639">name</span><span class="op" id="3570643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3570646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3570649">if</span>&nbsp;<span class="ident" id="3570652">dns</span><span class="op" id="3570655">.</span><span class="ident" id="3570656">rcode</span>&nbsp;<span class="op" id="3570662">!=</span>&nbsp;<span class="ident" id="3570665">dnsRcodeSuccess</span>&nbsp;<span class="op" id="3570681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3570685">//&nbsp;None&nbsp;of&nbsp;the&nbsp;error&nbsp;codes&nbsp;make&nbsp;sense</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3570725">//&nbsp;for&nbsp;the&nbsp;query&nbsp;we&nbsp;sent.&nbsp;&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;get</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3570771">//&nbsp;a&nbsp;name&nbsp;error&nbsp;and&nbsp;we&nbsp;didn&#39;t&nbsp;get&nbsp;success,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3570816">//&nbsp;the&nbsp;server&nbsp;is&nbsp;behaving&nbsp;incorrectly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3570857">return</span>&nbsp;<span class="string" id="3570864">&#34;&#34;</span><span class="op" id="3570866">,</span>&nbsp;<span class="ident" id="3570868">nil</span><span class="op" id="3570871">,</span>&nbsp;<span class="op" id="3570873">&amp;</span><span class="ident" id="3570874">DNSError</span><span class="op" id="3570882">{</span><span class="ident" id="3570883">Err</span><span class="op" id="3570886">:</span>&nbsp;<span class="string" id="3570888">&#34;server&nbsp;misbehaving&#34;</span><span class="op" id="3570908">,</span>&nbsp;<span class="ident" id="3570910">Name</span><span class="op" id="3570914">:</span>&nbsp;<span class="ident" id="3570916">name</span><span class="op" id="3570920">,</span>&nbsp;<span class="ident" id="3570922">Server</span><span class="op" id="3570928">:</span>&nbsp;<span class="ident" id="3570930">server</span><span class="op" id="3570936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3570939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3570943">//&nbsp;Look&nbsp;for&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3570966">//&nbsp;Presotto&nbsp;says&nbsp;it&#39;s&nbsp;okay&nbsp;to&nbsp;assume&nbsp;that&nbsp;servers&nbsp;listed&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3571027">//&nbsp;/etc/resolv.conf&nbsp;are&nbsp;recursive&nbsp;resolvers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3571073">//&nbsp;We&nbsp;asked&nbsp;for&nbsp;recursion,&nbsp;so&nbsp;it&nbsp;should&nbsp;have&nbsp;included</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3571128">//&nbsp;all&nbsp;the&nbsp;answers&nbsp;we&nbsp;need&nbsp;in&nbsp;this&nbsp;one&nbsp;packet.</span><br>
<span class="lineno">85</span><span class="ident" id="3571175">Cname</span><span class="op" id="3571180">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571183">for</span>&nbsp;<span class="ident" id="3571187">cnameloop</span>&nbsp;<span class="op" id="3571197">:=</span>&nbsp;<span class="num" id="3571200">0</span><span class="op" id="3571201">;</span>&nbsp;<span class="ident" id="3571203">cnameloop</span>&nbsp;<span class="op" id="3571213">&lt;</span>&nbsp;<span class="num" id="3571215">10</span><span class="op" id="3571217">;</span>&nbsp;<span class="ident" id="3571219">cnameloop</span><span class="op" id="3571228">++</span>&nbsp;<span class="op" id="3571231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3571235">addrs</span>&nbsp;<span class="op" id="3571241">=</span>&nbsp;<span class="ident" id="3571243">addrs</span><span class="op" id="3571248">[</span><span class="num" id="3571249">0</span><span class="op" id="3571250">:</span><span class="num" id="3571251">0</span><span class="op" id="3571252">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571256">for</span>&nbsp;<span class="ident" id="3571260">_</span><span class="op" id="3571261">,</span>&nbsp;<span class="ident" id="3571263">rr</span>&nbsp;<span class="op" id="3571266">:=</span>&nbsp;<span class="keyword" id="3571269">range</span>&nbsp;<span class="ident" id="3571275">dns</span><span class="op" id="3571278">.</span><span class="ident" id="3571279">answer</span>&nbsp;<span class="op" id="3571286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571291">if</span>&nbsp;<span class="ident" id="3571294">_</span><span class="op" id="3571295">,</span>&nbsp;<span class="ident" id="3571297">justHeader</span>&nbsp;<span class="op" id="3571308">:=</span>&nbsp;<span class="ident" id="3571311">rr</span><span class="op" id="3571313">.</span><span class="op" id="3571314">(</span><span class="op" id="3571315">*</span><span class="ident" id="3571316">dnsRR_Header</span><span class="op" id="3571328">)</span><span class="op" id="3571329">;</span>&nbsp;<span class="ident" id="3571331">justHeader</span>&nbsp;<span class="op" id="3571342">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3571348">//&nbsp;Corrupt&nbsp;record:&nbsp;we&nbsp;only&nbsp;have&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3571386">//&nbsp;header.&nbsp;That&nbsp;header&nbsp;might&nbsp;say&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3571428">//&nbsp;of&nbsp;type&nbsp;qtype,&nbsp;but&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3571463">//&nbsp;actually&nbsp;have&nbsp;it.&nbsp;Skip.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571494">continue</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3571506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3571511">h</span>&nbsp;<span class="op" id="3571513">:=</span>&nbsp;<span class="ident" id="3571516">rr</span><span class="op" id="3571518">.</span><span class="ident" id="3571519">Header</span><span class="op" id="3571525">(</span><span class="op" id="3571526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571531">if</span>&nbsp;<span class="ident" id="3571534">h</span><span class="op" id="3571535">.</span><span class="ident" id="3571536">Class</span>&nbsp;<span class="op" id="3571542">==</span>&nbsp;<span class="ident" id="3571545">dnsClassINET</span>&nbsp;<span class="op" id="3571558">&amp;&amp;</span>&nbsp;<span class="ident" id="3571561">h</span><span class="op" id="3571562">.</span><span class="ident" id="3571563">Name</span>&nbsp;<span class="op" id="3571568">==</span>&nbsp;<span class="ident" id="3571571">name</span>&nbsp;<span class="op" id="3571576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571582">switch</span>&nbsp;<span class="ident" id="3571589">h</span><span class="op" id="3571590">.</span><span class="ident" id="3571591">Rrtype</span>&nbsp;<span class="op" id="3571598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571604">case</span>&nbsp;<span class="ident" id="3571609">qtype</span><span class="op" id="3571614">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3571621">addrs</span>&nbsp;<span class="op" id="3571627">=</span>&nbsp;<span class="builtinfunc" id="3571629">append</span><span class="op" id="3571635">(</span><span class="ident" id="3571636">addrs</span><span class="op" id="3571641">,</span>&nbsp;<span class="ident" id="3571643">rr</span><span class="op" id="3571645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571651">case</span>&nbsp;<span class="ident" id="3571656">dnsTypeCNAME</span><span class="op" id="3571668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3571675">//&nbsp;redirect&nbsp;to&nbsp;cname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3571701">name</span>&nbsp;<span class="op" id="3571706">=</span>&nbsp;<span class="ident" id="3571708">rr</span><span class="op" id="3571710">.</span><span class="op" id="3571711">(</span><span class="op" id="3571712">*</span><span class="ident" id="3571713">dnsRR_CNAME</span><span class="op" id="3571724">)</span><span class="op" id="3571725">.</span><span class="ident" id="3571726">Cname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571737">continue</span>&nbsp;<span class="ident" id="3571746">Cname</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3571756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3571761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3571765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571769">if</span>&nbsp;<span class="builtinfunc" id="3571772">len</span><span class="op" id="3571775">(</span><span class="ident" id="3571776">addrs</span><span class="op" id="3571781">)</span>&nbsp;<span class="op" id="3571783">==</span>&nbsp;<span class="num" id="3571786">0</span>&nbsp;<span class="op" id="3571788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571793">return</span>&nbsp;<span class="string" id="3571800">&#34;&#34;</span><span class="op" id="3571802">,</span>&nbsp;<span class="ident" id="3571804">nil</span><span class="op" id="3571807">,</span>&nbsp;<span class="op" id="3571809">&amp;</span><span class="ident" id="3571810">DNSError</span><span class="op" id="3571818">{</span><span class="ident" id="3571819">Err</span><span class="op" id="3571822">:</span>&nbsp;<span class="ident" id="3571824">noSuchHost</span><span class="op" id="3571834">,</span>&nbsp;<span class="ident" id="3571836">Name</span><span class="op" id="3571840">:</span>&nbsp;<span class="ident" id="3571842">name</span><span class="op" id="3571846">,</span>&nbsp;<span class="ident" id="3571848">Server</span><span class="op" id="3571854">:</span>&nbsp;<span class="ident" id="3571856">server</span><span class="op" id="3571862">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3571866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571870">return</span>&nbsp;<span class="ident" id="3571877">name</span><span class="op" id="3571881">,</span>&nbsp;<span class="ident" id="3571883">addrs</span><span class="op" id="3571888">,</span>&nbsp;<span class="ident" id="3571890">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3571895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571899">return</span>&nbsp;<span class="string" id="3571906">&#34;&#34;</span><span class="op" id="3571908">,</span>&nbsp;<span class="ident" id="3571910">nil</span><span class="op" id="3571913">,</span>&nbsp;<span class="op" id="3571915">&amp;</span><span class="ident" id="3571916">DNSError</span><span class="op" id="3571924">{</span><span class="ident" id="3571925">Err</span><span class="op" id="3571928">:</span>&nbsp;<span class="string" id="3571930">&#34;too&nbsp;many&nbsp;redirects&#34;</span><span class="op" id="3571950">,</span>&nbsp;<span class="ident" id="3571952">Name</span><span class="op" id="3571956">:</span>&nbsp;<span class="ident" id="3571958">name</span><span class="op" id="3571962">,</span>&nbsp;<span class="ident" id="3571964">Server</span><span class="op" id="3571970">:</span>&nbsp;<span class="ident" id="3571972">server</span><span class="op" id="3571978">}</span><br>
<span class="lineno">115</span><span class="op" id="3571980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3571983">func</span>&nbsp;<span class="ident" id="3571988">isDomainName</span><span class="op" id="3572000">(</span><span class="ident" id="3572001">s</span>&nbsp;<span class="builtintype" id="3572003">string</span><span class="op" id="3572009">)</span>&nbsp;<span class="builtintype" id="3572011">bool</span>&nbsp;<span class="op" id="3572016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572019">//&nbsp;See&nbsp;RFC&nbsp;1035,&nbsp;RFC&nbsp;3696.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572047">if</span>&nbsp;<span class="builtinfunc" id="3572050">len</span><span class="op" id="3572053">(</span><span class="ident" id="3572054">s</span><span class="op" id="3572055">)</span>&nbsp;<span class="op" id="3572057">==</span>&nbsp;<span class="num" id="3572060">0</span>&nbsp;<span class="op" id="3572062">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572066">return</span>&nbsp;<span class="builtintype" id="3572073">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3572080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572083">if</span>&nbsp;<span class="builtinfunc" id="3572086">len</span><span class="op" id="3572089">(</span><span class="ident" id="3572090">s</span><span class="op" id="3572091">)</span>&nbsp;<span class="op" id="3572093">&gt;</span>&nbsp;<span class="num" id="3572095">255</span>&nbsp;<span class="op" id="3572099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572103">return</span>&nbsp;<span class="builtintype" id="3572110">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3572117">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572121">last</span>&nbsp;<span class="op" id="3572126">:=</span>&nbsp;<span class="builtintype" id="3572129">byte</span><span class="op" id="3572133">(</span><span class="string" id="3572134">&#39;.&#39;</span><span class="op" id="3572137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572140">ok</span>&nbsp;<span class="op" id="3572143">:=</span>&nbsp;<span class="builtintype" id="3572146">false</span>&nbsp;<span class="comment" id="3572152">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572185">partlen</span>&nbsp;<span class="op" id="3572193">:=</span>&nbsp;<span class="num" id="3572196">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572199">for</span>&nbsp;<span class="ident" id="3572203">i</span>&nbsp;<span class="op" id="3572205">:=</span>&nbsp;<span class="num" id="3572208">0</span><span class="op" id="3572209">;</span>&nbsp;<span class="ident" id="3572211">i</span>&nbsp;<span class="op" id="3572213">&lt;</span>&nbsp;<span class="builtinfunc" id="3572215">len</span><span class="op" id="3572218">(</span><span class="ident" id="3572219">s</span><span class="op" id="3572220">)</span><span class="op" id="3572221">;</span>&nbsp;<span class="ident" id="3572223">i</span><span class="op" id="3572224">++</span>&nbsp;<span class="op" id="3572227">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572231">c</span>&nbsp;<span class="op" id="3572233">:=</span>&nbsp;<span class="ident" id="3572236">s</span><span class="op" id="3572237">[</span><span class="ident" id="3572238">i</span><span class="op" id="3572239">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572243">switch</span>&nbsp;<span class="op" id="3572250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572254">default</span><span class="op" id="3572261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572266">return</span>&nbsp;<span class="builtintype" id="3572273">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572281">case</span>&nbsp;<span class="string" id="3572286">&#39;a&#39;</span>&nbsp;<span class="op" id="3572290">&lt;=</span>&nbsp;<span class="ident" id="3572293">c</span>&nbsp;<span class="op" id="3572295">&amp;&amp;</span>&nbsp;<span class="ident" id="3572298">c</span>&nbsp;<span class="op" id="3572300">&lt;=</span>&nbsp;<span class="string" id="3572303">&#39;z&#39;</span>&nbsp;<span class="op" id="3572307">||</span>&nbsp;<span class="string" id="3572310">&#39;A&#39;</span>&nbsp;<span class="op" id="3572314">&lt;=</span>&nbsp;<span class="ident" id="3572317">c</span>&nbsp;<span class="op" id="3572319">&amp;&amp;</span>&nbsp;<span class="ident" id="3572322">c</span>&nbsp;<span class="op" id="3572324">&lt;=</span>&nbsp;<span class="string" id="3572327">&#39;Z&#39;</span>&nbsp;<span class="op" id="3572331">||</span>&nbsp;<span class="ident" id="3572334">c</span>&nbsp;<span class="op" id="3572336">==</span>&nbsp;<span class="string" id="3572339">&#39;_&#39;</span><span class="op" id="3572342">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572347">ok</span>&nbsp;<span class="op" id="3572350">=</span>&nbsp;<span class="builtintype" id="3572352">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572360">partlen</span><span class="op" id="3572367">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572372">case</span>&nbsp;<span class="string" id="3572377">&#39;0&#39;</span>&nbsp;<span class="op" id="3572381">&lt;=</span>&nbsp;<span class="ident" id="3572384">c</span>&nbsp;<span class="op" id="3572386">&amp;&amp;</span>&nbsp;<span class="ident" id="3572389">c</span>&nbsp;<span class="op" id="3572391">&lt;=</span>&nbsp;<span class="string" id="3572394">&#39;9&#39;</span><span class="op" id="3572397">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572402">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572413">partlen</span><span class="op" id="3572420">++</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572425">case</span>&nbsp;<span class="ident" id="3572430">c</span>&nbsp;<span class="op" id="3572432">==</span>&nbsp;<span class="string" id="3572435">&#39;-&#39;</span><span class="op" id="3572438">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572443">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572481">if</span>&nbsp;<span class="ident" id="3572484">last</span>&nbsp;<span class="op" id="3572489">==</span>&nbsp;<span class="string" id="3572492">&#39;.&#39;</span>&nbsp;<span class="op" id="3572496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572502">return</span>&nbsp;<span class="builtintype" id="3572509">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3572518">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572523">partlen</span><span class="op" id="3572530">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572535">case</span>&nbsp;<span class="ident" id="3572540">c</span>&nbsp;<span class="op" id="3572542">==</span>&nbsp;<span class="string" id="3572545">&#39;.&#39;</span><span class="op" id="3572548">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572553">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572596">if</span>&nbsp;<span class="ident" id="3572599">last</span>&nbsp;<span class="op" id="3572604">==</span>&nbsp;<span class="string" id="3572607">&#39;.&#39;</span>&nbsp;<span class="op" id="3572611">||</span>&nbsp;<span class="ident" id="3572614">last</span>&nbsp;<span class="op" id="3572619">==</span>&nbsp;<span class="string" id="3572622">&#39;-&#39;</span>&nbsp;<span class="op" id="3572626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572632">return</span>&nbsp;<span class="builtintype" id="3572639">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3572648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572653">if</span>&nbsp;<span class="ident" id="3572656">partlen</span>&nbsp;<span class="op" id="3572664">&gt;</span>&nbsp;<span class="num" id="3572666">63</span>&nbsp;<span class="op" id="3572669">||</span>&nbsp;<span class="ident" id="3572672">partlen</span>&nbsp;<span class="op" id="3572680">==</span>&nbsp;<span class="num" id="3572683">0</span>&nbsp;<span class="op" id="3572685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572691">return</span>&nbsp;<span class="builtintype" id="3572698">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3572707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572712">partlen</span>&nbsp;<span class="op" id="3572720">=</span>&nbsp;<span class="num" id="3572722">0</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3572726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572730">last</span>&nbsp;<span class="op" id="3572735">=</span>&nbsp;<span class="ident" id="3572737">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3572740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572743">if</span>&nbsp;<span class="ident" id="3572746">last</span>&nbsp;<span class="op" id="3572751">==</span>&nbsp;<span class="string" id="3572754">&#39;-&#39;</span>&nbsp;<span class="op" id="3572758">||</span>&nbsp;<span class="ident" id="3572761">partlen</span>&nbsp;<span class="op" id="3572769">&gt;</span>&nbsp;<span class="num" id="3572771">63</span>&nbsp;<span class="op" id="3572774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572778">return</span>&nbsp;<span class="builtintype" id="3572785">false</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3572792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3572796">return</span>&nbsp;<span class="ident" id="3572803">ok</span><br>
<span class="lineno"></span><span class="op" id="3572806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3572809">//&nbsp;An&nbsp;SRV&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;SRV&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="3572855">type</span>&nbsp;<span class="ident" id="3572860">SRV</span>&nbsp;<span class="keyword" id="3572864">struct</span>&nbsp;<span class="op" id="3572871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572874">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3572883">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572891">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3572900">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572908">Priority</span>&nbsp;<span class="builtintype" id="3572917">uint16</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572925">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3572934">uint16</span><br>
<span class="lineno"></span><span class="op" id="3572941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3572944">//&nbsp;byPriorityWeight&nbsp;sorts&nbsp;SRV&nbsp;records&nbsp;by&nbsp;ascending&nbsp;priority&nbsp;and&nbsp;weight.</span><br>
<span class="lineno"></span><span class="keyword" id="3573016">type</span>&nbsp;<span class="ident" id="3573021">byPriorityWeight</span>&nbsp;<span class="op" id="3573038">[</span><span class="op" id="3573039">]</span><span class="op" id="3573040">*</span><span class="ident" id="3573041">SRV</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3573046">func</span>&nbsp;<span class="op" id="3573051">(</span><span class="ident" id="3573052">s</span>&nbsp;<span class="ident" id="3573054">byPriorityWeight</span><span class="op" id="3573070">)</span>&nbsp;<span class="ident" id="3573072">Len</span><span class="op" id="3573075">(</span><span class="op" id="3573076">)</span>&nbsp;<span class="builtintype" id="3573078">int</span>&nbsp;<span class="op" id="3573082">{</span>&nbsp;<span class="keyword" id="3573084">return</span>&nbsp;<span class="builtinfunc" id="3573091">len</span><span class="op" id="3573094">(</span><span class="ident" id="3573095">s</span><span class="op" id="3573096">)</span>&nbsp;<span class="op" id="3573098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3573101">func</span>&nbsp;<span class="op" id="3573106">(</span><span class="ident" id="3573107">s</span>&nbsp;<span class="ident" id="3573109">byPriorityWeight</span><span class="op" id="3573125">)</span>&nbsp;<span class="ident" id="3573127">Swap</span><span class="op" id="3573131">(</span><span class="ident" id="3573132">i</span><span class="op" id="3573133">,</span>&nbsp;<span class="ident" id="3573135">j</span>&nbsp;<span class="builtintype" id="3573137">int</span><span class="op" id="3573140">)</span>&nbsp;<span class="op" id="3573142">{</span>&nbsp;<span class="ident" id="3573144">s</span><span class="op" id="3573145">[</span><span class="ident" id="3573146">i</span><span class="op" id="3573147">]</span><span class="op" id="3573148">,</span>&nbsp;<span class="ident" id="3573150">s</span><span class="op" id="3573151">[</span><span class="ident" id="3573152">j</span><span class="op" id="3573153">]</span>&nbsp;<span class="op" id="3573155">=</span>&nbsp;<span class="ident" id="3573157">s</span><span class="op" id="3573158">[</span><span class="ident" id="3573159">j</span><span class="op" id="3573160">]</span><span class="op" id="3573161">,</span>&nbsp;<span class="ident" id="3573163">s</span><span class="op" id="3573164">[</span><span class="ident" id="3573165">i</span><span class="op" id="3573166">]</span>&nbsp;<span class="op" id="3573168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3573171">func</span>&nbsp;<span class="op" id="3573176">(</span><span class="ident" id="3573177">s</span>&nbsp;<span class="ident" id="3573179">byPriorityWeight</span><span class="op" id="3573195">)</span>&nbsp;<span class="ident" id="3573197">Less</span><span class="op" id="3573201">(</span><span class="ident" id="3573202">i</span><span class="op" id="3573203">,</span>&nbsp;<span class="ident" id="3573205">j</span>&nbsp;<span class="builtintype" id="3573207">int</span><span class="op" id="3573210">)</span>&nbsp;<span class="builtintype" id="3573212">bool</span>&nbsp;<span class="op" id="3573217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3573220">return</span>&nbsp;<span class="ident" id="3573227">s</span><span class="op" id="3573228">[</span><span class="ident" id="3573229">i</span><span class="op" id="3573230">]</span><span class="op" id="3573231">.</span><span class="ident" id="3573232">Priority</span>&nbsp;<span class="op" id="3573241">&lt;</span>&nbsp;<span class="ident" id="3573243">s</span><span class="op" id="3573244">[</span><span class="ident" id="3573245">j</span><span class="op" id="3573246">]</span><span class="op" id="3573247">.</span><span class="ident" id="3573248">Priority</span>&nbsp;<span class="op" id="3573257">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3573262">(</span><span class="ident" id="3573263">s</span><span class="op" id="3573264">[</span><span class="ident" id="3573265">i</span><span class="op" id="3573266">]</span><span class="op" id="3573267">.</span><span class="ident" id="3573268">Priority</span>&nbsp;<span class="op" id="3573277">==</span>&nbsp;<span class="ident" id="3573280">s</span><span class="op" id="3573281">[</span><span class="ident" id="3573282">j</span><span class="op" id="3573283">]</span><span class="op" id="3573284">.</span><span class="ident" id="3573285">Priority</span>&nbsp;<span class="op" id="3573294">&amp;&amp;</span>&nbsp;<span class="ident" id="3573297">s</span><span class="op" id="3573298">[</span><span class="ident" id="3573299">i</span><span class="op" id="3573300">]</span><span class="op" id="3573301">.</span><span class="ident" id="3573302">Weight</span>&nbsp;<span class="op" id="3573309">&lt;</span>&nbsp;<span class="ident" id="3573311">s</span><span class="op" id="3573312">[</span><span class="ident" id="3573313">j</span><span class="op" id="3573314">]</span><span class="op" id="3573315">.</span><span class="ident" id="3573316">Weight</span><span class="op" id="3573322">)</span><br>
<span class="lineno"></span><span class="op" id="3573324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="comment" id="3573327">//&nbsp;shuffleByWeight&nbsp;shuffles&nbsp;SRV&nbsp;records&nbsp;by&nbsp;weight&nbsp;using&nbsp;the&nbsp;algorithm</span><br>
<span class="lineno"></span><span class="comment" id="3573397">//&nbsp;described&nbsp;in&nbsp;RFC&nbsp;2782.</span><br>
<span class="lineno"></span><span class="keyword" id="3573423">func</span>&nbsp;<span class="op" id="3573428">(</span><span class="ident" id="3573429">addrs</span>&nbsp;<span class="ident" id="3573435">byPriorityWeight</span><span class="op" id="3573451">)</span>&nbsp;<span class="ident" id="3573453">shuffleByWeight</span><span class="op" id="3573468">(</span><span class="op" id="3573469">)</span>&nbsp;<span class="op" id="3573471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3573474">sum</span>&nbsp;<span class="op" id="3573478">:=</span>&nbsp;<span class="num" id="3573481">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3573484">for</span>&nbsp;<span class="ident" id="3573488">_</span><span class="op" id="3573489">,</span>&nbsp;<span class="ident" id="3573491">addr</span>&nbsp;<span class="op" id="3573496">:=</span>&nbsp;<span class="keyword" id="3573499">range</span>&nbsp;<span class="ident" id="3573505">addrs</span>&nbsp;<span class="op" id="3573511">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3573515">sum</span>&nbsp;<span class="op" id="3573519">+=</span>&nbsp;<span class="builtintype" id="3573522">int</span><span class="op" id="3573525">(</span><span class="ident" id="3573526">addr</span><span class="op" id="3573530">.</span><span class="ident" id="3573531">Weight</span><span class="op" id="3573537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3573540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3573543">for</span>&nbsp;<span class="ident" id="3573547">sum</span>&nbsp;<span class="op" id="3573551">&gt;</span>&nbsp;<span class="num" id="3573553">0</span>&nbsp;<span class="op" id="3573555">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3573558">len</span><span class="op" id="3573561">(</span><span class="ident" id="3573562">addrs</span><span class="op" id="3573567">)</span>&nbsp;<span class="op" id="3573569">&gt;</span>&nbsp;<span class="num" id="3573571">1</span>&nbsp;<span class="op" id="3573573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3573577">s</span>&nbsp;<span class="op" id="3573579">:=</span>&nbsp;<span class="num" id="3573582">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3573586">n</span>&nbsp;<span class="op" id="3573588">:=</span>&nbsp;<span class="ident" id="3573591">rand</span><span class="op" id="3573595">.</span><span class="ident" id="3573596">Intn</span><span class="op" id="3573600">(</span><span class="ident" id="3573601">sum</span><span class="op" id="3573604">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3573608">for</span>&nbsp;<span class="ident" id="3573612">i</span>&nbsp;<span class="op" id="3573614">:=</span>&nbsp;<span class="keyword" id="3573617">range</span>&nbsp;<span class="ident" id="3573623">addrs</span>&nbsp;<span class="op" id="3573629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3573634">s</span>&nbsp;<span class="op" id="3573636">+=</span>&nbsp;<span class="builtintype" id="3573639">int</span><span class="op" id="3573642">(</span><span class="ident" id="3573643">addrs</span><span class="op" id="3573648">[</span><span class="ident" id="3573649">i</span><span class="op" id="3573650">]</span><span class="op" id="3573651">.</span><span class="ident" id="3573652">Weight</span><span class="op" id="3573658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3573663">if</span>&nbsp;<span class="ident" id="3573666">s</span>&nbsp;<span class="op" id="3573668">&gt;</span>&nbsp;<span class="ident" id="3573670">n</span>&nbsp;<span class="op" id="3573672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3573678">if</span>&nbsp;<span class="ident" id="3573681">i</span>&nbsp;<span class="op" id="3573683">&gt;</span>&nbsp;<span class="num" id="3573685">0</span>&nbsp;<span class="op" id="3573687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3573694">addrs</span><span class="op" id="3573699">[</span><span class="num" id="3573700">0</span><span class="op" id="3573701">]</span><span class="op" id="3573702">,</span>&nbsp;<span class="ident" id="3573704">addrs</span><span class="op" id="3573709">[</span><span class="ident" id="3573710">i</span><span class="op" id="3573711">]</span>&nbsp;<span class="op" id="3573713">=</span>&nbsp;<span class="ident" id="3573715">addrs</span><span class="op" id="3573720">[</span><span class="ident" id="3573721">i</span><span class="op" id="3573722">]</span><span class="op" id="3573723">,</span>&nbsp;<span class="ident" id="3573725">addrs</span><span class="op" id="3573730">[</span><span class="num" id="3573731">0</span><span class="op" id="3573732">]</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3573738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3573744">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3573753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3573757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3573761">sum</span>&nbsp;<span class="op" id="3573765">-=</span>&nbsp;<span class="builtintype" id="3573768">int</span><span class="op" id="3573771">(</span><span class="ident" id="3573772">addrs</span><span class="op" id="3573777">[</span><span class="num" id="3573778">0</span><span class="op" id="3573779">]</span><span class="op" id="3573780">.</span><span class="ident" id="3573781">Weight</span><span class="op" id="3573787">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3573791">addrs</span>&nbsp;<span class="op" id="3573797">=</span>&nbsp;<span class="ident" id="3573799">addrs</span><span class="op" id="3573804">[</span><span class="num" id="3573805">1</span><span class="op" id="3573806">:</span><span class="op" id="3573807">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3573810">}</span><br>
<span class="lineno"></span><span class="op" id="3573812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3573815">//&nbsp;sort&nbsp;reorders&nbsp;SRV&nbsp;records&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;2782.</span><br>
<span class="lineno">210</span><span class="keyword" id="3573870">func</span>&nbsp;<span class="op" id="3573875">(</span><span class="ident" id="3573876">addrs</span>&nbsp;<span class="ident" id="3573882">byPriorityWeight</span><span class="op" id="3573898">)</span>&nbsp;<span class="ident" id="3573900">sort</span><span class="op" id="3573904">(</span><span class="op" id="3573905">)</span>&nbsp;<span class="op" id="3573907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3573910">sort</span><span class="op" id="3573914">.</span><span class="ident" id="3573915">Sort</span><span class="op" id="3573919">(</span><span class="ident" id="3573920">addrs</span><span class="op" id="3573925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3573928">i</span>&nbsp;<span class="op" id="3573930">:=</span>&nbsp;<span class="num" id="3573933">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3573936">for</span>&nbsp;<span class="ident" id="3573940">j</span>&nbsp;<span class="op" id="3573942">:=</span>&nbsp;<span class="num" id="3573945">1</span><span class="op" id="3573946">;</span>&nbsp;<span class="ident" id="3573948">j</span>&nbsp;<span class="op" id="3573950">&lt;</span>&nbsp;<span class="builtinfunc" id="3573952">len</span><span class="op" id="3573955">(</span><span class="ident" id="3573956">addrs</span><span class="op" id="3573961">)</span><span class="op" id="3573962">;</span>&nbsp;<span class="ident" id="3573964">j</span><span class="op" id="3573965">++</span>&nbsp;<span class="op" id="3573968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3573972">if</span>&nbsp;<span class="ident" id="3573975">addrs</span><span class="op" id="3573980">[</span><span class="ident" id="3573981">i</span><span class="op" id="3573982">]</span><span class="op" id="3573983">.</span><span class="ident" id="3573984">Priority</span>&nbsp;<span class="op" id="3573993">!=</span>&nbsp;<span class="ident" id="3573996">addrs</span><span class="op" id="3574001">[</span><span class="ident" id="3574002">j</span><span class="op" id="3574003">]</span><span class="op" id="3574004">.</span><span class="ident" id="3574005">Priority</span>&nbsp;<span class="op" id="3574014">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3574019">addrs</span><span class="op" id="3574024">[</span><span class="ident" id="3574025">i</span><span class="op" id="3574026">:</span><span class="ident" id="3574027">j</span><span class="op" id="3574028">]</span><span class="op" id="3574029">.</span><span class="ident" id="3574030">shuffleByWeight</span><span class="op" id="3574045">(</span><span class="op" id="3574046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3574051">i</span>&nbsp;<span class="op" id="3574053">=</span>&nbsp;<span class="ident" id="3574055">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3574059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3574062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3574065">addrs</span><span class="op" id="3574070">[</span><span class="ident" id="3574071">i</span><span class="op" id="3574072">:</span><span class="op" id="3574073">]</span><span class="op" id="3574074">.</span><span class="ident" id="3574075">shuffleByWeight</span><span class="op" id="3574090">(</span><span class="op" id="3574091">)</span><br>
<span class="lineno">220</span><span class="op" id="3574093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3574096">//&nbsp;An&nbsp;MX&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;MX&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="3574140">type</span>&nbsp;<span class="ident" id="3574145">MX</span>&nbsp;<span class="keyword" id="3574148">struct</span>&nbsp;<span class="op" id="3574155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3574158">Host</span>&nbsp;<span class="builtintype" id="3574163">string</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3574171">Pref</span>&nbsp;<span class="builtintype" id="3574176">uint16</span><br>
<span class="lineno"></span><span class="op" id="3574183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3574186">//&nbsp;byPref&nbsp;implements&nbsp;sort.Interface&nbsp;to&nbsp;sort&nbsp;MX&nbsp;records&nbsp;by&nbsp;preference</span><br>
<span class="lineno"></span><span class="keyword" id="3574255">type</span>&nbsp;<span class="ident" id="3574260">byPref</span>&nbsp;<span class="op" id="3574267">[</span><span class="op" id="3574268">]</span><span class="op" id="3574269">*</span><span class="ident" id="3574270">MX</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3574274">func</span>&nbsp;<span class="op" id="3574279">(</span><span class="ident" id="3574280">s</span>&nbsp;<span class="ident" id="3574282">byPref</span><span class="op" id="3574288">)</span>&nbsp;<span class="ident" id="3574290">Len</span><span class="op" id="3574293">(</span><span class="op" id="3574294">)</span>&nbsp;<span class="builtintype" id="3574296">int</span>&nbsp;<span class="op" id="3574300">{</span>&nbsp;<span class="keyword" id="3574302">return</span>&nbsp;<span class="builtinfunc" id="3574309">len</span><span class="op" id="3574312">(</span><span class="ident" id="3574313">s</span><span class="op" id="3574314">)</span>&nbsp;<span class="op" id="3574316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3574319">func</span>&nbsp;<span class="op" id="3574324">(</span><span class="ident" id="3574325">s</span>&nbsp;<span class="ident" id="3574327">byPref</span><span class="op" id="3574333">)</span>&nbsp;<span class="ident" id="3574335">Less</span><span class="op" id="3574339">(</span><span class="ident" id="3574340">i</span><span class="op" id="3574341">,</span>&nbsp;<span class="ident" id="3574343">j</span>&nbsp;<span class="builtintype" id="3574345">int</span><span class="op" id="3574348">)</span>&nbsp;<span class="builtintype" id="3574350">bool</span>&nbsp;<span class="op" id="3574355">{</span>&nbsp;<span class="keyword" id="3574357">return</span>&nbsp;<span class="ident" id="3574364">s</span><span class="op" id="3574365">[</span><span class="ident" id="3574366">i</span><span class="op" id="3574367">]</span><span class="op" id="3574368">.</span><span class="ident" id="3574369">Pref</span>&nbsp;<span class="op" id="3574374">&lt;</span>&nbsp;<span class="ident" id="3574376">s</span><span class="op" id="3574377">[</span><span class="ident" id="3574378">j</span><span class="op" id="3574379">]</span><span class="op" id="3574380">.</span><span class="ident" id="3574381">Pref</span>&nbsp;<span class="op" id="3574386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="3574389">func</span>&nbsp;<span class="op" id="3574394">(</span><span class="ident" id="3574395">s</span>&nbsp;<span class="ident" id="3574397">byPref</span><span class="op" id="3574403">)</span>&nbsp;<span class="ident" id="3574405">Swap</span><span class="op" id="3574409">(</span><span class="ident" id="3574410">i</span><span class="op" id="3574411">,</span>&nbsp;<span class="ident" id="3574413">j</span>&nbsp;<span class="builtintype" id="3574415">int</span><span class="op" id="3574418">)</span>&nbsp;<span class="op" id="3574420">{</span>&nbsp;<span class="ident" id="3574422">s</span><span class="op" id="3574423">[</span><span class="ident" id="3574424">i</span><span class="op" id="3574425">]</span><span class="op" id="3574426">,</span>&nbsp;<span class="ident" id="3574428">s</span><span class="op" id="3574429">[</span><span class="ident" id="3574430">j</span><span class="op" id="3574431">]</span>&nbsp;<span class="op" id="3574433">=</span>&nbsp;<span class="ident" id="3574435">s</span><span class="op" id="3574436">[</span><span class="ident" id="3574437">j</span><span class="op" id="3574438">]</span><span class="op" id="3574439">,</span>&nbsp;<span class="ident" id="3574441">s</span><span class="op" id="3574442">[</span><span class="ident" id="3574443">i</span><span class="op" id="3574444">]</span>&nbsp;<span class="op" id="3574446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3574449">//&nbsp;sort&nbsp;reorders&nbsp;MX&nbsp;records&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;5321.</span><br>
<span class="lineno"></span><span class="keyword" id="3574503">func</span>&nbsp;<span class="op" id="3574508">(</span><span class="ident" id="3574509">s</span>&nbsp;<span class="ident" id="3574511">byPref</span><span class="op" id="3574517">)</span>&nbsp;<span class="ident" id="3574519">sort</span><span class="op" id="3574523">(</span><span class="op" id="3574524">)</span>&nbsp;<span class="op" id="3574526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3574529">for</span>&nbsp;<span class="ident" id="3574533">i</span>&nbsp;<span class="op" id="3574535">:=</span>&nbsp;<span class="keyword" id="3574538">range</span>&nbsp;<span class="ident" id="3574544">s</span>&nbsp;<span class="op" id="3574546">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3574550">j</span>&nbsp;<span class="op" id="3574552">:=</span>&nbsp;<span class="ident" id="3574555">rand</span><span class="op" id="3574559">.</span><span class="ident" id="3574560">Intn</span><span class="op" id="3574564">(</span><span class="ident" id="3574565">i</span>&nbsp;<span class="op" id="3574567">+</span>&nbsp;<span class="num" id="3574569">1</span><span class="op" id="3574570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3574574">s</span><span class="op" id="3574575">[</span><span class="ident" id="3574576">i</span><span class="op" id="3574577">]</span><span class="op" id="3574578">,</span>&nbsp;<span class="ident" id="3574580">s</span><span class="op" id="3574581">[</span><span class="ident" id="3574582">j</span><span class="op" id="3574583">]</span>&nbsp;<span class="op" id="3574585">=</span>&nbsp;<span class="ident" id="3574587">s</span><span class="op" id="3574588">[</span><span class="ident" id="3574589">j</span><span class="op" id="3574590">]</span><span class="op" id="3574591">,</span>&nbsp;<span class="ident" id="3574593">s</span><span class="op" id="3574594">[</span><span class="ident" id="3574595">i</span><span class="op" id="3574596">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3574599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3574602">sort</span><span class="op" id="3574606">.</span><span class="ident" id="3574607">Sort</span><span class="op" id="3574611">(</span><span class="ident" id="3574612">s</span><span class="op" id="3574613">)</span><br>
<span class="lineno"></span><span class="op" id="3574615">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="3574618">//&nbsp;An&nbsp;NS&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;NS&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="3574662">type</span>&nbsp;<span class="ident" id="3574667">NS</span>&nbsp;<span class="keyword" id="3574670">struct</span>&nbsp;<span class="op" id="3574677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3574680">Host</span>&nbsp;<span class="builtintype" id="3574685">string</span><br>
<span class="lineno"></span><span class="op" id="3574692">}</span>
</div>
</body>
</html>
