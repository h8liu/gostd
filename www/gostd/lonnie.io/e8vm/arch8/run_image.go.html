<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/arch8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/arch8/console.go.html">console.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu.go.html">cpu.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu_test.go.html">cpu_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/device.go.html">device.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/exception.go.html">exception.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br_test.go.html">inst_br_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm_test.go.html">inst_imm_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg_test.go.html">inst_reg_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/int_bus.go.html">int_bus.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt.go.html">interrupt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt_test.go.html">interrupt_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/machine.go.html">machine.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/multi_core.go.html">multi_core.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page.go.html">page.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table.go.html">page_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table_test.go.html">page_table_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_test.go.html">page_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory.go.html">phy_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory_test.go.html">phy_memory_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs.go.html">regs.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs_test.go.html">regs_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/run_image.go.html">run_image.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/serial.go.html">serial.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/ticker.go.html">ticker.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory.go.html">virt_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory_test.go.html">virt_memory_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="4803884">package</span>&nbsp;<span class="ident" id="4803892">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4803899">import</span>&nbsp;<span class="op" id="4803906">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4803909">&#34;os&#34;</span><br>
<span class="lineno">5</span><span class="op" id="4803914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4803917">//&nbsp;RunImage&nbsp;loads&nbsp;and&nbsp;run&nbsp;a&nbsp;raw&nbsp;image&nbsp;on&nbsp;a&nbsp;single&nbsp;core&nbsp;machine</span><br>
<span class="lineno"></span><span class="comment" id="4803980">//&nbsp;with&nbsp;1GB&nbsp;physical&nbsp;memory&nbsp;until&nbsp;it&nbsp;runs&nbsp;into&nbsp;an&nbsp;exception.</span><br>
<span class="lineno"></span><span class="keyword" id="4804041">func</span>&nbsp;<span class="ident" id="4804046">RunImage</span><span class="op" id="4804054">(</span><span class="ident" id="4804055">path</span>&nbsp;<span class="builtintype" id="4804060">string</span><span class="op" id="4804066">)</span>&nbsp;<span class="builtintype" id="4804068">error</span>&nbsp;<span class="op" id="4804074">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804077">f</span><span class="op" id="4804078">,</span>&nbsp;<span class="ident" id="4804080">e</span>&nbsp;<span class="op" id="4804082">:=</span>&nbsp;<span class="ident" id="4804085">os</span><span class="op" id="4804087">.</span><span class="ident" id="4804088">Open</span><span class="op" id="4804092">(</span><span class="ident" id="4804093">path</span><span class="op" id="4804097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804100">if</span>&nbsp;<span class="ident" id="4804103">e</span>&nbsp;<span class="op" id="4804105">!=</span>&nbsp;<span class="ident" id="4804108">nil</span>&nbsp;<span class="op" id="4804112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804116">return</span>&nbsp;<span class="ident" id="4804123">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804130">m</span>&nbsp;<span class="op" id="4804132">:=</span>&nbsp;<span class="ident" id="4804135">NewMachine</span><span class="op" id="4804145">(</span><span class="builtintype" id="4804146">uint32</span><span class="op" id="4804152">(</span><span class="num" id="4804153">1</span><span class="op" id="4804154">&lt;&lt;</span><span class="num" id="4804156">30</span><span class="op" id="4804158">)</span><span class="op" id="4804159">,</span>&nbsp;<span class="num" id="4804161">1</span><span class="op" id="4804162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804165">e</span>&nbsp;<span class="op" id="4804167">=</span>&nbsp;<span class="ident" id="4804169">m</span><span class="op" id="4804170">.</span><span class="ident" id="4804171">LoadImage</span><span class="op" id="4804180">(</span><span class="ident" id="4804181">f</span><span class="op" id="4804182">,</span>&nbsp;<span class="ident" id="4804184">InitPC</span><span class="op" id="4804190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804193">if</span>&nbsp;<span class="ident" id="4804196">e</span>&nbsp;<span class="op" id="4804198">!=</span>&nbsp;<span class="ident" id="4804201">nil</span>&nbsp;<span class="op" id="4804205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804209">return</span>&nbsp;<span class="ident" id="4804216">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804219">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804223">_</span><span class="op" id="4804224">,</span>&nbsp;<span class="ident" id="4804226">exp</span>&nbsp;<span class="op" id="4804230">:=</span>&nbsp;<span class="ident" id="4804233">m</span><span class="op" id="4804234">.</span><span class="ident" id="4804235">Run</span><span class="op" id="4804238">(</span><span class="num" id="4804239">0</span><span class="op" id="4804240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804243">if</span>&nbsp;<span class="ident" id="4804246">exp</span>&nbsp;<span class="op" id="4804250">!=</span>&nbsp;<span class="ident" id="4804253">nil</span>&nbsp;<span class="op" id="4804257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804261">return</span>&nbsp;<span class="ident" id="4804268">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804273">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804277">return</span>&nbsp;<span class="ident" id="4804284">nil</span><br>
<span class="lineno"></span><span class="op" id="4804288">}</span>
</div>
</body>
</html>
