<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1795859">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1795914">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1795968">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1796019">//go:generate&nbsp;go&nbsp;run&nbsp;makeisprint.go&nbsp;-output&nbsp;isprint.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1796075">package</span>&nbsp;<span class="ident" id="1796083">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1796092">import</span>&nbsp;<span class="op" id="1796099">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1796102">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1796117">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1796120">const</span>&nbsp;<span class="ident" id="1796126">lowerhex</span>&nbsp;<span class="op" id="1796135">=</span>&nbsp;<span class="string" id="1796137">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1796157">func</span>&nbsp;<span class="ident" id="1796162">quoteWith</span><span class="op" id="1796171">(</span><span class="ident" id="1796172">s</span>&nbsp;<span class="builtintype" id="1796174">string</span><span class="op" id="1796180">,</span>&nbsp;<span class="ident" id="1796182">quote</span>&nbsp;<span class="builtintype" id="1796188">byte</span><span class="op" id="1796192">,</span>&nbsp;<span class="ident" id="1796194">ASCIIonly</span>&nbsp;<span class="builtintype" id="1796204">bool</span><span class="op" id="1796208">)</span>&nbsp;<span class="builtintype" id="1796210">string</span>&nbsp;<span class="op" id="1796217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1796220">var</span>&nbsp;<span class="ident" id="1796224">runeTmp</span>&nbsp;<span class="op" id="1796232">[</span><span class="ident" id="1796233">utf8</span><span class="op" id="1796237">.</span><span class="ident" id="1796238">UTFMax</span><span class="op" id="1796244">]</span><span class="builtintype" id="1796245">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796251">buf</span>&nbsp;<span class="op" id="1796255">:=</span>&nbsp;<span class="builtinfunc" id="1796258">make</span><span class="op" id="1796262">(</span><span class="op" id="1796263">[</span><span class="op" id="1796264">]</span><span class="builtintype" id="1796265">byte</span><span class="op" id="1796269">,</span>&nbsp;<span class="num" id="1796271">0</span><span class="op" id="1796272">,</span>&nbsp;<span class="num" id="1796274">3</span><span class="op" id="1796275">*</span><span class="builtinfunc" id="1796276">len</span><span class="op" id="1796279">(</span><span class="ident" id="1796280">s</span><span class="op" id="1796281">)</span><span class="op" id="1796282">/</span><span class="num" id="1796283">2</span><span class="op" id="1796284">)</span>&nbsp;<span class="comment" id="1796286">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796321">buf</span>&nbsp;<span class="op" id="1796325">=</span>&nbsp;<span class="builtinfunc" id="1796327">append</span><span class="op" id="1796333">(</span><span class="ident" id="1796334">buf</span><span class="op" id="1796337">,</span>&nbsp;<span class="ident" id="1796339">quote</span><span class="op" id="1796344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1796347">for</span>&nbsp;<span class="ident" id="1796351">width</span>&nbsp;<span class="op" id="1796357">:=</span>&nbsp;<span class="num" id="1796360">0</span><span class="op" id="1796361">;</span>&nbsp;<span class="builtinfunc" id="1796363">len</span><span class="op" id="1796366">(</span><span class="ident" id="1796367">s</span><span class="op" id="1796368">)</span>&nbsp;<span class="op" id="1796370">&gt;</span>&nbsp;<span class="num" id="1796372">0</span><span class="op" id="1796373">;</span>&nbsp;<span class="ident" id="1796375">s</span>&nbsp;<span class="op" id="1796377">=</span>&nbsp;<span class="ident" id="1796379">s</span><span class="op" id="1796380">[</span><span class="ident" id="1796381">width</span><span class="op" id="1796386">:</span><span class="op" id="1796387">]</span>&nbsp;<span class="op" id="1796389">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796393">r</span>&nbsp;<span class="op" id="1796395">:=</span>&nbsp;<span class="builtintype" id="1796398">rune</span><span class="op" id="1796402">(</span><span class="ident" id="1796403">s</span><span class="op" id="1796404">[</span><span class="num" id="1796405">0</span><span class="op" id="1796406">]</span><span class="op" id="1796407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796411">width</span>&nbsp;<span class="op" id="1796417">=</span>&nbsp;<span class="num" id="1796419">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1796423">if</span>&nbsp;<span class="ident" id="1796426">r</span>&nbsp;<span class="op" id="1796428">&gt;=</span>&nbsp;<span class="ident" id="1796431">utf8</span><span class="op" id="1796435">.</span><span class="ident" id="1796436">RuneSelf</span>&nbsp;<span class="op" id="1796445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796450">r</span><span class="op" id="1796451">,</span>&nbsp;<span class="ident" id="1796453">width</span>&nbsp;<span class="op" id="1796459">=</span>&nbsp;<span class="ident" id="1796461">utf8</span><span class="op" id="1796465">.</span><span class="ident" id="1796466">DecodeRuneInString</span><span class="op" id="1796484">(</span><span class="ident" id="1796485">s</span><span class="op" id="1796486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1796490">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1796494">if</span>&nbsp;<span class="ident" id="1796497">width</span>&nbsp;<span class="op" id="1796503">==</span>&nbsp;<span class="num" id="1796506">1</span>&nbsp;<span class="op" id="1796508">&amp;&amp;</span>&nbsp;<span class="ident" id="1796511">r</span>&nbsp;<span class="op" id="1796513">==</span>&nbsp;<span class="ident" id="1796516">utf8</span><span class="op" id="1796520">.</span><span class="ident" id="1796521">RuneError</span>&nbsp;<span class="op" id="1796531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796536">buf</span>&nbsp;<span class="op" id="1796540">=</span>&nbsp;<span class="builtinfunc" id="1796542">append</span><span class="op" id="1796548">(</span><span class="ident" id="1796549">buf</span><span class="op" id="1796552">,</span>&nbsp;<span class="string" id="1796554">`\x`</span><span class="op" id="1796558">...</span><span class="op" id="1796561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796566">buf</span>&nbsp;<span class="op" id="1796570">=</span>&nbsp;<span class="builtinfunc" id="1796572">append</span><span class="op" id="1796578">(</span><span class="ident" id="1796579">buf</span><span class="op" id="1796582">,</span>&nbsp;<span class="ident" id="1796584">lowerhex</span><span class="op" id="1796592">[</span><span class="ident" id="1796593">s</span><span class="op" id="1796594">[</span><span class="num" id="1796595">0</span><span class="op" id="1796596">]</span><span class="op" id="1796597">&gt;&gt;</span><span class="num" id="1796599">4</span><span class="op" id="1796600">]</span><span class="op" id="1796601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796606">buf</span>&nbsp;<span class="op" id="1796610">=</span>&nbsp;<span class="builtinfunc" id="1796612">append</span><span class="op" id="1796618">(</span><span class="ident" id="1796619">buf</span><span class="op" id="1796622">,</span>&nbsp;<span class="ident" id="1796624">lowerhex</span><span class="op" id="1796632">[</span><span class="ident" id="1796633">s</span><span class="op" id="1796634">[</span><span class="num" id="1796635">0</span><span class="op" id="1796636">]</span><span class="op" id="1796637">&amp;</span><span class="num" id="1796638">0xF</span><span class="op" id="1796641">]</span><span class="op" id="1796642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1796647">continue</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1796658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1796662">if</span>&nbsp;<span class="ident" id="1796665">r</span>&nbsp;<span class="op" id="1796667">==</span>&nbsp;<span class="builtintype" id="1796670">rune</span><span class="op" id="1796674">(</span><span class="ident" id="1796675">quote</span><span class="op" id="1796680">)</span>&nbsp;<span class="op" id="1796682">||</span>&nbsp;<span class="ident" id="1796685">r</span>&nbsp;<span class="op" id="1796687">==</span>&nbsp;<span class="string" id="1796690">&#39;\\&#39;</span>&nbsp;<span class="op" id="1796695">{</span>&nbsp;<span class="comment" id="1796697">//&nbsp;always&nbsp;backslashed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796722">buf</span>&nbsp;<span class="op" id="1796726">=</span>&nbsp;<span class="builtinfunc" id="1796728">append</span><span class="op" id="1796734">(</span><span class="ident" id="1796735">buf</span><span class="op" id="1796738">,</span>&nbsp;<span class="string" id="1796740">&#39;\\&#39;</span><span class="op" id="1796744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796749">buf</span>&nbsp;<span class="op" id="1796753">=</span>&nbsp;<span class="builtinfunc" id="1796755">append</span><span class="op" id="1796761">(</span><span class="ident" id="1796762">buf</span><span class="op" id="1796765">,</span>&nbsp;<span class="builtintype" id="1796767">byte</span><span class="op" id="1796771">(</span><span class="ident" id="1796772">r</span><span class="op" id="1796773">)</span><span class="op" id="1796774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1796779">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1796790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1796794">if</span>&nbsp;<span class="ident" id="1796797">ASCIIonly</span>&nbsp;<span class="op" id="1796807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1796812">if</span>&nbsp;<span class="ident" id="1796815">r</span>&nbsp;<span class="op" id="1796817">&lt;</span>&nbsp;<span class="ident" id="1796819">utf8</span><span class="op" id="1796823">.</span><span class="ident" id="1796824">RuneSelf</span>&nbsp;<span class="op" id="1796833">&amp;&amp;</span>&nbsp;<span class="ident" id="1796836">IsPrint</span><span class="op" id="1796843">(</span><span class="ident" id="1796844">r</span><span class="op" id="1796845">)</span>&nbsp;<span class="op" id="1796847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796853">buf</span>&nbsp;<span class="op" id="1796857">=</span>&nbsp;<span class="builtinfunc" id="1796859">append</span><span class="op" id="1796865">(</span><span class="ident" id="1796866">buf</span><span class="op" id="1796869">,</span>&nbsp;<span class="builtintype" id="1796871">byte</span><span class="op" id="1796875">(</span><span class="ident" id="1796876">r</span><span class="op" id="1796877">)</span><span class="op" id="1796878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1796884">continue</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1796896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1796900">}</span>&nbsp;<span class="keyword" id="1796902">else</span>&nbsp;<span class="keyword" id="1796907">if</span>&nbsp;<span class="ident" id="1796910">IsPrint</span><span class="op" id="1796917">(</span><span class="ident" id="1796918">r</span><span class="op" id="1796919">)</span>&nbsp;<span class="op" id="1796921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796926">n</span>&nbsp;<span class="op" id="1796928">:=</span>&nbsp;<span class="ident" id="1796931">utf8</span><span class="op" id="1796935">.</span><span class="ident" id="1796936">EncodeRune</span><span class="op" id="1796946">(</span><span class="ident" id="1796947">runeTmp</span><span class="op" id="1796954">[</span><span class="op" id="1796955">:</span><span class="op" id="1796956">]</span><span class="op" id="1796957">,</span>&nbsp;<span class="ident" id="1796959">r</span><span class="op" id="1796960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1796965">buf</span>&nbsp;<span class="op" id="1796969">=</span>&nbsp;<span class="builtinfunc" id="1796971">append</span><span class="op" id="1796977">(</span><span class="ident" id="1796978">buf</span><span class="op" id="1796981">,</span>&nbsp;<span class="ident" id="1796983">runeTmp</span><span class="op" id="1796990">[</span><span class="op" id="1796991">:</span><span class="ident" id="1796992">n</span><span class="op" id="1796993">]</span><span class="op" id="1796994">...</span><span class="op" id="1796997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797002">continue</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1797013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797017">switch</span>&nbsp;<span class="ident" id="1797024">r</span>&nbsp;<span class="op" id="1797026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797030">case</span>&nbsp;<span class="string" id="1797035">&#39;\a&#39;</span><span class="op" id="1797039">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797044">buf</span>&nbsp;<span class="op" id="1797048">=</span>&nbsp;<span class="builtinfunc" id="1797050">append</span><span class="op" id="1797056">(</span><span class="ident" id="1797057">buf</span><span class="op" id="1797060">,</span>&nbsp;<span class="string" id="1797062">`\a`</span><span class="op" id="1797066">...</span><span class="op" id="1797069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797073">case</span>&nbsp;<span class="string" id="1797078">&#39;\b&#39;</span><span class="op" id="1797082">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797087">buf</span>&nbsp;<span class="op" id="1797091">=</span>&nbsp;<span class="builtinfunc" id="1797093">append</span><span class="op" id="1797099">(</span><span class="ident" id="1797100">buf</span><span class="op" id="1797103">,</span>&nbsp;<span class="string" id="1797105">`\b`</span><span class="op" id="1797109">...</span><span class="op" id="1797112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797116">case</span>&nbsp;<span class="string" id="1797121">&#39;\f&#39;</span><span class="op" id="1797125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797130">buf</span>&nbsp;<span class="op" id="1797134">=</span>&nbsp;<span class="builtinfunc" id="1797136">append</span><span class="op" id="1797142">(</span><span class="ident" id="1797143">buf</span><span class="op" id="1797146">,</span>&nbsp;<span class="string" id="1797148">`\f`</span><span class="op" id="1797152">...</span><span class="op" id="1797155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797159">case</span>&nbsp;<span class="string" id="1797164">&#39;\n&#39;</span><span class="op" id="1797168">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797173">buf</span>&nbsp;<span class="op" id="1797177">=</span>&nbsp;<span class="builtinfunc" id="1797179">append</span><span class="op" id="1797185">(</span><span class="ident" id="1797186">buf</span><span class="op" id="1797189">,</span>&nbsp;<span class="string" id="1797191">`\n`</span><span class="op" id="1797195">...</span><span class="op" id="1797198">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797202">case</span>&nbsp;<span class="string" id="1797207">&#39;\r&#39;</span><span class="op" id="1797211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797216">buf</span>&nbsp;<span class="op" id="1797220">=</span>&nbsp;<span class="builtinfunc" id="1797222">append</span><span class="op" id="1797228">(</span><span class="ident" id="1797229">buf</span><span class="op" id="1797232">,</span>&nbsp;<span class="string" id="1797234">`\r`</span><span class="op" id="1797238">...</span><span class="op" id="1797241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797245">case</span>&nbsp;<span class="string" id="1797250">&#39;\t&#39;</span><span class="op" id="1797254">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797259">buf</span>&nbsp;<span class="op" id="1797263">=</span>&nbsp;<span class="builtinfunc" id="1797265">append</span><span class="op" id="1797271">(</span><span class="ident" id="1797272">buf</span><span class="op" id="1797275">,</span>&nbsp;<span class="string" id="1797277">`\t`</span><span class="op" id="1797281">...</span><span class="op" id="1797284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797288">case</span>&nbsp;<span class="string" id="1797293">&#39;\v&#39;</span><span class="op" id="1797297">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797302">buf</span>&nbsp;<span class="op" id="1797306">=</span>&nbsp;<span class="builtinfunc" id="1797308">append</span><span class="op" id="1797314">(</span><span class="ident" id="1797315">buf</span><span class="op" id="1797318">,</span>&nbsp;<span class="string" id="1797320">`\v`</span><span class="op" id="1797324">...</span><span class="op" id="1797327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797331">default</span><span class="op" id="1797338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797343">switch</span>&nbsp;<span class="op" id="1797350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797355">case</span>&nbsp;<span class="ident" id="1797360">r</span>&nbsp;<span class="op" id="1797362">&lt;</span>&nbsp;<span class="string" id="1797364">&#39;&nbsp;&#39;</span><span class="op" id="1797367">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797373">buf</span>&nbsp;<span class="op" id="1797377">=</span>&nbsp;<span class="builtinfunc" id="1797379">append</span><span class="op" id="1797385">(</span><span class="ident" id="1797386">buf</span><span class="op" id="1797389">,</span>&nbsp;<span class="string" id="1797391">`\x`</span><span class="op" id="1797395">...</span><span class="op" id="1797398">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797404">buf</span>&nbsp;<span class="op" id="1797408">=</span>&nbsp;<span class="builtinfunc" id="1797410">append</span><span class="op" id="1797416">(</span><span class="ident" id="1797417">buf</span><span class="op" id="1797420">,</span>&nbsp;<span class="ident" id="1797422">lowerhex</span><span class="op" id="1797430">[</span><span class="ident" id="1797431">s</span><span class="op" id="1797432">[</span><span class="num" id="1797433">0</span><span class="op" id="1797434">]</span><span class="op" id="1797435">&gt;&gt;</span><span class="num" id="1797437">4</span><span class="op" id="1797438">]</span><span class="op" id="1797439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797445">buf</span>&nbsp;<span class="op" id="1797449">=</span>&nbsp;<span class="builtinfunc" id="1797451">append</span><span class="op" id="1797457">(</span><span class="ident" id="1797458">buf</span><span class="op" id="1797461">,</span>&nbsp;<span class="ident" id="1797463">lowerhex</span><span class="op" id="1797471">[</span><span class="ident" id="1797472">s</span><span class="op" id="1797473">[</span><span class="num" id="1797474">0</span><span class="op" id="1797475">]</span><span class="op" id="1797476">&amp;</span><span class="num" id="1797477">0xF</span><span class="op" id="1797480">]</span><span class="op" id="1797481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797486">case</span>&nbsp;<span class="ident" id="1797491">r</span>&nbsp;<span class="op" id="1797493">&gt;</span>&nbsp;<span class="ident" id="1797495">utf8</span><span class="op" id="1797499">.</span><span class="ident" id="1797500">MaxRune</span><span class="op" id="1797507">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797513">r</span>&nbsp;<span class="op" id="1797515">=</span>&nbsp;<span class="num" id="1797517">0xFFFD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797528">fallthrough</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797543">case</span>&nbsp;<span class="ident" id="1797548">r</span>&nbsp;<span class="op" id="1797550">&lt;</span>&nbsp;<span class="num" id="1797552">0x10000</span><span class="op" id="1797559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797565">buf</span>&nbsp;<span class="op" id="1797569">=</span>&nbsp;<span class="builtinfunc" id="1797571">append</span><span class="op" id="1797577">(</span><span class="ident" id="1797578">buf</span><span class="op" id="1797581">,</span>&nbsp;<span class="string" id="1797583">`\u`</span><span class="op" id="1797587">...</span><span class="op" id="1797590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797596">for</span>&nbsp;<span class="ident" id="1797600">s</span>&nbsp;<span class="op" id="1797602">:=</span>&nbsp;<span class="num" id="1797605">12</span><span class="op" id="1797607">;</span>&nbsp;<span class="ident" id="1797609">s</span>&nbsp;<span class="op" id="1797611">&gt;=</span>&nbsp;<span class="num" id="1797614">0</span><span class="op" id="1797615">;</span>&nbsp;<span class="ident" id="1797617">s</span>&nbsp;<span class="op" id="1797619">-=</span>&nbsp;<span class="num" id="1797622">4</span>&nbsp;<span class="op" id="1797624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797631">buf</span>&nbsp;<span class="op" id="1797635">=</span>&nbsp;<span class="builtinfunc" id="1797637">append</span><span class="op" id="1797643">(</span><span class="ident" id="1797644">buf</span><span class="op" id="1797647">,</span>&nbsp;<span class="ident" id="1797649">lowerhex</span><span class="op" id="1797657">[</span><span class="ident" id="1797658">r</span><span class="op" id="1797659">&gt;&gt;</span><span class="builtintype" id="1797661">uint</span><span class="op" id="1797665">(</span><span class="ident" id="1797666">s</span><span class="op" id="1797667">)</span><span class="op" id="1797668">&amp;</span><span class="num" id="1797669">0xF</span><span class="op" id="1797672">]</span><span class="op" id="1797673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1797679">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797684">default</span><span class="op" id="1797691">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797697">buf</span>&nbsp;<span class="op" id="1797701">=</span>&nbsp;<span class="builtinfunc" id="1797703">append</span><span class="op" id="1797709">(</span><span class="ident" id="1797710">buf</span><span class="op" id="1797713">,</span>&nbsp;<span class="string" id="1797715">`\U`</span><span class="op" id="1797719">...</span><span class="op" id="1797722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797728">for</span>&nbsp;<span class="ident" id="1797732">s</span>&nbsp;<span class="op" id="1797734">:=</span>&nbsp;<span class="num" id="1797737">28</span><span class="op" id="1797739">;</span>&nbsp;<span class="ident" id="1797741">s</span>&nbsp;<span class="op" id="1797743">&gt;=</span>&nbsp;<span class="num" id="1797746">0</span><span class="op" id="1797747">;</span>&nbsp;<span class="ident" id="1797749">s</span>&nbsp;<span class="op" id="1797751">-=</span>&nbsp;<span class="num" id="1797754">4</span>&nbsp;<span class="op" id="1797756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797763">buf</span>&nbsp;<span class="op" id="1797767">=</span>&nbsp;<span class="builtinfunc" id="1797769">append</span><span class="op" id="1797775">(</span><span class="ident" id="1797776">buf</span><span class="op" id="1797779">,</span>&nbsp;<span class="ident" id="1797781">lowerhex</span><span class="op" id="1797789">[</span><span class="ident" id="1797790">r</span><span class="op" id="1797791">&gt;&gt;</span><span class="builtintype" id="1797793">uint</span><span class="op" id="1797797">(</span><span class="ident" id="1797798">s</span><span class="op" id="1797799">)</span><span class="op" id="1797800">&amp;</span><span class="num" id="1797801">0xF</span><span class="op" id="1797804">]</span><span class="op" id="1797805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1797811">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1797816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1797820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1797823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1797826">buf</span>&nbsp;<span class="op" id="1797830">=</span>&nbsp;<span class="builtinfunc" id="1797832">append</span><span class="op" id="1797838">(</span><span class="ident" id="1797839">buf</span><span class="op" id="1797842">,</span>&nbsp;<span class="ident" id="1797844">quote</span><span class="op" id="1797849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1797852">return</span>&nbsp;<span class="builtintype" id="1797859">string</span><span class="op" id="1797865">(</span><span class="ident" id="1797866">buf</span><span class="op" id="1797869">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="op" id="1797872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1797875">//&nbsp;Quote&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.&nbsp;&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="1797947">//&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno">90</span><span class="comment" id="1798018">//&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1798083">//&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="1798095">func</span>&nbsp;<span class="ident" id="1798100">Quote</span><span class="op" id="1798105">(</span><span class="ident" id="1798106">s</span>&nbsp;<span class="builtintype" id="1798108">string</span><span class="op" id="1798114">)</span>&nbsp;<span class="builtintype" id="1798116">string</span>&nbsp;<span class="op" id="1798123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1798126">return</span>&nbsp;<span class="ident" id="1798133">quoteWith</span><span class="op" id="1798142">(</span><span class="ident" id="1798143">s</span><span class="op" id="1798144">,</span>&nbsp;<span class="string" id="1798146">&#39;&#34;&#39;</span><span class="op" id="1798149">,</span>&nbsp;<span class="builtintype" id="1798151">false</span><span class="op" id="1798156">)</span><br>
<span class="lineno"></span><span class="op" id="1798158">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="1798161">//&nbsp;AppendQuote&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno"></span><span class="comment" id="1798234">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;Quote,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="1798300">func</span>&nbsp;<span class="ident" id="1798305">AppendQuote</span><span class="op" id="1798316">(</span><span class="ident" id="1798317">dst</span>&nbsp;<span class="op" id="1798321">[</span><span class="op" id="1798322">]</span><span class="builtintype" id="1798323">byte</span><span class="op" id="1798327">,</span>&nbsp;<span class="ident" id="1798329">s</span>&nbsp;<span class="builtintype" id="1798331">string</span><span class="op" id="1798337">)</span>&nbsp;<span class="op" id="1798339">[</span><span class="op" id="1798340">]</span><span class="builtintype" id="1798341">byte</span>&nbsp;<span class="op" id="1798346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1798349">return</span>&nbsp;<span class="builtinfunc" id="1798356">append</span><span class="op" id="1798362">(</span><span class="ident" id="1798363">dst</span><span class="op" id="1798366">,</span>&nbsp;<span class="ident" id="1798368">Quote</span><span class="op" id="1798373">(</span><span class="ident" id="1798374">s</span><span class="op" id="1798375">)</span><span class="op" id="1798376">...</span><span class="op" id="1798379">)</span><br>
<span class="lineno">100</span><span class="op" id="1798381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1798384">//&nbsp;QuoteToASCII&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="1798458">//&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="1798533">//&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno">105</span><span class="keyword" id="1798609">func</span>&nbsp;<span class="ident" id="1798614">QuoteToASCII</span><span class="op" id="1798626">(</span><span class="ident" id="1798627">s</span>&nbsp;<span class="builtintype" id="1798629">string</span><span class="op" id="1798635">)</span>&nbsp;<span class="builtintype" id="1798637">string</span>&nbsp;<span class="op" id="1798644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1798647">return</span>&nbsp;<span class="ident" id="1798654">quoteWith</span><span class="op" id="1798663">(</span><span class="ident" id="1798664">s</span><span class="op" id="1798665">,</span>&nbsp;<span class="string" id="1798667">&#39;&#34;&#39;</span><span class="op" id="1798670">,</span>&nbsp;<span class="builtintype" id="1798672">true</span><span class="op" id="1798676">)</span><br>
<span class="lineno"></span><span class="op" id="1798678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1798681">//&nbsp;AppendQuoteToASCII&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno">110</span><span class="comment" id="1798761">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="1798834">func</span>&nbsp;<span class="ident" id="1798839">AppendQuoteToASCII</span><span class="op" id="1798857">(</span><span class="ident" id="1798858">dst</span>&nbsp;<span class="op" id="1798862">[</span><span class="op" id="1798863">]</span><span class="builtintype" id="1798864">byte</span><span class="op" id="1798868">,</span>&nbsp;<span class="ident" id="1798870">s</span>&nbsp;<span class="builtintype" id="1798872">string</span><span class="op" id="1798878">)</span>&nbsp;<span class="op" id="1798880">[</span><span class="op" id="1798881">]</span><span class="builtintype" id="1798882">byte</span>&nbsp;<span class="op" id="1798887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1798890">return</span>&nbsp;<span class="builtinfunc" id="1798897">append</span><span class="op" id="1798903">(</span><span class="ident" id="1798904">dst</span><span class="op" id="1798907">,</span>&nbsp;<span class="ident" id="1798909">QuoteToASCII</span><span class="op" id="1798921">(</span><span class="ident" id="1798922">s</span><span class="op" id="1798923">)</span><span class="op" id="1798924">...</span><span class="op" id="1798927">)</span><br>
<span class="lineno"></span><span class="op" id="1798929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="1798932">//&nbsp;QuoteRune&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1799007">//&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)</span><br>
<span class="lineno"></span><span class="comment" id="1799085">//&nbsp;for&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="1799163">func</span>&nbsp;<span class="ident" id="1799168">QuoteRune</span><span class="op" id="1799177">(</span><span class="ident" id="1799178">r</span>&nbsp;<span class="builtintype" id="1799180">rune</span><span class="op" id="1799184">)</span>&nbsp;<span class="builtintype" id="1799186">string</span>&nbsp;<span class="op" id="1799193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1799196">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1799233">return</span>&nbsp;<span class="ident" id="1799240">quoteWith</span><span class="op" id="1799249">(</span><span class="builtintype" id="1799250">string</span><span class="op" id="1799256">(</span><span class="ident" id="1799257">r</span><span class="op" id="1799258">)</span><span class="op" id="1799259">,</span>&nbsp;<span class="string" id="1799261">&#39;\&#39;&#39;</span><span class="op" id="1799265">,</span>&nbsp;<span class="builtintype" id="1799267">false</span><span class="op" id="1799272">)</span><br>
<span class="lineno"></span><span class="op" id="1799274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1799277">//&nbsp;AppendQuoteRune&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="1799364">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRune,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">125</span><span class="keyword" id="1799434">func</span>&nbsp;<span class="ident" id="1799439">AppendQuoteRune</span><span class="op" id="1799454">(</span><span class="ident" id="1799455">dst</span>&nbsp;<span class="op" id="1799459">[</span><span class="op" id="1799460">]</span><span class="builtintype" id="1799461">byte</span><span class="op" id="1799465">,</span>&nbsp;<span class="ident" id="1799467">r</span>&nbsp;<span class="builtintype" id="1799469">rune</span><span class="op" id="1799473">)</span>&nbsp;<span class="op" id="1799475">[</span><span class="op" id="1799476">]</span><span class="builtintype" id="1799477">byte</span>&nbsp;<span class="op" id="1799482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1799485">return</span>&nbsp;<span class="builtinfunc" id="1799492">append</span><span class="op" id="1799498">(</span><span class="ident" id="1799499">dst</span><span class="op" id="1799502">,</span>&nbsp;<span class="ident" id="1799504">QuoteRune</span><span class="op" id="1799513">(</span><span class="ident" id="1799514">r</span><span class="op" id="1799515">)</span><span class="op" id="1799516">...</span><span class="op" id="1799519">)</span><br>
<span class="lineno"></span><span class="op" id="1799521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1799524">//&nbsp;QuoteRuneToASCII&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing</span><br>
<span class="lineno">130</span><span class="comment" id="1799602">//&nbsp;the&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,</span><br>
<span class="lineno"></span><span class="comment" id="1799676">//&nbsp;\u0100)&nbsp;for&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="1799752">//&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="1799767">func</span>&nbsp;<span class="ident" id="1799772">QuoteRuneToASCII</span><span class="op" id="1799788">(</span><span class="ident" id="1799789">r</span>&nbsp;<span class="builtintype" id="1799791">rune</span><span class="op" id="1799795">)</span>&nbsp;<span class="builtintype" id="1799797">string</span>&nbsp;<span class="op" id="1799804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1799807">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1799844">return</span>&nbsp;<span class="ident" id="1799851">quoteWith</span><span class="op" id="1799860">(</span><span class="builtintype" id="1799861">string</span><span class="op" id="1799867">(</span><span class="ident" id="1799868">r</span><span class="op" id="1799869">)</span><span class="op" id="1799870">,</span>&nbsp;<span class="string" id="1799872">&#39;\&#39;&#39;</span><span class="op" id="1799876">,</span>&nbsp;<span class="builtintype" id="1799878">true</span><span class="op" id="1799882">)</span><br>
<span class="lineno"></span><span class="op" id="1799884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1799887">//&nbsp;AppendQuoteRuneToASCII&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="1799981">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRuneToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">140</span><span class="keyword" id="1800058">func</span>&nbsp;<span class="ident" id="1800063">AppendQuoteRuneToASCII</span><span class="op" id="1800085">(</span><span class="ident" id="1800086">dst</span>&nbsp;<span class="op" id="1800090">[</span><span class="op" id="1800091">]</span><span class="builtintype" id="1800092">byte</span><span class="op" id="1800096">,</span>&nbsp;<span class="ident" id="1800098">r</span>&nbsp;<span class="builtintype" id="1800100">rune</span><span class="op" id="1800104">)</span>&nbsp;<span class="op" id="1800106">[</span><span class="op" id="1800107">]</span><span class="builtintype" id="1800108">byte</span>&nbsp;<span class="op" id="1800113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800116">return</span>&nbsp;<span class="builtinfunc" id="1800123">append</span><span class="op" id="1800129">(</span><span class="ident" id="1800130">dst</span><span class="op" id="1800133">,</span>&nbsp;<span class="ident" id="1800135">QuoteRuneToASCII</span><span class="op" id="1800151">(</span><span class="ident" id="1800152">r</span><span class="op" id="1800153">)</span><span class="op" id="1800154">...</span><span class="op" id="1800157">)</span><br>
<span class="lineno"></span><span class="op" id="1800159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1800162">//&nbsp;CanBackquote&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;represented</span><br>
<span class="lineno">145</span><span class="comment" id="1800226">//&nbsp;unchanged&nbsp;as&nbsp;a&nbsp;single-line&nbsp;backquoted&nbsp;string&nbsp;without&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="1800290">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;tab.</span><br>
<span class="lineno"></span><span class="keyword" id="1800320">func</span>&nbsp;<span class="ident" id="1800325">CanBackquote</span><span class="op" id="1800337">(</span><span class="ident" id="1800338">s</span>&nbsp;<span class="builtintype" id="1800340">string</span><span class="op" id="1800346">)</span>&nbsp;<span class="builtintype" id="1800348">bool</span>&nbsp;<span class="op" id="1800353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800356">for</span>&nbsp;<span class="builtinfunc" id="1800360">len</span><span class="op" id="1800363">(</span><span class="ident" id="1800364">s</span><span class="op" id="1800365">)</span>&nbsp;<span class="op" id="1800367">&gt;</span>&nbsp;<span class="num" id="1800369">0</span>&nbsp;<span class="op" id="1800371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1800375">r</span><span class="op" id="1800376">,</span>&nbsp;<span class="ident" id="1800378">wid</span>&nbsp;<span class="op" id="1800382">:=</span>&nbsp;<span class="ident" id="1800385">utf8</span><span class="op" id="1800389">.</span><span class="ident" id="1800390">DecodeRuneInString</span><span class="op" id="1800408">(</span><span class="ident" id="1800409">s</span><span class="op" id="1800410">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1800414">s</span>&nbsp;<span class="op" id="1800416">=</span>&nbsp;<span class="ident" id="1800418">s</span><span class="op" id="1800419">[</span><span class="ident" id="1800420">wid</span><span class="op" id="1800423">:</span><span class="op" id="1800424">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800428">if</span>&nbsp;<span class="ident" id="1800431">wid</span>&nbsp;<span class="op" id="1800435">&gt;</span>&nbsp;<span class="num" id="1800437">1</span>&nbsp;<span class="op" id="1800439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800444">if</span>&nbsp;<span class="ident" id="1800447">r</span>&nbsp;<span class="op" id="1800449">==</span>&nbsp;<span class="string" id="1800452">&#39;\ufeff&#39;</span>&nbsp;<span class="op" id="1800461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800467">return</span>&nbsp;<span class="builtintype" id="1800474">false</span>&nbsp;<span class="comment" id="1800480">//&nbsp;BOMs&nbsp;are&nbsp;invisible&nbsp;and&nbsp;should&nbsp;not&nbsp;be&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1800531">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800536">continue</span>&nbsp;<span class="comment" id="1800545">//&nbsp;All&nbsp;other&nbsp;multibyte&nbsp;runes&nbsp;are&nbsp;correctly&nbsp;encoded&nbsp;and&nbsp;assumed&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1800621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800625">if</span>&nbsp;<span class="ident" id="1800628">r</span>&nbsp;<span class="op" id="1800630">==</span>&nbsp;<span class="ident" id="1800633">utf8</span><span class="op" id="1800637">.</span><span class="ident" id="1800638">RuneError</span>&nbsp;<span class="op" id="1800648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800653">return</span>&nbsp;<span class="builtintype" id="1800660">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1800668">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800672">if</span>&nbsp;<span class="op" id="1800675">(</span><span class="ident" id="1800676">r</span>&nbsp;<span class="op" id="1800678">&lt;</span>&nbsp;<span class="string" id="1800680">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="1800684">&amp;&amp;</span>&nbsp;<span class="ident" id="1800687">r</span>&nbsp;<span class="op" id="1800689">!=</span>&nbsp;<span class="string" id="1800692">&#39;\t&#39;</span><span class="op" id="1800696">)</span>&nbsp;<span class="op" id="1800698">||</span>&nbsp;<span class="ident" id="1800701">r</span>&nbsp;<span class="op" id="1800703">==</span>&nbsp;<span class="string" id="1800706">&#39;`&#39;</span>&nbsp;<span class="op" id="1800710">||</span>&nbsp;<span class="ident" id="1800713">r</span>&nbsp;<span class="op" id="1800715">==</span>&nbsp;<span class="string" id="1800718">&#39;\u007F&#39;</span>&nbsp;<span class="op" id="1800727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800732">return</span>&nbsp;<span class="builtintype" id="1800739">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1800747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1800750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800753">return</span>&nbsp;<span class="builtintype" id="1800760">true</span><br>
<span class="lineno">165</span><span class="op" id="1800765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1800768">func</span>&nbsp;<span class="ident" id="1800773">unhex</span><span class="op" id="1800778">(</span><span class="ident" id="1800779">b</span>&nbsp;<span class="builtintype" id="1800781">byte</span><span class="op" id="1800785">)</span>&nbsp;<span class="op" id="1800787">(</span><span class="ident" id="1800788">v</span>&nbsp;<span class="builtintype" id="1800790">rune</span><span class="op" id="1800794">,</span>&nbsp;<span class="ident" id="1800796">ok</span>&nbsp;<span class="builtintype" id="1800799">bool</span><span class="op" id="1800803">)</span>&nbsp;<span class="op" id="1800805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1800808">c</span>&nbsp;<span class="op" id="1800810">:=</span>&nbsp;<span class="builtintype" id="1800813">rune</span><span class="op" id="1800817">(</span><span class="ident" id="1800818">b</span><span class="op" id="1800819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800822">switch</span>&nbsp;<span class="op" id="1800829">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800832">case</span>&nbsp;<span class="string" id="1800837">&#39;0&#39;</span>&nbsp;<span class="op" id="1800841">&lt;=</span>&nbsp;<span class="ident" id="1800844">c</span>&nbsp;<span class="op" id="1800846">&amp;&amp;</span>&nbsp;<span class="ident" id="1800849">c</span>&nbsp;<span class="op" id="1800851">&lt;=</span>&nbsp;<span class="string" id="1800854">&#39;9&#39;</span><span class="op" id="1800857">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800861">return</span>&nbsp;<span class="ident" id="1800868">c</span>&nbsp;<span class="op" id="1800870">-</span>&nbsp;<span class="string" id="1800872">&#39;0&#39;</span><span class="op" id="1800875">,</span>&nbsp;<span class="builtintype" id="1800877">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800883">case</span>&nbsp;<span class="string" id="1800888">&#39;a&#39;</span>&nbsp;<span class="op" id="1800892">&lt;=</span>&nbsp;<span class="ident" id="1800895">c</span>&nbsp;<span class="op" id="1800897">&amp;&amp;</span>&nbsp;<span class="ident" id="1800900">c</span>&nbsp;<span class="op" id="1800902">&lt;=</span>&nbsp;<span class="string" id="1800905">&#39;f&#39;</span><span class="op" id="1800908">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800912">return</span>&nbsp;<span class="ident" id="1800919">c</span>&nbsp;<span class="op" id="1800921">-</span>&nbsp;<span class="string" id="1800923">&#39;a&#39;</span>&nbsp;<span class="op" id="1800927">+</span>&nbsp;<span class="num" id="1800929">10</span><span class="op" id="1800931">,</span>&nbsp;<span class="builtintype" id="1800933">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800939">case</span>&nbsp;<span class="string" id="1800944">&#39;A&#39;</span>&nbsp;<span class="op" id="1800948">&lt;=</span>&nbsp;<span class="ident" id="1800951">c</span>&nbsp;<span class="op" id="1800953">&amp;&amp;</span>&nbsp;<span class="ident" id="1800956">c</span>&nbsp;<span class="op" id="1800958">&lt;=</span>&nbsp;<span class="string" id="1800961">&#39;F&#39;</span><span class="op" id="1800964">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800968">return</span>&nbsp;<span class="ident" id="1800975">c</span>&nbsp;<span class="op" id="1800977">-</span>&nbsp;<span class="string" id="1800979">&#39;A&#39;</span>&nbsp;<span class="op" id="1800983">+</span>&nbsp;<span class="num" id="1800985">10</span><span class="op" id="1800987">,</span>&nbsp;<span class="builtintype" id="1800989">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1800995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1800998">return</span><br>
<span class="lineno"></span><span class="op" id="1801005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="1801008">//&nbsp;UnquoteChar&nbsp;decodes&nbsp;the&nbsp;first&nbsp;character&nbsp;or&nbsp;byte&nbsp;in&nbsp;the&nbsp;escaped&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="1801081">//&nbsp;or&nbsp;character&nbsp;literal&nbsp;represented&nbsp;by&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="1801134">//&nbsp;It&nbsp;returns&nbsp;four&nbsp;values:</span><br>
<span class="lineno"></span><span class="comment" id="1801161">//</span><br>
<span class="lineno"></span><span class="comment" id="1801164">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;value,&nbsp;the&nbsp;decoded&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;byte&nbsp;value;</span><br>
<span class="lineno">185</span><span class="comment" id="1801223">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;multibyte,&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;decoded&nbsp;character&nbsp;requires&nbsp;a&nbsp;multibyte&nbsp;UTF-8&nbsp;representation;</span><br>
<span class="lineno"></span><span class="comment" id="1801334">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;tail,&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string&nbsp;after&nbsp;the&nbsp;character;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1801399">//&nbsp;&nbsp;&nbsp;&nbsp4)&nbsp;an&nbsp;error&nbsp;that&nbsp;will&nbsp;be&nbsp;nil&nbsp;if&nbsp;the&nbsp;character&nbsp;is&nbsp;syntactically&nbsp;valid.</span><br>
<span class="lineno"></span><span class="comment" id="1801472">//</span><br>
<span class="lineno"></span><span class="comment" id="1801475">//&nbsp;The&nbsp;second&nbsp;argument,&nbsp;quote,&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;literal&nbsp;being&nbsp;parsed</span><br>
<span class="lineno">190</span><span class="comment" id="1801549">//&nbsp;and&nbsp;therefore&nbsp;which&nbsp;escaped&nbsp;quote&nbsp;character&nbsp;is&nbsp;permitted.</span><br>
<span class="lineno"></span><span class="comment" id="1801610">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;single&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;the&nbsp;sequence&nbsp;\&#39;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="1801693">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;double&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;\&#34;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="1801763">//&nbsp;If&nbsp;set&nbsp;to&nbsp;zero,&nbsp;it&nbsp;does&nbsp;not&nbsp;permit&nbsp;either&nbsp;escape&nbsp;and&nbsp;allows&nbsp;both&nbsp;quote&nbsp;characters&nbsp;to&nbsp;appear&nbsp;unescaped.</span><br>
<span class="lineno"></span><span class="keyword" id="1801869">func</span>&nbsp;<span class="ident" id="1801874">UnquoteChar</span><span class="op" id="1801885">(</span><span class="ident" id="1801886">s</span>&nbsp;<span class="builtintype" id="1801888">string</span><span class="op" id="1801894">,</span>&nbsp;<span class="ident" id="1801896">quote</span>&nbsp;<span class="builtintype" id="1801902">byte</span><span class="op" id="1801906">)</span>&nbsp;<span class="op" id="1801908">(</span><span class="ident" id="1801909">value</span>&nbsp;<span class="builtintype" id="1801915">rune</span><span class="op" id="1801919">,</span>&nbsp;<span class="ident" id="1801921">multibyte</span>&nbsp;<span class="builtintype" id="1801931">bool</span><span class="op" id="1801935">,</span>&nbsp;<span class="ident" id="1801937">tail</span>&nbsp;<span class="builtintype" id="1801942">string</span><span class="op" id="1801948">,</span>&nbsp;<span class="ident" id="1801950">err</span>&nbsp;<span class="builtintype" id="1801954">error</span><span class="op" id="1801959">)</span>&nbsp;<span class="op" id="1801961">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1801964">//&nbsp;easy&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1801979">switch</span>&nbsp;<span class="ident" id="1801986">c</span>&nbsp;<span class="op" id="1801988">:=</span>&nbsp;<span class="ident" id="1801991">s</span><span class="op" id="1801992">[</span><span class="num" id="1801993">0</span><span class="op" id="1801994">]</span><span class="op" id="1801995">;</span>&nbsp;<span class="op" id="1801997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802000">case</span>&nbsp;<span class="ident" id="1802005">c</span>&nbsp;<span class="op" id="1802007">==</span>&nbsp;<span class="ident" id="1802010">quote</span>&nbsp;<span class="op" id="1802016">&amp;&amp;</span>&nbsp;<span class="op" id="1802019">(</span><span class="ident" id="1802020">quote</span>&nbsp;<span class="op" id="1802026">==</span>&nbsp;<span class="string" id="1802029">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="1802034">||</span>&nbsp;<span class="ident" id="1802037">quote</span>&nbsp;<span class="op" id="1802043">==</span>&nbsp;<span class="string" id="1802046">&#39;&#34;&#39;</span><span class="op" id="1802049">)</span><span class="op" id="1802050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802054">err</span>&nbsp;<span class="op" id="1802058">=</span>&nbsp;<span class="ident" id="1802060">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802072">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802080">case</span>&nbsp;<span class="ident" id="1802085">c</span>&nbsp;<span class="op" id="1802087">&gt;=</span>&nbsp;<span class="ident" id="1802090">utf8</span><span class="op" id="1802094">.</span><span class="ident" id="1802095">RuneSelf</span><span class="op" id="1802103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802107">r</span><span class="op" id="1802108">,</span>&nbsp;<span class="ident" id="1802110">size</span>&nbsp;<span class="op" id="1802115">:=</span>&nbsp;<span class="ident" id="1802118">utf8</span><span class="op" id="1802122">.</span><span class="ident" id="1802123">DecodeRuneInString</span><span class="op" id="1802141">(</span><span class="ident" id="1802142">s</span><span class="op" id="1802143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802147">return</span>&nbsp;<span class="ident" id="1802154">r</span><span class="op" id="1802155">,</span>&nbsp;<span class="builtintype" id="1802157">true</span><span class="op" id="1802161">,</span>&nbsp;<span class="ident" id="1802163">s</span><span class="op" id="1802164">[</span><span class="ident" id="1802165">size</span><span class="op" id="1802169">:</span><span class="op" id="1802170">]</span><span class="op" id="1802171">,</span>&nbsp;<span class="ident" id="1802173">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802178">case</span>&nbsp;<span class="ident" id="1802183">c</span>&nbsp;<span class="op" id="1802185">!=</span>&nbsp;<span class="string" id="1802188">&#39;\\&#39;</span><span class="op" id="1802192">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802196">return</span>&nbsp;<span class="builtintype" id="1802203">rune</span><span class="op" id="1802207">(</span><span class="ident" id="1802208">s</span><span class="op" id="1802209">[</span><span class="num" id="1802210">0</span><span class="op" id="1802211">]</span><span class="op" id="1802212">)</span><span class="op" id="1802213">,</span>&nbsp;<span class="builtintype" id="1802215">false</span><span class="op" id="1802220">,</span>&nbsp;<span class="ident" id="1802222">s</span><span class="op" id="1802223">[</span><span class="num" id="1802224">1</span><span class="op" id="1802225">:</span><span class="op" id="1802226">]</span><span class="op" id="1802227">,</span>&nbsp;<span class="ident" id="1802229">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1802234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1802238">//&nbsp;hard&nbsp;case:&nbsp;c&nbsp;is&nbsp;backslash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802268">if</span>&nbsp;<span class="builtinfunc" id="1802271">len</span><span class="op" id="1802274">(</span><span class="ident" id="1802275">s</span><span class="op" id="1802276">)</span>&nbsp;<span class="op" id="1802278">&lt;=</span>&nbsp;<span class="num" id="1802281">1</span>&nbsp;<span class="op" id="1802283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802287">err</span>&nbsp;<span class="op" id="1802291">=</span>&nbsp;<span class="ident" id="1802293">ErrSyntax</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802305">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1802313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802316">c</span>&nbsp;<span class="op" id="1802318">:=</span>&nbsp;<span class="ident" id="1802321">s</span><span class="op" id="1802322">[</span><span class="num" id="1802323">1</span><span class="op" id="1802324">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802327">s</span>&nbsp;<span class="op" id="1802329">=</span>&nbsp;<span class="ident" id="1802331">s</span><span class="op" id="1802332">[</span><span class="num" id="1802333">2</span><span class="op" id="1802334">:</span><span class="op" id="1802335">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802339">switch</span>&nbsp;<span class="ident" id="1802346">c</span>&nbsp;<span class="op" id="1802348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802351">case</span>&nbsp;<span class="string" id="1802356">&#39;a&#39;</span><span class="op" id="1802359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802363">value</span>&nbsp;<span class="op" id="1802369">=</span>&nbsp;<span class="string" id="1802371">&#39;\a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802377">case</span>&nbsp;<span class="string" id="1802382">&#39;b&#39;</span><span class="op" id="1802385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802389">value</span>&nbsp;<span class="op" id="1802395">=</span>&nbsp;<span class="string" id="1802397">&#39;\b&#39;</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802403">case</span>&nbsp;<span class="string" id="1802408">&#39;f&#39;</span><span class="op" id="1802411">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802415">value</span>&nbsp;<span class="op" id="1802421">=</span>&nbsp;<span class="string" id="1802423">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802429">case</span>&nbsp;<span class="string" id="1802434">&#39;n&#39;</span><span class="op" id="1802437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802441">value</span>&nbsp;<span class="op" id="1802447">=</span>&nbsp;<span class="string" id="1802449">&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802455">case</span>&nbsp;<span class="string" id="1802460">&#39;r&#39;</span><span class="op" id="1802463">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802467">value</span>&nbsp;<span class="op" id="1802473">=</span>&nbsp;<span class="string" id="1802475">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802481">case</span>&nbsp;<span class="string" id="1802486">&#39;t&#39;</span><span class="op" id="1802489">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802493">value</span>&nbsp;<span class="op" id="1802499">=</span>&nbsp;<span class="string" id="1802501">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802507">case</span>&nbsp;<span class="string" id="1802512">&#39;v&#39;</span><span class="op" id="1802515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802519">value</span>&nbsp;<span class="op" id="1802525">=</span>&nbsp;<span class="string" id="1802527">&#39;\v&#39;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802533">case</span>&nbsp;<span class="string" id="1802538">&#39;x&#39;</span><span class="op" id="1802541">,</span>&nbsp;<span class="string" id="1802543">&#39;u&#39;</span><span class="op" id="1802546">,</span>&nbsp;<span class="string" id="1802548">&#39;U&#39;</span><span class="op" id="1802551">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802555">n</span>&nbsp;<span class="op" id="1802557">:=</span>&nbsp;<span class="num" id="1802560">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802564">switch</span>&nbsp;<span class="ident" id="1802571">c</span>&nbsp;<span class="op" id="1802573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802577">case</span>&nbsp;<span class="string" id="1802582">&#39;x&#39;</span><span class="op" id="1802585">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802590">n</span>&nbsp;<span class="op" id="1802592">=</span>&nbsp;<span class="num" id="1802594">2</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802598">case</span>&nbsp;<span class="string" id="1802603">&#39;u&#39;</span><span class="op" id="1802606">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802611">n</span>&nbsp;<span class="op" id="1802613">=</span>&nbsp;<span class="num" id="1802615">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802619">case</span>&nbsp;<span class="string" id="1802624">&#39;U&#39;</span><span class="op" id="1802627">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802632">n</span>&nbsp;<span class="op" id="1802634">=</span>&nbsp;<span class="num" id="1802636">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1802640">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802644">var</span>&nbsp;<span class="ident" id="1802648">v</span>&nbsp;<span class="builtintype" id="1802650">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802657">if</span>&nbsp;<span class="builtinfunc" id="1802660">len</span><span class="op" id="1802663">(</span><span class="ident" id="1802664">s</span><span class="op" id="1802665">)</span>&nbsp;<span class="op" id="1802667">&lt;</span>&nbsp;<span class="ident" id="1802669">n</span>&nbsp;<span class="op" id="1802671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802676">err</span>&nbsp;<span class="op" id="1802680">=</span>&nbsp;<span class="ident" id="1802682">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802695">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1802704">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802708">for</span>&nbsp;<span class="ident" id="1802712">j</span>&nbsp;<span class="op" id="1802714">:=</span>&nbsp;<span class="num" id="1802717">0</span><span class="op" id="1802718">;</span>&nbsp;<span class="ident" id="1802720">j</span>&nbsp;<span class="op" id="1802722">&lt;</span>&nbsp;<span class="ident" id="1802724">n</span><span class="op" id="1802725">;</span>&nbsp;<span class="ident" id="1802727">j</span><span class="op" id="1802728">++</span>&nbsp;<span class="op" id="1802731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802736">x</span><span class="op" id="1802737">,</span>&nbsp;<span class="ident" id="1802739">ok</span>&nbsp;<span class="op" id="1802742">:=</span>&nbsp;<span class="ident" id="1802745">unhex</span><span class="op" id="1802750">(</span><span class="ident" id="1802751">s</span><span class="op" id="1802752">[</span><span class="ident" id="1802753">j</span><span class="op" id="1802754">]</span><span class="op" id="1802755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802760">if</span>&nbsp;<span class="op" id="1802763">!</span><span class="ident" id="1802764">ok</span>&nbsp;<span class="op" id="1802767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802773">err</span>&nbsp;<span class="op" id="1802777">=</span>&nbsp;<span class="ident" id="1802779">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802793">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1802803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802808">v</span>&nbsp;<span class="op" id="1802810">=</span>&nbsp;<span class="ident" id="1802812">v</span><span class="op" id="1802813">&lt;&lt;</span><span class="num" id="1802815">4</span>&nbsp;<span class="op" id="1802817">|</span>&nbsp;<span class="ident" id="1802819">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1802823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802827">s</span>&nbsp;<span class="op" id="1802829">=</span>&nbsp;<span class="ident" id="1802831">s</span><span class="op" id="1802832">[</span><span class="ident" id="1802833">n</span><span class="op" id="1802834">:</span><span class="op" id="1802835">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802839">if</span>&nbsp;<span class="ident" id="1802842">c</span>&nbsp;<span class="op" id="1802844">==</span>&nbsp;<span class="string" id="1802847">&#39;x&#39;</span>&nbsp;<span class="op" id="1802851">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1802856">//&nbsp;single-byte&nbsp;string,&nbsp;possibly&nbsp;not&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802901">value</span>&nbsp;<span class="op" id="1802907">=</span>&nbsp;<span class="ident" id="1802909">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802914">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1802922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802926">if</span>&nbsp;<span class="ident" id="1802929">v</span>&nbsp;<span class="op" id="1802931">&gt;</span>&nbsp;<span class="ident" id="1802933">utf8</span><span class="op" id="1802937">.</span><span class="ident" id="1802938">MaxRune</span>&nbsp;<span class="op" id="1802946">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802951">err</span>&nbsp;<span class="op" id="1802955">=</span>&nbsp;<span class="ident" id="1802957">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802970">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1802979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802983">value</span>&nbsp;<span class="op" id="1802989">=</span>&nbsp;<span class="ident" id="1802991">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802995">multibyte</span>&nbsp;<span class="op" id="1803005">=</span>&nbsp;<span class="builtintype" id="1803007">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803013">case</span>&nbsp;<span class="string" id="1803018">&#39;0&#39;</span><span class="op" id="1803021">,</span>&nbsp;<span class="string" id="1803023">&#39;1&#39;</span><span class="op" id="1803026">,</span>&nbsp;<span class="string" id="1803028">&#39;2&#39;</span><span class="op" id="1803031">,</span>&nbsp;<span class="string" id="1803033">&#39;3&#39;</span><span class="op" id="1803036">,</span>&nbsp;<span class="string" id="1803038">&#39;4&#39;</span><span class="op" id="1803041">,</span>&nbsp;<span class="string" id="1803043">&#39;5&#39;</span><span class="op" id="1803046">,</span>&nbsp;<span class="string" id="1803048">&#39;6&#39;</span><span class="op" id="1803051">,</span>&nbsp;<span class="string" id="1803053">&#39;7&#39;</span><span class="op" id="1803056">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803060">v</span>&nbsp;<span class="op" id="1803062">:=</span>&nbsp;<span class="builtintype" id="1803065">rune</span><span class="op" id="1803069">(</span><span class="ident" id="1803070">c</span><span class="op" id="1803071">)</span>&nbsp;<span class="op" id="1803073">-</span>&nbsp;<span class="string" id="1803075">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803081">if</span>&nbsp;<span class="builtinfunc" id="1803084">len</span><span class="op" id="1803087">(</span><span class="ident" id="1803088">s</span><span class="op" id="1803089">)</span>&nbsp;<span class="op" id="1803091">&lt;</span>&nbsp;<span class="num" id="1803093">2</span>&nbsp;<span class="op" id="1803095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803100">err</span>&nbsp;<span class="op" id="1803104">=</span>&nbsp;<span class="ident" id="1803106">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803119">return</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1803128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803132">for</span>&nbsp;<span class="ident" id="1803136">j</span>&nbsp;<span class="op" id="1803138">:=</span>&nbsp;<span class="num" id="1803141">0</span><span class="op" id="1803142">;</span>&nbsp;<span class="ident" id="1803144">j</span>&nbsp;<span class="op" id="1803146">&lt;</span>&nbsp;<span class="num" id="1803148">2</span><span class="op" id="1803149">;</span>&nbsp;<span class="ident" id="1803151">j</span><span class="op" id="1803152">++</span>&nbsp;<span class="op" id="1803155">{</span>&nbsp;<span class="comment" id="1803157">//&nbsp;one&nbsp;digit&nbsp;already;&nbsp;two&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803191">x</span>&nbsp;<span class="op" id="1803193">:=</span>&nbsp;<span class="builtintype" id="1803196">rune</span><span class="op" id="1803200">(</span><span class="ident" id="1803201">s</span><span class="op" id="1803202">[</span><span class="ident" id="1803203">j</span><span class="op" id="1803204">]</span><span class="op" id="1803205">)</span>&nbsp;<span class="op" id="1803207">-</span>&nbsp;<span class="string" id="1803209">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803216">if</span>&nbsp;<span class="ident" id="1803219">x</span>&nbsp;<span class="op" id="1803221">&lt;</span>&nbsp;<span class="num" id="1803223">0</span>&nbsp;<span class="op" id="1803225">||</span>&nbsp;<span class="ident" id="1803228">x</span>&nbsp;<span class="op" id="1803230">&gt;</span>&nbsp;<span class="num" id="1803232">7</span>&nbsp;<span class="op" id="1803234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803240">err</span>&nbsp;<span class="op" id="1803244">=</span>&nbsp;<span class="ident" id="1803246">ErrSyntax</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803260">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1803270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803275">v</span>&nbsp;<span class="op" id="1803277">=</span>&nbsp;<span class="op" id="1803279">(</span><span class="ident" id="1803280">v</span>&nbsp;<span class="op" id="1803282">&lt;&lt;</span>&nbsp;<span class="num" id="1803285">3</span><span class="op" id="1803286">)</span>&nbsp;<span class="op" id="1803288">|</span>&nbsp;<span class="ident" id="1803290">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1803294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803298">s</span>&nbsp;<span class="op" id="1803300">=</span>&nbsp;<span class="ident" id="1803302">s</span><span class="op" id="1803303">[</span><span class="num" id="1803304">2</span><span class="op" id="1803305">:</span><span class="op" id="1803306">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803310">if</span>&nbsp;<span class="ident" id="1803313">v</span>&nbsp;<span class="op" id="1803315">&gt;</span>&nbsp;<span class="num" id="1803317">255</span>&nbsp;<span class="op" id="1803321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803326">err</span>&nbsp;<span class="op" id="1803330">=</span>&nbsp;<span class="ident" id="1803332">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803345">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1803354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803358">value</span>&nbsp;<span class="op" id="1803364">=</span>&nbsp;<span class="ident" id="1803366">v</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803369">case</span>&nbsp;<span class="string" id="1803374">&#39;\\&#39;</span><span class="op" id="1803378">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803382">value</span>&nbsp;<span class="op" id="1803388">=</span>&nbsp;<span class="string" id="1803390">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803396">case</span>&nbsp;<span class="string" id="1803401">&#39;\&#39;&#39;</span><span class="op" id="1803405">,</span>&nbsp;<span class="string" id="1803407">&#39;&#34;&#39;</span><span class="op" id="1803410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803414">if</span>&nbsp;<span class="ident" id="1803417">c</span>&nbsp;<span class="op" id="1803419">!=</span>&nbsp;<span class="ident" id="1803422">quote</span>&nbsp;<span class="op" id="1803428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803433">err</span>&nbsp;<span class="op" id="1803437">=</span>&nbsp;<span class="ident" id="1803439">ErrSyntax</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803452">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1803461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803465">value</span>&nbsp;<span class="op" id="1803471">=</span>&nbsp;<span class="builtintype" id="1803473">rune</span><span class="op" id="1803477">(</span><span class="ident" id="1803478">c</span><span class="op" id="1803479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803482">default</span><span class="op" id="1803489">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803493">err</span>&nbsp;<span class="op" id="1803497">=</span>&nbsp;<span class="ident" id="1803499">ErrSyntax</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803511">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1803519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803522">tail</span>&nbsp;<span class="op" id="1803527">=</span>&nbsp;<span class="ident" id="1803529">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803532">return</span><br>
<span class="lineno"></span><span class="op" id="1803539">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="1803542">//&nbsp;Unquote&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;double-quoted,</span><br>
<span class="lineno"></span><span class="comment" id="1803601">//&nbsp;or&nbsp;backquoted&nbsp;Go&nbsp;string&nbsp;literal,&nbsp;returning&nbsp;the&nbsp;string&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="1803664">//&nbsp;that&nbsp;s&nbsp;quotes.&nbsp;&nbsp;(If&nbsp;s&nbsp;is&nbsp;single-quoted,&nbsp;it&nbsp;would&nbsp;be&nbsp;a&nbsp;Go</span><br>
<span class="lineno"></span><span class="comment" id="1803724">//&nbsp;character&nbsp;literal;&nbsp;Unquote&nbsp;returns&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno">305</span><span class="comment" id="1803780">//&nbsp;one-character&nbsp;string.)</span><br>
<span class="lineno"></span><span class="keyword" id="1803806">func</span>&nbsp;<span class="ident" id="1803811">Unquote</span><span class="op" id="1803818">(</span><span class="ident" id="1803819">s</span>&nbsp;<span class="builtintype" id="1803821">string</span><span class="op" id="1803827">)</span>&nbsp;<span class="op" id="1803829">(</span><span class="ident" id="1803830">t</span>&nbsp;<span class="builtintype" id="1803832">string</span><span class="op" id="1803838">,</span>&nbsp;<span class="ident" id="1803840">err</span>&nbsp;<span class="builtintype" id="1803844">error</span><span class="op" id="1803849">)</span>&nbsp;<span class="op" id="1803851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803854">n</span>&nbsp;<span class="op" id="1803856">:=</span>&nbsp;<span class="builtinfunc" id="1803859">len</span><span class="op" id="1803862">(</span><span class="ident" id="1803863">s</span><span class="op" id="1803864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803867">if</span>&nbsp;<span class="ident" id="1803870">n</span>&nbsp;<span class="op" id="1803872">&lt;</span>&nbsp;<span class="num" id="1803874">2</span>&nbsp;<span class="op" id="1803876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803880">return</span>&nbsp;<span class="string" id="1803887">&#34;&#34;</span><span class="op" id="1803889">,</span>&nbsp;<span class="ident" id="1803891">ErrSyntax</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1803902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803905">quote</span>&nbsp;<span class="op" id="1803911">:=</span>&nbsp;<span class="ident" id="1803914">s</span><span class="op" id="1803915">[</span><span class="num" id="1803916">0</span><span class="op" id="1803917">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803920">if</span>&nbsp;<span class="ident" id="1803923">quote</span>&nbsp;<span class="op" id="1803929">!=</span>&nbsp;<span class="ident" id="1803932">s</span><span class="op" id="1803933">[</span><span class="ident" id="1803934">n</span><span class="op" id="1803935">-</span><span class="num" id="1803936">1</span><span class="op" id="1803937">]</span>&nbsp;<span class="op" id="1803939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803943">return</span>&nbsp;<span class="string" id="1803950">&#34;&#34;</span><span class="op" id="1803952">,</span>&nbsp;<span class="ident" id="1803954">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1803965">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803968">s</span>&nbsp;<span class="op" id="1803970">=</span>&nbsp;<span class="ident" id="1803972">s</span><span class="op" id="1803973">[</span><span class="num" id="1803974">1</span>&nbsp;<span class="op" id="1803976">:</span>&nbsp;<span class="ident" id="1803978">n</span><span class="op" id="1803979">-</span><span class="num" id="1803980">1</span><span class="op" id="1803981">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803985">if</span>&nbsp;<span class="ident" id="1803988">quote</span>&nbsp;<span class="op" id="1803994">==</span>&nbsp;<span class="string" id="1803997">&#39;`&#39;</span>&nbsp;<span class="op" id="1804001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804005">if</span>&nbsp;<span class="ident" id="1804008">contains</span><span class="op" id="1804016">(</span><span class="ident" id="1804017">s</span><span class="op" id="1804018">,</span>&nbsp;<span class="string" id="1804020">&#39;`&#39;</span><span class="op" id="1804023">)</span>&nbsp;<span class="op" id="1804025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804030">return</span>&nbsp;<span class="string" id="1804037">&#34;&#34;</span><span class="op" id="1804039">,</span>&nbsp;<span class="ident" id="1804041">ErrSyntax</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804057">return</span>&nbsp;<span class="ident" id="1804064">s</span><span class="op" id="1804065">,</span>&nbsp;<span class="ident" id="1804067">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804075">if</span>&nbsp;<span class="ident" id="1804078">quote</span>&nbsp;<span class="op" id="1804084">!=</span>&nbsp;<span class="string" id="1804087">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="1804091">&amp;&amp;</span>&nbsp;<span class="ident" id="1804094">quote</span>&nbsp;<span class="op" id="1804100">!=</span>&nbsp;<span class="string" id="1804103">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="1804108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804112">return</span>&nbsp;<span class="string" id="1804119">&#34;&#34;</span><span class="op" id="1804121">,</span>&nbsp;<span class="ident" id="1804123">ErrSyntax</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804137">if</span>&nbsp;<span class="ident" id="1804140">contains</span><span class="op" id="1804148">(</span><span class="ident" id="1804149">s</span><span class="op" id="1804150">,</span>&nbsp;<span class="string" id="1804152">&#39;\n&#39;</span><span class="op" id="1804156">)</span>&nbsp;<span class="op" id="1804158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804162">return</span>&nbsp;<span class="string" id="1804169">&#34;&#34;</span><span class="op" id="1804171">,</span>&nbsp;<span class="ident" id="1804173">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1804188">//&nbsp;Is&nbsp;it&nbsp;trivial?&nbsp;&nbsp;Avoid&nbsp;allocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804226">if</span>&nbsp;<span class="op" id="1804229">!</span><span class="ident" id="1804230">contains</span><span class="op" id="1804238">(</span><span class="ident" id="1804239">s</span><span class="op" id="1804240">,</span>&nbsp;<span class="string" id="1804242">&#39;\\&#39;</span><span class="op" id="1804246">)</span>&nbsp;<span class="op" id="1804248">&amp;&amp;</span>&nbsp;<span class="op" id="1804251">!</span><span class="ident" id="1804252">contains</span><span class="op" id="1804260">(</span><span class="ident" id="1804261">s</span><span class="op" id="1804262">,</span>&nbsp;<span class="ident" id="1804264">quote</span><span class="op" id="1804269">)</span>&nbsp;<span class="op" id="1804271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804275">switch</span>&nbsp;<span class="ident" id="1804282">quote</span>&nbsp;<span class="op" id="1804288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804292">case</span>&nbsp;<span class="string" id="1804297">&#39;&#34;&#39;</span><span class="op" id="1804300">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804305">return</span>&nbsp;<span class="ident" id="1804312">s</span><span class="op" id="1804313">,</span>&nbsp;<span class="ident" id="1804315">nil</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804321">case</span>&nbsp;<span class="string" id="1804326">&#39;\&#39;&#39;</span><span class="op" id="1804330">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1804335">r</span><span class="op" id="1804336">,</span>&nbsp;<span class="ident" id="1804338">size</span>&nbsp;<span class="op" id="1804343">:=</span>&nbsp;<span class="ident" id="1804346">utf8</span><span class="op" id="1804350">.</span><span class="ident" id="1804351">DecodeRuneInString</span><span class="op" id="1804369">(</span><span class="ident" id="1804370">s</span><span class="op" id="1804371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804376">if</span>&nbsp;<span class="ident" id="1804379">size</span>&nbsp;<span class="op" id="1804384">==</span>&nbsp;<span class="builtinfunc" id="1804387">len</span><span class="op" id="1804390">(</span><span class="ident" id="1804391">s</span><span class="op" id="1804392">)</span>&nbsp;<span class="op" id="1804394">&amp;&amp;</span>&nbsp;<span class="op" id="1804397">(</span><span class="ident" id="1804398">r</span>&nbsp;<span class="op" id="1804400">!=</span>&nbsp;<span class="ident" id="1804403">utf8</span><span class="op" id="1804407">.</span><span class="ident" id="1804408">RuneError</span>&nbsp;<span class="op" id="1804418">||</span>&nbsp;<span class="ident" id="1804421">size</span>&nbsp;<span class="op" id="1804426">!=</span>&nbsp;<span class="num" id="1804429">1</span><span class="op" id="1804430">)</span>&nbsp;<span class="op" id="1804432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804438">return</span>&nbsp;<span class="ident" id="1804445">s</span><span class="op" id="1804446">,</span>&nbsp;<span class="ident" id="1804448">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804455">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804466">var</span>&nbsp;<span class="ident" id="1804470">runeTmp</span>&nbsp;<span class="op" id="1804478">[</span><span class="ident" id="1804479">utf8</span><span class="op" id="1804483">.</span><span class="ident" id="1804484">UTFMax</span><span class="op" id="1804490">]</span><span class="builtintype" id="1804491">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1804497">buf</span>&nbsp;<span class="op" id="1804501">:=</span>&nbsp;<span class="builtinfunc" id="1804504">make</span><span class="op" id="1804508">(</span><span class="op" id="1804509">[</span><span class="op" id="1804510">]</span><span class="builtintype" id="1804511">byte</span><span class="op" id="1804515">,</span>&nbsp;<span class="num" id="1804517">0</span><span class="op" id="1804518">,</span>&nbsp;<span class="num" id="1804520">3</span><span class="op" id="1804521">*</span><span class="builtinfunc" id="1804522">len</span><span class="op" id="1804525">(</span><span class="ident" id="1804526">s</span><span class="op" id="1804527">)</span><span class="op" id="1804528">/</span><span class="num" id="1804529">2</span><span class="op" id="1804530">)</span>&nbsp;<span class="comment" id="1804532">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804567">for</span>&nbsp;<span class="builtinfunc" id="1804571">len</span><span class="op" id="1804574">(</span><span class="ident" id="1804575">s</span><span class="op" id="1804576">)</span>&nbsp;<span class="op" id="1804578">&gt;</span>&nbsp;<span class="num" id="1804580">0</span>&nbsp;<span class="op" id="1804582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1804586">c</span><span class="op" id="1804587">,</span>&nbsp;<span class="ident" id="1804589">multibyte</span><span class="op" id="1804598">,</span>&nbsp;<span class="ident" id="1804600">ss</span><span class="op" id="1804602">,</span>&nbsp;<span class="ident" id="1804604">err</span>&nbsp;<span class="op" id="1804608">:=</span>&nbsp;<span class="ident" id="1804611">UnquoteChar</span><span class="op" id="1804622">(</span><span class="ident" id="1804623">s</span><span class="op" id="1804624">,</span>&nbsp;<span class="ident" id="1804626">quote</span><span class="op" id="1804631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804635">if</span>&nbsp;<span class="ident" id="1804638">err</span>&nbsp;<span class="op" id="1804642">!=</span>&nbsp;<span class="ident" id="1804645">nil</span>&nbsp;<span class="op" id="1804649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804654">return</span>&nbsp;<span class="string" id="1804661">&#34;&#34;</span><span class="op" id="1804663">,</span>&nbsp;<span class="ident" id="1804665">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804671">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1804675">s</span>&nbsp;<span class="op" id="1804677">=</span>&nbsp;<span class="ident" id="1804679">ss</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804684">if</span>&nbsp;<span class="ident" id="1804687">c</span>&nbsp;<span class="op" id="1804689">&lt;</span>&nbsp;<span class="ident" id="1804691">utf8</span><span class="op" id="1804695">.</span><span class="ident" id="1804696">RuneSelf</span>&nbsp;<span class="op" id="1804705">||</span>&nbsp;<span class="op" id="1804708">!</span><span class="ident" id="1804709">multibyte</span>&nbsp;<span class="op" id="1804719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1804724">buf</span>&nbsp;<span class="op" id="1804728">=</span>&nbsp;<span class="builtinfunc" id="1804730">append</span><span class="op" id="1804736">(</span><span class="ident" id="1804737">buf</span><span class="op" id="1804740">,</span>&nbsp;<span class="builtintype" id="1804742">byte</span><span class="op" id="1804746">(</span><span class="ident" id="1804747">c</span><span class="op" id="1804748">)</span><span class="op" id="1804749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804753">}</span>&nbsp;<span class="keyword" id="1804755">else</span>&nbsp;<span class="op" id="1804760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1804765">n</span>&nbsp;<span class="op" id="1804767">:=</span>&nbsp;<span class="ident" id="1804770">utf8</span><span class="op" id="1804774">.</span><span class="ident" id="1804775">EncodeRune</span><span class="op" id="1804785">(</span><span class="ident" id="1804786">runeTmp</span><span class="op" id="1804793">[</span><span class="op" id="1804794">:</span><span class="op" id="1804795">]</span><span class="op" id="1804796">,</span>&nbsp;<span class="ident" id="1804798">c</span><span class="op" id="1804799">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1804804">buf</span>&nbsp;<span class="op" id="1804808">=</span>&nbsp;<span class="builtinfunc" id="1804810">append</span><span class="op" id="1804816">(</span><span class="ident" id="1804817">buf</span><span class="op" id="1804820">,</span>&nbsp;<span class="ident" id="1804822">runeTmp</span><span class="op" id="1804829">[</span><span class="op" id="1804830">:</span><span class="ident" id="1804831">n</span><span class="op" id="1804832">]</span><span class="op" id="1804833">...</span><span class="op" id="1804836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804844">if</span>&nbsp;<span class="ident" id="1804847">quote</span>&nbsp;<span class="op" id="1804853">==</span>&nbsp;<span class="string" id="1804856">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="1804861">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1804864">len</span><span class="op" id="1804867">(</span><span class="ident" id="1804868">s</span><span class="op" id="1804869">)</span>&nbsp;<span class="op" id="1804871">!=</span>&nbsp;<span class="num" id="1804874">0</span>&nbsp;<span class="op" id="1804876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1804881">//&nbsp;single-quoted&nbsp;must&nbsp;be&nbsp;single&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804926">return</span>&nbsp;<span class="string" id="1804933">&#34;&#34;</span><span class="op" id="1804935">,</span>&nbsp;<span class="ident" id="1804937">ErrSyntax</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804955">return</span>&nbsp;<span class="builtintype" id="1804962">string</span><span class="op" id="1804968">(</span><span class="ident" id="1804969">buf</span><span class="op" id="1804972">)</span><span class="op" id="1804973">,</span>&nbsp;<span class="ident" id="1804975">nil</span><br>
<span class="lineno"></span><span class="op" id="1804979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="1804982">//&nbsp;contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;contains&nbsp;the&nbsp;byte&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="1805042">func</span>&nbsp;<span class="ident" id="1805047">contains</span><span class="op" id="1805055">(</span><span class="ident" id="1805056">s</span>&nbsp;<span class="builtintype" id="1805058">string</span><span class="op" id="1805064">,</span>&nbsp;<span class="ident" id="1805066">c</span>&nbsp;<span class="builtintype" id="1805068">byte</span><span class="op" id="1805072">)</span>&nbsp;<span class="builtintype" id="1805074">bool</span>&nbsp;<span class="op" id="1805079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1805082">for</span>&nbsp;<span class="ident" id="1805086">i</span>&nbsp;<span class="op" id="1805088">:=</span>&nbsp;<span class="num" id="1805091">0</span><span class="op" id="1805092">;</span>&nbsp;<span class="ident" id="1805094">i</span>&nbsp;<span class="op" id="1805096">&lt;</span>&nbsp;<span class="builtinfunc" id="1805098">len</span><span class="op" id="1805101">(</span><span class="ident" id="1805102">s</span><span class="op" id="1805103">)</span><span class="op" id="1805104">;</span>&nbsp;<span class="ident" id="1805106">i</span><span class="op" id="1805107">++</span>&nbsp;<span class="op" id="1805110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1805114">if</span>&nbsp;<span class="ident" id="1805117">s</span><span class="op" id="1805118">[</span><span class="ident" id="1805119">i</span><span class="op" id="1805120">]</span>&nbsp;<span class="op" id="1805122">==</span>&nbsp;<span class="ident" id="1805125">c</span>&nbsp;<span class="op" id="1805127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1805132">return</span>&nbsp;<span class="builtintype" id="1805139">true</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1805146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1805149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1805152">return</span>&nbsp;<span class="builtintype" id="1805159">false</span><br>
<span class="lineno"></span><span class="op" id="1805165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="1805168">//&nbsp;bsearch16&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1805225">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch16&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="1805277">func</span>&nbsp;<span class="ident" id="1805282">bsearch16</span><span class="op" id="1805291">(</span><span class="ident" id="1805292">a</span>&nbsp;<span class="op" id="1805294">[</span><span class="op" id="1805295">]</span><span class="builtintype" id="1805296">uint16</span><span class="op" id="1805302">,</span>&nbsp;<span class="ident" id="1805304">x</span>&nbsp;<span class="builtintype" id="1805306">uint16</span><span class="op" id="1805312">)</span>&nbsp;<span class="builtintype" id="1805314">int</span>&nbsp;<span class="op" id="1805318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1805321">i</span><span class="op" id="1805322">,</span>&nbsp;<span class="ident" id="1805324">j</span>&nbsp;<span class="op" id="1805326">:=</span>&nbsp;<span class="num" id="1805329">0</span><span class="op" id="1805330">,</span>&nbsp;<span class="builtinfunc" id="1805332">len</span><span class="op" id="1805335">(</span><span class="ident" id="1805336">a</span><span class="op" id="1805337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1805340">for</span>&nbsp;<span class="ident" id="1805344">i</span>&nbsp;<span class="op" id="1805346">&lt;</span>&nbsp;<span class="ident" id="1805348">j</span>&nbsp;<span class="op" id="1805350">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1805354">h</span>&nbsp;<span class="op" id="1805356">:=</span>&nbsp;<span class="ident" id="1805359">i</span>&nbsp;<span class="op" id="1805361">+</span>&nbsp;<span class="op" id="1805363">(</span><span class="ident" id="1805364">j</span><span class="op" id="1805365">-</span><span class="ident" id="1805366">i</span><span class="op" id="1805367">)</span><span class="op" id="1805368">/</span><span class="num" id="1805369">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1805373">if</span>&nbsp;<span class="ident" id="1805376">a</span><span class="op" id="1805377">[</span><span class="ident" id="1805378">h</span><span class="op" id="1805379">]</span>&nbsp;<span class="op" id="1805381">&lt;</span>&nbsp;<span class="ident" id="1805383">x</span>&nbsp;<span class="op" id="1805385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1805390">i</span>&nbsp;<span class="op" id="1805392">=</span>&nbsp;<span class="ident" id="1805394">h</span>&nbsp;<span class="op" id="1805396">+</span>&nbsp;<span class="num" id="1805398">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1805402">}</span>&nbsp;<span class="keyword" id="1805404">else</span>&nbsp;<span class="op" id="1805409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1805414">j</span>&nbsp;<span class="op" id="1805416">=</span>&nbsp;<span class="ident" id="1805418">h</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1805422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1805425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1805428">return</span>&nbsp;<span class="ident" id="1805435">i</span><br>
<span class="lineno"></span><span class="op" id="1805437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="1805440">//&nbsp;bsearch32&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1805497">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch32&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="1805549">func</span>&nbsp;<span class="ident" id="1805554">bsearch32</span><span class="op" id="1805563">(</span><span class="ident" id="1805564">a</span>&nbsp;<span class="op" id="1805566">[</span><span class="op" id="1805567">]</span><span class="builtintype" id="1805568">uint32</span><span class="op" id="1805574">,</span>&nbsp;<span class="ident" id="1805576">x</span>&nbsp;<span class="builtintype" id="1805578">uint32</span><span class="op" id="1805584">)</span>&nbsp;<span class="builtintype" id="1805586">int</span>&nbsp;<span class="op" id="1805590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1805593">i</span><span class="op" id="1805594">,</span>&nbsp;<span class="ident" id="1805596">j</span>&nbsp;<span class="op" id="1805598">:=</span>&nbsp;<span class="num" id="1805601">0</span><span class="op" id="1805602">,</span>&nbsp;<span class="builtinfunc" id="1805604">len</span><span class="op" id="1805607">(</span><span class="ident" id="1805608">a</span><span class="op" id="1805609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1805612">for</span>&nbsp;<span class="ident" id="1805616">i</span>&nbsp;<span class="op" id="1805618">&lt;</span>&nbsp;<span class="ident" id="1805620">j</span>&nbsp;<span class="op" id="1805622">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1805626">h</span>&nbsp;<span class="op" id="1805628">:=</span>&nbsp;<span class="ident" id="1805631">i</span>&nbsp;<span class="op" id="1805633">+</span>&nbsp;<span class="op" id="1805635">(</span><span class="ident" id="1805636">j</span><span class="op" id="1805637">-</span><span class="ident" id="1805638">i</span><span class="op" id="1805639">)</span><span class="op" id="1805640">/</span><span class="num" id="1805641">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1805645">if</span>&nbsp;<span class="ident" id="1805648">a</span><span class="op" id="1805649">[</span><span class="ident" id="1805650">h</span><span class="op" id="1805651">]</span>&nbsp;<span class="op" id="1805653">&lt;</span>&nbsp;<span class="ident" id="1805655">x</span>&nbsp;<span class="op" id="1805657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1805662">i</span>&nbsp;<span class="op" id="1805664">=</span>&nbsp;<span class="ident" id="1805666">h</span>&nbsp;<span class="op" id="1805668">+</span>&nbsp;<span class="num" id="1805670">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1805674">}</span>&nbsp;<span class="keyword" id="1805676">else</span>&nbsp;<span class="op" id="1805681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1805686">j</span>&nbsp;<span class="op" id="1805688">=</span>&nbsp;<span class="ident" id="1805690">h</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1805694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1805697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1805700">return</span>&nbsp;<span class="ident" id="1805707">i</span><br>
<span class="lineno"></span><span class="op" id="1805709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="1805712">//&nbsp;TODO:&nbsp;IsPrint&nbsp;is&nbsp;a&nbsp;local&nbsp;implementation&nbsp;of&nbsp;unicode.IsPrint,&nbsp;verified&nbsp;by&nbsp;the&nbsp;tests</span><br>
<span class="lineno"></span><span class="comment" id="1805797">//&nbsp;to&nbsp;give&nbsp;the&nbsp;same&nbsp;answer.&nbsp;It&nbsp;allows&nbsp;this&nbsp;package&nbsp;not&nbsp;to&nbsp;depend&nbsp;on&nbsp;unicode,</span><br>
<span class="lineno"></span><span class="comment" id="1805874">//&nbsp;and&nbsp;therefore&nbsp;not&nbsp;pull&nbsp;in&nbsp;all&nbsp;the&nbsp;Unicode&nbsp;tables.&nbsp;If&nbsp;the&nbsp;linker&nbsp;were&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="1805953">//&nbsp;at&nbsp;tossing&nbsp;unused&nbsp;tables,&nbsp;we&nbsp;could&nbsp;get&nbsp;rid&nbsp;of&nbsp;this&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="comment" id="1806023">//&nbsp;That&nbsp;would&nbsp;be&nbsp;nice.</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="1806047">//&nbsp;IsPrint&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;defined&nbsp;as&nbsp;printable&nbsp;by&nbsp;Go,&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1806119">//&nbsp;the&nbsp;same&nbsp;definition&nbsp;as&nbsp;unicode.IsPrint:&nbsp;letters,&nbsp;numbers,&nbsp;punctuation,</span><br>
<span class="lineno"></span><span class="comment" id="1806193">//&nbsp;symbols&nbsp;and&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="1806221">func</span>&nbsp;<span class="ident" id="1806226">IsPrint</span><span class="op" id="1806233">(</span><span class="ident" id="1806234">r</span>&nbsp;<span class="builtintype" id="1806236">rune</span><span class="op" id="1806240">)</span>&nbsp;<span class="builtintype" id="1806242">bool</span>&nbsp;<span class="op" id="1806247">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1806250">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;Latin-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1806277">if</span>&nbsp;<span class="ident" id="1806280">r</span>&nbsp;<span class="op" id="1806282">&lt;=</span>&nbsp;<span class="num" id="1806285">0xFF</span>&nbsp;<span class="op" id="1806290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1806294">if</span>&nbsp;<span class="num" id="1806297">0x20</span>&nbsp;<span class="op" id="1806302">&lt;=</span>&nbsp;<span class="ident" id="1806305">r</span>&nbsp;<span class="op" id="1806307">&amp;&amp;</span>&nbsp;<span class="ident" id="1806310">r</span>&nbsp;<span class="op" id="1806312">&lt;=</span>&nbsp;<span class="num" id="1806315">0x7E</span>&nbsp;<span class="op" id="1806320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1806325">//&nbsp;All&nbsp;the&nbsp;ASCII&nbsp;is&nbsp;printable&nbsp;from&nbsp;space&nbsp;through&nbsp;DEL-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1806384">return</span>&nbsp;<span class="builtintype" id="1806391">true</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1806398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1806402">if</span>&nbsp;<span class="num" id="1806405">0xA1</span>&nbsp;<span class="op" id="1806410">&lt;=</span>&nbsp;<span class="ident" id="1806413">r</span>&nbsp;<span class="op" id="1806415">&amp;&amp;</span>&nbsp;<span class="ident" id="1806418">r</span>&nbsp;<span class="op" id="1806420">&lt;=</span>&nbsp;<span class="num" id="1806423">0xFF</span>&nbsp;<span class="op" id="1806428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1806433">//&nbsp;Similarly&nbsp;for&nbsp;&nbsp;through&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1806470">return</span>&nbsp;<span class="ident" id="1806477">r</span>&nbsp;<span class="op" id="1806479">!=</span>&nbsp;<span class="num" id="1806482">0xAD</span>&nbsp;<span class="comment" id="1806487">//&nbsp;...except&nbsp;for&nbsp;the&nbsp;bizarre&nbsp;soft&nbsp;hyphen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1806531">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1806535">return</span>&nbsp;<span class="builtintype" id="1806542">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1806549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1806553">//&nbsp;Same&nbsp;algorithm,&nbsp;either&nbsp;on&nbsp;uint16&nbsp;or&nbsp;uint32&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1806607">//&nbsp;First,&nbsp;find&nbsp;first&nbsp;i&nbsp;such&nbsp;that&nbsp;isPrint[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1806658">//&nbsp;This&nbsp;is&nbsp;the&nbsp;index&nbsp;of&nbsp;either&nbsp;the&nbsp;start&nbsp;or&nbsp;end&nbsp;of&nbsp;a&nbsp;pair&nbsp;that&nbsp;might&nbsp;span&nbsp;x.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1806736">//&nbsp;The&nbsp;start&nbsp;is&nbsp;even&nbsp;(isPrint[i&amp;^1])&nbsp;and&nbsp;the&nbsp;end&nbsp;is&nbsp;odd&nbsp;(isPrint[i|1]).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1806809">//&nbsp;If&nbsp;we&nbsp;find&nbsp;x&nbsp;in&nbsp;a&nbsp;range,&nbsp;make&nbsp;sure&nbsp;x&nbsp;is&nbsp;not&nbsp;in&nbsp;isNotPrint&nbsp;list.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1806878">if</span>&nbsp;<span class="num" id="1806881">0</span>&nbsp;<span class="op" id="1806883">&lt;=</span>&nbsp;<span class="ident" id="1806886">r</span>&nbsp;<span class="op" id="1806888">&amp;&amp;</span>&nbsp;<span class="ident" id="1806891">r</span>&nbsp;<span class="op" id="1806893">&lt;</span>&nbsp;<span class="num" id="1806895">1</span><span class="op" id="1806896">&lt;&lt;</span><span class="num" id="1806898">16</span>&nbsp;<span class="op" id="1806901">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1806905">rr</span><span class="op" id="1806907">,</span>&nbsp;<span class="ident" id="1806909">isPrint</span><span class="op" id="1806916">,</span>&nbsp;<span class="ident" id="1806918">isNotPrint</span>&nbsp;<span class="op" id="1806929">:=</span>&nbsp;<span class="builtintype" id="1806932">uint16</span><span class="op" id="1806938">(</span><span class="ident" id="1806939">r</span><span class="op" id="1806940">)</span><span class="op" id="1806941">,</span>&nbsp;<span class="ident" id="1806943">isPrint16</span><span class="op" id="1806952">,</span>&nbsp;<span class="ident" id="1806954">isNotPrint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1806969">i</span>&nbsp;<span class="op" id="1806971">:=</span>&nbsp;<span class="ident" id="1806974">bsearch16</span><span class="op" id="1806983">(</span><span class="ident" id="1806984">isPrint</span><span class="op" id="1806991">,</span>&nbsp;<span class="ident" id="1806993">rr</span><span class="op" id="1806995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1806999">if</span>&nbsp;<span class="ident" id="1807002">i</span>&nbsp;<span class="op" id="1807004">&gt;=</span>&nbsp;<span class="builtinfunc" id="1807007">len</span><span class="op" id="1807010">(</span><span class="ident" id="1807011">isPrint</span><span class="op" id="1807018">)</span>&nbsp;<span class="op" id="1807020">||</span>&nbsp;<span class="ident" id="1807023">rr</span>&nbsp;<span class="op" id="1807026">&lt;</span>&nbsp;<span class="ident" id="1807028">isPrint</span><span class="op" id="1807035">[</span><span class="ident" id="1807036">i</span><span class="op" id="1807037">&amp;^</span><span class="num" id="1807039">1</span><span class="op" id="1807040">]</span>&nbsp;<span class="op" id="1807042">||</span>&nbsp;<span class="ident" id="1807045">isPrint</span><span class="op" id="1807052">[</span><span class="ident" id="1807053">i</span><span class="op" id="1807054">|</span><span class="num" id="1807055">1</span><span class="op" id="1807056">]</span>&nbsp;<span class="op" id="1807058">&lt;</span>&nbsp;<span class="ident" id="1807060">rr</span>&nbsp;<span class="op" id="1807063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1807068">return</span>&nbsp;<span class="builtintype" id="1807075">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1807083">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1807087">j</span>&nbsp;<span class="op" id="1807089">:=</span>&nbsp;<span class="ident" id="1807092">bsearch16</span><span class="op" id="1807101">(</span><span class="ident" id="1807102">isNotPrint</span><span class="op" id="1807112">,</span>&nbsp;<span class="ident" id="1807114">rr</span><span class="op" id="1807116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1807120">return</span>&nbsp;<span class="ident" id="1807127">j</span>&nbsp;<span class="op" id="1807129">&gt;=</span>&nbsp;<span class="builtinfunc" id="1807132">len</span><span class="op" id="1807135">(</span><span class="ident" id="1807136">isNotPrint</span><span class="op" id="1807146">)</span>&nbsp;<span class="op" id="1807148">||</span>&nbsp;<span class="ident" id="1807151">isNotPrint</span><span class="op" id="1807161">[</span><span class="ident" id="1807162">j</span><span class="op" id="1807163">]</span>&nbsp;<span class="op" id="1807165">!=</span>&nbsp;<span class="ident" id="1807168">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1807172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1807176">rr</span><span class="op" id="1807178">,</span>&nbsp;<span class="ident" id="1807180">isPrint</span><span class="op" id="1807187">,</span>&nbsp;<span class="ident" id="1807189">isNotPrint</span>&nbsp;<span class="op" id="1807200">:=</span>&nbsp;<span class="builtintype" id="1807203">uint32</span><span class="op" id="1807209">(</span><span class="ident" id="1807210">r</span><span class="op" id="1807211">)</span><span class="op" id="1807212">,</span>&nbsp;<span class="ident" id="1807214">isPrint32</span><span class="op" id="1807223">,</span>&nbsp;<span class="ident" id="1807225">isNotPrint32</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1807239">i</span>&nbsp;<span class="op" id="1807241">:=</span>&nbsp;<span class="ident" id="1807244">bsearch32</span><span class="op" id="1807253">(</span><span class="ident" id="1807254">isPrint</span><span class="op" id="1807261">,</span>&nbsp;<span class="ident" id="1807263">rr</span><span class="op" id="1807265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1807268">if</span>&nbsp;<span class="ident" id="1807271">i</span>&nbsp;<span class="op" id="1807273">&gt;=</span>&nbsp;<span class="builtinfunc" id="1807276">len</span><span class="op" id="1807279">(</span><span class="ident" id="1807280">isPrint</span><span class="op" id="1807287">)</span>&nbsp;<span class="op" id="1807289">||</span>&nbsp;<span class="ident" id="1807292">rr</span>&nbsp;<span class="op" id="1807295">&lt;</span>&nbsp;<span class="ident" id="1807297">isPrint</span><span class="op" id="1807304">[</span><span class="ident" id="1807305">i</span><span class="op" id="1807306">&amp;^</span><span class="num" id="1807308">1</span><span class="op" id="1807309">]</span>&nbsp;<span class="op" id="1807311">||</span>&nbsp;<span class="ident" id="1807314">isPrint</span><span class="op" id="1807321">[</span><span class="ident" id="1807322">i</span><span class="op" id="1807323">|</span><span class="num" id="1807324">1</span><span class="op" id="1807325">]</span>&nbsp;<span class="op" id="1807327">&lt;</span>&nbsp;<span class="ident" id="1807329">rr</span>&nbsp;<span class="op" id="1807332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1807336">return</span>&nbsp;<span class="builtintype" id="1807343">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1807350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1807353">if</span>&nbsp;<span class="ident" id="1807356">r</span>&nbsp;<span class="op" id="1807358">&gt;=</span>&nbsp;<span class="num" id="1807361">0x20000</span>&nbsp;<span class="op" id="1807369">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1807373">return</span>&nbsp;<span class="builtintype" id="1807380">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1807386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1807389">r</span>&nbsp;<span class="op" id="1807391">-=</span>&nbsp;<span class="num" id="1807394">0x10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1807403">j</span>&nbsp;<span class="op" id="1807405">:=</span>&nbsp;<span class="ident" id="1807408">bsearch16</span><span class="op" id="1807417">(</span><span class="ident" id="1807418">isNotPrint</span><span class="op" id="1807428">,</span>&nbsp;<span class="builtintype" id="1807430">uint16</span><span class="op" id="1807436">(</span><span class="ident" id="1807437">r</span><span class="op" id="1807438">)</span><span class="op" id="1807439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1807442">return</span>&nbsp;<span class="ident" id="1807449">j</span>&nbsp;<span class="op" id="1807451">&gt;=</span>&nbsp;<span class="builtinfunc" id="1807454">len</span><span class="op" id="1807457">(</span><span class="ident" id="1807458">isNotPrint</span><span class="op" id="1807468">)</span>&nbsp;<span class="op" id="1807470">||</span>&nbsp;<span class="ident" id="1807473">isNotPrint</span><span class="op" id="1807483">[</span><span class="ident" id="1807484">j</span><span class="op" id="1807485">]</span>&nbsp;<span class="op" id="1807487">!=</span>&nbsp;<span class="builtintype" id="1807490">uint16</span><span class="op" id="1807496">(</span><span class="ident" id="1807497">r</span><span class="op" id="1807498">)</span><br>
<span class="lineno">455</span><span class="op" id="1807500">}</span>
</div>
</body>
</html>
