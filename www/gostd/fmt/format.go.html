<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2232773">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2232828">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2232882">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2232933">package</span>&nbsp;<span class="ident" id="2232941">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232946">import</span>&nbsp;<span class="op" id="2232953">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2232956">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2232964">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2232975">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2232990">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232993">const</span>&nbsp;<span class="op" id="2232999">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233002">//&nbsp;%b&nbsp;of&nbsp;an&nbsp;int64,&nbsp;plus&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233035">//&nbsp;Hex&nbsp;can&nbsp;add&nbsp;0x&nbsp;and&nbsp;we&nbsp;handle&nbsp;it&nbsp;specially.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233082">nByte</span>&nbsp;<span class="op" id="2233088">=</span>&nbsp;<span class="num" id="2233090">65</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233095">ldigits</span>&nbsp;<span class="op" id="2233103">=</span>&nbsp;<span class="string" id="2233105">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233125">udigits</span>&nbsp;<span class="op" id="2233133">=</span>&nbsp;<span class="string" id="2233135">&#34;0123456789ABCDEF&#34;</span><br>
<span class="lineno">20</span><span class="op" id="2233154">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2233157">const</span>&nbsp;<span class="op" id="2233163">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233166">signed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2233175">=</span>&nbsp;<span class="builtintype" id="2233177">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233183">unsigned</span>&nbsp;<span class="op" id="2233192">=</span>&nbsp;<span class="builtintype" id="2233194">false</span><br>
<span class="lineno">25</span><span class="op" id="2233200">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2233203">var</span>&nbsp;<span class="ident" id="2233207">padZeroBytes</span>&nbsp;<span class="op" id="2233220">=</span>&nbsp;<span class="builtinfunc" id="2233222">make</span><span class="op" id="2233226">(</span><span class="op" id="2233227">[</span><span class="op" id="2233228">]</span><span class="builtintype" id="2233229">byte</span><span class="op" id="2233233">,</span>&nbsp;<span class="ident" id="2233235">nByte</span><span class="op" id="2233240">)</span><br>
<span class="lineno"></span><span class="keyword" id="2233242">var</span>&nbsp;<span class="ident" id="2233246">padSpaceBytes</span>&nbsp;<span class="op" id="2233260">=</span>&nbsp;<span class="builtinfunc" id="2233262">make</span><span class="op" id="2233266">(</span><span class="op" id="2233267">[</span><span class="op" id="2233268">]</span><span class="builtintype" id="2233269">byte</span><span class="op" id="2233273">,</span>&nbsp;<span class="ident" id="2233275">nByte</span><span class="op" id="2233280">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="2233283">func</span>&nbsp;<span class="ident" id="2233288">init</span><span class="op" id="2233292">(</span><span class="op" id="2233293">)</span>&nbsp;<span class="op" id="2233295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233298">for</span>&nbsp;<span class="ident" id="2233302">i</span>&nbsp;<span class="op" id="2233304">:=</span>&nbsp;<span class="num" id="2233307">0</span><span class="op" id="2233308">;</span>&nbsp;<span class="ident" id="2233310">i</span>&nbsp;<span class="op" id="2233312">&lt;</span>&nbsp;<span class="ident" id="2233314">nByte</span><span class="op" id="2233319">;</span>&nbsp;<span class="ident" id="2233321">i</span><span class="op" id="2233322">++</span>&nbsp;<span class="op" id="2233325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233329">padZeroBytes</span><span class="op" id="2233341">[</span><span class="ident" id="2233342">i</span><span class="op" id="2233343">]</span>&nbsp;<span class="op" id="2233345">=</span>&nbsp;<span class="string" id="2233347">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233353">padSpaceBytes</span><span class="op" id="2233366">[</span><span class="ident" id="2233367">i</span><span class="op" id="2233368">]</span>&nbsp;<span class="op" id="2233370">=</span>&nbsp;<span class="string" id="2233372">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233377">}</span><br>
<span class="lineno">35</span><span class="op" id="2233379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2233382">//&nbsp;flags&nbsp;placed&nbsp;in&nbsp;a&nbsp;separate&nbsp;struct&nbsp;for&nbsp;easy&nbsp;clearing.</span><br>
<span class="lineno"></span><span class="keyword" id="2233438">type</span>&nbsp;<span class="ident" id="2233443">fmtFlags</span>&nbsp;<span class="keyword" id="2233452">struct</span>&nbsp;<span class="op" id="2233459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233462">widPresent</span>&nbsp;&nbsp;<span class="builtintype" id="2233474">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233480">precPresent</span>&nbsp;<span class="builtintype" id="2233492">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233498">minus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2233510">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233516">plus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2233528">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233534">sharp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2233546">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233552">space</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2233564">bool</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233570">unicode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2233582">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233588">uniQuote</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2233600">bool</span>&nbsp;<span class="comment" id="2233605">//&nbsp;Use&nbsp;&#39;x&#39;=&nbsp;prefix&nbsp;for&nbsp;%U&nbsp;if&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233646">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2233658">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233665">//&nbsp;For&nbsp;the&nbsp;formats&nbsp;%+v&nbsp;%#v,&nbsp;we&nbsp;set&nbsp;the&nbsp;plusV/sharpV&nbsp;flags</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233724">//&nbsp;and&nbsp;clear&nbsp;the&nbsp;plus/sharp&nbsp;flags&nbsp;since&nbsp;%+v&nbsp;and&nbsp;%#v&nbsp;are&nbsp;in&nbsp;effect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233791">//&nbsp;different,&nbsp;flagless&nbsp;formats&nbsp;set&nbsp;at&nbsp;the&nbsp;top&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233845">plusV</span>&nbsp;&nbsp;<span class="builtintype" id="2233852">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233858">sharpV</span>&nbsp;<span class="builtintype" id="2233865">bool</span><br>
<span class="lineno"></span><span class="op" id="2233870">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2233873">//&nbsp;A&nbsp;fmt&nbsp;is&nbsp;the&nbsp;raw&nbsp;formatter&nbsp;used&nbsp;by&nbsp;Printf&nbsp;etc.</span><br>
<span class="lineno"></span><span class="comment" id="2233923">//&nbsp;It&nbsp;prints&nbsp;into&nbsp;a&nbsp;buffer&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="2233982">type</span>&nbsp;<span class="ident" id="2233987">fmt</span>&nbsp;<span class="keyword" id="2233991">struct</span>&nbsp;<span class="op" id="2233998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234001">intbuf</span>&nbsp;<span class="op" id="2234008">[</span><span class="ident" id="2234009">nByte</span><span class="op" id="2234014">]</span><span class="builtintype" id="2234015">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234021">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2234028">*</span><span class="ident" id="2234029">buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2234037">//&nbsp;width,&nbsp;precision</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234058">wid</span>&nbsp;&nbsp;<span class="builtintype" id="2234063">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234068">prec</span>&nbsp;<span class="builtintype" id="2234073">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234078">fmtFlags</span><br>
<span class="lineno">65</span><span class="op" id="2234087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2234090">func</span>&nbsp;<span class="op" id="2234095">(</span><span class="ident" id="2234096">f</span>&nbsp;<span class="op" id="2234098">*</span><span class="ident" id="2234099">fmt</span><span class="op" id="2234102">)</span>&nbsp;<span class="ident" id="2234104">clearflags</span><span class="op" id="2234114">(</span><span class="op" id="2234115">)</span>&nbsp;<span class="op" id="2234117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234120">f</span><span class="op" id="2234121">.</span><span class="ident" id="2234122">fmtFlags</span>&nbsp;<span class="op" id="2234131">=</span>&nbsp;<span class="ident" id="2234133">fmtFlags</span><span class="op" id="2234141">{</span><span class="op" id="2234142">}</span><br>
<span class="lineno"></span><span class="op" id="2234144">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2234147">func</span>&nbsp;<span class="op" id="2234152">(</span><span class="ident" id="2234153">f</span>&nbsp;<span class="op" id="2234155">*</span><span class="ident" id="2234156">fmt</span><span class="op" id="2234159">)</span>&nbsp;<span class="ident" id="2234161">init</span><span class="op" id="2234165">(</span><span class="ident" id="2234166">buf</span>&nbsp;<span class="op" id="2234170">*</span><span class="ident" id="2234171">buffer</span><span class="op" id="2234177">)</span>&nbsp;<span class="op" id="2234179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234182">f</span><span class="op" id="2234183">.</span><span class="ident" id="2234184">buf</span>&nbsp;<span class="op" id="2234188">=</span>&nbsp;<span class="ident" id="2234190">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234195">f</span><span class="op" id="2234196">.</span><span class="ident" id="2234197">clearflags</span><span class="op" id="2234207">(</span><span class="op" id="2234208">)</span><br>
<span class="lineno"></span><span class="op" id="2234210">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2234213">//&nbsp;computePadding&nbsp;computes&nbsp;left&nbsp;and&nbsp;right&nbsp;padding&nbsp;widths&nbsp;(only&nbsp;one&nbsp;will&nbsp;be&nbsp;non-zero).</span><br>
<span class="lineno"></span><span class="keyword" id="2234299">func</span>&nbsp;<span class="op" id="2234304">(</span><span class="ident" id="2234305">f</span>&nbsp;<span class="op" id="2234307">*</span><span class="ident" id="2234308">fmt</span><span class="op" id="2234311">)</span>&nbsp;<span class="ident" id="2234313">computePadding</span><span class="op" id="2234327">(</span><span class="ident" id="2234328">width</span>&nbsp;<span class="builtintype" id="2234334">int</span><span class="op" id="2234337">)</span>&nbsp;<span class="op" id="2234339">(</span><span class="ident" id="2234340">padding</span>&nbsp;<span class="op" id="2234348">[</span><span class="op" id="2234349">]</span><span class="builtintype" id="2234350">byte</span><span class="op" id="2234354">,</span>&nbsp;<span class="ident" id="2234356">leftWidth</span><span class="op" id="2234365">,</span>&nbsp;<span class="ident" id="2234367">rightWidth</span>&nbsp;<span class="builtintype" id="2234378">int</span><span class="op" id="2234381">)</span>&nbsp;<span class="op" id="2234383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234386">left</span>&nbsp;<span class="op" id="2234391">:=</span>&nbsp;<span class="op" id="2234394">!</span><span class="ident" id="2234395">f</span><span class="op" id="2234396">.</span><span class="ident" id="2234397">minus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234404">w</span>&nbsp;<span class="op" id="2234406">:=</span>&nbsp;<span class="ident" id="2234409">f</span><span class="op" id="2234410">.</span><span class="ident" id="2234411">wid</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234416">if</span>&nbsp;<span class="ident" id="2234419">w</span>&nbsp;<span class="op" id="2234421">&lt;</span>&nbsp;<span class="num" id="2234423">0</span>&nbsp;<span class="op" id="2234425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234429">left</span>&nbsp;<span class="op" id="2234434">=</span>&nbsp;<span class="builtintype" id="2234436">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234444">w</span>&nbsp;<span class="op" id="2234446">=</span>&nbsp;<span class="op" id="2234448">-</span><span class="ident" id="2234449">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234455">w</span>&nbsp;<span class="op" id="2234457">-=</span>&nbsp;<span class="ident" id="2234460">width</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234467">if</span>&nbsp;<span class="ident" id="2234470">w</span>&nbsp;<span class="op" id="2234472">&gt;</span>&nbsp;<span class="num" id="2234474">0</span>&nbsp;<span class="op" id="2234476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234480">if</span>&nbsp;<span class="ident" id="2234483">left</span>&nbsp;<span class="op" id="2234488">&amp;&amp;</span>&nbsp;<span class="ident" id="2234491">f</span><span class="op" id="2234492">.</span><span class="ident" id="2234493">zero</span>&nbsp;<span class="op" id="2234498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234503">return</span>&nbsp;<span class="ident" id="2234510">padZeroBytes</span><span class="op" id="2234522">,</span>&nbsp;<span class="ident" id="2234524">w</span><span class="op" id="2234525">,</span>&nbsp;<span class="num" id="2234527">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234535">if</span>&nbsp;<span class="ident" id="2234538">left</span>&nbsp;<span class="op" id="2234543">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234548">return</span>&nbsp;<span class="ident" id="2234555">padSpaceBytes</span><span class="op" id="2234568">,</span>&nbsp;<span class="ident" id="2234570">w</span><span class="op" id="2234571">,</span>&nbsp;<span class="num" id="2234573">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234577">}</span>&nbsp;<span class="keyword" id="2234579">else</span>&nbsp;<span class="op" id="2234584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2234589">//&nbsp;can&#39;t&nbsp;be&nbsp;zero&nbsp;padding&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234630">return</span>&nbsp;<span class="ident" id="2234637">padSpaceBytes</span><span class="op" id="2234650">,</span>&nbsp;<span class="num" id="2234652">0</span><span class="op" id="2234653">,</span>&nbsp;<span class="ident" id="2234655">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234659">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234665">return</span><br>
<span class="lineno"></span><span class="op" id="2234672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2234675">//&nbsp;writePadding&nbsp;generates&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding.</span><br>
<span class="lineno">100</span><span class="keyword" id="2234721">func</span>&nbsp;<span class="op" id="2234726">(</span><span class="ident" id="2234727">f</span>&nbsp;<span class="op" id="2234729">*</span><span class="ident" id="2234730">fmt</span><span class="op" id="2234733">)</span>&nbsp;<span class="ident" id="2234735">writePadding</span><span class="op" id="2234747">(</span><span class="ident" id="2234748">n</span>&nbsp;<span class="builtintype" id="2234750">int</span><span class="op" id="2234753">,</span>&nbsp;<span class="ident" id="2234755">padding</span>&nbsp;<span class="op" id="2234763">[</span><span class="op" id="2234764">]</span><span class="builtintype" id="2234765">byte</span><span class="op" id="2234769">)</span>&nbsp;<span class="op" id="2234771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234774">for</span>&nbsp;<span class="ident" id="2234778">n</span>&nbsp;<span class="op" id="2234780">&gt;</span>&nbsp;<span class="num" id="2234782">0</span>&nbsp;<span class="op" id="2234784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234788">m</span>&nbsp;<span class="op" id="2234790">:=</span>&nbsp;<span class="ident" id="2234793">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234797">if</span>&nbsp;<span class="ident" id="2234800">m</span>&nbsp;<span class="op" id="2234802">&gt;</span>&nbsp;<span class="ident" id="2234804">nByte</span>&nbsp;<span class="op" id="2234810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234815">m</span>&nbsp;<span class="op" id="2234817">=</span>&nbsp;<span class="ident" id="2234819">nByte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234831">f</span><span class="op" id="2234832">.</span><span class="ident" id="2234833">buf</span><span class="op" id="2234836">.</span><span class="ident" id="2234837">Write</span><span class="op" id="2234842">(</span><span class="ident" id="2234843">padding</span><span class="op" id="2234850">[</span><span class="num" id="2234851">0</span><span class="op" id="2234852">:</span><span class="ident" id="2234853">m</span><span class="op" id="2234854">]</span><span class="op" id="2234855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234859">n</span>&nbsp;<span class="op" id="2234861">-=</span>&nbsp;<span class="ident" id="2234864">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234867">}</span><br>
<span class="lineno"></span><span class="op" id="2234869">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2234872">//&nbsp;pad&nbsp;appends&nbsp;b&nbsp;to&nbsp;f.buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2234951">func</span>&nbsp;<span class="op" id="2234956">(</span><span class="ident" id="2234957">f</span>&nbsp;<span class="op" id="2234959">*</span><span class="ident" id="2234960">fmt</span><span class="op" id="2234963">)</span>&nbsp;<span class="ident" id="2234965">pad</span><span class="op" id="2234968">(</span><span class="ident" id="2234969">b</span>&nbsp;<span class="op" id="2234971">[</span><span class="op" id="2234972">]</span><span class="builtintype" id="2234973">byte</span><span class="op" id="2234977">)</span>&nbsp;<span class="op" id="2234979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234982">if</span>&nbsp;<span class="op" id="2234985">!</span><span class="ident" id="2234986">f</span><span class="op" id="2234987">.</span><span class="ident" id="2234988">widPresent</span>&nbsp;<span class="op" id="2234999">||</span>&nbsp;<span class="ident" id="2235002">f</span><span class="op" id="2235003">.</span><span class="ident" id="2235004">wid</span>&nbsp;<span class="op" id="2235008">==</span>&nbsp;<span class="num" id="2235011">0</span>&nbsp;<span class="op" id="2235013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235017">f</span><span class="op" id="2235018">.</span><span class="ident" id="2235019">buf</span><span class="op" id="2235022">.</span><span class="ident" id="2235023">Write</span><span class="op" id="2235028">(</span><span class="ident" id="2235029">b</span><span class="op" id="2235030">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235034">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235045">padding</span><span class="op" id="2235052">,</span>&nbsp;<span class="ident" id="2235054">left</span><span class="op" id="2235058">,</span>&nbsp;<span class="ident" id="2235060">right</span>&nbsp;<span class="op" id="2235066">:=</span>&nbsp;<span class="ident" id="2235069">f</span><span class="op" id="2235070">.</span><span class="ident" id="2235071">computePadding</span><span class="op" id="2235085">(</span><span class="ident" id="2235086">utf8</span><span class="op" id="2235090">.</span><span class="ident" id="2235091">RuneCount</span><span class="op" id="2235100">(</span><span class="ident" id="2235101">b</span><span class="op" id="2235102">)</span><span class="op" id="2235103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235106">if</span>&nbsp;<span class="ident" id="2235109">left</span>&nbsp;<span class="op" id="2235114">&gt;</span>&nbsp;<span class="num" id="2235116">0</span>&nbsp;<span class="op" id="2235118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235122">f</span><span class="op" id="2235123">.</span><span class="ident" id="2235124">writePadding</span><span class="op" id="2235136">(</span><span class="ident" id="2235137">left</span><span class="op" id="2235141">,</span>&nbsp;<span class="ident" id="2235143">padding</span><span class="op" id="2235150">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235156">f</span><span class="op" id="2235157">.</span><span class="ident" id="2235158">buf</span><span class="op" id="2235161">.</span><span class="ident" id="2235162">Write</span><span class="op" id="2235167">(</span><span class="ident" id="2235168">b</span><span class="op" id="2235169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235172">if</span>&nbsp;<span class="ident" id="2235175">right</span>&nbsp;<span class="op" id="2235181">&gt;</span>&nbsp;<span class="num" id="2235183">0</span>&nbsp;<span class="op" id="2235185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235189">f</span><span class="op" id="2235190">.</span><span class="ident" id="2235191">writePadding</span><span class="op" id="2235203">(</span><span class="ident" id="2235204">right</span><span class="op" id="2235209">,</span>&nbsp;<span class="ident" id="2235211">padding</span><span class="op" id="2235218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235221">}</span><br>
<span class="lineno">125</span><span class="op" id="2235223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2235226">//&nbsp;padString&nbsp;appends&nbsp;s&nbsp;to&nbsp;buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2235309">func</span>&nbsp;<span class="op" id="2235314">(</span><span class="ident" id="2235315">f</span>&nbsp;<span class="op" id="2235317">*</span><span class="ident" id="2235318">fmt</span><span class="op" id="2235321">)</span>&nbsp;<span class="ident" id="2235323">padString</span><span class="op" id="2235332">(</span><span class="ident" id="2235333">s</span>&nbsp;<span class="builtintype" id="2235335">string</span><span class="op" id="2235341">)</span>&nbsp;<span class="op" id="2235343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235346">if</span>&nbsp;<span class="op" id="2235349">!</span><span class="ident" id="2235350">f</span><span class="op" id="2235351">.</span><span class="ident" id="2235352">widPresent</span>&nbsp;<span class="op" id="2235363">||</span>&nbsp;<span class="ident" id="2235366">f</span><span class="op" id="2235367">.</span><span class="ident" id="2235368">wid</span>&nbsp;<span class="op" id="2235372">==</span>&nbsp;<span class="num" id="2235375">0</span>&nbsp;<span class="op" id="2235377">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235381">f</span><span class="op" id="2235382">.</span><span class="ident" id="2235383">buf</span><span class="op" id="2235386">.</span><span class="ident" id="2235387">WriteString</span><span class="op" id="2235398">(</span><span class="ident" id="2235399">s</span><span class="op" id="2235400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235404">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235415">padding</span><span class="op" id="2235422">,</span>&nbsp;<span class="ident" id="2235424">left</span><span class="op" id="2235428">,</span>&nbsp;<span class="ident" id="2235430">right</span>&nbsp;<span class="op" id="2235436">:=</span>&nbsp;<span class="ident" id="2235439">f</span><span class="op" id="2235440">.</span><span class="ident" id="2235441">computePadding</span><span class="op" id="2235455">(</span><span class="ident" id="2235456">utf8</span><span class="op" id="2235460">.</span><span class="ident" id="2235461">RuneCountInString</span><span class="op" id="2235478">(</span><span class="ident" id="2235479">s</span><span class="op" id="2235480">)</span><span class="op" id="2235481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235484">if</span>&nbsp;<span class="ident" id="2235487">left</span>&nbsp;<span class="op" id="2235492">&gt;</span>&nbsp;<span class="num" id="2235494">0</span>&nbsp;<span class="op" id="2235496">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235500">f</span><span class="op" id="2235501">.</span><span class="ident" id="2235502">writePadding</span><span class="op" id="2235514">(</span><span class="ident" id="2235515">left</span><span class="op" id="2235519">,</span>&nbsp;<span class="ident" id="2235521">padding</span><span class="op" id="2235528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235534">f</span><span class="op" id="2235535">.</span><span class="ident" id="2235536">buf</span><span class="op" id="2235539">.</span><span class="ident" id="2235540">WriteString</span><span class="op" id="2235551">(</span><span class="ident" id="2235552">s</span><span class="op" id="2235553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235556">if</span>&nbsp;<span class="ident" id="2235559">right</span>&nbsp;<span class="op" id="2235565">&gt;</span>&nbsp;<span class="num" id="2235567">0</span>&nbsp;<span class="op" id="2235569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235573">f</span><span class="op" id="2235574">.</span><span class="ident" id="2235575">writePadding</span><span class="op" id="2235587">(</span><span class="ident" id="2235588">right</span><span class="op" id="2235593">,</span>&nbsp;<span class="ident" id="2235595">padding</span><span class="op" id="2235602">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235605">}</span><br>
<span class="lineno"></span><span class="op" id="2235607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2235610">var</span>&nbsp;<span class="op" id="2235614">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235617">trueBytes</span>&nbsp;&nbsp;<span class="op" id="2235628">=</span>&nbsp;<span class="op" id="2235630">[</span><span class="op" id="2235631">]</span><span class="builtintype" id="2235632">byte</span><span class="op" id="2235636">(</span><span class="string" id="2235637">&#34;true&#34;</span><span class="op" id="2235643">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235646">falseBytes</span>&nbsp;<span class="op" id="2235657">=</span>&nbsp;<span class="op" id="2235659">[</span><span class="op" id="2235660">]</span><span class="builtintype" id="2235661">byte</span><span class="op" id="2235665">(</span><span class="string" id="2235666">&#34;false&#34;</span><span class="op" id="2235673">)</span><br>
<span class="lineno"></span><span class="op" id="2235675">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2235678">//&nbsp;fmt_boolean&nbsp;formats&nbsp;a&nbsp;boolean.</span><br>
<span class="lineno"></span><span class="keyword" id="2235712">func</span>&nbsp;<span class="op" id="2235717">(</span><span class="ident" id="2235718">f</span>&nbsp;<span class="op" id="2235720">*</span><span class="ident" id="2235721">fmt</span><span class="op" id="2235724">)</span>&nbsp;<span class="ident" id="2235726">fmt_boolean</span><span class="op" id="2235737">(</span><span class="ident" id="2235738">v</span>&nbsp;<span class="builtintype" id="2235740">bool</span><span class="op" id="2235744">)</span>&nbsp;<span class="op" id="2235746">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235749">if</span>&nbsp;<span class="ident" id="2235752">v</span>&nbsp;<span class="op" id="2235754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235758">f</span><span class="op" id="2235759">.</span><span class="ident" id="2235760">pad</span><span class="op" id="2235763">(</span><span class="ident" id="2235764">trueBytes</span><span class="op" id="2235773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235776">}</span>&nbsp;<span class="keyword" id="2235778">else</span>&nbsp;<span class="op" id="2235783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235787">f</span><span class="op" id="2235788">.</span><span class="ident" id="2235789">pad</span><span class="op" id="2235792">(</span><span class="ident" id="2235793">falseBytes</span><span class="op" id="2235803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235806">}</span><br>
<span class="lineno">155</span><span class="op" id="2235808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2235811">//&nbsp;integer;&nbsp;interprets&nbsp;prec&nbsp;but&nbsp;not&nbsp;wid.&nbsp;&nbsp;Once&nbsp;formatted,&nbsp;result&nbsp;is&nbsp;sent&nbsp;to&nbsp;pad()</span><br>
<span class="lineno"></span><span class="comment" id="2235893">//&nbsp;and&nbsp;then&nbsp;flags&nbsp;are&nbsp;cleared.</span><br>
<span class="lineno"></span><span class="keyword" id="2235924">func</span>&nbsp;<span class="op" id="2235929">(</span><span class="ident" id="2235930">f</span>&nbsp;<span class="op" id="2235932">*</span><span class="ident" id="2235933">fmt</span><span class="op" id="2235936">)</span>&nbsp;<span class="ident" id="2235938">integer</span><span class="op" id="2235945">(</span><span class="ident" id="2235946">a</span>&nbsp;<span class="ident" id="2235948">int64</span><span class="op" id="2235953">,</span>&nbsp;<span class="ident" id="2235955">base</span>&nbsp;<span class="ident" id="2235960">uint64</span><span class="op" id="2235966">,</span>&nbsp;<span class="ident" id="2235968">signedness</span>&nbsp;<span class="builtintype" id="2235979">bool</span><span class="op" id="2235983">,</span>&nbsp;<span class="ident" id="2235985">digits</span>&nbsp;<span class="builtintype" id="2235992">string</span><span class="op" id="2235998">)</span>&nbsp;<span class="op" id="2236000">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236003">//&nbsp;precision&nbsp;of&nbsp;0&nbsp;and&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;&#34;print&nbsp;nothing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236059">if</span>&nbsp;<span class="ident" id="2236062">f</span><span class="op" id="2236063">.</span><span class="ident" id="2236064">precPresent</span>&nbsp;<span class="op" id="2236076">&amp;&amp;</span>&nbsp;<span class="ident" id="2236079">f</span><span class="op" id="2236080">.</span><span class="ident" id="2236081">prec</span>&nbsp;<span class="op" id="2236086">==</span>&nbsp;<span class="num" id="2236089">0</span>&nbsp;<span class="op" id="2236091">&amp;&amp;</span>&nbsp;<span class="ident" id="2236094">a</span>&nbsp;<span class="op" id="2236096">==</span>&nbsp;<span class="num" id="2236099">0</span>&nbsp;<span class="op" id="2236101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236105">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236117">var</span>&nbsp;<span class="ident" id="2236121">buf</span>&nbsp;<span class="op" id="2236125">[</span><span class="op" id="2236126">]</span><span class="builtintype" id="2236127">byte</span>&nbsp;<span class="op" id="2236132">=</span>&nbsp;<span class="ident" id="2236134">f</span><span class="op" id="2236135">.</span><span class="ident" id="2236136">intbuf</span><span class="op" id="2236142">[</span><span class="num" id="2236143">0</span><span class="op" id="2236144">:</span><span class="op" id="2236145">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236148">if</span>&nbsp;<span class="ident" id="2236151">f</span><span class="op" id="2236152">.</span><span class="ident" id="2236153">widPresent</span>&nbsp;<span class="op" id="2236164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236168">width</span>&nbsp;<span class="op" id="2236174">:=</span>&nbsp;<span class="ident" id="2236177">f</span><span class="op" id="2236178">.</span><span class="ident" id="2236179">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236185">if</span>&nbsp;<span class="ident" id="2236188">base</span>&nbsp;<span class="op" id="2236193">==</span>&nbsp;<span class="num" id="2236196">16</span>&nbsp;<span class="op" id="2236199">&amp;&amp;</span>&nbsp;<span class="ident" id="2236202">f</span><span class="op" id="2236203">.</span><span class="ident" id="2236204">sharp</span>&nbsp;<span class="op" id="2236210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236215">//&nbsp;Also&nbsp;adds&nbsp;&#34;0x&#34;.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236237">width</span>&nbsp;<span class="op" id="2236243">+=</span>&nbsp;<span class="num" id="2236246">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236254">if</span>&nbsp;<span class="ident" id="2236257">width</span>&nbsp;<span class="op" id="2236263">&gt;</span>&nbsp;<span class="ident" id="2236265">nByte</span>&nbsp;<span class="op" id="2236271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236276">//&nbsp;We&#39;re&nbsp;going&nbsp;to&nbsp;need&nbsp;a&nbsp;bigger&nbsp;boat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236317">buf</span>&nbsp;<span class="op" id="2236321">=</span>&nbsp;<span class="builtinfunc" id="2236323">make</span><span class="op" id="2236327">(</span><span class="op" id="2236328">[</span><span class="op" id="2236329">]</span><span class="builtintype" id="2236330">byte</span><span class="op" id="2236334">,</span>&nbsp;<span class="ident" id="2236336">width</span><span class="op" id="2236341">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236352">negative</span>&nbsp;<span class="op" id="2236361">:=</span>&nbsp;<span class="ident" id="2236364">signedness</span>&nbsp;<span class="op" id="2236375">==</span>&nbsp;<span class="ident" id="2236378">signed</span>&nbsp;<span class="op" id="2236385">&amp;&amp;</span>&nbsp;<span class="ident" id="2236388">a</span>&nbsp;<span class="op" id="2236390">&lt;</span>&nbsp;<span class="num" id="2236392">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236395">if</span>&nbsp;<span class="ident" id="2236398">negative</span>&nbsp;<span class="op" id="2236407">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236411">a</span>&nbsp;<span class="op" id="2236413">=</span>&nbsp;<span class="op" id="2236415">-</span><span class="ident" id="2236416">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236423">//&nbsp;two&nbsp;ways&nbsp;to&nbsp;ask&nbsp;for&nbsp;extra&nbsp;leading&nbsp;zero&nbsp;digits:&nbsp;%.3d&nbsp;or&nbsp;%03d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236488">//&nbsp;apparently&nbsp;the&nbsp;first&nbsp;cancels&nbsp;the&nbsp;second.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236533">prec</span>&nbsp;<span class="op" id="2236538">:=</span>&nbsp;<span class="num" id="2236541">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236544">if</span>&nbsp;<span class="ident" id="2236547">f</span><span class="op" id="2236548">.</span><span class="ident" id="2236549">precPresent</span>&nbsp;<span class="op" id="2236561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236565">prec</span>&nbsp;<span class="op" id="2236570">=</span>&nbsp;<span class="ident" id="2236572">f</span><span class="op" id="2236573">.</span><span class="ident" id="2236574">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236581">f</span><span class="op" id="2236582">.</span><span class="ident" id="2236583">zero</span>&nbsp;<span class="op" id="2236588">=</span>&nbsp;<span class="builtintype" id="2236590">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236597">}</span>&nbsp;<span class="keyword" id="2236599">else</span>&nbsp;<span class="keyword" id="2236604">if</span>&nbsp;<span class="ident" id="2236607">f</span><span class="op" id="2236608">.</span><span class="ident" id="2236609">zero</span>&nbsp;<span class="op" id="2236614">&amp;&amp;</span>&nbsp;<span class="ident" id="2236617">f</span><span class="op" id="2236618">.</span><span class="ident" id="2236619">widPresent</span>&nbsp;<span class="op" id="2236630">&amp;&amp;</span>&nbsp;<span class="op" id="2236633">!</span><span class="ident" id="2236634">f</span><span class="op" id="2236635">.</span><span class="ident" id="2236636">minus</span>&nbsp;<span class="op" id="2236642">&amp;&amp;</span>&nbsp;<span class="ident" id="2236645">f</span><span class="op" id="2236646">.</span><span class="ident" id="2236647">wid</span>&nbsp;<span class="op" id="2236651">&gt;</span>&nbsp;<span class="num" id="2236653">0</span>&nbsp;<span class="op" id="2236655">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236659">prec</span>&nbsp;<span class="op" id="2236664">=</span>&nbsp;<span class="ident" id="2236666">f</span><span class="op" id="2236667">.</span><span class="ident" id="2236668">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236674">if</span>&nbsp;<span class="ident" id="2236677">negative</span>&nbsp;<span class="op" id="2236686">||</span>&nbsp;<span class="ident" id="2236689">f</span><span class="op" id="2236690">.</span><span class="ident" id="2236691">plus</span>&nbsp;<span class="op" id="2236696">||</span>&nbsp;<span class="ident" id="2236699">f</span><span class="op" id="2236700">.</span><span class="ident" id="2236701">space</span>&nbsp;<span class="op" id="2236707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236712">prec</span><span class="op" id="2236716">--</span>&nbsp;<span class="comment" id="2236719">//&nbsp;leave&nbsp;room&nbsp;for&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236747">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236751">//&nbsp;format&nbsp;a&nbsp;into&nbsp;buf,&nbsp;ending&nbsp;at&nbsp;buf[i].&nbsp;&nbsp;(printing&nbsp;is&nbsp;easier&nbsp;right-to-left.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236829">//&nbsp;a&nbsp;is&nbsp;made&nbsp;into&nbsp;unsigned&nbsp;ua.&nbsp;&nbsp;we&nbsp;could&nbsp;make&nbsp;things</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236883">//&nbsp;marginally&nbsp;faster&nbsp;by&nbsp;splitting&nbsp;the&nbsp;32-bit&nbsp;case&nbsp;out&nbsp;into&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236954">//&nbsp;block&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;duplication,&nbsp;so&nbsp;ua&nbsp;has&nbsp;64&nbsp;bits.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237019">i</span>&nbsp;<span class="op" id="2237021">:=</span>&nbsp;<span class="builtinfunc" id="2237024">len</span><span class="op" id="2237027">(</span><span class="ident" id="2237028">buf</span><span class="op" id="2237031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237034">ua</span>&nbsp;<span class="op" id="2237037">:=</span>&nbsp;<span class="ident" id="2237040">uint64</span><span class="op" id="2237046">(</span><span class="ident" id="2237047">a</span><span class="op" id="2237048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2237051">//&nbsp;use&nbsp;constants&nbsp;for&nbsp;the&nbsp;division&nbsp;and&nbsp;modulo&nbsp;for&nbsp;more&nbsp;efficient&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2237122">//&nbsp;switch&nbsp;cases&nbsp;ordered&nbsp;by&nbsp;popularity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237162">switch</span>&nbsp;<span class="ident" id="2237169">base</span>&nbsp;<span class="op" id="2237174">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237177">case</span>&nbsp;<span class="num" id="2237182">10</span><span class="op" id="2237184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237188">for</span>&nbsp;<span class="ident" id="2237192">ua</span>&nbsp;<span class="op" id="2237195">&gt;=</span>&nbsp;<span class="num" id="2237198">10</span>&nbsp;<span class="op" id="2237201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237206">i</span><span class="op" id="2237207">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237213">next</span>&nbsp;<span class="op" id="2237218">:=</span>&nbsp;<span class="ident" id="2237221">ua</span>&nbsp;<span class="op" id="2237224">/</span>&nbsp;<span class="num" id="2237226">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237232">buf</span><span class="op" id="2237235">[</span><span class="ident" id="2237236">i</span><span class="op" id="2237237">]</span>&nbsp;<span class="op" id="2237239">=</span>&nbsp;<span class="builtintype" id="2237241">byte</span><span class="op" id="2237245">(</span><span class="string" id="2237246">&#39;0&#39;</span>&nbsp;<span class="op" id="2237250">+</span>&nbsp;<span class="ident" id="2237252">ua</span>&nbsp;<span class="op" id="2237255">-</span>&nbsp;<span class="ident" id="2237257">next</span><span class="op" id="2237261">*</span><span class="num" id="2237262">10</span><span class="op" id="2237264">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237269">ua</span>&nbsp;<span class="op" id="2237272">=</span>&nbsp;<span class="ident" id="2237274">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237284">case</span>&nbsp;<span class="num" id="2237289">16</span><span class="op" id="2237291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237295">for</span>&nbsp;<span class="ident" id="2237299">ua</span>&nbsp;<span class="op" id="2237302">&gt;=</span>&nbsp;<span class="num" id="2237305">16</span>&nbsp;<span class="op" id="2237308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237313">i</span><span class="op" id="2237314">--</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237320">buf</span><span class="op" id="2237323">[</span><span class="ident" id="2237324">i</span><span class="op" id="2237325">]</span>&nbsp;<span class="op" id="2237327">=</span>&nbsp;<span class="ident" id="2237329">digits</span><span class="op" id="2237335">[</span><span class="ident" id="2237336">ua</span><span class="op" id="2237338">&amp;</span><span class="num" id="2237339">0xF</span><span class="op" id="2237342">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237347">ua</span>&nbsp;<span class="op" id="2237350">&gt;&gt;=</span>&nbsp;<span class="num" id="2237354">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237361">case</span>&nbsp;<span class="num" id="2237366">8</span><span class="op" id="2237367">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237371">for</span>&nbsp;<span class="ident" id="2237375">ua</span>&nbsp;<span class="op" id="2237378">&gt;=</span>&nbsp;<span class="num" id="2237381">8</span>&nbsp;<span class="op" id="2237383">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237388">i</span><span class="op" id="2237389">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237395">buf</span><span class="op" id="2237398">[</span><span class="ident" id="2237399">i</span><span class="op" id="2237400">]</span>&nbsp;<span class="op" id="2237402">=</span>&nbsp;<span class="builtintype" id="2237404">byte</span><span class="op" id="2237408">(</span><span class="string" id="2237409">&#39;0&#39;</span>&nbsp;<span class="op" id="2237413">+</span>&nbsp;<span class="ident" id="2237415">ua</span><span class="op" id="2237417">&amp;</span><span class="num" id="2237418">7</span><span class="op" id="2237419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237424">ua</span>&nbsp;<span class="op" id="2237427">&gt;&gt;=</span>&nbsp;<span class="num" id="2237431">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237438">case</span>&nbsp;<span class="num" id="2237443">2</span><span class="op" id="2237444">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237448">for</span>&nbsp;<span class="ident" id="2237452">ua</span>&nbsp;<span class="op" id="2237455">&gt;=</span>&nbsp;<span class="num" id="2237458">2</span>&nbsp;<span class="op" id="2237460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237465">i</span><span class="op" id="2237466">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237472">buf</span><span class="op" id="2237475">[</span><span class="ident" id="2237476">i</span><span class="op" id="2237477">]</span>&nbsp;<span class="op" id="2237479">=</span>&nbsp;<span class="builtintype" id="2237481">byte</span><span class="op" id="2237485">(</span><span class="string" id="2237486">&#39;0&#39;</span>&nbsp;<span class="op" id="2237490">+</span>&nbsp;<span class="ident" id="2237492">ua</span><span class="op" id="2237494">&amp;</span><span class="num" id="2237495">1</span><span class="op" id="2237496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237501">ua</span>&nbsp;<span class="op" id="2237504">&gt;&gt;=</span>&nbsp;<span class="num" id="2237508">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237512">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237515">default</span><span class="op" id="2237522">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2237526">panic</span><span class="op" id="2237531">(</span><span class="string" id="2237532">&#34;fmt:&nbsp;unknown&nbsp;base;&nbsp;can&#39;t&nbsp;happen&#34;</span><span class="op" id="2237565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237571">i</span><span class="op" id="2237572">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237576">buf</span><span class="op" id="2237579">[</span><span class="ident" id="2237580">i</span><span class="op" id="2237581">]</span>&nbsp;<span class="op" id="2237583">=</span>&nbsp;<span class="ident" id="2237585">digits</span><span class="op" id="2237591">[</span><span class="ident" id="2237592">ua</span><span class="op" id="2237594">]</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237597">for</span>&nbsp;<span class="ident" id="2237601">i</span>&nbsp;<span class="op" id="2237603">&gt;</span>&nbsp;<span class="num" id="2237605">0</span>&nbsp;<span class="op" id="2237607">&amp;&amp;</span>&nbsp;<span class="ident" id="2237610">prec</span>&nbsp;<span class="op" id="2237615">&gt;</span>&nbsp;<span class="builtinfunc" id="2237617">len</span><span class="op" id="2237620">(</span><span class="ident" id="2237621">buf</span><span class="op" id="2237624">)</span><span class="op" id="2237625">-</span><span class="ident" id="2237626">i</span>&nbsp;<span class="op" id="2237628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237632">i</span><span class="op" id="2237633">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237638">buf</span><span class="op" id="2237641">[</span><span class="ident" id="2237642">i</span><span class="op" id="2237643">]</span>&nbsp;<span class="op" id="2237645">=</span>&nbsp;<span class="string" id="2237647">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2237656">//&nbsp;Various&nbsp;prefixes:&nbsp;0x,&nbsp;-,&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237690">if</span>&nbsp;<span class="ident" id="2237693">f</span><span class="op" id="2237694">.</span><span class="ident" id="2237695">sharp</span>&nbsp;<span class="op" id="2237701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237705">switch</span>&nbsp;<span class="ident" id="2237712">base</span>&nbsp;<span class="op" id="2237717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237721">case</span>&nbsp;<span class="num" id="2237726">8</span><span class="op" id="2237727">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237732">if</span>&nbsp;<span class="ident" id="2237735">buf</span><span class="op" id="2237738">[</span><span class="ident" id="2237739">i</span><span class="op" id="2237740">]</span>&nbsp;<span class="op" id="2237742">!=</span>&nbsp;<span class="string" id="2237745">&#39;0&#39;</span>&nbsp;<span class="op" id="2237749">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237755">i</span><span class="op" id="2237756">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237763">buf</span><span class="op" id="2237766">[</span><span class="ident" id="2237767">i</span><span class="op" id="2237768">]</span>&nbsp;<span class="op" id="2237770">=</span>&nbsp;<span class="string" id="2237772">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237783">case</span>&nbsp;<span class="num" id="2237788">16</span><span class="op" id="2237790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237795">i</span><span class="op" id="2237796">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237802">buf</span><span class="op" id="2237805">[</span><span class="ident" id="2237806">i</span><span class="op" id="2237807">]</span>&nbsp;<span class="op" id="2237809">=</span>&nbsp;<span class="string" id="2237811">&#39;x&#39;</span>&nbsp;<span class="op" id="2237815">+</span>&nbsp;<span class="ident" id="2237817">digits</span><span class="op" id="2237823">[</span><span class="num" id="2237824">10</span><span class="op" id="2237826">]</span>&nbsp;<span class="op" id="2237828">-</span>&nbsp;<span class="string" id="2237830">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237837">i</span><span class="op" id="2237838">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237844">buf</span><span class="op" id="2237847">[</span><span class="ident" id="2237848">i</span><span class="op" id="2237849">]</span>&nbsp;<span class="op" id="2237851">=</span>&nbsp;<span class="string" id="2237853">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237862">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237865">if</span>&nbsp;<span class="ident" id="2237868">f</span><span class="op" id="2237869">.</span><span class="ident" id="2237870">unicode</span>&nbsp;<span class="op" id="2237878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237882">i</span><span class="op" id="2237883">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237888">buf</span><span class="op" id="2237891">[</span><span class="ident" id="2237892">i</span><span class="op" id="2237893">]</span>&nbsp;<span class="op" id="2237895">=</span>&nbsp;<span class="string" id="2237897">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237903">i</span><span class="op" id="2237904">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237909">buf</span><span class="op" id="2237912">[</span><span class="ident" id="2237913">i</span><span class="op" id="2237914">]</span>&nbsp;<span class="op" id="2237916">=</span>&nbsp;<span class="string" id="2237918">&#39;U&#39;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237927">if</span>&nbsp;<span class="ident" id="2237930">negative</span>&nbsp;<span class="op" id="2237939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237943">i</span><span class="op" id="2237944">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237949">buf</span><span class="op" id="2237952">[</span><span class="ident" id="2237953">i</span><span class="op" id="2237954">]</span>&nbsp;<span class="op" id="2237956">=</span>&nbsp;<span class="string" id="2237958">&#39;-&#39;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237963">}</span>&nbsp;<span class="keyword" id="2237965">else</span>&nbsp;<span class="keyword" id="2237970">if</span>&nbsp;<span class="ident" id="2237973">f</span><span class="op" id="2237974">.</span><span class="ident" id="2237975">plus</span>&nbsp;<span class="op" id="2237980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237984">i</span><span class="op" id="2237985">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237990">buf</span><span class="op" id="2237993">[</span><span class="ident" id="2237994">i</span><span class="op" id="2237995">]</span>&nbsp;<span class="op" id="2237997">=</span>&nbsp;<span class="string" id="2237999">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238004">}</span>&nbsp;<span class="keyword" id="2238006">else</span>&nbsp;<span class="keyword" id="2238011">if</span>&nbsp;<span class="ident" id="2238014">f</span><span class="op" id="2238015">.</span><span class="ident" id="2238016">space</span>&nbsp;<span class="op" id="2238022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238026">i</span><span class="op" id="2238027">--</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238032">buf</span><span class="op" id="2238035">[</span><span class="ident" id="2238036">i</span><span class="op" id="2238037">]</span>&nbsp;<span class="op" id="2238039">=</span>&nbsp;<span class="string" id="2238041">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2238050">//&nbsp;If&nbsp;we&nbsp;want&nbsp;a&nbsp;quoted&nbsp;char&nbsp;for&nbsp;%#U,&nbsp;move&nbsp;the&nbsp;data&nbsp;up&nbsp;to&nbsp;make&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238119">if</span>&nbsp;<span class="ident" id="2238122">f</span><span class="op" id="2238123">.</span><span class="ident" id="2238124">unicode</span>&nbsp;<span class="op" id="2238132">&amp;&amp;</span>&nbsp;<span class="ident" id="2238135">f</span><span class="op" id="2238136">.</span><span class="ident" id="2238137">uniQuote</span>&nbsp;<span class="op" id="2238146">&amp;&amp;</span>&nbsp;<span class="ident" id="2238149">a</span>&nbsp;<span class="op" id="2238151">&gt;=</span>&nbsp;<span class="num" id="2238154">0</span>&nbsp;<span class="op" id="2238156">&amp;&amp;</span>&nbsp;<span class="ident" id="2238159">a</span>&nbsp;<span class="op" id="2238161">&lt;=</span>&nbsp;<span class="ident" id="2238164">utf8</span><span class="op" id="2238168">.</span><span class="ident" id="2238169">MaxRune</span>&nbsp;<span class="op" id="2238177">&amp;&amp;</span>&nbsp;<span class="ident" id="2238180">strconv</span><span class="op" id="2238187">.</span><span class="ident" id="2238188">IsPrint</span><span class="op" id="2238195">(</span><span class="builtintype" id="2238196">rune</span><span class="op" id="2238200">(</span><span class="ident" id="2238201">a</span><span class="op" id="2238202">)</span><span class="op" id="2238203">)</span>&nbsp;<span class="op" id="2238205">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238209">runeWidth</span>&nbsp;<span class="op" id="2238219">:=</span>&nbsp;<span class="ident" id="2238222">utf8</span><span class="op" id="2238226">.</span><span class="ident" id="2238227">RuneLen</span><span class="op" id="2238234">(</span><span class="builtintype" id="2238235">rune</span><span class="op" id="2238239">(</span><span class="ident" id="2238240">a</span><span class="op" id="2238241">)</span><span class="op" id="2238242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238246">width</span>&nbsp;<span class="op" id="2238252">:=</span>&nbsp;<span class="num" id="2238255">1</span>&nbsp;<span class="op" id="2238257">+</span>&nbsp;<span class="num" id="2238259">1</span>&nbsp;<span class="op" id="2238261">+</span>&nbsp;<span class="ident" id="2238263">runeWidth</span>&nbsp;<span class="op" id="2238273">+</span>&nbsp;<span class="num" id="2238275">1</span>&nbsp;<span class="comment" id="2238277">//&nbsp;space,&nbsp;quote,&nbsp;rune,&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2238308">copy</span><span class="op" id="2238312">(</span><span class="ident" id="2238313">buf</span><span class="op" id="2238316">[</span><span class="ident" id="2238317">i</span><span class="op" id="2238318">-</span><span class="ident" id="2238319">width</span><span class="op" id="2238324">:</span><span class="op" id="2238325">]</span><span class="op" id="2238326">,</span>&nbsp;<span class="ident" id="2238328">buf</span><span class="op" id="2238331">[</span><span class="ident" id="2238332">i</span><span class="op" id="2238333">:</span><span class="op" id="2238334">]</span><span class="op" id="2238335">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2238339">//&nbsp;guaranteed&nbsp;to&nbsp;have&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238376">i</span>&nbsp;<span class="op" id="2238378">-=</span>&nbsp;<span class="ident" id="2238381">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2238389">//&nbsp;Now&nbsp;put&nbsp;&#34;&nbsp;&#39;x&#39;&#34;&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238421">j</span>&nbsp;<span class="op" id="2238423">:=</span>&nbsp;<span class="builtinfunc" id="2238426">len</span><span class="op" id="2238429">(</span><span class="ident" id="2238430">buf</span><span class="op" id="2238433">)</span>&nbsp;<span class="op" id="2238435">-</span>&nbsp;<span class="ident" id="2238437">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238445">buf</span><span class="op" id="2238448">[</span><span class="ident" id="2238449">j</span><span class="op" id="2238450">]</span>&nbsp;<span class="op" id="2238452">=</span>&nbsp;<span class="string" id="2238454">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238460">j</span><span class="op" id="2238461">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238466">buf</span><span class="op" id="2238469">[</span><span class="ident" id="2238470">j</span><span class="op" id="2238471">]</span>&nbsp;<span class="op" id="2238473">=</span>&nbsp;<span class="string" id="2238475">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238482">j</span><span class="op" id="2238483">++</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238488">utf8</span><span class="op" id="2238492">.</span><span class="ident" id="2238493">EncodeRune</span><span class="op" id="2238503">(</span><span class="ident" id="2238504">buf</span><span class="op" id="2238507">[</span><span class="ident" id="2238508">j</span><span class="op" id="2238509">:</span><span class="op" id="2238510">]</span><span class="op" id="2238511">,</span>&nbsp;<span class="builtintype" id="2238513">rune</span><span class="op" id="2238517">(</span><span class="ident" id="2238518">a</span><span class="op" id="2238519">)</span><span class="op" id="2238520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238524">j</span>&nbsp;<span class="op" id="2238526">+=</span>&nbsp;<span class="ident" id="2238529">runeWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238541">buf</span><span class="op" id="2238544">[</span><span class="ident" id="2238545">j</span><span class="op" id="2238546">]</span>&nbsp;<span class="op" id="2238548">=</span>&nbsp;<span class="string" id="2238550">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238560">f</span><span class="op" id="2238561">.</span><span class="ident" id="2238562">pad</span><span class="op" id="2238565">(</span><span class="ident" id="2238566">buf</span><span class="op" id="2238569">[</span><span class="ident" id="2238570">i</span><span class="op" id="2238571">:</span><span class="op" id="2238572">]</span><span class="op" id="2238573">)</span><br>
<span class="lineno"></span><span class="op" id="2238575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2238578">//&nbsp;truncate&nbsp;truncates&nbsp;the&nbsp;string&nbsp;to&nbsp;the&nbsp;specified&nbsp;precision,&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2238651">func</span>&nbsp;<span class="op" id="2238656">(</span><span class="ident" id="2238657">f</span>&nbsp;<span class="op" id="2238659">*</span><span class="ident" id="2238660">fmt</span><span class="op" id="2238663">)</span>&nbsp;<span class="ident" id="2238665">truncate</span><span class="op" id="2238673">(</span><span class="ident" id="2238674">s</span>&nbsp;<span class="builtintype" id="2238676">string</span><span class="op" id="2238682">)</span>&nbsp;<span class="builtintype" id="2238684">string</span>&nbsp;<span class="op" id="2238691">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238694">if</span>&nbsp;<span class="ident" id="2238697">f</span><span class="op" id="2238698">.</span><span class="ident" id="2238699">precPresent</span>&nbsp;<span class="op" id="2238711">&amp;&amp;</span>&nbsp;<span class="ident" id="2238714">f</span><span class="op" id="2238715">.</span><span class="ident" id="2238716">prec</span>&nbsp;<span class="op" id="2238721">&lt;</span>&nbsp;<span class="ident" id="2238723">utf8</span><span class="op" id="2238727">.</span><span class="ident" id="2238728">RuneCountInString</span><span class="op" id="2238745">(</span><span class="ident" id="2238746">s</span><span class="op" id="2238747">)</span>&nbsp;<span class="op" id="2238749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238753">n</span>&nbsp;<span class="op" id="2238755">:=</span>&nbsp;<span class="ident" id="2238758">f</span><span class="op" id="2238759">.</span><span class="ident" id="2238760">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238767">for</span>&nbsp;<span class="ident" id="2238771">i</span>&nbsp;<span class="op" id="2238773">:=</span>&nbsp;<span class="keyword" id="2238776">range</span>&nbsp;<span class="ident" id="2238782">s</span>&nbsp;<span class="op" id="2238784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238789">if</span>&nbsp;<span class="ident" id="2238792">n</span>&nbsp;<span class="op" id="2238794">==</span>&nbsp;<span class="num" id="2238797">0</span>&nbsp;<span class="op" id="2238799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238805">s</span>&nbsp;<span class="op" id="2238807">=</span>&nbsp;<span class="ident" id="2238809">s</span><span class="op" id="2238810">[</span><span class="op" id="2238811">:</span><span class="ident" id="2238812">i</span><span class="op" id="2238813">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238819">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238833">n</span><span class="op" id="2238834">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238842">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238845">return</span>&nbsp;<span class="ident" id="2238852">s</span><br>
<span class="lineno"></span><span class="op" id="2238854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2238857">//&nbsp;fmt_s&nbsp;formats&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2238884">func</span>&nbsp;<span class="op" id="2238889">(</span><span class="ident" id="2238890">f</span>&nbsp;<span class="op" id="2238892">*</span><span class="ident" id="2238893">fmt</span><span class="op" id="2238896">)</span>&nbsp;<span class="ident" id="2238898">fmt_s</span><span class="op" id="2238903">(</span><span class="ident" id="2238904">s</span>&nbsp;<span class="builtintype" id="2238906">string</span><span class="op" id="2238912">)</span>&nbsp;<span class="op" id="2238914">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238917">s</span>&nbsp;<span class="op" id="2238919">=</span>&nbsp;<span class="ident" id="2238921">f</span><span class="op" id="2238922">.</span><span class="ident" id="2238923">truncate</span><span class="op" id="2238931">(</span><span class="ident" id="2238932">s</span><span class="op" id="2238933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238936">f</span><span class="op" id="2238937">.</span><span class="ident" id="2238938">padString</span><span class="op" id="2238947">(</span><span class="ident" id="2238948">s</span><span class="op" id="2238949">)</span><br>
<span class="lineno"></span><span class="op" id="2238951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2238954">//&nbsp;fmt_sbx&nbsp;formats&nbsp;a&nbsp;string&nbsp;or&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">315</span><span class="keyword" id="2239036">func</span>&nbsp;<span class="op" id="2239041">(</span><span class="ident" id="2239042">f</span>&nbsp;<span class="op" id="2239044">*</span><span class="ident" id="2239045">fmt</span><span class="op" id="2239048">)</span>&nbsp;<span class="ident" id="2239050">fmt_sbx</span><span class="op" id="2239057">(</span><span class="ident" id="2239058">s</span>&nbsp;<span class="builtintype" id="2239060">string</span><span class="op" id="2239066">,</span>&nbsp;<span class="ident" id="2239068">b</span>&nbsp;<span class="op" id="2239070">[</span><span class="op" id="2239071">]</span><span class="builtintype" id="2239072">byte</span><span class="op" id="2239076">,</span>&nbsp;<span class="ident" id="2239078">digits</span>&nbsp;<span class="builtintype" id="2239085">string</span><span class="op" id="2239091">)</span>&nbsp;<span class="op" id="2239093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239096">n</span>&nbsp;<span class="op" id="2239098">:=</span>&nbsp;<span class="builtinfunc" id="2239101">len</span><span class="op" id="2239104">(</span><span class="ident" id="2239105">b</span><span class="op" id="2239106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239109">if</span>&nbsp;<span class="ident" id="2239112">b</span>&nbsp;<span class="op" id="2239114">==</span>&nbsp;<span class="ident" id="2239117">nil</span>&nbsp;<span class="op" id="2239121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239125">n</span>&nbsp;<span class="op" id="2239127">=</span>&nbsp;<span class="builtinfunc" id="2239129">len</span><span class="op" id="2239132">(</span><span class="ident" id="2239133">s</span><span class="op" id="2239134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239137">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239140">x</span>&nbsp;<span class="op" id="2239142">:=</span>&nbsp;<span class="ident" id="2239145">digits</span><span class="op" id="2239151">[</span><span class="num" id="2239152">10</span><span class="op" id="2239154">]</span>&nbsp;<span class="op" id="2239156">-</span>&nbsp;<span class="string" id="2239158">&#39;a&#39;</span>&nbsp;<span class="op" id="2239162">+</span>&nbsp;<span class="string" id="2239164">&#39;x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2239169">//&nbsp;TODO:&nbsp;Avoid&nbsp;buffer&nbsp;by&nbsp;pre-padding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239208">var</span>&nbsp;<span class="ident" id="2239212">buf</span>&nbsp;<span class="op" id="2239216">[</span><span class="op" id="2239217">]</span><span class="builtintype" id="2239218">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239224">for</span>&nbsp;<span class="ident" id="2239228">i</span>&nbsp;<span class="op" id="2239230">:=</span>&nbsp;<span class="num" id="2239233">0</span><span class="op" id="2239234">;</span>&nbsp;<span class="ident" id="2239236">i</span>&nbsp;<span class="op" id="2239238">&lt;</span>&nbsp;<span class="ident" id="2239240">n</span><span class="op" id="2239241">;</span>&nbsp;<span class="ident" id="2239243">i</span><span class="op" id="2239244">++</span>&nbsp;<span class="op" id="2239247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239251">if</span>&nbsp;<span class="ident" id="2239254">i</span>&nbsp;<span class="op" id="2239256">&gt;</span>&nbsp;<span class="num" id="2239258">0</span>&nbsp;<span class="op" id="2239260">&amp;&amp;</span>&nbsp;<span class="ident" id="2239263">f</span><span class="op" id="2239264">.</span><span class="ident" id="2239265">space</span>&nbsp;<span class="op" id="2239271">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239276">buf</span>&nbsp;<span class="op" id="2239280">=</span>&nbsp;<span class="builtinfunc" id="2239282">append</span><span class="op" id="2239288">(</span><span class="ident" id="2239289">buf</span><span class="op" id="2239292">,</span>&nbsp;<span class="string" id="2239294">&#39;&nbsp;&#39;</span><span class="op" id="2239297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239305">if</span>&nbsp;<span class="ident" id="2239308">f</span><span class="op" id="2239309">.</span><span class="ident" id="2239310">sharp</span>&nbsp;<span class="op" id="2239316">&amp;&amp;</span>&nbsp;<span class="op" id="2239319">(</span><span class="ident" id="2239320">f</span><span class="op" id="2239321">.</span><span class="ident" id="2239322">space</span>&nbsp;<span class="op" id="2239328">||</span>&nbsp;<span class="ident" id="2239331">i</span>&nbsp;<span class="op" id="2239333">==</span>&nbsp;<span class="num" id="2239336">0</span><span class="op" id="2239337">)</span>&nbsp;<span class="op" id="2239339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239344">buf</span>&nbsp;<span class="op" id="2239348">=</span>&nbsp;<span class="builtinfunc" id="2239350">append</span><span class="op" id="2239356">(</span><span class="ident" id="2239357">buf</span><span class="op" id="2239360">,</span>&nbsp;<span class="string" id="2239362">&#39;0&#39;</span><span class="op" id="2239365">,</span>&nbsp;<span class="ident" id="2239367">x</span><span class="op" id="2239368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239372">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239376">var</span>&nbsp;<span class="ident" id="2239380">c</span>&nbsp;<span class="builtintype" id="2239382">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239389">if</span>&nbsp;<span class="ident" id="2239392">b</span>&nbsp;<span class="op" id="2239394">==</span>&nbsp;<span class="ident" id="2239397">nil</span>&nbsp;<span class="op" id="2239401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239406">c</span>&nbsp;<span class="op" id="2239408">=</span>&nbsp;<span class="ident" id="2239410">s</span><span class="op" id="2239411">[</span><span class="ident" id="2239412">i</span><span class="op" id="2239413">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239417">}</span>&nbsp;<span class="keyword" id="2239419">else</span>&nbsp;<span class="op" id="2239424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239429">c</span>&nbsp;<span class="op" id="2239431">=</span>&nbsp;<span class="ident" id="2239433">b</span><span class="op" id="2239434">[</span><span class="ident" id="2239435">i</span><span class="op" id="2239436">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239444">buf</span>&nbsp;<span class="op" id="2239448">=</span>&nbsp;<span class="builtinfunc" id="2239450">append</span><span class="op" id="2239456">(</span><span class="ident" id="2239457">buf</span><span class="op" id="2239460">,</span>&nbsp;<span class="ident" id="2239462">digits</span><span class="op" id="2239468">[</span><span class="ident" id="2239469">c</span><span class="op" id="2239470">&gt;&gt;</span><span class="num" id="2239472">4</span><span class="op" id="2239473">]</span><span class="op" id="2239474">,</span>&nbsp;<span class="ident" id="2239476">digits</span><span class="op" id="2239482">[</span><span class="ident" id="2239483">c</span><span class="op" id="2239484">&amp;</span><span class="num" id="2239485">0xF</span><span class="op" id="2239488">]</span><span class="op" id="2239489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239495">f</span><span class="op" id="2239496">.</span><span class="ident" id="2239497">pad</span><span class="op" id="2239500">(</span><span class="ident" id="2239501">buf</span><span class="op" id="2239504">)</span><br>
<span class="lineno"></span><span class="op" id="2239506">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="2239509">//&nbsp;fmt_sx&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2239576">func</span>&nbsp;<span class="op" id="2239581">(</span><span class="ident" id="2239582">f</span>&nbsp;<span class="op" id="2239584">*</span><span class="ident" id="2239585">fmt</span><span class="op" id="2239588">)</span>&nbsp;<span class="ident" id="2239590">fmt_sx</span><span class="op" id="2239596">(</span><span class="ident" id="2239597">s</span><span class="op" id="2239598">,</span>&nbsp;<span class="ident" id="2239600">digits</span>&nbsp;<span class="builtintype" id="2239607">string</span><span class="op" id="2239613">)</span>&nbsp;<span class="op" id="2239615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239618">if</span>&nbsp;<span class="ident" id="2239621">f</span><span class="op" id="2239622">.</span><span class="ident" id="2239623">precPresent</span>&nbsp;<span class="op" id="2239635">&amp;&amp;</span>&nbsp;<span class="ident" id="2239638">f</span><span class="op" id="2239639">.</span><span class="ident" id="2239640">prec</span>&nbsp;<span class="op" id="2239645">&lt;</span>&nbsp;<span class="builtinfunc" id="2239647">len</span><span class="op" id="2239650">(</span><span class="ident" id="2239651">s</span><span class="op" id="2239652">)</span>&nbsp;<span class="op" id="2239654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239658">s</span>&nbsp;<span class="op" id="2239660">=</span>&nbsp;<span class="ident" id="2239662">s</span><span class="op" id="2239663">[</span><span class="op" id="2239664">:</span><span class="ident" id="2239665">f</span><span class="op" id="2239666">.</span><span class="ident" id="2239667">prec</span><span class="op" id="2239671">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239677">f</span><span class="op" id="2239678">.</span><span class="ident" id="2239679">fmt_sbx</span><span class="op" id="2239686">(</span><span class="ident" id="2239687">s</span><span class="op" id="2239688">,</span>&nbsp;<span class="ident" id="2239690">nil</span><span class="op" id="2239693">,</span>&nbsp;<span class="ident" id="2239695">digits</span><span class="op" id="2239701">)</span><br>
<span class="lineno"></span><span class="op" id="2239703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2239706">//&nbsp;fmt_bx&nbsp;formats&nbsp;a&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">350</span><span class="keyword" id="2239777">func</span>&nbsp;<span class="op" id="2239782">(</span><span class="ident" id="2239783">f</span>&nbsp;<span class="op" id="2239785">*</span><span class="ident" id="2239786">fmt</span><span class="op" id="2239789">)</span>&nbsp;<span class="ident" id="2239791">fmt_bx</span><span class="op" id="2239797">(</span><span class="ident" id="2239798">b</span>&nbsp;<span class="op" id="2239800">[</span><span class="op" id="2239801">]</span><span class="builtintype" id="2239802">byte</span><span class="op" id="2239806">,</span>&nbsp;<span class="ident" id="2239808">digits</span>&nbsp;<span class="builtintype" id="2239815">string</span><span class="op" id="2239821">)</span>&nbsp;<span class="op" id="2239823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239826">if</span>&nbsp;<span class="ident" id="2239829">f</span><span class="op" id="2239830">.</span><span class="ident" id="2239831">precPresent</span>&nbsp;<span class="op" id="2239843">&amp;&amp;</span>&nbsp;<span class="ident" id="2239846">f</span><span class="op" id="2239847">.</span><span class="ident" id="2239848">prec</span>&nbsp;<span class="op" id="2239853">&lt;</span>&nbsp;<span class="builtinfunc" id="2239855">len</span><span class="op" id="2239858">(</span><span class="ident" id="2239859">b</span><span class="op" id="2239860">)</span>&nbsp;<span class="op" id="2239862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239866">b</span>&nbsp;<span class="op" id="2239868">=</span>&nbsp;<span class="ident" id="2239870">b</span><span class="op" id="2239871">[</span><span class="op" id="2239872">:</span><span class="ident" id="2239873">f</span><span class="op" id="2239874">.</span><span class="ident" id="2239875">prec</span><span class="op" id="2239879">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239885">f</span><span class="op" id="2239886">.</span><span class="ident" id="2239887">fmt_sbx</span><span class="op" id="2239894">(</span><span class="string" id="2239895">&#34;&#34;</span><span class="op" id="2239897">,</span>&nbsp;<span class="ident" id="2239899">b</span><span class="op" id="2239900">,</span>&nbsp;<span class="ident" id="2239902">digits</span><span class="op" id="2239908">)</span><br>
<span class="lineno">355</span><span class="op" id="2239910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2239913">//&nbsp;fmt_q&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;double-quoted,&nbsp;escaped&nbsp;Go&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="2239987">func</span>&nbsp;<span class="op" id="2239992">(</span><span class="ident" id="2239993">f</span>&nbsp;<span class="op" id="2239995">*</span><span class="ident" id="2239996">fmt</span><span class="op" id="2239999">)</span>&nbsp;<span class="ident" id="2240001">fmt_q</span><span class="op" id="2240006">(</span><span class="ident" id="2240007">s</span>&nbsp;<span class="builtintype" id="2240009">string</span><span class="op" id="2240015">)</span>&nbsp;<span class="op" id="2240017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240020">s</span>&nbsp;<span class="op" id="2240022">=</span>&nbsp;<span class="ident" id="2240024">f</span><span class="op" id="2240025">.</span><span class="ident" id="2240026">truncate</span><span class="op" id="2240034">(</span><span class="ident" id="2240035">s</span><span class="op" id="2240036">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240039">var</span>&nbsp;<span class="ident" id="2240043">quoted</span>&nbsp;<span class="builtintype" id="2240050">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240058">if</span>&nbsp;<span class="ident" id="2240061">f</span><span class="op" id="2240062">.</span><span class="ident" id="2240063">sharp</span>&nbsp;<span class="op" id="2240069">&amp;&amp;</span>&nbsp;<span class="ident" id="2240072">strconv</span><span class="op" id="2240079">.</span><span class="ident" id="2240080">CanBackquote</span><span class="op" id="2240092">(</span><span class="ident" id="2240093">s</span><span class="op" id="2240094">)</span>&nbsp;<span class="op" id="2240096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240100">quoted</span>&nbsp;<span class="op" id="2240107">=</span>&nbsp;<span class="string" id="2240109">&#34;`&#34;</span>&nbsp;<span class="op" id="2240113">+</span>&nbsp;<span class="ident" id="2240115">s</span>&nbsp;<span class="op" id="2240117">+</span>&nbsp;<span class="string" id="2240119">&#34;`&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240124">}</span>&nbsp;<span class="keyword" id="2240126">else</span>&nbsp;<span class="op" id="2240131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240135">if</span>&nbsp;<span class="ident" id="2240138">f</span><span class="op" id="2240139">.</span><span class="ident" id="2240140">plus</span>&nbsp;<span class="op" id="2240145">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240150">quoted</span>&nbsp;<span class="op" id="2240157">=</span>&nbsp;<span class="ident" id="2240159">strconv</span><span class="op" id="2240166">.</span><span class="ident" id="2240167">QuoteToASCII</span><span class="op" id="2240179">(</span><span class="ident" id="2240180">s</span><span class="op" id="2240181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240185">}</span>&nbsp;<span class="keyword" id="2240187">else</span>&nbsp;<span class="op" id="2240192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240197">quoted</span>&nbsp;<span class="op" id="2240204">=</span>&nbsp;<span class="ident" id="2240206">strconv</span><span class="op" id="2240213">.</span><span class="ident" id="2240214">Quote</span><span class="op" id="2240219">(</span><span class="ident" id="2240220">s</span><span class="op" id="2240221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240228">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240231">f</span><span class="op" id="2240232">.</span><span class="ident" id="2240233">padString</span><span class="op" id="2240242">(</span><span class="ident" id="2240243">quoted</span><span class="op" id="2240249">)</span><br>
<span class="lineno"></span><span class="op" id="2240251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2240254">//&nbsp;fmt_qc&nbsp;formats&nbsp;the&nbsp;integer&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;escaped&nbsp;Go&nbsp;character&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2240335">//&nbsp;If&nbsp;the&nbsp;character&nbsp;is&nbsp;not&nbsp;valid&nbsp;Unicode,&nbsp;it&nbsp;will&nbsp;print&nbsp;&#39;\ufffd&#39;.</span><br>
<span class="lineno">375</span><span class="keyword" id="2240401">func</span>&nbsp;<span class="op" id="2240406">(</span><span class="ident" id="2240407">f</span>&nbsp;<span class="op" id="2240409">*</span><span class="ident" id="2240410">fmt</span><span class="op" id="2240413">)</span>&nbsp;<span class="ident" id="2240415">fmt_qc</span><span class="op" id="2240421">(</span><span class="ident" id="2240422">c</span>&nbsp;<span class="ident" id="2240424">int64</span><span class="op" id="2240429">)</span>&nbsp;<span class="op" id="2240431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240434">var</span>&nbsp;<span class="ident" id="2240438">quoted</span>&nbsp;<span class="op" id="2240445">[</span><span class="op" id="2240446">]</span><span class="builtintype" id="2240447">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240453">if</span>&nbsp;<span class="ident" id="2240456">f</span><span class="op" id="2240457">.</span><span class="ident" id="2240458">plus</span>&nbsp;<span class="op" id="2240463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240467">quoted</span>&nbsp;<span class="op" id="2240474">=</span>&nbsp;<span class="ident" id="2240476">strconv</span><span class="op" id="2240483">.</span><span class="ident" id="2240484">AppendQuoteRuneToASCII</span><span class="op" id="2240506">(</span><span class="ident" id="2240507">f</span><span class="op" id="2240508">.</span><span class="ident" id="2240509">intbuf</span><span class="op" id="2240515">[</span><span class="num" id="2240516">0</span><span class="op" id="2240517">:</span><span class="num" id="2240518">0</span><span class="op" id="2240519">]</span><span class="op" id="2240520">,</span>&nbsp;<span class="builtintype" id="2240522">rune</span><span class="op" id="2240526">(</span><span class="ident" id="2240527">c</span><span class="op" id="2240528">)</span><span class="op" id="2240529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240532">}</span>&nbsp;<span class="keyword" id="2240534">else</span>&nbsp;<span class="op" id="2240539">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240543">quoted</span>&nbsp;<span class="op" id="2240550">=</span>&nbsp;<span class="ident" id="2240552">strconv</span><span class="op" id="2240559">.</span><span class="ident" id="2240560">AppendQuoteRune</span><span class="op" id="2240575">(</span><span class="ident" id="2240576">f</span><span class="op" id="2240577">.</span><span class="ident" id="2240578">intbuf</span><span class="op" id="2240584">[</span><span class="num" id="2240585">0</span><span class="op" id="2240586">:</span><span class="num" id="2240587">0</span><span class="op" id="2240588">]</span><span class="op" id="2240589">,</span>&nbsp;<span class="builtintype" id="2240591">rune</span><span class="op" id="2240595">(</span><span class="ident" id="2240596">c</span><span class="op" id="2240597">)</span><span class="op" id="2240598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240604">f</span><span class="op" id="2240605">.</span><span class="ident" id="2240606">pad</span><span class="op" id="2240609">(</span><span class="ident" id="2240610">quoted</span><span class="op" id="2240616">)</span><br>
<span class="lineno"></span><span class="op" id="2240618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="2240621">//&nbsp;floating-point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2240640">func</span>&nbsp;<span class="ident" id="2240645">doPrec</span><span class="op" id="2240651">(</span><span class="ident" id="2240652">f</span>&nbsp;<span class="op" id="2240654">*</span><span class="ident" id="2240655">fmt</span><span class="op" id="2240658">,</span>&nbsp;<span class="ident" id="2240660">def</span>&nbsp;<span class="builtintype" id="2240664">int</span><span class="op" id="2240667">)</span>&nbsp;<span class="builtintype" id="2240669">int</span>&nbsp;<span class="op" id="2240673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240676">if</span>&nbsp;<span class="ident" id="2240679">f</span><span class="op" id="2240680">.</span><span class="ident" id="2240681">precPresent</span>&nbsp;<span class="op" id="2240693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240697">return</span>&nbsp;<span class="ident" id="2240704">f</span><span class="op" id="2240705">.</span><span class="ident" id="2240706">prec</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240715">return</span>&nbsp;<span class="ident" id="2240722">def</span><br>
<span class="lineno"></span><span class="op" id="2240726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2240729">//&nbsp;formatFloat&nbsp;formats&nbsp;a&nbsp;float64;&nbsp;it&nbsp;is&nbsp;an&nbsp;efficient&nbsp;equivalent&nbsp;to&nbsp;&nbsp;f.pad(strconv.FormatFloat()...).</span><br>
<span class="lineno">395</span><span class="keyword" id="2240830">func</span>&nbsp;<span class="op" id="2240835">(</span><span class="ident" id="2240836">f</span>&nbsp;<span class="op" id="2240838">*</span><span class="ident" id="2240839">fmt</span><span class="op" id="2240842">)</span>&nbsp;<span class="ident" id="2240844">formatFloat</span><span class="op" id="2240855">(</span><span class="ident" id="2240856">v</span>&nbsp;<span class="builtintype" id="2240858">float64</span><span class="op" id="2240865">,</span>&nbsp;<span class="ident" id="2240867">verb</span>&nbsp;<span class="builtintype" id="2240872">byte</span><span class="op" id="2240876">,</span>&nbsp;<span class="ident" id="2240878">prec</span><span class="op" id="2240882">,</span>&nbsp;<span class="ident" id="2240884">n</span>&nbsp;<span class="builtintype" id="2240886">int</span><span class="op" id="2240889">)</span>&nbsp;<span class="op" id="2240891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2240894">//&nbsp;Format&nbsp;number,&nbsp;reserving&nbsp;space&nbsp;for&nbsp;leading&nbsp;+&nbsp;sign&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240959">num</span>&nbsp;<span class="op" id="2240963">:=</span>&nbsp;<span class="ident" id="2240966">strconv</span><span class="op" id="2240973">.</span><span class="ident" id="2240974">AppendFloat</span><span class="op" id="2240985">(</span><span class="ident" id="2240986">f</span><span class="op" id="2240987">.</span><span class="ident" id="2240988">intbuf</span><span class="op" id="2240994">[</span><span class="num" id="2240995">0</span><span class="op" id="2240996">:</span><span class="num" id="2240997">1</span><span class="op" id="2240998">]</span><span class="op" id="2240999">,</span>&nbsp;<span class="ident" id="2241001">v</span><span class="op" id="2241002">,</span>&nbsp;<span class="ident" id="2241004">verb</span><span class="op" id="2241008">,</span>&nbsp;<span class="ident" id="2241010">prec</span><span class="op" id="2241014">,</span>&nbsp;<span class="ident" id="2241016">n</span><span class="op" id="2241017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241020">if</span>&nbsp;<span class="ident" id="2241023">num</span><span class="op" id="2241026">[</span><span class="num" id="2241027">1</span><span class="op" id="2241028">]</span>&nbsp;<span class="op" id="2241030">==</span>&nbsp;<span class="string" id="2241033">&#39;-&#39;</span>&nbsp;<span class="op" id="2241037">||</span>&nbsp;<span class="ident" id="2241040">num</span><span class="op" id="2241043">[</span><span class="num" id="2241044">1</span><span class="op" id="2241045">]</span>&nbsp;<span class="op" id="2241047">==</span>&nbsp;<span class="string" id="2241050">&#39;+&#39;</span>&nbsp;<span class="op" id="2241054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241058">num</span>&nbsp;<span class="op" id="2241062">=</span>&nbsp;<span class="ident" id="2241064">num</span><span class="op" id="2241067">[</span><span class="num" id="2241068">1</span><span class="op" id="2241069">:</span><span class="op" id="2241070">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241073">}</span>&nbsp;<span class="keyword" id="2241075">else</span>&nbsp;<span class="op" id="2241080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241084">num</span><span class="op" id="2241087">[</span><span class="num" id="2241088">0</span><span class="op" id="2241089">]</span>&nbsp;<span class="op" id="2241091">=</span>&nbsp;<span class="string" id="2241093">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2241101">//&nbsp;Special&nbsp;handling&nbsp;for&nbsp;infinity,&nbsp;which&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;a&nbsp;number&nbsp;so&nbsp;shouldn&#39;t&nbsp;be&nbsp;padded&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241204">if</span>&nbsp;<span class="ident" id="2241207">math</span><span class="op" id="2241211">.</span><span class="ident" id="2241212">IsInf</span><span class="op" id="2241217">(</span><span class="ident" id="2241218">v</span><span class="op" id="2241219">,</span>&nbsp;<span class="num" id="2241221">0</span><span class="op" id="2241222">)</span>&nbsp;<span class="op" id="2241224">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241228">if</span>&nbsp;<span class="ident" id="2241231">f</span><span class="op" id="2241232">.</span><span class="ident" id="2241233">zero</span>&nbsp;<span class="op" id="2241238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241243">defer</span>&nbsp;<span class="keyword" id="2241249">func</span><span class="op" id="2241253">(</span><span class="op" id="2241254">)</span>&nbsp;<span class="op" id="2241256">{</span>&nbsp;<span class="ident" id="2241258">f</span><span class="op" id="2241259">.</span><span class="ident" id="2241260">zero</span>&nbsp;<span class="op" id="2241265">=</span>&nbsp;<span class="builtintype" id="2241267">true</span>&nbsp;<span class="op" id="2241272">}</span><span class="op" id="2241273">(</span><span class="op" id="2241274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241279">f</span><span class="op" id="2241280">.</span><span class="ident" id="2241281">zero</span>&nbsp;<span class="op" id="2241286">=</span>&nbsp;<span class="builtintype" id="2241288">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241299">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2241302">//&nbsp;num&nbsp;is&nbsp;now&nbsp;a&nbsp;signed&nbsp;version&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2241349">//&nbsp;If&nbsp;we&#39;re&nbsp;zero&nbsp;padding,&nbsp;want&nbsp;the&nbsp;sign&nbsp;before&nbsp;the&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2241416">//&nbsp;Achieve&nbsp;this&nbsp;by&nbsp;writing&nbsp;the&nbsp;sign&nbsp;out&nbsp;and&nbsp;then&nbsp;padding&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241495">if</span>&nbsp;<span class="ident" id="2241498">f</span><span class="op" id="2241499">.</span><span class="ident" id="2241500">zero</span>&nbsp;<span class="op" id="2241505">&amp;&amp;</span>&nbsp;<span class="ident" id="2241508">f</span><span class="op" id="2241509">.</span><span class="ident" id="2241510">widPresent</span>&nbsp;<span class="op" id="2241521">&amp;&amp;</span>&nbsp;<span class="ident" id="2241524">f</span><span class="op" id="2241525">.</span><span class="ident" id="2241526">wid</span>&nbsp;<span class="op" id="2241530">&gt;</span>&nbsp;<span class="builtinfunc" id="2241532">len</span><span class="op" id="2241535">(</span><span class="ident" id="2241536">num</span><span class="op" id="2241539">)</span>&nbsp;<span class="op" id="2241541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241545">if</span>&nbsp;<span class="ident" id="2241548">f</span><span class="op" id="2241549">.</span><span class="ident" id="2241550">space</span>&nbsp;<span class="op" id="2241556">&amp;&amp;</span>&nbsp;<span class="ident" id="2241559">v</span>&nbsp;<span class="op" id="2241561">&gt;=</span>&nbsp;<span class="num" id="2241564">0</span>&nbsp;<span class="op" id="2241566">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241571">f</span><span class="op" id="2241572">.</span><span class="ident" id="2241573">buf</span><span class="op" id="2241576">.</span><span class="ident" id="2241577">WriteByte</span><span class="op" id="2241586">(</span><span class="string" id="2241587">&#39;&nbsp;&#39;</span><span class="op" id="2241590">)</span>&nbsp;<span class="comment" id="2241592">//&nbsp;This&nbsp;is&nbsp;what&nbsp;C&nbsp;does:&nbsp;even&nbsp;with&nbsp;zero,&nbsp;f.space&nbsp;means&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241656">f</span><span class="op" id="2241657">.</span><span class="ident" id="2241658">wid</span><span class="op" id="2241661">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241666">}</span>&nbsp;<span class="keyword" id="2241668">else</span>&nbsp;<span class="keyword" id="2241673">if</span>&nbsp;<span class="ident" id="2241676">f</span><span class="op" id="2241677">.</span><span class="ident" id="2241678">plus</span>&nbsp;<span class="op" id="2241683">||</span>&nbsp;<span class="ident" id="2241686">v</span>&nbsp;<span class="op" id="2241688">&lt;</span>&nbsp;<span class="num" id="2241690">0</span>&nbsp;<span class="op" id="2241692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241697">f</span><span class="op" id="2241698">.</span><span class="ident" id="2241699">buf</span><span class="op" id="2241702">.</span><span class="ident" id="2241703">WriteByte</span><span class="op" id="2241712">(</span><span class="ident" id="2241713">num</span><span class="op" id="2241716">[</span><span class="num" id="2241717">0</span><span class="op" id="2241718">]</span><span class="op" id="2241719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241724">f</span><span class="op" id="2241725">.</span><span class="ident" id="2241726">wid</span><span class="op" id="2241729">--</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241738">f</span><span class="op" id="2241739">.</span><span class="ident" id="2241740">pad</span><span class="op" id="2241743">(</span><span class="ident" id="2241744">num</span><span class="op" id="2241747">[</span><span class="num" id="2241748">1</span><span class="op" id="2241749">:</span><span class="op" id="2241750">]</span><span class="op" id="2241751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241755">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2241766">//&nbsp;f.space&nbsp;says&nbsp;to&nbsp;replace&nbsp;a&nbsp;leading&nbsp;+&nbsp;with&nbsp;a&nbsp;space.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241820">if</span>&nbsp;<span class="ident" id="2241823">f</span><span class="op" id="2241824">.</span><span class="ident" id="2241825">space</span>&nbsp;<span class="op" id="2241831">&amp;&amp;</span>&nbsp;<span class="ident" id="2241834">num</span><span class="op" id="2241837">[</span><span class="num" id="2241838">0</span><span class="op" id="2241839">]</span>&nbsp;<span class="op" id="2241841">==</span>&nbsp;<span class="string" id="2241844">&#39;+&#39;</span>&nbsp;<span class="op" id="2241848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241852">num</span><span class="op" id="2241855">[</span><span class="num" id="2241856">0</span><span class="op" id="2241857">]</span>&nbsp;<span class="op" id="2241859">=</span>&nbsp;<span class="string" id="2241861">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241867">f</span><span class="op" id="2241868">.</span><span class="ident" id="2241869">pad</span><span class="op" id="2241872">(</span><span class="ident" id="2241873">num</span><span class="op" id="2241876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241880">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241888">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2241891">//&nbsp;Now&nbsp;we&nbsp;know&nbsp;the&nbsp;sign&nbsp;is&nbsp;attached&nbsp;directly&nbsp;to&nbsp;the&nbsp;number,&nbsp;if&nbsp;present&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2241971">//&nbsp;We&nbsp;want&nbsp;a&nbsp;sign&nbsp;if&nbsp;asked&nbsp;for,&nbsp;if&nbsp;it&#39;s&nbsp;negative,&nbsp;or&nbsp;if&nbsp;it&#39;s&nbsp;infinity&nbsp;(+Inf&nbsp;vs.&nbsp;-Inf).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242059">if</span>&nbsp;<span class="ident" id="2242062">f</span><span class="op" id="2242063">.</span><span class="ident" id="2242064">plus</span>&nbsp;<span class="op" id="2242069">||</span>&nbsp;<span class="ident" id="2242072">num</span><span class="op" id="2242075">[</span><span class="num" id="2242076">0</span><span class="op" id="2242077">]</span>&nbsp;<span class="op" id="2242079">==</span>&nbsp;<span class="string" id="2242082">&#39;-&#39;</span>&nbsp;<span class="op" id="2242086">||</span>&nbsp;<span class="ident" id="2242089">math</span><span class="op" id="2242093">.</span><span class="ident" id="2242094">IsInf</span><span class="op" id="2242099">(</span><span class="ident" id="2242100">v</span><span class="op" id="2242101">,</span>&nbsp;<span class="num" id="2242103">0</span><span class="op" id="2242104">)</span>&nbsp;<span class="op" id="2242106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242110">f</span><span class="op" id="2242111">.</span><span class="ident" id="2242112">pad</span><span class="op" id="2242115">(</span><span class="ident" id="2242116">num</span><span class="op" id="2242119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242123">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2242131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242134">//&nbsp;No&nbsp;sign&nbsp;to&nbsp;show&nbsp;and&nbsp;the&nbsp;number&nbsp;is&nbsp;positive;&nbsp;just&nbsp;print&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242214">f</span><span class="op" id="2242215">.</span><span class="ident" id="2242216">pad</span><span class="op" id="2242219">(</span><span class="ident" id="2242220">num</span><span class="op" id="2242223">[</span><span class="num" id="2242224">1</span><span class="op" id="2242225">:</span><span class="op" id="2242226">]</span><span class="op" id="2242227">)</span><br>
<span class="lineno"></span><span class="op" id="2242229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="2242232">//&nbsp;fmt_e64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2242284">func</span>&nbsp;<span class="op" id="2242289">(</span><span class="ident" id="2242290">f</span>&nbsp;<span class="op" id="2242292">*</span><span class="ident" id="2242293">fmt</span><span class="op" id="2242296">)</span>&nbsp;<span class="ident" id="2242298">fmt_e64</span><span class="op" id="2242305">(</span><span class="ident" id="2242306">v</span>&nbsp;<span class="builtintype" id="2242308">float64</span><span class="op" id="2242315">)</span>&nbsp;<span class="op" id="2242317">{</span>&nbsp;<span class="ident" id="2242319">f</span><span class="op" id="2242320">.</span><span class="ident" id="2242321">formatFloat</span><span class="op" id="2242332">(</span><span class="ident" id="2242333">v</span><span class="op" id="2242334">,</span>&nbsp;<span class="string" id="2242336">&#39;e&#39;</span><span class="op" id="2242339">,</span>&nbsp;<span class="ident" id="2242341">doPrec</span><span class="op" id="2242347">(</span><span class="ident" id="2242348">f</span><span class="op" id="2242349">,</span>&nbsp;<span class="num" id="2242351">6</span><span class="op" id="2242352">)</span><span class="op" id="2242353">,</span>&nbsp;<span class="num" id="2242355">64</span><span class="op" id="2242357">)</span>&nbsp;<span class="op" id="2242359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2242362">//&nbsp;fmt_E64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2242414">func</span>&nbsp;<span class="op" id="2242419">(</span><span class="ident" id="2242420">f</span>&nbsp;<span class="op" id="2242422">*</span><span class="ident" id="2242423">fmt</span><span class="op" id="2242426">)</span>&nbsp;<span class="ident" id="2242428">fmt_E64</span><span class="op" id="2242435">(</span><span class="ident" id="2242436">v</span>&nbsp;<span class="builtintype" id="2242438">float64</span><span class="op" id="2242445">)</span>&nbsp;<span class="op" id="2242447">{</span>&nbsp;<span class="ident" id="2242449">f</span><span class="op" id="2242450">.</span><span class="ident" id="2242451">formatFloat</span><span class="op" id="2242462">(</span><span class="ident" id="2242463">v</span><span class="op" id="2242464">,</span>&nbsp;<span class="string" id="2242466">&#39;E&#39;</span><span class="op" id="2242469">,</span>&nbsp;<span class="ident" id="2242471">doPrec</span><span class="op" id="2242477">(</span><span class="ident" id="2242478">f</span><span class="op" id="2242479">,</span>&nbsp;<span class="num" id="2242481">6</span><span class="op" id="2242482">)</span><span class="op" id="2242483">,</span>&nbsp;<span class="num" id="2242485">64</span><span class="op" id="2242487">)</span>&nbsp;<span class="op" id="2242489">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="comment" id="2242492">//&nbsp;fmt_f64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2242540">func</span>&nbsp;<span class="op" id="2242545">(</span><span class="ident" id="2242546">f</span>&nbsp;<span class="op" id="2242548">*</span><span class="ident" id="2242549">fmt</span><span class="op" id="2242552">)</span>&nbsp;<span class="ident" id="2242554">fmt_f64</span><span class="op" id="2242561">(</span><span class="ident" id="2242562">v</span>&nbsp;<span class="builtintype" id="2242564">float64</span><span class="op" id="2242571">)</span>&nbsp;<span class="op" id="2242573">{</span>&nbsp;<span class="ident" id="2242575">f</span><span class="op" id="2242576">.</span><span class="ident" id="2242577">formatFloat</span><span class="op" id="2242588">(</span><span class="ident" id="2242589">v</span><span class="op" id="2242590">,</span>&nbsp;<span class="string" id="2242592">&#39;f&#39;</span><span class="op" id="2242595">,</span>&nbsp;<span class="ident" id="2242597">doPrec</span><span class="op" id="2242603">(</span><span class="ident" id="2242604">f</span><span class="op" id="2242605">,</span>&nbsp;<span class="num" id="2242607">6</span><span class="op" id="2242608">)</span><span class="op" id="2242609">,</span>&nbsp;<span class="num" id="2242611">64</span><span class="op" id="2242613">)</span>&nbsp;<span class="op" id="2242615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2242618">//&nbsp;fmt_g64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">450</span><span class="keyword" id="2242689">func</span>&nbsp;<span class="op" id="2242694">(</span><span class="ident" id="2242695">f</span>&nbsp;<span class="op" id="2242697">*</span><span class="ident" id="2242698">fmt</span><span class="op" id="2242701">)</span>&nbsp;<span class="ident" id="2242703">fmt_g64</span><span class="op" id="2242710">(</span><span class="ident" id="2242711">v</span>&nbsp;<span class="builtintype" id="2242713">float64</span><span class="op" id="2242720">)</span>&nbsp;<span class="op" id="2242722">{</span>&nbsp;<span class="ident" id="2242724">f</span><span class="op" id="2242725">.</span><span class="ident" id="2242726">formatFloat</span><span class="op" id="2242737">(</span><span class="ident" id="2242738">v</span><span class="op" id="2242739">,</span>&nbsp;<span class="string" id="2242741">&#39;g&#39;</span><span class="op" id="2242744">,</span>&nbsp;<span class="ident" id="2242746">doPrec</span><span class="op" id="2242752">(</span><span class="ident" id="2242753">f</span><span class="op" id="2242754">,</span>&nbsp;<span class="op" id="2242756">-</span><span class="num" id="2242757">1</span><span class="op" id="2242758">)</span><span class="op" id="2242759">,</span>&nbsp;<span class="num" id="2242761">64</span><span class="op" id="2242763">)</span>&nbsp;<span class="op" id="2242765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2242768">//&nbsp;fmt_G64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2242839">func</span>&nbsp;<span class="op" id="2242844">(</span><span class="ident" id="2242845">f</span>&nbsp;<span class="op" id="2242847">*</span><span class="ident" id="2242848">fmt</span><span class="op" id="2242851">)</span>&nbsp;<span class="ident" id="2242853">fmt_G64</span><span class="op" id="2242860">(</span><span class="ident" id="2242861">v</span>&nbsp;<span class="builtintype" id="2242863">float64</span><span class="op" id="2242870">)</span>&nbsp;<span class="op" id="2242872">{</span>&nbsp;<span class="ident" id="2242874">f</span><span class="op" id="2242875">.</span><span class="ident" id="2242876">formatFloat</span><span class="op" id="2242887">(</span><span class="ident" id="2242888">v</span><span class="op" id="2242889">,</span>&nbsp;<span class="string" id="2242891">&#39;G&#39;</span><span class="op" id="2242894">,</span>&nbsp;<span class="ident" id="2242896">doPrec</span><span class="op" id="2242902">(</span><span class="ident" id="2242903">f</span><span class="op" id="2242904">,</span>&nbsp;<span class="op" id="2242906">-</span><span class="num" id="2242907">1</span><span class="op" id="2242908">)</span><span class="op" id="2242909">,</span>&nbsp;<span class="num" id="2242911">64</span><span class="op" id="2242913">)</span>&nbsp;<span class="op" id="2242915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="2242918">//&nbsp;fmt_fb64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2242993">func</span>&nbsp;<span class="op" id="2242998">(</span><span class="ident" id="2242999">f</span>&nbsp;<span class="op" id="2243001">*</span><span class="ident" id="2243002">fmt</span><span class="op" id="2243005">)</span>&nbsp;<span class="ident" id="2243007">fmt_fb64</span><span class="op" id="2243015">(</span><span class="ident" id="2243016">v</span>&nbsp;<span class="builtintype" id="2243018">float64</span><span class="op" id="2243025">)</span>&nbsp;<span class="op" id="2243027">{</span>&nbsp;<span class="ident" id="2243029">f</span><span class="op" id="2243030">.</span><span class="ident" id="2243031">formatFloat</span><span class="op" id="2243042">(</span><span class="ident" id="2243043">v</span><span class="op" id="2243044">,</span>&nbsp;<span class="string" id="2243046">&#39;b&#39;</span><span class="op" id="2243049">,</span>&nbsp;<span class="num" id="2243051">0</span><span class="op" id="2243052">,</span>&nbsp;<span class="num" id="2243054">64</span><span class="op" id="2243056">)</span>&nbsp;<span class="op" id="2243058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2243061">//&nbsp;float32</span><br>
<span class="lineno"></span><span class="comment" id="2243072">//&nbsp;cannot&nbsp;defer&nbsp;to&nbsp;float64&nbsp;versions</span><br>
<span class="lineno">460</span><span class="comment" id="2243108">//&nbsp;because&nbsp;it&nbsp;will&nbsp;get&nbsp;rounding&nbsp;wrong&nbsp;in&nbsp;corner&nbsp;cases.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2243164">//&nbsp;fmt_e32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2243216">func</span>&nbsp;<span class="op" id="2243221">(</span><span class="ident" id="2243222">f</span>&nbsp;<span class="op" id="2243224">*</span><span class="ident" id="2243225">fmt</span><span class="op" id="2243228">)</span>&nbsp;<span class="ident" id="2243230">fmt_e32</span><span class="op" id="2243237">(</span><span class="ident" id="2243238">v</span>&nbsp;<span class="builtintype" id="2243240">float32</span><span class="op" id="2243247">)</span>&nbsp;<span class="op" id="2243249">{</span>&nbsp;<span class="ident" id="2243251">f</span><span class="op" id="2243252">.</span><span class="ident" id="2243253">formatFloat</span><span class="op" id="2243264">(</span><span class="builtintype" id="2243265">float64</span><span class="op" id="2243272">(</span><span class="ident" id="2243273">v</span><span class="op" id="2243274">)</span><span class="op" id="2243275">,</span>&nbsp;<span class="string" id="2243277">&#39;e&#39;</span><span class="op" id="2243280">,</span>&nbsp;<span class="ident" id="2243282">doPrec</span><span class="op" id="2243288">(</span><span class="ident" id="2243289">f</span><span class="op" id="2243290">,</span>&nbsp;<span class="num" id="2243292">6</span><span class="op" id="2243293">)</span><span class="op" id="2243294">,</span>&nbsp;<span class="num" id="2243296">32</span><span class="op" id="2243298">)</span>&nbsp;<span class="op" id="2243300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="2243303">//&nbsp;fmt_E32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2243355">func</span>&nbsp;<span class="op" id="2243360">(</span><span class="ident" id="2243361">f</span>&nbsp;<span class="op" id="2243363">*</span><span class="ident" id="2243364">fmt</span><span class="op" id="2243367">)</span>&nbsp;<span class="ident" id="2243369">fmt_E32</span><span class="op" id="2243376">(</span><span class="ident" id="2243377">v</span>&nbsp;<span class="builtintype" id="2243379">float32</span><span class="op" id="2243386">)</span>&nbsp;<span class="op" id="2243388">{</span>&nbsp;<span class="ident" id="2243390">f</span><span class="op" id="2243391">.</span><span class="ident" id="2243392">formatFloat</span><span class="op" id="2243403">(</span><span class="builtintype" id="2243404">float64</span><span class="op" id="2243411">(</span><span class="ident" id="2243412">v</span><span class="op" id="2243413">)</span><span class="op" id="2243414">,</span>&nbsp;<span class="string" id="2243416">&#39;E&#39;</span><span class="op" id="2243419">,</span>&nbsp;<span class="ident" id="2243421">doPrec</span><span class="op" id="2243427">(</span><span class="ident" id="2243428">f</span><span class="op" id="2243429">,</span>&nbsp;<span class="num" id="2243431">6</span><span class="op" id="2243432">)</span><span class="op" id="2243433">,</span>&nbsp;<span class="num" id="2243435">32</span><span class="op" id="2243437">)</span>&nbsp;<span class="op" id="2243439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2243442">//&nbsp;fmt_f32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2243490">func</span>&nbsp;<span class="op" id="2243495">(</span><span class="ident" id="2243496">f</span>&nbsp;<span class="op" id="2243498">*</span><span class="ident" id="2243499">fmt</span><span class="op" id="2243502">)</span>&nbsp;<span class="ident" id="2243504">fmt_f32</span><span class="op" id="2243511">(</span><span class="ident" id="2243512">v</span>&nbsp;<span class="builtintype" id="2243514">float32</span><span class="op" id="2243521">)</span>&nbsp;<span class="op" id="2243523">{</span>&nbsp;<span class="ident" id="2243525">f</span><span class="op" id="2243526">.</span><span class="ident" id="2243527">formatFloat</span><span class="op" id="2243538">(</span><span class="builtintype" id="2243539">float64</span><span class="op" id="2243546">(</span><span class="ident" id="2243547">v</span><span class="op" id="2243548">)</span><span class="op" id="2243549">,</span>&nbsp;<span class="string" id="2243551">&#39;f&#39;</span><span class="op" id="2243554">,</span>&nbsp;<span class="ident" id="2243556">doPrec</span><span class="op" id="2243562">(</span><span class="ident" id="2243563">f</span><span class="op" id="2243564">,</span>&nbsp;<span class="num" id="2243566">6</span><span class="op" id="2243567">)</span><span class="op" id="2243568">,</span>&nbsp;<span class="num" id="2243570">32</span><span class="op" id="2243572">)</span>&nbsp;<span class="op" id="2243574">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="2243577">//&nbsp;fmt_g32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2243648">func</span>&nbsp;<span class="op" id="2243653">(</span><span class="ident" id="2243654">f</span>&nbsp;<span class="op" id="2243656">*</span><span class="ident" id="2243657">fmt</span><span class="op" id="2243660">)</span>&nbsp;<span class="ident" id="2243662">fmt_g32</span><span class="op" id="2243669">(</span><span class="ident" id="2243670">v</span>&nbsp;<span class="builtintype" id="2243672">float32</span><span class="op" id="2243679">)</span>&nbsp;<span class="op" id="2243681">{</span>&nbsp;<span class="ident" id="2243683">f</span><span class="op" id="2243684">.</span><span class="ident" id="2243685">formatFloat</span><span class="op" id="2243696">(</span><span class="builtintype" id="2243697">float64</span><span class="op" id="2243704">(</span><span class="ident" id="2243705">v</span><span class="op" id="2243706">)</span><span class="op" id="2243707">,</span>&nbsp;<span class="string" id="2243709">&#39;g&#39;</span><span class="op" id="2243712">,</span>&nbsp;<span class="ident" id="2243714">doPrec</span><span class="op" id="2243720">(</span><span class="ident" id="2243721">f</span><span class="op" id="2243722">,</span>&nbsp;<span class="op" id="2243724">-</span><span class="num" id="2243725">1</span><span class="op" id="2243726">)</span><span class="op" id="2243727">,</span>&nbsp;<span class="num" id="2243729">32</span><span class="op" id="2243731">)</span>&nbsp;<span class="op" id="2243733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2243736">//&nbsp;fmt_G32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">475</span><span class="keyword" id="2243807">func</span>&nbsp;<span class="op" id="2243812">(</span><span class="ident" id="2243813">f</span>&nbsp;<span class="op" id="2243815">*</span><span class="ident" id="2243816">fmt</span><span class="op" id="2243819">)</span>&nbsp;<span class="ident" id="2243821">fmt_G32</span><span class="op" id="2243828">(</span><span class="ident" id="2243829">v</span>&nbsp;<span class="builtintype" id="2243831">float32</span><span class="op" id="2243838">)</span>&nbsp;<span class="op" id="2243840">{</span>&nbsp;<span class="ident" id="2243842">f</span><span class="op" id="2243843">.</span><span class="ident" id="2243844">formatFloat</span><span class="op" id="2243855">(</span><span class="builtintype" id="2243856">float64</span><span class="op" id="2243863">(</span><span class="ident" id="2243864">v</span><span class="op" id="2243865">)</span><span class="op" id="2243866">,</span>&nbsp;<span class="string" id="2243868">&#39;G&#39;</span><span class="op" id="2243871">,</span>&nbsp;<span class="ident" id="2243873">doPrec</span><span class="op" id="2243879">(</span><span class="ident" id="2243880">f</span><span class="op" id="2243881">,</span>&nbsp;<span class="op" id="2243883">-</span><span class="num" id="2243884">1</span><span class="op" id="2243885">)</span><span class="op" id="2243886">,</span>&nbsp;<span class="num" id="2243888">32</span><span class="op" id="2243890">)</span>&nbsp;<span class="op" id="2243892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2243895">//&nbsp;fmt_fb32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2243970">func</span>&nbsp;<span class="op" id="2243975">(</span><span class="ident" id="2243976">f</span>&nbsp;<span class="op" id="2243978">*</span><span class="ident" id="2243979">fmt</span><span class="op" id="2243982">)</span>&nbsp;<span class="ident" id="2243984">fmt_fb32</span><span class="op" id="2243992">(</span><span class="ident" id="2243993">v</span>&nbsp;<span class="builtintype" id="2243995">float32</span><span class="op" id="2244002">)</span>&nbsp;<span class="op" id="2244004">{</span>&nbsp;<span class="ident" id="2244006">f</span><span class="op" id="2244007">.</span><span class="ident" id="2244008">formatFloat</span><span class="op" id="2244019">(</span><span class="builtintype" id="2244020">float64</span><span class="op" id="2244027">(</span><span class="ident" id="2244028">v</span><span class="op" id="2244029">)</span><span class="op" id="2244030">,</span>&nbsp;<span class="string" id="2244032">&#39;b&#39;</span><span class="op" id="2244035">,</span>&nbsp;<span class="num" id="2244037">0</span><span class="op" id="2244038">,</span>&nbsp;<span class="num" id="2244040">32</span><span class="op" id="2244042">)</span>&nbsp;<span class="op" id="2244044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="2244047">//&nbsp;fmt_c64&nbsp;formats&nbsp;a&nbsp;complex64&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2244101">func</span>&nbsp;<span class="op" id="2244106">(</span><span class="ident" id="2244107">f</span>&nbsp;<span class="op" id="2244109">*</span><span class="ident" id="2244110">fmt</span><span class="op" id="2244113">)</span>&nbsp;<span class="ident" id="2244115">fmt_c64</span><span class="op" id="2244122">(</span><span class="ident" id="2244123">v</span>&nbsp;<span class="builtintype" id="2244125">complex64</span><span class="op" id="2244134">,</span>&nbsp;<span class="ident" id="2244136">verb</span>&nbsp;<span class="builtintype" id="2244141">rune</span><span class="op" id="2244145">)</span>&nbsp;<span class="op" id="2244147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244150">f</span><span class="op" id="2244151">.</span><span class="ident" id="2244152">fmt_complex</span><span class="op" id="2244163">(</span><span class="builtintype" id="2244164">float64</span><span class="op" id="2244171">(</span><span class="builtinfunc" id="2244172">real</span><span class="op" id="2244176">(</span><span class="ident" id="2244177">v</span><span class="op" id="2244178">)</span><span class="op" id="2244179">)</span><span class="op" id="2244180">,</span>&nbsp;<span class="builtintype" id="2244182">float64</span><span class="op" id="2244189">(</span><span class="builtinfunc" id="2244190">imag</span><span class="op" id="2244194">(</span><span class="ident" id="2244195">v</span><span class="op" id="2244196">)</span><span class="op" id="2244197">)</span><span class="op" id="2244198">,</span>&nbsp;<span class="num" id="2244200">32</span><span class="op" id="2244202">,</span>&nbsp;<span class="ident" id="2244204">verb</span><span class="op" id="2244208">)</span><br>
<span class="lineno"></span><span class="op" id="2244210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="2244213">//&nbsp;fmt_c128&nbsp;formats&nbsp;a&nbsp;complex128&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2244269">func</span>&nbsp;<span class="op" id="2244274">(</span><span class="ident" id="2244275">f</span>&nbsp;<span class="op" id="2244277">*</span><span class="ident" id="2244278">fmt</span><span class="op" id="2244281">)</span>&nbsp;<span class="ident" id="2244283">fmt_c128</span><span class="op" id="2244291">(</span><span class="ident" id="2244292">v</span>&nbsp;<span class="builtintype" id="2244294">complex128</span><span class="op" id="2244304">,</span>&nbsp;<span class="ident" id="2244306">verb</span>&nbsp;<span class="builtintype" id="2244311">rune</span><span class="op" id="2244315">)</span>&nbsp;<span class="op" id="2244317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244320">f</span><span class="op" id="2244321">.</span><span class="ident" id="2244322">fmt_complex</span><span class="op" id="2244333">(</span><span class="builtinfunc" id="2244334">real</span><span class="op" id="2244338">(</span><span class="ident" id="2244339">v</span><span class="op" id="2244340">)</span><span class="op" id="2244341">,</span>&nbsp;<span class="builtinfunc" id="2244343">imag</span><span class="op" id="2244347">(</span><span class="ident" id="2244348">v</span><span class="op" id="2244349">)</span><span class="op" id="2244350">,</span>&nbsp;<span class="num" id="2244352">64</span><span class="op" id="2244354">,</span>&nbsp;<span class="ident" id="2244356">verb</span><span class="op" id="2244360">)</span><br>
<span class="lineno"></span><span class="op" id="2244362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span><span class="comment" id="2244365">//&nbsp;fmt_complex&nbsp;formats&nbsp;a&nbsp;complex&nbsp;number&nbsp;as&nbsp;(r+ji).</span><br>
<span class="lineno"></span><span class="keyword" id="2244416">func</span>&nbsp;<span class="op" id="2244421">(</span><span class="ident" id="2244422">f</span>&nbsp;<span class="op" id="2244424">*</span><span class="ident" id="2244425">fmt</span><span class="op" id="2244428">)</span>&nbsp;<span class="ident" id="2244430">fmt_complex</span><span class="op" id="2244441">(</span><span class="ident" id="2244442">r</span><span class="op" id="2244443">,</span>&nbsp;<span class="ident" id="2244445">j</span>&nbsp;<span class="builtintype" id="2244447">float64</span><span class="op" id="2244454">,</span>&nbsp;<span class="ident" id="2244456">size</span>&nbsp;<span class="builtintype" id="2244461">int</span><span class="op" id="2244464">,</span>&nbsp;<span class="ident" id="2244466">verb</span>&nbsp;<span class="builtintype" id="2244471">rune</span><span class="op" id="2244475">)</span>&nbsp;<span class="op" id="2244477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244480">f</span><span class="op" id="2244481">.</span><span class="ident" id="2244482">buf</span><span class="op" id="2244485">.</span><span class="ident" id="2244486">WriteByte</span><span class="op" id="2244495">(</span><span class="string" id="2244496">&#39;(&#39;</span><span class="op" id="2244499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244502">oldPlus</span>&nbsp;<span class="op" id="2244510">:=</span>&nbsp;<span class="ident" id="2244513">f</span><span class="op" id="2244514">.</span><span class="ident" id="2244515">plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244521">oldSpace</span>&nbsp;<span class="op" id="2244530">:=</span>&nbsp;<span class="ident" id="2244533">f</span><span class="op" id="2244534">.</span><span class="ident" id="2244535">space</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244542">oldWid</span>&nbsp;<span class="op" id="2244549">:=</span>&nbsp;<span class="ident" id="2244552">f</span><span class="op" id="2244553">.</span><span class="ident" id="2244554">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244559">for</span>&nbsp;<span class="ident" id="2244563">i</span>&nbsp;<span class="op" id="2244565">:=</span>&nbsp;<span class="num" id="2244568">0</span><span class="op" id="2244569">;</span>&nbsp;<span class="op" id="2244571">;</span>&nbsp;<span class="ident" id="2244573">i</span><span class="op" id="2244574">++</span>&nbsp;<span class="op" id="2244577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244581">switch</span>&nbsp;<span class="ident" id="2244588">verb</span>&nbsp;<span class="op" id="2244593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244597">case</span>&nbsp;<span class="string" id="2244602">&#39;b&#39;</span><span class="op" id="2244605">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244610">f</span><span class="op" id="2244611">.</span><span class="ident" id="2244612">formatFloat</span><span class="op" id="2244623">(</span><span class="ident" id="2244624">r</span><span class="op" id="2244625">,</span>&nbsp;<span class="string" id="2244627">&#39;b&#39;</span><span class="op" id="2244630">,</span>&nbsp;<span class="num" id="2244632">0</span><span class="op" id="2244633">,</span>&nbsp;<span class="ident" id="2244635">size</span><span class="op" id="2244639">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244643">case</span>&nbsp;<span class="string" id="2244648">&#39;e&#39;</span><span class="op" id="2244651">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244656">f</span><span class="op" id="2244657">.</span><span class="ident" id="2244658">formatFloat</span><span class="op" id="2244669">(</span><span class="ident" id="2244670">r</span><span class="op" id="2244671">,</span>&nbsp;<span class="string" id="2244673">&#39;e&#39;</span><span class="op" id="2244676">,</span>&nbsp;<span class="ident" id="2244678">doPrec</span><span class="op" id="2244684">(</span><span class="ident" id="2244685">f</span><span class="op" id="2244686">,</span>&nbsp;<span class="num" id="2244688">6</span><span class="op" id="2244689">)</span><span class="op" id="2244690">,</span>&nbsp;<span class="ident" id="2244692">size</span><span class="op" id="2244696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244700">case</span>&nbsp;<span class="string" id="2244705">&#39;E&#39;</span><span class="op" id="2244708">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244713">f</span><span class="op" id="2244714">.</span><span class="ident" id="2244715">formatFloat</span><span class="op" id="2244726">(</span><span class="ident" id="2244727">r</span><span class="op" id="2244728">,</span>&nbsp;<span class="string" id="2244730">&#39;E&#39;</span><span class="op" id="2244733">,</span>&nbsp;<span class="ident" id="2244735">doPrec</span><span class="op" id="2244741">(</span><span class="ident" id="2244742">f</span><span class="op" id="2244743">,</span>&nbsp;<span class="num" id="2244745">6</span><span class="op" id="2244746">)</span><span class="op" id="2244747">,</span>&nbsp;<span class="ident" id="2244749">size</span><span class="op" id="2244753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244757">case</span>&nbsp;<span class="string" id="2244762">&#39;f&#39;</span><span class="op" id="2244765">,</span>&nbsp;<span class="string" id="2244767">&#39;F&#39;</span><span class="op" id="2244770">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244775">f</span><span class="op" id="2244776">.</span><span class="ident" id="2244777">formatFloat</span><span class="op" id="2244788">(</span><span class="ident" id="2244789">r</span><span class="op" id="2244790">,</span>&nbsp;<span class="string" id="2244792">&#39;f&#39;</span><span class="op" id="2244795">,</span>&nbsp;<span class="ident" id="2244797">doPrec</span><span class="op" id="2244803">(</span><span class="ident" id="2244804">f</span><span class="op" id="2244805">,</span>&nbsp;<span class="num" id="2244807">6</span><span class="op" id="2244808">)</span><span class="op" id="2244809">,</span>&nbsp;<span class="ident" id="2244811">size</span><span class="op" id="2244815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244819">case</span>&nbsp;<span class="string" id="2244824">&#39;g&#39;</span><span class="op" id="2244827">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244832">f</span><span class="op" id="2244833">.</span><span class="ident" id="2244834">formatFloat</span><span class="op" id="2244845">(</span><span class="ident" id="2244846">r</span><span class="op" id="2244847">,</span>&nbsp;<span class="string" id="2244849">&#39;g&#39;</span><span class="op" id="2244852">,</span>&nbsp;<span class="ident" id="2244854">doPrec</span><span class="op" id="2244860">(</span><span class="ident" id="2244861">f</span><span class="op" id="2244862">,</span>&nbsp;<span class="op" id="2244864">-</span><span class="num" id="2244865">1</span><span class="op" id="2244866">)</span><span class="op" id="2244867">,</span>&nbsp;<span class="ident" id="2244869">size</span><span class="op" id="2244873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244877">case</span>&nbsp;<span class="string" id="2244882">&#39;G&#39;</span><span class="op" id="2244885">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244890">f</span><span class="op" id="2244891">.</span><span class="ident" id="2244892">formatFloat</span><span class="op" id="2244903">(</span><span class="ident" id="2244904">r</span><span class="op" id="2244905">,</span>&nbsp;<span class="string" id="2244907">&#39;G&#39;</span><span class="op" id="2244910">,</span>&nbsp;<span class="ident" id="2244912">doPrec</span><span class="op" id="2244918">(</span><span class="ident" id="2244919">f</span><span class="op" id="2244920">,</span>&nbsp;<span class="op" id="2244922">-</span><span class="num" id="2244923">1</span><span class="op" id="2244924">)</span><span class="op" id="2244925">,</span>&nbsp;<span class="ident" id="2244927">size</span><span class="op" id="2244931">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244939">if</span>&nbsp;<span class="ident" id="2244942">i</span>&nbsp;<span class="op" id="2244944">!=</span>&nbsp;<span class="num" id="2244947">0</span>&nbsp;<span class="op" id="2244949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244954">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2244966">//&nbsp;Imaginary&nbsp;part&nbsp;always&nbsp;has&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245005">f</span><span class="op" id="2245006">.</span><span class="ident" id="2245007">plus</span>&nbsp;<span class="op" id="2245012">=</span>&nbsp;<span class="builtintype" id="2245014">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245021">f</span><span class="op" id="2245022">.</span><span class="ident" id="2245023">space</span>&nbsp;<span class="op" id="2245029">=</span>&nbsp;<span class="builtintype" id="2245031">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245039">f</span><span class="op" id="2245040">.</span><span class="ident" id="2245041">wid</span>&nbsp;<span class="op" id="2245045">=</span>&nbsp;<span class="ident" id="2245047">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245056">r</span>&nbsp;<span class="op" id="2245058">=</span>&nbsp;<span class="ident" id="2245060">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2245063">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245066">f</span><span class="op" id="2245067">.</span><span class="ident" id="2245068">space</span>&nbsp;<span class="op" id="2245074">=</span>&nbsp;<span class="ident" id="2245076">oldSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245086">f</span><span class="op" id="2245087">.</span><span class="ident" id="2245088">plus</span>&nbsp;<span class="op" id="2245093">=</span>&nbsp;<span class="ident" id="2245095">oldPlus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245104">f</span><span class="op" id="2245105">.</span><span class="ident" id="2245106">wid</span>&nbsp;<span class="op" id="2245110">=</span>&nbsp;<span class="ident" id="2245112">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245120">f</span><span class="op" id="2245121">.</span><span class="ident" id="2245122">buf</span><span class="op" id="2245125">.</span><span class="ident" id="2245126">Write</span><span class="op" id="2245131">(</span><span class="ident" id="2245132">irparenBytes</span><span class="op" id="2245144">)</span><br>
<span class="lineno"></span><span class="op" id="2245146">}</span>
</div>
</body>
</html>
