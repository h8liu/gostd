<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3863939">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3863995">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3864049">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3864100">//&nbsp;Package&nbsp;textproto&nbsp;implements&nbsp;generic&nbsp;support&nbsp;for&nbsp;text-based&nbsp;request/response</span><br>
<span class="lineno"></span><span class="comment" id="3864180">//&nbsp;protocols&nbsp;in&nbsp;the&nbsp;style&nbsp;of&nbsp;HTTP,&nbsp;NNTP,&nbsp;and&nbsp;SMTP.</span><br>
<span class="lineno"></span><span class="comment" id="3864231">//</span><br>
<span class="lineno"></span><span class="comment" id="3864234">//&nbsp;The&nbsp;package&nbsp;provides:</span><br>
<span class="lineno"></span><span class="comment" id="3864259">//</span><br>
<span class="lineno">10</span><span class="comment" id="3864262">//&nbsp;Error,&nbsp;which&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3864319">//&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="3864332">//</span><br>
<span class="lineno"></span><span class="comment" id="3864335">//&nbsp;Pipeline,&nbsp;to&nbsp;manage&nbsp;pipelined&nbsp;requests&nbsp;and&nbsp;responses</span><br>
<span class="lineno"></span><span class="comment" id="3864391">//&nbsp;in&nbsp;a&nbsp;client.</span><br>
<span class="lineno">15</span><span class="comment" id="3864407">//</span><br>
<span class="lineno"></span><span class="comment" id="3864410">//&nbsp;Reader,&nbsp;to&nbsp;read&nbsp;numeric&nbsp;response&nbsp;code&nbsp;lines,</span><br>
<span class="lineno"></span><span class="comment" id="3864458">//&nbsp;key:&nbsp;value&nbsp;headers,&nbsp;lines&nbsp;wrapped&nbsp;with&nbsp;leading&nbsp;spaces</span><br>
<span class="lineno"></span><span class="comment" id="3864515">//&nbsp;on&nbsp;continuation&nbsp;lines,&nbsp;and&nbsp;whole&nbsp;text&nbsp;blocks&nbsp;ending</span><br>
<span class="lineno"></span><span class="comment" id="3864570">//&nbsp;with&nbsp;a&nbsp;dot&nbsp;on&nbsp;a&nbsp;line&nbsp;by&nbsp;itself.</span><br>
<span class="lineno">20</span><span class="comment" id="3864605">//</span><br>
<span class="lineno"></span><span class="comment" id="3864608">//&nbsp;Writer,&nbsp;to&nbsp;write&nbsp;dot-encoded&nbsp;text&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="comment" id="3864653">//</span><br>
<span class="lineno"></span><span class="comment" id="3864656">//&nbsp;Conn,&nbsp;a&nbsp;convenient&nbsp;packaging&nbsp;of&nbsp;Reader,&nbsp;Writer,&nbsp;and&nbsp;Pipeline&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="3864728">//&nbsp;with&nbsp;a&nbsp;single&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">25</span><span class="comment" id="3864765">//</span><br>
<span class="lineno"></span><span class="keyword" id="3864768">package</span>&nbsp;<span class="ident" id="3864776">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3864787">import</span>&nbsp;<span class="op" id="3864794">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3864797">&#34;bufio&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3864806">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3864813">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3864819">&#34;net&#34;</span><br>
<span class="lineno"></span><span class="op" id="3864825">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3864828">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="3864891">type</span>&nbsp;<span class="ident" id="3864896">Error</span>&nbsp;<span class="keyword" id="3864902">struct</span>&nbsp;<span class="op" id="3864909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864912">Code</span>&nbsp;<span class="builtintype" id="3864917">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864922">Msg</span>&nbsp;&nbsp;<span class="builtintype" id="3864927">string</span><br>
<span class="lineno"></span><span class="op" id="3864934">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3864937">func</span>&nbsp;<span class="op" id="3864942">(</span><span class="ident" id="3864943">e</span>&nbsp;<span class="op" id="3864945">*</span><span class="ident" id="3864946">Error</span><span class="op" id="3864951">)</span>&nbsp;<span class="ident" id="3864953">Error</span><span class="op" id="3864958">(</span><span class="op" id="3864959">)</span>&nbsp;<span class="builtintype" id="3864961">string</span>&nbsp;<span class="op" id="3864968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864971">return</span>&nbsp;<span class="ident" id="3864978">fmt</span><span class="op" id="3864981">.</span><span class="ident" id="3864982">Sprintf</span><span class="op" id="3864989">(</span><span class="string" id="3864990">&#34;%03d&nbsp;%s&#34;</span><span class="op" id="3864999">,</span>&nbsp;<span class="ident" id="3865001">e</span><span class="op" id="3865002">.</span><span class="ident" id="3865003">Code</span><span class="op" id="3865007">,</span>&nbsp;<span class="ident" id="3865009">e</span><span class="op" id="3865010">.</span><span class="ident" id="3865011">Msg</span><span class="op" id="3865014">)</span><br>
<span class="lineno"></span><span class="op" id="3865016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3865019">//&nbsp;A&nbsp;ProtocolError&nbsp;describes&nbsp;a&nbsp;protocol&nbsp;violation&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="3865074">//&nbsp;as&nbsp;an&nbsp;invalid&nbsp;response&nbsp;or&nbsp;a&nbsp;hung-up&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3865125">type</span>&nbsp;<span class="ident" id="3865130">ProtocolError</span>&nbsp;<span class="builtintype" id="3865144">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3865152">func</span>&nbsp;<span class="op" id="3865157">(</span><span class="ident" id="3865158">p</span>&nbsp;<span class="ident" id="3865160">ProtocolError</span><span class="op" id="3865173">)</span>&nbsp;<span class="ident" id="3865175">Error</span><span class="op" id="3865180">(</span><span class="op" id="3865181">)</span>&nbsp;<span class="builtintype" id="3865183">string</span>&nbsp;<span class="op" id="3865190">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865193">return</span>&nbsp;<span class="builtintype" id="3865200">string</span><span class="op" id="3865206">(</span><span class="ident" id="3865207">p</span><span class="op" id="3865208">)</span><br>
<span class="lineno"></span><span class="op" id="3865210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3865213">//&nbsp;A&nbsp;Conn&nbsp;represents&nbsp;a&nbsp;textual&nbsp;network&nbsp;protocol&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3865273">//&nbsp;It&nbsp;consists&nbsp;of&nbsp;a&nbsp;Reader&nbsp;and&nbsp;Writer&nbsp;to&nbsp;manage&nbsp;I/O</span><br>
<span class="lineno">55</span><span class="comment" id="3865325">//&nbsp;and&nbsp;a&nbsp;Pipeline&nbsp;to&nbsp;sequence&nbsp;concurrent&nbsp;requests&nbsp;on&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3865394">//&nbsp;These&nbsp;embedded&nbsp;types&nbsp;carry&nbsp;methods&nbsp;with&nbsp;them;</span><br>
<span class="lineno"></span><span class="comment" id="3865443">//&nbsp;see&nbsp;the&nbsp;documentation&nbsp;of&nbsp;those&nbsp;types&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="3865496">type</span>&nbsp;<span class="ident" id="3865501">Conn</span>&nbsp;<span class="keyword" id="3865506">struct</span>&nbsp;<span class="op" id="3865513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865516">Reader</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865524">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865532">Pipeline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865542">conn</span>&nbsp;<span class="ident" id="3865547">io</span><span class="op" id="3865549">.</span><span class="ident" id="3865550">ReadWriteCloser</span><br>
<span class="lineno"></span><span class="op" id="3865566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="3865569">//&nbsp;NewConn&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;using&nbsp;conn&nbsp;for&nbsp;I/O.</span><br>
<span class="lineno"></span><span class="keyword" id="3865619">func</span>&nbsp;<span class="ident" id="3865624">NewConn</span><span class="op" id="3865631">(</span><span class="ident" id="3865632">conn</span>&nbsp;<span class="ident" id="3865637">io</span><span class="op" id="3865639">.</span><span class="ident" id="3865640">ReadWriteCloser</span><span class="op" id="3865655">)</span>&nbsp;<span class="op" id="3865657">*</span><span class="ident" id="3865658">Conn</span>&nbsp;<span class="op" id="3865663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865666">return</span>&nbsp;<span class="op" id="3865673">&amp;</span><span class="ident" id="3865674">Conn</span><span class="op" id="3865678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865682">Reader</span><span class="op" id="3865688">:</span>&nbsp;<span class="ident" id="3865690">Reader</span><span class="op" id="3865696">{</span><span class="ident" id="3865697">R</span><span class="op" id="3865698">:</span>&nbsp;<span class="ident" id="3865700">bufio</span><span class="op" id="3865705">.</span><span class="ident" id="3865706">NewReader</span><span class="op" id="3865715">(</span><span class="ident" id="3865716">conn</span><span class="op" id="3865720">)</span><span class="op" id="3865721">}</span><span class="op" id="3865722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865726">Writer</span><span class="op" id="3865732">:</span>&nbsp;<span class="ident" id="3865734">Writer</span><span class="op" id="3865740">{</span><span class="ident" id="3865741">W</span><span class="op" id="3865742">:</span>&nbsp;<span class="ident" id="3865744">bufio</span><span class="op" id="3865749">.</span><span class="ident" id="3865750">NewWriter</span><span class="op" id="3865759">(</span><span class="ident" id="3865760">conn</span><span class="op" id="3865764">)</span><span class="op" id="3865765">}</span><span class="op" id="3865766">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865770">conn</span><span class="op" id="3865774">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3865778">conn</span><span class="op" id="3865782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865785">}</span><br>
<span class="lineno"></span><span class="op" id="3865787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3865790">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">75</span><span class="keyword" id="3865822">func</span>&nbsp;<span class="op" id="3865827">(</span><span class="ident" id="3865828">c</span>&nbsp;<span class="op" id="3865830">*</span><span class="ident" id="3865831">Conn</span><span class="op" id="3865835">)</span>&nbsp;<span class="ident" id="3865837">Close</span><span class="op" id="3865842">(</span><span class="op" id="3865843">)</span>&nbsp;<span class="builtintype" id="3865845">error</span>&nbsp;<span class="op" id="3865851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865854">return</span>&nbsp;<span class="ident" id="3865861">c</span><span class="op" id="3865862">.</span><span class="ident" id="3865863">conn</span><span class="op" id="3865867">.</span><span class="ident" id="3865868">Close</span><span class="op" id="3865873">(</span><span class="op" id="3865874">)</span><br>
<span class="lineno"></span><span class="op" id="3865876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3865879">//&nbsp;Dial&nbsp;connects&nbsp;to&nbsp;the&nbsp;given&nbsp;address&nbsp;on&nbsp;the&nbsp;given&nbsp;network&nbsp;using&nbsp;net.Dial</span><br>
<span class="lineno">80</span><span class="comment" id="3865953">//&nbsp;and&nbsp;then&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3866004">func</span>&nbsp;<span class="ident" id="3866009">Dial</span><span class="op" id="3866013">(</span><span class="ident" id="3866014">network</span><span class="op" id="3866021">,</span>&nbsp;<span class="ident" id="3866023">addr</span>&nbsp;<span class="builtintype" id="3866028">string</span><span class="op" id="3866034">)</span>&nbsp;<span class="op" id="3866036">(</span><span class="op" id="3866037">*</span><span class="ident" id="3866038">Conn</span><span class="op" id="3866042">,</span>&nbsp;<span class="builtintype" id="3866044">error</span><span class="op" id="3866049">)</span>&nbsp;<span class="op" id="3866051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866054">c</span><span class="op" id="3866055">,</span>&nbsp;<span class="ident" id="3866057">err</span>&nbsp;<span class="op" id="3866061">:=</span>&nbsp;<span class="ident" id="3866064">net</span><span class="op" id="3866067">.</span><span class="ident" id="3866068">Dial</span><span class="op" id="3866072">(</span><span class="ident" id="3866073">network</span><span class="op" id="3866080">,</span>&nbsp;<span class="ident" id="3866082">addr</span><span class="op" id="3866086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866089">if</span>&nbsp;<span class="ident" id="3866092">err</span>&nbsp;<span class="op" id="3866096">!=</span>&nbsp;<span class="ident" id="3866099">nil</span>&nbsp;<span class="op" id="3866103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866107">return</span>&nbsp;<span class="ident" id="3866114">nil</span><span class="op" id="3866117">,</span>&nbsp;<span class="ident" id="3866119">err</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866127">return</span>&nbsp;<span class="ident" id="3866134">NewConn</span><span class="op" id="3866141">(</span><span class="ident" id="3866142">c</span><span class="op" id="3866143">)</span><span class="op" id="3866144">,</span>&nbsp;<span class="ident" id="3866146">nil</span><br>
<span class="lineno"></span><span class="op" id="3866150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3866153">//&nbsp;Cmd&nbsp;is&nbsp;a&nbsp;convenience&nbsp;method&nbsp;that&nbsp;sends&nbsp;a&nbsp;command&nbsp;after</span><br>
<span class="lineno">90</span><span class="comment" id="3866211">//&nbsp;waiting&nbsp;its&nbsp;turn&nbsp;in&nbsp;the&nbsp;pipeline.&nbsp;&nbsp;The&nbsp;command&nbsp;text&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3866273">//&nbsp;result&nbsp;of&nbsp;formatting&nbsp;format&nbsp;with&nbsp;args&nbsp;and&nbsp;appending&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="comment" id="3866334">//&nbsp;Cmd&nbsp;returns&nbsp;the&nbsp;id&nbsp;of&nbsp;the&nbsp;command,&nbsp;for&nbsp;use&nbsp;with&nbsp;StartResponse&nbsp;and&nbsp;EndResponse.</span><br>
<span class="lineno"></span><span class="comment" id="3866416">//</span><br>
<span class="lineno"></span><span class="comment" id="3866419">//&nbsp;For&nbsp;example,&nbsp;a&nbsp;client&nbsp;might&nbsp;run&nbsp;a&nbsp;HELP&nbsp;command&nbsp;that&nbsp;returns&nbsp;a&nbsp;dot-body</span><br>
<span class="lineno">95</span><span class="comment" id="3866493">//&nbsp;by&nbsp;using:</span><br>
<span class="lineno"></span><span class="comment" id="3866506">//</span><br>
<span class="lineno"></span><span class="comment" id="3866509">//&nbsp;&nbsp;&nbsp;&nbspid,&nbsp;err&nbsp;:=&nbsp;c.Cmd(&#34;HELP&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3866537">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3866556">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno">100</span><span class="comment" id="3866576">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3866581">//</span><br>
<span class="lineno"></span><span class="comment" id="3866584">//&nbsp;&nbsp;&nbsp;&nbspc.StartResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="3866607">//&nbsp;&nbsp;&nbsp;&nbspdefer&nbsp;c.EndResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="3866634">//</span><br>
<span class="lineno">105</span><span class="comment" id="3866637">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;_,&nbsp;_,&nbsp;err&nbsp;=&nbsp;c.ReadCodeLine(110);&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3866689">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="3866709">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3866714">//&nbsp;&nbsp;&nbsp;&nbsptext,&nbsp;err&nbsp;:=&nbsp;c.ReadDotBytes()</span><br>
<span class="lineno"></span><span class="comment" id="3866747">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno">110</span><span class="comment" id="3866766">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="3866786">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3866791">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;c.ReadCodeLine(250)</span><br>
<span class="lineno"></span><span class="comment" id="3866821">//</span><br>
<span class="lineno"></span><span class="keyword" id="3866824">func</span>&nbsp;<span class="op" id="3866829">(</span><span class="ident" id="3866830">c</span>&nbsp;<span class="op" id="3866832">*</span><span class="ident" id="3866833">Conn</span><span class="op" id="3866837">)</span>&nbsp;<span class="ident" id="3866839">Cmd</span><span class="op" id="3866842">(</span><span class="ident" id="3866843">format</span>&nbsp;<span class="builtintype" id="3866850">string</span><span class="op" id="3866856">,</span>&nbsp;<span class="ident" id="3866858">args</span>&nbsp;<span class="op" id="3866863">...</span><span class="keyword" id="3866866">interface</span><span class="op" id="3866875">{</span><span class="op" id="3866876">}</span><span class="op" id="3866877">)</span>&nbsp;<span class="op" id="3866879">(</span><span class="ident" id="3866880">id</span>&nbsp;<span class="builtintype" id="3866883">uint</span><span class="op" id="3866887">,</span>&nbsp;<span class="ident" id="3866889">err</span>&nbsp;<span class="builtintype" id="3866893">error</span><span class="op" id="3866898">)</span>&nbsp;<span class="op" id="3866900">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866903">id</span>&nbsp;<span class="op" id="3866906">=</span>&nbsp;<span class="ident" id="3866908">c</span><span class="op" id="3866909">.</span><span class="ident" id="3866910">Next</span><span class="op" id="3866914">(</span><span class="op" id="3866915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866918">c</span><span class="op" id="3866919">.</span><span class="ident" id="3866920">StartRequest</span><span class="op" id="3866932">(</span><span class="ident" id="3866933">id</span><span class="op" id="3866935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866938">err</span>&nbsp;<span class="op" id="3866942">=</span>&nbsp;<span class="ident" id="3866944">c</span><span class="op" id="3866945">.</span><span class="ident" id="3866946">PrintfLine</span><span class="op" id="3866956">(</span><span class="ident" id="3866957">format</span><span class="op" id="3866963">,</span>&nbsp;<span class="ident" id="3866965">args</span><span class="op" id="3866969">...</span><span class="op" id="3866972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866975">c</span><span class="op" id="3866976">.</span><span class="ident" id="3866977">EndRequest</span><span class="op" id="3866987">(</span><span class="ident" id="3866988">id</span><span class="op" id="3866990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866993">if</span>&nbsp;<span class="ident" id="3866996">err</span>&nbsp;<span class="op" id="3867000">!=</span>&nbsp;<span class="ident" id="3867003">nil</span>&nbsp;<span class="op" id="3867007">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867011">return</span>&nbsp;<span class="num" id="3867018">0</span><span class="op" id="3867019">,</span>&nbsp;<span class="ident" id="3867021">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867029">return</span>&nbsp;<span class="ident" id="3867036">id</span><span class="op" id="3867038">,</span>&nbsp;<span class="ident" id="3867040">nil</span><br>
<span class="lineno"></span><span class="op" id="3867044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3867047">//&nbsp;TrimString&nbsp;returns&nbsp;s&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3867113">func</span>&nbsp;<span class="ident" id="3867118">TrimString</span><span class="op" id="3867128">(</span><span class="ident" id="3867129">s</span>&nbsp;<span class="builtintype" id="3867131">string</span><span class="op" id="3867137">)</span>&nbsp;<span class="builtintype" id="3867139">string</span>&nbsp;<span class="op" id="3867146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867149">for</span>&nbsp;<span class="builtinfunc" id="3867153">len</span><span class="op" id="3867156">(</span><span class="ident" id="3867157">s</span><span class="op" id="3867158">)</span>&nbsp;<span class="op" id="3867160">&gt;</span>&nbsp;<span class="num" id="3867162">0</span>&nbsp;<span class="op" id="3867164">&amp;&amp;</span>&nbsp;<span class="ident" id="3867167">isASCIISpace</span><span class="op" id="3867179">(</span><span class="ident" id="3867180">s</span><span class="op" id="3867181">[</span><span class="num" id="3867182">0</span><span class="op" id="3867183">]</span><span class="op" id="3867184">)</span>&nbsp;<span class="op" id="3867186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867190">s</span>&nbsp;<span class="op" id="3867192">=</span>&nbsp;<span class="ident" id="3867194">s</span><span class="op" id="3867195">[</span><span class="num" id="3867196">1</span><span class="op" id="3867197">:</span><span class="op" id="3867198">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867201">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867204">for</span>&nbsp;<span class="builtinfunc" id="3867208">len</span><span class="op" id="3867211">(</span><span class="ident" id="3867212">s</span><span class="op" id="3867213">)</span>&nbsp;<span class="op" id="3867215">&gt;</span>&nbsp;<span class="num" id="3867217">0</span>&nbsp;<span class="op" id="3867219">&amp;&amp;</span>&nbsp;<span class="ident" id="3867222">isASCIISpace</span><span class="op" id="3867234">(</span><span class="ident" id="3867235">s</span><span class="op" id="3867236">[</span><span class="builtinfunc" id="3867237">len</span><span class="op" id="3867240">(</span><span class="ident" id="3867241">s</span><span class="op" id="3867242">)</span><span class="op" id="3867243">-</span><span class="num" id="3867244">1</span><span class="op" id="3867245">]</span><span class="op" id="3867246">)</span>&nbsp;<span class="op" id="3867248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867252">s</span>&nbsp;<span class="op" id="3867254">=</span>&nbsp;<span class="ident" id="3867256">s</span><span class="op" id="3867257">[</span><span class="op" id="3867258">:</span><span class="builtinfunc" id="3867259">len</span><span class="op" id="3867262">(</span><span class="ident" id="3867263">s</span><span class="op" id="3867264">)</span><span class="op" id="3867265">-</span><span class="num" id="3867266">1</span><span class="op" id="3867267">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867273">return</span>&nbsp;<span class="ident" id="3867280">s</span><br>
<span class="lineno"></span><span class="op" id="3867282">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="3867285">//&nbsp;TrimBytes&nbsp;returns&nbsp;b&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3867350">func</span>&nbsp;<span class="ident" id="3867355">TrimBytes</span><span class="op" id="3867364">(</span><span class="ident" id="3867365">b</span>&nbsp;<span class="op" id="3867367">[</span><span class="op" id="3867368">]</span><span class="builtintype" id="3867369">byte</span><span class="op" id="3867373">)</span>&nbsp;<span class="op" id="3867375">[</span><span class="op" id="3867376">]</span><span class="builtintype" id="3867377">byte</span>&nbsp;<span class="op" id="3867382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867385">for</span>&nbsp;<span class="builtinfunc" id="3867389">len</span><span class="op" id="3867392">(</span><span class="ident" id="3867393">b</span><span class="op" id="3867394">)</span>&nbsp;<span class="op" id="3867396">&gt;</span>&nbsp;<span class="num" id="3867398">0</span>&nbsp;<span class="op" id="3867400">&amp;&amp;</span>&nbsp;<span class="ident" id="3867403">isASCIISpace</span><span class="op" id="3867415">(</span><span class="ident" id="3867416">b</span><span class="op" id="3867417">[</span><span class="num" id="3867418">0</span><span class="op" id="3867419">]</span><span class="op" id="3867420">)</span>&nbsp;<span class="op" id="3867422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867426">b</span>&nbsp;<span class="op" id="3867428">=</span>&nbsp;<span class="ident" id="3867430">b</span><span class="op" id="3867431">[</span><span class="num" id="3867432">1</span><span class="op" id="3867433">:</span><span class="op" id="3867434">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867440">for</span>&nbsp;<span class="builtinfunc" id="3867444">len</span><span class="op" id="3867447">(</span><span class="ident" id="3867448">b</span><span class="op" id="3867449">)</span>&nbsp;<span class="op" id="3867451">&gt;</span>&nbsp;<span class="num" id="3867453">0</span>&nbsp;<span class="op" id="3867455">&amp;&amp;</span>&nbsp;<span class="ident" id="3867458">isASCIISpace</span><span class="op" id="3867470">(</span><span class="ident" id="3867471">b</span><span class="op" id="3867472">[</span><span class="builtinfunc" id="3867473">len</span><span class="op" id="3867476">(</span><span class="ident" id="3867477">b</span><span class="op" id="3867478">)</span><span class="op" id="3867479">-</span><span class="num" id="3867480">1</span><span class="op" id="3867481">]</span><span class="op" id="3867482">)</span>&nbsp;<span class="op" id="3867484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867488">b</span>&nbsp;<span class="op" id="3867490">=</span>&nbsp;<span class="ident" id="3867492">b</span><span class="op" id="3867493">[</span><span class="op" id="3867494">:</span><span class="builtinfunc" id="3867495">len</span><span class="op" id="3867498">(</span><span class="ident" id="3867499">b</span><span class="op" id="3867500">)</span><span class="op" id="3867501">-</span><span class="num" id="3867502">1</span><span class="op" id="3867503">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867509">return</span>&nbsp;<span class="ident" id="3867516">b</span><br>
<span class="lineno">145</span><span class="op" id="3867518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3867521">func</span>&nbsp;<span class="ident" id="3867526">isASCIISpace</span><span class="op" id="3867538">(</span><span class="ident" id="3867539">b</span>&nbsp;<span class="builtintype" id="3867541">byte</span><span class="op" id="3867545">)</span>&nbsp;<span class="builtintype" id="3867547">bool</span>&nbsp;<span class="op" id="3867552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867555">return</span>&nbsp;<span class="ident" id="3867562">b</span>&nbsp;<span class="op" id="3867564">==</span>&nbsp;<span class="string" id="3867567">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3867571">||</span>&nbsp;<span class="ident" id="3867574">b</span>&nbsp;<span class="op" id="3867576">==</span>&nbsp;<span class="string" id="3867579">&#39;\t&#39;</span>&nbsp;<span class="op" id="3867584">||</span>&nbsp;<span class="ident" id="3867587">b</span>&nbsp;<span class="op" id="3867589">==</span>&nbsp;<span class="string" id="3867592">&#39;\n&#39;</span>&nbsp;<span class="op" id="3867597">||</span>&nbsp;<span class="ident" id="3867600">b</span>&nbsp;<span class="op" id="3867602">==</span>&nbsp;<span class="string" id="3867605">&#39;\r&#39;</span><br>
<span class="lineno"></span><span class="op" id="3867610">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="3867613">func</span>&nbsp;<span class="ident" id="3867618">isASCIILetter</span><span class="op" id="3867631">(</span><span class="ident" id="3867632">b</span>&nbsp;<span class="builtintype" id="3867634">byte</span><span class="op" id="3867638">)</span>&nbsp;<span class="builtintype" id="3867640">bool</span>&nbsp;<span class="op" id="3867645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867648">b</span>&nbsp;<span class="op" id="3867650">|=</span>&nbsp;<span class="num" id="3867653">0x20</span>&nbsp;<span class="comment" id="3867658">//&nbsp;make&nbsp;lower&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867678">return</span>&nbsp;<span class="string" id="3867685">&#39;a&#39;</span>&nbsp;<span class="op" id="3867689">&lt;=</span>&nbsp;<span class="ident" id="3867692">b</span>&nbsp;<span class="op" id="3867694">&amp;&amp;</span>&nbsp;<span class="ident" id="3867697">b</span>&nbsp;<span class="op" id="3867699">&lt;=</span>&nbsp;<span class="string" id="3867702">&#39;z&#39;</span><br>
<span class="lineno"></span><span class="op" id="3867706">}</span>
</div>
</body>
</html>
