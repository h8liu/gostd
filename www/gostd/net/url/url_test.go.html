<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/url</h2>
<ul>
<li><a href="/gostd/net/url/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/url/url.go.html">url.go</a></li>
<li><a href="/gostd/net/url/url_test.go.html" class="current">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8484821">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8484876">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8484930">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8484981">package</span>&nbsp;<span class="ident" id="8484989">url</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8484994">import</span>&nbsp;<span class="op" id="8485001">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485004">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485011">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485022">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485033">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8485043">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8485046">type</span>&nbsp;<span class="ident" id="8485051">URLTest</span>&nbsp;<span class="keyword" id="8485059">struct</span>&nbsp;<span class="op" id="8485066">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485069">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8485079">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485087">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485097">*</span><span class="ident" id="8485098">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485103">roundtrip</span>&nbsp;<span class="builtintype" id="8485113">string</span>&nbsp;<span class="comment" id="8485120">//&nbsp;expected&nbsp;result&nbsp;of&nbsp;reserializing&nbsp;the&nbsp;URL;&nbsp;empty&nbsp;means&nbsp;same&nbsp;as&nbsp;&#34;in&#34;.</span><br>
<span class="lineno"></span><span class="op" id="8485191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8485194">var</span>&nbsp;<span class="ident" id="8485198">urltests</span>&nbsp;<span class="op" id="8485207">=</span>&nbsp;<span class="op" id="8485209">[</span><span class="op" id="8485210">]</span><span class="ident" id="8485211">URLTest</span><span class="op" id="8485218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8485221">//&nbsp;no&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485237">&#34;http://www.google.com&#34;</span><span class="op" id="8485260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485264">&amp;</span><span class="ident" id="8485265">URL</span><span class="op" id="8485268">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485273">Scheme</span><span class="op" id="8485279">:</span>&nbsp;<span class="string" id="8485281">&#34;http&#34;</span><span class="op" id="8485287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485292">Host</span><span class="op" id="8485296">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8485300">&#34;www.google.com&#34;</span><span class="op" id="8485316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485320">}</span><span class="op" id="8485321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485325">&#34;&#34;</span><span class="op" id="8485327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485330">}</span><span class="op" id="8485331">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8485334">//&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485347">&#34;http://www.google.com/&#34;</span><span class="op" id="8485371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485375">&amp;</span><span class="ident" id="8485376">URL</span><span class="op" id="8485379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485384">Scheme</span><span class="op" id="8485390">:</span>&nbsp;<span class="string" id="8485392">&#34;http&#34;</span><span class="op" id="8485398">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485403">Host</span><span class="op" id="8485407">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8485411">&#34;www.google.com&#34;</span><span class="op" id="8485427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485432">Path</span><span class="op" id="8485436">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8485440">&#34;/&#34;</span><span class="op" id="8485443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485447">}</span><span class="op" id="8485448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485452">&#34;&#34;</span><span class="op" id="8485454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485457">}</span><span class="op" id="8485458">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8485461">//&nbsp;path&nbsp;with&nbsp;hex&nbsp;escaping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485492">&#34;http://www.google.com/file%20one%26two&#34;</span><span class="op" id="8485532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485536">&amp;</span><span class="ident" id="8485537">URL</span><span class="op" id="8485540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485545">Scheme</span><span class="op" id="8485551">:</span>&nbsp;<span class="string" id="8485553">&#34;http&#34;</span><span class="op" id="8485559">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485564">Host</span><span class="op" id="8485568">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8485572">&#34;www.google.com&#34;</span><span class="op" id="8485588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485593">Path</span><span class="op" id="8485597">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8485601">&#34;/file&nbsp;one&amp;two&#34;</span><span class="op" id="8485616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485620">}</span><span class="op" id="8485621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485625">&#34;http://www.google.com/file%20one&amp;two&#34;</span><span class="op" id="8485663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485666">}</span><span class="op" id="8485667">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8485670">//&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485683">&#34;ftp://webmaster@www.google.com/&#34;</span><span class="op" id="8485716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485720">&amp;</span><span class="ident" id="8485721">URL</span><span class="op" id="8485724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485729">Scheme</span><span class="op" id="8485735">:</span>&nbsp;<span class="string" id="8485737">&#34;ftp&#34;</span><span class="op" id="8485742">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485747">User</span><span class="op" id="8485751">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8485755">User</span><span class="op" id="8485759">(</span><span class="string" id="8485760">&#34;webmaster&#34;</span><span class="op" id="8485771">)</span><span class="op" id="8485772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485777">Host</span><span class="op" id="8485781">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8485785">&#34;www.google.com&#34;</span><span class="op" id="8485801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485806">Path</span><span class="op" id="8485810">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8485814">&#34;/&#34;</span><span class="op" id="8485817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485821">}</span><span class="op" id="8485822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485826">&#34;&#34;</span><span class="op" id="8485828">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485831">}</span><span class="op" id="8485832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8485835">//&nbsp;escape&nbsp;sequence&nbsp;in&nbsp;username</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8485871">&#34;ftp://john%20doe@www.google.com/&#34;</span><span class="op" id="8485905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8485909">&amp;</span><span class="ident" id="8485910">URL</span><span class="op" id="8485913">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485918">Scheme</span><span class="op" id="8485924">:</span>&nbsp;<span class="string" id="8485926">&#34;ftp&#34;</span><span class="op" id="8485931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485936">User</span><span class="op" id="8485940">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8485944">User</span><span class="op" id="8485948">(</span><span class="string" id="8485949">&#34;john&nbsp;doe&#34;</span><span class="op" id="8485959">)</span><span class="op" id="8485960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485965">Host</span><span class="op" id="8485969">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8485973">&#34;www.google.com&#34;</span><span class="op" id="8485989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8485994">Path</span><span class="op" id="8485998">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8486002">&#34;/&#34;</span><span class="op" id="8486005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486009">}</span><span class="op" id="8486010">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486014">&#34;ftp://john%20doe@www.google.com/&#34;</span><span class="op" id="8486048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486051">}</span><span class="op" id="8486052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8486055">//&nbsp;query</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486069">&#34;http://www.google.com/?q=go+language&#34;</span><span class="op" id="8486107">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486111">&amp;</span><span class="ident" id="8486112">URL</span><span class="op" id="8486115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486120">Scheme</span><span class="op" id="8486126">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8486130">&#34;http&#34;</span><span class="op" id="8486136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486141">Host</span><span class="op" id="8486145">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486151">&#34;www.google.com&#34;</span><span class="op" id="8486167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486172">Path</span><span class="op" id="8486176">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486182">&#34;/&#34;</span><span class="op" id="8486185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486190">RawQuery</span><span class="op" id="8486198">:</span>&nbsp;<span class="string" id="8486200">&#34;q=go+language&#34;</span><span class="op" id="8486215">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486219">}</span><span class="op" id="8486220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486224">&#34;&#34;</span><span class="op" id="8486226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486229">}</span><span class="op" id="8486230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8486233">//&nbsp;query&nbsp;with&nbsp;hex&nbsp;escaping:&nbsp;NOT&nbsp;parsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486273">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486277">&#34;http://www.google.com/?q=go%20language&#34;</span><span class="op" id="8486317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486321">&amp;</span><span class="ident" id="8486322">URL</span><span class="op" id="8486325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486330">Scheme</span><span class="op" id="8486336">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8486340">&#34;http&#34;</span><span class="op" id="8486346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486351">Host</span><span class="op" id="8486355">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486361">&#34;www.google.com&#34;</span><span class="op" id="8486377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486382">Path</span><span class="op" id="8486386">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486392">&#34;/&#34;</span><span class="op" id="8486395">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486400">RawQuery</span><span class="op" id="8486408">:</span>&nbsp;<span class="string" id="8486410">&#34;q=go%20language&#34;</span><span class="op" id="8486427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486431">}</span><span class="op" id="8486432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486436">&#34;&#34;</span><span class="op" id="8486438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486441">}</span><span class="op" id="8486442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8486445">//&nbsp;%20&nbsp;outside&nbsp;query</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486471">&#34;http://www.google.com/a%20b?q=c+d&#34;</span><span class="op" id="8486506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486510">&amp;</span><span class="ident" id="8486511">URL</span><span class="op" id="8486514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486519">Scheme</span><span class="op" id="8486525">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8486529">&#34;http&#34;</span><span class="op" id="8486535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486540">Host</span><span class="op" id="8486544">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486550">&#34;www.google.com&#34;</span><span class="op" id="8486566">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486571">Path</span><span class="op" id="8486575">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486581">&#34;/a&nbsp;b&#34;</span><span class="op" id="8486587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486592">RawQuery</span><span class="op" id="8486600">:</span>&nbsp;<span class="string" id="8486602">&#34;q=c+d&#34;</span><span class="op" id="8486609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486613">}</span><span class="op" id="8486614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486618">&#34;&#34;</span><span class="op" id="8486620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486623">}</span><span class="op" id="8486624">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8486627">//&nbsp;path&nbsp;without&nbsp;leading&nbsp;/,&nbsp;so&nbsp;no&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486673">&#34;http:www.google.com/?q=go+language&#34;</span><span class="op" id="8486709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486713">&amp;</span><span class="ident" id="8486714">URL</span><span class="op" id="8486717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486722">Scheme</span><span class="op" id="8486728">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8486732">&#34;http&#34;</span><span class="op" id="8486738">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486743">Opaque</span><span class="op" id="8486749">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8486753">&#34;www.google.com/&#34;</span><span class="op" id="8486770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486775">RawQuery</span><span class="op" id="8486783">:</span>&nbsp;<span class="string" id="8486785">&#34;q=go+language&#34;</span><span class="op" id="8486800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486804">}</span><span class="op" id="8486805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486809">&#34;http:www.google.com/?q=go+language&#34;</span><span class="op" id="8486845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486848">}</span><span class="op" id="8486849">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8486852">//&nbsp;path&nbsp;without&nbsp;leading&nbsp;/,&nbsp;so&nbsp;no&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8486898">&#34;http:%2f%2fwww.google.com/?q=go+language&#34;</span><span class="op" id="8486940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8486944">&amp;</span><span class="ident" id="8486945">URL</span><span class="op" id="8486948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486953">Scheme</span><span class="op" id="8486959">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8486963">&#34;http&#34;</span><span class="op" id="8486969">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8486974">Opaque</span><span class="op" id="8486980">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8486984">&#34;%2f%2fwww.google.com/&#34;</span><span class="op" id="8487007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487012">RawQuery</span><span class="op" id="8487020">:</span>&nbsp;<span class="string" id="8487022">&#34;q=go+language&#34;</span><span class="op" id="8487037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487041">}</span><span class="op" id="8487042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487046">&#34;http:%2f%2fwww.google.com/?q=go+language&#34;</span><span class="op" id="8487088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487091">}</span><span class="op" id="8487092">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8487095">//&nbsp;non-authority&nbsp;with&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487127">&#34;mailto:/webmaster@golang.org&#34;</span><span class="op" id="8487157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487161">&amp;</span><span class="ident" id="8487162">URL</span><span class="op" id="8487165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487170">Scheme</span><span class="op" id="8487176">:</span>&nbsp;<span class="string" id="8487178">&#34;mailto&#34;</span><span class="op" id="8487186">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487191">Path</span><span class="op" id="8487195">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8487199">&#34;/webmaster@golang.org&#34;</span><span class="op" id="8487222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487226">}</span><span class="op" id="8487227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487231">&#34;mailto:///webmaster@golang.org&#34;</span><span class="op" id="8487263">,</span>&nbsp;<span class="comment" id="8487265">//&nbsp;unfortunate&nbsp;compromise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487292">}</span><span class="op" id="8487293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8487296">//&nbsp;non-authority</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487318">&#34;mailto:webmaster@golang.org&#34;</span><span class="op" id="8487347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487351">&amp;</span><span class="ident" id="8487352">URL</span><span class="op" id="8487355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487360">Scheme</span><span class="op" id="8487366">:</span>&nbsp;<span class="string" id="8487368">&#34;mailto&#34;</span><span class="op" id="8487376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487381">Opaque</span><span class="op" id="8487387">:</span>&nbsp;<span class="string" id="8487389">&#34;webmaster@golang.org&#34;</span><span class="op" id="8487411">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487415">}</span><span class="op" id="8487416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487420">&#34;&#34;</span><span class="op" id="8487422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487425">}</span><span class="op" id="8487426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8487429">//&nbsp;unescaped&nbsp;://&nbsp;in&nbsp;query&nbsp;should&nbsp;not&nbsp;create&nbsp;a&nbsp;scheme</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487483">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487487">&#34;/foo?query=http://bad&#34;</span><span class="op" id="8487510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487514">&amp;</span><span class="ident" id="8487515">URL</span><span class="op" id="8487518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487523">Path</span><span class="op" id="8487527">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487533">&#34;/foo&#34;</span><span class="op" id="8487539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487544">RawQuery</span><span class="op" id="8487552">:</span>&nbsp;<span class="string" id="8487554">&#34;query=http://bad&#34;</span><span class="op" id="8487572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487576">}</span><span class="op" id="8487577">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487581">&#34;&#34;</span><span class="op" id="8487583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487586">}</span><span class="op" id="8487587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8487590">//&nbsp;leading&nbsp;//&nbsp;without&nbsp;scheme&nbsp;should&nbsp;create&nbsp;an&nbsp;authority</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487651">&#34;//foo&#34;</span><span class="op" id="8487658">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487662">&amp;</span><span class="ident" id="8487663">URL</span><span class="op" id="8487666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487671">Host</span><span class="op" id="8487675">:</span>&nbsp;<span class="string" id="8487677">&#34;foo&#34;</span><span class="op" id="8487682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487686">}</span><span class="op" id="8487687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487691">&#34;&#34;</span><span class="op" id="8487693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487696">}</span><span class="op" id="8487697">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8487700">//&nbsp;leading&nbsp;//&nbsp;without&nbsp;scheme,&nbsp;with&nbsp;userinfo,&nbsp;path,&nbsp;and&nbsp;query</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487766">&#34;//user@foo/path?a=b&#34;</span><span class="op" id="8487787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487791">&amp;</span><span class="ident" id="8487792">URL</span><span class="op" id="8487795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487800">User</span><span class="op" id="8487804">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487810">User</span><span class="op" id="8487814">(</span><span class="string" id="8487815">&#34;user&#34;</span><span class="op" id="8487821">)</span><span class="op" id="8487822">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487827">Host</span><span class="op" id="8487831">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487837">&#34;foo&#34;</span><span class="op" id="8487842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487847">Path</span><span class="op" id="8487851">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487857">&#34;/path&#34;</span><span class="op" id="8487864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8487869">RawQuery</span><span class="op" id="8487877">:</span>&nbsp;<span class="string" id="8487879">&#34;a=b&#34;</span><span class="op" id="8487884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487888">}</span><span class="op" id="8487889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8487893">&#34;&#34;</span><span class="op" id="8487895">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8487898">}</span><span class="op" id="8487899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8487902">//&nbsp;Three&nbsp;leading&nbsp;slashes&nbsp;isn&#39;t&nbsp;an&nbsp;authority,&nbsp;but&nbsp;doesn&#39;t&nbsp;return&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8487977">//&nbsp;(We&nbsp;can&#39;t&nbsp;return&nbsp;an&nbsp;error,&nbsp;as&nbsp;this&nbsp;code&nbsp;is&nbsp;also&nbsp;used&nbsp;via</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8488038">//&nbsp;ServeHTTP&nbsp;-&gt;&nbsp;ReadRequest&nbsp;-&gt;&nbsp;Parse,&nbsp;which&nbsp;is&nbsp;arguably&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8488097">//&nbsp;different&nbsp;URL&nbsp;parsing&nbsp;context,&nbsp;but&nbsp;currently&nbsp;shares&nbsp;the</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8488157">//&nbsp;same&nbsp;codepath)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488180">&#34;///threeslashes&#34;</span><span class="op" id="8488197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488201">&amp;</span><span class="ident" id="8488202">URL</span><span class="op" id="8488205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488210">Path</span><span class="op" id="8488214">:</span>&nbsp;<span class="string" id="8488216">&#34;///threeslashes&#34;</span><span class="op" id="8488233">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488237">}</span><span class="op" id="8488238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488242">&#34;&#34;</span><span class="op" id="8488244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488247">}</span><span class="op" id="8488248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488255">&#34;http://user:password@google.com&#34;</span><span class="op" id="8488288">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488292">&amp;</span><span class="ident" id="8488293">URL</span><span class="op" id="8488296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488301">Scheme</span><span class="op" id="8488307">:</span>&nbsp;<span class="string" id="8488309">&#34;http&#34;</span><span class="op" id="8488315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488320">User</span><span class="op" id="8488324">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8488328">UserPassword</span><span class="op" id="8488340">(</span><span class="string" id="8488341">&#34;user&#34;</span><span class="op" id="8488347">,</span>&nbsp;<span class="string" id="8488349">&#34;password&#34;</span><span class="op" id="8488359">)</span><span class="op" id="8488360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488365">Host</span><span class="op" id="8488369">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8488373">&#34;google.com&#34;</span><span class="op" id="8488385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488389">}</span><span class="op" id="8488390">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488394">&#34;http://user:password@google.com&#34;</span><span class="op" id="8488427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488430">}</span><span class="op" id="8488431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8488434">//&nbsp;unescaped&nbsp;@&nbsp;in&nbsp;username&nbsp;should&nbsp;not&nbsp;confuse&nbsp;host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488490">&#34;http://j@ne:password@google.com&#34;</span><span class="op" id="8488523">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488527">&amp;</span><span class="ident" id="8488528">URL</span><span class="op" id="8488531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488536">Scheme</span><span class="op" id="8488542">:</span>&nbsp;<span class="string" id="8488544">&#34;http&#34;</span><span class="op" id="8488550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488555">User</span><span class="op" id="8488559">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8488563">UserPassword</span><span class="op" id="8488575">(</span><span class="string" id="8488576">&#34;j@ne&#34;</span><span class="op" id="8488582">,</span>&nbsp;<span class="string" id="8488584">&#34;password&#34;</span><span class="op" id="8488594">)</span><span class="op" id="8488595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488600">Host</span><span class="op" id="8488604">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8488608">&#34;google.com&#34;</span><span class="op" id="8488620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488624">}</span><span class="op" id="8488625">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488629">&#34;http://j%40ne:password@google.com&#34;</span><span class="op" id="8488664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488667">}</span><span class="op" id="8488668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8488671">//&nbsp;unescaped&nbsp;@&nbsp;in&nbsp;password&nbsp;should&nbsp;not&nbsp;confuse&nbsp;host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488727">&#34;http://jane:p@ssword@google.com&#34;</span><span class="op" id="8488760">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488764">&amp;</span><span class="ident" id="8488765">URL</span><span class="op" id="8488768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488773">Scheme</span><span class="op" id="8488779">:</span>&nbsp;<span class="string" id="8488781">&#34;http&#34;</span><span class="op" id="8488787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488792">User</span><span class="op" id="8488796">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8488800">UserPassword</span><span class="op" id="8488812">(</span><span class="string" id="8488813">&#34;jane&#34;</span><span class="op" id="8488819">,</span>&nbsp;<span class="string" id="8488821">&#34;p@ssword&#34;</span><span class="op" id="8488831">)</span><span class="op" id="8488832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488837">Host</span><span class="op" id="8488841">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8488845">&#34;google.com&#34;</span><span class="op" id="8488857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488861">}</span><span class="op" id="8488862">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488866">&#34;http://jane:p%40ssword@google.com&#34;</span><span class="op" id="8488901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488904">}</span><span class="op" id="8488905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488912">&#34;http://j@ne:password@google.com/p@th?q=@go&#34;</span><span class="op" id="8488956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8488960">&amp;</span><span class="ident" id="8488961">URL</span><span class="op" id="8488964">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488969">Scheme</span><span class="op" id="8488975">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8488979">&#34;http&#34;</span><span class="op" id="8488985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488990">User</span><span class="op" id="8488994">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489000">UserPassword</span><span class="op" id="8489012">(</span><span class="string" id="8489013">&#34;j@ne&#34;</span><span class="op" id="8489019">,</span>&nbsp;<span class="string" id="8489021">&#34;password&#34;</span><span class="op" id="8489031">)</span><span class="op" id="8489032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489037">Host</span><span class="op" id="8489041">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489047">&#34;google.com&#34;</span><span class="op" id="8489059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489064">Path</span><span class="op" id="8489068">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489074">&#34;/p@th&#34;</span><span class="op" id="8489081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489086">RawQuery</span><span class="op" id="8489094">:</span>&nbsp;<span class="string" id="8489096">&#34;q=@go&#34;</span><span class="op" id="8489103">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489107">}</span><span class="op" id="8489108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489112">&#34;http://j%40ne:password@google.com/p@th?q=@go&#34;</span><span class="op" id="8489158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489161">}</span><span class="op" id="8489162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489169">&#34;http://www.google.com/?q=go+language#foo&#34;</span><span class="op" id="8489211">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489215">&amp;</span><span class="ident" id="8489216">URL</span><span class="op" id="8489219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489224">Scheme</span><span class="op" id="8489230">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8489234">&#34;http&#34;</span><span class="op" id="8489240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489245">Host</span><span class="op" id="8489249">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489255">&#34;www.google.com&#34;</span><span class="op" id="8489271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489276">Path</span><span class="op" id="8489280">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489286">&#34;/&#34;</span><span class="op" id="8489289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489294">RawQuery</span><span class="op" id="8489302">:</span>&nbsp;<span class="string" id="8489304">&#34;q=go+language&#34;</span><span class="op" id="8489319">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489324">Fragment</span><span class="op" id="8489332">:</span>&nbsp;<span class="string" id="8489334">&#34;foo&#34;</span><span class="op" id="8489339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489343">}</span><span class="op" id="8489344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489348">&#34;&#34;</span><span class="op" id="8489350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489353">}</span><span class="op" id="8489354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489357">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489361">&#34;http://www.google.com/?q=go+language#foo%26bar&#34;</span><span class="op" id="8489409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489413">&amp;</span><span class="ident" id="8489414">URL</span><span class="op" id="8489417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489422">Scheme</span><span class="op" id="8489428">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8489432">&#34;http&#34;</span><span class="op" id="8489438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489443">Host</span><span class="op" id="8489447">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489453">&#34;www.google.com&#34;</span><span class="op" id="8489469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489474">Path</span><span class="op" id="8489478">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489484">&#34;/&#34;</span><span class="op" id="8489487">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489492">RawQuery</span><span class="op" id="8489500">:</span>&nbsp;<span class="string" id="8489502">&#34;q=go+language&#34;</span><span class="op" id="8489517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489522">Fragment</span><span class="op" id="8489530">:</span>&nbsp;<span class="string" id="8489532">&#34;foo&amp;bar&#34;</span><span class="op" id="8489541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489545">}</span><span class="op" id="8489546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489550">&#34;http://www.google.com/?q=go+language#foo&amp;bar&#34;</span><span class="op" id="8489596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489599">}</span><span class="op" id="8489600">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489607">&#34;file:///home/adg/rabbits&#34;</span><span class="op" id="8489633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489637">&amp;</span><span class="ident" id="8489638">URL</span><span class="op" id="8489641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489646">Scheme</span><span class="op" id="8489652">:</span>&nbsp;<span class="string" id="8489654">&#34;file&#34;</span><span class="op" id="8489660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489665">Host</span><span class="op" id="8489669">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8489673">&#34;&#34;</span><span class="op" id="8489675">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489680">Path</span><span class="op" id="8489684">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8489688">&#34;/home/adg/rabbits&#34;</span><span class="op" id="8489707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489711">}</span><span class="op" id="8489712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489716">&#34;file:///home/adg/rabbits&#34;</span><span class="op" id="8489742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489745">}</span><span class="op" id="8489746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8489749">//&nbsp;&#34;Windows&#34;&nbsp;paths&nbsp;are&nbsp;no&nbsp;exception&nbsp;to&nbsp;the&nbsp;rule.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8489799">//&nbsp;See&nbsp;golang.org/issue/6027,&nbsp;especially&nbsp;comment&nbsp;#9.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489857">&#34;file:///C:/FooBar/Baz.txt&#34;</span><span class="op" id="8489884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489888">&amp;</span><span class="ident" id="8489889">URL</span><span class="op" id="8489892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489897">Scheme</span><span class="op" id="8489903">:</span>&nbsp;<span class="string" id="8489905">&#34;file&#34;</span><span class="op" id="8489911">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489916">Host</span><span class="op" id="8489920">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8489924">&#34;&#34;</span><span class="op" id="8489926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489931">Path</span><span class="op" id="8489935">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8489939">&#34;/C:/FooBar/Baz.txt&#34;</span><span class="op" id="8489959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489963">}</span><span class="op" id="8489964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489968">&#34;file:///C:/FooBar/Baz.txt&#34;</span><span class="op" id="8489995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489998">}</span><span class="op" id="8489999">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8490002">//&nbsp;case-insensitive&nbsp;scheme</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8490034">&#34;MaIlTo:webmaster@golang.org&#34;</span><span class="op" id="8490063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490067">&amp;</span><span class="ident" id="8490068">URL</span><span class="op" id="8490071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8490076">Scheme</span><span class="op" id="8490082">:</span>&nbsp;<span class="string" id="8490084">&#34;mailto&#34;</span><span class="op" id="8490092">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8490097">Opaque</span><span class="op" id="8490103">:</span>&nbsp;<span class="string" id="8490105">&#34;webmaster@golang.org&#34;</span><span class="op" id="8490127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490131">}</span><span class="op" id="8490132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8490136">&#34;mailto:webmaster@golang.org&#34;</span><span class="op" id="8490165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490168">}</span><span class="op" id="8490169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8490172">//&nbsp;Relative&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8490194">&#34;a/b/c&#34;</span><span class="op" id="8490201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490205">&amp;</span><span class="ident" id="8490206">URL</span><span class="op" id="8490209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8490214">Path</span><span class="op" id="8490218">:</span>&nbsp;<span class="string" id="8490220">&#34;a/b/c&#34;</span><span class="op" id="8490227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490231">}</span><span class="op" id="8490232">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8490236">&#34;a/b/c&#34;</span><span class="op" id="8490243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490246">}</span><span class="op" id="8490247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8490250">//&nbsp;escaped&nbsp;&#39;?&#39;&nbsp;in&nbsp;username&nbsp;and&nbsp;password</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8490295">&#34;http://%3Fam:pa%3Fsword@google.com&#34;</span><span class="op" id="8490331">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490335">&amp;</span><span class="ident" id="8490336">URL</span><span class="op" id="8490339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8490344">Scheme</span><span class="op" id="8490350">:</span>&nbsp;<span class="string" id="8490352">&#34;http&#34;</span><span class="op" id="8490358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8490363">User</span><span class="op" id="8490367">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8490371">UserPassword</span><span class="op" id="8490383">(</span><span class="string" id="8490384">&#34;?am&#34;</span><span class="op" id="8490389">,</span>&nbsp;<span class="string" id="8490391">&#34;pa?sword&#34;</span><span class="op" id="8490401">)</span><span class="op" id="8490402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8490407">Host</span><span class="op" id="8490411">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8490415">&#34;google.com&#34;</span><span class="op" id="8490427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490431">}</span><span class="op" id="8490432">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8490436">&#34;&#34;</span><span class="op" id="8490438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490441">}</span><span class="op" id="8490442">,</span><br>
<span class="lineno"></span><span class="op" id="8490444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8490447">//&nbsp;more&nbsp;useful&nbsp;string&nbsp;for&nbsp;debugging&nbsp;than&nbsp;fmt&#39;s&nbsp;struct&nbsp;printer</span><br>
<span class="lineno">295</span><span class="keyword" id="8490509">func</span>&nbsp;<span class="ident" id="8490514">ufmt</span><span class="op" id="8490518">(</span><span class="ident" id="8490519">u</span>&nbsp;<span class="op" id="8490521">*</span><span class="ident" id="8490522">URL</span><span class="op" id="8490525">)</span>&nbsp;<span class="builtintype" id="8490527">string</span>&nbsp;<span class="op" id="8490534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8490537">var</span>&nbsp;<span class="ident" id="8490541">user</span><span class="op" id="8490545">,</span>&nbsp;<span class="ident" id="8490547">pass</span>&nbsp;<span class="keyword" id="8490552">interface</span><span class="op" id="8490561">{</span><span class="op" id="8490562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8490565">if</span>&nbsp;<span class="ident" id="8490568">u</span><span class="op" id="8490569">.</span><span class="ident" id="8490570">User</span>&nbsp;<span class="op" id="8490575">!=</span>&nbsp;<span class="builtintype" id="8490578">nil</span>&nbsp;<span class="op" id="8490582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8490586">user</span>&nbsp;<span class="op" id="8490591">=</span>&nbsp;<span class="ident" id="8490593">u</span><span class="op" id="8490594">.</span><span class="ident" id="8490595">User</span><span class="op" id="8490599">.</span><span class="ident" id="8490600">Username</span><span class="op" id="8490608">(</span><span class="op" id="8490609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8490613">if</span>&nbsp;<span class="ident" id="8490616">p</span><span class="op" id="8490617">,</span>&nbsp;<span class="ident" id="8490619">ok</span>&nbsp;<span class="op" id="8490622">:=</span>&nbsp;<span class="ident" id="8490625">u</span><span class="op" id="8490626">.</span><span class="ident" id="8490627">User</span><span class="op" id="8490631">.</span><span class="ident" id="8490632">Password</span><span class="op" id="8490640">(</span><span class="op" id="8490641">)</span><span class="op" id="8490642">;</span>&nbsp;<span class="ident" id="8490644">ok</span>&nbsp;<span class="op" id="8490647">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8490652">pass</span>&nbsp;<span class="op" id="8490657">=</span>&nbsp;<span class="ident" id="8490659">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8490666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8490669">return</span>&nbsp;<span class="ident" id="8490676">fmt</span><span class="op" id="8490679">.</span><span class="ident" id="8490680">Sprintf</span><span class="op" id="8490687">(</span><span class="string" id="8490688">&#34;opaque=%q,&nbsp;scheme=%q,&nbsp;user=%#v,&nbsp;pass=%#v,&nbsp;host=%q,&nbsp;path=%q,&nbsp;rawq=%q,&nbsp;frag=%q&#34;</span><span class="op" id="8490766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8490770">u</span><span class="op" id="8490771">.</span><span class="ident" id="8490772">Opaque</span><span class="op" id="8490778">,</span>&nbsp;<span class="ident" id="8490780">u</span><span class="op" id="8490781">.</span><span class="ident" id="8490782">Scheme</span><span class="op" id="8490788">,</span>&nbsp;<span class="ident" id="8490790">user</span><span class="op" id="8490794">,</span>&nbsp;<span class="ident" id="8490796">pass</span><span class="op" id="8490800">,</span>&nbsp;<span class="ident" id="8490802">u</span><span class="op" id="8490803">.</span><span class="ident" id="8490804">Host</span><span class="op" id="8490808">,</span>&nbsp;<span class="ident" id="8490810">u</span><span class="op" id="8490811">.</span><span class="ident" id="8490812">Path</span><span class="op" id="8490816">,</span>&nbsp;<span class="ident" id="8490818">u</span><span class="op" id="8490819">.</span><span class="ident" id="8490820">RawQuery</span><span class="op" id="8490828">,</span>&nbsp;<span class="ident" id="8490830">u</span><span class="op" id="8490831">.</span><span class="ident" id="8490832">Fragment</span><span class="op" id="8490840">)</span><br>
<span class="lineno">305</span><span class="op" id="8490842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8490845">func</span>&nbsp;<span class="ident" id="8490850">DoTest</span><span class="op" id="8490856">(</span><span class="ident" id="8490857">t</span>&nbsp;<span class="op" id="8490859">*</span><span class="ident" id="8490860">testing</span><span class="op" id="8490867">.</span><span class="ident" id="8490868">T</span><span class="op" id="8490869">,</span>&nbsp;<span class="ident" id="8490871">parse</span>&nbsp;<span class="keyword" id="8490877">func</span><span class="op" id="8490881">(</span><span class="builtintype" id="8490882">string</span><span class="op" id="8490888">)</span>&nbsp;<span class="op" id="8490890">(</span><span class="op" id="8490891">*</span><span class="ident" id="8490892">URL</span><span class="op" id="8490895">,</span>&nbsp;<span class="builtintype" id="8490897">error</span><span class="op" id="8490902">)</span><span class="op" id="8490903">,</span>&nbsp;<span class="ident" id="8490905">name</span>&nbsp;<span class="builtintype" id="8490910">string</span><span class="op" id="8490916">,</span>&nbsp;<span class="ident" id="8490918">tests</span>&nbsp;<span class="op" id="8490924">[</span><span class="op" id="8490925">]</span><span class="ident" id="8490926">URLTest</span><span class="op" id="8490933">)</span>&nbsp;<span class="op" id="8490935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8490938">for</span>&nbsp;<span class="ident" id="8490942">_</span><span class="op" id="8490943">,</span>&nbsp;<span class="ident" id="8490945">tt</span>&nbsp;<span class="op" id="8490948">:=</span>&nbsp;<span class="keyword" id="8490951">range</span>&nbsp;<span class="ident" id="8490957">tests</span>&nbsp;<span class="op" id="8490963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8490967">u</span><span class="op" id="8490968">,</span>&nbsp;<span class="ident" id="8490970">err</span>&nbsp;<span class="op" id="8490974">:=</span>&nbsp;<span class="ident" id="8490977">parse</span><span class="op" id="8490982">(</span><span class="ident" id="8490983">tt</span><span class="op" id="8490985">.</span><span class="ident" id="8490986">in</span><span class="op" id="8490988">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8490992">if</span>&nbsp;<span class="ident" id="8490995">err</span>&nbsp;<span class="op" id="8490999">!=</span>&nbsp;<span class="builtintype" id="8491002">nil</span>&nbsp;<span class="op" id="8491006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491011">t</span><span class="op" id="8491012">.</span><span class="ident" id="8491013">Errorf</span><span class="op" id="8491019">(</span><span class="string" id="8491020">&#34;%s(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="8491046">,</span>&nbsp;<span class="ident" id="8491048">name</span><span class="op" id="8491052">,</span>&nbsp;<span class="ident" id="8491054">tt</span><span class="op" id="8491056">.</span><span class="ident" id="8491057">in</span><span class="op" id="8491059">,</span>&nbsp;<span class="ident" id="8491061">err</span><span class="op" id="8491064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8491069">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8491080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8491084">if</span>&nbsp;<span class="op" id="8491087">!</span><span class="ident" id="8491088">reflect</span><span class="op" id="8491095">.</span><span class="ident" id="8491096">DeepEqual</span><span class="op" id="8491105">(</span><span class="ident" id="8491106">u</span><span class="op" id="8491107">,</span>&nbsp;<span class="ident" id="8491109">tt</span><span class="op" id="8491111">.</span><span class="ident" id="8491112">out</span><span class="op" id="8491115">)</span>&nbsp;<span class="op" id="8491117">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491122">t</span><span class="op" id="8491123">.</span><span class="ident" id="8491124">Errorf</span><span class="op" id="8491130">(</span><span class="string" id="8491131">&#34;%s(%q):\n\thave&nbsp;%v\n\twant&nbsp;%v\n&#34;</span><span class="op" id="8491164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491170">name</span><span class="op" id="8491174">,</span>&nbsp;<span class="ident" id="8491176">tt</span><span class="op" id="8491178">.</span><span class="ident" id="8491179">in</span><span class="op" id="8491181">,</span>&nbsp;<span class="ident" id="8491183">ufmt</span><span class="op" id="8491187">(</span><span class="ident" id="8491188">u</span><span class="op" id="8491189">)</span><span class="op" id="8491190">,</span>&nbsp;<span class="ident" id="8491192">ufmt</span><span class="op" id="8491196">(</span><span class="ident" id="8491197">tt</span><span class="op" id="8491199">.</span><span class="ident" id="8491200">out</span><span class="op" id="8491203">)</span><span class="op" id="8491204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8491208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8491211">}</span><br>
<span class="lineno"></span><span class="op" id="8491213">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="keyword" id="8491216">func</span>&nbsp;<span class="ident" id="8491221">BenchmarkString</span><span class="op" id="8491236">(</span><span class="ident" id="8491237">b</span>&nbsp;<span class="op" id="8491239">*</span><span class="ident" id="8491240">testing</span><span class="op" id="8491247">.</span><span class="ident" id="8491248">B</span><span class="op" id="8491249">)</span>&nbsp;<span class="op" id="8491251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491254">b</span><span class="op" id="8491255">.</span><span class="ident" id="8491256">StopTimer</span><span class="op" id="8491265">(</span><span class="op" id="8491266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491269">b</span><span class="op" id="8491270">.</span><span class="ident" id="8491271">ReportAllocs</span><span class="op" id="8491283">(</span><span class="op" id="8491284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8491287">for</span>&nbsp;<span class="ident" id="8491291">_</span><span class="op" id="8491292">,</span>&nbsp;<span class="ident" id="8491294">tt</span>&nbsp;<span class="op" id="8491297">:=</span>&nbsp;<span class="keyword" id="8491300">range</span>&nbsp;<span class="ident" id="8491306">urltests</span>&nbsp;<span class="op" id="8491315">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491319">u</span><span class="op" id="8491320">,</span>&nbsp;<span class="ident" id="8491322">err</span>&nbsp;<span class="op" id="8491326">:=</span>&nbsp;<span class="ident" id="8491329">Parse</span><span class="op" id="8491334">(</span><span class="ident" id="8491335">tt</span><span class="op" id="8491337">.</span><span class="ident" id="8491338">in</span><span class="op" id="8491340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8491344">if</span>&nbsp;<span class="ident" id="8491347">err</span>&nbsp;<span class="op" id="8491351">!=</span>&nbsp;<span class="builtintype" id="8491354">nil</span>&nbsp;<span class="op" id="8491358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491363">b</span><span class="op" id="8491364">.</span><span class="ident" id="8491365">Errorf</span><span class="op" id="8491371">(</span><span class="string" id="8491372">&#34;Parse(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="8491401">,</span>&nbsp;<span class="ident" id="8491403">tt</span><span class="op" id="8491405">.</span><span class="ident" id="8491406">in</span><span class="op" id="8491408">,</span>&nbsp;<span class="ident" id="8491410">err</span><span class="op" id="8491413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8491418">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8491429">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8491433">if</span>&nbsp;<span class="ident" id="8491436">tt</span><span class="op" id="8491438">.</span><span class="ident" id="8491439">roundtrip</span>&nbsp;<span class="op" id="8491449">==</span>&nbsp;<span class="string" id="8491452">&#34;&#34;</span>&nbsp;<span class="op" id="8491455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8491460">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8491471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491475">b</span><span class="op" id="8491476">.</span><span class="ident" id="8491477">StartTimer</span><span class="op" id="8491487">(</span><span class="op" id="8491488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8491492">var</span>&nbsp;<span class="ident" id="8491496">g</span>&nbsp;<span class="builtintype" id="8491498">string</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8491507">for</span>&nbsp;<span class="ident" id="8491511">i</span>&nbsp;<span class="op" id="8491513">:=</span>&nbsp;<span class="num" id="8491516">0</span><span class="op" id="8491517">;</span>&nbsp;<span class="ident" id="8491519">i</span>&nbsp;<span class="op" id="8491521">&lt;</span>&nbsp;<span class="ident" id="8491523">b</span><span class="op" id="8491524">.</span><span class="ident" id="8491525">N</span><span class="op" id="8491526">;</span>&nbsp;<span class="ident" id="8491528">i</span><span class="op" id="8491529">++</span>&nbsp;<span class="op" id="8491532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491537">g</span>&nbsp;<span class="op" id="8491539">=</span>&nbsp;<span class="ident" id="8491541">u</span><span class="op" id="8491542">.</span><span class="ident" id="8491543">String</span><span class="op" id="8491549">(</span><span class="op" id="8491550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8491554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491558">b</span><span class="op" id="8491559">.</span><span class="ident" id="8491560">StopTimer</span><span class="op" id="8491569">(</span><span class="op" id="8491570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8491574">if</span>&nbsp;<span class="ident" id="8491577">w</span>&nbsp;<span class="op" id="8491579">:=</span>&nbsp;<span class="ident" id="8491582">tt</span><span class="op" id="8491584">.</span><span class="ident" id="8491585">roundtrip</span><span class="op" id="8491594">;</span>&nbsp;<span class="ident" id="8491596">g</span>&nbsp;<span class="op" id="8491598">!=</span>&nbsp;<span class="ident" id="8491601">w</span>&nbsp;<span class="op" id="8491603">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491608">b</span><span class="op" id="8491609">.</span><span class="ident" id="8491610">Errorf</span><span class="op" id="8491616">(</span><span class="string" id="8491617">&#34;Parse(%q).String()&nbsp;==&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8491652">,</span>&nbsp;<span class="ident" id="8491654">tt</span><span class="op" id="8491656">.</span><span class="ident" id="8491657">in</span><span class="op" id="8491659">,</span>&nbsp;<span class="ident" id="8491661">g</span><span class="op" id="8491662">,</span>&nbsp;<span class="ident" id="8491664">w</span><span class="op" id="8491665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8491669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8491672">}</span><br>
<span class="lineno"></span><span class="op" id="8491674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="8491677">func</span>&nbsp;<span class="ident" id="8491682">TestParse</span><span class="op" id="8491691">(</span><span class="ident" id="8491692">t</span>&nbsp;<span class="op" id="8491694">*</span><span class="ident" id="8491695">testing</span><span class="op" id="8491702">.</span><span class="ident" id="8491703">T</span><span class="op" id="8491704">)</span>&nbsp;<span class="op" id="8491706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491709">DoTest</span><span class="op" id="8491715">(</span><span class="ident" id="8491716">t</span><span class="op" id="8491717">,</span>&nbsp;<span class="ident" id="8491719">Parse</span><span class="op" id="8491724">,</span>&nbsp;<span class="string" id="8491726">&#34;Parse&#34;</span><span class="op" id="8491733">,</span>&nbsp;<span class="ident" id="8491735">urltests</span><span class="op" id="8491743">)</span><br>
<span class="lineno"></span><span class="op" id="8491745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8491748">const</span>&nbsp;<span class="ident" id="8491754">pathThatLooksSchemeRelative</span>&nbsp;<span class="op" id="8491782">=</span>&nbsp;<span class="string" id="8491784">&#34;//not.a.user@not.a.host/just/a/path&#34;</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span><span class="keyword" id="8491823">var</span>&nbsp;<span class="ident" id="8491827">parseRequestURLTests</span>&nbsp;<span class="op" id="8491848">=</span>&nbsp;<span class="op" id="8491850">[</span><span class="op" id="8491851">]</span><span class="keyword" id="8491852">struct</span>&nbsp;<span class="op" id="8491859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491862">url</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8491876">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8491884">expectedValid</span>&nbsp;<span class="builtintype" id="8491898">bool</span><br>
<span class="lineno"></span><span class="op" id="8491903">}</span><span class="op" id="8491904">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8491907">{</span><span class="string" id="8491908">&#34;http://foo.com&#34;</span><span class="op" id="8491924">,</span>&nbsp;<span class="builtintype" id="8491926">true</span><span class="op" id="8491930">}</span><span class="op" id="8491931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8491934">{</span><span class="string" id="8491935">&#34;http://foo.com/&#34;</span><span class="op" id="8491952">,</span>&nbsp;<span class="builtintype" id="8491954">true</span><span class="op" id="8491958">}</span><span class="op" id="8491959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8491962">{</span><span class="string" id="8491963">&#34;http://foo.com/path&#34;</span><span class="op" id="8491984">,</span>&nbsp;<span class="builtintype" id="8491986">true</span><span class="op" id="8491990">}</span><span class="op" id="8491991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8491994">{</span><span class="string" id="8491995">&#34;/&#34;</span><span class="op" id="8491998">,</span>&nbsp;<span class="builtintype" id="8492000">true</span><span class="op" id="8492004">}</span><span class="op" id="8492005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8492008">{</span><span class="ident" id="8492009">pathThatLooksSchemeRelative</span><span class="op" id="8492036">,</span>&nbsp;<span class="builtintype" id="8492038">true</span><span class="op" id="8492042">}</span><span class="op" id="8492043">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8492046">{</span><span class="string" id="8492047">&#34;//not.a.user@%66%6f%6f.com/just/a/path/also&#34;</span><span class="op" id="8492092">,</span>&nbsp;<span class="builtintype" id="8492094">true</span><span class="op" id="8492098">}</span><span class="op" id="8492099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8492102">{</span><span class="string" id="8492103">&#34;foo.html&#34;</span><span class="op" id="8492113">,</span>&nbsp;<span class="builtintype" id="8492115">false</span><span class="op" id="8492120">}</span><span class="op" id="8492121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8492124">{</span><span class="string" id="8492125">&#34;../dir/&#34;</span><span class="op" id="8492134">,</span>&nbsp;<span class="builtintype" id="8492136">false</span><span class="op" id="8492141">}</span><span class="op" id="8492142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8492145">{</span><span class="string" id="8492146">&#34;*&#34;</span><span class="op" id="8492149">,</span>&nbsp;<span class="builtintype" id="8492151">true</span><span class="op" id="8492155">}</span><span class="op" id="8492156">,</span><br>
<span class="lineno"></span><span class="op" id="8492158">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="8492161">func</span>&nbsp;<span class="ident" id="8492166">TestParseRequestURI</span><span class="op" id="8492185">(</span><span class="ident" id="8492186">t</span>&nbsp;<span class="op" id="8492188">*</span><span class="ident" id="8492189">testing</span><span class="op" id="8492196">.</span><span class="ident" id="8492197">T</span><span class="op" id="8492198">)</span>&nbsp;<span class="op" id="8492200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8492203">for</span>&nbsp;<span class="ident" id="8492207">_</span><span class="op" id="8492208">,</span>&nbsp;<span class="ident" id="8492210">test</span>&nbsp;<span class="op" id="8492215">:=</span>&nbsp;<span class="keyword" id="8492218">range</span>&nbsp;<span class="ident" id="8492224">parseRequestURLTests</span>&nbsp;<span class="op" id="8492245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8492249">_</span><span class="op" id="8492250">,</span>&nbsp;<span class="ident" id="8492252">err</span>&nbsp;<span class="op" id="8492256">:=</span>&nbsp;<span class="ident" id="8492259">ParseRequestURI</span><span class="op" id="8492274">(</span><span class="ident" id="8492275">test</span><span class="op" id="8492279">.</span><span class="ident" id="8492280">url</span><span class="op" id="8492283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8492287">valid</span>&nbsp;<span class="op" id="8492293">:=</span>&nbsp;<span class="ident" id="8492296">err</span>&nbsp;<span class="op" id="8492300">==</span>&nbsp;<span class="builtintype" id="8492303">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8492309">if</span>&nbsp;<span class="ident" id="8492312">valid</span>&nbsp;<span class="op" id="8492318">!=</span>&nbsp;<span class="ident" id="8492321">test</span><span class="op" id="8492325">.</span><span class="ident" id="8492326">expectedValid</span>&nbsp;<span class="op" id="8492340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8492345">t</span><span class="op" id="8492346">.</span><span class="ident" id="8492347">Errorf</span><span class="op" id="8492353">(</span><span class="string" id="8492354">&#34;Expected&nbsp;valid=%v&nbsp;for&nbsp;%q;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8492388">,</span>&nbsp;<span class="ident" id="8492390">test</span><span class="op" id="8492394">.</span><span class="ident" id="8492395">expectedValid</span><span class="op" id="8492408">,</span>&nbsp;<span class="ident" id="8492410">test</span><span class="op" id="8492414">.</span><span class="ident" id="8492415">url</span><span class="op" id="8492418">,</span>&nbsp;<span class="ident" id="8492420">valid</span><span class="op" id="8492425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8492429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8492432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8492436">url</span><span class="op" id="8492439">,</span>&nbsp;<span class="ident" id="8492441">err</span>&nbsp;<span class="op" id="8492445">:=</span>&nbsp;<span class="ident" id="8492448">ParseRequestURI</span><span class="op" id="8492463">(</span><span class="ident" id="8492464">pathThatLooksSchemeRelative</span><span class="op" id="8492491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8492494">if</span>&nbsp;<span class="ident" id="8492497">err</span>&nbsp;<span class="op" id="8492501">!=</span>&nbsp;<span class="builtintype" id="8492504">nil</span>&nbsp;<span class="op" id="8492508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8492512">t</span><span class="op" id="8492513">.</span><span class="ident" id="8492514">Fatalf</span><span class="op" id="8492520">(</span><span class="string" id="8492521">&#34;Unexpected&nbsp;error&nbsp;%v&#34;</span><span class="op" id="8492542">,</span>&nbsp;<span class="ident" id="8492544">err</span><span class="op" id="8492547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8492550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8492553">if</span>&nbsp;<span class="ident" id="8492556">url</span><span class="op" id="8492559">.</span><span class="ident" id="8492560">Path</span>&nbsp;<span class="op" id="8492565">!=</span>&nbsp;<span class="ident" id="8492568">pathThatLooksSchemeRelative</span>&nbsp;<span class="op" id="8492596">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8492600">t</span><span class="op" id="8492601">.</span><span class="ident" id="8492602">Errorf</span><span class="op" id="8492608">(</span><span class="string" id="8492609">&#34;Expected&nbsp;path&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8492635">,</span>&nbsp;<span class="ident" id="8492637">pathThatLooksSchemeRelative</span><span class="op" id="8492664">,</span>&nbsp;<span class="ident" id="8492666">url</span><span class="op" id="8492669">.</span><span class="ident" id="8492670">Path</span><span class="op" id="8492674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8492677">}</span><br>
<span class="lineno"></span><span class="op" id="8492679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8492682">func</span>&nbsp;<span class="ident" id="8492687">DoTestString</span><span class="op" id="8492699">(</span><span class="ident" id="8492700">t</span>&nbsp;<span class="op" id="8492702">*</span><span class="ident" id="8492703">testing</span><span class="op" id="8492710">.</span><span class="ident" id="8492711">T</span><span class="op" id="8492712">,</span>&nbsp;<span class="ident" id="8492714">parse</span>&nbsp;<span class="keyword" id="8492720">func</span><span class="op" id="8492724">(</span><span class="builtintype" id="8492725">string</span><span class="op" id="8492731">)</span>&nbsp;<span class="op" id="8492733">(</span><span class="op" id="8492734">*</span><span class="ident" id="8492735">URL</span><span class="op" id="8492738">,</span>&nbsp;<span class="builtintype" id="8492740">error</span><span class="op" id="8492745">)</span><span class="op" id="8492746">,</span>&nbsp;<span class="ident" id="8492748">name</span>&nbsp;<span class="builtintype" id="8492753">string</span><span class="op" id="8492759">,</span>&nbsp;<span class="ident" id="8492761">tests</span>&nbsp;<span class="op" id="8492767">[</span><span class="op" id="8492768">]</span><span class="ident" id="8492769">URLTest</span><span class="op" id="8492776">)</span>&nbsp;<span class="op" id="8492778">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8492781">for</span>&nbsp;<span class="ident" id="8492785">_</span><span class="op" id="8492786">,</span>&nbsp;<span class="ident" id="8492788">tt</span>&nbsp;<span class="op" id="8492791">:=</span>&nbsp;<span class="keyword" id="8492794">range</span>&nbsp;<span class="ident" id="8492800">tests</span>&nbsp;<span class="op" id="8492806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8492810">u</span><span class="op" id="8492811">,</span>&nbsp;<span class="ident" id="8492813">err</span>&nbsp;<span class="op" id="8492817">:=</span>&nbsp;<span class="ident" id="8492820">parse</span><span class="op" id="8492825">(</span><span class="ident" id="8492826">tt</span><span class="op" id="8492828">.</span><span class="ident" id="8492829">in</span><span class="op" id="8492831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8492835">if</span>&nbsp;<span class="ident" id="8492838">err</span>&nbsp;<span class="op" id="8492842">!=</span>&nbsp;<span class="builtintype" id="8492845">nil</span>&nbsp;<span class="op" id="8492849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8492854">t</span><span class="op" id="8492855">.</span><span class="ident" id="8492856">Errorf</span><span class="op" id="8492862">(</span><span class="string" id="8492863">&#34;%s(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="8492889">,</span>&nbsp;<span class="ident" id="8492891">name</span><span class="op" id="8492895">,</span>&nbsp;<span class="ident" id="8492897">tt</span><span class="op" id="8492899">.</span><span class="ident" id="8492900">in</span><span class="op" id="8492902">,</span>&nbsp;<span class="ident" id="8492904">err</span><span class="op" id="8492907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8492912">continue</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8492923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8492927">expected</span>&nbsp;<span class="op" id="8492936">:=</span>&nbsp;<span class="ident" id="8492939">tt</span><span class="op" id="8492941">.</span><span class="ident" id="8492942">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8492947">if</span>&nbsp;<span class="builtinfunc" id="8492950">len</span><span class="op" id="8492953">(</span><span class="ident" id="8492954">tt</span><span class="op" id="8492956">.</span><span class="ident" id="8492957">roundtrip</span><span class="op" id="8492966">)</span>&nbsp;<span class="op" id="8492968">&gt;</span>&nbsp;<span class="num" id="8492970">0</span>&nbsp;<span class="op" id="8492972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8492977">expected</span>&nbsp;<span class="op" id="8492986">=</span>&nbsp;<span class="ident" id="8492988">tt</span><span class="op" id="8492990">.</span><span class="ident" id="8492991">roundtrip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493003">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493007">s</span>&nbsp;<span class="op" id="8493009">:=</span>&nbsp;<span class="ident" id="8493012">u</span><span class="op" id="8493013">.</span><span class="ident" id="8493014">String</span><span class="op" id="8493020">(</span><span class="op" id="8493021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8493025">if</span>&nbsp;<span class="ident" id="8493028">s</span>&nbsp;<span class="op" id="8493030">!=</span>&nbsp;<span class="ident" id="8493033">expected</span>&nbsp;<span class="op" id="8493042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493047">t</span><span class="op" id="8493048">.</span><span class="ident" id="8493049">Errorf</span><span class="op" id="8493055">(</span><span class="string" id="8493056">&#34;%s(%q).String()&nbsp;==&nbsp;%q&nbsp;(expected&nbsp;%q)&#34;</span><span class="op" id="8493093">,</span>&nbsp;<span class="ident" id="8493095">name</span><span class="op" id="8493099">,</span>&nbsp;<span class="ident" id="8493101">tt</span><span class="op" id="8493103">.</span><span class="ident" id="8493104">in</span><span class="op" id="8493106">,</span>&nbsp;<span class="ident" id="8493108">s</span><span class="op" id="8493109">,</span>&nbsp;<span class="ident" id="8493111">expected</span><span class="op" id="8493119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493126">}</span><br>
<span class="lineno">400</span><span class="op" id="8493128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8493131">func</span>&nbsp;<span class="ident" id="8493136">TestURLString</span><span class="op" id="8493149">(</span><span class="ident" id="8493150">t</span>&nbsp;<span class="op" id="8493152">*</span><span class="ident" id="8493153">testing</span><span class="op" id="8493160">.</span><span class="ident" id="8493161">T</span><span class="op" id="8493162">)</span>&nbsp;<span class="op" id="8493164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493167">DoTestString</span><span class="op" id="8493179">(</span><span class="ident" id="8493180">t</span><span class="op" id="8493181">,</span>&nbsp;<span class="ident" id="8493183">Parse</span><span class="op" id="8493188">,</span>&nbsp;<span class="string" id="8493190">&#34;Parse&#34;</span><span class="op" id="8493197">,</span>&nbsp;<span class="ident" id="8493199">urltests</span><span class="op" id="8493207">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8493211">//&nbsp;no&nbsp;leading&nbsp;slash&nbsp;on&nbsp;path&nbsp;should&nbsp;prepend</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8493255">//&nbsp;slash&nbsp;on&nbsp;String()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493282">noslash</span>&nbsp;<span class="op" id="8493290">:=</span>&nbsp;<span class="ident" id="8493293">URLTest</span><span class="op" id="8493300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493304">&#34;http://www.google.com/search&#34;</span><span class="op" id="8493334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493338">&amp;</span><span class="ident" id="8493339">URL</span><span class="op" id="8493342">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493347">Scheme</span><span class="op" id="8493353">:</span>&nbsp;<span class="string" id="8493355">&#34;http&#34;</span><span class="op" id="8493361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493366">Host</span><span class="op" id="8493370">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8493374">&#34;www.google.com&#34;</span><span class="op" id="8493390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493395">Path</span><span class="op" id="8493399">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8493403">&#34;search&#34;</span><span class="op" id="8493411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493415">}</span><span class="op" id="8493416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493420">&#34;&#34;</span><span class="op" id="8493422">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493428">s</span>&nbsp;<span class="op" id="8493430">:=</span>&nbsp;<span class="ident" id="8493433">noslash</span><span class="op" id="8493440">.</span><span class="ident" id="8493441">out</span><span class="op" id="8493444">.</span><span class="ident" id="8493445">String</span><span class="op" id="8493451">(</span><span class="op" id="8493452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8493455">if</span>&nbsp;<span class="ident" id="8493458">s</span>&nbsp;<span class="op" id="8493460">!=</span>&nbsp;<span class="ident" id="8493463">noslash</span><span class="op" id="8493470">.</span><span class="ident" id="8493471">in</span>&nbsp;<span class="op" id="8493474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493478">t</span><span class="op" id="8493479">.</span><span class="ident" id="8493480">Errorf</span><span class="op" id="8493486">(</span><span class="string" id="8493487">&#34;Expected&nbsp;%s;&nbsp;go&nbsp;%s&#34;</span><span class="op" id="8493507">,</span>&nbsp;<span class="ident" id="8493509">noslash</span><span class="op" id="8493516">.</span><span class="ident" id="8493517">in</span><span class="op" id="8493519">,</span>&nbsp;<span class="ident" id="8493521">s</span><span class="op" id="8493522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493525">}</span><br>
<span class="lineno">420</span><span class="op" id="8493527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8493530">type</span>&nbsp;<span class="ident" id="8493535">EscapeTest</span>&nbsp;<span class="keyword" id="8493546">struct</span>&nbsp;<span class="op" id="8493553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493556">in</span>&nbsp;&nbsp;<span class="builtintype" id="8493560">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493568">out</span>&nbsp;<span class="builtintype" id="8493572">string</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493580">err</span>&nbsp;<span class="builtintype" id="8493584">error</span><br>
<span class="lineno"></span><span class="op" id="8493590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8493593">var</span>&nbsp;<span class="ident" id="8493597">unescapeTests</span>&nbsp;<span class="op" id="8493611">=</span>&nbsp;<span class="op" id="8493613">[</span><span class="op" id="8493614">]</span><span class="ident" id="8493615">EscapeTest</span><span class="op" id="8493625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493628">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493632">&#34;&#34;</span><span class="op" id="8493634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493638">&#34;&#34;</span><span class="op" id="8493640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8493644">nil</span><span class="op" id="8493647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493650">}</span><span class="op" id="8493651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493654">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493658">&#34;abc&#34;</span><span class="op" id="8493663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493667">&#34;abc&#34;</span><span class="op" id="8493672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8493676">nil</span><span class="op" id="8493679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493682">}</span><span class="op" id="8493683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493686">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493690">&#34;1%41&#34;</span><span class="op" id="8493696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493700">&#34;1A&#34;</span><span class="op" id="8493704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8493708">nil</span><span class="op" id="8493711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493714">}</span><span class="op" id="8493715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493718">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493722">&#34;1%41%42%43&#34;</span><span class="op" id="8493734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493738">&#34;1ABC&#34;</span><span class="op" id="8493744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8493748">nil</span><span class="op" id="8493751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493754">}</span><span class="op" id="8493755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493758">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493762">&#34;%4a&#34;</span><span class="op" id="8493767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493771">&#34;J&#34;</span><span class="op" id="8493774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8493778">nil</span><span class="op" id="8493781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493784">}</span><span class="op" id="8493785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493788">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493792">&#34;%6F&#34;</span><span class="op" id="8493797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493801">&#34;o&#34;</span><span class="op" id="8493804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8493808">nil</span><span class="op" id="8493811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493814">}</span><span class="op" id="8493815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493818">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493822">&#34;%&#34;</span><span class="op" id="8493825">,</span>&nbsp;<span class="comment" id="8493827">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493862">&#34;&#34;</span><span class="op" id="8493864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493868">EscapeError</span><span class="op" id="8493879">(</span><span class="string" id="8493880">&#34;%&#34;</span><span class="op" id="8493883">)</span><span class="op" id="8493884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493887">}</span><span class="op" id="8493888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493891">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493895">&#34;%a&#34;</span><span class="op" id="8493899">,</span>&nbsp;<span class="comment" id="8493901">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493936">&#34;&#34;</span><span class="op" id="8493938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8493942">EscapeError</span><span class="op" id="8493953">(</span><span class="string" id="8493954">&#34;%a&#34;</span><span class="op" id="8493958">)</span><span class="op" id="8493959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493962">}</span><span class="op" id="8493963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8493966">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8493970">&#34;%1&#34;</span><span class="op" id="8493974">,</span>&nbsp;<span class="comment" id="8493976">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494011">&#34;&#34;</span><span class="op" id="8494013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8494017">EscapeError</span><span class="op" id="8494028">(</span><span class="string" id="8494029">&#34;%1&#34;</span><span class="op" id="8494033">)</span><span class="op" id="8494034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494037">}</span><span class="op" id="8494038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494041">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494045">&#34;123%45%6&#34;</span><span class="op" id="8494055">,</span>&nbsp;<span class="comment" id="8494057">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494092">&#34;&#34;</span><span class="op" id="8494094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8494098">EscapeError</span><span class="op" id="8494109">(</span><span class="string" id="8494110">&#34;%6&#34;</span><span class="op" id="8494114">)</span><span class="op" id="8494115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494118">}</span><span class="op" id="8494119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494122">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494126">&#34;%zzzzz&#34;</span><span class="op" id="8494134">,</span>&nbsp;<span class="comment" id="8494136">//&nbsp;invalid&nbsp;hex&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494160">&#34;&#34;</span><span class="op" id="8494162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8494166">EscapeError</span><span class="op" id="8494177">(</span><span class="string" id="8494178">&#34;%zz&#34;</span><span class="op" id="8494183">)</span><span class="op" id="8494184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494187">}</span><span class="op" id="8494188">,</span><br>
<span class="lineno"></span><span class="op" id="8494190">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="8494193">func</span>&nbsp;<span class="ident" id="8494198">TestUnescape</span><span class="op" id="8494210">(</span><span class="ident" id="8494211">t</span>&nbsp;<span class="op" id="8494213">*</span><span class="ident" id="8494214">testing</span><span class="op" id="8494221">.</span><span class="ident" id="8494222">T</span><span class="op" id="8494223">)</span>&nbsp;<span class="op" id="8494225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8494228">for</span>&nbsp;<span class="ident" id="8494232">_</span><span class="op" id="8494233">,</span>&nbsp;<span class="ident" id="8494235">tt</span>&nbsp;<span class="op" id="8494238">:=</span>&nbsp;<span class="keyword" id="8494241">range</span>&nbsp;<span class="ident" id="8494247">unescapeTests</span>&nbsp;<span class="op" id="8494261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8494265">actual</span><span class="op" id="8494271">,</span>&nbsp;<span class="ident" id="8494273">err</span>&nbsp;<span class="op" id="8494277">:=</span>&nbsp;<span class="ident" id="8494280">QueryUnescape</span><span class="op" id="8494293">(</span><span class="ident" id="8494294">tt</span><span class="op" id="8494296">.</span><span class="ident" id="8494297">in</span><span class="op" id="8494299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8494303">if</span>&nbsp;<span class="ident" id="8494306">actual</span>&nbsp;<span class="op" id="8494313">!=</span>&nbsp;<span class="ident" id="8494316">tt</span><span class="op" id="8494318">.</span><span class="ident" id="8494319">out</span>&nbsp;<span class="op" id="8494323">||</span>&nbsp;<span class="op" id="8494326">(</span><span class="ident" id="8494327">err</span>&nbsp;<span class="op" id="8494331">!=</span>&nbsp;<span class="builtintype" id="8494334">nil</span><span class="op" id="8494337">)</span>&nbsp;<span class="op" id="8494339">!=</span>&nbsp;<span class="op" id="8494342">(</span><span class="ident" id="8494343">tt</span><span class="op" id="8494345">.</span><span class="ident" id="8494346">err</span>&nbsp;<span class="op" id="8494350">!=</span>&nbsp;<span class="builtintype" id="8494353">nil</span><span class="op" id="8494356">)</span>&nbsp;<span class="op" id="8494358">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8494363">t</span><span class="op" id="8494364">.</span><span class="ident" id="8494365">Errorf</span><span class="op" id="8494371">(</span><span class="string" id="8494372">&#34;QueryUnescape(%q)&nbsp;=&nbsp;%q,&nbsp;%s;&nbsp;want&nbsp;%q,&nbsp;%s&#34;</span><span class="op" id="8494413">,</span>&nbsp;<span class="ident" id="8494415">tt</span><span class="op" id="8494417">.</span><span class="ident" id="8494418">in</span><span class="op" id="8494420">,</span>&nbsp;<span class="ident" id="8494422">actual</span><span class="op" id="8494428">,</span>&nbsp;<span class="ident" id="8494430">err</span><span class="op" id="8494433">,</span>&nbsp;<span class="ident" id="8494435">tt</span><span class="op" id="8494437">.</span><span class="ident" id="8494438">out</span><span class="op" id="8494441">,</span>&nbsp;<span class="ident" id="8494443">tt</span><span class="op" id="8494445">.</span><span class="ident" id="8494446">err</span><span class="op" id="8494449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494456">}</span><br>
<span class="lineno"></span><span class="op" id="8494458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span><span class="keyword" id="8494461">var</span>&nbsp;<span class="ident" id="8494465">escapeTests</span>&nbsp;<span class="op" id="8494477">=</span>&nbsp;<span class="op" id="8494479">[</span><span class="op" id="8494480">]</span><span class="ident" id="8494481">EscapeTest</span><span class="op" id="8494491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494498">&#34;&#34;</span><span class="op" id="8494500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494504">&#34;&#34;</span><span class="op" id="8494506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8494510">nil</span><span class="op" id="8494513">,</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494516">}</span><span class="op" id="8494517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494524">&#34;abc&#34;</span><span class="op" id="8494529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494533">&#34;abc&#34;</span><span class="op" id="8494538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8494542">nil</span><span class="op" id="8494545">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494548">}</span><span class="op" id="8494549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494556">&#34;one&nbsp;two&#34;</span><span class="op" id="8494565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494569">&#34;one+two&#34;</span><span class="op" id="8494578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8494582">nil</span><span class="op" id="8494585">,</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494588">}</span><span class="op" id="8494589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494596">&#34;10%&#34;</span><span class="op" id="8494601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494605">&#34;10%25&#34;</span><span class="op" id="8494612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8494616">nil</span><span class="op" id="8494619">,</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494622">}</span><span class="op" id="8494623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494630">&#34;&nbsp;?&amp;=#+%!&lt;&gt;#\&#34;{}|\\^[]`☺\t:/@$&#39;()*,;&#34;</span><span class="op" id="8494669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8494673">&#34;+%3F%26%3D%23%2B%25%21%3C%3E%23%22%7B%7D%7C%5C%5E%5B%5D%60%E2%98%BA%09%3A%2F%40%24%27%28%29%2A%2C%3B&#34;</span><span class="op" id="8494775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8494779">nil</span><span class="op" id="8494782">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494785">}</span><span class="op" id="8494786">,</span><br>
<span class="lineno"></span><span class="op" id="8494788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8494791">func</span>&nbsp;<span class="ident" id="8494796">TestEscape</span><span class="op" id="8494806">(</span><span class="ident" id="8494807">t</span>&nbsp;<span class="op" id="8494809">*</span><span class="ident" id="8494810">testing</span><span class="op" id="8494817">.</span><span class="ident" id="8494818">T</span><span class="op" id="8494819">)</span>&nbsp;<span class="op" id="8494821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8494824">for</span>&nbsp;<span class="ident" id="8494828">_</span><span class="op" id="8494829">,</span>&nbsp;<span class="ident" id="8494831">tt</span>&nbsp;<span class="op" id="8494834">:=</span>&nbsp;<span class="keyword" id="8494837">range</span>&nbsp;<span class="ident" id="8494843">escapeTests</span>&nbsp;<span class="op" id="8494855">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8494859">actual</span>&nbsp;<span class="op" id="8494866">:=</span>&nbsp;<span class="ident" id="8494869">QueryEscape</span><span class="op" id="8494880">(</span><span class="ident" id="8494881">tt</span><span class="op" id="8494883">.</span><span class="ident" id="8494884">in</span><span class="op" id="8494886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8494890">if</span>&nbsp;<span class="ident" id="8494893">tt</span><span class="op" id="8494895">.</span><span class="ident" id="8494896">out</span>&nbsp;<span class="op" id="8494900">!=</span>&nbsp;<span class="ident" id="8494903">actual</span>&nbsp;<span class="op" id="8494910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8494915">t</span><span class="op" id="8494916">.</span><span class="ident" id="8494917">Errorf</span><span class="op" id="8494923">(</span><span class="string" id="8494924">&#34;QueryEscape(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8494955">,</span>&nbsp;<span class="ident" id="8494957">tt</span><span class="op" id="8494959">.</span><span class="ident" id="8494960">in</span><span class="op" id="8494962">,</span>&nbsp;<span class="ident" id="8494964">actual</span><span class="op" id="8494970">,</span>&nbsp;<span class="ident" id="8494972">tt</span><span class="op" id="8494974">.</span><span class="ident" id="8494975">out</span><span class="op" id="8494978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8494982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8494987">//&nbsp;for&nbsp;bonus&nbsp;points,&nbsp;verify&nbsp;that&nbsp;escape:unescape&nbsp;is&nbsp;an&nbsp;identity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8495054">roundtrip</span><span class="op" id="8495063">,</span>&nbsp;<span class="ident" id="8495065">err</span>&nbsp;<span class="op" id="8495069">:=</span>&nbsp;<span class="ident" id="8495072">QueryUnescape</span><span class="op" id="8495085">(</span><span class="ident" id="8495086">actual</span><span class="op" id="8495092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8495096">if</span>&nbsp;<span class="ident" id="8495099">roundtrip</span>&nbsp;<span class="op" id="8495109">!=</span>&nbsp;<span class="ident" id="8495112">tt</span><span class="op" id="8495114">.</span><span class="ident" id="8495115">in</span>&nbsp;<span class="op" id="8495118">||</span>&nbsp;<span class="ident" id="8495121">err</span>&nbsp;<span class="op" id="8495125">!=</span>&nbsp;<span class="builtintype" id="8495128">nil</span>&nbsp;<span class="op" id="8495132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8495137">t</span><span class="op" id="8495138">.</span><span class="ident" id="8495139">Errorf</span><span class="op" id="8495145">(</span><span class="string" id="8495146">&#34;QueryUnescape(%q)&nbsp;=&nbsp;%q,&nbsp;%s;&nbsp;want&nbsp;%q,&nbsp;%s&#34;</span><span class="op" id="8495187">,</span>&nbsp;<span class="ident" id="8495189">actual</span><span class="op" id="8495195">,</span>&nbsp;<span class="ident" id="8495197">roundtrip</span><span class="op" id="8495206">,</span>&nbsp;<span class="ident" id="8495208">err</span><span class="op" id="8495211">,</span>&nbsp;<span class="ident" id="8495213">tt</span><span class="op" id="8495215">.</span><span class="ident" id="8495216">in</span><span class="op" id="8495218">,</span>&nbsp;<span class="string" id="8495220">&#34;[no&nbsp;error]&#34;</span><span class="op" id="8495232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8495236">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8495239">}</span><br>
<span class="lineno"></span><span class="op" id="8495241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8495244">//var&nbsp;userinfoTests&nbsp;=&nbsp;[]UserinfoTest{</span><br>
<span class="lineno"></span><span class="comment" id="8495282">//&nbsp;&nbsp;&nbsp;&nbsp;{&#34;user&#34;,&nbsp;&#34;password&#34;,&nbsp;&#34;user:password&#34;},</span><br>
<span class="lineno">540</span><span class="comment" id="8495324">//&nbsp;&nbsp;&nbsp;&nbsp;{&#34;foo:bar&#34;,&nbsp;&#34;~!@#$%^&amp;*()_+{}|[]\\-=`:;&#39;\&#34;&lt;&gt;?,./&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="8495377">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;foo%3Abar:~!%40%23$%25%5E&amp;*()_+%7B%7D%7C%5B%5D%5C-=%60%3A;&#39;%22%3C%3E?,.%2F&#34;},</span><br>
<span class="lineno"></span><span class="comment" id="8495460">//}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8495465">type</span>&nbsp;<span class="ident" id="8495470">EncodeQueryTest</span>&nbsp;<span class="keyword" id="8495486">struct</span>&nbsp;<span class="op" id="8495493">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8495496">m</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8495505">Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8495513">expected</span>&nbsp;<span class="builtintype" id="8495522">string</span><br>
<span class="lineno"></span><span class="op" id="8495529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8495532">var</span>&nbsp;<span class="ident" id="8495536">encodeQueryTests</span>&nbsp;<span class="op" id="8495553">=</span>&nbsp;<span class="op" id="8495555">[</span><span class="op" id="8495556">]</span><span class="ident" id="8495557">EncodeQueryTest</span><span class="op" id="8495572">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8495575">{</span><span class="builtintype" id="8495576">nil</span><span class="op" id="8495579">,</span>&nbsp;<span class="string" id="8495581">&#34;&#34;</span><span class="op" id="8495583">}</span><span class="op" id="8495584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8495587">{</span><span class="ident" id="8495588">Values</span><span class="op" id="8495594">{</span><span class="string" id="8495595">&#34;q&#34;</span><span class="op" id="8495598">:</span>&nbsp;<span class="op" id="8495600">{</span><span class="string" id="8495601">&#34;puppies&#34;</span><span class="op" id="8495610">}</span><span class="op" id="8495611">,</span>&nbsp;<span class="string" id="8495613">&#34;oe&#34;</span><span class="op" id="8495617">:</span>&nbsp;<span class="op" id="8495619">{</span><span class="string" id="8495620">&#34;utf8&#34;</span><span class="op" id="8495626">}</span><span class="op" id="8495627">}</span><span class="op" id="8495628">,</span>&nbsp;<span class="string" id="8495630">&#34;oe=utf8&amp;q=puppies&#34;</span><span class="op" id="8495649">}</span><span class="op" id="8495650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8495653">{</span><span class="ident" id="8495654">Values</span><span class="op" id="8495660">{</span><span class="string" id="8495661">&#34;q&#34;</span><span class="op" id="8495664">:</span>&nbsp;<span class="op" id="8495666">{</span><span class="string" id="8495667">&#34;dogs&#34;</span><span class="op" id="8495673">,</span>&nbsp;<span class="string" id="8495675">&#34;&amp;&#34;</span><span class="op" id="8495678">,</span>&nbsp;<span class="string" id="8495680">&#34;7&#34;</span><span class="op" id="8495683">}</span><span class="op" id="8495684">}</span><span class="op" id="8495685">,</span>&nbsp;<span class="string" id="8495687">&#34;q=dogs&amp;q=%26&amp;q=7&#34;</span><span class="op" id="8495705">}</span><span class="op" id="8495706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8495709">{</span><span class="ident" id="8495710">Values</span><span class="op" id="8495716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8495720">&#34;a&#34;</span><span class="op" id="8495723">:</span>&nbsp;<span class="op" id="8495725">{</span><span class="string" id="8495726">&#34;a1&#34;</span><span class="op" id="8495730">,</span>&nbsp;<span class="string" id="8495732">&#34;a2&#34;</span><span class="op" id="8495736">,</span>&nbsp;<span class="string" id="8495738">&#34;a3&#34;</span><span class="op" id="8495742">}</span><span class="op" id="8495743">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8495747">&#34;b&#34;</span><span class="op" id="8495750">:</span>&nbsp;<span class="op" id="8495752">{</span><span class="string" id="8495753">&#34;b1&#34;</span><span class="op" id="8495757">,</span>&nbsp;<span class="string" id="8495759">&#34;b2&#34;</span><span class="op" id="8495763">,</span>&nbsp;<span class="string" id="8495765">&#34;b3&#34;</span><span class="op" id="8495769">}</span><span class="op" id="8495770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8495774">&#34;c&#34;</span><span class="op" id="8495777">:</span>&nbsp;<span class="op" id="8495779">{</span><span class="string" id="8495780">&#34;c1&#34;</span><span class="op" id="8495784">,</span>&nbsp;<span class="string" id="8495786">&#34;c2&#34;</span><span class="op" id="8495790">,</span>&nbsp;<span class="string" id="8495792">&#34;c3&#34;</span><span class="op" id="8495796">}</span><span class="op" id="8495797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8495800">}</span><span class="op" id="8495801">,</span>&nbsp;<span class="string" id="8495803">&#34;a=a1&amp;a=a2&amp;a=a3&amp;b=b1&amp;b=b2&amp;b=b3&amp;c=c1&amp;c=c2&amp;c=c3&#34;</span><span class="op" id="8495849">}</span><span class="op" id="8495850">,</span><br>
<span class="lineno"></span><span class="op" id="8495852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="8495855">func</span>&nbsp;<span class="ident" id="8495860">TestEncodeQuery</span><span class="op" id="8495875">(</span><span class="ident" id="8495876">t</span>&nbsp;<span class="op" id="8495878">*</span><span class="ident" id="8495879">testing</span><span class="op" id="8495886">.</span><span class="ident" id="8495887">T</span><span class="op" id="8495888">)</span>&nbsp;<span class="op" id="8495890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8495893">for</span>&nbsp;<span class="ident" id="8495897">_</span><span class="op" id="8495898">,</span>&nbsp;<span class="ident" id="8495900">tt</span>&nbsp;<span class="op" id="8495903">:=</span>&nbsp;<span class="keyword" id="8495906">range</span>&nbsp;<span class="ident" id="8495912">encodeQueryTests</span>&nbsp;<span class="op" id="8495929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8495933">if</span>&nbsp;<span class="ident" id="8495936">q</span>&nbsp;<span class="op" id="8495938">:=</span>&nbsp;<span class="ident" id="8495941">tt</span><span class="op" id="8495943">.</span><span class="ident" id="8495944">m</span><span class="op" id="8495945">.</span><span class="ident" id="8495946">Encode</span><span class="op" id="8495952">(</span><span class="op" id="8495953">)</span><span class="op" id="8495954">;</span>&nbsp;<span class="ident" id="8495956">q</span>&nbsp;<span class="op" id="8495958">!=</span>&nbsp;<span class="ident" id="8495961">tt</span><span class="op" id="8495963">.</span><span class="ident" id="8495964">expected</span>&nbsp;<span class="op" id="8495973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8495978">t</span><span class="op" id="8495979">.</span><span class="ident" id="8495980">Errorf</span><span class="op" id="8495986">(</span><span class="string" id="8495987">`EncodeQuery(%+v)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q`</span><span class="op" id="8496019">,</span>&nbsp;<span class="ident" id="8496021">tt</span><span class="op" id="8496023">.</span><span class="ident" id="8496024">m</span><span class="op" id="8496025">,</span>&nbsp;<span class="ident" id="8496027">q</span><span class="op" id="8496028">,</span>&nbsp;<span class="ident" id="8496030">tt</span><span class="op" id="8496032">.</span><span class="ident" id="8496033">expected</span><span class="op" id="8496041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496045">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496048">}</span><br>
<span class="lineno"></span><span class="op" id="8496050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8496053">var</span>&nbsp;<span class="ident" id="8496057">resolvePathTests</span>&nbsp;<span class="op" id="8496074">=</span>&nbsp;<span class="op" id="8496076">[</span><span class="op" id="8496077">]</span><span class="keyword" id="8496078">struct</span>&nbsp;<span class="op" id="8496085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8496088">base</span><span class="op" id="8496092">,</span>&nbsp;<span class="ident" id="8496094">ref</span><span class="op" id="8496097">,</span>&nbsp;<span class="ident" id="8496099">expected</span>&nbsp;<span class="builtintype" id="8496108">string</span><br>
<span class="lineno">570</span><span class="op" id="8496115">}</span><span class="op" id="8496116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496119">{</span><span class="string" id="8496120">&#34;a/b&#34;</span><span class="op" id="8496125">,</span>&nbsp;<span class="string" id="8496127">&#34;.&#34;</span><span class="op" id="8496130">,</span>&nbsp;<span class="string" id="8496132">&#34;/a/&#34;</span><span class="op" id="8496137">}</span><span class="op" id="8496138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496141">{</span><span class="string" id="8496142">&#34;a/b&#34;</span><span class="op" id="8496147">,</span>&nbsp;<span class="string" id="8496149">&#34;c&#34;</span><span class="op" id="8496152">,</span>&nbsp;<span class="string" id="8496154">&#34;/a/c&#34;</span><span class="op" id="8496160">}</span><span class="op" id="8496161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496164">{</span><span class="string" id="8496165">&#34;a/b&#34;</span><span class="op" id="8496170">,</span>&nbsp;<span class="string" id="8496172">&#34;..&#34;</span><span class="op" id="8496176">,</span>&nbsp;<span class="string" id="8496178">&#34;/&#34;</span><span class="op" id="8496181">}</span><span class="op" id="8496182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496185">{</span><span class="string" id="8496186">&#34;a/&#34;</span><span class="op" id="8496190">,</span>&nbsp;<span class="string" id="8496192">&#34;..&#34;</span><span class="op" id="8496196">,</span>&nbsp;<span class="string" id="8496198">&#34;/&#34;</span><span class="op" id="8496201">}</span><span class="op" id="8496202">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496205">{</span><span class="string" id="8496206">&#34;a/&#34;</span><span class="op" id="8496210">,</span>&nbsp;<span class="string" id="8496212">&#34;../..&#34;</span><span class="op" id="8496219">,</span>&nbsp;<span class="string" id="8496221">&#34;/&#34;</span><span class="op" id="8496224">}</span><span class="op" id="8496225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496228">{</span><span class="string" id="8496229">&#34;a/b/c&#34;</span><span class="op" id="8496236">,</span>&nbsp;<span class="string" id="8496238">&#34;..&#34;</span><span class="op" id="8496242">,</span>&nbsp;<span class="string" id="8496244">&#34;/a/&#34;</span><span class="op" id="8496249">}</span><span class="op" id="8496250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496253">{</span><span class="string" id="8496254">&#34;a/b/c&#34;</span><span class="op" id="8496261">,</span>&nbsp;<span class="string" id="8496263">&#34;../d&#34;</span><span class="op" id="8496269">,</span>&nbsp;<span class="string" id="8496271">&#34;/a/d&#34;</span><span class="op" id="8496277">}</span><span class="op" id="8496278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496281">{</span><span class="string" id="8496282">&#34;a/b/c&#34;</span><span class="op" id="8496289">,</span>&nbsp;<span class="string" id="8496291">&#34;.././d&#34;</span><span class="op" id="8496299">,</span>&nbsp;<span class="string" id="8496301">&#34;/a/d&#34;</span><span class="op" id="8496307">}</span><span class="op" id="8496308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496311">{</span><span class="string" id="8496312">&#34;a/b&#34;</span><span class="op" id="8496317">,</span>&nbsp;<span class="string" id="8496319">&#34;./..&#34;</span><span class="op" id="8496325">,</span>&nbsp;<span class="string" id="8496327">&#34;/&#34;</span><span class="op" id="8496330">}</span><span class="op" id="8496331">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496334">{</span><span class="string" id="8496335">&#34;a/./b&#34;</span><span class="op" id="8496342">,</span>&nbsp;<span class="string" id="8496344">&#34;.&#34;</span><span class="op" id="8496347">,</span>&nbsp;<span class="string" id="8496349">&#34;/a/&#34;</span><span class="op" id="8496354">}</span><span class="op" id="8496355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496358">{</span><span class="string" id="8496359">&#34;a/../&#34;</span><span class="op" id="8496366">,</span>&nbsp;<span class="string" id="8496368">&#34;.&#34;</span><span class="op" id="8496371">,</span>&nbsp;<span class="string" id="8496373">&#34;/&#34;</span><span class="op" id="8496376">}</span><span class="op" id="8496377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496380">{</span><span class="string" id="8496381">&#34;a/.././b&#34;</span><span class="op" id="8496391">,</span>&nbsp;<span class="string" id="8496393">&#34;c&#34;</span><span class="op" id="8496396">,</span>&nbsp;<span class="string" id="8496398">&#34;/c&#34;</span><span class="op" id="8496402">}</span><span class="op" id="8496403">,</span><br>
<span class="lineno"></span><span class="op" id="8496405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="keyword" id="8496408">func</span>&nbsp;<span class="ident" id="8496413">TestResolvePath</span><span class="op" id="8496428">(</span><span class="ident" id="8496429">t</span>&nbsp;<span class="op" id="8496431">*</span><span class="ident" id="8496432">testing</span><span class="op" id="8496439">.</span><span class="ident" id="8496440">T</span><span class="op" id="8496441">)</span>&nbsp;<span class="op" id="8496443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8496446">for</span>&nbsp;<span class="ident" id="8496450">_</span><span class="op" id="8496451">,</span>&nbsp;<span class="ident" id="8496453">test</span>&nbsp;<span class="op" id="8496458">:=</span>&nbsp;<span class="keyword" id="8496461">range</span>&nbsp;<span class="ident" id="8496467">resolvePathTests</span>&nbsp;<span class="op" id="8496484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8496488">got</span>&nbsp;<span class="op" id="8496492">:=</span>&nbsp;<span class="ident" id="8496495">resolvePath</span><span class="op" id="8496506">(</span><span class="ident" id="8496507">test</span><span class="op" id="8496511">.</span><span class="ident" id="8496512">base</span><span class="op" id="8496516">,</span>&nbsp;<span class="ident" id="8496518">test</span><span class="op" id="8496522">.</span><span class="ident" id="8496523">ref</span><span class="op" id="8496526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8496530">if</span>&nbsp;<span class="ident" id="8496533">got</span>&nbsp;<span class="op" id="8496537">!=</span>&nbsp;<span class="ident" id="8496540">test</span><span class="op" id="8496544">.</span><span class="ident" id="8496545">expected</span>&nbsp;<span class="op" id="8496554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8496559">t</span><span class="op" id="8496560">.</span><span class="ident" id="8496561">Errorf</span><span class="op" id="8496567">(</span><span class="string" id="8496568">&#34;For&nbsp;%q&nbsp;+&nbsp;%q&nbsp;got&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="8496601">,</span>&nbsp;<span class="ident" id="8496603">test</span><span class="op" id="8496607">.</span><span class="ident" id="8496608">base</span><span class="op" id="8496612">,</span>&nbsp;<span class="ident" id="8496614">test</span><span class="op" id="8496618">.</span><span class="ident" id="8496619">ref</span><span class="op" id="8496622">,</span>&nbsp;<span class="ident" id="8496624">got</span><span class="op" id="8496627">,</span>&nbsp;<span class="ident" id="8496629">test</span><span class="op" id="8496633">.</span><span class="ident" id="8496634">expected</span><span class="op" id="8496642">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496649">}</span><br>
<span class="lineno"></span><span class="op" id="8496651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8496654">var</span>&nbsp;<span class="ident" id="8496658">resolveReferenceTests</span>&nbsp;<span class="op" id="8496680">=</span>&nbsp;<span class="op" id="8496682">[</span><span class="op" id="8496683">]</span><span class="keyword" id="8496684">struct</span>&nbsp;<span class="op" id="8496691">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8496694">base</span><span class="op" id="8496698">,</span>&nbsp;<span class="ident" id="8496700">rel</span><span class="op" id="8496703">,</span>&nbsp;<span class="ident" id="8496705">expected</span>&nbsp;<span class="builtintype" id="8496714">string</span><br>
<span class="lineno"></span><span class="op" id="8496721">}</span><span class="op" id="8496722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8496725">//&nbsp;Absolute&nbsp;URL&nbsp;references</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496753">{</span><span class="string" id="8496754">&#34;http://foo.com?a=b&#34;</span><span class="op" id="8496774">,</span>&nbsp;<span class="string" id="8496776">&#34;https://bar.com/&#34;</span><span class="op" id="8496794">,</span>&nbsp;<span class="string" id="8496796">&#34;https://bar.com/&#34;</span><span class="op" id="8496814">}</span><span class="op" id="8496815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496818">{</span><span class="string" id="8496819">&#34;http://foo.com/&#34;</span><span class="op" id="8496836">,</span>&nbsp;<span class="string" id="8496838">&#34;https://bar.com/?a=b&#34;</span><span class="op" id="8496860">,</span>&nbsp;<span class="string" id="8496862">&#34;https://bar.com/?a=b&#34;</span><span class="op" id="8496884">}</span><span class="op" id="8496885">,</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496888">{</span><span class="string" id="8496889">&#34;http://foo.com/bar&#34;</span><span class="op" id="8496909">,</span>&nbsp;<span class="string" id="8496911">&#34;mailto:foo@example.com&#34;</span><span class="op" id="8496935">,</span>&nbsp;<span class="string" id="8496937">&#34;mailto:foo@example.com&#34;</span><span class="op" id="8496961">}</span><span class="op" id="8496962">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8496966">//&nbsp;Path-absolute&nbsp;references</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8496995">{</span><span class="string" id="8496996">&#34;http://foo.com/bar&#34;</span><span class="op" id="8497016">,</span>&nbsp;<span class="string" id="8497018">&#34;/baz&#34;</span><span class="op" id="8497024">,</span>&nbsp;<span class="string" id="8497026">&#34;http://foo.com/baz&#34;</span><span class="op" id="8497046">}</span><span class="op" id="8497047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497050">{</span><span class="string" id="8497051">&#34;http://foo.com/bar?a=b#f&#34;</span><span class="op" id="8497077">,</span>&nbsp;<span class="string" id="8497079">&#34;/baz&#34;</span><span class="op" id="8497085">,</span>&nbsp;<span class="string" id="8497087">&#34;http://foo.com/baz&#34;</span><span class="op" id="8497107">}</span><span class="op" id="8497108">,</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497111">{</span><span class="string" id="8497112">&#34;http://foo.com/bar?a=b&#34;</span><span class="op" id="8497136">,</span>&nbsp;<span class="string" id="8497138">&#34;/baz?c=d&#34;</span><span class="op" id="8497148">,</span>&nbsp;<span class="string" id="8497150">&#34;http://foo.com/baz?c=d&#34;</span><span class="op" id="8497174">}</span><span class="op" id="8497175">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8497179">//&nbsp;Scheme-relative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497199">{</span><span class="string" id="8497200">&#34;https://foo.com/bar?a=b&#34;</span><span class="op" id="8497225">,</span>&nbsp;<span class="string" id="8497227">&#34;//bar.com/quux&#34;</span><span class="op" id="8497243">,</span>&nbsp;<span class="string" id="8497245">&#34;https://bar.com/quux&#34;</span><span class="op" id="8497267">}</span><span class="op" id="8497268">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8497272">//&nbsp;Path-relative&nbsp;references:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8497303">//&nbsp;...&nbsp;current&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497329">{</span><span class="string" id="8497330">&#34;http://foo.com&#34;</span><span class="op" id="8497346">,</span>&nbsp;<span class="string" id="8497348">&#34;.&#34;</span><span class="op" id="8497351">,</span>&nbsp;<span class="string" id="8497353">&#34;http://foo.com/&#34;</span><span class="op" id="8497370">}</span><span class="op" id="8497371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497374">{</span><span class="string" id="8497375">&#34;http://foo.com/bar&#34;</span><span class="op" id="8497395">,</span>&nbsp;<span class="string" id="8497397">&#34;.&#34;</span><span class="op" id="8497400">,</span>&nbsp;<span class="string" id="8497402">&#34;http://foo.com/&#34;</span><span class="op" id="8497419">}</span><span class="op" id="8497420">,</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497423">{</span><span class="string" id="8497424">&#34;http://foo.com/bar/&#34;</span><span class="op" id="8497445">,</span>&nbsp;<span class="string" id="8497447">&#34;.&#34;</span><span class="op" id="8497450">,</span>&nbsp;<span class="string" id="8497452">&#34;http://foo.com/bar/&#34;</span><span class="op" id="8497473">}</span><span class="op" id="8497474">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8497478">//&nbsp;...&nbsp;going&nbsp;down</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497497">{</span><span class="string" id="8497498">&#34;http://foo.com&#34;</span><span class="op" id="8497514">,</span>&nbsp;<span class="string" id="8497516">&#34;bar&#34;</span><span class="op" id="8497521">,</span>&nbsp;<span class="string" id="8497523">&#34;http://foo.com/bar&#34;</span><span class="op" id="8497543">}</span><span class="op" id="8497544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497547">{</span><span class="string" id="8497548">&#34;http://foo.com/&#34;</span><span class="op" id="8497565">,</span>&nbsp;<span class="string" id="8497567">&#34;bar&#34;</span><span class="op" id="8497572">,</span>&nbsp;<span class="string" id="8497574">&#34;http://foo.com/bar&#34;</span><span class="op" id="8497594">}</span><span class="op" id="8497595">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497598">{</span><span class="string" id="8497599">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8497623">,</span>&nbsp;<span class="string" id="8497625">&#34;quux&#34;</span><span class="op" id="8497631">,</span>&nbsp;<span class="string" id="8497633">&#34;http://foo.com/bar/quux&#34;</span><span class="op" id="8497658">}</span><span class="op" id="8497659">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8497663">//&nbsp;...&nbsp;going&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497680">{</span><span class="string" id="8497681">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8497705">,</span>&nbsp;<span class="string" id="8497707">&#34;../quux&#34;</span><span class="op" id="8497716">,</span>&nbsp;<span class="string" id="8497718">&#34;http://foo.com/quux&#34;</span><span class="op" id="8497739">}</span><span class="op" id="8497740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497743">{</span><span class="string" id="8497744">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8497768">,</span>&nbsp;<span class="string" id="8497770">&#34;../../../../../quux&#34;</span><span class="op" id="8497791">,</span>&nbsp;<span class="string" id="8497793">&#34;http://foo.com/quux&#34;</span><span class="op" id="8497814">}</span><span class="op" id="8497815">,</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497818">{</span><span class="string" id="8497819">&#34;http://foo.com/bar&#34;</span><span class="op" id="8497839">,</span>&nbsp;<span class="string" id="8497841">&#34;..&#34;</span><span class="op" id="8497845">,</span>&nbsp;<span class="string" id="8497847">&#34;http://foo.com/&#34;</span><span class="op" id="8497864">}</span><span class="op" id="8497865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497868">{</span><span class="string" id="8497869">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8497893">,</span>&nbsp;<span class="string" id="8497895">&#34;./..&#34;</span><span class="op" id="8497901">,</span>&nbsp;<span class="string" id="8497903">&#34;http://foo.com/&#34;</span><span class="op" id="8497920">}</span><span class="op" id="8497921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8497924">//&nbsp;&#34;..&#34;&nbsp;in&nbsp;the&nbsp;middle&nbsp;(issue&nbsp;3560)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8497960">{</span><span class="string" id="8497961">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8497985">,</span>&nbsp;<span class="string" id="8497987">&#34;quux/dotdot/../tail&#34;</span><span class="op" id="8498008">,</span>&nbsp;<span class="string" id="8498010">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8498040">}</span><span class="op" id="8498041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8498044">{</span><span class="string" id="8498045">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8498069">,</span>&nbsp;<span class="string" id="8498071">&#34;quux/./dotdot/../tail&#34;</span><span class="op" id="8498094">,</span>&nbsp;<span class="string" id="8498096">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8498126">}</span><span class="op" id="8498127">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8498130">{</span><span class="string" id="8498131">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8498155">,</span>&nbsp;<span class="string" id="8498157">&#34;quux/./dotdot/.././tail&#34;</span><span class="op" id="8498182">,</span>&nbsp;<span class="string" id="8498184">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8498214">}</span><span class="op" id="8498215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8498218">{</span><span class="string" id="8498219">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8498243">,</span>&nbsp;<span class="string" id="8498245">&#34;quux/./dotdot/./../tail&#34;</span><span class="op" id="8498270">,</span>&nbsp;<span class="string" id="8498272">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8498302">}</span><span class="op" id="8498303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8498306">{</span><span class="string" id="8498307">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8498331">,</span>&nbsp;<span class="string" id="8498333">&#34;quux/./dotdot/dotdot/././../../tail&#34;</span><span class="op" id="8498370">,</span>&nbsp;<span class="string" id="8498372">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8498402">}</span><span class="op" id="8498403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8498406">{</span><span class="string" id="8498407">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8498431">,</span>&nbsp;<span class="string" id="8498433">&#34;quux/./dotdot/dotdot/./.././../tail&#34;</span><span class="op" id="8498470">,</span>&nbsp;<span class="string" id="8498472">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8498502">}</span><span class="op" id="8498503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8498506">{</span><span class="string" id="8498507">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8498531">,</span>&nbsp;<span class="string" id="8498533">&#34;quux/./dotdot/dotdot/dotdot/./../../.././././tail&#34;</span><span class="op" id="8498584">,</span>&nbsp;<span class="string" id="8498586">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8498616">}</span><span class="op" id="8498617">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8498620">{</span><span class="string" id="8498621">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8498645">,</span>&nbsp;<span class="string" id="8498647">&#34;quux/./dotdot/../dotdot/../dot/./tail/..&#34;</span><span class="op" id="8498689">,</span>&nbsp;<span class="string" id="8498691">&#34;http://foo.com/bar/quux/dot/&#34;</span><span class="op" id="8498721">}</span><span class="op" id="8498722">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8498726">//&nbsp;Remove&nbsp;any&nbsp;dot-segments&nbsp;prior&nbsp;to&nbsp;forming&nbsp;the&nbsp;target&nbsp;URI.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8498787">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8498840">{</span><span class="string" id="8498841">&#34;http://foo.com/dot/./dotdot/../foo/bar&#34;</span><span class="op" id="8498881">,</span>&nbsp;<span class="string" id="8498883">&#34;../baz&#34;</span><span class="op" id="8498891">,</span>&nbsp;<span class="string" id="8498893">&#34;http://foo.com/dot/baz&#34;</span><span class="op" id="8498917">}</span><span class="op" id="8498918">,</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8498922">//&nbsp;Triple&nbsp;dot&nbsp;isn&#39;t&nbsp;special</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8498951">{</span><span class="string" id="8498952">&#34;http://foo.com/bar&#34;</span><span class="op" id="8498972">,</span>&nbsp;<span class="string" id="8498974">&#34;...&#34;</span><span class="op" id="8498979">,</span>&nbsp;<span class="string" id="8498981">&#34;http://foo.com/...&#34;</span><span class="op" id="8499001">}</span><span class="op" id="8499002">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8499006">//&nbsp;Fragment</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499019">{</span><span class="string" id="8499020">&#34;http://foo.com/bar&#34;</span><span class="op" id="8499040">,</span>&nbsp;<span class="string" id="8499042">&#34;.#frag&#34;</span><span class="op" id="8499050">,</span>&nbsp;<span class="string" id="8499052">&#34;http://foo.com/#frag&#34;</span><span class="op" id="8499074">}</span><span class="op" id="8499075">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8499079">//&nbsp;RFC&nbsp;3986:&nbsp;Normal&nbsp;Examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8499109">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499162">{</span><span class="string" id="8499163">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499183">,</span>&nbsp;<span class="string" id="8499185">&#34;g:h&#34;</span><span class="op" id="8499190">,</span>&nbsp;<span class="string" id="8499192">&#34;g:h&#34;</span><span class="op" id="8499197">}</span><span class="op" id="8499198">,</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499201">{</span><span class="string" id="8499202">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499222">,</span>&nbsp;<span class="string" id="8499224">&#34;g&#34;</span><span class="op" id="8499227">,</span>&nbsp;<span class="string" id="8499229">&#34;http://a/b/c/g&#34;</span><span class="op" id="8499245">}</span><span class="op" id="8499246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499249">{</span><span class="string" id="8499250">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499270">,</span>&nbsp;<span class="string" id="8499272">&#34;./g&#34;</span><span class="op" id="8499277">,</span>&nbsp;<span class="string" id="8499279">&#34;http://a/b/c/g&#34;</span><span class="op" id="8499295">}</span><span class="op" id="8499296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499299">{</span><span class="string" id="8499300">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499320">,</span>&nbsp;<span class="string" id="8499322">&#34;g/&#34;</span><span class="op" id="8499326">,</span>&nbsp;<span class="string" id="8499328">&#34;http://a/b/c/g/&#34;</span><span class="op" id="8499345">}</span><span class="op" id="8499346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499349">{</span><span class="string" id="8499350">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499370">,</span>&nbsp;<span class="string" id="8499372">&#34;/g&#34;</span><span class="op" id="8499376">,</span>&nbsp;<span class="string" id="8499378">&#34;http://a/g&#34;</span><span class="op" id="8499390">}</span><span class="op" id="8499391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499394">{</span><span class="string" id="8499395">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499415">,</span>&nbsp;<span class="string" id="8499417">&#34;//g&#34;</span><span class="op" id="8499422">,</span>&nbsp;<span class="string" id="8499424">&#34;http://g&#34;</span><span class="op" id="8499434">}</span><span class="op" id="8499435">,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499438">{</span><span class="string" id="8499439">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499459">,</span>&nbsp;<span class="string" id="8499461">&#34;?y&#34;</span><span class="op" id="8499465">,</span>&nbsp;<span class="string" id="8499467">&#34;http://a/b/c/d;p?y&#34;</span><span class="op" id="8499487">}</span><span class="op" id="8499488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499491">{</span><span class="string" id="8499492">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499512">,</span>&nbsp;<span class="string" id="8499514">&#34;g?y&#34;</span><span class="op" id="8499519">,</span>&nbsp;<span class="string" id="8499521">&#34;http://a/b/c/g?y&#34;</span><span class="op" id="8499539">}</span><span class="op" id="8499540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499543">{</span><span class="string" id="8499544">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499564">,</span>&nbsp;<span class="string" id="8499566">&#34;#s&#34;</span><span class="op" id="8499570">,</span>&nbsp;<span class="string" id="8499572">&#34;http://a/b/c/d;p?q#s&#34;</span><span class="op" id="8499594">}</span><span class="op" id="8499595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499598">{</span><span class="string" id="8499599">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499619">,</span>&nbsp;<span class="string" id="8499621">&#34;g#s&#34;</span><span class="op" id="8499626">,</span>&nbsp;<span class="string" id="8499628">&#34;http://a/b/c/g#s&#34;</span><span class="op" id="8499646">}</span><span class="op" id="8499647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499650">{</span><span class="string" id="8499651">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499671">,</span>&nbsp;<span class="string" id="8499673">&#34;g?y#s&#34;</span><span class="op" id="8499680">,</span>&nbsp;<span class="string" id="8499682">&#34;http://a/b/c/g?y#s&#34;</span><span class="op" id="8499702">}</span><span class="op" id="8499703">,</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499706">{</span><span class="string" id="8499707">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499727">,</span>&nbsp;<span class="string" id="8499729">&#34;;x&#34;</span><span class="op" id="8499733">,</span>&nbsp;<span class="string" id="8499735">&#34;http://a/b/c/;x&#34;</span><span class="op" id="8499752">}</span><span class="op" id="8499753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499756">{</span><span class="string" id="8499757">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499777">,</span>&nbsp;<span class="string" id="8499779">&#34;g;x&#34;</span><span class="op" id="8499784">,</span>&nbsp;<span class="string" id="8499786">&#34;http://a/b/c/g;x&#34;</span><span class="op" id="8499804">}</span><span class="op" id="8499805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499808">{</span><span class="string" id="8499809">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499829">,</span>&nbsp;<span class="string" id="8499831">&#34;g;x?y#s&#34;</span><span class="op" id="8499840">,</span>&nbsp;<span class="string" id="8499842">&#34;http://a/b/c/g;x?y#s&#34;</span><span class="op" id="8499864">}</span><span class="op" id="8499865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499868">{</span><span class="string" id="8499869">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499889">,</span>&nbsp;<span class="string" id="8499891">&#34;&#34;</span><span class="op" id="8499893">,</span>&nbsp;<span class="string" id="8499895">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499915">}</span><span class="op" id="8499916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499919">{</span><span class="string" id="8499920">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499940">,</span>&nbsp;<span class="string" id="8499942">&#34;.&#34;</span><span class="op" id="8499945">,</span>&nbsp;<span class="string" id="8499947">&#34;http://a/b/c/&#34;</span><span class="op" id="8499962">}</span><span class="op" id="8499963">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499966">{</span><span class="string" id="8499967">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8499987">,</span>&nbsp;<span class="string" id="8499989">&#34;./&#34;</span><span class="op" id="8499993">,</span>&nbsp;<span class="string" id="8499995">&#34;http://a/b/c/&#34;</span><span class="op" id="8500010">}</span><span class="op" id="8500011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500014">{</span><span class="string" id="8500015">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500035">,</span>&nbsp;<span class="string" id="8500037">&#34;..&#34;</span><span class="op" id="8500041">,</span>&nbsp;<span class="string" id="8500043">&#34;http://a/b/&#34;</span><span class="op" id="8500056">}</span><span class="op" id="8500057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500060">{</span><span class="string" id="8500061">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500081">,</span>&nbsp;<span class="string" id="8500083">&#34;../&#34;</span><span class="op" id="8500088">,</span>&nbsp;<span class="string" id="8500090">&#34;http://a/b/&#34;</span><span class="op" id="8500103">}</span><span class="op" id="8500104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500107">{</span><span class="string" id="8500108">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500128">,</span>&nbsp;<span class="string" id="8500130">&#34;../g&#34;</span><span class="op" id="8500136">,</span>&nbsp;<span class="string" id="8500138">&#34;http://a/b/g&#34;</span><span class="op" id="8500152">}</span><span class="op" id="8500153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500156">{</span><span class="string" id="8500157">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500177">,</span>&nbsp;<span class="string" id="8500179">&#34;../..&#34;</span><span class="op" id="8500186">,</span>&nbsp;<span class="string" id="8500188">&#34;http://a/&#34;</span><span class="op" id="8500199">}</span><span class="op" id="8500200">,</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500203">{</span><span class="string" id="8500204">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500224">,</span>&nbsp;<span class="string" id="8500226">&#34;../../&#34;</span><span class="op" id="8500234">,</span>&nbsp;<span class="string" id="8500236">&#34;http://a/&#34;</span><span class="op" id="8500247">}</span><span class="op" id="8500248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500251">{</span><span class="string" id="8500252">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500272">,</span>&nbsp;<span class="string" id="8500274">&#34;../../g&#34;</span><span class="op" id="8500283">,</span>&nbsp;<span class="string" id="8500285">&#34;http://a/g&#34;</span><span class="op" id="8500297">}</span><span class="op" id="8500298">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8500302">//&nbsp;RFC&nbsp;3986:&nbsp;Abnormal&nbsp;Examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8500334">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.4.2</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500387">{</span><span class="string" id="8500388">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500408">,</span>&nbsp;<span class="string" id="8500410">&#34;../../../g&#34;</span><span class="op" id="8500422">,</span>&nbsp;<span class="string" id="8500424">&#34;http://a/g&#34;</span><span class="op" id="8500436">}</span><span class="op" id="8500437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500440">{</span><span class="string" id="8500441">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500461">,</span>&nbsp;<span class="string" id="8500463">&#34;../../../../g&#34;</span><span class="op" id="8500478">,</span>&nbsp;<span class="string" id="8500480">&#34;http://a/g&#34;</span><span class="op" id="8500492">}</span><span class="op" id="8500493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500496">{</span><span class="string" id="8500497">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500517">,</span>&nbsp;<span class="string" id="8500519">&#34;/./g&#34;</span><span class="op" id="8500525">,</span>&nbsp;<span class="string" id="8500527">&#34;http://a/g&#34;</span><span class="op" id="8500539">}</span><span class="op" id="8500540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500543">{</span><span class="string" id="8500544">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500564">,</span>&nbsp;<span class="string" id="8500566">&#34;/../g&#34;</span><span class="op" id="8500573">,</span>&nbsp;<span class="string" id="8500575">&#34;http://a/g&#34;</span><span class="op" id="8500587">}</span><span class="op" id="8500588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500591">{</span><span class="string" id="8500592">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500612">,</span>&nbsp;<span class="string" id="8500614">&#34;g.&#34;</span><span class="op" id="8500618">,</span>&nbsp;<span class="string" id="8500620">&#34;http://a/b/c/g.&#34;</span><span class="op" id="8500637">}</span><span class="op" id="8500638">,</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500641">{</span><span class="string" id="8500642">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500662">,</span>&nbsp;<span class="string" id="8500664">&#34;.g&#34;</span><span class="op" id="8500668">,</span>&nbsp;<span class="string" id="8500670">&#34;http://a/b/c/.g&#34;</span><span class="op" id="8500687">}</span><span class="op" id="8500688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500691">{</span><span class="string" id="8500692">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500712">,</span>&nbsp;<span class="string" id="8500714">&#34;g..&#34;</span><span class="op" id="8500719">,</span>&nbsp;<span class="string" id="8500721">&#34;http://a/b/c/g..&#34;</span><span class="op" id="8500739">}</span><span class="op" id="8500740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500743">{</span><span class="string" id="8500744">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500764">,</span>&nbsp;<span class="string" id="8500766">&#34;..g&#34;</span><span class="op" id="8500771">,</span>&nbsp;<span class="string" id="8500773">&#34;http://a/b/c/..g&#34;</span><span class="op" id="8500791">}</span><span class="op" id="8500792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500795">{</span><span class="string" id="8500796">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500816">,</span>&nbsp;<span class="string" id="8500818">&#34;./../g&#34;</span><span class="op" id="8500826">,</span>&nbsp;<span class="string" id="8500828">&#34;http://a/b/g&#34;</span><span class="op" id="8500842">}</span><span class="op" id="8500843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500846">{</span><span class="string" id="8500847">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500867">,</span>&nbsp;<span class="string" id="8500869">&#34;./g/.&#34;</span><span class="op" id="8500876">,</span>&nbsp;<span class="string" id="8500878">&#34;http://a/b/c/g/&#34;</span><span class="op" id="8500895">}</span><span class="op" id="8500896">,</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500899">{</span><span class="string" id="8500900">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500920">,</span>&nbsp;<span class="string" id="8500922">&#34;g/./h&#34;</span><span class="op" id="8500929">,</span>&nbsp;<span class="string" id="8500931">&#34;http://a/b/c/g/h&#34;</span><span class="op" id="8500949">}</span><span class="op" id="8500950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500953">{</span><span class="string" id="8500954">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8500974">,</span>&nbsp;<span class="string" id="8500976">&#34;g/../h&#34;</span><span class="op" id="8500984">,</span>&nbsp;<span class="string" id="8500986">&#34;http://a/b/c/h&#34;</span><span class="op" id="8501002">}</span><span class="op" id="8501003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501006">{</span><span class="string" id="8501007">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8501027">,</span>&nbsp;<span class="string" id="8501029">&#34;g;x=1/./y&#34;</span><span class="op" id="8501040">,</span>&nbsp;<span class="string" id="8501042">&#34;http://a/b/c/g;x=1/y&#34;</span><span class="op" id="8501064">}</span><span class="op" id="8501065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501068">{</span><span class="string" id="8501069">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8501089">,</span>&nbsp;<span class="string" id="8501091">&#34;g;x=1/../y&#34;</span><span class="op" id="8501103">,</span>&nbsp;<span class="string" id="8501105">&#34;http://a/b/c/y&#34;</span><span class="op" id="8501121">}</span><span class="op" id="8501122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501125">{</span><span class="string" id="8501126">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8501146">,</span>&nbsp;<span class="string" id="8501148">&#34;g?y/./x&#34;</span><span class="op" id="8501157">,</span>&nbsp;<span class="string" id="8501159">&#34;http://a/b/c/g?y/./x&#34;</span><span class="op" id="8501181">}</span><span class="op" id="8501182">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501185">{</span><span class="string" id="8501186">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8501206">,</span>&nbsp;<span class="string" id="8501208">&#34;g?y/../x&#34;</span><span class="op" id="8501218">,</span>&nbsp;<span class="string" id="8501220">&#34;http://a/b/c/g?y/../x&#34;</span><span class="op" id="8501243">}</span><span class="op" id="8501244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501247">{</span><span class="string" id="8501248">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8501268">,</span>&nbsp;<span class="string" id="8501270">&#34;g#s/./x&#34;</span><span class="op" id="8501279">,</span>&nbsp;<span class="string" id="8501281">&#34;http://a/b/c/g#s/./x&#34;</span><span class="op" id="8501303">}</span><span class="op" id="8501304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501307">{</span><span class="string" id="8501308">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8501328">,</span>&nbsp;<span class="string" id="8501330">&#34;g#s/../x&#34;</span><span class="op" id="8501340">,</span>&nbsp;<span class="string" id="8501342">&#34;http://a/b/c/g#s/../x&#34;</span><span class="op" id="8501365">}</span><span class="op" id="8501366">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8501370">//&nbsp;Extras.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501382">{</span><span class="string" id="8501383">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="8501404">,</span>&nbsp;<span class="string" id="8501406">&#34;//g?q&#34;</span><span class="op" id="8501413">,</span>&nbsp;<span class="string" id="8501415">&#34;https://g?q&#34;</span><span class="op" id="8501428">}</span><span class="op" id="8501429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501432">{</span><span class="string" id="8501433">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="8501454">,</span>&nbsp;<span class="string" id="8501456">&#34;//g#s&#34;</span><span class="op" id="8501463">,</span>&nbsp;<span class="string" id="8501465">&#34;https://g#s&#34;</span><span class="op" id="8501478">}</span><span class="op" id="8501479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501482">{</span><span class="string" id="8501483">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="8501504">,</span>&nbsp;<span class="string" id="8501506">&#34;//g/d/e/f?y#s&#34;</span><span class="op" id="8501521">,</span>&nbsp;<span class="string" id="8501523">&#34;https://g/d/e/f?y#s&#34;</span><span class="op" id="8501544">}</span><span class="op" id="8501545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501548">{</span><span class="string" id="8501549">&#34;https://a/b/c/d;p#s&#34;</span><span class="op" id="8501570">,</span>&nbsp;<span class="string" id="8501572">&#34;?y&#34;</span><span class="op" id="8501576">,</span>&nbsp;<span class="string" id="8501578">&#34;https://a/b/c/d;p?y&#34;</span><span class="op" id="8501599">}</span><span class="op" id="8501600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501603">{</span><span class="string" id="8501604">&#34;https://a/b/c/d;p?q#s&#34;</span><span class="op" id="8501627">,</span>&nbsp;<span class="string" id="8501629">&#34;?y&#34;</span><span class="op" id="8501633">,</span>&nbsp;<span class="string" id="8501635">&#34;https://a/b/c/d;p?y&#34;</span><span class="op" id="8501656">}</span><span class="op" id="8501657">,</span><br>
<span class="lineno">700</span><span class="op" id="8501659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8501662">func</span>&nbsp;<span class="ident" id="8501667">TestResolveReference</span><span class="op" id="8501687">(</span><span class="ident" id="8501688">t</span>&nbsp;<span class="op" id="8501690">*</span><span class="ident" id="8501691">testing</span><span class="op" id="8501698">.</span><span class="ident" id="8501699">T</span><span class="op" id="8501700">)</span>&nbsp;<span class="op" id="8501702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501705">mustParse</span>&nbsp;<span class="op" id="8501715">:=</span>&nbsp;<span class="keyword" id="8501718">func</span><span class="op" id="8501722">(</span><span class="ident" id="8501723">url</span>&nbsp;<span class="builtintype" id="8501727">string</span><span class="op" id="8501733">)</span>&nbsp;<span class="op" id="8501735">*</span><span class="ident" id="8501736">URL</span>&nbsp;<span class="op" id="8501740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501744">u</span><span class="op" id="8501745">,</span>&nbsp;<span class="ident" id="8501747">err</span>&nbsp;<span class="op" id="8501751">:=</span>&nbsp;<span class="ident" id="8501754">Parse</span><span class="op" id="8501759">(</span><span class="ident" id="8501760">url</span><span class="op" id="8501763">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8501767">if</span>&nbsp;<span class="ident" id="8501770">err</span>&nbsp;<span class="op" id="8501774">!=</span>&nbsp;<span class="builtintype" id="8501777">nil</span>&nbsp;<span class="op" id="8501781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501786">t</span><span class="op" id="8501787">.</span><span class="ident" id="8501788">Fatalf</span><span class="op" id="8501794">(</span><span class="string" id="8501795">&#34;Expected&nbsp;URL&nbsp;to&nbsp;parse:&nbsp;%q,&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8501837">,</span>&nbsp;<span class="ident" id="8501839">url</span><span class="op" id="8501842">,</span>&nbsp;<span class="ident" id="8501844">err</span><span class="op" id="8501847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8501855">return</span>&nbsp;<span class="ident" id="8501862">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501865">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501868">opaque</span>&nbsp;<span class="op" id="8501875">:=</span>&nbsp;<span class="op" id="8501878">&amp;</span><span class="ident" id="8501879">URL</span><span class="op" id="8501882">{</span><span class="ident" id="8501883">Scheme</span><span class="op" id="8501889">:</span>&nbsp;<span class="string" id="8501891">&#34;scheme&#34;</span><span class="op" id="8501899">,</span>&nbsp;<span class="ident" id="8501901">Opaque</span><span class="op" id="8501907">:</span>&nbsp;<span class="string" id="8501909">&#34;opaque&#34;</span><span class="op" id="8501917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8501920">for</span>&nbsp;<span class="ident" id="8501924">_</span><span class="op" id="8501925">,</span>&nbsp;<span class="ident" id="8501927">test</span>&nbsp;<span class="op" id="8501932">:=</span>&nbsp;<span class="keyword" id="8501935">range</span>&nbsp;<span class="ident" id="8501941">resolveReferenceTests</span>&nbsp;<span class="op" id="8501963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501967">base</span>&nbsp;<span class="op" id="8501972">:=</span>&nbsp;<span class="ident" id="8501975">mustParse</span><span class="op" id="8501984">(</span><span class="ident" id="8501985">test</span><span class="op" id="8501989">.</span><span class="ident" id="8501990">base</span><span class="op" id="8501994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501998">rel</span>&nbsp;<span class="op" id="8502002">:=</span>&nbsp;<span class="ident" id="8502005">mustParse</span><span class="op" id="8502014">(</span><span class="ident" id="8502015">test</span><span class="op" id="8502019">.</span><span class="ident" id="8502020">rel</span><span class="op" id="8502023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502027">url</span>&nbsp;<span class="op" id="8502031">:=</span>&nbsp;<span class="ident" id="8502034">base</span><span class="op" id="8502038">.</span><span class="ident" id="8502039">ResolveReference</span><span class="op" id="8502055">(</span><span class="ident" id="8502056">rel</span><span class="op" id="8502059">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8502063">if</span>&nbsp;<span class="ident" id="8502066">url</span><span class="op" id="8502069">.</span><span class="ident" id="8502070">String</span><span class="op" id="8502076">(</span><span class="op" id="8502077">)</span>&nbsp;<span class="op" id="8502079">!=</span>&nbsp;<span class="ident" id="8502082">test</span><span class="op" id="8502086">.</span><span class="ident" id="8502087">expected</span>&nbsp;<span class="op" id="8502096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502101">t</span><span class="op" id="8502102">.</span><span class="ident" id="8502103">Errorf</span><span class="op" id="8502109">(</span><span class="string" id="8502110">&#34;URL(%q).ResolveReference(%q)&nbsp;==&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8502154">,</span>&nbsp;<span class="ident" id="8502156">test</span><span class="op" id="8502160">.</span><span class="ident" id="8502161">base</span><span class="op" id="8502165">,</span>&nbsp;<span class="ident" id="8502167">test</span><span class="op" id="8502171">.</span><span class="ident" id="8502172">rel</span><span class="op" id="8502175">,</span>&nbsp;<span class="ident" id="8502177">test</span><span class="op" id="8502181">.</span><span class="ident" id="8502182">expected</span><span class="op" id="8502190">,</span>&nbsp;<span class="ident" id="8502192">url</span><span class="op" id="8502195">.</span><span class="ident" id="8502196">String</span><span class="op" id="8502202">(</span><span class="op" id="8502203">)</span><span class="op" id="8502204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8502208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8502212">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8502257">if</span>&nbsp;<span class="ident" id="8502260">base</span>&nbsp;<span class="op" id="8502265">==</span>&nbsp;<span class="ident" id="8502268">url</span>&nbsp;<span class="op" id="8502272">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502277">t</span><span class="op" id="8502278">.</span><span class="ident" id="8502279">Errorf</span><span class="op" id="8502285">(</span><span class="string" id="8502286">&#34;Expected&nbsp;URL.ResolveReference&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="8502345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8502349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8502353">//&nbsp;Test&nbsp;the&nbsp;convenience&nbsp;wrapper&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502392">url</span><span class="op" id="8502395">,</span>&nbsp;<span class="ident" id="8502397">err</span>&nbsp;<span class="op" id="8502401">:=</span>&nbsp;<span class="ident" id="8502404">base</span><span class="op" id="8502408">.</span><span class="ident" id="8502409">Parse</span><span class="op" id="8502414">(</span><span class="ident" id="8502415">test</span><span class="op" id="8502419">.</span><span class="ident" id="8502420">rel</span><span class="op" id="8502423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8502427">if</span>&nbsp;<span class="ident" id="8502430">err</span>&nbsp;<span class="op" id="8502434">!=</span>&nbsp;<span class="builtintype" id="8502437">nil</span>&nbsp;<span class="op" id="8502441">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502446">t</span><span class="op" id="8502447">.</span><span class="ident" id="8502448">Errorf</span><span class="op" id="8502454">(</span><span class="string" id="8502455">&#34;URL(%q).Parse(%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8502485">,</span>&nbsp;<span class="ident" id="8502487">test</span><span class="op" id="8502491">.</span><span class="ident" id="8502492">base</span><span class="op" id="8502496">,</span>&nbsp;<span class="ident" id="8502498">test</span><span class="op" id="8502502">.</span><span class="ident" id="8502503">rel</span><span class="op" id="8502506">,</span>&nbsp;<span class="ident" id="8502508">err</span><span class="op" id="8502511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8502515">}</span>&nbsp;<span class="keyword" id="8502517">else</span>&nbsp;<span class="keyword" id="8502522">if</span>&nbsp;<span class="ident" id="8502525">url</span><span class="op" id="8502528">.</span><span class="ident" id="8502529">String</span><span class="op" id="8502535">(</span><span class="op" id="8502536">)</span>&nbsp;<span class="op" id="8502538">!=</span>&nbsp;<span class="ident" id="8502541">test</span><span class="op" id="8502545">.</span><span class="ident" id="8502546">expected</span>&nbsp;<span class="op" id="8502555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502560">t</span><span class="op" id="8502561">.</span><span class="ident" id="8502562">Errorf</span><span class="op" id="8502568">(</span><span class="string" id="8502569">&#34;URL(%q).Parse(%q)&nbsp;==&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8502602">,</span>&nbsp;<span class="ident" id="8502604">test</span><span class="op" id="8502608">.</span><span class="ident" id="8502609">base</span><span class="op" id="8502613">,</span>&nbsp;<span class="ident" id="8502615">test</span><span class="op" id="8502619">.</span><span class="ident" id="8502620">rel</span><span class="op" id="8502623">,</span>&nbsp;<span class="ident" id="8502625">test</span><span class="op" id="8502629">.</span><span class="ident" id="8502630">expected</span><span class="op" id="8502638">,</span>&nbsp;<span class="ident" id="8502640">url</span><span class="op" id="8502643">.</span><span class="ident" id="8502644">String</span><span class="op" id="8502650">(</span><span class="op" id="8502651">)</span><span class="op" id="8502652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8502656">}</span>&nbsp;<span class="keyword" id="8502658">else</span>&nbsp;<span class="keyword" id="8502663">if</span>&nbsp;<span class="ident" id="8502666">base</span>&nbsp;<span class="op" id="8502671">==</span>&nbsp;<span class="ident" id="8502674">url</span>&nbsp;<span class="op" id="8502678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8502683">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned&nbsp;for&nbsp;the&nbsp;wrapper&nbsp;too.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502749">t</span><span class="op" id="8502750">.</span><span class="ident" id="8502751">Errorf</span><span class="op" id="8502757">(</span><span class="string" id="8502758">&#34;Expected&nbsp;URL.Parse&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="8502806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8502810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8502814">//&nbsp;Ensure&nbsp;Opaque&nbsp;resets&nbsp;the&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502849">url</span>&nbsp;<span class="op" id="8502853">=</span>&nbsp;<span class="ident" id="8502855">base</span><span class="op" id="8502859">.</span><span class="ident" id="8502860">ResolveReference</span><span class="op" id="8502876">(</span><span class="ident" id="8502877">opaque</span><span class="op" id="8502883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8502887">if</span>&nbsp;<span class="op" id="8502890">*</span><span class="ident" id="8502891">url</span>&nbsp;<span class="op" id="8502895">!=</span>&nbsp;<span class="op" id="8502898">*</span><span class="ident" id="8502899">opaque</span>&nbsp;<span class="op" id="8502906">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502911">t</span><span class="op" id="8502912">.</span><span class="ident" id="8502913">Errorf</span><span class="op" id="8502919">(</span><span class="string" id="8502920">&#34;ResolveReference&nbsp;failed&nbsp;to&nbsp;resolve&nbsp;opaque&nbsp;URL:&nbsp;want&nbsp;%#v,&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="8502986">,</span>&nbsp;<span class="ident" id="8502988">url</span><span class="op" id="8502991">,</span>&nbsp;<span class="ident" id="8502993">opaque</span><span class="op" id="8502999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8503003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8503007">//&nbsp;Test&nbsp;the&nbsp;convenience&nbsp;wrapper&nbsp;with&nbsp;an&nbsp;opaque&nbsp;URL&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8503065">url</span><span class="op" id="8503068">,</span>&nbsp;<span class="ident" id="8503070">err</span>&nbsp;<span class="op" id="8503074">=</span>&nbsp;<span class="ident" id="8503076">base</span><span class="op" id="8503080">.</span><span class="ident" id="8503081">Parse</span><span class="op" id="8503086">(</span><span class="string" id="8503087">&#34;scheme:opaque&#34;</span><span class="op" id="8503102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8503106">if</span>&nbsp;<span class="ident" id="8503109">err</span>&nbsp;<span class="op" id="8503113">!=</span>&nbsp;<span class="builtintype" id="8503116">nil</span>&nbsp;<span class="op" id="8503120">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8503125">t</span><span class="op" id="8503126">.</span><span class="ident" id="8503127">Errorf</span><span class="op" id="8503133">(</span><span class="string" id="8503134">`URL(%q).Parse(&#34;scheme:opaque&#34;)&nbsp;failed:&nbsp;%v`</span><span class="op" id="8503177">,</span>&nbsp;<span class="ident" id="8503179">test</span><span class="op" id="8503183">.</span><span class="ident" id="8503184">base</span><span class="op" id="8503188">,</span>&nbsp;<span class="ident" id="8503190">err</span><span class="op" id="8503193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8503197">}</span>&nbsp;<span class="keyword" id="8503199">else</span>&nbsp;<span class="keyword" id="8503204">if</span>&nbsp;<span class="op" id="8503207">*</span><span class="ident" id="8503208">url</span>&nbsp;<span class="op" id="8503212">!=</span>&nbsp;<span class="op" id="8503215">*</span><span class="ident" id="8503216">opaque</span>&nbsp;<span class="op" id="8503223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8503228">t</span><span class="op" id="8503229">.</span><span class="ident" id="8503230">Errorf</span><span class="op" id="8503236">(</span><span class="string" id="8503237">&#34;Parse&nbsp;failed&nbsp;to&nbsp;resolve&nbsp;opaque&nbsp;URL:&nbsp;want&nbsp;%#v,&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="8503292">,</span>&nbsp;<span class="ident" id="8503294">url</span><span class="op" id="8503297">,</span>&nbsp;<span class="ident" id="8503299">opaque</span><span class="op" id="8503305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8503309">}</span>&nbsp;<span class="keyword" id="8503311">else</span>&nbsp;<span class="keyword" id="8503316">if</span>&nbsp;<span class="ident" id="8503319">base</span>&nbsp;<span class="op" id="8503324">==</span>&nbsp;<span class="ident" id="8503327">url</span>&nbsp;<span class="op" id="8503331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8503336">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned,&nbsp;again.</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8503389">t</span><span class="op" id="8503390">.</span><span class="ident" id="8503391">Errorf</span><span class="op" id="8503397">(</span><span class="string" id="8503398">&#34;Expected&nbsp;URL.Parse&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="8503446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8503450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8503453">}</span><br>
<span class="lineno"></span><span class="op" id="8503455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">750</span><span class="keyword" id="8503458">func</span>&nbsp;<span class="ident" id="8503463">TestQueryValues</span><span class="op" id="8503478">(</span><span class="ident" id="8503479">t</span>&nbsp;<span class="op" id="8503481">*</span><span class="ident" id="8503482">testing</span><span class="op" id="8503489">.</span><span class="ident" id="8503490">T</span><span class="op" id="8503491">)</span>&nbsp;<span class="op" id="8503493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8503496">u</span><span class="op" id="8503497">,</span>&nbsp;<span class="ident" id="8503499">_</span>&nbsp;<span class="op" id="8503501">:=</span>&nbsp;<span class="ident" id="8503504">Parse</span><span class="op" id="8503509">(</span><span class="string" id="8503510">&#34;http://x.com?foo=bar&amp;bar=1&amp;bar=2&#34;</span><span class="op" id="8503544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8503547">v</span>&nbsp;<span class="op" id="8503549">:=</span>&nbsp;<span class="ident" id="8503552">u</span><span class="op" id="8503553">.</span><span class="ident" id="8503554">Query</span><span class="op" id="8503559">(</span><span class="op" id="8503560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8503563">if</span>&nbsp;<span class="builtinfunc" id="8503566">len</span><span class="op" id="8503569">(</span><span class="ident" id="8503570">v</span><span class="op" id="8503571">)</span>&nbsp;<span class="op" id="8503573">!=</span>&nbsp;<span class="num" id="8503576">2</span>&nbsp;<span class="op" id="8503578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8503582">t</span><span class="op" id="8503583">.</span><span class="ident" id="8503584">Errorf</span><span class="op" id="8503590">(</span><span class="string" id="8503591">&#34;got&nbsp;%d&nbsp;keys&nbsp;in&nbsp;Query&nbsp;values,&nbsp;want&nbsp;2&#34;</span><span class="op" id="8503628">,</span>&nbsp;<span class="builtinfunc" id="8503630">len</span><span class="op" id="8503633">(</span><span class="ident" id="8503634">v</span><span class="op" id="8503635">)</span><span class="op" id="8503636">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8503639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8503642">if</span>&nbsp;<span class="ident" id="8503645">g</span><span class="op" id="8503646">,</span>&nbsp;<span class="ident" id="8503648">e</span>&nbsp;<span class="op" id="8503650">:=</span>&nbsp;<span class="ident" id="8503653">v</span><span class="op" id="8503654">.</span><span class="ident" id="8503655">Get</span><span class="op" id="8503658">(</span><span class="string" id="8503659">&#34;foo&#34;</span><span class="op" id="8503664">)</span><span class="op" id="8503665">,</span>&nbsp;<span class="string" id="8503667">&#34;bar&#34;</span><span class="op" id="8503672">;</span>&nbsp;<span class="ident" id="8503674">g</span>&nbsp;<span class="op" id="8503676">!=</span>&nbsp;<span class="ident" id="8503679">e</span>&nbsp;<span class="op" id="8503681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8503685">t</span><span class="op" id="8503686">.</span><span class="ident" id="8503687">Errorf</span><span class="op" id="8503693">(</span><span class="string" id="8503694">&#34;Get(foo)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8503718">,</span>&nbsp;<span class="ident" id="8503720">g</span><span class="op" id="8503721">,</span>&nbsp;<span class="ident" id="8503723">e</span><span class="op" id="8503724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8503727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8503730">//&nbsp;Case&nbsp;sensitive:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8503750">if</span>&nbsp;<span class="ident" id="8503753">g</span><span class="op" id="8503754">,</span>&nbsp;<span class="ident" id="8503756">e</span>&nbsp;<span class="op" id="8503758">:=</span>&nbsp;<span class="ident" id="8503761">v</span><span class="op" id="8503762">.</span><span class="ident" id="8503763">Get</span><span class="op" id="8503766">(</span><span class="string" id="8503767">&#34;Foo&#34;</span><span class="op" id="8503772">)</span><span class="op" id="8503773">,</span>&nbsp;<span class="string" id="8503775">&#34;&#34;</span><span class="op" id="8503777">;</span>&nbsp;<span class="ident" id="8503779">g</span>&nbsp;<span class="op" id="8503781">!=</span>&nbsp;<span class="ident" id="8503784">e</span>&nbsp;<span class="op" id="8503786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8503790">t</span><span class="op" id="8503791">.</span><span class="ident" id="8503792">Errorf</span><span class="op" id="8503798">(</span><span class="string" id="8503799">&#34;Get(Foo)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8503823">,</span>&nbsp;<span class="ident" id="8503825">g</span><span class="op" id="8503826">,</span>&nbsp;<span class="ident" id="8503828">e</span><span class="op" id="8503829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8503832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8503835">if</span>&nbsp;<span class="ident" id="8503838">g</span><span class="op" id="8503839">,</span>&nbsp;<span class="ident" id="8503841">e</span>&nbsp;<span class="op" id="8503843">:=</span>&nbsp;<span class="ident" id="8503846">v</span><span class="op" id="8503847">.</span><span class="ident" id="8503848">Get</span><span class="op" id="8503851">(</span><span class="string" id="8503852">&#34;bar&#34;</span><span class="op" id="8503857">)</span><span class="op" id="8503858">,</span>&nbsp;<span class="string" id="8503860">&#34;1&#34;</span><span class="op" id="8503863">;</span>&nbsp;<span class="ident" id="8503865">g</span>&nbsp;<span class="op" id="8503867">!=</span>&nbsp;<span class="ident" id="8503870">e</span>&nbsp;<span class="op" id="8503872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8503876">t</span><span class="op" id="8503877">.</span><span class="ident" id="8503878">Errorf</span><span class="op" id="8503884">(</span><span class="string" id="8503885">&#34;Get(bar)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8503909">,</span>&nbsp;<span class="ident" id="8503911">g</span><span class="op" id="8503912">,</span>&nbsp;<span class="ident" id="8503914">e</span><span class="op" id="8503915">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8503918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8503921">if</span>&nbsp;<span class="ident" id="8503924">g</span><span class="op" id="8503925">,</span>&nbsp;<span class="ident" id="8503927">e</span>&nbsp;<span class="op" id="8503929">:=</span>&nbsp;<span class="ident" id="8503932">v</span><span class="op" id="8503933">.</span><span class="ident" id="8503934">Get</span><span class="op" id="8503937">(</span><span class="string" id="8503938">&#34;baz&#34;</span><span class="op" id="8503943">)</span><span class="op" id="8503944">,</span>&nbsp;<span class="string" id="8503946">&#34;&#34;</span><span class="op" id="8503948">;</span>&nbsp;<span class="ident" id="8503950">g</span>&nbsp;<span class="op" id="8503952">!=</span>&nbsp;<span class="ident" id="8503955">e</span>&nbsp;<span class="op" id="8503957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8503961">t</span><span class="op" id="8503962">.</span><span class="ident" id="8503963">Errorf</span><span class="op" id="8503969">(</span><span class="string" id="8503970">&#34;Get(baz)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8503994">,</span>&nbsp;<span class="ident" id="8503996">g</span><span class="op" id="8503997">,</span>&nbsp;<span class="ident" id="8503999">e</span><span class="op" id="8504000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504006">v</span><span class="op" id="8504007">.</span><span class="ident" id="8504008">Del</span><span class="op" id="8504011">(</span><span class="string" id="8504012">&#34;bar&#34;</span><span class="op" id="8504017">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8504020">if</span>&nbsp;<span class="ident" id="8504023">g</span><span class="op" id="8504024">,</span>&nbsp;<span class="ident" id="8504026">e</span>&nbsp;<span class="op" id="8504028">:=</span>&nbsp;<span class="ident" id="8504031">v</span><span class="op" id="8504032">.</span><span class="ident" id="8504033">Get</span><span class="op" id="8504036">(</span><span class="string" id="8504037">&#34;bar&#34;</span><span class="op" id="8504042">)</span><span class="op" id="8504043">,</span>&nbsp;<span class="string" id="8504045">&#34;&#34;</span><span class="op" id="8504047">;</span>&nbsp;<span class="ident" id="8504049">g</span>&nbsp;<span class="op" id="8504051">!=</span>&nbsp;<span class="ident" id="8504054">e</span>&nbsp;<span class="op" id="8504056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504060">t</span><span class="op" id="8504061">.</span><span class="ident" id="8504062">Errorf</span><span class="op" id="8504068">(</span><span class="string" id="8504069">&#34;second&nbsp;Get(bar)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8504100">,</span>&nbsp;<span class="ident" id="8504102">g</span><span class="op" id="8504103">,</span>&nbsp;<span class="ident" id="8504105">e</span><span class="op" id="8504106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504109">}</span><br>
<span class="lineno"></span><span class="op" id="8504111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span><span class="keyword" id="8504114">type</span>&nbsp;<span class="ident" id="8504119">parseTest</span>&nbsp;<span class="keyword" id="8504129">struct</span>&nbsp;<span class="op" id="8504136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504139">query</span>&nbsp;<span class="builtintype" id="8504145">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504153">out</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8504159">Values</span><br>
<span class="lineno"></span><span class="op" id="8504166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span><span class="keyword" id="8504169">var</span>&nbsp;<span class="ident" id="8504173">parseTests</span>&nbsp;<span class="op" id="8504184">=</span>&nbsp;<span class="op" id="8504186">[</span><span class="op" id="8504187">]</span><span class="ident" id="8504188">parseTest</span><span class="op" id="8504197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504204">query</span><span class="op" id="8504209">:</span>&nbsp;<span class="string" id="8504211">&#34;a=1&amp;b=2&#34;</span><span class="op" id="8504220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504224">out</span><span class="op" id="8504227">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8504231">Values</span><span class="op" id="8504237">{</span><span class="string" id="8504238">&#34;a&#34;</span><span class="op" id="8504241">:</span>&nbsp;<span class="op" id="8504243">[</span><span class="op" id="8504244">]</span><span class="builtintype" id="8504245">string</span><span class="op" id="8504251">{</span><span class="string" id="8504252">&#34;1&#34;</span><span class="op" id="8504255">}</span><span class="op" id="8504256">,</span>&nbsp;<span class="string" id="8504258">&#34;b&#34;</span><span class="op" id="8504261">:</span>&nbsp;<span class="op" id="8504263">[</span><span class="op" id="8504264">]</span><span class="builtintype" id="8504265">string</span><span class="op" id="8504271">{</span><span class="string" id="8504272">&#34;2&#34;</span><span class="op" id="8504275">}</span><span class="op" id="8504276">}</span><span class="op" id="8504277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504280">}</span><span class="op" id="8504281">,</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504288">query</span><span class="op" id="8504293">:</span>&nbsp;<span class="string" id="8504295">&#34;a=1&amp;a=2&amp;a=banana&#34;</span><span class="op" id="8504313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504317">out</span><span class="op" id="8504320">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8504324">Values</span><span class="op" id="8504330">{</span><span class="string" id="8504331">&#34;a&#34;</span><span class="op" id="8504334">:</span>&nbsp;<span class="op" id="8504336">[</span><span class="op" id="8504337">]</span><span class="builtintype" id="8504338">string</span><span class="op" id="8504344">{</span><span class="string" id="8504345">&#34;1&#34;</span><span class="op" id="8504348">,</span>&nbsp;<span class="string" id="8504350">&#34;2&#34;</span><span class="op" id="8504353">,</span>&nbsp;<span class="string" id="8504355">&#34;banana&#34;</span><span class="op" id="8504363">}</span><span class="op" id="8504364">}</span><span class="op" id="8504365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504368">}</span><span class="op" id="8504369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504372">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504376">query</span><span class="op" id="8504381">:</span>&nbsp;<span class="string" id="8504383">&#34;ascii=%3Ckey%3A+0x90%3E&#34;</span><span class="op" id="8504408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504412">out</span><span class="op" id="8504415">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8504419">Values</span><span class="op" id="8504425">{</span><span class="string" id="8504426">&#34;ascii&#34;</span><span class="op" id="8504433">:</span>&nbsp;<span class="op" id="8504435">[</span><span class="op" id="8504436">]</span><span class="builtintype" id="8504437">string</span><span class="op" id="8504443">{</span><span class="string" id="8504444">&#34;&lt;key:&nbsp;0x90&gt;&#34;</span><span class="op" id="8504457">}</span><span class="op" id="8504458">}</span><span class="op" id="8504459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504462">}</span><span class="op" id="8504463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504470">query</span><span class="op" id="8504475">:</span>&nbsp;<span class="string" id="8504477">&#34;a=1;b=2&#34;</span><span class="op" id="8504486">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504490">out</span><span class="op" id="8504493">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8504497">Values</span><span class="op" id="8504503">{</span><span class="string" id="8504504">&#34;a&#34;</span><span class="op" id="8504507">:</span>&nbsp;<span class="op" id="8504509">[</span><span class="op" id="8504510">]</span><span class="builtintype" id="8504511">string</span><span class="op" id="8504517">{</span><span class="string" id="8504518">&#34;1&#34;</span><span class="op" id="8504521">}</span><span class="op" id="8504522">,</span>&nbsp;<span class="string" id="8504524">&#34;b&#34;</span><span class="op" id="8504527">:</span>&nbsp;<span class="op" id="8504529">[</span><span class="op" id="8504530">]</span><span class="builtintype" id="8504531">string</span><span class="op" id="8504537">{</span><span class="string" id="8504538">&#34;2&#34;</span><span class="op" id="8504541">}</span><span class="op" id="8504542">}</span><span class="op" id="8504543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504546">}</span><span class="op" id="8504547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504554">query</span><span class="op" id="8504559">:</span>&nbsp;<span class="string" id="8504561">&#34;a=1&amp;a=2;a=banana&#34;</span><span class="op" id="8504579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504583">out</span><span class="op" id="8504586">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8504590">Values</span><span class="op" id="8504596">{</span><span class="string" id="8504597">&#34;a&#34;</span><span class="op" id="8504600">:</span>&nbsp;<span class="op" id="8504602">[</span><span class="op" id="8504603">]</span><span class="builtintype" id="8504604">string</span><span class="op" id="8504610">{</span><span class="string" id="8504611">&#34;1&#34;</span><span class="op" id="8504614">,</span>&nbsp;<span class="string" id="8504616">&#34;2&#34;</span><span class="op" id="8504619">,</span>&nbsp;<span class="string" id="8504621">&#34;banana&#34;</span><span class="op" id="8504629">}</span><span class="op" id="8504630">}</span><span class="op" id="8504631">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504634">}</span><span class="op" id="8504635">,</span><br>
<span class="lineno"></span><span class="op" id="8504637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8504640">func</span>&nbsp;<span class="ident" id="8504645">TestParseQuery</span><span class="op" id="8504659">(</span><span class="ident" id="8504660">t</span>&nbsp;<span class="op" id="8504662">*</span><span class="ident" id="8504663">testing</span><span class="op" id="8504670">.</span><span class="ident" id="8504671">T</span><span class="op" id="8504672">)</span>&nbsp;<span class="op" id="8504674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8504677">for</span>&nbsp;<span class="ident" id="8504681">i</span><span class="op" id="8504682">,</span>&nbsp;<span class="ident" id="8504684">test</span>&nbsp;<span class="op" id="8504689">:=</span>&nbsp;<span class="keyword" id="8504692">range</span>&nbsp;<span class="ident" id="8504698">parseTests</span>&nbsp;<span class="op" id="8504709">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504713">form</span><span class="op" id="8504717">,</span>&nbsp;<span class="ident" id="8504719">err</span>&nbsp;<span class="op" id="8504723">:=</span>&nbsp;<span class="ident" id="8504726">ParseQuery</span><span class="op" id="8504736">(</span><span class="ident" id="8504737">test</span><span class="op" id="8504741">.</span><span class="ident" id="8504742">query</span><span class="op" id="8504747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8504751">if</span>&nbsp;<span class="ident" id="8504754">err</span>&nbsp;<span class="op" id="8504758">!=</span>&nbsp;<span class="builtintype" id="8504761">nil</span>&nbsp;<span class="op" id="8504765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504770">t</span><span class="op" id="8504771">.</span><span class="ident" id="8504772">Errorf</span><span class="op" id="8504778">(</span><span class="string" id="8504779">&#34;test&nbsp;%d:&nbsp;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8504810">,</span>&nbsp;<span class="ident" id="8504812">i</span><span class="op" id="8504813">,</span>&nbsp;<span class="ident" id="8504815">err</span><span class="op" id="8504818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8504823">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504834">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8504838">if</span>&nbsp;<span class="builtinfunc" id="8504841">len</span><span class="op" id="8504844">(</span><span class="ident" id="8504845">form</span><span class="op" id="8504849">)</span>&nbsp;<span class="op" id="8504851">!=</span>&nbsp;<span class="builtinfunc" id="8504854">len</span><span class="op" id="8504857">(</span><span class="ident" id="8504858">test</span><span class="op" id="8504862">.</span><span class="ident" id="8504863">out</span><span class="op" id="8504866">)</span>&nbsp;<span class="op" id="8504868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504873">t</span><span class="op" id="8504874">.</span><span class="ident" id="8504875">Errorf</span><span class="op" id="8504881">(</span><span class="string" id="8504882">&#34;test&nbsp;%d:&nbsp;len(form)&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8504916">,</span>&nbsp;<span class="ident" id="8504918">i</span><span class="op" id="8504919">,</span>&nbsp;<span class="builtinfunc" id="8504921">len</span><span class="op" id="8504924">(</span><span class="ident" id="8504925">form</span><span class="op" id="8504929">)</span><span class="op" id="8504930">,</span>&nbsp;<span class="builtinfunc" id="8504932">len</span><span class="op" id="8504935">(</span><span class="ident" id="8504936">test</span><span class="op" id="8504940">.</span><span class="ident" id="8504941">out</span><span class="op" id="8504944">)</span><span class="op" id="8504945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8504949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8504953">for</span>&nbsp;<span class="ident" id="8504957">k</span><span class="op" id="8504958">,</span>&nbsp;<span class="ident" id="8504960">evs</span>&nbsp;<span class="op" id="8504964">:=</span>&nbsp;<span class="keyword" id="8504967">range</span>&nbsp;<span class="ident" id="8504973">test</span><span class="op" id="8504977">.</span><span class="ident" id="8504978">out</span>&nbsp;<span class="op" id="8504982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8504987">vs</span><span class="op" id="8504989">,</span>&nbsp;<span class="ident" id="8504991">ok</span>&nbsp;<span class="op" id="8504994">:=</span>&nbsp;<span class="ident" id="8504997">form</span><span class="op" id="8505001">[</span><span class="ident" id="8505002">k</span><span class="op" id="8505003">]</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8505008">if</span>&nbsp;<span class="op" id="8505011">!</span><span class="ident" id="8505012">ok</span>&nbsp;<span class="op" id="8505015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505021">t</span><span class="op" id="8505022">.</span><span class="ident" id="8505023">Errorf</span><span class="op" id="8505029">(</span><span class="string" id="8505030">&#34;test&nbsp;%d:&nbsp;Missing&nbsp;key&nbsp;%q&#34;</span><span class="op" id="8505055">,</span>&nbsp;<span class="ident" id="8505057">i</span><span class="op" id="8505058">,</span>&nbsp;<span class="ident" id="8505060">k</span><span class="op" id="8505061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8505067">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8505084">if</span>&nbsp;<span class="builtinfunc" id="8505087">len</span><span class="op" id="8505090">(</span><span class="ident" id="8505091">vs</span><span class="op" id="8505093">)</span>&nbsp;<span class="op" id="8505095">!=</span>&nbsp;<span class="builtinfunc" id="8505098">len</span><span class="op" id="8505101">(</span><span class="ident" id="8505102">evs</span><span class="op" id="8505105">)</span>&nbsp;<span class="op" id="8505107">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505113">t</span><span class="op" id="8505114">.</span><span class="ident" id="8505115">Errorf</span><span class="op" id="8505121">(</span><span class="string" id="8505122">&#34;test&nbsp;%d:&nbsp;len(form[%q])&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8505160">,</span>&nbsp;<span class="ident" id="8505162">i</span><span class="op" id="8505163">,</span>&nbsp;<span class="ident" id="8505165">k</span><span class="op" id="8505166">,</span>&nbsp;<span class="builtinfunc" id="8505168">len</span><span class="op" id="8505171">(</span><span class="ident" id="8505172">vs</span><span class="op" id="8505174">)</span><span class="op" id="8505175">,</span>&nbsp;<span class="builtinfunc" id="8505177">len</span><span class="op" id="8505180">(</span><span class="ident" id="8505181">evs</span><span class="op" id="8505184">)</span><span class="op" id="8505185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8505191">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8505208">for</span>&nbsp;<span class="ident" id="8505212">j</span><span class="op" id="8505213">,</span>&nbsp;<span class="ident" id="8505215">ev</span>&nbsp;<span class="op" id="8505218">:=</span>&nbsp;<span class="keyword" id="8505221">range</span>&nbsp;<span class="ident" id="8505227">evs</span>&nbsp;<span class="op" id="8505231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8505237">if</span>&nbsp;<span class="ident" id="8505240">v</span>&nbsp;<span class="op" id="8505242">:=</span>&nbsp;<span class="ident" id="8505245">vs</span><span class="op" id="8505247">[</span><span class="ident" id="8505248">j</span><span class="op" id="8505249">]</span><span class="op" id="8505250">;</span>&nbsp;<span class="ident" id="8505252">v</span>&nbsp;<span class="op" id="8505254">!=</span>&nbsp;<span class="ident" id="8505257">ev</span>&nbsp;<span class="op" id="8505260">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505267">t</span><span class="op" id="8505268">.</span><span class="ident" id="8505269">Errorf</span><span class="op" id="8505275">(</span><span class="string" id="8505276">&#34;test&nbsp;%d:&nbsp;form[%q][%d]&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8505313">,</span>&nbsp;<span class="ident" id="8505315">i</span><span class="op" id="8505316">,</span>&nbsp;<span class="ident" id="8505318">k</span><span class="op" id="8505319">,</span>&nbsp;<span class="ident" id="8505321">j</span><span class="op" id="8505322">,</span>&nbsp;<span class="ident" id="8505324">v</span><span class="op" id="8505325">,</span>&nbsp;<span class="ident" id="8505327">ev</span><span class="op" id="8505329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505347">}</span><br>
<span class="lineno">830</span><span class="op" id="8505349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8505352">type</span>&nbsp;<span class="ident" id="8505357">RequestURITest</span>&nbsp;<span class="keyword" id="8505372">struct</span>&nbsp;<span class="op" id="8505379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505382">url</span>&nbsp;<span class="op" id="8505386">*</span><span class="ident" id="8505387">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505392">out</span>&nbsp;<span class="builtintype" id="8505396">string</span><br>
<span class="lineno">835</span><span class="op" id="8505403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8505406">var</span>&nbsp;<span class="ident" id="8505410">requritests</span>&nbsp;<span class="op" id="8505422">=</span>&nbsp;<span class="op" id="8505424">[</span><span class="op" id="8505425">]</span><span class="ident" id="8505426">RequestURITest</span><span class="op" id="8505440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505447">&amp;</span><span class="ident" id="8505448">URL</span><span class="op" id="8505451">{</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505456">Scheme</span><span class="op" id="8505462">:</span>&nbsp;<span class="string" id="8505464">&#34;http&#34;</span><span class="op" id="8505470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505475">Host</span><span class="op" id="8505479">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8505483">&#34;example.com&#34;</span><span class="op" id="8505496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505501">Path</span><span class="op" id="8505505">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8505509">&#34;&#34;</span><span class="op" id="8505511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505515">}</span><span class="op" id="8505516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505520">&#34;/&#34;</span><span class="op" id="8505523">,</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505526">}</span><span class="op" id="8505527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505534">&amp;</span><span class="ident" id="8505535">URL</span><span class="op" id="8505538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505543">Scheme</span><span class="op" id="8505549">:</span>&nbsp;<span class="string" id="8505551">&#34;http&#34;</span><span class="op" id="8505557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505562">Host</span><span class="op" id="8505566">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8505570">&#34;example.com&#34;</span><span class="op" id="8505583">,</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505588">Path</span><span class="op" id="8505592">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8505596">&#34;/a&nbsp;b&#34;</span><span class="op" id="8505602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505606">}</span><span class="op" id="8505607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505611">&#34;/a%20b&#34;</span><span class="op" id="8505619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505622">}</span><span class="op" id="8505623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8505626">//&nbsp;golang.org/issue/4860&nbsp;variant&nbsp;1</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505666">&amp;</span><span class="ident" id="8505667">URL</span><span class="op" id="8505670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505675">Scheme</span><span class="op" id="8505681">:</span>&nbsp;<span class="string" id="8505683">&#34;http&#34;</span><span class="op" id="8505689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505694">Host</span><span class="op" id="8505698">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8505702">&#34;example.com&#34;</span><span class="op" id="8505715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505720">Opaque</span><span class="op" id="8505726">:</span>&nbsp;<span class="string" id="8505728">&#34;/%2F/%2F/&#34;</span><span class="op" id="8505739">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505743">}</span><span class="op" id="8505744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505748">&#34;/%2F/%2F/&#34;</span><span class="op" id="8505759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505762">}</span><span class="op" id="8505763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8505766">//&nbsp;golang.org/issue/4860&nbsp;variant&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505802">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505806">&amp;</span><span class="ident" id="8505807">URL</span><span class="op" id="8505810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505815">Scheme</span><span class="op" id="8505821">:</span>&nbsp;<span class="string" id="8505823">&#34;http&#34;</span><span class="op" id="8505829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505834">Host</span><span class="op" id="8505838">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8505842">&#34;example.com&#34;</span><span class="op" id="8505855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505860">Opaque</span><span class="op" id="8505866">:</span>&nbsp;<span class="string" id="8505868">&#34;//other.example.com/%2F/%2F/&#34;</span><span class="op" id="8505898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505902">}</span><span class="op" id="8505903">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505907">&#34;http://other.example.com/%2F/%2F/&#34;</span><span class="op" id="8505942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505945">}</span><span class="op" id="8505946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8505953">&amp;</span><span class="ident" id="8505954">URL</span><span class="op" id="8505957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505962">Scheme</span><span class="op" id="8505968">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8505972">&#34;http&#34;</span><span class="op" id="8505978">,</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505983">Host</span><span class="op" id="8505987">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505993">&#34;example.com&#34;</span><span class="op" id="8506006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506011">Path</span><span class="op" id="8506015">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8506021">&#34;/a&nbsp;b&#34;</span><span class="op" id="8506027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506032">RawQuery</span><span class="op" id="8506040">:</span>&nbsp;<span class="string" id="8506042">&#34;q=go+language&#34;</span><span class="op" id="8506057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506061">}</span><span class="op" id="8506062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8506066">&#34;/a%20b?q=go+language&#34;</span><span class="op" id="8506088">,</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506091">}</span><span class="op" id="8506092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506099">&amp;</span><span class="ident" id="8506100">URL</span><span class="op" id="8506103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506108">Scheme</span><span class="op" id="8506114">:</span>&nbsp;<span class="string" id="8506116">&#34;myschema&#34;</span><span class="op" id="8506126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506131">Opaque</span><span class="op" id="8506137">:</span>&nbsp;<span class="string" id="8506139">&#34;opaque&#34;</span><span class="op" id="8506147">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506151">}</span><span class="op" id="8506152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8506156">&#34;opaque&#34;</span><span class="op" id="8506164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506167">}</span><span class="op" id="8506168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506175">&amp;</span><span class="ident" id="8506176">URL</span><span class="op" id="8506179">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506184">Scheme</span><span class="op" id="8506190">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8506194">&#34;myschema&#34;</span><span class="op" id="8506204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506209">Opaque</span><span class="op" id="8506215">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8506219">&#34;opaque&#34;</span><span class="op" id="8506227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506232">RawQuery</span><span class="op" id="8506240">:</span>&nbsp;<span class="string" id="8506242">&#34;q=go+language&#34;</span><span class="op" id="8506257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506261">}</span><span class="op" id="8506262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8506266">&#34;opaque?q=go+language&#34;</span><span class="op" id="8506288">,</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506291">}</span><span class="op" id="8506292">,</span><br>
<span class="lineno"></span><span class="op" id="8506294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8506297">func</span>&nbsp;<span class="ident" id="8506302">TestRequestURI</span><span class="op" id="8506316">(</span><span class="ident" id="8506317">t</span>&nbsp;<span class="op" id="8506319">*</span><span class="ident" id="8506320">testing</span><span class="op" id="8506327">.</span><span class="ident" id="8506328">T</span><span class="op" id="8506329">)</span>&nbsp;<span class="op" id="8506331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8506334">for</span>&nbsp;<span class="ident" id="8506338">_</span><span class="op" id="8506339">,</span>&nbsp;<span class="ident" id="8506341">tt</span>&nbsp;<span class="op" id="8506344">:=</span>&nbsp;<span class="keyword" id="8506347">range</span>&nbsp;<span class="ident" id="8506353">requritests</span>&nbsp;<span class="op" id="8506365">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506369">s</span>&nbsp;<span class="op" id="8506371">:=</span>&nbsp;<span class="ident" id="8506374">tt</span><span class="op" id="8506376">.</span><span class="ident" id="8506377">url</span><span class="op" id="8506380">.</span><span class="ident" id="8506381">RequestURI</span><span class="op" id="8506391">(</span><span class="op" id="8506392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8506396">if</span>&nbsp;<span class="ident" id="8506399">s</span>&nbsp;<span class="op" id="8506401">!=</span>&nbsp;<span class="ident" id="8506404">tt</span><span class="op" id="8506406">.</span><span class="ident" id="8506407">out</span>&nbsp;<span class="op" id="8506411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506416">t</span><span class="op" id="8506417">.</span><span class="ident" id="8506418">Errorf</span><span class="op" id="8506424">(</span><span class="string" id="8506425">&#34;%#v.RequestURI()&nbsp;==&nbsp;%q&nbsp;(expected&nbsp;%q)&#34;</span><span class="op" id="8506463">,</span>&nbsp;<span class="ident" id="8506465">tt</span><span class="op" id="8506467">.</span><span class="ident" id="8506468">url</span><span class="op" id="8506471">,</span>&nbsp;<span class="ident" id="8506473">s</span><span class="op" id="8506474">,</span>&nbsp;<span class="ident" id="8506476">tt</span><span class="op" id="8506478">.</span><span class="ident" id="8506479">out</span><span class="op" id="8506482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506489">}</span><br>
<span class="lineno">905</span><span class="op" id="8506491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8506494">func</span>&nbsp;<span class="ident" id="8506499">TestParseFailure</span><span class="op" id="8506515">(</span><span class="ident" id="8506516">t</span>&nbsp;<span class="op" id="8506518">*</span><span class="ident" id="8506519">testing</span><span class="op" id="8506526">.</span><span class="ident" id="8506527">T</span><span class="op" id="8506528">)</span>&nbsp;<span class="op" id="8506530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8506533">//&nbsp;Test&nbsp;that&nbsp;the&nbsp;first&nbsp;parse&nbsp;error&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8506582">const</span>&nbsp;<span class="ident" id="8506588">url</span>&nbsp;<span class="op" id="8506592">=</span>&nbsp;<span class="string" id="8506594">&#34;%gh&amp;%ij&#34;</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506605">_</span><span class="op" id="8506606">,</span>&nbsp;<span class="ident" id="8506608">err</span>&nbsp;<span class="op" id="8506612">:=</span>&nbsp;<span class="ident" id="8506615">ParseQuery</span><span class="op" id="8506625">(</span><span class="ident" id="8506626">url</span><span class="op" id="8506629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506632">errStr</span>&nbsp;<span class="op" id="8506639">:=</span>&nbsp;<span class="ident" id="8506642">fmt</span><span class="op" id="8506645">.</span><span class="ident" id="8506646">Sprint</span><span class="op" id="8506652">(</span><span class="ident" id="8506653">err</span><span class="op" id="8506656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8506659">if</span>&nbsp;<span class="op" id="8506662">!</span><span class="ident" id="8506663">strings</span><span class="op" id="8506670">.</span><span class="ident" id="8506671">Contains</span><span class="op" id="8506679">(</span><span class="ident" id="8506680">errStr</span><span class="op" id="8506686">,</span>&nbsp;<span class="string" id="8506688">&#34;%gh&#34;</span><span class="op" id="8506693">)</span>&nbsp;<span class="op" id="8506695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506699">t</span><span class="op" id="8506700">.</span><span class="ident" id="8506701">Errorf</span><span class="op" id="8506707">(</span><span class="string" id="8506708">`ParseQuery(%q)&nbsp;returned&nbsp;error&nbsp;%q,&nbsp;want&nbsp;something&nbsp;containing&nbsp;%q&#34;`</span><span class="op" id="8506773">,</span>&nbsp;<span class="ident" id="8506775">url</span><span class="op" id="8506778">,</span>&nbsp;<span class="ident" id="8506780">errStr</span><span class="op" id="8506786">,</span>&nbsp;<span class="string" id="8506788">&#34;%gh&#34;</span><span class="op" id="8506793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506796">}</span><br>
<span class="lineno">915</span><span class="op" id="8506798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8506801">type</span>&nbsp;<span class="ident" id="8506806">shouldEscapeTest</span>&nbsp;<span class="keyword" id="8506823">struct</span>&nbsp;<span class="op" id="8506830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506833">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8506840">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506846">mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8506853">encoding</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8506863">escape</span>&nbsp;<span class="builtintype" id="8506870">bool</span><br>
<span class="lineno"></span><span class="op" id="8506875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8506878">var</span>&nbsp;<span class="ident" id="8506882">shouldEscapeTests</span>&nbsp;<span class="op" id="8506900">=</span>&nbsp;<span class="op" id="8506902">[</span><span class="op" id="8506903">]</span><span class="ident" id="8506904">shouldEscapeTest</span><span class="op" id="8506920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8506923">//&nbsp;Unreserved&nbsp;characters&nbsp;(§2.3)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506957">{</span><span class="string" id="8506958">&#39;a&#39;</span><span class="op" id="8506961">,</span>&nbsp;<span class="ident" id="8506963">encodePath</span><span class="op" id="8506973">,</span>&nbsp;<span class="builtintype" id="8506975">false</span><span class="op" id="8506980">}</span><span class="op" id="8506981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506984">{</span><span class="string" id="8506985">&#39;a&#39;</span><span class="op" id="8506988">,</span>&nbsp;<span class="ident" id="8506990">encodeUserPassword</span><span class="op" id="8507008">,</span>&nbsp;<span class="builtintype" id="8507010">false</span><span class="op" id="8507015">}</span><span class="op" id="8507016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507019">{</span><span class="string" id="8507020">&#39;a&#39;</span><span class="op" id="8507023">,</span>&nbsp;<span class="ident" id="8507025">encodeQueryComponent</span><span class="op" id="8507045">,</span>&nbsp;<span class="builtintype" id="8507047">false</span><span class="op" id="8507052">}</span><span class="op" id="8507053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507056">{</span><span class="string" id="8507057">&#39;a&#39;</span><span class="op" id="8507060">,</span>&nbsp;<span class="ident" id="8507062">encodeFragment</span><span class="op" id="8507076">,</span>&nbsp;<span class="builtintype" id="8507078">false</span><span class="op" id="8507083">}</span><span class="op" id="8507084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507087">{</span><span class="string" id="8507088">&#39;z&#39;</span><span class="op" id="8507091">,</span>&nbsp;<span class="ident" id="8507093">encodePath</span><span class="op" id="8507103">,</span>&nbsp;<span class="builtintype" id="8507105">false</span><span class="op" id="8507110">}</span><span class="op" id="8507111">,</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507114">{</span><span class="string" id="8507115">&#39;A&#39;</span><span class="op" id="8507118">,</span>&nbsp;<span class="ident" id="8507120">encodePath</span><span class="op" id="8507130">,</span>&nbsp;<span class="builtintype" id="8507132">false</span><span class="op" id="8507137">}</span><span class="op" id="8507138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507141">{</span><span class="string" id="8507142">&#39;Z&#39;</span><span class="op" id="8507145">,</span>&nbsp;<span class="ident" id="8507147">encodePath</span><span class="op" id="8507157">,</span>&nbsp;<span class="builtintype" id="8507159">false</span><span class="op" id="8507164">}</span><span class="op" id="8507165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507168">{</span><span class="string" id="8507169">&#39;0&#39;</span><span class="op" id="8507172">,</span>&nbsp;<span class="ident" id="8507174">encodePath</span><span class="op" id="8507184">,</span>&nbsp;<span class="builtintype" id="8507186">false</span><span class="op" id="8507191">}</span><span class="op" id="8507192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507195">{</span><span class="string" id="8507196">&#39;9&#39;</span><span class="op" id="8507199">,</span>&nbsp;<span class="ident" id="8507201">encodePath</span><span class="op" id="8507211">,</span>&nbsp;<span class="builtintype" id="8507213">false</span><span class="op" id="8507218">}</span><span class="op" id="8507219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507222">{</span><span class="string" id="8507223">&#39;-&#39;</span><span class="op" id="8507226">,</span>&nbsp;<span class="ident" id="8507228">encodePath</span><span class="op" id="8507238">,</span>&nbsp;<span class="builtintype" id="8507240">false</span><span class="op" id="8507245">}</span><span class="op" id="8507246">,</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507249">{</span><span class="string" id="8507250">&#39;-&#39;</span><span class="op" id="8507253">,</span>&nbsp;<span class="ident" id="8507255">encodeUserPassword</span><span class="op" id="8507273">,</span>&nbsp;<span class="builtintype" id="8507275">false</span><span class="op" id="8507280">}</span><span class="op" id="8507281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507284">{</span><span class="string" id="8507285">&#39;-&#39;</span><span class="op" id="8507288">,</span>&nbsp;<span class="ident" id="8507290">encodeQueryComponent</span><span class="op" id="8507310">,</span>&nbsp;<span class="builtintype" id="8507312">false</span><span class="op" id="8507317">}</span><span class="op" id="8507318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507321">{</span><span class="string" id="8507322">&#39;-&#39;</span><span class="op" id="8507325">,</span>&nbsp;<span class="ident" id="8507327">encodeFragment</span><span class="op" id="8507341">,</span>&nbsp;<span class="builtintype" id="8507343">false</span><span class="op" id="8507348">}</span><span class="op" id="8507349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507352">{</span><span class="string" id="8507353">&#39;.&#39;</span><span class="op" id="8507356">,</span>&nbsp;<span class="ident" id="8507358">encodePath</span><span class="op" id="8507368">,</span>&nbsp;<span class="builtintype" id="8507370">false</span><span class="op" id="8507375">}</span><span class="op" id="8507376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507379">{</span><span class="string" id="8507380">&#39;_&#39;</span><span class="op" id="8507383">,</span>&nbsp;<span class="ident" id="8507385">encodePath</span><span class="op" id="8507395">,</span>&nbsp;<span class="builtintype" id="8507397">false</span><span class="op" id="8507402">}</span><span class="op" id="8507403">,</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507406">{</span><span class="string" id="8507407">&#39;~&#39;</span><span class="op" id="8507410">,</span>&nbsp;<span class="ident" id="8507412">encodePath</span><span class="op" id="8507422">,</span>&nbsp;<span class="builtintype" id="8507424">false</span><span class="op" id="8507429">}</span><span class="op" id="8507430">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8507434">//&nbsp;User&nbsp;information&nbsp;(§3.2.1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507465">{</span><span class="string" id="8507466">&#39;:&#39;</span><span class="op" id="8507469">,</span>&nbsp;<span class="ident" id="8507471">encodeUserPassword</span><span class="op" id="8507489">,</span>&nbsp;<span class="builtintype" id="8507491">true</span><span class="op" id="8507495">}</span><span class="op" id="8507496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507499">{</span><span class="string" id="8507500">&#39;/&#39;</span><span class="op" id="8507503">,</span>&nbsp;<span class="ident" id="8507505">encodeUserPassword</span><span class="op" id="8507523">,</span>&nbsp;<span class="builtintype" id="8507525">true</span><span class="op" id="8507529">}</span><span class="op" id="8507530">,</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507533">{</span><span class="string" id="8507534">&#39;?&#39;</span><span class="op" id="8507537">,</span>&nbsp;<span class="ident" id="8507539">encodeUserPassword</span><span class="op" id="8507557">,</span>&nbsp;<span class="builtintype" id="8507559">true</span><span class="op" id="8507563">}</span><span class="op" id="8507564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507567">{</span><span class="string" id="8507568">&#39;@&#39;</span><span class="op" id="8507571">,</span>&nbsp;<span class="ident" id="8507573">encodeUserPassword</span><span class="op" id="8507591">,</span>&nbsp;<span class="builtintype" id="8507593">true</span><span class="op" id="8507597">}</span><span class="op" id="8507598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507601">{</span><span class="string" id="8507602">&#39;$&#39;</span><span class="op" id="8507605">,</span>&nbsp;<span class="ident" id="8507607">encodeUserPassword</span><span class="op" id="8507625">,</span>&nbsp;<span class="builtintype" id="8507627">false</span><span class="op" id="8507632">}</span><span class="op" id="8507633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507636">{</span><span class="string" id="8507637">&#39;&amp;&#39;</span><span class="op" id="8507640">,</span>&nbsp;<span class="ident" id="8507642">encodeUserPassword</span><span class="op" id="8507660">,</span>&nbsp;<span class="builtintype" id="8507662">false</span><span class="op" id="8507667">}</span><span class="op" id="8507668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507671">{</span><span class="string" id="8507672">&#39;+&#39;</span><span class="op" id="8507675">,</span>&nbsp;<span class="ident" id="8507677">encodeUserPassword</span><span class="op" id="8507695">,</span>&nbsp;<span class="builtintype" id="8507697">false</span><span class="op" id="8507702">}</span><span class="op" id="8507703">,</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507706">{</span><span class="string" id="8507707">&#39;,&#39;</span><span class="op" id="8507710">,</span>&nbsp;<span class="ident" id="8507712">encodeUserPassword</span><span class="op" id="8507730">,</span>&nbsp;<span class="builtintype" id="8507732">false</span><span class="op" id="8507737">}</span><span class="op" id="8507738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507741">{</span><span class="string" id="8507742">&#39;;&#39;</span><span class="op" id="8507745">,</span>&nbsp;<span class="ident" id="8507747">encodeUserPassword</span><span class="op" id="8507765">,</span>&nbsp;<span class="builtintype" id="8507767">false</span><span class="op" id="8507772">}</span><span class="op" id="8507773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507776">{</span><span class="string" id="8507777">&#39;=&#39;</span><span class="op" id="8507780">,</span>&nbsp;<span class="ident" id="8507782">encodeUserPassword</span><span class="op" id="8507800">,</span>&nbsp;<span class="builtintype" id="8507802">false</span><span class="op" id="8507807">}</span><span class="op" id="8507808">,</span><br>
<span class="lineno"></span><span class="op" id="8507810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">955</span><span class="keyword" id="8507813">func</span>&nbsp;<span class="ident" id="8507818">TestShouldEscape</span><span class="op" id="8507834">(</span><span class="ident" id="8507835">t</span>&nbsp;<span class="op" id="8507837">*</span><span class="ident" id="8507838">testing</span><span class="op" id="8507845">.</span><span class="ident" id="8507846">T</span><span class="op" id="8507847">)</span>&nbsp;<span class="op" id="8507849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8507852">for</span>&nbsp;<span class="ident" id="8507856">_</span><span class="op" id="8507857">,</span>&nbsp;<span class="ident" id="8507859">tt</span>&nbsp;<span class="op" id="8507862">:=</span>&nbsp;<span class="keyword" id="8507865">range</span>&nbsp;<span class="ident" id="8507871">shouldEscapeTests</span>&nbsp;<span class="op" id="8507889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8507893">if</span>&nbsp;<span class="ident" id="8507896">shouldEscape</span><span class="op" id="8507908">(</span><span class="ident" id="8507909">tt</span><span class="op" id="8507911">.</span><span class="ident" id="8507912">in</span><span class="op" id="8507914">,</span>&nbsp;<span class="ident" id="8507916">tt</span><span class="op" id="8507918">.</span><span class="ident" id="8507919">mode</span><span class="op" id="8507923">)</span>&nbsp;<span class="op" id="8507925">!=</span>&nbsp;<span class="ident" id="8507928">tt</span><span class="op" id="8507930">.</span><span class="ident" id="8507931">escape</span>&nbsp;<span class="op" id="8507938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8507943">t</span><span class="op" id="8507944">.</span><span class="ident" id="8507945">Errorf</span><span class="op" id="8507951">(</span><span class="string" id="8507952">&#34;shouldEscape(%q,&nbsp;%v)&nbsp;returned&nbsp;%v;&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="8507999">,</span>&nbsp;<span class="ident" id="8508001">tt</span><span class="op" id="8508003">.</span><span class="ident" id="8508004">in</span><span class="op" id="8508006">,</span>&nbsp;<span class="ident" id="8508008">tt</span><span class="op" id="8508010">.</span><span class="ident" id="8508011">mode</span><span class="op" id="8508015">,</span>&nbsp;<span class="op" id="8508017">!</span><span class="ident" id="8508018">tt</span><span class="op" id="8508020">.</span><span class="ident" id="8508021">escape</span><span class="op" id="8508027">,</span>&nbsp;<span class="ident" id="8508029">tt</span><span class="op" id="8508031">.</span><span class="ident" id="8508032">escape</span><span class="op" id="8508038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8508042">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8508045">}</span><br>
<span class="lineno"></span><span class="op" id="8508047">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
