<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2122878">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2122933">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2122987">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2123038">package</span>&nbsp;<span class="ident" id="2123046">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2123052">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspBessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2123118">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2123172">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2123223">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2123278">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2123308">//</span><br>
<span class="lineno"></span><span class="comment" id="2123311">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2123367">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2123436">//</span><br>
<span class="lineno"></span><span class="comment" id="2123439">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2123498">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2123554">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2123611">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2123628">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2123684">//</span><br>
<span class="lineno">25</span><span class="comment" id="2123687">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2123729">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="2123789">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="2123803">//</span><br>
<span class="lineno"></span><span class="comment" id="2123806">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="2123824">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="2123889">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2123952">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="2123986">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="2124020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="2124054">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="2124106">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="2124146">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2124201">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="2124256">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="2124313">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2124366">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2124420">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="2124454">//</span><br>
<span class="lineno"></span><span class="comment" id="2124457">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="2124508">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2124555">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2124579">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2124640">//</span><br>
<span class="lineno">50</span><span class="comment" id="2124643">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2124665">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2124685">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2124705">func</span>&nbsp;<span class="ident" id="2124710">Jn</span><span class="op" id="2124712">(</span><span class="ident" id="2124713">n</span>&nbsp;<span class="builtintype" id="2124715">int</span><span class="op" id="2124718">,</span>&nbsp;<span class="ident" id="2124720">x</span>&nbsp;<span class="builtintype" id="2124722">float64</span><span class="op" id="2124729">)</span>&nbsp;<span class="builtintype" id="2124731">float64</span>&nbsp;<span class="op" id="2124739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2124742">const</span>&nbsp;<span class="op" id="2124748">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2124752">TwoM29</span>&nbsp;<span class="op" id="2124759">=</span>&nbsp;<span class="num" id="2124761">1.0</span>&nbsp;<span class="op" id="2124765">/</span>&nbsp;<span class="op" id="2124767">(</span><span class="num" id="2124768">1</span>&nbsp;<span class="op" id="2124770">&lt;&lt;</span>&nbsp;<span class="num" id="2124773">29</span><span class="op" id="2124775">)</span>&nbsp;<span class="comment" id="2124777">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2124808">Two302</span>&nbsp;<span class="op" id="2124815">=</span>&nbsp;<span class="num" id="2124817">1</span>&nbsp;<span class="op" id="2124819">&lt;&lt;</span>&nbsp;<span class="num" id="2124822">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2124833">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2124863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2124866">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2124884">switch</span>&nbsp;<span class="op" id="2124891">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2124894">case</span>&nbsp;<span class="ident" id="2124899">IsNaN</span><span class="op" id="2124904">(</span><span class="ident" id="2124905">x</span><span class="op" id="2124906">)</span><span class="op" id="2124907">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2124911">return</span>&nbsp;<span class="ident" id="2124918">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2124921">case</span>&nbsp;<span class="ident" id="2124926">IsInf</span><span class="op" id="2124931">(</span><span class="ident" id="2124932">x</span><span class="op" id="2124933">,</span>&nbsp;<span class="num" id="2124935">0</span><span class="op" id="2124936">)</span><span class="op" id="2124937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2124941">return</span>&nbsp;<span class="num" id="2124948">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2124951">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2124954">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125017">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125048">if</span>&nbsp;<span class="ident" id="2125051">n</span>&nbsp;<span class="op" id="2125053">==</span>&nbsp;<span class="num" id="2125056">0</span>&nbsp;<span class="op" id="2125058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125062">return</span>&nbsp;<span class="ident" id="2125069">J0</span><span class="op" id="2125071">(</span><span class="ident" id="2125072">x</span><span class="op" id="2125073">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2125076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125079">if</span>&nbsp;<span class="ident" id="2125082">x</span>&nbsp;<span class="op" id="2125084">==</span>&nbsp;<span class="num" id="2125087">0</span>&nbsp;<span class="op" id="2125089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125093">return</span>&nbsp;<span class="num" id="2125100">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2125103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125106">if</span>&nbsp;<span class="ident" id="2125109">n</span>&nbsp;<span class="op" id="2125111">&lt;</span>&nbsp;<span class="num" id="2125113">0</span>&nbsp;<span class="op" id="2125115">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2125119">n</span><span class="op" id="2125120">,</span>&nbsp;<span class="ident" id="2125122">x</span>&nbsp;<span class="op" id="2125124">=</span>&nbsp;<span class="op" id="2125126">-</span><span class="ident" id="2125127">n</span><span class="op" id="2125128">,</span>&nbsp;<span class="op" id="2125130">-</span><span class="ident" id="2125131">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2125134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125137">if</span>&nbsp;<span class="ident" id="2125140">n</span>&nbsp;<span class="op" id="2125142">==</span>&nbsp;<span class="num" id="2125145">1</span>&nbsp;<span class="op" id="2125147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125151">return</span>&nbsp;<span class="ident" id="2125158">J1</span><span class="op" id="2125160">(</span><span class="ident" id="2125161">x</span><span class="op" id="2125162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2125165">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2125168">sign</span>&nbsp;<span class="op" id="2125173">:=</span>&nbsp;<span class="builtintype" id="2125176">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125183">if</span>&nbsp;<span class="ident" id="2125186">x</span>&nbsp;<span class="op" id="2125188">&lt;</span>&nbsp;<span class="num" id="2125190">0</span>&nbsp;<span class="op" id="2125192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2125196">x</span>&nbsp;<span class="op" id="2125198">=</span>&nbsp;<span class="op" id="2125200">-</span><span class="ident" id="2125201">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125205">if</span>&nbsp;<span class="ident" id="2125208">n</span><span class="op" id="2125209">&amp;</span><span class="num" id="2125210">1</span>&nbsp;<span class="op" id="2125212">==</span>&nbsp;<span class="num" id="2125215">1</span>&nbsp;<span class="op" id="2125217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2125222">sign</span>&nbsp;<span class="op" id="2125227">=</span>&nbsp;<span class="builtintype" id="2125229">true</span>&nbsp;<span class="comment" id="2125234">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2125260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2125263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125266">var</span>&nbsp;<span class="ident" id="2125270">b</span>&nbsp;<span class="builtintype" id="2125272">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125281">if</span>&nbsp;<span class="builtintype" id="2125284">float64</span><span class="op" id="2125291">(</span><span class="ident" id="2125292">n</span><span class="op" id="2125293">)</span>&nbsp;<span class="op" id="2125295">&lt;=</span>&nbsp;<span class="ident" id="2125298">x</span>&nbsp;<span class="op" id="2125300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125304">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125352">if</span>&nbsp;<span class="ident" id="2125355">x</span>&nbsp;<span class="op" id="2125357">&gt;=</span>&nbsp;<span class="ident" id="2125360">Two302</span>&nbsp;<span class="op" id="2125367">{</span>&nbsp;<span class="comment" id="2125369">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125387">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125405">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125460">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125515">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125554">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125611">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125617">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125673">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125727">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125775">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125823">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2125871">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125920">var</span>&nbsp;<span class="ident" id="2125924">temp</span>&nbsp;<span class="builtintype" id="2125929">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125940">switch</span>&nbsp;<span class="ident" id="2125947">n</span>&nbsp;<span class="op" id="2125949">&amp;</span>&nbsp;<span class="num" id="2125951">3</span>&nbsp;<span class="op" id="2125953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125958">case</span>&nbsp;<span class="num" id="2125963">0</span><span class="op" id="2125964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2125970">temp</span>&nbsp;<span class="op" id="2125975">=</span>&nbsp;<span class="ident" id="2125977">Cos</span><span class="op" id="2125980">(</span><span class="ident" id="2125981">x</span><span class="op" id="2125982">)</span>&nbsp;<span class="op" id="2125984">+</span>&nbsp;<span class="ident" id="2125986">Sin</span><span class="op" id="2125989">(</span><span class="ident" id="2125990">x</span><span class="op" id="2125991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2125996">case</span>&nbsp;<span class="num" id="2126001">1</span><span class="op" id="2126002">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126008">temp</span>&nbsp;<span class="op" id="2126013">=</span>&nbsp;<span class="op" id="2126015">-</span><span class="ident" id="2126016">Cos</span><span class="op" id="2126019">(</span><span class="ident" id="2126020">x</span><span class="op" id="2126021">)</span>&nbsp;<span class="op" id="2126023">+</span>&nbsp;<span class="ident" id="2126025">Sin</span><span class="op" id="2126028">(</span><span class="ident" id="2126029">x</span><span class="op" id="2126030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2126035">case</span>&nbsp;<span class="num" id="2126040">2</span><span class="op" id="2126041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126047">temp</span>&nbsp;<span class="op" id="2126052">=</span>&nbsp;<span class="op" id="2126054">-</span><span class="ident" id="2126055">Cos</span><span class="op" id="2126058">(</span><span class="ident" id="2126059">x</span><span class="op" id="2126060">)</span>&nbsp;<span class="op" id="2126062">-</span>&nbsp;<span class="ident" id="2126064">Sin</span><span class="op" id="2126067">(</span><span class="ident" id="2126068">x</span><span class="op" id="2126069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2126074">case</span>&nbsp;<span class="num" id="2126079">3</span><span class="op" id="2126080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126086">temp</span>&nbsp;<span class="op" id="2126091">=</span>&nbsp;<span class="ident" id="2126093">Cos</span><span class="op" id="2126096">(</span><span class="ident" id="2126097">x</span><span class="op" id="2126098">)</span>&nbsp;<span class="op" id="2126100">-</span>&nbsp;<span class="ident" id="2126102">Sin</span><span class="op" id="2126105">(</span><span class="ident" id="2126106">x</span><span class="op" id="2126107">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2126112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126117">b</span>&nbsp;<span class="op" id="2126119">=</span>&nbsp;<span class="op" id="2126121">(</span><span class="num" id="2126122">1</span>&nbsp;<span class="op" id="2126124">/</span>&nbsp;<span class="ident" id="2126126">SqrtPi</span><span class="op" id="2126132">)</span>&nbsp;<span class="op" id="2126134">*</span>&nbsp;<span class="ident" id="2126136">temp</span>&nbsp;<span class="op" id="2126141">/</span>&nbsp;<span class="ident" id="2126143">Sqrt</span><span class="op" id="2126147">(</span><span class="ident" id="2126148">x</span><span class="op" id="2126149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2126153">}</span>&nbsp;<span class="keyword" id="2126155">else</span>&nbsp;<span class="op" id="2126160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126165">b</span>&nbsp;<span class="op" id="2126167">=</span>&nbsp;<span class="ident" id="2126169">J1</span><span class="op" id="2126171">(</span><span class="ident" id="2126172">x</span><span class="op" id="2126173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2126178">for</span>&nbsp;<span class="ident" id="2126182">i</span><span class="op" id="2126183">,</span>&nbsp;<span class="ident" id="2126185">a</span>&nbsp;<span class="op" id="2126187">:=</span>&nbsp;<span class="num" id="2126190">1</span><span class="op" id="2126191">,</span>&nbsp;<span class="ident" id="2126193">J0</span><span class="op" id="2126195">(</span><span class="ident" id="2126196">x</span><span class="op" id="2126197">)</span><span class="op" id="2126198">;</span>&nbsp;<span class="ident" id="2126200">i</span>&nbsp;<span class="op" id="2126202">&lt;</span>&nbsp;<span class="ident" id="2126204">n</span><span class="op" id="2126205">;</span>&nbsp;<span class="ident" id="2126207">i</span><span class="op" id="2126208">++</span>&nbsp;<span class="op" id="2126211">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126217">a</span><span class="op" id="2126218">,</span>&nbsp;<span class="ident" id="2126220">b</span>&nbsp;<span class="op" id="2126222">=</span>&nbsp;<span class="ident" id="2126224">b</span><span class="op" id="2126225">,</span>&nbsp;<span class="ident" id="2126227">b</span><span class="op" id="2126228">*</span><span class="op" id="2126229">(</span><span class="builtintype" id="2126230">float64</span><span class="op" id="2126237">(</span><span class="ident" id="2126238">i</span><span class="op" id="2126239">+</span><span class="ident" id="2126240">i</span><span class="op" id="2126241">)</span><span class="op" id="2126242">/</span><span class="ident" id="2126243">x</span><span class="op" id="2126244">)</span><span class="op" id="2126245">-</span><span class="ident" id="2126246">a</span>&nbsp;<span class="comment" id="2126248">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2126270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2126274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2126277">}</span>&nbsp;<span class="keyword" id="2126279">else</span>&nbsp;<span class="op" id="2126284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2126288">if</span>&nbsp;<span class="ident" id="2126291">x</span>&nbsp;<span class="op" id="2126293">&lt;</span>&nbsp;<span class="ident" id="2126295">TwoM29</span>&nbsp;<span class="op" id="2126302">{</span>&nbsp;<span class="comment" id="2126304">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2126321">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2126382">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2126419">if</span>&nbsp;<span class="ident" id="2126422">n</span>&nbsp;<span class="op" id="2126424">&gt;</span>&nbsp;<span class="num" id="2126426">33</span>&nbsp;<span class="op" id="2126429">{</span>&nbsp;<span class="comment" id="2126431">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126448">b</span>&nbsp;<span class="op" id="2126450">=</span>&nbsp;<span class="num" id="2126452">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2126457">}</span>&nbsp;<span class="keyword" id="2126459">else</span>&nbsp;<span class="op" id="2126464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126470">temp</span>&nbsp;<span class="op" id="2126475">:=</span>&nbsp;<span class="ident" id="2126478">x</span>&nbsp;<span class="op" id="2126480">*</span>&nbsp;<span class="num" id="2126482">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126490">b</span>&nbsp;<span class="op" id="2126492">=</span>&nbsp;<span class="ident" id="2126494">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126503">a</span>&nbsp;<span class="op" id="2126505">:=</span>&nbsp;<span class="num" id="2126508">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2126516">for</span>&nbsp;<span class="ident" id="2126520">i</span>&nbsp;<span class="op" id="2126522">:=</span>&nbsp;<span class="num" id="2126525">2</span><span class="op" id="2126526">;</span>&nbsp;<span class="ident" id="2126528">i</span>&nbsp;<span class="op" id="2126530">&lt;=</span>&nbsp;<span class="ident" id="2126533">n</span><span class="op" id="2126534">;</span>&nbsp;<span class="ident" id="2126536">i</span><span class="op" id="2126537">++</span>&nbsp;<span class="op" id="2126540">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126547">a</span>&nbsp;<span class="op" id="2126549">*=</span>&nbsp;<span class="builtintype" id="2126552">float64</span><span class="op" id="2126559">(</span><span class="ident" id="2126560">i</span><span class="op" id="2126561">)</span>&nbsp;<span class="comment" id="2126563">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126578">b</span>&nbsp;<span class="op" id="2126580">*=</span>&nbsp;<span class="ident" id="2126583">temp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2126594">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2126614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2126620">b</span>&nbsp;<span class="op" id="2126622">/=</span>&nbsp;<span class="ident" id="2126625">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2126630">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2126634">}</span>&nbsp;<span class="keyword" id="2126636">else</span>&nbsp;<span class="op" id="2126641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2126646">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2126676">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2126725">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2126782">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2126831">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2126837">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2126882">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2126938">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2126986">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127036">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127082">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127088">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127142">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127184">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127209">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127246">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127274">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127310">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127341">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127376">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127413">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127419">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127465">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127500">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127538">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127576">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127614">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127657">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127675">w</span>&nbsp;<span class="op" id="2127677">:=</span>&nbsp;<span class="builtintype" id="2127680">float64</span><span class="op" id="2127687">(</span><span class="ident" id="2127688">n</span><span class="op" id="2127689">+</span><span class="ident" id="2127690">n</span><span class="op" id="2127691">)</span>&nbsp;<span class="op" id="2127693">/</span>&nbsp;<span class="ident" id="2127695">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127700">h</span>&nbsp;<span class="op" id="2127702">:=</span>&nbsp;<span class="num" id="2127705">2</span>&nbsp;<span class="op" id="2127707">/</span>&nbsp;<span class="ident" id="2127709">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127714">q0</span>&nbsp;<span class="op" id="2127717">:=</span>&nbsp;<span class="ident" id="2127720">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127725">z</span>&nbsp;<span class="op" id="2127727">:=</span>&nbsp;<span class="ident" id="2127730">w</span>&nbsp;<span class="op" id="2127732">+</span>&nbsp;<span class="ident" id="2127734">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127739">q1</span>&nbsp;<span class="op" id="2127742">:=</span>&nbsp;<span class="ident" id="2127745">w</span><span class="op" id="2127746">*</span><span class="ident" id="2127747">z</span>&nbsp;<span class="op" id="2127749">-</span>&nbsp;<span class="num" id="2127751">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127756">k</span>&nbsp;<span class="op" id="2127758">:=</span>&nbsp;<span class="num" id="2127761">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2127766">for</span>&nbsp;<span class="ident" id="2127770">q1</span>&nbsp;<span class="op" id="2127773">&lt;</span>&nbsp;<span class="num" id="2127775">1e9</span>&nbsp;<span class="op" id="2127779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127785">k</span>&nbsp;<span class="op" id="2127787">+=</span>&nbsp;<span class="num" id="2127790">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127796">z</span>&nbsp;<span class="op" id="2127798">+=</span>&nbsp;<span class="ident" id="2127801">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127807">q0</span><span class="op" id="2127809">,</span>&nbsp;<span class="ident" id="2127811">q1</span>&nbsp;<span class="op" id="2127814">=</span>&nbsp;<span class="ident" id="2127816">q1</span><span class="op" id="2127818">,</span>&nbsp;<span class="ident" id="2127820">z</span><span class="op" id="2127821">*</span><span class="ident" id="2127822">q1</span><span class="op" id="2127824">-</span><span class="ident" id="2127825">q0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127836">m</span>&nbsp;<span class="op" id="2127838">:=</span>&nbsp;<span class="ident" id="2127841">n</span>&nbsp;<span class="op" id="2127843">+</span>&nbsp;<span class="ident" id="2127845">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127850">t</span>&nbsp;<span class="op" id="2127852">:=</span>&nbsp;<span class="num" id="2127855">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2127862">for</span>&nbsp;<span class="ident" id="2127866">i</span>&nbsp;<span class="op" id="2127868">:=</span>&nbsp;<span class="num" id="2127871">2</span>&nbsp;<span class="op" id="2127873">*</span>&nbsp;<span class="op" id="2127875">(</span><span class="ident" id="2127876">n</span>&nbsp;<span class="op" id="2127878">+</span>&nbsp;<span class="ident" id="2127880">k</span><span class="op" id="2127881">)</span><span class="op" id="2127882">;</span>&nbsp;<span class="ident" id="2127884">i</span>&nbsp;<span class="op" id="2127886">&gt;=</span>&nbsp;<span class="ident" id="2127889">m</span><span class="op" id="2127890">;</span>&nbsp;<span class="ident" id="2127892">i</span>&nbsp;<span class="op" id="2127894">-=</span>&nbsp;<span class="num" id="2127897">2</span>&nbsp;<span class="op" id="2127899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127905">t</span>&nbsp;<span class="op" id="2127907">=</span>&nbsp;<span class="num" id="2127909">1</span>&nbsp;<span class="op" id="2127911">/</span>&nbsp;<span class="op" id="2127913">(</span><span class="builtintype" id="2127914">float64</span><span class="op" id="2127921">(</span><span class="ident" id="2127922">i</span><span class="op" id="2127923">)</span><span class="op" id="2127924">/</span><span class="ident" id="2127925">x</span>&nbsp;<span class="op" id="2127927">-</span>&nbsp;<span class="ident" id="2127929">t</span><span class="op" id="2127930">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127940">a</span>&nbsp;<span class="op" id="2127942">:=</span>&nbsp;<span class="ident" id="2127945">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127950">b</span>&nbsp;<span class="op" id="2127952">=</span>&nbsp;<span class="num" id="2127954">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2127959">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2128013">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2128050">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2128081">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2128122">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2128188">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2128247">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128280">tmp</span>&nbsp;<span class="op" id="2128284">:=</span>&nbsp;<span class="builtintype" id="2128287">float64</span><span class="op" id="2128294">(</span><span class="ident" id="2128295">n</span><span class="op" id="2128296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128301">v</span>&nbsp;<span class="op" id="2128303">:=</span>&nbsp;<span class="num" id="2128306">2</span>&nbsp;<span class="op" id="2128308">/</span>&nbsp;<span class="ident" id="2128310">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128315">tmp</span>&nbsp;<span class="op" id="2128319">=</span>&nbsp;<span class="ident" id="2128321">tmp</span>&nbsp;<span class="op" id="2128325">*</span>&nbsp;<span class="ident" id="2128327">Log</span><span class="op" id="2128330">(</span><span class="ident" id="2128331">Abs</span><span class="op" id="2128334">(</span><span class="ident" id="2128335">v</span><span class="op" id="2128336">*</span><span class="ident" id="2128337">tmp</span><span class="op" id="2128340">)</span><span class="op" id="2128341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2128346">if</span>&nbsp;<span class="ident" id="2128349">tmp</span>&nbsp;<span class="op" id="2128353">&lt;</span>&nbsp;<span class="num" id="2128355">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="2128382">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2128388">for</span>&nbsp;<span class="ident" id="2128392">i</span>&nbsp;<span class="op" id="2128394">:=</span>&nbsp;<span class="ident" id="2128397">n</span>&nbsp;<span class="op" id="2128399">-</span>&nbsp;<span class="num" id="2128401">1</span><span class="op" id="2128402">;</span>&nbsp;<span class="ident" id="2128404">i</span>&nbsp;<span class="op" id="2128406">&gt;</span>&nbsp;<span class="num" id="2128408">0</span><span class="op" id="2128409">;</span>&nbsp;<span class="ident" id="2128411">i</span><span class="op" id="2128412">--</span>&nbsp;<span class="op" id="2128415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128422">di</span>&nbsp;<span class="op" id="2128425">:=</span>&nbsp;<span class="builtintype" id="2128428">float64</span><span class="op" id="2128435">(</span><span class="ident" id="2128436">i</span>&nbsp;<span class="op" id="2128438">+</span>&nbsp;<span class="ident" id="2128440">i</span><span class="op" id="2128441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128448">a</span><span class="op" id="2128449">,</span>&nbsp;<span class="ident" id="2128451">b</span>&nbsp;<span class="op" id="2128453">=</span>&nbsp;<span class="ident" id="2128455">b</span><span class="op" id="2128456">,</span>&nbsp;<span class="ident" id="2128458">b</span><span class="op" id="2128459">*</span><span class="ident" id="2128460">di</span><span class="op" id="2128462">/</span><span class="ident" id="2128463">x</span><span class="op" id="2128464">-</span><span class="ident" id="2128465">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128472">di</span>&nbsp;<span class="op" id="2128475">-=</span>&nbsp;<span class="num" id="2128478">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128484">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128489">}</span>&nbsp;<span class="keyword" id="2128491">else</span>&nbsp;<span class="op" id="2128496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2128502">for</span>&nbsp;<span class="ident" id="2128506">i</span>&nbsp;<span class="op" id="2128508">:=</span>&nbsp;<span class="ident" id="2128511">n</span>&nbsp;<span class="op" id="2128513">-</span>&nbsp;<span class="num" id="2128515">1</span><span class="op" id="2128516">;</span>&nbsp;<span class="ident" id="2128518">i</span>&nbsp;<span class="op" id="2128520">&gt;</span>&nbsp;<span class="num" id="2128522">0</span><span class="op" id="2128523">;</span>&nbsp;<span class="ident" id="2128525">i</span><span class="op" id="2128526">--</span>&nbsp;<span class="op" id="2128529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128536">di</span>&nbsp;<span class="op" id="2128539">:=</span>&nbsp;<span class="builtintype" id="2128542">float64</span><span class="op" id="2128549">(</span><span class="ident" id="2128550">i</span>&nbsp;<span class="op" id="2128552">+</span>&nbsp;<span class="ident" id="2128554">i</span><span class="op" id="2128555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128562">a</span><span class="op" id="2128563">,</span>&nbsp;<span class="ident" id="2128565">b</span>&nbsp;<span class="op" id="2128567">=</span>&nbsp;<span class="ident" id="2128569">b</span><span class="op" id="2128570">,</span>&nbsp;<span class="ident" id="2128572">b</span><span class="op" id="2128573">*</span><span class="ident" id="2128574">di</span><span class="op" id="2128576">/</span><span class="ident" id="2128577">x</span><span class="op" id="2128578">-</span><span class="ident" id="2128579">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128586">di</span>&nbsp;<span class="op" id="2128589">-=</span>&nbsp;<span class="num" id="2128592">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2128599">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2128642">if</span>&nbsp;<span class="ident" id="2128645">b</span>&nbsp;<span class="op" id="2128647">&gt;</span>&nbsp;<span class="num" id="2128649">1e100</span>&nbsp;<span class="op" id="2128655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128663">a</span>&nbsp;<span class="op" id="2128665">/=</span>&nbsp;<span class="ident" id="2128668">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128676">t</span>&nbsp;<span class="op" id="2128678">/=</span>&nbsp;<span class="ident" id="2128681">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128689">b</span>&nbsp;<span class="op" id="2128691">=</span>&nbsp;<span class="num" id="2128693">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2128716">b</span>&nbsp;<span class="op" id="2128718">=</span>&nbsp;<span class="ident" id="2128720">t</span>&nbsp;<span class="op" id="2128722">*</span>&nbsp;<span class="ident" id="2128724">J0</span><span class="op" id="2128726">(</span><span class="ident" id="2128727">x</span><span class="op" id="2128728">)</span>&nbsp;<span class="op" id="2128730">/</span>&nbsp;<span class="ident" id="2128732">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128736">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2128742">if</span>&nbsp;<span class="ident" id="2128745">sign</span>&nbsp;<span class="op" id="2128750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2128754">return</span>&nbsp;<span class="op" id="2128761">-</span><span class="ident" id="2128762">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2128768">return</span>&nbsp;<span class="ident" id="2128775">b</span><br>
<span class="lineno">225</span><span class="op" id="2128777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2128780">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2128842">//</span><br>
<span class="lineno"></span><span class="comment" id="2128845">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="2128867">//&nbsp;&nbsp;&nbsp;&nbspYn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2128886">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2128909">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="2128963">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2128985">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="2129005">func</span>&nbsp;<span class="ident" id="2129010">Yn</span><span class="op" id="2129012">(</span><span class="ident" id="2129013">n</span>&nbsp;<span class="builtintype" id="2129015">int</span><span class="op" id="2129018">,</span>&nbsp;<span class="ident" id="2129020">x</span>&nbsp;<span class="builtintype" id="2129022">float64</span><span class="op" id="2129029">)</span>&nbsp;<span class="builtintype" id="2129031">float64</span>&nbsp;<span class="op" id="2129039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129042">const</span>&nbsp;<span class="ident" id="2129048">Two302</span>&nbsp;<span class="op" id="2129055">=</span>&nbsp;<span class="num" id="2129057">1</span>&nbsp;<span class="op" id="2129059">&lt;&lt;</span>&nbsp;<span class="num" id="2129062">302</span>&nbsp;<span class="comment" id="2129066">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129096">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129114">switch</span>&nbsp;<span class="op" id="2129121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129124">case</span>&nbsp;<span class="ident" id="2129129">x</span>&nbsp;<span class="op" id="2129131">&lt;</span>&nbsp;<span class="num" id="2129133">0</span>&nbsp;<span class="op" id="2129135">||</span>&nbsp;<span class="ident" id="2129138">IsNaN</span><span class="op" id="2129143">(</span><span class="ident" id="2129144">x</span><span class="op" id="2129145">)</span><span class="op" id="2129146">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129150">return</span>&nbsp;<span class="ident" id="2129157">NaN</span><span class="op" id="2129160">(</span><span class="op" id="2129161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129164">case</span>&nbsp;<span class="ident" id="2129169">IsInf</span><span class="op" id="2129174">(</span><span class="ident" id="2129175">x</span><span class="op" id="2129176">,</span>&nbsp;<span class="num" id="2129178">1</span><span class="op" id="2129179">)</span><span class="op" id="2129180">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129184">return</span>&nbsp;<span class="num" id="2129191">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129198">if</span>&nbsp;<span class="ident" id="2129201">n</span>&nbsp;<span class="op" id="2129203">==</span>&nbsp;<span class="num" id="2129206">0</span>&nbsp;<span class="op" id="2129208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129212">return</span>&nbsp;<span class="ident" id="2129219">Y0</span><span class="op" id="2129221">(</span><span class="ident" id="2129222">x</span><span class="op" id="2129223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129229">if</span>&nbsp;<span class="ident" id="2129232">x</span>&nbsp;<span class="op" id="2129234">==</span>&nbsp;<span class="num" id="2129237">0</span>&nbsp;<span class="op" id="2129239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129243">if</span>&nbsp;<span class="ident" id="2129246">n</span>&nbsp;<span class="op" id="2129248">&lt;</span>&nbsp;<span class="num" id="2129250">0</span>&nbsp;<span class="op" id="2129252">&amp;&amp;</span>&nbsp;<span class="ident" id="2129255">n</span><span class="op" id="2129256">&amp;</span><span class="num" id="2129257">1</span>&nbsp;<span class="op" id="2129259">==</span>&nbsp;<span class="num" id="2129262">1</span>&nbsp;<span class="op" id="2129264">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129269">return</span>&nbsp;<span class="ident" id="2129276">Inf</span><span class="op" id="2129279">(</span><span class="num" id="2129280">1</span><span class="op" id="2129281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129289">return</span>&nbsp;<span class="ident" id="2129296">Inf</span><span class="op" id="2129299">(</span><span class="op" id="2129300">-</span><span class="num" id="2129301">1</span><span class="op" id="2129302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2129308">sign</span>&nbsp;<span class="op" id="2129313">:=</span>&nbsp;<span class="builtintype" id="2129316">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129323">if</span>&nbsp;<span class="ident" id="2129326">n</span>&nbsp;<span class="op" id="2129328">&lt;</span>&nbsp;<span class="num" id="2129330">0</span>&nbsp;<span class="op" id="2129332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2129336">n</span>&nbsp;<span class="op" id="2129338">=</span>&nbsp;<span class="op" id="2129340">-</span><span class="ident" id="2129341">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129345">if</span>&nbsp;<span class="ident" id="2129348">n</span><span class="op" id="2129349">&amp;</span><span class="num" id="2129350">1</span>&nbsp;<span class="op" id="2129352">==</span>&nbsp;<span class="num" id="2129355">1</span>&nbsp;<span class="op" id="2129357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2129362">sign</span>&nbsp;<span class="op" id="2129367">=</span>&nbsp;<span class="builtintype" id="2129369">true</span>&nbsp;<span class="comment" id="2129374">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129409">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129415">if</span>&nbsp;<span class="ident" id="2129418">n</span>&nbsp;<span class="op" id="2129420">==</span>&nbsp;<span class="num" id="2129423">1</span>&nbsp;<span class="op" id="2129425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129429">if</span>&nbsp;<span class="ident" id="2129432">sign</span>&nbsp;<span class="op" id="2129437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129442">return</span>&nbsp;<span class="op" id="2129449">-</span><span class="ident" id="2129450">Y1</span><span class="op" id="2129452">(</span><span class="ident" id="2129453">x</span><span class="op" id="2129454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129458">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129462">return</span>&nbsp;<span class="ident" id="2129469">Y1</span><span class="op" id="2129471">(</span><span class="ident" id="2129472">x</span><span class="op" id="2129473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129479">var</span>&nbsp;<span class="ident" id="2129483">b</span>&nbsp;<span class="builtintype" id="2129485">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129494">if</span>&nbsp;<span class="ident" id="2129497">x</span>&nbsp;<span class="op" id="2129499">&gt;=</span>&nbsp;<span class="ident" id="2129502">Two302</span>&nbsp;<span class="op" id="2129509">{</span>&nbsp;<span class="comment" id="2129511">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129527">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129544">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129593">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129642">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129675">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspxn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129719">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129724">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbspsin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbspcos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129761">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129802">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129824">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129847">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp-s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2129869">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129892">var</span>&nbsp;<span class="ident" id="2129896">temp</span>&nbsp;<span class="builtintype" id="2129901">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129911">switch</span>&nbsp;<span class="ident" id="2129918">n</span>&nbsp;<span class="op" id="2129920">&amp;</span>&nbsp;<span class="num" id="2129922">3</span>&nbsp;<span class="op" id="2129924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129928">case</span>&nbsp;<span class="num" id="2129933">0</span><span class="op" id="2129934">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2129939">temp</span>&nbsp;<span class="op" id="2129944">=</span>&nbsp;<span class="ident" id="2129946">Sin</span><span class="op" id="2129949">(</span><span class="ident" id="2129950">x</span><span class="op" id="2129951">)</span>&nbsp;<span class="op" id="2129953">-</span>&nbsp;<span class="ident" id="2129955">Cos</span><span class="op" id="2129958">(</span><span class="ident" id="2129959">x</span><span class="op" id="2129960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2129964">case</span>&nbsp;<span class="num" id="2129969">1</span><span class="op" id="2129970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2129975">temp</span>&nbsp;<span class="op" id="2129980">=</span>&nbsp;<span class="op" id="2129982">-</span><span class="ident" id="2129983">Sin</span><span class="op" id="2129986">(</span><span class="ident" id="2129987">x</span><span class="op" id="2129988">)</span>&nbsp;<span class="op" id="2129990">-</span>&nbsp;<span class="ident" id="2129992">Cos</span><span class="op" id="2129995">(</span><span class="ident" id="2129996">x</span><span class="op" id="2129997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2130001">case</span>&nbsp;<span class="num" id="2130006">2</span><span class="op" id="2130007">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2130012">temp</span>&nbsp;<span class="op" id="2130017">=</span>&nbsp;<span class="op" id="2130019">-</span><span class="ident" id="2130020">Sin</span><span class="op" id="2130023">(</span><span class="ident" id="2130024">x</span><span class="op" id="2130025">)</span>&nbsp;<span class="op" id="2130027">+</span>&nbsp;<span class="ident" id="2130029">Cos</span><span class="op" id="2130032">(</span><span class="ident" id="2130033">x</span><span class="op" id="2130034">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2130038">case</span>&nbsp;<span class="num" id="2130043">3</span><span class="op" id="2130044">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2130049">temp</span>&nbsp;<span class="op" id="2130054">=</span>&nbsp;<span class="ident" id="2130056">Sin</span><span class="op" id="2130059">(</span><span class="ident" id="2130060">x</span><span class="op" id="2130061">)</span>&nbsp;<span class="op" id="2130063">+</span>&nbsp;<span class="ident" id="2130065">Cos</span><span class="op" id="2130068">(</span><span class="ident" id="2130069">x</span><span class="op" id="2130070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2130078">b</span>&nbsp;<span class="op" id="2130080">=</span>&nbsp;<span class="op" id="2130082">(</span><span class="num" id="2130083">1</span>&nbsp;<span class="op" id="2130085">/</span>&nbsp;<span class="ident" id="2130087">SqrtPi</span><span class="op" id="2130093">)</span>&nbsp;<span class="op" id="2130095">*</span>&nbsp;<span class="ident" id="2130097">temp</span>&nbsp;<span class="op" id="2130102">/</span>&nbsp;<span class="ident" id="2130104">Sqrt</span><span class="op" id="2130108">(</span><span class="ident" id="2130109">x</span><span class="op" id="2130110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130113">}</span>&nbsp;<span class="keyword" id="2130115">else</span>&nbsp;<span class="op" id="2130120">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2130124">a</span>&nbsp;<span class="op" id="2130126">:=</span>&nbsp;<span class="ident" id="2130129">Y0</span><span class="op" id="2130131">(</span><span class="ident" id="2130132">x</span><span class="op" id="2130133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2130137">b</span>&nbsp;<span class="op" id="2130139">=</span>&nbsp;<span class="ident" id="2130141">Y1</span><span class="op" id="2130143">(</span><span class="ident" id="2130144">x</span><span class="op" id="2130145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2130149">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2130172">for</span>&nbsp;<span class="ident" id="2130176">i</span>&nbsp;<span class="op" id="2130178">:=</span>&nbsp;<span class="num" id="2130181">1</span><span class="op" id="2130182">;</span>&nbsp;<span class="ident" id="2130184">i</span>&nbsp;<span class="op" id="2130186">&lt;</span>&nbsp;<span class="ident" id="2130188">n</span>&nbsp;<span class="op" id="2130190">&amp;&amp;</span>&nbsp;<span class="op" id="2130193">!</span><span class="ident" id="2130194">IsInf</span><span class="op" id="2130199">(</span><span class="ident" id="2130200">b</span><span class="op" id="2130201">,</span>&nbsp;<span class="op" id="2130203">-</span><span class="num" id="2130204">1</span><span class="op" id="2130205">)</span><span class="op" id="2130206">;</span>&nbsp;<span class="ident" id="2130208">i</span><span class="op" id="2130209">++</span>&nbsp;<span class="op" id="2130212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2130217">a</span><span class="op" id="2130218">,</span>&nbsp;<span class="ident" id="2130220">b</span>&nbsp;<span class="op" id="2130222">=</span>&nbsp;<span class="ident" id="2130224">b</span><span class="op" id="2130225">,</span>&nbsp;<span class="op" id="2130227">(</span><span class="builtintype" id="2130228">float64</span><span class="op" id="2130235">(</span><span class="ident" id="2130236">i</span><span class="op" id="2130237">+</span><span class="ident" id="2130238">i</span><span class="op" id="2130239">)</span><span class="op" id="2130240">/</span><span class="ident" id="2130241">x</span><span class="op" id="2130242">)</span><span class="op" id="2130243">*</span><span class="ident" id="2130244">b</span><span class="op" id="2130245">-</span><span class="ident" id="2130246">a</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2130256">if</span>&nbsp;<span class="ident" id="2130259">sign</span>&nbsp;<span class="op" id="2130264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2130268">return</span>&nbsp;<span class="op" id="2130275">-</span><span class="ident" id="2130276">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130279">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2130282">return</span>&nbsp;<span class="ident" id="2130289">b</span><br>
<span class="lineno"></span><span class="op" id="2130291">}</span>
</div>
</body>
</html>
